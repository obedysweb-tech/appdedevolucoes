import{j as m,c as Vw,T as Hw,I as GA,S as $w,a as Ww,P as qA,C as Gw,V as YA,L as qw,b as Yw,d as XA,e as KA,f as Xw,R as JA,g as QA,h as Y0,u as Lu,i as ZA,k as e4,o as t4,s as r4,l as a4,m as n4,n as s4,p as i4,q as o4,r as l4,t as M1,v as xu,w as ys,x as c4,y as j1,z as u4,A as f4,B as d4,D as Xa,E as h4,F as m4,G as g4,H as I1,J as P1,_ as x4,K as X0,M as v4,N as p4,O as Kw,Q as Jw,U as y4,W as _4,X as Qw,Y as Zw,Z as w4,$ as e2,a0 as b4,a1 as t2,a2 as r2,a3 as S4,a4 as E4}from"./ui-vendor-m41omS0V.js";import{d as T4,e as k4,r as K,R as ge,b as A4,c as C4,u as N4,f as D4,L as c0,O as O4,B as R4,h as F4,i as Ls,N as C0}from"./react-vendor-B-kcwh7K.js";import{c as a2,R as co,A as M4,C as Nl,X as Dl,Y as ki,T as uo,a as j4,B as pm,b as u0,d as I4,L as t1,P as P4,e as L4,f as B4,g as n2,r as U4,h as z4}from"./chart-vendor-e0ABBqH7.js";import{_ as V4,E as s2,a as Ni}from"./pdf-vendor-B3LczRcA.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();var ym={exports:{}},qc={},_m={exports:{}},wm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dy;function H4(){return Dy||(Dy=1,function(e){function t(q,ae){var be=q.length;q.push(ae);e:for(;0<be;){var z=be-1>>>1,fe=q[z];if(0<n(fe,ae))q[z]=ae,q[be]=fe,be=z;else break e}}function r(q){return q.length===0?null:q[0]}function a(q){if(q.length===0)return null;var ae=q[0],be=q.pop();if(be!==ae){q[0]=be;e:for(var z=0,fe=q.length,De=fe>>>1;z<De;){var P=2*(z+1)-1,X=q[P],Y=P+1,Q=q[Y];if(0>n(X,be))Y<fe&&0>n(Q,X)?(q[z]=Q,q[Y]=be,z=Y):(q[z]=X,q[P]=be,z=P);else if(Y<fe&&0>n(Q,be))q[z]=Q,q[Y]=be,z=Y;else break e}}return ae}function n(q,ae){var be=q.sortIndex-ae.sortIndex;return be!==0?be:q.id-ae.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();e.unstable_now=function(){return l.now()-u}}var f=[],h=[],g=1,v=null,p=3,_=!1,b=!1,w=!1,S=!1,T=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function E(q){for(var ae=r(h);ae!==null;){if(ae.callback===null)a(h);else if(ae.startTime<=q)a(h),ae.sortIndex=ae.expirationTime,t(f,ae);else break;ae=r(h)}}function M(q){if(w=!1,E(q),!b)if(r(f)!==null)b=!0,D||(D=!0,U());else{var ae=r(h);ae!==null&&ie(M,ae.startTime-q)}}var D=!1,A=-1,B=5,j=-1;function ee(){return S?!0:!(e.unstable_now()-j<B)}function re(){if(S=!1,D){var q=e.unstable_now();j=q;var ae=!0;try{e:{b=!1,w&&(w=!1,N(A),A=-1),_=!0;var be=p;try{t:{for(E(q),v=r(f);v!==null&&!(v.expirationTime>q&&ee());){var z=v.callback;if(typeof z=="function"){v.callback=null,p=v.priorityLevel;var fe=z(v.expirationTime<=q);if(q=e.unstable_now(),typeof fe=="function"){v.callback=fe,E(q),ae=!0;break t}v===r(f)&&a(f),E(q)}else a(f);v=r(f)}if(v!==null)ae=!0;else{var De=r(h);De!==null&&ie(M,De.startTime-q),ae=!1}}break e}finally{v=null,p=be,_=!1}ae=void 0}}finally{ae?U():D=!1}}}var U;if(typeof k=="function")U=function(){k(re)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,ne=I.port2;I.port1.onmessage=re,U=function(){ne.postMessage(null)}}else U=function(){T(re,0)};function ie(q,ae){A=T(function(){q(e.unstable_now())},ae)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_next=function(q){switch(p){case 1:case 2:case 3:var ae=3;break;default:ae=p}var be=p;p=ae;try{return q()}finally{p=be}},e.unstable_requestPaint=function(){S=!0},e.unstable_runWithPriority=function(q,ae){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var be=p;p=q;try{return ae()}finally{p=be}},e.unstable_scheduleCallback=function(q,ae,be){var z=e.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?z+be:z):be=z,q){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=be+fe,q={id:g++,callback:ae,priorityLevel:q,startTime:be,expirationTime:fe,sortIndex:-1},be>z?(q.sortIndex=be,t(h,q),r(f)===null&&q===r(h)&&(w?(N(A),A=-1):w=!0,ie(M,be-z))):(q.sortIndex=fe,t(f,q),b||_||(b=!0,D||(D=!0,U()))),q},e.unstable_shouldYield=ee,e.unstable_wrapCallback=function(q){var ae=p;return function(){var be=p;p=ae;try{return q.apply(this,arguments)}finally{p=be}}}}(wm)),wm}var Oy;function $4(){return Oy||(Oy=1,_m.exports=H4()),_m.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ry;function W4(){if(Ry)return qc;Ry=1;var e=$4(),t=T4(),r=k4();function a(s){var i="https://react.dev/errors/"+s;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var i=s,c=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(c=i.return),s=i.return;while(s)}return i.tag===3?c:null}function l(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function u(s){if(o(s)!==s)throw Error(a(188))}function f(s){var i=s.alternate;if(!i){if(i=o(s),i===null)throw Error(a(188));return i!==s?null:s}for(var c=s,d=i;;){var x=c.return;if(x===null)break;var y=x.alternate;if(y===null){if(d=x.return,d!==null){c=d;continue}break}if(x.child===y.child){for(y=x.child;y;){if(y===c)return u(x),s;if(y===d)return u(x),i;y=y.sibling}throw Error(a(188))}if(c.return!==d.return)c=x,d=y;else{for(var C=!1,F=x.child;F;){if(F===c){C=!0,c=x,d=y;break}if(F===d){C=!0,d=x,c=y;break}F=F.sibling}if(!C){for(F=y.child;F;){if(F===c){C=!0,c=y,d=x;break}if(F===d){C=!0,d=y,c=x;break}F=F.sibling}if(!C)throw Error(a(189))}}if(c.alternate!==d)throw Error(a(190))}if(c.tag!==3)throw Error(a(188));return c.stateNode.current===c?s:i}function h(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s;for(s=s.child;s!==null;){if(i=h(s),i!==null)return i;s=s.sibling}return null}var g=Object.assign,v=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),N=Symbol.for("react.consumer"),k=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),ee=Symbol.for("react.memo_cache_sentinel"),re=Symbol.iterator;function U(s){return s===null||typeof s!="object"?null:(s=re&&s[re]||s["@@iterator"],typeof s=="function"?s:null)}var I=Symbol.for("react.client.reference");function ne(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===I?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case S:return"Profiler";case w:return"StrictMode";case M:return"Suspense";case D:return"SuspenseList";case j:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case _:return"Portal";case k:return(s.displayName||"Context")+".Provider";case N:return(s._context.displayName||"Context")+".Consumer";case E:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case A:return i=s.displayName||null,i!==null?i:ne(s.type)||"Memo";case B:i=s._payload,s=s._init;try{return ne(s(i))}catch{}}return null}var ie=Array.isArray,q=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,be={pending:!1,data:null,method:null,action:null},z=[],fe=-1;function De(s){return{current:s}}function P(s){0>fe||(s.current=z[fe],z[fe]=null,fe--)}function X(s,i){fe++,z[fe]=s.current,s.current=i}var Y=De(null),Q=De(null),de=De(null),Fe=De(null);function Te(s,i){switch(X(de,i),X(Q,s),X(Y,null),i.nodeType){case 9:case 11:s=(s=i.documentElement)&&(s=s.namespaceURI)?ny(s):0;break;default:if(s=i.tagName,i=i.namespaceURI)i=ny(i),s=sy(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}P(Y),X(Y,s)}function Oe(){P(Y),P(Q),P(de)}function Re(s){s.memoizedState!==null&&X(Fe,s);var i=Y.current,c=sy(i,s.type);i!==c&&(X(Q,s),X(Y,c))}function Je(s){Q.current===s&&(P(Y),P(Q)),Fe.current===s&&(P(Fe),Vc._currentValue=be)}var H=Object.prototype.hasOwnProperty,O=e.unstable_scheduleCallback,Ae=e.unstable_cancelCallback,Pe=e.unstable_shouldYield,Se=e.unstable_requestPaint,Z=e.unstable_now,le=e.unstable_getCurrentPriorityLevel,Ge=e.unstable_ImmediatePriority,kt=e.unstable_UserBlockingPriority,nt=e.unstable_NormalPriority,st=e.unstable_LowPriority,Ze=e.unstable_IdlePriority,Ee=e.log,Xe=e.unstable_setDisableYieldValue,Qe=null,et=null;function rt(s){if(typeof Ee=="function"&&Xe(s),et&&typeof et.setStrictMode=="function")try{et.setStrictMode(Qe,s)}catch{}}var ke=Math.clz32?Math.clz32:ze,ye=Math.log,xe=Math.LN2;function ze(s){return s>>>=0,s===0?32:31-(ye(s)/xe|0)|0}var xt=256,qt=4194304;function lr(s){var i=s&42;if(i!==0)return i;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Nr(s,i,c){var d=s.pendingLanes;if(d===0)return 0;var x=0,y=s.suspendedLanes,C=s.pingedLanes;s=s.warmLanes;var F=d&134217727;return F!==0?(d=F&~y,d!==0?x=lr(d):(C&=F,C!==0?x=lr(C):c||(c=F&~s,c!==0&&(x=lr(c))))):(F=d&~y,F!==0?x=lr(F):C!==0?x=lr(C):c||(c=d&~s,c!==0&&(x=lr(c)))),x===0?0:i!==0&&i!==x&&(i&y)===0&&(y=x&-x,c=i&-i,y>=c||y===32&&(c&4194048)!==0)?i:x}function gr(s,i){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&i)===0}function xa(s,i){switch(s){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function br(){var s=xt;return xt<<=1,(xt&4194048)===0&&(xt=256),s}function ft(){var s=qt;return qt<<=1,(qt&62914560)===0&&(qt=4194304),s}function jt(s){for(var i=[],c=0;31>c;c++)i.push(s);return i}function lt(s,i){s.pendingLanes|=i,i!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Ot(s,i,c,d,x,y){var C=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var F=s.entanglements,te=s.expirationTimes,he=s.hiddenUpdates;for(c=C&~c;0<c;){var Me=31-ke(c),Le=1<<Me;F[Me]=0,te[Me]=-1;var pe=he[Me];if(pe!==null)for(he[Me]=null,Me=0;Me<pe.length;Me++){var we=pe[Me];we!==null&&(we.lane&=-536870913)}c&=~Le}d!==0&&ct(s,d,0),y!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=y&~(C&~i))}function ct(s,i,c){s.pendingLanes|=i,s.suspendedLanes&=~i;var d=31-ke(i);s.entangledLanes|=i,s.entanglements[d]=s.entanglements[d]|1073741824|c&4194090}function je(s,i){var c=s.entangledLanes|=i;for(s=s.entanglements;c;){var d=31-ke(c),x=1<<d;x&i|s[d]&i&&(s[d]|=i),c&=~x}}function He(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function pr(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Bn(){var s=ae.p;return s!==0?s:(s=window.event,s===void 0?32:Ey(s.type))}function Sr(s,i){var c=ae.p;try{return ae.p=s,i()}finally{ae.p=c}}var xr=Math.random().toString(36).slice(2),Or="__reactFiber$"+xr,er="__reactProps$"+xr,Xr="__reactContainer$"+xr,Qs="__reactEvents$"+xr,Un="__reactListeners$"+xr,R="__reactHandles$"+xr,G="__reactResources$"+xr,L="__reactMarker$"+xr;function V(s){delete s[Or],delete s[er],delete s[Qs],delete s[Un],delete s[R]}function W(s){var i=s[Or];if(i)return i;for(var c=s.parentNode;c;){if(i=c[Xr]||c[Or]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(s=cy(s);s!==null;){if(c=s[Or])return c;s=cy(s)}return i}s=c,c=s.parentNode}return null}function J(s){if(s=s[Or]||s[Xr]){var i=s.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return s}return null}function me(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s.stateNode;throw Error(a(33))}function Ce(s){var i=s[G];return i||(i=s[G]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function ce(s){s[L]=!0}var ve=new Set,_e={};function Ue(s,i){$e(s,i),$e(s+"Capture",i)}function $e(s,i){for(_e[s]=i,s=0;s<i.length;s++)ve.add(i[s])}var at=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ve={},tt={};function Nt(s){return H.call(tt,s)?!0:H.call(Ve,s)?!1:at.test(s)?tt[s]=!0:(Ve[s]=!0,!1)}function cr(s,i,c){if(Nt(i))if(c===null)s.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(i);return;case"boolean":var d=i.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){s.removeAttribute(i);return}}s.setAttribute(i,""+c)}}function ur(s,i,c){if(c===null)s.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(i);return}s.setAttribute(i,""+c)}}function yr(s,i,c,d){if(d===null)s.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(i,c,""+d)}}var Ss,Zs;function pn(s){if(Ss===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);Ss=i&&i[1]||"",Zs=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ss+s+Zs}var zn=!1;function $i(s,i){if(!s||zn)return"";zn=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(i){var Le=function(){throw Error()};if(Object.defineProperty(Le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Le,[])}catch(we){var pe=we}Reflect.construct(s,[],Le)}else{try{Le.call()}catch(we){pe=we}s.call(Le.prototype)}}else{try{throw Error()}catch(we){pe=we}(Le=s())&&typeof Le.catch=="function"&&Le.catch(function(){})}}catch(we){if(we&&pe&&typeof we.stack=="string")return[we.stack,pe.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=d.DetermineComponentFrameRoot(),C=y[0],F=y[1];if(C&&F){var te=C.split(`
`),he=F.split(`
`);for(x=d=0;d<te.length&&!te[d].includes("DetermineComponentFrameRoot");)d++;for(;x<he.length&&!he[x].includes("DetermineComponentFrameRoot");)x++;if(d===te.length||x===he.length)for(d=te.length-1,x=he.length-1;1<=d&&0<=x&&te[d]!==he[x];)x--;for(;1<=d&&0<=x;d--,x--)if(te[d]!==he[x]){if(d!==1||x!==1)do if(d--,x--,0>x||te[d]!==he[x]){var Me=`
`+te[d].replace(" at new "," at ");return s.displayName&&Me.includes("<anonymous>")&&(Me=Me.replace("<anonymous>",s.displayName)),Me}while(1<=d&&0<=x);break}}}finally{zn=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?pn(c):""}function Vn(s){switch(s.tag){case 26:case 27:case 5:return pn(s.type);case 16:return pn("Lazy");case 13:return pn("Suspense");case 19:return pn("SuspenseList");case 0:case 15:return $i(s.type,!1);case 11:return $i(s.type.render,!1);case 1:return $i(s.type,!0);case 31:return pn("Activity");default:return""}}function Qg(s){try{var i="";do i+=Vn(s),s=s.return;while(s);return i}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function yn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Zg(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function zT(s){var i=Zg(s)?"checked":"value",c=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),d=""+s[i];if(!s.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var x=c.get,y=c.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return x.call(this)},set:function(C){d=""+C,y.call(this,C)}}),Object.defineProperty(s,i,{enumerable:c.enumerable}),{getValue:function(){return d},setValue:function(C){d=""+C},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function ef(s){s._valueTracker||(s._valueTracker=zT(s))}function ex(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var c=i.getValue(),d="";return s&&(d=Zg(s)?s.checked?"true":"false":s.value),s=d,s!==c?(i.setValue(s),!0):!1}function tf(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var VT=/[\n"\\]/g;function _n(s){return s.replace(VT,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function gd(s,i,c,d,x,y,C,F){s.name="",C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?s.type=C:s.removeAttribute("type"),i!=null?C==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+yn(i)):s.value!==""+yn(i)&&(s.value=""+yn(i)):C!=="submit"&&C!=="reset"||s.removeAttribute("value"),i!=null?xd(s,C,yn(i)):c!=null?xd(s,C,yn(c)):d!=null&&s.removeAttribute("value"),x==null&&y!=null&&(s.defaultChecked=!!y),x!=null&&(s.checked=x&&typeof x!="function"&&typeof x!="symbol"),F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?s.name=""+yn(F):s.removeAttribute("name")}function tx(s,i,c,d,x,y,C,F){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(s.type=y),i!=null||c!=null){if(!(y!=="submit"&&y!=="reset"||i!=null))return;c=c!=null?""+yn(c):"",i=i!=null?""+yn(i):c,F||i===s.value||(s.value=i),s.defaultValue=i}d=d??x,d=typeof d!="function"&&typeof d!="symbol"&&!!d,s.checked=F?s.checked:!!d,s.defaultChecked=!!d,C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(s.name=C)}function xd(s,i,c){i==="number"&&tf(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function Po(s,i,c,d){if(s=s.options,i){i={};for(var x=0;x<c.length;x++)i["$"+c[x]]=!0;for(c=0;c<s.length;c++)x=i.hasOwnProperty("$"+s[c].value),s[c].selected!==x&&(s[c].selected=x),x&&d&&(s[c].defaultSelected=!0)}else{for(c=""+yn(c),i=null,x=0;x<s.length;x++){if(s[x].value===c){s[x].selected=!0,d&&(s[x].defaultSelected=!0);return}i!==null||s[x].disabled||(i=s[x])}i!==null&&(i.selected=!0)}}function rx(s,i,c){if(i!=null&&(i=""+yn(i),i!==s.value&&(s.value=i),c==null)){s.defaultValue!==i&&(s.defaultValue=i);return}s.defaultValue=c!=null?""+yn(c):""}function ax(s,i,c,d){if(i==null){if(d!=null){if(c!=null)throw Error(a(92));if(ie(d)){if(1<d.length)throw Error(a(93));d=d[0]}c=d}c==null&&(c=""),i=c}c=yn(i),s.defaultValue=c,d=s.textContent,d===c&&d!==""&&d!==null&&(s.value=d)}function Lo(s,i){if(i){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=i;return}}s.textContent=i}var HT=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function nx(s,i,c){var d=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="":d?s.setProperty(i,c):typeof c!="number"||c===0||HT.has(i)?i==="float"?s.cssFloat=c:s[i]=(""+c).trim():s[i]=c+"px"}function sx(s,i,c){if(i!=null&&typeof i!="object")throw Error(a(62));if(s=s.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||i!=null&&i.hasOwnProperty(d)||(d.indexOf("--")===0?s.setProperty(d,""):d==="float"?s.cssFloat="":s[d]="");for(var x in i)d=i[x],i.hasOwnProperty(x)&&c[x]!==d&&nx(s,x,d)}else for(var y in i)i.hasOwnProperty(y)&&nx(s,y,i[y])}function vd(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $T=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),WT=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function rf(s){return WT.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var pd=null;function yd(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Bo=null,Uo=null;function ix(s){var i=J(s);if(i&&(s=i.stateNode)){var c=s[er]||null;e:switch(s=i.stateNode,i.type){case"input":if(gd(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+_n(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var d=c[i];if(d!==s&&d.form===s.form){var x=d[er]||null;if(!x)throw Error(a(90));gd(d,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(i=0;i<c.length;i++)d=c[i],d.form===s.form&&ex(d)}break e;case"textarea":rx(s,c.value,c.defaultValue);break e;case"select":i=c.value,i!=null&&Po(s,!!c.multiple,i,!1)}}}var _d=!1;function ox(s,i,c){if(_d)return s(i,c);_d=!0;try{var d=s(i);return d}finally{if(_d=!1,(Bo!==null||Uo!==null)&&(Vf(),Bo&&(i=Bo,s=Uo,Uo=Bo=null,ix(i),s)))for(i=0;i<s.length;i++)ix(s[i])}}function tc(s,i){var c=s.stateNode;if(c===null)return null;var d=c[er]||null;if(d===null)return null;c=d[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(s=s.type,d=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!d;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(a(231,i,typeof c));return c}var Es=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wd=!1;if(Es)try{var rc={};Object.defineProperty(rc,"passive",{get:function(){wd=!0}}),window.addEventListener("test",rc,rc),window.removeEventListener("test",rc,rc)}catch{wd=!1}var ei=null,bd=null,af=null;function lx(){if(af)return af;var s,i=bd,c=i.length,d,x="value"in ei?ei.value:ei.textContent,y=x.length;for(s=0;s<c&&i[s]===x[s];s++);var C=c-s;for(d=1;d<=C&&i[c-d]===x[y-d];d++);return af=x.slice(s,1<d?1-d:void 0)}function nf(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function sf(){return!0}function cx(){return!1}function Ha(s){function i(c,d,x,y,C){this._reactName=c,this._targetInst=x,this.type=d,this.nativeEvent=y,this.target=C,this.currentTarget=null;for(var F in s)s.hasOwnProperty(F)&&(c=s[F],this[F]=c?c(y):y[F]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?sf:cx,this.isPropagationStopped=cx,this}return g(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=sf)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=sf)},persist:function(){},isPersistent:sf}),i}var Wi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},of=Ha(Wi),ac=g({},Wi,{view:0,detail:0}),GT=Ha(ac),Sd,Ed,nc,lf=g({},ac,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==nc&&(nc&&s.type==="mousemove"?(Sd=s.screenX-nc.screenX,Ed=s.screenY-nc.screenY):Ed=Sd=0,nc=s),Sd)},movementY:function(s){return"movementY"in s?s.movementY:Ed}}),ux=Ha(lf),qT=g({},lf,{dataTransfer:0}),YT=Ha(qT),XT=g({},ac,{relatedTarget:0}),Td=Ha(XT),KT=g({},Wi,{animationName:0,elapsedTime:0,pseudoElement:0}),JT=Ha(KT),QT=g({},Wi,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),ZT=Ha(QT),ek=g({},Wi,{data:0}),fx=Ha(ek),tk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ak={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nk(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=ak[s])?!!i[s]:!1}function kd(){return nk}var sk=g({},ac,{key:function(s){if(s.key){var i=tk[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=nf(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?rk[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kd,charCode:function(s){return s.type==="keypress"?nf(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?nf(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ik=Ha(sk),ok=g({},lf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dx=Ha(ok),lk=g({},ac,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kd}),ck=Ha(lk),uk=g({},Wi,{propertyName:0,elapsedTime:0,pseudoElement:0}),fk=Ha(uk),dk=g({},lf,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),hk=Ha(dk),mk=g({},Wi,{newState:0,oldState:0}),gk=Ha(mk),xk=[9,13,27,32],Ad=Es&&"CompositionEvent"in window,sc=null;Es&&"documentMode"in document&&(sc=document.documentMode);var vk=Es&&"TextEvent"in window&&!sc,hx=Es&&(!Ad||sc&&8<sc&&11>=sc),mx=" ",gx=!1;function xx(s,i){switch(s){case"keyup":return xk.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vx(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var zo=!1;function pk(s,i){switch(s){case"compositionend":return vx(i);case"keypress":return i.which!==32?null:(gx=!0,mx);case"textInput":return s=i.data,s===mx&&gx?null:s;default:return null}}function yk(s,i){if(zo)return s==="compositionend"||!Ad&&xx(s,i)?(s=lx(),af=bd=ei=null,zo=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return hx&&i.locale!=="ko"?null:i.data;default:return null}}var _k={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function px(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!_k[s.type]:i==="textarea"}function yx(s,i,c,d){Bo?Uo?Uo.push(d):Uo=[d]:Bo=d,i=Yf(i,"onChange"),0<i.length&&(c=new of("onChange","change",null,c,d),s.push({event:c,listeners:i}))}var ic=null,oc=null;function wk(s){Zp(s,0)}function cf(s){var i=me(s);if(ex(i))return s}function _x(s,i){if(s==="change")return i}var wx=!1;if(Es){var Cd;if(Es){var Nd="oninput"in document;if(!Nd){var bx=document.createElement("div");bx.setAttribute("oninput","return;"),Nd=typeof bx.oninput=="function"}Cd=Nd}else Cd=!1;wx=Cd&&(!document.documentMode||9<document.documentMode)}function Sx(){ic&&(ic.detachEvent("onpropertychange",Ex),oc=ic=null)}function Ex(s){if(s.propertyName==="value"&&cf(oc)){var i=[];yx(i,oc,s,yd(s)),ox(wk,i)}}function bk(s,i,c){s==="focusin"?(Sx(),ic=i,oc=c,ic.attachEvent("onpropertychange",Ex)):s==="focusout"&&Sx()}function Sk(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return cf(oc)}function Ek(s,i){if(s==="click")return cf(i)}function Tk(s,i){if(s==="input"||s==="change")return cf(i)}function kk(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Qa=typeof Object.is=="function"?Object.is:kk;function lc(s,i){if(Qa(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var c=Object.keys(s),d=Object.keys(i);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var x=c[d];if(!H.call(i,x)||!Qa(s[x],i[x]))return!1}return!0}function Tx(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function kx(s,i){var c=Tx(s);s=0;for(var d;c;){if(c.nodeType===3){if(d=s+c.textContent.length,s<=i&&d>=i)return{node:c,offset:i-s};s=d}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Tx(c)}}function Ax(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?Ax(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function Cx(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var i=tf(s.document);i instanceof s.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)s=i.contentWindow;else break;i=tf(s.document)}return i}function Dd(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}var Ak=Es&&"documentMode"in document&&11>=document.documentMode,Vo=null,Od=null,cc=null,Rd=!1;function Nx(s,i,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Rd||Vo==null||Vo!==tf(d)||(d=Vo,"selectionStart"in d&&Dd(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),cc&&lc(cc,d)||(cc=d,d=Yf(Od,"onSelect"),0<d.length&&(i=new of("onSelect","select",null,i,c),s.push({event:i,listeners:d}),i.target=Vo)))}function Gi(s,i){var c={};return c[s.toLowerCase()]=i.toLowerCase(),c["Webkit"+s]="webkit"+i,c["Moz"+s]="moz"+i,c}var Ho={animationend:Gi("Animation","AnimationEnd"),animationiteration:Gi("Animation","AnimationIteration"),animationstart:Gi("Animation","AnimationStart"),transitionrun:Gi("Transition","TransitionRun"),transitionstart:Gi("Transition","TransitionStart"),transitioncancel:Gi("Transition","TransitionCancel"),transitionend:Gi("Transition","TransitionEnd")},Fd={},Dx={};Es&&(Dx=document.createElement("div").style,"AnimationEvent"in window||(delete Ho.animationend.animation,delete Ho.animationiteration.animation,delete Ho.animationstart.animation),"TransitionEvent"in window||delete Ho.transitionend.transition);function qi(s){if(Fd[s])return Fd[s];if(!Ho[s])return s;var i=Ho[s],c;for(c in i)if(i.hasOwnProperty(c)&&c in Dx)return Fd[s]=i[c];return s}var Ox=qi("animationend"),Rx=qi("animationiteration"),Fx=qi("animationstart"),Ck=qi("transitionrun"),Nk=qi("transitionstart"),Dk=qi("transitioncancel"),Mx=qi("transitionend"),jx=new Map,Md="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Md.push("scrollEnd");function Hn(s,i){jx.set(s,i),Ue(i,[s])}var Ix=new WeakMap;function wn(s,i){if(typeof s=="object"&&s!==null){var c=Ix.get(s);return c!==void 0?c:(i={value:s,source:i,stack:Qg(i)},Ix.set(s,i),i)}return{value:s,source:i,stack:Qg(i)}}var bn=[],$o=0,jd=0;function uf(){for(var s=$o,i=jd=$o=0;i<s;){var c=bn[i];bn[i++]=null;var d=bn[i];bn[i++]=null;var x=bn[i];bn[i++]=null;var y=bn[i];if(bn[i++]=null,d!==null&&x!==null){var C=d.pending;C===null?x.next=x:(x.next=C.next,C.next=x),d.pending=x}y!==0&&Px(c,x,y)}}function ff(s,i,c,d){bn[$o++]=s,bn[$o++]=i,bn[$o++]=c,bn[$o++]=d,jd|=d,s.lanes|=d,s=s.alternate,s!==null&&(s.lanes|=d)}function Id(s,i,c,d){return ff(s,i,c,d),df(s)}function Wo(s,i){return ff(s,null,null,i),df(s)}function Px(s,i,c){s.lanes|=c;var d=s.alternate;d!==null&&(d.lanes|=c);for(var x=!1,y=s.return;y!==null;)y.childLanes|=c,d=y.alternate,d!==null&&(d.childLanes|=c),y.tag===22&&(s=y.stateNode,s===null||s._visibility&1||(x=!0)),s=y,y=y.return;return s.tag===3?(y=s.stateNode,x&&i!==null&&(x=31-ke(c),s=y.hiddenUpdates,d=s[x],d===null?s[x]=[i]:d.push(i),i.lane=c|536870912),y):null}function df(s){if(50<Mc)throw Mc=0,Vh=null,Error(a(185));for(var i=s.return;i!==null;)s=i,i=s.return;return s.tag===3?s.stateNode:null}var Go={};function Ok(s,i,c,d){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Za(s,i,c,d){return new Ok(s,i,c,d)}function Pd(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Ts(s,i){var c=s.alternate;return c===null?(c=Za(s.tag,i,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=i,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,i=s.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function Lx(s,i){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,i=c.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s}function hf(s,i,c,d,x,y){var C=0;if(d=s,typeof s=="function")Pd(s)&&(C=1);else if(typeof s=="string")C=FA(s,c,Y.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case j:return s=Za(31,c,i,x),s.elementType=j,s.lanes=y,s;case b:return Yi(c.children,x,y,i);case w:C=8,x|=24;break;case S:return s=Za(12,c,i,x|2),s.elementType=S,s.lanes=y,s;case M:return s=Za(13,c,i,x),s.elementType=M,s.lanes=y,s;case D:return s=Za(19,c,i,x),s.elementType=D,s.lanes=y,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case T:case k:C=10;break e;case N:C=9;break e;case E:C=11;break e;case A:C=14;break e;case B:C=16,d=null;break e}C=29,c=Error(a(130,s===null?"null":typeof s,"")),d=null}return i=Za(C,c,i,x),i.elementType=s,i.type=d,i.lanes=y,i}function Yi(s,i,c,d){return s=Za(7,s,d,i),s.lanes=c,s}function Ld(s,i,c){return s=Za(6,s,null,i),s.lanes=c,s}function Bd(s,i,c){return i=Za(4,s.children!==null?s.children:[],s.key,i),i.lanes=c,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}var qo=[],Yo=0,mf=null,gf=0,Sn=[],En=0,Xi=null,ks=1,As="";function Ki(s,i){qo[Yo++]=gf,qo[Yo++]=mf,mf=s,gf=i}function Bx(s,i,c){Sn[En++]=ks,Sn[En++]=As,Sn[En++]=Xi,Xi=s;var d=ks;s=As;var x=32-ke(d)-1;d&=~(1<<x),c+=1;var y=32-ke(i)+x;if(30<y){var C=x-x%5;y=(d&(1<<C)-1).toString(32),d>>=C,x-=C,ks=1<<32-ke(i)+x|c<<x|d,As=y+s}else ks=1<<y|c<<x|d,As=s}function Ud(s){s.return!==null&&(Ki(s,1),Bx(s,1,0))}function zd(s){for(;s===mf;)mf=qo[--Yo],qo[Yo]=null,gf=qo[--Yo],qo[Yo]=null;for(;s===Xi;)Xi=Sn[--En],Sn[En]=null,As=Sn[--En],Sn[En]=null,ks=Sn[--En],Sn[En]=null}var Ba=null,Pr=null,Qt=!1,Ji=null,ns=!1,Vd=Error(a(519));function Qi(s){var i=Error(a(418,""));throw dc(wn(i,s)),Vd}function Ux(s){var i=s.stateNode,c=s.type,d=s.memoizedProps;switch(i[Or]=s,i[er]=d,c){case"dialog":zt("cancel",i),zt("close",i);break;case"iframe":case"object":case"embed":zt("load",i);break;case"video":case"audio":for(c=0;c<Ic.length;c++)zt(Ic[c],i);break;case"source":zt("error",i);break;case"img":case"image":case"link":zt("error",i),zt("load",i);break;case"details":zt("toggle",i);break;case"input":zt("invalid",i),tx(i,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0),ef(i);break;case"select":zt("invalid",i);break;case"textarea":zt("invalid",i),ax(i,d.value,d.defaultValue,d.children),ef(i)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||d.suppressHydrationWarning===!0||ay(i.textContent,c)?(d.popover!=null&&(zt("beforetoggle",i),zt("toggle",i)),d.onScroll!=null&&zt("scroll",i),d.onScrollEnd!=null&&zt("scrollend",i),d.onClick!=null&&(i.onclick=Xf),i=!0):i=!1,i||Qi(s)}function zx(s){for(Ba=s.return;Ba;)switch(Ba.tag){case 5:case 13:ns=!1;return;case 27:case 3:ns=!0;return;default:Ba=Ba.return}}function uc(s){if(s!==Ba)return!1;if(!Qt)return zx(s),Qt=!0,!1;var i=s.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||nm(s.type,s.memoizedProps)),c=!c),c&&Pr&&Qi(s),zx(s),i===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(a(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8)if(c=s.data,c==="/$"){if(i===0){Pr=Wn(s.nextSibling);break e}i--}else c!=="$"&&c!=="$!"&&c!=="$?"||i++;s=s.nextSibling}Pr=null}}else i===27?(i=Pr,xi(s.type)?(s=lm,lm=null,Pr=s):Pr=i):Pr=Ba?Wn(s.stateNode.nextSibling):null;return!0}function fc(){Pr=Ba=null,Qt=!1}function Vx(){var s=Ji;return s!==null&&(Ga===null?Ga=s:Ga.push.apply(Ga,s),Ji=null),s}function dc(s){Ji===null?Ji=[s]:Ji.push(s)}var Hd=De(null),Zi=null,Cs=null;function ti(s,i,c){X(Hd,i._currentValue),i._currentValue=c}function Ns(s){s._currentValue=Hd.current,P(Hd)}function $d(s,i,c){for(;s!==null;){var d=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,d!==null&&(d.childLanes|=i)):d!==null&&(d.childLanes&i)!==i&&(d.childLanes|=i),s===c)break;s=s.return}}function Wd(s,i,c,d){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var y=x.dependencies;if(y!==null){var C=x.child;y=y.firstContext;e:for(;y!==null;){var F=y;y=x;for(var te=0;te<i.length;te++)if(F.context===i[te]){y.lanes|=c,F=y.alternate,F!==null&&(F.lanes|=c),$d(y.return,c,s),d||(C=null);break e}y=F.next}}else if(x.tag===18){if(C=x.return,C===null)throw Error(a(341));C.lanes|=c,y=C.alternate,y!==null&&(y.lanes|=c),$d(C,c,s),C=null}else C=x.child;if(C!==null)C.return=x;else for(C=x;C!==null;){if(C===s){C=null;break}if(x=C.sibling,x!==null){x.return=C.return,C=x;break}C=C.return}x=C}}function hc(s,i,c,d){s=null;for(var x=i,y=!1;x!==null;){if(!y){if((x.flags&524288)!==0)y=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var C=x.alternate;if(C===null)throw Error(a(387));if(C=C.memoizedProps,C!==null){var F=x.type;Qa(x.pendingProps.value,C.value)||(s!==null?s.push(F):s=[F])}}else if(x===Fe.current){if(C=x.alternate,C===null)throw Error(a(387));C.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(Vc):s=[Vc])}x=x.return}s!==null&&Wd(i,s,c,d),i.flags|=262144}function xf(s){for(s=s.firstContext;s!==null;){if(!Qa(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function eo(s){Zi=s,Cs=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Aa(s){return Hx(Zi,s)}function vf(s,i){return Zi===null&&eo(s),Hx(s,i)}function Hx(s,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},Cs===null){if(s===null)throw Error(a(308));Cs=i,s.dependencies={lanes:0,firstContext:i},s.flags|=524288}else Cs=Cs.next=i;return c}var Rk=typeof AbortController<"u"?AbortController:function(){var s=[],i=this.signal={aborted:!1,addEventListener:function(c,d){s.push(d)}};this.abort=function(){i.aborted=!0,s.forEach(function(c){return c()})}},Fk=e.unstable_scheduleCallback,Mk=e.unstable_NormalPriority,na={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Gd(){return{controller:new Rk,data:new Map,refCount:0}}function mc(s){s.refCount--,s.refCount===0&&Fk(Mk,function(){s.controller.abort()})}var gc=null,qd=0,Xo=0,Ko=null;function jk(s,i){if(gc===null){var c=gc=[];qd=0,Xo=Xh(),Ko={status:"pending",value:void 0,then:function(d){c.push(d)}}}return qd++,i.then($x,$x),i}function $x(){if(--qd===0&&gc!==null){Ko!==null&&(Ko.status="fulfilled");var s=gc;gc=null,Xo=0,Ko=null;for(var i=0;i<s.length;i++)(0,s[i])()}}function Ik(s,i){var c=[],d={status:"pending",value:null,reason:null,then:function(x){c.push(x)}};return s.then(function(){d.status="fulfilled",d.value=i;for(var x=0;x<c.length;x++)(0,c[x])(i)},function(x){for(d.status="rejected",d.reason=x,x=0;x<c.length;x++)(0,c[x])(void 0)}),d}var Wx=q.S;q.S=function(s,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&jk(s,i),Wx!==null&&Wx(s,i)};var to=De(null);function Yd(){var s=to.current;return s!==null?s:_r.pooledCache}function pf(s,i){i===null?X(to,to.current):X(to,i.pool)}function Gx(){var s=Yd();return s===null?null:{parent:na._currentValue,pool:s}}var xc=Error(a(460)),qx=Error(a(474)),yf=Error(a(542)),Xd={then:function(){}};function Yx(s){return s=s.status,s==="fulfilled"||s==="rejected"}function _f(){}function Xx(s,i,c){switch(c=s[c],c===void 0?s.push(i):c!==i&&(i.then(_f,_f),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,Jx(s),s;default:if(typeof i.status=="string")i.then(_f,_f);else{if(s=_r,s!==null&&100<s.shellSuspendCounter)throw Error(a(482));s=i,s.status="pending",s.then(function(d){if(i.status==="pending"){var x=i;x.status="fulfilled",x.value=d}},function(d){if(i.status==="pending"){var x=i;x.status="rejected",x.reason=d}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,Jx(s),s}throw vc=i,xc}}var vc=null;function Kx(){if(vc===null)throw Error(a(459));var s=vc;return vc=null,s}function Jx(s){if(s===xc||s===yf)throw Error(a(483))}var ri=!1;function Kd(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jd(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function ai(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function ni(s,i,c){var d=s.updateQueue;if(d===null)return null;if(d=d.shared,(tr&2)!==0){var x=d.pending;return x===null?i.next=i:(i.next=x.next,x.next=i),d.pending=i,i=df(s),Px(s,null,c),i}return ff(s,d,i,c),df(s)}function pc(s,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var d=i.lanes;d&=s.pendingLanes,c|=d,i.lanes=c,je(s,c)}}function Qd(s,i){var c=s.updateQueue,d=s.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var x=null,y=null;if(c=c.firstBaseUpdate,c!==null){do{var C={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};y===null?x=y=C:y=y.next=C,c=c.next}while(c!==null);y===null?x=y=i:y=y.next=i}else x=y=i;c={baseState:d.baseState,firstBaseUpdate:x,lastBaseUpdate:y,shared:d.shared,callbacks:d.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=i:s.next=i,c.lastBaseUpdate=i}var Zd=!1;function yc(){if(Zd){var s=Ko;if(s!==null)throw s}}function _c(s,i,c,d){Zd=!1;var x=s.updateQueue;ri=!1;var y=x.firstBaseUpdate,C=x.lastBaseUpdate,F=x.shared.pending;if(F!==null){x.shared.pending=null;var te=F,he=te.next;te.next=null,C===null?y=he:C.next=he,C=te;var Me=s.alternate;Me!==null&&(Me=Me.updateQueue,F=Me.lastBaseUpdate,F!==C&&(F===null?Me.firstBaseUpdate=he:F.next=he,Me.lastBaseUpdate=te))}if(y!==null){var Le=x.baseState;C=0,Me=he=te=null,F=y;do{var pe=F.lane&-536870913,we=pe!==F.lane;if(we?(Gt&pe)===pe:(d&pe)===pe){pe!==0&&pe===Xo&&(Zd=!0),Me!==null&&(Me=Me.next={lane:0,tag:F.tag,payload:F.payload,callback:null,next:null});e:{var St=s,vt=F;pe=i;var hr=c;switch(vt.tag){case 1:if(St=vt.payload,typeof St=="function"){Le=St.call(hr,Le,pe);break e}Le=St;break e;case 3:St.flags=St.flags&-65537|128;case 0:if(St=vt.payload,pe=typeof St=="function"?St.call(hr,Le,pe):St,pe==null)break e;Le=g({},Le,pe);break e;case 2:ri=!0}}pe=F.callback,pe!==null&&(s.flags|=64,we&&(s.flags|=8192),we=x.callbacks,we===null?x.callbacks=[pe]:we.push(pe))}else we={lane:pe,tag:F.tag,payload:F.payload,callback:F.callback,next:null},Me===null?(he=Me=we,te=Le):Me=Me.next=we,C|=pe;if(F=F.next,F===null){if(F=x.shared.pending,F===null)break;we=F,F=we.next,we.next=null,x.lastBaseUpdate=we,x.shared.pending=null}}while(!0);Me===null&&(te=Le),x.baseState=te,x.firstBaseUpdate=he,x.lastBaseUpdate=Me,y===null&&(x.shared.lanes=0),di|=C,s.lanes=C,s.memoizedState=Le}}function Qx(s,i){if(typeof s!="function")throw Error(a(191,s));s.call(i)}function Zx(s,i){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)Qx(c[s],i)}var Jo=De(null),wf=De(0);function ev(s,i){s=Is,X(wf,s),X(Jo,i),Is=s|i.baseLanes}function eh(){X(wf,Is),X(Jo,Jo.current)}function th(){Is=wf.current,P(Jo),P(wf)}var si=0,It=null,fr=null,Kr=null,bf=!1,Qo=!1,ro=!1,Sf=0,wc=0,Zo=null,Pk=0;function Hr(){throw Error(a(321))}function rh(s,i){if(i===null)return!1;for(var c=0;c<i.length&&c<s.length;c++)if(!Qa(s[c],i[c]))return!1;return!0}function ah(s,i,c,d,x,y){return si=y,It=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,q.H=s===null||s.memoizedState===null?Pv:Lv,ro=!1,y=c(d,x),ro=!1,Qo&&(y=rv(i,c,d,x)),tv(s),y}function tv(s){q.H=Nf;var i=fr!==null&&fr.next!==null;if(si=0,Kr=fr=It=null,bf=!1,wc=0,Zo=null,i)throw Error(a(300));s===null||ca||(s=s.dependencies,s!==null&&xf(s)&&(ca=!0))}function rv(s,i,c,d){It=s;var x=0;do{if(Qo&&(Zo=null),wc=0,Qo=!1,25<=x)throw Error(a(301));if(x+=1,Kr=fr=null,s.updateQueue!=null){var y=s.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}q.H=$k,y=i(c,d)}while(Qo);return y}function Lk(){var s=q.H,i=s.useState()[0];return i=typeof i.then=="function"?bc(i):i,s=s.useState()[0],(fr!==null?fr.memoizedState:null)!==s&&(It.flags|=1024),i}function nh(){var s=Sf!==0;return Sf=0,s}function sh(s,i,c){i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~c}function ih(s){if(bf){for(s=s.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}bf=!1}si=0,Kr=fr=It=null,Qo=!1,wc=Sf=0,Zo=null}function $a(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kr===null?It.memoizedState=Kr=s:Kr=Kr.next=s,Kr}function Jr(){if(fr===null){var s=It.alternate;s=s!==null?s.memoizedState:null}else s=fr.next;var i=Kr===null?It.memoizedState:Kr.next;if(i!==null)Kr=i,fr=s;else{if(s===null)throw It.alternate===null?Error(a(467)):Error(a(310));fr=s,s={memoizedState:fr.memoizedState,baseState:fr.baseState,baseQueue:fr.baseQueue,queue:fr.queue,next:null},Kr===null?It.memoizedState=Kr=s:Kr=Kr.next=s}return Kr}function oh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function bc(s){var i=wc;return wc+=1,Zo===null&&(Zo=[]),s=Xx(Zo,s,i),i=It,(Kr===null?i.memoizedState:Kr.next)===null&&(i=i.alternate,q.H=i===null||i.memoizedState===null?Pv:Lv),s}function Ef(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return bc(s);if(s.$$typeof===k)return Aa(s)}throw Error(a(438,String(s)))}function lh(s){var i=null,c=It.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var d=It.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(i={data:d.data.map(function(x){return x.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=oh(),It.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(s),d=0;d<s;d++)c[d]=ee;return i.index++,c}function Ds(s,i){return typeof i=="function"?i(s):i}function Tf(s){var i=Jr();return ch(i,fr,s)}function ch(s,i,c){var d=s.queue;if(d===null)throw Error(a(311));d.lastRenderedReducer=c;var x=s.baseQueue,y=d.pending;if(y!==null){if(x!==null){var C=x.next;x.next=y.next,y.next=C}i.baseQueue=x=y,d.pending=null}if(y=s.baseState,x===null)s.memoizedState=y;else{i=x.next;var F=C=null,te=null,he=i,Me=!1;do{var Le=he.lane&-536870913;if(Le!==he.lane?(Gt&Le)===Le:(si&Le)===Le){var pe=he.revertLane;if(pe===0)te!==null&&(te=te.next={lane:0,revertLane:0,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null}),Le===Xo&&(Me=!0);else if((si&pe)===pe){he=he.next,pe===Xo&&(Me=!0);continue}else Le={lane:0,revertLane:he.revertLane,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},te===null?(F=te=Le,C=y):te=te.next=Le,It.lanes|=pe,di|=pe;Le=he.action,ro&&c(y,Le),y=he.hasEagerState?he.eagerState:c(y,Le)}else pe={lane:Le,revertLane:he.revertLane,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},te===null?(F=te=pe,C=y):te=te.next=pe,It.lanes|=Le,di|=Le;he=he.next}while(he!==null&&he!==i);if(te===null?C=y:te.next=F,!Qa(y,s.memoizedState)&&(ca=!0,Me&&(c=Ko,c!==null)))throw c;s.memoizedState=y,s.baseState=C,s.baseQueue=te,d.lastRenderedState=y}return x===null&&(d.lanes=0),[s.memoizedState,d.dispatch]}function uh(s){var i=Jr(),c=i.queue;if(c===null)throw Error(a(311));c.lastRenderedReducer=s;var d=c.dispatch,x=c.pending,y=i.memoizedState;if(x!==null){c.pending=null;var C=x=x.next;do y=s(y,C.action),C=C.next;while(C!==x);Qa(y,i.memoizedState)||(ca=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),c.lastRenderedState=y}return[y,d]}function av(s,i,c){var d=It,x=Jr(),y=Qt;if(y){if(c===void 0)throw Error(a(407));c=c()}else c=i();var C=!Qa((fr||x).memoizedState,c);C&&(x.memoizedState=c,ca=!0),x=x.queue;var F=iv.bind(null,d,x,s);if(Sc(2048,8,F,[s]),x.getSnapshot!==i||C||Kr!==null&&Kr.memoizedState.tag&1){if(d.flags|=2048,el(9,kf(),sv.bind(null,d,x,c,i),null),_r===null)throw Error(a(349));y||(si&124)!==0||nv(d,i,c)}return c}function nv(s,i,c){s.flags|=16384,s={getSnapshot:i,value:c},i=It.updateQueue,i===null?(i=oh(),It.updateQueue=i,i.stores=[s]):(c=i.stores,c===null?i.stores=[s]:c.push(s))}function sv(s,i,c,d){i.value=c,i.getSnapshot=d,ov(i)&&lv(s)}function iv(s,i,c){return c(function(){ov(i)&&lv(s)})}function ov(s){var i=s.getSnapshot;s=s.value;try{var c=i();return!Qa(s,c)}catch{return!0}}function lv(s){var i=Wo(s,2);i!==null&&nn(i,s,2)}function fh(s){var i=$a();if(typeof s=="function"){var c=s;if(s=c(),ro){rt(!0);try{c()}finally{rt(!1)}}}return i.memoizedState=i.baseState=s,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ds,lastRenderedState:s},i}function cv(s,i,c,d){return s.baseState=c,ch(s,fr,typeof d=="function"?d:Ds)}function Bk(s,i,c,d,x){if(Cf(s))throw Error(a(485));if(s=i.action,s!==null){var y={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(C){y.listeners.push(C)}};q.T!==null?c(!0):y.isTransition=!1,d(y),c=i.pending,c===null?(y.next=i.pending=y,uv(i,y)):(y.next=c.next,i.pending=c.next=y)}}function uv(s,i){var c=i.action,d=i.payload,x=s.state;if(i.isTransition){var y=q.T,C={};q.T=C;try{var F=c(x,d),te=q.S;te!==null&&te(C,F),fv(s,i,F)}catch(he){dh(s,i,he)}finally{q.T=y}}else try{y=c(x,d),fv(s,i,y)}catch(he){dh(s,i,he)}}function fv(s,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){dv(s,i,d)},function(d){return dh(s,i,d)}):dv(s,i,c)}function dv(s,i,c){i.status="fulfilled",i.value=c,hv(i),s.state=c,i=s.pending,i!==null&&(c=i.next,c===i?s.pending=null:(c=c.next,i.next=c,uv(s,c)))}function dh(s,i,c){var d=s.pending;if(s.pending=null,d!==null){d=d.next;do i.status="rejected",i.reason=c,hv(i),i=i.next;while(i!==d)}s.action=null}function hv(s){s=s.listeners;for(var i=0;i<s.length;i++)(0,s[i])()}function mv(s,i){return i}function gv(s,i){if(Qt){var c=_r.formState;if(c!==null){e:{var d=It;if(Qt){if(Pr){t:{for(var x=Pr,y=ns;x.nodeType!==8;){if(!y){x=null;break t}if(x=Wn(x.nextSibling),x===null){x=null;break t}}y=x.data,x=y==="F!"||y==="F"?x:null}if(x){Pr=Wn(x.nextSibling),d=x.data==="F!";break e}}Qi(d)}d=!1}d&&(i=c[0])}}return c=$a(),c.memoizedState=c.baseState=i,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mv,lastRenderedState:i},c.queue=d,c=Mv.bind(null,It,d),d.dispatch=c,d=fh(!1),y=vh.bind(null,It,!1,d.queue),d=$a(),x={state:i,dispatch:null,action:s,pending:null},d.queue=x,c=Bk.bind(null,It,x,y,c),x.dispatch=c,d.memoizedState=s,[i,c,!1]}function xv(s){var i=Jr();return vv(i,fr,s)}function vv(s,i,c){if(i=ch(s,i,mv)[0],s=Tf(Ds)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var d=bc(i)}catch(C){throw C===xc?yf:C}else d=i;i=Jr();var x=i.queue,y=x.dispatch;return c!==i.memoizedState&&(It.flags|=2048,el(9,kf(),Uk.bind(null,x,c),null)),[d,y,s]}function Uk(s,i){s.action=i}function pv(s){var i=Jr(),c=fr;if(c!==null)return vv(i,c,s);Jr(),i=i.memoizedState,c=Jr();var d=c.queue.dispatch;return c.memoizedState=s,[i,d,!1]}function el(s,i,c,d){return s={tag:s,create:c,deps:d,inst:i,next:null},i=It.updateQueue,i===null&&(i=oh(),It.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=s.next=s:(d=c.next,c.next=s,s.next=d,i.lastEffect=s),s}function kf(){return{destroy:void 0,resource:void 0}}function yv(){return Jr().memoizedState}function Af(s,i,c,d){var x=$a();d=d===void 0?null:d,It.flags|=s,x.memoizedState=el(1|i,kf(),c,d)}function Sc(s,i,c,d){var x=Jr();d=d===void 0?null:d;var y=x.memoizedState.inst;fr!==null&&d!==null&&rh(d,fr.memoizedState.deps)?x.memoizedState=el(i,y,c,d):(It.flags|=s,x.memoizedState=el(1|i,y,c,d))}function _v(s,i){Af(8390656,8,s,i)}function wv(s,i){Sc(2048,8,s,i)}function bv(s,i){return Sc(4,2,s,i)}function Sv(s,i){return Sc(4,4,s,i)}function Ev(s,i){if(typeof i=="function"){s=s();var c=i(s);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function Tv(s,i,c){c=c!=null?c.concat([s]):null,Sc(4,4,Ev.bind(null,i,s),c)}function hh(){}function kv(s,i){var c=Jr();i=i===void 0?null:i;var d=c.memoizedState;return i!==null&&rh(i,d[1])?d[0]:(c.memoizedState=[s,i],s)}function Av(s,i){var c=Jr();i=i===void 0?null:i;var d=c.memoizedState;if(i!==null&&rh(i,d[1]))return d[0];if(d=s(),ro){rt(!0);try{s()}finally{rt(!1)}}return c.memoizedState=[d,i],d}function mh(s,i,c){return c===void 0||(si&1073741824)!==0?s.memoizedState=i:(s.memoizedState=c,s=Dp(),It.lanes|=s,di|=s,c)}function Cv(s,i,c,d){return Qa(c,i)?c:Jo.current!==null?(s=mh(s,c,d),Qa(s,i)||(ca=!0),s):(si&42)===0?(ca=!0,s.memoizedState=c):(s=Dp(),It.lanes|=s,di|=s,i)}function Nv(s,i,c,d,x){var y=ae.p;ae.p=y!==0&&8>y?y:8;var C=q.T,F={};q.T=F,vh(s,!1,i,c);try{var te=x(),he=q.S;if(he!==null&&he(F,te),te!==null&&typeof te=="object"&&typeof te.then=="function"){var Me=Ik(te,d);Ec(s,i,Me,an(s))}else Ec(s,i,d,an(s))}catch(Le){Ec(s,i,{then:function(){},status:"rejected",reason:Le},an())}finally{ae.p=y,q.T=C}}function zk(){}function gh(s,i,c,d){if(s.tag!==5)throw Error(a(476));var x=Dv(s).queue;Nv(s,x,i,be,c===null?zk:function(){return Ov(s),c(d)})}function Dv(s){var i=s.memoizedState;if(i!==null)return i;i={memoizedState:be,baseState:be,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ds,lastRenderedState:be},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ds,lastRenderedState:c},next:null},s.memoizedState=i,s=s.alternate,s!==null&&(s.memoizedState=i),i}function Ov(s){var i=Dv(s).next.queue;Ec(s,i,{},an())}function xh(){return Aa(Vc)}function Rv(){return Jr().memoizedState}function Fv(){return Jr().memoizedState}function Vk(s){for(var i=s.return;i!==null;){switch(i.tag){case 24:case 3:var c=an();s=ai(c);var d=ni(i,s,c);d!==null&&(nn(d,i,c),pc(d,i,c)),i={cache:Gd()},s.payload=i;return}i=i.return}}function Hk(s,i,c){var d=an();c={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},Cf(s)?jv(i,c):(c=Id(s,i,c,d),c!==null&&(nn(c,s,d),Iv(c,i,d)))}function Mv(s,i,c){var d=an();Ec(s,i,c,d)}function Ec(s,i,c,d){var x={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(Cf(s))jv(i,x);else{var y=s.alternate;if(s.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var C=i.lastRenderedState,F=y(C,c);if(x.hasEagerState=!0,x.eagerState=F,Qa(F,C))return ff(s,i,x,0),_r===null&&uf(),!1}catch{}finally{}if(c=Id(s,i,x,d),c!==null)return nn(c,s,d),Iv(c,i,d),!0}return!1}function vh(s,i,c,d){if(d={lane:2,revertLane:Xh(),action:d,hasEagerState:!1,eagerState:null,next:null},Cf(s)){if(i)throw Error(a(479))}else i=Id(s,c,d,2),i!==null&&nn(i,s,2)}function Cf(s){var i=s.alternate;return s===It||i!==null&&i===It}function jv(s,i){Qo=bf=!0;var c=s.pending;c===null?i.next=i:(i.next=c.next,c.next=i),s.pending=i}function Iv(s,i,c){if((c&4194048)!==0){var d=i.lanes;d&=s.pendingLanes,c|=d,i.lanes=c,je(s,c)}}var Nf={readContext:Aa,use:Ef,useCallback:Hr,useContext:Hr,useEffect:Hr,useImperativeHandle:Hr,useLayoutEffect:Hr,useInsertionEffect:Hr,useMemo:Hr,useReducer:Hr,useRef:Hr,useState:Hr,useDebugValue:Hr,useDeferredValue:Hr,useTransition:Hr,useSyncExternalStore:Hr,useId:Hr,useHostTransitionStatus:Hr,useFormState:Hr,useActionState:Hr,useOptimistic:Hr,useMemoCache:Hr,useCacheRefresh:Hr},Pv={readContext:Aa,use:Ef,useCallback:function(s,i){return $a().memoizedState=[s,i===void 0?null:i],s},useContext:Aa,useEffect:_v,useImperativeHandle:function(s,i,c){c=c!=null?c.concat([s]):null,Af(4194308,4,Ev.bind(null,i,s),c)},useLayoutEffect:function(s,i){return Af(4194308,4,s,i)},useInsertionEffect:function(s,i){Af(4,2,s,i)},useMemo:function(s,i){var c=$a();i=i===void 0?null:i;var d=s();if(ro){rt(!0);try{s()}finally{rt(!1)}}return c.memoizedState=[d,i],d},useReducer:function(s,i,c){var d=$a();if(c!==void 0){var x=c(i);if(ro){rt(!0);try{c(i)}finally{rt(!1)}}}else x=i;return d.memoizedState=d.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},d.queue=s,s=s.dispatch=Hk.bind(null,It,s),[d.memoizedState,s]},useRef:function(s){var i=$a();return s={current:s},i.memoizedState=s},useState:function(s){s=fh(s);var i=s.queue,c=Mv.bind(null,It,i);return i.dispatch=c,[s.memoizedState,c]},useDebugValue:hh,useDeferredValue:function(s,i){var c=$a();return mh(c,s,i)},useTransition:function(){var s=fh(!1);return s=Nv.bind(null,It,s.queue,!0,!1),$a().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,i,c){var d=It,x=$a();if(Qt){if(c===void 0)throw Error(a(407));c=c()}else{if(c=i(),_r===null)throw Error(a(349));(Gt&124)!==0||nv(d,i,c)}x.memoizedState=c;var y={value:c,getSnapshot:i};return x.queue=y,_v(iv.bind(null,d,y,s),[s]),d.flags|=2048,el(9,kf(),sv.bind(null,d,y,c,i),null),c},useId:function(){var s=$a(),i=_r.identifierPrefix;if(Qt){var c=As,d=ks;c=(d&~(1<<32-ke(d)-1)).toString(32)+c,i=""+i+"R"+c,c=Sf++,0<c&&(i+="H"+c.toString(32)),i+=""}else c=Pk++,i=""+i+"r"+c.toString(32)+"";return s.memoizedState=i},useHostTransitionStatus:xh,useFormState:gv,useActionState:gv,useOptimistic:function(s){var i=$a();i.memoizedState=i.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=vh.bind(null,It,!0,c),c.dispatch=i,[s,i]},useMemoCache:lh,useCacheRefresh:function(){return $a().memoizedState=Vk.bind(null,It)}},Lv={readContext:Aa,use:Ef,useCallback:kv,useContext:Aa,useEffect:wv,useImperativeHandle:Tv,useInsertionEffect:bv,useLayoutEffect:Sv,useMemo:Av,useReducer:Tf,useRef:yv,useState:function(){return Tf(Ds)},useDebugValue:hh,useDeferredValue:function(s,i){var c=Jr();return Cv(c,fr.memoizedState,s,i)},useTransition:function(){var s=Tf(Ds)[0],i=Jr().memoizedState;return[typeof s=="boolean"?s:bc(s),i]},useSyncExternalStore:av,useId:Rv,useHostTransitionStatus:xh,useFormState:xv,useActionState:xv,useOptimistic:function(s,i){var c=Jr();return cv(c,fr,s,i)},useMemoCache:lh,useCacheRefresh:Fv},$k={readContext:Aa,use:Ef,useCallback:kv,useContext:Aa,useEffect:wv,useImperativeHandle:Tv,useInsertionEffect:bv,useLayoutEffect:Sv,useMemo:Av,useReducer:uh,useRef:yv,useState:function(){return uh(Ds)},useDebugValue:hh,useDeferredValue:function(s,i){var c=Jr();return fr===null?mh(c,s,i):Cv(c,fr.memoizedState,s,i)},useTransition:function(){var s=uh(Ds)[0],i=Jr().memoizedState;return[typeof s=="boolean"?s:bc(s),i]},useSyncExternalStore:av,useId:Rv,useHostTransitionStatus:xh,useFormState:pv,useActionState:pv,useOptimistic:function(s,i){var c=Jr();return fr!==null?cv(c,fr,s,i):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:lh,useCacheRefresh:Fv},tl=null,Tc=0;function Df(s){var i=Tc;return Tc+=1,tl===null&&(tl=[]),Xx(tl,s,i)}function kc(s,i){i=i.props.ref,s.ref=i!==void 0?i:null}function Of(s,i){throw i.$$typeof===v?Error(a(525)):(s=Object.prototype.toString.call(i),Error(a(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)))}function Bv(s){var i=s._init;return i(s._payload)}function Uv(s){function i(oe,se){if(s){var ue=oe.deletions;ue===null?(oe.deletions=[se],oe.flags|=16):ue.push(se)}}function c(oe,se){if(!s)return null;for(;se!==null;)i(oe,se),se=se.sibling;return null}function d(oe){for(var se=new Map;oe!==null;)oe.key!==null?se.set(oe.key,oe):se.set(oe.index,oe),oe=oe.sibling;return se}function x(oe,se){return oe=Ts(oe,se),oe.index=0,oe.sibling=null,oe}function y(oe,se,ue){return oe.index=ue,s?(ue=oe.alternate,ue!==null?(ue=ue.index,ue<se?(oe.flags|=67108866,se):ue):(oe.flags|=67108866,se)):(oe.flags|=1048576,se)}function C(oe){return s&&oe.alternate===null&&(oe.flags|=67108866),oe}function F(oe,se,ue,Ie){return se===null||se.tag!==6?(se=Ld(ue,oe.mode,Ie),se.return=oe,se):(se=x(se,ue),se.return=oe,se)}function te(oe,se,ue,Ie){var it=ue.type;return it===b?Me(oe,se,ue.props.children,Ie,ue.key):se!==null&&(se.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===B&&Bv(it)===se.type)?(se=x(se,ue.props),kc(se,ue),se.return=oe,se):(se=hf(ue.type,ue.key,ue.props,null,oe.mode,Ie),kc(se,ue),se.return=oe,se)}function he(oe,se,ue,Ie){return se===null||se.tag!==4||se.stateNode.containerInfo!==ue.containerInfo||se.stateNode.implementation!==ue.implementation?(se=Bd(ue,oe.mode,Ie),se.return=oe,se):(se=x(se,ue.children||[]),se.return=oe,se)}function Me(oe,se,ue,Ie,it){return se===null||se.tag!==7?(se=Yi(ue,oe.mode,Ie,it),se.return=oe,se):(se=x(se,ue),se.return=oe,se)}function Le(oe,se,ue){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return se=Ld(""+se,oe.mode,ue),se.return=oe,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case p:return ue=hf(se.type,se.key,se.props,null,oe.mode,ue),kc(ue,se),ue.return=oe,ue;case _:return se=Bd(se,oe.mode,ue),se.return=oe,se;case B:var Ie=se._init;return se=Ie(se._payload),Le(oe,se,ue)}if(ie(se)||U(se))return se=Yi(se,oe.mode,ue,null),se.return=oe,se;if(typeof se.then=="function")return Le(oe,Df(se),ue);if(se.$$typeof===k)return Le(oe,vf(oe,se),ue);Of(oe,se)}return null}function pe(oe,se,ue,Ie){var it=se!==null?se.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return it!==null?null:F(oe,se,""+ue,Ie);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case p:return ue.key===it?te(oe,se,ue,Ie):null;case _:return ue.key===it?he(oe,se,ue,Ie):null;case B:return it=ue._init,ue=it(ue._payload),pe(oe,se,ue,Ie)}if(ie(ue)||U(ue))return it!==null?null:Me(oe,se,ue,Ie,null);if(typeof ue.then=="function")return pe(oe,se,Df(ue),Ie);if(ue.$$typeof===k)return pe(oe,se,vf(oe,ue),Ie);Of(oe,ue)}return null}function we(oe,se,ue,Ie,it){if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint")return oe=oe.get(ue)||null,F(se,oe,""+Ie,it);if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case p:return oe=oe.get(Ie.key===null?ue:Ie.key)||null,te(se,oe,Ie,it);case _:return oe=oe.get(Ie.key===null?ue:Ie.key)||null,he(se,oe,Ie,it);case B:var Lt=Ie._init;return Ie=Lt(Ie._payload),we(oe,se,ue,Ie,it)}if(ie(Ie)||U(Ie))return oe=oe.get(ue)||null,Me(se,oe,Ie,it,null);if(typeof Ie.then=="function")return we(oe,se,ue,Df(Ie),it);if(Ie.$$typeof===k)return we(oe,se,ue,vf(se,Ie),it);Of(se,Ie)}return null}function St(oe,se,ue,Ie){for(var it=null,Lt=null,dt=se,pt=se=0,fa=null;dt!==null&&pt<ue.length;pt++){dt.index>pt?(fa=dt,dt=null):fa=dt.sibling;var Kt=pe(oe,dt,ue[pt],Ie);if(Kt===null){dt===null&&(dt=fa);break}s&&dt&&Kt.alternate===null&&i(oe,dt),se=y(Kt,se,pt),Lt===null?it=Kt:Lt.sibling=Kt,Lt=Kt,dt=fa}if(pt===ue.length)return c(oe,dt),Qt&&Ki(oe,pt),it;if(dt===null){for(;pt<ue.length;pt++)dt=Le(oe,ue[pt],Ie),dt!==null&&(se=y(dt,se,pt),Lt===null?it=dt:Lt.sibling=dt,Lt=dt);return Qt&&Ki(oe,pt),it}for(dt=d(dt);pt<ue.length;pt++)fa=we(dt,oe,pt,ue[pt],Ie),fa!==null&&(s&&fa.alternate!==null&&dt.delete(fa.key===null?pt:fa.key),se=y(fa,se,pt),Lt===null?it=fa:Lt.sibling=fa,Lt=fa);return s&&dt.forEach(function(wi){return i(oe,wi)}),Qt&&Ki(oe,pt),it}function vt(oe,se,ue,Ie){if(ue==null)throw Error(a(151));for(var it=null,Lt=null,dt=se,pt=se=0,fa=null,Kt=ue.next();dt!==null&&!Kt.done;pt++,Kt=ue.next()){dt.index>pt?(fa=dt,dt=null):fa=dt.sibling;var wi=pe(oe,dt,Kt.value,Ie);if(wi===null){dt===null&&(dt=fa);break}s&&dt&&wi.alternate===null&&i(oe,dt),se=y(wi,se,pt),Lt===null?it=wi:Lt.sibling=wi,Lt=wi,dt=fa}if(Kt.done)return c(oe,dt),Qt&&Ki(oe,pt),it;if(dt===null){for(;!Kt.done;pt++,Kt=ue.next())Kt=Le(oe,Kt.value,Ie),Kt!==null&&(se=y(Kt,se,pt),Lt===null?it=Kt:Lt.sibling=Kt,Lt=Kt);return Qt&&Ki(oe,pt),it}for(dt=d(dt);!Kt.done;pt++,Kt=ue.next())Kt=we(dt,oe,pt,Kt.value,Ie),Kt!==null&&(s&&Kt.alternate!==null&&dt.delete(Kt.key===null?pt:Kt.key),se=y(Kt,se,pt),Lt===null?it=Kt:Lt.sibling=Kt,Lt=Kt);return s&&dt.forEach(function(WA){return i(oe,WA)}),Qt&&Ki(oe,pt),it}function hr(oe,se,ue,Ie){if(typeof ue=="object"&&ue!==null&&ue.type===b&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case p:e:{for(var it=ue.key;se!==null;){if(se.key===it){if(it=ue.type,it===b){if(se.tag===7){c(oe,se.sibling),Ie=x(se,ue.props.children),Ie.return=oe,oe=Ie;break e}}else if(se.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===B&&Bv(it)===se.type){c(oe,se.sibling),Ie=x(se,ue.props),kc(Ie,ue),Ie.return=oe,oe=Ie;break e}c(oe,se);break}else i(oe,se);se=se.sibling}ue.type===b?(Ie=Yi(ue.props.children,oe.mode,Ie,ue.key),Ie.return=oe,oe=Ie):(Ie=hf(ue.type,ue.key,ue.props,null,oe.mode,Ie),kc(Ie,ue),Ie.return=oe,oe=Ie)}return C(oe);case _:e:{for(it=ue.key;se!==null;){if(se.key===it)if(se.tag===4&&se.stateNode.containerInfo===ue.containerInfo&&se.stateNode.implementation===ue.implementation){c(oe,se.sibling),Ie=x(se,ue.children||[]),Ie.return=oe,oe=Ie;break e}else{c(oe,se);break}else i(oe,se);se=se.sibling}Ie=Bd(ue,oe.mode,Ie),Ie.return=oe,oe=Ie}return C(oe);case B:return it=ue._init,ue=it(ue._payload),hr(oe,se,ue,Ie)}if(ie(ue))return St(oe,se,ue,Ie);if(U(ue)){if(it=U(ue),typeof it!="function")throw Error(a(150));return ue=it.call(ue),vt(oe,se,ue,Ie)}if(typeof ue.then=="function")return hr(oe,se,Df(ue),Ie);if(ue.$$typeof===k)return hr(oe,se,vf(oe,ue),Ie);Of(oe,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint"?(ue=""+ue,se!==null&&se.tag===6?(c(oe,se.sibling),Ie=x(se,ue),Ie.return=oe,oe=Ie):(c(oe,se),Ie=Ld(ue,oe.mode,Ie),Ie.return=oe,oe=Ie),C(oe)):c(oe,se)}return function(oe,se,ue,Ie){try{Tc=0;var it=hr(oe,se,ue,Ie);return tl=null,it}catch(dt){if(dt===xc||dt===yf)throw dt;var Lt=Za(29,dt,null,oe.mode);return Lt.lanes=Ie,Lt.return=oe,Lt}finally{}}}var rl=Uv(!0),zv=Uv(!1),Tn=De(null),ss=null;function ii(s){var i=s.alternate;X(sa,sa.current&1),X(Tn,s),ss===null&&(i===null||Jo.current!==null||i.memoizedState!==null)&&(ss=s)}function Vv(s){if(s.tag===22){if(X(sa,sa.current),X(Tn,s),ss===null){var i=s.alternate;i!==null&&i.memoizedState!==null&&(ss=s)}}else oi()}function oi(){X(sa,sa.current),X(Tn,Tn.current)}function Os(s){P(Tn),ss===s&&(ss=null),P(sa)}var sa=De(0);function Rf(s){for(var i=s;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||om(c)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function ph(s,i,c,d){i=s.memoizedState,c=c(d,i),c=c==null?i:g({},i,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var yh={enqueueSetState:function(s,i,c){s=s._reactInternals;var d=an(),x=ai(d);x.payload=i,c!=null&&(x.callback=c),i=ni(s,x,d),i!==null&&(nn(i,s,d),pc(i,s,d))},enqueueReplaceState:function(s,i,c){s=s._reactInternals;var d=an(),x=ai(d);x.tag=1,x.payload=i,c!=null&&(x.callback=c),i=ni(s,x,d),i!==null&&(nn(i,s,d),pc(i,s,d))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var c=an(),d=ai(c);d.tag=2,i!=null&&(d.callback=i),i=ni(s,d,c),i!==null&&(nn(i,s,c),pc(i,s,c))}};function Hv(s,i,c,d,x,y,C){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(d,y,C):i.prototype&&i.prototype.isPureReactComponent?!lc(c,d)||!lc(x,y):!0}function $v(s,i,c,d){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,d),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,d),i.state!==s&&yh.enqueueReplaceState(i,i.state,null)}function ao(s,i){var c=i;if("ref"in i){c={};for(var d in i)d!=="ref"&&(c[d]=i[d])}if(s=s.defaultProps){c===i&&(c=g({},c));for(var x in s)c[x]===void 0&&(c[x]=s[x])}return c}var Ff=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Wv(s){Ff(s)}function Gv(s){console.error(s)}function qv(s){Ff(s)}function Mf(s,i){try{var c=s.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(d){setTimeout(function(){throw d})}}function Yv(s,i,c){try{var d=s.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function _h(s,i,c){return c=ai(c),c.tag=3,c.payload={element:null},c.callback=function(){Mf(s,i)},c}function Xv(s){return s=ai(s),s.tag=3,s}function Kv(s,i,c,d){var x=c.type.getDerivedStateFromError;if(typeof x=="function"){var y=d.value;s.payload=function(){return x(y)},s.callback=function(){Yv(i,c,d)}}var C=c.stateNode;C!==null&&typeof C.componentDidCatch=="function"&&(s.callback=function(){Yv(i,c,d),typeof x!="function"&&(hi===null?hi=new Set([this]):hi.add(this));var F=d.stack;this.componentDidCatch(d.value,{componentStack:F!==null?F:""})})}function Wk(s,i,c,d,x){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(i=c.alternate,i!==null&&hc(i,c,x,!0),c=Tn.current,c!==null){switch(c.tag){case 13:return ss===null?$h():c.alternate===null&&Lr===0&&(Lr=3),c.flags&=-257,c.flags|=65536,c.lanes=x,d===Xd?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([d]):i.add(d),Gh(s,d,x)),!1;case 22:return c.flags|=65536,d===Xd?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([d]):c.add(d)),Gh(s,d,x)),!1}throw Error(a(435,c.tag))}return Gh(s,d,x),$h(),!1}if(Qt)return i=Tn.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=x,d!==Vd&&(s=Error(a(422),{cause:d}),dc(wn(s,c)))):(d!==Vd&&(i=Error(a(423),{cause:d}),dc(wn(i,c))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,d=wn(d,c),x=_h(s.stateNode,d,x),Qd(s,x),Lr!==4&&(Lr=2)),!1;var y=Error(a(520),{cause:d});if(y=wn(y,c),Fc===null?Fc=[y]:Fc.push(y),Lr!==4&&(Lr=2),i===null)return!0;d=wn(d,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,s=x&-x,c.lanes|=s,s=_h(c.stateNode,d,s),Qd(c,s),!1;case 1:if(i=c.type,y=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(hi===null||!hi.has(y))))return c.flags|=65536,x&=-x,c.lanes|=x,x=Xv(x),Kv(x,s,c,d),Qd(c,x),!1}c=c.return}while(c!==null);return!1}var Jv=Error(a(461)),ca=!1;function va(s,i,c,d){i.child=s===null?zv(i,null,c,d):rl(i,s.child,c,d)}function Qv(s,i,c,d,x){c=c.render;var y=i.ref;if("ref"in d){var C={};for(var F in d)F!=="ref"&&(C[F]=d[F])}else C=d;return eo(i),d=ah(s,i,c,C,y,x),F=nh(),s!==null&&!ca?(sh(s,i,x),Rs(s,i,x)):(Qt&&F&&Ud(i),i.flags|=1,va(s,i,d,x),i.child)}function Zv(s,i,c,d,x){if(s===null){var y=c.type;return typeof y=="function"&&!Pd(y)&&y.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=y,ep(s,i,y,d,x)):(s=hf(c.type,null,d,i,i.mode,x),s.ref=i.ref,s.return=i,i.child=s)}if(y=s.child,!Ch(s,x)){var C=y.memoizedProps;if(c=c.compare,c=c!==null?c:lc,c(C,d)&&s.ref===i.ref)return Rs(s,i,x)}return i.flags|=1,s=Ts(y,d),s.ref=i.ref,s.return=i,i.child=s}function ep(s,i,c,d,x){if(s!==null){var y=s.memoizedProps;if(lc(y,d)&&s.ref===i.ref)if(ca=!1,i.pendingProps=d=y,Ch(s,x))(s.flags&131072)!==0&&(ca=!0);else return i.lanes=s.lanes,Rs(s,i,x)}return wh(s,i,c,d,x)}function tp(s,i,c){var d=i.pendingProps,x=d.children,y=s!==null?s.memoizedState:null;if(d.mode==="hidden"){if((i.flags&128)!==0){if(d=y!==null?y.baseLanes|c:c,s!==null){for(x=i.child=s.child,y=0;x!==null;)y=y|x.lanes|x.childLanes,x=x.sibling;i.childLanes=y&~d}else i.childLanes=0,i.child=null;return rp(s,i,d,c)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},s!==null&&pf(i,y!==null?y.cachePool:null),y!==null?ev(i,y):eh(),Vv(i);else return i.lanes=i.childLanes=536870912,rp(s,i,y!==null?y.baseLanes|c:c,c)}else y!==null?(pf(i,y.cachePool),ev(i,y),oi(),i.memoizedState=null):(s!==null&&pf(i,null),eh(),oi());return va(s,i,x,c),i.child}function rp(s,i,c,d){var x=Yd();return x=x===null?null:{parent:na._currentValue,pool:x},i.memoizedState={baseLanes:c,cachePool:x},s!==null&&pf(i,null),eh(),Vv(i),s!==null&&hc(s,i,d,!0),null}function jf(s,i){var c=i.ref;if(c===null)s!==null&&s.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(a(284));(s===null||s.ref!==c)&&(i.flags|=4194816)}}function wh(s,i,c,d,x){return eo(i),c=ah(s,i,c,d,void 0,x),d=nh(),s!==null&&!ca?(sh(s,i,x),Rs(s,i,x)):(Qt&&d&&Ud(i),i.flags|=1,va(s,i,c,x),i.child)}function ap(s,i,c,d,x,y){return eo(i),i.updateQueue=null,c=rv(i,d,c,x),tv(s),d=nh(),s!==null&&!ca?(sh(s,i,y),Rs(s,i,y)):(Qt&&d&&Ud(i),i.flags|=1,va(s,i,c,y),i.child)}function np(s,i,c,d,x){if(eo(i),i.stateNode===null){var y=Go,C=c.contextType;typeof C=="object"&&C!==null&&(y=Aa(C)),y=new c(d,y),i.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=yh,i.stateNode=y,y._reactInternals=i,y=i.stateNode,y.props=d,y.state=i.memoizedState,y.refs={},Kd(i),C=c.contextType,y.context=typeof C=="object"&&C!==null?Aa(C):Go,y.state=i.memoizedState,C=c.getDerivedStateFromProps,typeof C=="function"&&(ph(i,c,C,d),y.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(C=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),C!==y.state&&yh.enqueueReplaceState(y,y.state,null),_c(i,d,y,x),yc(),y.state=i.memoizedState),typeof y.componentDidMount=="function"&&(i.flags|=4194308),d=!0}else if(s===null){y=i.stateNode;var F=i.memoizedProps,te=ao(c,F);y.props=te;var he=y.context,Me=c.contextType;C=Go,typeof Me=="object"&&Me!==null&&(C=Aa(Me));var Le=c.getDerivedStateFromProps;Me=typeof Le=="function"||typeof y.getSnapshotBeforeUpdate=="function",F=i.pendingProps!==F,Me||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(F||he!==C)&&$v(i,y,d,C),ri=!1;var pe=i.memoizedState;y.state=pe,_c(i,d,y,x),yc(),he=i.memoizedState,F||pe!==he||ri?(typeof Le=="function"&&(ph(i,c,Le,d),he=i.memoizedState),(te=ri||Hv(i,c,te,d,pe,he,C))?(Me||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(i.flags|=4194308)):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=d,i.memoizedState=he),y.props=d,y.state=he,y.context=C,d=te):(typeof y.componentDidMount=="function"&&(i.flags|=4194308),d=!1)}else{y=i.stateNode,Jd(s,i),C=i.memoizedProps,Me=ao(c,C),y.props=Me,Le=i.pendingProps,pe=y.context,he=c.contextType,te=Go,typeof he=="object"&&he!==null&&(te=Aa(he)),F=c.getDerivedStateFromProps,(he=typeof F=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(C!==Le||pe!==te)&&$v(i,y,d,te),ri=!1,pe=i.memoizedState,y.state=pe,_c(i,d,y,x),yc();var we=i.memoizedState;C!==Le||pe!==we||ri||s!==null&&s.dependencies!==null&&xf(s.dependencies)?(typeof F=="function"&&(ph(i,c,F,d),we=i.memoizedState),(Me=ri||Hv(i,c,Me,d,pe,we,te)||s!==null&&s.dependencies!==null&&xf(s.dependencies))?(he||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(d,we,te),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(d,we,te)),typeof y.componentDidUpdate=="function"&&(i.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof y.componentDidUpdate!="function"||C===s.memoizedProps&&pe===s.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||C===s.memoizedProps&&pe===s.memoizedState||(i.flags|=1024),i.memoizedProps=d,i.memoizedState=we),y.props=d,y.state=we,y.context=te,d=Me):(typeof y.componentDidUpdate!="function"||C===s.memoizedProps&&pe===s.memoizedState||(i.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||C===s.memoizedProps&&pe===s.memoizedState||(i.flags|=1024),d=!1)}return y=d,jf(s,i),d=(i.flags&128)!==0,y||d?(y=i.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:y.render(),i.flags|=1,s!==null&&d?(i.child=rl(i,s.child,null,x),i.child=rl(i,null,c,x)):va(s,i,c,x),i.memoizedState=y.state,s=i.child):s=Rs(s,i,x),s}function sp(s,i,c,d){return fc(),i.flags|=256,va(s,i,c,d),i.child}var bh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Sh(s){return{baseLanes:s,cachePool:Gx()}}function Eh(s,i,c){return s=s!==null?s.childLanes&~c:0,i&&(s|=kn),s}function ip(s,i,c){var d=i.pendingProps,x=!1,y=(i.flags&128)!==0,C;if((C=y)||(C=s!==null&&s.memoizedState===null?!1:(sa.current&2)!==0),C&&(x=!0,i.flags&=-129),C=(i.flags&32)!==0,i.flags&=-33,s===null){if(Qt){if(x?ii(i):oi(),Qt){var F=Pr,te;if(te=F){e:{for(te=F,F=ns;te.nodeType!==8;){if(!F){F=null;break e}if(te=Wn(te.nextSibling),te===null){F=null;break e}}F=te}F!==null?(i.memoizedState={dehydrated:F,treeContext:Xi!==null?{id:ks,overflow:As}:null,retryLane:536870912,hydrationErrors:null},te=Za(18,null,null,0),te.stateNode=F,te.return=i,i.child=te,Ba=i,Pr=null,te=!0):te=!1}te||Qi(i)}if(F=i.memoizedState,F!==null&&(F=F.dehydrated,F!==null))return om(F)?i.lanes=32:i.lanes=536870912,null;Os(i)}return F=d.children,d=d.fallback,x?(oi(),x=i.mode,F=If({mode:"hidden",children:F},x),d=Yi(d,x,c,null),F.return=i,d.return=i,F.sibling=d,i.child=F,x=i.child,x.memoizedState=Sh(c),x.childLanes=Eh(s,C,c),i.memoizedState=bh,d):(ii(i),Th(i,F))}if(te=s.memoizedState,te!==null&&(F=te.dehydrated,F!==null)){if(y)i.flags&256?(ii(i),i.flags&=-257,i=kh(s,i,c)):i.memoizedState!==null?(oi(),i.child=s.child,i.flags|=128,i=null):(oi(),x=d.fallback,F=i.mode,d=If({mode:"visible",children:d.children},F),x=Yi(x,F,c,null),x.flags|=2,d.return=i,x.return=i,d.sibling=x,i.child=d,rl(i,s.child,null,c),d=i.child,d.memoizedState=Sh(c),d.childLanes=Eh(s,C,c),i.memoizedState=bh,i=x);else if(ii(i),om(F)){if(C=F.nextSibling&&F.nextSibling.dataset,C)var he=C.dgst;C=he,d=Error(a(419)),d.stack="",d.digest=C,dc({value:d,source:null,stack:null}),i=kh(s,i,c)}else if(ca||hc(s,i,c,!1),C=(c&s.childLanes)!==0,ca||C){if(C=_r,C!==null&&(d=c&-c,d=(d&42)!==0?1:He(d),d=(d&(C.suspendedLanes|c))!==0?0:d,d!==0&&d!==te.retryLane))throw te.retryLane=d,Wo(s,d),nn(C,s,d),Jv;F.data==="$?"||$h(),i=kh(s,i,c)}else F.data==="$?"?(i.flags|=192,i.child=s.child,i=null):(s=te.treeContext,Pr=Wn(F.nextSibling),Ba=i,Qt=!0,Ji=null,ns=!1,s!==null&&(Sn[En++]=ks,Sn[En++]=As,Sn[En++]=Xi,ks=s.id,As=s.overflow,Xi=i),i=Th(i,d.children),i.flags|=4096);return i}return x?(oi(),x=d.fallback,F=i.mode,te=s.child,he=te.sibling,d=Ts(te,{mode:"hidden",children:d.children}),d.subtreeFlags=te.subtreeFlags&65011712,he!==null?x=Ts(he,x):(x=Yi(x,F,c,null),x.flags|=2),x.return=i,d.return=i,d.sibling=x,i.child=d,d=x,x=i.child,F=s.child.memoizedState,F===null?F=Sh(c):(te=F.cachePool,te!==null?(he=na._currentValue,te=te.parent!==he?{parent:he,pool:he}:te):te=Gx(),F={baseLanes:F.baseLanes|c,cachePool:te}),x.memoizedState=F,x.childLanes=Eh(s,C,c),i.memoizedState=bh,d):(ii(i),c=s.child,s=c.sibling,c=Ts(c,{mode:"visible",children:d.children}),c.return=i,c.sibling=null,s!==null&&(C=i.deletions,C===null?(i.deletions=[s],i.flags|=16):C.push(s)),i.child=c,i.memoizedState=null,c)}function Th(s,i){return i=If({mode:"visible",children:i},s.mode),i.return=s,s.child=i}function If(s,i){return s=Za(22,s,null,i),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function kh(s,i,c){return rl(i,s.child,null,c),s=Th(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function op(s,i,c){s.lanes|=i;var d=s.alternate;d!==null&&(d.lanes|=i),$d(s.return,i,c)}function Ah(s,i,c,d,x){var y=s.memoizedState;y===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:x}:(y.isBackwards=i,y.rendering=null,y.renderingStartTime=0,y.last=d,y.tail=c,y.tailMode=x)}function lp(s,i,c){var d=i.pendingProps,x=d.revealOrder,y=d.tail;if(va(s,i,d.children,c),d=sa.current,(d&2)!==0)d=d&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&op(s,c,i);else if(s.tag===19)op(s,c,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}d&=1}switch(X(sa,d),x){case"forwards":for(c=i.child,x=null;c!==null;)s=c.alternate,s!==null&&Rf(s)===null&&(x=c),c=c.sibling;c=x,c===null?(x=i.child,i.child=null):(x=c.sibling,c.sibling=null),Ah(i,!1,x,c,y);break;case"backwards":for(c=null,x=i.child,i.child=null;x!==null;){if(s=x.alternate,s!==null&&Rf(s)===null){i.child=x;break}s=x.sibling,x.sibling=c,c=x,x=s}Ah(i,!0,c,null,y);break;case"together":Ah(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Rs(s,i,c){if(s!==null&&(i.dependencies=s.dependencies),di|=i.lanes,(c&i.childLanes)===0)if(s!==null){if(hc(s,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(s!==null&&i.child!==s.child)throw Error(a(153));if(i.child!==null){for(s=i.child,c=Ts(s,s.pendingProps),i.child=c,c.return=i;s.sibling!==null;)s=s.sibling,c=c.sibling=Ts(s,s.pendingProps),c.return=i;c.sibling=null}return i.child}function Ch(s,i){return(s.lanes&i)!==0?!0:(s=s.dependencies,!!(s!==null&&xf(s)))}function Gk(s,i,c){switch(i.tag){case 3:Te(i,i.stateNode.containerInfo),ti(i,na,s.memoizedState.cache),fc();break;case 27:case 5:Re(i);break;case 4:Te(i,i.stateNode.containerInfo);break;case 10:ti(i,i.type,i.memoizedProps.value);break;case 13:var d=i.memoizedState;if(d!==null)return d.dehydrated!==null?(ii(i),i.flags|=128,null):(c&i.child.childLanes)!==0?ip(s,i,c):(ii(i),s=Rs(s,i,c),s!==null?s.sibling:null);ii(i);break;case 19:var x=(s.flags&128)!==0;if(d=(c&i.childLanes)!==0,d||(hc(s,i,c,!1),d=(c&i.childLanes)!==0),x){if(d)return lp(s,i,c);i.flags|=128}if(x=i.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),X(sa,sa.current),d)break;return null;case 22:case 23:return i.lanes=0,tp(s,i,c);case 24:ti(i,na,s.memoizedState.cache)}return Rs(s,i,c)}function cp(s,i,c){if(s!==null)if(s.memoizedProps!==i.pendingProps)ca=!0;else{if(!Ch(s,c)&&(i.flags&128)===0)return ca=!1,Gk(s,i,c);ca=(s.flags&131072)!==0}else ca=!1,Qt&&(i.flags&1048576)!==0&&Bx(i,gf,i.index);switch(i.lanes=0,i.tag){case 16:e:{s=i.pendingProps;var d=i.elementType,x=d._init;if(d=x(d._payload),i.type=d,typeof d=="function")Pd(d)?(s=ao(d,s),i.tag=1,i=np(null,i,d,s,c)):(i.tag=0,i=wh(null,i,d,s,c));else{if(d!=null){if(x=d.$$typeof,x===E){i.tag=11,i=Qv(null,i,d,s,c);break e}else if(x===A){i.tag=14,i=Zv(null,i,d,s,c);break e}}throw i=ne(d)||d,Error(a(306,i,""))}}return i;case 0:return wh(s,i,i.type,i.pendingProps,c);case 1:return d=i.type,x=ao(d,i.pendingProps),np(s,i,d,x,c);case 3:e:{if(Te(i,i.stateNode.containerInfo),s===null)throw Error(a(387));d=i.pendingProps;var y=i.memoizedState;x=y.element,Jd(s,i),_c(i,d,null,c);var C=i.memoizedState;if(d=C.cache,ti(i,na,d),d!==y.cache&&Wd(i,[na],c,!0),yc(),d=C.element,y.isDehydrated)if(y={element:d,isDehydrated:!1,cache:C.cache},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){i=sp(s,i,d,c);break e}else if(d!==x){x=wn(Error(a(424)),i),dc(x),i=sp(s,i,d,c);break e}else{switch(s=i.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Pr=Wn(s.firstChild),Ba=i,Qt=!0,Ji=null,ns=!0,c=zv(i,null,d,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(fc(),d===x){i=Rs(s,i,c);break e}va(s,i,d,c)}i=i.child}return i;case 26:return jf(s,i),s===null?(c=hy(i.type,null,i.pendingProps,null))?i.memoizedState=c:Qt||(c=i.type,s=i.pendingProps,d=Kf(de.current).createElement(c),d[Or]=i,d[er]=s,ya(d,c,s),ce(d),i.stateNode=d):i.memoizedState=hy(i.type,s.memoizedProps,i.pendingProps,s.memoizedState),null;case 27:return Re(i),s===null&&Qt&&(d=i.stateNode=uy(i.type,i.pendingProps,de.current),Ba=i,ns=!0,x=Pr,xi(i.type)?(lm=x,Pr=Wn(d.firstChild)):Pr=x),va(s,i,i.pendingProps.children,c),jf(s,i),s===null&&(i.flags|=4194304),i.child;case 5:return s===null&&Qt&&((x=d=Pr)&&(d=_A(d,i.type,i.pendingProps,ns),d!==null?(i.stateNode=d,Ba=i,Pr=Wn(d.firstChild),ns=!1,x=!0):x=!1),x||Qi(i)),Re(i),x=i.type,y=i.pendingProps,C=s!==null?s.memoizedProps:null,d=y.children,nm(x,y)?d=null:C!==null&&nm(x,C)&&(i.flags|=32),i.memoizedState!==null&&(x=ah(s,i,Lk,null,null,c),Vc._currentValue=x),jf(s,i),va(s,i,d,c),i.child;case 6:return s===null&&Qt&&((s=c=Pr)&&(c=wA(c,i.pendingProps,ns),c!==null?(i.stateNode=c,Ba=i,Pr=null,s=!0):s=!1),s||Qi(i)),null;case 13:return ip(s,i,c);case 4:return Te(i,i.stateNode.containerInfo),d=i.pendingProps,s===null?i.child=rl(i,null,d,c):va(s,i,d,c),i.child;case 11:return Qv(s,i,i.type,i.pendingProps,c);case 7:return va(s,i,i.pendingProps,c),i.child;case 8:return va(s,i,i.pendingProps.children,c),i.child;case 12:return va(s,i,i.pendingProps.children,c),i.child;case 10:return d=i.pendingProps,ti(i,i.type,d.value),va(s,i,d.children,c),i.child;case 9:return x=i.type._context,d=i.pendingProps.children,eo(i),x=Aa(x),d=d(x),i.flags|=1,va(s,i,d,c),i.child;case 14:return Zv(s,i,i.type,i.pendingProps,c);case 15:return ep(s,i,i.type,i.pendingProps,c);case 19:return lp(s,i,c);case 31:return d=i.pendingProps,c=i.mode,d={mode:d.mode,children:d.children},s===null?(c=If(d,c),c.ref=i.ref,i.child=c,c.return=i,i=c):(c=Ts(s.child,d),c.ref=i.ref,i.child=c,c.return=i,i=c),i;case 22:return tp(s,i,c);case 24:return eo(i),d=Aa(na),s===null?(x=Yd(),x===null&&(x=_r,y=Gd(),x.pooledCache=y,y.refCount++,y!==null&&(x.pooledCacheLanes|=c),x=y),i.memoizedState={parent:d,cache:x},Kd(i),ti(i,na,x)):((s.lanes&c)!==0&&(Jd(s,i),_c(i,null,null,c),yc()),x=s.memoizedState,y=i.memoizedState,x.parent!==d?(x={parent:d,cache:d},i.memoizedState=x,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=x),ti(i,na,d)):(d=y.cache,ti(i,na,d),d!==x.cache&&Wd(i,[na],c,!0))),va(s,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function Fs(s){s.flags|=4}function up(s,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!py(i)){if(i=Tn.current,i!==null&&((Gt&4194048)===Gt?ss!==null:(Gt&62914560)!==Gt&&(Gt&536870912)===0||i!==ss))throw vc=Xd,qx;s.flags|=8192}}function Pf(s,i){i!==null&&(s.flags|=4),s.flags&16384&&(i=s.tag!==22?ft():536870912,s.lanes|=i,il|=i)}function Ac(s,i){if(!Qt)switch(s.tailMode){case"hidden":i=s.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:d.sibling=null}}function Rr(s){var i=s.alternate!==null&&s.alternate.child===s.child,c=0,d=0;if(i)for(var x=s.child;x!==null;)c|=x.lanes|x.childLanes,d|=x.subtreeFlags&65011712,d|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)c|=x.lanes|x.childLanes,d|=x.subtreeFlags,d|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=d,s.childLanes=c,i}function qk(s,i,c){var d=i.pendingProps;switch(zd(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rr(i),null;case 1:return Rr(i),null;case 3:return c=i.stateNode,d=null,s!==null&&(d=s.memoizedState.cache),i.memoizedState.cache!==d&&(i.flags|=2048),Ns(na),Oe(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(uc(i)?Fs(i):s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Vx())),Rr(i),null;case 26:return c=i.memoizedState,s===null?(Fs(i),c!==null?(Rr(i),up(i,c)):(Rr(i),i.flags&=-16777217)):c?c!==s.memoizedState?(Fs(i),Rr(i),up(i,c)):(Rr(i),i.flags&=-16777217):(s.memoizedProps!==d&&Fs(i),Rr(i),i.flags&=-16777217),null;case 27:Je(i),c=de.current;var x=i.type;if(s!==null&&i.stateNode!=null)s.memoizedProps!==d&&Fs(i);else{if(!d){if(i.stateNode===null)throw Error(a(166));return Rr(i),null}s=Y.current,uc(i)?Ux(i):(s=uy(x,d,c),i.stateNode=s,Fs(i))}return Rr(i),null;case 5:if(Je(i),c=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==d&&Fs(i);else{if(!d){if(i.stateNode===null)throw Error(a(166));return Rr(i),null}if(s=Y.current,uc(i))Ux(i);else{switch(x=Kf(de.current),s){case 1:s=x.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:s=x.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":s=x.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":s=x.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":s=x.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof d.is=="string"?x.createElement("select",{is:d.is}):x.createElement("select"),d.multiple?s.multiple=!0:d.size&&(s.size=d.size);break;default:s=typeof d.is=="string"?x.createElement(c,{is:d.is}):x.createElement(c)}}s[Or]=i,s[er]=d;e:for(x=i.child;x!==null;){if(x.tag===5||x.tag===6)s.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===i)break e;for(;x.sibling===null;){if(x.return===null||x.return===i)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}i.stateNode=s;e:switch(ya(s,c,d),c){case"button":case"input":case"select":case"textarea":s=!!d.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Fs(i)}}return Rr(i),i.flags&=-16777217,null;case 6:if(s&&i.stateNode!=null)s.memoizedProps!==d&&Fs(i);else{if(typeof d!="string"&&i.stateNode===null)throw Error(a(166));if(s=de.current,uc(i)){if(s=i.stateNode,c=i.memoizedProps,d=null,x=Ba,x!==null)switch(x.tag){case 27:case 5:d=x.memoizedProps}s[Or]=i,s=!!(s.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||ay(s.nodeValue,c)),s||Qi(i)}else s=Kf(s).createTextNode(d),s[Or]=i,i.stateNode=s}return Rr(i),null;case 13:if(d=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=uc(i),d!==null&&d.dehydrated!==null){if(s===null){if(!x)throw Error(a(318));if(x=i.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(a(317));x[Or]=i}else fc(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Rr(i),x=!1}else x=Vx(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return i.flags&256?(Os(i),i):(Os(i),null)}if(Os(i),(i.flags&128)!==0)return i.lanes=c,i;if(c=d!==null,s=s!==null&&s.memoizedState!==null,c){d=i.child,x=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(x=d.alternate.memoizedState.cachePool.pool);var y=null;d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(y=d.memoizedState.cachePool.pool),y!==x&&(d.flags|=2048)}return c!==s&&c&&(i.child.flags|=8192),Pf(i,i.updateQueue),Rr(i),null;case 4:return Oe(),s===null&&Zh(i.stateNode.containerInfo),Rr(i),null;case 10:return Ns(i.type),Rr(i),null;case 19:if(P(sa),x=i.memoizedState,x===null)return Rr(i),null;if(d=(i.flags&128)!==0,y=x.rendering,y===null)if(d)Ac(x,!1);else{if(Lr!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(y=Rf(s),y!==null){for(i.flags|=128,Ac(x,!1),s=y.updateQueue,i.updateQueue=s,Pf(i,s),i.subtreeFlags=0,s=c,c=i.child;c!==null;)Lx(c,s),c=c.sibling;return X(sa,sa.current&1|2),i.child}s=s.sibling}x.tail!==null&&Z()>Uf&&(i.flags|=128,d=!0,Ac(x,!1),i.lanes=4194304)}else{if(!d)if(s=Rf(y),s!==null){if(i.flags|=128,d=!0,s=s.updateQueue,i.updateQueue=s,Pf(i,s),Ac(x,!0),x.tail===null&&x.tailMode==="hidden"&&!y.alternate&&!Qt)return Rr(i),null}else 2*Z()-x.renderingStartTime>Uf&&c!==536870912&&(i.flags|=128,d=!0,Ac(x,!1),i.lanes=4194304);x.isBackwards?(y.sibling=i.child,i.child=y):(s=x.last,s!==null?s.sibling=y:i.child=y,x.last=y)}return x.tail!==null?(i=x.tail,x.rendering=i,x.tail=i.sibling,x.renderingStartTime=Z(),i.sibling=null,s=sa.current,X(sa,d?s&1|2:s&1),i):(Rr(i),null);case 22:case 23:return Os(i),th(),d=i.memoizedState!==null,s!==null?s.memoizedState!==null!==d&&(i.flags|=8192):d&&(i.flags|=8192),d?(c&536870912)!==0&&(i.flags&128)===0&&(Rr(i),i.subtreeFlags&6&&(i.flags|=8192)):Rr(i),c=i.updateQueue,c!==null&&Pf(i,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),d=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),d!==c&&(i.flags|=2048),s!==null&&P(to),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),Ns(na),Rr(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function Yk(s,i){switch(zd(i),i.tag){case 1:return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return Ns(na),Oe(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 26:case 27:case 5:return Je(i),null;case 13:if(Os(i),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(a(340));fc()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return P(sa),null;case 4:return Oe(),null;case 10:return Ns(i.type),null;case 22:case 23:return Os(i),th(),s!==null&&P(to),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 24:return Ns(na),null;case 25:return null;default:return null}}function fp(s,i){switch(zd(i),i.tag){case 3:Ns(na),Oe();break;case 26:case 27:case 5:Je(i);break;case 4:Oe();break;case 13:Os(i);break;case 19:P(sa);break;case 10:Ns(i.type);break;case 22:case 23:Os(i),th(),s!==null&&P(to);break;case 24:Ns(na)}}function Cc(s,i){try{var c=i.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var x=d.next;c=x;do{if((c.tag&s)===s){d=void 0;var y=c.create,C=c.inst;d=y(),C.destroy=d}c=c.next}while(c!==x)}}catch(F){vr(i,i.return,F)}}function li(s,i,c){try{var d=i.updateQueue,x=d!==null?d.lastEffect:null;if(x!==null){var y=x.next;d=y;do{if((d.tag&s)===s){var C=d.inst,F=C.destroy;if(F!==void 0){C.destroy=void 0,x=i;var te=c,he=F;try{he()}catch(Me){vr(x,te,Me)}}}d=d.next}while(d!==y)}}catch(Me){vr(i,i.return,Me)}}function dp(s){var i=s.updateQueue;if(i!==null){var c=s.stateNode;try{Zx(i,c)}catch(d){vr(s,s.return,d)}}}function hp(s,i,c){c.props=ao(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(d){vr(s,i,d)}}function Nc(s,i){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var d=s.stateNode;break;case 30:d=s.stateNode;break;default:d=s.stateNode}typeof c=="function"?s.refCleanup=c(d):c.current=d}}catch(x){vr(s,i,x)}}function is(s,i){var c=s.ref,d=s.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(x){vr(s,i,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(x){vr(s,i,x)}else c.current=null}function mp(s){var i=s.type,c=s.memoizedProps,d=s.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break e;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(x){vr(s,s.return,x)}}function Nh(s,i,c){try{var d=s.stateNode;gA(d,s.type,c,i),d[er]=i}catch(x){vr(s,s.return,x)}}function gp(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&xi(s.type)||s.tag===4}function Dh(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||gp(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&xi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Oh(s,i,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(s),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=Xf));else if(d!==4&&(d===27&&xi(s.type)&&(c=s.stateNode,i=null),s=s.child,s!==null))for(Oh(s,i,c),s=s.sibling;s!==null;)Oh(s,i,c),s=s.sibling}function Lf(s,i,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,i?c.insertBefore(s,i):c.appendChild(s);else if(d!==4&&(d===27&&xi(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(Lf(s,i,c),s=s.sibling;s!==null;)Lf(s,i,c),s=s.sibling}function xp(s){var i=s.stateNode,c=s.memoizedProps;try{for(var d=s.type,x=i.attributes;x.length;)i.removeAttributeNode(x[0]);ya(i,d,c),i[Or]=s,i[er]=c}catch(y){vr(s,s.return,y)}}var Ms=!1,$r=!1,Rh=!1,vp=typeof WeakSet=="function"?WeakSet:Set,ua=null;function Xk(s,i){if(s=s.containerInfo,rm=r0,s=Cx(s),Dd(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var x=d.anchorOffset,y=d.focusNode;d=d.focusOffset;try{c.nodeType,y.nodeType}catch{c=null;break e}var C=0,F=-1,te=-1,he=0,Me=0,Le=s,pe=null;t:for(;;){for(var we;Le!==c||x!==0&&Le.nodeType!==3||(F=C+x),Le!==y||d!==0&&Le.nodeType!==3||(te=C+d),Le.nodeType===3&&(C+=Le.nodeValue.length),(we=Le.firstChild)!==null;)pe=Le,Le=we;for(;;){if(Le===s)break t;if(pe===c&&++he===x&&(F=C),pe===y&&++Me===d&&(te=C),(we=Le.nextSibling)!==null)break;Le=pe,pe=Le.parentNode}Le=we}c=F===-1||te===-1?null:{start:F,end:te}}else c=null}c=c||{start:0,end:0}}else c=null;for(am={focusedElem:s,selectionRange:c},r0=!1,ua=i;ua!==null;)if(i=ua,s=i.child,(i.subtreeFlags&1024)!==0&&s!==null)s.return=i,ua=s;else for(;ua!==null;){switch(i=ua,y=i.alternate,s=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&y!==null){s=void 0,c=i,x=y.memoizedProps,y=y.memoizedState,d=c.stateNode;try{var St=ao(c.type,x,c.elementType===c.type);s=d.getSnapshotBeforeUpdate(St,y),d.__reactInternalSnapshotBeforeUpdate=s}catch(vt){vr(c,c.return,vt)}}break;case 3:if((s&1024)!==0){if(s=i.stateNode.containerInfo,c=s.nodeType,c===9)im(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":im(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(a(163))}if(s=i.sibling,s!==null){s.return=i.return,ua=s;break}ua=i.return}}function pp(s,i,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:ci(s,c),d&4&&Cc(5,c);break;case 1:if(ci(s,c),d&4)if(s=c.stateNode,i===null)try{s.componentDidMount()}catch(C){vr(c,c.return,C)}else{var x=ao(c.type,i.memoizedProps);i=i.memoizedState;try{s.componentDidUpdate(x,i,s.__reactInternalSnapshotBeforeUpdate)}catch(C){vr(c,c.return,C)}}d&64&&dp(c),d&512&&Nc(c,c.return);break;case 3:if(ci(s,c),d&64&&(s=c.updateQueue,s!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{Zx(s,i)}catch(C){vr(c,c.return,C)}}break;case 27:i===null&&d&4&&xp(c);case 26:case 5:ci(s,c),i===null&&d&4&&mp(c),d&512&&Nc(c,c.return);break;case 12:ci(s,c);break;case 13:ci(s,c),d&4&&wp(s,c),d&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=nA.bind(null,c),bA(s,c))));break;case 22:if(d=c.memoizedState!==null||Ms,!d){i=i!==null&&i.memoizedState!==null||$r,x=Ms;var y=$r;Ms=d,($r=i)&&!y?ui(s,c,(c.subtreeFlags&8772)!==0):ci(s,c),Ms=x,$r=y}break;case 30:break;default:ci(s,c)}}function yp(s){var i=s.alternate;i!==null&&(s.alternate=null,yp(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&V(i)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Dr=null,Wa=!1;function js(s,i,c){for(c=c.child;c!==null;)_p(s,i,c),c=c.sibling}function _p(s,i,c){if(et&&typeof et.onCommitFiberUnmount=="function")try{et.onCommitFiberUnmount(Qe,c)}catch{}switch(c.tag){case 26:$r||is(c,i),js(s,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:$r||is(c,i);var d=Dr,x=Wa;xi(c.type)&&(Dr=c.stateNode,Wa=!1),js(s,i,c),Lc(c.stateNode),Dr=d,Wa=x;break;case 5:$r||is(c,i);case 6:if(d=Dr,x=Wa,Dr=null,js(s,i,c),Dr=d,Wa=x,Dr!==null)if(Wa)try{(Dr.nodeType===9?Dr.body:Dr.nodeName==="HTML"?Dr.ownerDocument.body:Dr).removeChild(c.stateNode)}catch(y){vr(c,i,y)}else try{Dr.removeChild(c.stateNode)}catch(y){vr(c,i,y)}break;case 18:Dr!==null&&(Wa?(s=Dr,ly(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),Gc(s)):ly(Dr,c.stateNode));break;case 4:d=Dr,x=Wa,Dr=c.stateNode.containerInfo,Wa=!0,js(s,i,c),Dr=d,Wa=x;break;case 0:case 11:case 14:case 15:$r||li(2,c,i),$r||li(4,c,i),js(s,i,c);break;case 1:$r||(is(c,i),d=c.stateNode,typeof d.componentWillUnmount=="function"&&hp(c,i,d)),js(s,i,c);break;case 21:js(s,i,c);break;case 22:$r=(d=$r)||c.memoizedState!==null,js(s,i,c),$r=d;break;default:js(s,i,c)}}function wp(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Gc(s)}catch(c){vr(i,i.return,c)}}function Kk(s){switch(s.tag){case 13:case 19:var i=s.stateNode;return i===null&&(i=s.stateNode=new vp),i;case 22:return s=s.stateNode,i=s._retryCache,i===null&&(i=s._retryCache=new vp),i;default:throw Error(a(435,s.tag))}}function Fh(s,i){var c=Kk(s);i.forEach(function(d){var x=sA.bind(null,s,d);c.has(d)||(c.add(d),d.then(x,x))})}function en(s,i){var c=i.deletions;if(c!==null)for(var d=0;d<c.length;d++){var x=c[d],y=s,C=i,F=C;e:for(;F!==null;){switch(F.tag){case 27:if(xi(F.type)){Dr=F.stateNode,Wa=!1;break e}break;case 5:Dr=F.stateNode,Wa=!1;break e;case 3:case 4:Dr=F.stateNode.containerInfo,Wa=!0;break e}F=F.return}if(Dr===null)throw Error(a(160));_p(y,C,x),Dr=null,Wa=!1,y=x.alternate,y!==null&&(y.return=null),x.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)bp(i,s),i=i.sibling}var $n=null;function bp(s,i){var c=s.alternate,d=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:en(i,s),tn(s),d&4&&(li(3,s,s.return),Cc(3,s),li(5,s,s.return));break;case 1:en(i,s),tn(s),d&512&&($r||c===null||is(c,c.return)),d&64&&Ms&&(s=s.updateQueue,s!==null&&(d=s.callbacks,d!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var x=$n;if(en(i,s),tn(s),d&512&&($r||c===null||is(c,c.return)),d&4){var y=c!==null?c.memoizedState:null;if(d=s.memoizedState,c===null)if(d===null)if(s.stateNode===null){e:{d=s.type,c=s.memoizedProps,x=x.ownerDocument||x;t:switch(d){case"title":y=x.getElementsByTagName("title")[0],(!y||y[L]||y[Or]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=x.createElement(d),x.head.insertBefore(y,x.querySelector("head > title"))),ya(y,d,c),y[Or]=s,ce(y),d=y;break e;case"link":var C=xy("link","href",x).get(d+(c.href||""));if(C){for(var F=0;F<C.length;F++)if(y=C[F],y.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&y.getAttribute("rel")===(c.rel==null?null:c.rel)&&y.getAttribute("title")===(c.title==null?null:c.title)&&y.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){C.splice(F,1);break t}}y=x.createElement(d),ya(y,d,c),x.head.appendChild(y);break;case"meta":if(C=xy("meta","content",x).get(d+(c.content||""))){for(F=0;F<C.length;F++)if(y=C[F],y.getAttribute("content")===(c.content==null?null:""+c.content)&&y.getAttribute("name")===(c.name==null?null:c.name)&&y.getAttribute("property")===(c.property==null?null:c.property)&&y.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&y.getAttribute("charset")===(c.charSet==null?null:c.charSet)){C.splice(F,1);break t}}y=x.createElement(d),ya(y,d,c),x.head.appendChild(y);break;default:throw Error(a(468,d))}y[Or]=s,ce(y),d=y}s.stateNode=d}else vy(x,s.type,s.stateNode);else s.stateNode=gy(x,d,s.memoizedProps);else y!==d?(y===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):y.count--,d===null?vy(x,s.type,s.stateNode):gy(x,d,s.memoizedProps)):d===null&&s.stateNode!==null&&Nh(s,s.memoizedProps,c.memoizedProps)}break;case 27:en(i,s),tn(s),d&512&&($r||c===null||is(c,c.return)),c!==null&&d&4&&Nh(s,s.memoizedProps,c.memoizedProps);break;case 5:if(en(i,s),tn(s),d&512&&($r||c===null||is(c,c.return)),s.flags&32){x=s.stateNode;try{Lo(x,"")}catch(we){vr(s,s.return,we)}}d&4&&s.stateNode!=null&&(x=s.memoizedProps,Nh(s,x,c!==null?c.memoizedProps:x)),d&1024&&(Rh=!0);break;case 6:if(en(i,s),tn(s),d&4){if(s.stateNode===null)throw Error(a(162));d=s.memoizedProps,c=s.stateNode;try{c.nodeValue=d}catch(we){vr(s,s.return,we)}}break;case 3:if(Zf=null,x=$n,$n=Jf(i.containerInfo),en(i,s),$n=x,tn(s),d&4&&c!==null&&c.memoizedState.isDehydrated)try{Gc(i.containerInfo)}catch(we){vr(s,s.return,we)}Rh&&(Rh=!1,Sp(s));break;case 4:d=$n,$n=Jf(s.stateNode.containerInfo),en(i,s),tn(s),$n=d;break;case 12:en(i,s),tn(s);break;case 13:en(i,s),tn(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Bh=Z()),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,Fh(s,d)));break;case 22:x=s.memoizedState!==null;var te=c!==null&&c.memoizedState!==null,he=Ms,Me=$r;if(Ms=he||x,$r=Me||te,en(i,s),$r=Me,Ms=he,tn(s),d&8192)e:for(i=s.stateNode,i._visibility=x?i._visibility&-2:i._visibility|1,x&&(c===null||te||Ms||$r||no(s)),c=null,i=s;;){if(i.tag===5||i.tag===26){if(c===null){te=c=i;try{if(y=te.stateNode,x)C=y.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{F=te.stateNode;var Le=te.memoizedProps.style,pe=Le!=null&&Le.hasOwnProperty("display")?Le.display:null;F.style.display=pe==null||typeof pe=="boolean"?"":(""+pe).trim()}}catch(we){vr(te,te.return,we)}}}else if(i.tag===6){if(c===null){te=i;try{te.stateNode.nodeValue=x?"":te.memoizedProps}catch(we){vr(te,te.return,we)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===s)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}d&4&&(d=s.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,Fh(s,c))));break;case 19:en(i,s),tn(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,Fh(s,d)));break;case 30:break;case 21:break;default:en(i,s),tn(s)}}function tn(s){var i=s.flags;if(i&2){try{for(var c,d=s.return;d!==null;){if(gp(d)){c=d;break}d=d.return}if(c==null)throw Error(a(160));switch(c.tag){case 27:var x=c.stateNode,y=Dh(s);Lf(s,y,x);break;case 5:var C=c.stateNode;c.flags&32&&(Lo(C,""),c.flags&=-33);var F=Dh(s);Lf(s,F,C);break;case 3:case 4:var te=c.stateNode.containerInfo,he=Dh(s);Oh(s,he,te);break;default:throw Error(a(161))}}catch(Me){vr(s,s.return,Me)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function Sp(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var i=s;Sp(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),s=s.sibling}}function ci(s,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)pp(s,i.alternate,i),i=i.sibling}function no(s){for(s=s.child;s!==null;){var i=s;switch(i.tag){case 0:case 11:case 14:case 15:li(4,i,i.return),no(i);break;case 1:is(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&hp(i,i.return,c),no(i);break;case 27:Lc(i.stateNode);case 26:case 5:is(i,i.return),no(i);break;case 22:i.memoizedState===null&&no(i);break;case 30:no(i);break;default:no(i)}s=s.sibling}}function ui(s,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var d=i.alternate,x=s,y=i,C=y.flags;switch(y.tag){case 0:case 11:case 15:ui(x,y,c),Cc(4,y);break;case 1:if(ui(x,y,c),d=y,x=d.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(he){vr(d,d.return,he)}if(d=y,x=d.updateQueue,x!==null){var F=d.stateNode;try{var te=x.shared.hiddenCallbacks;if(te!==null)for(x.shared.hiddenCallbacks=null,x=0;x<te.length;x++)Qx(te[x],F)}catch(he){vr(d,d.return,he)}}c&&C&64&&dp(y),Nc(y,y.return);break;case 27:xp(y);case 26:case 5:ui(x,y,c),c&&d===null&&C&4&&mp(y),Nc(y,y.return);break;case 12:ui(x,y,c);break;case 13:ui(x,y,c),c&&C&4&&wp(x,y);break;case 22:y.memoizedState===null&&ui(x,y,c),Nc(y,y.return);break;case 30:break;default:ui(x,y,c)}i=i.sibling}}function Mh(s,i){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&mc(c))}function jh(s,i){s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&mc(s))}function os(s,i,c,d){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Ep(s,i,c,d),i=i.sibling}function Ep(s,i,c,d){var x=i.flags;switch(i.tag){case 0:case 11:case 15:os(s,i,c,d),x&2048&&Cc(9,i);break;case 1:os(s,i,c,d);break;case 3:os(s,i,c,d),x&2048&&(s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&mc(s)));break;case 12:if(x&2048){os(s,i,c,d),s=i.stateNode;try{var y=i.memoizedProps,C=y.id,F=y.onPostCommit;typeof F=="function"&&F(C,i.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(te){vr(i,i.return,te)}}else os(s,i,c,d);break;case 13:os(s,i,c,d);break;case 23:break;case 22:y=i.stateNode,C=i.alternate,i.memoizedState!==null?y._visibility&2?os(s,i,c,d):Dc(s,i):y._visibility&2?os(s,i,c,d):(y._visibility|=2,al(s,i,c,d,(i.subtreeFlags&10256)!==0)),x&2048&&Mh(C,i);break;case 24:os(s,i,c,d),x&2048&&jh(i.alternate,i);break;default:os(s,i,c,d)}}function al(s,i,c,d,x){for(x=x&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var y=s,C=i,F=c,te=d,he=C.flags;switch(C.tag){case 0:case 11:case 15:al(y,C,F,te,x),Cc(8,C);break;case 23:break;case 22:var Me=C.stateNode;C.memoizedState!==null?Me._visibility&2?al(y,C,F,te,x):Dc(y,C):(Me._visibility|=2,al(y,C,F,te,x)),x&&he&2048&&Mh(C.alternate,C);break;case 24:al(y,C,F,te,x),x&&he&2048&&jh(C.alternate,C);break;default:al(y,C,F,te,x)}i=i.sibling}}function Dc(s,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=s,d=i,x=d.flags;switch(d.tag){case 22:Dc(c,d),x&2048&&Mh(d.alternate,d);break;case 24:Dc(c,d),x&2048&&jh(d.alternate,d);break;default:Dc(c,d)}i=i.sibling}}var Oc=8192;function nl(s){if(s.subtreeFlags&Oc)for(s=s.child;s!==null;)Tp(s),s=s.sibling}function Tp(s){switch(s.tag){case 26:nl(s),s.flags&Oc&&s.memoizedState!==null&&jA($n,s.memoizedState,s.memoizedProps);break;case 5:nl(s);break;case 3:case 4:var i=$n;$n=Jf(s.stateNode.containerInfo),nl(s),$n=i;break;case 22:s.memoizedState===null&&(i=s.alternate,i!==null&&i.memoizedState!==null?(i=Oc,Oc=16777216,nl(s),Oc=i):nl(s));break;default:nl(s)}}function kp(s){var i=s.alternate;if(i!==null&&(s=i.child,s!==null)){i.child=null;do i=s.sibling,s.sibling=null,s=i;while(s!==null)}}function Rc(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var d=i[c];ua=d,Cp(d,s)}kp(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Ap(s),s=s.sibling}function Ap(s){switch(s.tag){case 0:case 11:case 15:Rc(s),s.flags&2048&&li(9,s,s.return);break;case 3:Rc(s);break;case 12:Rc(s);break;case 22:var i=s.stateNode;s.memoizedState!==null&&i._visibility&2&&(s.return===null||s.return.tag!==13)?(i._visibility&=-3,Bf(s)):Rc(s);break;default:Rc(s)}}function Bf(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var d=i[c];ua=d,Cp(d,s)}kp(s)}for(s=s.child;s!==null;){switch(i=s,i.tag){case 0:case 11:case 15:li(8,i,i.return),Bf(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,Bf(i));break;default:Bf(i)}s=s.sibling}}function Cp(s,i){for(;ua!==null;){var c=ua;switch(c.tag){case 0:case 11:case 15:li(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:mc(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,ua=d;else e:for(c=s;ua!==null;){d=ua;var x=d.sibling,y=d.return;if(yp(d),d===c){ua=null;break e}if(x!==null){x.return=y,ua=x;break e}ua=y}}}var Jk={getCacheForType:function(s){var i=Aa(na),c=i.data.get(s);return c===void 0&&(c=s(),i.data.set(s,c)),c}},Qk=typeof WeakMap=="function"?WeakMap:Map,tr=0,_r=null,Ut=null,Gt=0,rr=0,rn=null,fi=!1,sl=!1,Ih=!1,Is=0,Lr=0,di=0,so=0,Ph=0,kn=0,il=0,Fc=null,Ga=null,Lh=!1,Bh=0,Uf=1/0,zf=null,hi=null,pa=0,mi=null,ol=null,ll=0,Uh=0,zh=null,Np=null,Mc=0,Vh=null;function an(){if((tr&2)!==0&&Gt!==0)return Gt&-Gt;if(q.T!==null){var s=Xo;return s!==0?s:Xh()}return Bn()}function Dp(){kn===0&&(kn=(Gt&536870912)===0||Qt?br():536870912);var s=Tn.current;return s!==null&&(s.flags|=32),kn}function nn(s,i,c){(s===_r&&(rr===2||rr===9)||s.cancelPendingCommit!==null)&&(cl(s,0),gi(s,Gt,kn,!1)),lt(s,c),((tr&2)===0||s!==_r)&&(s===_r&&((tr&2)===0&&(so|=c),Lr===4&&gi(s,Gt,kn,!1)),ls(s))}function Op(s,i,c){if((tr&6)!==0)throw Error(a(327));var d=!c&&(i&124)===0&&(i&s.expiredLanes)===0||gr(s,i),x=d?tA(s,i):Wh(s,i,!0),y=d;do{if(x===0){sl&&!d&&gi(s,i,0,!1);break}else{if(c=s.current.alternate,y&&!Zk(c)){x=Wh(s,i,!1),y=!1;continue}if(x===2){if(y=i,s.errorRecoveryDisabledLanes&y)var C=0;else C=s.pendingLanes&-536870913,C=C!==0?C:C&536870912?536870912:0;if(C!==0){i=C;e:{var F=s;x=Fc;var te=F.current.memoizedState.isDehydrated;if(te&&(cl(F,C).flags|=256),C=Wh(F,C,!1),C!==2){if(Ih&&!te){F.errorRecoveryDisabledLanes|=y,so|=y,x=4;break e}y=Ga,Ga=x,y!==null&&(Ga===null?Ga=y:Ga.push.apply(Ga,y))}x=C}if(y=!1,x!==2)continue}}if(x===1){cl(s,0),gi(s,i,0,!0);break}e:{switch(d=s,y=x,y){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:gi(d,i,kn,!fi);break e;case 2:Ga=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(x=Bh+300-Z(),10<x)){if(gi(d,i,kn,!fi),Nr(d,0,!0)!==0)break e;d.timeoutHandle=iy(Rp.bind(null,d,c,Ga,zf,Lh,i,kn,so,il,fi,y,2,-0,0),x);break e}Rp(d,c,Ga,zf,Lh,i,kn,so,il,fi,y,0,-0,0)}}break}while(!0);ls(s)}function Rp(s,i,c,d,x,y,C,F,te,he,Me,Le,pe,we){if(s.timeoutHandle=-1,Le=i.subtreeFlags,(Le&8192||(Le&16785408)===16785408)&&(zc={stylesheets:null,count:0,unsuspend:MA},Tp(i),Le=IA(),Le!==null)){s.cancelPendingCommit=Le(Bp.bind(null,s,i,y,c,d,x,C,F,te,Me,1,pe,we)),gi(s,y,C,!he);return}Bp(s,i,y,c,d,x,C,F,te)}function Zk(s){for(var i=s;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var x=c[d],y=x.getSnapshot;x=x.value;try{if(!Qa(y(),x))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function gi(s,i,c,d){i&=~Ph,i&=~so,s.suspendedLanes|=i,s.pingedLanes&=~i,d&&(s.warmLanes|=i),d=s.expirationTimes;for(var x=i;0<x;){var y=31-ke(x),C=1<<y;d[y]=-1,x&=~C}c!==0&&ct(s,c,i)}function Vf(){return(tr&6)===0?(jc(0),!1):!0}function Hh(){if(Ut!==null){if(rr===0)var s=Ut.return;else s=Ut,Cs=Zi=null,ih(s),tl=null,Tc=0,s=Ut;for(;s!==null;)fp(s.alternate,s),s=s.return;Ut=null}}function cl(s,i){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,vA(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),Hh(),_r=s,Ut=c=Ts(s.current,null),Gt=i,rr=0,rn=null,fi=!1,sl=gr(s,i),Ih=!1,il=kn=Ph=so=di=Lr=0,Ga=Fc=null,Lh=!1,(i&8)!==0&&(i|=i&32);var d=s.entangledLanes;if(d!==0)for(s=s.entanglements,d&=i;0<d;){var x=31-ke(d),y=1<<x;i|=s[x],d&=~y}return Is=i,uf(),c}function Fp(s,i){It=null,q.H=Nf,i===xc||i===yf?(i=Kx(),rr=3):i===qx?(i=Kx(),rr=4):rr=i===Jv?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,rn=i,Ut===null&&(Lr=1,Mf(s,wn(i,s.current)))}function Mp(){var s=q.H;return q.H=Nf,s===null?Nf:s}function jp(){var s=q.A;return q.A=Jk,s}function $h(){Lr=4,fi||(Gt&4194048)!==Gt&&Tn.current!==null||(sl=!0),(di&134217727)===0&&(so&134217727)===0||_r===null||gi(_r,Gt,kn,!1)}function Wh(s,i,c){var d=tr;tr|=2;var x=Mp(),y=jp();(_r!==s||Gt!==i)&&(zf=null,cl(s,i)),i=!1;var C=Lr;e:do try{if(rr!==0&&Ut!==null){var F=Ut,te=rn;switch(rr){case 8:Hh(),C=6;break e;case 3:case 2:case 9:case 6:Tn.current===null&&(i=!0);var he=rr;if(rr=0,rn=null,ul(s,F,te,he),c&&sl){C=0;break e}break;default:he=rr,rr=0,rn=null,ul(s,F,te,he)}}eA(),C=Lr;break}catch(Me){Fp(s,Me)}while(!0);return i&&s.shellSuspendCounter++,Cs=Zi=null,tr=d,q.H=x,q.A=y,Ut===null&&(_r=null,Gt=0,uf()),C}function eA(){for(;Ut!==null;)Ip(Ut)}function tA(s,i){var c=tr;tr|=2;var d=Mp(),x=jp();_r!==s||Gt!==i?(zf=null,Uf=Z()+500,cl(s,i)):sl=gr(s,i);e:do try{if(rr!==0&&Ut!==null){i=Ut;var y=rn;t:switch(rr){case 1:rr=0,rn=null,ul(s,i,y,1);break;case 2:case 9:if(Yx(y)){rr=0,rn=null,Pp(i);break}i=function(){rr!==2&&rr!==9||_r!==s||(rr=7),ls(s)},y.then(i,i);break e;case 3:rr=7;break e;case 4:rr=5;break e;case 7:Yx(y)?(rr=0,rn=null,Pp(i)):(rr=0,rn=null,ul(s,i,y,7));break;case 5:var C=null;switch(Ut.tag){case 26:C=Ut.memoizedState;case 5:case 27:var F=Ut;if(!C||py(C)){rr=0,rn=null;var te=F.sibling;if(te!==null)Ut=te;else{var he=F.return;he!==null?(Ut=he,Hf(he)):Ut=null}break t}}rr=0,rn=null,ul(s,i,y,5);break;case 6:rr=0,rn=null,ul(s,i,y,6);break;case 8:Hh(),Lr=6;break e;default:throw Error(a(462))}}rA();break}catch(Me){Fp(s,Me)}while(!0);return Cs=Zi=null,q.H=d,q.A=x,tr=c,Ut!==null?0:(_r=null,Gt=0,uf(),Lr)}function rA(){for(;Ut!==null&&!Pe();)Ip(Ut)}function Ip(s){var i=cp(s.alternate,s,Is);s.memoizedProps=s.pendingProps,i===null?Hf(s):Ut=i}function Pp(s){var i=s,c=i.alternate;switch(i.tag){case 15:case 0:i=ap(c,i,i.pendingProps,i.type,void 0,Gt);break;case 11:i=ap(c,i,i.pendingProps,i.type.render,i.ref,Gt);break;case 5:ih(i);default:fp(c,i),i=Ut=Lx(i,Is),i=cp(c,i,Is)}s.memoizedProps=s.pendingProps,i===null?Hf(s):Ut=i}function ul(s,i,c,d){Cs=Zi=null,ih(i),tl=null,Tc=0;var x=i.return;try{if(Wk(s,x,i,c,Gt)){Lr=1,Mf(s,wn(c,s.current)),Ut=null;return}}catch(y){if(x!==null)throw Ut=x,y;Lr=1,Mf(s,wn(c,s.current)),Ut=null;return}i.flags&32768?(Qt||d===1?s=!0:sl||(Gt&536870912)!==0?s=!1:(fi=s=!0,(d===2||d===9||d===3||d===6)&&(d=Tn.current,d!==null&&d.tag===13&&(d.flags|=16384))),Lp(i,s)):Hf(i)}function Hf(s){var i=s;do{if((i.flags&32768)!==0){Lp(i,fi);return}s=i.return;var c=qk(i.alternate,i,Is);if(c!==null){Ut=c;return}if(i=i.sibling,i!==null){Ut=i;return}Ut=i=s}while(i!==null);Lr===0&&(Lr=5)}function Lp(s,i){do{var c=Yk(s.alternate,s);if(c!==null){c.flags&=32767,Ut=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(s=s.sibling,s!==null)){Ut=s;return}Ut=s=c}while(s!==null);Lr=6,Ut=null}function Bp(s,i,c,d,x,y,C,F,te){s.cancelPendingCommit=null;do $f();while(pa!==0);if((tr&6)!==0)throw Error(a(327));if(i!==null){if(i===s.current)throw Error(a(177));if(y=i.lanes|i.childLanes,y|=jd,Ot(s,c,y,C,F,te),s===_r&&(Ut=_r=null,Gt=0),ol=i,mi=s,ll=c,Uh=y,zh=x,Np=d,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,iA(nt,function(){return $p(),null})):(s.callbackNode=null,s.callbackPriority=0),d=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||d){d=q.T,q.T=null,x=ae.p,ae.p=2,C=tr,tr|=4;try{Xk(s,i,c)}finally{tr=C,ae.p=x,q.T=d}}pa=1,Up(),zp(),Vp()}}function Up(){if(pa===1){pa=0;var s=mi,i=ol,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=q.T,q.T=null;var d=ae.p;ae.p=2;var x=tr;tr|=4;try{bp(i,s);var y=am,C=Cx(s.containerInfo),F=y.focusedElem,te=y.selectionRange;if(C!==F&&F&&F.ownerDocument&&Ax(F.ownerDocument.documentElement,F)){if(te!==null&&Dd(F)){var he=te.start,Me=te.end;if(Me===void 0&&(Me=he),"selectionStart"in F)F.selectionStart=he,F.selectionEnd=Math.min(Me,F.value.length);else{var Le=F.ownerDocument||document,pe=Le&&Le.defaultView||window;if(pe.getSelection){var we=pe.getSelection(),St=F.textContent.length,vt=Math.min(te.start,St),hr=te.end===void 0?vt:Math.min(te.end,St);!we.extend&&vt>hr&&(C=hr,hr=vt,vt=C);var oe=kx(F,vt),se=kx(F,hr);if(oe&&se&&(we.rangeCount!==1||we.anchorNode!==oe.node||we.anchorOffset!==oe.offset||we.focusNode!==se.node||we.focusOffset!==se.offset)){var ue=Le.createRange();ue.setStart(oe.node,oe.offset),we.removeAllRanges(),vt>hr?(we.addRange(ue),we.extend(se.node,se.offset)):(ue.setEnd(se.node,se.offset),we.addRange(ue))}}}}for(Le=[],we=F;we=we.parentNode;)we.nodeType===1&&Le.push({element:we,left:we.scrollLeft,top:we.scrollTop});for(typeof F.focus=="function"&&F.focus(),F=0;F<Le.length;F++){var Ie=Le[F];Ie.element.scrollLeft=Ie.left,Ie.element.scrollTop=Ie.top}}r0=!!rm,am=rm=null}finally{tr=x,ae.p=d,q.T=c}}s.current=i,pa=2}}function zp(){if(pa===2){pa=0;var s=mi,i=ol,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=q.T,q.T=null;var d=ae.p;ae.p=2;var x=tr;tr|=4;try{pp(s,i.alternate,i)}finally{tr=x,ae.p=d,q.T=c}}pa=3}}function Vp(){if(pa===4||pa===3){pa=0,Se();var s=mi,i=ol,c=ll,d=Np;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?pa=5:(pa=0,ol=mi=null,Hp(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(hi=null),pr(c),i=i.stateNode,et&&typeof et.onCommitFiberRoot=="function")try{et.onCommitFiberRoot(Qe,i,void 0,(i.current.flags&128)===128)}catch{}if(d!==null){i=q.T,x=ae.p,ae.p=2,q.T=null;try{for(var y=s.onRecoverableError,C=0;C<d.length;C++){var F=d[C];y(F.value,{componentStack:F.stack})}}finally{q.T=i,ae.p=x}}(ll&3)!==0&&$f(),ls(s),x=s.pendingLanes,(c&4194090)!==0&&(x&42)!==0?s===Vh?Mc++:(Mc=0,Vh=s):Mc=0,jc(0)}}function Hp(s,i){(s.pooledCacheLanes&=i)===0&&(i=s.pooledCache,i!=null&&(s.pooledCache=null,mc(i)))}function $f(s){return Up(),zp(),Vp(),$p()}function $p(){if(pa!==5)return!1;var s=mi,i=Uh;Uh=0;var c=pr(ll),d=q.T,x=ae.p;try{ae.p=32>c?32:c,q.T=null,c=zh,zh=null;var y=mi,C=ll;if(pa=0,ol=mi=null,ll=0,(tr&6)!==0)throw Error(a(331));var F=tr;if(tr|=4,Ap(y.current),Ep(y,y.current,C,c),tr=F,jc(0,!1),et&&typeof et.onPostCommitFiberRoot=="function")try{et.onPostCommitFiberRoot(Qe,y)}catch{}return!0}finally{ae.p=x,q.T=d,Hp(s,i)}}function Wp(s,i,c){i=wn(c,i),i=_h(s.stateNode,i,2),s=ni(s,i,2),s!==null&&(lt(s,2),ls(s))}function vr(s,i,c){if(s.tag===3)Wp(s,s,c);else for(;i!==null;){if(i.tag===3){Wp(i,s,c);break}else if(i.tag===1){var d=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(hi===null||!hi.has(d))){s=wn(c,s),c=Xv(2),d=ni(i,c,2),d!==null&&(Kv(c,d,i,s),lt(d,2),ls(d));break}}i=i.return}}function Gh(s,i,c){var d=s.pingCache;if(d===null){d=s.pingCache=new Qk;var x=new Set;d.set(i,x)}else x=d.get(i),x===void 0&&(x=new Set,d.set(i,x));x.has(c)||(Ih=!0,x.add(c),s=aA.bind(null,s,i,c),i.then(s,s))}function aA(s,i,c){var d=s.pingCache;d!==null&&d.delete(i),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,_r===s&&(Gt&c)===c&&(Lr===4||Lr===3&&(Gt&62914560)===Gt&&300>Z()-Bh?(tr&2)===0&&cl(s,0):Ph|=c,il===Gt&&(il=0)),ls(s)}function Gp(s,i){i===0&&(i=ft()),s=Wo(s,i),s!==null&&(lt(s,i),ls(s))}function nA(s){var i=s.memoizedState,c=0;i!==null&&(c=i.retryLane),Gp(s,c)}function sA(s,i){var c=0;switch(s.tag){case 13:var d=s.stateNode,x=s.memoizedState;x!==null&&(c=x.retryLane);break;case 19:d=s.stateNode;break;case 22:d=s.stateNode._retryCache;break;default:throw Error(a(314))}d!==null&&d.delete(i),Gp(s,c)}function iA(s,i){return O(s,i)}var Wf=null,fl=null,qh=!1,Gf=!1,Yh=!1,io=0;function ls(s){s!==fl&&s.next===null&&(fl===null?Wf=fl=s:fl=fl.next=s),Gf=!0,qh||(qh=!0,lA())}function jc(s,i){if(!Yh&&Gf){Yh=!0;do for(var c=!1,d=Wf;d!==null;){if(s!==0){var x=d.pendingLanes;if(x===0)var y=0;else{var C=d.suspendedLanes,F=d.pingedLanes;y=(1<<31-ke(42|s)+1)-1,y&=x&~(C&~F),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(c=!0,Kp(d,y))}else y=Gt,y=Nr(d,d===_r?y:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(y&3)===0||gr(d,y)||(c=!0,Kp(d,y));d=d.next}while(c);Yh=!1}}function oA(){qp()}function qp(){Gf=qh=!1;var s=0;io!==0&&(xA()&&(s=io),io=0);for(var i=Z(),c=null,d=Wf;d!==null;){var x=d.next,y=Yp(d,i);y===0?(d.next=null,c===null?Wf=x:c.next=x,x===null&&(fl=c)):(c=d,(s!==0||(y&3)!==0)&&(Gf=!0)),d=x}jc(s)}function Yp(s,i){for(var c=s.suspendedLanes,d=s.pingedLanes,x=s.expirationTimes,y=s.pendingLanes&-62914561;0<y;){var C=31-ke(y),F=1<<C,te=x[C];te===-1?((F&c)===0||(F&d)!==0)&&(x[C]=xa(F,i)):te<=i&&(s.expiredLanes|=F),y&=~F}if(i=_r,c=Gt,c=Nr(s,s===i?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d=s.callbackNode,c===0||s===i&&(rr===2||rr===9)||s.cancelPendingCommit!==null)return d!==null&&d!==null&&Ae(d),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||gr(s,c)){if(i=c&-c,i===s.callbackPriority)return i;switch(d!==null&&Ae(d),pr(c)){case 2:case 8:c=kt;break;case 32:c=nt;break;case 268435456:c=Ze;break;default:c=nt}return d=Xp.bind(null,s),c=O(c,d),s.callbackPriority=i,s.callbackNode=c,i}return d!==null&&d!==null&&Ae(d),s.callbackPriority=2,s.callbackNode=null,2}function Xp(s,i){if(pa!==0&&pa!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if($f()&&s.callbackNode!==c)return null;var d=Gt;return d=Nr(s,s===_r?d:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d===0?null:(Op(s,d,i),Yp(s,Z()),s.callbackNode!=null&&s.callbackNode===c?Xp.bind(null,s):null)}function Kp(s,i){if($f())return null;Op(s,i,!0)}function lA(){pA(function(){(tr&6)!==0?O(Ge,oA):qp()})}function Xh(){return io===0&&(io=br()),io}function Jp(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:rf(""+s)}function Qp(s,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,s.id&&c.setAttribute("form",s.id),i.parentNode.insertBefore(c,i),s=new FormData(s),c.parentNode.removeChild(c),s}function cA(s,i,c,d,x){if(i==="submit"&&c&&c.stateNode===x){var y=Jp((x[er]||null).action),C=d.submitter;C&&(i=(i=C[er]||null)?Jp(i.formAction):C.getAttribute("formAction"),i!==null&&(y=i,C=null));var F=new of("action","action",null,d,x);s.push({event:F,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(io!==0){var te=C?Qp(x,C):new FormData(x);gh(c,{pending:!0,data:te,method:x.method,action:y},null,te)}}else typeof y=="function"&&(F.preventDefault(),te=C?Qp(x,C):new FormData(x),gh(c,{pending:!0,data:te,method:x.method,action:y},y,te))},currentTarget:x}]})}}for(var Kh=0;Kh<Md.length;Kh++){var Jh=Md[Kh],uA=Jh.toLowerCase(),fA=Jh[0].toUpperCase()+Jh.slice(1);Hn(uA,"on"+fA)}Hn(Ox,"onAnimationEnd"),Hn(Rx,"onAnimationIteration"),Hn(Fx,"onAnimationStart"),Hn("dblclick","onDoubleClick"),Hn("focusin","onFocus"),Hn("focusout","onBlur"),Hn(Ck,"onTransitionRun"),Hn(Nk,"onTransitionStart"),Hn(Dk,"onTransitionCancel"),Hn(Mx,"onTransitionEnd"),$e("onMouseEnter",["mouseout","mouseover"]),$e("onMouseLeave",["mouseout","mouseover"]),$e("onPointerEnter",["pointerout","pointerover"]),$e("onPointerLeave",["pointerout","pointerover"]),Ue("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ue("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ue("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ue("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ue("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ue("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ic="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ic));function Zp(s,i){i=(i&4)!==0;for(var c=0;c<s.length;c++){var d=s[c],x=d.event;d=d.listeners;e:{var y=void 0;if(i)for(var C=d.length-1;0<=C;C--){var F=d[C],te=F.instance,he=F.currentTarget;if(F=F.listener,te!==y&&x.isPropagationStopped())break e;y=F,x.currentTarget=he;try{y(x)}catch(Me){Ff(Me)}x.currentTarget=null,y=te}else for(C=0;C<d.length;C++){if(F=d[C],te=F.instance,he=F.currentTarget,F=F.listener,te!==y&&x.isPropagationStopped())break e;y=F,x.currentTarget=he;try{y(x)}catch(Me){Ff(Me)}x.currentTarget=null,y=te}}}}function zt(s,i){var c=i[Qs];c===void 0&&(c=i[Qs]=new Set);var d=s+"__bubble";c.has(d)||(ey(i,s,2,!1),c.add(d))}function Qh(s,i,c){var d=0;i&&(d|=4),ey(c,s,d,i)}var qf="_reactListening"+Math.random().toString(36).slice(2);function Zh(s){if(!s[qf]){s[qf]=!0,ve.forEach(function(c){c!=="selectionchange"&&(dA.has(c)||Qh(c,!1,s),Qh(c,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[qf]||(i[qf]=!0,Qh("selectionchange",!1,i))}}function ey(s,i,c,d){switch(Ey(i)){case 2:var x=BA;break;case 8:x=UA;break;default:x=hm}c=x.bind(null,i,c,s),x=void 0,!wd||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(x=!0),d?x!==void 0?s.addEventListener(i,c,{capture:!0,passive:x}):s.addEventListener(i,c,!0):x!==void 0?s.addEventListener(i,c,{passive:x}):s.addEventListener(i,c,!1)}function em(s,i,c,d,x){var y=d;if((i&1)===0&&(i&2)===0&&d!==null)e:for(;;){if(d===null)return;var C=d.tag;if(C===3||C===4){var F=d.stateNode.containerInfo;if(F===x)break;if(C===4)for(C=d.return;C!==null;){var te=C.tag;if((te===3||te===4)&&C.stateNode.containerInfo===x)return;C=C.return}for(;F!==null;){if(C=W(F),C===null)return;if(te=C.tag,te===5||te===6||te===26||te===27){d=y=C;continue e}F=F.parentNode}}d=d.return}ox(function(){var he=y,Me=yd(c),Le=[];e:{var pe=jx.get(s);if(pe!==void 0){var we=of,St=s;switch(s){case"keypress":if(nf(c)===0)break e;case"keydown":case"keyup":we=ik;break;case"focusin":St="focus",we=Td;break;case"focusout":St="blur",we=Td;break;case"beforeblur":case"afterblur":we=Td;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":we=ux;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":we=YT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":we=ck;break;case Ox:case Rx:case Fx:we=JT;break;case Mx:we=fk;break;case"scroll":case"scrollend":we=GT;break;case"wheel":we=hk;break;case"copy":case"cut":case"paste":we=ZT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":we=dx;break;case"toggle":case"beforetoggle":we=gk}var vt=(i&4)!==0,hr=!vt&&(s==="scroll"||s==="scrollend"),oe=vt?pe!==null?pe+"Capture":null:pe;vt=[];for(var se=he,ue;se!==null;){var Ie=se;if(ue=Ie.stateNode,Ie=Ie.tag,Ie!==5&&Ie!==26&&Ie!==27||ue===null||oe===null||(Ie=tc(se,oe),Ie!=null&&vt.push(Pc(se,Ie,ue))),hr)break;se=se.return}0<vt.length&&(pe=new we(pe,St,null,c,Me),Le.push({event:pe,listeners:vt}))}}if((i&7)===0){e:{if(pe=s==="mouseover"||s==="pointerover",we=s==="mouseout"||s==="pointerout",pe&&c!==pd&&(St=c.relatedTarget||c.fromElement)&&(W(St)||St[Xr]))break e;if((we||pe)&&(pe=Me.window===Me?Me:(pe=Me.ownerDocument)?pe.defaultView||pe.parentWindow:window,we?(St=c.relatedTarget||c.toElement,we=he,St=St?W(St):null,St!==null&&(hr=o(St),vt=St.tag,St!==hr||vt!==5&&vt!==27&&vt!==6)&&(St=null)):(we=null,St=he),we!==St)){if(vt=ux,Ie="onMouseLeave",oe="onMouseEnter",se="mouse",(s==="pointerout"||s==="pointerover")&&(vt=dx,Ie="onPointerLeave",oe="onPointerEnter",se="pointer"),hr=we==null?pe:me(we),ue=St==null?pe:me(St),pe=new vt(Ie,se+"leave",we,c,Me),pe.target=hr,pe.relatedTarget=ue,Ie=null,W(Me)===he&&(vt=new vt(oe,se+"enter",St,c,Me),vt.target=ue,vt.relatedTarget=hr,Ie=vt),hr=Ie,we&&St)t:{for(vt=we,oe=St,se=0,ue=vt;ue;ue=dl(ue))se++;for(ue=0,Ie=oe;Ie;Ie=dl(Ie))ue++;for(;0<se-ue;)vt=dl(vt),se--;for(;0<ue-se;)oe=dl(oe),ue--;for(;se--;){if(vt===oe||oe!==null&&vt===oe.alternate)break t;vt=dl(vt),oe=dl(oe)}vt=null}else vt=null;we!==null&&ty(Le,pe,we,vt,!1),St!==null&&hr!==null&&ty(Le,hr,St,vt,!0)}}e:{if(pe=he?me(he):window,we=pe.nodeName&&pe.nodeName.toLowerCase(),we==="select"||we==="input"&&pe.type==="file")var it=_x;else if(px(pe))if(wx)it=Tk;else{it=Sk;var Lt=bk}else we=pe.nodeName,!we||we.toLowerCase()!=="input"||pe.type!=="checkbox"&&pe.type!=="radio"?he&&vd(he.elementType)&&(it=_x):it=Ek;if(it&&(it=it(s,he))){yx(Le,it,c,Me);break e}Lt&&Lt(s,pe,he),s==="focusout"&&he&&pe.type==="number"&&he.memoizedProps.value!=null&&xd(pe,"number",pe.value)}switch(Lt=he?me(he):window,s){case"focusin":(px(Lt)||Lt.contentEditable==="true")&&(Vo=Lt,Od=he,cc=null);break;case"focusout":cc=Od=Vo=null;break;case"mousedown":Rd=!0;break;case"contextmenu":case"mouseup":case"dragend":Rd=!1,Nx(Le,c,Me);break;case"selectionchange":if(Ak)break;case"keydown":case"keyup":Nx(Le,c,Me)}var dt;if(Ad)e:{switch(s){case"compositionstart":var pt="onCompositionStart";break e;case"compositionend":pt="onCompositionEnd";break e;case"compositionupdate":pt="onCompositionUpdate";break e}pt=void 0}else zo?xx(s,c)&&(pt="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(pt="onCompositionStart");pt&&(hx&&c.locale!=="ko"&&(zo||pt!=="onCompositionStart"?pt==="onCompositionEnd"&&zo&&(dt=lx()):(ei=Me,bd="value"in ei?ei.value:ei.textContent,zo=!0)),Lt=Yf(he,pt),0<Lt.length&&(pt=new fx(pt,s,null,c,Me),Le.push({event:pt,listeners:Lt}),dt?pt.data=dt:(dt=vx(c),dt!==null&&(pt.data=dt)))),(dt=vk?pk(s,c):yk(s,c))&&(pt=Yf(he,"onBeforeInput"),0<pt.length&&(Lt=new fx("onBeforeInput","beforeinput",null,c,Me),Le.push({event:Lt,listeners:pt}),Lt.data=dt)),cA(Le,s,he,c,Me)}Zp(Le,i)})}function Pc(s,i,c){return{instance:s,listener:i,currentTarget:c}}function Yf(s,i){for(var c=i+"Capture",d=[];s!==null;){var x=s,y=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||y===null||(x=tc(s,c),x!=null&&d.unshift(Pc(s,x,y)),x=tc(s,i),x!=null&&d.push(Pc(s,x,y))),s.tag===3)return d;s=s.return}return[]}function dl(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function ty(s,i,c,d,x){for(var y=i._reactName,C=[];c!==null&&c!==d;){var F=c,te=F.alternate,he=F.stateNode;if(F=F.tag,te!==null&&te===d)break;F!==5&&F!==26&&F!==27||he===null||(te=he,x?(he=tc(c,y),he!=null&&C.unshift(Pc(c,he,te))):x||(he=tc(c,y),he!=null&&C.push(Pc(c,he,te)))),c=c.return}C.length!==0&&s.push({event:i,listeners:C})}var hA=/\r\n?/g,mA=/\u0000|\uFFFD/g;function ry(s){return(typeof s=="string"?s:""+s).replace(hA,`
`).replace(mA,"")}function ay(s,i){return i=ry(i),ry(s)===i}function Xf(){}function dr(s,i,c,d,x,y){switch(c){case"children":typeof d=="string"?i==="body"||i==="textarea"&&d===""||Lo(s,d):(typeof d=="number"||typeof d=="bigint")&&i!=="body"&&Lo(s,""+d);break;case"className":ur(s,"class",d);break;case"tabIndex":ur(s,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":ur(s,c,d);break;case"style":sx(s,d,y);break;case"data":if(i!=="object"){ur(s,"data",d);break}case"src":case"href":if(d===""&&(i!=="a"||c!=="href")){s.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(c);break}d=rf(""+d),s.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(c==="formAction"?(i!=="input"&&dr(s,i,"name",x.name,x,null),dr(s,i,"formEncType",x.formEncType,x,null),dr(s,i,"formMethod",x.formMethod,x,null),dr(s,i,"formTarget",x.formTarget,x,null)):(dr(s,i,"encType",x.encType,x,null),dr(s,i,"method",x.method,x,null),dr(s,i,"target",x.target,x,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(c);break}d=rf(""+d),s.setAttribute(c,d);break;case"onClick":d!=null&&(s.onclick=Xf);break;case"onScroll":d!=null&&zt("scroll",s);break;case"onScrollEnd":d!=null&&zt("scrollend",s);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(a(61));if(c=d.__html,c!=null){if(x.children!=null)throw Error(a(60));s.innerHTML=c}}break;case"multiple":s.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":s.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){s.removeAttribute("xlink:href");break}c=rf(""+d),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,""+d):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":d===!0?s.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,d):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?s.setAttribute(c,d):s.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?s.removeAttribute(c):s.setAttribute(c,d);break;case"popover":zt("beforetoggle",s),zt("toggle",s),cr(s,"popover",d);break;case"xlinkActuate":yr(s,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":yr(s,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":yr(s,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":yr(s,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":yr(s,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":yr(s,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":yr(s,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":yr(s,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":yr(s,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":cr(s,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=$T.get(c)||c,cr(s,c,d))}}function tm(s,i,c,d,x,y){switch(c){case"style":sx(s,d,y);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(a(61));if(c=d.__html,c!=null){if(x.children!=null)throw Error(a(60));s.innerHTML=c}}break;case"children":typeof d=="string"?Lo(s,d):(typeof d=="number"||typeof d=="bigint")&&Lo(s,""+d);break;case"onScroll":d!=null&&zt("scroll",s);break;case"onScrollEnd":d!=null&&zt("scrollend",s);break;case"onClick":d!=null&&(s.onclick=Xf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!_e.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(x=c.endsWith("Capture"),i=c.slice(2,x?c.length-7:void 0),y=s[er]||null,y=y!=null?y[c]:null,typeof y=="function"&&s.removeEventListener(i,y,x),typeof d=="function")){typeof y!="function"&&y!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(i,d,x);break e}c in s?s[c]=d:d===!0?s.setAttribute(c,""):cr(s,c,d)}}}function ya(s,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":zt("error",s),zt("load",s);var d=!1,x=!1,y;for(y in c)if(c.hasOwnProperty(y)){var C=c[y];if(C!=null)switch(y){case"src":d=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:dr(s,i,y,C,c,null)}}x&&dr(s,i,"srcSet",c.srcSet,c,null),d&&dr(s,i,"src",c.src,c,null);return;case"input":zt("invalid",s);var F=y=C=x=null,te=null,he=null;for(d in c)if(c.hasOwnProperty(d)){var Me=c[d];if(Me!=null)switch(d){case"name":x=Me;break;case"type":C=Me;break;case"checked":te=Me;break;case"defaultChecked":he=Me;break;case"value":y=Me;break;case"defaultValue":F=Me;break;case"children":case"dangerouslySetInnerHTML":if(Me!=null)throw Error(a(137,i));break;default:dr(s,i,d,Me,c,null)}}tx(s,y,F,te,he,C,x,!1),ef(s);return;case"select":zt("invalid",s),d=C=y=null;for(x in c)if(c.hasOwnProperty(x)&&(F=c[x],F!=null))switch(x){case"value":y=F;break;case"defaultValue":C=F;break;case"multiple":d=F;default:dr(s,i,x,F,c,null)}i=y,c=C,s.multiple=!!d,i!=null?Po(s,!!d,i,!1):c!=null&&Po(s,!!d,c,!0);return;case"textarea":zt("invalid",s),y=x=d=null;for(C in c)if(c.hasOwnProperty(C)&&(F=c[C],F!=null))switch(C){case"value":d=F;break;case"defaultValue":x=F;break;case"children":y=F;break;case"dangerouslySetInnerHTML":if(F!=null)throw Error(a(91));break;default:dr(s,i,C,F,c,null)}ax(s,d,x,y),ef(s);return;case"option":for(te in c)if(c.hasOwnProperty(te)&&(d=c[te],d!=null))switch(te){case"selected":s.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:dr(s,i,te,d,c,null)}return;case"dialog":zt("beforetoggle",s),zt("toggle",s),zt("cancel",s),zt("close",s);break;case"iframe":case"object":zt("load",s);break;case"video":case"audio":for(d=0;d<Ic.length;d++)zt(Ic[d],s);break;case"image":zt("error",s),zt("load",s);break;case"details":zt("toggle",s);break;case"embed":case"source":case"link":zt("error",s),zt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(he in c)if(c.hasOwnProperty(he)&&(d=c[he],d!=null))switch(he){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:dr(s,i,he,d,c,null)}return;default:if(vd(i)){for(Me in c)c.hasOwnProperty(Me)&&(d=c[Me],d!==void 0&&tm(s,i,Me,d,c,void 0));return}}for(F in c)c.hasOwnProperty(F)&&(d=c[F],d!=null&&dr(s,i,F,d,c,null))}function gA(s,i,c,d){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,y=null,C=null,F=null,te=null,he=null,Me=null;for(we in c){var Le=c[we];if(c.hasOwnProperty(we)&&Le!=null)switch(we){case"checked":break;case"value":break;case"defaultValue":te=Le;default:d.hasOwnProperty(we)||dr(s,i,we,null,d,Le)}}for(var pe in d){var we=d[pe];if(Le=c[pe],d.hasOwnProperty(pe)&&(we!=null||Le!=null))switch(pe){case"type":y=we;break;case"name":x=we;break;case"checked":he=we;break;case"defaultChecked":Me=we;break;case"value":C=we;break;case"defaultValue":F=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(a(137,i));break;default:we!==Le&&dr(s,i,pe,we,d,Le)}}gd(s,C,F,te,he,Me,y,x);return;case"select":we=C=F=pe=null;for(y in c)if(te=c[y],c.hasOwnProperty(y)&&te!=null)switch(y){case"value":break;case"multiple":we=te;default:d.hasOwnProperty(y)||dr(s,i,y,null,d,te)}for(x in d)if(y=d[x],te=c[x],d.hasOwnProperty(x)&&(y!=null||te!=null))switch(x){case"value":pe=y;break;case"defaultValue":F=y;break;case"multiple":C=y;default:y!==te&&dr(s,i,x,y,d,te)}i=F,c=C,d=we,pe!=null?Po(s,!!c,pe,!1):!!d!=!!c&&(i!=null?Po(s,!!c,i,!0):Po(s,!!c,c?[]:"",!1));return;case"textarea":we=pe=null;for(F in c)if(x=c[F],c.hasOwnProperty(F)&&x!=null&&!d.hasOwnProperty(F))switch(F){case"value":break;case"children":break;default:dr(s,i,F,null,d,x)}for(C in d)if(x=d[C],y=c[C],d.hasOwnProperty(C)&&(x!=null||y!=null))switch(C){case"value":pe=x;break;case"defaultValue":we=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(a(91));break;default:x!==y&&dr(s,i,C,x,d,y)}rx(s,pe,we);return;case"option":for(var St in c)if(pe=c[St],c.hasOwnProperty(St)&&pe!=null&&!d.hasOwnProperty(St))switch(St){case"selected":s.selected=!1;break;default:dr(s,i,St,null,d,pe)}for(te in d)if(pe=d[te],we=c[te],d.hasOwnProperty(te)&&pe!==we&&(pe!=null||we!=null))switch(te){case"selected":s.selected=pe&&typeof pe!="function"&&typeof pe!="symbol";break;default:dr(s,i,te,pe,d,we)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var vt in c)pe=c[vt],c.hasOwnProperty(vt)&&pe!=null&&!d.hasOwnProperty(vt)&&dr(s,i,vt,null,d,pe);for(he in d)if(pe=d[he],we=c[he],d.hasOwnProperty(he)&&pe!==we&&(pe!=null||we!=null))switch(he){case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(a(137,i));break;default:dr(s,i,he,pe,d,we)}return;default:if(vd(i)){for(var hr in c)pe=c[hr],c.hasOwnProperty(hr)&&pe!==void 0&&!d.hasOwnProperty(hr)&&tm(s,i,hr,void 0,d,pe);for(Me in d)pe=d[Me],we=c[Me],!d.hasOwnProperty(Me)||pe===we||pe===void 0&&we===void 0||tm(s,i,Me,pe,d,we);return}}for(var oe in c)pe=c[oe],c.hasOwnProperty(oe)&&pe!=null&&!d.hasOwnProperty(oe)&&dr(s,i,oe,null,d,pe);for(Le in d)pe=d[Le],we=c[Le],!d.hasOwnProperty(Le)||pe===we||pe==null&&we==null||dr(s,i,Le,pe,d,we)}var rm=null,am=null;function Kf(s){return s.nodeType===9?s:s.ownerDocument}function ny(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function sy(s,i){if(s===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&i==="foreignObject"?0:s}function nm(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var sm=null;function xA(){var s=window.event;return s&&s.type==="popstate"?s===sm?!1:(sm=s,!0):(sm=null,!1)}var iy=typeof setTimeout=="function"?setTimeout:void 0,vA=typeof clearTimeout=="function"?clearTimeout:void 0,oy=typeof Promise=="function"?Promise:void 0,pA=typeof queueMicrotask=="function"?queueMicrotask:typeof oy<"u"?function(s){return oy.resolve(null).then(s).catch(yA)}:iy;function yA(s){setTimeout(function(){throw s})}function xi(s){return s==="head"}function ly(s,i){var c=i,d=0,x=0;do{var y=c.nextSibling;if(s.removeChild(c),y&&y.nodeType===8)if(c=y.data,c==="/$"){if(0<d&&8>d){c=d;var C=s.ownerDocument;if(c&1&&Lc(C.documentElement),c&2&&Lc(C.body),c&4)for(c=C.head,Lc(c),C=c.firstChild;C;){var F=C.nextSibling,te=C.nodeName;C[L]||te==="SCRIPT"||te==="STYLE"||te==="LINK"&&C.rel.toLowerCase()==="stylesheet"||c.removeChild(C),C=F}}if(x===0){s.removeChild(y),Gc(i);return}x--}else c==="$"||c==="$?"||c==="$!"?x++:d=c.charCodeAt(0)-48;else d=0;c=y}while(c);Gc(i)}function im(s){var i=s.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":im(c),V(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function _A(s,i,c,d){for(;s.nodeType===1;){var x=c;if(s.nodeName.toLowerCase()!==i.toLowerCase()){if(!d&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(d){if(!s[L])switch(i){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(y=s.getAttribute("rel"),y==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(y!==x.rel||s.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||s.getAttribute("title")!==(x.title==null?null:x.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(y=s.getAttribute("src"),(y!==(x.src==null?null:x.src)||s.getAttribute("type")!==(x.type==null?null:x.type)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&y&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(i==="input"&&s.type==="hidden"){var y=x.name==null?null:""+x.name;if(x.type==="hidden"&&s.getAttribute("name")===y)return s}else return s;if(s=Wn(s.nextSibling),s===null)break}return null}function wA(s,i,c){if(i==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=Wn(s.nextSibling),s===null))return null;return s}function om(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function bA(s,i){var c=s.ownerDocument;if(s.data!=="$?"||c.readyState==="complete")i();else{var d=function(){i(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),s._reactRetry=d}}function Wn(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return s}var lm=null;function cy(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"){if(i===0)return s;i--}else c==="/$"&&i++}s=s.previousSibling}return null}function uy(s,i,c){switch(i=Kf(c),s){case"html":if(s=i.documentElement,!s)throw Error(a(452));return s;case"head":if(s=i.head,!s)throw Error(a(453));return s;case"body":if(s=i.body,!s)throw Error(a(454));return s;default:throw Error(a(451))}}function Lc(s){for(var i=s.attributes;i.length;)s.removeAttributeNode(i[0]);V(s)}var An=new Map,fy=new Set;function Jf(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Ps=ae.d;ae.d={f:SA,r:EA,D:TA,C:kA,L:AA,m:CA,X:DA,S:NA,M:OA};function SA(){var s=Ps.f(),i=Vf();return s||i}function EA(s){var i=J(s);i!==null&&i.tag===5&&i.type==="form"?Ov(i):Ps.r(s)}var hl=typeof document>"u"?null:document;function dy(s,i,c){var d=hl;if(d&&typeof i=="string"&&i){var x=_n(i);x='link[rel="'+s+'"][href="'+x+'"]',typeof c=="string"&&(x+='[crossorigin="'+c+'"]'),fy.has(x)||(fy.add(x),s={rel:s,crossOrigin:c,href:i},d.querySelector(x)===null&&(i=d.createElement("link"),ya(i,"link",s),ce(i),d.head.appendChild(i)))}}function TA(s){Ps.D(s),dy("dns-prefetch",s,null)}function kA(s,i){Ps.C(s,i),dy("preconnect",s,i)}function AA(s,i,c){Ps.L(s,i,c);var d=hl;if(d&&s&&i){var x='link[rel="preload"][as="'+_n(i)+'"]';i==="image"&&c&&c.imageSrcSet?(x+='[imagesrcset="'+_n(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(x+='[imagesizes="'+_n(c.imageSizes)+'"]')):x+='[href="'+_n(s)+'"]';var y=x;switch(i){case"style":y=ml(s);break;case"script":y=gl(s)}An.has(y)||(s=g({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:s,as:i},c),An.set(y,s),d.querySelector(x)!==null||i==="style"&&d.querySelector(Bc(y))||i==="script"&&d.querySelector(Uc(y))||(i=d.createElement("link"),ya(i,"link",s),ce(i),d.head.appendChild(i)))}}function CA(s,i){Ps.m(s,i);var c=hl;if(c&&s){var d=i&&typeof i.as=="string"?i.as:"script",x='link[rel="modulepreload"][as="'+_n(d)+'"][href="'+_n(s)+'"]',y=x;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=gl(s)}if(!An.has(y)&&(s=g({rel:"modulepreload",href:s},i),An.set(y,s),c.querySelector(x)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Uc(y)))return}d=c.createElement("link"),ya(d,"link",s),ce(d),c.head.appendChild(d)}}}function NA(s,i,c){Ps.S(s,i,c);var d=hl;if(d&&s){var x=Ce(d).hoistableStyles,y=ml(s);i=i||"default";var C=x.get(y);if(!C){var F={loading:0,preload:null};if(C=d.querySelector(Bc(y)))F.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":i},c),(c=An.get(y))&&cm(s,c);var te=C=d.createElement("link");ce(te),ya(te,"link",s),te._p=new Promise(function(he,Me){te.onload=he,te.onerror=Me}),te.addEventListener("load",function(){F.loading|=1}),te.addEventListener("error",function(){F.loading|=2}),F.loading|=4,Qf(C,i,d)}C={type:"stylesheet",instance:C,count:1,state:F},x.set(y,C)}}}function DA(s,i){Ps.X(s,i);var c=hl;if(c&&s){var d=Ce(c).hoistableScripts,x=gl(s),y=d.get(x);y||(y=c.querySelector(Uc(x)),y||(s=g({src:s,async:!0},i),(i=An.get(x))&&um(s,i),y=c.createElement("script"),ce(y),ya(y,"link",s),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(x,y))}}function OA(s,i){Ps.M(s,i);var c=hl;if(c&&s){var d=Ce(c).hoistableScripts,x=gl(s),y=d.get(x);y||(y=c.querySelector(Uc(x)),y||(s=g({src:s,async:!0,type:"module"},i),(i=An.get(x))&&um(s,i),y=c.createElement("script"),ce(y),ya(y,"link",s),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(x,y))}}function hy(s,i,c,d){var x=(x=de.current)?Jf(x):null;if(!x)throw Error(a(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=ml(c.href),c=Ce(x).hoistableStyles,d=c.get(i),d||(d={type:"style",instance:null,count:0,state:null},c.set(i,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=ml(c.href);var y=Ce(x).hoistableStyles,C=y.get(s);if(C||(x=x.ownerDocument||x,C={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(s,C),(y=x.querySelector(Bc(s)))&&!y._p&&(C.instance=y,C.state.loading=5),An.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},An.set(s,c),y||RA(x,s,c,C.state))),i&&d===null)throw Error(a(528,""));return C}if(i&&d!==null)throw Error(a(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=gl(c),c=Ce(x).hoistableScripts,d=c.get(i),d||(d={type:"script",instance:null,count:0,state:null},c.set(i,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,s))}}function ml(s){return'href="'+_n(s)+'"'}function Bc(s){return'link[rel="stylesheet"]['+s+"]"}function my(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function RA(s,i,c,d){s.querySelector('link[rel="preload"][as="style"]['+i+"]")?d.loading=1:(i=s.createElement("link"),d.preload=i,i.addEventListener("load",function(){return d.loading|=1}),i.addEventListener("error",function(){return d.loading|=2}),ya(i,"link",c),ce(i),s.head.appendChild(i))}function gl(s){return'[src="'+_n(s)+'"]'}function Uc(s){return"script[async]"+s}function gy(s,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var d=s.querySelector('style[data-href~="'+_n(c.href)+'"]');if(d)return i.instance=d,ce(d),d;var x=g({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(s.ownerDocument||s).createElement("style"),ce(d),ya(d,"style",x),Qf(d,c.precedence,s),i.instance=d;case"stylesheet":x=ml(c.href);var y=s.querySelector(Bc(x));if(y)return i.state.loading|=4,i.instance=y,ce(y),y;d=my(c),(x=An.get(x))&&cm(d,x),y=(s.ownerDocument||s).createElement("link"),ce(y);var C=y;return C._p=new Promise(function(F,te){C.onload=F,C.onerror=te}),ya(y,"link",d),i.state.loading|=4,Qf(y,c.precedence,s),i.instance=y;case"script":return y=gl(c.src),(x=s.querySelector(Uc(y)))?(i.instance=x,ce(x),x):(d=c,(x=An.get(y))&&(d=g({},c),um(d,x)),s=s.ownerDocument||s,x=s.createElement("script"),ce(x),ya(x,"link",d),s.head.appendChild(x),i.instance=x);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(d=i.instance,i.state.loading|=4,Qf(d,c.precedence,s));return i.instance}function Qf(s,i,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=d.length?d[d.length-1]:null,y=x,C=0;C<d.length;C++){var F=d[C];if(F.dataset.precedence===i)y=F;else if(y!==x)break}y?y.parentNode.insertBefore(s,y.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(s,i.firstChild))}function cm(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.title==null&&(s.title=i.title)}function um(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.integrity==null&&(s.integrity=i.integrity)}var Zf=null;function xy(s,i,c){if(Zf===null){var d=new Map,x=Zf=new Map;x.set(c,d)}else x=Zf,d=x.get(c),d||(d=new Map,x.set(c,d));if(d.has(s))return d;for(d.set(s,null),c=c.getElementsByTagName(s),x=0;x<c.length;x++){var y=c[x];if(!(y[L]||y[Or]||s==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var C=y.getAttribute(i)||"";C=s+C;var F=d.get(C);F?F.push(y):d.set(C,[y])}}return d}function vy(s,i,c){s=s.ownerDocument||s,s.head.insertBefore(c,i==="title"?s.querySelector("head > title"):null)}function FA(s,i,c){if(c===1||i.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return s=i.disabled,typeof i.precedence=="string"&&s==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function py(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var zc=null;function MA(){}function jA(s,i,c){if(zc===null)throw Error(a(475));var d=zc;if(i.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var x=ml(c.href),y=s.querySelector(Bc(x));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(d.count++,d=e0.bind(d),s.then(d,d)),i.state.loading|=4,i.instance=y,ce(y);return}y=s.ownerDocument||s,c=my(c),(x=An.get(x))&&cm(c,x),y=y.createElement("link"),ce(y);var C=y;C._p=new Promise(function(F,te){C.onload=F,C.onerror=te}),ya(y,"link",c),i.instance=y}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(i,s),(s=i.state.preload)&&(i.state.loading&3)===0&&(d.count++,i=e0.bind(d),s.addEventListener("load",i),s.addEventListener("error",i))}}function IA(){if(zc===null)throw Error(a(475));var s=zc;return s.stylesheets&&s.count===0&&fm(s,s.stylesheets),0<s.count?function(i){var c=setTimeout(function(){if(s.stylesheets&&fm(s,s.stylesheets),s.unsuspend){var d=s.unsuspend;s.unsuspend=null,d()}},6e4);return s.unsuspend=i,function(){s.unsuspend=null,clearTimeout(c)}}:null}function e0(){if(this.count--,this.count===0){if(this.stylesheets)fm(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var t0=null;function fm(s,i){s.stylesheets=null,s.unsuspend!==null&&(s.count++,t0=new Map,i.forEach(PA,s),t0=null,e0.call(s))}function PA(s,i){if(!(i.state.loading&4)){var c=t0.get(s);if(c)var d=c.get(null);else{c=new Map,t0.set(s,c);for(var x=s.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<x.length;y++){var C=x[y];(C.nodeName==="LINK"||C.getAttribute("media")!=="not all")&&(c.set(C.dataset.precedence,C),d=C)}d&&c.set(null,d)}x=i.instance,C=x.getAttribute("data-precedence"),y=c.get(C)||d,y===d&&c.set(null,x),c.set(C,x),this.count++,d=e0.bind(this),x.addEventListener("load",d),x.addEventListener("error",d),y?y.parentNode.insertBefore(x,y.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(x,s.firstChild)),i.state.loading|=4}}var Vc={$$typeof:k,Provider:null,Consumer:null,_currentValue:be,_currentValue2:be,_threadCount:0};function LA(s,i,c,d,x,y,C,F){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=jt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jt(0),this.hiddenUpdates=jt(null),this.identifierPrefix=d,this.onUncaughtError=x,this.onCaughtError=y,this.onRecoverableError=C,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=F,this.incompleteTransitions=new Map}function yy(s,i,c,d,x,y,C,F,te,he,Me,Le){return s=new LA(s,i,c,C,F,te,he,Le),i=1,y===!0&&(i|=24),y=Za(3,null,null,i),s.current=y,y.stateNode=s,i=Gd(),i.refCount++,s.pooledCache=i,i.refCount++,y.memoizedState={element:d,isDehydrated:c,cache:i},Kd(y),s}function _y(s){return s?(s=Go,s):Go}function wy(s,i,c,d,x,y){x=_y(x),d.context===null?d.context=x:d.pendingContext=x,d=ai(i),d.payload={element:c},y=y===void 0?null:y,y!==null&&(d.callback=y),c=ni(s,d,i),c!==null&&(nn(c,s,i),pc(c,s,i))}function by(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<i?c:i}}function dm(s,i){by(s,i),(s=s.alternate)&&by(s,i)}function Sy(s){if(s.tag===13){var i=Wo(s,67108864);i!==null&&nn(i,s,67108864),dm(s,67108864)}}var r0=!0;function BA(s,i,c,d){var x=q.T;q.T=null;var y=ae.p;try{ae.p=2,hm(s,i,c,d)}finally{ae.p=y,q.T=x}}function UA(s,i,c,d){var x=q.T;q.T=null;var y=ae.p;try{ae.p=8,hm(s,i,c,d)}finally{ae.p=y,q.T=x}}function hm(s,i,c,d){if(r0){var x=mm(d);if(x===null)em(s,i,d,a0,c),Ty(s,d);else if(VA(x,s,i,c,d))d.stopPropagation();else if(Ty(s,d),i&4&&-1<zA.indexOf(s)){for(;x!==null;){var y=J(x);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var C=lr(y.pendingLanes);if(C!==0){var F=y;for(F.pendingLanes|=2,F.entangledLanes|=2;C;){var te=1<<31-ke(C);F.entanglements[1]|=te,C&=~te}ls(y),(tr&6)===0&&(Uf=Z()+500,jc(0))}}break;case 13:F=Wo(y,2),F!==null&&nn(F,y,2),Vf(),dm(y,2)}if(y=mm(d),y===null&&em(s,i,d,a0,c),y===x)break;x=y}x!==null&&d.stopPropagation()}else em(s,i,d,null,c)}}function mm(s){return s=yd(s),gm(s)}var a0=null;function gm(s){if(a0=null,s=W(s),s!==null){var i=o(s);if(i===null)s=null;else{var c=i.tag;if(c===13){if(s=l(i),s!==null)return s;s=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null)}}return a0=s,null}function Ey(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(le()){case Ge:return 2;case kt:return 8;case nt:case st:return 32;case Ze:return 268435456;default:return 32}default:return 32}}var xm=!1,vi=null,pi=null,yi=null,Hc=new Map,$c=new Map,_i=[],zA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ty(s,i){switch(s){case"focusin":case"focusout":vi=null;break;case"dragenter":case"dragleave":pi=null;break;case"mouseover":case"mouseout":yi=null;break;case"pointerover":case"pointerout":Hc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":$c.delete(i.pointerId)}}function Wc(s,i,c,d,x,y){return s===null||s.nativeEvent!==y?(s={blockedOn:i,domEventName:c,eventSystemFlags:d,nativeEvent:y,targetContainers:[x]},i!==null&&(i=J(i),i!==null&&Sy(i)),s):(s.eventSystemFlags|=d,i=s.targetContainers,x!==null&&i.indexOf(x)===-1&&i.push(x),s)}function VA(s,i,c,d,x){switch(i){case"focusin":return vi=Wc(vi,s,i,c,d,x),!0;case"dragenter":return pi=Wc(pi,s,i,c,d,x),!0;case"mouseover":return yi=Wc(yi,s,i,c,d,x),!0;case"pointerover":var y=x.pointerId;return Hc.set(y,Wc(Hc.get(y)||null,s,i,c,d,x)),!0;case"gotpointercapture":return y=x.pointerId,$c.set(y,Wc($c.get(y)||null,s,i,c,d,x)),!0}return!1}function ky(s){var i=W(s.target);if(i!==null){var c=o(i);if(c!==null){if(i=c.tag,i===13){if(i=l(c),i!==null){s.blockedOn=i,Sr(s.priority,function(){if(c.tag===13){var d=an();d=He(d);var x=Wo(c,d);x!==null&&nn(x,c,d),dm(c,d)}});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function n0(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var c=mm(s.nativeEvent);if(c===null){c=s.nativeEvent;var d=new c.constructor(c.type,c);pd=d,c.target.dispatchEvent(d),pd=null}else return i=J(c),i!==null&&Sy(i),s.blockedOn=c,!1;i.shift()}return!0}function Ay(s,i,c){n0(s)&&c.delete(i)}function HA(){xm=!1,vi!==null&&n0(vi)&&(vi=null),pi!==null&&n0(pi)&&(pi=null),yi!==null&&n0(yi)&&(yi=null),Hc.forEach(Ay),$c.forEach(Ay)}function s0(s,i){s.blockedOn===i&&(s.blockedOn=null,xm||(xm=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,HA)))}var i0=null;function Cy(s){i0!==s&&(i0=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){i0===s&&(i0=null);for(var i=0;i<s.length;i+=3){var c=s[i],d=s[i+1],x=s[i+2];if(typeof d!="function"){if(gm(d||c)===null)continue;break}var y=J(c);y!==null&&(s.splice(i,3),i-=3,gh(y,{pending:!0,data:x,method:c.method,action:d},d,x))}}))}function Gc(s){function i(te){return s0(te,s)}vi!==null&&s0(vi,s),pi!==null&&s0(pi,s),yi!==null&&s0(yi,s),Hc.forEach(i),$c.forEach(i);for(var c=0;c<_i.length;c++){var d=_i[c];d.blockedOn===s&&(d.blockedOn=null)}for(;0<_i.length&&(c=_i[0],c.blockedOn===null);)ky(c),c.blockedOn===null&&_i.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var x=c[d],y=c[d+1],C=x[er]||null;if(typeof y=="function")C||Cy(c);else if(C){var F=null;if(y&&y.hasAttribute("formAction")){if(x=y,C=y[er]||null)F=C.formAction;else if(gm(x)!==null)continue}else F=C.action;typeof F=="function"?c[d+1]=F:(c.splice(d,3),d-=3),Cy(c)}}}function vm(s){this._internalRoot=s}o0.prototype.render=vm.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(a(409));var c=i.current,d=an();wy(c,d,s,i,null,null)},o0.prototype.unmount=vm.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;wy(s.current,2,null,s,null,null),Vf(),i[Xr]=null}};function o0(s){this._internalRoot=s}o0.prototype.unstable_scheduleHydration=function(s){if(s){var i=Bn();s={blockedOn:null,target:s,priority:i};for(var c=0;c<_i.length&&i!==0&&i<_i[c].priority;c++);_i.splice(c,0,s),c===0&&ky(s)}};var Ny=t.version;if(Ny!=="19.1.0")throw Error(a(527,Ny,"19.1.0"));ae.findDOMNode=function(s){var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(a(188)):(s=Object.keys(s).join(","),Error(a(268,s)));return s=f(i),s=s!==null?h(s):null,s=s===null?null:s.stateNode,s};var $A={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var l0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!l0.isDisabled&&l0.supportsFiber)try{Qe=l0.inject($A),et=l0}catch{}}return qc.createRoot=function(s,i){if(!n(s))throw Error(a(299));var c=!1,d="",x=Wv,y=Gv,C=qv,F=null;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onUncaughtError!==void 0&&(x=i.onUncaughtError),i.onCaughtError!==void 0&&(y=i.onCaughtError),i.onRecoverableError!==void 0&&(C=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(F=i.unstable_transitionCallbacks)),i=yy(s,1,!1,null,null,c,d,x,y,C,F,null),s[Xr]=i.current,Zh(s),new vm(i)},qc.hydrateRoot=function(s,i,c){if(!n(s))throw Error(a(299));var d=!1,x="",y=Wv,C=Gv,F=qv,te=null,he=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(y=c.onUncaughtError),c.onCaughtError!==void 0&&(C=c.onCaughtError),c.onRecoverableError!==void 0&&(F=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(te=c.unstable_transitionCallbacks),c.formState!==void 0&&(he=c.formState)),i=yy(s,1,!0,i,c??null,d,x,y,C,F,te,he),i.context=_y(null),c=i.current,d=an(),d=He(d),x=ai(d),x.callback=null,ni(c,x,d),c=d,i.current.lanes=c,lt(i,c),ls(i),s[Xr]=i.current,Zh(s),new o0(i)},qc.version="19.1.0",qc}var Fy;function G4(){if(Fy)return ym.exports;Fy=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),ym.exports=W4(),ym.exports}var q4=G4();const L1="-",Y4=e=>{const t=K4(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:a}=e;return{getClassGroupId:l=>{const u=l.split(L1);return u[0]===""&&u.length!==1&&u.shift(),i2(u,t)||X4(l)},getConflictingClassGroupIds:(l,u)=>{const f=r[l]||[];return u&&a[l]?[...f,...a[l]]:f}}},i2=(e,t)=>{var l;if(e.length===0)return t.classGroupId;const r=e[0],a=t.nextPart.get(r),n=a?i2(e.slice(1),a):void 0;if(n)return n;if(t.validators.length===0)return;const o=e.join(L1);return(l=t.validators.find(({validator:u})=>u(o)))==null?void 0:l.classGroupId},My=/^\[(.+)\]$/,X4=e=>{if(My.test(e)){const t=My.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},K4=e=>{const{theme:t,prefix:r}=e,a={nextPart:new Map,validators:[]};return Q4(Object.entries(e.classGroups),r).forEach(([o,l])=>{r1(l,a,o,t)}),a},r1=(e,t,r,a)=>{e.forEach(n=>{if(typeof n=="string"){const o=n===""?t:jy(t,n);o.classGroupId=r;return}if(typeof n=="function"){if(J4(n)){r1(n(a),t,r,a);return}t.validators.push({validator:n,classGroupId:r});return}Object.entries(n).forEach(([o,l])=>{r1(l,jy(t,o),r,a)})})},jy=(e,t)=>{let r=e;return t.split(L1).forEach(a=>{r.nextPart.has(a)||r.nextPart.set(a,{nextPart:new Map,validators:[]}),r=r.nextPart.get(a)}),r},J4=e=>e.isThemeGetter,Q4=(e,t)=>t?e.map(([r,a])=>{const n=a.map(o=>typeof o=="string"?t+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([l,u])=>[t+l,u])):o);return[r,n]}):e,Z4=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,a=new Map;const n=(o,l)=>{r.set(o,l),t++,t>e&&(t=0,a=r,r=new Map)};return{get(o){let l=r.get(o);if(l!==void 0)return l;if((l=a.get(o))!==void 0)return n(o,l),l},set(o,l){r.has(o)?r.set(o,l):n(o,l)}}},o2="!",eC=e=>{const{separator:t,experimentalParseClassName:r}=e,a=t.length===1,n=t[0],o=t.length,l=u=>{const f=[];let h=0,g=0,v;for(let S=0;S<u.length;S++){let T=u[S];if(h===0){if(T===n&&(a||u.slice(S,S+o)===t)){f.push(u.slice(g,S)),g=S+o;continue}if(T==="/"){v=S;continue}}T==="["?h++:T==="]"&&h--}const p=f.length===0?u:u.substring(g),_=p.startsWith(o2),b=_?p.substring(1):p,w=v&&v>g?v-g:void 0;return{modifiers:f,hasImportantModifier:_,baseClassName:b,maybePostfixModifierPosition:w}};return r?u=>r({className:u,parseClassName:l}):l},tC=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(a=>{a[0]==="["?(t.push(...r.sort(),a),r=[]):r.push(a)}),t.push(...r.sort()),t},rC=e=>({cache:Z4(e.cacheSize),parseClassName:eC(e),...Y4(e)}),aC=/\s+/,nC=(e,t)=>{const{parseClassName:r,getClassGroupId:a,getConflictingClassGroupIds:n}=t,o=[],l=e.trim().split(aC);let u="";for(let f=l.length-1;f>=0;f-=1){const h=l[f],{modifiers:g,hasImportantModifier:v,baseClassName:p,maybePostfixModifierPosition:_}=r(h);let b=!!_,w=a(b?p.substring(0,_):p);if(!w){if(!b){u=h+(u.length>0?" "+u:u);continue}if(w=a(p),!w){u=h+(u.length>0?" "+u:u);continue}b=!1}const S=tC(g).join(":"),T=v?S+o2:S,N=T+w;if(o.includes(N))continue;o.push(N);const k=n(w,b);for(let E=0;E<k.length;++E){const M=k[E];o.push(T+M)}u=h+(u.length>0?" "+u:u)}return u};function sC(){let e=0,t,r,a="";for(;e<arguments.length;)(t=arguments[e++])&&(r=l2(t))&&(a&&(a+=" "),a+=r);return a}const l2=e=>{if(typeof e=="string")return e;let t,r="";for(let a=0;a<e.length;a++)e[a]&&(t=l2(e[a]))&&(r&&(r+=" "),r+=t);return r};function iC(e,...t){let r,a,n,o=l;function l(f){const h=t.reduce((g,v)=>v(g),e());return r=rC(h),a=r.cache.get,n=r.cache.set,o=u,u(f)}function u(f){const h=a(f);if(h)return h;const g=nC(f,r);return n(f,g),g}return function(){return o(sC.apply(null,arguments))}}const Er=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},c2=/^\[(?:([a-z-]+):)?(.+)\]$/i,oC=/^\d+\/\d+$/,lC=new Set(["px","full","screen"]),cC=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,uC=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,fC=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,dC=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,hC=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Bs=e=>Ll(e)||lC.has(e)||oC.test(e),bi=e=>Xl(e,"length",wC),Ll=e=>!!e&&!Number.isNaN(Number(e)),bm=e=>Xl(e,"number",Ll),Yc=e=>!!e&&Number.isInteger(Number(e)),mC=e=>e.endsWith("%")&&Ll(e.slice(0,-1)),Ft=e=>c2.test(e),Si=e=>cC.test(e),gC=new Set(["length","size","percentage"]),xC=e=>Xl(e,gC,u2),vC=e=>Xl(e,"position",u2),pC=new Set(["image","url"]),yC=e=>Xl(e,pC,SC),_C=e=>Xl(e,"",bC),Xc=()=>!0,Xl=(e,t,r)=>{const a=c2.exec(e);return a?a[1]?typeof t=="string"?a[1]===t:t.has(a[1]):r(a[2]):!1},wC=e=>uC.test(e)&&!fC.test(e),u2=()=>!1,bC=e=>dC.test(e),SC=e=>hC.test(e),EC=()=>{const e=Er("colors"),t=Er("spacing"),r=Er("blur"),a=Er("brightness"),n=Er("borderColor"),o=Er("borderRadius"),l=Er("borderSpacing"),u=Er("borderWidth"),f=Er("contrast"),h=Er("grayscale"),g=Er("hueRotate"),v=Er("invert"),p=Er("gap"),_=Er("gradientColorStops"),b=Er("gradientColorStopPositions"),w=Er("inset"),S=Er("margin"),T=Er("opacity"),N=Er("padding"),k=Er("saturate"),E=Er("scale"),M=Er("sepia"),D=Er("skew"),A=Er("space"),B=Er("translate"),j=()=>["auto","contain","none"],ee=()=>["auto","hidden","clip","visible","scroll"],re=()=>["auto",Ft,t],U=()=>[Ft,t],I=()=>["",Bs,bi],ne=()=>["auto",Ll,Ft],ie=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],q=()=>["solid","dashed","dotted","double","none"],ae=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],be=()=>["start","end","center","between","around","evenly","stretch"],z=()=>["","0",Ft],fe=()=>["auto","avoid","all","avoid-page","page","left","right","column"],De=()=>[Ll,Ft];return{cacheSize:500,separator:":",theme:{colors:[Xc],spacing:[Bs,bi],blur:["none","",Si,Ft],brightness:De(),borderColor:[e],borderRadius:["none","","full",Si,Ft],borderSpacing:U(),borderWidth:I(),contrast:De(),grayscale:z(),hueRotate:De(),invert:z(),gap:U(),gradientColorStops:[e],gradientColorStopPositions:[mC,bi],inset:re(),margin:re(),opacity:De(),padding:U(),saturate:De(),scale:De(),sepia:z(),skew:De(),space:U(),translate:U()},classGroups:{aspect:[{aspect:["auto","square","video",Ft]}],container:["container"],columns:[{columns:[Si]}],"break-after":[{"break-after":fe()}],"break-before":[{"break-before":fe()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ie(),Ft]}],overflow:[{overflow:ee()}],"overflow-x":[{"overflow-x":ee()}],"overflow-y":[{"overflow-y":ee()}],overscroll:[{overscroll:j()}],"overscroll-x":[{"overscroll-x":j()}],"overscroll-y":[{"overscroll-y":j()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[w]}],"inset-x":[{"inset-x":[w]}],"inset-y":[{"inset-y":[w]}],start:[{start:[w]}],end:[{end:[w]}],top:[{top:[w]}],right:[{right:[w]}],bottom:[{bottom:[w]}],left:[{left:[w]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Yc,Ft]}],basis:[{basis:re()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ft]}],grow:[{grow:z()}],shrink:[{shrink:z()}],order:[{order:["first","last","none",Yc,Ft]}],"grid-cols":[{"grid-cols":[Xc]}],"col-start-end":[{col:["auto",{span:["full",Yc,Ft]},Ft]}],"col-start":[{"col-start":ne()}],"col-end":[{"col-end":ne()}],"grid-rows":[{"grid-rows":[Xc]}],"row-start-end":[{row:["auto",{span:[Yc,Ft]},Ft]}],"row-start":[{"row-start":ne()}],"row-end":[{"row-end":ne()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ft]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ft]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...be()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...be(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...be(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[N]}],px:[{px:[N]}],py:[{py:[N]}],ps:[{ps:[N]}],pe:[{pe:[N]}],pt:[{pt:[N]}],pr:[{pr:[N]}],pb:[{pb:[N]}],pl:[{pl:[N]}],m:[{m:[S]}],mx:[{mx:[S]}],my:[{my:[S]}],ms:[{ms:[S]}],me:[{me:[S]}],mt:[{mt:[S]}],mr:[{mr:[S]}],mb:[{mb:[S]}],ml:[{ml:[S]}],"space-x":[{"space-x":[A]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[A]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ft,t]}],"min-w":[{"min-w":[Ft,t,"min","max","fit"]}],"max-w":[{"max-w":[Ft,t,"none","full","min","max","fit","prose",{screen:[Si]},Si]}],h:[{h:[Ft,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ft,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ft,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ft,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Si,bi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",bm]}],"font-family":[{font:[Xc]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ft]}],"line-clamp":[{"line-clamp":["none",Ll,bm]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Bs,Ft]}],"list-image":[{"list-image":["none",Ft]}],"list-style-type":[{list:["none","disc","decimal",Ft]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[T]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[T]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...q(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Bs,bi]}],"underline-offset":[{"underline-offset":["auto",Bs,Ft]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:U()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ft]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ft]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[T]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ie(),vC]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",xC]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},yC]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[b]}],"gradient-via-pos":[{via:[b]}],"gradient-to-pos":[{to:[b]}],"gradient-from":[{from:[_]}],"gradient-via":[{via:[_]}],"gradient-to":[{to:[_]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[u]}],"border-w-x":[{"border-x":[u]}],"border-w-y":[{"border-y":[u]}],"border-w-s":[{"border-s":[u]}],"border-w-e":[{"border-e":[u]}],"border-w-t":[{"border-t":[u]}],"border-w-r":[{"border-r":[u]}],"border-w-b":[{"border-b":[u]}],"border-w-l":[{"border-l":[u]}],"border-opacity":[{"border-opacity":[T]}],"border-style":[{border:[...q(),"hidden"]}],"divide-x":[{"divide-x":[u]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[u]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[T]}],"divide-style":[{divide:q()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...q()]}],"outline-offset":[{"outline-offset":[Bs,Ft]}],"outline-w":[{outline:[Bs,bi]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:I()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[T]}],"ring-offset-w":[{"ring-offset":[Bs,bi]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Si,_C]}],"shadow-color":[{shadow:[Xc]}],opacity:[{opacity:[T]}],"mix-blend":[{"mix-blend":[...ae(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ae()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[a]}],contrast:[{contrast:[f]}],"drop-shadow":[{"drop-shadow":["","none",Si,Ft]}],grayscale:[{grayscale:[h]}],"hue-rotate":[{"hue-rotate":[g]}],invert:[{invert:[v]}],saturate:[{saturate:[k]}],sepia:[{sepia:[M]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[a]}],"backdrop-contrast":[{"backdrop-contrast":[f]}],"backdrop-grayscale":[{"backdrop-grayscale":[h]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[g]}],"backdrop-invert":[{"backdrop-invert":[v]}],"backdrop-opacity":[{"backdrop-opacity":[T]}],"backdrop-saturate":[{"backdrop-saturate":[k]}],"backdrop-sepia":[{"backdrop-sepia":[M]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[l]}],"border-spacing-x":[{"border-spacing-x":[l]}],"border-spacing-y":[{"border-spacing-y":[l]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ft]}],duration:[{duration:De()}],ease:[{ease:["linear","in","out","in-out",Ft]}],delay:[{delay:De()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ft]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[E]}],"scale-x":[{"scale-x":[E]}],"scale-y":[{"scale-y":[E]}],rotate:[{rotate:[Yc,Ft]}],"translate-x":[{"translate-x":[B]}],"translate-y":[{"translate-y":[B]}],"skew-x":[{"skew-x":[D]}],"skew-y":[{"skew-y":[D]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ft]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ft]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":U()}],"scroll-mx":[{"scroll-mx":U()}],"scroll-my":[{"scroll-my":U()}],"scroll-ms":[{"scroll-ms":U()}],"scroll-me":[{"scroll-me":U()}],"scroll-mt":[{"scroll-mt":U()}],"scroll-mr":[{"scroll-mr":U()}],"scroll-mb":[{"scroll-mb":U()}],"scroll-ml":[{"scroll-ml":U()}],"scroll-p":[{"scroll-p":U()}],"scroll-px":[{"scroll-px":U()}],"scroll-py":[{"scroll-py":U()}],"scroll-ps":[{"scroll-ps":U()}],"scroll-pe":[{"scroll-pe":U()}],"scroll-pt":[{"scroll-pt":U()}],"scroll-pr":[{"scroll-pr":U()}],"scroll-pb":[{"scroll-pb":U()}],"scroll-pl":[{"scroll-pl":U()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ft]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Bs,bi,bm]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},TC=iC(EC);function Ye(...e){return TC(a2(e))}const Vt=K.forwardRef(({className:e,...t},r)=>m.jsx("div",{ref:r,className:Ye("rounded-xl border bg-card text-card-foreground shadow dark:shadow-[0_0_15px_-3px_rgba(255,255,255,0.05)]",e),...t}));Vt.displayName="Card";const Ht=K.forwardRef(({className:e,...t},r)=>m.jsx("div",{ref:r,className:Ye("flex flex-col space-y-1.5 p-6",e),...t}));Ht.displayName="CardHeader";const $t=K.forwardRef(({className:e,...t},r)=>m.jsx("div",{ref:r,className:Ye("font-semibold leading-none tracking-tight",e),...t}));$t.displayName="CardTitle";const cn=K.forwardRef(({className:e,...t},r)=>m.jsx("div",{ref:r,className:Ye("text-sm text-muted-foreground",e),...t}));cn.displayName="CardDescription";const Wt=K.forwardRef(({className:e,...t},r)=>m.jsx("div",{ref:r,className:Ye("p-6 pt-0",e),...t}));Wt.displayName="CardContent";const f2=K.forwardRef(({className:e,...t},r)=>m.jsx("div",{ref:r,className:Ye("flex items-center p-6 pt-0",e),...t}));f2.displayName="CardFooter";function Kc({title:e,value:t,description:r,icon:a,trend:n,trendValue:o}){return m.jsxs(Vt,{children:[m.jsxs(Ht,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsx($t,{className:"text-sm font-medium",children:e}),m.jsx(a,{className:"h-4 w-4 text-muted-foreground"})]}),m.jsxs(Wt,{children:[m.jsx("div",{className:"text-2xl font-bold",children:t}),(r||o)&&m.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[n==="up"&&m.jsxs("span",{className:"text-green-500 mr-1",children:[" ",o]}),n==="down"&&m.jsxs("span",{className:"text-red-500 mr-1",children:[" ",o]}),r]})]})]})}const Iy=e=>{let t;const r=new Set,a=(h,g)=>{const v=typeof h=="function"?h(t):h;if(!Object.is(v,t)){const p=t;t=g??(typeof v!="object"||v===null)?v:Object.assign({},t,v),r.forEach(_=>_(t,p))}},n=()=>t,u={setState:a,getState:n,getInitialState:()=>f,subscribe:h=>(r.add(h),()=>r.delete(h))},f=t=e(a,n,u);return u},kC=e=>e?Iy(e):Iy,AC=e=>e;function CC(e,t=AC){const r=ge.useSyncExternalStore(e.subscribe,ge.useCallback(()=>t(e.getState()),[e,t]),ge.useCallback(()=>t(e.getInitialState()),[e,t]));return ge.useDebugValue(r),r}const Py=e=>{const t=kC(e),r=a=>CC(t,a);return Object.assign(r,t),r},d2=e=>e?Py(e):Py,jn=d2(e=>({user:null,isLoading:!0,setUser:t=>e({user:t}),setIsLoading:t=>e({isLoading:t}),logout:async()=>{const{supabase:t}=await V4(async()=>{const{supabase:r}=await Promise.resolve().then(()=>B6);return{supabase:r}},void 0);await t.auth.signOut(),e({user:null,isLoading:!1})}})),Bu=d2(e=>({filters:{period:"THIS_MONTH"},setFilters:t=>e(r=>({filters:{...r.filters,...t}})),resetFilters:()=>e({filters:{period:"THIS_MONTH"}})}));var NC=Symbol.for("react.lazy"),N0=A4[" use ".trim().toString()];function DC(e){return typeof e=="object"&&e!==null&&"then"in e}function h2(e){return e!=null&&typeof e=="object"&&"$$typeof"in e&&e.$$typeof===NC&&"_payload"in e&&DC(e._payload)}function B1(e){const t=RC(e),r=K.forwardRef((a,n)=>{let{children:o,...l}=a;h2(o)&&typeof N0=="function"&&(o=N0(o._payload));const u=K.Children.toArray(o),f=u.find(MC);if(f){const h=f.props.children,g=u.map(v=>v===f?K.Children.count(h)>1?K.Children.only(null):K.isValidElement(h)?h.props.children:null:v);return m.jsx(t,{...l,ref:n,children:K.isValidElement(h)?K.cloneElement(h,void 0,g):null})}return m.jsx(t,{...l,ref:n,children:o})});return r.displayName=`${e}.Slot`,r}var OC=B1("Slot");function RC(e){const t=K.forwardRef((r,a)=>{let{children:n,...o}=r;if(h2(n)&&typeof N0=="function"&&(n=N0(n._payload)),K.isValidElement(n)){const l=IC(n),u=jC(o,n.props);return n.type!==K.Fragment&&(u.ref=a?Vw(a,l):l),K.cloneElement(n,u)}return K.Children.count(n)>1?K.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var FC=Symbol("radix.slottable");function MC(e){return K.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===FC}function jC(e,t){const r={...t};for(const a in t){const n=e[a],o=t[a];/^on[A-Z]/.test(a)?n&&o?r[a]=(...u)=>{const f=o(...u);return n(...u),f}:n&&(r[a]=n):a==="style"?r[a]={...n,...o}:a==="className"&&(r[a]=[n,o].filter(Boolean).join(" "))}return{...e,...r}}function IC(e){var a,n;let t=(a=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(n=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}const Ly=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,By=a2,K0=(e,t)=>r=>{var a;if((t==null?void 0:t.variants)==null)return By(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:n,defaultVariants:o}=t,l=Object.keys(n).map(h=>{const g=r==null?void 0:r[h],v=o==null?void 0:o[h];if(g===null)return null;const p=Ly(g)||Ly(v);return n[h][p]}),u=r&&Object.entries(r).reduce((h,g)=>{let[v,p]=g;return p===void 0||(h[v]=p),h},{}),f=t==null||(a=t.compoundVariants)===null||a===void 0?void 0:a.reduce((h,g)=>{let{class:v,className:p,..._}=g;return Object.entries(_).every(b=>{let[w,S]=b;return Array.isArray(S)?S.includes({...o,...u}[w]):{...o,...u}[w]===S})?[...h,v,p]:h},[]);return By(e,l,f,r==null?void 0:r.class,r==null?void 0:r.className)},a1=K0("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Dt=K.forwardRef(({className:e,variant:t,size:r,asChild:a=!1,...n},o)=>{const l=a?OC:"button";return m.jsx(l,{className:Ye(a1({variant:t,size:r,className:e})),ref:o,...n})});Dt.displayName="Button";const Gr=K.forwardRef(({className:e,type:t,...r},a)=>m.jsx("input",{type:t,className:Ye("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...r}));Gr.displayName="Input";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PC=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),LC=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,a)=>a?a.toUpperCase():r.toLowerCase()),Uy=e=>{const t=LC(e);return t.charAt(0).toUpperCase()+t.slice(1)},m2=(...e)=>e.filter((t,r,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===r).join(" ").trim(),BC=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var UC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zC=K.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:n="",children:o,iconNode:l,...u},f)=>K.createElement("svg",{ref:f,...UC,width:t,height:t,stroke:e,strokeWidth:a?Number(r)*24/Number(t):r,className:m2("lucide",n),...!o&&!BC(u)&&{"aria-hidden":"true"},...u},[...l.map(([h,g])=>K.createElement(h,g)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=(e,t)=>{const r=K.forwardRef(({className:a,...n},o)=>K.createElement(zC,{ref:o,iconNode:t,className:m2(`lucide-${PC(Uy(e))}`,`lucide-${e}`,a),...n}));return r.displayName=Uy(e),r};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VC=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],g2=Ct("arrow-down",VC);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HC=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],x2=Ct("arrow-up-down",HC);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $C=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],v2=Ct("arrow-up",$C);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WC=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],GC=Ct("calendar",WC);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qC=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],zy=Ct("chart-column",qC);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YC=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],XC=Ct("check",YC);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KC=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],J0=Ct("chevron-down",KC);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JC=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],p2=Ct("chevron-left",JC);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QC=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],y2=Ct("chevron-right",QC);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZC=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],eN=Ct("chevron-up",ZC);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tN=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],_2=Ct("circle-alert",tN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rN=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],aN=Ct("cloud-upload",rN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nN=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],sN=Ct("dollar-sign",nN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iN=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]],oN=Ct("file-chart-column-increasing",iN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lN=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],cN=Ct("file-spreadsheet",lN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uN=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],w2=Ct("file-text",uN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fN=[["path",{d:"M12.531 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14v6a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341l.427-.473",key:"ol2ft2"}],["path",{d:"m16.5 3.5 5 5",key:"15e6fa"}],["path",{d:"m21.5 3.5-5 5",key:"m0lwru"}]],dN=Ct("funnel-x",fN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hN=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],mN=Ct("history",hN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gN=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],xN=Ct("layers",gN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vN=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],pN=Ct("layout-dashboard",vN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yN=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Do=Ct("loader-circle",yN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _N=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Vy=Ct("log-out",_N);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wN=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],bN=Ct("mail",wN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SN=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],EN=Ct("map-pin",SN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TN=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],kN=Ct("menu",TN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AN=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],Hy=Ct("moon",AN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CN=[["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}],["path",{d:"m17 13 5 5m-5 0 5-5",key:"im3w4b"}]],$y=Ct("package-x",CN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NN=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],DN=Ct("package",NN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ON=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],RN=Ct("pen",ON);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FN=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Jc=Ct("plus",FN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MN=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],jN=Ct("refresh-ccw",MN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IN=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],b2=Ct("refresh-cw",IN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PN=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],LN=Ct("save",PN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BN=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],UN=Ct("search",BN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zN=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],VN=Ct("settings",zN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HN=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],$N=Ct("share-2",HN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WN=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],GN=Ct("shield",WN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qN=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],A0=Ct("square-check-big",qN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YN=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],XN=Ct("square-pen",YN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KN=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Wy=Ct("square",KN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JN=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Gy=Ct("sun",JN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QN=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],nu=Ct("trash-2",QN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZN=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],S2=Ct("trending-up",ZN);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],n1=Ct("triangle-alert",e3);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],s1=Ct("user",t3);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Q0=Ct("x",r3),Ra=JA,Fa=QA,Ea=K.forwardRef(({className:e,children:t,...r},a)=>m.jsxs(Hw,{ref:a,className:Ye("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,m.jsx(GA,{asChild:!0,children:m.jsx(J0,{className:"h-4 w-4 opacity-50"})})]}));Ea.displayName=Hw.displayName;const E2=K.forwardRef(({className:e,...t},r)=>m.jsx($w,{ref:r,className:Ye("flex cursor-default items-center justify-center py-1",e),...t,children:m.jsx(eN,{className:"h-4 w-4"})}));E2.displayName=$w.displayName;const T2=K.forwardRef(({className:e,...t},r)=>m.jsx(Ww,{ref:r,className:Ye("flex cursor-default items-center justify-center py-1",e),...t,children:m.jsx(J0,{className:"h-4 w-4"})}));T2.displayName=Ww.displayName;const Ta=K.forwardRef(({className:e,children:t,position:r="popper",...a},n)=>m.jsx(qA,{children:m.jsxs(Gw,{ref:n,className:Ye("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...a,children:[m.jsx(E2,{}),m.jsx(YA,{className:Ye("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),m.jsx(T2,{})]})}));Ta.displayName=Gw.displayName;const a3=K.forwardRef(({className:e,...t},r)=>m.jsx(qw,{ref:r,className:Ye("px-2 py-1.5 text-sm font-semibold",e),...t}));a3.displayName=qw.displayName;const Et=K.forwardRef(({className:e,children:t,...r},a)=>m.jsxs(Yw,{ref:a,className:Ye("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[m.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:m.jsx(XA,{children:m.jsx(XC,{className:"h-4 w-4"})})}),m.jsx(KA,{children:t})]}));Et.displayName=Yw.displayName;const n3=K.forwardRef(({className:e,...t},r)=>m.jsx(Xw,{ref:r,className:Ye("-mx-1 my-1 h-px bg-muted",e),...t}));n3.displayName=Xw.displayName;var U1="Popper",[k2,A2]=Y0(U1),[s3,C2]=k2(U1),N2=e=>{const{__scopePopper:t,children:r}=e,[a,n]=K.useState(null);return m.jsx(s3,{scope:t,anchor:a,onAnchorChange:n,children:r})};N2.displayName=U1;var D2="PopperAnchor",O2=K.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:a,...n}=e,o=C2(D2,r),l=K.useRef(null),u=Lu(t,l),f=K.useRef(null);return K.useEffect(()=>{const h=f.current;f.current=(a==null?void 0:a.current)||l.current,h!==f.current&&o.onAnchorChange(f.current)}),a?null:m.jsx(ys.div,{...n,ref:u})});O2.displayName=D2;var z1="PopperContent",[i3,o3]=k2(z1),R2=K.forwardRef((e,t)=>{var Fe,Te,Oe,Re,Je,H;const{__scopePopper:r,side:a="bottom",sideOffset:n=0,align:o="center",alignOffset:l=0,arrowPadding:u=0,avoidCollisions:f=!0,collisionBoundary:h=[],collisionPadding:g=0,sticky:v="partial",hideWhenDetached:p=!1,updatePositionStrategy:_="optimized",onPlaced:b,...w}=e,S=C2(z1,r),[T,N]=K.useState(null),k=Lu(t,O=>N(O)),[E,M]=K.useState(null),D=ZA(E),A=(D==null?void 0:D.width)??0,B=(D==null?void 0:D.height)??0,j=a+(o!=="center"?"-"+o:""),ee=typeof g=="number"?g:{top:0,right:0,bottom:0,left:0,...g},re=Array.isArray(h)?h:[h],U=re.length>0,I={padding:ee,boundary:re.filter(c3),altBoundary:U},{refs:ne,floatingStyles:ie,placement:q,isPositioned:ae,middlewareData:be}=e4({strategy:"fixed",placement:j,whileElementsMounted:(...O)=>l4(...O,{animationFrame:_==="always"}),elements:{reference:S.anchor},middleware:[t4({mainAxis:n+B,alignmentAxis:l}),f&&r4({mainAxis:!0,crossAxis:!1,limiter:v==="partial"?o4():void 0,...I}),f&&a4({...I}),n4({...I,apply:({elements:O,rects:Ae,availableWidth:Pe,availableHeight:Se})=>{const{width:Z,height:le}=Ae.reference,Ge=O.floating.style;Ge.setProperty("--radix-popper-available-width",`${Pe}px`),Ge.setProperty("--radix-popper-available-height",`${Se}px`),Ge.setProperty("--radix-popper-anchor-width",`${Z}px`),Ge.setProperty("--radix-popper-anchor-height",`${le}px`)}}),E&&s4({element:E,padding:u}),u3({arrowWidth:A,arrowHeight:B}),p&&i4({strategy:"referenceHidden",...I})]}),[z,fe]=j2(q),De=M1(b);xu(()=>{ae&&(De==null||De())},[ae,De]);const P=(Fe=be.arrow)==null?void 0:Fe.x,X=(Te=be.arrow)==null?void 0:Te.y,Y=((Oe=be.arrow)==null?void 0:Oe.centerOffset)!==0,[Q,de]=K.useState();return xu(()=>{T&&de(window.getComputedStyle(T).zIndex)},[T]),m.jsx("div",{ref:ne.setFloating,"data-radix-popper-content-wrapper":"",style:{...ie,transform:ae?ie.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Q,"--radix-popper-transform-origin":[(Re=be.transformOrigin)==null?void 0:Re.x,(Je=be.transformOrigin)==null?void 0:Je.y].join(" "),...((H=be.hide)==null?void 0:H.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:m.jsx(i3,{scope:r,placedSide:z,onArrowChange:M,arrowX:P,arrowY:X,shouldHideArrow:Y,children:m.jsx(ys.div,{"data-side":z,"data-align":fe,...w,ref:k,style:{...w.style,animation:ae?void 0:"none"}})})})});R2.displayName=z1;var F2="PopperArrow",l3={top:"bottom",right:"left",bottom:"top",left:"right"},M2=K.forwardRef(function(t,r){const{__scopePopper:a,...n}=t,o=o3(F2,a),l=l3[o.placedSide];return m.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[l]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:m.jsx(c4,{...n,ref:r,style:{...n.style,display:"block"}})})});M2.displayName=F2;function c3(e){return e!==null}var u3=e=>({name:"transformOrigin",options:e,fn(t){var S,T,N;const{placement:r,rects:a,middlewareData:n}=t,l=((S=n.arrow)==null?void 0:S.centerOffset)!==0,u=l?0:e.arrowWidth,f=l?0:e.arrowHeight,[h,g]=j2(r),v={start:"0%",center:"50%",end:"100%"}[g],p=(((T=n.arrow)==null?void 0:T.x)??0)+u/2,_=(((N=n.arrow)==null?void 0:N.y)??0)+f/2;let b="",w="";return h==="bottom"?(b=l?v:`${p}px`,w=`${-f}px`):h==="top"?(b=l?v:`${p}px`,w=`${a.floating.height+f}px`):h==="right"?(b=`${-f}px`,w=l?v:`${_}px`):h==="left"&&(b=`${a.floating.width+f}px`,w=l?v:`${_}px`),{data:{x:b,y:w}}}});function j2(e){const[t,r="center"]=e.split("-");return[t,r]}var f3=N2,I2=O2,d3=R2,h3=M2;function m3(e){const t=g3(e),r=K.forwardRef((a,n)=>{const{children:o,...l}=a,u=K.Children.toArray(o),f=u.find(v3);if(f){const h=f.props.children,g=u.map(v=>v===f?K.Children.count(h)>1?K.Children.only(null):K.isValidElement(h)?h.props.children:null:v);return m.jsx(t,{...l,ref:n,children:K.isValidElement(h)?K.cloneElement(h,void 0,g):null})}return m.jsx(t,{...l,ref:n,children:o})});return r.displayName=`${e}.Slot`,r}function g3(e){const t=K.forwardRef((r,a)=>{const{children:n,...o}=r;if(K.isValidElement(n)){const l=y3(n),u=p3(o,n.props);return n.type!==K.Fragment&&(u.ref=a?Vw(a,l):l),K.cloneElement(n,u)}return K.Children.count(n)>1?K.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var x3=Symbol("radix.slottable");function v3(e){return K.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===x3}function p3(e,t){const r={...t};for(const a in t){const n=e[a],o=t[a];/^on[A-Z]/.test(a)?n&&o?r[a]=(...u)=>{const f=o(...u);return n(...u),f}:n&&(r[a]=n):a==="style"?r[a]={...n,...o}:a==="className"&&(r[a]=[n,o].filter(Boolean).join(" "))}return{...e,...r}}function y3(e){var a,n;let t=(a=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(n=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var Z0="Popover",[P2,b$]=Y0(Z0,[A2]),Uu=A2(),[_3,Ui]=P2(Z0),L2=e=>{const{__scopePopover:t,children:r,open:a,defaultOpen:n,onOpenChange:o,modal:l=!1}=e,u=Uu(t),f=K.useRef(null),[h,g]=K.useState(!1),[v,p]=I1({prop:a,defaultProp:n??!1,onChange:o,caller:Z0});return m.jsx(f3,{...u,children:m.jsx(_3,{scope:t,contentId:P1(),triggerRef:f,open:v,onOpenChange:p,onOpenToggle:K.useCallback(()=>p(_=>!_),[p]),hasCustomAnchor:h,onCustomAnchorAdd:K.useCallback(()=>g(!0),[]),onCustomAnchorRemove:K.useCallback(()=>g(!1),[]),modal:l,children:r})})};L2.displayName=Z0;var B2="PopoverAnchor",w3=K.forwardRef((e,t)=>{const{__scopePopover:r,...a}=e,n=Ui(B2,r),o=Uu(r),{onCustomAnchorAdd:l,onCustomAnchorRemove:u}=n;return K.useEffect(()=>(l(),()=>u()),[l,u]),m.jsx(I2,{...o,...a,ref:t})});w3.displayName=B2;var U2="PopoverTrigger",z2=K.forwardRef((e,t)=>{const{__scopePopover:r,...a}=e,n=Ui(U2,r),o=Uu(r),l=Lu(t,n.triggerRef),u=m.jsx(ys.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":G2(n.open),...a,ref:l,onClick:Xa(e.onClick,n.onOpenToggle)});return n.hasCustomAnchor?u:m.jsx(I2,{asChild:!0,...o,children:u})});z2.displayName=U2;var V1="PopoverPortal",[b3,S3]=P2(V1,{forceMount:void 0}),V2=e=>{const{__scopePopover:t,forceMount:r,children:a,container:n}=e,o=Ui(V1,t);return m.jsx(b3,{scope:t,forceMount:r,children:m.jsx(j1,{present:r||o.open,children:m.jsx(u4,{asChild:!0,container:n,children:a})})})};V2.displayName=V1;var Wl="PopoverContent",H2=K.forwardRef((e,t)=>{const r=S3(Wl,e.__scopePopover),{forceMount:a=r.forceMount,...n}=e,o=Ui(Wl,e.__scopePopover);return m.jsx(j1,{present:a||o.open,children:o.modal?m.jsx(T3,{...n,ref:t}):m.jsx(k3,{...n,ref:t})})});H2.displayName=Wl;var E3=m3("PopoverContent.RemoveScroll"),T3=K.forwardRef((e,t)=>{const r=Ui(Wl,e.__scopePopover),a=K.useRef(null),n=Lu(t,a),o=K.useRef(!1);return K.useEffect(()=>{const l=a.current;if(l)return f4(l)},[]),m.jsx(d4,{as:E3,allowPinchZoom:!0,children:m.jsx($2,{...e,ref:n,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Xa(e.onCloseAutoFocus,l=>{var u;l.preventDefault(),o.current||(u=r.triggerRef.current)==null||u.focus()}),onPointerDownOutside:Xa(e.onPointerDownOutside,l=>{const u=l.detail.originalEvent,f=u.button===0&&u.ctrlKey===!0,h=u.button===2||f;o.current=h},{checkForDefaultPrevented:!1}),onFocusOutside:Xa(e.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1})})})}),k3=K.forwardRef((e,t)=>{const r=Ui(Wl,e.__scopePopover),a=K.useRef(!1),n=K.useRef(!1);return m.jsx($2,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var l,u;(l=e.onCloseAutoFocus)==null||l.call(e,o),o.defaultPrevented||(a.current||(u=r.triggerRef.current)==null||u.focus(),o.preventDefault()),a.current=!1,n.current=!1},onInteractOutside:o=>{var f,h;(f=e.onInteractOutside)==null||f.call(e,o),o.defaultPrevented||(a.current=!0,o.detail.originalEvent.type==="pointerdown"&&(n.current=!0));const l=o.target;((h=r.triggerRef.current)==null?void 0:h.contains(l))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&n.current&&o.preventDefault()}})}),$2=K.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:a,onOpenAutoFocus:n,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:h,onInteractOutside:g,...v}=e,p=Ui(Wl,r),_=Uu(r);return h4(),m.jsx(m4,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:n,onUnmountAutoFocus:o,children:m.jsx(g4,{asChild:!0,disableOutsidePointerEvents:l,onInteractOutside:g,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:h,onDismiss:()=>p.onOpenChange(!1),children:m.jsx(d3,{"data-state":G2(p.open),role:"dialog",id:p.contentId,..._,...v,ref:t,style:{...v.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),W2="PopoverClose",A3=K.forwardRef((e,t)=>{const{__scopePopover:r,...a}=e,n=Ui(W2,r);return m.jsx(ys.button,{type:"button",...a,ref:t,onClick:Xa(e.onClick,()=>n.onOpenChange(!1))})});A3.displayName=W2;var C3="PopoverArrow",N3=K.forwardRef((e,t)=>{const{__scopePopover:r,...a}=e,n=Uu(r);return m.jsx(h3,{...n,...a,ref:t})});N3.displayName=C3;function G2(e){return e?"open":"closed"}var D3=L2,O3=z2,R3=V2,q2=H2;const F3=D3,M3=O3,Y2=K.forwardRef(({className:e,align:t="center",sideOffset:r=4,...a},n)=>m.jsx(R3,{children:m.jsx(q2,{ref:n,align:t,sideOffset:r,className:Ye("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",e),...a})}));Y2.displayName=q2.displayName;function j3(e,t,r="long"){return new Intl.DateTimeFormat("en-US",{hour:"numeric",timeZone:e,timeZoneName:r}).format(t).split(/\s/g).slice(2).join(" ")}const Sm={},Zc={};function vo(e,t){try{const a=(Sm[e]||(Sm[e]=new Intl.DateTimeFormat("en-US",{timeZone:e,timeZoneName:"longOffset"}).format))(t).split("GMT")[1];return a in Zc?Zc[a]:qy(a,a.split(":"))}catch{if(e in Zc)return Zc[e];const r=e==null?void 0:e.match(I3);return r?qy(e,r.slice(1)):NaN}}const I3=/([+-]\d\d):?(\d\d)?/;function qy(e,t){const r=+(t[0]||0),a=+(t[1]||0),n=+(t[2]||0)/60;return Zc[e]=r*60+a>0?r*60+a+n:r*60-a-n}class xs extends Date{constructor(...t){super(),t.length>1&&typeof t[t.length-1]=="string"&&(this.timeZone=t.pop()),this.internal=new Date,isNaN(vo(this.timeZone,this))?this.setTime(NaN):t.length?typeof t[0]=="number"&&(t.length===1||t.length===2&&typeof t[1]!="number")?this.setTime(t[0]):typeof t[0]=="string"?this.setTime(+new Date(t[0])):t[0]instanceof Date?this.setTime(+t[0]):(this.setTime(+new Date(...t)),X2(this),i1(this)):this.setTime(Date.now())}static tz(t,...r){return r.length?new xs(...r,t):new xs(Date.now(),t)}withTimeZone(t){return new xs(+this,t)}getTimezoneOffset(){const t=-vo(this.timeZone,this);return t>0?Math.floor(t):Math.ceil(t)}setTime(t){return Date.prototype.setTime.apply(this,arguments),i1(this),+this}[Symbol.for("constructDateFrom")](t){return new xs(+new Date(t),this.timeZone)}}const Yy=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(e=>{if(!Yy.test(e))return;const t=e.replace(Yy,"$1UTC");xs.prototype[t]&&(e.startsWith("get")?xs.prototype[e]=function(){return this.internal[t]()}:(xs.prototype[e]=function(){return Date.prototype[t].apply(this.internal,arguments),P3(this),+this},xs.prototype[t]=function(){return Date.prototype[t].apply(this,arguments),i1(this),+this}))});function i1(e){e.internal.setTime(+e),e.internal.setUTCSeconds(e.internal.getUTCSeconds()-Math.round(-vo(e.timeZone,e)*60))}function P3(e){Date.prototype.setFullYear.call(e,e.internal.getUTCFullYear(),e.internal.getUTCMonth(),e.internal.getUTCDate()),Date.prototype.setHours.call(e,e.internal.getUTCHours(),e.internal.getUTCMinutes(),e.internal.getUTCSeconds(),e.internal.getUTCMilliseconds()),X2(e)}function X2(e){const t=vo(e.timeZone,e),r=t>0?Math.floor(t):Math.ceil(t),a=new Date(+e);a.setUTCHours(a.getUTCHours()-1);const n=-new Date(+e).getTimezoneOffset(),o=-new Date(+a).getTimezoneOffset(),l=n-o,u=Date.prototype.getHours.apply(e)!==e.internal.getUTCHours();l&&u&&e.internal.setUTCMinutes(e.internal.getUTCMinutes()+l);const f=n-r;f&&Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+f);const h=new Date(+e);h.setUTCSeconds(0);const g=n>0?h.getSeconds():(h.getSeconds()-60)%60,v=Math.round(-(vo(e.timeZone,e)*60))%60;(v||g)&&(e.internal.setUTCSeconds(e.internal.getUTCSeconds()+v),Date.prototype.setUTCSeconds.call(e,Date.prototype.getUTCSeconds.call(e)+v+g));const p=vo(e.timeZone,e),_=p>0?Math.floor(p):Math.ceil(p),w=-new Date(+e).getTimezoneOffset()-_,S=_!==r,T=w-f;if(S&&T){Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+T);const N=vo(e.timeZone,e),k=N>0?Math.floor(N):Math.ceil(N),E=_-k;E&&(e.internal.setUTCMinutes(e.internal.getUTCMinutes()+E),Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+E))}}class Da extends xs{static tz(t,...r){return r.length?new Da(...r,t):new Da(Date.now(),t)}toISOString(){const[t,r,a]=this.tzComponents(),n=`${t}${r}:${a}`;return this.internal.toISOString().slice(0,-1)+n}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[t,r,a,n]=this.internal.toUTCString().split(" ");return`${t==null?void 0:t.slice(0,-1)} ${a} ${r} ${n}`}toTimeString(){const t=this.internal.toUTCString().split(" ")[4],[r,a,n]=this.tzComponents();return`${t} GMT${r}${a}${n} (${j3(this.timeZone,this)})`}toLocaleString(t,r){return Date.prototype.toLocaleString.call(this,t,{...r,timeZone:(r==null?void 0:r.timeZone)||this.timeZone})}toLocaleDateString(t,r){return Date.prototype.toLocaleDateString.call(this,t,{...r,timeZone:(r==null?void 0:r.timeZone)||this.timeZone})}toLocaleTimeString(t,r){return Date.prototype.toLocaleTimeString.call(this,t,{...r,timeZone:(r==null?void 0:r.timeZone)||this.timeZone})}tzComponents(){const t=this.getTimezoneOffset(),r=t>0?"-":"+",a=String(Math.floor(Math.abs(t)/60)).padStart(2,"0"),n=String(Math.abs(t)%60).padStart(2,"0");return[r,a,n]}withTimeZone(t){return new Da(+this,t)}[Symbol.for("constructDateFrom")](t){return new Da(+new Date(t),this.timeZone)}}const K2=6048e5,L3=864e5,Xy=Symbol.for("constructDateFrom");function aa(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Xy in e?e[Xy](t):e instanceof Date?new e.constructor(t):new Date(t)}function Zt(e,t){return aa(t||e,e)}function H1(e,t,r){const a=Zt(e,r==null?void 0:r.in);return isNaN(t)?aa(e,NaN):(t&&a.setDate(a.getDate()+t),a)}function $1(e,t,r){const a=Zt(e,r==null?void 0:r.in);if(isNaN(t))return aa(e,NaN);if(!t)return a;const n=a.getDate(),o=aa(e,a.getTime());o.setMonth(a.getMonth()+t+1,0);const l=o.getDate();return n>=l?o:(a.setFullYear(o.getFullYear(),o.getMonth(),n),a)}let B3={};function zu(){return B3}function ji(e,t){var u,f,h,g;const r=zu(),a=(t==null?void 0:t.weekStartsOn)??((f=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:f.weekStartsOn)??r.weekStartsOn??((g=(h=r.locale)==null?void 0:h.options)==null?void 0:g.weekStartsOn)??0,n=Zt(e,t==null?void 0:t.in),o=n.getDay(),l=(o<a?7:0)+o-a;return n.setDate(n.getDate()-l),n.setHours(0,0,0,0),n}function vu(e,t){return ji(e,{...t,weekStartsOn:1})}function J2(e,t){const r=Zt(e,t==null?void 0:t.in),a=r.getFullYear(),n=aa(r,0);n.setFullYear(a+1,0,4),n.setHours(0,0,0,0);const o=vu(n),l=aa(r,0);l.setFullYear(a,0,4),l.setHours(0,0,0,0);const u=vu(l);return r.getTime()>=o.getTime()?a+1:r.getTime()>=u.getTime()?a:a-1}function Ky(e){const t=Zt(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Kl(e,...t){const r=aa.bind(null,t.find(a=>typeof a=="object"));return t.map(r)}function Mi(e,t){const r=Zt(e,t==null?void 0:t.in);return r.setHours(0,0,0,0),r}function W1(e,t,r){const[a,n]=Kl(r==null?void 0:r.in,e,t),o=Mi(a),l=Mi(n),u=+o-Ky(o),f=+l-Ky(l);return Math.round((u-f)/L3)}function U3(e,t){const r=J2(e,t),a=aa(e,0);return a.setFullYear(r,0,4),a.setHours(0,0,0,0),vu(a)}function Q2(e,t,r){return H1(e,t*7,r)}function z3(e,t,r){return $1(e,t*12,r)}function V3(e,t){let r,a=t==null?void 0:t.in;return e.forEach(n=>{!a&&typeof n=="object"&&(a=aa.bind(null,n));const o=Zt(n,a);(!r||r<o||isNaN(+o))&&(r=o)}),aa(a,r||NaN)}function H3(e,t){let r,a=t==null?void 0:t.in;return e.forEach(n=>{!a&&typeof n=="object"&&(a=aa.bind(null,n));const o=Zt(n,a);(!r||r>o||isNaN(+o))&&(r=o)}),aa(a,r||NaN)}function $3(e,t,r){const[a,n]=Kl(r==null?void 0:r.in,e,t);return+Mi(a)==+Mi(n)}function Z2(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function W3(e){return!(!Z2(e)&&typeof e!="number"||isNaN(+Zt(e)))}function eb(e,t,r){const[a,n]=Kl(r==null?void 0:r.in,e,t),o=a.getFullYear()-n.getFullYear(),l=a.getMonth()-n.getMonth();return o*12+l}function Em(e,t){const r=Zt(e,t==null?void 0:t.in);return r.setHours(23,59,59,999),r}function o1(e,t){const r=Zt(e,t==null?void 0:t.in),a=r.getMonth();return r.setFullYear(r.getFullYear(),a+1,0),r.setHours(23,59,59,999),r}function tb(e,t){const[r,a]=Kl(e,t.start,t.end);return{start:r,end:a}}function G3(e,t){const{start:r,end:a}=tb(t==null?void 0:t.in,e);let n=+r>+a;const o=n?+r:+a,l=n?a:r;l.setHours(0,0,0,0),l.setDate(1);let u=1;const f=[];for(;+l<=o;)f.push(aa(r,l)),l.setMonth(l.getMonth()+u);return n?f.reverse():f}function q3(e,t){const r=Zt(e,t==null?void 0:t.in),a=r.getMonth(),n=a-a%3;return r.setMonth(n,1),r.setHours(0,0,0,0),r}function l1(e,t){const r=Zt(e,t==null?void 0:t.in);return r.setDate(1),r.setHours(0,0,0,0),r}function rb(e,t){const r=Zt(e,t==null?void 0:t.in),a=r.getFullYear();return r.setFullYear(a+1,0,0),r.setHours(23,59,59,999),r}function G1(e,t){const r=Zt(e,t==null?void 0:t.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}function Y3(e,t){const{start:r,end:a}=tb(t==null?void 0:t.in,e);let n=+r>+a;const o=n?+r:+a,l=n?a:r;l.setHours(0,0,0,0),l.setMonth(0,1);let u=1;const f=[];for(;+l<=o;)f.push(aa(r,l)),l.setFullYear(l.getFullYear()+u);return n?f.reverse():f}function D0(e,t){var u,f,h,g;const r=zu(),a=(t==null?void 0:t.weekStartsOn)??((f=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:f.weekStartsOn)??r.weekStartsOn??((g=(h=r.locale)==null?void 0:h.options)==null?void 0:g.weekStartsOn)??0,n=Zt(e,t==null?void 0:t.in),o=n.getDay(),l=(o<a?-7:0)+6-(o-a);return n.setDate(n.getDate()+l),n.setHours(23,59,59,999),n}function X3(e,t){return D0(e,{...t,weekStartsOn:1})}function K3(e,t){const r=Zt(e,t==null?void 0:t.in),a=r.getMonth(),n=a-a%3+3;return r.setMonth(n,0),r.setHours(23,59,59,999),r}const J3={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Q3=(e,t,r)=>{let a;const n=J3[e];return typeof n=="string"?a=n:t===1?a=n.one:a=n.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+a:a+" ago":a};function Bl(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Z3={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},eD={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},tD={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},rD={date:Bl({formats:Z3,defaultWidth:"full"}),time:Bl({formats:eD,defaultWidth:"full"}),dateTime:Bl({formats:tD,defaultWidth:"full"})},aD={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},nD=(e,t,r,a)=>aD[e];function ms(e){return(t,r)=>{const a=r!=null&&r.context?String(r.context):"standalone";let n;if(a==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,u=r!=null&&r.width?String(r.width):l;n=e.formattingValues[u]||e.formattingValues[l]}else{const l=e.defaultWidth,u=r!=null&&r.width?String(r.width):e.defaultWidth;n=e.values[u]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(t):t;return n[o]}}const sD={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},iD={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},oD={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},lD={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},cD={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},uD={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},fD=(e,t)=>{const r=Number(e),a=r%100;if(a>20||a<10)switch(a%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},dD={ordinalNumber:fD,era:ms({values:sD,defaultWidth:"wide"}),quarter:ms({values:iD,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ms({values:oD,defaultWidth:"wide"}),day:ms({values:lD,defaultWidth:"wide"}),dayPeriod:ms({values:cD,defaultWidth:"wide",formattingValues:uD,defaultFormattingWidth:"wide"})};function gs(e){return(t,r={})=>{const a=r.width,n=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],o=t.match(n);if(!o)return null;const l=o[0],u=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],f=Array.isArray(u)?mD(u,v=>v.test(l)):hD(u,v=>v.test(l));let h;h=e.valueCallback?e.valueCallback(f):f,h=r.valueCallback?r.valueCallback(h):h;const g=t.slice(l.length);return{value:h,rest:g}}}function hD(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function mD(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function ab(e){return(t,r={})=>{const a=t.match(e.matchPattern);if(!a)return null;const n=a[0],o=t.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=r.valueCallback?r.valueCallback(l):l;const u=t.slice(n.length);return{value:l,rest:u}}}const gD=/^(\d+)(th|st|nd|rd)?/i,xD=/\d+/i,vD={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},pD={any:[/^b/i,/^(a|c)/i]},yD={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},_D={any:[/1/i,/2/i,/3/i,/4/i]},wD={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},bD={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},SD={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},ED={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},TD={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},kD={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},AD={ordinalNumber:ab({matchPattern:gD,parsePattern:xD,valueCallback:e=>parseInt(e,10)}),era:gs({matchPatterns:vD,defaultMatchWidth:"wide",parsePatterns:pD,defaultParseWidth:"any"}),quarter:gs({matchPatterns:yD,defaultMatchWidth:"wide",parsePatterns:_D,defaultParseWidth:"any",valueCallback:e=>e+1}),month:gs({matchPatterns:wD,defaultMatchWidth:"wide",parsePatterns:bD,defaultParseWidth:"any"}),day:gs({matchPatterns:SD,defaultMatchWidth:"wide",parsePatterns:ED,defaultParseWidth:"any"}),dayPeriod:gs({matchPatterns:TD,defaultMatchWidth:"any",parsePatterns:kD,defaultParseWidth:"any"})},Ol={code:"en-US",formatDistance:Q3,formatLong:rD,formatRelative:nD,localize:dD,match:AD,options:{weekStartsOn:0,firstWeekContainsDate:1}};function CD(e,t){const r=Zt(e,t==null?void 0:t.in);return W1(r,G1(r))+1}function q1(e,t){const r=Zt(e,t==null?void 0:t.in),a=+vu(r)-+U3(r);return Math.round(a/K2)+1}function nb(e,t){var g,v,p,_;const r=Zt(e,t==null?void 0:t.in),a=r.getFullYear(),n=zu(),o=(t==null?void 0:t.firstWeekContainsDate)??((v=(g=t==null?void 0:t.locale)==null?void 0:g.options)==null?void 0:v.firstWeekContainsDate)??n.firstWeekContainsDate??((_=(p=n.locale)==null?void 0:p.options)==null?void 0:_.firstWeekContainsDate)??1,l=aa((t==null?void 0:t.in)||e,0);l.setFullYear(a+1,0,o),l.setHours(0,0,0,0);const u=ji(l,t),f=aa((t==null?void 0:t.in)||e,0);f.setFullYear(a,0,o),f.setHours(0,0,0,0);const h=ji(f,t);return+r>=+u?a+1:+r>=+h?a:a-1}function ND(e,t){var u,f,h,g;const r=zu(),a=(t==null?void 0:t.firstWeekContainsDate)??((f=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)??r.firstWeekContainsDate??((g=(h=r.locale)==null?void 0:h.options)==null?void 0:g.firstWeekContainsDate)??1,n=nb(e,t),o=aa((t==null?void 0:t.in)||e,0);return o.setFullYear(n,0,a),o.setHours(0,0,0,0),ji(o,t)}function Y1(e,t){const r=Zt(e,t==null?void 0:t.in),a=+ji(r,t)-+ND(r,t);return Math.round(a/K2)+1}function nr(e,t){const r=e<0?"-":"",a=Math.abs(e).toString().padStart(t,"0");return r+a}const Ei={y(e,t){const r=e.getFullYear(),a=r>0?r:1-r;return nr(t==="yy"?a%100:a,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):nr(r+1,2)},d(e,t){return nr(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return nr(e.getHours()%12||12,t.length)},H(e,t){return nr(e.getHours(),t.length)},m(e,t){return nr(e.getMinutes(),t.length)},s(e,t){return nr(e.getSeconds(),t.length)},S(e,t){const r=t.length,a=e.getMilliseconds(),n=Math.trunc(a*Math.pow(10,r-3));return nr(n,t.length)}},xl={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Jy={G:function(e,t,r){const a=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(a,{width:"abbreviated"});case"GGGGG":return r.era(a,{width:"narrow"});case"GGGG":default:return r.era(a,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const a=e.getFullYear(),n=a>0?a:1-a;return r.ordinalNumber(n,{unit:"year"})}return Ei.y(e,t)},Y:function(e,t,r,a){const n=nb(e,a),o=n>0?n:1-n;if(t==="YY"){const l=o%100;return nr(l,2)}return t==="Yo"?r.ordinalNumber(o,{unit:"year"}):nr(o,t.length)},R:function(e,t){const r=J2(e);return nr(r,t.length)},u:function(e,t){const r=e.getFullYear();return nr(r,t.length)},Q:function(e,t,r){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(a);case"QQ":return nr(a,2);case"Qo":return r.ordinalNumber(a,{unit:"quarter"});case"QQQ":return r.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(a,{width:"wide",context:"formatting"})}},q:function(e,t,r){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(a);case"qq":return nr(a,2);case"qo":return r.ordinalNumber(a,{unit:"quarter"});case"qqq":return r.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(a,{width:"wide",context:"standalone"})}},M:function(e,t,r){const a=e.getMonth();switch(t){case"M":case"MM":return Ei.M(e,t);case"Mo":return r.ordinalNumber(a+1,{unit:"month"});case"MMM":return r.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(a,{width:"wide",context:"formatting"})}},L:function(e,t,r){const a=e.getMonth();switch(t){case"L":return String(a+1);case"LL":return nr(a+1,2);case"Lo":return r.ordinalNumber(a+1,{unit:"month"});case"LLL":return r.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(a,{width:"wide",context:"standalone"})}},w:function(e,t,r,a){const n=Y1(e,a);return t==="wo"?r.ordinalNumber(n,{unit:"week"}):nr(n,t.length)},I:function(e,t,r){const a=q1(e);return t==="Io"?r.ordinalNumber(a,{unit:"week"}):nr(a,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Ei.d(e,t)},D:function(e,t,r){const a=CD(e);return t==="Do"?r.ordinalNumber(a,{unit:"dayOfYear"}):nr(a,t.length)},E:function(e,t,r){const a=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(a,{width:"short",context:"formatting"});case"EEEE":default:return r.day(a,{width:"wide",context:"formatting"})}},e:function(e,t,r,a){const n=e.getDay(),o=(n-a.weekStartsOn+8)%7||7;switch(t){case"e":return String(o);case"ee":return nr(o,2);case"eo":return r.ordinalNumber(o,{unit:"day"});case"eee":return r.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})}},c:function(e,t,r,a){const n=e.getDay(),o=(n-a.weekStartsOn+8)%7||7;switch(t){case"c":return String(o);case"cc":return nr(o,t.length);case"co":return r.ordinalNumber(o,{unit:"day"});case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})}},i:function(e,t,r){const a=e.getDay(),n=a===0?7:a;switch(t){case"i":return String(n);case"ii":return nr(n,t.length);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return r.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(a,{width:"short",context:"formatting"});case"iiii":default:return r.day(a,{width:"wide",context:"formatting"})}},a:function(e,t,r){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,r){const a=e.getHours();let n;switch(a===12?n=xl.noon:a===0?n=xl.midnight:n=a/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,r){const a=e.getHours();let n;switch(a>=17?n=xl.evening:a>=12?n=xl.afternoon:a>=4?n=xl.morning:n=xl.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let a=e.getHours()%12;return a===0&&(a=12),r.ordinalNumber(a,{unit:"hour"})}return Ei.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Ei.H(e,t)},K:function(e,t,r){const a=e.getHours()%12;return t==="Ko"?r.ordinalNumber(a,{unit:"hour"}):nr(a,t.length)},k:function(e,t,r){let a=e.getHours();return a===0&&(a=24),t==="ko"?r.ordinalNumber(a,{unit:"hour"}):nr(a,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Ei.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Ei.s(e,t)},S:function(e,t){return Ei.S(e,t)},X:function(e,t,r){const a=e.getTimezoneOffset();if(a===0)return"Z";switch(t){case"X":return Zy(a);case"XXXX":case"XX":return fo(a);case"XXXXX":case"XXX":default:return fo(a,":")}},x:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"x":return Zy(a);case"xxxx":case"xx":return fo(a);case"xxxxx":case"xxx":default:return fo(a,":")}},O:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Qy(a,":");case"OOOO":default:return"GMT"+fo(a,":")}},z:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Qy(a,":");case"zzzz":default:return"GMT"+fo(a,":")}},t:function(e,t,r){const a=Math.trunc(+e/1e3);return nr(a,t.length)},T:function(e,t,r){return nr(+e,t.length)}};function Qy(e,t=""){const r=e>0?"-":"+",a=Math.abs(e),n=Math.trunc(a/60),o=a%60;return o===0?r+String(n):r+String(n)+t+nr(o,2)}function Zy(e,t){return e%60===0?(e>0?"-":"+")+nr(Math.abs(e)/60,2):fo(e,t)}function fo(e,t=""){const r=e>0?"-":"+",a=Math.abs(e),n=nr(Math.trunc(a/60),2),o=nr(a%60,2);return r+n+t+o}const e_=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},sb=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},DD=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],a=r[1],n=r[2];if(!n)return e_(e,t);let o;switch(a){case"P":o=t.dateTime({width:"short"});break;case"PP":o=t.dateTime({width:"medium"});break;case"PPP":o=t.dateTime({width:"long"});break;case"PPPP":default:o=t.dateTime({width:"full"});break}return o.replace("{{date}}",e_(a,t)).replace("{{time}}",sb(n,t))},OD={p:sb,P:DD},RD=/^D+$/,FD=/^Y+$/,MD=["D","DD","YY","YYYY"];function jD(e){return RD.test(e)}function ID(e){return FD.test(e)}function PD(e,t,r){const a=LD(e,t,r);if(console.warn(a),MD.includes(e))throw new RangeError(a)}function LD(e,t,r){const a=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${a} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const BD=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,UD=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,zD=/^'([^]*?)'?$/,VD=/''/g,HD=/[a-zA-Z]/;function ir(e,t,r){var g,v,p,_,b,w,S,T;const a=zu(),n=(r==null?void 0:r.locale)??a.locale??Ol,o=(r==null?void 0:r.firstWeekContainsDate)??((v=(g=r==null?void 0:r.locale)==null?void 0:g.options)==null?void 0:v.firstWeekContainsDate)??a.firstWeekContainsDate??((_=(p=a.locale)==null?void 0:p.options)==null?void 0:_.firstWeekContainsDate)??1,l=(r==null?void 0:r.weekStartsOn)??((w=(b=r==null?void 0:r.locale)==null?void 0:b.options)==null?void 0:w.weekStartsOn)??a.weekStartsOn??((T=(S=a.locale)==null?void 0:S.options)==null?void 0:T.weekStartsOn)??0,u=Zt(e,r==null?void 0:r.in);if(!W3(u))throw new RangeError("Invalid time value");let f=t.match(UD).map(N=>{const k=N[0];if(k==="p"||k==="P"){const E=OD[k];return E(N,n.formatLong)}return N}).join("").match(BD).map(N=>{if(N==="''")return{isToken:!1,value:"'"};const k=N[0];if(k==="'")return{isToken:!1,value:$D(N)};if(Jy[k])return{isToken:!0,value:N};if(k.match(HD))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:N}});n.localize.preprocessor&&(f=n.localize.preprocessor(u,f));const h={firstWeekContainsDate:o,weekStartsOn:l,locale:n};return f.map(N=>{if(!N.isToken)return N.value;const k=N.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&ID(k)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&jD(k))&&PD(k,t,String(e));const E=Jy[k[0]];return E(u,k,n.localize,h)}).join("")}function $D(e){const t=e.match(zD);return t?t[1].replace(VD,"'"):e}function WD(e,t){const r=Zt(e,t==null?void 0:t.in),a=r.getFullYear(),n=r.getMonth(),o=aa(r,0);return o.setFullYear(a,n+1,0),o.setHours(0,0,0,0),o.getDate()}function GD(e,t){return Zt(e,t==null?void 0:t.in).getMonth()}function qD(e,t){return Zt(e,t==null?void 0:t.in).getFullYear()}function YD(e,t){return+Zt(e)>+Zt(t)}function XD(e,t){return+Zt(e)<+Zt(t)}function KD(e,t,r){const[a,n]=Kl(r==null?void 0:r.in,e,t);return a.getFullYear()===n.getFullYear()&&a.getMonth()===n.getMonth()}function JD(e,t,r){const[a,n]=Kl(r==null?void 0:r.in,e,t);return a.getFullYear()===n.getFullYear()}function QD(e,t,r){return H1(e,-1,r)}function ZD(e,t,r){const a=Zt(e,r==null?void 0:r.in),n=a.getFullYear(),o=a.getDate(),l=aa(e,0);l.setFullYear(n,t,15),l.setHours(0,0,0,0);const u=WD(l);return a.setMonth(t,Math.min(o,u)),a}function eO(e,t,r){const a=Zt(e,r==null?void 0:r.in);return isNaN(+a)?aa(e,NaN):(a.setFullYear(t),a)}function tO(e,t,r){return $1(e,-1,r)}function rO(e,t,r){return Q2(e,-1,r)}const t_=5,aO=4;function nO(e,t){const r=t.startOfMonth(e),a=r.getDay()>0?r.getDay():7,n=t.addDays(e,-a+1),o=t.addDays(n,t_*7-1);return t.getMonth(e)===t.getMonth(o)?t_:aO}function ib(e,t){const r=t.startOfMonth(e),a=r.getDay();return a===1?r:a===0?t.addDays(r,-1*6):t.addDays(r,-1*(a-1))}function sO(e,t){const r=ib(e,t),a=nO(e,t);return t.addDays(r,a*7-1)}const iO={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 ms",other:"cerca de {{count}} meses"},xMonths:{one:"1 ms",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},oO=(e,t,r)=>{let a;const n=iO[e];return typeof n=="string"?a=n:t===1?a=n.one:a=n.other.replace("{{count}}",String(t)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"em "+a:"h "+a:a},lO={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},cO={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},uO={full:"{{date}} 's' {{time}}",long:"{{date}} 's' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},fO={date:Bl({formats:lO,defaultWidth:"full"}),time:Bl({formats:cO,defaultWidth:"full"}),dateTime:Bl({formats:uO,defaultWidth:"full"})},dO={lastWeek:e=>{const t=e.getDay();return"'"+(t===0||t===6?"ltimo":"ltima")+"' eeee 's' p"},yesterday:"'ontem s' p",today:"'hoje s' p",tomorrow:"'amanh s' p",nextWeek:"eeee 's' p",other:"P"},hO=(e,t,r,a)=>{const n=dO[e];return typeof n=="function"?n(t):n},mO={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},gO={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},xO={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},vO={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","tera","quarta","quinta","sexta","sbado"],wide:["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"]},pO={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"}},yO={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},_O=(e,t)=>{const r=Number(e);return(t==null?void 0:t.unit)==="week"?r+"":r+""},wO={ordinalNumber:_O,era:ms({values:mO,defaultWidth:"wide"}),quarter:ms({values:gO,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ms({values:xO,defaultWidth:"wide"}),day:ms({values:vO,defaultWidth:"wide"}),dayPeriod:ms({values:pO,defaultWidth:"wide",formattingValues:yO,defaultFormattingWidth:"wide"})},bO=/^(\d+)[o]?/i,SO=/\d+/i,EO={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},TO={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},kO={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},AO={any:[/1/i,/2/i,/3/i,/4/i]},CO={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|maro|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},NO={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},DO={narrow:/^(dom|[23456]?|s[a]b)/i,short:/^(dom|[23456]?|s[a]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a]b)/i,wide:/^(domingo|(segunda|ter[c]a|quarta|quinta|sexta)([- ]feira)?|s[a]bado)/i},OO={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a]b/i]},RO={narrow:/^(a|p|mn|md|(da) (manh|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh|tarde|noite))/i},FO={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},MO={ordinalNumber:ab({matchPattern:bO,parsePattern:SO,valueCallback:e=>parseInt(e,10)}),era:gs({matchPatterns:EO,defaultMatchWidth:"wide",parsePatterns:TO,defaultParseWidth:"any"}),quarter:gs({matchPatterns:kO,defaultMatchWidth:"wide",parsePatterns:AO,defaultParseWidth:"any",valueCallback:e=>e+1}),month:gs({matchPatterns:CO,defaultMatchWidth:"wide",parsePatterns:NO,defaultParseWidth:"any"}),day:gs({matchPatterns:DO,defaultMatchWidth:"wide",parsePatterns:OO,defaultParseWidth:"any"}),dayPeriod:gs({matchPatterns:RO,defaultMatchWidth:"any",parsePatterns:FO,defaultParseWidth:"any"})},da={code:"pt-BR",formatDistance:oO,formatLong:fO,formatRelative:hO,localize:wO,match:MO,options:{weekStartsOn:0,firstWeekContainsDate:1}},ob={...Ol,labels:{labelDayButton:(e,t,r,a)=>{let n;a&&typeof a.format=="function"?n=a.format.bind(a):n=(l,u)=>ir(l,u,{locale:Ol,...r});let o=n(e,"PPPP");return t.today&&(o=`Today, ${o}`),t.selected&&(o=`${o}, selected`),o},labelMonthDropdown:"Choose the Month",labelNext:"Go to the Next Month",labelPrevious:"Go to the Previous Month",labelWeekNumber:e=>`Week ${e}`,labelYearDropdown:"Choose the Year",labelGrid:(e,t,r)=>{let a;return r&&typeof r.format=="function"?a=r.format.bind(r):a=(n,o)=>ir(n,o,{locale:Ol,...t}),a(e,"LLLL yyyy")},labelGridcell:(e,t,r,a)=>{let n;a&&typeof a.format=="function"?n=a.format.bind(a):n=(l,u)=>ir(l,u,{locale:Ol,...r});let o=n(e,"PPPP");return t!=null&&t.today&&(o=`Today, ${o}`),o},labelNav:"Navigation bar",labelWeekNumberHeader:"Week Number",labelWeekday:(e,t,r)=>{let a;return r&&typeof r.format=="function"?a=r.format.bind(r):a=(n,o)=>ir(n,o,{locale:Ol,...t}),a(e,"cccc")}}};class xn{constructor(t,r){this.Date=Date,this.today=()=>{var a;return(a=this.overrides)!=null&&a.today?this.overrides.today():this.options.timeZone?Da.tz(this.options.timeZone):new this.Date},this.newDate=(a,n,o)=>{var l;return(l=this.overrides)!=null&&l.newDate?this.overrides.newDate(a,n,o):this.options.timeZone?new Da(a,n,o,this.options.timeZone):new Date(a,n,o)},this.addDays=(a,n)=>{var o;return(o=this.overrides)!=null&&o.addDays?this.overrides.addDays(a,n):H1(a,n)},this.addMonths=(a,n)=>{var o;return(o=this.overrides)!=null&&o.addMonths?this.overrides.addMonths(a,n):$1(a,n)},this.addWeeks=(a,n)=>{var o;return(o=this.overrides)!=null&&o.addWeeks?this.overrides.addWeeks(a,n):Q2(a,n)},this.addYears=(a,n)=>{var o;return(o=this.overrides)!=null&&o.addYears?this.overrides.addYears(a,n):z3(a,n)},this.differenceInCalendarDays=(a,n)=>{var o;return(o=this.overrides)!=null&&o.differenceInCalendarDays?this.overrides.differenceInCalendarDays(a,n):W1(a,n)},this.differenceInCalendarMonths=(a,n)=>{var o;return(o=this.overrides)!=null&&o.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(a,n):eb(a,n)},this.eachMonthOfInterval=a=>{var n;return(n=this.overrides)!=null&&n.eachMonthOfInterval?this.overrides.eachMonthOfInterval(a):G3(a)},this.eachYearOfInterval=a=>{var u;const n=(u=this.overrides)!=null&&u.eachYearOfInterval?this.overrides.eachYearOfInterval(a):Y3(a),o=new Set(n.map(f=>this.getYear(f)));if(o.size===n.length)return n;const l=[];return o.forEach(f=>{l.push(new Date(f,0,1))}),l},this.endOfBroadcastWeek=a=>{var n;return(n=this.overrides)!=null&&n.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(a):sO(a,this)},this.endOfISOWeek=a=>{var n;return(n=this.overrides)!=null&&n.endOfISOWeek?this.overrides.endOfISOWeek(a):X3(a)},this.endOfMonth=a=>{var n;return(n=this.overrides)!=null&&n.endOfMonth?this.overrides.endOfMonth(a):o1(a)},this.endOfWeek=(a,n)=>{var o;return(o=this.overrides)!=null&&o.endOfWeek?this.overrides.endOfWeek(a,n):D0(a,this.options)},this.endOfYear=a=>{var n;return(n=this.overrides)!=null&&n.endOfYear?this.overrides.endOfYear(a):rb(a)},this.format=(a,n,o)=>{var u;const l=(u=this.overrides)!=null&&u.format?this.overrides.format(a,n,this.options):ir(a,n,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(l):l},this.getISOWeek=a=>{var n;return(n=this.overrides)!=null&&n.getISOWeek?this.overrides.getISOWeek(a):q1(a)},this.getMonth=(a,n)=>{var o;return(o=this.overrides)!=null&&o.getMonth?this.overrides.getMonth(a,this.options):GD(a,this.options)},this.getYear=(a,n)=>{var o;return(o=this.overrides)!=null&&o.getYear?this.overrides.getYear(a,this.options):qD(a,this.options)},this.getWeek=(a,n)=>{var o;return(o=this.overrides)!=null&&o.getWeek?this.overrides.getWeek(a,this.options):Y1(a,this.options)},this.isAfter=(a,n)=>{var o;return(o=this.overrides)!=null&&o.isAfter?this.overrides.isAfter(a,n):YD(a,n)},this.isBefore=(a,n)=>{var o;return(o=this.overrides)!=null&&o.isBefore?this.overrides.isBefore(a,n):XD(a,n)},this.isDate=a=>{var n;return(n=this.overrides)!=null&&n.isDate?this.overrides.isDate(a):Z2(a)},this.isSameDay=(a,n)=>{var o;return(o=this.overrides)!=null&&o.isSameDay?this.overrides.isSameDay(a,n):$3(a,n)},this.isSameMonth=(a,n)=>{var o;return(o=this.overrides)!=null&&o.isSameMonth?this.overrides.isSameMonth(a,n):KD(a,n)},this.isSameYear=(a,n)=>{var o;return(o=this.overrides)!=null&&o.isSameYear?this.overrides.isSameYear(a,n):JD(a,n)},this.max=a=>{var n;return(n=this.overrides)!=null&&n.max?this.overrides.max(a):V3(a)},this.min=a=>{var n;return(n=this.overrides)!=null&&n.min?this.overrides.min(a):H3(a)},this.setMonth=(a,n)=>{var o;return(o=this.overrides)!=null&&o.setMonth?this.overrides.setMonth(a,n):ZD(a,n)},this.setYear=(a,n)=>{var o;return(o=this.overrides)!=null&&o.setYear?this.overrides.setYear(a,n):eO(a,n)},this.startOfBroadcastWeek=(a,n)=>{var o;return(o=this.overrides)!=null&&o.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(a,this):ib(a,this)},this.startOfDay=a=>{var n;return(n=this.overrides)!=null&&n.startOfDay?this.overrides.startOfDay(a):Mi(a)},this.startOfISOWeek=a=>{var n;return(n=this.overrides)!=null&&n.startOfISOWeek?this.overrides.startOfISOWeek(a):vu(a)},this.startOfMonth=a=>{var n;return(n=this.overrides)!=null&&n.startOfMonth?this.overrides.startOfMonth(a):l1(a)},this.startOfWeek=(a,n)=>{var o;return(o=this.overrides)!=null&&o.startOfWeek?this.overrides.startOfWeek(a,this.options):ji(a,this.options)},this.startOfYear=a=>{var n;return(n=this.overrides)!=null&&n.startOfYear?this.overrides.startOfYear(a):G1(a)},this.options={locale:ob,...t},this.overrides=r}getDigitMap(){const{numerals:t="latn"}=this.options,r=new Intl.NumberFormat("en-US",{numberingSystem:t}),a={};for(let n=0;n<10;n++)a[n.toString()]=r.format(n);return a}replaceDigits(t){const r=this.getDigitMap();return t.replace(/\d/g,a=>r[a]||a)}formatNumber(t){return this.replaceDigits(t.toString())}getMonthYearOrder(){var r;const t=(r=this.options.locale)==null?void 0:r.code;return t&&xn.yearFirstLocales.has(t)?"year-first":"month-first"}formatMonthYear(t){const{locale:r,timeZone:a,numerals:n}=this.options,o=r==null?void 0:r.code;if(o&&xn.yearFirstLocales.has(o))try{return new Intl.DateTimeFormat(o,{month:"long",year:"numeric",timeZone:a,numberingSystem:n}).format(t)}catch{}const l=this.getMonthYearOrder()==="year-first"?"y LLLL":"LLLL y";return this.format(t,l)}}xn.yearFirstLocales=new Set(["eu","hu","ja","ja-Hira","ja-JP","ko","ko-KR","lt","lt-LT","lv","lv-LV","mn","mn-MN","zh","zh-CN","zh-HK","zh-TW"]);const _s=new xn;class lb{constructor(t,r,a=_s){this.date=t,this.displayMonth=r,this.outside=!!(r&&!a.isSameMonth(t,r)),this.dateLib=a,this.isoDate=a.format(t,"yyyy-MM-dd"),this.displayMonthId=a.format(r,"yyyy-MM"),this.dateMonthId=a.format(t,"yyyy-MM")}isEqualTo(t){return this.dateLib.isSameDay(t.date,this.date)&&this.dateLib.isSameMonth(t.displayMonth,this.displayMonth)}}class jO{constructor(t,r){this.date=t,this.weeks=r}}class IO{constructor(t,r){this.days=r,this.weekNumber=t}}function PO(e){return ge.createElement("button",{...e})}function LO(e){return ge.createElement("span",{...e})}function BO(e){const{size:t=24,orientation:r="left",className:a}=e;return ge.createElement("svg",{className:a,width:t,height:t,viewBox:"0 0 24 24"},r==="up"&&ge.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),r==="down"&&ge.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),r==="left"&&ge.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),r==="right"&&ge.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function UO(e){const{day:t,modifiers:r,...a}=e;return ge.createElement("td",{...a})}function zO(e){const{day:t,modifiers:r,...a}=e,n=ge.useRef(null);return ge.useEffect(()=>{var o;r.focused&&((o=n.current)==null||o.focus())},[r.focused]),ge.createElement("button",{ref:n,...a})}var ht;(function(e){e.Root="root",e.Chevron="chevron",e.Day="day",e.DayButton="day_button",e.CaptionLabel="caption_label",e.Dropdowns="dropdowns",e.Dropdown="dropdown",e.DropdownRoot="dropdown_root",e.Footer="footer",e.MonthGrid="month_grid",e.MonthCaption="month_caption",e.MonthsDropdown="months_dropdown",e.Month="month",e.Months="months",e.Nav="nav",e.NextMonthButton="button_next",e.PreviousMonthButton="button_previous",e.Week="week",e.Weeks="weeks",e.Weekday="weekday",e.Weekdays="weekdays",e.WeekNumber="week_number",e.WeekNumberHeader="week_number_header",e.YearsDropdown="years_dropdown"})(ht||(ht={}));var Mr;(function(e){e.disabled="disabled",e.hidden="hidden",e.outside="outside",e.focused="focused",e.today="today"})(Mr||(Mr={}));var Zn;(function(e){e.range_end="range_end",e.range_middle="range_middle",e.range_start="range_start",e.selected="selected"})(Zn||(Zn={}));var on;(function(e){e.weeks_before_enter="weeks_before_enter",e.weeks_before_exit="weeks_before_exit",e.weeks_after_enter="weeks_after_enter",e.weeks_after_exit="weeks_after_exit",e.caption_after_enter="caption_after_enter",e.caption_after_exit="caption_after_exit",e.caption_before_enter="caption_before_enter",e.caption_before_exit="caption_before_exit"})(on||(on={}));function VO(e){const{options:t,className:r,components:a,classNames:n,...o}=e,l=[n[ht.Dropdown],r].join(" "),u=t==null?void 0:t.find(({value:f})=>f===o.value);return ge.createElement("span",{"data-disabled":o.disabled,className:n[ht.DropdownRoot]},ge.createElement(a.Select,{className:l,...o},t==null?void 0:t.map(({value:f,label:h,disabled:g})=>ge.createElement(a.Option,{key:f,value:f,disabled:g},h))),ge.createElement("span",{className:n[ht.CaptionLabel],"aria-hidden":!0},u==null?void 0:u.label,ge.createElement(a.Chevron,{orientation:"down",size:18,className:n[ht.Chevron]})))}function HO(e){return ge.createElement("div",{...e})}function $O(e){return ge.createElement("div",{...e})}function WO(e){const{calendarMonth:t,displayIndex:r,...a}=e;return ge.createElement("div",{...a},e.children)}function GO(e){const{calendarMonth:t,displayIndex:r,...a}=e;return ge.createElement("div",{...a})}function qO(e){return ge.createElement("table",{...e})}function YO(e){return ge.createElement("div",{...e})}const cb=K.createContext(void 0);function Vu(){const e=K.useContext(cb);if(e===void 0)throw new Error("useDayPicker() must be used within a custom component.");return e}function XO(e){const{components:t}=Vu();return ge.createElement(t.Dropdown,{...e})}function KO(e){const{onPreviousClick:t,onNextClick:r,previousMonth:a,nextMonth:n,...o}=e,{components:l,classNames:u,labels:{labelPrevious:f,labelNext:h}}=Vu(),g=K.useCallback(p=>{n&&(r==null||r(p))},[n,r]),v=K.useCallback(p=>{a&&(t==null||t(p))},[a,t]);return ge.createElement("nav",{...o},ge.createElement(l.PreviousMonthButton,{type:"button",className:u[ht.PreviousMonthButton],tabIndex:a?void 0:-1,"aria-disabled":a?void 0:!0,"aria-label":f(a),onClick:v},ge.createElement(l.Chevron,{disabled:a?void 0:!0,className:u[ht.Chevron],orientation:"left"})),ge.createElement(l.NextMonthButton,{type:"button",className:u[ht.NextMonthButton],tabIndex:n?void 0:-1,"aria-disabled":n?void 0:!0,"aria-label":h(n),onClick:g},ge.createElement(l.Chevron,{disabled:n?void 0:!0,orientation:"right",className:u[ht.Chevron]})))}function JO(e){const{components:t}=Vu();return ge.createElement(t.Button,{...e})}function QO(e){return ge.createElement("option",{...e})}function ZO(e){const{components:t}=Vu();return ge.createElement(t.Button,{...e})}function eR(e){const{rootRef:t,...r}=e;return ge.createElement("div",{...r,ref:t})}function tR(e){return ge.createElement("select",{...e})}function rR(e){const{week:t,...r}=e;return ge.createElement("tr",{...r})}function aR(e){return ge.createElement("th",{...e})}function nR(e){return ge.createElement("thead",{"aria-hidden":!0},ge.createElement("tr",{...e}))}function sR(e){const{week:t,...r}=e;return ge.createElement("th",{...r})}function iR(e){return ge.createElement("th",{...e})}function oR(e){return ge.createElement("tbody",{...e})}function lR(e){const{components:t}=Vu();return ge.createElement(t.Dropdown,{...e})}const cR=Object.freeze(Object.defineProperty({__proto__:null,Button:PO,CaptionLabel:LO,Chevron:BO,Day:UO,DayButton:zO,Dropdown:VO,DropdownNav:HO,Footer:$O,Month:WO,MonthCaption:GO,MonthGrid:qO,Months:YO,MonthsDropdown:XO,Nav:KO,NextMonthButton:JO,Option:QO,PreviousMonthButton:ZO,Root:eR,Select:tR,Week:rR,WeekNumber:sR,WeekNumberHeader:iR,Weekday:aR,Weekdays:nR,Weeks:oR,YearsDropdown:lR},Symbol.toStringTag,{value:"Module"}));function zs(e,t,r=!1,a=_s){let{from:n,to:o}=e;const{differenceInCalendarDays:l,isSameDay:u}=a;return n&&o?(l(o,n)<0&&([n,o]=[o,n]),l(t,n)>=(r?1:0)&&l(o,t)>=(r?1:0)):!r&&o?u(o,t):!r&&n?u(n,t):!1}function X1(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function ed(e){return!!(e&&typeof e=="object"&&"from"in e)}function K1(e){return!!(e&&typeof e=="object"&&"after"in e)}function J1(e){return!!(e&&typeof e=="object"&&"before"in e)}function ub(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function fb(e,t){return Array.isArray(e)&&e.every(t.isDate)}function Vs(e,t,r=_s){const a=Array.isArray(t)?t:[t],{isSameDay:n,differenceInCalendarDays:o,isAfter:l}=r;return a.some(u=>{if(typeof u=="boolean")return u;if(r.isDate(u))return n(e,u);if(fb(u,r))return u.some(f=>n(e,f));if(ed(u))return zs(u,e,!1,r);if(ub(u))return Array.isArray(u.dayOfWeek)?u.dayOfWeek.includes(e.getDay()):u.dayOfWeek===e.getDay();if(X1(u)){const f=o(u.before,e),h=o(u.after,e),g=f>0,v=h<0;return l(u.before,u.after)?v&&g:g||v}return K1(u)?o(e,u.after)>0:J1(u)?o(u.before,e)>0:typeof u=="function"?u(e):!1})}function uR(e,t,r,a,n){const{disabled:o,hidden:l,modifiers:u,showOutsideDays:f,broadcastCalendar:h,today:g=n.today()}=t,{isSameDay:v,isSameMonth:p,startOfMonth:_,isBefore:b,endOfMonth:w,isAfter:S}=n,T=r&&_(r),N=a&&w(a),k={[Mr.focused]:[],[Mr.outside]:[],[Mr.disabled]:[],[Mr.hidden]:[],[Mr.today]:[]},E={};for(const M of e){const{date:D,displayMonth:A}=M,B=!!(A&&!p(D,A)),j=!!(T&&b(D,T)),ee=!!(N&&S(D,N)),re=!!(o&&Vs(D,o,n)),U=!!(l&&Vs(D,l,n))||j||ee||!h&&!f&&B||h&&f===!1&&B,I=v(D,g);B&&k.outside.push(M),re&&k.disabled.push(M),U&&k.hidden.push(M),I&&k.today.push(M),u&&Object.keys(u).forEach(ne=>{const ie=u==null?void 0:u[ne];ie&&Vs(D,ie,n)&&(E[ne]?E[ne].push(M):E[ne]=[M])})}return M=>{const D={[Mr.focused]:!1,[Mr.disabled]:!1,[Mr.hidden]:!1,[Mr.outside]:!1,[Mr.today]:!1},A={};for(const B in k){const j=k[B];D[B]=j.some(ee=>ee===M)}for(const B in E)A[B]=E[B].some(j=>j===M);return{...D,...A}}}function fR(e,t,r={}){return Object.entries(e).filter(([,n])=>n===!0).reduce((n,[o])=>(r[o]?n.push(r[o]):t[Mr[o]]?n.push(t[Mr[o]]):t[Zn[o]]&&n.push(t[Zn[o]]),n),[t[ht.Day]])}function dR(e){return{...cR,...e}}function hR(e){const t={"data-mode":e.mode??void 0,"data-required":"required"in e?e.required:void 0,"data-multiple-months":e.numberOfMonths&&e.numberOfMonths>1||void 0,"data-week-numbers":e.showWeekNumber||void 0,"data-broadcast-calendar":e.broadcastCalendar||void 0,"data-nav-layout":e.navLayout||void 0};return Object.entries(e).forEach(([r,a])=>{r.startsWith("data-")&&(t[r]=a)}),t}function Q1(){const e={};for(const t in ht)e[ht[t]]=`rdp-${ht[t]}`;for(const t in Mr)e[Mr[t]]=`rdp-${Mr[t]}`;for(const t in Zn)e[Zn[t]]=`rdp-${Zn[t]}`;for(const t in on)e[on[t]]=`rdp-${on[t]}`;return e}function db(e,t,r){return(r??new xn(t)).formatMonthYear(e)}const mR=db;function gR(e,t,r){return(r??new xn(t)).format(e,"d")}function xR(e,t=_s){return t.format(e,"LLLL")}function vR(e,t,r){return(r??new xn(t)).format(e,"cccccc")}function pR(e,t=_s){return e<10?t.formatNumber(`0${e.toLocaleString()}`):t.formatNumber(`${e.toLocaleString()}`)}function yR(){return""}function hb(e,t=_s){return t.format(e,"yyyy")}const _R=hb,wR=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:db,formatDay:gR,formatMonthCaption:mR,formatMonthDropdown:xR,formatWeekNumber:pR,formatWeekNumberHeader:yR,formatWeekdayName:vR,formatYearCaption:_R,formatYearDropdown:hb},Symbol.toStringTag,{value:"Module"}));function bR(e){return e!=null&&e.formatMonthCaption&&!e.formatCaption&&(e.formatCaption=e.formatMonthCaption),e!=null&&e.formatYearCaption&&!e.formatYearDropdown&&(e.formatYearDropdown=e.formatYearCaption),{...wR,...e}}function Z1(e,t,r,a){let n=(a??new xn(r)).format(e,"PPPP");return t.today&&(n=`Today, ${n}`),t.selected&&(n=`${n}, selected`),n}const SR=Z1;function eg(e,t,r){return(r??new xn(t)).formatMonthYear(e)}const ER=eg;function mb(e,t,r,a){let n=(a??new xn(r)).format(e,"PPPP");return t!=null&&t.today&&(n=`Today, ${n}`),n}function gb(e){return"Choose the Month"}function xb(){return""}const TR="Go to the Next Month";function vb(e,t){return TR}function pb(e){return"Go to the Previous Month"}function yb(e,t,r){return(r??new xn(t)).format(e,"cccc")}function _b(e,t){return`Week ${e}`}function wb(e){return"Week Number"}function bb(e){return"Choose the Year"}const kR=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:ER,labelDay:SR,labelDayButton:Z1,labelGrid:eg,labelGridcell:mb,labelMonthDropdown:gb,labelNav:xb,labelNext:vb,labelPrevious:pb,labelWeekNumber:_b,labelWeekNumberHeader:wb,labelWeekday:yb,labelYearDropdown:bb},Symbol.toStringTag,{value:"Module"})),Gn=(e,t,r)=>t||(r?typeof r=="function"?r:(...a)=>r:e);function AR(e,t){var a;const r=((a=t.locale)==null?void 0:a.labels)??{};return{...kR,...e??{},labelDayButton:Gn(Z1,e==null?void 0:e.labelDayButton,r.labelDayButton),labelMonthDropdown:Gn(gb,e==null?void 0:e.labelMonthDropdown,r.labelMonthDropdown),labelNext:Gn(vb,e==null?void 0:e.labelNext,r.labelNext),labelPrevious:Gn(pb,e==null?void 0:e.labelPrevious,r.labelPrevious),labelWeekNumber:Gn(_b,e==null?void 0:e.labelWeekNumber,r.labelWeekNumber),labelYearDropdown:Gn(bb,e==null?void 0:e.labelYearDropdown,r.labelYearDropdown),labelGrid:Gn(eg,e==null?void 0:e.labelGrid,r.labelGrid),labelGridcell:Gn(mb,e==null?void 0:e.labelGridcell,r.labelGridcell),labelNav:Gn(xb,e==null?void 0:e.labelNav,r.labelNav),labelWeekNumberHeader:Gn(wb,e==null?void 0:e.labelWeekNumberHeader,r.labelWeekNumberHeader),labelWeekday:Gn(yb,e==null?void 0:e.labelWeekday,r.labelWeekday)}}function CR(e,t,r,a,n){const{startOfMonth:o,startOfYear:l,endOfYear:u,eachMonthOfInterval:f,getMonth:h}=n;return f({start:l(e),end:u(e)}).map(p=>{const _=a.formatMonthDropdown(p,n),b=h(p),w=t&&p<o(t)||r&&p>o(r)||!1;return{value:b,label:_,disabled:w}})}function NR(e,t={},r={}){let a={...t==null?void 0:t[ht.Day]};return Object.entries(e).filter(([,n])=>n===!0).forEach(([n])=>{a={...a,...r==null?void 0:r[n]}}),a}function DR(e,t,r,a){const n=a??e.today(),o=r?e.startOfBroadcastWeek(n,e):t?e.startOfISOWeek(n):e.startOfWeek(n),l=[];for(let u=0;u<7;u++){const f=e.addDays(o,u);l.push(f)}return l}function OR(e,t,r,a,n=!1){if(!e||!t)return;const{startOfYear:o,endOfYear:l,eachYearOfInterval:u,getYear:f}=a,h=o(e),g=l(t),v=u({start:h,end:g});return n&&v.reverse(),v.map(p=>{const _=r.formatYearDropdown(p,a);return{value:f(p),label:_,disabled:!1}})}function RR(e,t={}){var u;const{weekStartsOn:r,locale:a}=t,n=r??((u=a==null?void 0:a.options)==null?void 0:u.weekStartsOn)??0,o=f=>{const h=typeof f=="number"||typeof f=="string"?new Date(f):f;return new Da(h.getFullYear(),h.getMonth(),h.getDate(),12,0,0,e)},l=f=>{const h=o(f);return new Date(h.getFullYear(),h.getMonth(),h.getDate(),0,0,0,0)};return{today:()=>o(Da.tz(e)),newDate:(f,h,g)=>new Da(f,h,g,12,0,0,e),startOfDay:f=>o(f),startOfWeek:(f,h)=>{const g=o(f),v=(h==null?void 0:h.weekStartsOn)??n,p=(g.getDay()-v+7)%7;return g.setDate(g.getDate()-p),g},startOfISOWeek:f=>{const h=o(f),g=(h.getDay()-1+7)%7;return h.setDate(h.getDate()-g),h},startOfMonth:f=>{const h=o(f);return h.setDate(1),h},startOfYear:f=>{const h=o(f);return h.setMonth(0,1),h},endOfWeek:(f,h)=>{const g=o(f),_=((((h==null?void 0:h.weekStartsOn)??n)+6)%7-g.getDay()+7)%7;return g.setDate(g.getDate()+_),g},endOfISOWeek:f=>{const h=o(f),g=(7-h.getDay())%7;return h.setDate(h.getDate()+g),h},endOfMonth:f=>{const h=o(f);return h.setMonth(h.getMonth()+1,0),h},endOfYear:f=>{const h=o(f);return h.setMonth(11,31),h},eachMonthOfInterval:f=>{const h=o(f.start),g=o(f.end),v=[],p=new Da(h.getFullYear(),h.getMonth(),1,12,0,0,e),_=g.getFullYear()*12+g.getMonth();for(;p.getFullYear()*12+p.getMonth()<=_;)v.push(new Da(p,e)),p.setMonth(p.getMonth()+1,1);return v},addDays:(f,h)=>{const g=o(f);return g.setDate(g.getDate()+h),g},addWeeks:(f,h)=>{const g=o(f);return g.setDate(g.getDate()+h*7),g},addMonths:(f,h)=>{const g=o(f);return g.setMonth(g.getMonth()+h),g},addYears:(f,h)=>{const g=o(f);return g.setFullYear(g.getFullYear()+h),g},eachYearOfInterval:f=>{const h=o(f.start),g=o(f.end),v=[],p=new Da(h.getFullYear(),0,1,12,0,0,e);for(;p.getFullYear()<=g.getFullYear();)v.push(new Da(p,e)),p.setFullYear(p.getFullYear()+1,0,1);return v},getWeek:(f,h)=>{var v;const g=l(f);return Y1(g,{weekStartsOn:(h==null?void 0:h.weekStartsOn)??n,firstWeekContainsDate:(h==null?void 0:h.firstWeekContainsDate)??((v=a==null?void 0:a.options)==null?void 0:v.firstWeekContainsDate)??1})},getISOWeek:f=>{const h=l(f);return q1(h)},differenceInCalendarDays:(f,h)=>{const g=l(f),v=l(h);return W1(g,v)},differenceInCalendarMonths:(f,h)=>{const g=l(f),v=l(h);return eb(g,v)}}}const Hu=e=>e instanceof HTMLElement?e:null,Tm=e=>[...e.querySelectorAll("[data-animated-month]")??[]],FR=e=>Hu(e.querySelector("[data-animated-month]")),km=e=>Hu(e.querySelector("[data-animated-caption]")),Am=e=>Hu(e.querySelector("[data-animated-weeks]")),MR=e=>Hu(e.querySelector("[data-animated-nav]")),jR=e=>Hu(e.querySelector("[data-animated-weekdays]"));function IR(e,t,{classNames:r,months:a,focused:n,dateLib:o}){const l=K.useRef(null),u=K.useRef(a),f=K.useRef(!1);K.useLayoutEffect(()=>{const h=u.current;if(u.current=a,!t||!e.current||!(e.current instanceof HTMLElement)||a.length===0||h.length===0||a.length!==h.length)return;const g=o.isSameMonth(a[0].date,h[0].date),v=o.isAfter(a[0].date,h[0].date),p=v?r[on.caption_after_enter]:r[on.caption_before_enter],_=v?r[on.weeks_after_enter]:r[on.weeks_before_enter],b=l.current,w=e.current.cloneNode(!0);if(w instanceof HTMLElement?(Tm(w).forEach(k=>{if(!(k instanceof HTMLElement))return;const E=FR(k);E&&k.contains(E)&&k.removeChild(E);const M=km(k);M&&M.classList.remove(p);const D=Am(k);D&&D.classList.remove(_)}),l.current=w):l.current=null,f.current||g||n)return;const S=b instanceof HTMLElement?Tm(b):[],T=Tm(e.current);if(T!=null&&T.every(N=>N instanceof HTMLElement)&&S&&S.every(N=>N instanceof HTMLElement)){f.current=!0,e.current.style.isolation="isolate";const N=MR(e.current);N&&(N.style.zIndex="1"),T.forEach((k,E)=>{const M=S[E];if(!M)return;k.style.position="relative",k.style.overflow="hidden";const D=km(k);D&&D.classList.add(p);const A=Am(k);A&&A.classList.add(_);const B=()=>{f.current=!1,e.current&&(e.current.style.isolation=""),N&&(N.style.zIndex=""),D&&D.classList.remove(p),A&&A.classList.remove(_),k.style.position="",k.style.overflow="",k.contains(M)&&k.removeChild(M)};M.style.pointerEvents="none",M.style.position="absolute",M.style.overflow="hidden",M.setAttribute("aria-hidden","true");const j=jR(M);j&&(j.style.opacity="0");const ee=km(M);ee&&(ee.classList.add(v?r[on.caption_before_exit]:r[on.caption_after_exit]),ee.addEventListener("animationend",B));const re=Am(M);re&&re.classList.add(v?r[on.weeks_before_exit]:r[on.weeks_after_exit]),k.insertBefore(M,k.firstChild)})}})}function PR(e,t,r,a){const n=e[0],o=e[e.length-1],{ISOWeek:l,fixedWeeks:u,broadcastCalendar:f}=r??{},{addDays:h,differenceInCalendarDays:g,differenceInCalendarMonths:v,endOfBroadcastWeek:p,endOfISOWeek:_,endOfMonth:b,endOfWeek:w,isAfter:S,startOfBroadcastWeek:T,startOfISOWeek:N,startOfWeek:k}=a,E=f?T(n,a):l?N(n):k(n),M=f?p(o):l?_(b(o)):w(b(o)),D=t&&(f?p(t):l?_(t):w(t)),A=D&&S(M,D)?D:M,B=g(A,E),j=v(o,n)+1,ee=[];for(let I=0;I<=B;I++){const ne=h(E,I);ee.push(ne)}const U=(f?35:42)*j;if(u&&ee.length<U){const I=U-ee.length;for(let ne=0;ne<I;ne++){const ie=h(ee[ee.length-1],1);ee.push(ie)}}return ee}function LR(e){const t=[];return e.reduce((r,a)=>{const n=a.weeks.reduce((o,l)=>o.concat(l.days.slice()),t.slice());return r.concat(n.slice())},t.slice())}function BR(e,t,r,a){const{numberOfMonths:n=1}=r,o=[];for(let l=0;l<n;l++){const u=a.addMonths(e,l);if(t&&u>t)break;o.push(u)}return o}function r_(e,t,r,a){const{month:n,defaultMonth:o,today:l=a.today(),numberOfMonths:u=1}=e;let f=n||o||l;const{differenceInCalendarMonths:h,addMonths:g,startOfMonth:v}=a;if(r&&h(r,f)<u-1){const p=-1*(u-1);f=g(r,p)}return t&&h(f,t)<0&&(f=t),v(f)}function UR(e,t,r,a){const{addDays:n,endOfBroadcastWeek:o,endOfISOWeek:l,endOfMonth:u,endOfWeek:f,getISOWeek:h,getWeek:g,startOfBroadcastWeek:v,startOfISOWeek:p,startOfWeek:_}=a,b=e.reduce((w,S)=>{const T=r.broadcastCalendar?v(S,a):r.ISOWeek?p(S):_(S),N=r.broadcastCalendar?o(S):r.ISOWeek?l(u(S)):f(u(S)),k=t.filter(A=>A>=T&&A<=N),E=r.broadcastCalendar?35:42;if(r.fixedWeeks&&k.length<E){const A=t.filter(B=>{const j=E-k.length;return B>N&&B<=n(N,j)});k.push(...A)}const M=k.reduce((A,B)=>{const j=r.ISOWeek?h(B):g(B),ee=A.find(U=>U.weekNumber===j),re=new lb(B,S,a);return ee?ee.days.push(re):A.push(new IO(j,[re])),A},[]),D=new jO(S,M);return w.push(D),w},[]);return r.reverseMonths?b.reverse():b}function zR(e,t){let{startMonth:r,endMonth:a}=e;const{startOfYear:n,startOfDay:o,startOfMonth:l,endOfMonth:u,addYears:f,endOfYear:h,newDate:g,today:v}=t,{fromYear:p,toYear:_,fromMonth:b,toMonth:w}=e;!r&&b&&(r=b),!r&&p&&(r=t.newDate(p,0,1)),!a&&w&&(a=w),!a&&_&&(a=g(_,11,31));const S=e.captionLayout==="dropdown"||e.captionLayout==="dropdown-years";return r?r=l(r):p?r=g(p,0,1):!r&&S&&(r=n(f(e.today??v(),-100))),a?a=u(a):_?a=g(_,11,31):!a&&S&&(a=h(e.today??v())),[r&&o(r),a&&o(a)]}function VR(e,t,r,a){if(r.disableNavigation)return;const{pagedNavigation:n,numberOfMonths:o=1}=r,{startOfMonth:l,addMonths:u,differenceInCalendarMonths:f}=a,h=n?o:1,g=l(e);if(!t)return u(g,h);if(!(f(t,e)<o))return u(g,h)}function HR(e,t,r,a){if(r.disableNavigation)return;const{pagedNavigation:n,numberOfMonths:o}=r,{startOfMonth:l,addMonths:u,differenceInCalendarMonths:f}=a,h=n?o??1:1,g=l(e);if(!t)return u(g,-h);if(!(f(g,t)<=0))return u(g,-h)}function $R(e){const t=[];return e.reduce((r,a)=>r.concat(a.weeks.slice()),t.slice())}function td(e,t){const[r,a]=K.useState(e);return[t===void 0?r:t,a]}function WR(e,t){var E;const[r,a]=zR(e,t),{startOfMonth:n,endOfMonth:o}=t,l=r_(e,r,a,t),[u,f]=td(l,e.month?l:void 0);K.useEffect(()=>{const M=r_(e,r,a,t);f(M)},[e.timeZone]);const{months:h,weeks:g,days:v,previousMonth:p,nextMonth:_}=K.useMemo(()=>{const M=BR(u,a,{numberOfMonths:e.numberOfMonths},t),D=PR(M,e.endMonth?o(e.endMonth):void 0,{ISOWeek:e.ISOWeek,fixedWeeks:e.fixedWeeks,broadcastCalendar:e.broadcastCalendar},t),A=UR(M,D,{broadcastCalendar:e.broadcastCalendar,fixedWeeks:e.fixedWeeks,ISOWeek:e.ISOWeek,reverseMonths:e.reverseMonths},t),B=$R(A),j=LR(A),ee=HR(u,r,e,t),re=VR(u,a,e,t);return{months:A,weeks:B,days:j,previousMonth:ee,nextMonth:re}},[t,u.getTime(),a==null?void 0:a.getTime(),r==null?void 0:r.getTime(),e.disableNavigation,e.broadcastCalendar,(E=e.endMonth)==null?void 0:E.getTime(),e.fixedWeeks,e.ISOWeek,e.numberOfMonths,e.pagedNavigation,e.reverseMonths]),{disableNavigation:b,onMonthChange:w}=e,S=M=>g.some(D=>D.days.some(A=>A.isEqualTo(M))),T=M=>{if(b)return;let D=n(M);r&&D<n(r)&&(D=n(r)),a&&D>n(a)&&(D=n(a)),f(D),w==null||w(D)};return{months:h,weeks:g,days:v,navStart:r,navEnd:a,previousMonth:p,nextMonth:_,goToMonth:T,goToDay:M=>{S(M)||T(M.date)}}}var hs;(function(e){e[e.Today=0]="Today",e[e.Selected=1]="Selected",e[e.LastFocused=2]="LastFocused",e[e.FocusedModifier=3]="FocusedModifier"})(hs||(hs={}));function a_(e){return!e[Mr.disabled]&&!e[Mr.hidden]&&!e[Mr.outside]}function GR(e,t,r,a){let n,o=-1;for(const l of e){const u=t(l);a_(u)&&(u[Mr.focused]&&o<hs.FocusedModifier?(n=l,o=hs.FocusedModifier):a!=null&&a.isEqualTo(l)&&o<hs.LastFocused?(n=l,o=hs.LastFocused):r(l.date)&&o<hs.Selected?(n=l,o=hs.Selected):u[Mr.today]&&o<hs.Today&&(n=l,o=hs.Today))}return n||(n=e.find(l=>a_(t(l)))),n}function qR(e,t,r,a,n,o,l){const{ISOWeek:u,broadcastCalendar:f}=o,{addDays:h,addMonths:g,addWeeks:v,addYears:p,endOfBroadcastWeek:_,endOfISOWeek:b,endOfWeek:w,max:S,min:T,startOfBroadcastWeek:N,startOfISOWeek:k,startOfWeek:E}=l;let D={day:h,week:v,month:g,year:p,startOfWeek:A=>f?N(A,l):u?k(A):E(A),endOfWeek:A=>f?_(A):u?b(A):w(A)}[e](r,t==="after"?1:-1);return t==="before"&&a?D=S([a,D]):t==="after"&&n&&(D=T([n,D])),D}function Sb(e,t,r,a,n,o,l,u=0){if(u>365)return;const f=qR(e,t,r.date,a,n,o,l),h=!!(o.disabled&&Vs(f,o.disabled,l)),g=!!(o.hidden&&Vs(f,o.hidden,l)),v=f,p=new lb(f,v,l);return!h&&!g?p:Sb(e,t,p,a,n,o,l,u+1)}function YR(e,t,r,a,n){const{autoFocus:o}=e,[l,u]=K.useState(),f=GR(t.days,r,a||(()=>!1),l),[h,g]=K.useState(o?f:void 0);return{isFocusTarget:w=>!!(f!=null&&f.isEqualTo(w)),setFocused:g,focused:h,blur:()=>{u(h),g(void 0)},moveFocus:(w,S)=>{if(!h)return;const T=Sb(w,S,h,t.navStart,t.navEnd,e,n);T&&(e.disableNavigation&&!t.days.some(k=>k.isEqualTo(T))||(t.goToDay(T),g(T)))}}}function XR(e,t){const{selected:r,required:a,onSelect:n}=e,[o,l]=td(r,n?r:void 0),u=n?r:o,{isSameDay:f}=t,h=_=>(u==null?void 0:u.some(b=>f(b,_)))??!1,{min:g,max:v}=e;return{selected:u,select:(_,b,w)=>{let S=[...u??[]];if(h(_)){if((u==null?void 0:u.length)===g||a&&(u==null?void 0:u.length)===1)return;S=u==null?void 0:u.filter(T=>!f(T,_))}else(u==null?void 0:u.length)===v?S=[_]:S=[...S,_];return n||l(S),n==null||n(S,_,b,w),S},isSelected:h}}function KR(e,t,r=0,a=0,n=!1,o=_s){const{from:l,to:u}=t||{},{isSameDay:f,isAfter:h,isBefore:g}=o;let v;if(!l&&!u)v={from:e,to:r>0?void 0:e};else if(l&&!u)f(l,e)?r===0?v={from:l,to:e}:n?v={from:l,to:void 0}:v=void 0:g(e,l)?v={from:e,to:l}:v={from:l,to:e};else if(l&&u)if(f(l,e)&&f(u,e))n?v={from:l,to:u}:v=void 0;else if(f(l,e))v={from:l,to:r>0?void 0:e};else if(f(u,e))v={from:e,to:r>0?void 0:e};else if(g(e,l))v={from:e,to:u};else if(h(e,l))v={from:l,to:e};else if(h(e,u))v={from:l,to:e};else throw new Error("Invalid range");if(v!=null&&v.from&&(v!=null&&v.to)){const p=o.differenceInCalendarDays(v.to,v.from);a>0&&p>a?v={from:e,to:void 0}:r>1&&p<r&&(v={from:e,to:void 0})}return v}function JR(e,t,r=_s){const a=Array.isArray(t)?t:[t];let n=e.from;const o=r.differenceInCalendarDays(e.to,e.from),l=Math.min(o,6);for(let u=0;u<=l;u++){if(a.includes(n.getDay()))return!0;n=r.addDays(n,1)}return!1}function n_(e,t,r=_s){return zs(e,t.from,!1,r)||zs(e,t.to,!1,r)||zs(t,e.from,!1,r)||zs(t,e.to,!1,r)}function QR(e,t,r=_s){const a=Array.isArray(t)?t:[t];if(a.filter(u=>typeof u!="function").some(u=>typeof u=="boolean"?u:r.isDate(u)?zs(e,u,!1,r):fb(u,r)?u.some(f=>zs(e,f,!1,r)):ed(u)?u.from&&u.to?n_(e,{from:u.from,to:u.to},r):!1:ub(u)?JR(e,u.dayOfWeek,r):X1(u)?r.isAfter(u.before,u.after)?n_(e,{from:r.addDays(u.after,1),to:r.addDays(u.before,-1)},r):Vs(e.from,u,r)||Vs(e.to,u,r):K1(u)||J1(u)?Vs(e.from,u,r)||Vs(e.to,u,r):!1))return!0;const l=a.filter(u=>typeof u=="function");if(l.length){let u=e.from;const f=r.differenceInCalendarDays(e.to,e.from);for(let h=0;h<=f;h++){if(l.some(g=>g(u)))return!0;u=r.addDays(u,1)}}return!1}function ZR(e,t){const{disabled:r,excludeDisabled:a,selected:n,required:o,onSelect:l}=e,[u,f]=td(n,l?n:void 0),h=l?n:u;return{selected:h,select:(p,_,b)=>{const{min:w,max:S}=e,T=p?KR(p,h,w,S,o,t):void 0;return a&&r&&(T!=null&&T.from)&&T.to&&QR({from:T.from,to:T.to},r,t)&&(T.from=p,T.to=void 0),l||f(T),l==null||l(T,p,_,b),T},isSelected:p=>h&&zs(h,p,!1,t)}}function e8(e,t){const{selected:r,required:a,onSelect:n}=e,[o,l]=td(r,n?r:void 0),u=n?r:o,{isSameDay:f}=t;return{selected:u,select:(v,p,_)=>{let b=v;return!a&&u&&u&&f(v,u)&&(b=void 0),n||l(b),n==null||n(b,v,p,_),b},isSelected:v=>u?f(u,v):!1}}function t8(e,t){const r=e8(e,t),a=XR(e,t),n=ZR(e,t);switch(e.mode){case"single":return r;case"multiple":return a;case"range":return n;default:return}}function Rn(e,t){return e instanceof Da&&e.timeZone===t?e:new Da(e,t)}function vl(e,t,r){return Rn(e,t)}function s_(e,t,r){return typeof e=="boolean"||typeof e=="function"?e:e instanceof Date?vl(e,t):Array.isArray(e)?e.map(a=>a instanceof Date?vl(a,t):a):ed(e)?{...e,from:e.from?Rn(e.from,t):e.from,to:e.to?Rn(e.to,t):e.to}:X1(e)?{before:vl(e.before,t),after:vl(e.after,t)}:K1(e)?{after:vl(e.after,t)}:J1(e)?{before:vl(e.before,t)}:e}function Cm(e,t,r){return e&&(Array.isArray(e)?e.map(a=>s_(a,t)):s_(e,t))}function r8(e){var br;let t=e;const r=t.timeZone;if(r&&(t={...e,timeZone:r},t.today&&(t.today=Rn(t.today,r)),t.month&&(t.month=Rn(t.month,r)),t.defaultMonth&&(t.defaultMonth=Rn(t.defaultMonth,r)),t.startMonth&&(t.startMonth=Rn(t.startMonth,r)),t.endMonth&&(t.endMonth=Rn(t.endMonth,r)),t.mode==="single"&&t.selected?t.selected=Rn(t.selected,r):t.mode==="multiple"&&t.selected?t.selected=(br=t.selected)==null?void 0:br.map(ft=>Rn(ft,r)):t.mode==="range"&&t.selected&&(t.selected={from:t.selected.from?Rn(t.selected.from,r):t.selected.from,to:t.selected.to?Rn(t.selected.to,r):t.selected.to}),t.disabled!==void 0&&(t.disabled=Cm(t.disabled,r)),t.hidden!==void 0&&(t.hidden=Cm(t.hidden,r)),t.modifiers)){const ft={};Object.keys(t.modifiers).forEach(jt=>{var lt;ft[jt]=Cm((lt=t.modifiers)==null?void 0:lt[jt],r)}),t.modifiers=ft}const{components:a,formatters:n,labels:o,dateLib:l,locale:u,classNames:f}=K.useMemo(()=>{const ft={...ob,...t.locale},jt=t.broadcastCalendar?1:t.weekStartsOn,lt=t.noonSafe&&t.timeZone?RR(t.timeZone,{weekStartsOn:jt,locale:ft}):void 0,Ot=t.dateLib&&lt?{...lt,...t.dateLib}:t.dateLib??lt,ct=new xn({locale:ft,weekStartsOn:jt,firstWeekContainsDate:t.firstWeekContainsDate,useAdditionalWeekYearTokens:t.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:t.useAdditionalDayOfYearTokens,timeZone:t.timeZone,numerals:t.numerals},Ot);return{dateLib:ct,components:dR(t.components),formatters:bR(t.formatters),labels:AR(t.labels,ct.options),locale:ft,classNames:{...Q1(),...t.classNames}}},[t.locale,t.broadcastCalendar,t.weekStartsOn,t.firstWeekContainsDate,t.useAdditionalWeekYearTokens,t.useAdditionalDayOfYearTokens,t.timeZone,t.numerals,t.dateLib,t.noonSafe,t.components,t.formatters,t.labels,t.classNames]);t.today||(t={...t,today:l.today()});const{captionLayout:h,mode:g,navLayout:v,numberOfMonths:p=1,onDayBlur:_,onDayClick:b,onDayFocus:w,onDayKeyDown:S,onDayMouseEnter:T,onDayMouseLeave:N,onNextClick:k,onPrevClick:E,showWeekNumber:M,styles:D}=t,{formatCaption:A,formatDay:B,formatMonthDropdown:j,formatWeekNumber:ee,formatWeekNumberHeader:re,formatWeekdayName:U,formatYearDropdown:I}=n,ne=WR(t,l),{days:ie,months:q,navStart:ae,navEnd:be,previousMonth:z,nextMonth:fe,goToMonth:De}=ne,P=uR(ie,t,ae,be,l),{isSelected:X,select:Y,selected:Q}=t8(t,l)??{},{blur:de,focused:Fe,isFocusTarget:Te,moveFocus:Oe,setFocused:Re}=YR(t,ne,P,X??(()=>!1),l),{labelDayButton:Je,labelGridcell:H,labelGrid:O,labelMonthDropdown:Ae,labelNav:Pe,labelPrevious:Se,labelNext:Z,labelWeekday:le,labelWeekNumber:Ge,labelWeekNumberHeader:kt,labelYearDropdown:nt}=o,st=K.useMemo(()=>DR(l,t.ISOWeek,t.broadcastCalendar,t.today),[l,t.ISOWeek,t.broadcastCalendar,t.today]),Ze=g!==void 0||b!==void 0,Ee=K.useCallback(()=>{z&&(De(z),E==null||E(z))},[z,De,E]),Xe=K.useCallback(()=>{fe&&(De(fe),k==null||k(fe))},[De,fe,k]),Qe=K.useCallback((ft,jt)=>lt=>{lt.preventDefault(),lt.stopPropagation(),Re(ft),!jt.disabled&&(Y==null||Y(ft.date,jt,lt),b==null||b(ft.date,jt,lt))},[Y,b,Re]),et=K.useCallback((ft,jt)=>lt=>{Re(ft),w==null||w(ft.date,jt,lt)},[w,Re]),rt=K.useCallback((ft,jt)=>lt=>{de(),_==null||_(ft.date,jt,lt)},[de,_]),ke=K.useCallback((ft,jt)=>lt=>{const Ot={ArrowLeft:[lt.shiftKey?"month":"day",t.dir==="rtl"?"after":"before"],ArrowRight:[lt.shiftKey?"month":"day",t.dir==="rtl"?"before":"after"],ArrowDown:[lt.shiftKey?"year":"week","after"],ArrowUp:[lt.shiftKey?"year":"week","before"],PageUp:[lt.shiftKey?"year":"month","before"],PageDown:[lt.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(Ot[lt.key]){lt.preventDefault(),lt.stopPropagation();const[ct,je]=Ot[lt.key];Oe(ct,je)}S==null||S(ft.date,jt,lt)},[Oe,S,t.dir]),ye=K.useCallback((ft,jt)=>lt=>{T==null||T(ft.date,jt,lt)},[T]),xe=K.useCallback((ft,jt)=>lt=>{N==null||N(ft.date,jt,lt)},[N]),ze=K.useCallback(ft=>jt=>{const lt=Number(jt.target.value),Ot=l.setMonth(l.startOfMonth(ft),lt);De(Ot)},[l,De]),xt=K.useCallback(ft=>jt=>{const lt=Number(jt.target.value),Ot=l.setYear(l.startOfMonth(ft),lt);De(Ot)},[l,De]),{className:qt,style:lr}=K.useMemo(()=>({className:[f[ht.Root],t.className].filter(Boolean).join(" "),style:{...D==null?void 0:D[ht.Root],...t.style}}),[f,t.className,t.style,D]),Nr=hR(t),gr=K.useRef(null);IR(gr,!!t.animate,{classNames:f,months:q,focused:Fe,dateLib:l});const xa={dayPickerProps:t,selected:Q,select:Y,isSelected:X,months:q,nextMonth:fe,previousMonth:z,goToMonth:De,getModifiers:P,components:a,classNames:f,styles:D,labels:o,formatters:n};return ge.createElement(cb.Provider,{value:xa},ge.createElement(a.Root,{rootRef:t.animate?gr:void 0,className:qt,style:lr,dir:t.dir,id:t.id,lang:t.lang,nonce:t.nonce,title:t.title,role:t.role,"aria-label":t["aria-label"],"aria-labelledby":t["aria-labelledby"],...Nr},ge.createElement(a.Months,{className:f[ht.Months],style:D==null?void 0:D[ht.Months]},!t.hideNavigation&&!v&&ge.createElement(a.Nav,{"data-animated-nav":t.animate?"true":void 0,className:f[ht.Nav],style:D==null?void 0:D[ht.Nav],"aria-label":Pe(),onPreviousClick:Ee,onNextClick:Xe,previousMonth:z,nextMonth:fe}),q.map((ft,jt)=>ge.createElement(a.Month,{"data-animated-month":t.animate?"true":void 0,className:f[ht.Month],style:D==null?void 0:D[ht.Month],key:jt,displayIndex:jt,calendarMonth:ft},v==="around"&&!t.hideNavigation&&jt===0&&ge.createElement(a.PreviousMonthButton,{type:"button",className:f[ht.PreviousMonthButton],tabIndex:z?void 0:-1,"aria-disabled":z?void 0:!0,"aria-label":Se(z),onClick:Ee,"data-animated-button":t.animate?"true":void 0},ge.createElement(a.Chevron,{disabled:z?void 0:!0,className:f[ht.Chevron],orientation:t.dir==="rtl"?"right":"left"})),ge.createElement(a.MonthCaption,{"data-animated-caption":t.animate?"true":void 0,className:f[ht.MonthCaption],style:D==null?void 0:D[ht.MonthCaption],calendarMonth:ft,displayIndex:jt},h!=null&&h.startsWith("dropdown")?ge.createElement(a.DropdownNav,{className:f[ht.Dropdowns],style:D==null?void 0:D[ht.Dropdowns]},(()=>{const lt=h==="dropdown"||h==="dropdown-months"?ge.createElement(a.MonthsDropdown,{key:"month",className:f[ht.MonthsDropdown],"aria-label":Ae(),classNames:f,components:a,disabled:!!t.disableNavigation,onChange:ze(ft.date),options:CR(ft.date,ae,be,n,l),style:D==null?void 0:D[ht.Dropdown],value:l.getMonth(ft.date)}):ge.createElement("span",{key:"month"},j(ft.date,l)),Ot=h==="dropdown"||h==="dropdown-years"?ge.createElement(a.YearsDropdown,{key:"year",className:f[ht.YearsDropdown],"aria-label":nt(l.options),classNames:f,components:a,disabled:!!t.disableNavigation,onChange:xt(ft.date),options:OR(ae,be,n,l,!!t.reverseYears),style:D==null?void 0:D[ht.Dropdown],value:l.getYear(ft.date)}):ge.createElement("span",{key:"year"},I(ft.date,l));return l.getMonthYearOrder()==="year-first"?[Ot,lt]:[lt,Ot]})(),ge.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},A(ft.date,l.options,l))):ge.createElement(a.CaptionLabel,{className:f[ht.CaptionLabel],role:"status","aria-live":"polite"},A(ft.date,l.options,l))),v==="around"&&!t.hideNavigation&&jt===p-1&&ge.createElement(a.NextMonthButton,{type:"button",className:f[ht.NextMonthButton],tabIndex:fe?void 0:-1,"aria-disabled":fe?void 0:!0,"aria-label":Z(fe),onClick:Xe,"data-animated-button":t.animate?"true":void 0},ge.createElement(a.Chevron,{disabled:fe?void 0:!0,className:f[ht.Chevron],orientation:t.dir==="rtl"?"left":"right"})),jt===p-1&&v==="after"&&!t.hideNavigation&&ge.createElement(a.Nav,{"data-animated-nav":t.animate?"true":void 0,className:f[ht.Nav],style:D==null?void 0:D[ht.Nav],"aria-label":Pe(),onPreviousClick:Ee,onNextClick:Xe,previousMonth:z,nextMonth:fe}),ge.createElement(a.MonthGrid,{role:"grid","aria-multiselectable":g==="multiple"||g==="range","aria-label":O(ft.date,l.options,l)||void 0,className:f[ht.MonthGrid],style:D==null?void 0:D[ht.MonthGrid]},!t.hideWeekdays&&ge.createElement(a.Weekdays,{"data-animated-weekdays":t.animate?"true":void 0,className:f[ht.Weekdays],style:D==null?void 0:D[ht.Weekdays]},M&&ge.createElement(a.WeekNumberHeader,{"aria-label":kt(l.options),className:f[ht.WeekNumberHeader],style:D==null?void 0:D[ht.WeekNumberHeader],scope:"col"},re()),st.map(lt=>ge.createElement(a.Weekday,{"aria-label":le(lt,l.options,l),className:f[ht.Weekday],key:String(lt),style:D==null?void 0:D[ht.Weekday],scope:"col"},U(lt,l.options,l)))),ge.createElement(a.Weeks,{"data-animated-weeks":t.animate?"true":void 0,className:f[ht.Weeks],style:D==null?void 0:D[ht.Weeks]},ft.weeks.map(lt=>ge.createElement(a.Week,{className:f[ht.Week],key:lt.weekNumber,style:D==null?void 0:D[ht.Week],week:lt},M&&ge.createElement(a.WeekNumber,{week:lt,style:D==null?void 0:D[ht.WeekNumber],"aria-label":Ge(lt.weekNumber,{locale:u}),className:f[ht.WeekNumber],scope:"row",role:"rowheader"},ee(lt.weekNumber,l)),lt.days.map(Ot=>{const{date:ct}=Ot,je=P(Ot);if(je[Mr.focused]=!je.hidden&&!!(Fe!=null&&Fe.isEqualTo(Ot)),je[Zn.selected]=(X==null?void 0:X(ct))||je.selected,ed(Q)){const{from:Sr,to:xr}=Q;je[Zn.range_start]=!!(Sr&&xr&&l.isSameDay(ct,Sr)),je[Zn.range_end]=!!(Sr&&xr&&l.isSameDay(ct,xr)),je[Zn.range_middle]=zs(Q,ct,!0,l)}const He=NR(je,D,t.modifiersStyles),pr=fR(je,f,t.modifiersClassNames),Bn=!Ze&&!je.hidden?H(ct,je,l.options,l):void 0;return ge.createElement(a.Day,{key:`${Ot.isoDate}_${Ot.displayMonthId}`,day:Ot,modifiers:je,className:pr.join(" "),style:He,role:"gridcell","aria-selected":je.selected||void 0,"aria-label":Bn,"data-day":Ot.isoDate,"data-month":Ot.outside?Ot.dateMonthId:void 0,"data-selected":je.selected||void 0,"data-disabled":je.disabled||void 0,"data-hidden":je.hidden||void 0,"data-outside":Ot.outside||void 0,"data-focused":je.focused||void 0,"data-today":je.today||void 0},!je.hidden&&Ze?ge.createElement(a.DayButton,{className:f[ht.DayButton],style:D==null?void 0:D[ht.DayButton],type:"button",day:Ot,modifiers:je,disabled:!je.focused&&je.disabled||void 0,"aria-disabled":je.focused&&je.disabled||void 0,tabIndex:Te(Ot)?0:-1,"aria-label":Je(ct,je,l.options,l),onClick:Qe(Ot,je),onBlur:rt(Ot,je),onFocus:et(Ot,je),onKeyDown:ke(Ot,je),onMouseEnter:ye(Ot,je),onMouseLeave:xe(Ot,je)},B(ct,l.options,l)):!je.hidden&&B(Ot.date,l.options,l))})))))))),t.footer&&ge.createElement(a.Footer,{className:f[ht.Footer],style:D==null?void 0:D[ht.Footer],role:"status","aria-live":"polite"},t.footer)))}function a8({className:e,classNames:t,showOutsideDays:r=!0,captionLayout:a="label",buttonVariant:n="ghost",formatters:o,components:l,...u}){const f=Q1();return m.jsx(r8,{showOutsideDays:r,className:Ye("bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,e),captionLayout:a,formatters:{formatMonthDropdown:h=>h.toLocaleString("default",{month:"short"}),...o},classNames:{root:Ye("w-fit",f.root),months:Ye("relative flex flex-col gap-4 md:flex-row",f.months),month:Ye("flex w-full flex-col gap-4",f.month),nav:Ye("absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1",f.nav),button_previous:Ye(a1({variant:n}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",f.button_previous),button_next:Ye(a1({variant:n}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",f.button_next),month_caption:Ye("flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]",f.month_caption),dropdowns:Ye("flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium",f.dropdowns),dropdown_root:Ye("has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border",f.dropdown_root),dropdown:Ye("bg-popover absolute inset-0 opacity-0",f.dropdown),caption_label:Ye("select-none font-medium",a==="label"?"text-sm":"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5",f.caption_label),table:"w-full border-collapse",weekdays:Ye("flex",f.weekdays),weekday:Ye("text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal",f.weekday),week:Ye("mt-2 flex w-full",f.week),week_number_header:Ye("w-[--cell-size] select-none",f.week_number_header),week_number:Ye("text-muted-foreground select-none text-[0.8rem]",f.week_number),day:Ye("group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md",f.day),range_start:Ye("bg-accent rounded-l-md",f.range_start),range_middle:Ye("rounded-none",f.range_middle),range_end:Ye("bg-accent rounded-r-md",f.range_end),today:Ye("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",f.today),outside:Ye("text-muted-foreground aria-selected:text-muted-foreground",f.outside),disabled:Ye("text-muted-foreground opacity-50",f.disabled),hidden:Ye("invisible",f.hidden),...t},components:{Root:({className:h,rootRef:g,...v})=>m.jsx("div",{"data-slot":"calendar",ref:g,className:Ye(h),...v}),Chevron:({className:h,orientation:g,...v})=>g==="left"?m.jsx(p2,{className:Ye("size-4",h),...v}):g==="right"?m.jsx(y2,{className:Ye("size-4",h),...v}):m.jsx(J0,{className:Ye("size-4",h),...v}),DayButton:n8,WeekNumber:({children:h,...g})=>m.jsx("td",{...g,children:m.jsx("div",{className:"flex size-[--cell-size] items-center justify-center text-center",children:h})}),...l},...u})}function n8({className:e,day:t,modifiers:r,...a}){const n=Q1(),o=K.useRef(null);return K.useEffect(()=>{var l;r.focused&&((l=o.current)==null||l.focus())},[r.focused]),m.jsx(Dt,{ref:o,variant:"ghost",size:"icon","data-day":t.date.toLocaleDateString(),"data-selected-single":r.selected&&!r.range_start&&!r.range_end&&!r.range_middle,"data-range-start":r.range_start,"data-range-end":r.range_end,"data-range-middle":r.range_middle,className:Ye("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70",n.day,e),...a})}const s8=K0("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ln({className:e,variant:t,...r}){return m.jsx("div",{className:Ye(s8({variant:t}),e),...r})}const i8=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class tg extends Error{constructor(t,r="FunctionsError",a){super(t),this.name=r,this.context=a}}class o8 extends tg{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class i_ extends tg{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class o_ extends tg{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var c1;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(c1||(c1={}));class l8{constructor(t,{headers:r={},customFetch:a,region:n=c1.Any}={}){this.url=t,this.headers=r,this.region=n,this.fetch=i8(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return x4(this,arguments,void 0,function*(r,a={}){var n;let o,l;try{const{headers:u,method:f,body:h,signal:g,timeout:v}=a;let p={},{region:_}=a;_||(_=this.region);const b=new URL(`${this.url}/${r}`);_&&_!=="any"&&(p["x-region"]=_,b.searchParams.set("forceFunctionRegion",_));let w;h&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&h instanceof Blob||h instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",w=h):typeof h=="string"?(p["Content-Type"]="text/plain",w=h):typeof FormData<"u"&&h instanceof FormData?w=h:(p["Content-Type"]="application/json",w=JSON.stringify(h)):w=h;let S=g;v&&(l=new AbortController,o=setTimeout(()=>l.abort(),v),g?(S=l.signal,g.addEventListener("abort",()=>l.abort())):S=l.signal);const T=yield this.fetch(b.toString(),{method:f||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),u),body:w,signal:S}).catch(M=>{throw new o8(M)}),N=T.headers.get("x-relay-error");if(N&&N==="true")throw new i_(T);if(!T.ok)throw new o_(T);let k=((n=T.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),E;return k==="application/json"?E=yield T.json():k==="application/octet-stream"||k==="application/pdf"?E=yield T.blob():k==="text/event-stream"?E=T:k==="multipart/form-data"?E=yield T.formData():E=yield T.text(),{data:E,error:null,response:T}}catch(u){return{data:null,error:u,response:u instanceof o_||u instanceof i_?u.context:void 0}}finally{o&&clearTimeout(o)}})}}var c8=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},u8=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let n=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{let l=null,u=null,f=null,h=o.status,g=o.statusText;if(o.ok){var v,p;if(r.method!=="HEAD"){var _;const T=await o.text();T===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((_=r.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?u=T:u=JSON.parse(T))}const w=(v=r.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),S=(p=o.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");w&&S&&S.length>1&&(f=parseInt(S[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(u)&&(u.length>1?(l={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,f=null,h=406,g="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{var b;const w=await o.text();try{l=JSON.parse(w),Array.isArray(l)&&o.status===404&&(u=[],l=null,h=200,g="OK")}catch{o.status===404&&w===""?(h=204,g="No Content"):l={message:w}}if(l&&r.isMaybeSingle&&(!(l==null||(b=l.details)===null||b===void 0)&&b.includes("0 rows"))&&(l=null,h=200,g="OK"),l&&r.shouldThrowOnError)throw new c8(l)}return{error:l,data:u,count:f,status:h,statusText:g}});return this.shouldThrowOnError||(n=n.catch(o=>{var l;let u="";const f=o==null?void 0:o.cause;if(f){var h,g,v,p;const b=(h=f==null?void 0:f.message)!==null&&h!==void 0?h:"",w=(g=f==null?void 0:f.code)!==null&&g!==void 0?g:"";u=`${(v=o==null?void 0:o.name)!==null&&v!==void 0?v:"FetchError"}: ${o==null?void 0:o.message}`,u+=`

Caused by: ${(p=f==null?void 0:f.name)!==null&&p!==void 0?p:"Error"}: ${b}`,w&&(u+=` (${w})`),f!=null&&f.stack&&(u+=`
${f.stack}`)}else{var _;u=(_=o==null?void 0:o.stack)!==null&&_!==void 0?_:""}return{error:{message:`${(l=o==null?void 0:o.name)!==null&&l!==void 0?l:"FetchError"}: ${o==null?void 0:o.message}`,details:u,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),n.then(e,t)}returns(){return this}overrideTypes(){return this}},f8=class extends u8{select(e){let t=!1;const r=(e??"*").split("").map(a=>/\s/.test(a)&&!t?"":(a==='"'&&(t=!t),a)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:a,referencedTable:n=a}={}){const o=n?`${n}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:a=r}={}){const n=typeof a>"u"?"offset":`${a}.offset`,o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:a=!1,wal:n=!1,format:o="text"}={}){var l;const u=[e?"analyze":null,t?"verbose":null,r?"settings":null,a?"buffers":null,n?"wal":null].filter(Boolean).join("|"),f=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${f}"; options=${u};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const l_=new RegExp("[,()]");var Rl=class extends f8{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&l_.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&l_.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:a}={}){let n="";a==="plain"?n="pl":a==="phrase"?n="ph":a==="websearch"&&(n="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${n}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},d8=class{constructor(e,{headers:t={},schema:r,fetch:a}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=a}select(e,t){const{head:r=!1,count:a}=t??{},n=r?"HEAD":"GET";let o=!1;const l=(e??"*").split("").map(u=>/\s/.test(u)&&!o?"":(u==='"'&&(o=!o),u)).join("");return this.url.searchParams.set("select",l),a&&this.headers.append("Prefer",`count=${a}`),new Rl({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var a;const n="POST";if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(o.length>0){const l=[...new Set(o)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new Rl({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:a,defaultToNull:n=!0}={}){var o;const l="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),a&&this.headers.append("Prefer",`count=${a}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((f,h)=>f.concat(Object.keys(h)),[]);if(u.length>0){const f=[...new Set(u)].map(h=>`"${h}"`);this.url.searchParams.set("columns",f.join(","))}}return new Rl({method:l,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(e,{count:t}={}){var r;const a="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new Rl({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Rl({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},h8=class Eb{constructor(t,{headers:r={},schema:a,fetch:n}={}){this.url=t,this.headers=new Headers(r),this.schemaName=a,this.fetch=n}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new d8(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Eb(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:a=!1,get:n=!1,count:o}={}){var l;let u;const f=new URL(`${this.url}/rpc/${t}`);let h;a||n?(u=a?"HEAD":"GET",Object.entries(r).filter(([v,p])=>p!==void 0).map(([v,p])=>[v,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([v,p])=>{f.searchParams.append(v,p)})):(u="POST",h=r);const g=new Headers(this.headers);return o&&g.set("Prefer",`count=${o}`),new Rl({method:u,url:f,headers:g,schema:this.schemaName,body:h,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}};class m8{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const a=r.node,n=parseInt(a.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const a=this.getWebSocketConstructor();return new a(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const g8="2.89.0",x8=`realtime-js/${g8}`,Tb="1.0.0",v8="2.0.0",c_=Tb,u1=1e4,p8=1e3,y8=100;var Ai;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Ai||(Ai={}));var ia;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(ia||(ia={}));var Kn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Kn||(Kn={}));var f1;(function(e){e.websocket="websocket"})(f1||(f1={}));var mo;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(mo||(mo={}));class _8{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let a=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,a;const n=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(t){var r,a;const n=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},l=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(t,r,a){var n,o;const l=t.topic,u=(n=t.ref)!==null&&n!==void 0?n:"",f=(o=t.join_ref)!==null&&o!==void 0?o:"",h=t.payload.event,g=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},v=Object.keys(g).length===0?"":JSON.stringify(g);if(f.length>255)throw new Error(`joinRef length ${f.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`userEvent length ${h.length} exceeds maximum of 255`);if(v.length>255)throw new Error(`metadata length ${v.length} exceeds maximum of 255`);const p=this.USER_BROADCAST_PUSH_META_LENGTH+f.length+u.length+l.length+h.length+v.length,_=new ArrayBuffer(this.HEADER_LENGTH+p);let b=new DataView(_),w=0;b.setUint8(w++,this.KINDS.userBroadcastPush),b.setUint8(w++,f.length),b.setUint8(w++,u.length),b.setUint8(w++,l.length),b.setUint8(w++,h.length),b.setUint8(w++,v.length),b.setUint8(w++,r),Array.from(f,T=>b.setUint8(w++,T.charCodeAt(0))),Array.from(u,T=>b.setUint8(w++,T.charCodeAt(0))),Array.from(l,T=>b.setUint8(w++,T.charCodeAt(0))),Array.from(h,T=>b.setUint8(w++,T.charCodeAt(0))),Array.from(v,T=>b.setUint8(w++,T.charCodeAt(0)));var S=new Uint8Array(_.byteLength+a.byteLength);return S.set(new Uint8Array(_),0),S.set(new Uint8Array(a),_.byteLength),S.buffer}decode(t,r){if(this._isArrayBuffer(t)){let a=this._binaryDecode(t);return r(a)}if(typeof t=="string"){const a=JSON.parse(t),[n,o,l,u,f]=a;return r({join_ref:n,ref:o,topic:l,event:u,payload:f})}return r({})}_binaryDecode(t){const r=new DataView(t),a=r.getUint8(0),n=new TextDecoder;switch(a){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,n)}}_decodeUserBroadcast(t,r,a){const n=r.getUint8(1),o=r.getUint8(2),l=r.getUint8(3),u=r.getUint8(4);let f=this.HEADER_LENGTH+4;const h=a.decode(t.slice(f,f+n));f=f+n;const g=a.decode(t.slice(f,f+o));f=f+o;const v=a.decode(t.slice(f,f+l));f=f+l;const p=t.slice(f,t.byteLength),_=u===this.JSON_ENCODING?JSON.parse(a.decode(p)):p,b={type:this.BROADCAST_EVENT,event:g,payload:_};return l>0&&(b.meta=JSON.parse(v)),{join_ref:null,ref:null,topic:h,event:this.BROADCAST_EVENT,payload:b}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([a])=>r.includes(a)))}}class kb{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var wr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(wr||(wr={}));const u_=(e,t,r={})=>{var a;const n=(a=r.skipTypes)!==null&&a!==void 0?a:[];return t?Object.keys(t).reduce((o,l)=>(o[l]=w8(l,e,t,n),o),{}):{}},w8=(e,t,r,a)=>{const n=t.find(u=>u.name===e),o=n==null?void 0:n.type,l=r[e];return o&&!a.includes(o)?Ab(o,l):d1(l)},Ab=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return T8(t,r)}switch(e){case wr.bool:return b8(t);case wr.float4:case wr.float8:case wr.int2:case wr.int4:case wr.int8:case wr.numeric:case wr.oid:return S8(t);case wr.json:case wr.jsonb:return E8(t);case wr.timestamp:return k8(t);case wr.abstime:case wr.date:case wr.daterange:case wr.int4range:case wr.int8range:case wr.money:case wr.reltime:case wr.text:case wr.time:case wr.timestamptz:case wr.timetz:case wr.tsrange:case wr.tstzrange:return d1(t);default:return d1(t)}},d1=e=>e,b8=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},S8=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},E8=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},T8=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,a=e[r];if(e[0]==="{"&&a==="}"){let o;const l=e.slice(1,r);try{o=JSON.parse("["+l+"]")}catch{o=l?l.split(","):[]}return o.map(u=>Ab(t,u))}return e},k8=e=>typeof e=="string"?e.replace(" ","T"):e,Cb=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Nm{constructor(t,r,a={},n=u1){this.channel=t,this.event=r,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var a;return this._hasReceived(t)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var f_;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(f_||(f_={}));class su{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},n=>{const{onJoin:o,onLeave:l,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=su.syncState(this.state,n,o,l),this.pendingDiffs.forEach(f=>{this.state=su.syncDiff(this.state,f,o,l)}),this.pendingDiffs=[],u()}),this.channel._on(a.diff,{},n=>{const{onJoin:o,onLeave:l,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=su.syncDiff(this.state,n,o,l),u())}),this.onJoin((n,o,l)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:o,newPresences:l})}),this.onLeave((n,o,l)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:o,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,a,n){const o=this.cloneDeep(t),l=this.transformState(r),u={},f={};return this.map(o,(h,g)=>{l[h]||(f[h]=g)}),this.map(l,(h,g)=>{const v=o[h];if(v){const p=g.map(S=>S.presence_ref),_=v.map(S=>S.presence_ref),b=g.filter(S=>_.indexOf(S.presence_ref)<0),w=v.filter(S=>p.indexOf(S.presence_ref)<0);b.length>0&&(u[h]=b),w.length>0&&(f[h]=w)}else u[h]=g}),this.syncDiff(o,{joins:u,leaves:f},a,n)}static syncDiff(t,r,a,n){const{joins:o,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(o,(u,f)=>{var h;const g=(h=t[u])!==null&&h!==void 0?h:[];if(t[u]=this.cloneDeep(f),g.length>0){const v=t[u].map(_=>_.presence_ref),p=g.filter(_=>v.indexOf(_.presence_ref)<0);t[u].unshift(...p)}a(u,g,f)}),this.map(l,(u,f)=>{let h=t[u];if(!h)return;const g=f.map(v=>v.presence_ref);h=h.filter(v=>g.indexOf(v.presence_ref)<0),t[u]=h,n(u,h,f),h.length===0&&delete t[u]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(a=>r(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,a)=>{const n=t[a];return"metas"in n?r[a]=n.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):r[a]=n,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var d_;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(d_||(d_={}));var iu;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(iu||(iu={}));var Us;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Us||(Us={}));class Il{constructor(t,r={config:{}},a){var n,o;if(this.topic=t,this.params=r,this.socket=a,this.bindings={},this.state=ia.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Nm(this,Kn.join,this.params,this.timeout),this.rejoinTimer=new kb(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ia.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ia.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=ia.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ia.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=ia.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Kn.reply,{},(l,u)=>{this._trigger(this._replyEventName(u),l)}),this.presence=new su(this),this.broadcastEndpointURL=Cb(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var a,n,o;if(this.socket.isConnected()||this.socket.connect(),this.state==ia.closed){const{config:{broadcast:l,presence:u,private:f}}=this.params,h=(n=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(_=>_.filter))!==null&&n!==void 0?n:[],g=!!this.bindings[iu.PRESENCE]&&this.bindings[iu.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,v={},p={broadcast:l,presence:Object.assign(Object.assign({},u),{enabled:g}),postgres_changes:h,private:f};this.socket.accessTokenValue&&(v.access_token=this.socket.accessTokenValue),this._onError(_=>t==null?void 0:t(Us.CHANNEL_ERROR,_)),this._onClose(()=>t==null?void 0:t(Us.CLOSED)),this.updateJoinPayload(Object.assign({config:p},v)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:_})=>{var b;if(this.socket._isManualToken()||this.socket.setAuth(),_===void 0){t==null||t(Us.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,S=(b=w==null?void 0:w.length)!==null&&b!==void 0?b:0,T=[];for(let N=0;N<S;N++){const k=w[N],{filter:{event:E,schema:M,table:D,filter:A}}=k,B=_&&_[N];if(B&&B.event===E&&Il.isFilterValueEqual(B.schema,M)&&Il.isFilterValueEqual(B.table,D)&&Il.isFilterValueEqual(B.filter,A))T.push(Object.assign(Object.assign({},k),{id:B.id}));else{this.unsubscribe(),this.state=ia.errored,t==null||t(Us.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=T,t&&t(Us.SUBSCRIBED);return}}).receive("error",_=>{this.state=ia.errored,t==null||t(Us.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Us.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,a){return this.state===ia.joined&&t===iu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,a)}async httpSend(t,r,a={}){var n;if(r==null)return Promise.reject("Payload is required for httpSend()");const o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=a.timeout)!==null&&n!==void 0?n:this.timeout);if(u.status===202)return{success:!0};let f=u.statusText;try{const h=await u.json();f=h.error||h.message||f}catch{}return Promise.reject(new Error(f))}async send(t,r={}){var a,n;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:l}=t,u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const f={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:l,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((n=h.body)===null||n===void 0?void 0:n.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var l,u,f;const h=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((f=(u=(l=this.params)===null||l===void 0?void 0:l.config)===null||u===void 0?void 0:u.broadcast)===null||f===void 0)&&f.ack)&&o("ok"),h.receive("ok",()=>o("ok")),h.receive("error",()=>o("error")),h.receive("timeout",()=>o("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ia.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Kn.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(n=>{a=new Nm(this,Kn.leave,{},t),a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ia.closed,this.bindings={}}async _fetchWithTimeout(t,r,a){const n=new AbortController,o=setTimeout(()=>n.abort(),a),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(o),l}_push(t,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Nm(this,t,r,a);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>y8){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,a){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,a){var n,o;const l=t.toLocaleLowerCase(),{close:u,error:f,leave:h,join:g}=Kn;if(a&&[u,f,h,g].indexOf(l)>=0&&a!==this._joinRef())return;let p=this._onMessage(l,r,a);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(_=>{var b,w,S;return((b=_.filter)===null||b===void 0?void 0:b.event)==="*"||((S=(w=_.filter)===null||w===void 0?void 0:w.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===l}).map(_=>_.callback(p,a)):(o=this.bindings[l])===null||o===void 0||o.filter(_=>{var b,w,S,T,N,k;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in _){const E=_.id,M=(b=_.filter)===null||b===void 0?void 0:b.event;return E&&((w=r.ids)===null||w===void 0?void 0:w.includes(E))&&(M==="*"||(M==null?void 0:M.toLocaleLowerCase())===((S=r.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const E=(N=(T=_==null?void 0:_.filter)===null||T===void 0?void 0:T.event)===null||N===void 0?void 0:N.toLocaleLowerCase();return E==="*"||E===((k=r==null?void 0:r.event)===null||k===void 0?void 0:k.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===l}).map(_=>{if(typeof p=="object"&&"ids"in p){const b=p.data,{schema:w,table:S,commit_timestamp:T,type:N,errors:k}=b;p=Object.assign(Object.assign({},{schema:w,table:S,commit_timestamp:T,eventType:N,new:{},old:{},errors:k}),this._getPayloadRecords(b))}_.callback(p,a)})}_isClosed(){return this.state===ia.closed}_isJoined(){return this.state===ia.joined}_isJoining(){return this.state===ia.joining}_isLeaving(){return this.state===ia.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,a){const n=t.toLocaleLowerCase(),o={type:n,filter:r,callback:a};return this.bindings[n]?this.bindings[n].push(o):this.bindings[n]=[o],this}_off(t,r){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(n=>{var o;return!(((o=n.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===a&&Il.isEqual(n.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const a in t)if(t[a]!==r[a])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Kn.close,{},t)}_onError(t){this._on(Kn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ia.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=u_(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=u_(t.columns,t.old_record)),r}}const Dm=()=>{},f0={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},A8=[1e3,2e3,5e3,1e4],C8=1e4,N8=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class D8{constructor(t,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=u1,this.transport=null,this.heartbeatIntervalMs=f0.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Dm,this.ref=0,this.reconnectTimer=null,this.vsn=c_,this.logger=Dm,this.conn=null,this.sendBuffer=[],this.serializer=new _8,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...o)=>n(...o):(...o)=>fetch(...o),!(!((a=r==null?void 0:r.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${f1.websocket}`,this.httpEndpoint=Cb(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=m8.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,a){this.logger(t,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case Ai.connecting:return mo.Connecting;case Ai.open:return mo.Open;case Ai.closing:return mo.Closing;default:return mo.Closed}}isConnected(){return this.connectionState()===mo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const a=`realtime:${t}`,n=this.getChannels().find(o=>o.topic===a);if(n)return n;{const o=new Il(`realtime:${t}`,r,this);return this.channels.push(o),o}}push(t){const{topic:r,event:a,payload:n,ref:o}=t,l=()=>{this.encode(t,u=>{var f;(f=this.conn)===null||f===void 0||f.send(u)})};this.log("push",`${r} ${a} (${o})`,n),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(p8,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},f0.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(h){this.log("error","error in heartbeat callback",h)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:n,payload:o,ref:l}=r,u=l?`(${l})`:"",f=o.status||"";this.log("receive",`${f} ${a} ${n} ${u}`.trim(),o),this.channels.filter(h=>h._isMember(a)).forEach(h=>h._trigger(n,o,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===Ai.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Ai.open||this.conn.readyState===Ai.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Kn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const a=t.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${t}${a}${n}`}_workerObjectUrl(t){let r;if(t)r=t;else{const a=new Blob([N8],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,a=!1;if(t)r=t,a=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),r=this.accessTokenValue}else r=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const o={access_token:r,version:x8};r&&n.updateJoinPayload(o),n.joinedOnce&&n._isJoined()&&n._push(Kn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(r)}catch(n){this.log("error",`error in ${t} callback`,n)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new kb(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},f0.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,a,n,o,l,u,f,h,g,v,p,_;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(a=t==null?void 0:t.timeout)!==null&&a!==void 0?a:u1,this.heartbeatIntervalMs=(n=t==null?void 0:t.heartbeatIntervalMs)!==null&&n!==void 0?n:f0.HEARTBEAT_INTERVAL,this.worker=(o=t==null?void 0:t.worker)!==null&&o!==void 0?o:!1,this.accessToken=(l=t==null?void 0:t.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(u=t==null?void 0:t.heartbeatCallback)!==null&&u!==void 0?u:Dm,this.vsn=(f=t==null?void 0:t.vsn)!==null&&f!==void 0?f:c_,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=t==null?void 0:t.reconnectAfterMs)!==null&&h!==void 0?h:b=>A8[b-1]||C8,this.vsn){case Tb:this.encode=(g=t==null?void 0:t.encode)!==null&&g!==void 0?g:(b,w)=>w(JSON.stringify(b)),this.decode=(v=t==null?void 0:t.decode)!==null&&v!==void 0?v:(b,w)=>w(JSON.parse(b));break;case v8:this.encode=(p=t==null?void 0:t.encode)!==null&&p!==void 0?p:this.serializer.encode.bind(this.serializer),this.decode=(_=t==null?void 0:t.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var pu=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function O8(e,t,r){const a=new URL(t,e);if(r)for(const[n,o]of Object.entries(r))o!==void 0&&a.searchParams.set(n,o);return a.toString()}async function R8(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function F8(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:n,body:o,headers:l}){const u=O8(e.baseUrl,a,n),f=await R8(e.auth),h=await t(u,{method:r,headers:{...o?{"Content-Type":"application/json"}:{},...f,...l},body:o?JSON.stringify(o):void 0}),g=await h.text(),v=(h.headers.get("content-type")||"").includes("application/json"),p=v&&g?JSON.parse(g):g;if(!h.ok){const _=v?p:void 0,b=_==null?void 0:_.error;throw new pu((b==null?void 0:b.message)??`Request failed with status ${h.status}`,{status:h.status,icebergType:b==null?void 0:b.type,icebergCode:b==null?void 0:b.code,details:_})}return{status:h.status,headers:h.headers,data:p}}}}function d0(e){return e.join("")}var M8=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:d0(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${d0(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${d0(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${d0(e.namespace)}`}),!0}catch(t){if(t instanceof pu&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof pu&&r.status===409)return;throw r}}};function pl(e){return e.join("")}var j8=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${pl(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${pl(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${pl(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${pl(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${pl(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${pl(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof pu&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof pu&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},I8=class{constructor(e){var a;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=F8({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(a=e.accessDelegation)==null?void 0:a.join(","),this.namespaceOps=new M8(this.client,t),this.tableOps=new j8(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},rd=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function Fr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var P8=class extends rd{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},h1=class extends rd{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const rg=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),L8=()=>Response,m1=e=>{if(Array.isArray(e))return e.map(r=>m1(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,a])=>{const n=r.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));t[n]=m1(a)}),t},B8=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},U8=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function yu(e){"@babel/helpers - typeof";return yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yu(e)}function z8(e,t){if(yu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(yu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function V8(e){var t=z8(e,"string");return yu(t)=="symbol"?t:t+""}function H8(e,t,r){return(t=V8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function _t(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h_(Object(r),!0).forEach(function(a){H8(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h_(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}const Om=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},$8=async(e,t,r)=>{e instanceof await L8()&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const n=e.status||500,o=(a==null?void 0:a.statusCode)||n+"";t(new P8(Om(a),n,o))}).catch(a=>{t(new h1(Om(a),a))}):t(new h1(Om(e),e))},W8=(e,t,r,a)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!a?n:(B8(a)?(n.headers=_t({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(a)):n.body=a,t!=null&&t.duplex&&(n.duplex=t.duplex),_t(_t({},n),r))};async function $u(e,t,r,a,n,o){return new Promise((l,u)=>{e(r,W8(t,a,n,o)).then(f=>{if(!f.ok)throw f;return a!=null&&a.noResolveJson?f:f.json()}).then(f=>l(f)).catch(f=>$8(f,u,a))})}async function _u(e,t,r,a){return $u(e,"GET",t,r,a)}async function Xn(e,t,r,a,n){return $u(e,"POST",t,a,n,r)}async function g1(e,t,r,a,n){return $u(e,"PUT",t,a,n,r)}async function G8(e,t,r,a){return $u(e,"HEAD",t,_t(_t({},r),{},{noResolveJson:!0}),a)}async function ag(e,t,r,a,n){return $u(e,"DELETE",t,a,n,r)}var q8=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Fr(t))return{data:null,error:t};throw t}}};let Nb;Nb=Symbol.toStringTag;var Y8=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Nb]="BlobDownloadBuilder",this.promise=null}asStream(){return new q8(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Fr(t))return{data:null,error:t};throw t}}};const X8={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},m_={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var K8=class{constructor(e,t={},r,a){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=rg(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,a){var n=this;try{let o;const l=_t(_t({},m_),a);let u=_t(_t({},n.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const f=l.metadata;typeof Blob<"u"&&r instanceof Blob?(o=new FormData,o.append("cacheControl",l.cacheControl),f&&o.append("metadata",n.encodeMetadata(f)),o.append("",r)):typeof FormData<"u"&&r instanceof FormData?(o=r,o.has("cacheControl")||o.append("cacheControl",l.cacheControl),f&&!o.has("metadata")&&o.append("metadata",n.encodeMetadata(f))):(o=r,u["cache-control"]=`max-age=${l.cacheControl}`,u["content-type"]=l.contentType,f&&(u["x-metadata"]=n.toBase64(n.encodeMetadata(f))),(typeof ReadableStream<"u"&&o instanceof ReadableStream||o&&typeof o=="object"&&"pipe"in o&&typeof o.pipe=="function")&&!l.duplex&&(l.duplex="half")),a!=null&&a.headers&&(u=_t(_t({},u),a.headers));const h=n._removeEmptyFolders(t),g=n._getFinalPath(h),v=await(e=="PUT"?g1:Xn)(n.fetch,`${n.url}/object/${g}`,o,_t({headers:u},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{data:{path:h,id:v.Id,fullPath:v.Key},error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(Fr(o))return{data:null,error:o};throw o}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,a){var n=this;const o=n._removeEmptyFolders(e),l=n._getFinalPath(o),u=new URL(n.url+`/object/upload/sign/${l}`);u.searchParams.set("token",t);try{let f;const h=_t({upsert:m_.upsert},a),g=_t(_t({},n.headers),{"x-upsert":String(h.upsert)});return typeof Blob<"u"&&r instanceof Blob?(f=new FormData,f.append("cacheControl",h.cacheControl),f.append("",r)):typeof FormData<"u"&&r instanceof FormData?(f=r,f.append("cacheControl",h.cacheControl)):(f=r,g["cache-control"]=`max-age=${h.cacheControl}`,g["content-type"]=h.contentType),{data:{path:o,fullPath:(await g1(n.fetch,u.toString(),f,{headers:g})).Key},error:null}}catch(f){if(n.shouldThrowOnError)throw f;if(Fr(f))return{data:null,error:f};throw f}}async createSignedUploadUrl(e,t){var r=this;try{let a=r._getFinalPath(e);const n=_t({},r.headers);t!=null&&t.upsert&&(n["x-upsert"]="true");const o=await Xn(r.fetch,`${r.url}/object/upload/sign/${a}`,{},{headers:n}),l=new URL(r.url+o.url),u=l.searchParams.get("token");if(!u)throw new rd("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:u},error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Fr(a))return{data:null,error:a};throw a}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var a=this;try{return{data:await Xn(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:a.headers}),error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(Fr(n))return{data:null,error:n};throw n}}async copy(e,t,r){var a=this;try{return{data:{path:(await Xn(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:a.headers})).Key},error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(Fr(n))return{data:null,error:n};throw n}}async createSignedUrl(e,t,r){var a=this;try{let n=a._getFinalPath(e),o=await Xn(a.fetch,`${a.url}/object/sign/${n}`,_t({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:a.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return o={signedUrl:encodeURI(`${a.url}${o.signedURL}${l}`)},{data:o,error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(Fr(n))return{data:null,error:n};throw n}}async createSignedUrls(e,t,r){var a=this;try{const n=await Xn(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:t,paths:e},{headers:a.headers}),o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(l=>_t(_t({},l),{},{signedUrl:l.signedURL?encodeURI(`${a.url}${l.signedURL}${o}`):null})),error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(Fr(n))return{data:null,error:n};throw n}}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),n=a?`?${a}`:"",o=this._getFinalPath(e),l=()=>_u(this.fetch,`${this.url}/${r}/${o}${n}`,{headers:this.headers,noResolveJson:!0});return new Y8(l,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:m1(await _u(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Fr(a))return{data:null,error:a};throw a}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await G8(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Fr(a)&&a instanceof h1){const n=a.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:a}}throw a}}getPublicUrl(e,t){const r=this._getFinalPath(e),a=[],n=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";n!==""&&a.push(n);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&a.push(l);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${u}`)}}}async remove(e){var t=this;try{return{data:await ag(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}async list(e,t,r){var a=this;try{const n=_t(_t(_t({},X8),t),{},{prefix:e||""});return{data:await Xn(a.fetch,`${a.url}/object/list/${a.bucketId}`,n,{headers:a.headers},r),error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(Fr(n))return{data:null,error:n};throw n}}async listV2(e,t){var r=this;try{const a=_t({},e);return{data:await Xn(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,a,{headers:r.headers},t),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Fr(a))return{data:null,error:a};throw a}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const Db="2.89.0",Ob={"X-Client-Info":`storage-js/${Db}`};var J8=class{constructor(e,t={},r,a){this.shouldThrowOnError=!1;const n=new URL(e);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase.")),this.url=n.href.replace(/\/$/,""),this.headers=_t(_t({},Ob),t),this.fetch=rg(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await _u(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await _u(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await Xn(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Fr(a))return{data:null,error:a};throw a}}async updateBucket(e,t){var r=this;try{return{data:await g1(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Fr(a))return{data:null,error:a};throw a}}async emptyBucket(e){var t=this;try{return{data:await Xn(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await ag(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},Q8=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=_t(_t({},Ob),t),this.fetch=rg(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Xn(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const a=r.toString(),n=a?`${t.url}/bucket?${a}`:`${t.url}/bucket`;return{data:await _u(t.fetch,n,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await ag(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!U8(e))throw new rd("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new I8({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(r,{get(n,o){const l=n[o];return typeof l!="function"?l:async(...u)=>{try{return{data:await l.apply(n,u),error:null}}catch(f){if(a)throw f;return{data:null,error:f}}}}})}};const ng={"X-Client-Info":`storage-js/${Db}`,"Content-Type":"application/json"};var Rb=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function dn(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var Rm=class extends Rb{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Z8=class extends Rb{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const sg=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),e5=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},g_=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),t5=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const a=e.status||500,n=e;if(typeof n.json=="function")n.json().then(o=>{const l=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||a+"";t(new Rm(g_(o),a,l))}).catch(()=>{const o=a+"";t(new Rm(n.statusText||`HTTP ${a} error`,a,o))});else{const o=a+"";t(new Rm(n.statusText||`HTTP ${a} error`,a,o))}}else t(new Z8(g_(e),e))},r5=(e,t,r,a)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return a?(e5(a)?(n.headers=_t({"Content-Type":"application/json"},t==null?void 0:t.headers),n.body=JSON.stringify(a)):n.body=a,_t(_t({},n),r)):n};async function a5(e,t,r,a,n,o){return new Promise((l,u)=>{e(r,r5(t,a,n,o)).then(f=>{if(!f.ok)throw f;if(a!=null&&a.noResolveJson)return f;const h=f.headers.get("content-type");return!h||!h.includes("application/json")?{}:f.json()}).then(f=>l(f)).catch(f=>t5(f,u,a))})}async function hn(e,t,r,a,n){return a5(e,"POST",t,a,n,r)}var n5=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=_t(_t({},ng),t),this.fetch=sg(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await hn(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(dn(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await hn(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(dn(a))return{data:null,error:a};throw a}}async listIndexes(e){var t=this;try{return{data:await hn(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(dn(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await hn(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(dn(a))return{data:null,error:a};throw a}}},s5=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=_t(_t({},ng),t),this.fetch=sg(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await hn(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(dn(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await hn(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(dn(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await hn(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(dn(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await hn(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(dn(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await hn(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(dn(r))return{data:null,error:r};throw r}}},i5=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=_t(_t({},ng),t),this.fetch=sg(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await hn(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(dn(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await hn(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(dn(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await hn(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(dn(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await hn(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(dn(r))return{data:null,error:r};throw r}}},o5=class extends i5{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new l5(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},l5=class extends n5{constructor(e,t,r,a){super(e,t,a),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,_t(_t({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,_t(_t({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new c5(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},c5=class extends s5{constructor(e,t,r,a,n){super(e,t,n),this.vectorBucketName=r,this.indexName=a}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,_t(_t({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,_t(_t({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,_t(_t({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,_t(_t({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,_t(_t({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},u5=class extends J8{constructor(e,t={},r,a){super(e,t,r,a)}from(e){return new K8(this.url,this.headers,e,this.fetch)}get vectors(){return new o5(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Q8(this.url+"/iceberg",this.headers,this.fetch)}};const Fb="2.89.0",Fl=30*1e3,x1=3,Fm=x1*Fl,f5="http://localhost:9999",d5="supabase.auth.token",h5={"X-Client-Info":`gotrue-js/${Fb}`},v1="X-Supabase-Api-Version",Mb={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},m5=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,g5=10*60*1e3;class wu extends Error{constructor(t,r,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function ut(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class x5 extends wu{constructor(t,r,a){super(t,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function v5(e){return ut(e)&&e.name==="AuthApiError"}class go extends wu{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ys extends wu{constructor(t,r,a,n){super(t,a,n),this.name=r,this.status=a}}class sn extends Ys{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function p5(e){return ut(e)&&e.name==="AuthSessionMissingError"}class yl extends Ys{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class h0 extends Ys{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class m0 extends Ys{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function y5(e){return ut(e)&&e.name==="AuthImplicitGrantRedirectError"}class x_ extends Ys{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class _5 extends Ys{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class p1 extends Ys{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Mm(e){return ut(e)&&e.name==="AuthRetryableFetchError"}class v_ extends Ys{constructor(t,r,a){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class y1 extends Ys{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const O0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),p_=` 	
\r=`.split(""),w5=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<p_.length;t+=1)e[p_[t].charCodeAt(0)]=-2;for(let t=0;t<O0.length;t+=1)e[O0[t].charCodeAt(0)]=t;return e})();function y_(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(O0[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(O0[a]),t.queuedBits-=6}}function jb(e,t,r){const a=w5[e];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function __(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},o=l=>{E5(l,a,r)};for(let l=0;l<e.length;l+=1)jb(e.charCodeAt(l),n,o);return t.join("")}function b5(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function S5(e,t){for(let r=0;r<e.length;r+=1){let a=e.charCodeAt(r);if(a>55295&&a<=56319){const n=(a-55296)*1024&65535;a=(e.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}b5(a,t)}}function E5(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let a=1;a<6;a+=1)if((e>>7-a&1)===0){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Ul(e){const t=[],r={queue:0,queuedBits:0},a=n=>{t.push(n)};for(let n=0;n<e.length;n+=1)jb(e.charCodeAt(n),r,a);return new Uint8Array(t)}function T5(e){const t=[];return S5(e,r=>t.push(r)),new Uint8Array(t)}function po(e){const t=[],r={queue:0,queuedBits:0},a=n=>{t.push(n)};return e.forEach(n=>y_(n,r,a)),y_(null,r,a),t.join("")}function k5(e){return Math.round(Date.now()/1e3)+e}function A5(){return Symbol("auth-callback")}const wa=()=>typeof window<"u"&&typeof document<"u",oo={tested:!1,writable:!1},Ib=()=>{if(!wa())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(oo.tested)return oo.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),oo.tested=!0,oo.writable=!0}catch{oo.tested=!0,oo.writable=!1}return oo.writable};function C5(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,o)=>{t[o]=n})}catch{}return r.searchParams.forEach((a,n)=>{t[n]=a}),t}const Pb=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),N5=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ml=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},lo=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},_a=async(e,t)=>{await e.removeItem(t)};class ad{constructor(){this.promise=new ad.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}ad.promiseConstructor=Promise;function jm(e){const t=e.split(".");if(t.length!==3)throw new y1("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!m5.test(t[a]))throw new y1("JWT not in base64url format");return{header:JSON.parse(__(t[0])),payload:JSON.parse(__(t[1])),signature:Ul(t[2]),raw:{header:t[0],payload:t[1]}}}async function D5(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function O5(e,t){return new Promise((a,n)=>{(async()=>{for(let o=0;o<1/0;o++)try{const l=await e(o);if(!t(o,null,l)){a(l);return}}catch(l){if(!t(o,l)){n(l);return}}})()})}function R5(e){return("0"+e.toString(16)).substr(-2)}function F5(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let n="";for(let o=0;o<56;o++)n+=r.charAt(Math.floor(Math.random()*a));return n}return crypto.getRandomValues(t),Array.from(t,R5).join("")}async function M5(e){const r=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(a);return Array.from(n).map(o=>String.fromCharCode(o)).join("")}async function j5(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await M5(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function _l(e,t,r=!1){const a=F5();let n=a;r&&(n+="/PASSWORD_RECOVERY"),await Ml(e,`${t}-code-verifier`,n);const o=await j5(a);return[o,a===o?"plain":"s256"]}const I5=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function P5(e){const t=e.headers.get(v1);if(!t||!t.match(I5))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function L5(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function B5(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const U5=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function wl(e){if(!U5.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Im(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function z5(e,t){return new Proxy(e,{get:(r,a,n)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const o=a.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)"||o==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,n)}return!t.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,a,n)}})}function w_(e){return JSON.parse(JSON.stringify(e))}const ho=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),V5=[502,503,504];async function b_(e){var t;if(!N5(e))throw new p1(ho(e),0);if(V5.includes(e.status))throw new p1(ho(e),e.status);let r;try{r=await e.json()}catch(o){throw new go(ho(o),o)}let a;const n=P5(e);if(n&&n.getTime()>=Mb["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new v_(ho(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new sn}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((o,l)=>o&&typeof l=="string",!0))throw new v_(ho(r),e.status,r.weak_password.reasons);throw new x5(ho(r),e.status||500,a)}const H5=(e,t,r,a)=>{const n={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),r))};async function yt(e,t,r,a){var n;const o=Object.assign({},a==null?void 0:a.headers);o[v1]||(o[v1]=Mb["2024-01-01"].name),a!=null&&a.jwt&&(o.Authorization=`Bearer ${a.jwt}`);const l=(n=a==null?void 0:a.query)!==null&&n!==void 0?n:{};a!=null&&a.redirectTo&&(l.redirect_to=a.redirectTo);const u=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",f=await $5(e,t,r+u,{headers:o,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(f):{data:Object.assign({},f),error:null}}async function $5(e,t,r,a,n,o){const l=H5(t,a,n,o);let u;try{u=await e(r,Object.assign({},l))}catch(f){throw console.error(f),new p1(ho(f),0)}if(u.ok||await b_(u),a!=null&&a.noResolveJson)return u;try{return await u.json()}catch(f){await b_(f)}}function Yn(e){var t;let r=null;q5(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=k5(e.expires_in)));const a=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:a},error:null}}function S_(e){const t=Yn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Ci(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function W5(e){return{data:e,error:null}}function G5(e){const{action_link:t,email_otp:r,hashed_token:a,redirect_to:n,verification_type:o}=e,l=X0(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:r,hashed_token:a,redirect_to:n,verification_type:o},f=Object.assign({},l);return{data:{properties:u,user:f},error:null}}function E_(e){return e}function q5(e){return e.access_token&&e.refresh_token&&e.expires_in}const Pm=["global","local","others"];class Y5{constructor({url:t="",headers:r={},fetch:a}){this.url=t,this.headers=r,this.fetch=Pb(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Pm[0]){if(Pm.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Pm.join(", ")}`);try{return await yt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(ut(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,r={}){try{return await yt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ci})}catch(a){if(ut(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:r}=t,a=X0(t,["options"]),n=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(n.new_email=a==null?void 0:a.newEmail,delete n.newEmail),await yt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:G5,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(ut(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await yt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ci})}catch(r){if(ut(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,a,n,o,l,u,f;try{const h={nextPage:null,lastPage:0,total:0},g=await yt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(o=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:""},xform:E_});if(g.error)throw g.error;const v=await g.json(),p=(l=g.headers.get("x-total-count"))!==null&&l!==void 0?l:0,_=(f=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&f!==void 0?f:[];return _.length>0&&(_.forEach(b=>{const w=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);h[`${S}Page`]=w}),h.total=parseInt(p)),{data:Object.assign(Object.assign({},v),h),error:null}}catch(h){if(ut(h))return{data:{users:[]},error:h};throw h}}async getUserById(t){wl(t);try{return await yt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ci})}catch(r){if(ut(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){wl(t);try{return await yt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Ci})}catch(a){if(ut(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,r=!1){wl(t);try{return await yt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ci})}catch(a){if(ut(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){wl(t.userId);try{const{data:r,error:a}=await yt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:a}}catch(r){if(ut(r))return{data:null,error:r};throw r}}async _deleteFactor(t){wl(t.userId),wl(t.id);try{return{data:await yt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(ut(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,a,n,o,l,u,f;try{const h={nextPage:null,lastPage:0,total:0},g=await yt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(o=(n=t==null?void 0:t.perPage)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:""},xform:E_});if(g.error)throw g.error;const v=await g.json(),p=(l=g.headers.get("x-total-count"))!==null&&l!==void 0?l:0,_=(f=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&f!==void 0?f:[];return _.length>0&&(_.forEach(b=>{const w=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);h[`${S}Page`]=w}),h.total=parseInt(p)),{data:Object.assign(Object.assign({},v),h),error:null}}catch(h){if(ut(h))return{data:{clients:[]},error:h};throw h}}async _createOAuthClient(t){try{return await yt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ut(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await yt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ut(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await yt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(ut(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(t){try{return await yt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ut(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await yt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ut(r))return{data:null,error:r};throw r}}}function T_(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const bl={debug:!!(globalThis&&Ib()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Lb extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class X5 extends Lb{}async function K5(e,t,r){bl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),bl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async n=>{if(n){bl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{bl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}else{if(t===0)throw bl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new X5(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(bl.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function J5(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Bb(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function Q5(e){return parseInt(e,16)}function Z5(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,a=>a.toString(16).padStart(2,"0")).join("")}function e6(e){var t;const{chainId:r,domain:a,expirationTime:n,issuedAt:o=new Date,nonce:l,notBefore:u,requestId:f,resources:h,scheme:g,uri:v,version:p}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!v)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const _=Bb(e.address),b=g?`${g}://${a}`:a,w=e.statement?`${e.statement}
`:"",S=`${b} wants you to sign in with your Ethereum account:
${_}

${w}`;let T=`URI: ${v}
Version: ${p}
Chain ID: ${r}${l?`
Nonce: ${l}`:""}
Issued At: ${o.toISOString()}`;if(n&&(T+=`
Expiration Time: ${n.toISOString()}`),u&&(T+=`
Not Before: ${u.toISOString()}`),f&&(T+=`
Request ID: ${f}`),h){let N=`
Resources:`;for(const k of h){if(!k||typeof k!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${k}`);N+=`
- ${k}`}T+=N}return`${S}
${T}`}class ra extends Error{constructor({message:t,code:r,cause:a,name:n}){var o;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=(o=n??(a instanceof Error?a.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=r}}class R0 extends ra{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function t6({error:e,options:t}){var r,a,n;const{publicKey:o}=t;if(!o)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new ra({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=o.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new ra({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((a=o.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new ra({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((n=o.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new ra({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new ra({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new ra({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return o.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new ra({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new ra({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const l=window.location.hostname;if(Ub(l)){if(o.rp.id!==l)return new ra({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new ra({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new ra({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new ra({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new ra({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function r6({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new ra({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new ra({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(Ub(a)){if(r.rpId!==a)return new ra({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new ra({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new ra({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new ra({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class a6{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const n6=new a6;function s6(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:a}=e,n=X0(e,["challenge","user","excludeCredentials"]),o=Ul(t).buffer,l=Object.assign(Object.assign({},r),{id:Ul(r.id).buffer}),u=Object.assign(Object.assign({},n),{challenge:o,user:l});if(a&&a.length>0){u.excludeCredentials=new Array(a.length);for(let f=0;f<a.length;f++){const h=a[f];u.excludeCredentials[f]=Object.assign(Object.assign({},h),{id:Ul(h.id).buffer,type:h.type||"public-key",transports:h.transports})}}return u}function i6(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,a=X0(e,["challenge","allowCredentials"]),n=Ul(t).buffer,o=Object.assign(Object.assign({},a),{challenge:n});if(r&&r.length>0){o.allowCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const u=r[l];o.allowCredentials[l]=Object.assign(Object.assign({},u),{id:Ul(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return o}function o6(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:po(new Uint8Array(e.response.attestationObject)),clientDataJSON:po(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function l6(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,a=e.getClientExtensionResults(),n=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:po(new Uint8Array(n.authenticatorData)),clientDataJSON:po(new Uint8Array(n.clientDataJSON)),signature:po(new Uint8Array(n.signature)),userHandle:n.userHandle?po(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Ub(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function k_(){var e,t;return!!(wa()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function c6(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new R0("Browser returned unexpected credential type",t)}:{data:null,error:new R0("Empty credential response",t)}}catch(t){return{data:null,error:t6({error:t,options:e})}}}async function u6(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new R0("Browser returned unexpected credential type",t)}:{data:null,error:new R0("Empty credential response",t)}}catch(t){return{data:null,error:r6({error:t,options:e})}}}const f6={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},d6={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function F0(...e){const t=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),a={};for(const n of e)if(n)for(const o in n){const l=n[o];if(l!==void 0)if(Array.isArray(l))a[o]=l;else if(r(l))a[o]=l;else if(t(l)){const u=a[o];t(u)?a[o]=F0(u,l):a[o]=F0(l)}else a[o]=l}return a}function h6(e,t){return F0(f6,e,t||{})}function m6(e,t){return F0(d6,e,t||{})}class g6{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:a,signal:n},o){try{const{data:l,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!l)return{data:null,error:u};const f=n??n6.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:h}=l.webauthn.credential_options.publicKey;h.name||(h.name=`${h.id}:${a}`),h.displayName||(h.displayName=h.name)}switch(l.webauthn.type){case"create":{const h=h6(l.webauthn.credential_options.publicKey,o==null?void 0:o.create),{data:g,error:v}=await c6({publicKey:h,signal:f});return g?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:g}},error:null}:{data:null,error:v}}case"request":{const h=m6(l.webauthn.credential_options.publicKey,o==null?void 0:o.request),{data:g,error:v}=await u6(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:h,signal:f}));return g?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:g}},error:null}:{data:null,error:v}}}}catch(l){return ut(l)?{data:null,error:l}:{data:null,error:new go("Unexpected error in challenge",l)}}}async _verify({challengeId:t,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:a})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},o){if(!r)return{data:null,error:new wu("rpId is required for WebAuthn authentication")};try{if(!k_())return{data:null,error:new go("Browser does not support WebAuthn",null)};const{data:l,error:u}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:a},signal:n},{request:o});if(!l)return{data:null,error:u};const{webauthn:f}=l;return this._verify({factorId:t,challengeId:l.challengeId,webauthn:{type:f.type,rpId:r,rpOrigins:a,credential_response:f.credential_response}})}catch(l){return ut(l)?{data:null,error:l}:{data:null,error:new go("Unexpected error in authenticate",l)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},o){if(!r)return{data:null,error:new wu("rpId is required for WebAuthn registration")};try{if(!k_())return{data:null,error:new go("Browser does not support WebAuthn",null)};const{data:l,error:u}=await this._enroll({friendlyName:t});if(!l)return await this.client.mfa.listFactors().then(g=>{var v;return(v=g.data)===null||v===void 0?void 0:v.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===t&&p.status!=="unverified")}).then(g=>g?this.client.mfa.unenroll({factorId:g==null?void 0:g.id}):void 0),{data:null,error:u};const{data:f,error:h}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:n},{create:o});return f?this._verify({factorId:l.id,challengeId:f.challengeId,webauthn:{rpId:r,rpOrigins:a,type:f.webauthn.type,credential_response:f.webauthn.credential_response}}):{data:null,error:h}}catch(l){return ut(l)?{data:null,error:l}:{data:null,error:new go("Unexpected error in register",l)}}}}J5();const x6={url:f5,storageKey:d5,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:h5,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function A_(e,t,r){return await r()}const Sl={};class bu{get jwks(){var t,r;return(r=(t=Sl[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Sl[this.storageKey]=Object.assign(Object.assign({},Sl[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Sl[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Sl[this.storageKey]=Object.assign(Object.assign({},Sl[this.storageKey]),{cachedAt:t})}constructor(t){var r,a,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const o=Object.assign(Object.assign({},x6),t);if(this.storageKey=o.storageKey,this.instanceID=(r=bu.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,bu.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.instanceID>0&&wa()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=o.persistSession,this.autoRefreshToken=o.autoRefreshToken,this.admin=new Y5({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=Pb(o.fetch),this.lock=o.lock||A_,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,this.throwOnError=o.throwOnError,o.lock?this.lock=o.lock:this.persistSession&&wa()&&(!((a=globalThis==null?void 0:globalThis.navigator)===null||a===void 0)&&a.locks)?this.lock=K5:this.lock=A_,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new g6(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:Ib()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=T_(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=T_(this.memoryStorage)),wa()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Fb}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},a="none";if(wa()&&(r=C5(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),wa()&&this.detectSessionInUrl&&a!=="none"){const{data:n,error:o}=await this._getSessionFromURL(r,a);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),y5(o)){const f=(t=o.details)===null||t===void 0?void 0:t.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:l,redirectType:u}=n;return this._debug("#_initialize()","detected session in URL",l,"redirect type",u),await this._saveSession(l),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ut(r)?this._returnResult({error:r}):this._returnResult({error:new go("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,a,n;try{const o=await yt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.captchaToken}},xform:Yn}),{data:l,error:u}=o;if(u||!l)return this._returnResult({data:{user:null,session:null},error:u});const f=l.session,h=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:h,session:f},error:null})}catch(o){if(ut(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signUp(t){var r,a,n;try{let o;if("email"in t){const{email:g,password:v,options:p}=t;let _=null,b=null;this.flowType==="pkce"&&([_,b]=await _l(this.storage,this.storageKey)),o=await yt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:g,password:v,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:_,code_challenge_method:b},xform:Yn})}else if("phone"in t){const{phone:g,password:v,options:p}=t;o=await yt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:v,data:(a=p==null?void 0:p.data)!==null&&a!==void 0?a:{},channel:(n=p==null?void 0:p.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Yn})}else throw new h0("You must provide either an email or phone number and a password");const{data:l,error:u}=o;if(u||!l)return await _a(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:u});const f=l.session,h=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:h,session:f},error:null})}catch(o){if(await _a(this.storage,`${this.storageKey}-code-verifier`),ut(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithPassword(t){try{let r;if("email"in t){const{email:o,password:l,options:u}=t;r=await yt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:l,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:S_})}else if("phone"in t){const{phone:o,password:l,options:u}=t;r=await yt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:l,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:S_})}else throw new h0("You must provide either an email or phone number and a password");const{data:a,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!a||!a.session||!a.user){const o=new yl;return this._returnResult({data:{user:null,session:null},error:o})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(r){if(ut(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,a,n,o;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(n=t.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(o=t.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,a,n,o,l,u,f,h,g,v,p;let _,b;if("message"in t)_=t.message,b=t.signature;else{const{chain:w,wallet:S,statement:T,options:N}=t;let k;if(wa())if(typeof S=="object")k=S;else{const j=window;if("ethereum"in j&&typeof j.ethereum=="object"&&"request"in j.ethereum&&typeof j.ethereum.request=="function")k=j.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=S}const E=new URL((r=N==null?void 0:N.url)!==null&&r!==void 0?r:window.location.href),M=await k.request({method:"eth_requestAccounts"}).then(j=>j).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!M||M.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const D=Bb(M[0]);let A=(a=N==null?void 0:N.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!A){const j=await k.request({method:"eth_chainId"});A=Q5(j)}const B={domain:E.host,address:D,statement:T,uri:E.href,version:"1",chainId:A,nonce:(n=N==null?void 0:N.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(l=(o=N==null?void 0:N.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(u=N==null?void 0:N.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(f=N==null?void 0:N.signInWithEthereum)===null||f===void 0?void 0:f.notBefore,requestId:(h=N==null?void 0:N.signInWithEthereum)===null||h===void 0?void 0:h.requestId,resources:(g=N==null?void 0:N.signInWithEthereum)===null||g===void 0?void 0:g.resources};_=e6(B),b=await k.request({method:"personal_sign",params:[Z5(_),D]})}try{const{data:w,error:S}=await yt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:_,signature:b},!((v=t.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Yn});if(S)throw S;if(!w||!w.session||!w.user){const T=new yl;return this._returnResult({data:{user:null,session:null},error:T})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:S})}catch(w){if(ut(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(t){var r,a,n,o,l,u,f,h,g,v,p,_;let b,w;if("message"in t)b=t.message,w=t.signature;else{const{chain:S,wallet:T,statement:N,options:k}=t;let E;if(wa())if(typeof T=="object")E=T;else{const D=window;if("solana"in D&&typeof D.solana=="object"&&("signIn"in D.solana&&typeof D.solana.signIn=="function"||"signMessage"in D.solana&&typeof D.solana.signMessage=="function"))E=D.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!(k!=null&&k.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=T}const M=new URL((r=k==null?void 0:k.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in E&&E.signIn){const D=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},k==null?void 0:k.signInWithSolana),{version:"1",domain:M.host,uri:M.href}),N?{statement:N}:null));let A;if(Array.isArray(D)&&D[0]&&typeof D[0]=="object")A=D[0];else if(D&&typeof D=="object"&&"signedMessage"in D&&"signature"in D)A=D;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in A&&"signature"in A&&(typeof A.signedMessage=="string"||A.signedMessage instanceof Uint8Array)&&A.signature instanceof Uint8Array)b=typeof A.signedMessage=="string"?A.signedMessage:new TextDecoder().decode(A.signedMessage),w=A.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${M.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...N?["",N,""]:[""],"Version: 1",`URI: ${M.href}`,`Issued At: ${(n=(a=k==null?void 0:k.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((o=k==null?void 0:k.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${k.signInWithSolana.notBefore}`]:[],...!((l=k==null?void 0:k.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${k.signInWithSolana.expirationTime}`]:[],...!((u=k==null?void 0:k.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${k.signInWithSolana.chainId}`]:[],...!((f=k==null?void 0:k.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${k.signInWithSolana.nonce}`]:[],...!((h=k==null?void 0:k.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${k.signInWithSolana.requestId}`]:[],...!((v=(g=k==null?void 0:k.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||v===void 0)&&v.length?["Resources",...k.signInWithSolana.resources.map(A=>`- ${A}`)]:[]].join(`
`);const D=await E.signMessage(new TextEncoder().encode(b),"utf8");if(!D||!(D instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=D}}try{const{data:S,error:T}=await yt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:po(w)},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(_=t.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:Yn});if(T)throw T;if(!S||!S.session||!S.user){const N=new yl;return this._returnResult({data:{user:null,session:null},error:N})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:T})}catch(S){if(ut(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(t){const r=await lo(this.storage,`${this.storageKey}-code-verifier`),[a,n]=(r??"").split("/");try{if(!a&&this.flowType==="pkce")throw new _5;const{data:o,error:l}=await yt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:Yn});if(await _a(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!o||!o.session||!o.user){const u=new yl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign(Object.assign({},o),{redirectType:n??null}),error:l})}catch(o){if(await _a(this.storage,`${this.storageKey}-code-verifier`),ut(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}}async signInWithIdToken(t){try{const{options:r,provider:a,token:n,access_token:o,nonce:l}=t,u=await yt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:n,access_token:o,nonce:l,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Yn}),{data:f,error:h}=u;if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!f||!f.session||!f.user){const g=new yl;return this._returnResult({data:{user:null,session:null},error:g})}return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),this._returnResult({data:f,error:h})}catch(r){if(ut(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,a,n,o,l;try{if("email"in t){const{email:u,options:f}=t;let h=null,g=null;this.flowType==="pkce"&&([h,g]=await _l(this.storage,this.storageKey));const{error:v}=await yt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},create_user:(a=f==null?void 0:f.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:h,code_challenge_method:g},redirectTo:f==null?void 0:f.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:v})}if("phone"in t){const{phone:u,options:f}=t,{data:h,error:g}=await yt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},create_user:(o=f==null?void 0:f.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},channel:(l=f==null?void 0:f.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:g})}throw new h0("You must provide either an email or phone number.")}catch(u){if(await _a(this.storage,`${this.storageKey}-code-verifier`),ut(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(t){var r,a;try{let n,o;"options"in t&&(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo,o=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:l,error:u}=await yt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:o}}),redirectTo:n,xform:Yn});if(u)throw u;if(!l)throw new Error("An error occurred on token verification.");const f=l.session,h=l.user;return f!=null&&f.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),this._returnResult({data:{user:h,session:f},error:null})}catch(n){if(ut(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(t){var r,a,n,o,l;try{let u=null,f=null;this.flowType==="pkce"&&([u,f]=await _l(this.storage,this.storageKey));const h=await yt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((n=t==null?void 0:t.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:f}),headers:this.headers,xform:W5});return!((o=h.data)===null||o===void 0)&&o.url&&wa()&&!(!((l=t.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(h.data.url),this._returnResult(h)}catch(u){if(await _a(this.storage,`${this.storageKey}-code-verifier`),ut(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;if(a)throw a;if(!r)throw new sn;const{error:n}=await yt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(t){if(ut(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:a,type:n,options:o}=t,{error:l}=await yt(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in t){const{phone:a,type:n,options:o}=t,{data:l,error:u}=await yt(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:u})}throw new h0("You must provide either an email or phone number and a type")}catch(r){if(ut(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await lo(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<Fm:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const l=await lo(this.userStorage,this.storageKey+"-user");l!=null&&l.user?t.user=l.user:t.user=Im()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};t.user=z5(t.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:n,error:o}=await this._callRefreshToken(t.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await yt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ci}):await this._useSession(async r=>{var a,n,o;const{data:l,error:u}=r;if(u)throw u;return!(!((a=l.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new sn}:await yt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&o!==void 0?o:void 0,xform:Ci})})}catch(r){if(ut(r))return p5(r)&&(await this._removeSession(),await _a(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async a=>{const{data:n,error:o}=a;if(o)throw o;if(!n.session)throw new sn;const l=n.session;let u=null,f=null;this.flowType==="pkce"&&t.email!=null&&([u,f]=await _l(this.storage,this.storageKey));const{data:h,error:g}=await yt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:f}),jwt:l.access_token,xform:Ci});if(g)throw g;return l.user=h.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(a){if(await _a(this.storage,`${this.storageKey}-code-verifier`),ut(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new sn;const r=Date.now()/1e3;let a=r,n=!0,o=null;const{payload:l}=jm(t.access_token);if(l.exp&&(a=l.exp,n=a<=r),n){const{data:u,error:f}=await this._callRefreshToken(t.refresh_token);if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!u)return{data:{user:null,session:null},error:null};o=u}else{const{data:u,error:f}=await this._getUser(t.access_token);if(f)throw f;o={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(r){if(ut(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var a;if(!t){const{data:l,error:u}=r;if(u)throw u;t=(a=l.session)!==null&&a!==void 0?a:void 0}if(!(t!=null&&t.refresh_token))throw new sn;const{data:n,error:o}=await this._callRefreshToken(t.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(ut(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!wa())throw new m0("No browser detected.");if(t.error||t.error_description||t.error_code)throw new m0(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new x_("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new m0("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new x_("No code detected.");const{data:N,error:k}=await this._exchangeCodeForSession(t.code);if(k)throw k;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:N.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:o,refresh_token:l,expires_in:u,expires_at:f,token_type:h}=t;if(!o||!u||!l||!h)throw new m0("No session defined in URL");const g=Math.round(Date.now()/1e3),v=parseInt(u);let p=g+v;f&&(p=parseInt(f));const _=p-g;_*1e3<=Fl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${v}s`);const b=p-v;g-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,p,g):g-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,p,g);const{data:w,error:S}=await this._getUser(o);if(S)throw S;const T={provider_token:a,provider_refresh_token:n,access_token:o,expires_in:v,expires_at:p,refresh_token:l,token_type:h,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:T,redirectType:t.type},error:null})}catch(a){if(ut(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await lo(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:n,error:o}=r;if(o)return this._returnResult({error:o});const l=(a=n.session)===null||a===void 0?void 0:a.access_token;if(l){const{error:u}=await this.admin.signOut(l,t);if(u&&!(v5(u)&&(u.status===404||u.status===401||u.status===403)))return this._returnResult({error:u})}return t!=="others"&&(await this._removeSession(),await _a(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=A5(),a={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async r=>{var a,n;try{const{data:{session:o},error:l}=r;if(l)throw l;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",t,"session",o)}catch(o){await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",o),console.error(o)}})}async resetPasswordForEmail(t,r={}){let a=null,n=null;this.flowType==="pkce"&&([a,n]=await _l(this.storage,this.storageKey,!0));try{return await yt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(await _a(this.storage,`${this.storageKey}-code-verifier`),ut(o))return this._returnResult({data:null,error:o});throw o}}async getUserIdentities(){var t;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(ut(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:a,error:n}=await this._useSession(async o=>{var l,u,f,h,g;const{data:v,error:p}=o;if(p)throw p;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(f=t.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await yt(this.fetch,"GET",_,{headers:this.headers,jwt:(g=(h=v.session)===null||h===void 0?void 0:h.access_token)!==null&&g!==void 0?g:void 0})});if(n)throw n;return wa()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),this._returnResult({data:{provider:t.provider,url:a==null?void 0:a.url},error:null})}catch(a){if(ut(a))return this._returnResult({data:{provider:t.provider,url:null},error:a});throw a}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var a;try{const{error:n,data:{session:o}}=r;if(n)throw n;const{options:l,provider:u,token:f,access_token:h,nonce:g}=t,v=await yt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=o==null?void 0:o.access_token)!==null&&a!==void 0?a:void 0,body:{provider:u,id_token:f,access_token:h,nonce:g,link_identity:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Yn}),{data:p,error:_}=v;return _?this._returnResult({data:{user:null,session:null},error:_}):!p||!p.session||!p.user?this._returnResult({data:{user:null,session:null},error:new yl}):(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),this._returnResult({data:p,error:_}))}catch(n){if(await _a(this.storage,`${this.storageKey}-code-verifier`),ut(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var a,n;const{data:o,error:l}=r;if(l)throw l;return await yt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(n=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(ut(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await O5(async n=>(n>0&&await D5(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await yt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Yn})),(n,o)=>{const l=200*Math.pow(2,n);return o&&Mm(o)&&Date.now()+l-a<Fl})}catch(a){if(this._debug(r,"error",a),ut(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",a),wa()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const n=await lo(this.storage,this.storageKey);if(n&&this.userStorage){let l=await lo(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:n.user},await Ml(this.userStorage,this.storageKey+"-user",l)),n.user=(t=l==null?void 0:l.user)!==null&&t!==void 0?t:Im()}else if(n&&!n.user&&!n.user){const l=await lo(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(n.user=l.user,await _a(this.storage,this.storageKey+"-user"),await Ml(this.storage,this.storageKey,n)):n.user=Im()}if(this._debug(a,"session from storage",n),!this._isValidSession(n)){this._debug(a,"session is not valid"),n!==null&&await this._removeSession();return}const o=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Fm;if(this._debug(a,`session has${o?"":" not"} expired with margin of ${Fm}s`),o){if(this.autoRefreshToken&&n.refresh_token){const{error:l}=await this._callRefreshToken(n.refresh_token);l&&(console.error(l),Mm(l)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:u}=await this._getUser(n.access_token);!u&&(l!=null&&l.user)?(n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(a,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(a,"error",n),console.error(n);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var r,a;if(!t)throw new sn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new ad;const{data:o,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!o.session)throw new sn;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const u={data:o.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(o){if(this._debug(n,"error",o),ut(o)){const l={data:null,error:o};return Mm(o)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(o),o}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(t,r,a=!0){const n=`#_notifyAllSubscribers(${t})`;this._debug(n,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:r});const o=[],l=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,r)}catch(f){o.push(f)}});if(await Promise.all(l),o.length>0){for(let u=0;u<o.length;u+=1)console.error(o[u]);throw o[0]}}finally{this._debug(n,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await _a(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await Ml(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const o=w_(n);await Ml(this.storage,this.storageKey,o)}else{const n=w_(r);await Ml(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await _a(this.storage,this.storageKey),await _a(this.storage,this.storageKey+"-code-verifier"),await _a(this.storage,this.storageKey+"-user"),this.userStorage&&await _a(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&wa()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Fl);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((a.expires_at*1e3-t)/Fl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Fl}ms, refresh threshold is ${x1} ticks`),n<=x1&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Lb)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!wa()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,a){const n=[`provider=${encodeURIComponent(r)}`];if(a!=null&&a.redirectTo&&n.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&n.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[o,l]=await _l(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(l)}`});n.push(u.toString())}if(a!=null&&a.queryParams){const o=new URLSearchParams(a.queryParams);n.push(o.toString())}return a!=null&&a.skipBrowserRedirect&&n.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var a;const{data:n,error:o}=r;return o?this._returnResult({data:null,error:o}):await yt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(ut(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var a,n;const{data:o,error:l}=r;if(l)return this._returnResult({data:null,error:l});const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:f,error:h}=await yt(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(a=o==null?void 0:o.session)===null||a===void 0?void 0:a.access_token});return h?this._returnResult({data:null,error:h}):(t.factorType==="totp"&&f.type==="totp"&&(!((n=f==null?void 0:f.totp)===null||n===void 0)&&n.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),this._returnResult({data:f,error:null}))})}catch(r){if(ut(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?o6(t.webauthn.credential_response):l6(t.webauthn.credential_response)})}:{code:t.code}),{data:u,error:f}=await yt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:l,headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});return f?this._returnResult({data:null,error:f}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:f}))})}catch(r){if(ut(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=await yt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});if(l.error)return l;const{data:u}=l;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:s6(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:i6(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(ut(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:a}=await this._challenge({factorId:t.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const n={all:[],phone:[],totp:[],webauthn:[]};for(const o of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])n.all.push(o),o.status==="verified"&&n[o.factor_type].push(o);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:a},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=jm(a.access_token);let l=null;o.aal&&(l=o.aal);let u=l;((r=(t=a.user.factors)===null||t===void 0?void 0:t.filter(g=>g.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const h=o.amr||[];return{data:{currentLevel:l,nextLevel:u,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:a},error:n}=r;return n?this._returnResult({data:null,error:n}):a?await yt(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:a.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new sn})})}catch(r){if(ut(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:n},error:o}=a;if(o)return this._returnResult({data:null,error:o});if(!n)return this._returnResult({data:null,error:new sn});const l=await yt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return l.data&&l.data.redirect_url&&wa()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(a){if(ut(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:n},error:o}=a;if(o)return this._returnResult({data:null,error:o});if(!n)return this._returnResult({data:null,error:new sn});const l=await yt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return l.data&&l.data.redirect_url&&wa()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(a){if(ut(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?await yt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new sn})})}catch(t){if(ut(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:a},error:n}=r;return n?this._returnResult({data:null,error:n}):a?(await yt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new sn})})}catch(r){if(ut(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let a=r.keys.find(u=>u.kid===t);if(a)return a;const n=Date.now();if(a=this.jwks.keys.find(u=>u.kid===t),a&&this.jwks_cached_at+g5>n)return a;const{data:o,error:l}=await yt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=n,a=o.keys.find(u=>u.kid===t),!a)?null:a}async getClaims(t,r={}){try{let a=t;if(!a){const{data:_,error:b}=await this.getSession();if(b||!_.session)return this._returnResult({data:null,error:b});a=_.session.access_token}const{header:n,payload:o,signature:l,raw:{header:u,payload:f}}=jm(a);r!=null&&r.allowExpired||L5(o.exp);const h=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!h){const{error:_}=await this.getUser(a);if(_)throw _;return{data:{claims:o,header:n,signature:l},error:null}}const g=B5(n.alg),v=await crypto.subtle.importKey("jwk",h,g,!0,["verify"]);if(!await crypto.subtle.verify(g,v,l,T5(`${u}.${f}`)))throw new y1("Invalid JWT signature");return{data:{claims:o,header:n,signature:l},error:null}}catch(a){if(ut(a))return this._returnResult({data:null,error:a});throw a}}}bu.nextInstanceID={};const v6=bu,p6="2.89.0";let eu="";typeof Deno<"u"?eu="deno":typeof document<"u"?eu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?eu="react-native":eu="node";const y6={"X-Client-Info":`supabase-js-${eu}/${p6}`},_6={headers:y6},w6={schema:"public"},b6={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},S6={};function Su(e){"@babel/helpers - typeof";return Su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Su(e)}function E6(e,t){if(Su(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Su(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function T6(e){var t=E6(e,"string");return Su(t)=="symbol"?t:t+""}function k6(e,t,r){return(t=T6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function Br(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?C_(Object(r),!0).forEach(function(a){k6(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C_(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}const A6=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),C6=()=>Headers,N6=(e,t,r)=>{const a=A6(r),n=C6();return async(o,l)=>{var u;const f=(u=await t())!==null&&u!==void 0?u:e;let h=new n(l==null?void 0:l.headers);return h.has("apikey")||h.set("apikey",e),h.has("Authorization")||h.set("Authorization",`Bearer ${f}`),a(o,Br(Br({},l),{},{headers:h}))}};function D6(e){return e.endsWith("/")?e:e+"/"}function O6(e,t){var r,a;const{db:n,auth:o,realtime:l,global:u}=e,{db:f,auth:h,realtime:g,global:v}=t,p={db:Br(Br({},f),n),auth:Br(Br({},h),o),realtime:Br(Br({},g),l),storage:{},global:Br(Br(Br({},v),u),{},{headers:Br(Br({},(r=v==null?void 0:v.headers)!==null&&r!==void 0?r:{}),(a=u==null?void 0:u.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}function R6(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(D6(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var F6=class extends v6{constructor(e){super(e)}},M6=class{constructor(e,t,r){var a,n;this.supabaseUrl=e,this.supabaseKey=t;const o=R6(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,u={db:w6,realtime:S6,auth:Br(Br({},b6),{},{storageKey:l}),global:_6},f=O6(r??{},u);if(this.storageKey=(a=f.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(n=f.global.headers)!==null&&n!==void 0?n:{},f.accessToken)this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(g,v)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(v)} is not possible`)}});else{var h;this.auth=this._initSupabaseAuthClient((h=f.auth)!==null&&h!==void 0?h:{},this.headers,f.global.fetch)}this.fetch=N6(t,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Br({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.accessToken&&this.accessToken().then(g=>this.realtime.setAuth(g)).catch(g=>console.warn("Failed to set initial Realtime auth token:",g)),this.rest=new h8(new URL("rest/v1",o).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new u5(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new l8(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:a}=await e.auth.getSession();return(t=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:n,storageKey:o,flowType:l,lock:u,debug:f,throwOnError:h},g,v){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new F6({url:this.authUrl.href,headers:Br(Br({},p),g),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:n,flowType:l,lock:u,debug:f,throwOnError:h,fetch:v,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new D8(this.realtimeUrl.href,Br(Br({},e),{},{params:Br(Br({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const j6=(e,t,r)=>new M6(e,t,r);function I6(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}I6()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const P6="https://tqelhhitxpahzllngamh.supabase.co",L6="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRxZWxoaGl0eHBhaHpsbG5nYW1oIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY2NzMwMjksImV4cCI6MjA4MjI0OTAyOX0.fqtBXBNmMA1yGud_PXNqzXduEmW75kZ9b8CkttymFzI",ot=j6(P6,L6),B6=Object.freeze(Object.defineProperty({__proto__:null,supabase:ot},Symbol.toStringTag,{value:"Module"}));function nd(){var _,b,w,S,T,N,k;const{filters:e,setFilters:t,resetFilters:r}=Bu(),[a,n]=K.useState(e.startDate),[o,l]=K.useState([]),[u,f]=K.useState([]),[h,g]=K.useState([]),[v,p]=K.useState([]);return K.useEffect(()=>{(async()=>{const[M,D,A,B]=await Promise.all([ot.from("setores").select("*").order("nome"),ot.from("motivos_devolucao").select("id, nome").order("nome"),ot.from("clientes").select("nome").order("nome"),ot.from("devolucoes").select("vendedor").not("vendedor","is",null)]);if(M.data&&l(M.data.map(j=>({id:j.id,name:j.nome}))),D.data&&f(D.data),A.data){const j=Array.from(new Set(A.data.map(ee=>ee.nome))).filter(Boolean);g(j.map(ee=>({nome:ee})))}if(B.data){const j=Array.from(new Set(B.data.map(ee=>ee.vendedor))).filter(Boolean);p(j)}})()},[]),m.jsxs("div",{className:"w-full bg-card border-b p-4 space-y-4",children:[m.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[m.jsxs("div",{className:"relative w-full md:w-1/3",children:[m.jsx(UN,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),m.jsx(Gr,{placeholder:"Buscar por cliente, vendedor, cidade...",className:"pl-8",value:e.search||"",onChange:E=>t({search:E.target.value})})]}),m.jsxs("div",{className:"flex flex-wrap gap-2 items-center w-full md:w-auto",children:[m.jsxs(Ra,{value:((_=e.resultado)==null?void 0:_[0])||"all",onValueChange:E=>t({resultado:E==="all"?void 0:[E]}),children:[m.jsx(Ea,{className:"w-[180px]",children:m.jsx(Fa,{placeholder:"Resultado"})}),m.jsxs(Ta,{children:[m.jsx(Et,{value:"all",children:"Todos os Resultados"}),m.jsx(Et,{value:"PENDENTE VALIDAO",children:"PENDENTE VALIDAO"}),m.jsx(Et,{value:"VALIDADA",children:"VALIDADA"}),m.jsx(Et,{value:"LANADA",children:"LANADA"}),m.jsx(Et,{value:"TRATATIVA DE ANULAO",children:"TRATATIVA DE ANULAO"}),m.jsx(Et,{value:"ANULADA/CANCELADA",children:"ANULADA/CANCELADA"})]})]}),m.jsxs(Ra,{value:((b=e.motivo)==null?void 0:b[0])||"all",onValueChange:E=>t({motivo:E==="all"?void 0:[E]}),children:[m.jsx(Ea,{className:"w-[180px]",children:m.jsx(Fa,{placeholder:"Motivo"})}),m.jsxs(Ta,{children:[m.jsx(Et,{value:"all",children:"Todos os Motivos"}),u.map(E=>m.jsx(Et,{value:E.id,children:E.nome},E.id))]})]}),m.jsxs(Ra,{value:((w=e.cliente)==null?void 0:w[0])||"all",onValueChange:E=>t({cliente:E==="all"?void 0:[E]}),children:[m.jsx(Ea,{className:"w-[180px]",children:m.jsx(Fa,{placeholder:"Cliente"})}),m.jsxs(Ta,{children:[m.jsx(Et,{value:"all",children:"Todos os Clientes"}),h.slice(0,100).map((E,M)=>m.jsx(Et,{value:E.nome,children:E.nome},M))]})]}),m.jsxs(Ra,{value:((S=e.vendedor)==null?void 0:S[0])||"all",onValueChange:E=>t({vendedor:E==="all"?void 0:[E]}),children:[m.jsx(Ea,{className:"w-[160px]",children:m.jsx(Fa,{placeholder:"Vendedor"})}),m.jsxs(Ta,{children:[m.jsx(Et,{value:"all",children:"Todos os Vendedores"}),v.map(E=>m.jsx(Et,{value:E,children:E},E))]})]}),m.jsxs(Ra,{value:((T=e.setor)==null?void 0:T[0])||"all",onValueChange:E=>t({setor:E==="all"?void 0:[E]}),children:[m.jsxs(Ea,{className:"w-[160px]",children:[m.jsx(xN,{className:"mr-2 h-4 w-4 text-muted-foreground"}),m.jsx(Fa,{placeholder:"Setor"})]}),m.jsxs(Ta,{children:[m.jsx(Et,{value:"all",children:"Todos os Setores"}),o.map(E=>m.jsx(Et,{value:E.id,children:E.name},E.id))]})]}),m.jsxs(Ra,{value:e.period,onValueChange:E=>t({period:E}),children:[m.jsx(Ea,{className:"w-[160px]",children:m.jsx(Fa,{placeholder:"Perodo"})}),m.jsxs(Ta,{children:[m.jsx(Et,{value:"TODAY",children:"Hoje"}),m.jsx(Et,{value:"YESTERDAY",children:"Ontem"}),m.jsx(Et,{value:"THIS_WEEK",children:"Esta Semana"}),m.jsx(Et,{value:"LAST_WEEK",children:"Semana Passada"}),m.jsx(Et,{value:"THIS_MONTH",children:"Ms Atual"}),m.jsx(Et,{value:"LAST_MONTH",children:"Ms Anterior"}),m.jsx(Et,{value:"THIS_QUARTER",children:"Trimestre Atual"}),m.jsx(Et,{value:"THIS_SEMESTER",children:"Semestre Atual"}),m.jsx(Et,{value:"THIS_YEAR",children:"Ano Atual"})]})]}),m.jsxs(F3,{children:[m.jsx(M3,{asChild:!0,children:m.jsxs(Dt,{variant:"outline",className:Ye("w-[200px] justify-start text-left font-normal",!a&&"text-muted-foreground"),children:[m.jsx(GC,{className:"mr-2 h-4 w-4"}),a?ir(a,"dd/MM/yyyy"):m.jsx("span",{children:"Data Especfica"})]})}),m.jsx(Y2,{className:"w-auto p-0",align:"start",children:m.jsx(a8,{mode:"single",selected:a,onSelect:E=>{n(E),t({startDate:E})},initialFocus:!0})})]}),m.jsx(Dt,{variant:"ghost",size:"icon",onClick:()=>{r(),n(void 0)},children:m.jsx(dN,{className:"h-4 w-4"})})]})]}),m.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.period&&m.jsxs(ln,{variant:"secondary",children:["Perodo: ",e.period]}),e.search&&m.jsxs(ln,{variant:"secondary",children:["Busca: ",e.search]}),e.setor&&e.setor.length>0&&m.jsxs(ln,{variant:"secondary",children:["Setor: ",((N=o.find(E=>{var M;return E.id===((M=e.setor)==null?void 0:M[0])}))==null?void 0:N.name)||"Selecionado"]}),e.resultado&&e.resultado.length>0&&m.jsxs(ln,{variant:"secondary",children:["Resultado: ",e.resultado[0]]}),e.motivo&&e.motivo.length>0&&m.jsxs(ln,{variant:"secondary",children:["Motivo: ",((k=u.find(E=>{var M;return E.id===((M=e.motivo)==null?void 0:M[0])}))==null?void 0:k.nome)||"Selecionado"]}),e.cliente&&e.cliente.length>0&&m.jsxs(ln,{variant:"secondary",children:["Cliente: ",e.cliente[0]]}),e.vendedor&&e.vendedor.length>0&&m.jsxs(ln,{variant:"secondary",children:["Vendedor: ",e.vendedor[0]]})]})]})}function ig(e){if(!e)return{};const t=new Date;switch(e){case"TODAY":return{startDate:Mi(t),endDate:Em(t)};case"YESTERDAY":const r=QD(t);return{startDate:Mi(r),endDate:Em(r)};case"THIS_WEEK":return{startDate:ji(t,{weekStartsOn:1}),endDate:D0(t,{weekStartsOn:1})};case"LAST_WEEK":const a=rO(t);return{startDate:ji(a,{weekStartsOn:1}),endDate:D0(a,{weekStartsOn:1})};case"THIS_MONTH":return{startDate:l1(t),endDate:o1(t)};case"LAST_MONTH":const n=tO(t);return{startDate:l1(n),endDate:o1(n)};case"THIS_QUARTER":return{startDate:q3(t),endDate:K3(t)};case"THIS_SEMESTER":const o=t.getMonth()<6?new Date(t.getFullYear(),0,1):new Date(t.getFullYear(),6,1),l=t.getMonth()<6?new Date(t.getFullYear(),5,30):new Date(t.getFullYear(),11,31);return{startDate:Mi(o),endDate:Em(l)};case"THIS_YEAR":return{startDate:G1(t),endDate:rb(t)};default:return{}}}function U6(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}const z6=e=>{switch(e){case"success":return $6;case"info":return G6;case"warning":return W6;case"error":return q6;default:return null}},V6=Array(12).fill(0),H6=({visible:e,className:t})=>ge.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},ge.createElement("div",{className:"sonner-spinner"},V6.map((r,a)=>ge.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${a}`})))),$6=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ge.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),W6=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ge.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),G6=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ge.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),q6=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ge.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Y6=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ge.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ge.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),X6=()=>{const[e,t]=ge.useState(document.hidden);return ge.useEffect(()=>{const r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e};let _1=1;class K6{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;const{message:a,...n}=t,o=typeof(t==null?void 0:t.id)=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:_1++,l=this.toasts.find(f=>f.id===o),u=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(o)&&this.dismissedToasts.delete(o),l?this.toasts=this.toasts.map(f=>f.id===o?(this.publish({...f,...t,id:o,title:a}),{...f,...t,id:o,dismissible:u,title:a}):f):this.addToast({title:a,...n,dismissible:u,id:o}),o},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:t,dismiss:!0})))):this.toasts.forEach(r=>{this.subscribers.forEach(a=>a({id:r.id,dismiss:!0}))}),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let a;r.loading!==void 0&&(a=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const n=Promise.resolve(t instanceof Function?t():t);let o=a!==void 0,l;const u=n.then(async h=>{if(l=["resolve",h],ge.isValidElement(h))o=!1,this.create({id:a,type:"default",message:h});else if(Q6(h)&&!h.ok){o=!1;const v=typeof r.error=="function"?await r.error(`HTTP error! status: ${h.status}`):r.error,p=typeof r.description=="function"?await r.description(`HTTP error! status: ${h.status}`):r.description,b=typeof v=="object"&&!ge.isValidElement(v)?v:{message:v};this.create({id:a,type:"error",description:p,...b})}else if(h instanceof Error){o=!1;const v=typeof r.error=="function"?await r.error(h):r.error,p=typeof r.description=="function"?await r.description(h):r.description,b=typeof v=="object"&&!ge.isValidElement(v)?v:{message:v};this.create({id:a,type:"error",description:p,...b})}else if(r.success!==void 0){o=!1;const v=typeof r.success=="function"?await r.success(h):r.success,p=typeof r.description=="function"?await r.description(h):r.description,b=typeof v=="object"&&!ge.isValidElement(v)?v:{message:v};this.create({id:a,type:"success",description:p,...b})}}).catch(async h=>{if(l=["reject",h],r.error!==void 0){o=!1;const g=typeof r.error=="function"?await r.error(h):r.error,v=typeof r.description=="function"?await r.description(h):r.description,_=typeof g=="object"&&!ge.isValidElement(g)?g:{message:g};this.create({id:a,type:"error",description:v,..._})}}).finally(()=>{o&&(this.dismiss(a),a=void 0),r.finally==null||r.finally.call(r)}),f=()=>new Promise((h,g)=>u.then(()=>l[0]==="reject"?g(l[1]):h(l[1])).catch(g));return typeof a!="string"&&typeof a!="number"?{unwrap:f}:Object.assign(a,{unwrap:f})},this.custom=(t,r)=>{const a=(r==null?void 0:r.id)||_1++;return this.create({jsx:t(a),id:a,...r}),a},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const qa=new K6,J6=(e,t)=>{const r=(t==null?void 0:t.id)||_1++;return qa.addToast({title:e,...t,id:r}),r},Q6=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",Z6=J6,eF=()=>qa.toasts,tF=()=>qa.getActiveToasts(),Ke=Object.assign(Z6,{success:qa.success,info:qa.info,warning:qa.warning,error:qa.error,custom:qa.custom,message:qa.message,promise:qa.promise,dismiss:qa.dismiss,loading:qa.loading},{getHistory:eF,getToasts:tF});U6("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function g0(e){return e.label!==void 0}const rF=3,aF="24px",nF="16px",N_=4e3,sF=356,iF=14,oF=45,lF=200;function cs(...e){return e.filter(Boolean).join(" ")}function cF(e){const[t,r]=e.split("-"),a=[];return t&&a.push(t),r&&a.push(r),a}const uF=e=>{var t,r,a,n,o,l,u,f,h;const{invert:g,toast:v,unstyled:p,interacting:_,setHeights:b,visibleToasts:w,heights:S,index:T,toasts:N,expanded:k,removeToast:E,defaultRichColors:M,closeButton:D,style:A,cancelButtonStyle:B,actionButtonStyle:j,className:ee="",descriptionClassName:re="",duration:U,position:I,gap:ne,expandByDefault:ie,classNames:q,icons:ae,closeButtonAriaLabel:be="Close toast"}=e,[z,fe]=ge.useState(null),[De,P]=ge.useState(null),[X,Y]=ge.useState(!1),[Q,de]=ge.useState(!1),[Fe,Te]=ge.useState(!1),[Oe,Re]=ge.useState(!1),[Je,H]=ge.useState(!1),[O,Ae]=ge.useState(0),[Pe,Se]=ge.useState(0),Z=ge.useRef(v.duration||U||N_),le=ge.useRef(null),Ge=ge.useRef(null),kt=T===0,nt=T+1<=w,st=v.type,Ze=v.dismissible!==!1,Ee=v.className||"",Xe=v.descriptionClassName||"",Qe=ge.useMemo(()=>S.findIndex(ct=>ct.toastId===v.id)||0,[S,v.id]),et=ge.useMemo(()=>{var ct;return(ct=v.closeButton)!=null?ct:D},[v.closeButton,D]),rt=ge.useMemo(()=>v.duration||U||N_,[v.duration,U]),ke=ge.useRef(0),ye=ge.useRef(0),xe=ge.useRef(0),ze=ge.useRef(null),[xt,qt]=I.split("-"),lr=ge.useMemo(()=>S.reduce((ct,je,He)=>He>=Qe?ct:ct+je.height,0),[S,Qe]),Nr=X6(),gr=v.invert||g,xa=st==="loading";ye.current=ge.useMemo(()=>Qe*ne+lr,[Qe,lr]),ge.useEffect(()=>{Z.current=rt},[rt]),ge.useEffect(()=>{Y(!0)},[]),ge.useEffect(()=>{const ct=Ge.current;if(ct){const je=ct.getBoundingClientRect().height;return Se(je),b(He=>[{toastId:v.id,height:je,position:v.position},...He]),()=>b(He=>He.filter(pr=>pr.toastId!==v.id))}},[b,v.id]),ge.useLayoutEffect(()=>{if(!X)return;const ct=Ge.current,je=ct.style.height;ct.style.height="auto";const He=ct.getBoundingClientRect().height;ct.style.height=je,Se(He),b(pr=>pr.find(Sr=>Sr.toastId===v.id)?pr.map(Sr=>Sr.toastId===v.id?{...Sr,height:He}:Sr):[{toastId:v.id,height:He,position:v.position},...pr])},[X,v.title,v.description,b,v.id,v.jsx,v.action,v.cancel]);const br=ge.useCallback(()=>{de(!0),Ae(ye.current),b(ct=>ct.filter(je=>je.toastId!==v.id)),setTimeout(()=>{E(v)},lF)},[v,E,b,ye]);ge.useEffect(()=>{if(v.promise&&st==="loading"||v.duration===1/0||v.type==="loading")return;let ct;return k||_||Nr?(()=>{if(xe.current<ke.current){const pr=new Date().getTime()-ke.current;Z.current=Z.current-pr}xe.current=new Date().getTime()})():(()=>{Z.current!==1/0&&(ke.current=new Date().getTime(),ct=setTimeout(()=>{v.onAutoClose==null||v.onAutoClose.call(v,v),br()},Z.current))})(),()=>clearTimeout(ct)},[k,_,v,st,Nr,br]),ge.useEffect(()=>{v.delete&&(br(),v.onDismiss==null||v.onDismiss.call(v,v))},[br,v.delete]);function ft(){var ct;if(ae!=null&&ae.loading){var je;return ge.createElement("div",{className:cs(q==null?void 0:q.loader,v==null||(je=v.classNames)==null?void 0:je.loader,"sonner-loader"),"data-visible":st==="loading"},ae.loading)}return ge.createElement(H6,{className:cs(q==null?void 0:q.loader,v==null||(ct=v.classNames)==null?void 0:ct.loader),visible:st==="loading"})}const jt=v.icon||(ae==null?void 0:ae[st])||z6(st);var lt,Ot;return ge.createElement("li",{tabIndex:0,ref:Ge,className:cs(ee,Ee,q==null?void 0:q.toast,v==null||(t=v.classNames)==null?void 0:t.toast,q==null?void 0:q.default,q==null?void 0:q[st],v==null||(r=v.classNames)==null?void 0:r[st]),"data-sonner-toast":"","data-rich-colors":(lt=v.richColors)!=null?lt:M,"data-styled":!(v.jsx||v.unstyled||p),"data-mounted":X,"data-promise":!!v.promise,"data-swiped":Je,"data-removed":Q,"data-visible":nt,"data-y-position":xt,"data-x-position":qt,"data-index":T,"data-front":kt,"data-swiping":Fe,"data-dismissible":Ze,"data-type":st,"data-invert":gr,"data-swipe-out":Oe,"data-swipe-direction":De,"data-expanded":!!(k||ie&&X),"data-testid":v.testId,style:{"--index":T,"--toasts-before":T,"--z-index":N.length-T,"--offset":`${Q?O:ye.current}px`,"--initial-height":ie?"auto":`${Pe}px`,...A,...v.style},onDragEnd:()=>{Te(!1),fe(null),ze.current=null},onPointerDown:ct=>{ct.button!==2&&(xa||!Ze||(le.current=new Date,Ae(ye.current),ct.target.setPointerCapture(ct.pointerId),ct.target.tagName!=="BUTTON"&&(Te(!0),ze.current={x:ct.clientX,y:ct.clientY})))},onPointerUp:()=>{var ct,je,He;if(Oe||!Ze)return;ze.current=null;const pr=Number(((ct=Ge.current)==null?void 0:ct.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Bn=Number(((je=Ge.current)==null?void 0:je.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Sr=new Date().getTime()-((He=le.current)==null?void 0:He.getTime()),xr=z==="x"?pr:Bn,Or=Math.abs(xr)/Sr;if(Math.abs(xr)>=oF||Or>.11){Ae(ye.current),v.onDismiss==null||v.onDismiss.call(v,v),P(z==="x"?pr>0?"right":"left":Bn>0?"down":"up"),br(),Re(!0);return}else{var er,Xr;(er=Ge.current)==null||er.style.setProperty("--swipe-amount-x","0px"),(Xr=Ge.current)==null||Xr.style.setProperty("--swipe-amount-y","0px")}H(!1),Te(!1),fe(null)},onPointerMove:ct=>{var je,He,pr;if(!ze.current||!Ze||((je=window.getSelection())==null?void 0:je.toString().length)>0)return;const Sr=ct.clientY-ze.current.y,xr=ct.clientX-ze.current.x;var Or;const er=(Or=e.swipeDirections)!=null?Or:cF(I);!z&&(Math.abs(xr)>1||Math.abs(Sr)>1)&&fe(Math.abs(xr)>Math.abs(Sr)?"x":"y");let Xr={x:0,y:0};const Qs=Un=>1/(1.5+Math.abs(Un)/20);if(z==="y"){if(er.includes("top")||er.includes("bottom"))if(er.includes("top")&&Sr<0||er.includes("bottom")&&Sr>0)Xr.y=Sr;else{const Un=Sr*Qs(Sr);Xr.y=Math.abs(Un)<Math.abs(Sr)?Un:Sr}}else if(z==="x"&&(er.includes("left")||er.includes("right")))if(er.includes("left")&&xr<0||er.includes("right")&&xr>0)Xr.x=xr;else{const Un=xr*Qs(xr);Xr.x=Math.abs(Un)<Math.abs(xr)?Un:xr}(Math.abs(Xr.x)>0||Math.abs(Xr.y)>0)&&H(!0),(He=Ge.current)==null||He.style.setProperty("--swipe-amount-x",`${Xr.x}px`),(pr=Ge.current)==null||pr.style.setProperty("--swipe-amount-y",`${Xr.y}px`)}},et&&!v.jsx&&st!=="loading"?ge.createElement("button",{"aria-label":be,"data-disabled":xa,"data-close-button":!0,onClick:xa||!Ze?()=>{}:()=>{br(),v.onDismiss==null||v.onDismiss.call(v,v)},className:cs(q==null?void 0:q.closeButton,v==null||(a=v.classNames)==null?void 0:a.closeButton)},(Ot=ae==null?void 0:ae.close)!=null?Ot:Y6):null,(st||v.icon||v.promise)&&v.icon!==null&&((ae==null?void 0:ae[st])!==null||v.icon)?ge.createElement("div",{"data-icon":"",className:cs(q==null?void 0:q.icon,v==null||(n=v.classNames)==null?void 0:n.icon)},v.promise||v.type==="loading"&&!v.icon?v.icon||ft():null,v.type!=="loading"?jt:null):null,ge.createElement("div",{"data-content":"",className:cs(q==null?void 0:q.content,v==null||(o=v.classNames)==null?void 0:o.content)},ge.createElement("div",{"data-title":"",className:cs(q==null?void 0:q.title,v==null||(l=v.classNames)==null?void 0:l.title)},v.jsx?v.jsx:typeof v.title=="function"?v.title():v.title),v.description?ge.createElement("div",{"data-description":"",className:cs(re,Xe,q==null?void 0:q.description,v==null||(u=v.classNames)==null?void 0:u.description)},typeof v.description=="function"?v.description():v.description):null),ge.isValidElement(v.cancel)?v.cancel:v.cancel&&g0(v.cancel)?ge.createElement("button",{"data-button":!0,"data-cancel":!0,style:v.cancelButtonStyle||B,onClick:ct=>{g0(v.cancel)&&Ze&&(v.cancel.onClick==null||v.cancel.onClick.call(v.cancel,ct),br())},className:cs(q==null?void 0:q.cancelButton,v==null||(f=v.classNames)==null?void 0:f.cancelButton)},v.cancel.label):null,ge.isValidElement(v.action)?v.action:v.action&&g0(v.action)?ge.createElement("button",{"data-button":!0,"data-action":!0,style:v.actionButtonStyle||j,onClick:ct=>{g0(v.action)&&(v.action.onClick==null||v.action.onClick.call(v.action,ct),!ct.defaultPrevented&&br())},className:cs(q==null?void 0:q.actionButton,v==null||(h=v.classNames)==null?void 0:h.actionButton)},v.action.label):null)};function D_(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function fF(e,t){const r={};return[e,t].forEach((a,n)=>{const o=n===1,l=o?"--mobile-offset":"--offset",u=o?nF:aF;function f(h){["top","right","bottom","left"].forEach(g=>{r[`${l}-${g}`]=typeof h=="number"?`${h}px`:h})}typeof a=="number"||typeof a=="string"?f(a):typeof a=="object"?["top","right","bottom","left"].forEach(h=>{a[h]===void 0?r[`${l}-${h}`]=u:r[`${l}-${h}`]=typeof a[h]=="number"?`${a[h]}px`:a[h]}):f(u)}),r}const dF=ge.forwardRef(function(t,r){const{id:a,invert:n,position:o="bottom-right",hotkey:l=["altKey","KeyT"],expand:u,closeButton:f,className:h,offset:g,mobileOffset:v,theme:p="light",richColors:_,duration:b,style:w,visibleToasts:S=rF,toastOptions:T,dir:N=D_(),gap:k=iF,icons:E,containerAriaLabel:M="Notifications"}=t,[D,A]=ge.useState([]),B=ge.useMemo(()=>a?D.filter(X=>X.toasterId===a):D.filter(X=>!X.toasterId),[D,a]),j=ge.useMemo(()=>Array.from(new Set([o].concat(B.filter(X=>X.position).map(X=>X.position)))),[B,o]),[ee,re]=ge.useState([]),[U,I]=ge.useState(!1),[ne,ie]=ge.useState(!1),[q,ae]=ge.useState(p!=="system"?p:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),be=ge.useRef(null),z=l.join("+").replace(/Key/g,"").replace(/Digit/g,""),fe=ge.useRef(null),De=ge.useRef(!1),P=ge.useCallback(X=>{A(Y=>{var Q;return(Q=Y.find(de=>de.id===X.id))!=null&&Q.delete||qa.dismiss(X.id),Y.filter(({id:de})=>de!==X.id)})},[]);return ge.useEffect(()=>qa.subscribe(X=>{if(X.dismiss){requestAnimationFrame(()=>{A(Y=>Y.map(Q=>Q.id===X.id?{...Q,delete:!0}:Q))});return}setTimeout(()=>{C4.flushSync(()=>{A(Y=>{const Q=Y.findIndex(de=>de.id===X.id);return Q!==-1?[...Y.slice(0,Q),{...Y[Q],...X},...Y.slice(Q+1)]:[X,...Y]})})})}),[D]),ge.useEffect(()=>{if(p!=="system"){ae(p);return}if(p==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ae("dark"):ae("light")),typeof window>"u")return;const X=window.matchMedia("(prefers-color-scheme: dark)");try{X.addEventListener("change",({matches:Y})=>{ae(Y?"dark":"light")})}catch{X.addListener(({matches:Q})=>{try{ae(Q?"dark":"light")}catch(de){console.error(de)}})}},[p]),ge.useEffect(()=>{D.length<=1&&I(!1)},[D]),ge.useEffect(()=>{const X=Y=>{var Q;if(l.every(Te=>Y[Te]||Y.code===Te)){var Fe;I(!0),(Fe=be.current)==null||Fe.focus()}Y.code==="Escape"&&(document.activeElement===be.current||(Q=be.current)!=null&&Q.contains(document.activeElement))&&I(!1)};return document.addEventListener("keydown",X),()=>document.removeEventListener("keydown",X)},[l]),ge.useEffect(()=>{if(be.current)return()=>{fe.current&&(fe.current.focus({preventScroll:!0}),fe.current=null,De.current=!1)}},[be.current]),ge.createElement("section",{ref:r,"aria-label":`${M} ${z}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},j.map((X,Y)=>{var Q;const[de,Fe]=X.split("-");return B.length?ge.createElement("ol",{key:X,dir:N==="auto"?D_():N,tabIndex:-1,ref:be,className:h,"data-sonner-toaster":!0,"data-sonner-theme":q,"data-y-position":de,"data-x-position":Fe,style:{"--front-toast-height":`${((Q=ee[0])==null?void 0:Q.height)||0}px`,"--width":`${sF}px`,"--gap":`${k}px`,...w,...fF(g,v)},onBlur:Te=>{De.current&&!Te.currentTarget.contains(Te.relatedTarget)&&(De.current=!1,fe.current&&(fe.current.focus({preventScroll:!0}),fe.current=null))},onFocus:Te=>{Te.target instanceof HTMLElement&&Te.target.dataset.dismissible==="false"||De.current||(De.current=!0,fe.current=Te.relatedTarget)},onMouseEnter:()=>I(!0),onMouseMove:()=>I(!0),onMouseLeave:()=>{ne||I(!1)},onDragEnd:()=>I(!1),onPointerDown:Te=>{Te.target instanceof HTMLElement&&Te.target.dataset.dismissible==="false"||ie(!0)},onPointerUp:()=>ie(!1)},B.filter(Te=>!Te.position&&Y===0||Te.position===X).map((Te,Oe)=>{var Re,Je;return ge.createElement(uF,{key:Te.id,icons:E,index:Oe,toast:Te,defaultRichColors:_,duration:(Re=T==null?void 0:T.duration)!=null?Re:b,className:T==null?void 0:T.className,descriptionClassName:T==null?void 0:T.descriptionClassName,invert:n,visibleToasts:S,closeButton:(Je=T==null?void 0:T.closeButton)!=null?Je:f,interacting:ne,position:X,style:T==null?void 0:T.style,unstyled:T==null?void 0:T.unstyled,classNames:T==null?void 0:T.classNames,cancelButtonStyle:T==null?void 0:T.cancelButtonStyle,actionButtonStyle:T==null?void 0:T.actionButtonStyle,closeButtonAriaLabel:T==null?void 0:T.closeButtonAriaLabel,removeToast:P,toasts:B.filter(H=>H.position==Te.position),heights:ee.filter(H=>H.position==Te.position),setHeights:re,expandByDefault:u,gap:k,expanded:U,swipeDirections:t.swipeDirections})})):null}))}),hF=["#18442b","#2e6b4d","#4a9170","#70b896","#9cdebd","#c4f0da"],mF=["#3fedef","#2cb5b8","#1e8285","#135457","#0a2e30","#000000"];function gF(){const{filters:e}=Bu(),{user:t}=jn(),[r,a]=K.useState(!0),[n,o]=K.useState({totalValue:0,totalReturns:0,avgTicket:0,slaBreach:0,totalProducts:0}),[l,u]=K.useState([]),[f,h]=K.useState([]),[g,v]=K.useState([]),[p,_]=K.useState([]),[b,w]=K.useState([]),[S,T]=K.useState([]),[N,k]=K.useState([]),[E,M]=K.useState([]),[D,A]=K.useState([]),[B,j]=K.useState([]),[ee,re]=K.useState(!1);K.useEffect(()=>{const ne=()=>{re(document.documentElement.classList.contains("dark"))};ne();const ie=new MutationObserver(ne);return ie.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>ie.disconnect()},[]);const U=ee?mF:hF;K.useEffect(()=>{I()},[e]);const I=async()=>{a(!0);const ne=(t==null?void 0:t.role)==="VENDEDOR"?t.vendedor:null;let ie=ot.from("devolucoes").select(`
        *,
        motivos_devolucao(nome),
        setores(nome),
        itens:itens_devolucao(quantidade, descricao, motivo_id)
    `);t&&t.role==="VENDEDOR"&&ne&&(ie=ie.eq("vendedor",ne),console.log(" Dashboard - Filtrando por vendedor:",ne));const q=e.period&&!e.startDate&&!e.endDate?ig(e.period):{},ae=e.startDate||q.startDate,be=e.endDate||q.endDate;e.search&&(ie=ie.or(`nome_cliente.ilike.%${e.search}%,vendedor.ilike.%${e.search}%,numero.ilike.%${e.search}%`)),e.resultado&&e.resultado.length>0&&(ie=ie.in("resultado",e.resultado)),e.motivo&&e.motivo.length>0&&(ie=ie.in("motivo_id",e.motivo)),e.cliente&&e.cliente.length>0&&(ie=ie.in("nome_cliente",e.cliente)),e.vendedor&&e.vendedor.length>0&&(ie=ie.in("vendedor",e.vendedor)),e.setor&&e.setor.length>0&&(ie=ie.in("setor_id",e.setor)),ae&&(ie=ie.gte("data_emissao",ae.toISOString().split("T")[0])),be&&(ie=ie.lte("data_emissao",be.toISOString().split("T")[0]));const{data:z,error:fe}=await ie;if(fe){console.error(" Erro ao buscar dados do Dashboard:",fe),Ke.error("Erro ao carregar dados do Dashboard: "+fe.message),a(!1);return}if(!z||z.length===0){console.log(" Nenhuma devoluo encontrada para os filtros selecionados"),o({totalValue:0,totalReturns:0,avgTicket:0,slaBreach:0,totalProducts:0}),u([]),h([]),v([]),_([]),k([]),M([]),A([]),j([]),w([]),T([]),a(!1);return}if(z){console.log(` Dashboard: ${z.length} devolues carregadas`);const De=z.reduce((ke,ye)=>ke+(Number(ye.valor_total_nota)||0),0),P=z.length,X=P>0?De/P:0,Y=z.reduce((ke,ye)=>{const xe=ye.itens||[];return ke+xe.reduce((ze,xt)=>ze+(Number(xt.quantidade)||0),0)},0);o({totalValue:De,totalReturns:P,avgTicket:X,slaBreach:0,totalProducts:Y});const Q=z.reduce((ke,ye)=>{const xe=new Date(ye.data_emissao||ye.created_at),ze=ir(xe,"dd/MM",{locale:da});return ke[ze]=(ke[ze]||0)+(Number(ye.valor_total_nota)||0),ke},{}),de=Object.keys(Q).sort((ke,ye)=>{const xe=new Date(ke.split("/").reverse().join("-")),ze=new Date(ye.split("/").reverse().join("-"));return xe.getTime()-ze.getTime()}).map(ke=>({name:ke,value:Q[ke]}));u(de);const Fe=z.reduce((ke,ye)=>{const xe=ye.nome_cliente||"Desconhecido",ze=Number(ye.valor_total_nota)||0;return ke[xe]=(ke[xe]||0)+ze,ke},{}),Te=Object.entries(Fe).map(([ke,ye])=>({name:ke,value:ye})).sort((ke,ye)=>ye.value-ke.value).slice(0,5);h(Te);const Oe=z.reduce((ke,ye)=>{const xe=ye.vendedor||"Desconhecido",ze=Number(ye.valor_total_nota)||0;return ke[xe]=(ke[xe]||0)+ze,ke},{}),Re=Object.entries(Oe).map(([ke,ye])=>({name:ke,value:ye})).sort((ke,ye)=>ye.value-ke.value).slice(0,5);v(Re);const Je=z.reduce((ke,ye)=>{let xe=ye.rede||"Sem rede";xe==="Sem rede"&&ye.cnpj_destinatario&&(xe=ye.rede||"Sem rede");const ze=Number(ye.valor_total_nota)||0;return ke[xe]=(ke[xe]||0)+ze,ke},{}),H=Object.entries(Je).map(([ke,ye])=>({name:ke,value:ye})).sort((ke,ye)=>ye.value-ke.value).slice(0,5);_(H);const O=Object.entries(Fe).map(([ke,ye])=>({name:ke,value:ye})).sort((ke,ye)=>ye.value-ke.value);let Ae=0;const Pe=O.reduce((ke,ye)=>ke+ye.value,0),Se=O.map((ke,ye)=>(Ae+=ke.value,{name:ke.name.length>15?ke.name.substring(0,15)+"...":ke.name,value:ke.value,cumulative:Ae,percentage:Ae/Pe*100,index:ye+1})).slice(0,10);k(Se);const Z={};z.forEach(ke=>{(ke.itens||[]).forEach(xe=>{var lr,Nr;const ze=xe.descricao||"Desconhecido",xt=((lr=xe.motivo_item)==null?void 0:lr.nome)||((Nr=ke.motivos_devolucao)==null?void 0:Nr.nome)||"No informado";Z[ze]||(Z[ze]={});const qt=Number(xe.valor_total_bruto)||0;Z[ze][xt]=(Z[ze][xt]||0)+qt})});const le=Object.keys(Z).slice(0,10),Ge=new Set;z.forEach(ke=>{var xe;(ke.itens||[]).forEach(ze=>{var xt;(xt=ze.motivo_item)!=null&&xt.nome&&Ge.add(ze.motivo_item.nome)}),(xe=ke.motivos_devolucao)!=null&&xe.nome&&Ge.add(ke.motivos_devolucao.nome)});const kt=Array.from(Ge).slice(0,8),nt=le.map(ke=>{const ye={produto:ke};return kt.forEach(xe=>{var ze;ye[xe]=((ze=Z[ke])==null?void 0:ze[xe])||0}),ye});M(nt);const st=[];if(Te.length>0){const ke=Te[0].value/De*100;ke>20&&st.push(` Cliente "${Te[0].name}" concentra ${ke.toFixed(1)}% do valor total de devolues.`)}if(Y>0&&P>0){const ke=Y/P;st.push(` Mdia de ${ke.toFixed(1)} produtos por devoluo.`)}Re.length>0&&st.push(` Vendedor "${Re[0].name}" lidera em devolues com R$ ${Re[0].value.toLocaleString("pt-BR")}.`);const Ze=Se.findIndex(ke=>ke.percentage>=80);Ze>=0&&Ze<5&&st.push(` Regra 80/20: ${Ze+1} clientes concentram 80% do valor de devolues.`),A(st);const Ee=[];if(Y>0&&P>0){const ke=Y/P;z.forEach(ye=>{const ze=(ye.itens||[]).reduce((xt,qt)=>xt+(Number(qt.quantidade)||0),0);ze>ke*1.5&&Ee.push({type:"warning",message:`Nota ${ye.numero} tem ${ze} produtos (acima da mdia de ${ke.toFixed(1)})`,cliente:ye.nome_cliente})})}j(Ee.slice(0,5));const Xe=z.reduce((ke,ye)=>{const xe=ye.motivos_devolucao,ze=typeof xe=="object"&&(xe!=null&&xe.nome)?xe.nome:typeof xe=="string"?xe:"No informado";return ke[ze]=(ke[ze]||0)+1,ke},{}),Qe=Object.entries(Xe).map(([ke,ye])=>({name:ke,value:ye})).sort((ke,ye)=>ye.value-ke.value).slice(0,5);w(Qe);const et=z.reduce((ke,ye)=>{const xe=ye.uf_origem||"N/A";return ke[xe]=(ke[xe]||0)+(Number(ye.valor_total_nota)||0),ke},{}),rt=Object.entries(et).map(([ke,ye])=>({name:ke,value:ye})).sort((ke,ye)=>ye.value-ke.value).slice(0,6);T(rt)}a(!1)};return r?m.jsx("div",{className:"flex items-center justify-center min-h-screen",children:m.jsx(Do,{className:"h-8 w-8 animate-spin text-primary"})}):m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Dashboard"}),m.jsxs(Dt,{variant:"outline",size:"sm",onClick:I,children:[m.jsx(b2,{className:"mr-2 h-4 w-4"}),"Atualizar"]})]}),m.jsx(nd,{}),B.length>0&&m.jsxs(Vt,{className:"border-orange-500 bg-orange-50 dark:bg-orange-950/20",children:[m.jsx(Ht,{children:m.jsxs($t,{className:"flex items-center gap-2 text-orange-700 dark:text-orange-400",children:[m.jsx(n1,{className:"h-5 w-5"}),"Alertas (",B.length,")"]})}),m.jsx(Wt,{children:m.jsx("div",{className:"space-y-2",children:B.map((ne,ie)=>m.jsxs("div",{className:"text-sm text-orange-800 dark:text-orange-300",children:[" ",ne.message]},ie))})})]}),m.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[m.jsx(Kc,{title:"Valor Total Devolvido",value:`R$ ${n.totalValue.toLocaleString("pt-BR",{maximumFractionDigits:0})}`,icon:sN,trend:"up",trendValue:"vs perodo anterior"}),m.jsx(Kc,{title:"Total de Devolues",value:n.totalReturns,icon:jN,description:"Neste perodo"}),m.jsx(Kc,{title:"Produtos Devolvidos",value:n.totalProducts,icon:$y,description:"Quantidade total"}),m.jsx(Kc,{title:"Ticket Mdio",value:`R$ ${n.avgTicket.toLocaleString("pt-BR",{maximumFractionDigits:0})}`,icon:S2}),m.jsx(Kc,{title:"Fora do SLA",value:n.slaBreach,icon:n1,description:"Devolues atrasadas",trend:"down",trendValue:"0"})]}),m.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-7",children:[m.jsxs(Vt,{className:"col-span-4",children:[m.jsx(Ht,{children:m.jsx($t,{children:"Evoluo no Tempo"})}),m.jsx(Wt,{className:"pl-2",children:m.jsx(co,{width:"100%",height:350,children:m.jsxs(M4,{data:l,children:[m.jsx("defs",{children:m.jsxs("linearGradient",{id:"colorValue",x1:"0",y1:"0",x2:"0",y2:"1",children:[m.jsx("stop",{offset:"5%",stopColor:U[0],stopOpacity:.8}),m.jsx("stop",{offset:"95%",stopColor:U[0],stopOpacity:0})]})}),m.jsx(Nl,{strokeDasharray:"3 3",className:"stroke-muted/30"}),m.jsx(Dl,{dataKey:"name",className:"text-xs"}),m.jsx(ki,{className:"text-xs",tickFormatter:ne=>`R$${ne}`}),m.jsx(uo,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)",color:"var(--foreground)"},formatter:ne=>[`R$ ${(ne||0).toFixed(2)}`,"Valor"]}),m.jsx(j4,{type:"monotone",dataKey:"value",stroke:U[0],fillOpacity:1,fill:"url(#colorValue)"})]})})})]}),m.jsxs(Vt,{className:"col-span-3",children:[m.jsx(Ht,{children:m.jsx($t,{children:"Top Clientes (Valor)"})}),m.jsx(Wt,{children:m.jsx(co,{width:"100%",height:350,children:m.jsxs(pm,{data:f,children:[m.jsx(Nl,{strokeDasharray:"3 3",className:"stroke-muted/30"}),m.jsx(Dl,{dataKey:"name",className:"text-xs",angle:-45,textAnchor:"end",height:80}),m.jsx(ki,{className:"text-xs",tickFormatter:ne=>`R$${ne}`}),m.jsx(uo,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)",color:"var(--foreground)"},formatter:ne=>[`R$ ${(ne||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`,"Valor"]}),m.jsx(u0,{dataKey:"value",fill:U[0],radius:[8,8,0,0]})]})})})]})]}),m.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[m.jsxs(Vt,{children:[m.jsx(Ht,{children:m.jsx($t,{children:"Top Vendedores (Valor)"})}),m.jsx(Wt,{children:m.jsx(co,{width:"100%",height:300,children:m.jsxs(pm,{data:g,children:[m.jsx(Nl,{strokeDasharray:"3 3",className:"stroke-muted/30"}),m.jsx(Dl,{dataKey:"name",className:"text-xs",angle:-45,textAnchor:"end",height:80}),m.jsx(ki,{className:"text-xs",tickFormatter:ne=>`R$${ne}`}),m.jsx(uo,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)",color:"var(--foreground)"},formatter:ne=>[`R$ ${(ne||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`,"Valor"]}),m.jsx(u0,{dataKey:"value",fill:U[1],radius:[8,8,0,0]})]})})})]}),m.jsxs(Vt,{children:[m.jsx(Ht,{children:m.jsx($t,{children:"Top Redes (Valor)"})}),m.jsx(Wt,{children:m.jsx(co,{width:"100%",height:300,children:m.jsxs(pm,{data:p,children:[m.jsx(Nl,{strokeDasharray:"3 3",className:"stroke-muted/30"}),m.jsx(Dl,{dataKey:"name",className:"text-xs",angle:-45,textAnchor:"end",height:80}),m.jsx(ki,{className:"text-xs",tickFormatter:ne=>`R$${ne}`}),m.jsx(uo,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)",color:"var(--foreground)"},formatter:ne=>[`R$ ${(ne||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`,"Valor"]}),m.jsx(u0,{dataKey:"value",fill:U[2],radius:[8,8,0,0]})]})})})]})]}),m.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[m.jsxs(Vt,{children:[m.jsx(Ht,{children:m.jsx($t,{children:"Anlise de Pareto (80/20)"})}),m.jsxs(Wt,{children:[m.jsx(co,{width:"100%",height:350,children:m.jsxs(I4,{data:N,children:[m.jsx(Nl,{strokeDasharray:"3 3",className:"stroke-muted/30"}),m.jsx(Dl,{dataKey:"name",className:"text-xs",angle:-45,textAnchor:"end",height:80}),m.jsx(ki,{yAxisId:"left",className:"text-xs",tickFormatter:ne=>`R$${ne}`}),m.jsx(ki,{yAxisId:"right",orientation:"right",className:"text-xs",tickFormatter:ne=>`${ne}%`}),m.jsx(uo,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)",color:"var(--foreground)"},formatter:(ne,ie)=>{const q=ne||0,ae=ie||"";return ae==="value"?[`R$ ${q.toLocaleString("pt-BR",{maximumFractionDigits:0})}`,"Valor"]:ae==="percentage"?[`${q.toFixed(1)}%`,"Acumulado"]:[q,ae]}}),m.jsx(u0,{yAxisId:"left",dataKey:"value",fill:U[0],radius:[8,8,0,0]}),m.jsx(t1,{yAxisId:"right",type:"monotone",dataKey:"percentage",stroke:U[3],strokeWidth:2})]})}),m.jsx("div",{className:"mt-4 text-xs text-muted-foreground",children:"Linha mostra o percentual acumulado. A regra 80/20 indica que poucos clientes concentram a maioria do valor."})]})]}),m.jsxs(Vt,{children:[m.jsx(Ht,{children:m.jsx($t,{children:"Insights Automticos"})}),m.jsx(Wt,{children:m.jsx("div",{className:"space-y-3",children:D.length>0?D.map((ne,ie)=>m.jsx("div",{className:"p-3 bg-muted/50 rounded-lg text-sm",children:ne},ie)):m.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum insight disponvel no momento."})})})]})]}),E.length>0&&m.jsxs(Vt,{children:[m.jsx(Ht,{children:m.jsx($t,{children:"Heatmap: Produto  Motivo"})}),m.jsx(Wt,{children:m.jsx("div",{className:"overflow-x-auto",children:m.jsxs("table",{className:"w-full text-xs border-collapse",children:[m.jsx("thead",{children:m.jsxs("tr",{children:[m.jsx("th",{className:"border p-2 text-left bg-muted text-xs",children:"Produto"}),E[0]&&Object.keys(E[0]).filter(ne=>ne!=="produto").map(ne=>m.jsx("th",{className:"border p-2 bg-muted text-xs",children:ne.length>15?ne.substring(0,15)+"...":ne},ne))]})}),m.jsx("tbody",{children:E.map((ne,ie)=>m.jsxs("tr",{children:[m.jsx("td",{className:"border p-2 font-medium text-xs",children:ne.produto.length>20?ne.produto.substring(0,20)+"...":ne.produto}),Object.keys(ne).filter(q=>q!=="produto").map(q=>{const ae=ne[q]||0,be=Math.max(...E.map(fe=>Math.max(...Object.keys(fe).filter(De=>De!=="produto").map(De=>fe[De]||0)))),z=be>0?ae/be*100:0;return m.jsx("td",{className:"border p-2 text-center text-xs",style:{backgroundColor:z>0?`rgba(7, 62, 41, ${z/100})`:"transparent",color:z>50?"white":"inherit"},title:`R$ ${ae.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,children:ae>0?`R$ ${ae.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`:"-"},q)})]},ie))})]})})})]}),m.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[m.jsxs(Vt,{className:"col-span-1",children:[m.jsx(Ht,{children:m.jsx($t,{className:"text-base",children:"Principais Motivos"})}),m.jsx(Wt,{children:m.jsx("div",{className:"h-[250px]",children:m.jsx(co,{width:"100%",height:"100%",children:m.jsxs(P4,{children:[m.jsx(L4,{data:b,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:b.map((ne,ie)=>m.jsx(B4,{fill:U[ie%U.length]},`cell-${ie}`))}),m.jsx(uo,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)"}}),m.jsx(n2,{verticalAlign:"bottom",height:36,iconType:"circle"})]})})})})]}),m.jsxs(Vt,{className:"col-span-1",children:[m.jsx(Ht,{children:m.jsx($t,{className:"text-base",children:"Distribuio por Estado"})}),m.jsx(Wt,{children:m.jsx("div",{className:"space-y-4",children:S.map((ne,ie)=>m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(EN,{className:"h-4 w-4 text-muted-foreground"}),m.jsx("span",{className:"text-sm font-medium",children:ne.name})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"h-2 bg-muted rounded-full w-24 overflow-hidden",children:m.jsx("div",{className:"h-full bg-primary",style:{width:`${ne.value/(n.totalValue||1)*100}%`}})}),m.jsxs("span",{className:"text-xs text-muted-foreground",children:[(ne.value/(n.totalValue||1)*100).toFixed(0),"%"]})]})]},ie))})})]}),m.jsxs(Vt,{className:"col-span-1",children:[m.jsx(Ht,{children:m.jsx($t,{className:"text-base",children:"Produtos Crticos"})}),m.jsx(Wt,{children:m.jsxs("div",{className:"flex flex-col items-center justify-center h-[250px] text-muted-foreground text-center p-4",children:[m.jsx($y,{className:"h-10 w-10 mb-2 opacity-20"}),m.jsx("p",{className:"text-sm",children:"Importe dados detalhados para visualizar o ranking de produtos."})]})})]})]})]})}var xF=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],vF=xF.reduce((e,t)=>{const r=B1(`Primitive.${t}`),a=K.forwardRef((n,o)=>{const{asChild:l,...u}=n,f=l?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),m.jsx(f,{...u,ref:o})});return a.displayName=`Primitive.${t}`,{...e,[t]:a}},{}),pF="Label",zb=K.forwardRef((e,t)=>m.jsx(vF.label,{...e,ref:t,onMouseDown:r=>{var n;r.target.closest("button, input, select, textarea")||((n=e.onMouseDown)==null||n.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));zb.displayName=pF;var Vb=zb;const yF=K0("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Zr=K.forwardRef(({className:e,...t},r)=>m.jsx(Vb,{ref:r,className:Ye(yF(),e),...t}));Zr.displayName=Vb.displayName;const _F=K0("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Hb=K.forwardRef(({className:e,variant:t,...r},a)=>m.jsx("div",{ref:a,role:"alert",className:Ye(_F({variant:t}),e),...r}));Hb.displayName="Alert";const $b=K.forwardRef(({className:e,...t},r)=>m.jsx("div",{ref:r,className:Ye("text-sm [&_p]:leading-relaxed",e),...t}));$b.displayName="AlertDescription";const wF=K.forwardRef(({className:e,...t},r)=>m.jsx("h5",{ref:r,className:Ye("mb-1 font-medium leading-none tracking-tight",e),...t}));wF.displayName="AlertTitle";function bF(){const[e,t]=K.useState(""),[r,a]=K.useState(""),[n,o]=K.useState(""),[l,u]=K.useState(!0),[f,h]=K.useState(!1),[g,v]=K.useState(null),p=N4();K.useEffect(()=>{(async()=>{const{data:{session:w}}=await ot.auth.getSession();w!=null&&w.user&&p("/dashboard")})()},[p]);const _=async b=>{b.preventDefault(),h(!0),v(null);const w=e.trim();try{if(l){const{data:S,error:T}=await ot.auth.signInWithPassword({email:w,password:r});if(T)throw T;S.user&&(console.log(" Login bem-sucedido!"),Ke.success("Login realizado com sucesso!"),h(!1),setTimeout(()=>{p("/dashboard")},300))}else{const{data:S,error:T}=await ot.auth.signUp({email:w,password:r,options:{data:{name:n,role:"ADMIN"}}});if(T)throw T;S.user&&(Ke.success("Conta criada com sucesso! Voc j pode entrar."),S.session?p("/dashboard"):u(!0))}}catch(S){console.error(S);let T=S.message;T.includes("Invalid login credentials")?T="Usurio no encontrado ou senha incorreta.":T.includes("User already registered")&&(T="Este email j est cadastrado. Tente fazer login."),v(T),Ke.error("Erro de Autenticao")}finally{h(!1)}};return m.jsxs("div",{className:"flex items-center justify-center min-h-screen bg-background relative overflow-hidden",children:[m.jsx("div",{className:"absolute top-0 left-0 w-full h-1/2 bg-primary/10 -skew-y-3 origin-top-left z-0"}),m.jsxs(Vt,{className:"w-full max-w-md z-10 border-t-4 border-t-primary shadow-2xl bg-card",children:[m.jsxs(Ht,{className:"text-center pb-2",children:[m.jsx("div",{className:"mx-auto mb-6 flex items-center justify-center",children:m.jsx("div",{className:"h-32 w-32 relative flex items-center justify-center bg-white rounded-full shadow-md p-3",children:m.jsx("img",{src:"https://i.ibb.co/b095hpJ/Chat-GPT-Image-25-de-dez-de-2025-15-24-45.png",alt:"Logo Doce Mel",className:"object-contain h-full w-full"})})}),m.jsx("h1",{className:"text-2xl font-bold text-primary font-serif tracking-wide",children:"GRUPO DOCE MEL"}),m.jsx($t,{className:"text-lg font-medium text-foreground/80",children:"Gesto de Devolues"}),m.jsx(cn,{children:l?"Entre com suas credenciais.":"Crie sua conta de Administrador."})]}),m.jsxs("form",{onSubmit:_,children:[m.jsxs(Wt,{className:"space-y-4",children:[g&&m.jsxs(Hb,{variant:"destructive",children:[m.jsx(_2,{className:"h-4 w-4"}),m.jsx($b,{children:g})]}),!l&&m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{htmlFor:"name",children:"Nome Completo"}),m.jsx(Gr,{id:"name",placeholder:"Ex: Obedys",value:n,onChange:b=>o(b.target.value),required:!l})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{htmlFor:"email",children:"Email"}),m.jsx(Gr,{id:"email",type:"email",placeholder:"email@exemplo.com",value:e,onChange:b=>t(b.target.value),required:!0})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{htmlFor:"password",children:"Senha"}),m.jsx(Gr,{id:"password",type:"password",value:r,onChange:b=>a(b.target.value),required:!0})]})]}),m.jsxs(f2,{className:"flex flex-col gap-4 bg-muted/20 pt-6",children:[m.jsxs(Dt,{type:"submit",className:"w-full font-bold text-md h-11",disabled:f,children:[f&&m.jsx(Do,{className:"mr-2 h-4 w-4 animate-spin"}),l?"ENTRAR":"CRIAR CONTA"]}),m.jsx(Dt,{type:"button",variant:"link",onClick:()=>{u(!l),v(null)},children:l?"No possui acesso? Solicite aqui":"J possui conta? Voltar ao login"})]})]})]}),m.jsx("div",{className:"absolute bottom-4 text-center text-xs text-muted-foreground opacity-50",children:" 2025 Grupo Doce Mel."})]})}const Jn=K.forwardRef(({className:e,...t},r)=>m.jsx("div",{className:"relative w-full overflow-auto",children:m.jsx("table",{ref:r,className:Ye("w-full caption-bottom text-sm",e),...t})}));Jn.displayName="Table";const vs=K.forwardRef(({className:e,...t},r)=>m.jsx("thead",{ref:r,className:Ye("[&_tr]:border-b",e),...t}));vs.displayName="TableHeader";const Qn=K.forwardRef(({className:e,...t},r)=>m.jsx("tbody",{ref:r,className:Ye("[&_tr:last-child]:border-0",e),...t}));Qn.displayName="TableBody";const SF=K.forwardRef(({className:e,...t},r)=>m.jsx("tfoot",{ref:r,className:Ye("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));SF.displayName="TableFooter";const Tr=K.forwardRef(({className:e,...t},r)=>m.jsx("tr",{ref:r,className:Ye("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));Tr.displayName="TableRow";const gt=K.forwardRef(({className:e,...t},r)=>m.jsx("th",{ref:r,className:Ye("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));gt.displayName="TableHead";const At=K.forwardRef(({className:e,...t},r)=>m.jsx("td",{ref:r,className:Ye("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));At.displayName="TableCell";const EF=K.forwardRef(({className:e,...t},r)=>m.jsx("caption",{ref:r,className:Ye("mt-4 text-sm text-muted-foreground",e),...t}));EF.displayName="TableCaption";/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var M0={};M0.version="0.18.5";var Wb=1252,TF=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],og={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},lg=function(e){TF.indexOf(e)!=-1&&(Wb=og[0]=e)};function kF(){lg(1252)}var es=function(e){lg(e)};function cg(){es(1200),kF()}function O_(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function AF(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Gb(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var tu=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?AF(e.slice(2)):t==254&&r==255?Gb(e.slice(2)):t==65279?e.slice(1):e},x0=function(t){return String.fromCharCode(t)},R_=function(t){return String.fromCharCode(t)},Eu,Di="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Tu(e){for(var t="",r=0,a=0,n=0,o=0,l=0,u=0,f=0,h=0;h<e.length;)r=e.charCodeAt(h++),o=r>>2,a=e.charCodeAt(h++),l=(r&3)<<4|a>>4,n=e.charCodeAt(h++),u=(a&15)<<2|n>>6,f=n&63,isNaN(a)?u=f=64:isNaN(n)&&(f=64),t+=Di.charAt(o)+Di.charAt(l)+Di.charAt(u)+Di.charAt(f);return t}function vn(e){var t="",r=0,a=0,n=0,o=0,l=0,u=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)o=Di.indexOf(e.charAt(h++)),l=Di.indexOf(e.charAt(h++)),r=o<<2|l>>4,t+=String.fromCharCode(r),u=Di.indexOf(e.charAt(h++)),a=(l&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(a)),f=Di.indexOf(e.charAt(h++)),n=(u&3)<<6|f,f!==64&&(t+=String.fromCharCode(n));return t}var Pt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Xs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ii(e){return Pt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function F_(e){return Pt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var mn=function(t){return Pt?Xs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function sd(e){if(typeof ArrayBuffer>"u")return mn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function zi(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function CF(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function ug(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ug(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ma=Pt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Xs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function NF(e){for(var t=[],r=0,a=e.length+250,n=Ii(e.length+255),o=0;o<e.length;++o){var l=e.charCodeAt(o);if(l<128)n[r++]=l;else if(l<2048)n[r++]=192|l>>6&31,n[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=e.charCodeAt(++o)&1023;n[r++]=240|l>>8&7,n[r++]=128|l>>2&63,n[r++]=128|u>>6&15|(l&3)<<4,n[r++]=128|u&63}else n[r++]=224|l>>12&15,n[r++]=128|l>>6&63,n[r++]=128|l&63;r>a&&(t.push(n.slice(0,r)),r=0,n=Ii(65535),a=65530)}return t.push(n.slice(0,r)),ma(t)}var Va=/\u0000/g,ru=/[\u0001-\u0006]/g;function zl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ts(e,t){var r=""+e;return r.length>=t?r:Ur("0",t-r.length)+r}function fg(e,t){var r=""+e;return r.length>=t?r:Ur(" ",t-r.length)+r}function j0(e,t){var r=""+e;return r.length>=t?r:r+Ur(" ",t-r.length)}function DF(e,t){var r=""+Math.round(e);return r.length>=t?r:Ur("0",t-r.length)+r}function OF(e,t){var r=""+e;return r.length>=t?r:Ur("0",t-r.length)+r}var M_=Math.pow(2,32);function El(e,t){if(e>M_||e<-M_)return DF(e,t);var r=Math.round(e);return OF(r,t)}function I0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var j_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Lm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function RF(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var wt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},I_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},FF={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function P0(e,t,r){for(var a=e<0?-1:1,n=e*a,o=0,l=1,u=0,f=1,h=0,g=0,v=Math.floor(n);h<t&&(v=Math.floor(n),u=v*l+o,g=v*h+f,!(n-v<5e-8));)n=1/(n-v),o=l,l=u,f=h,h=g;if(g>t&&(h>t?(g=f,u=o):(g=h,u=l)),!r)return[0,a*u,g];var p=Math.floor(a*u/g);return[p,a*u-p*g,g]}function yo(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),o=0,l=[],u={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(a+=1462),u.u>.9999&&(u.u=0,++n==86400&&(u.T=n=0,++a,++u.D)),a===60)l=r?[1317,10,29]:[1900,2,29],o=3;else if(a===0)l=r?[1317,8,29]:[1900,1,0],o=6;else{a>60&&--a;var f=new Date(1900,0,1);f.setDate(f.getDate()+a-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],o=f.getDay(),a<60&&(o=(o+6)%7),r&&(o=BF(f,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=n%60,n=Math.floor(n/60),u.M=n%60,n=Math.floor(n/60),u.H=n,u.q=o,u}var qb=new Date(1899,11,31,0,0,0),MF=qb.getTime(),jF=new Date(1900,2,1,0,0,0);function Yb(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=jF&&(r+=24*60*60*1e3),(r-(MF+(e.getTimezoneOffset()-qb.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function dg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function IF(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function PF(e){var t=e<0?12:11,r=dg(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function LF(e){var t=dg(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ku(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=PF(e):t===10?r=e.toFixed(10).substr(0,12):r=LF(e),dg(IF(r.toUpperCase()))}function Eo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ku(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Pn(14,Yb(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function BF(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function UF(e,t,r,a){var n="",o=0,l=0,u=r.y,f,h=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:f=u%100,h=2;break;default:f=u%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:f=r.m,h=t.length;break;case 3:return Lm[r.m-1][1];case 5:return Lm[r.m-1][0];default:return Lm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:f=r.d,h=t.length;break;case 3:return j_[r.q][0];default:return j_[r.q][1]}break;case 104:switch(t.length){case 1:case 2:f=1+(r.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:f=r.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:f=r.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ts(r.S,t.length):(a>=2?l=a===3?1e3:100:l=a===1?10:1,o=Math.round(l*(r.S+r.u)),o>=60*l&&(o=0),t==="s"?o===0?"0":""+o/l:(n=ts(o,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:f=u,h=1;break}var g=h>0?ts(f,h):"";return g}function Oi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var Xb=/%/g;function zF(e,t,r){var a=t.replace(Xb,""),n=t.length-a.length;return $s(e,a,r*Math.pow(10,2*n))+Ur("%",n)}function VF(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return $s(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function Kb(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Kb(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%n;if(o<0&&(o+=n),r=(t/Math.pow(10,o)).toPrecision(a+1+(n+o)%n),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,h,g){return f+h+g.substr(0,(n+o)%n)+"."+g.substr(o)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Jb=/# (\?+)( ?)\/( ?)(\d+)/;function HF(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),o=Math.floor(n/a),l=n-o*a,u=a;return r+(o===0?"":""+o)+" "+(l===0?Ur(" ",e[1].length+1+e[4].length):fg(l,e[1].length)+e[2]+"/"+e[3]+ts(u,e[4].length))}function $F(e,t,r){return r+(t===0?"":""+t)+Ur(" ",e[1].length+2+e[4].length)}var Qb=/^#*0*\.([0#]+)/,Zb=/\).*[0#]/,eS=/\(###\) ###\\?-####/;function Ua(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function P_(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function L_(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function WF(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function GF(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Nn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Zb)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Nn("n",a,r):"("+Nn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return VF(e,t,r);if(t.indexOf("%")!==-1)return zF(e,t,r);if(t.indexOf("E")!==-1)return Kb(t,r);if(t.charCodeAt(0)===36)return"$"+Nn(e,t.substr(t.charAt(1)==" "?2:1),r);var n,o,l,u,f=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+El(f,t.length);if(t.match(/^[#?]+$/))return n=El(r,0),n==="0"&&(n=""),n.length>t.length?n:Ua(t.substr(0,t.length-n.length))+n;if(o=t.match(Jb))return HF(o,f,h);if(t.match(/^#+0+$/))return h+El(f,t.length-t.indexOf("0"));if(o=t.match(Qb))return n=P_(r,o[1].length).replace(/^([^\.]+)$/,"$1."+Ua(o[1])).replace(/\.$/,"."+Ua(o[1])).replace(/\.(\d*)$/,function(b,w){return"."+w+Ur("0",Ua(o[1]).length-w.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return h+P_(f,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return h+Oi(El(f,0));if(o=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Nn(e,t,-r):Oi(""+(Math.floor(r)+WF(r,o[1].length)))+"."+ts(L_(r,o[1].length),o[1].length);if(o=t.match(/^#,#*,#0/))return Nn(e,t.replace(/^#,#*,/,""),r);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=zl(Nn(e,t.replace(/[\\-]/g,""),r)),l=0,zl(zl(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return l<n.length?n.charAt(l++):b==="0"?"0":""}));if(t.match(eS))return n=Nn(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var g="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=P0(f,Math.pow(10,l)-1,!1),n=""+h,g=$s("n",o[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),n+=g+o[2]+"/"+o[3],g=j0(u[2],l),g.length<o[4].length&&(g=Ua(o[4].substr(o[4].length-g.length))+g),n+=g,n;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=P0(f,Math.pow(10,l)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?fg(u[1],l)+o[2]+"/"+o[3]+j0(u[2],l):Ur(" ",2*l+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return n=El(r,0),t.length<=n.length?n:Ua(t.substr(0,t.length-n.length))+n;if(o=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var v=t.indexOf(".")-l,p=t.length-n.length-v;return Ua(t.substr(0,v)+n+t.substr(t.length-p))}if(o=t.match(/^00,000\.([#0]*0)$/))return l=L_(r,o[1].length),r<0?"-"+Nn(e,t,-r):Oi(GF(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?ts(0,3-b.length):"")+b})+"."+ts(l,o[1].length);switch(t){case"###,##0.00":return Nn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var _=Oi(El(f,0));return _!=="0"?h+_:"";case"###,###.00":return Nn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Nn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function qF(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return $s(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function YF(e,t,r){var a=t.replace(Xb,""),n=t.length-a.length;return $s(e,a,r*Math.pow(10,2*n))+Ur("%",n)}function tS(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+tS(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%n;if(o<0&&(o+=n),r=(t/Math.pow(10,o)).toPrecision(a+1+(n+o)%n),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,h,g){return f+h+g.substr(0,(n+o)%n)+"."+g.substr(o)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function fs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Zb)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?fs("n",a,r):"("+fs("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return qF(e,t,r);if(t.indexOf("%")!==-1)return YF(e,t,r);if(t.indexOf("E")!==-1)return tS(t,r);if(t.charCodeAt(0)===36)return"$"+fs(e,t.substr(t.charAt(1)==" "?2:1),r);var n,o,l,u,f=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+ts(f,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:Ua(t.substr(0,t.length-n.length))+n;if(o=t.match(Jb))return $F(o,f,h);if(t.match(/^#+0+$/))return h+ts(f,t.length-t.indexOf("0"));if(o=t.match(Qb))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Ua(o[1])).replace(/\.$/,"."+Ua(o[1])),n=n.replace(/\.(\d*)$/,function(b,w){return"."+w+Ur("0",Ua(o[1]).length-w.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return h+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return h+Oi(""+f);if(o=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+fs(e,t,-r):Oi(""+r)+"."+Ur("0",o[1].length);if(o=t.match(/^#,#*,#0/))return fs(e,t.replace(/^#,#*,/,""),r);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=zl(fs(e,t.replace(/[\\-]/g,""),r)),l=0,zl(zl(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return l<n.length?n.charAt(l++):b==="0"?"0":""}));if(t.match(eS))return n=fs(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var g="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=P0(f,Math.pow(10,l)-1,!1),n=""+h,g=$s("n",o[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),n+=g+o[2]+"/"+o[3],g=j0(u[2],l),g.length<o[4].length&&(g=Ua(o[4].substr(o[4].length-g.length))+g),n+=g,n;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=P0(f,Math.pow(10,l)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?fg(u[1],l)+o[2]+"/"+o[3]+j0(u[2],l):Ur(" ",2*l+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:Ua(t.substr(0,t.length-n.length))+n;if(o=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var v=t.indexOf(".")-l,p=t.length-n.length-v;return Ua(t.substr(0,v)+n+t.substr(t.length-p))}if(o=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+fs(e,t,-r):Oi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?ts(0,3-b.length):"")+b})+"."+ts(0,o[1].length);switch(t){case"###,###":case"##,###":case"#,###":var _=Oi(""+f);return _!=="0"?h+_:"";default:if(t.match(/\.[0#?]*$/))return fs(e,t.slice(0,t.lastIndexOf(".")),r)+Ua(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function $s(e,t,r){return(r|0)===r?fs(e,t,r):Nn(e,t,r)}function XF(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var rS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Jl(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":I0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(rS))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function KF(e,t,r,a){for(var n=[],o="",l=0,u="",f="t",h,g,v,p="H";l<e.length;)switch(u=e.charAt(l)){case"G":if(!I0(e,l))throw new Error("unrecognized character "+u+" in "+e);n[n.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(v=e.charCodeAt(++l))!==34&&l<e.length;)o+=String.fromCharCode(v);n[n.length]={t:"t",v:o},++l;break;case"\\":var _=e.charAt(++l),b=_==="("||_===")"?_:"t";n[n.length]={t:b,v:_},++l;break;case"_":n[n.length]={t:"t",v:" "},l+=2;break;case"@":n[n.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(h==null&&(h=yo(t,r,e.charAt(l+1)==="2"),h==null))return"";n[n.length]={t:"X",v:e.substr(l,2)},f=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=yo(t,r),h==null))return"";for(o=u;++l<e.length&&e.charAt(l).toLowerCase()===u;)o+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=p),n[n.length]={t:u,v:o},f=u;break;case"A":case"a":case"":var w={t:u,v:u};if(h==null&&(h=yo(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(h!=null&&(w.v=h.H>=12?"P":"A"),w.t="T",p="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(h!=null&&(w.v=h.H>=12?"PM":"AM"),w.t="T",l+=5,p="h"):e.substr(l,5).toUpperCase()==="/"?(h!=null&&(w.v=h.H>=12?"":""),w.t="T",l+=5,p="h"):(w.t="t",++l),h==null&&w.t==="T")return"";n[n.length]=w,f=u;break;case"[":for(o=u;e.charAt(l++)!=="]"&&l<e.length;)o+=e.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(rS)){if(h==null&&(h=yo(t,r),h==null))return"";n[n.length]={t:"Z",v:o.toLowerCase()},f=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",Jl(e)||(n[n.length]={t:"t",v:o}));break;case".":if(h!=null){for(o=u;++l<e.length&&(u=e.charAt(l))==="0";)o+=u;n[n.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++l<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(l))>-1;)o+=u;n[n.length]={t:"n",v:o};break;case"?":for(o=u;e.charAt(++l)===u;)o+=u;n[n.length]={t:u,v:o},f=u;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":n[n.length]={t:a===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)o+=e.charAt(l);n[n.length]={t:"D",v:o};break;case" ":n[n.length]={t:u,v:u},++l;break;case"$":n[n.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);n[n.length]={t:"t",v:u},++l;break}var S=0,T=0,N;for(l=n.length-1,f="t";l>=0;--l)switch(n[l].t){case"h":case"H":n[l].t=p,f="h",S<1&&(S=1);break;case"s":(N=n[l].v.match(/\.0+$/))&&(T=Math.max(T,N[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":f=n[l].t;break;case"m":f==="s"&&(n[l].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&n[l].v.match(/[Hh]/)&&(S=1),S<2&&n[l].v.match(/[Mm]/)&&(S=2),S<3&&n[l].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var k="",E;for(l=0;l<n.length;++l)switch(n[l].t){case"t":case"T":case" ":case"D":break;case"X":n[l].v="",n[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[l].v=UF(n[l].t.charCodeAt(0),n[l].v,h,T),n[l].t="t";break;case"n":case"?":for(E=l+1;n[E]!=null&&((u=n[E].t)==="?"||u==="D"||(u===" "||u==="t")&&n[E+1]!=null&&(n[E+1].t==="?"||n[E+1].t==="t"&&n[E+1].v==="/")||n[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(n[E].v==="/"||n[E].v===" "&&n[E+1]!=null&&n[E+1].t=="?"));)n[l].v+=n[E].v,n[E]={v:"",t:";"},++E;k+=n[l].v,l=E-1;break;case"G":n[l].t="t",n[l].v=Eo(t,r);break}var M="",D,A;if(k.length>0){k.charCodeAt(0)==40?(D=t<0&&k.charCodeAt(0)===45?-t:t,A=$s("n",k,D)):(D=t<0&&a>1?-t:t,A=$s("n",k,D),D<0&&n[0]&&n[0].t=="t"&&(A=A.substr(1),n[0].v="-"+n[0].v)),E=A.length-1;var B=n.length;for(l=0;l<n.length;++l)if(n[l]!=null&&n[l].t!="t"&&n[l].v.indexOf(".")>-1){B=l;break}var j=n.length;if(B===n.length&&A.indexOf("E")===-1){for(l=n.length-1;l>=0;--l)n[l]==null||"n?".indexOf(n[l].t)===-1||(E>=n[l].v.length-1?(E-=n[l].v.length,n[l].v=A.substr(E+1,n[l].v.length)):E<0?n[l].v="":(n[l].v=A.substr(0,E+1),E=-1),n[l].t="t",j=l);E>=0&&j<n.length&&(n[j].v=A.substr(0,E+1)+n[j].v)}else if(B!==n.length&&A.indexOf("E")===-1){for(E=A.indexOf(".")-1,l=B;l>=0;--l)if(!(n[l]==null||"n?".indexOf(n[l].t)===-1)){for(g=n[l].v.indexOf(".")>-1&&l===B?n[l].v.indexOf(".")-1:n[l].v.length-1,M=n[l].v.substr(g+1);g>=0;--g)E>=0&&(n[l].v.charAt(g)==="0"||n[l].v.charAt(g)==="#")&&(M=A.charAt(E--)+M);n[l].v=M,n[l].t="t",j=l}for(E>=0&&j<n.length&&(n[j].v=A.substr(0,E+1)+n[j].v),E=A.indexOf(".")+1,l=B;l<n.length;++l)if(!(n[l]==null||"n?(".indexOf(n[l].t)===-1&&l!==B)){for(g=n[l].v.indexOf(".")>-1&&l===B?n[l].v.indexOf(".")+1:0,M=n[l].v.substr(0,g);g<n[l].v.length;++g)E<A.length&&(M+=A.charAt(E++));n[l].v=M,n[l].t="t",j=l}}}for(l=0;l<n.length;++l)n[l]!=null&&"n?".indexOf(n[l].t)>-1&&(D=a>1&&t<0&&l>0&&n[l-1].v==="-"?-t:t,n[l].v=$s(n[l].t,n[l].v,D),n[l].t="t");var ee="";for(l=0;l!==n.length;++l)n[l]!=null&&(ee+=n[l].v);return ee}var B_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function U_(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function JF(e,t){var r=XF(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var o=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,o];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(B_),u=r[1].match(B_);return U_(t,l)?[a,r[0]]:U_(t,u)?[a,r[1]]:[a,r[l!=null&&u!=null?2:1]]}return[a,o]}function Pn(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:wt)[e],a==null&&(a=r.table&&r.table[I_[e]]||wt[I_[e]]),a==null&&(a=FF[e]||"General");break}if(I0(a,0))return Eo(t,r);t instanceof Date&&(t=Yb(t,r.date1904));var n=JF(a,t);if(I0(n[1]))return Eo(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return KF(n[1],t,r,n[0])}function Ws(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(wt[r]==null){t<0&&(t=r);continue}if(wt[r]==e){t=r;break}}t<0&&(t=391)}return wt[t]=e,t}function id(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ws(e[t],t)}function Ql(){wt=RF()}var QF={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},aS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ZF(e){var t=typeof e=="number"?wt[e]:e;return t=t.replace(aS,"(\\d+)"),new RegExp("^"+t+"$")}function eM(e,t,r){var a=-1,n=-1,o=-1,l=-1,u=-1,f=-1;(t.match(aS)||[]).forEach(function(v,p){var _=parseInt(r[p+1],10);switch(v.toLowerCase().charAt(0)){case"y":a=_;break;case"d":o=_;break;case"h":l=_;break;case"s":f=_;break;case"m":l>=0?u=_:n=_;break}}),f>=0&&u==-1&&n>=0&&(u=n,n=-1);var h=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var g=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&u==-1&&f==-1?h:a==-1&&n==-1&&o==-1?g:h+"T"+g}var tM=function(){var e={};e.version="1.2.0";function t(){for(var A=0,B=new Array(256),j=0;j!=256;++j)A=j,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,B[j]=A;return typeof Int32Array<"u"?new Int32Array(B):B}var r=t();function a(A){var B=0,j=0,ee=0,re=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ee=0;ee!=256;++ee)re[ee]=A[ee];for(ee=0;ee!=256;++ee)for(j=A[ee],B=256+ee;B<4096;B+=256)j=re[B]=j>>>8^A[j&255];var U=[];for(ee=1;ee!=16;++ee)U[ee-1]=typeof Int32Array<"u"?re.subarray(ee*256,ee*256+256):re.slice(ee*256,ee*256+256);return U}var n=a(r),o=n[0],l=n[1],u=n[2],f=n[3],h=n[4],g=n[5],v=n[6],p=n[7],_=n[8],b=n[9],w=n[10],S=n[11],T=n[12],N=n[13],k=n[14];function E(A,B){for(var j=B^-1,ee=0,re=A.length;ee<re;)j=j>>>8^r[(j^A.charCodeAt(ee++))&255];return~j}function M(A,B){for(var j=B^-1,ee=A.length-15,re=0;re<ee;)j=k[A[re++]^j&255]^N[A[re++]^j>>8&255]^T[A[re++]^j>>16&255]^S[A[re++]^j>>>24]^w[A[re++]]^b[A[re++]]^_[A[re++]]^p[A[re++]]^v[A[re++]]^g[A[re++]]^h[A[re++]]^f[A[re++]]^u[A[re++]]^l[A[re++]]^o[A[re++]]^r[A[re++]];for(ee+=15;re<ee;)j=j>>>8^r[(j^A[re++])&255];return~j}function D(A,B){for(var j=B^-1,ee=0,re=A.length,U=0,I=0;ee<re;)U=A.charCodeAt(ee++),U<128?j=j>>>8^r[(j^U)&255]:U<2048?(j=j>>>8^r[(j^(192|U>>6&31))&255],j=j>>>8^r[(j^(128|U&63))&255]):U>=55296&&U<57344?(U=(U&1023)+64,I=A.charCodeAt(ee++)&1023,j=j>>>8^r[(j^(240|U>>8&7))&255],j=j>>>8^r[(j^(128|U>>2&63))&255],j=j>>>8^r[(j^(128|I>>6&15|(U&3)<<4))&255],j=j>>>8^r[(j^(128|I&63))&255]):(j=j>>>8^r[(j^(224|U>>12&15))&255],j=j>>>8^r[(j^(128|U>>6&63))&255],j=j>>>8^r[(j^(128|U&63))&255]);return~j}return e.table=r,e.bstr=E,e.buf=M,e.str=D,e}(),mt=function(){var t={};t.version="1.2.1";function r(R,G){for(var L=R.split("/"),V=G.split("/"),W=0,J=0,me=Math.min(L.length,V.length);W<me;++W){if(J=L[W].length-V[W].length)return J;if(L[W]!=V[W])return L[W]<V[W]?-1:1}return L.length-V.length}function a(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:a(R.slice(0,-1));var G=R.lastIndexOf("/");return G===-1?R:R.slice(0,G+1)}function n(R){if(R.charAt(R.length-1)=="/")return n(R.slice(0,-1));var G=R.lastIndexOf("/");return G===-1?R:R.slice(G+1)}function o(R,G){typeof G=="string"&&(G=new Date(G));var L=G.getHours();L=L<<6|G.getMinutes(),L=L<<5|G.getSeconds()>>>1,R.write_shift(2,L);var V=G.getFullYear()-1980;V=V<<4|G.getMonth()+1,V=V<<5|G.getDate(),R.write_shift(2,V)}function l(R){var G=R.read_shift(2)&65535,L=R.read_shift(2)&65535,V=new Date,W=L&31;L>>>=5;var J=L&15;L>>>=4,V.setMilliseconds(0),V.setFullYear(L+1980),V.setMonth(J-1),V.setDate(W);var me=G&31;G>>>=5;var Ce=G&63;return G>>>=6,V.setHours(G),V.setMinutes(Ce),V.setSeconds(me<<1),V}function u(R){Sa(R,0);for(var G={},L=0;R.l<=R.length-4;){var V=R.read_shift(2),W=R.read_shift(2),J=R.l+W,me={};switch(V){case 21589:L=R.read_shift(1),L&1&&(me.mtime=R.read_shift(4)),W>5&&(L&2&&(me.atime=R.read_shift(4)),L&4&&(me.ctime=R.read_shift(4))),me.mtime&&(me.mt=new Date(me.mtime*1e3));break}R.l=J,G[V]=me}return G}var f;function h(){return f||(f={})}function g(R,G){if(R[0]==80&&R[1]==75)return ft(R,G);if((R[0]|32)==109&&(R[1]|32)==105)return Sr(R,G);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var L=3,V=512,W=0,J=0,me=0,Ce=0,ce=0,ve=[],_e=R.slice(0,512);Sa(_e,0);var Ue=v(_e);switch(L=Ue[0],L){case 3:V=512;break;case 4:V=4096;break;case 0:if(Ue[1]==0)return ft(R,G);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}V!==512&&(_e=R.slice(0,V),Sa(_e,28));var $e=R.slice(0,V);p(_e,L);var at=_e.read_shift(4,"i");if(L===3&&at!==0)throw new Error("# Directory Sectors: Expected 0 saw "+at);_e.l+=4,me=_e.read_shift(4,"i"),_e.l+=4,_e.chk("00100000","Mini Stream Cutoff Size: "),Ce=_e.read_shift(4,"i"),W=_e.read_shift(4,"i"),ce=_e.read_shift(4,"i"),J=_e.read_shift(4,"i");for(var Ve=-1,tt=0;tt<109&&(Ve=_e.read_shift(4,"i"),!(Ve<0));++tt)ve[tt]=Ve;var Nt=_(R,V);S(ce,J,Nt,V,ve);var cr=N(Nt,me,ve,V);cr[me].name="!Directory",W>0&&Ce!==I&&(cr[Ce].name="!MiniFAT"),cr[ve[0]].name="!FAT",cr.fat_addrs=ve,cr.ssz=V;var ur={},yr=[],Ss=[],Zs=[];k(me,cr,Nt,yr,W,ur,Ss,Ce),b(Ss,Zs,yr),yr.shift();var pn={FileIndex:Ss,FullPaths:Zs};return G&&G.raw&&(pn.raw={header:$e,sectors:Nt}),pn}function v(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(ne,"Header Signature: "),R.l+=16;var G=R.read_shift(2,"u");return[R.read_shift(2,"u"),G]}function p(R,G){var L=9;switch(R.l+=2,L=R.read_shift(2)){case 9:if(G!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(G!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function _(R,G){for(var L=Math.ceil(R.length/G)-1,V=[],W=1;W<L;++W)V[W-1]=R.slice(W*G,(W+1)*G);return V[L-1]=R.slice(L*G),V}function b(R,G,L){for(var V=0,W=0,J=0,me=0,Ce=0,ce=L.length,ve=[],_e=[];V<ce;++V)ve[V]=_e[V]=V,G[V]=L[V];for(;Ce<_e.length;++Ce)V=_e[Ce],W=R[V].L,J=R[V].R,me=R[V].C,ve[V]===V&&(W!==-1&&ve[W]!==W&&(ve[V]=ve[W]),J!==-1&&ve[J]!==J&&(ve[V]=ve[J])),me!==-1&&(ve[me]=V),W!==-1&&V!=ve[V]&&(ve[W]=ve[V],_e.lastIndexOf(W)<Ce&&_e.push(W)),J!==-1&&V!=ve[V]&&(ve[J]=ve[V],_e.lastIndexOf(J)<Ce&&_e.push(J));for(V=1;V<ce;++V)ve[V]===V&&(J!==-1&&ve[J]!==J?ve[V]=ve[J]:W!==-1&&ve[W]!==W&&(ve[V]=ve[W]));for(V=1;V<ce;++V)if(R[V].type!==0){if(Ce=V,Ce!=ve[Ce])do Ce=ve[Ce],G[V]=G[Ce]+"/"+G[V];while(Ce!==0&&ve[Ce]!==-1&&Ce!=ve[Ce]);ve[V]=-1}for(G[0]+="/",V=1;V<ce;++V)R[V].type!==2&&(G[V]+="/")}function w(R,G,L){for(var V=R.start,W=R.size,J=[],me=V;L&&W>0&&me>=0;)J.push(G.slice(me*U,me*U+U)),W-=U,me=xo(L,me*4);return J.length===0?Ne(0):ma(J).slice(0,R.size)}function S(R,G,L,V,W){var J=I;if(R===I){if(G!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var me=L[R],Ce=(V>>>2)-1;if(!me)return;for(var ce=0;ce<Ce&&(J=xo(me,ce*4))!==I;++ce)W.push(J);S(xo(me,V-4),G-1,L,V,W)}}function T(R,G,L,V,W){var J=[],me=[];W||(W=[]);var Ce=V-1,ce=0,ve=0;for(ce=G;ce>=0;){W[ce]=!0,J[J.length]=ce,me.push(R[ce]);var _e=L[Math.floor(ce*4/V)];if(ve=ce*4&Ce,V<4+ve)throw new Error("FAT boundary crossed: "+ce+" 4 "+V);if(!R[_e])break;ce=xo(R[_e],ve)}return{nodes:J,data:Q_([me])}}function N(R,G,L,V){var W=R.length,J=[],me=[],Ce=[],ce=[],ve=V-1,_e=0,Ue=0,$e=0,at=0;for(_e=0;_e<W;++_e)if(Ce=[],$e=_e+G,$e>=W&&($e-=W),!me[$e]){ce=[];var Ve=[];for(Ue=$e;Ue>=0;){Ve[Ue]=!0,me[Ue]=!0,Ce[Ce.length]=Ue,ce.push(R[Ue]);var tt=L[Math.floor(Ue*4/V)];if(at=Ue*4&ve,V<4+at)throw new Error("FAT boundary crossed: "+Ue+" 4 "+V);if(!R[tt]||(Ue=xo(R[tt],at),Ve[Ue]))break}J[$e]={nodes:Ce,data:Q_([ce])}}return J}function k(R,G,L,V,W,J,me,Ce){for(var ce=0,ve=V.length?2:0,_e=G[R].data,Ue=0,$e=0,at;Ue<_e.length;Ue+=128){var Ve=_e.slice(Ue,Ue+128);Sa(Ve,64),$e=Ve.read_shift(2),at=yg(Ve,0,$e-ve),V.push(at);var tt={name:at,type:Ve.read_shift(1),color:Ve.read_shift(1),L:Ve.read_shift(4,"i"),R:Ve.read_shift(4,"i"),C:Ve.read_shift(4,"i"),clsid:Ve.read_shift(16),state:Ve.read_shift(4,"i"),start:0,size:0},Nt=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);Nt!==0&&(tt.ct=E(Ve,Ve.l-8));var cr=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);cr!==0&&(tt.mt=E(Ve,Ve.l-8)),tt.start=Ve.read_shift(4,"i"),tt.size=Ve.read_shift(4,"i"),tt.size<0&&tt.start<0&&(tt.size=tt.type=0,tt.start=I,tt.name=""),tt.type===5?(ce=tt.start,W>0&&ce!==I&&(G[ce].name="!StreamData")):tt.size>=4096?(tt.storage="fat",G[tt.start]===void 0&&(G[tt.start]=T(L,tt.start,G.fat_addrs,G.ssz)),G[tt.start].name=tt.name,tt.content=G[tt.start].data.slice(0,tt.size)):(tt.storage="minifat",tt.size<0?tt.size=0:ce!==I&&tt.start!==I&&G[ce]&&(tt.content=w(tt,G[ce].data,(G[Ce]||{}).data))),tt.content&&Sa(tt.content,0),J[at]=tt,me.push(tt)}}function E(R,G){return new Date((fn(R,G+4)/1e7*Math.pow(2,32)+fn(R,G)/1e7-11644473600)*1e3)}function M(R,G){return h(),g(f.readFileSync(R),G)}function D(R,G){var L=G&&G.type;switch(L||Pt&&Buffer.isBuffer(R)&&(L="buffer"),L||"base64"){case"file":return M(R,G);case"base64":return g(mn(vn(R)),G);case"binary":return g(mn(R),G)}return g(R,G)}function A(R,G){var L=G||{},V=L.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=V+"/",R.FileIndex[0]={name:V,type:5}),L.CLSID&&(R.FileIndex[0].clsid=L.CLSID),B(R)}function B(R){var G="Sh33tJ5";if(!mt.find(R,"/"+G)){var L=Ne(4);L[0]=55,L[1]=L[3]=50,L[2]=54,R.FileIndex.push({name:G,type:2,content:L,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+G),j(R)}}function j(R,G){A(R);for(var L=!1,V=!1,W=R.FullPaths.length-1;W>=0;--W){var J=R.FileIndex[W];switch(J.type){case 0:V?L=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:V=!0,isNaN(J.R*J.L*J.C)&&(L=!0),J.R>-1&&J.L>-1&&J.R==J.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!G)){var me=new Date(1987,1,19),Ce=0,ce=Object.create?Object.create(null):{},ve=[];for(W=0;W<R.FullPaths.length;++W)ce[R.FullPaths[W]]=!0,R.FileIndex[W].type!==0&&ve.push([R.FullPaths[W],R.FileIndex[W]]);for(W=0;W<ve.length;++W){var _e=a(ve[W][0]);V=ce[_e],V||(ve.push([_e,{name:n(_e).replace("/",""),type:1,clsid:q,ct:me,mt:me,content:null}]),ce[_e]=!0)}for(ve.sort(function(at,Ve){return r(at[0],Ve[0])}),R.FullPaths=[],R.FileIndex=[],W=0;W<ve.length;++W)R.FullPaths[W]=ve[W][0],R.FileIndex[W]=ve[W][1];for(W=0;W<ve.length;++W){var Ue=R.FileIndex[W],$e=R.FullPaths[W];if(Ue.name=n($e).replace("/",""),Ue.L=Ue.R=Ue.C=-(Ue.color=1),Ue.size=Ue.content?Ue.content.length:0,Ue.start=0,Ue.clsid=Ue.clsid||q,W===0)Ue.C=ve.length>1?1:-1,Ue.size=0,Ue.type=5;else if($e.slice(-1)=="/"){for(Ce=W+1;Ce<ve.length&&a(R.FullPaths[Ce])!=$e;++Ce);for(Ue.C=Ce>=ve.length?-1:Ce,Ce=W+1;Ce<ve.length&&a(R.FullPaths[Ce])!=a($e);++Ce);Ue.R=Ce>=ve.length?-1:Ce,Ue.type=1}else a(R.FullPaths[W+1]||"")==a($e)&&(Ue.R=W+1),Ue.type=2}}}function ee(R,G){var L=G||{};if(L.fileType=="mad")return xr(R,L);switch(j(R),L.fileType){case"zip":return lt(R,L)}var V=function(at){for(var Ve=0,tt=0,Nt=0;Nt<at.FileIndex.length;++Nt){var cr=at.FileIndex[Nt];if(cr.content){var ur=cr.content.length;ur>0&&(ur<4096?Ve+=ur+63>>6:tt+=ur+511>>9)}}for(var yr=at.FullPaths.length+3>>2,Ss=Ve+7>>3,Zs=Ve+127>>7,pn=Ss+tt+yr+Zs,zn=pn+127>>7,$i=zn<=109?0:Math.ceil((zn-109)/127);pn+zn+$i+127>>7>zn;)$i=++zn<=109?0:Math.ceil((zn-109)/127);var Vn=[1,$i,zn,Zs,yr,tt,Ve,0];return at.FileIndex[0].size=Ve<<6,Vn[7]=(at.FileIndex[0].start=Vn[0]+Vn[1]+Vn[2]+Vn[3]+Vn[4]+Vn[5])+(Vn[6]+7>>3),Vn}(R),W=Ne(V[7]<<9),J=0,me=0;{for(J=0;J<8;++J)W.write_shift(1,ie[J]);for(J=0;J<8;++J)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),J=0;J<3;++J)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,V[2]),W.write_shift(4,V[0]+V[1]+V[2]+V[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,V[3]?V[0]+V[1]+V[2]-1:I),W.write_shift(4,V[3]),W.write_shift(-4,V[1]?V[0]-1:I),W.write_shift(4,V[1]),J=0;J<109;++J)W.write_shift(-4,J<V[2]?V[1]+J:-1)}if(V[1])for(me=0;me<V[1];++me){for(;J<236+me*127;++J)W.write_shift(-4,J<V[2]?V[1]+J:-1);W.write_shift(-4,me===V[1]-1?I:me+1)}var Ce=function(at){for(me+=at;J<me-1;++J)W.write_shift(-4,J+1);at&&(++J,W.write_shift(-4,I))};for(me=J=0,me+=V[1];J<me;++J)W.write_shift(-4,ae.DIFSECT);for(me+=V[2];J<me;++J)W.write_shift(-4,ae.FATSECT);Ce(V[3]),Ce(V[4]);for(var ce=0,ve=0,_e=R.FileIndex[0];ce<R.FileIndex.length;++ce)_e=R.FileIndex[ce],_e.content&&(ve=_e.content.length,!(ve<4096)&&(_e.start=me,Ce(ve+511>>9)));for(Ce(V[6]+7>>3);W.l&511;)W.write_shift(-4,ae.ENDOFCHAIN);for(me=J=0,ce=0;ce<R.FileIndex.length;++ce)_e=R.FileIndex[ce],_e.content&&(ve=_e.content.length,!(!ve||ve>=4096)&&(_e.start=me,Ce(ve+63>>6)));for(;W.l&511;)W.write_shift(-4,ae.ENDOFCHAIN);for(J=0;J<V[4]<<2;++J){var Ue=R.FullPaths[J];if(!Ue||Ue.length===0){for(ce=0;ce<17;++ce)W.write_shift(4,0);for(ce=0;ce<3;++ce)W.write_shift(4,-1);for(ce=0;ce<12;++ce)W.write_shift(4,0);continue}_e=R.FileIndex[J],J===0&&(_e.start=_e.size?_e.start-1:I);var $e=J===0&&L.root||_e.name;if(ve=2*($e.length+1),W.write_shift(64,$e,"utf16le"),W.write_shift(2,ve),W.write_shift(1,_e.type),W.write_shift(1,_e.color),W.write_shift(-4,_e.L),W.write_shift(-4,_e.R),W.write_shift(-4,_e.C),_e.clsid)W.write_shift(16,_e.clsid,"hex");else for(ce=0;ce<4;++ce)W.write_shift(4,0);W.write_shift(4,_e.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,_e.start),W.write_shift(4,_e.size),W.write_shift(4,0)}for(J=1;J<R.FileIndex.length;++J)if(_e=R.FileIndex[J],_e.size>=4096)if(W.l=_e.start+1<<9,Pt&&Buffer.isBuffer(_e.content))_e.content.copy(W,W.l,0,_e.size),W.l+=_e.size+511&-512;else{for(ce=0;ce<_e.size;++ce)W.write_shift(1,_e.content[ce]);for(;ce&511;++ce)W.write_shift(1,0)}for(J=1;J<R.FileIndex.length;++J)if(_e=R.FileIndex[J],_e.size>0&&_e.size<4096)if(Pt&&Buffer.isBuffer(_e.content))_e.content.copy(W,W.l,0,_e.size),W.l+=_e.size+63&-64;else{for(ce=0;ce<_e.size;++ce)W.write_shift(1,_e.content[ce]);for(;ce&63;++ce)W.write_shift(1,0)}if(Pt)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function re(R,G){var L=R.FullPaths.map(function(ce){return ce.toUpperCase()}),V=L.map(function(ce){var ve=ce.split("/");return ve[ve.length-(ce.slice(-1)=="/"?2:1)]}),W=!1;G.charCodeAt(0)===47?(W=!0,G=L[0].slice(0,-1)+G):W=G.indexOf("/")!==-1;var J=G.toUpperCase(),me=W===!0?L.indexOf(J):V.indexOf(J);if(me!==-1)return R.FileIndex[me];var Ce=!J.match(ru);for(J=J.replace(Va,""),Ce&&(J=J.replace(ru,"!")),me=0;me<L.length;++me)if((Ce?L[me].replace(ru,"!"):L[me]).replace(Va,"")==J||(Ce?V[me].replace(ru,"!"):V[me]).replace(Va,"")==J)return R.FileIndex[me];return null}var U=64,I=-2,ne="d0cf11e0a1b11ae1",ie=[208,207,17,224,161,177,26,225],q="00000000000000000000000000000000",ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:I,FREESECT:-1,HEADER_SIGNATURE:ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function be(R,G,L){h();var V=ee(R,L);f.writeFileSync(G,V)}function z(R){for(var G=new Array(R.length),L=0;L<R.length;++L)G[L]=String.fromCharCode(R[L]);return G.join("")}function fe(R,G){var L=ee(R,G);switch(G&&G.type||"buffer"){case"file":return h(),f.writeFileSync(G.filename,L),L;case"binary":return typeof L=="string"?L:z(L);case"base64":return Tu(typeof L=="string"?L:z(L));case"buffer":if(Pt)return Buffer.isBuffer(L)?L:Xs(L);case"array":return typeof L=="string"?mn(L):L}return L}var De;function P(R){try{var G=R.InflateRaw,L=new G;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)De=R;else throw new Error("zlib does not expose bytesRead")}catch(V){console.error("cannot use native zlib: "+(V.message||V))}}function X(R,G){if(!De)return xa(R,G);var L=De.InflateRaw,V=new L,W=V._processChunk(R.slice(R.l),V._finishFlushFlag);return R.l+=V.bytesRead,W}function Y(R){return De?De.deflateRawSync(R):ye(R)}var Q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],de=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Te(R){var G=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(G>>16|G>>8|G)&255}for(var Oe=typeof Uint8Array<"u",Re=Oe?new Uint8Array(256):[],Je=0;Je<256;++Je)Re[Je]=Te(Je);function H(R,G){var L=Re[R&255];return G<=8?L>>>8-G:(L=L<<8|Re[R>>8&255],G<=16?L>>>16-G:(L=L<<8|Re[R>>16&255],L>>>24-G))}function O(R,G){var L=G&7,V=G>>>3;return(R[V]|(L<=6?0:R[V+1]<<8))>>>L&3}function Ae(R,G){var L=G&7,V=G>>>3;return(R[V]|(L<=5?0:R[V+1]<<8))>>>L&7}function Pe(R,G){var L=G&7,V=G>>>3;return(R[V]|(L<=4?0:R[V+1]<<8))>>>L&15}function Se(R,G){var L=G&7,V=G>>>3;return(R[V]|(L<=3?0:R[V+1]<<8))>>>L&31}function Z(R,G){var L=G&7,V=G>>>3;return(R[V]|(L<=1?0:R[V+1]<<8))>>>L&127}function le(R,G,L){var V=G&7,W=G>>>3,J=(1<<L)-1,me=R[W]>>>V;return L<8-V||(me|=R[W+1]<<8-V,L<16-V)||(me|=R[W+2]<<16-V,L<24-V)||(me|=R[W+3]<<24-V),me&J}function Ge(R,G,L){var V=G&7,W=G>>>3;return V<=5?R[W]|=(L&7)<<V:(R[W]|=L<<V&255,R[W+1]=(L&7)>>8-V),G+3}function kt(R,G,L){var V=G&7,W=G>>>3;return L=(L&1)<<V,R[W]|=L,G+1}function nt(R,G,L){var V=G&7,W=G>>>3;return L<<=V,R[W]|=L&255,L>>>=8,R[W+1]=L,G+8}function st(R,G,L){var V=G&7,W=G>>>3;return L<<=V,R[W]|=L&255,L>>>=8,R[W+1]=L&255,R[W+2]=L>>>8,G+16}function Ze(R,G){var L=R.length,V=2*L>G?2*L:G+5,W=0;if(L>=G)return R;if(Pt){var J=F_(V);if(R.copy)R.copy(J);else for(;W<R.length;++W)J[W]=R[W];return J}else if(Oe){var me=new Uint8Array(V);if(me.set)me.set(R);else for(;W<L;++W)me[W]=R[W];return me}return R.length=V,R}function Ee(R){for(var G=new Array(R),L=0;L<R;++L)G[L]=0;return G}function Xe(R,G,L){var V=1,W=0,J=0,me=0,Ce=0,ce=R.length,ve=Oe?new Uint16Array(32):Ee(32);for(J=0;J<32;++J)ve[J]=0;for(J=ce;J<L;++J)R[J]=0;ce=R.length;var _e=Oe?new Uint16Array(ce):Ee(ce);for(J=0;J<ce;++J)ve[W=R[J]]++,V<W&&(V=W),_e[J]=0;for(ve[0]=0,J=1;J<=V;++J)ve[J+16]=Ce=Ce+ve[J-1]<<1;for(J=0;J<ce;++J)Ce=R[J],Ce!=0&&(_e[J]=ve[Ce+16]++);var Ue=0;for(J=0;J<ce;++J)if(Ue=R[J],Ue!=0)for(Ce=H(_e[J],V)>>V-Ue,me=(1<<V+4-Ue)-1;me>=0;--me)G[Ce|me<<Ue]=Ue&15|J<<4;return V}var Qe=Oe?new Uint16Array(512):Ee(512),et=Oe?new Uint16Array(32):Ee(32);if(!Oe){for(var rt=0;rt<512;++rt)Qe[rt]=0;for(rt=0;rt<32;++rt)et[rt]=0}(function(){for(var R=[],G=0;G<32;G++)R.push(5);Xe(R,et,32);var L=[];for(G=0;G<=143;G++)L.push(8);for(;G<=255;G++)L.push(9);for(;G<=279;G++)L.push(7);for(;G<=287;G++)L.push(8);Xe(L,Qe,288)})();var ke=function(){for(var G=Oe?new Uint8Array(32768):[],L=0,V=0;L<Fe.length-1;++L)for(;V<Fe[L+1];++V)G[V]=L;for(;V<32768;++V)G[V]=29;var W=Oe?new Uint8Array(259):[];for(L=0,V=0;L<de.length-1;++L)for(;V<de[L+1];++V)W[V]=L;function J(Ce,ce){for(var ve=0;ve<Ce.length;){var _e=Math.min(65535,Ce.length-ve),Ue=ve+_e==Ce.length;for(ce.write_shift(1,+Ue),ce.write_shift(2,_e),ce.write_shift(2,~_e&65535);_e-- >0;)ce[ce.l++]=Ce[ve++]}return ce.l}function me(Ce,ce){for(var ve=0,_e=0,Ue=Oe?new Uint16Array(32768):[];_e<Ce.length;){var $e=Math.min(65535,Ce.length-_e);if($e<10){for(ve=Ge(ce,ve,+(_e+$e==Ce.length)),ve&7&&(ve+=8-(ve&7)),ce.l=ve/8|0,ce.write_shift(2,$e),ce.write_shift(2,~$e&65535);$e-- >0;)ce[ce.l++]=Ce[_e++];ve=ce.l*8;continue}ve=Ge(ce,ve,+(_e+$e==Ce.length)+2);for(var at=0;$e-- >0;){var Ve=Ce[_e];at=(at<<5^Ve)&32767;var tt=-1,Nt=0;if((tt=Ue[at])&&(tt|=_e&-32768,tt>_e&&(tt-=32768),tt<_e))for(;Ce[tt+Nt]==Ce[_e+Nt]&&Nt<250;)++Nt;if(Nt>2){Ve=W[Nt],Ve<=22?ve=nt(ce,ve,Re[Ve+1]>>1)-1:(nt(ce,ve,3),ve+=5,nt(ce,ve,Re[Ve-23]>>5),ve+=3);var cr=Ve<8?0:Ve-4>>2;cr>0&&(st(ce,ve,Nt-de[Ve]),ve+=cr),Ve=G[_e-tt],ve=nt(ce,ve,Re[Ve]>>3),ve-=3;var ur=Ve<4?0:Ve-2>>1;ur>0&&(st(ce,ve,_e-tt-Fe[Ve]),ve+=ur);for(var yr=0;yr<Nt;++yr)Ue[at]=_e&32767,at=(at<<5^Ce[_e])&32767,++_e;$e-=Nt-1}else Ve<=143?Ve=Ve+48:ve=kt(ce,ve,1),ve=nt(ce,ve,Re[Ve]),Ue[at]=_e&32767,++_e}ve=nt(ce,ve,0)-1}return ce.l=(ve+7)/8|0,ce.l}return function(ce,ve){return ce.length<8?J(ce,ve):me(ce,ve)}}();function ye(R){var G=Ne(50+Math.floor(R.length*1.1)),L=ke(R,G);return G.slice(0,L)}var xe=Oe?new Uint16Array(32768):Ee(32768),ze=Oe?new Uint16Array(32768):Ee(32768),xt=Oe?new Uint16Array(128):Ee(128),qt=1,lr=1;function Nr(R,G){var L=Se(R,G)+257;G+=5;var V=Se(R,G)+1;G+=5;var W=Pe(R,G)+4;G+=4;for(var J=0,me=Oe?new Uint8Array(19):Ee(19),Ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,ve=Oe?new Uint8Array(8):Ee(8),_e=Oe?new Uint8Array(8):Ee(8),Ue=me.length,$e=0;$e<W;++$e)me[Q[$e]]=J=Ae(R,G),ce<J&&(ce=J),ve[J]++,G+=3;var at=0;for(ve[0]=0,$e=1;$e<=ce;++$e)_e[$e]=at=at+ve[$e-1]<<1;for($e=0;$e<Ue;++$e)(at=me[$e])!=0&&(Ce[$e]=_e[at]++);var Ve=0;for($e=0;$e<Ue;++$e)if(Ve=me[$e],Ve!=0){at=Re[Ce[$e]]>>8-Ve;for(var tt=(1<<7-Ve)-1;tt>=0;--tt)xt[at|tt<<Ve]=Ve&7|$e<<3}var Nt=[];for(ce=1;Nt.length<L+V;)switch(at=xt[Z(R,G)],G+=at&7,at>>>=3){case 16:for(J=3+O(R,G),G+=2,at=Nt[Nt.length-1];J-- >0;)Nt.push(at);break;case 17:for(J=3+Ae(R,G),G+=3;J-- >0;)Nt.push(0);break;case 18:for(J=11+Z(R,G),G+=7;J-- >0;)Nt.push(0);break;default:Nt.push(at),ce<at&&(ce=at);break}var cr=Nt.slice(0,L),ur=Nt.slice(L);for($e=L;$e<286;++$e)cr[$e]=0;for($e=V;$e<30;++$e)ur[$e]=0;return qt=Xe(cr,xe,286),lr=Xe(ur,ze,30),G}function gr(R,G){if(R[0]==3&&!(R[1]&3))return[Ii(G),2];for(var L=0,V=0,W=F_(G||1<<18),J=0,me=W.length>>>0,Ce=0,ce=0;(V&1)==0;){if(V=Ae(R,L),L+=3,V>>>1)V>>1==1?(Ce=9,ce=5):(L=Nr(R,L),Ce=qt,ce=lr);else{L&7&&(L+=8-(L&7));var ve=R[L>>>3]|R[(L>>>3)+1]<<8;if(L+=32,ve>0)for(!G&&me<J+ve&&(W=Ze(W,J+ve),me=W.length);ve-- >0;)W[J++]=R[L>>>3],L+=8;continue}for(;;){!G&&me<J+32767&&(W=Ze(W,J+32767),me=W.length);var _e=le(R,L,Ce),Ue=V>>>1==1?Qe[_e]:xe[_e];if(L+=Ue&15,Ue>>>=4,(Ue>>>8&255)===0)W[J++]=Ue;else{if(Ue==256)break;Ue-=257;var $e=Ue<8?0:Ue-4>>2;$e>5&&($e=0);var at=J+de[Ue];$e>0&&(at+=le(R,L,$e),L+=$e),_e=le(R,L,ce),Ue=V>>>1==1?et[_e]:ze[_e],L+=Ue&15,Ue>>>=4;var Ve=Ue<4?0:Ue-2>>1,tt=Fe[Ue];for(Ve>0&&(tt+=le(R,L,Ve),L+=Ve),!G&&me<at&&(W=Ze(W,at+100),me=W.length);J<at;)W[J]=W[J-tt],++J}}}return G?[W,L+7>>>3]:[W.slice(0,J),L+7>>>3]}function xa(R,G){var L=R.slice(R.l||0),V=gr(L,G);return R.l+=V[1],V[0]}function br(R,G){if(R)typeof console<"u"&&console.error(G);else throw new Error(G)}function ft(R,G){var L=R;Sa(L,0);var V=[],W=[],J={FileIndex:V,FullPaths:W};A(J,{root:G.root});for(var me=L.length-4;(L[me]!=80||L[me+1]!=75||L[me+2]!=5||L[me+3]!=6)&&me>=0;)--me;L.l=me+4,L.l+=4;var Ce=L.read_shift(2);L.l+=6;var ce=L.read_shift(4);for(L.l=ce,me=0;me<Ce;++me){L.l+=20;var ve=L.read_shift(4),_e=L.read_shift(4),Ue=L.read_shift(2),$e=L.read_shift(2),at=L.read_shift(2);L.l+=8;var Ve=L.read_shift(4),tt=u(L.slice(L.l+Ue,L.l+Ue+$e));L.l+=Ue+$e+at;var Nt=L.l;L.l=Ve+4,jt(L,ve,_e,J,tt),L.l=Nt}return J}function jt(R,G,L,V,W){R.l+=2;var J=R.read_shift(2),me=R.read_shift(2),Ce=l(R);if(J&8257)throw new Error("Unsupported ZIP encryption");for(var ce=R.read_shift(4),ve=R.read_shift(4),_e=R.read_shift(4),Ue=R.read_shift(2),$e=R.read_shift(2),at="",Ve=0;Ve<Ue;++Ve)at+=String.fromCharCode(R[R.l++]);if($e){var tt=u(R.slice(R.l,R.l+$e));(tt[21589]||{}).mt&&(Ce=tt[21589].mt),((W||{})[21589]||{}).mt&&(Ce=W[21589].mt)}R.l+=$e;var Nt=R.slice(R.l,R.l+ve);switch(me){case 8:Nt=X(R,_e);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+me)}var cr=!1;J&8&&(ce=R.read_shift(4),ce==134695760&&(ce=R.read_shift(4),cr=!0),ve=R.read_shift(4),_e=R.read_shift(4)),ve!=G&&br(cr,"Bad compressed size: "+G+" != "+ve),_e!=L&&br(cr,"Bad uncompressed size: "+L+" != "+_e),er(V,at,Nt,{unsafe:!0,mt:Ce})}function lt(R,G){var L=G||{},V=[],W=[],J=Ne(1),me=L.compression?8:0,Ce=0,ce=0,ve=0,_e=0,Ue=0,$e=R.FullPaths[0],at=$e,Ve=R.FileIndex[0],tt=[],Nt=0;for(ce=1;ce<R.FullPaths.length;++ce)if(at=R.FullPaths[ce].slice($e.length),Ve=R.FileIndex[ce],!(!Ve.size||!Ve.content||at=="Sh33tJ5")){var cr=_e,ur=Ne(at.length);for(ve=0;ve<at.length;++ve)ur.write_shift(1,at.charCodeAt(ve)&127);ur=ur.slice(0,ur.l),tt[Ue]=tM.buf(Ve.content,0);var yr=Ve.content;me==8&&(yr=Y(yr)),J=Ne(30),J.write_shift(4,67324752),J.write_shift(2,20),J.write_shift(2,Ce),J.write_shift(2,me),Ve.mt?o(J,Ve.mt):J.write_shift(4,0),J.write_shift(-4,tt[Ue]),J.write_shift(4,yr.length),J.write_shift(4,Ve.content.length),J.write_shift(2,ur.length),J.write_shift(2,0),_e+=J.length,V.push(J),_e+=ur.length,V.push(ur),_e+=yr.length,V.push(yr),J=Ne(46),J.write_shift(4,33639248),J.write_shift(2,0),J.write_shift(2,20),J.write_shift(2,Ce),J.write_shift(2,me),J.write_shift(4,0),J.write_shift(-4,tt[Ue]),J.write_shift(4,yr.length),J.write_shift(4,Ve.content.length),J.write_shift(2,ur.length),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(4,0),J.write_shift(4,cr),Nt+=J.l,W.push(J),Nt+=ur.length,W.push(ur),++Ue}return J=Ne(22),J.write_shift(4,101010256),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,Ue),J.write_shift(2,Ue),J.write_shift(4,Nt),J.write_shift(4,_e),J.write_shift(2,0),ma([ma(V),ma(W),J])}var Ot={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ct(R,G){if(R.ctype)return R.ctype;var L=R.name||"",V=L.match(/\.([^\.]+)$/);return V&&Ot[V[1]]||G&&(V=(L=G).match(/[\.\\]([^\.\\])+$/),V&&Ot[V[1]])?Ot[V[1]]:"application/octet-stream"}function je(R){for(var G=Tu(R),L=[],V=0;V<G.length;V+=76)L.push(G.slice(V,V+76));return L.join(`\r
`)+`\r
`}function He(R){var G=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ve){var _e=ve.charCodeAt(0).toString(16).toUpperCase();return"="+(_e.length==1?"0"+_e:_e)});G=G.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),G.charAt(0)==`
`&&(G="=0D"+G.slice(1)),G=G.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],V=G.split(`\r
`),W=0;W<V.length;++W){var J=V[W];if(J.length==0){L.push("");continue}for(var me=0;me<J.length;){var Ce=76,ce=J.slice(me,me+Ce);ce.charAt(Ce-1)=="="?Ce--:ce.charAt(Ce-2)=="="?Ce-=2:ce.charAt(Ce-3)=="="&&(Ce-=3),ce=J.slice(me,me+Ce),me+=Ce,me<J.length&&(ce+="="),L.push(ce)}}return L.join(`\r
`)}function pr(R){for(var G=[],L=0;L<R.length;++L){for(var V=R[L];L<=R.length&&V.charAt(V.length-1)=="=";)V=V.slice(0,V.length-1)+R[++L];G.push(V)}for(var W=0;W<G.length;++W)G[W]=G[W].replace(/[=][0-9A-Fa-f]{2}/g,function(J){return String.fromCharCode(parseInt(J.slice(1),16))});return mn(G.join(`\r
`))}function Bn(R,G,L){for(var V="",W="",J="",me,Ce=0;Ce<10;++Ce){var ce=G[Ce];if(!ce||ce.match(/^\s*$/))break;var ve=ce.match(/^(.*?):\s*([^\s].*)$/);if(ve)switch(ve[1].toLowerCase()){case"content-location":V=ve[2].trim();break;case"content-type":J=ve[2].trim();break;case"content-transfer-encoding":W=ve[2].trim();break}}switch(++Ce,W.toLowerCase()){case"base64":me=mn(vn(G.slice(Ce).join("")));break;case"quoted-printable":me=pr(G.slice(Ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var _e=er(R,V.slice(L.length),me,{unsafe:!0});J&&(_e.ctype=J)}function Sr(R,G){if(z(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=G&&G.root||"",V=(Pt&&Buffer.isBuffer(R)?R.toString("binary"):z(R)).split(`\r
`),W=0,J="";for(W=0;W<V.length;++W)if(J=V[W],!!/^Content-Location:/i.test(J)&&(J=J.slice(J.indexOf("file")),L||(L=J.slice(0,J.lastIndexOf("/")+1)),J.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),J.slice(0,L.length)!=L););var me=(V[1]||"").match(/boundary="(.*?)"/);if(!me)throw new Error("MAD cannot find boundary");var Ce="--"+(me[1]||""),ce=[],ve=[],_e={FileIndex:ce,FullPaths:ve};A(_e);var Ue,$e=0;for(W=0;W<V.length;++W){var at=V[W];at!==Ce&&at!==Ce+"--"||($e++&&Bn(_e,V.slice(Ue,W),L),Ue=W)}return _e}function xr(R,G){var L=G||{},V=L.boundary||"SheetJS";V="------="+V;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+V.slice(2)+'"',"","",""],J=R.FullPaths[0],me=J,Ce=R.FileIndex[0],ce=1;ce<R.FullPaths.length;++ce)if(me=R.FullPaths[ce].slice(J.length),Ce=R.FileIndex[ce],!(!Ce.size||!Ce.content||me=="Sh33tJ5")){me=me.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Nt){return"_x"+Nt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Nt){return"_u"+Nt.charCodeAt(0).toString(16)+"_"});for(var ve=Ce.content,_e=Pt&&Buffer.isBuffer(ve)?ve.toString("binary"):z(ve),Ue=0,$e=Math.min(1024,_e.length),at=0,Ve=0;Ve<=$e;++Ve)(at=_e.charCodeAt(Ve))>=32&&at<128&&++Ue;var tt=Ue>=$e*4/5;W.push(V),W.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+me),W.push("Content-Transfer-Encoding: "+(tt?"quoted-printable":"base64")),W.push("Content-Type: "+ct(Ce,me)),W.push(""),W.push(tt?He(_e):je(_e))}return W.push(V+`--\r
`),W.join(`\r
`)}function Or(R){var G={};return A(G,R),G}function er(R,G,L,V){var W=V&&V.unsafe;W||A(R);var J=!W&&mt.find(R,G);if(!J){var me=R.FullPaths[0];G.slice(0,me.length)==me?me=G:(me.slice(-1)!="/"&&(me+="/"),me=(me+G).replace("//","/")),J={name:n(G),type:2},R.FileIndex.push(J),R.FullPaths.push(me),W||mt.utils.cfb_gc(R)}return J.content=L,J.size=L?L.length:0,V&&(V.CLSID&&(J.clsid=V.CLSID),V.mt&&(J.mt=V.mt),V.ct&&(J.ct=V.ct)),J}function Xr(R,G){A(R);var L=mt.find(R,G);if(L){for(var V=0;V<R.FileIndex.length;++V)if(R.FileIndex[V]==L)return R.FileIndex.splice(V,1),R.FullPaths.splice(V,1),!0}return!1}function Qs(R,G,L){A(R);var V=mt.find(R,G);if(V){for(var W=0;W<R.FileIndex.length;++W)if(R.FileIndex[W]==V)return R.FileIndex[W].name=n(L),R.FullPaths[W]=L,!0}return!1}function Un(R){j(R,!0)}return t.find=re,t.read=D,t.parse=g,t.write=fe,t.writeFile=be,t.utils={cfb_new:Or,cfb_add:er,cfb_del:Xr,cfb_mov:Qs,cfb_gc:Un,ReadShift:ou,CheckField:TS,prep_blob:Sa,bconcat:ma,use_zlib:P,_deflateRaw:ye,_inflateRaw:xa,consts:ae},t}();function rM(e){return typeof e=="string"?sd(e):Array.isArray(e)?CF(e):e}function Wu(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=sd(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?ps(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([rM(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=zi(t)),u.write(t),u.close(),t}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+e)}function aM(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function Vr(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function z_(e,t){for(var r=[],a=Vr(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function od(e){for(var t=[],r=Vr(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function ld(e){for(var t=[],r=Vr(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function nM(e){for(var t=[],r=Vr(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var L0=new Date(1899,11,30,0,0,0);function la(e,t){var r=e.getTime(),a=L0.getTime()+(e.getTimezoneOffset()-L0.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var nS=new Date,sM=L0.getTime()+(nS.getTimezoneOffset()-L0.getTimezoneOffset())*6e4,V_=nS.getTimezoneOffset();function cd(e){var t=new Date;return t.setTime(e*24*60*60*1e3+sM),t.getTimezoneOffset()!==V_&&t.setTime(t.getTime()+(t.getTimezoneOffset()-V_)*6e4),t}function iM(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=n.length;++o)if(n[o]){switch(r=1,o>3&&(a=!0),n[o].slice(n[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[o].slice(n[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[o],10)}return t}var H_=new Date("2017-02-19T19:06:09.000Z"),sS=isNaN(H_.getFullYear())?new Date("2/19/17"):H_,oM=sS.getFullYear()==2017;function Ar(e,t){var r=new Date(e);if(oM)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(sS.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function To(e,t){if(Pt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ps(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ps(Gb(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ps(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ps(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return r[o]||o})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function Cr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Cr(e[r]));return t}function Ur(e,t){for(var r="";r.length<t;)r+=e;return r}function rs(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,o){return r=-r,o}),!isNaN(t=Number(a)))?t/r:t}var lM=["january","february","march","april","may","june","july","august","september","october","november","december"];function Gl(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),o=t.getDate();if(isNaN(o))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&lM.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||o>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var cM=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var o=r.split(a),l=[o[0]],u=1;u<o.length;++u)l.push(n),l.push(o[u]);return l}}();function iS(e){return e?e.content&&e.type?To(e.content,!0):e.data?tu(e.data):e.asNodeBuffer&&Pt?tu(e.asNodeBuffer().toString("binary")):e.asBinary?tu(e.asBinary()):e._data&&e._data.getContent?tu(To(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function oS(e){if(!e)return null;if(e.data)return O_(e.data);if(e.asNodeBuffer&&Pt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?O_(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function uM(e){return e&&e.name.slice(-4)===".bin"?oS(e):iS(e)}function Fn(e,t){for(var r=e.FullPaths||Vr(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),o=0;o<r.length;++o){var l=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==l||n==l)return e.files?e.files[r[o]]:e.FileIndex[o]}return null}function hg(e,t){var r=Fn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function ea(e,t,r){if(!r)return uM(hg(e,t));if(!t)return null;try{return ea(e,t)}catch{return null}}function gn(e,t,r){if(!r)return iS(hg(e,t));if(!t)return null;try{return gn(e,t)}catch{return null}}function fM(e,t,r){return oS(hg(e,t))}function $_(e){for(var t=e.FullPaths||Vr(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Mt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return Pt?a=Xs(r):a=NF(r),mt.utils.cfb_add(e,t,a)}mt.utils.cfb_add(e,t,r)}else e.file(t,r)}function mg(){return mt.utils.cfb_new()}function lS(e,t){switch(t.type){case"base64":return mt.read(e,{type:"base64"});case"binary":return mt.read(e,{type:"binary"});case"buffer":case"array":return mt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function au(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Yr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,dM=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,W_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,hM=/<[^>]*>/g,La=Yr.match(W_)?W_:hM,mM=/<\w*:/,gM=/<(\/?)\w+:/;function Tt(e,t,r){for(var a={},n=0,o=0;n!==e.length&&!((o=e.charCodeAt(n))===32||o===10||o===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var l=e.match(dM),u=0,f="",h=0,g="",v="",p=1;if(l)for(h=0;h!=l.length;++h){for(v=l[h],o=0;o!=v.length&&v.charCodeAt(o)!==61;++o);for(g=v.slice(0,o).trim();v.charCodeAt(o+1)==32;)++o;for(p=(n=v.charCodeAt(o+1))==34||n==39?1:0,f=v.slice(o+1+p,v.length-p),u=0;u!=g.length&&g.charCodeAt(u)!==58;++u);if(u===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),a[g]=f,a[g.toLowerCase()]=f;else{var _=(u===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(u+1);if(a[_]&&g.slice(u-3,u)=="ext")continue;a[_]=f,a[_.toLowerCase()]=f}}return a}function ws(e){return e.replace(gM,"<$1")}var cS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},gg=od(cS),Yt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",o=n.indexOf("<![CDATA[");if(o==-1)return n.replace(e,function(u,f){return cS[u]||String.fromCharCode(parseInt(f,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,f){return String.fromCharCode(parseInt(f,16))});var l=n.indexOf("]]>");return r(n.slice(0,o))+n.slice(o+9,l)+r(n.slice(l+3))}}(),xg=/[&<>'"]/g,xM=/[\u0000-\u0008\u000b-\u001f]/g;function or(e){var t=e+"";return t.replace(xg,function(r){return gg[r]}).replace(xM,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function G_(e){return or(e).replace(/ /g,"_x0020_")}var uS=/[\u0000-\u001f]/g;function vg(e){var t=e+"";return t.replace(xg,function(r){return gg[r]}).replace(/\n/g,"<br/>").replace(uS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function vM(e){var t=e+"";return t.replace(xg,function(r){return gg[r]}).replace(uS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var q_=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function pM(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function kr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Bm(e){for(var t="",r=0,a=0,n=0,o=0,l=0,u=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){l=(a&31)<<6,l|=n&63,t+=String.fromCharCode(l);continue}if(o=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|o&63);continue}l=e.charCodeAt(r++),u=((a&7)<<18|(n&63)<<12|(o&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function Y_(e){var t=Ii(2*e.length),r,a,n=1,o=0,l=0,u;for(a=0;a<e.length;a+=n)n=1,(u=e.charCodeAt(a))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(a+1)&63),n=2):u<240?(r=(u&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(u&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[o++]=l&255,t[o++]=l>>>8,l=0),t[o++]=r%256,t[o++]=r>>>8;return t.slice(0,o).toString("ucs2")}function X_(e){return Xs(e,"binary").toString("utf8")}var v0="foo bar baz",mr=Pt&&(X_(v0)==Bm(v0)&&X_||Y_(v0)==Bm(v0)&&Y_)||Bm,ps=Pt?function(e){return Xs(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},Au=function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),fS=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),yM=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),_M=/<\/?(?:vt:)?variant>/g,wM=/<(?:vt:)([^>]*)>([\s\S]*)</;function K_(e,t){var r=Tt(e),a=e.match(yM(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(o){var l=o.replace(_M,"").match(wM);l&&n.push({v:mr(l[2]),t:l[1]})}),n}var dS=/(^\s|\s$|\n)/;function ka(e,t){return"<"+e+(t.match(dS)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Cu(e){return Vr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function We(e,t,r){return"<"+e+(r!=null?Cu(r):"")+(t!=null?(t.match(dS)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function w1(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function bM(e,t){switch(typeof e){case"string":var r=We("vt:lpwstr",or(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return We((e|0)==e?"vt:i4":"vt:r8",or(String(e)));case"boolean":return We("vt:bool",e?"true":"false")}if(e instanceof Date)return We("vt:filetime",w1(e));throw new Error("Unable to serialize "+e)}function pg(e){if(Pt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return mr(zi(ug(e)));throw new Error("Bad input format: expected Buffer or string")}var Nu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,oa={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Oo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],un={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function SM(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,o=5;o>=0;--o)n=n*256+e[t+o];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function EM(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,o=0,l=a?-t:t;isFinite(l)?l==0?n=o=0:(n=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-n),n<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?n=-1022:(o-=Math.pow(2,52),n+=1023)):(n=2047,o=isNaN(t)?26985:0);for(var u=0;u<=5;++u,o/=256)e[r+u]=o&255;e[r+6]=(n&15)<<4|o&15,e[r+7]=n>>4|a}var J_=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,o=e[0][a].length;n<o;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},Q_=Pt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Xs(t)})):J_(e)}:J_,Z_=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(Hs(e,n)));return a.join("").replace(Va,"")},yg=Pt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Va,""):Z_(e,t,r)}:Z_,ew=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},hS=Pt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ew(e,t,r)}:ew,tw=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(jl(e,n)));return a.join("")},Gu=Pt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):tw(t,r,a)}:tw,mS=function(e,t){var r=fn(e,t);return r>0?Gu(e,t+4,t+4+r-1):""},gS=mS,xS=function(e,t){var r=fn(e,t);return r>0?Gu(e,t+4,t+4+r-1):""},vS=xS,pS=function(e,t){var r=2*fn(e,t);return r>0?Gu(e,t+4,t+4+r-1):""},yS=pS,_S=function(t,r){var a=fn(t,r);return a>0?yg(t,r+4,r+4+a):""},wS=_S,bS=function(e,t){var r=fn(e,t);return r>0?Gu(e,t+4,t+4+r):""},SS=bS,ES=function(e,t){return SM(e,t)},B0=ES,_g=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Pt&&(gS=function(t,r){if(!Buffer.isBuffer(t))return mS(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},vS=function(t,r){if(!Buffer.isBuffer(t))return xS(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},yS=function(t,r){if(!Buffer.isBuffer(t))return pS(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},wS=function(t,r){if(!Buffer.isBuffer(t))return _S(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},SS=function(t,r){if(!Buffer.isBuffer(t))return bS(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},B0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):ES(t,r)},_g=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var jl=function(e,t){return e[t]},Hs=function(e,t){return e[t+1]*256+e[t]},TM=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},fn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},xo=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},kM=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ou(e,t){var r="",a,n,o=[],l,u,f,h;switch(t){case"dbcs":if(h=this.l,Pt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)r+=String.fromCharCode(Hs(this,h)),h+=2;e*=2;break;case"utf8":r=Gu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=yg(this,this.l,this.l+e);break;case"wstr":return ou.call(this,e,"dbcs");case"lpstr-ansi":r=gS(this,this.l),e=4+fn(this,this.l);break;case"lpstr-cp":r=vS(this,this.l),e=4+fn(this,this.l);break;case"lpwstr":r=yS(this,this.l),e=4+2*fn(this,this.l);break;case"lpp4":e=4+fn(this,this.l),r=wS(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+fn(this,this.l),r=SS(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=jl(this,this.l+e++))!==0;)o.push(x0(l));r=o.join("");break;case"_wstr":for(e=0,r="";(l=Hs(this,this.l+e))!==0;)o.push(x0(l)),e+=2;e+=2,r=o.join("");break;case"dbcs-cont":for(r="",h=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return l=jl(this,h),this.l=h+1,u=ou.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(x0(Hs(this,h))),h+=2}r=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return l=jl(this,h),this.l=h+1,u=ou.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(x0(jl(this,h))),h+=1}r=o.join("");break;default:switch(e){case 1:return a=jl(this,this.l),this.l++,a;case 2:return a=(t==="i"?TM:Hs)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?xo:kM)(this,this.l),this.l+=4,a):(n=fn(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=B0(this,this.l):n=B0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=hS(this,this.l,e);break}}return this.l+=e,r}var AM=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},CM=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},NM=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function DM(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)NM(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var l=t.charCodeAt(n);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,AM(this,t,this.l);break;case 8:if(a=8,r==="f"){EM(this,t,this.l);break}case 16:break;case-4:a=4,CM(this,t,this.l);break}return this.l+=a,this}function TS(e,t){var r=hS(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Sa(e,t){e.l=t,e.read_shift=ou,e.chk=TS,e.write_shift=DM}function Pa(e,t){e.l+=t}function Ne(e){var t=Ii(e);return Sa(t,0),t}function Ks(e,t,r){if(e){var a,n,o;Sa(e,e.l||0);for(var l=e.length,u=0,f=0;e.l<l;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var h=ju[u]||ju[65535];for(a=e.read_shift(1),o=a&127,n=1;n<4&&a&128;++n)o+=((a=e.read_shift(1))&127)<<7*n;f=e.l+o;var g=h.f&&h.f(e,o,r);if(e.l=f,t(g,h,u))return}}}function Ka(){var e=[],t=Pt?256:2048,r=function(h){var g=Ne(h);return Sa(g,0),g},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},o=function(h){return a&&h<a.length-a.l?a:(n(),a=r(Math.max(h+1,t)))},l=function(){return n(),ma(e)},u=function(h){n(),a=h,a.l==null&&(a.l=a.length),o(t)};return{next:o,push:u,end:l,_bufs:e}}function Be(e,t,r,a){var n=+t,o;if(!isNaN(n)){a||(a=ju[n].p||(r||[]).length||0),o=1+(n>=128?1:0)+1,a>=128&&++o,a>=16384&&++o,a>=2097152&&++o;var l=e.next(o);n<=127?l.write_shift(1,n):(l.write_shift(1,(n&127)+128),l.write_shift(1,n>>7));for(var u=0;u!=4;++u)if(a>=128)l.write_shift(1,(a&127)+128),a>>=7;else{l.write_shift(1,a);break}a>0&&_g(r)&&e.push(r)}}function lu(e,t,r){var a=Cr(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function rw(e,t,r){var a=Cr(e);return a.s=lu(a.s,t.s,r),a.e=lu(a.e,t.s,r),a}function cu(e,t){if(e.cRel&&e.c<0)for(e=Cr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Cr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=bt(e);return!e.cRel&&e.cRel!=null&&(r=FM(r)),!e.rRel&&e.rRel!=null&&(r=OM(r)),r}function Um(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+jr(e.s.c)+":"+(e.e.cRel?"":"$")+jr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+qr(e.s.r)+":"+(e.e.rRel?"":"$")+qr(e.e.r):cu(e.s,t.biff)+":"+cu(e.e,t.biff)}function wg(e){return parseInt(RM(e),10)-1}function qr(e){return""+(e+1)}function OM(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function RM(e){return e.replace(/\$(\d+)$/,"$1")}function bg(e){for(var t=MM(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function jr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function FM(e){return e.replace(/^([A-Z])/,"$$$1")}function MM(e){return e.replace(/^\$([A-Z])/,"$1")}function jM(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ir(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function bt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ja(e){var t=e.indexOf(":");return t==-1?{s:Ir(e),e:Ir(e)}:{s:Ir(e.slice(0,t)),e:Ir(e.slice(t+1))}}function Rt(e,t){return typeof t>"u"||typeof t=="number"?Rt(e.s,e.e):(typeof e!="string"&&(e=bt(e)),typeof t!="string"&&(t=bt(t)),e==t?e:e+":"+t)}function Xt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,o=e.length;for(r=0;a<o&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<o&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===o||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=o&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=o&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function aw(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Pn(e.z,r?la(t):t)}catch{}try{return e.w=Pn((e.XF||{}).numFmtId||(r?14:0),r?la(t):t)}catch{return""+t}}function qs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Js[e.v]||e.v:t==null?aw(e,e.v):aw(e,t))}function Vi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function kS(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,o=e||(n?[]:{}),l=0,u=0;if(o&&a.origin!=null){if(typeof a.origin=="number")l=a.origin;else{var f=typeof a.origin=="string"?Ir(a.origin):a.origin;l=f.r,u=f.c}o["!ref"]||(o["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var g=Xt(o["!ref"]);h.s.c=g.s.c,h.s.r=g.s.r,h.e.c=Math.max(h.e.c,g.e.c),h.e.r=Math.max(h.e.r,g.e.r),l==-1&&(h.e.r=l=g.e.r+1)}for(var v=0;v!=t.length;++v)if(t[v]){if(!Array.isArray(t[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[v].length;++p)if(!(typeof t[v][p]>"u")){var _={v:t[v][p]},b=l+v,w=u+p;if(h.s.r>b&&(h.s.r=b),h.s.c>w&&(h.s.c=w),h.e.r<b&&(h.e.r=b),h.e.c<w&&(h.e.c=w),t[v][p]&&typeof t[v][p]=="object"&&!Array.isArray(t[v][p])&&!(t[v][p]instanceof Date))_=t[v][p];else if(Array.isArray(_.v)&&(_.f=t[v][p][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(a.nullError)_.t="e",_.v=0;else if(a.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=a.dateNF||wt[14],a.cellDates?(_.t="d",_.w=Pn(_.z,la(_.v))):(_.t="n",_.v=la(_.v),_.w=Pn(_.z,_.v))):_.t="s";if(n)o[b]||(o[b]=[]),o[b][w]&&o[b][w].z&&(_.z=o[b][w].z),o[b][w]=_;else{var S=bt({c:w,r:b});o[S]&&o[S].z&&(_.z=o[S].z),o[S]=_}}}return h.s.c<1e7&&(o["!ref"]=Rt(h)),o}function Zl(e,t){return kS(null,e,t)}function IM(e){return e.read_shift(4,"i")}function as(e,t){return t||(t=Ne(4)),t.write_shift(4,e),t}function Ia(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function ga(e,t){var r=!1;return t==null&&(r=!0,t=Ne(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function PM(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function LM(e,t){return t||(t=Ne(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Sg(e,t){var r=e.l,a=e.read_shift(1),n=Ia(e),o=[],l={t:n,h:n};if((a&1)!==0){for(var u=e.read_shift(4),f=0;f!=u;++f)o.push(PM(e));l.r=o}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function BM(e,t){var r=!1;return t==null&&(r=!0,t=Ne(15+4*e.t.length)),t.write_shift(1,0),ga(e.t,t),r?t.slice(0,t.l):t}var UM=Sg;function zM(e,t){var r=!1;return t==null&&(r=!0,t=Ne(23+4*e.t.length)),t.write_shift(1,1),ga(e.t,t),t.write_shift(4,1),LM({},t),r?t.slice(0,t.l):t}function Ln(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ro(e,t){return t==null&&(t=Ne(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Fo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Mo(e,t){return t==null&&(t=Ne(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var VM=Ia,AS=ga;function Eg(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function U0(e,t){var r=!1;return t==null&&(r=!0,t=Ne(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var HM=Ia,b1=Eg,Tg=U0;function kg(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?B0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):xo(t,0)>>2;return r?n/100:n}function CS(e,t){t==null&&(t=Ne(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function NS(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function $M(e,t){return t||(t=Ne(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var jo=NS,ec=$M;function ja(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ko(e,t){return(t||Ne(8)).write_shift(8,e,"f")}function WM(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),o=e.read_shift(2,"i"),l=e.read_shift(1),u=e.read_shift(1),f=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var h=_o[n];h&&(t.rgb=Ou(h));break;case 2:t.rgb=Ou([l,u,f]);break;case 3:t.theme=n;break}return o!=0&&(t.tint=o>0?o/32767:o/32768),t}function z0(e,t){if(t||(t=Ne(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function GM(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function qM(e,t){t||(t=Ne(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function DS(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function YM(e){return DS(e,1)}function XM(e){return DS(e,2)}var Ag=2,Ya=3,p0=11,nw=12,V0=19,y0=64,KM=65,JM=71,QM=4108,ZM=4126,ha=80,OS=81,ej=[ha,OS],S1={1:{n:"CodePage",t:Ag},2:{n:"Category",t:ha},3:{n:"PresentationFormat",t:ha},4:{n:"ByteCount",t:Ya},5:{n:"LineCount",t:Ya},6:{n:"ParagraphCount",t:Ya},7:{n:"SlideCount",t:Ya},8:{n:"NoteCount",t:Ya},9:{n:"HiddenCount",t:Ya},10:{n:"MultimediaClipCount",t:Ya},11:{n:"ScaleCrop",t:p0},12:{n:"HeadingPairs",t:QM},13:{n:"TitlesOfParts",t:ZM},14:{n:"Manager",t:ha},15:{n:"Company",t:ha},16:{n:"LinksUpToDate",t:p0},17:{n:"CharacterCount",t:Ya},19:{n:"SharedDoc",t:p0},22:{n:"HyperlinksChanged",t:p0},23:{n:"AppVersion",t:Ya,p:"version"},24:{n:"DigSig",t:KM},26:{n:"ContentType",t:ha},27:{n:"ContentStatus",t:ha},28:{n:"Language",t:ha},29:{n:"Version",t:ha},255:{},2147483648:{n:"Locale",t:V0},2147483651:{n:"Behavior",t:V0},1919054434:{}},E1={1:{n:"CodePage",t:Ag},2:{n:"Title",t:ha},3:{n:"Subject",t:ha},4:{n:"Author",t:ha},5:{n:"Keywords",t:ha},6:{n:"Comments",t:ha},7:{n:"Template",t:ha},8:{n:"LastAuthor",t:ha},9:{n:"RevNumber",t:ha},10:{n:"EditTime",t:y0},11:{n:"LastPrinted",t:y0},12:{n:"CreatedDate",t:y0},13:{n:"ModifiedDate",t:y0},14:{n:"PageCount",t:Ya},15:{n:"WordCount",t:Ya},16:{n:"CharCount",t:Ya},17:{n:"Thumbnail",t:JM},18:{n:"Application",t:ha},19:{n:"DocSecurity",t:Ya},255:{},2147483648:{n:"Locale",t:V0},2147483651:{n:"Behavior",t:V0},1919054434:{}},sw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},tj=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function rj(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var aj=rj([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),_o=Cr(aj),Js={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},T1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},_0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Cg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function nj(e){var t=Cg();if(!e||!e.match)return t;var r={};if((e.match(La)||[]).forEach(function(a){var n=Tt(a);switch(n[0].replace(mM,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[T1[n.ContentType]]!==void 0&&t[T1[n.ContentType]].push(n.PartName);break}}),t.xmlns!==oa.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function FS(e,t){var r=nM(T1),a=[],n;a[a.length]=Yr,a[a.length]=We("Types",null,{xmlns:oa.CT,"xmlns:xsd":oa.xsd,"xmlns:xsi":oa.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return We("Default",null,{Extension:f[0],ContentType:f[1]})}));var o=function(f){e[f]&&e[f].length>0&&(n=e[f][0],a[a.length]=We("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:_0[f][t.bookType]||_0[f].xlsx}))},l=function(f){(e[f]||[]).forEach(function(h){a[a.length]=We("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:_0[f][t.bookType]||_0[f].xlsx})})},u=function(f){(e[f]||[]).forEach(function(h){a[a.length]=We("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[f][0]})})};return o("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Du(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function uu(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(La)||[]).forEach(function(n){var o=Tt(n);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:au(o.Target,t);r[u]=l,a[o.Id]=l}}),r["!id"]=a,r}function Vl(e){var t=[Yr,We("Relationships",null,{xmlns:oa.RELS})];return Vr(e["!id"]).forEach(function(r){t[t.length]=We("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function sr(e,t,r,a,n,o){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,[Bt.HLINK,Bt.XPATH,Bt.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var sj="application/vnd.oasis.opendocument.spreadsheet";function ij(e,t){for(var r=pg(e),a,n;a=Nu.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=Tt(a[0],!1),n.path=="/"&&n.type!==sj)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function oj(e){var t=[Yr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function iw(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function lj(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function cj(e){var t=[Yr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(iw(e[r][0],e[r][1])),t.push(lj("",e[r][0]));return t.push(iw("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function MS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+M0.version+"</meta:generator></office:meta></office:document-meta>"}var In=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],uj=function(){for(var e=new Array(In.length),t=0;t<In.length;++t){var r=In[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function jS(e){var t={};e=mr(e);for(var r=0;r<In.length;++r){var a=In[r],n=e.match(uj[r]);n!=null&&n.length>0&&(t[a[1]]=Yt(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=Ar(t[a[1]]))}return t}function zm(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=or(t),a[a.length]=r?We(e,t,r):ka(e,t))}function IS(e,t){var r=t||{},a=[Yr,We("cp:coreProperties",null,{"xmlns:cp":oa.CORE_PROPS,"xmlns:dc":oa.dc,"xmlns:dcterms":oa.dcterms,"xmlns:dcmitype":oa.dcmitype,"xmlns:xsi":oa.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&zm("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:w1(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&zm("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:w1(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var o=0;o!=In.length;++o){var l=In[o],u=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&zm(l[0],u,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var wo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],PS=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function LS(e,t,r,a){var n=[];if(typeof e=="string")n=K_(e,a);else for(var o=0;o<e.length;++o)n=n.concat(e[o].map(function(g){return{v:g}}));var l=typeof t=="string"?K_(t,a).map(function(g){return g.v}):t,u=0,f=0;if(l.length>0)for(var h=0;h!==n.length;h+=2){switch(f=+n[h+1].v,n[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=l.slice(u,u+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=f,r.DefinedNames=l.slice(u,u+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=l.slice(u,u+f);break}u+=f}}function fj(e,t,r){var a={};return t||(t={}),e=mr(e),wo.forEach(function(n){var o=(e.match(Au(n[0]))||[])[1];switch(n[2]){case"string":o&&(t[n[1]]=Yt(o));break;case"bool":t[n[1]]=o==="true";break;case"raw":var l=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));l&&l.length>0&&(a[n[1]]=l[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&LS(a.HeadingPairs,a.TitlesOfParts,t,r),t}function BS(e){var t=[],r=We;return e||(e={}),e.Application="SheetJS",t[t.length]=Yr,t[t.length]=We("Properties",null,{xmlns:oa.EXT_PROPS,"xmlns:vt":oa.vt}),wo.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=or(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+or(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var dj=/<[^>]+>[^<]*/g;function hj(e,t){var r={},a="",n=e.match(dj);if(n)for(var o=0;o!=n.length;++o){var l=n[o],u=Tt(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Yt(u.name);break;case"</property>":a=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),h=f[0].slice(4),g=f[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[a]=Yt(g);break;case"bool":r[a]=kr(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(g,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(g);break;case"filetime":case"date":r[a]=Ar(g);break;case"cy":case"error":r[a]=Yt(g);break;default:if(h.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,h,f)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function US(e){var t=[Yr,We("Properties",null,{xmlns:oa.CUST_PROPS,"xmlns:vt":oa.vt})];if(!e)return t.join("");var r=1;return Vr(e).forEach(function(n){++r,t[t.length]=We("property",bM(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:or(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var k1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Vm;function mj(e,t,r){Vm||(Vm=od(k1)),t=Vm[t]||t,e[t]=r}function gj(e,t){var r=[];return Vr(k1).map(function(a){for(var n=0;n<In.length;++n)if(In[n][1]==a)return In[n];for(n=0;n<wo.length;++n)if(wo[n][1]==a)return wo[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(ka(k1[a[1]]||a[1],n))}}),We("DocumentProperties",r.join(""),{xmlns:un.o})}function xj(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&Vr(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)){for(var l=0;l<In.length;++l)if(o==In[l][1])return;for(l=0;l<wo.length;++l)if(o==wo[l][1])return;for(l=0;l<r.length;++l)if(o==r[l])return;var u=e[o],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),n.push(We(G_(o),u,{"dt:dt":f}))}}),t&&Vr(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)&&!(e&&Object.prototype.hasOwnProperty.call(e,o))){var l=t[o],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),n.push(We(G_(o),l,{"dt:dt":u}))}}),"<"+a+' xmlns="'+un.o+'">'+n.join("")+"</"+a+">"}function Ng(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function vj(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var o=a/Math.pow(2,32)|0;o>0&&(a=a%Math.pow(2,32),n+=o);var l=Ne(8);return l.write_shift(4,a),l.write_shift(4,n),l}function zS(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function VS(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function HS(e,t,r){return t===31?VS(e):zS(e,t,r)}function A1(e,t,r){return HS(e,t,r===!1?0:4)}function pj(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return HS(e,t,0)}function yj(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Va,""),e.l-n&2&&(e.l+=2)}return r}function _j(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Va,"");return r}function wj(e){var t=e.l,r=H0(e,OS);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=H0(e,Ya);return[r,a]}function bj(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(wj(e));return r}function ow(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var o=e.read_shift(4),l=e.read_shift(4);a[o]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(Va,"").replace(ru,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function $S(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function Sj(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function H0(e,t,r){var a=e.read_shift(2),n,o=r||{};if(e.l+=2,t!==nw&&a!==t&&ej.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===nw?a:t){case 2:return n=e.read_shift(2,"i"),o.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return zS(e,a,4).replace(Va,"");case 31:return VS(e);case 64:return Ng(e);case 65:return $S(e);case 71:return Sj(e);case 80:return A1(e,a,!o.raw).replace(Va,"");case 81:return pj(e,a).replace(Va,"");case 4108:return bj(e);case 4126:case 4127:return a==4127?yj(e):_j(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function lw(e,t){var r=Ne(4),a=Ne(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=Ne(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=vj(t);break;case 31:case 80:for(a=Ne(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ma([r,a])}function cw(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),o=[],l=0,u=0,f=-1,h={};for(l=0;l!=n;++l){var g=e.read_shift(4),v=e.read_shift(4);o[l]=[g,v+r]}o.sort(function(N,k){return N[1]-k[1]});var p={};for(l=0;l!=n;++l){if(e.l!==o[l][1]){var _=!0;if(l>0&&t)switch(t[o[l-1][0]].t){case 2:e.l+2===o[l][1]&&(e.l+=2,_=!1);break;case 80:e.l<=o[l][1]&&(e.l=o[l][1],_=!1);break;case 4108:e.l<=o[l][1]&&(e.l=o[l][1],_=!1);break}if((!t||l==0)&&e.l<=o[l][1]&&(_=!1,e.l=o[l][1]),_)throw new Error("Read Error: Expected address "+o[l][1]+" at "+e.l+" :"+l)}if(t){var b=t[o[l][0]];if(p[b.n]=H0(e,b.t,{raw:!0}),b.p==="version"&&(p[b.n]=String(p[b.n]>>16)+"."+("0000"+String(p[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(p[b.n]){case 0:p[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:es(u=p[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[b.n])}}else if(o[l][0]===1){if(u=p.CodePage=H0(e,Ag),es(u),f!==-1){var w=e.l;e.l=o[f][1],h=ow(e,u),e.l=w}}else if(o[l][0]===0){if(u===0){f=l,e.l=o[l+1][1];continue}h=ow(e,u)}else{var S=h[o[l][0]],T;switch(e[e.l]){case 65:e.l+=4,T=$S(e);break;case 30:e.l+=4,T=A1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,T=A1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,T=e.read_shift(4,"i");break;case 19:e.l+=4,T=e.read_shift(4);break;case 5:e.l+=4,T=e.read_shift(8,"f");break;case 11:e.l+=4,T=Wr(e,4);break;case 64:e.l+=4,T=Ar(Ng(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[S]=T}}return e.l=r+a,p}var WS=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Ej(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function uw(e,t,r){var a=Ne(8),n=[],o=[],l=8,u=0,f=Ne(8),h=Ne(8);if(f.write_shift(4,2),f.write_shift(4,1200),h.write_shift(4,1),o.push(f),n.push(h),l+=8+f.length,!t){h=Ne(8),h.write_shift(4,0),n.unshift(h);var g=[Ne(4)];for(g[0].write_shift(4,e.length),u=0;u<e.length;++u){var v=e[u][0];for(f=Ne(8+2*(v.length+1)+(v.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,v.length+1),f.write_shift(0,v,"dbcs");f.l!=f.length;)f.write_shift(1,0);g.push(f)}f=ma(g),o.unshift(f),l+=8+f.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(WS.indexOf(e[u][0])>-1||PS.indexOf(e[u][0])>-1)&&e[u][1]!=null){var p=e[u][1],_=0;if(t){_=+t[e[u][0]];var b=r[_];if(b.p=="version"&&typeof p=="string"){var w=p.split(".");p=(+w[0]<<16)+(+w[1]||0)}f=lw(b.t,p)}else{var S=Ej(p);S==-1&&(S=31,p=String(p)),f=lw(S,p)}o.push(f),h=Ne(8),h.write_shift(4,t?_:2+u),n.push(h),l+=8+f.length}var T=8*(o.length+1);for(u=0;u<o.length;++u)n[u].write_shift(4,T),T+=o[u].length;return a.write_shift(4,l),a.write_shift(4,o.length),ma([a].concat(n).concat(o))}function fw(e,t,r){var a=e.content;if(!a)return{};Sa(a,0);var n,o,l,u,f=0;a.chk("feff","Byte Order: "),a.read_shift(2);var h=a.read_shift(4),g=a.read_shift(16);if(g!==mt.utils.consts.HEADER_CLSID&&g!==r)throw new Error("Bad PropertySet CLSID "+g);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(o=a.read_shift(16),u=a.read_shift(4),n===1&&u!==a.l)throw new Error("Length mismatch: "+u+" !== "+a.l);n===2&&(l=a.read_shift(16),f=a.read_shift(4));var v=cw(a,t),p={SystemIdentifier:h};for(var _ in v)p[_]=v[_];if(p.FMTID=o,n===1)return p;if(f-a.l==2&&(a.l+=2),a.l!==f)throw new Error("Length mismatch 2: "+a.l+" !== "+f);var b;try{b=cw(a,null)}catch{}for(_ in b)p[_]=b[_];return p.FMTID=[o,l],p}function dw(e,t,r,a,n,o){var l=Ne(n?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,mt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,n?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,n?68:48);var f=uw(e,r,a);if(u.push(f),n){var h=uw(n,null,null);l.write_shift(16,o,"hex"),l.write_shift(4,68+f.length),u.push(h)}return ma(u)}function Ti(e,t){return e.read_shift(t),null}function Tj(e,t){t||(t=Ne(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function kj(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function Wr(e,t){return e.read_shift(t)===1}function za(e,t){return t||(t=Ne(2)),t.write_shift(2,+!!e),t}function ta(e){return e.read_shift(2,"u")}function Mn(e,t){return t||(t=Ne(2)),t.write_shift(2,e),t}function GS(e,t){return kj(e,t,ta)}function Aj(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function qS(e,t,r){return r||(r=Ne(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function qu(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var o=e.read_shift(1);o&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var l=a?e.read_shift(a,n):"";return l}function Cj(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,n=r&8,o=1+(r&1),l=0,u,f={};n&&(l=e.read_shift(2)),a&&(u=e.read_shift(4));var h=o==2?"dbcs-cont":"sbcs-cont",g=t===0?"":e.read_shift(t,h);return n&&(e.l+=4*l),a&&(e.l+=u),f.t=g,n||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function Nj(e){var t=e.t||"",r=Ne(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=Ne(2*t.length);a.write_shift(2*t.length,t,"utf16le");var n=[r,a];return ma(n)}function Ao(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function Yu(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Ao(e,a,r)}function Io(e,t,r){if(r.biff>5)return Yu(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function YS(e,t,r){return r||(r=Ne(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Dj(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function Oj(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Va,"");return a&&(e.l+=24),n}function Rj(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(o>>1,"utf16le").replace(Va,"");return r+l}function Fj(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Oj(e);case"0303000000000000c000000000000046":return Rj(e);default:throw new Error("Unsupported Moniker "+r)}}function w0(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Va,""):"";return r}function hw(e,t){t||(t=Ne(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Mj(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var o,l,u,f,h="",g,v;n&16&&(o=w0(e,r-e.l)),n&128&&(l=w0(e,r-e.l)),(n&257)===257&&(u=w0(e,r-e.l)),(n&257)===1&&(f=Fj(e,r-e.l)),n&8&&(h=w0(e,r-e.l)),n&32&&(g=e.read_shift(16)),n&64&&(v=Ng(e)),e.l=r;var p=l||u||f||"";p&&h&&(p+="#"+h),p||(p="#"+h),n&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var _={Target:p};return g&&(_.guid=g),v&&(_.time=v),o&&(_.Tooltip=o),_}function jj(e){var t=Ne(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),o=n>-1?31:23;switch(a.charAt(0)){case"#":o=28;break;case".":o&=-3;break}t.write_shift(4,2),t.write_shift(4,o);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(o==28)a=a.slice(1),hw(a,t);else if(o&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var u=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)t.write_shift(2,u.charCodeAt(r));t.write_shift(2,0),o&8&&hw(n>-1?a.slice(n+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var f=0;a.slice(f*3,f*3+3)=="../"||a.slice(f*3,f*3+3)=="..\\";)++f;for(t.write_shift(2,f),t.write_shift(4,a.length-3*f+1),r=0;r<a.length-3*f;++r)t.write_shift(1,a.charCodeAt(r+3*f)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function XS(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function KS(e,t){var r=XS(e);return r[3]=0,r}function bs(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function Co(e,t,r,a){return a||(a=Ne(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function Ij(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Pj(e,t,r){return t===0?"":Io(e,t,r)}function Lj(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),o=e.read_shift(a,"i"),l=e.read_shift(a,"i");return[n,o,l]}function JS(e){var t=e.read_shift(2),r=kg(e);return[t,r]}function Bj(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=qu(e,t,r),o=e.read_shift(2);if(a-=e.l,o!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+o);return e.l+=o,n}function ud(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function QS(e,t){return t||(t=Ne(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function ZS(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var Uj=ZS;function eE(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function zj(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Vj(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ca(e){e.l+=2,e.l+=e.read_shift(2)}var Hj={0:Ca,4:Ca,5:Ca,6:Ca,7:Vj,8:Ca,9:Ca,10:Ca,11:Ca,12:Ca,13:zj,14:Ca,15:Ca,16:Ca,17:Ca,18:Ca,19:Ca,20:Ca,21:eE};function $j(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(Hj[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function b0(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Dg(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=Ne(n);return o.write_shift(2,a),o.write_shift(2,t),n>4&&o.write_shift(2,29282),n>6&&o.write_shift(2,1997),n>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function Wj(e,t){return t===0||e.read_shift(2),1200}function Gj(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=Io(e,0,r);return e.read_shift(t+a-e.l),n}function qj(e,t){var r=!t||t.biff==8,a=Ne(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function Yj(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function Xj(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=qu(e,0,r);return l.length===0&&(l="Sheet1"),{pos:a,hs:n,dt:o,name:l}}function Kj(e,t){var r=!t||t.biff>=8?2:1,a=Ne(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function Jj(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),o=[],l=0;l!=n&&e.l<r;++l)o.push(Cj(e));return o.Count=a,o.Unique=n,o}function Qj(e,t){var r=Ne(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=Nj(e[n]);var o=ma([r].concat(a));return o.parts=[r.length].concat(a.map(function(l){return l.length})),o}function Zj(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function eI(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function tI(e){var t=Ij(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function rI(e){return e.read_shift(2),e.read_shift(4)}function mw(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var o={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[o,n]}function aI(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),f=e.read_shift(2),h=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:o,CurTab:l,FirstTab:u,Selected:f,TabRatio:h}}function nI(){var e=Ne(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function sI(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function iI(e){var t=Ne(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function oI(){}function lI(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=qu(e,0,r),a}function cI(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,o=Ne(n);return o.write_shift(2,e.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,r.length),a||o.write_shift(1,1),o.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),o}function uI(e){var t=bs(e);return t.isst=e.read_shift(4),t}function fI(e,t,r,a){var n=Ne(10);return Co(e,t,a,n),n.write_shift(4,r),n}function dI(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=bs(e);r.biff==2&&e.l++;var o=Yu(e,a-e.l,r);return n.val=o,n}function hI(e,t,r,a,n){var o=!n||n.biff==8,l=Ne(8+ +o+(1+o)*r.length);return Co(e,t,a,l),l.write_shift(2,r.length),o&&l.write_shift(1,1),l.write_shift((1+o)*r.length,r,o?"utf16le":"sbcs"),l}function mI(e,t,r){var a=e.read_shift(2),n=Io(e,0,r);return[a,n]}function gI(e,t,r,a){var n=r&&r.biff==5;a||(a=Ne(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var o=a.length>a.l?a.slice(0,a.l):a;return o.l==null&&(o.l=o.length),o}var xI=Io;function gw(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,o=e.read_shift(n),l=e.read_shift(n),u=e.read_shift(2),f=e.read_shift(2);return e.l=a,{s:{r:o,c:u},e:{r:l,c:f}}}function vI(e,t){var r=t.biff==8||!t.biff?4:2,a=Ne(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function pI(e){var t=e.read_shift(2),r=e.read_shift(2),a=JS(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function yI(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),o=[];e.l<r;)o.push(JS(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(o.length!=l-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:l,rkrec:o}}function _I(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),o=[];e.l<r;)o.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(o.length!=l-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:l,ixfe:o}}function wI(e,t,r,a){var n={},o=e.read_shift(4),l=e.read_shift(4),u=e.read_shift(4),f=e.read_shift(2);return n.patternType=tj[u>>26],a.cellStyles&&(n.alc=o&7,n.fWrap=o>>3&1,n.alcV=o>>4&7,n.fJustLast=o>>7&1,n.trot=o>>8&255,n.cIndent=o>>16&15,n.fShrinkToFit=o>>20&1,n.iReadOrder=o>>22&2,n.fAtrNum=o>>26&1,n.fAtrFnt=o>>27&1,n.fAtrAlc=o>>28&1,n.fAtrBdr=o>>29&1,n.fAtrPat=o>>30&1,n.fAtrProt=o>>31&1,n.dgLeft=l&15,n.dgRight=l>>4&15,n.dgTop=l>>8&15,n.dgBottom=l>>12&15,n.icvLeft=l>>16&127,n.icvRight=l>>23&127,n.grbitDiag=l>>30&3,n.icvTop=u&127,n.icvBottom=u>>7&127,n.icvDiag=u>>14&127,n.dgDiag=u>>21&15,n.icvFore=f&127,n.icvBack=f>>7&127,n.fsxButton=f>>14&1),n}function bI(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=wI(e,t,a.fStyle,r),a}function xw(e,t,r,a){var n=r&&r.biff==5;a||(a=Ne(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var o=0;return e.numFmtId>0&&n&&(o|=1024),a.write_shift(4,o),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function SI(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function EI(e){var t=Ne(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function vw(e,t,r){var a=bs(e);(r.biff==2||t==9)&&++e.l;var n=Aj(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function TI(e,t,r,a,n,o){var l=Ne(8);return Co(e,t,a,l),qS(r,o,l),l}function kI(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=bs(e),n=ja(e);return a.val=n,a}function AI(e,t,r,a){var n=Ne(14);return Co(e,t,a,n),ko(r,n),n}var pw=Pj;function CI(e,t,r){var a=e.l+t,n=e.read_shift(2),o=e.read_shift(2);if(r.sbcch=o,o==1025||o==14849)return[o,n];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=Ao(e,o),u=[];a>e.l;)u.push(Yu(e));return[o,n,l,u]}function yw(e,t,r){var a=e.read_shift(2),n,o={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=Bj(e,t-2,r)),o.body=n||e.read_shift(t-2),typeof n=="string"&&(o.Name=n),o}var NI=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function _w(e,t,r){var a=e.l+t,n=e.read_shift(2),o=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),f=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var h=Ao(e,l,r);n&32&&(h=NI[h.charCodeAt(0)]);var g=a-e.l;r&&r.biff==2&&--g;var v=a==e.l||u===0||!(g>0)?[]:$L(e,g,r,u);return{chKey:o,Name:h,itab:f,rgce:v}}function tE(e,t,r){if(r.biff<8)return DI(e,t,r);for(var a=[],n=e.l+t,o=e.read_shift(r.biff>8?4:2);o--!==0;)a.push(Lj(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function DI(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=qu(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function OI(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),o=Ao(e,a,r),l=Ao(e,n,r);return[o,l]}function RI(e,t,r){var a=ZS(e);e.l++;var n=e.read_shift(1);return t-=8,[WL(e,t,r),n,a]}function ww(e,t,r){var a=Uj(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,VL(e,t,r)]}function FI(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function MI(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=Io(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},u,l,o]}}function jI(e,t,r){return MI(e,t,r)}function II(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(ud(e));return r}function PI(e){var t=Ne(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)QS(e[r],t);return t}function LI(e,t,r){if(r&&r.biff<8)return UI(e,t,r);var a=eE(e),n=$j(e,t-22,a[1]);return{cmo:a,ft:n}}var BI={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function UI(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((BI[a]||Pa)(e,t,r)),{cmo:[n,a,o],ft:l}}function zI(e,t,r){var a=e.l,n="";try{e.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:l=Dj(e,6,r);var u=e.read_shift(2);e.read_shift(2),ta(e,2);var f=e.read_shift(2);e.l+=f;for(var h=1;h<e.lens.length-1;++h){if(e.l-a!=e.lens[h])throw new Error("TxO: bad continue record");var g=e[e.l],v=Ao(e,e.lens[h+1]-e.lens[h]-1);if(n+=v,n.length>=(g?u:2*u))break}if(n.length!==u&&n.length!==u*2)throw new Error("cchText: "+u+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function VI(e,t){var r=ud(e);e.l+=16;var a=Mj(e,t-24);return[r,a]}function HI(e){var t=Ne(24),r=Ir(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return ma([t,jj(e[1])])}function $I(e,t){e.read_shift(2);var r=ud(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Va,""),[r,a]}function WI(e){var t=e[1].Tooltip,r=Ne(10+2*(t.length+1));r.write_shift(2,2048);var a=Ir(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function GI(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=sw[r]||r,r=e.read_shift(2),t[1]=sw[r]||r,t}function qI(e){return e||(e=Ne(4)),e.write_shift(2,1),e.write_shift(2,1),e}function YI(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(KS(e));return r}function XI(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(KS(e));return r}function KI(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function rE(e,t,r){if(!r.cellStyles)return Pa(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(a),u=e.read_shift(a),f=e.read_shift(2);a==2&&(e.l+=2);var h={s:n,e:o,w:l,ixfe:u,flags:f};return(r.biff>=5||!r.biff)&&(h.level=f>>8&7),h}function JI(e,t){var r=Ne(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function QI(e,t){var r={};return t<32||(e.l+=16,r.header=ja(e),r.footer=ja(e),e.l+=2),r}function ZI(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function eP(e){for(var t=Ne(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var tP=bs,rP=GS,aP=Yu;function nP(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function sP(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=bs(e);++e.l;var n=Io(e,t-7,r);return a.t="str",a.val=n,a}function iP(e){var t=bs(e);++e.l;var r=ja(e);return t.t="n",t.val=r,t}function oP(e,t,r){var a=Ne(15);return Qu(a,e,t),a.write_shift(8,r,"f"),a}function lP(e){var t=bs(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function cP(e,t,r){var a=Ne(9);return Qu(a,e,t),a.write_shift(2,r),a}function uP(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function fP(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function dP(e,t,r){var a=e.l+t,n=bs(e),o=e.read_shift(2),l=Ao(e,o,r);return e.l=a,n.t="str",n.val=l,n}var hP=[2,3,48,49,131,139,140,245],C1=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=od({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,f){var h=[],g=Ii(1);switch(f.type){case"base64":g=mn(vn(u));break;case"binary":g=mn(u);break;case"buffer":case"array":g=u;break}Sa(g,0);var v=g.read_shift(1),p=!!(v&136),_=!1,b=!1;switch(v){case 2:break;case 3:break;case 48:_=!0,p=!0;break;case 49:_=!0,p=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var w=0,S=521;v==2&&(w=g.read_shift(2)),g.l+=3,v!=2&&(w=g.read_shift(4)),w>1048576&&(w=1e6),v!=2&&(S=g.read_shift(2));var T=g.read_shift(2),N=f.codepage||1252;v!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(N=e[g[g.l]]),g.l+=1,g.l+=2),b&&(g.l+=36);for(var k=[],E={},M=Math.min(g.length,v==2?521:S-10-(_?264:0)),D=b?32:11;g.l<M&&g[g.l]!=13;)switch(E={},E.name=Eu.utils.decode(N,g.slice(g.l,g.l+D)).replace(/[\u0000\r\n].*$/g,""),g.l+=D,E.type=String.fromCharCode(g.read_shift(1)),v!=2&&!b&&(E.offset=g.read_shift(4)),E.len=g.read_shift(1),v==2&&(E.offset=g.read_shift(2)),E.dec=g.read_shift(1),E.name.length&&k.push(E),v!=2&&(g.l+=b?13:14),E.type){case"B":(!_||E.len!=8)&&f.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(g[g.l]!==13&&(g.l=S-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=S;var A=0,B=0;for(h[0]=[],B=0;B!=k.length;++B)h[0][B]=k[B].name;for(;w-- >0;){if(g[g.l]===42){g.l+=T;continue}for(++g.l,h[++A]=[],B=0,B=0;B!=k.length;++B){var j=g.slice(g.l,g.l+k[B].len);g.l+=k[B].len,Sa(j,0);var ee=Eu.utils.decode(N,j);switch(k[B].type){case"C":ee.trim().length&&(h[A][B]=ee.replace(/\s+$/,""));break;case"D":ee.length===8?h[A][B]=new Date(+ee.slice(0,4),+ee.slice(4,6)-1,+ee.slice(6,8)):h[A][B]=ee;break;case"F":h[A][B]=parseFloat(ee.trim());break;case"+":case"I":h[A][B]=b?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(ee.trim().toUpperCase()){case"Y":case"T":h[A][B]=!0;break;case"N":case"F":h[A][B]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ee+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));h[A][B]="##MEMO##"+(b?parseInt(ee.trim(),10):j.read_shift(4));break;case"N":ee=ee.replace(/\u0000/g,"").trim(),ee&&ee!="."&&(h[A][B]=+ee||0);break;case"@":h[A][B]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":h[A][B]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":h[A][B]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[A][B]=-j.read_shift(-8,"f");break;case"B":if(_&&k[B].len==8){h[A][B]=j.read_shift(8,"f");break}case"G":case"P":j.l+=k[B].len;break;case"0":if(k[B].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+k[B].type)}}}if(v!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return f&&f.sheetRows&&(h=h.slice(0,f.sheetRows)),f.DBF=k,h}function a(u,f){var h=f||{};h.dateNF||(h.dateNF="yyyymmdd");var g=Zl(r(u,h),h);return g["!cols"]=h.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete h.DBF,g}function n(u,f){try{return Vi(a(u,f),f)}catch(h){if(f&&f.WTF)throw h}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,f){var h=f||{};if(+h.codepage>=0&&es(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var g=Ka(),v=q0(u,{header:1,raw:!0,cellDates:!0}),p=v[0],_=v.slice(1),b=u["!cols"]||[],w=0,S=0,T=0,N=1;for(w=0;w<p.length;++w){if(((b[w]||{}).DBF||{}).name){p[w]=b[w].DBF.name,++T;continue}if(p[w]!=null){if(++T,typeof p[w]=="number"&&(p[w]=p[w].toString(10)),typeof p[w]!="string")throw new Error("DBF Invalid column name "+p[w]+" |"+typeof p[w]+"|");if(p.indexOf(p[w])!==w){for(S=0;S<1024;++S)if(p.indexOf(p[w]+"_"+S)==-1){p[w]+="_"+S;break}}}}var k=Xt(u["!ref"]),E=[],M=[],D=[];for(w=0;w<=k.e.c-k.s.c;++w){var A="",B="",j=0,ee=[];for(S=0;S<_.length;++S)_[S][w]!=null&&ee.push(_[S][w]);if(ee.length==0||p[w]==null){E[w]="?";continue}for(S=0;S<ee.length;++S){switch(typeof ee[S]){case"number":B="B";break;case"string":B="C";break;case"boolean":B="L";break;case"object":B=ee[S]instanceof Date?"D":"C";break;default:B="C"}j=Math.max(j,String(ee[S]).length),A=A&&A!=B?"C":B}j>250&&(j=250),B=((b[w]||{}).DBF||{}).type,B=="C"&&b[w].DBF.len>j&&(j=b[w].DBF.len),A=="B"&&B=="N"&&(A="N",D[w]=b[w].DBF.dec,j=b[w].DBF.len),M[w]=A=="C"||B=="N"?j:o[A]||0,N+=M[w],E[w]=A}var re=g.next(32);for(re.write_shift(4,318902576),re.write_shift(4,_.length),re.write_shift(2,296+32*T),re.write_shift(2,N),w=0;w<4;++w)re.write_shift(4,0);for(re.write_shift(4,0|(+t[Wb]||3)<<8),w=0,S=0;w<p.length;++w)if(p[w]!=null){var U=g.next(32),I=(p[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);U.write_shift(1,I,"sbcs"),U.write_shift(1,E[w]=="?"?"C":E[w],"sbcs"),U.write_shift(4,S),U.write_shift(1,M[w]||o[E[w]]||0),U.write_shift(1,D[w]||0),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(1,0),U.write_shift(4,0),U.write_shift(4,0),S+=M[w]||o[E[w]]||0}var ne=g.next(264);for(ne.write_shift(4,13),w=0;w<65;++w)ne.write_shift(4,0);for(w=0;w<_.length;++w){var ie=g.next(N);for(ie.write_shift(1,0),S=0;S<p.length;++S)if(p[S]!=null)switch(E[S]){case"L":ie.write_shift(1,_[w][S]==null?63:_[w][S]?84:70);break;case"B":ie.write_shift(8,_[w][S]||0,"f");break;case"N":var q="0";for(typeof _[w][S]=="number"&&(q=_[w][S].toFixed(D[S]||0)),T=0;T<M[S]-q.length;++T)ie.write_shift(1,32);ie.write_shift(1,q,"sbcs");break;case"D":_[w][S]?(ie.write_shift(4,("0000"+_[w][S].getFullYear()).slice(-4),"sbcs"),ie.write_shift(2,("00"+(_[w][S].getMonth()+1)).slice(-2),"sbcs"),ie.write_shift(2,("00"+_[w][S].getDate()).slice(-2),"sbcs")):ie.write_shift(8,"00000000","sbcs");break;case"C":var ae=String(_[w][S]!=null?_[w][S]:"").slice(0,M[S]);for(ie.write_shift(1,ae,"sbcs"),T=0;T<M[S]-ae.length;++T)ie.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:n,to_sheet:a,from_sheet:l}}(),aE=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Vr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,_){var b=e[_];return typeof b=="number"?R_(b):b},a=function(p,_,b){var w=_.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return w==59?p:R_(w)};e["|"]=254;function n(p,_){switch(_.type){case"base64":return o(vn(p),_);case"binary":return o(p,_);case"buffer":return o(Pt&&Buffer.isBuffer(p)?p.toString("binary"):zi(p),_);case"array":return o(To(p),_)}throw new Error("Unrecognized type "+_.type)}function o(p,_){var b=p.split(/[\n\r]+/),w=-1,S=-1,T=0,N=0,k=[],E=[],M=null,D={},A=[],B=[],j=[],ee=0,re;for(+_.codepage>=0&&es(+_.codepage);T!==b.length;++T){ee=0;var U=b[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),I=U.replace(/;;/g,"\0").split(";").map(function(Q){return Q.replace(/\u0000/g,";")}),ne=I[0],ie;if(U.length>0)switch(ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":I[1].charAt(0)=="P"&&E.push(U.slice(3).replace(/;;/g,";"));break;case"C":var q=!1,ae=!1,be=!1,z=!1,fe=-1,De=-1;for(N=1;N<I.length;++N)switch(I[N].charAt(0)){case"A":break;case"X":S=parseInt(I[N].slice(1))-1,ae=!0;break;case"Y":for(w=parseInt(I[N].slice(1))-1,ae||(S=0),re=k.length;re<=w;++re)k[re]=[];break;case"K":ie=I[N].slice(1),ie.charAt(0)==='"'?ie=ie.slice(1,ie.length-1):ie==="TRUE"?ie=!0:ie==="FALSE"?ie=!1:isNaN(rs(ie))?isNaN(Gl(ie).getDate())||(ie=Ar(ie)):(ie=rs(ie),M!==null&&Jl(M)&&(ie=cd(ie))),q=!0;break;case"E":z=!0;var P=Hl(I[N].slice(1),{r:w,c:S});k[w][S]=[k[w][S],P];break;case"S":be=!0,k[w][S]=[k[w][S],"S5S"];break;case"G":break;case"R":fe=parseInt(I[N].slice(1))-1;break;case"C":De=parseInt(I[N].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+U)}if(q&&(k[w][S]&&k[w][S].length==2?k[w][S][0]=ie:k[w][S]=ie,M=null),be){if(z)throw new Error("SYLK shared formula cannot have own formula");var X=fe>-1&&k[fe][De];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");k[w][S][1]=wE(X[1],{r:w-fe,c:S-De})}break;case"F":var Y=0;for(N=1;N<I.length;++N)switch(I[N].charAt(0)){case"X":S=parseInt(I[N].slice(1))-1,++Y;break;case"Y":for(w=parseInt(I[N].slice(1))-1,re=k.length;re<=w;++re)k[re]=[];break;case"M":ee=parseInt(I[N].slice(1))/20;break;case"F":break;case"G":break;case"P":M=E[parseInt(I[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=I[N].slice(1).split(" "),re=parseInt(j[0],10);re<=parseInt(j[1],10);++re)ee=parseInt(j[2],10),B[re-1]=ee===0?{hidden:!0}:{wch:ee},Pi(B[re-1]);break;case"C":S=parseInt(I[N].slice(1))-1,B[S]||(B[S]={});break;case"R":w=parseInt(I[N].slice(1))-1,A[w]||(A[w]={}),ee>0?(A[w].hpt=ee,A[w].hpx=Yl(ee)):ee===0&&(A[w].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+U)}Y<1&&(M=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+U)}}return A.length>0&&(D["!rows"]=A),B.length>0&&(D["!cols"]=B),_&&_.sheetRows&&(k=k.slice(0,_.sheetRows)),[k,D]}function l(p,_){var b=n(p,_),w=b[0],S=b[1],T=Zl(w,_);return Vr(S).forEach(function(N){T[N]=S[N]}),T}function u(p,_){return Vi(l(p,_),_)}function f(p,_,b,w){var S="C;Y"+(b+1)+";X"+(w+1)+";K";switch(p.t){case"n":S+=p.v||0,p.f&&!p.F&&(S+=";E"+Ig(p.f,{r:b,c:w}));break;case"b":S+=p.v?"TRUE":"FALSE";break;case"e":S+=p.w||p.v;break;case"d":S+='"'+(p.w||p.v)+'"';break;case"s":S+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function h(p,_){_.forEach(function(b,w){var S="F;W"+(w+1)+" "+(w+1)+" ";b.hidden?S+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=Ru(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=Fu(b.wpx)),typeof b.wch=="number"&&(S+=Math.round(b.wch))),S.charAt(S.length-1)!=" "&&p.push(S)})}function g(p,_){_.forEach(function(b,w){var S="F;";b.hidden?S+="M0;":b.hpt?S+="M"+20*b.hpt+";":b.hpx&&(S+="M"+20*Mu(b.hpx)+";"),S.length>2&&p.push(S+"R"+(w+1))})}function v(p,_){var b=["ID;PWXL;N;E"],w=[],S=Xt(p["!ref"]),T,N=Array.isArray(p),k=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),p["!cols"]&&h(b,p["!cols"]),p["!rows"]&&g(b,p["!rows"]),b.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var E=S.s.r;E<=S.e.r;++E)for(var M=S.s.c;M<=S.e.c;++M){var D=bt({r:E,c:M});T=N?(p[E]||[])[M]:p[D],!(!T||T.v==null&&(!T.f||T.F))&&w.push(f(T,p,E,M))}return b.join(k)+k+w.join(k)+k+"E"+k}return{to_workbook:u,to_sheet:l,from_sheet:v}}(),nE=function(){function e(o,l){switch(l.type){case"base64":return t(vn(o),l);case"binary":return t(o,l);case"buffer":return t(Pt&&Buffer.isBuffer(o)?o.toString("binary"):zi(o),l);case"array":return t(To(o),l)}throw new Error("Unrecognized type "+l.type)}function t(o,l){for(var u=o.split(`
`),f=-1,h=-1,g=0,v=[];g!==u.length;++g){if(u[g].trim()==="BOT"){v[++f]=[],h=0;continue}if(!(f<0)){var p=u[g].trim().split(","),_=p[0],b=p[1];++g;for(var w=u[g]||"";(w.match(/["]/g)||[]).length&1&&g<u.length-1;)w+=`
`+u[++g];switch(w=w.trim(),+_){case-1:if(w==="BOT"){v[++f]=[],h=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?v[f][h]=!0:w==="FALSE"?v[f][h]=!1:isNaN(rs(b))?isNaN(Gl(b).getDate())?v[f][h]=b:v[f][h]=Ar(b):v[f][h]=rs(b),++h;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),v[f][h++]=w!==""?w:null;break}if(w==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function r(o,l){return Zl(e(o,l),l)}function a(o,l){return Vi(r(o,l),l)}var n=function(){var o=function(f,h,g,v,p){f.push(h),f.push(g+","+v),f.push('"'+p.replace(/"/g,'""')+'"')},l=function(f,h,g,v){f.push(h+","+g),f.push(h==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(f){var h=[],g=Xt(f["!ref"]),v,p=Array.isArray(f);o(h,"TABLE",0,1,"sheetjs"),o(h,"VECTORS",0,g.e.r-g.s.r+1,""),o(h,"TUPLES",0,g.e.c-g.s.c+1,""),o(h,"DATA",0,0,"");for(var _=g.s.r;_<=g.e.r;++_){l(h,-1,0,"BOT");for(var b=g.s.c;b<=g.e.c;++b){var w=bt({r:_,c:b});if(v=p?(f[_]||[])[b]:f[w],!v){l(h,1,0,"");continue}switch(v.t){case"n":var S=v.w;!S&&v.v!=null&&(S=v.v),S==null?v.f&&!v.F?l(h,1,0,"="+v.f):l(h,1,0,""):l(h,0,S,"V");break;case"b":l(h,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(h,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=Pn(v.z||wt[14],la(Ar(v.v)))),l(h,0,v.w,"V");break;default:l(h,1,0,"")}}}l(h,-1,0,"EOD");var T=`\r
`,N=h.join(T);return N}}();return{to_workbook:a,to_sheet:r,from_sheet:n}}(),sE=function(){function e(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(v,p){for(var _=v.split(`
`),b=-1,w=-1,S=0,T=[];S!==_.length;++S){var N=_[S].trim().split(":");if(N[0]==="cell"){var k=Ir(N[1]);if(T.length<=k.r)for(b=T.length;b<=k.r;++b)T[b]||(T[b]=[]);switch(b=k.r,w=k.c,N[2]){case"t":T[b][w]=e(N[3]);break;case"v":T[b][w]=+N[3];break;case"vtf":var E=N[N.length-1];case"vtc":switch(N[3]){case"nl":T[b][w]=!!+N[4];break;default:T[b][w]=+N[4];break}N[2]=="vtf"&&(T[b][w]=[T[b][w],E])}}}return p&&p.sheetRows&&(T=T.slice(0,p.sheetRows)),T}function a(v,p){return Zl(r(v,p),p)}function n(v,p){return Vi(a(v,p),p)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function h(v){if(!v||!v["!ref"])return"";for(var p=[],_=[],b,w="",S=Ja(v["!ref"]),T=Array.isArray(v),N=S.s.r;N<=S.e.r;++N)for(var k=S.s.c;k<=S.e.c;++k)if(w=bt({r:N,c:k}),b=T?(v[N]||[])[k]:v[w],!(!b||b.v==null||b.t==="z")){switch(_=["cell",w,"t"],b.t){case"s":case"str":_.push(t(b.v));break;case"n":b.f?(_[2]="vtf",_[3]="n",_[4]=b.v,_[5]=t(b.f)):(_[2]="v",_[3]=b.v);break;case"b":_[2]="vt"+(b.f?"f":"c"),_[3]="nl",_[4]=b.v?"1":"0",_[5]=t(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var E=la(Ar(b.v));_[2]="vtc",_[3]="nd",_[4]=""+E,_[5]=b.w||Pn(b.z||wt[14],E);break;case"e":continue}p.push(_.join(":"))}return p.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function g(v){return[o,l,u,l,h(v),f].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:g}}(),ql=function(){function e(g,v,p,_,b){b.raw?v[p][_]=g:g===""||(g==="TRUE"?v[p][_]=!0:g==="FALSE"?v[p][_]=!1:isNaN(rs(g))?isNaN(Gl(g).getDate())?v[p][_]=g:v[p][_]=Ar(g):v[p][_]=rs(g))}function t(g,v){var p=v||{},_=[];if(!g||g.length===0)return _;for(var b=g.split(/[\r\n]/),w=b.length-1;w>=0&&b[w].length===0;)--w;for(var S=10,T=0,N=0;N<=w;++N)T=b[N].indexOf(" "),T==-1?T=b[N].length:T++,S=Math.max(S,T);for(N=0;N<=w;++N){_[N]=[];var k=0;for(e(b[N].slice(0,S).trim(),_,N,k,p),k=1;k<=(b[N].length-S)/10+1;++k)e(b[N].slice(S+(k-1)*10,S+k*10).trim(),_,N,k,p)}return p.sheetRows&&(_=_.slice(0,p.sheetRows)),_}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(g){for(var v={},p=!1,_=0,b=0;_<g.length;++_)(b=g.charCodeAt(_))==34?p=!p:!p&&b in r&&(v[b]=(v[b]||0)+1);b=[];for(_ in v)Object.prototype.hasOwnProperty.call(v,_)&&b.push([v[_],_]);if(!b.length){v=a;for(_ in v)Object.prototype.hasOwnProperty.call(v,_)&&b.push([v[_],_])}return b.sort(function(w,S){return w[0]-S[0]||a[w[1]]-a[S[1]]}),r[b.pop()[1]]||44}function o(g,v){var p=v||{},_="",b=p.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(_=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(_=g.charAt(4),g=g.slice(6)):_=n(g.slice(0,1024)):p&&p.FS?_=p.FS:_=n(g.slice(0,1024));var S=0,T=0,N=0,k=0,E=0,M=_.charCodeAt(0),D=!1,A=0,B=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var j=p.dateNF!=null?ZF(p.dateNF):null;function ee(){var re=g.slice(k,E),U={};if(re.charAt(0)=='"'&&re.charAt(re.length-1)=='"'&&(re=re.slice(1,-1).replace(/""/g,'"')),re.length===0)U.t="z";else if(p.raw)U.t="s",U.v=re;else if(re.trim().length===0)U.t="s",U.v=re;else if(re.charCodeAt(0)==61)re.charCodeAt(1)==34&&re.charCodeAt(re.length-1)==34?(U.t="s",U.v=re.slice(2,-1).replace(/""/g,'"')):C7(re)?(U.t="n",U.f=re.slice(1)):(U.t="s",U.v=re);else if(re=="TRUE")U.t="b",U.v=!0;else if(re=="FALSE")U.t="b",U.v=!1;else if(!isNaN(N=rs(re)))U.t="n",p.cellText!==!1&&(U.w=re),U.v=N;else if(!isNaN(Gl(re).getDate())||j&&re.match(j)){U.z=p.dateNF||wt[14];var I=0;j&&re.match(j)&&(re=eM(re,p.dateNF,re.match(j)||[]),I=1),p.cellDates?(U.t="d",U.v=Ar(re,I)):(U.t="n",U.v=la(Ar(re,I))),p.cellText!==!1&&(U.w=Pn(U.z,U.v instanceof Date?la(U.v):U.v)),p.cellNF||delete U.z}else U.t="s",U.v=re;if(U.t=="z"||(p.dense?(b[S]||(b[S]=[]),b[S][T]=U):b[bt({c:T,r:S})]=U),k=E+1,B=g.charCodeAt(k),w.e.c<T&&(w.e.c=T),w.e.r<S&&(w.e.r=S),A==M)++T;else if(T=0,++S,p.sheetRows&&p.sheetRows<=S)return!0}e:for(;E<g.length;++E)switch(A=g.charCodeAt(E)){case 34:B===34&&(D=!D);break;case M:case 10:case 13:if(!D&&ee())break e;break}return E-k>0&&ee(),b["!ref"]=Rt(w),b}function l(g,v){return!(v&&v.PRN)||v.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?o(g,v):Zl(t(g,v),v)}function u(g,v){var p="",_=v.type=="string"?[0,0,0,0]:$g(g,v);switch(v.type){case"base64":p=vn(g);break;case"binary":p=g;break;case"buffer":v.codepage==65001?p=g.toString("utf8"):v.codepage&&typeof Eu<"u"||(p=Pt&&Buffer.isBuffer(g)?g.toString("binary"):zi(g));break;case"array":p=To(g);break;case"string":p=g;break;default:throw new Error("Unrecognized type "+v.type)}return _[0]==239&&_[1]==187&&_[2]==191?p=mr(p.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?p=mr(p):v.type=="binary"&&typeof Eu<"u",p.slice(0,19)=="socialcalc:version:"?sE.to_sheet(v.type=="string"?p:mr(p),v):l(p,v)}function f(g,v){return Vi(u(g,v),v)}function h(g){for(var v=[],p=Xt(g["!ref"]),_,b=Array.isArray(g),w=p.s.r;w<=p.e.r;++w){for(var S=[],T=p.s.c;T<=p.e.c;++T){var N=bt({r:w,c:T});if(_=b?(g[w]||[])[T]:g[N],!_||_.v==null){S.push("          ");continue}for(var k=(_.w||(qs(_),_.w)||"").slice(0,10);k.length<10;)k+=" ";S.push(k+(T===0?" ":""))}v.push(S.join(""))}return v.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:h}}();function mP(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=aE.to_workbook(e,r);return r.WTF=a,n}catch(o){if(r.WTF=a,!o.message.match(/SYLK bad record ID/)&&a)throw o;return ql.to_workbook(e,t)}}var bo=function(){function e(P,X,Y){if(P){Sa(P,P.l||0);for(var Q=Y.Enum||fe;P.l<P.length;){var de=P.read_shift(2),Fe=Q[de]||Q[65535],Te=P.read_shift(2),Oe=P.l+Te,Re=Fe.f&&Fe.f(P,Te,Y);if(P.l=Oe,X(Re,Fe,de))return}}}function t(P,X){switch(X.type){case"base64":return r(mn(vn(P)),X);case"binary":return r(mn(P),X);case"buffer":case"array":return r(P,X)}throw"Unsupported type "+X.type}function r(P,X){if(!P)return P;var Y=X||{},Q=Y.dense?[]:{},de="Sheet1",Fe="",Te=0,Oe={},Re=[],Je=[],H={s:{r:0,c:0},e:{r:0,c:0}},O=Y.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)Y.Enum=fe,e(P,function(Z,le,Ge){switch(Ge){case 0:Y.vers=Z,Z>=4096&&(Y.qpro=!0);break;case 6:H=Z;break;case 204:Z&&(Fe=Z);break;case 222:Fe=Z;break;case 15:case 51:Y.qpro||(Z[1].v=Z[1].v.slice(1));case 13:case 14:case 16:Ge==14&&(Z[2]&112)==112&&(Z[2]&15)>1&&(Z[2]&15)<15&&(Z[1].z=Y.dateNF||wt[14],Y.cellDates&&(Z[1].t="d",Z[1].v=cd(Z[1].v))),Y.qpro&&Z[3]>Te&&(Q["!ref"]=Rt(H),Oe[de]=Q,Re.push(de),Q=Y.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Te=Z[3],de=Fe||"Sheet"+(Te+1),Fe="");var kt=Y.dense?(Q[Z[0].r]||[])[Z[0].c]:Q[bt(Z[0])];if(kt){kt.t=Z[1].t,kt.v=Z[1].v,Z[1].z!=null&&(kt.z=Z[1].z),Z[1].f!=null&&(kt.f=Z[1].f);break}Y.dense?(Q[Z[0].r]||(Q[Z[0].r]=[]),Q[Z[0].r][Z[0].c]=Z[1]):Q[bt(Z[0])]=Z[1];break}},Y);else if(P[2]==26||P[2]==14)Y.Enum=De,P[2]==14&&(Y.qpro=!0,P.l=0),e(P,function(Z,le,Ge){switch(Ge){case 204:de=Z;break;case 22:Z[1].v=Z[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Z[3]>Te&&(Q["!ref"]=Rt(H),Oe[de]=Q,Re.push(de),Q=Y.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},Te=Z[3],de="Sheet"+(Te+1)),O>0&&Z[0].r>=O)break;Y.dense?(Q[Z[0].r]||(Q[Z[0].r]=[]),Q[Z[0].r][Z[0].c]=Z[1]):Q[bt(Z[0])]=Z[1],H.e.c<Z[0].c&&(H.e.c=Z[0].c),H.e.r<Z[0].r&&(H.e.r=Z[0].r);break;case 27:Z[14e3]&&(Je[Z[14e3][0]]=Z[14e3][1]);break;case 1537:Je[Z[0]]=Z[1],Z[0]==Te&&(de=Z[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(Q["!ref"]=Rt(H),Oe[Fe||de]=Q,Re.push(Fe||de),!Je.length)return{SheetNames:Re,Sheets:Oe};for(var Ae={},Pe=[],Se=0;Se<Je.length;++Se)Oe[Re[Se]]?(Pe.push(Je[Se]||Re[Se]),Ae[Je[Se]]=Oe[Je[Se]]||Oe[Re[Se]]):(Pe.push(Je[Se]),Ae[Je[Se]]={"!ref":"A1"});return{SheetNames:Pe,Sheets:Ae}}function a(P,X){var Y=X||{};if(+Y.codepage>=0&&es(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var Q=Ka(),de=Xt(P["!ref"]),Fe=Array.isArray(P),Te=[];qe(Q,0,o(1030)),qe(Q,6,f(de));for(var Oe=Math.min(de.e.r,8191),Re=de.s.r;Re<=Oe;++Re)for(var Je=qr(Re),H=de.s.c;H<=de.e.c;++H){Re===de.s.r&&(Te[H]=jr(H));var O=Te[H]+Je,Ae=Fe?(P[Re]||[])[H]:P[O];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")(Ae.v|0)==Ae.v&&Ae.v>=-32768&&Ae.v<=32767?qe(Q,13,_(Re,H,Ae.v)):qe(Q,14,w(Re,H,Ae.v));else{var Pe=qs(Ae);qe(Q,15,v(Re,H,Pe.slice(0,239)))}}return qe(Q,1),Q.end()}function n(P,X){var Y=X||{};if(+Y.codepage>=0&&es(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var Q=Ka();qe(Q,0,l(P));for(var de=0,Fe=0;de<P.SheetNames.length;++de)(P.Sheets[P.SheetNames[de]]||{})["!ref"]&&qe(Q,27,z(P.SheetNames[de],Fe++));var Te=0;for(de=0;de<P.SheetNames.length;++de){var Oe=P.Sheets[P.SheetNames[de]];if(!(!Oe||!Oe["!ref"])){for(var Re=Xt(Oe["!ref"]),Je=Array.isArray(Oe),H=[],O=Math.min(Re.e.r,8191),Ae=Re.s.r;Ae<=O;++Ae)for(var Pe=qr(Ae),Se=Re.s.c;Se<=Re.e.c;++Se){Ae===Re.s.r&&(H[Se]=jr(Se));var Z=H[Se]+Pe,le=Je?(Oe[Ae]||[])[Se]:Oe[Z];if(!(!le||le.t=="z"))if(le.t=="n")qe(Q,23,ee(Ae,Se,Te,le.v));else{var Ge=qs(le);qe(Q,22,A(Ae,Se,Te,Ge.slice(0,239)))}}++Te}}return qe(Q,1),Q.end()}function o(P){var X=Ne(2);return X.write_shift(2,P),X}function l(P){var X=Ne(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var Y=0,Q=0,de=0,Fe=0;Fe<P.SheetNames.length;++Fe){var Te=P.SheetNames[Fe],Oe=P.Sheets[Te];if(!(!Oe||!Oe["!ref"])){++de;var Re=Ja(Oe["!ref"]);Y<Re.e.r&&(Y=Re.e.r),Q<Re.e.c&&(Q=Re.e.c)}}return Y>8191&&(Y=8191),X.write_shift(2,Y),X.write_shift(1,de),X.write_shift(1,Q),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function u(P,X,Y){var Q={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&Y.qpro?(Q.s.c=P.read_shift(1),P.l++,Q.s.r=P.read_shift(2),Q.e.c=P.read_shift(1),P.l++,Q.e.r=P.read_shift(2),Q):(Q.s.c=P.read_shift(2),Q.s.r=P.read_shift(2),X==12&&Y.qpro&&(P.l+=2),Q.e.c=P.read_shift(2),Q.e.r=P.read_shift(2),X==12&&Y.qpro&&(P.l+=2),Q.s.c==65535&&(Q.s.c=Q.e.c=Q.s.r=Q.e.r=0),Q)}function f(P){var X=Ne(8);return X.write_shift(2,P.s.c),X.write_shift(2,P.s.r),X.write_shift(2,P.e.c),X.write_shift(2,P.e.r),X}function h(P,X,Y){var Q=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(Q[0].c=P.read_shift(1),Q[3]=P.read_shift(1),Q[0].r=P.read_shift(2),P.l+=2):(Q[2]=P.read_shift(1),Q[0].c=P.read_shift(2),Q[0].r=P.read_shift(2)),Q}function g(P,X,Y){var Q=P.l+X,de=h(P,X,Y);if(de[1].t="s",Y.vers==20768){P.l++;var Fe=P.read_shift(1);return de[1].v=P.read_shift(Fe,"utf8"),de}return Y.qpro&&P.l++,de[1].v=P.read_shift(Q-P.l,"cstr"),de}function v(P,X,Y){var Q=Ne(7+Y.length);Q.write_shift(1,255),Q.write_shift(2,X),Q.write_shift(2,P),Q.write_shift(1,39);for(var de=0;de<Q.length;++de){var Fe=Y.charCodeAt(de);Q.write_shift(1,Fe>=128?95:Fe)}return Q.write_shift(1,0),Q}function p(P,X,Y){var Q=h(P,X,Y);return Q[1].v=P.read_shift(2,"i"),Q}function _(P,X,Y){var Q=Ne(7);return Q.write_shift(1,255),Q.write_shift(2,X),Q.write_shift(2,P),Q.write_shift(2,Y,"i"),Q}function b(P,X,Y){var Q=h(P,X,Y);return Q[1].v=P.read_shift(8,"f"),Q}function w(P,X,Y){var Q=Ne(13);return Q.write_shift(1,255),Q.write_shift(2,X),Q.write_shift(2,P),Q.write_shift(8,Y,"f"),Q}function S(P,X,Y){var Q=P.l+X,de=h(P,X,Y);if(de[1].v=P.read_shift(8,"f"),Y.qpro)P.l=Q;else{var Fe=P.read_shift(2);E(P.slice(P.l,P.l+Fe),de),P.l+=Fe}return de}function T(P,X,Y){var Q=X&32768;return X&=-32769,X=(Q?P:0)+(X>=8192?X-16384:X),(Q?"":"$")+(Y?jr(X):qr(X))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},k=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(P,X){Sa(P,0);for(var Y=[],Q=0,de="",Fe="",Te="",Oe="";P.l<P.length;){var Re=P[P.l++];switch(Re){case 0:Y.push(P.read_shift(8,"f"));break;case 1:Fe=T(X[0].c,P.read_shift(2),!0),de=T(X[0].r,P.read_shift(2),!1),Y.push(Fe+de);break;case 2:{var Je=T(X[0].c,P.read_shift(2),!0),H=T(X[0].r,P.read_shift(2),!1);Fe=T(X[0].c,P.read_shift(2),!0),de=T(X[0].r,P.read_shift(2),!1),Y.push(Je+H+":"+Fe+de)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(P.read_shift(2));break;case 6:{for(var O="";Re=P[P.l++];)O+=String.fromCharCode(Re);Y.push('"'+O.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:Oe=Y.pop(),Te=Y.pop(),Y.push(["AND","OR"][Re-20]+"("+Te+","+Oe+")");break;default:if(Re<32&&k[Re])Oe=Y.pop(),Te=Y.pop(),Y.push(Te+k[Re]+Oe);else if(N[Re]){if(Q=N[Re][1],Q==69&&(Q=P[P.l++]),Q>Y.length){console.error("WK1 bad formula parse 0x"+Re.toString(16)+":|"+Y.join("|")+"|");return}var Ae=Y.slice(-Q);Y.length-=Q,Y.push(N[Re][0]+"("+Ae.join(",")+")")}else return Re<=7?console.error("WK1 invalid opcode "+Re.toString(16)):Re<=24?console.error("WK1 unsupported op "+Re.toString(16)):Re<=30?console.error("WK1 invalid opcode "+Re.toString(16)):Re<=115?console.error("WK1 unsupported function opcode "+Re.toString(16)):console.error("WK1 unrecognized opcode "+Re.toString(16))}}Y.length==1?X[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function M(P){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=P.read_shift(2),X[3]=P[P.l++],X[0].c=P[P.l++],X}function D(P,X){var Y=M(P);return Y[1].t="s",Y[1].v=P.read_shift(X-4,"cstr"),Y}function A(P,X,Y,Q){var de=Ne(6+Q.length);de.write_shift(2,P),de.write_shift(1,Y),de.write_shift(1,X),de.write_shift(1,39);for(var Fe=0;Fe<Q.length;++Fe){var Te=Q.charCodeAt(Fe);de.write_shift(1,Te>=128?95:Te)}return de.write_shift(1,0),de}function B(P,X){var Y=M(P);Y[1].v=P.read_shift(2);var Q=Y[1].v>>1;if(Y[1].v&1)switch(Q&7){case 0:Q=(Q>>3)*5e3;break;case 1:Q=(Q>>3)*500;break;case 2:Q=(Q>>3)/20;break;case 3:Q=(Q>>3)/200;break;case 4:Q=(Q>>3)/2e3;break;case 5:Q=(Q>>3)/2e4;break;case 6:Q=(Q>>3)/16;break;case 7:Q=(Q>>3)/64;break}return Y[1].v=Q,Y}function j(P,X){var Y=M(P),Q=P.read_shift(4),de=P.read_shift(4),Fe=P.read_shift(2);if(Fe==65535)return Q===0&&de===3221225472?(Y[1].t="e",Y[1].v=15):Q===0&&de===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var Te=Fe&32768;return Fe=(Fe&32767)-16446,Y[1].v=(1-Te*2)*(de*Math.pow(2,Fe+32)+Q*Math.pow(2,Fe)),Y}function ee(P,X,Y,Q){var de=Ne(14);if(de.write_shift(2,P),de.write_shift(1,Y),de.write_shift(1,X),Q==0)return de.write_shift(4,0),de.write_shift(4,0),de.write_shift(2,65535),de;var Fe=0,Te=0,Oe=0,Re=0;return Q<0&&(Fe=1,Q=-Q),Te=Math.log2(Q)|0,Q/=Math.pow(2,Te-31),Re=Q>>>0,(Re&2147483648)==0&&(Q/=2,++Te,Re=Q>>>0),Q-=Re,Re|=2147483648,Re>>>=0,Q*=Math.pow(2,32),Oe=Q>>>0,de.write_shift(4,Oe),de.write_shift(4,Re),Te+=16383+(Fe?32768:0),de.write_shift(2,Te),de}function re(P,X){var Y=j(P);return P.l+=X-14,Y}function U(P,X){var Y=M(P),Q=P.read_shift(4);return Y[1].v=Q>>6,Y}function I(P,X){var Y=M(P),Q=P.read_shift(8,"f");return Y[1].v=Q,Y}function ne(P,X){var Y=I(P);return P.l+=X-10,Y}function ie(P,X){return P[P.l+X-1]==0?P.read_shift(X,"cstr"):""}function q(P,X){var Y=P[P.l++];Y>X-1&&(Y=X-1);for(var Q="";Q.length<Y;)Q+=String.fromCharCode(P[P.l++]);return Q}function ae(P,X,Y){if(!(!Y.qpro||X<21)){var Q=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var de=P.read_shift(X-21,"cstr");return[Q,de]}}function be(P,X){for(var Y={},Q=P.l+X;P.l<Q;){var de=P.read_shift(2);if(de==14e3){for(Y[de]=[0,""],Y[de][0]=P.read_shift(2);P[P.l];)Y[de][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return Y}function z(P,X){var Y=Ne(5+P.length);Y.write_shift(2,14e3),Y.write_shift(2,X);for(var Q=0;Q<P.length;++Q){var de=P.charCodeAt(Q);Y[Y.l++]=de>127?95:de}return Y[Y.l++]=0,Y}var fe={0:{n:"BOF",f:ta},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ie},222:{n:"SHEETNAMELP",f:q},65535:{n:""}},De={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:B},25:{n:"FORMULA19",f:re},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:be},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:U},38:{n:"??"},39:{n:"NUMBER27",f:I},40:{n:"FORMULA28",f:ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ie},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}}();function gP(e){var t={},r=e.match(La),a=0,n=!1;if(r)for(;a!=r.length;++a){var o=Tt(r[a]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;t.cp=og[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=o.val;break;case"<sz":t.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":o.rgb&&(t.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(o[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+o[0])}}return t}var xP=function(){var e=Au("t"),t=Au("rPr");function r(o){var l=o.match(e);if(!l)return{t:"s",v:""};var u={t:"s",v:Yt(l[1])},f=o.match(t);return f&&(u.s=gP(f[1])),u}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(l){return l.replace(a,"").split(n).map(r).filter(function(u){return u.v})}}(),vP=function(){var t=/(\r\n|\n)/g;function r(n,o,l){var u=[];n.u&&u.push("text-decoration: underline;"),n.uval&&u.push("text-underline-style:"+n.uval+";"),n.sz&&u.push("font-size:"+n.sz+"pt;"),n.outline&&u.push("text-effect: outline;"),n.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),n.b&&(o.push("<b>"),l.push("</b>")),n.i&&(o.push("<i>"),l.push("</i>")),n.strike&&(o.push("<s>"),l.push("</s>"));var f=n.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(o.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),n}function a(n){var o=[[],n.v,[]];return n.v?(n.s&&r(n.s,o[0],o[2]),o[0].join("")+o[1].replace(t,"<br/>")+o[2].join("")):""}return function(o){return o.map(a).join("")}}(),pP=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,yP=/<(?:\w+:)?r>/,_P=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Og(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Yt(mr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=mr(e),r&&(a.h=vg(a.t))):e.match(yP)&&(a.r=mr(e),a.t=Yt(mr((e.replace(_P,"").match(pP)||[]).join("").replace(La,""))),r&&(a.h=vP(xP(a.r)))),a):{t:""}}var wP=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,bP=/<(?:\w+:)?(?:si|sstItem)>/g,SP=/<\/(?:\w+:)?(?:si|sstItem)>/;function EP(e,t){var r=[],a="";if(!e)return r;var n=e.match(wP);if(n){a=n[2].replace(bP,"").split(SP);for(var o=0;o!=a.length;++o){var l=Og(a[o].trim(),t);l!=null&&(r[r.length]=l)}n=Tt(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var TP=/^\s|\s$|[\t\n\r]/;function iE(e,t){if(!t.bookSST)return"";var r=[Yr];r[r.length]=We("sst",null,{xmlns:Oo[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],o="<si>";n.r?o+=n.r:(o+="<t",n.t||(n.t=""),n.t.match(TP)&&(o+=' xml:space="preserve"'),o+=">"+or(n.t)+"</t>"),o+="</si>",r[r.length]=o}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function kP(e){return[e.read_shift(4),e.read_shift(4)]}function AP(e,t){var r=[],a=!1;return Ks(e,function(o,l,u){switch(u){case 159:r.Count=o[0],r.Unique=o[1];break;case 19:r.push(o);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(l.T,!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function CP(e,t){return t||(t=Ne(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var NP=BM;function DP(e){var t=Ka();Be(t,159,CP(e));for(var r=0;r<e.length;++r)Be(t,19,NP(e[r]));return Be(t,160),t.end()}function oE(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Gs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function OP(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Gs(e,4),t.U=Gs(e,4),t.W=Gs(e,4),t}function RP(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),o=[];n-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=o,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function FP(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(RP(e));return t}function MP(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function jP(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Gs(e,4),t.U=Gs(e,4),t.W=Gs(e,4),t}function IP(e){var t=jP(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function lE(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function cE(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function PP(e){var t=Gs(e);switch(t.Minor){case 2:return[t.Minor,LP(e)];case 3:return[t.Minor,BP()];case 4:return[t.Minor,UP(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function LP(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=lE(e,r),n=cE(e,e.length-e.l);return{t:"Std",h:a,v:n}}function BP(){throw new Error("File is password-protected: ECMA-376 Extensible")}function UP(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(La,function(o){var l=Tt(o);switch(ws(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){a[u]=l[u]});break;case"<dataIntegrity":a.encryptedHmacKey=l.encryptedHmacKey,a.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(l);break;default:throw l[0]}}),a}function zP(e,t){var r={},a=r.EncryptionVersionInfo=Gs(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=lE(e,n),t-=n,r.EncryptionVerifier=cE(e,t),r}function VP(e){var t={},r=t.EncryptionVersionInfo=Gs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Rg(e){var t=0,r,a=oE(e),n=a.length+1,o,l,u,f,h;for(r=Ii(n),r[0]=a.length,o=1;o!=n;++o)r[o]=a[o-1];for(o=n-1;o>=0;--o)l=r[o],u=(t&16384)===0?0:1,f=t<<1&32767,h=u|f,t=h^l;return t^52811}var uE=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(l){return(l/2|l*128)&255},n=function(l,u){return a(l^u)},o=function(l){for(var u=t[l.length-1],f=104,h=l.length-1;h>=0;--h)for(var g=l[h],v=0;v!=7;++v)g&64&&(u^=r[f]),g*=2,--f;return u};return function(l){for(var u=oE(l),f=o(u),h=u.length,g=Ii(16),v=0;v!=16;++v)g[v]=0;var p,_,b;for((h&1)===1&&(p=f>>8,g[h]=n(e[0],p),--h,p=f&255,_=u[u.length-1],g[h]=n(_,p));h>0;)--h,p=f>>8,g[h]=n(u[h],p),--h,p=f&255,g[h]=n(u[h],p);for(h=15,b=15-u.length;b>0;)p=f>>8,g[h]=n(e[b],p),--h,--b,p=f&255,g[h]=n(u[h],p),--h,--b;return g}}(),HP=function(e,t,r,a,n){n||(n=t),a||(a=uE(e));var o,l;for(o=0;o!=t.length;++o)l=t[o],l^=a[r],l=(l>>5|l<<3)&255,n[o]=l,++r;return[n,r,a]},$P=function(e){var t=0,r=uE(e);return function(a){var n=HP("",a,t,r);return t=n[1],n[0]}};function WP(e,t,r,a){var n={key:ta(e),verificationBytes:ta(e)};return r.password&&(n.verifier=Rg(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=$P(r.password)),n}function GP(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=VP(e):a.Data=zP(e,t),a}function qP(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?GP(e,t-2,a):WP(e,r.biff>=8?t:t-2,r,a),a}var fE=function(){function e(n,o){switch(o.type){case"base64":return t(vn(n),o);case"binary":return t(n,o);case"buffer":return t(Pt&&Buffer.isBuffer(n)?n.toString("binary"):zi(n),o);case"array":return t(To(n),o)}throw new Error("Unrecognized type "+o.type)}function t(n,o){var l=o||{},u=l.dense?[]:{},f=n.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(g,v){Array.isArray(u)&&(u[v]=[]);for(var p=/\\\w+\b/g,_=0,b,w=-1;b=p.exec(g);){switch(b[0]){case"\\cell":var S=g.slice(_,p.lastIndex-b[0].length);if(S[0]==" "&&(S=S.slice(1)),++w,S.length){var T={v:S,t:"s"};Array.isArray(u)?u[v][w]=T:u[bt({r:v,c:w})]=T}break}_=p.lastIndex}w>h.e.c&&(h.e.c=w)}),u["!ref"]=Rt(h),u}function r(n,o){return Vi(e(n,o),o)}function a(n){for(var o=["{\\rtf1\\ansi"],l=Xt(n["!ref"]),u,f=Array.isArray(n),h=l.s.r;h<=l.e.r;++h){o.push("\\trowd\\trautofit1");for(var g=l.s.c;g<=l.e.c;++g)o.push("\\cellx"+(g+1));for(o.push("\\pard\\intbl"),g=l.s.c;g<=l.e.c;++g){var v=bt({r:h,c:g});u=f?(n[h]||[])[g]:n[v],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(qs(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function YP(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Ou(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function XP(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),o=Math.min(t,r,a),l=n-o;if(l===0)return[0,0,t];var u=0,f=0,h=n+o;switch(f=l/(h>1?2-h:h),n){case t:u=((r-a)/l+6)%6;break;case r:u=(a-t)/l+2;break;case a:u=(t-r)/l+4;break}return[u/6,f,h/2]}function KP(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),o=a-n/2,l=[o,o,o],u=6*t,f;if(r!==0)switch(u|0){case 0:case 6:f=n*u,l[0]+=n,l[1]+=f;break;case 1:f=n*(2-u),l[0]+=f,l[1]+=n;break;case 2:f=n*(u-2),l[1]+=n,l[2]+=f;break;case 3:f=n*(4-u),l[1]+=f,l[2]+=n;break;case 4:f=n*(u-4),l[2]+=n,l[0]+=f;break;case 5:f=n*(6-u),l[2]+=f,l[0]+=n;break}for(var h=0;h!=3;++h)l[h]=Math.round(l[h]*255);return l}function $0(e,t){if(t===0)return e;var r=XP(YP(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Ou(KP(r))}var dE=6,JP=15,QP=1,Ma=dE;function Ru(e){return Math.floor((e+Math.round(128/Ma)/256)*Ma)}function Fu(e){return Math.floor((e-5)/Ma*100+.5)/100}function W0(e){return Math.round((e*Ma+5)/Ma*256)/256}function Hm(e){return W0(Fu(Ru(e)))}function Fg(e){var t=Math.abs(e-Hm(e)),r=Ma;if(t>.005)for(Ma=QP;Ma<JP;++Ma)Math.abs(e-Hm(e))<=t&&(t=Math.abs(e-Hm(e)),r=Ma);Ma=r}function Pi(e){e.width?(e.wpx=Ru(e.width),e.wch=Fu(e.wpx),e.MDW=Ma):e.wpx?(e.wch=Fu(e.wpx),e.width=W0(e.wch),e.MDW=Ma):typeof e.wch=="number"&&(e.width=W0(e.wch),e.wpx=Ru(e.width),e.MDW=Ma),e.customWidth&&delete e.customWidth}var ZP=96,hE=ZP;function Mu(e){return e*96/hE}function Yl(e){return e*hE/96}var e9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function t9(e,t,r,a){t.Borders=[];var n={},o=!1;(e[0].match(La)||[]).forEach(function(l){var u=Tt(l);switch(ws(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},u.diagonalUp&&(n.diagonalUp=kr(u.diagonalUp)),u.diagonalDown&&(n.diagonalDown=kr(u.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(a&&a.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function r9(e,t,r,a){t.Fills=[];var n={},o=!1;(e[0].match(La)||[]).forEach(function(l){var u=Tt(l);switch(ws(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":u.patternType&&(n.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),u.indexed&&(n.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(n.bgColor.theme=parseInt(u.theme,10)),u.tint&&(n.bgColor.tint=parseFloat(u.tint)),u.rgb&&(n.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),u.theme&&(n.fgColor.theme=parseInt(u.theme,10)),u.tint&&(n.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(n.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(a&&a.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function a9(e,t,r,a){t.Fonts=[];var n={},o=!1;(e[0].match(La)||[]).forEach(function(l){var u=Tt(l);switch(ws(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":u.val&&(n.name=mr(u.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=u.val?kr(u.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=u.val?kr(u.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(u.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=u.val?kr(u.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=u.val?kr(u.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=u.val?kr(u.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=u.val?kr(u.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=u.val?kr(u.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":u.val&&(n.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(n.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(n.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(n.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=og[parseInt(u.val,10)];break;case"<color":if(n.color||(n.color={}),u.auto&&(n.color.auto=kr(u.auto)),u.rgb)n.color.rgb=u.rgb.slice(-6);else if(u.indexed){n.color.index=parseInt(u.indexed,10);var f=_o[n.color.index];n.color.index==81&&(f=_o[1]),f||(f=_o[1]),n.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else u.theme&&(n.color.theme=parseInt(u.theme,10),u.tint&&(n.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=$0(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(a&&a.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function n9(e,t,r){t.NumberFmt=[];for(var a=Vr(wt),n=0;n<a.length;++n)t.NumberFmt[a[n]]=wt[a[n]];var o=e[0].match(La);if(o)for(n=0;n<o.length;++n){var l=Tt(o[n]);switch(ws(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Yt(mr(l.formatCode)),f=parseInt(l.numFmtId,10);if(t.NumberFmt[f]=u,f>0){if(f>392){for(f=392;f>60&&t.NumberFmt[f]!=null;--f);t.NumberFmt[f]=u}Ws(u,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function s9(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=We("numFmt",null,{numFmtId:a,formatCode:or(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=We("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var S0=["numFmtId","fillId","fontId","borderId","xfId"],E0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function i9(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(La)||[]).forEach(function(o){var l=Tt(o),u=0;switch(ws(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=l,delete a[0],u=0;u<S0.length;++u)a[S0[u]]&&(a[S0[u]]=parseInt(a[S0[u]],10));for(u=0;u<E0.length;++u)a[E0[u]]&&(a[E0[u]]=kr(a[E0[u]]));if(t.NumberFmt&&a.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[u]){a.numFmtId=u;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=kr(l.wrapText)),a.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function o9(e){var t=[];return t[t.length]=We("cellXfs",null),e.forEach(function(r){t[t.length]=We("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=We("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var l9=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,f,h){var g={};if(!u)return g;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=u.match(t))&&n9(v,g,h),(v=u.match(n))&&a9(v,g,f,h),(v=u.match(a))&&r9(v,g,f,h),(v=u.match(o))&&t9(v,g,f,h),(v=u.match(r))&&i9(v,g,h),g}}();function mE(e,t){var r=[Yr,We("styleSheet",null,{xmlns:Oo[0],"xmlns:vt":oa.vt})],a;return e.SSF&&(a=s9(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=o9(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function c9(e,t){var r=e.read_shift(2),a=Ia(e);return[r,a]}function u9(e,t,r){r||(r=Ne(6+4*t.length)),r.write_shift(2,e),ga(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function f9(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=GM(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var o=e.read_shift(2);switch(o===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(a.underline=l);var u=e.read_shift(1);u>0&&(a.family=u);var f=e.read_shift(1);switch(f>0&&(a.charset=f),e.l++,a.color=WM(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Ia(e),a}function d9(e,t){t||(t=Ne(25+4*32)),t.write_shift(2,e.sz*20),qM(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),z0(e.color,t);var a=0;return a=2,t.write_shift(1,a),ga(e.name,t),t.length>t.l?t.slice(0,t.l):t}var h9=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],$m,m9=Pa;function bw(e,t){t||(t=Ne(4*3+8*7+16*1)),$m||($m=od(h9));var r=$m[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(z0({auto:1},t),z0({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function g9(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function gE(e,t,r){r||(r=Ne(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Qc(e,t){return t||(t=Ne(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var x9=Pa;function v9(e,t){return t||(t=Ne(51)),t.write_shift(1,0),Qc(null,t),Qc(null,t),Qc(null,t),Qc(null,t),Qc(null,t),t.length>t.l?t.slice(0,t.l):t}function p9(e,t){return t||(t=Ne(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),U0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function y9(e,t,r){var a=Ne(2052);return a.write_shift(4,e),U0(t,a),U0(r,a),a.length>a.l?a.slice(0,a.l):a}function _9(e,t,r){var a={};a.NumberFmt=[];for(var n in wt)a.NumberFmt[n]=wt[n];a.CellXf=[],a.Fonts=[];var o=[],l=!1;return Ks(e,function(f,h,g){switch(g){case 44:a.NumberFmt[f[0]]=f[1],Ws(f[1],f[0]);break;case 43:a.Fonts.push(f),f.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(f.color.rgb=$0(t.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&a.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(g),l=!0;break;case 38:o.pop(),l=!1;break;default:if(h.T>0)o.push(g);else if(h.T<0)o.pop();else if(!l||r.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),a}function w9(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(Be(e,615,as(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&Be(e,44,u9(n,t[n]))}),Be(e,616))}}function b9(e){var t=1;Be(e,611,as(t)),Be(e,43,d9({sz:12,color:{theme:1},name:"Calibri",family:2})),Be(e,612)}function S9(e){var t=2;Be(e,603,as(t)),Be(e,45,bw({patternType:"none"})),Be(e,45,bw({patternType:"gray125"})),Be(e,604)}function E9(e){var t=1;Be(e,613,as(t)),Be(e,46,v9()),Be(e,614)}function T9(e){var t=1;Be(e,626,as(t)),Be(e,47,gE({numFmtId:0},65535)),Be(e,627)}function k9(e,t){Be(e,617,as(t.length)),t.forEach(function(r){Be(e,47,gE(r,0))}),Be(e,618)}function A9(e){var t=1;Be(e,619,as(t)),Be(e,48,p9({xfId:0,name:"Normal"})),Be(e,620)}function C9(e){var t=0;Be(e,505,as(t)),Be(e,506)}function N9(e){var t=0;Be(e,508,y9(t,"TableStyleMedium9","PivotStyleMedium4")),Be(e,509)}function D9(e,t){var r=Ka();return Be(r,278),w9(r,e.SSF),b9(r),S9(r),E9(r),T9(r),k9(r,t.cellXfs),A9(r),C9(r),N9(r),Be(r,279),r.end()}var O9=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function R9(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(La)||[]).forEach(function(n){var o=Tt(n);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=o.val;break;case"<a:sysClr":a.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(t.themeElements.clrScheme[O9.indexOf(o[0])]=a,a={}):a.name=o[0].slice(3,o[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function F9(){}function M9(){}var j9=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,I9=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,P9=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function L9(e,t,r){t.themeElements={};var a;[["clrScheme",j9,R9],["fontScheme",I9,F9],["fmtScheme",P9,M9]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var B9=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function xE(e,t){(!e||e.length===0)&&(e=Mg());var r,a={};if(!(r=e.match(B9)))throw new Error("themeElements not found in theme");return L9(r[0],a,t),a.raw=e,a}function Mg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Yr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function U9(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var o=e.slice(e.l);e.l=a;var l;try{l=lS(o,{type:"array"})}catch{return}var u=gn(l,"theme/theme/theme1.xml",!0);if(u)return xE(u,r)}}function z9(e){return e.read_shift(4)}function V9(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=H9(e,4);break;case 2:t.xclrValue=XS(e);break;case 3:t.xclrValue=z9(e);break;case 4:e.l+=4;break}return e.l+=8,t}function H9(e,t){return Pa(e,t)}function $9(e,t){return Pa(e,t)}function W9(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=V9(e);break;case 6:a[1]=$9(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function G9(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),o=[];n-- >0;)o.push(W9(e,r-e.l));return{ixfe:a,ext:o}}function q9(e,t){t.forEach(function(r){r[0]})}function Y9(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ia(e)}}function X9(e){var t=Ne(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),ga(e.name,t),t.slice(0,t.l)}function K9(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function J9(e){var t=Ne(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Q9(e,t){var r=Ne(8+2*t.length);return r.write_shift(4,e),ga(t,r),r.slice(0,r.l)}function Z9(e){return e.l+=4,e.read_shift(4)!=0}function e7(e,t){var r=Ne(8);return r.write_shift(4,e),r.write_shift(4,1),r}function t7(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},o=[],l=!1,u=2;return Ks(e,function(f,h,g){switch(g){case 335:a.Types.push({name:f.name});break;case 51:f.forEach(function(v){u==1?a.Cell.push({type:a.Types[v[0]-1].name,index:v[1]}):u==0&&a.Value.push({type:a.Types[v[0]-1].name,index:v[1]})});break;case 337:u=f?1:0;break;case 338:u=2;break;case 35:o.push(g),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!h.T){if(!l||n.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),a}function r7(){var e=Ka();return Be(e,332),Be(e,334,as(1)),Be(e,335,X9({name:"XLDAPR",version:12e4,flags:3496657072})),Be(e,336),Be(e,339,Q9(1,"XLDAPR")),Be(e,52),Be(e,35,as(514)),Be(e,4096,as(0)),Be(e,4097,Mn(1)),Be(e,36),Be(e,53),Be(e,340),Be(e,337,e7(1)),Be(e,51,J9([[1,0]])),Be(e,338),Be(e,333),e.end()}function a7(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,o=2,l;return e.replace(La,function(u){var f=Tt(u);switch(ws(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<a.Types.length;++h)a.Types[h].name==f.name&&(l=a.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?a.Cell.push({type:a.Types[f.t-1].name,index:+f.v}):o==0&&a.Value.push({type:a.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return u}),a}function vE(){var e=[Yr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function n7(e){var t=[];if(!e)return t;var r=1;return(e.match(La)||[]).forEach(function(a){var n=Tt(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function s7(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=bt(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function i7(e,t,r){var a=[];return Ks(e,function(o,l,u){switch(u){case 63:a.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}function o7(e,t,r,a){if(!e)return e;var n=a||{},o=!1;Ks(e,function(u,f,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!f.T){if(!o||n.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},n)}function l7(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Pl=1024;function pE(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[We("xml",null,{"xmlns:v":un.v,"xmlns:o":un.o,"xmlns:x":un.x,"xmlns:mv":un.mv}).replace(/\/>/,">"),We("o:shapelayout",We("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),We("v:shapetype",[We("v:stroke",null,{joinstyle:"miter"}),We("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];Pl<e*1e3;)Pl+=1e3;return t.forEach(function(o){var l=Ir(o[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?We("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=We("v:fill",f,u),g={on:"t",obscured:"t"};++Pl,n=n.concat(["<v:shape"+Cu({id:"_x0000_s"+Pl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,We("v:shadow",null,g),We("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ka("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),ka("x:AutoFill","False"),ka("x:Row",String(l.r)),ka("x:Column",String(l.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function Sw(e,t,r,a){var n=Array.isArray(e),o;t.forEach(function(l){var u=Ir(l.ref);if(n?(e[u.r]||(e[u.r]=[]),o=e[u.r][u.c]):o=e[l.ref],!o){o={t:"z"},n?e[u.r][u.c]=o:e[l.ref]=o;var f=Xt(e["!ref"]||"BDWGO1000001:A1");f.s.r>u.r&&(f.s.r=u.r),f.e.r<u.r&&(f.e.r=u.r),f.s.c>u.c&&(f.s.c=u.c),f.e.c<u.c&&(f.e.c=u.c);var h=Rt(f);h!==e["!ref"]&&(e["!ref"]=h)}o.c||(o.c=[]);var g={a:l.author,t:l.t,r:l.r,T:r};l.h&&(g.h=l.h);for(var v=o.c.length-1;v>=0;--v){if(!r&&o.c[v].T)return;r&&!o.c[v].T&&o.c.splice(v,1)}if(r&&a){for(v=0;v<a.length;++v)if(g.a==a[v].id){g.a=a[v].name||g.a;break}}o.c.push(g)})}function c7(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var f=Tt(u[0]),h={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},g=Ir(f.ref);if(!(t.sheetRows&&t.sheetRows<=g.r)){var v=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!v&&!!v[1]&&Og(v[1])||{r:"",t:"",h:""};h.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),h.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(h.h=p.h),a.push(h)}}}}),a}function yE(e){var t=[Yr,We("comments",null,{xmlns:Oo[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var o=or(n.a);r.indexOf(o)==-1&&(r.push(o),t.push("<author>"+o+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,o=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(f){f.a&&(n=r.indexOf(or(f.a))),o.push(f.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),o.length<=1)t.push(ka("t",or(o[0]||"")));else{for(var l=`Comment:
    `+o[0]+`
`,u=1;u<o.length;++u)l+=`Reply:
    `+o[u]+`
`;t.push(ka("t",or(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function u7(e,t){var r=[],a=!1,n={},o=0;return e.replace(La,function(u,f){var h=Tt(u);switch(ws(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":o=f+u.length;break;case"</text>":n.t=e.slice(o,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return u}),r}function f7(e,t,r){var a=[Yr,We("ThreadedComments",null,{xmlns:oa.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var o="";(n[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var f={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?o=f.id:f.parentId=o,l.ID=f.id,l.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),a.push(We("threadedComment",ka("text",l.t||""),f))})}),a.push("</ThreadedComments>"),a.join("")}function d7(e,t){var r=[],a=!1;return e.replace(La,function(o){var l=Tt(o);switch(ws(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function h7(e){var t=[Yr,We("personList",null,{xmlns:oa.TCMNT,"xmlns:x":Oo[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(We("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function m7(e){var t={};t.iauthor=e.read_shift(4);var r=jo(e);return t.rfx=r.s,t.ref=bt(r.s),e.l+=16,t}function g7(e,t){return t==null&&(t=Ne(36)),t.write_shift(4,e[1].iauthor),ec(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var x7=Ia;function v7(e){return ga(e.slice(0,54))}function p7(e,t){var r=[],a=[],n={},o=!1;return Ks(e,function(u,f,h){switch(h){case 632:a.push(u);break;case 635:n=u;break;case 637:n.t=u.t,n.h=u.h,n.r=u.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!o||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}function y7(e){var t=Ka(),r=[];return Be(t,628),Be(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),Be(t,632,v7(n.a)))})}),Be(t,631),Be(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var o={s:Ir(a[0]),e:Ir(a[0])};Be(t,635,g7([o,n])),n.t&&n.t.length>0&&Be(t,637,zM(n)),Be(t,636),delete n.iauthor})}),Be(t,634),Be(t,629),t.end()}var _7="application/vnd.ms-office.vbaProject";function w7(e){var t=mt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");mt.utils.cfb_add(t,n,e.FileIndex[a].content)}}),mt.write(t)}function b7(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&mt.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var _E=["xlsb","xlsm","xlam","biff8","xla"];function S7(){return{"!type":"dialog"}}function E7(){return{"!type":"dialog"}}function T7(){return{"!type":"macro"}}function k7(){return{"!type":"macro"}}var Hl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,o,l){var u=!1,f=!1;o.length==0?f=!0:o.charAt(0)=="["&&(f=!0,o=o.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var h=o.length>0?parseInt(o,10)|0:0,g=l.length>0?parseInt(l,10)|0:0;return u?g+=t.c:--g,f?h+=t.r:--h,n+(u?"":"$")+jr(g)+(f?"":"$")+qr(h)}return function(n,o){return t=o,n.replace(e,r)}}(),jg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ig=function(){return function(t,r){return t.replace(jg,function(a,n,o,l,u,f){var h=bg(l)-(o?0:r.c),g=wg(f)-(u?0:r.r),v=g==0?"":u?g+1:"["+g+"]",p=h==0?"":o?h+1:"["+h+"]";return n+"R"+v+"C"+p})}}();function wE(e,t){return e.replace(jg,function(r,a,n,o,l,u){return a+(n=="$"?n+o:jr(bg(o)+t.c))+(l=="$"?l+u:qr(wg(u)+t.r))})}function A7(e,t,r){var a=Ja(t),n=a.s,o=Ir(r),l={r:o.r-n.r,c:o.c-n.c};return wE(e,l)}function C7(e){return e.length!=1}function Ew(e){return e.replace(/_xlfn\./g,"")}function Qr(e){e.l+=1}function Li(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function bE(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return SE(e);r.biff==12&&(a=4)}var n=e.read_shift(a),o=e.read_shift(a),l=Li(e),u=Li(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function SE(e){var t=Li(e),r=Li(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function N7(e,t,r){if(r.biff<8)return SE(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),o=Li(e),l=Li(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function EE(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return D7(e);var a=e.read_shift(r&&r.biff==12?4:2),n=Li(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function D7(e){var t=Li(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function O7(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function R7(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return F7(e);var n=e.read_shift(a>=12?4:2),o=e.read_shift(2),l=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;n>524287;)n-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:n,c:o,cRel:l,rRel:u}}function F7(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function M7(e,t,r){var a=(e[e.l++]&96)>>5,n=bE(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function j7(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),o=8;if(r)switch(r.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var l=bE(e,o,r);return[a,n,l]}function I7(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function P7(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),o=8;if(r)switch(r.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[a,n]}function L7(e,t,r){var a=(e[e.l++]&96)>>5,n=N7(e,t-1,r);return[a,n]}function B7(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function Tw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function U7(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],o=0;o<=a;++o)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function z7(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function V7(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function H7(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function $7(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function TE(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function W7(e){return e.read_shift(2),TE(e)}function G7(e){return e.read_shift(2),TE(e)}function q7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=EE(e,0,r);return[a,n]}function Y7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=R7(e,0,r);return[a,n]}function X7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var o=EE(e,0,r);return[a,n,o]}function K7(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[ZL[n],CE[n],a]}function J7(e,t,r){var a=e[e.l++],n=e.read_shift(1),o=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:Q7(e);return[n,(o[0]===0?CE:QL)[o[1]]]}function Q7(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Z7(e,t,r){e.l+=r&&r.biff==2?3:4}function eL(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function tL(e){return e.l++,Js[e.read_shift(1)]}function rL(e){return e.l++,e.read_shift(2)}function aL(e){return e.l++,e.read_shift(1)!==0}function nL(e){return e.l++,ja(e)}function sL(e,t,r){return e.l++,qu(e,t-1,r)}function iL(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Wr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Js[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ja(e);break;case 2:r[1]=Io(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function oL(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],o=0;o!=a;++o)n.push((r.biff==12?jo:ud)(e));return n}function lL(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var o=0,l=[];o!=a&&(l[o]=[]);++o)for(var u=0;u!=n;++u)l[o][u]=iL(e,r.biff);return l}function cL(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,o=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,o]}function uL(e,t,r){if(r.biff==5)return fL(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),o=e.read_shift(4);return[a,n,o]}function fL(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function dL(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function hL(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function mL(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function gL(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[a,n]}var xL=Pa,vL=Pa,pL=Pa;function Xu(e,t,r){return e.l+=2,[O7(e)]}function Pg(e){return e.l+=6,[]}var yL=Xu,_L=Pg,wL=Pg,bL=Xu;function kE(e){return e.l+=2,[ta(e),e.read_shift(2)&1]}var SL=Xu,EL=kE,TL=Pg,kL=Xu,AL=Xu,CL=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function NL(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),o=e.read_shift(2),l=CL[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:a,c:n,C:o}}function DL(e){return e.l+=2,[e.read_shift(4)]}function OL(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function RL(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function FL(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function ML(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function jL(e){return e.l+=4,[0,0]}var kw={1:{n:"PtgExp",f:eL},2:{n:"PtgTbl",f:pL},3:{n:"PtgAdd",f:Qr},4:{n:"PtgSub",f:Qr},5:{n:"PtgMul",f:Qr},6:{n:"PtgDiv",f:Qr},7:{n:"PtgPower",f:Qr},8:{n:"PtgConcat",f:Qr},9:{n:"PtgLt",f:Qr},10:{n:"PtgLe",f:Qr},11:{n:"PtgEq",f:Qr},12:{n:"PtgGe",f:Qr},13:{n:"PtgGt",f:Qr},14:{n:"PtgNe",f:Qr},15:{n:"PtgIsect",f:Qr},16:{n:"PtgUnion",f:Qr},17:{n:"PtgRange",f:Qr},18:{n:"PtgUplus",f:Qr},19:{n:"PtgUminus",f:Qr},20:{n:"PtgPercent",f:Qr},21:{n:"PtgParen",f:Qr},22:{n:"PtgMissArg",f:Qr},23:{n:"PtgStr",f:sL},26:{n:"PtgSheet",f:OL},27:{n:"PtgEndSheet",f:RL},28:{n:"PtgErr",f:tL},29:{n:"PtgBool",f:aL},30:{n:"PtgInt",f:rL},31:{n:"PtgNum",f:nL},32:{n:"PtgArray",f:B7},33:{n:"PtgFunc",f:K7},34:{n:"PtgFuncVar",f:J7},35:{n:"PtgName",f:cL},36:{n:"PtgRef",f:q7},37:{n:"PtgArea",f:M7},38:{n:"PtgMemArea",f:dL},39:{n:"PtgMemErr",f:xL},40:{n:"PtgMemNoMem",f:vL},41:{n:"PtgMemFunc",f:hL},42:{n:"PtgRefErr",f:mL},43:{n:"PtgAreaErr",f:I7},44:{n:"PtgRefN",f:Y7},45:{n:"PtgAreaN",f:L7},46:{n:"PtgMemAreaN",f:FL},47:{n:"PtgMemNoMemN",f:ML},57:{n:"PtgNameX",f:uL},58:{n:"PtgRef3d",f:X7},59:{n:"PtgArea3d",f:j7},60:{n:"PtgRefErr3d",f:gL},61:{n:"PtgAreaErr3d",f:P7},255:{}},IL={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},PL={1:{n:"PtgElfLel",f:kE},2:{n:"PtgElfRw",f:kL},3:{n:"PtgElfCol",f:yL},6:{n:"PtgElfRwV",f:AL},7:{n:"PtgElfColV",f:bL},10:{n:"PtgElfRadical",f:SL},11:{n:"PtgElfRadicalS",f:TL},13:{n:"PtgElfColS",f:_L},15:{n:"PtgElfColSV",f:wL},16:{n:"PtgElfRadicalLel",f:EL},25:{n:"PtgList",f:NL},29:{n:"PtgSxName",f:DL},255:{}},LL={0:{n:"PtgAttrNoop",f:jL},1:{n:"PtgAttrSemi",f:$7},2:{n:"PtgAttrIf",f:V7},4:{n:"PtgAttrChoose",f:U7},8:{n:"PtgAttrGoto",f:z7},16:{n:"PtgAttrSum",f:Z7},32:{n:"PtgAttrBaxcel",f:Tw},33:{n:"PtgAttrBaxcel",f:Tw},64:{n:"PtgAttrSpace",f:W7},65:{n:"PtgAttrSpaceSemi",f:G7},128:{n:"PtgAttrIfError",f:H7},255:{}};function Ku(e,t,r,a){if(a.biff<8)return Pa(e,t);for(var n=e.l+t,o=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=lL(e,0,a),o.push(r[l][1]);break;case"PtgMemArea":r[l][2]=oL(e,r[l][1],a),o.push(r[l][2]);break;case"PtgExp":a&&a.biff==12&&(r[l][1][1]=e.read_shift(4),o.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=n-e.l,t!==0&&o.push(Pa(e,t)),o}function Ju(e,t,r){for(var a=e.l+t,n,o,l=[];a!=e.l;)t=a-e.l,o=e[e.l],n=kw[o]||kw[IL[o]],(o===24||o===25)&&(n=(o===24?PL:LL)[e[e.l+1]]),!n||!n.f?Pa(e,t):l.push([n.n,n.f(e,t,r)]);return l}function BL(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],o=0;o<a.length;++o){var l=a[o];if(l)switch(l[0]){case 2:n.push('"'+l[1].replace(/"/g,'""')+'"');break;default:n.push(l[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var UL={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function zL(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function AE(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Aw(e,t,r){var a=AE(e,t,r);return a=="#REF"?a:zL(a,r)}function Oa(e,t,r,a,n){var o=n&&n.biff||8,l={s:{c:0,r:0}},u=[],f,h,g,v=0,p=0,_,b="";if(!e[0]||!e[0][0])return"";for(var w=-1,S="",T=0,N=e[0].length;T<N;++T){var k=e[0][T];switch(k[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),h=u.pop(),w>=0){switch(e[0][w][1][0]){case 0:S=Ur(" ",e[0][w][1][1]);break;case 1:S=Ur("\r",e[0][w][1][1]);break;default:if(S="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}h=h+S,w=-1}u.push(h+UL[k[0]]+f);break;case"PtgIsect":f=u.pop(),h=u.pop(),u.push(h+" "+f);break;case"PtgUnion":f=u.pop(),h=u.pop(),u.push(h+","+f);break;case"PtgRange":f=u.pop(),h=u.pop(),u.push(h+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=lu(k[1][1],l,n),u.push(cu(g,o));break;case"PtgRefN":g=r?lu(k[1][1],r,n):k[1][1],u.push(cu(g,o));break;case"PtgRef3d":v=k[1][1],g=lu(k[1][2],l,n),b=Aw(a,v,n),u.push(b+"!"+cu(g,o));break;case"PtgFunc":case"PtgFuncVar":var E=k[1][0],M=k[1][1];E||(E=0),E&=127;var D=E==0?[]:u.slice(-E);u.length-=E,M==="User"&&(M=D.shift()),u.push(M+"("+D.join(",")+")");break;case"PtgBool":u.push(k[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(k[1]);break;case"PtgNum":u.push(String(k[1]));break;case"PtgStr":u.push('"'+k[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(k[1]);break;case"PtgAreaN":_=rw(k[1][1],r?{s:r}:l,n),u.push(Um(_,n));break;case"PtgArea":_=rw(k[1][1],l,n),u.push(Um(_,n));break;case"PtgArea3d":v=k[1][1],_=k[1][2],b=Aw(a,v,n),u.push(b+"!"+Um(_,n));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=k[1][2];var A=(a.names||[])[p-1]||(a[0]||[])[p],B=A?A.Name:"SH33TJSNAME"+String(p);B&&B.slice(0,6)=="_xlfn."&&!n.xlfn&&(B=B.slice(6)),u.push(B);break;case"PtgNameX":var j=k[1][1];p=k[1][2];var ee;if(n.biff<=5)j<0&&(j=-j),a[j]&&(ee=a[j][p]);else{var re="";if(((a[j]||[])[0]||[])[0]==14849||(((a[j]||[])[0]||[])[0]==1025?a[j][p]&&a[j][p].itab>0&&(re=a.SheetNames[a[j][p].itab-1]+"!"):re=a.SheetNames[p-1]+"!"),a[j]&&a[j][p])re+=a[j][p].Name;else if(a[0]&&a[0][p])re+=a[0][p].Name;else{var U=(AE(a,j,n)||"").split(";;");U[p-1]?re=U[p-1]:re+="SH33TJSERRX"}u.push(re);break}ee||(ee={Name:"SH33TJSERRY"}),u.push(ee.Name);break;case"PtgParen":var I="(",ne=")";if(w>=0){switch(S="",e[0][w][1][0]){case 2:I=Ur(" ",e[0][w][1][1])+I;break;case 3:I=Ur("\r",e[0][w][1][1])+I;break;case 4:ne=Ur(" ",e[0][w][1][1])+ne;break;case 5:ne=Ur("\r",e[0][w][1][1])+ne;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}u.push(I+u.pop()+ne);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":g={c:k[1][1],r:k[1][0]};var ie={c:r.c,r:r.r};if(a.sharedf[bt(g)]){var q=a.sharedf[bt(g)];u.push(Oa(q,l,ie,a,n))}else{var ae=!1;for(f=0;f!=a.arrayf.length;++f)if(h=a.arrayf[f],!(g.c<h[0].s.c||g.c>h[0].e.c)&&!(g.r<h[0].s.r||g.r>h[0].e.r)){u.push(Oa(h[1],l,ie,a,n)),ae=!0;break}ae||u.push(k[1])}break;case"PtgArray":u.push("{"+BL(k[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+k[1].idx+"[#"+k[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(k));default:throw new Error("Unrecognized Formula Token: "+String(k))}var be=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&w>=0&&be.indexOf(e[0][T][0])==-1){k=e[0][w];var z=!0;switch(k[1][0]){case 4:z=!1;case 0:S=Ur(" ",k[1][1]);break;case 5:z=!1;case 1:S=Ur("\r",k[1][1]);break;default:if(S="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+k[1][0])}u.push((z?S:"")+u.pop()+(z?"":S)),w=-1}}if(u.length>1&&n.WTF)throw new Error("bad formula stack");return u[0]}function VL(e,t,r){var a=e.l+t,n=r.biff==2?1:2,o,l=e.read_shift(n);if(l==65535)return[[],Pa(e,t-2)];var u=Ju(e,l,r);return t!==l+n&&(o=Ku(e,t-l-n,u,r)),e.l=a,[u,o]}function HL(e,t,r){var a=e.l+t,n=r.biff==2?1:2,o,l=e.read_shift(n);if(l==65535)return[[],Pa(e,t-2)];var u=Ju(e,l,r);return t!==l+n&&(o=Ku(e,t-l-n,u,r)),e.l=a,[u,o]}function $L(e,t,r,a){var n=e.l+t,o=Ju(e,a,r),l;return n!==e.l&&(l=Ku(e,n-e.l,o,r)),[o,l]}function WL(e,t,r){var a=e.l+t,n,o=e.read_shift(2),l=Ju(e,o,r);return o==65535?[[],Pa(e,t-2)]:(t!==o+2&&(n=Ku(e,a-o-2,l,r)),[l,n])}function GL(e){var t;if(Hs(e,e.l+6)!==65535)return[ja(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function qL(e){if(e==null){var t=Ne(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ko(e);return ko(0)}function Wm(e,t,r){var a=e.l+t,n=bs(e);r.biff==2&&++e.l;var o=GL(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=HL(e,a-e.l,r);return{cell:n,val:o[0],formula:u,shared:l>>3&1,tt:o[1]}}function YL(e,t,r,a,n){var o=Co(t,r,n),l=qL(e.v),u=Ne(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var h=Ne(e.bf.length),g=0;g<e.bf.length;++g)h[g]=e.bf[g];var v=ma([o,l,u,h]);return v}function fd(e,t,r){var a=e.read_shift(4),n=Ju(e,a,r),o=e.read_shift(4),l=o>0?Ku(e,o,n,r):null;return[n,l]}var XL=fd,dd=fd,KL=fd,JL=fd,QL={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},CE={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},ZL={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Cw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function eB(e){var t="of:="+e.replace(jg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Gm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function tB(e){return e.replace(/\./,"!")}var fu={},$l={},du=typeof Map<"u";function Lg(e,t,r){var a=0,n=e.length;if(r){if(du?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var o=du?r.get(t):r[t];a<o.length;++a)if(e[o[a]].t===t)return e.Count++,o[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(du?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function hd(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(Ma=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=Fu(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=W0(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function So(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Hi(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,o=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){Ws(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=o;++n)if(e[n].numFmtId===a)return n;return e[o]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function NE(e,t,r,a,n,o){try{a.cellNF&&(e.z=wt[t])}catch(u){if(a.WTF)throw u}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ar(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(wt[t]==null&&Ws(QF[t]||"General",t),e.t==="e")e.w=e.w||Js[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ku(e.v);else if(e.t==="d"){var l=la(e.v);(l|0)===l?e.w=l.toString(10):e.w=ku(l)}else{if(e.v===void 0)return"";e.w=Eo(e.v,$l)}else e.t==="d"?e.w=Pn(t,la(e.v),$l):e.w=Pn(t,e.v,$l)}catch(u){if(a.WTF)throw u}if(a.cellStyles&&r!=null)try{e.s=o.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=$0(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=$0(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(a.WTF&&o.Fills)throw u}}}function rB(e,t,r){if(e&&e["!ref"]){var a=Xt(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function aB(e,t){var r=Xt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Rt(r))}var nB=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sB=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,iB=/<(?:\w:)?hyperlink [^>]*>/mg,oB=/"(\w*:\w*)"/,lB=/<(?:\w:)?col\b[^>]*[\/]?>/g,cB=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,uB=/<(?:\w:)?pageMargins[^>]*\/>/g,DE=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,fB=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,dB=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function hB(e,t,r,a,n,o,l){if(!e)return e;a||(a={"!id":{}});var u=t.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",g="",v=e.match(sB);v?(h=e.slice(0,v.index),g=e.slice(v.index+v[0].length)):h=g=e;var p=h.match(DE);p?Bg(p[0],u,n,r):(p=h.match(fB))&&gB(p[0],p[1]||"",u,n,r);var _=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var b=h.slice(_,_+50).match(oB);b&&aB(u,b[1])}var w=h.match(dB);w&&w[1]&&CB(w[1],n);var S=[];if(t.cellStyles){var T=h.match(lB);T&&SB(S,T)}v&&OB(v[1],u,t,f,o,l);var N=g.match(cB);N&&(u["!autofilter"]=TB(N[0]));var k=[],E=g.match(nB);if(E)for(_=0;_!=E.length;++_)k[_]=Xt(E[_].slice(E[_].indexOf('"')+1));var M=g.match(iB);M&&_B(u,M,a);var D=g.match(uB);if(D&&(u["!margins"]=wB(Tt(D[0]))),!u["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(u["!ref"]=Rt(f)),t.sheetRows>0&&u["!ref"]){var A=Xt(u["!ref"]);t.sheetRows<=+A.e.r&&(A.e.r=t.sheetRows-1,A.e.r>f.e.r&&(A.e.r=f.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>f.e.c&&(A.e.c=f.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Rt(A))}return S.length>0&&(u["!cols"]=S),k.length>0&&(u["!merges"]=k),u}function mB(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Rt(e[r])+'"/>';return t+"</mergeCells>"}function Bg(e,t,r,a){var n=Tt(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=Yt(mr(n.codeName)))}function gB(e,t,r,a,n){Bg(e.slice(0,e.indexOf(">")),r,a,n)}function xB(e,t,r,a,n){var o=!1,l={},u=null;if(a.bookType!=="xlsx"&&t.vbaraw){var f=t.SheetNames[r];try{t.Workbook&&(f=t.Workbook.Sheets[r].CodeName||f)}catch{}o=!0,l.codeName=ps(or(f))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),u=(u||"")+We("outlinePr",null,h)}!o&&!u||(n[n.length]=We("sheetPr",u,l))}var vB=["objects","scenarios","selectLockedCells","selectUnlockedCells"],pB=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function yB(e){var t={sheet:1};return vB.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),pB.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Rg(e.password).toString(16).toUpperCase()),We("sheetProtection",null,t)}function _B(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var o=Tt(mr(t[n]),!0);if(!o.ref)return;var l=((r||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+Yt(o.location))):(o.Target="#"+Yt(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=Xt(o.ref),f=u.s.r;f<=u.e.r;++f)for(var h=u.s.c;h<=u.e.c;++h){var g=bt({c:h,r:f});a?(e[f]||(e[f]=[]),e[f][h]||(e[f][h]={t:"z",v:void 0}),e[f][h].l=o):(e[g]||(e[g]={t:"z",v:void 0}),e[g].l=o)}}}function wB(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function bB(e){return So(e),We("pageMargins",null,e)}function SB(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=Tt(t[a],!0);n.hidden&&(n.hidden=kr(n.hidden));var o=parseInt(n.min,10)-1,l=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Fg(n.width)),Pi(n);o<=l;)e[o++]=Cr(n)}}function EB(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=We("col",null,hd(n,a)));return r[r.length]="</cols>",r.join("")}function TB(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function kB(e,t,r,a){var n=typeof e.ref=="string"?e.ref:Rt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Ja(n);l.s.r==l.e.r&&(l.e.r=Ja(t["!ref"]).e.r,n=Rt(l));for(var u=0;u<o.length;++u){var f=o[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==a){f.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),We("autoFilter",null,{ref:n})}var AB=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function CB(e,t){t.Views||(t.Views=[{}]),(e.match(AB)||[]).forEach(function(r,a){var n=Tt(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),kr(n.rightToLeft)&&(t.Views[a].RTL=!0)})}function NB(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),We("sheetViews",We("sheetView",null,n),{})}function DB(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",o=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Js[e.v];break;case"d":a&&a.cellDates?n=Ar(e.v,-1).toISOString():(e=Cr(e),e.t="n",n=""+(e.v=la(Ar(e.v)))),typeof e.z>"u"&&(e.z=wt[14]);break;default:n=e.v;break}var u=ka("v",or(n)),f={r:t},h=Hi(a.cellXfs,e,a);switch(h!==0&&(f.s=h),e.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){u=ka("v",""+Lg(a.Strings,e.v,a.revStrings)),f.t="s";break}f.t="str";break}if(e.t!=o&&(e.t=o,e.v=l),typeof e.f=="string"&&e.f){var g=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=We("f",or(e.f),g)+(e.v!=null?u:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(f.cm=1),We("c",u,f)}var OB=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,o=Au("v"),l=Au("f");return function(f,h,g,v,p,_){for(var b=0,w="",S=[],T=[],N=0,k=0,E=0,M="",D,A,B=0,j=0,ee,re,U=0,I=0,ne=Array.isArray(_.CellXf),ie,q=[],ae=[],be=Array.isArray(h),z=[],fe={},De=!1,P=!!g.sheetStubs,X=f.split(t),Y=0,Q=X.length;Y!=Q;++Y){w=X[Y].trim();var de=w.length;if(de!==0){var Fe=0;e:for(b=0;b<de;++b)switch(w[b]){case">":if(w[b-1]!="/"){++b;break e}if(g&&g.cellStyles){if(A=Tt(w.slice(Fe,b),!0),B=A.r!=null?parseInt(A.r,10):B+1,j=-1,g.sheetRows&&g.sheetRows<B)continue;fe={},De=!1,A.ht&&(De=!0,fe.hpt=parseFloat(A.ht),fe.hpx=Yl(fe.hpt)),A.hidden=="1"&&(De=!0,fe.hidden=!0),A.outlineLevel!=null&&(De=!0,fe.level=+A.outlineLevel),De&&(z[B-1]=fe)}break;case"<":Fe=b;break}if(Fe>=b)break;if(A=Tt(w.slice(Fe,b),!0),B=A.r!=null?parseInt(A.r,10):B+1,j=-1,!(g.sheetRows&&g.sheetRows<B)){v.s.r>B-1&&(v.s.r=B-1),v.e.r<B-1&&(v.e.r=B-1),g&&g.cellStyles&&(fe={},De=!1,A.ht&&(De=!0,fe.hpt=parseFloat(A.ht),fe.hpx=Yl(fe.hpt)),A.hidden=="1"&&(De=!0,fe.hidden=!0),A.outlineLevel!=null&&(De=!0,fe.level=+A.outlineLevel),De&&(z[B-1]=fe)),S=w.slice(b).split(e);for(var Te=0;Te!=S.length&&S[Te].trim().charAt(0)=="<";++Te);for(S=S.slice(Te),b=0;b!=S.length;++b)if(w=S[b].trim(),w.length!==0){if(T=w.match(r),N=b,k=0,E=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,T!=null&&T.length===2){for(N=0,M=T[1],k=0;k!=M.length&&!((E=M.charCodeAt(k)-64)<1||E>26);++k)N=26*N+E;--N,j=N}else++j;for(k=0;k!=w.length&&w.charCodeAt(k)!==62;++k);if(++k,A=Tt(w.slice(0,k),!0),A.r||(A.r=bt({r:B-1,c:j})),M=w.slice(k),D={t:""},(T=M.match(o))!=null&&T[1]!==""&&(D.v=Yt(T[1])),g.cellFormula){if((T=M.match(l))!=null&&T[1]!==""){if(D.f=Yt(mr(T[1])).replace(/\r\n/g,`
`),g.xlfn||(D.f=Ew(D.f)),T[0].indexOf('t="array"')>-1)D.F=(M.match(n)||[])[1],D.F.indexOf(":")>-1&&q.push([Xt(D.F),D.F]);else if(T[0].indexOf('t="shared"')>-1){re=Tt(T[0]);var Oe=Yt(mr(T[1]));g.xlfn||(Oe=Ew(Oe)),ae[parseInt(re.si,10)]=[re,Oe,A.r]}}else(T=M.match(/<f[^>]*\/>/))&&(re=Tt(T[0]),ae[re.si]&&(D.f=A7(ae[re.si][1],ae[re.si][2],A.r)));var Re=Ir(A.r);for(k=0;k<q.length;++k)Re.r>=q[k][0].s.r&&Re.r<=q[k][0].e.r&&Re.c>=q[k][0].s.c&&Re.c<=q[k][0].e.c&&(D.F=q[k][1])}if(A.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(P)D.t="z";else continue;else D.t=A.t||"n";switch(v.s.c>j&&(v.s.c=j),v.e.c<j&&(v.e.c=j),D.t){case"n":if(D.v==""||D.v==null){if(!P)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!P)continue;D.t="z"}else ee=fu[parseInt(D.v,10)],D.v=ee.t,D.r=ee.r,g.cellHTML&&(D.h=ee.h);break;case"str":D.t="s",D.v=D.v!=null?mr(D.v):"",g.cellHTML&&(D.h=vg(D.v));break;case"inlineStr":T=M.match(a),D.t="s",T!=null&&(ee=Og(T[1]))?(D.v=ee.t,g.cellHTML&&(D.h=ee.h)):D.v="";break;case"b":D.v=kr(D.v);break;case"d":g.cellDates?D.v=Ar(D.v,1):(D.v=la(Ar(D.v,1)),D.t="n");break;case"e":(!g||g.cellText!==!1)&&(D.w=D.v),D.v=RS[D.v];break}if(U=I=0,ie=null,ne&&A.s!==void 0&&(ie=_.CellXf[A.s],ie!=null&&(ie.numFmtId!=null&&(U=ie.numFmtId),g.cellStyles&&ie.fillId!=null&&(I=ie.fillId))),NE(D,U,I,g,p,_),g.cellDates&&ne&&D.t=="n"&&Jl(wt[U])&&(D.t="d",D.v=cd(D.v)),A.cm&&g.xlmeta){var Je=(g.xlmeta.Cell||[])[+A.cm-1];Je&&Je.type=="XLDAPR"&&(D.D=!0)}if(be){var H=Ir(A.r);h[H.r]||(h[H.r]=[]),h[H.r][H.c]=D}else h[A.r]=D}}}}z.length>0&&(h["!rows"]=z)}}();function RB(e,t,r,a){var n=[],o=[],l=Xt(e["!ref"]),u="",f,h="",g=[],v=0,p=0,_=e["!rows"],b=Array.isArray(e),w={r:h},S,T=-1;for(p=l.s.c;p<=l.e.c;++p)g[p]=jr(p);for(v=l.s.r;v<=l.e.r;++v){for(o=[],h=qr(v),p=l.s.c;p<=l.e.c;++p){f=g[p]+h;var N=b?(e[v]||[])[p]:e[f];N!==void 0&&(u=DB(N,f,e,t))!=null&&o.push(u)}(o.length>0||_&&_[v])&&(w={r:h},_&&_[v]&&(S=_[v],S.hidden&&(w.hidden=1),T=-1,S.hpx?T=Mu(S.hpx):S.hpt&&(T=S.hpt),T>-1&&(w.ht=T,w.customHeight=1),S.level&&(w.outlineLevel=S.level)),n[n.length]=We("row",o.join(""),w))}if(_)for(;v<_.length;++v)_&&_[v]&&(w={r:v+1},S=_[v],S.hidden&&(w.hidden=1),T=-1,S.hpx?T=Mu(S.hpx):S.hpt&&(T=S.hpt),T>-1&&(w.ht=T,w.customHeight=1),S.level&&(w.outlineLevel=S.level),n[n.length]=We("row","",w));return n.join("")}function OE(e,t,r,a){var n=[Yr,We("worksheet",null,{xmlns:Oo[0],"xmlns:r":oa.r})],o=r.SheetNames[e],l=0,u="",f=r.Sheets[o];f==null&&(f={});var h=f["!ref"]||"A1",g=Xt(h);if(g.e.c>16383||g.e.r>1048575){if(t.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575),h=Rt(g)}a||(a={}),f["!comments"]=[];var v=[];xB(f,r,e,t,n),n[n.length]=We("dimension",null,{ref:h}),n[n.length]=NB(f,t,e,r),t.sheetFormat&&(n[n.length]=We("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(n[n.length]=EB(f,f["!cols"])),n[l=n.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=RB(f,t),u.length>0&&(n[n.length]=u)),n.length>l+1&&(n[n.length]="</sheetData>",n[l]=n[l].replace("/>",">")),f["!protect"]&&(n[n.length]=yB(f["!protect"])),f["!autofilter"]!=null&&(n[n.length]=kB(f["!autofilter"],f,r,e)),f["!merges"]!=null&&f["!merges"].length>0&&(n[n.length]=mB(f["!merges"]));var p=-1,_,b=-1;return f["!links"].length>0&&(n[n.length]="<hyperlinks>",f["!links"].forEach(function(w){w[1].Target&&(_={ref:w[0]},w[1].Target.charAt(0)!="#"&&(b=sr(a,-1,or(w[1].Target).replace(/#.*$/,""),Bt.HLINK),_["r:id"]="rId"+b),(p=w[1].Target.indexOf("#"))>-1&&(_.location=or(w[1].Target.slice(p+1))),w[1].Tooltip&&(_.tooltip=or(w[1].Tooltip)),n[n.length]=We("hyperlink",null,_))}),n[n.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(n[n.length]=bB(f["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=ka("ignoredErrors",We("ignoredError",null,{numberStoredAsText:1,sqref:h}))),v.length>0&&(b=sr(a,-1,"../drawings/drawing"+(e+1)+".xml",Bt.DRAW),n[n.length]=We("drawing",null,{"r:id":"rId"+b}),f["!drawing"]=v),f["!comments"].length>0&&(b=sr(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Bt.VML),n[n.length]=We("legacyDrawing",null,{"r:id":"rId"+b}),f["!legacy"]=b),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function FB(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=a,o&7&&(r.level=o&7),o&16&&(r.hidden=!0),o&32&&(r.hpt=n/20),r}function MB(e,t,r){var a=Ne(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var o=320;n.hpx?o=Mu(n.hpx)*20:n.hpt&&(o=n.hpt*20),a.write_shift(2,o),a.write_shift(1,0);var l=0;n.level&&(l|=n.level),n.hidden&&(l|=16),(n.hpx||n.hpt)&&(l|=32),a.write_shift(1,l),a.write_shift(1,0);var u=0,f=a.l;a.l+=4;for(var h={r:e,c:0},g=0;g<16;++g)if(!(t.s.c>g+1<<10||t.e.c<g<<10)){for(var v=-1,p=-1,_=g<<10;_<g+1<<10;++_){h.c=_;var b=Array.isArray(r)?(r[h.r]||[])[h.c]:r[bt(h)];b&&(v<0&&(v=_),p=_)}v<0||(++u,a.write_shift(4,v),a.write_shift(4,p))}var w=a.l;return a.l=f,a.write_shift(4,u),a.l=w,a.length>a.l?a.slice(0,a.l):a}function jB(e,t,r,a){var n=MB(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&Be(e,0,n)}var IB=jo,PB=ec;function LB(){}function BB(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=VM(e),r}function UB(e,t,r){r==null&&(r=Ne(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return z0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),AS(e,r),r.slice(0,r.l)}function zB(e){var t=Ln(e);return[t]}function VB(e,t,r){return r==null&&(r=Ne(8)),Ro(t,r)}function HB(e){var t=Fo(e);return[t]}function $B(e,t,r){return r==null&&(r=Ne(4)),Mo(t,r)}function WB(e){var t=Ln(e),r=e.read_shift(1);return[t,r,"b"]}function GB(e,t,r){return r==null&&(r=Ne(9)),Ro(t,r),r.write_shift(1,e.v?1:0),r}function qB(e){var t=Fo(e),r=e.read_shift(1);return[t,r,"b"]}function YB(e,t,r){return r==null&&(r=Ne(5)),Mo(t,r),r.write_shift(1,e.v?1:0),r}function XB(e){var t=Ln(e),r=e.read_shift(1);return[t,r,"e"]}function KB(e,t,r){return r==null&&(r=Ne(9)),Ro(t,r),r.write_shift(1,e.v),r}function JB(e){var t=Fo(e),r=e.read_shift(1);return[t,r,"e"]}function QB(e,t,r){return r==null&&(r=Ne(8)),Mo(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function ZB(e){var t=Ln(e),r=e.read_shift(4);return[t,r,"s"]}function eU(e,t,r){return r==null&&(r=Ne(12)),Ro(t,r),r.write_shift(4,t.v),r}function tU(e){var t=Fo(e),r=e.read_shift(4);return[t,r,"s"]}function rU(e,t,r){return r==null&&(r=Ne(8)),Mo(t,r),r.write_shift(4,t.v),r}function aU(e){var t=Ln(e),r=ja(e);return[t,r,"n"]}function nU(e,t,r){return r==null&&(r=Ne(16)),Ro(t,r),ko(e.v,r),r}function RE(e){var t=Fo(e),r=ja(e);return[t,r,"n"]}function sU(e,t,r){return r==null&&(r=Ne(12)),Mo(t,r),ko(e.v,r),r}function iU(e){var t=Ln(e),r=kg(e);return[t,r,"n"]}function oU(e,t,r){return r==null&&(r=Ne(12)),Ro(t,r),CS(e.v,r),r}function lU(e){var t=Fo(e),r=kg(e);return[t,r,"n"]}function cU(e,t,r){return r==null&&(r=Ne(8)),Mo(t,r),CS(e.v,r),r}function uU(e){var t=Ln(e),r=Sg(e);return[t,r,"is"]}function fU(e){var t=Ln(e),r=Ia(e);return[t,r,"str"]}function dU(e,t,r){return r==null&&(r=Ne(12+4*e.v.length)),Ro(t,r),ga(e.v,r),r.length>r.l?r.slice(0,r.l):r}function hU(e){var t=Fo(e),r=Ia(e);return[t,r,"str"]}function mU(e,t,r){return r==null&&(r=Ne(8+4*e.v.length)),Mo(t,r),ga(e.v,r),r.length>r.l?r.slice(0,r.l):r}function gU(e,t,r){var a=e.l+t,n=Ln(e);n.r=r["!row"];var o=e.read_shift(1),l=[n,o,"b"];if(r.cellFormula){e.l+=2;var u=dd(e,a-e.l,r);l[3]=Oa(u,null,n,r.supbooks,r)}else e.l=a;return l}function xU(e,t,r){var a=e.l+t,n=Ln(e);n.r=r["!row"];var o=e.read_shift(1),l=[n,o,"e"];if(r.cellFormula){e.l+=2;var u=dd(e,a-e.l,r);l[3]=Oa(u,null,n,r.supbooks,r)}else e.l=a;return l}function vU(e,t,r){var a=e.l+t,n=Ln(e);n.r=r["!row"];var o=ja(e),l=[n,o,"n"];if(r.cellFormula){e.l+=2;var u=dd(e,a-e.l,r);l[3]=Oa(u,null,n,r.supbooks,r)}else e.l=a;return l}function pU(e,t,r){var a=e.l+t,n=Ln(e);n.r=r["!row"];var o=Ia(e),l=[n,o,"str"];if(r.cellFormula){e.l+=2;var u=dd(e,a-e.l,r);l[3]=Oa(u,null,n,r.supbooks,r)}else e.l=a;return l}var yU=jo,_U=ec;function wU(e,t){return t==null&&(t=Ne(4)),t.write_shift(4,e),t}function bU(e,t){var r=e.l+t,a=jo(e),n=Eg(e),o=Ia(e),l=Ia(e),u=Ia(e);e.l=r;var f={rfx:a,relId:n,loc:o,display:u};return l&&(f.Tooltip=l),f}function SU(e,t){var r=Ne(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ec({s:Ir(e[0]),e:Ir(e[0])},r),Tg("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return ga(n||"",r),ga(e[1].Tooltip||"",r),ga("",r),r.slice(0,r.l)}function EU(){}function TU(e,t,r){var a=e.l+t,n=NS(e),o=e.read_shift(1),l=[n];if(l[2]=o,r.cellFormula){var u=XL(e,a-e.l,r);l[1]=u}else e.l=a;return l}function kU(e,t,r){var a=e.l+t,n=jo(e),o=[n];if(r.cellFormula){var l=JL(e,a-e.l,r);o[1]=l,e.l=a}else e.l=a;return o}function AU(e,t,r){r==null&&(r=Ne(18));var a=hd(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var FE=["left","right","top","bottom","header","footer"];function CU(e){var t={};return FE.forEach(function(r){t[r]=ja(e)}),t}function NU(e,t){return t==null&&(t=Ne(6*8)),So(e),FE.forEach(function(r){ko(e[r],t)}),t}function DU(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function OU(e,t,r){r==null&&(r=Ne(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function RU(e){var t=Ne(24);return t.write_shift(4,4),t.write_shift(4,1),ec(e,t),t}function FU(e,t){return t==null&&(t=Ne(16*4+2)),t.write_shift(2,e.password?Rg(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function MU(){}function jU(){}function IU(e,t,r,a,n,o,l){if(!e)return e;var u=t||{};a||(a={"!id":{}});var f=u.dense?[]:{},h,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,p=!1,_,b,w,S,T,N,k,E,M,D=[];u.biff=12,u["!row"]=0;var A=0,B=!1,j=[],ee={},re=u.supbooks||n.supbooks||[[]];if(re.sharedf=ee,re.arrayf=j,re.SheetNames=n.SheetNames||n.Sheets.map(function(be){return be.name}),!u.supbooks&&(u.supbooks=re,n.Names))for(var U=0;U<n.Names.length;++U)re[0][U+1]=n.Names[U];var I=[],ne=[],ie=!1;ju[16]={n:"BrtShortReal",f:RE};var q;if(Ks(e,function(z,fe,De){if(!p)switch(De){case 148:h=z;break;case 0:_=z,u.sheetRows&&u.sheetRows<=_.r&&(p=!0),E=qr(S=_.r),u["!row"]=_.r,(z.hidden||z.hpt||z.level!=null)&&(z.hpt&&(z.hpx=Yl(z.hpt)),ne[z.r]=z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:z[2]},z[2]){case"n":b.v=z[1];break;case"s":k=fu[z[1]],b.v=k.t,b.r=k.r;break;case"b":b.v=!!z[1];break;case"e":b.v=z[1],u.cellText!==!1&&(b.w=Js[b.v]);break;case"str":b.t="s",b.v=z[1];break;case"is":b.t="s",b.v=z[1].t;break}if((w=l.CellXf[z[0].iStyleRef])&&NE(b,w.numFmtId,null,u,o,l),T=z[0].c==-1?T+1:z[0].c,u.dense?(f[S]||(f[S]=[]),f[S][T]=b):f[jr(T)+E]=b,u.cellFormula){for(B=!1,A=0;A<j.length;++A){var P=j[A];_.r>=P[0].s.r&&_.r<=P[0].e.r&&T>=P[0].s.c&&T<=P[0].e.c&&(b.F=Rt(P[0]),B=!0)}!B&&z.length>3&&(b.f=z[3])}if(g.s.r>_.r&&(g.s.r=_.r),g.s.c>T&&(g.s.c=T),g.e.r<_.r&&(g.e.r=_.r),g.e.c<T&&(g.e.c=T),u.cellDates&&w&&b.t=="n"&&Jl(wt[w.numFmtId])){var X=yo(b.v);X&&(b.t="d",b.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}q&&(q.type=="XLDAPR"&&(b.D=!0),q=void 0);break;case 1:case 12:if(!u.sheetStubs||v)break;b={t:"z",v:void 0},T=z[0].c==-1?T+1:z[0].c,u.dense?(f[S]||(f[S]=[]),f[S][T]=b):f[jr(T)+E]=b,g.s.r>_.r&&(g.s.r=_.r),g.s.c>T&&(g.s.c=T),g.e.r<_.r&&(g.e.r=_.r),g.e.c<T&&(g.e.c=T),q&&(q.type=="XLDAPR"&&(b.D=!0),q=void 0);break;case 176:D.push(z);break;case 49:q=((u.xlmeta||{}).Cell||[])[z-1];break;case 494:var Y=a["!id"][z.relId];for(Y?(z.Target=Y.Target,z.loc&&(z.Target+="#"+z.loc),z.Rel=Y):z.relId==""&&(z.Target="#"+z.loc),S=z.rfx.s.r;S<=z.rfx.e.r;++S)for(T=z.rfx.s.c;T<=z.rfx.e.c;++T)u.dense?(f[S]||(f[S]=[]),f[S][T]||(f[S][T]={t:"z",v:void 0}),f[S][T].l=z):(N=bt({c:T,r:S}),f[N]||(f[N]={t:"z",v:void 0}),f[N].l=z);break;case 426:if(!u.cellFormula)break;j.push(z),M=u.dense?f[S][T]:f[jr(T)+E],M.f=Oa(z[1],g,{r:_.r,c:T},re,u),M.F=Rt(z[0]);break;case 427:if(!u.cellFormula)break;ee[bt(z[0].s)]=z[1],M=u.dense?f[S][T]:f[jr(T)+E],M.f=Oa(z[1],g,{r:_.r,c:T},re,u);break;case 60:if(!u.cellStyles)break;for(;z.e>=z.s;)I[z.e--]={width:z.w/256,hidden:!!(z.flags&1),level:z.level},ie||(ie=!0,Fg(z.w/256)),Pi(I[z.e+1]);break;case 161:f["!autofilter"]={ref:Rt(z)};break;case 476:f["!margins"]=z;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),z.name&&(n.Sheets[r].CodeName=z.name),(z.above||z.left)&&(f["!outline"]={above:z.above,left:z.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),z.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!fe.T){if(!v||u.WTF)throw new Error("Unexpected record 0x"+De.toString(16))}}},u),delete u.supbooks,delete u["!row"],!f["!ref"]&&(g.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(f["!ref"]=Rt(h||g)),u.sheetRows&&f["!ref"]){var ae=Xt(f["!ref"]);u.sheetRows<=+ae.e.r&&(ae.e.r=u.sheetRows-1,ae.e.r>g.e.r&&(ae.e.r=g.e.r),ae.e.r<ae.s.r&&(ae.s.r=ae.e.r),ae.e.c>g.e.c&&(ae.e.c=g.e.c),ae.e.c<ae.s.c&&(ae.s.c=ae.e.c),f["!fullref"]=f["!ref"],f["!ref"]=Rt(ae))}return D.length>0&&(f["!merges"]=D),I.length>0&&(f["!cols"]=I),ne.length>0&&(f["!rows"]=ne),f}function PU(e,t,r,a,n,o,l){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=Cr(t),t.z=t.z||wt[14],t.v=la(Ar(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var f={r,c:a};switch(f.s=Hi(n.cellXfs,t,n),t.l&&o["!links"].push([bt(f),t.l]),t.c&&o["!comments"].push([bt(f),t.c]),t.t){case"s":case"str":return n.bookSST?(u=Lg(n.Strings,t.v,n.revStrings),f.t="s",f.v=u,l?Be(e,18,rU(t,f)):Be(e,7,eU(t,f))):(f.t="str",l?Be(e,17,mU(t,f)):Be(e,6,dU(t,f))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?Be(e,13,cU(t,f)):Be(e,2,oU(t,f)):l?Be(e,16,sU(t,f)):Be(e,5,nU(t,f)),!0;case"b":return f.t="b",l?Be(e,15,YB(t,f)):Be(e,4,GB(t,f)),!0;case"e":return f.t="e",l?Be(e,14,QB(t,f)):Be(e,3,KB(t,f)),!0}return l?Be(e,12,$B(t,f)):Be(e,1,VB(t,f)),!0}function LU(e,t,r,a){var n=Xt(t["!ref"]||"A1"),o,l="",u=[];Be(e,145);var f=Array.isArray(t),h=n.e.r;t["!rows"]&&(h=Math.max(n.e.r,t["!rows"].length-1));for(var g=n.s.r;g<=h;++g){l=qr(g),jB(e,t,n,g);var v=!1;if(g<=n.e.r)for(var p=n.s.c;p<=n.e.c;++p){g===n.s.r&&(u[p]=jr(p)),o=u[p]+l;var _=f?(t[g]||[])[p]:t[o];if(!_){v=!1;continue}v=PU(e,_,g,p,a,t,v)}}Be(e,146)}function BU(e,t){!t||!t["!merges"]||(Be(e,177,wU(t["!merges"].length)),t["!merges"].forEach(function(r){Be(e,176,_U(r))}),Be(e,178))}function UU(e,t){!t||!t["!cols"]||(Be(e,390),t["!cols"].forEach(function(r,a){r&&Be(e,60,AU(a,r))}),Be(e,391))}function zU(e,t){!t||!t["!ref"]||(Be(e,648),Be(e,649,RU(Xt(t["!ref"]))),Be(e,650))}function VU(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=sr(r,-1,a[1].Target.replace(/#.*$/,""),Bt.HLINK);Be(e,494,SU(a,n))}}),delete t["!links"]}function HU(e,t,r,a){if(t["!comments"].length>0){var n=sr(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Bt.VML);Be(e,551,Tg("rId"+n)),t["!legacy"]=n}}function $U(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],o=typeof n.ref=="string"?n.ref:Rt(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,u=Ja(o);u.s.r==u.e.r&&(u.e.r=Ja(t["!ref"]).e.r,o=Rt(u));for(var f=0;f<l.length;++f){var h=l[f];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==a){h.Ref="'"+r.SheetNames[a]+"'!"+o;break}}f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+o}),Be(e,161,ec(Xt(o))),Be(e,162)}}function WU(e,t,r){Be(e,133),Be(e,137,OU(t,r)),Be(e,138),Be(e,134)}function GU(e,t){t["!protect"]&&Be(e,535,FU(t["!protect"]))}function qU(e,t,r,a){var n=Ka(),o=r.SheetNames[e],l=r.Sheets[o]||{},u=o;try{r&&r.Workbook&&(u=r.Workbook.Sheets[e].CodeName||u)}catch{}var f=Xt(l["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Be(n,129),(r.vbaraw||l["!outline"])&&Be(n,147,UB(u,l["!outline"])),Be(n,148,PB(f)),WU(n,l,r.Workbook),UU(n,l),LU(n,l,e,t),GU(n,l),$U(n,l,r,e),BU(n,l),VU(n,l,a),l["!margins"]&&Be(n,476,NU(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&zU(n,l),HU(n,l,e,a),Be(n,130),n.end()}function YU(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var n=Yt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){a=o.replace(/<.*?>/g,"")}),[t,n,a]}function XU(e,t,r,a,n,o){var l=o||{"!type":"chart"};if(!e)return o;var u=0,f=0,h="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var p=YU(v);g.s.r=g.s.c=0,g.e.c=u,h=jr(u),p[0].forEach(function(_,b){l[h+qr(b)]={t:"n",v:_,z:p[1]},f=b}),g.e.r<f&&(g.e.r=f),++u}),u>0&&(l["!ref"]=Rt(g)),l}function KU(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,u=e.match(DE);return u&&Bg(u[0],o,n,r),(l=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),a["!id"][o["!rel"]]&&(o["!drawel"]=a["!id"][o["!rel"]]),o}function JU(e,t){e.l+=10;var r=Ia(e);return{name:r}}function QU(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Ks(e,function(f,h,g){switch(g){case 550:o["!rel"]=f;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),f.name&&(n.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},t),a["!id"][o["!rel"]]&&(o["!drawel"]=a["!id"][o["!rel"]]),o}var Ug=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],ZU=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],ez=[],tz=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Nw(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var o=t[n];if(a[o[0]]==null)a[o[0]]=o[1];else switch(o[2]){case"bool":typeof a[o[0]]=="string"&&(a[o[0]]=kr(a[o[0]]));break;case"int":typeof a[o[0]]=="string"&&(a[o[0]]=parseInt(a[o[0]],10));break}}}function Dw(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=kr(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function ME(e){Dw(e.WBProps,Ug),Dw(e.CalcPr,tz),Nw(e.WBView,ZU),Nw(e.Sheets,ez),$l.date1904=kr(e.WBProps.date1904)}function rz(e){return!e.Workbook||!e.Workbook.WBProps?"false":kr(e.Workbook.WBProps.date1904)?"true":"false"}var az="][*?/\\".split("");function jE(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return az.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function nz(e,t,r){e.forEach(function(a,n){jE(a);for(var o=0;o<n;++o)if(a==e[o])throw new Error("Duplicate Sheet Name: "+a);if(r){var l=t&&t[n]&&t[n].CodeName||a;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function sz(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];nz(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)rB(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var iz=/<\w+:workbook/;function oz(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",o={},l=0;if(e.replace(La,function(f,h){var g=Tt(f);switch(ws(g[0])){case"<?xml":break;case"<workbook":f.match(iz)&&(n="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=g[n];break;case"</workbook>":break;case"<fileVersion":delete g[0],r.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Ug.forEach(function(v){if(g[v[0]]!=null)switch(v[2]){case"bool":r.WBProps[v[0]]=kr(g[v[0]]);break;case"int":r.WBProps[v[0]]=parseInt(g[v[0]],10);break;default:r.WBProps[v[0]]=g[v[0]]}}),g.codeName&&(r.WBProps.CodeName=mr(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],r.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=Yt(mr(g.name)),delete g[0],r.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":o={},o.Name=mr(g.name),g.comment&&(o.Comment=g.comment),g.localSheetId&&(o.Sheet=+g.localSheetId),kr(g.hidden||"0")&&(o.Hidden=!0),l=h+f.length;break;case"</definedName>":o.Ref=Yt(mr(e.slice(l,h))),r.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete g[0],r.CalcPr=g;break;case"<calcPr/>":delete g[0],r.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return f}),Oo.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return ME(r),r}function IE(e){var t=[Yr];t[t.length]=We("workbook",null,{xmlns:Oo[0],"xmlns:r":oa.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Ug.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(a[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=We("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],o=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",o=0;o!=e.SheetNames.length&&!(!n[o]||!n[o].Hidden);++o);o==e.SheetNames.length&&(o=0),t[t.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var l={name:or(e.SheetNames[o].slice(0,31))};if(l.sheetId=""+(o+1),l["r:id"]="rId"+(o+1),n[o])switch(n[o].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=We("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(t[t.length]=We("definedName",or(u.Ref),f))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function lz(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=b1(e),r.name=Ia(e),r}function cz(e,t){return t||(t=Ne(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Tg(e.strRelID,t),ga(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function uz(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Ia(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function fz(e,t){t||(t=Ne(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),AS(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function dz(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function hz(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),o=HM(e),l=KL(e,0,r),u=Eg(e);e.l=a;var f={Name:o,Ptg:l};return n<268435455&&(f.Sheet=n),u&&(f.Comment=u),f}function mz(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],ju[16]={n:"BrtFRTArchID$",f:dz},Ks(e,function(f,h,g){switch(g){case 156:l.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(t.SID=f.Sheet),f.Ref=Oa(f.Ptg,null,null,l,t),delete t.SID,delete f.Ptg,o.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([g,f]):l[0]=[g,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(g),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(g),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!h.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},t),ME(r),r.Names=o,r.supbooks=l,r}function gz(e,t){Be(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Be(e,156,cz(n))}Be(e,144)}function xz(e,t){t||(t=Ne(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return ga("SheetJS",t),ga(M0.version,t),ga(M0.version,t),ga("7262",t),t.length>t.l?t.slice(0,t.l):t}function vz(e,t){t||(t=Ne(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function pz(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,o=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&o==-1&&(o=a);o>n||(Be(e,135),Be(e,158,vz(n)),Be(e,136))}}function yz(e,t){var r=Ka();return Be(r,131),Be(r,128,xz()),Be(r,153,fz(e.Workbook&&e.Workbook.WBProps||null)),pz(r,e),gz(r,e),Be(r,132),r.end()}function _z(e,t,r){return t.slice(-4)===".bin"?mz(e,r):oz(e,r)}function wz(e,t,r,a,n,o,l,u){return t.slice(-4)===".bin"?IU(e,a,r,n,o,l,u):hB(e,a,r,n,o,l,u)}function bz(e,t,r,a,n,o,l,u){return t.slice(-4)===".bin"?QU(e,a,r,n,o):KU(e,a,r,n,o)}function Sz(e,t,r,a,n,o,l,u){return t.slice(-4)===".bin"?T7():k7()}function Ez(e,t,r,a,n,o,l,u){return t.slice(-4)===".bin"?S7():E7()}function Tz(e,t,r,a){return t.slice(-4)===".bin"?_9(e,r,a):l9(e,r,a)}function kz(e,t,r){return xE(e,r)}function Az(e,t,r){return t.slice(-4)===".bin"?AP(e,r):EP(e,r)}function Cz(e,t,r){return t.slice(-4)===".bin"?p7(e,r):c7(e,r)}function Nz(e,t,r){return t.slice(-4)===".bin"?i7(e):n7(e)}function Dz(e,t,r,a){return r.slice(-4)===".bin"?o7(e,t,r,a):void 0}function Oz(e,t,r){return t.slice(-4)===".bin"?t7(e,t,r):a7(e,t,r)}function Rz(e,t,r){return(t.slice(-4)===".bin"?yz:IE)(e)}function Fz(e,t,r,a,n){return(t.slice(-4)===".bin"?qU:OE)(e,r,a,n)}function Mz(e,t,r){return(t.slice(-4)===".bin"?D9:mE)(e,r)}function jz(e,t,r){return(t.slice(-4)===".bin"?DP:iE)(e,r)}function Iz(e,t,r){return(t.slice(-4)===".bin"?y7:yE)(e)}function Pz(e){return(e.slice(-4)===".bin"?r7:vE)()}var PE=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,LE=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function qn(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=e.match(PE),o,l,u,f;if(n)for(f=0;f!=n.length;++f)o=n[f].match(LE),(l=o[1].indexOf(":"))===-1?a[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(l+1),a[u]=o[2].slice(1,o[2].length-1));return a}function Lz(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(PE),n,o,l,u;if(a)for(u=0;u!=a.length;++u)n=a[u].match(LE),(o=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?l="xmlns"+n[1].slice(6):l=n[1].slice(o+1),r[l]=n[2].slice(1,n[2].length-1));return r}var hu;function Bz(e,t){var r=hu[e]||Yt(e);return r==="General"?Eo(t):Pn(r,t)}function Uz(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=kr(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Ar(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Yt(t)]=n}function zz(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Js[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ku(e.v):e.w=Eo(e.v):e.w=Bz(t||"General",e.v)}catch(o){if(r.WTF)throw o}try{var a=hu[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&Jl(a)){var n=yo(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(o){if(r.WTF)throw o}}}function Vz(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=e9[a.Pattern]||a.Pattern)}e[t.ID]=t}function Hz(e,t,r,a,n,o,l,u,f,h){var g="General",v=a.StyleID,p={};h=h||{};var _=[],b=0;for(v===void 0&&u&&(v=u.StyleID),v===void 0&&l&&(v=l.StyleID);o[v]!==void 0&&(o[v].nf&&(g=o[v].nf),o[v].Interior&&_.push(o[v].Interior),!!o[v].Parent);)v=o[v].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=kr(e);break;case"String":a.t="s",a.r=q_(Yt(e)),a.v=e.indexOf("<")>-1?Yt(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Ar(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=Yt(e):a.v<60&&(a.v=a.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=RS[e],h.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=q_(t||e));break}if(zz(a,g,h),h.cellFormula!==!1)if(a.Formula){var w=Yt(a.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),a.f=Hl(w,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Hl("RC:RC",n):a.ArrayRange&&(a.F=Hl(a.ArrayRange,n),f.push([Xt(a.F),a.F]))}else for(b=0;b<f.length;++b)n.r>=f[b][0].s.r&&n.r<=f[b][0].e.r&&n.c>=f[b][0].s.c&&n.c<=f[b][0].e.c&&(a.F=f[b][1]);h.cellStyles&&(_.forEach(function(S){!p.patternType&&S.patternType&&(p.patternType=S.patternType)}),a.s=p),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function $z(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function qm(e,t){var r=t||{};Ql();var a=tu(pg(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=mr(a));var n=a.slice(0,1024).toLowerCase(),o=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var l=Cr(r);return l.type="string",ql.to_workbook(a,l)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(le){n.indexOf("<"+le)>=0&&(o=!0)}),o)return NV(a,r);hu={"General Number":"General","General Date":wt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":wt[15],"Short Date":wt[14],"Long Time":wt[19],"Medium Time":wt[18],"Short Time":wt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:wt[2],Standard:wt[4],Percent:wt[10],Scientific:wt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,f=[],h,g={},v=[],p=r.dense?[]:{},_="",b={},w={},S=qn('<Data ss:Type="String">'),T=0,N=0,k=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},M={},D={},A="",B=0,j=[],ee={},re={},U=0,I=[],ne=[],ie={},q=[],ae,be=!1,z=[],fe=[],De={},P=0,X=0,Y={Sheets:[],WBProps:{date1904:!1}},Q={};Nu.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var de="";u=Nu.exec(a);)switch(u[3]=(de=u[3]).toLowerCase()){case"data":if(de=="data"){if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break}if(f[f.length-1][1])break;u[1]==="/"?Hz(a.slice(T,u.index),A,S,f[f.length-1][0]=="comment"?ie:b,{c:N,r:k},M,q[N],w,z,r):(A="",S=qn(u[0]),T=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(ne.length>0&&(b.c=ne),(!r.sheetRows||r.sheetRows>k)&&b.v!==void 0&&(r.dense?(p[k]||(p[k]=[]),p[k][N]=b):p[jr(N)+qr(k)]=b),b.HRef&&(b.l={Target:Yt(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(P=N+(parseInt(b.MergeAcross,10)|0),X=k+(parseInt(b.MergeDown,10)|0),j.push({s:{c:N,r:k},e:{c:P,r:X}})),!r.sheetStubs)b.MergeAcross?N=P+1:++N;else if(b.MergeAcross||b.MergeDown){for(var Fe=N;Fe<=P;++Fe)for(var Te=k;Te<=X;++Te)(Fe>N||Te>k)&&(r.dense?(p[Te]||(p[Te]=[]),p[Te][Fe]={t:"z"}):p[jr(Fe)+qr(Te)]={t:"z"});N=P+1}else++N;else b=Lz(u[0]),b.Index&&(N=+b.Index-1),N<E.s.c&&(E.s.c=N),N>E.e.c&&(E.e.c=N),u[0].slice(-2)==="/>"&&++N,ne=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(k<E.s.r&&(E.s.r=k),k>E.e.r&&(E.e.r=k),u[0].slice(-2)==="/>"&&(w=qn(u[0]),w.Index&&(k=+w.Index-1)),N=0,++k):(w=qn(u[0]),w.Index&&(k=+w.Index-1),De={},(w.AutoFitHeight=="0"||w.Height)&&(De.hpx=parseInt(w.Height,10),De.hpt=Mu(De.hpx),fe[k]=De),w.Hidden=="1"&&(De.hidden=!0,fe[k]=De));break;case"worksheet":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));v.push(_),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(p["!ref"]=Rt(E),r.sheetRows&&r.sheetRows<=E.e.r&&(p["!fullref"]=p["!ref"],E.e.r=r.sheetRows-1,p["!ref"]=Rt(E))),j.length&&(p["!merges"]=j),q.length>0&&(p["!cols"]=q),fe.length>0&&(p["!rows"]=fe),g[_]=p}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},k=N=0,f.push([u[3],!1]),h=qn(u[0]),_=Yt(h.Name),p=r.dense?[]:{},j=[],z=[],fe=[],Q={name:_,Hidden:0},Y.Sheets.push(Q);break;case"table":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else{if(u[0].slice(-2)=="/>")break;f.push([u[3],!1]),q=[],be=!1}break;case"style":u[1]==="/"?Vz(M,D,r):D=qn(u[0]);break;case"numberformat":D.nf=Yt(qn(u[0]).Format||"General"),hu[D.nf]&&(D.nf=hu[D.nf]);for(var Oe=0;Oe!=392&&wt[Oe]!=D.nf;++Oe);if(Oe==392){for(Oe=57;Oe!=392;++Oe)if(wt[Oe]==null){Ws(D.nf,Oe);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(ae=qn(u[0]),ae.Hidden&&(ae.hidden=!0,delete ae.Hidden),ae.Width&&(ae.wpx=parseInt(ae.Width,10)),!be&&ae.wpx>10){be=!0,Ma=dE;for(var Re=0;Re<q.length;++Re)q[Re]&&Pi(q[Re])}be&&Pi(ae),q[ae.Index-1||q.length]=ae;for(var Je=0;Je<+ae.Span;++Je)q[q.length]=Cr(ae);break;case"namedrange":if(u[1]==="/")break;Y.Names||(Y.Names=[]);var H=Tt(u[0]),O={Name:H.Name,Ref:Hl(H.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(O.Sheet=Y.Sheets.length-1),Y.Names.push(O);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?A+=a.slice(B,u.index):B=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;D.Interior=qn(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?mj(ee,de,a.slice(U,u.index)):U=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else f.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));$z(ie),ne.push(ie)}else f.push([u[3],!1]),h=qn(u[0]),ie={a:h.Author};break;case"autofilter":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var Ae=qn(u[0]);p["!autofilter"]={ref:Hl(Ae.Range).replace(/\$/g,"")},f.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"null":break;default:if(f.length==0&&u[3]=="document"||f.length==0&&u[3]=="uof")return jw(a,r);var Pe=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Pe=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Pe=!1}break;case"excelworkbook":switch(u[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Pe=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:Pe=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(a.slice(U,u.index)){case"SheetHidden":Q.Hidden=1;break;case"SheetVeryHidden":Q.Hidden=2;break}else U=u.index+u[0].length;break;case"header":p["!margins"]||So(p["!margins"]={},"xlml"),isNaN(+Tt(u[0]).Margin)||(p["!margins"].header=+Tt(u[0]).Margin);break;case"footer":p["!margins"]||So(p["!margins"]={},"xlml"),isNaN(+Tt(u[0]).Margin)||(p["!margins"].footer=+Tt(u[0]).Margin);break;case"pagemargins":var Se=Tt(u[0]);p["!margins"]||So(p["!margins"]={},"xlml"),isNaN(+Se.Top)||(p["!margins"].top=+Se.Top),isNaN(+Se.Left)||(p["!margins"].left=+Se.Left),isNaN(+Se.Right)||(p["!margins"].right=+Se.Right),isNaN(+Se.Bottom)||(p["!margins"].bottom=+Se.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Pe=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Pe=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Pe=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Pe=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Pe=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Pe=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Pe=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Pe=!1}break;case"smarttags":break;default:Pe=!1;break}if(Pe||u[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?Uz(re,de,I,a.slice(U,u.index)):(I=u,U=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+f.join("|")}var Z={};return!r.bookSheets&&!r.bookProps&&(Z.Sheets=g),Z.SheetNames=v,Z.Workbook=Y,Z.SSF=Cr(wt),Z.Props=ee,Z.Custprops=re,Z}function N1(e,t){switch(Vg(t=t||{}),t.type||"base64"){case"base64":return qm(vn(e),t);case"binary":case"buffer":case"file":return qm(e,t);case"array":return qm(zi(e),t)}}function Wz(e,t){var r=[];return e.Props&&r.push(gj(e.Props,t)),e.Custprops&&r.push(xj(e.Props,e.Custprops)),r.join("")}function Gz(){return""}function qz(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var o=[];o.push(We("NumberFormat",null,{"ss:Format":or(wt[a.numFmtId])}));var l={"ss:ID":"s"+(21+n)};r.push(We("Style",o.join(""),l))}),We("Styles",r.join(""))}function BE(e){return We("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Ig(e.Ref,{r:0,c:0})})}function Yz(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(BE(n)))}return We("Names",r.join(""))}function Xz(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,o=[],l=0;l<n.length;++l){var u=n[l];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||o.push(BE(u)))}return o.join("")}function Kz(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(We("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(We("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(We("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(We("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<r&&!(a.Workbook.Sheets[o]&&!a.Workbook.Sheets[o].Hidden);++o);o==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(ka("ProtectContents","True")),e["!protect"].objects&&n.push(ka("ProtectObjects","True")),e["!protect"].scenarios&&n.push(ka("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(ka("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(ka("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&n.push("<"+l[1]+"/>")})),n.length==0?"":We("WorksheetOptions",n.join(""),{xmlns:un.x})}function Jz(e){return e.map(function(t){var r=pM(t.t||""),a=We("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return We("Comment",a,{"ss:Author":t.a})}).join("")}function Qz(e,t,r,a,n,o,l){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+or(Ig(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var f=Ir(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==l.r?"":"["+(f.r-l.r)+"]")+"C"+(f.c==l.c?"":"["+(f.c-l.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=or(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=or(e.l.Tooltip))),r["!merges"])for(var h=r["!merges"],g=0;g!=h.length;++g)h[g].s.c!=l.c||h[g].s.r!=l.r||(h[g].e.c>h[g].s.c&&(u["ss:MergeAcross"]=h[g].e.c-h[g].s.c),h[g].e.r>h[g].s.r&&(u["ss:MergeDown"]=h[g].e.r-h[g].s.r));var v="",p="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":v="Number",p=String(e.v);break;case"b":v="Boolean",p=e.v?"1":"0";break;case"e":v="Error",p=Js[e.v];break;case"d":v="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||wt[14]);break;case"s":v="String",p=vM(e.v||"");break}var _=Hi(a.cellXfs,e,a);u["ss:StyleID"]="s"+(21+_),u["ss:Index"]=l.c+1;var b=e.v!=null?p:"",w=e.t=="z"?"":'<Data ss:Type="'+v+'">'+b+"</Data>";return(e.c||[]).length>0&&(w+=Jz(e.c)),We("Cell",w,u)}function Zz(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Yl(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function eV(e,t,r,a){if(!e["!ref"])return"";var n=Xt(e["!ref"]),o=e["!merges"]||[],l=0,u=[];e["!cols"]&&e["!cols"].forEach(function(S,T){Pi(S);var N=!!S.width,k=hd(T,S),E={"ss:Index":T+1};N&&(E["ss:Width"]=Ru(k.width)),S.hidden&&(E["ss:Hidden"]="1"),u.push(We("Column",null,E))});for(var f=Array.isArray(e),h=n.s.r;h<=n.e.r;++h){for(var g=[Zz(h,(e["!rows"]||[])[h])],v=n.s.c;v<=n.e.c;++v){var p=!1;for(l=0;l!=o.length;++l)if(!(o[l].s.c>v)&&!(o[l].s.r>h)&&!(o[l].e.c<v)&&!(o[l].e.r<h)){(o[l].s.c!=v||o[l].s.r!=h)&&(p=!0);break}if(!p){var _={r:h,c:v},b=bt(_),w=f?(e[h]||[])[v]:e[b];g.push(Qz(w,b,e,t,r,a,_))}}g.push("</Row>"),g.length>2&&u.push(g.join(""))}return u.join("")}function tV(e,t,r){var a=[],n=r.SheetNames[e],o=r.Sheets[n],l=o?Xz(o,t,e,r):"";return l.length>0&&a.push("<Names>"+l+"</Names>"),l=o?eV(o,t,e,r):"",l.length>0&&a.push("<Table>"+l+"</Table>"),a.push(Kz(o,t,e,r)),a.join("")}function rV(e,t){t||(t={}),e.SSF||(e.SSF=Cr(wt)),e.SSF&&(Ql(),id(e.SSF),t.revssf=ld(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Hi(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Wz(e,t)),r.push(Gz()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(We("Worksheet",tV(a,t,e),{"ss:Name":or(e.SheetNames[a])}));return r[2]=qz(e,t),r[3]=Yz(e),Yr+We("Workbook",r.join(""),{xmlns:un.ss,"xmlns:o":un.o,"xmlns:x":un.x,"xmlns:ss":un.ss,"xmlns:dt":un.dt,"xmlns:html":un.html})}function aV(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=YM(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=XM(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var nV=[60,1084,2066,2165,2175];function sV(e,t,r,a,n){var o=a,l=[],u=r.slice(r.l,r.l+o);if(n&&n.enc&&n.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(u)}l.push(u),r.l+=o;for(var f=Hs(r,r.l),h=D1[f],g=0;h!=null&&nV.indexOf(f)>-1;)o=Hs(r,r.l+2),g=r.l+4,f==2066?g+=4:(f==2165||f==2175)&&(g+=12),u=r.slice(g,r.l+4+o),l.push(u),r.l+=4+o,h=D1[f=Hs(r,r.l)];var v=ma(l);Sa(v,0);var p=0;v.lens=[];for(var _=0;_<l.length;++_)v.lens.push(p),p+=l[_].length;if(v.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+v.length+" < "+a;return t.f(v,v.length,n)}function us(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=wt[a])}catch(o){if(t.WTF)throw o}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Js[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ku(e.v):e.w=Eo(e.v):e.w=Pn(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(o){if(t.WTF)throw o}if(t.cellDates&&a&&e.t=="n"&&Jl(wt[a]||String(a))){var n=yo(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function T0(e,t,r){return{v:e,ixfe:t,t:r}}function iV(e,t){var r={opts:{}},a={},n=t.dense?[]:{},o={},l={},u=null,f=[],h="",g={},v,p="",_,b,w,S,T={},N=[],k,E,M=[],D=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},B={},j=function(ye){return ye<8?_o[ye]:ye<64&&D[ye-8]||_o[ye]},ee=function(ye,xe,ze){var xt=xe.XF.data;if(!(!xt||!xt.patternType||!ze||!ze.cellStyles)){xe.s={},xe.s.patternType=xt.patternType;var qt;(qt=Ou(j(xt.icvFore)))&&(xe.s.fgColor={rgb:qt}),(qt=Ou(j(xt.icvBack)))&&(xe.s.bgColor={rgb:qt})}},re=function(ye,xe,ze){if(!(De>1)&&!(ze.sheetRows&&ye.r>=ze.sheetRows)){if(ze.cellStyles&&xe.XF&&xe.XF.data&&ee(ye,xe,ze),delete xe.ixfe,delete xe.XF,v=ye,p=bt(ye),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),ye.r<l.s.r&&(l.s.r=ye.r),ye.c<l.s.c&&(l.s.c=ye.c),ye.r+1>l.e.r&&(l.e.r=ye.r+1),ye.c+1>l.e.c&&(l.e.c=ye.c+1),ze.cellFormula&&xe.f){for(var xt=0;xt<N.length;++xt)if(!(N[xt][0].s.c>ye.c||N[xt][0].s.r>ye.r)&&!(N[xt][0].e.c<ye.c||N[xt][0].e.r<ye.r)){xe.F=Rt(N[xt][0]),(N[xt][0].s.c!=ye.c||N[xt][0].s.r!=ye.r)&&delete xe.f,xe.f&&(xe.f=""+Oa(N[xt][1],l,ye,z,U));break}}ze.dense?(n[ye.r]||(n[ye.r]=[]),n[ye.r][ye.c]=xe):n[p]=xe}},U={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:N,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(U.password=t.password);var I,ne=[],ie=[],q=[],ae=[],be=!1,z=[];z.SheetNames=U.snames,z.sharedf=U.sharedf,z.arrayf=U.arrayf,z.names=[],z.XTI=[];var fe=0,De=0,P=0,X=[],Y=[],Q;U.codepage=1200,es(1200);for(var de=!1;e.l<e.length-1;){var Fe=e.l,Te=e.read_shift(2);if(Te===0&&fe===10)break;var Oe=e.l===e.length?0:e.read_shift(2),Re=D1[Te];if(Re&&Re.f){if(t.bookSheets&&fe===133&&Te!==133)break;if(fe=Te,Re.r===2||Re.r==12){var Je=e.read_shift(2);if(Oe-=2,!U.enc&&Je!==Te&&((Je&255)<<8|Je>>8)!==Te)throw new Error("rt mismatch: "+Je+"!="+Te);Re.r==12&&(e.l+=10,Oe-=10)}var H={};if(Te===10?H=Re.f(e,Oe,U):H=sV(Te,Re,e,Oe,U),De==0&&[9,521,1033,2057].indexOf(fe)===-1)continue;switch(Te){case 34:r.opts.Date1904=A.WBProps.date1904=H;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(U.enc||(e.l=0),U.enc=H,!t.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:U.lastuser=H;break;case 66:var O=Number(H);switch(O){case 21010:O=1200;break;case 32768:O=1e4;break;case 32769:O=1252;break}es(U.codepage=O),de=!0;break;case 317:U.rrtabid=H;break;case 25:U.winlocked=H;break;case 439:r.opts.RefreshAll=H;break;case 12:r.opts.CalcCount=H;break;case 16:r.opts.CalcDelta=H;break;case 17:r.opts.CalcIter=H;break;case 13:r.opts.CalcMode=H;break;case 14:r.opts.CalcPrecision=H;break;case 95:r.opts.CalcSaveRecalc=H;break;case 15:U.CalcRefMode=H;break;case 2211:r.opts.FullCalc=H;break;case 129:H.fDialog&&(n["!type"]="dialog"),H.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),H.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:M.push(H);break;case 430:z.push([H]),z[z.length-1].XTI=[];break;case 35:case 547:z[z.length-1].push(H);break;case 24:case 536:Q={Name:H.Name,Ref:Oa(H.rgce,l,null,z,U)},H.itab>0&&(Q.Sheet=H.itab-1),z.names.push(Q),z[0]||(z[0]=[],z[0].XTI=[]),z[z.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(Y[H.itab-1]={ref:Rt(H.rgce[0][0][1][2])});break;case 22:U.ExternCount=H;break;case 23:z.length==0&&(z[0]=[],z[0].XTI=[]),z[z.length-1].XTI=z[z.length-1].XTI.concat(H),z.XTI=z.XTI.concat(H);break;case 2196:if(U.biff<8)break;Q!=null&&(Q.Comment=H[1]);break;case 18:n["!protect"]=H;break;case 19:H!==0&&U.WTF&&console.error("Password verifier: "+H);break;case 133:o[H.pos]=H,U.snames.push(H.name);break;case 10:{if(--De)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,n["!ref"]=Rt(l),t.sheetRows&&t.sheetRows<=l.e.r){var Ae=l.e.r;l.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Rt(l),l.e.r=Ae}l.e.r++,l.e.c++}ne.length>0&&(n["!merges"]=ne),ie.length>0&&(n["!objects"]=ie),q.length>0&&(n["!cols"]=q),ae.length>0&&(n["!rows"]=ae),A.Sheets.push(B)}h===""?g=n:a[h]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(U.biff===8&&(U.biff={9:2,521:3,1033:4}[Te]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),U.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(U.biff=5,de=!0,es(U.codepage=28591)),U.biff==8&&H.BIFFVer==0&&H.dt==16&&(U.biff=2),De++)break;if(n=t.dense?[]:{},U.biff<8&&!de&&(de=!0,es(U.codepage=t.codepage||1252)),U.biff<5||H.BIFFVer==0&&H.dt==4096){h===""&&(h="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Pe={pos:e.l-Oe,name:h};o[Pe.pos]=Pe,U.snames.push(h)}else h=(o[Fe]||{name:""}).name;H.dt==32&&(n["!type"]="chart"),H.dt==64&&(n["!type"]="macro"),ne=[],ie=[],U.arrayf=N=[],q=[],ae=[],be=!1,B={Hidden:(o[Fe]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[H.r]||[])[H.c]:n[bt({c:H.c,r:H.r})])&&++H.c,k={ixfe:H.ixfe,XF:M[H.ixfe]||{},v:H.val,t:"n"},P>0&&(k.z=X[k.ixfe>>8&63]),us(k,t,r.opts.Date1904),re({c:H.c,r:H.r},k,t);break;case 5:case 517:k={ixfe:H.ixfe,XF:M[H.ixfe],v:H.val,t:H.t},P>0&&(k.z=X[k.ixfe>>8&63]),us(k,t,r.opts.Date1904),re({c:H.c,r:H.r},k,t);break;case 638:k={ixfe:H.ixfe,XF:M[H.ixfe],v:H.rknum,t:"n"},P>0&&(k.z=X[k.ixfe>>8&63]),us(k,t,r.opts.Date1904),re({c:H.c,r:H.r},k,t);break;case 189:for(var Se=H.c;Se<=H.C;++Se){var Z=H.rkrec[Se-H.c][0];k={ixfe:Z,XF:M[Z],v:H.rkrec[Se-H.c][1],t:"n"},P>0&&(k.z=X[k.ixfe>>8&63]),us(k,t,r.opts.Date1904),re({c:Se,r:H.r},k,t)}break;case 6:case 518:case 1030:{if(H.val=="String"){u=H;break}if(k=T0(H.val,H.cell.ixfe,H.tt),k.XF=M[k.ixfe],t.cellFormula){var le=H.formula;if(le&&le[0]&&le[0][0]&&le[0][0][0]=="PtgExp"){var Ge=le[0][0][1][0],kt=le[0][0][1][1],nt=bt({r:Ge,c:kt});T[nt]?k.f=""+Oa(H.formula,l,H.cell,z,U):k.F=((t.dense?(n[Ge]||[])[kt]:n[nt])||{}).F}else k.f=""+Oa(H.formula,l,H.cell,z,U)}P>0&&(k.z=X[k.ixfe>>8&63]),us(k,t,r.opts.Date1904),re(H.cell,k,t),u=H}break;case 7:case 519:if(u)u.val=H,k=T0(H,u.cell.ixfe,"s"),k.XF=M[k.ixfe],t.cellFormula&&(k.f=""+Oa(u.formula,l,u.cell,z,U)),P>0&&(k.z=X[k.ixfe>>8&63]),us(k,t,r.opts.Date1904),re(u.cell,k,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{N.push(H);var st=bt(H[0].s);if(_=t.dense?(n[H[0].s.r]||[])[H[0].s.c]:n[st],t.cellFormula&&_){if(!u||!st||!_)break;_.f=""+Oa(H[1],l,H[0],z,U),_.F=Rt(H[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!u)break;T[bt(u.cell)]=H[0],_=t.dense?(n[u.cell.r]||[])[u.cell.c]:n[bt(u.cell)],(_||{}).f=""+Oa(H[0],l,v,z,U)}}break;case 253:k=T0(f[H.isst].t,H.ixfe,"s"),f[H.isst].h&&(k.h=f[H.isst].h),k.XF=M[k.ixfe],P>0&&(k.z=X[k.ixfe>>8&63]),us(k,t,r.opts.Date1904),re({c:H.c,r:H.r},k,t);break;case 513:t.sheetStubs&&(k={ixfe:H.ixfe,XF:M[H.ixfe],t:"z"},P>0&&(k.z=X[k.ixfe>>8&63]),us(k,t,r.opts.Date1904),re({c:H.c,r:H.r},k,t));break;case 190:if(t.sheetStubs)for(var Ze=H.c;Ze<=H.C;++Ze){var Ee=H.ixfe[Ze-H.c];k={ixfe:Ee,XF:M[Ee],t:"z"},P>0&&(k.z=X[k.ixfe>>8&63]),us(k,t,r.opts.Date1904),re({c:Ze,r:H.r},k,t)}break;case 214:case 516:case 4:k=T0(H.val,H.ixfe,"s"),k.XF=M[k.ixfe],P>0&&(k.z=X[k.ixfe>>8&63]),us(k,t,r.opts.Date1904),re({c:H.c,r:H.r},k,t);break;case 0:case 512:De===1&&(l=H);break;case 252:f=H;break;case 1054:if(U.biff==4){X[P++]=H[1];for(var Xe=0;Xe<P+163&&wt[Xe]!=H[1];++Xe);Xe>=163&&Ws(H[1],P+163)}else Ws(H[1],H[0]);break;case 30:{X[P++]=H;for(var Qe=0;Qe<P+163&&wt[Qe]!=H;++Qe);Qe>=163&&Ws(H,P+163)}break;case 229:ne=ne.concat(H);break;case 93:ie[H.cmo[0]]=U.lastobj=H;break;case 438:U.lastobj.TxO=H;break;case 127:U.lastobj.ImData=H;break;case 440:for(S=H[0].s.r;S<=H[0].e.r;++S)for(w=H[0].s.c;w<=H[0].e.c;++w)_=t.dense?(n[S]||[])[w]:n[bt({c:w,r:S})],_&&(_.l=H[1]);break;case 2048:for(S=H[0].s.r;S<=H[0].e.r;++S)for(w=H[0].s.c;w<=H[0].e.c;++w)_=t.dense?(n[S]||[])[w]:n[bt({c:w,r:S})],_&&_.l&&(_.l.Tooltip=H[1]);break;case 28:{if(U.biff<=5&&U.biff>=2)break;_=t.dense?(n[H[0].r]||[])[H[0].c]:n[bt(H[0])];var et=ie[H[2]];_||(t.dense?(n[H[0].r]||(n[H[0].r]=[]),_=n[H[0].r][H[0].c]={t:"z"}):_=n[bt(H[0])]={t:"z"},l.e.r=Math.max(l.e.r,H[0].r),l.s.r=Math.min(l.s.r,H[0].r),l.e.c=Math.max(l.e.c,H[0].c),l.s.c=Math.min(l.s.c,H[0].c)),_.c||(_.c=[]),b={a:H[1],t:et.TxO.t},_.c.push(b)}break;case 2173:q9(M[H.ixfe],H.ext);break;case 125:{if(!U.cellStyles)break;for(;H.e>=H.s;)q[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},be||(be=!0,Fg(H.w/256)),Pi(q[H.e+1])}break;case 520:{var rt={};H.level!=null&&(ae[H.r]=rt,rt.level=H.level),H.hidden&&(ae[H.r]=rt,rt.hidden=!0),H.hpt&&(ae[H.r]=rt,rt.hpt=H.hpt,rt.hpx=Yl(H.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||So(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Te]]=H;break;case 161:n["!margins"]||So(n["!margins"]={}),n["!margins"].header=H.header,n["!margins"].footer=H.footer;break;case 574:H.RTL&&(A.Views[0].RTL=!0);break;case 146:D=H;break;case 2198:I=H;break;case 140:E=H;break;case 442:h?B.CodeName=H||B.name:A.WBProps.CodeName=H||"ThisWorkbook";break}}else Re||console.error("Missing Info for XLS Record 0x"+Te.toString(16)),e.l+=Oe}return r.SheetNames=Vr(o).sort(function(ke,ye){return Number(ke)-Number(ye)}).map(function(ke){return o[ke].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&g["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=g)):r.Preamble=g,r.Sheets&&Y.forEach(function(ke,ye){r.Sheets[r.SheetNames[ye]]["!autofilter"]=ke}),r.Strings=f,r.SSF=Cr(wt),U.enc&&(r.Encryption=U.enc),I&&(r.Themes=I),r.Metadata={},E!==void 0&&(r.Metadata.Country=E),z.names.length>0&&(A.Names=z.names),r.Workbook=A,r}var mu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function oV(e,t,r){var a=mt.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=fw(a,S1,mu.DSI);for(var o in n)t[o]=n[o]}catch(h){if(r.WTF)throw h}var l=mt.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var u=fw(l,E1,mu.SI);for(var f in u)t[f]==null&&(t[f]=u[f])}catch(h){if(r.WTF)throw h}t.HeadingPairs&&t.TitlesOfParts&&(LS(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function lV(e,t){var r=[],a=[],n=[],o=0,l,u=z_(S1,"n"),f=z_(E1,"n");if(e.Props)for(l=Vr(e.Props),o=0;o<l.length;++o)(Object.prototype.hasOwnProperty.call(u,l[o])?r:Object.prototype.hasOwnProperty.call(f,l[o])?a:n).push([l[o],e.Props[l[o]]]);if(e.Custprops)for(l=Vr(e.Custprops),o=0;o<l.length;++o)Object.prototype.hasOwnProperty.call(e.Props||{},l[o])||(Object.prototype.hasOwnProperty.call(u,l[o])?r:Object.prototype.hasOwnProperty.call(f,l[o])?a:n).push([l[o],e.Custprops[l[o]]]);var h=[];for(o=0;o<n.length;++o)WS.indexOf(n[o][0])>-1||PS.indexOf(n[o][0])>-1||n[o][1]!=null&&h.push(n[o]);a.length&&mt.utils.cfb_add(t,"/SummaryInformation",dw(a,mu.SI,f,E1)),(r.length||h.length)&&mt.utils.cfb_add(t,"/DocumentSummaryInformation",dw(r,mu.DSI,u,S1,h.length?h:null,mu.UDI))}function UE(e,t){t||(t={}),Vg(t),cg(),t.codepage&&lg(t.codepage);var r,a;if(e.FullPaths){if(mt.find(e,"/encryption"))throw new Error("File is password-protected");r=mt.find(e,"!CompObj"),a=mt.find(e,"/Workbook")||mt.find(e,"/Book")}else{switch(t.type){case"base64":e=mn(vn(e));break;case"binary":e=mn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Sa(e,0),a={content:e}}var n,o;if(r&&aV(r),t.bookProps&&!t.bookSheets)n={};else{var l=Pt?"buffer":"array";if(a&&a.content)n=iV(a.content,t);else if((o=mt.find(e,"PerfectOffice_MAIN"))&&o.content)n=bo.to_workbook(o.content,(t.type=l,t));else if((o=mt.find(e,"NativeContent_MAIN"))&&o.content)n=bo.to_workbook(o.content,(t.type=l,t));else throw(o=mt.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&mt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=w7(e))}var u={};return e.FullPaths&&oV(e,u,t),n.Props=n.Custprops=u,t.bookFiles&&(n.cfb=e),n}function cV(e,t){var r=t||{},a=mt.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return mt.utils.cfb_add(a,n,zE(e,r)),r.biff==8&&(e.Props||e.Custprops)&&lV(e,a),r.biff==8&&e.vbaraw&&b7(a,mt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var ju={0:{f:FB},1:{f:zB},2:{f:iU},3:{f:XB},4:{f:WB},5:{f:aU},6:{f:fU},7:{f:ZB},8:{f:pU},9:{f:vU},10:{f:gU},11:{f:xU},12:{f:HB},13:{f:lU},14:{f:JB},15:{f:qB},16:{f:RE},17:{f:hU},18:{f:tU},19:{f:Sg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:hz},40:{},42:{},43:{f:f9},44:{f:c9},45:{f:m9},46:{f:x9},47:{f:g9},48:{},49:{f:IM},50:{},51:{f:K9},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rE},62:{f:uU},63:{f:s7},64:{f:MU},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Pa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:DU},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:BB},148:{f:IB,p:16},151:{f:EU},152:{},153:{f:uz},154:{},155:{},156:{f:lz},157:{},158:{},159:{T:1,f:kP},160:{T:-1},161:{T:1,f:jo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:yU},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Y9},336:{T:-1},337:{f:Z9,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:b1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:tE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:TU},427:{f:kU},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:CU},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:LB},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:bU},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:b1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:x7},633:{T:1},634:{T:-1},635:{T:1,f:m7},636:{T:-1},637:{f:UM},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:JU},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:jU},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},D1={6:{f:Wm},10:{f:Ti},12:{f:ta},13:{f:ta},14:{f:Wr},15:{f:Wr},16:{f:ja},17:{f:Wr},18:{f:Wr},19:{f:ta},20:{f:pw},21:{f:pw},23:{f:tE},24:{f:_w},25:{f:Wr},26:{},27:{},28:{f:jI},29:{},34:{f:Wr},35:{f:yw},38:{f:ja},39:{f:ja},40:{f:ja},41:{f:ja},42:{f:Wr},43:{f:Wr},47:{f:qP},49:{f:lI},51:{f:ta},60:{},61:{f:aI},64:{f:Wr},65:{f:oI},66:{f:ta},77:{},80:{},81:{},82:{},85:{f:ta},89:{},90:{},91:{},92:{f:Gj},93:{f:LI},94:{},95:{f:Wr},96:{},97:{},99:{f:Wr},125:{f:rE},128:{f:SI},129:{f:Yj},130:{f:ta},131:{f:Wr},132:{f:Wr},133:{f:Xj},134:{},140:{f:GI},141:{f:ta},144:{},146:{f:XI},151:{},152:{},153:{},154:{},155:{},156:{f:ta},157:{},158:{},160:{f:rP},161:{f:QI},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:yI},190:{f:_I},193:{f:Ti},197:{},198:{},199:{},200:{},201:{},202:{f:Wr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ta},220:{},221:{f:Wr},222:{},224:{f:bI},225:{f:Wj},226:{f:Ti},227:{},229:{f:II},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Jj},253:{f:uI},255:{f:Zj},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:GS},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Wr},353:{f:Ti},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:CI},431:{f:Wr},432:{},433:{},434:{},437:{},438:{f:zI},439:{f:Wr},440:{f:VI},441:{},442:{f:Yu},443:{},444:{f:ta},445:{},446:{},448:{f:Ti},449:{f:rI,r:2},450:{f:Ti},512:{f:gw},513:{f:tP},515:{f:kI},516:{f:dI},517:{f:vw},519:{f:aP},520:{f:eI},523:{},545:{f:ww},549:{f:mw},566:{},574:{f:sI},638:{f:pI},659:{},1048:{},1054:{f:mI},1084:{},1212:{f:RI},2048:{f:$I},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:b0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ti},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:KI,r:12},2173:{f:G9,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Wr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:OI,r:12},2197:{},2198:{f:U9,r:12},2199:{},2200:{},2201:{},2202:{f:FI,r:12},2203:{f:Ti},2204:{},2205:{},2206:{},2207:{},2211:{f:tI},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ta},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:ZI},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:YI},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:gw},1:{},2:{f:lP},3:{f:iP},4:{f:sP},5:{f:vw},7:{f:uP},8:{},9:{f:b0},11:{},22:{f:ta},30:{f:xI},31:{},32:{},33:{f:ww},36:{},37:{f:mw},50:{f:fP},62:{},52:{},67:{},68:{f:ta},69:{},86:{},126:{},127:{f:nP},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:dP},223:{},234:{},354:{},421:{},518:{f:Wm},521:{f:b0},536:{f:_w},547:{f:yw},561:{},579:{},1030:{f:Wm},1033:{f:b0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function qe(e,t,r,a){var n=t;if(!isNaN(n)){var o=a||(r||[]).length||0,l=e.next(4);l.write_shift(2,n),l.write_shift(2,o),o>0&&_g(r)&&e.push(r)}}function uV(e,t,r,a){var n=(r||[]).length||0;if(n<=8224)return qe(e,t,r,n);var o=t;if(!isNaN(o)){for(var l=r.parts||[],u=0,f=0,h=0;h+(l[u]||8224)<=8224;)h+=l[u]||8224,u++;var g=e.next(4);for(g.write_shift(2,o),g.write_shift(2,h),e.push(r.slice(f,f+h)),f+=h;f<n;){for(g=e.next(4),g.write_shift(2,60),h=0;h+(l[u]||8224)<=8224;)h+=l[u]||8224,u++;g.write_shift(2,h),e.push(r.slice(f,f+h)),f+=h}}}function Qu(e,t,r){return e||(e=Ne(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function fV(e,t,r,a){var n=Ne(9);return Qu(n,e,t),qS(r,a||"b",n),n}function dV(e,t,r){var a=Ne(8+2*r.length);return Qu(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function hV(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?la(Ar(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?qe(e,2,cP(r,a,n)):qe(e,3,oP(r,a,n));return;case"b":case"e":qe(e,5,fV(r,a,t.v,t.t));return;case"s":case"str":qe(e,4,dV(r,a,(t.v||"").slice(0,255)));return}qe(e,1,Qu(null,r,a))}function mV(e,t,r,a){var n=Array.isArray(t),o=Xt(t["!ref"]||"A1"),l,u="",f=[];if(o.e.c>255||o.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),l=Rt(o)}for(var h=o.s.r;h<=o.e.r;++h){u=qr(h);for(var g=o.s.c;g<=o.e.c;++g){h===o.s.r&&(f[g]=jr(g)),l=f[g]+u;var v=n?(t[h]||[])[g]:t[l];v&&hV(e,v,h,g)}}}function gV(e,t){for(var r=t||{},a=Ka(),n=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==r.sheet&&(n=o);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return qe(a,r.biff==4?1033:r.biff==3?521:9,Dg(e,16,r)),mV(a,e.Sheets[e.SheetNames[n]],n,r),qe(a,10),a.end()}function xV(e,t,r){qe(e,49,cI({sz:12,name:"Arial"},r))}function vV(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&qe(e,1054,gI(n,t[n],r))})}function pV(e,t){var r=Ne(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),qe(e,2151,r),r=Ne(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),QS(Xt(t["!ref"]||"A1"),r),r.write_shift(4,4),qe(e,2152,r)}function yV(e,t){for(var r=0;r<16;++r)qe(e,224,xw({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){qe(e,224,xw(a,0,t))})}function _V(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];qe(e,440,HI(a)),a[1].Tooltip&&qe(e,2048,WI(a))}delete t["!links"]}function wV(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&qe(e,125,JI(hd(n,a),n))})}}function bV(e,t,r,a,n){var o=16+Hi(n.cellXfs,t,n);if(t.v==null&&!t.bf){qe(e,513,Co(r,a,o));return}if(t.bf)qe(e,6,YL(t,r,a,n,o));else switch(t.t){case"d":case"n":var l=t.t=="d"?la(Ar(t.v)):t.v;qe(e,515,AI(r,a,l,o));break;case"b":case"e":qe(e,517,TI(r,a,t.v,o,n,t.t));break;case"s":case"str":if(n.bookSST){var u=Lg(n.Strings,t.v,n.revStrings);qe(e,253,fI(r,a,u,o))}else qe(e,516,hI(r,a,(t.v||"").slice(0,255),o,n));break;default:qe(e,513,Co(r,a,o))}}function SV(e,t,r){var a=Ka(),n=r.SheetNames[e],o=r.Sheets[n]||{},l=(r||{}).Workbook||{},u=(l.Sheets||[])[e]||{},f=Array.isArray(o),h=t.biff==8,g,v="",p=[],_=Xt(o["!ref"]||"A1"),b=h?65536:16384;if(_.e.c>255||_.e.r>=b){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,b-1)}qe(a,2057,Dg(r,16,t)),qe(a,13,Mn(1)),qe(a,12,Mn(100)),qe(a,15,za(!0)),qe(a,17,za(!1)),qe(a,16,ko(.001)),qe(a,95,za(!0)),qe(a,42,za(!1)),qe(a,43,za(!1)),qe(a,130,Mn(1)),qe(a,128,EI()),qe(a,131,za(!1)),qe(a,132,za(!1)),h&&wV(a,o["!cols"]),qe(a,512,vI(_,t)),h&&(o["!links"]=[]);for(var w=_.s.r;w<=_.e.r;++w){v=qr(w);for(var S=_.s.c;S<=_.e.c;++S){w===_.s.r&&(p[S]=jr(S)),g=p[S]+v;var T=f?(o[w]||[])[S]:o[g];T&&(bV(a,T,w,S,t),h&&T.l&&o["!links"].push([g,T.l]))}}var N=u.CodeName||u.name||n;return h&&qe(a,574,iI((l.Views||[])[0])),h&&(o["!merges"]||[]).length&&qe(a,229,PI(o["!merges"])),h&&_V(a,o),qe(a,442,YS(N)),h&&pV(a,o),qe(a,10),a.end()}function EV(e,t,r){var a=Ka(),n=(e||{}).Workbook||{},o=n.Sheets||[],l=n.WBProps||{},u=r.biff==8,f=r.biff==5;if(qe(a,2057,Dg(e,5,r)),r.bookType=="xla"&&qe(a,135),qe(a,225,u?Mn(1200):null),qe(a,193,Tj(2)),f&&qe(a,191),f&&qe(a,192),qe(a,226),qe(a,92,qj("SheetJS",r)),qe(a,66,Mn(u?1200:1252)),u&&qe(a,353,Mn(0)),u&&qe(a,448),qe(a,317,eP(e.SheetNames.length)),u&&e.vbaraw&&qe(a,211),u&&e.vbaraw){var h=l.CodeName||"ThisWorkbook";qe(a,442,YS(h))}qe(a,156,Mn(17)),qe(a,25,za(!1)),qe(a,18,za(!1)),qe(a,19,Mn(0)),u&&qe(a,431,za(!1)),u&&qe(a,444,Mn(0)),qe(a,61,nI()),qe(a,64,za(!1)),qe(a,141,Mn(0)),qe(a,34,za(rz(e)=="true")),qe(a,14,za(!0)),u&&qe(a,439,za(!1)),qe(a,218,Mn(0)),xV(a,e,r),vV(a,e.SSF,r),yV(a,r),u&&qe(a,352,za(!1));var g=a.end(),v=Ka();u&&qe(v,140,qI()),u&&r.Strings&&uV(v,252,Qj(r.Strings)),qe(v,10);var p=v.end(),_=Ka(),b=0,w=0;for(w=0;w<e.SheetNames.length;++w)b+=(u?12:11)+(u?2:1)*e.SheetNames[w].length;var S=g.length+b+p.length;for(w=0;w<e.SheetNames.length;++w){var T=o[w]||{};qe(_,133,Kj({pos:S,hs:T.Hidden||0,dt:0,name:e.SheetNames[w]},r)),S+=t[w].length}var N=_.end();if(b!=N.length)throw new Error("BS8 "+b+" != "+N.length);var k=[];return g.length&&k.push(g),N.length&&k.push(N),p.length&&k.push(p),ma(k)}function TV(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=Cr(wt)),e&&e.SSF&&(Ql(),id(e.SSF),r.revssf=ld(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Hg(r),r.cellXfs=[],Hi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=SV(n,r,e);return a.unshift(EV(e,a,r)),ma(a)}function zE(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=Ja(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var o=t||{};switch(o.biff||2){case 8:case 5:return TV(e,t);case 4:case 3:case 2:return gV(e,t)}throw new Error("invalid type "+o.bookType+" for BIFF")}function Ow(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),l=n.index,u=o&&o.index||e.length,f=cM(e.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,g=0,v=0,p=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(l=0;l<f.length;++l){var w=f[l].trim(),S=w.slice(0,3).toLowerCase();if(S=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}g=0;continue}if(!(S!="<td"&&S!="<th")){var T=w.split(/<\/t[dh]>/i);for(u=0;u<T.length;++u){var N=T[u].trim();if(N.match(/<t[dh]/i)){for(var k=N,E=0;k.charAt(0)=="<"&&(E=k.indexOf(">"))>-1;)k=k.slice(E+1);for(var M=0;M<b.length;++M){var D=b[M];D.s.c==g&&D.s.r<h&&h<=D.e.r&&(g=D.e.c+1,M=-1)}var A=Tt(N.slice(0,N.indexOf(">")));p=A.colspan?+A.colspan:1,((v=+A.rowspan)>1||p>1)&&b.push({s:{r:h,c:g},e:{r:h+(v||1)-1,c:g+p-1}});var B=A.t||A["data-t"]||"";if(!k.length){g+=p;continue}if(k=fS(k),_.s.r>h&&(_.s.r=h),_.e.r<h&&(_.e.r=h),_.s.c>g&&(_.s.c=g),_.e.c<g&&(_.e.c=g),!k.length){g+=p;continue}var j={t:"s",v:k};r.raw||!k.trim().length||B=="s"||(k==="TRUE"?j={t:"b",v:!0}:k==="FALSE"?j={t:"b",v:!1}:isNaN(rs(k))?isNaN(Gl(k).getDate())||(j={t:"d",v:Ar(k)},r.cellDates||(j={t:"n",v:la(j.v)}),j.z=r.dateNF||wt[14]):j={t:"n",v:rs(k)}),r.dense?(a[h]||(a[h]=[]),a[h][g]=j):a[bt({r:h,c:g})]=j,g+=p}}}}return a["!ref"]=Rt(_),b.length&&(a["!merges"]=b),a}function kV(e,t,r,a){for(var n=e["!merges"]||[],o=[],l=t.s.c;l<=t.e.c;++l){for(var u=0,f=0,h=0;h<n.length;++h)if(!(n[h].s.r>r||n[h].s.c>l)&&!(n[h].e.r<r||n[h].e.c<l)){if(n[h].s.r<r||n[h].s.c<l){u=-1;break}u=n[h].e.r-n[h].s.r+1,f=n[h].e.c-n[h].s.c+1;break}if(!(u<0)){var g=bt({r,c:l}),v=a.dense?(e[r]||[])[l]:e[g],p=v&&v.v!=null&&(v.h||vg(v.w||(qs(v),v.w)||""))||"",_={};u>1&&(_.rowspan=u),f>1&&(_.colspan=f),a.editable?p='<span contenteditable="true">'+p+"</span>":v&&(_["data-t"]=v&&v.t||"z",v.v!=null&&(_["data-v"]=v.v),v.z!=null&&(_["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+v.l.Target+'">'+p+"</a>")),_.id=(a.id||"sjs")+"-"+g,o.push(We("td",p,_))}}var b="<tr>";return b+o.join("")+"</tr>"}var AV='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',CV="</body></html>";function NV(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Vi(Ow(r[0],t),t);var a=Gg();return r.forEach(function(n,o){qg(a,Ow(n,t),"Sheet"+(o+1))}),a}function DV(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function VE(e,t){var r=t||{},a=r.header!=null?r.header:AV,n=r.footer!=null?r.footer:CV,o=[a],l=Ja(e["!ref"]);r.dense=Array.isArray(e),o.push(DV(e,l,r));for(var u=l.s.r;u<=l.e.r;++u)o.push(kV(e,l,u,r));return o.push("</table>"+n),o.join("")}function HE(e,t,r){var a=r||{},n=0,o=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var l=typeof a.origin=="string"?Ir(a.origin):a.origin;n=l.r,o=l.c}var u=t.getElementsByTagName("tr"),f=Math.min(a.sheetRows||1e7,u.length),h={s:{r:0,c:0},e:{r:n,c:o}};if(e["!ref"]){var g=Ja(e["!ref"]);h.s.r=Math.min(h.s.r,g.s.r),h.s.c=Math.min(h.s.c,g.s.c),h.e.r=Math.max(h.e.r,g.e.r),h.e.c=Math.max(h.e.c,g.e.c),n==-1&&(h.e.r=n=g.e.r+1)}var v=[],p=0,_=e["!rows"]||(e["!rows"]=[]),b=0,w=0,S=0,T=0,N=0,k=0;for(e["!cols"]||(e["!cols"]=[]);b<u.length&&w<f;++b){var E=u[b];if(Rw(E)){if(a.display)continue;_[w]={hidden:!0}}var M=E.children;for(S=T=0;S<M.length;++S){var D=M[S];if(!(a.display&&Rw(D))){var A=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):fS(D.innerHTML),B=D.getAttribute("data-z")||D.getAttribute("z");for(p=0;p<v.length;++p){var j=v[p];j.s.c==T+o&&j.s.r<w+n&&w+n<=j.e.r&&(T=j.e.c+1-o,p=-1)}k=+D.getAttribute("colspan")||1,((N=+D.getAttribute("rowspan")||1)>1||k>1)&&v.push({s:{r:w+n,c:T+o},e:{r:w+n+(N||1)-1,c:T+o+(k||1)-1}});var ee={t:"s",v:A},re=D.getAttribute("data-t")||D.getAttribute("t")||"";A!=null&&(A.length==0?ee.t=re||"z":a.raw||A.trim().length==0||re=="s"||(A==="TRUE"?ee={t:"b",v:!0}:A==="FALSE"?ee={t:"b",v:!1}:isNaN(rs(A))?isNaN(Gl(A).getDate())||(ee={t:"d",v:Ar(A)},a.cellDates||(ee={t:"n",v:la(ee.v)}),ee.z=a.dateNF||wt[14]):ee={t:"n",v:rs(A)})),ee.z===void 0&&B!=null&&(ee.z=B);var U="",I=D.getElementsByTagName("A");if(I&&I.length)for(var ne=0;ne<I.length&&!(I[ne].hasAttribute("href")&&(U=I[ne].getAttribute("href"),U.charAt(0)!="#"));++ne);U&&U.charAt(0)!="#"&&(ee.l={Target:U}),a.dense?(e[w+n]||(e[w+n]=[]),e[w+n][T+o]=ee):e[bt({c:T+o,r:w+n})]=ee,h.e.c<T+o&&(h.e.c=T+o),T+=k}}++w}return v.length&&(e["!merges"]=(e["!merges"]||[]).concat(v)),h.e.r=Math.max(h.e.r,w-1+n),e["!ref"]=Rt(h),w>=f&&(e["!fullref"]=Rt((h.e.r=u.length-b+w-1+n,h))),e}function $E(e,t){var r=t||{},a=r.dense?[]:{};return HE(a,e,t)}function OV(e,t){return Vi($E(e,t),t)}function Rw(e){var t="",r=RV(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function RV(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function FV(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Yt(t.replace(/<[^>]*>/g,""));return[r]}var Fw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function WE(e,t){var r=t||{},a=pg(e),n=[],o,l,u={name:""},f="",h=0,g,v,p={},_=[],b=r.dense?[]:{},w,S,T={value:""},N="",k=0,E=[],M=-1,D=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},B=0,j={},ee=[],re={},U=0,I=0,ne=[],ie=1,q=1,ae=[],be={Names:[]},z={},fe=["",""],De=[],P={},X="",Y=0,Q=!1,de=!1,Fe=0;for(Nu.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=Nu.exec(a);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?b["!ref"]=Rt(A):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(b["!fullref"]=b["!ref"],A.e.r=r.sheetRows-1,b["!ref"]=Rt(A)),ee.length&&(b["!merges"]=ee),ne.length&&(b["!rows"]=ne),g.name=g.||g.name,typeof JSON<"u"&&JSON.stringify(g),_.push(g.name),p[g.name]=b,de=!1):w[0].charAt(w[0].length-2)!=="/"&&(g=Tt(w[0],!1),M=D=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,b=r.dense?[]:{},ee=[],ne=[],de=!0);break;case"table-row-group":w[1]==="/"?--B:++B;break;case"table-row":case"":if(w[1]==="/"){M+=ie,ie=1;break}if(v=Tt(w[0],!1),v.?M=v.-1:M==-1&&(M=0),ie=+v["number-rows-repeated"]||1,ie<10)for(Fe=0;Fe<ie;++Fe)B>0&&(ne[M+Fe]={level:B});D=-1;break;case"covered-table-cell":w[1]!=="/"&&++D,r.sheetStubs&&(r.dense?(b[M]||(b[M]=[]),b[M][D]={t:"z"}):b[bt({r:M,c:D})]={t:"z"}),N="",E=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++D,T=Tt(w[0],!1),q=parseInt(T["number-columns-repeated"]||"1",10),S={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(S.f=Cw(Yt(T.formula))),(T.||T["value-type"])=="string"&&(S.t="s",S.v=Yt(T["string-value"]||""),r.dense?(b[M]||(b[M]=[]),b[M][D]=S):b[bt({r:M,c:D})]=S),D+=q-1;else if(w[1]!=="/"){++D,N="",k=0,E=[],q=1;var Te=ie?M+ie-1:M;if(D>A.e.c&&(A.e.c=D),D<A.s.c&&(A.s.c=D),M<A.s.r&&(A.s.r=M),Te>A.e.r&&(A.e.r=Te),T=Tt(w[0],!1),De=[],P={},S={t:T.||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=Yt(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(U=parseInt(T["number-matrix-rows-spanned"],10)||0,I=parseInt(T["number-matrix-columns-spanned"],10)||0,re={s:{r:M,c:D},e:{r:M+U-1,c:D+I-1}},S.F=Rt(re),ae.push([re,S.F])),T.formula)S.f=Cw(T.formula);else for(Fe=0;Fe<ae.length;++Fe)M>=ae[Fe][0].s.r&&M<=ae[Fe][0].e.r&&D>=ae[Fe][0].s.c&&D<=ae[Fe][0].e.c&&(S.F=ae[Fe][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(U=parseInt(T["number-rows-spanned"],10)||0,I=parseInt(T["number-columns-spanned"],10)||0,re={s:{r:M,c:D},e:{r:M+U-1,c:D+I-1}},ee.push(re)),T["number-columns-repeated"]&&(q=parseInt(T["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=kr(T["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(T.value);break;case"percentage":S.t="n",S.v=parseFloat(T.value);break;case"currency":S.t="n",S.v=parseFloat(T.value);break;case"date":S.t="d",S.v=Ar(T["date-value"]),r.cellDates||(S.t="n",S.v=la(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=iM(T["time-value"])/86400,r.cellDates&&(S.t="d",S.v=cd(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(T.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",T["string-value"]!=null&&(N=Yt(T["string-value"]),E=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(Q=!1,S.t==="s"&&(S.v=N||"",E.length&&(S.R=E),Q=k==0),z.Target&&(S.l=z),De.length>0&&(S.c=De,De=[]),N&&r.cellText!==!1&&(S.w=N),Q&&(S.t="z",delete S.v),(!Q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=M))for(var Oe=0;Oe<ie;++Oe){if(q=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(b[M+Oe]||(b[M+Oe]=[]),b[M+Oe][D]=Oe==0?S:Cr(S);--q>0;)b[M+Oe][D+q]=Cr(S);else for(b[bt({r:M+Oe,c:D})]=S;--q>0;)b[bt({r:M+Oe,c:D+q})]=Cr(S);A.e.c<=D&&(A.e.c=D)}q=parseInt(T["number-columns-repeated"]||"1",10),D+=q-1,q=0,S={},N="",E=[]}z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((o=n.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&n.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((o=n.pop())[0]!==w[3])throw"Bad state: "+o;P.t=N,E.length&&(P.R=E),P.a=X,De.push(P)}else w[0].charAt(w[0].length-2)!=="/"&&n.push([w[3],!1]);X="",Y=0,N="",k=0,E=[];break;case"creator":w[1]==="/"?X=a.slice(Y,w.index):Y=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((o=n.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&n.push([w[3],!1]);N="",k=0,E=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(j[u.name]=f,(o=n.pop())[0]!==w[3])throw"Bad state: "+o}else w[0].charAt(w[0].length-2)!=="/"&&(f="",u=Tt(w[0],!1),n.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Tt(w[0],!1),f+=Fw[w[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Tt(w[0],!1),f+=Fw[w[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":f+=a.slice(h,w.index);break}else h=w.index+w[0].length;break;case"named-range":l=Tt(w[0],!1),fe=Gm(l["cell-range-address"]);var Re={Name:l.name,Ref:fe[0]+"!"+fe[1]};de&&(Re.Sheet=_.length),be.Names.push(Re);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(w[1]==="/"&&(!T||!T["string-value"])){var Je=FV(a.slice(k,w.index));N=(N.length>0?N+`
`:"")+Je[0]}else Tt(w[0],!1),k=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{fe=Gm(Tt(w[0])["target-range-address"]),p[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(z=Tt(w[0],!1),!z.href)break;z.Target=Yt(z.href),delete z.href,z.Target.charAt(0)=="#"&&z.Target.indexOf(".")>-1?(fe=Gm(z.Target.slice(1)),z.Target="#"+fe[0]+"!"+fe[1]):z.Target.match(/^\.\.[\\\/]/)&&(z.Target=z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(w)}}var H={Sheets:p,SheetNames:_,Workbook:be};return r.bookSheets&&delete H.Sheets,H}function Mw(e,t){t=t||{},Fn(e,"META-INF/manifest.xml")&&ij(ea(e,"META-INF/manifest.xml"),t);var r=gn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=WE(mr(r),t);return Fn(e,"meta.xml")&&(a.Props=jS(ea(e,"meta.xml"))),a}function jw(e,t){return WE(e,t)}var MV=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Cu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Yr+t}}(),Iw=function(){var e=function(o){return or(o).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(o,l,u){var f=[];f.push('      <table:table table:name="'+or(l.SheetNames[u])+`" table:style-name="ta1">
`);var h=0,g=0,v=Ja(o["!ref"]||"A1"),p=o["!merges"]||[],_=0,b=Array.isArray(o);if(o["!cols"])for(g=0;g<=v.e.c;++g)f.push("        <table:table-column"+(o["!cols"][g]?' table:style-name="co'+o["!cols"][g].ods+'"':"")+`></table:table-column>
`);var w="",S=o["!rows"]||[];for(h=0;h<v.s.r;++h)w=S[h]?' table:style-name="ro'+S[h].ods+'"':"",f.push("        <table:table-row"+w+`></table:table-row>
`);for(;h<=v.e.r;++h){for(w=S[h]?' table:style-name="ro'+S[h].ods+'"':"",f.push("        <table:table-row"+w+`>
`),g=0;g<v.s.c;++g)f.push(t);for(;g<=v.e.c;++g){var T=!1,N={},k="";for(_=0;_!=p.length;++_)if(!(p[_].s.c>g)&&!(p[_].s.r>h)&&!(p[_].e.c<g)&&!(p[_].e.r<h)){(p[_].s.c!=g||p[_].s.r!=h)&&(T=!0),N["table:number-columns-spanned"]=p[_].e.c-p[_].s.c+1,N["table:number-rows-spanned"]=p[_].e.r-p[_].s.r+1;break}if(T){f.push(r);continue}var E=bt({r:h,c:g}),M=b?(o[h]||[])[g]:o[E];if(M&&M.f&&(N["table:formula"]=or(eB(M.f)),M.F&&M.F.slice(0,E.length)==E)){var D=Ja(M.F);N["table:number-matrix-columns-spanned"]=D.e.c-D.s.c+1,N["table:number-matrix-rows-spanned"]=D.e.r-D.s.r+1}if(!M){f.push(t);continue}switch(M.t){case"b":k=M.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=M.v?"true":"false";break;case"n":k=M.w||String(M.v||0),N["office:value-type"]="float",N["office:value"]=M.v||0;break;case"s":case"str":k=M.v==null?"":M.v,N["office:value-type"]="string";break;case"d":k=M.w||Ar(M.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=Ar(M.v).toISOString(),N["table:style-name"]="ce1";break;default:f.push(t);continue}var A=e(k);if(M.l&&M.l.Target){var B=M.l.Target;B=B.charAt(0)=="#"?"#"+tB(B.slice(1)):B,B.charAt(0)!="#"&&!B.match(/^\w+:/)&&(B="../"+B),A=We("text:a",A,{"xlink:href":B.replace(/&/g,"&amp;")})}f.push("          "+We("table:table-cell",We("text:p",A,{}),N)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},n=function(o,l){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(h){return l.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var g=0;g<h["!cols"].length;++g)if(h["!cols"][g]){var v=h["!cols"][g];if(v.width==null&&v.wpx==null&&v.wch==null)continue;Pi(v),v.ods=u;var p=h["!cols"][g].wpx+"px";o.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),o.push(`  </style:style>
`),++u}}});var f=0;l.SheetNames.map(function(h){return l.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var g=0;g<h["!rows"].length;++g)if(h["!rows"][g]){h["!rows"][g].ods=f;var v=h["!rows"][g].hpx+"px";o.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),o.push(`  </style:style>
`),++f}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(l,u){var f=[Yr],h=Cu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),g=Cu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+h+g+`>
`),f.push(MS().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+h+`>
`),n(f,l),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var v=0;v!=l.SheetNames.length;++v)f.push(a(l.Sheets[l.SheetNames[v]],l,v));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}}();function GE(e,t){if(t.bookType=="fods")return Iw(e,t);var r=mg(),a="",n=[],o=[];return a="mimetype",Mt(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Mt(r,a,Iw(e,t)),n.push([a,"text/xml"]),o.push([a,"ContentFile"]),a="styles.xml",Mt(r,a,MV(e,t)),n.push([a,"text/xml"]),o.push([a,"StylesFile"]),a="meta.xml",Mt(r,a,Yr+MS()),n.push([a,"text/xml"]),o.push([a,"MetadataFile"]),a="manifest.rdf",Mt(r,a,cj(o)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Mt(r,a,oj(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function No(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function O1(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):mr(zi(e))}function jV(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):mn(ps(e))}function IV(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Bi(e){var t=e.reduce(function(n,o){return n+o.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function Pw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function PV(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function LV(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var o=0;n>=1;++o,n/=256)e[t+o]=n&255;e[t+15]|=r>=0?0:128}function Iu(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function ar(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function zr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Jt(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=Iu(e,r),o=n&7;n=Math.floor(n/8);var l=0,u;if(n==0)break;switch(o){case 0:{for(var f=r[0];e[r[0]++]>=128;);u=e.slice(f,r[0])}break;case 5:l=4,u=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,u=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Iu(e,r),u=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(n," at offset ").concat(a))}var h={data:u,type:o};t[n]==null?t[n]=[h]:t[n].push(h)}return t}function ba(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(ar(a*8+n.type)),n.type==2&&t.push(ar(n.data.length)),t.push(n.data))})}),Bi(t)}function zg(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Dn(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=Iu(e,a),o=Jt(e.slice(a[0],a[0]+n));a[0]+=n;var l={id:zr(o[1][0].data),messages:[]};o[2].forEach(function(u){var f=Jt(u.data),h=zr(f[3][0].data);l.messages.push({meta:f,data:e.slice(a[0],a[0]+h)}),a[0]+=h}),(t=o[3])!=null&&t[0]&&(l.merge=zr(o[3][0].data)>>>0>0),r.push(l)}return r}function Tl(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:ar(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:ar(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(l){n.push(l.data),l.meta[3]=[{type:0,data:ar(l.data.length)}],a[2].push({data:ba(l.meta),type:2})});var o=ba(a);t.push(ar(o.length)),t.push(o),n.forEach(function(l){return t.push(l)})}),Bi(t)}function BV(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Iu(t,r),n=[];r[0]<t.length;){var o=t[r[0]]&3;if(o==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var u=l-59;l=t[r[0]],u>1&&(l|=t[r[0]+1]<<8),u>2&&(l|=t[r[0]+2]<<16),u>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=u}n.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var f=0,h=0;if(o==1?(h=(t[r[0]]>>2&7)+4,f=(t[r[0]++]&224)<<3,f|=t[r[0]++]):(h=(t[r[0]++]>>2)+1,o==2?(f=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(f=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Bi(n)],f==0)throw new Error("Invalid offset 0");if(f>n[0].length)throw new Error("Invalid offset beyond length");if(h>=f)for(n.push(n[0].slice(-f)),h-=f;h>=n[n.length-1].length;)n.push(n[n.length-1]),h-=n[n.length-1].length;n.push(n[0].slice(-f,-f+h))}}var g=Bi(n);if(g.length!=a)throw new Error("Unexpected length: ".concat(g.length," != ").concat(a));return g}function On(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(BV(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Bi(t)}function kl(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var o=ar(a),l=o.length;t.push(o),a<=60?(l++,t.push(new Uint8Array([a-1<<2]))):a<=256?(l+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(l+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(l+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(l+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),l+=a,n[0]=0,n[1]=l&255,n[2]=l>>8&255,n[3]=l>>16&255,r+=a}return Bi(t)}function UV(e,t,r,a){var n=No(e),o=n.getUint32(4,!0),l=(a>1?12:8)+Pw(o&(a>1?3470:398))*4,u=-1,f=-1,h=NaN,g=new Date(2001,0,1);o&512&&(u=n.getUint32(l,!0),l+=4),l+=Pw(o&(a>1?12288:4096))*4,o&16&&(f=n.getUint32(l,!0),l+=4),o&32&&(h=n.getFloat64(l,!0),l+=8),o&64&&(g.setTime(g.getTime()+n.getFloat64(l,!0)*1e3),l+=8);var v;switch(e[2]){case 0:break;case 2:v={t:"n",v:h};break;case 3:v={t:"s",v:t[f]};break;case 5:v={t:"d",v:g};break;case 6:v={t:"b",v:h>0};break;case 7:v={t:"n",v:h/86400};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1)v={t:"s",v:r[u]};else if(f>-1)v={t:"s",v:t[f]};else if(!isNaN(h))v={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return v}function zV(e,t,r){var a=No(e),n=a.getUint32(8,!0),o=12,l=-1,u=-1,f=NaN,h=NaN,g=new Date(2001,0,1);n&1&&(f=PV(e,o),o+=16),n&2&&(h=a.getFloat64(o,!0),o+=8),n&4&&(g.setTime(g.getTime()+a.getFloat64(o,!0)*1e3),o+=8),n&8&&(u=a.getUint32(o,!0),o+=4),n&16&&(l=a.getUint32(o,!0),o+=4);var v;switch(e[1]){case 0:break;case 2:v={t:"n",v:f};break;case 3:v={t:"s",v:t[u]};break;case 5:v={t:"d",v:g};break;case 6:v={t:"b",v:h>0};break;case 7:v={t:"n",v:h/86400};break;case 8:v={t:"e",v:0};break;case 9:if(l>-1)v={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:v={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return v}function Ym(e,t){var r=new Uint8Array(32),a=No(r),n=12,o=0;switch(r[0]=5,e.t){case"n":r[1]=2,LV(r,n,e.v),o|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),o|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),o|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,o,!0),r.slice(0,n)}function Xm(e,t){var r=new Uint8Array(32),a=No(r),n=12,o=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),o|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),o|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),o|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,o,!0),r.slice(0,n)}function VV(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return UV(e,t,r,e[0]);case 5:return zV(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Na(e){var t=Jt(e);return Iu(t[1][0].data)}function Lw(e,t){var r=Jt(t.data),a=zr(r[1][0].data),n=r[3],o=[];return(n||[]).forEach(function(l){var u=Jt(l.data),f=zr(u[1][0].data)>>>0;switch(a){case 1:o[f]=O1(u[3][0].data);break;case 8:{var h=e[Na(u[9][0].data)][0],g=Jt(h.data),v=e[Na(g[1][0].data)][0],p=zr(v.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var _=Jt(v.data);o[f]=_[3].map(function(b){return O1(b.data)}).join("")}break}}),o}function HV(e,t){var r,a,n,o,l,u,f,h,g,v,p,_,b,w,S=Jt(e),T=zr(S[1][0].data)>>>0,N=zr(S[2][0].data)>>>0,k=((a=(r=S[8])==null?void 0:r[0])==null?void 0:a.data)&&zr(S[8][0].data)>0||!1,E,M;if((o=(n=S[7])==null?void 0:n[0])!=null&&o.data&&t!=0)E=(u=(l=S[7])==null?void 0:l[0])==null?void 0:u.data,M=(h=(f=S[6])==null?void 0:f[0])==null?void 0:h.data;else if((v=(g=S[4])==null?void 0:g[0])!=null&&v.data&&t!=1)E=(_=(p=S[4])==null?void 0:p[0])==null?void 0:_.data,M=(w=(b=S[3])==null?void 0:b[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var D=k?4:1,A=No(E),B=[],j=0;j<E.length/2;++j){var ee=A.getUint16(j*2,!0);ee<65535&&B.push([j,ee])}if(B.length!=N)throw"Expected ".concat(N," cells, found ").concat(B.length);var re=[];for(j=0;j<B.length-1;++j)re[B[j][0]]=M.subarray(B[j][1]*D,B[j+1][1]*D);return B.length>=1&&(re[B[B.length-1][0]]=M.subarray(B[B.length-1][1]*D)),{R:T,cells:re}}function $V(e,t){var r,a=Jt(t.data),n=(r=a==null?void 0:a[7])!=null&&r[0]?zr(a[7][0].data)>>>0>0?1:0:-1,o=zg(a[5],function(l){return HV(l,n)});return{nrows:zr(a[4][0].data)>>>0,data:o.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(f,h){if(l[u.R][h])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(h));l[u.R][h]=f}),l},[])}}function WV(e,t,r){var a,n=Jt(t.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(zr(n[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(o.e.c=(zr(n[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Rt(o);var l=Jt(n[4][0].data),u=Lw(e,e[Na(l[4][0].data)][0]),f=(a=l[17])!=null&&a[0]?Lw(e,e[Na(l[17][0].data)][0]):[],h=Jt(l[3][0].data),g=0;h[1].forEach(function(v){var p=Jt(v.data),_=e[Na(p[2][0].data)][0],b=zr(_.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var w=$V(e,_);w.data.forEach(function(S,T){S.forEach(function(N,k){var E=bt({r:g+T,c:k}),M=VV(N,u,f);M&&(r[E]=M)})}),g+=w.nrows})}function GV(e,t){var r=Jt(t.data),a={"!ref":"A1"},n=e[Na(r[2][0].data)],o=zr(n[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return WV(e,n[0],a),a}function qV(e,t){var r,a=Jt(t.data),n={name:(r=a[1])!=null&&r[0]?O1(a[1][0].data):"",sheets:[]},o=zg(a[2],Na);return o.forEach(function(l){e[l].forEach(function(u){var f=zr(u.meta[1][0].data);f==6e3&&n.sheets.push(GV(e,u))})}),n}function YV(e,t){var r=Gg(),a=Jt(t.data),n=zg(a[1],Na);if(n.forEach(function(o){e[o].forEach(function(l){var u=zr(l.meta[1][0].data);if(u==2){var f=qV(e,l);f.sheets.forEach(function(h,g){qg(r,h,g==0?f.name:f.name+"_"+g,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Km(e){var t,r,a,n,o={},l=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var h;try{h=On(f.content)}catch(v){return console.log("?? "+f.content.length+" "+(v.message||v))}var g;try{g=Dn(h)}catch(v){return console.log("## "+(v.message||v))}g.forEach(function(v){o[v.id]=v.messages,l.push(v.id)})}}),!l.length)throw new Error("File has no messages");var u=((n=(a=(r=(t=o==null?void 0:o[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&zr(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||l.forEach(function(f){o[f].forEach(function(h){var g=zr(h.meta[1][0].data)>>>0;if(g==1)if(!u)u=h;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return YV(o,u)}function XV(e,t,r){var a,n,o,l;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(o=e[8])==null?void 0:o[0])==null?void 0:l.data)&&zr(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,h=No(e[7][0].data),g=0,v=[],p=No(e[4][0].data),_=0,b=[],w=0;w<t.length;++w){if(t[w]==null){h.setUint16(w*2,65535,!0),p.setUint16(w*2,65535);continue}h.setUint16(w*2,g,!0),p.setUint16(w*2,_,!0);var S,T;switch(typeof t[w]){case"string":S=Ym({t:"s",v:t[w]},r),T=Xm({t:"s",v:t[w]},r);break;case"number":S=Ym({t:"n",v:t[w]},r),T=Xm({t:"n",v:t[w]},r);break;case"boolean":S=Ym({t:"b",v:t[w]},r),T=Xm({t:"b",v:t[w]},r);break;default:throw new Error("Unsupported value "+t[w])}v.push(S),g+=S.length,b.push(T),_+=T.length,++f}for(e[2][0].data=ar(f);w<e[7][0].data.length/2;++w)h.setUint16(w*2,65535,!0),p.setUint16(w*2,65535,!0);return e[6][0].data=Bi(v),e[3][0].data=Bi(b),f}function KV(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Ja(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Rt(a)));var o=q0(r,{range:a,header:1}),l=["~Sh33tJ5~"];o.forEach(function(X){return X.forEach(function(Y){typeof Y=="string"&&l.push(Y)})});var u={},f=[],h=mt.read(t.numbers,{type:"base64"});h.FileIndex.map(function(X,Y){return[X,h.FullPaths[Y]]}).forEach(function(X){var Y=X[0],Q=X[1];if(Y.type==2&&Y.name.match(/\.iwa/)){var de=Y.content,Fe=On(de),Te=Dn(Fe);Te.forEach(function(Oe){f.push(Oe.id),u[Oe.id]={deps:[],location:Q,type:zr(Oe.messages[0].meta[1][0].data)}})}}),f.sort(function(X,Y){return X-Y});var g=f.filter(function(X){return X>1}).map(function(X){return[X,ar(X)]});h.FileIndex.map(function(X,Y){return[X,h.FullPaths[Y]]}).forEach(function(X){var Y=X[0];if(X[1],!!Y.name.match(/\.iwa/)){var Q=Dn(On(Y.content));Q.forEach(function(de){de.messages.forEach(function(Fe){g.forEach(function(Te){de.messages.some(function(Oe){return zr(Oe.meta[1][0].data)!=11006&&IV(Oe.data,Te[1])})&&u[Te[0]].deps.push(de.id)})})})}});for(var v=mt.find(h,u[1].location),p=Dn(On(v.content)),_,b=0;b<p.length;++b){var w=p[b];w.id==1&&(_=w)}var S=Na(Jt(_.messages[0].data)[1][0].data);for(v=mt.find(h,u[S].location),p=Dn(On(v.content)),b=0;b<p.length;++b)w=p[b],w.id==S&&(_=w);for(S=Na(Jt(_.messages[0].data)[2][0].data),v=mt.find(h,u[S].location),p=Dn(On(v.content)),b=0;b<p.length;++b)w=p[b],w.id==S&&(_=w);for(S=Na(Jt(_.messages[0].data)[2][0].data),v=mt.find(h,u[S].location),p=Dn(On(v.content)),b=0;b<p.length;++b)w=p[b],w.id==S&&(_=w);var T=Jt(_.messages[0].data);{T[6][0].data=ar(a.e.r+1),T[7][0].data=ar(a.e.c+1);var N=Na(T[46][0].data),k=mt.find(h,u[N].location),E=Dn(On(k.content));{for(var M=0;M<E.length&&E[M].id!=N;++M);if(E[M].id!=N)throw"Bad ColumnRowUIDMapArchive";var D=Jt(E[M].messages[0].data);D[1]=[],D[2]=[],D[3]=[];for(var A=0;A<=a.e.c;++A){var B=[];B[1]=B[2]=[{type:0,data:ar(A+420690)}],D[1].push({type:2,data:ba(B)}),D[2].push({type:0,data:ar(A)}),D[3].push({type:0,data:ar(A)})}D[4]=[],D[5]=[],D[6]=[];for(var j=0;j<=a.e.r;++j)B=[],B[1]=B[2]=[{type:0,data:ar(j+726270)}],D[4].push({type:2,data:ba(B)}),D[5].push({type:0,data:ar(j)}),D[6].push({type:0,data:ar(j)});E[M].messages[0].data=ba(D)}k.content=kl(Tl(E)),k.size=k.content.length,delete T[46];var ee=Jt(T[4][0].data);{ee[7][0].data=ar(a.e.r+1);var re=Jt(ee[1][0].data),U=Na(re[2][0].data);k=mt.find(h,u[U].location),E=Dn(On(k.content));{if(E[0].id!=U)throw"Bad HeaderStorageBucket";var I=Jt(E[0].messages[0].data);for(j=0;j<o.length;++j){var ne=Jt(I[2][0].data);ne[1][0].data=ar(j),ne[4][0].data=ar(o[j].length),I[2][j]={type:I[2][0].type,data:ba(ne)}}E[0].messages[0].data=ba(I)}k.content=kl(Tl(E)),k.size=k.content.length;var ie=Na(ee[2][0].data);k=mt.find(h,u[ie].location),E=Dn(On(k.content));{if(E[0].id!=ie)throw"Bad HeaderStorageBucket";for(I=Jt(E[0].messages[0].data),A=0;A<=a.e.c;++A)ne=Jt(I[2][0].data),ne[1][0].data=ar(A),ne[4][0].data=ar(a.e.r+1),I[2][A]={type:I[2][0].type,data:ba(ne)};E[0].messages[0].data=ba(I)}k.content=kl(Tl(E)),k.size=k.content.length;var q=Na(ee[4][0].data);(function(){for(var X=mt.find(h,u[q].location),Y=Dn(On(X.content)),Q,de=0;de<Y.length;++de){var Fe=Y[de];Fe.id==q&&(Q=Fe)}var Te=Jt(Q.messages[0].data);{Te[3]=[];var Oe=[];l.forEach(function(H,O){Oe[1]=[{type:0,data:ar(O)}],Oe[2]=[{type:0,data:ar(1)}],Oe[3]=[{type:2,data:jV(H)}],Te[3].push({type:2,data:ba(Oe)})})}Q.messages[0].data=ba(Te);var Re=Tl(Y),Je=kl(Re);X.content=Je,X.size=X.content.length})();var ae=Jt(ee[3][0].data);{var be=ae[1][0];delete ae[2];var z=Jt(be.data);{var fe=Na(z[2][0].data);(function(){for(var X=mt.find(h,u[fe].location),Y=Dn(On(X.content)),Q,de=0;de<Y.length;++de){var Fe=Y[de];Fe.id==fe&&(Q=Fe)}var Te=Jt(Q.messages[0].data);{delete Te[6],delete ae[7];var Oe=new Uint8Array(Te[5][0].data);Te[5]=[];for(var Re=0,Je=0;Je<=a.e.r;++Je){var H=Jt(Oe);Re+=XV(H,o[Je],l),H[1][0].data=ar(Je),Te[5].push({data:ba(H),type:2})}Te[1]=[{type:0,data:ar(a.e.c+1)}],Te[2]=[{type:0,data:ar(a.e.r+1)}],Te[3]=[{type:0,data:ar(Re)}],Te[4]=[{type:0,data:ar(a.e.r+1)}]}Q.messages[0].data=ba(Te);var O=Tl(Y),Ae=kl(O);X.content=Ae,X.size=X.content.length})()}be.data=ba(z)}ee[3][0].data=ba(ae)}T[4][0].data=ba(ee)}_.messages[0].data=ba(T);var De=Tl(p),P=kl(De);return v.content=P,v.size=v.content.length,h}function qE(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function Vg(e){qE([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Hg(e){qE([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function JV(e){return Bt.WS.indexOf(e)>-1?"sheet":e==Bt.CS?"chart":e==Bt.DS?"dialog":e==Bt.MS?"macro":e&&e.length?e:"sheet"}function QV(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,JV(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function ZV(e,t,r,a,n,o,l,u,f,h,g,v){try{o[a]=uu(gn(e,r,!0),t);var p=ea(e,t),_;switch(u){case"sheet":_=wz(p,t,n,f,o[a],h,g,v);break;case"chart":if(_=bz(p,t,n,f,o[a],h,g,v),!_||!_["!drawel"])break;var b=au(_["!drawel"].Target,t),w=Du(b),S=l7(gn(e,b,!0),uu(gn(e,w,!0),b)),T=au(S,b),N=Du(T);_=XU(gn(e,T,!0),T,f,uu(gn(e,N,!0),T),h,_);break;case"macro":_=Sz(p,t,n,f,o[a],h,g,v);break;case"dialog":_=Ez(p,t,n,f,o[a],h,g,v);break;default:throw new Error("Unrecognized sheet type "+u)}l[a]=_;var k=[];o&&o[a]&&Vr(o[a]).forEach(function(E){var M="";if(o[a][E].Type==Bt.CMNT){M=au(o[a][E].Target,t);var D=Cz(ea(e,M,!0),M,f);if(!D||!D.length)return;Sw(_,D,!1)}o[a][E].Type==Bt.TCMNT&&(M=au(o[a][E].Target,t),k=k.concat(u7(ea(e,M,!0),f)))}),k&&k.length&&Sw(_,k,!0,f.people||[])}catch(E){if(f.WTF)throw E}}function Cn(e){return e.charAt(0)=="/"?e.slice(1):e}function eH(e,t){if(Ql(),t=t||{},Vg(t),Fn(e,"META-INF/manifest.xml")||Fn(e,"objectdata.xml"))return Mw(e,t);if(Fn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Km<"u"){if(e.FileIndex)return Km(e);var r=mt.utils.cfb_new();return $_(e).forEach(function(ne){Mt(r,ne,fM(e,ne))}),Km(r)}throw new Error("Unsupported NUMBERS file")}if(!Fn(e,"[Content_Types].xml"))throw Fn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Fn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=$_(e),n=nj(gn(e,"[Content_Types].xml")),o=!1,l,u;if(n.workbooks.length===0&&(u="xl/workbook.xml",ea(e,u,!0)&&n.workbooks.push(u)),n.workbooks.length===0){if(u="xl/workbook.bin",!ea(e,u,!0))throw new Error("Could not find workbook");n.workbooks.push(u),o=!0}n.workbooks[0].slice(-3)=="bin"&&(o=!0);var f={},h={};if(!t.bookSheets&&!t.bookProps){if(fu=[],n.sst)try{fu=Az(ea(e,Cn(n.sst)),n.sst,t)}catch(ne){if(t.WTF)throw ne}t.cellStyles&&n.themes.length&&(f=kz(gn(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(h=Tz(ea(e,Cn(n.style)),n.style,f,t))}n.links.map(function(ne){try{var ie=uu(gn(e,Du(Cn(ne))),ne);return Dz(ea(e,Cn(ne)),ie,ne,t)}catch{}});var g=_z(ea(e,Cn(n.workbooks[0])),n.workbooks[0],t),v={},p="";n.coreprops.length&&(p=ea(e,Cn(n.coreprops[0]),!0),p&&(v=jS(p)),n.extprops.length!==0&&(p=ea(e,Cn(n.extprops[0]),!0),p&&fj(p,v,t)));var _={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(p=gn(e,Cn(n.custprops[0]),!0),p&&(_=hj(p,t)));var b={};if((t.bookSheets||t.bookProps)&&(g.Sheets?l=g.Sheets.map(function(ie){return ie.name}):v.Worksheets&&v.SheetNames.length>0&&(l=v.SheetNames),t.bookProps&&(b.Props=v,b.Custprops=_),t.bookSheets&&typeof l<"u"&&(b.SheetNames=l),t.bookSheets?b.SheetNames:t.bookProps))return b;l={};var w={};t.bookDeps&&n.calcchain&&(w=Nz(ea(e,Cn(n.calcchain)),n.calcchain));var S=0,T={},N,k;{var E=g.Sheets;v.Worksheets=E.length,v.SheetNames=[];for(var M=0;M!=E.length;++M)v.SheetNames[M]=E[M].name}var D=o?"bin":"xml",A=n.workbooks[0].lastIndexOf("/"),B=(n.workbooks[0].slice(0,A+1)+"_rels/"+n.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");Fn(e,B)||(B="xl/_rels/workbook."+D+".rels");var j=uu(gn(e,B,!0),B.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=Oz(ea(e,Cn(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=d7(ea(e,Cn(n.people[0])),t)),j&&(j=QV(j,g.Sheets));var ee=ea(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=v.Worksheets;++S){var re="sheet";if(j&&j[S]?(N="xl/"+j[S][1].replace(/[\/]?xl\//,""),Fn(e,N)||(N=j[S][1]),Fn(e,N)||(N=B.replace(/_rels\/.*$/,"")+j[S][1]),re=j[S][2]):(N="xl/worksheets/sheet"+(S+1-ee)+"."+D,N=N.replace(/sheet0\./,"sheet.")),k=N.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(S!=t.sheets)continue e;break;case"string":if(v.SheetNames[S].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var U=!1,I=0;I!=t.sheets.length;++I)typeof t.sheets[I]=="number"&&t.sheets[I]==S&&(U=1),typeof t.sheets[I]=="string"&&t.sheets[I].toLowerCase()==v.SheetNames[S].toLowerCase()&&(U=1);if(!U)continue e}}ZV(e,N,k,v.SheetNames[S],S,T,l,re,t,g,f,h)}return b={Directory:n,Workbook:g,Props:v,Custprops:_,Deps:w,Sheets:l,SheetNames:v.SheetNames,Strings:fu,Styles:h,Themes:f,SSF:Cr(wt)},t&&t.bookFiles&&(e.files?(b.keys=a,b.files=e.files):(b.keys=[],b.files={},e.FullPaths.forEach(function(ne,ie){ne=ne.replace(/^Root Entry[\/]/,""),b.keys.push(ne),b.files[ne]=e.FileIndex[ie]}))),t&&t.bookVBA&&(n.vba.length>0?b.vbaraw=ea(e,Cn(n.vba[0]),!0):n.defaults&&n.defaults.bin===_7&&(b.vbaraw=ea(e,"xl/vbaProject.bin",!0))),b}function tH(e,t){var r=t||{},a="Workbook",n=mt.find(e,a);try{if(a="/!DataSpaces/Version",n=mt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(OP(n.content),a="/!DataSpaces/DataSpaceMap",n=mt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=FP(n.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=mt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=MP(n.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=mt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);IP(n.content)}catch{}if(a="/EncryptionInfo",n=mt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var u=PP(n.content);if(a="/EncryptedPackage",n=mt.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],n.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function rH(e,t){return t.bookType=="ods"?GE(e,t):t.bookType=="numbers"?KV(e,t):t.bookType=="xlsb"?aH(e,t):nH(e,t)}function aH(e,t){Pl=1024,e&&!e.SSF&&(e.SSF=Cr(wt)),e&&e.SSF&&(Ql(),id(e.SSF),t.revssf=ld(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,du?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=_E.indexOf(t.bookType)>-1,n=Cg();Hg(t=t||{});var o=mg(),l="",u=0;if(t.cellXfs=[],Hi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Mt(o,l,IS(e.Props,t)),n.coreprops.push(l),sr(t.rels,2,l,Bt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(e.SheetNames[h]);e.Props.SheetNames=f}for(e.Props.Worksheets=e.Props.SheetNames.length,Mt(o,l,BS(e.Props)),n.extprops.push(l),sr(t.rels,3,l,Bt.EXT_PROPS),e.Custprops!==e.Props&&Vr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Mt(o,l,US(e.Custprops)),n.custprops.push(l),sr(t.rels,4,l,Bt.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var g={"!id":{}},v=e.Sheets[e.SheetNames[u-1]],p=(v||{})["!type"]||"sheet";switch(p){case"chart":default:l="xl/worksheets/sheet"+u+"."+r,Mt(o,l,Fz(u-1,l,t,e,g)),n.sheets.push(l),sr(t.wbrels,-1,"worksheets/sheet"+u+"."+r,Bt.WS[0])}if(v){var _=v["!comments"],b=!1,w="";_&&_.length>0&&(w="xl/comments"+u+"."+r,Mt(o,w,Iz(_,w)),n.comments.push(w),sr(g,-1,"../comments"+u+"."+r,Bt.CMNT),b=!0),v["!legacy"]&&b&&Mt(o,"xl/drawings/vmlDrawing"+u+".vml",pE(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}g["!id"].rId1&&Mt(o,Du(l),Vl(g))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Mt(o,l,jz(t.Strings,l,t)),n.strs.push(l),sr(t.wbrels,-1,"sharedStrings."+r,Bt.SST)),l="xl/workbook."+r,Mt(o,l,Rz(e,l)),n.workbooks.push(l),sr(t.rels,1,l,Bt.WB),l="xl/theme/theme1.xml",Mt(o,l,Mg(e.Themes,t)),n.themes.push(l),sr(t.wbrels,-1,"theme/theme1.xml",Bt.THEME),l="xl/styles."+r,Mt(o,l,Mz(e,l,t)),n.styles.push(l),sr(t.wbrels,-1,"styles."+r,Bt.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",Mt(o,l,e.vbaraw),n.vba.push(l),sr(t.wbrels,-1,"vbaProject.bin",Bt.VBA)),l="xl/metadata."+r,Mt(o,l,Pz(l)),n.metadata.push(l),sr(t.wbrels,-1,"metadata."+r,Bt.XLMETA),Mt(o,"[Content_Types].xml",FS(n,t)),Mt(o,"_rels/.rels",Vl(t.rels)),Mt(o,"xl/_rels/workbook."+r+".rels",Vl(t.wbrels)),delete t.revssf,delete t.ssf,o}function nH(e,t){Pl=1024,e&&!e.SSF&&(e.SSF=Cr(wt)),e&&e.SSF&&(Ql(),id(e.SSF),t.revssf=ld(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,du?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=_E.indexOf(t.bookType)>-1,n=Cg();Hg(t=t||{});var o=mg(),l="",u=0;if(t.cellXfs=[],Hi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Mt(o,l,IS(e.Props,t)),n.coreprops.push(l),sr(t.rels,2,l,Bt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(e.SheetNames[h]);e.Props.SheetNames=f}e.Props.Worksheets=e.Props.SheetNames.length,Mt(o,l,BS(e.Props)),n.extprops.push(l),sr(t.rels,3,l,Bt.EXT_PROPS),e.Custprops!==e.Props&&Vr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Mt(o,l,US(e.Custprops)),n.custprops.push(l),sr(t.rels,4,l,Bt.CUST_PROPS));var g=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var v={"!id":{}},p=e.Sheets[e.SheetNames[u-1]],_=(p||{})["!type"]||"sheet";switch(_){case"chart":default:l="xl/worksheets/sheet"+u+"."+r,Mt(o,l,OE(u-1,t,e,v)),n.sheets.push(l),sr(t.wbrels,-1,"worksheets/sheet"+u+"."+r,Bt.WS[0])}if(p){var b=p["!comments"],w=!1,S="";if(b&&b.length>0){var T=!1;b.forEach(function(N){N[1].forEach(function(k){k.T==!0&&(T=!0)})}),T&&(S="xl/threadedComments/threadedComment"+u+"."+r,Mt(o,S,f7(b,g,t)),n.threadedcomments.push(S),sr(v,-1,"../threadedComments/threadedComment"+u+"."+r,Bt.TCMNT)),S="xl/comments"+u+"."+r,Mt(o,S,yE(b)),n.comments.push(S),sr(v,-1,"../comments"+u+"."+r,Bt.CMNT),w=!0}p["!legacy"]&&w&&Mt(o,"xl/drawings/vmlDrawing"+u+".vml",pE(u,p["!comments"])),delete p["!comments"],delete p["!legacy"]}v["!id"].rId1&&Mt(o,Du(l),Vl(v))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Mt(o,l,iE(t.Strings,t)),n.strs.push(l),sr(t.wbrels,-1,"sharedStrings."+r,Bt.SST)),l="xl/workbook."+r,Mt(o,l,IE(e)),n.workbooks.push(l),sr(t.rels,1,l,Bt.WB),l="xl/theme/theme1.xml",Mt(o,l,Mg(e.Themes,t)),n.themes.push(l),sr(t.wbrels,-1,"theme/theme1.xml",Bt.THEME),l="xl/styles."+r,Mt(o,l,mE(e,t)),n.styles.push(l),sr(t.wbrels,-1,"styles."+r,Bt.STY),e.vbaraw&&a&&(l="xl/vbaProject.bin",Mt(o,l,e.vbaraw),n.vba.push(l),sr(t.wbrels,-1,"vbaProject.bin",Bt.VBA)),l="xl/metadata."+r,Mt(o,l,vE()),n.metadata.push(l),sr(t.wbrels,-1,"metadata."+r,Bt.XLMETA),g.length>1&&(l="xl/persons/person.xml",Mt(o,l,h7(g)),n.people.push(l),sr(t.wbrels,-1,"persons/person.xml",Bt.PEOPLE)),Mt(o,"[Content_Types].xml",FS(n,t)),Mt(o,"_rels/.rels",Vl(t.rels)),Mt(o,"xl/_rels/workbook."+r+".rels",Vl(t.wbrels)),delete t.revssf,delete t.ssf,o}function $g(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=vn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function sH(e,t){return mt.find(e,"EncryptedPackage")?tH(e,t):UE(e,t)}function iH(e,t){var r,a=e,n=t||{};return n.type||(n.type=Pt&&Buffer.isBuffer(e)?"buffer":"base64"),r=lS(a,n),eH(r,n)}function YE(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return N1(e.slice(r),t);default:break e}return ql.to_workbook(e,t)}function oH(e,t){var r="",a=$g(e,t);switch(t.type){case"base64":r=vn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=To(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=mr(r)),t.type="binary",YE(r,t)}function lH(e,t){var r=e;return t.type=="base64"&&(r=vn(r)),r=Eu.utils.decode(1200,r.slice(2),"str"),t.type="binary",YE(r,t)}function cH(e){return e.match(/[^\x00-\x7F]/)?ps(e):e}function Jm(e,t,r,a){return a?(r.type="string",ql.to_workbook(e,r)):ql.to_workbook(t,r)}function G0(e,t){cg();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return G0(new Uint8Array(e),(r=Cr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),$l={},r.dateNF&&($l.dateNF=r.dateNF),r.type||(r.type=Pt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Pt?"buffer":"binary",a=aM(e),typeof Uint8Array<"u"&&!Pt&&(r.type="array")),r.type=="string"&&(o=!0,r.type="binary",r.codepage=65001,a=cH(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return r=Cr(r),r.type="array",G0(ug(a),r)}switch((n=$g(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return sH(mt.read(a,r),r);break;case 9:if(n[1]<=8)return UE(a,r);break;case 60:return N1(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return mP(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return nE.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?iH(a,r):Jm(e,a,r,o);case 239:return n[3]===60?N1(a,r):Jm(e,a,r,o);case 255:if(n[1]===254)return lH(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return bo.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return bo.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return C1.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return fE.to_workbook(a,r);break;case 10:case 13:case 32:return oH(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return hP.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?C1.to_workbook(a,r):Jm(e,a,r,o)}function XE(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Wu(t.file,mt.write(e,{type:Pt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return mt.write(e,t)}function uH(e,t){var r=Cr(t||{}),a=rH(e,r);return fH(a,r)}function fH(e,t){var r={},a=Pt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?mt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(sd(n))}return t.password&&typeof encrypt_agile<"u"?XE(encrypt_agile(n,t.password),t):t.type==="file"?Wu(t.file,n):t.type=="string"?mr(n):n}function dH(e,t){var r=t||{},a=cV(e,r);return XE(a,r)}function ds(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return Tu(ps(a));case"binary":return ps(a);case"string":return e;case"file":return Wu(t.file,a,"utf8");case"buffer":return Pt?Xs(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):ds(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function hH(e,t){switch(t.type){case"base64":return Tu(e);case"binary":return e;case"string":return e;case"file":return Wu(t.file,e,"binary");case"buffer":return Pt?Xs(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function k0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?Tu(r):t.type=="string"?mr(r):r;case"file":return Wu(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function KE(e,t){cg(),sz(e);var r=Cr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=KE(e,r);return r.type="array",sd(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ds(rV(e,r),r);case"slk":case"sylk":return ds(aE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return ds(VE(e.Sheets[e.SheetNames[n]],r),r);case"txt":return hH(JE(e.Sheets[e.SheetNames[n]],r),r);case"csv":return ds(Wg(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return ds(nE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return k0(C1.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return ds(ql.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return ds(fE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return ds(sE.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return ds(GE(e,r),r);case"wk1":return k0(bo.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return k0(bo.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),k0(zE(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),dH(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return uH(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function mH(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function gH(e,t,r){var a={};return a.type="file",a.file=t,mH(a),KE(e,a)}function xH(e,t,r,a,n,o,l,u){var f=qr(r),h=u.defval,g=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,p=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!l||e[r])for(var _=t.s.c;_<=t.e.c;++_){var b=l?e[r][_]:e[a[_]+f];if(b===void 0||b.t===void 0){if(h===void 0)continue;o[_]!=null&&(p[o[_]]=h);continue}var w=b.v;switch(b.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(o[_]!=null){if(w==null)if(b.t=="e"&&w===null)p[o[_]]=null;else if(h!==void 0)p[o[_]]=h;else if(g&&w===null)p[o[_]]=null;else continue;else p[o[_]]=g&&(b.t!=="n"||b.t==="n"&&u.rawNumbers!==!1)?w:qs(b,w,u);w!=null&&(v=!1)}}return{row:p,isempty:v}}function q0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,o=[],l=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},g=h.range!=null?h.range:e["!ref"];switch(h.header===1?a=1:h.header==="A"?a=2:Array.isArray(h.header)?a=3:h.header==null&&(a=0),typeof g){case"string":f=Xt(g);break;case"number":f=Xt(e["!ref"]),f.s.r=g;break;default:f=g}a>0&&(n=0);var v=qr(f.s.r),p=[],_=[],b=0,w=0,S=Array.isArray(e),T=f.s.r,N=0,k={};S&&!e[T]&&(e[T]=[]);var E=h.skipHidden&&e["!cols"]||[],M=h.skipHidden&&e["!rows"]||[];for(N=f.s.c;N<=f.e.c;++N)if(!(E[N]||{}).hidden)switch(p[N]=jr(N),r=S?e[T][N]:e[p[N]+v],a){case 1:o[N]=N-f.s.c;break;case 2:o[N]=p[N];break;case 3:o[N]=h.header[N-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=l=qs(r,null,h),w=k[l]||0,!w)k[l]=1;else{do u=l+"_"+w++;while(k[u]);k[l]=w,k[u]=1}o[N]=u}for(T=f.s.r+n;T<=f.e.r;++T)if(!(M[T]||{}).hidden){var D=xH(e,f,T,p,a,o,S,h);(D.isempty===!1||(a===1?h.blankrows!==!1:h.blankrows))&&(_[b++]=D.row)}return _.length=b,_}var Bw=/"/g;function vH(e,t,r,a,n,o,l,u){for(var f=!0,h=[],g="",v=qr(r),p=t.s.c;p<=t.e.c;++p)if(a[p]){var _=u.dense?(e[r]||[])[p]:e[a[p]+v];if(_==null)g="";else if(_.v!=null){f=!1,g=""+(u.rawNumbers&&_.t=="n"?_.v:qs(_,null,u));for(var b=0,w=0;b!==g.length;++b)if((w=g.charCodeAt(b))===n||w===o||w===34||u.forceQuotes){g='"'+g.replace(Bw,'""')+'"';break}g=="ID"&&(g='"ID"')}else _.f!=null&&!_.F?(f=!1,g="="+_.f,g.indexOf(",")>=0&&(g='"'+g.replace(Bw,'""')+'"')):g="";h.push(g)}return u.blankrows===!1&&f?null:h.join(l)}function Wg(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=Xt(e["!ref"]),o=a.FS!==void 0?a.FS:",",l=o.charCodeAt(0),u=a.RS!==void 0?a.RS:`
`,f=u.charCodeAt(0),h=new RegExp((o=="|"?"\\|":o)+"+$"),g="",v=[];a.dense=Array.isArray(e);for(var p=a.skipHidden&&e["!cols"]||[],_=a.skipHidden&&e["!rows"]||[],b=n.s.c;b<=n.e.c;++b)(p[b]||{}).hidden||(v[b]=jr(b));for(var w=0,S=n.s.r;S<=n.e.r;++S)(_[S]||{}).hidden||(g=vH(e,n,S,v,l,f,o,a),g!=null&&(a.strip&&(g=g.replace(h,"")),(g||a.blankrows!==!1)&&r.push((w++?u:"")+g)));return delete a.dense,r.join("")}function JE(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Wg(e,t);return r}function pH(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=Xt(e["!ref"]),o="",l=[],u,f=[],h=Array.isArray(e);for(u=n.s.c;u<=n.e.c;++u)l[u]=jr(u);for(var g=n.s.r;g<=n.e.r;++g)for(o=qr(g),u=n.s.c;u<=n.e.c;++u)if(t=l[u]+o,r=h?(e[g]||[])[u]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}f[f.length]=t+"="+a}return f}function QE(e,t,r){var a=r||{},n=+!a.skipHeader,o=e||{},l=0,u=0;if(o&&a.origin!=null)if(typeof a.origin=="number")l=a.origin;else{var f=typeof a.origin=="string"?Ir(a.origin):a.origin;l=f.r,u=f.c}var h,g={s:{c:0,r:0},e:{c:u,r:l+t.length-1+n}};if(o["!ref"]){var v=Xt(o["!ref"]);g.e.c=Math.max(g.e.c,v.e.c),g.e.r=Math.max(g.e.r,v.e.r),l==-1&&(l=v.e.r+1,g.e.r=l+t.length-1+n)}else l==-1&&(l=0,g.e.r=t.length-1+n);var p=a.header||[],_=0;t.forEach(function(w,S){Vr(w).forEach(function(T){(_=p.indexOf(T))==-1&&(p[_=p.length]=T);var N=w[T],k="z",E="",M=bt({c:u+_,r:l+S+n});h=Pu(o,M),N&&typeof N=="object"&&!(N instanceof Date)?o[M]=N:(typeof N=="number"?k="n":typeof N=="boolean"?k="b":typeof N=="string"?k="s":N instanceof Date?(k="d",a.cellDates||(k="n",N=la(N)),E=a.dateNF||wt[14]):N===null&&a.nullError&&(k="e",N=0),h?(h.t=k,h.v=N,delete h.w,delete h.R,E&&(h.z=E)):o[M]=h={t:k,v:N},E&&(h.z=E))})}),g.e.c=Math.max(g.e.c,u+p.length-1);var b=qr(l);if(n)for(_=0;_<p.length;++_)o[jr(_+u)+b]={t:"s",v:p[_]};return o["!ref"]=Rt(g),o}function yH(e,t){return QE(null,e,t)}function Pu(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=Ir(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Pu(e,bt(t)):Pu(e,bt({r:t,c:r||0}))}function _H(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Gg(){return{SheetNames:[],Sheets:{}}}function qg(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);n=o&&+o[2]||0;var l=o&&o[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=l+n)!=-1;++n);}if(jE(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function wH(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=_H(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function bH(e,t){return e.z=t,e}function ZE(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function SH(e,t,r){return ZE(e,"#"+t,r)}function EH(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function TH(e,t,r,a){for(var n=typeof t!="string"?t:Xt(t),o=typeof t=="string"?t:Rt(t),l=n.s.r;l<=n.e.r;++l)for(var u=n.s.c;u<=n.e.c;++u){var f=Pu(e,l,u);f.t="n",f.F=o,delete f.v,l==n.s.r&&u==n.s.c&&(f.f=r,a&&(f.D=!0))}return e}var gu={encode_col:jr,encode_row:qr,encode_cell:bt,encode_range:Rt,decode_col:bg,decode_row:wg,split_cell:jM,decode_cell:Ir,decode_range:Ja,format_cell:qs,sheet_add_aoa:kS,sheet_add_json:QE,sheet_add_dom:HE,aoa_to_sheet:Zl,json_to_sheet:yH,table_to_sheet:$E,table_to_book:OV,sheet_to_csv:Wg,sheet_to_txt:JE,sheet_to_json:q0,sheet_to_html:VE,sheet_to_formulae:pH,sheet_to_row_object_array:q0,sheet_get_cell:Pu,book_new:Gg,book_append_sheet:qg,book_set_sheet_visibility:wH,cell_set_number_format:bH,cell_set_hyperlink:ZE,cell_set_internal_link:SH,cell_add_comment:EH,sheet_set_array_formula:TH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Al={"PENDENTE VALIDAO":1,VALIDADA:2,LANADA:3,"TRATATIVA DE ANULAO":4,"ANULADA/CANCELADA":5};function kH(){const{filters:e}=Bu(),{user:t}=jn(),[r,a]=K.useState([]),[n,o]=K.useState([]),[l,u]=K.useState(!0),[f,h]=K.useState(1),[g,v]=K.useState(null),[p,_]=K.useState(null),b=100;K.useEffect(()=>{w(),v(null),_(null),h(1)},[e]);const w=async()=>{u(!0);const E=(t==null?void 0:t.role)==="VENDEDOR"?t.vendedor:null;let M=ot.from("devolucoes").select(`
        *,
        itens:itens_devolucao(*),
        setores(nome),
        motivos_devolucao(nome, setores:setores(nome))
      `);t&&t.role==="VENDEDOR"&&E&&(M=M.eq("vendedor",E),console.log(" Reports - Filtrando por vendedor:",E));const D=e.period&&!e.startDate&&!e.endDate?ig(e.period):{},A=e.startDate||D.startDate,B=e.endDate||D.endDate;e.search&&(M=M.or(`nome_cliente.ilike.%${e.search}%,vendedor.ilike.%${e.search}%,numero.ilike.%${e.search}%`)),e.resultado&&e.resultado.length>0&&(M=M.in("resultado",e.resultado)),e.motivo&&e.motivo.length>0&&(M=M.in("motivo_id",e.motivo)),e.cliente&&e.cliente.length>0&&(M=M.in("nome_cliente",e.cliente)),e.vendedor&&e.vendedor.length>0&&(M=M.in("vendedor",e.vendedor)),e.setor&&e.setor.length>0&&(M=M.in("setor_id",e.setor)),A&&(M=M.gte("data_emissao",A.toISOString().split("T")[0])),B&&(M=M.lte("data_emissao",B.toISOString().split("T")[0]));const{data:j,error:ee}=await M;if(ee)console.error(ee),Ke.error("Erro ao carregar dados do relatrio");else if(j){const U=j.map(I=>{var ne,ie,q;return{...I,setor_nome:typeof I.setores=="object"&&((ne=I.setores)!=null&&ne.nome)?I.setores.nome:typeof I.setores=="string"?I.setores:"-",motivo_nome:typeof I.motivos_devolucao=="object"&&((ie=I.motivos_devolucao)!=null&&ie.nome)?I.motivos_devolucao.nome:typeof I.motivos_devolucao=="string"?I.motivos_devolucao:"-",itens_count:((q=I.itens)==null?void 0:q.length)||0}}).sort((I,ne)=>{const ie=Al[I.resultado]||999,q=Al[ne.resultado]||999;if(ie!==q)return ie-q;const ae=I.data_emissao?new Date(I.data_emissao).getTime():0;return(ne.data_emissao?new Date(ne.data_emissao).getTime():0)-ae});o(U)}u(!1)},S=()=>{try{const E=new s2("p","mm","a4"),M=E.internal.pageSize.getWidth(),D=E.internal.pageSize.getHeight();let A=20;const B=[7,62,41],j=[10,80,55],ee=[7,62,41],re=[251,191,36],U=[239,68,68],I=[220,252,231],ne=[7,62,41],ie={nfPendentes:n.filter(Z=>Z.resultado==="PENDENTE VALIDAO").length,totalPendente:n.filter(Z=>Z.resultado==="PENDENTE VALIDAO").reduce((Z,le)=>Z+(Number(le.valor_total_nota)||0),0),nfCancelamento:n.filter(Z=>Z.resultado==="TRATATIVA DE ANULAO").length,totalCancelamento:n.filter(Z=>Z.resultado==="TRATATIVA DE ANULAO").reduce((Z,le)=>Z+(Number(le.valor_total_nota)||0),0),nfAtraso:n.filter(Z=>Z.prazo==="EM ATRASO").length,totalAtraso:n.filter(Z=>Z.prazo==="EM ATRASO").reduce((Z,le)=>Z+(Number(le.valor_total_nota)||0),0)};E.setFillColor(B[0],B[1],B[2]),E.rect(0,0,M,45,"F");try{const Z=new Image;Z.src="/logo.png",E.addImage(Z,"PNG",15,8,25,25)}catch{E.setFillColor(255,255,255),E.rect(15,8,12,12,"F"),E.setFillColor(j[0],j[1],j[2]),E.rect(15.5,8.5,11,11,"F"),E.setTextColor(255,255,255),E.setFontSize(10),E.setFont("helvetica","bold"),E.text("DM",19,16)}E.setFontSize(22),E.setFont("helvetica","bold"),E.setTextColor(255,255,255),E.text("Gesto de Devolues",45,18),E.setFontSize(10),E.setFont("helvetica","normal"),E.setTextColor(255,255,255),E.text("Grupo Doce Mel",45,28),E.text(`Relatrio Gerado em: ${ir(new Date,"dd/MM/yyyy HH:mm",{locale:da})}`,15,38);const q=e.startDate&&e.endDate?`${ir(e.startDate,"dd/MM/yyyy",{locale:da})} a ${ir(e.endDate,"dd/MM/yyyy",{locale:da})}`:e.period||"Perodo no especificado";E.text(`Perodo: ${q}`,M-15,20,{align:"right"}),E.text("Filial: Todas",M-15,30,{align:"right"}),A=55,E.setTextColor(j[0],j[1],j[2]),E.setFontSize(14),E.setFont("helvetica","bold"),E.text("Resumo Executivo",15,A),A+=10;const ae=(M-45)/3,be=25;let z=15,fe=A;E.setFillColor(I[0],I[1],I[2]),E.setDrawColor(ne[0],ne[1],ne[2]),E.setLineWidth(.5),E.rect(z,fe,ae,be,"FD"),E.setFontSize(10),E.setFont("helvetica","bold"),E.setTextColor(j[0],j[1],j[2]),E.text("NF Pendentes",z+5,fe+8),E.setFontSize(16),E.setTextColor(U[0],U[1],U[2]),E.text(ie.nfPendentes.toString(),z+5,fe+18),E.setFontSize(8),E.setTextColor(100,100,100),E.text(`R$ ${ie.totalPendente.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,z+5,fe+23),z+=ae+7.5,E.setFillColor(I[0],I[1],I[2]),E.setDrawColor(ne[0],ne[1],ne[2]),E.setLineWidth(.5),E.rect(z,fe,ae,be,"FD"),E.setFontSize(10),E.setFont("helvetica","bold"),E.setTextColor(j[0],j[1],j[2]),E.text("NF Cancelamento",z+5,fe+8),E.setFontSize(16),E.setTextColor(re[0],re[1],re[2]),E.text(ie.nfCancelamento.toString(),z+5,fe+18),E.setFontSize(8),E.setTextColor(100,100,100),E.text(`R$ ${ie.totalCancelamento.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,z+5,fe+23),z+=ae+7.5,E.setFillColor(I[0],I[1],I[2]),E.setDrawColor(ne[0],ne[1],ne[2]),E.setLineWidth(.5),E.rect(z,fe,ae,be,"FD"),E.setFontSize(10),E.setFont("helvetica","bold"),E.setTextColor(j[0],j[1],j[2]),E.text("NF em Atraso",z+5,fe+8),E.setFontSize(16),E.setTextColor(U[0],U[1],U[2]),E.text(ie.nfAtraso.toString(),z+5,fe+18),E.setFontSize(8),E.setTextColor(100,100,100),E.text(`R$ ${ie.totalAtraso.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,z+5,fe+23),A+=be+15,z=15,fe=A;const De=n.filter(Z=>Z.resultado==="VALIDADA").length,P=n.filter(Z=>Z.resultado==="VALIDADA").reduce((Z,le)=>Z+(Number(le.valor_total_nota)||0),0);E.setFillColor(I[0],I[1],I[2]),E.setDrawColor(ne[0],ne[1],ne[2]),E.setLineWidth(.5),E.rect(z,fe,ae,be,"FD"),E.setFontSize(10),E.setFont("helvetica","bold"),E.setTextColor(j[0],j[1],j[2]),E.text("NF Validadas",z+5,fe+8),E.setFontSize(16),E.setTextColor(ee[0],ee[1],ee[2]),E.text(De.toString(),z+5,fe+18),E.setFontSize(8),E.setTextColor(100,100,100),E.text(`R$ ${P.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,z+5,fe+23);const X=n.filter(Z=>Z.resultado==="LANADA").length,Y=n.filter(Z=>Z.resultado==="LANADA").reduce((Z,le)=>Z+(Number(le.valor_total_nota)||0),0);z+=ae+7.5,E.setFillColor(I[0],I[1],I[2]),E.setDrawColor(ne[0],ne[1],ne[2]),E.setLineWidth(.5),E.rect(z,fe,ae,be,"FD"),E.setFontSize(10),E.setFont("helvetica","bold"),E.setTextColor(j[0],j[1],j[2]),E.text("NF Lanadas",z+5,fe+8),E.setFontSize(16),E.setTextColor(ee[0],ee[1],ee[2]),E.text(X.toString(),z+5,fe+18),E.setFontSize(8),E.setTextColor(100,100,100),E.text(`R$ ${Y.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,z+5,fe+23);const Q=n.reduce((Z,le)=>Z+(Number(le.valor_total_nota)||0),0);z+=ae+7.5,E.setFillColor(I[0],I[1],I[2]),E.setDrawColor(ne[0],ne[1],ne[2]),E.setLineWidth(.5),E.rect(z,fe,ae,be,"FD"),E.setFontSize(10),E.setFont("helvetica","bold"),E.setTextColor(j[0],j[1],j[2]),E.text("Total Geral",z+5,fe+8),E.setFontSize(16),E.setTextColor(B[0],B[1],B[2]),E.text(n.length.toString(),z+5,fe+18),E.setFontSize(8),E.setTextColor(100,100,100),E.text(`R$ ${Q.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,z+5,fe+23),A+=be+20,E.setTextColor(j[0],j[1],j[2]),E.setFontSize(12),E.setFont("helvetica","bold");const de=n.filter(Z=>Z.resultado==="PENDENTE VALIDAO");if(de.length>0){E.text("1. Lista de Pendentes",15,A),A+=5;const Z=de.map(le=>[le.numero||"-",le.vendedor||"-",(le.nome_cliente||"-").substring(0,30),le.data_emissao?ir(new Date(le.data_emissao),"dd/MM/yyyy",{locale:da}):"-",`R$ ${(Number(le.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,le.prazo||"-",le.dias!==null&&le.dias!==void 0?le.dias.toString():"-",le.resultado||"-"]);Ni(E,{head:[["NF","Vendedor","Cliente","Data Emisso","Valor","Prazo","Dias","Resultado"]],body:Z,startY:A,styles:{fontSize:7,cellPadding:2},headStyles:{fillColor:[B[0],B[1],B[2]],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:15,right:15}}),A=E.lastAutoTable.finalY+10}A>D-50&&(E.addPage(),A=20);const Fe=n.filter(Z=>Z.resultado==="TRATATIVA DE ANULAO");if(Fe.length>0){E.text("2. Lista em Tratativas",15,A),A+=5;const Z=Fe.map(le=>[le.numero||"-",le.vendedor||"-",(le.nome_cliente||"-").substring(0,30),le.data_emissao?ir(new Date(le.data_emissao),"dd/MM/yyyy",{locale:da}):"-",`R$ ${(Number(le.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,le.prazo||"-",le.dias!==null&&le.dias!==void 0?le.dias.toString():"-",le.resultado||"-"]);Ni(E,{head:[["NF","Vendedor","Cliente","Data Emisso","Valor","Prazo","Dias","Resultado"]],body:Z,startY:A,styles:{fontSize:7,cellPadding:2},headStyles:{fillColor:[re[0],re[1],re[2]],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[255,250,240]},margin:{left:15,right:15}}),A=E.lastAutoTable.finalY+10}A>D-50&&(E.addPage(),A=20);const Te=n.filter(Z=>Z.resultado==="VALIDADA");if(Te.length>0){E.text("3. Lista Validadas",15,A),A+=5;const Z=Te.map(le=>[le.numero||"-",le.vendedor||"-",(le.nome_cliente||"-").substring(0,30),le.data_emissao?ir(new Date(le.data_emissao),"dd/MM/yyyy",{locale:da}):"-",`R$ ${(Number(le.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,le.prazo||"-",le.dias!==null&&le.dias!==void 0?le.dias.toString():"-",le.resultado||"-"]);Ni(E,{head:[["NF","Vendedor","Cliente","Data Emisso","Valor","Prazo","Dias","Resultado"]],body:Z,startY:A,styles:{fontSize:7,cellPadding:2},headStyles:{fillColor:[ee[0],ee[1],ee[2]],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[240,255,240]},margin:{left:15,right:15}}),A=E.lastAutoTable.finalY+10}A>D-50&&(E.addPage(),A=20),E.text("4. Lista Completa com Produtos",15,A),A+=5;const Oe=[];n.forEach(Z=>{Z.itens&&Z.itens.length>0?Z.itens.forEach(le=>{Oe.push([Z.numero||"-",Z.vendedor||"-",(Z.nome_cliente||"-").substring(0,25),(le.descricao||"-").substring(0,30),le.unidade||"-",le.quantidade?le.quantidade.toString():"-",`R$ ${(Number(le.valor_total_bruto)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`])}):Oe.push([Z.numero||"-",Z.vendedor||"-",(Z.nome_cliente||"-").substring(0,25),"Sem itens","-","-",`R$ ${(Number(Z.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`])}),Ni(E,{head:[["NF","Vendedor","Cliente","Produto","Unidade","Quantidade","Valor"]],body:Oe.slice(0,50),startY:A,styles:{fontSize:6,cellPadding:1.5},headStyles:{fillColor:[j[0],j[1],j[2]],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[250,250,250]},margin:{left:15,right:15}}),A=E.lastAutoTable.finalY+10,A>D-60&&(E.addPage(),A=20),E.setFillColor(B[0],B[1],B[2]),E.rect(0,A-5,M,8,"F"),E.setTextColor(255,255,255),E.setFontSize(14),E.setFont("helvetica","bold"),E.text("Inteligncia e Anlises",15,A+3),A+=15,E.setTextColor(j[0],j[1],j[2]),E.setFontSize(10),E.setFont("helvetica","bold");const Re=n.reduce((Z,le)=>{const Ge=le.nome_cliente||"Desconhecido";return Z[Ge]=(Z[Ge]||0)+1,Z},{}),Je=Object.entries(Re).sort(([,Z],[,le])=>le-Z).slice(0,5).map(([Z,le])=>`${Z}: ${le} devoluo(es)`);E.text("Clientes com Maior Recorrncia:",15,A),A+=6,E.setFont("helvetica","normal"),E.setFontSize(9),Je.forEach((Z,le)=>{E.text(`${le+1}. ${Z}`,20,A),A+=5}),A+=5,E.setFont("helvetica","bold"),E.setFontSize(10),E.text("Alertas e Recomendaes:",15,A),A+=6,E.setFont("helvetica","normal"),E.setFontSize(9);const H=[];if(ie.nfAtraso>0&&H.push(` ${ie.nfAtraso} nota(s) fiscal(is) em atraso requerem ateno imediata`),ie.nfPendentes>10&&H.push(` Alto volume de pendncias (${ie.nfPendentes}) - considere revisar processos`),ie.totalCancelamento>Q*.1&&H.push(" Taxa de cancelamento acima de 10% - investigar causas"),n.length>0){const Z=n.filter(le=>le.dias!==null&&le.dias!==void 0).reduce((le,Ge)=>le+(Ge.dias||0),0)/n.filter(le=>le.dias!==null&&le.dias!==void 0).length;Z>30&&H.push(` Tempo mdio de processamento alto (${Z.toFixed(1)} dias)`)}H.length===0&&H.push(" Nenhum alerta crtico identificado"),H.forEach(Z=>{E.text(Z,20,A),A+=5}),A+=5,E.setFont("helvetica","bold"),E.setFontSize(10),E.text("Tendncias:",15,A),A+=6,E.setFont("helvetica","normal"),E.setFontSize(9);const O=n.length>0?(Te.length/n.length*100).toFixed(1):"0",Ae=n.length>0?(ie.nfCancelamento/n.length*100).toFixed(1):"0";E.text(`Taxa de Validao: ${O}%`,20,A),A+=5,E.text(`Taxa de Cancelamento: ${Ae}%`,20,A),A+=5,E.text(`Total Processado: ${n.length} nota(s) fiscal(is)`,20,A);const Pe=E.getNumberOfPages();for(let Z=1;Z<=Pe;Z++)E.setPage(Z),E.setFontSize(8),E.setTextColor(150,150,150),E.text(`Pgina ${Z} de ${Pe} - Sistema de Devolues`,M/2,D-10,{align:"center"});const Se=`Relatorio_Devolucoes_${ir(new Date,"yyyy-MM-dd_HH-mm-ss",{locale:da})}.pdf`;E.save(Se),Ke.success("PDF gerado com sucesso!")}catch(E){console.error("Erro ao gerar PDF:",E),Ke.error("Erro ao gerar PDF: "+E.message)}};K.useEffect(()=>{if(n.length===0)return;let E=[...n];g&&p?E=[...n].sort((A,B)=>{let j,ee;switch(g){case"data_emissao":j=A.data_emissao?new Date(A.data_emissao).getTime():0,ee=B.data_emissao?new Date(B.data_emissao).getTime():0;break;case"numero":j=A.numero||"",ee=B.numero||"";break;case"nome_cliente":j=(A.nome_cliente||"").toLowerCase(),ee=(B.nome_cliente||"").toLowerCase();break;case"cidade_origem":j=(A.cidade_origem||"").toLowerCase(),ee=(B.cidade_origem||"").toLowerCase();break;case"vendedor":j=(A.vendedor||"").toLowerCase(),ee=(B.vendedor||"").toLowerCase();break;case"motivo_nome":j=(A.motivo_nome||"").toLowerCase(),ee=(B.motivo_nome||"").toLowerCase();break;case"valor_total_nota":j=parseFloat(A.valor_total_nota||0),ee=parseFloat(B.valor_total_nota||0);break;case"dias":j=A.dias!==null&&A.dias!==void 0?A.dias:-1,ee=B.dias!==null&&B.dias!==void 0?B.dias:-1;break;case"prazo":j=(A.prazo||"").toLowerCase(),ee=(B.prazo||"").toLowerCase();break;case"resultado":j=Al[A.resultado]||999,ee=Al[B.resultado]||999;break;default:return 0}return j<ee?p==="asc"?-1:1:j>ee?p==="asc"?1:-1:0}):E=[...n].sort((A,B)=>{const j=Al[A.resultado]||999,ee=Al[B.resultado]||999;if(j!==ee)return j-ee;const re=A.data_emissao?new Date(A.data_emissao).getTime():0;return(B.data_emissao?new Date(B.data_emissao).getTime():0)-re});const M=(f-1)*b,D=M+b;a(E.slice(M,D))},[g,p,n,f]);const T=E=>{g===E?p==="asc"?_("desc"):p==="desc"&&(v(null),_(null)):(v(E),_("asc")),h(1)},N=({field:E})=>g!==E?m.jsx(x2,{className:"ml-1 h-4 w-4 opacity-50"}):p==="asc"?m.jsx(v2,{className:"ml-1 h-4 w-4"}):m.jsx(g2,{className:"ml-1 h-4 w-4"}),k=()=>{if(r.length===0){Ke.warning("Sem dados para exportar");return}const E=n.map(A=>({"Data Emisso":A.data_emissao?ir(new Date(A.data_emissao),"dd/MM/yyyy"):"","Nota Fiscal":A.numero,Cliente:A.nome_cliente,CNPJ:A.cnpj_destinatario,Vendedor:A.vendedor,Cidade:A.cidade_origem,UF:A.uf_origem,Setor:A.setor_nome,Motivo:A.motivo_nome,Dias:A.dias!==null&&A.dias!==void 0?A.dias:"-",Prazo:A.prazo||"-",Status:A.resultado||"PENDENTE VALIDAO","Valor Total":A.valor_total_nota,"Qtd Itens":A.itens_count})),M=gu.json_to_sheet(E),D=gu.book_new();gu.book_append_sheet(D,M,"Relatrio Devolues"),gH(D,`Relatorio_Devolucoes_${ir(new Date,"yyyy-MM-dd")}.xlsx`),Ke.success("Relatrio Excel gerado com sucesso!")};return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Relatrios"}),m.jsxs("div",{className:"flex gap-2",children:[m.jsxs(Dt,{variant:"outline",onClick:k,children:[m.jsx(cN,{className:"mr-2 h-4 w-4 text-green-600"}),"Exportar Excel"]}),m.jsxs(Dt,{variant:"outline",onClick:S,children:[m.jsx(w2,{className:"mr-2 h-4 w-4"}),"Gerar PDF"]})]})]}),m.jsx(nd,{}),m.jsxs(Vt,{children:[m.jsx(Ht,{children:m.jsx($t,{children:"Detalhamento de Devolues"})}),m.jsx(Wt,{children:l?m.jsx("div",{className:"flex justify-center py-10",children:m.jsx(Do,{className:"h-8 w-8 animate-spin text-primary"})}):m.jsx("div",{className:"rounded-md border overflow-x-auto",children:m.jsxs(Jn,{children:[m.jsx(vs,{children:m.jsxs(Tr,{children:[m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>T("data_emissao"),children:m.jsxs("div",{className:"flex items-center",children:["Data Emisso",m.jsx(N,{field:"data_emissao"})]})}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>T("numero"),children:m.jsxs("div",{className:"flex items-center",children:["Nota Fiscal",m.jsx(N,{field:"numero"})]})}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>T("nome_cliente"),children:m.jsxs("div",{className:"flex items-center",children:["Cliente",m.jsx(N,{field:"nome_cliente"})]})}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>T("vendedor"),children:m.jsxs("div",{className:"flex items-center",children:["Vendedor",m.jsx(N,{field:"vendedor"})]})}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>T("motivo"),children:m.jsxs("div",{className:"flex items-center",children:["Motivo",m.jsx(N,{field:"motivo"})]})}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>T("cidade_origem"),children:m.jsxs("div",{className:"flex items-center",children:["Origem",m.jsx(N,{field:"cidade_origem"})]})}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>T("dias"),children:m.jsxs("div",{className:"flex items-center",children:["Dias",m.jsx(N,{field:"dias"})]})}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>T("prazo"),children:m.jsxs("div",{className:"flex items-center",children:["Prazo",m.jsx(N,{field:"prazo"})]})}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>T("resultado"),children:m.jsxs("div",{className:"flex items-center",children:["Resultado",m.jsx(N,{field:"resultado"})]})}),m.jsx(gt,{className:"text-right cursor-pointer hover:bg-muted/50",onClick:()=>T("valor_total_nota"),children:m.jsxs("div",{className:"flex items-center justify-end",children:["Valor Total",m.jsx(N,{field:"valor_total_nota"})]})})]})}),m.jsxs(Qn,{children:[r.map(E=>m.jsxs(Tr,{children:[m.jsx(At,{children:E.data_emissao?ir(new Date(E.data_emissao),"dd/MM/yyyy"):"-"}),m.jsx(At,{children:E.numero}),m.jsx(At,{className:"max-w-[200px] truncate",title:E.nome_cliente,children:E.nome_cliente}),m.jsx(At,{className:"max-w-[150px] truncate",children:E.vendedor}),m.jsx(At,{className:"max-w-[200px] truncate",title:E.motivo_nome,children:E.motivo_nome||"-"}),m.jsxs(At,{children:[E.cidade_origem,"/",E.uf_origem]}),m.jsx(At,{className:"text-center",children:E.dias!==null&&E.dias!==void 0?E.dias:"-"}),m.jsx(At,{children:m.jsx(ln,{className:E.prazo==="EM ATRASO"?"bg-red-500 hover:bg-red-600":E.prazo==="NO PRAZO"?"bg-green-500 hover:bg-green-600":"bg-gray-500 hover:bg-gray-600",children:E.prazo||"-"})}),m.jsx(At,{children:m.jsx(ln,{variant:E.resultado==="VALIDADA"||E.resultado==="LANADA"?"default":E.resultado==="ANULADA/CANCELADA"?"destructive":"secondary",className:"text-[10px]",children:E.resultado||"PENDENTE VALIDAO"})}),m.jsxs(At,{className:"text-right font-medium",children:["R$ ",Number(E.valor_total_nota||0).toLocaleString("pt-BR",{minimumFractionDigits:2})]})]},E.id)),r.length===0&&m.jsx(Tr,{children:m.jsx(At,{colSpan:10,className:"text-center py-8 text-muted-foreground",children:"Nenhum dado encontrado com os filtros atuais."})})]})]})})})]}),!l&&n.length>0&&m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",(f-1)*b+1," a ",Math.min(f*b,n.length)," de ",n.length," registros"]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsxs(Dt,{variant:"outline",size:"sm",onClick:()=>h(E=>Math.max(1,E-1)),disabled:f===1,children:[m.jsx(p2,{className:"h-4 w-4 mr-1"}),"Anterior"]}),m.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.ceil(n.length/b)},(E,M)=>M+1).filter(E=>{const M=Math.ceil(n.length/b);return E===1||E===M||E>=f-2&&E<=f+2}).map((E,M,D)=>{const A=D[M-1],B=A&&E-A>1;return m.jsxs("div",{className:"flex items-center gap-1",children:[B&&m.jsx("span",{className:"px-2",children:"..."}),m.jsx(Dt,{variant:f===E?"default":"outline",size:"sm",onClick:()=>h(E),className:"w-10",children:E})]},E)})}),m.jsxs(Dt,{variant:"outline",size:"sm",onClick:()=>h(E=>Math.min(Math.ceil(n.length/b),E+1)),disabled:f>=Math.ceil(n.length/b),children:["Prxima",m.jsx(y2,{className:"h-4 w-4 ml-1"})]})]})]})]})}const Uw={"CNPJ Destinatrio":{dbField:"cnpj_destinatario",visible:!1,type:"string"},Destinatrio:{dbField:"destinatario",visible:!1,type:"string"},"Cidade Destino":{dbField:"cidade_destino",visible:!1,type:"string"},"UF Destino":{dbField:"uf_destino",visible:!1,type:"string"},"CNPJ Emitente":{dbField:"cnpj_emitente",visible:!1,type:"string"},"Nome PJ Emitente":{dbField:"nome_pj_emitente",visible:!1,type:"string"},"Chave de Acesso":{dbField:"chave_acesso",visible:!1,type:"string"},Srie:{dbField:"serie",visible:!1,type:"string"},Tipo:{dbField:"tipo",visible:!1,type:"string"},Status:{dbField:"status_nfe",visible:!1,type:"string"},"Nome ou e-mail do usurio que fez a sincronizao":{dbField:"nome_usuario_sync",visible:!1,type:"string"},"Data da sincronizao":{dbField:"data_sync",visible:!1,type:"date"},"Natureza Operao":{dbField:"natureza_operacao",visible:!1,type:"string"},"CFOPs da Nota":{dbField:"cfops",visible:!1,type:"string"},Etiquetas:{dbField:"etiquetas",visible:!1,type:"string"},"Nome Filial":{dbField:"nome_filial",visible:!0,type:"string"},FILIAL:{dbField:"nome_filial",visible:!0,type:"string"},"Nome Cliente":{dbField:"nome_cliente",visible:!0,type:"string"},"Cidade Origem":{dbField:"cidade_origem",visible:!0,type:"string"},"UF Origem":{dbField:"uf_origem",visible:!0,type:"string"},"Data Emisso":{dbField:"data_emissao",visible:!0,type:"date"},Nmero:{dbField:"numero",visible:!0,type:"string"},"Valor Total da Nota":{dbField:"valor_total_nota",visible:!0,type:"number"},"Peso lquido":{dbField:"peso_liquido",visible:!0,type:"number"},"Sincronizao ERP":{dbField:"sincronizacao_erp",visible:!0,type:"string"},"Finalidade NFe":{dbField:"finalidade_nfe",visible:!0,type:"string"},"Dados Adicionais":{dbField:"dados_adicionais",visible:!0,type:"string"},Vendedor:{dbField:"vendedor",visible:!0,type:"string"},Motivo:{dbField:"motivo",visible:!0,type:"string"},Resultado:{dbField:"resultado",visible:!0,type:"string"},"[Item] Descrio":{dbField:"item_description",visible:!0,type:"string"},"[Item] Unidade":{dbField:"item_unit",visible:!0,type:"string"},"[Item] Quantidade":{dbField:"item_quantity",visible:!0,type:"number"},"[Item] Valor Unitrio":{dbField:"item_unit_value",visible:!0,type:"number"},"[Item] Valor Total Bruto":{dbField:"item_total_value",visible:!0,type:"number"},"[Item] Nmero do Item.":{dbField:"item_number",visible:!0,type:"string"}};function AH(){const[e,t]=K.useState(null),[r,a]=K.useState([]),[n,o]=K.useState(!1),l=p=>{if(p.target.files&&p.target.files[0]){const _=p.target.files[0];t(_),u(_)}},u=async p=>{const _=new FileReader;_.onload=async b=>{var S;const w=(S=b.target)==null?void 0:S.result;if(w){const T=G0(w,{type:"binary",cellDates:!0}),N=T.SheetNames[0],k=T.Sheets[N],E=gu.sheet_to_json(k),M=E.map(re=>String(re["CNPJ Emitente"]||"")).filter(re=>re&&re.trim()!=="");let D=new Map,A=new Map;const B=re=>re?re.replace(/[^\d]/g,""):"";if(M.length>0){const{data:re}=await ot.from("clientes").select("cnpj_cpf, nome, vendedor, rede, uf, municipio");re&&re.forEach(U=>{const I=B(U.cnpj_cpf||"");I&&I.length>=11&&D.set(I,U)})}const{data:j}=await ot.from("emitentes").select("cnpj, nome_fantasia");j&&j.forEach(re=>{const U=B(re.cnpj||"");if(U&&U.length>=11){const I=re.nome_fantasia||"";A.set(U,I)}});const ee=E.slice(0,10).map(re=>{const U={...re};U["Data Emisso"]instanceof Date&&(U["Data Emisso"]=U["Data Emisso"].toLocaleDateString("pt-BR"));const I=String(re["CNPJ Emitente"]||""),ne=B(I),ie=ne.length>=11?D.get(ne):null;ie?(U["Nome Cliente"]=ie.nome||"",U.Vendedor=ie.vendedor||""):(U["Nome Cliente"]="",U.Vendedor="");const q=String(re["CNPJ Destinatrio"]||""),ae=B(q);if(ae&&ae.length>=11){const be=A.get(ae);be&&be.trim()!==""?(U["Nome Filial"]=be,U.FILIAL=be):(U["Nome Filial"]="",U.FILIAL="")}else U["Nome Filial"]="",U.FILIAL="";return U});a(ee)}},_.readAsBinaryString(p)},f=p=>p?String(p).replace(/[.\-\/\s]/g,"").trim():"",h=async()=>{const p=new Map;try{const{data:_,error:b}=await ot.from("clientes").select("nome, razao_social, cnpj_cpf, vendedor, rede").not("cnpj_cpf","is",null);if(b)return console.error("Erro ao buscar clientes:",b),p;_&&_.length>0&&_.forEach(w=>{if(w.cnpj_cpf){const S=f(w.cnpj_cpf);if(S&&S.length>=11){const T=w.nome||w.razao_social||"";p.set(S,{nome:T,vendedor:w.vendedor||"",rede:w.rede||""})}}})}catch(_){console.error("Erro ao carregar clientes:",_)}return p},g=async()=>{if(e){o(!0);try{const p=new FileReader;p.onload=async _=>{var ee,re,U;const b=(ee=_.target)==null?void 0:ee.result,w=G0(b,{type:"binary",cellDates:!0}),S=w.Sheets[w.SheetNames[0]],T=gu.sheet_to_json(S),N=new Map;for(const I of T){const ne=I.Nmero;if(!ne)continue;if(!N.has(ne)){let ae=new Date().toISOString();if(I["Data Emisso"])if(I["Data Emisso"]instanceof Date)ae=I["Data Emisso"].toISOString();else{const be=new Date(I["Data Emisso"]);isNaN(be.getTime())||(ae=be.toISOString())}N.set(ne,{invoice_number:String(ne),customer_cnpj:String(I["CNPJ Destinatrio"]||""),destinatario:String(I.Destinatrio||""),cidade_origem:String(I["Cidade Origem"]||""),uf_origem:String(I["UF Origem"]||""),cidade_destino:String(I["Cidade Destino"]||""),uf_destino:String(I["UF Destino"]||""),cnpj_emitente:String(I["CNPJ Emitente"]||""),nome_pj_emitente:String(I["Nome PJ Emitente"]||""),chave_acesso:String(I["Chave de Acesso"]||""),serie:String(I.Srie||""),peso_liquido:parseFloat(I["Peso lquido"]||"0"),tipo:String(I.Tipo||""),status_nfe:String(I.Status||""),sincronizacao_erp:String(I["Sincronizao ERP"]||""),finalidade_nfe:String(I["Finalidade NFe"]||""),natureza_operacao:String(I["Natureza Operao"]||""),cfops:String(I["CFOPs da Nota"]||""),dados_adicionais:String(I["Dados Adicionais"]||""),nfe_referenciada:String(I["NFe Referenciada"]||""),etiquetas:String(I.Etiquetas||""),invoice_date:ae,total_value:0,motivo_id:null,sector_id:null,items:[]})}const ie=N.get(ne),q=parseFloat(I["[Item] Valor Total Bruto"]||"0");ie.total_value+=q,ie.items.push({description:I["[Item] Descrio"],quantity:parseFloat(I["[Item] Quantidade"]||"0"),unit:I["[Item] Unidade"],unit_value:parseFloat(I["[Item] Valor Unitrio"]||"0"),total_value:q,item_number:String(I["[Item] Nmero do Item."]||"")})}let k=0,E=0;const M=Array.from(N.values()),D=await h(),A=new Map;try{const{data:I}=await ot.from("emitentes").select("cnpj, nome_fantasia").not("cnpj","is",null);I&&I.forEach(ne=>{if(ne.cnpj){const ie=f(ne.cnpj);if(ie&&ie.length>=11){const q=ne.nome_fantasia||"";A.set(ie,q)}}})}catch(I){console.error("Erro ao carregar emitentes:",I)}const{data:B}=await ot.from("devolucoes").select("chave_acesso").not("chave_acesso","is",null),j=new Set((B||[]).map(I=>I.chave_acesso).filter(I=>I&&I.trim()!==""));for(const I of M){if(I.chave_acesso&&I.chave_acesso.trim()!==""&&j.has(I.chave_acesso)){console.log(`Chave de acesso duplicada ignorada: ${I.chave_acesso}`),E++;continue}const ne=String(I.sincronizacao_erp||"").trim().toUpperCase();if(ne==="SINCRONIZADO"||ne==="SIM"||ne==="S"){console.log(`Registro descartado - j sincronizado: ${I.invoice_number} (Chave: ${I.chave_acesso})`),E++;continue}let ie="",q="",ae="";if(I.cnpj_emitente){const De=f(I.cnpj_emitente);if(De&&De.length>=11){const P=D.get(De);P&&(ie=P.nome||"",q=P.vendedor||"",ae=P.rede||"")}}let be="";if(I.customer_cnpj){const De=f(I.customer_cnpj);if(De&&De.length>=11){const P=A.get(De);P&&P.trim()!==""&&(be=P)}}const{data:z,error:fe}=await ot.from("devolucoes").insert({numero:I.invoice_number,nome_cliente:ie,cnpj_destinatario:I.customer_cnpj,destinatario:I.destinatario,cidade_origem:I.cidade_origem,uf_origem:I.uf_origem,cidade_destino:I.cidade_destino,uf_destino:I.uf_destino,cnpj_emitente:I.cnpj_emitente,nome_pj_emitente:I.nome_pj_emitente,chave_acesso:I.chave_acesso||null,serie:I.serie,peso_liquido:I.peso_liquido||null,tipo:I.tipo,status_nfe:I.status_nfe,sincronizacao_erp:I.sincronizacao_erp,finalidade_nfe:I.finalidade_nfe,natureza_operacao:I.natureza_operacao,cfops:I.cfops,dados_adicionais:I.dados_adicionais,nfe_referenciada:I.nfe_referenciada,etiquetas:I.etiquetas,nome_filial:be,data_emissao:I.invoice_date,valor_total_nota:I.total_value,vendedor:q,rede:ae,resultado:"PENDENTE VALIDAO",motivo_id:I.reason_id,setor_id:I.sector_id}).select().single();if(fe){if(fe.code==="23505"||(re=fe.message)!=null&&re.includes("unique")||(U=fe.message)!=null&&U.includes("duplicate")){console.log(`Chave de acesso duplicada ignorada (constraint): ${I.chave_acesso}`),E++;continue}console.error("Erro ao inserir devoluo:",fe);continue}if(z){I.chave_acesso&&I.chave_acesso.trim()!==""&&j.add(I.chave_acesso);const De=I.items.map(X=>({devolucao_id:z.id,descricao:X.description,quantidade:X.quantity,unidade:X.unit,valor_unitario:X.unit_value,valor_total_bruto:X.total_value,numero_item:X.item_number})),{error:P}=await ot.from("itens_devolucao").insert(De);P||k++}}if(k>0){let I=`${k} devoluo(es) importada(s) com sucesso!`;E>0&&(I+=` ${E} registro(s) ignorado(s) (duplicados ou j sincronizados).`),Ke.success(I)}else E>0?Ke.warning(`${E} registro(s) ignorado(s) (duplicados ou j sincronizados). Nenhuma devoluo nova foi importada.`):Ke.warning("Nenhuma devoluo importada. Verifique o arquivo.");o(!1),t(null),a([])},p.readAsBinaryString(e)}catch(p){console.error(p),Ke.error("Erro crtico ao processar arquivo"),o(!1)}}},v=Object.keys(Uw).filter(p=>Uw[p].visible);return m.jsxs("div",{className:"space-y-6",children:[m.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Sincronizao"}),m.jsx("div",{className:"grid gap-6 md:grid-cols-1",children:m.jsxs(Vt,{children:[m.jsxs(Ht,{children:[m.jsx($t,{children:"Importar Arquivo"}),m.jsx(cn,{children:"Faa upload de arquivos CSV ou XLSX. O sistema identificar automaticamente os Motivos, Setores e buscar o nome do cliente na base de dados usando o CNPJ."})]}),m.jsxs(Wt,{children:[m.jsxs("div",{className:"flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-10 hover:bg-muted/50 transition-colors relative",children:[m.jsx(Gr,{type:"file",accept:".csv, .xlsx, .xls",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:l}),m.jsx(aN,{className:"h-10 w-10 text-muted-foreground mb-4"}),m.jsx("p",{className:"text-sm font-medium mb-1",children:e?e.name:"Arraste e solte ou clique para selecionar"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Suporta .csv e .xlsx"})]}),r.length>0&&m.jsxs("div",{className:"mt-6 space-y-4",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("h3",{className:"text-sm font-semibold",children:"Pr-visualizao"}),m.jsxs(Dt,{onClick:g,disabled:n,children:[n&&m.jsx(Do,{className:"mr-2 h-4 w-4 animate-spin"}),"Confirmar e Processar"]})]}),m.jsx("div",{className:"overflow-x-auto rounded-md border",children:m.jsxs(Jn,{children:[m.jsx(vs,{children:m.jsx(Tr,{children:v.map(p=>m.jsx(gt,{className:"whitespace-nowrap",children:p},p))})}),m.jsx(Qn,{children:r.map((p,_)=>m.jsx(Tr,{children:v.map(b=>m.jsx(At,{className:"whitespace-nowrap",children:p[b]},`${_}-${b}`))},_))})]})}),m.jsxs("div",{className:"flex items-center gap-2 text-xs text-amber-600 bg-amber-50 p-2 rounded border border-amber-200",children:[m.jsx(n1,{className:"h-4 w-4"}),m.jsx("span",{children:'Certifique-se de que os nomes dos "Motivos" no Excel correspondam exatamente aos cadastrados em Configuraes para que os grficos funcionem.'})]})]})]})]})})]})}const CH=y4,eT=K.forwardRef(({className:e,...t},r)=>m.jsx(v4,{ref:r,className:Ye("border-b",e),...t}));eT.displayName="AccordionItem";const tT=K.forwardRef(({className:e,children:t,...r},a)=>m.jsx(p4,{className:"flex",children:m.jsxs(Kw,{ref:a,className:Ye("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180",e),...r,children:[t,m.jsx(J0,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})}));tT.displayName=Kw.displayName;const rT=K.forwardRef(({className:e,children:t,...r},a)=>m.jsx(Jw,{ref:a,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:m.jsx("div",{className:Ye("pb-4 pt-0",e),children:t})}));rT.displayName=Jw.displayName;const R1=K.forwardRef(({className:e,...t},r)=>m.jsx("textarea",{className:Ye("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));R1.displayName="Textarea";const Qm=["PENDENTE VALIDAO","VALIDADA","LANADA","TRATATIVA DE ANULAO","ANULADA/CANCELADA"],NH={"PENDENTE VALIDAO":"bg-red-500 hover:bg-red-600 text-white",VALIDADA:"bg-blue-500 hover:bg-blue-600 text-white",LANADA:"bg-green-500 hover:bg-green-600 text-white","TRATATIVA DE ANULAO":"bg-orange-500 hover:bg-orange-600 text-white","ANULADA/CANCELADA":"bg-black hover:bg-gray-900 text-white"},Cl={"PENDENTE VALIDAO":1,VALIDADA:2,LANADA:3,"TRATATIVA DE ANULAO":4,"ANULADA/CANCELADA":5};function DH(e){const r=(Qm.indexOf(e)+1)%Qm.length;return Qm[r]}function OH(e){return e.trim().split(/\s+/).filter(t=>t.length>0).length}function RH(){const[e,t]=K.useState([]),[r,a]=K.useState([]),[n,o]=K.useState(!0),[l,u]=K.useState([]),[f,h]=K.useState([]),[g,v]=K.useState({}),[p,_]=K.useState({}),[b,w]=K.useState(1),[S,T]=K.useState(null),[N,k]=K.useState(null),[E,M]=K.useState(new Set),[D,A]=K.useState(null),[B,j]=K.useState(!1),[ee,re]=K.useState({nfPendentes:0,totalPendente:0,nfCancelamento:0,totalCancelamento:0,nfAtraso:0,totalAtraso:0}),{user:U}=jn(),{filters:I}=Bu(),ne=100;K.useEffect(()=>{ie(),q(),ae(),T(null),k(null),w(1)},[I]);const ie=async()=>{const{data:O}=await ot.from("motivos_devolucao").select("id, nome").order("nome");O&&u(O)},q=async()=>{const{data:O}=await ot.from("setores").select("id, nome").order("nome");O&&h(O)},ae=async()=>{o(!0);const O=(U==null?void 0:U.role)==="VENDEDOR"?U.vendedor:null;let Ae=ot.from("devolucoes").select(`
            *,
            itens:itens_devolucao(*, motivo_item:motivos_devolucao(id, nome)),
            setores:setores(nome),
            motivos_devolucao:motivos_devolucao(id, nome, setores:setores(nome))
        `);U&&U.role==="VENDEDOR"&&O&&(Ae=Ae.eq("vendedor",O),console.log(" Validao - Filtrando por vendedor:",O));const Pe=I.period&&!I.startDate&&!I.endDate?ig(I.period):{},Se=I.startDate||Pe.startDate,Z=I.endDate||Pe.endDate;I.search&&(Ae=Ae.or(`nome_cliente.ilike.%${I.search}%,vendedor.ilike.%${I.search}%,numero.ilike.%${I.search}%`)),I.resultado&&I.resultado.length>0&&(Ae=Ae.in("resultado",I.resultado)),I.motivo&&I.motivo.length>0&&(Ae=Ae.in("motivo_id",I.motivo)),I.cliente&&I.cliente.length>0&&(Ae=Ae.in("nome_cliente",I.cliente)),I.vendedor&&I.vendedor.length>0&&(Ae=Ae.in("vendedor",I.vendedor)),I.setor&&I.setor.length>0&&(Ae=Ae.in("setor_id",I.setor)),Se&&(Ae=Ae.gte("data_emissao",Se.toISOString().split("T")[0])),Z&&(Ae=Ae.lte("data_emissao",Z.toISOString().split("T")[0]));const{data:le,error:Ge}=await Ae.order("created_at",{ascending:!1});if(Ge)Ke.error("Erro ao carregar devolues"),console.error(Ge);else if(le){const kt=le.map(xe=>xe.cnpj_destinatario).filter(xe=>xe&&xe.trim()!=="");let nt=new Map;if(kt.length>0){const{data:xe}=await ot.from("clientes").select("cnpj_cpf, nome, vendedor, rede, uf, municipio").in("cnpj_cpf",kt);xe&&xe.forEach(ze=>{nt.set(ze.cnpj_cpf,ze)})}const Ze=le.map(xe=>{var qt,lr,Nr;const ze=nt.get(xe.cnpj_destinatario),xt=(qt=xe.itens)==null?void 0:qt.map(gr=>{var xa;return{...gr,motivo_nome:((xa=gr.motivo_item)==null?void 0:xa.nome)||"-"}});return{...xe,setor:(lr=xe.setores)==null?void 0:lr.nome,motivo:typeof xe.motivos_devolucao=="object"&&((Nr=xe.motivos_devolucao)!=null&&Nr.nome)?xe.motivos_devolucao.nome:typeof xe.motivos_devolucao=="string"?xe.motivos_devolucao:"-",motivo_id:xe.motivo_id,resultado:xe.resultado||"PENDENTE VALIDAO",itens:xt,nome_cliente:(ze==null?void 0:ze.nome)||xe.nome_cliente||"Cliente no encontrado",vendedor:(ze==null?void 0:ze.vendedor)||xe.vendedor||"-",rede:(ze==null?void 0:ze.rede)||xe.rede||"-",uf_destino:(ze==null?void 0:ze.uf)||xe.uf_destino||"-",cidade_destino:(ze==null?void 0:ze.municipio)||xe.cidade_destino||"-"}}).sort((xe,ze)=>{const xt=Cl[xe.resultado]||999,qt=Cl[ze.resultado]||999;if(xt!==qt)return xt-qt;const lr=xe.data_emissao?new Date(xe.data_emissao).getTime():0;return(ze.data_emissao?new Date(ze.data_emissao).getTime():0)-lr});a(Ze);const Ee=Ze.filter(xe=>xe.resultado==="PENDENTE VALIDAO").length,Xe=Ze.filter(xe=>xe.resultado==="PENDENTE VALIDAO").reduce((xe,ze)=>xe+(Number(ze.valor_total_nota)||0),0),Qe=Ze.filter(xe=>xe.resultado==="TRATATIVA DE ANULAO").length,et=Ze.filter(xe=>xe.resultado==="TRATATIVA DE ANULAO").reduce((xe,ze)=>xe+(Number(ze.valor_total_nota)||0),0),rt=Ze.filter(xe=>xe.prazo==="EM ATRASO").length,ke=Ze.filter(xe=>xe.prazo==="EM ATRASO").reduce((xe,ze)=>xe+(Number(ze.valor_total_nota)||0),0);re({nfPendentes:Ee,totalPendente:Xe,nfCancelamento:Qe,totalCancelamento:et,nfAtraso:rt,totalAtraso:ke});const ye={};Ze.forEach(xe=>{ye[xe.id]=xe.justificativa||""}),v(ye)}o(!1)};K.useEffect(()=>{if(r.length===0)return;let O=[...r];S&&N?O=[...r].sort((Se,Z)=>{let le,Ge;switch(S){case"data_emissao":le=Se.data_emissao?new Date(Se.data_emissao).getTime():0,Ge=Z.data_emissao?new Date(Z.data_emissao).getTime():0;break;case"numero":le=Se.numero||"",Ge=Z.numero||"";break;case"nome_cliente":le=(Se.nome_cliente||"").toLowerCase(),Ge=(Z.nome_cliente||"").toLowerCase();break;case"cidade_origem":le=(Se.cidade_origem||"").toLowerCase(),Ge=(Z.cidade_origem||"").toLowerCase();break;case"vendedor":le=(Se.vendedor||"").toLowerCase(),Ge=(Z.vendedor||"").toLowerCase();break;case"motivo":le=(Se.motivo||"").toLowerCase(),Ge=(Z.motivo||"").toLowerCase();break;case"valor_total_nota":le=parseFloat(Se.valor_total_nota||0),Ge=parseFloat(Z.valor_total_nota||0);break;case"dias":le=Se.dias!==null&&Se.dias!==void 0?Se.dias:-1,Ge=Z.dias!==null&&Z.dias!==void 0?Z.dias:-1;break;case"prazo":le=(Se.prazo||"").toLowerCase(),Ge=(Z.prazo||"").toLowerCase();break;case"resultado":le=Cl[Se.resultado]||999,Ge=Cl[Z.resultado]||999;break;default:return 0}return le<Ge?N==="asc"?-1:1:le>Ge?N==="asc"?1:-1:0}):O=[...r].sort((Se,Z)=>{const le=Cl[Se.resultado]||999,Ge=Cl[Z.resultado]||999;if(le!==Ge)return le-Ge;const kt=Se.data_emissao?new Date(Se.data_emissao).getTime():0;return(Z.data_emissao?new Date(Z.data_emissao).getTime():0)-kt});const Ae=(b-1)*ne,Pe=Ae+ne;t(O.slice(Ae,Pe))},[S,N,r,b]);const be=O=>{S===O?N==="asc"?k("desc"):N==="desc"&&(T(null),k(null)):(T(O),k("asc")),w(1)},z=({field:O})=>S!==O?m.jsx(x2,{className:"ml-1 h-4 w-4 opacity-50"}):N==="asc"?m.jsx(v2,{className:"ml-1 h-4 w-4"}):m.jsx(g2,{className:"ml-1 h-4 w-4"}),fe=async(O,Ae)=>{if(!U)return;const Se=DH(Ae);try{const{error:Z}=await ot.from("devolucoes").update({resultado:Se}).eq("id",O);if(Z)throw Z;const{error:le}=await ot.from("logs_validacao").insert({devolucao_id:O,usuario_id:U.id,acao:"ALTERAR_RESULTADO",status_anterior:Ae,status_novo:Se});le&&console.error("Erro ao salvar log:",le),Ke.success(`Resultado alterado para: ${Se}`),ae()}catch(Z){Ke.error("Erro ao processar: "+Z.message)}},De=async(O,Ae)=>{if(U)try{const{data:Pe}=await ot.from("devolucoes").select("resultado").eq("id",O).single(),Se=(Pe==null?void 0:Pe.resultado)||"PENDENTE VALIDAO",{data:Z}=await ot.from("itens_devolucao").select("id").eq("devolucao_id",O);if(Z&&Z.length>0)for(const kt of Z){const{error:nt}=await ot.from("itens_devolucao").update({motivo_id:Ae}).eq("id",kt.id);if(nt)throw console.error("Erro ao atualizar item:",nt),nt}const{error:le}=await ot.from("devolucoes").update({motivo_id:Ae,resultado:"VALIDADA"}).eq("id",O);if(le)throw le;const{error:Ge}=await ot.from("logs_validacao").insert({devolucao_id:O,usuario_id:U.id,acao:"SELECIONAR_MOTIVO",status_anterior:Se,status_novo:"VALIDADA"});Ge&&console.error("Erro ao salvar log:",Ge),Ke.success("Motivo aplicado a todos os produtos e resultado alterado para VALIDADA!"),t(kt=>kt.map(nt=>{var st;return nt.id===O?{...nt,motivo_id:Ae,resultado:"VALIDADA",itens:(st=nt.itens)==null?void 0:st.map(Ze=>({...Ze,motivo_id:Ae}))}:nt}))}catch(Pe){Ke.error("Erro ao processar: "+Pe.message)}},P=(O,Ae)=>{if(OH(Ae)>100){Ke.warning("Mximo de 100 palavras permitido");return}v(Se=>({...Se,[O]:Ae}))},X=async O=>{if(U){_(Ae=>({...Ae,[O]:!0}));try{const{error:Ae}=await ot.from("devolucoes").update({justificativa:g[O]||null}).eq("id",O);if(Ae)throw Ae;Ke.success("Comentrio salvo com sucesso!"),await ot.from("logs_validacao").insert({devolucao_id:O,usuario_id:U.id,acao:"ADICIONAR_COMENTARIO",status_anterior:null,status_novo:null})}catch(Ae){Ke.error("Erro ao salvar comentrio: "+Ae.message)}finally{_(Ae=>({...Ae,[O]:!1}))}}},Y=async(O,Ae,Pe)=>{if(U)try{const{error:Se}=await ot.from("itens_devolucao").update({motivo_id:Ae}).eq("id",O);if(Se)throw Se;const{data:Z,error:le}=await ot.from("itens_devolucao").select("id, motivo_id").eq("devolucao_id",Pe);if(le)throw le;const Ge=Z&&Z.length>0&&Z.every(kt=>kt.motivo_id);if(Ge){const kt={};let nt=null;Z.forEach(Xe=>{Xe.motivo_id&&(nt||(nt=Xe.motivo_id),kt[Xe.motivo_id]=(kt[Xe.motivo_id]||0)+1)});let st=nt,Ze=0;Object.entries(kt).forEach(([Xe,Qe])=>{Qe>Ze&&(Ze=Qe,st=Xe)});const{data:Ee}=await ot.from("devolucoes").select("resultado, motivo_id").eq("id",Pe).single();if(Ee&&st){const Xe={resultado:"VALIDADA"};(!Ee.motivo_id||Ee.motivo_id!==st)&&(Xe.motivo_id=st);const{error:Qe}=await ot.from("devolucoes").update(Xe).eq("id",Pe);if(Qe)throw console.error("Erro ao atualizar resultado e motivo:",Qe),Qe;await ot.from("logs_validacao").insert({devolucao_id:Pe,usuario_id:U.id,acao:"SELECIONAR_MOTIVO_PRODUTO",status_anterior:Ee.resultado||"PENDENTE VALIDAO",status_novo:"VALIDADA"})}}t(kt=>kt.map(nt=>{var st;if(nt.id===Pe){const Ze=(st=nt.itens)==null?void 0:st.map(ye=>ye.id===O?{...ye,motivo_id:Ae}:ye),Ee={};let Xe=null;Ze==null||Ze.forEach(ye=>{ye.motivo_id&&(Xe||(Xe=ye.motivo_id),Ee[ye.motivo_id]=(Ee[ye.motivo_id]||0)+1)});let Qe=Xe,et=0;Object.entries(Ee).forEach(([ye,xe])=>{xe>et&&(et=xe,Qe=ye)});const rt=l.find(ye=>ye.id===Qe),ke=(rt==null?void 0:rt.nome)||nt.motivo||"-";return{...nt,itens:Ze,resultado:Ge?"VALIDADA":nt.resultado,motivo_id:Ge&&Qe?Qe:nt.motivo_id,motivo:Ge&&Qe?ke:nt.motivo,motivos_devolucao:Ge&&Qe?rt:nt.motivos_devolucao}}return nt})),a(kt=>kt.map(nt=>{var st;if(nt.id===Pe){const Ze=(st=nt.itens)==null?void 0:st.map(xe=>xe.id===O?{...xe,motivo_id:Ae}:xe),Ee=Ze&&Ze.length>0&&Ze.every(xe=>xe.motivo_id),Xe={};let Qe=null;Ze==null||Ze.forEach(xe=>{xe.motivo_id&&(Qe||(Qe=xe.motivo_id),Xe[xe.motivo_id]=(Xe[xe.motivo_id]||0)+1)});let et=Qe,rt=0;Object.entries(Xe).forEach(([xe,ze])=>{ze>rt&&(rt=ze,et=xe)});const ke=l.find(xe=>xe.id===et),ye=(ke==null?void 0:ke.nome)||nt.motivo||"-";return{...nt,itens:Ze,resultado:Ee?"VALIDADA":nt.resultado,motivo_id:Ee&&et?et:nt.motivo_id,motivo:Ee&&et?ye:nt.motivo,motivos_devolucao:Ee&&et?ke:nt.motivos_devolucao}}return nt})),Ge?(Ke.success("Todos os produtos validados! Resultado alterado para VALIDADA."),setTimeout(()=>{ae()},500)):Ke.success("Motivo do item atualizado!")}catch(Se){Ke.error("Erro ao atualizar motivo: "+Se.message)}},Q=async O=>{if(U&&confirm("Tem certeza que deseja excluir este registro?"))try{const{error:Ae}=await ot.from("itens_devolucao").delete().eq("devolucao_id",O);if(Ae)throw Ae;const{error:Pe}=await ot.from("devolucoes").delete().eq("id",O);if(Pe)throw Pe;Ke.success("Registro excludo com sucesso!"),ae(),M(new Set)}catch(Ae){Ke.error("Erro ao excluir registro: "+Ae.message)}},de=async()=>{if(E.size===0){Ke.warning("Selecione pelo menos um registro para excluir");return}if(confirm(`Tem certeza que deseja excluir ${E.size} registro(s)?`))try{const O=Array.from(E);for(const Pe of O)await ot.from("itens_devolucao").delete().eq("devolucao_id",Pe);const{error:Ae}=await ot.from("devolucoes").delete().in("id",O);if(Ae)throw Ae;Ke.success(`${O.length} registro(s) excludo(s) com sucesso!`),ae(),M(new Set),j(!1)}catch(O){Ke.error("Erro ao excluir registros: "+O.message)}},Fe=O=>{A(O)},Te=async()=>{if(!(!D||!U))try{const{error:O}=await ot.from("devolucoes").update({numero:D.numero,nome_cliente:D.nome_cliente,vendedor:D.vendedor,cidade_origem:D.cidade_origem,uf_origem:D.uf_origem,data_emissao:D.data_emissao,valor_total_nota:D.valor_total_nota,peso_liquido:D.peso_liquido,motivo_id:D.motivo_id,setor_id:D.setor_id,resultado:D.resultado,justificativa:D.justificativa,updated_at:new Date().toISOString()}).eq("id",D.id);if(O)throw O;Ke.success("Registro atualizado com sucesso!"),A(null),ae()}catch(O){Ke.error("Erro ao atualizar registro: "+O.message)}},Oe=O=>{var Z;const Ae=((Z=O.itens)==null?void 0:Z.map((le,Ge)=>`${Ge+1}. ${le.descricao||"-"}
   Quantidade: ${le.quantidade||"-"} ${le.unidade||""}
   Valor Unitrio: R$ ${(Number(le.valor_unitario)||0).toFixed(2)}
   Valor Total: R$ ${(Number(le.valor_total_bruto)||0).toFixed(2)}`).join(`

`))||"Nenhum produto cadastrado",Pe=` *Devoluo - Nota Fiscal ${O.numero||"-"}*

*Cliente:* ${O.nome_cliente||"-"}
*Vendedor:* ${O.vendedor||"-"}
*Data de Emisso:* ${O.data_emissao?ir(new Date(O.data_emissao),"dd/MM/yyyy",{locale:da}):"-"}
*Origem:* ${O.cidade_origem||"-"}/${O.uf_origem||"-"}

*Valor Total:* R$ ${(Number(O.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}
*Peso Lquido:* ${O.peso_liquido||"-"} kg
*Dias:* ${O.dias!==null&&O.dias!==void 0?O.dias:"-"}
*Prazo:* ${O.prazo||"-"}
*Resultado:* ${O.resultado||"-"}
*Motivo:* ${O.motivo||"-"}
*Setor:* ${O.setor||"-"}

*Produtos:*
${Ae}

${O.justificativa?`*Comentrio:*
${O.justificativa}`:""}`,Se=`https://wa.me/?text=${encodeURIComponent(Pe)}`;window.open(Se,"_blank")},Re=O=>{const Ae=new Set(E);Ae.has(O)?Ae.delete(O):Ae.add(O),M(Ae)},Je=()=>{E.size===e.length?M(new Set):M(new Set(e.map(O=>O.id)))},H=()=>{try{const O=new s2("p","mm","a4"),Ae=O.internal.pageSize.getWidth(),Pe=O.internal.pageSize.getHeight();let Se=20;const Z=[7,62,41],le=[10,80,55],Ge=[7,62,41],kt=[251,191,36],nt=[239,68,68],st=[220,252,231],Ze=[7,62,41];O.setFillColor(Z[0],Z[1],Z[2]),O.rect(0,0,Ae,45,"F");try{const je=new Image;je.src="/logo.png",O.addImage(je,"PNG",15,8,25,25)}catch{O.setFillColor(255,255,255),O.rect(15,8,12,12,"F"),O.setFillColor(le[0],le[1],le[2]),O.rect(15.5,8.5,11,11,"F"),O.setTextColor(255,255,255),O.setFontSize(10),O.setFont("helvetica","bold"),O.text("DM",19,16)}O.setFontSize(22),O.setFont("helvetica","bold"),O.setTextColor(255,255,255),O.text("Gesto de Devolues",45,18),O.setFontSize(10),O.setFont("helvetica","normal"),O.setTextColor(255,255,255),O.text("Grupo Doce Mel",45,28),O.text(`Relatrio Gerado em: ${ir(new Date,"dd/MM/yyyy HH:mm",{locale:da})}`,15,38);const Ee=I.startDate&&I.endDate?`${ir(I.startDate,"dd/MM/yyyy",{locale:da})} a ${ir(I.endDate,"dd/MM/yyyy",{locale:da})}`:I.period||"Perodo no especificado";O.text(`Perodo: ${Ee}`,Ae-15,20,{align:"right"}),O.text("Filial: Todas",Ae-15,30,{align:"right"}),Se=55,O.setTextColor(le[0],le[1],le[2]),O.setFontSize(14),O.setFont("helvetica","bold"),O.text("Resumo Executivo",15,Se),Se+=10;const Xe=(Ae-45)/3,Qe=25;let et=15,rt=Se;O.setFillColor(st[0],st[1],st[2]),O.setDrawColor(Ze[0],Ze[1],Ze[2]),O.setLineWidth(.5),O.rect(et,rt,Xe,Qe,"FD"),O.setFontSize(10),O.setFont("helvetica","bold"),O.setTextColor(le[0],le[1],le[2]),O.text("NF Pendentes",et+5,rt+8),O.setFontSize(16),O.setTextColor(nt[0],nt[1],nt[2]),O.text(ee.nfPendentes.toString(),et+5,rt+18),O.setFontSize(8),O.setTextColor(100,100,100),O.text(`R$ ${ee.totalPendente.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,et+5,rt+23),et+=Xe+7.5,O.setFillColor(st[0],st[1],st[2]),O.setDrawColor(Ze[0],Ze[1],Ze[2]),O.setLineWidth(.5),O.rect(et,rt,Xe,Qe,"FD"),O.setFontSize(10),O.setFont("helvetica","bold"),O.setTextColor(le[0],le[1],le[2]),O.text("NF Cancelamento",et+5,rt+8),O.setFontSize(16),O.setTextColor(kt[0],kt[1],kt[2]),O.text(ee.nfCancelamento.toString(),et+5,rt+18),O.setFontSize(8),O.setTextColor(100,100,100),O.text(`R$ ${ee.totalCancelamento.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,et+5,rt+23),et+=Xe+7.5,O.setFillColor(st[0],st[1],st[2]),O.setDrawColor(Ze[0],Ze[1],Ze[2]),O.setLineWidth(.5),O.rect(et,rt,Xe,Qe,"FD"),O.setFontSize(10),O.setFont("helvetica","bold"),O.setTextColor(le[0],le[1],le[2]),O.text("NF em Atraso",et+5,rt+8),O.setFontSize(16),O.setTextColor(nt[0],nt[1],nt[2]),O.text(ee.nfAtraso.toString(),et+5,rt+18),O.setFontSize(8),O.setTextColor(100,100,100),O.text(`R$ ${ee.totalAtraso.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,et+5,rt+23),Se+=Qe+15,et=15,rt=Se;const ke=r.filter(je=>je.resultado==="VALIDADA").length,ye=r.filter(je=>je.resultado==="VALIDADA").reduce((je,He)=>je+(Number(He.valor_total_nota)||0),0);O.setFillColor(st[0],st[1],st[2]),O.setDrawColor(Ze[0],Ze[1],Ze[2]),O.setLineWidth(.5),O.rect(et,rt,Xe,Qe,"FD"),O.setFontSize(10),O.setFont("helvetica","bold"),O.setTextColor(le[0],le[1],le[2]),O.text("NF Validadas",et+5,rt+8),O.setFontSize(16),O.setTextColor(Ge[0],Ge[1],Ge[2]),O.text(ke.toString(),et+5,rt+18),O.setFontSize(8),O.setTextColor(100,100,100),O.text(`R$ ${ye.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,et+5,rt+23);const xe=r.filter(je=>je.resultado==="LANADA").length,ze=r.filter(je=>je.resultado==="LANADA").reduce((je,He)=>je+(Number(He.valor_total_nota)||0),0);et+=Xe+7.5,O.setFillColor(st[0],st[1],st[2]),O.setDrawColor(Ze[0],Ze[1],Ze[2]),O.setLineWidth(.5),O.rect(et,rt,Xe,Qe,"FD"),O.setFontSize(10),O.setFont("helvetica","bold"),O.setTextColor(le[0],le[1],le[2]),O.text("NF Lanadas",et+5,rt+8),O.setFontSize(16),O.setTextColor(Ge[0],Ge[1],Ge[2]),O.text(xe.toString(),et+5,rt+18),O.setFontSize(8),O.setTextColor(100,100,100),O.text(`R$ ${ze.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,et+5,rt+23);const xt=r.reduce((je,He)=>je+(Number(He.valor_total_nota)||0),0);et+=Xe+7.5,O.setFillColor(st[0],st[1],st[2]),O.setDrawColor(Ze[0],Ze[1],Ze[2]),O.setLineWidth(.5),O.rect(et,rt,Xe,Qe,"FD"),O.setFontSize(10),O.setFont("helvetica","bold"),O.setTextColor(le[0],le[1],le[2]),O.text("Total Geral",et+5,rt+8),O.setFontSize(16),O.setTextColor(Z[0],Z[1],Z[2]),O.text(r.length.toString(),et+5,rt+18),O.setFontSize(8),O.setTextColor(100,100,100),O.text(`R$ ${xt.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,et+5,rt+23),Se+=Qe+20,O.setTextColor(le[0],le[1],le[2]),O.setFontSize(12),O.setFont("helvetica","bold");const qt=r.filter(je=>je.resultado==="PENDENTE VALIDAO");if(qt.length>0){O.text("1. Lista de Pendentes",15,Se),Se+=5;const je=qt.map(He=>[He.numero||"-",He.vendedor||"-",(He.nome_cliente||"-").substring(0,30),He.data_emissao?ir(new Date(He.data_emissao),"dd/MM/yyyy",{locale:da}):"-",`R$ ${(Number(He.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,He.prazo||"-",He.dias!==null&&He.dias!==void 0?He.dias.toString():"-",He.resultado||"-"]);Ni(O,{head:[["NF","Vendedor","Cliente","Data Emisso","Valor","Prazo","Dias","Resultado"]],body:je,startY:Se,styles:{fontSize:7,cellPadding:2},headStyles:{fillColor:[Z[0],Z[1],Z[2]],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:15,right:15}}),Se=O.lastAutoTable.finalY+10}Se>Pe-50&&(O.addPage(),Se=20);const lr=r.filter(je=>je.resultado==="TRATATIVA DE ANULAO");if(lr.length>0){O.text("2. Lista em Tratativas",15,Se),Se+=5;const je=lr.map(He=>[He.numero||"-",He.vendedor||"-",(He.nome_cliente||"-").substring(0,30),He.data_emissao?ir(new Date(He.data_emissao),"dd/MM/yyyy",{locale:da}):"-",`R$ ${(Number(He.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,He.prazo||"-",He.dias!==null&&He.dias!==void 0?He.dias.toString():"-",He.resultado||"-"]);Ni(O,{head:[["NF","Vendedor","Cliente","Data Emisso","Valor","Prazo","Dias","Resultado"]],body:je,startY:Se,styles:{fontSize:7,cellPadding:2},headStyles:{fillColor:[kt[0],kt[1],kt[2]],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[255,250,240]},margin:{left:15,right:15}}),Se=O.lastAutoTable.finalY+10}Se>Pe-50&&(O.addPage(),Se=20);const Nr=r.filter(je=>je.resultado==="VALIDADA");if(Nr.length>0){O.text("3. Lista Validadas",15,Se),Se+=5;const je=Nr.map(He=>[He.numero||"-",He.vendedor||"-",(He.nome_cliente||"-").substring(0,30),He.data_emissao?ir(new Date(He.data_emissao),"dd/MM/yyyy",{locale:da}):"-",`R$ ${(Number(He.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,He.prazo||"-",He.dias!==null&&He.dias!==void 0?He.dias.toString():"-",He.resultado||"-"]);Ni(O,{head:[["NF","Vendedor","Cliente","Data Emisso","Valor","Prazo","Dias","Resultado"]],body:je,startY:Se,styles:{fontSize:7,cellPadding:2},headStyles:{fillColor:[Ge[0],Ge[1],Ge[2]],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[240,255,240]},margin:{left:15,right:15}}),Se=O.lastAutoTable.finalY+10}Se>Pe-50&&(O.addPage(),Se=20),O.text("4. Lista Completa com Produtos",15,Se),Se+=5;const gr=[];r.forEach(je=>{je.itens&&je.itens.length>0?je.itens.forEach(He=>{gr.push([je.numero||"-",je.vendedor||"-",(je.nome_cliente||"-").substring(0,25),(He.descricao||"-").substring(0,30),He.unidade||"-",He.quantidade?He.quantidade.toString():"-",`R$ ${(Number(He.valor_total_bruto)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`])}):gr.push([je.numero||"-",je.vendedor||"-",(je.nome_cliente||"-").substring(0,25),"Sem itens","-","-",`R$ ${(Number(je.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`])}),Ni(O,{head:[["NF","Vendedor","Cliente","Produto","Unidade","Quantidade","Valor"]],body:gr.slice(0,50),startY:Se,styles:{fontSize:6,cellPadding:1.5},headStyles:{fillColor:[le[0],le[1],le[2]],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[250,250,250]},margin:{left:15,right:15}}),Se=O.lastAutoTable.finalY+10,Se>Pe-60&&(O.addPage(),Se=20),O.setFillColor(Z[0],Z[1],Z[2]),O.rect(0,Se-5,Ae,8,"F"),O.setTextColor(255,255,255),O.setFontSize(14),O.setFont("helvetica","bold"),O.text("Inteligncia e Anlises",15,Se+3),Se+=15,O.setTextColor(le[0],le[1],le[2]),O.setFontSize(10),O.setFont("helvetica","bold");const xa=r.reduce((je,He)=>{const pr=He.nome_cliente||"Desconhecido";return je[pr]=(je[pr]||0)+1,je},{}),br=Object.entries(xa).sort(([,je],[,He])=>He-je).slice(0,5).map(([je,He])=>`${je}: ${He} devoluo(es)`);O.text("Clientes com Maior Recorrncia:",15,Se),Se+=6,O.setFont("helvetica","normal"),O.setFontSize(9),br.forEach((je,He)=>{O.text(`${He+1}. ${je}`,20,Se),Se+=5}),Se+=5,O.setFont("helvetica","bold"),O.setFontSize(10),O.text("Alertas e Recomendaes:",15,Se),Se+=6,O.setFont("helvetica","normal"),O.setFontSize(9);const ft=[];if(ee.nfAtraso>0&&ft.push(` ${ee.nfAtraso} nota(s) fiscal(is) em atraso requerem ateno imediata`),ee.nfPendentes>10&&ft.push(` Alto volume de pendncias (${ee.nfPendentes}) - considere revisar processos`),ee.totalCancelamento>xt*.1&&ft.push(" Taxa de cancelamento acima de 10% - investigar causas"),r.length>0){const je=r.filter(He=>He.dias!==null&&He.dias!==void 0).reduce((He,pr)=>He+(pr.dias||0),0)/r.filter(He=>He.dias!==null&&He.dias!==void 0).length;je>30&&ft.push(` Tempo mdio de processamento alto (${je.toFixed(1)} dias)`)}ft.length===0&&ft.push(" Nenhum alerta crtico identificado"),ft.forEach(je=>{O.text(je,20,Se),Se+=5}),Se+=5,O.setFont("helvetica","bold"),O.setFontSize(10),O.text("Tendncias:",15,Se),Se+=6,O.setFont("helvetica","normal"),O.setFontSize(9);const jt=r.length>0?(Nr.length/r.length*100).toFixed(1):"0",lt=r.length>0?(ee.nfCancelamento/r.length*100).toFixed(1):"0";O.text(`Taxa de Validao: ${jt}%`,20,Se),Se+=5,O.text(`Taxa de Cancelamento: ${lt}%`,20,Se),Se+=5,O.text(`Total Processado: ${r.length} nota(s) fiscal(is)`,20,Se);const Ot=O.getNumberOfPages();for(let je=1;je<=Ot;je++)O.setPage(je),O.setFontSize(8),O.setTextColor(150,150,150),O.text(`Pgina ${je} de ${Ot} - Sistema de Devolues`,Ae/2,Pe-10,{align:"center"});const ct=`Relatorio_Devolucoes_${ir(new Date,"yyyy-MM-dd_HH-mm-ss",{locale:da})}.pdf`;O.save(ct),Ke.success("PDF gerado com sucesso!")}catch(O){console.error("Erro ao gerar PDF:",O),Ke.error("Erro ao gerar PDF: "+O.message)}};return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Validao"}),m.jsxs("div",{className:"flex gap-2",children:[B&&E.size>0&&m.jsxs(Dt,{variant:"destructive",onClick:de,children:[m.jsx(nu,{className:"mr-2 h-4 w-4"}),"Excluir (",E.size,")"]}),m.jsx(Dt,{variant:B?"default":"outline",onClick:()=>{j(!B),M(new Set)},children:B?m.jsxs(m.Fragment,{children:[m.jsx(Q0,{className:"mr-2 h-4 w-4"}),"Cancelar Seleo"]}):m.jsxs(m.Fragment,{children:[m.jsx(A0,{className:"mr-2 h-4 w-4"}),"Selecionar"]})}),m.jsxs(Dt,{variant:"outline",onClick:H,children:[m.jsx(w2,{className:"mr-2 h-4 w-4"}),"Gerar PDF"]})]})]}),m.jsx(nd,{}),m.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[m.jsxs(Vt,{children:[m.jsx(Ht,{className:"pb-2",children:m.jsx($t,{className:"text-sm font-medium",children:"NF Pendentes"})}),m.jsx(Wt,{children:m.jsx("div",{className:"text-2xl font-bold",children:ee.nfPendentes})})]}),m.jsxs(Vt,{children:[m.jsx(Ht,{className:"pb-2",children:m.jsx($t,{className:"text-sm font-medium",children:"Total Pendente"})}),m.jsx(Wt,{children:m.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",ee.totalPendente.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),m.jsxs(Vt,{children:[m.jsx(Ht,{className:"pb-2",children:m.jsx($t,{className:"text-sm font-medium",children:"NF em Cancelamento"})}),m.jsx(Wt,{children:m.jsx("div",{className:"text-2xl font-bold",children:ee.nfCancelamento})})]}),m.jsxs(Vt,{children:[m.jsx(Ht,{className:"pb-2",children:m.jsx($t,{className:"text-sm font-medium",children:"Total Cancelamento"})}),m.jsx(Wt,{children:m.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",ee.totalCancelamento.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),m.jsxs(Vt,{children:[m.jsx(Ht,{className:"pb-2",children:m.jsx($t,{className:"text-sm font-medium",children:"NF em Atraso"})}),m.jsx(Wt,{children:m.jsx("div",{className:"text-2xl font-bold text-red-600",children:ee.nfAtraso})})]}),m.jsxs(Vt,{children:[m.jsx(Ht,{className:"pb-2",children:m.jsx($t,{className:"text-sm font-medium",children:"Total em Atraso"})}),m.jsx(Wt,{children:m.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["R$ ",ee.totalAtraso.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]})]}),m.jsx("div",{className:"rounded-md border bg-card min-h-[400px]",children:n?m.jsx("div",{className:"flex items-center justify-center h-full py-20",children:m.jsx(Do,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.length===0?m.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-20 text-muted-foreground",children:[m.jsx(_2,{className:"h-10 w-10 mb-2"}),m.jsx("p",{children:"Nenhuma devoluo encontrada."})]}):m.jsx("div",{className:"overflow-x-auto",children:m.jsxs(Jn,{children:[m.jsx(vs,{children:m.jsxs(Tr,{children:[B&&m.jsx(gt,{className:"w-[50px]",children:m.jsx("button",{onClick:Je,className:"p-1 hover:bg-muted rounded",children:E.size===e.length&&e.length>0?m.jsx(A0,{className:"h-4 w-4"}):m.jsx(Wy,{className:"h-4 w-4"})})}),m.jsx(gt,{className:"w-[50px]"}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>be("data_emissao"),children:m.jsxs("div",{className:"flex items-center",children:["Data Emisso",m.jsx(z,{field:"data_emissao"})]})}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>be("numero"),children:m.jsxs("div",{className:"flex items-center",children:["Nota Fiscal",m.jsx(z,{field:"numero"})]})}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>be("nome_cliente"),children:m.jsxs("div",{className:"flex items-center",children:["Cliente",m.jsx(z,{field:"nome_cliente"})]})}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>be("cidade_origem"),children:m.jsxs("div",{className:"flex items-center",children:["Origem",m.jsx(z,{field:"cidade_origem"})]})}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>be("vendedor"),children:m.jsxs("div",{className:"flex items-center",children:["Vendedor",m.jsx(z,{field:"vendedor"})]})}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>be("motivo"),children:m.jsxs("div",{className:"flex items-center",children:["Motivo",m.jsx(z,{field:"motivo"})]})}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>be("valor_total_nota"),children:m.jsxs("div",{className:"flex items-center",children:["Valor Total",m.jsx(z,{field:"valor_total_nota"})]})}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>be("dias"),children:m.jsxs("div",{className:"flex items-center",children:["Dias",m.jsx(z,{field:"dias"})]})}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>be("prazo"),children:m.jsxs("div",{className:"flex items-center",children:["Prazo",m.jsx(z,{field:"prazo"})]})}),m.jsx(gt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>be("resultado"),children:m.jsxs("div",{className:"flex items-center",children:["Resultado",m.jsx(z,{field:"resultado"})]})}),m.jsx(gt,{children:"Comentrio"}),m.jsx(gt,{className:"w-[150px]",children:"Aes"})]})}),m.jsx(Qn,{children:e.map(O=>{const Ae=O.resultado||"PENDENTE VALIDAO";return m.jsx(Tr,{className:"group",children:m.jsx(At,{colSpan:B?14:13,className:"p-0 border-b",children:m.jsx(CH,{type:"single",collapsible:!0,className:"w-full",children:m.jsxs(eT,{value:O.id,className:"border-b-0",children:[m.jsxs("div",{className:"flex items-center w-full py-2 px-4 hover:bg-muted/50",children:[B&&m.jsx("button",{onClick:()=>Re(O.id),className:"w-[50px] flex items-center justify-center",children:E.has(O.id)?m.jsx(A0,{className:"h-4 w-4 text-primary"}):m.jsx(Wy,{className:"h-4 w-4"})}),m.jsx(tT,{className:"w-[50px] py-0 pr-4 hover:no-underline"}),m.jsxs("div",{className:"flex gap-4 w-full items-center text-sm",children:[m.jsx("div",{className:"w-24",children:O.data_emissao?ir(new Date(O.data_emissao),"dd/MM/yyyy",{locale:da}):"-"}),m.jsx("div",{className:"w-24 font-medium",children:O.numero}),m.jsx("div",{className:"flex-1 truncate",title:O.nome_cliente,children:O.nome_cliente}),m.jsxs("div",{className:"w-24",children:[O.cidade_origem,"/",O.uf_origem]}),m.jsx("div",{className:"w-32 truncate",title:O.vendedor,children:O.vendedor}),m.jsx("div",{className:"w-48",children:m.jsxs(Ra,{value:O.motivo_id||"",onValueChange:Pe=>De(O.id,Pe),children:[m.jsx(Ea,{className:"h-8 text-xs",onClick:Pe=>Pe.stopPropagation(),children:m.jsx(Fa,{placeholder:"Selecione..."})}),m.jsx(Ta,{children:l.map(Pe=>m.jsx(Et,{value:Pe.id,children:Pe.nome},Pe.id))})]})}),m.jsxs("div",{className:"w-24 font-bold",children:["R$ ",Number(O.valor_total_nota||0).toFixed(2)]}),m.jsx("div",{className:"w-16 text-center",children:O.dias!==null&&O.dias!==void 0?O.dias:"-"}),m.jsx("div",{className:"w-24",children:m.jsx("span",{className:`text-xs px-2 py-1 rounded ${O.prazo==="EM ATRASO"?"bg-red-500 text-white":O.prazo==="NO PRAZO"?"bg-green-500 text-white":"bg-gray-500 text-white"}`,children:O.prazo||"-"})}),m.jsx("div",{className:"w-40",children:m.jsx(Dt,{size:"sm",className:`${NH[Ae]} cursor-pointer text-xs px-2 py-1 w-full`,onClick:Pe=>{Pe.stopPropagation(),fe(O.id,Ae)},children:Ae})}),m.jsxs("div",{className:"w-64 flex gap-1",children:[m.jsx(R1,{className:"h-8 text-xs min-h-[32px] max-h-[32px] resize-none flex-1",placeholder:"Comentrio...",value:g[O.id]||"",onChange:Pe=>P(O.id,Pe.target.value),onClick:Pe=>Pe.stopPropagation(),maxLength:500}),m.jsx(Dt,{size:"sm",variant:"outline",className:"h-8 px-2",onClick:Pe=>{Pe.stopPropagation(),X(O.id)},disabled:p[O.id],children:m.jsx(LN,{className:"h-3 w-3"})})]}),m.jsxs("div",{className:"w-[150px] flex gap-1",children:[m.jsx(Dt,{size:"sm",variant:"outline",className:"h-8 px-2",onClick:Pe=>{Pe.stopPropagation(),Oe(O)},title:"Compartilhar via WhatsApp",children:m.jsx($N,{className:"h-3 w-3"})}),m.jsx(Dt,{size:"sm",variant:"outline",className:"h-8 px-2",onClick:Pe=>{Pe.stopPropagation(),Fe(O)},title:"Editar",children:m.jsx(XN,{className:"h-3 w-3"})}),m.jsx(Dt,{size:"sm",variant:"destructive",className:"h-8 px-2",onClick:Pe=>{Pe.stopPropagation(),Q(O.id)},title:"Excluir",children:m.jsx(nu,{className:"h-3 w-3"})})]})]})]}),m.jsx(rT,{children:m.jsx("div",{className:"px-4 pb-4",children:m.jsxs("div",{className:"rounded-md border bg-muted/50 p-4",children:[m.jsx("h4",{className:"font-semibold mb-2 text-sm",children:"Itens da Devoluo"}),m.jsxs(Jn,{children:[m.jsx(vs,{children:m.jsxs(Tr,{children:[m.jsx(gt,{className:"h-8 text-xs",children:"Nmero"}),m.jsx(gt,{className:"h-8 text-xs",children:"Descrio"}),m.jsx(gt,{className:"h-8 text-xs",children:"Unidade"}),m.jsx(gt,{className:"h-8 text-xs",children:"Quantidade"}),m.jsx(gt,{className:"h-8 text-xs",children:"Valor Unitrio"}),m.jsx(gt,{className:"h-8 text-xs",children:"Valor Total Bruto"}),m.jsx(gt,{className:"h-8 text-xs",children:"Motivo"})]})}),m.jsx(Qn,{children:O.itens&&O.itens.length>0?O.itens.map((Pe,Se)=>m.jsxs(Tr,{children:[m.jsx(At,{className:"text-xs",children:Pe.numero_item||"-"}),m.jsx(At,{className:"text-xs",children:Pe.descricao||"-"}),m.jsx(At,{className:"text-xs",children:Pe.unidade||"-"}),m.jsx(At,{className:"text-xs",children:Pe.quantidade||"-"}),m.jsxs(At,{className:"text-xs",children:["R$ ",Number(Pe.valor_unitario||0).toFixed(2)]}),m.jsxs(At,{className:"text-xs",children:["R$ ",Number(Pe.valor_total_bruto||0).toFixed(2)]}),m.jsx(At,{className:"text-xs",children:m.jsxs(Ra,{value:Pe.motivo_id||"",onValueChange:Z=>Y(Pe.id,Z,O.id),children:[m.jsx(Ea,{className:"h-7 text-xs",children:m.jsx(Fa,{placeholder:"Selecione..."})}),m.jsx(Ta,{children:l.map(Z=>m.jsx(Et,{value:Z.id,children:Z.nome},Z.id))})]})})]},Se)):m.jsx(Tr,{children:m.jsx(At,{colSpan:7,className:"text-center text-xs text-muted-foreground",children:"Nenhum item cadastrado"})})})]})]})})})]})})})},O.id)})})]})})}),D&&m.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:m.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[m.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Editar Registro"}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Nmero da Nota"}),m.jsx("input",{type:"text",className:"w-full border rounded px-3 py-2",value:D.numero||"",onChange:O=>A({...D,numero:O.target.value})})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Cliente"}),m.jsx("input",{type:"text",className:"w-full border rounded px-3 py-2",value:D.nome_cliente||"",onChange:O=>A({...D,nome_cliente:O.target.value})})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Vendedor"}),m.jsx("input",{type:"text",className:"w-full border rounded px-3 py-2",value:D.vendedor||"",onChange:O=>A({...D,vendedor:O.target.value})})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Cidade Origem"}),m.jsx("input",{type:"text",className:"w-full border rounded px-3 py-2",value:D.cidade_origem||"",onChange:O=>A({...D,cidade_origem:O.target.value})})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"UF Origem"}),m.jsx("input",{type:"text",className:"w-full border rounded px-3 py-2",value:D.uf_origem||"",onChange:O=>A({...D,uf_origem:O.target.value})})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Data de Emisso"}),m.jsx("input",{type:"date",className:"w-full border rounded px-3 py-2",value:D.data_emissao?ir(new Date(D.data_emissao),"yyyy-MM-dd"):"",onChange:O=>A({...D,data_emissao:O.target.value})})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Valor Total"}),m.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-3 py-2",value:D.valor_total_nota||"",onChange:O=>A({...D,valor_total_nota:O.target.value})})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Peso Lquido"}),m.jsx("input",{type:"number",step:"0.01",className:"w-full border rounded px-3 py-2",value:D.peso_liquido||"",onChange:O=>A({...D,peso_liquido:O.target.value})})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Setor"}),m.jsxs(Ra,{value:D.setor_id||"",onValueChange:O=>A({...D,setor_id:O}),children:[m.jsx(Ea,{className:"w-full",children:m.jsx(Fa,{placeholder:"Selecione o setor..."})}),m.jsx(Ta,{children:f.map(O=>m.jsx(Et,{value:O.id,children:O.nome},O.id))})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Motivo"}),m.jsxs(Ra,{value:D.motivo_id||"",onValueChange:O=>A({...D,motivo_id:O}),children:[m.jsx(Ea,{className:"w-full",children:m.jsx(Fa,{placeholder:"Selecione o motivo..."})}),m.jsx(Ta,{children:l.map(O=>m.jsx(Et,{value:O.id,children:O.nome},O.id))})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Resultado"}),m.jsxs(Ra,{value:D.resultado||"PENDENTE VALIDAO",onValueChange:O=>A({...D,resultado:O}),children:[m.jsx(Ea,{className:"w-full",children:m.jsx(Fa,{})}),m.jsxs(Ta,{children:[m.jsx(Et,{value:"PENDENTE VALIDAO",children:"PENDENTE VALIDAO"}),m.jsx(Et,{value:"VALIDADA",children:"VALIDADA"}),m.jsx(Et,{value:"LANADA",children:"LANADA"}),m.jsx(Et,{value:"TRATATIVA DE ANULAO",children:"TRATATIVA DE ANULAO"}),m.jsx(Et,{value:"ANULADA/CANCELADA",children:"ANULADA/CANCELADA"})]})]})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-sm font-medium",children:"Justificativa"}),m.jsx(R1,{className:"w-full border rounded px-3 py-2",value:D.justificativa||"",onChange:O=>A({...D,justificativa:O.target.value})})]}),m.jsxs("div",{className:"flex gap-2 justify-end",children:[m.jsx(Dt,{variant:"outline",onClick:()=>A(null),children:"Cancelar"}),m.jsx(Dt,{onClick:Te,children:"Salvar"})]})]})]})})]})}var Zm="rovingFocusGroup.onEntryFocus",FH={bubbles:!1,cancelable:!0},Zu="RovingFocusGroup",[F1,aT,MH]=_4(Zu),[jH,nT]=Y0(Zu,[MH]),[IH,PH]=jH(Zu),sT=K.forwardRef((e,t)=>m.jsx(F1.Provider,{scope:e.__scopeRovingFocusGroup,children:m.jsx(F1.Slot,{scope:e.__scopeRovingFocusGroup,children:m.jsx(LH,{...e,ref:t})})}));sT.displayName=Zu;var LH=K.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:a,loop:n=!1,dir:o,currentTabStopId:l,defaultCurrentTabStopId:u,onCurrentTabStopIdChange:f,onEntryFocus:h,preventScrollOnEntryFocus:g=!1,...v}=e,p=K.useRef(null),_=Lu(t,p),b=Qw(o),[w,S]=I1({prop:l,defaultProp:u??null,onChange:f,caller:Zu}),[T,N]=K.useState(!1),k=M1(h),E=aT(r),M=K.useRef(!1),[D,A]=K.useState(0);return K.useEffect(()=>{const B=p.current;if(B)return B.addEventListener(Zm,k),()=>B.removeEventListener(Zm,k)},[k]),m.jsx(IH,{scope:r,orientation:a,dir:b,loop:n,currentTabStopId:w,onItemFocus:K.useCallback(B=>S(B),[S]),onItemShiftTab:K.useCallback(()=>N(!0),[]),onFocusableItemAdd:K.useCallback(()=>A(B=>B+1),[]),onFocusableItemRemove:K.useCallback(()=>A(B=>B-1),[]),children:m.jsx(ys.div,{tabIndex:T||D===0?-1:0,"data-orientation":a,...v,ref:_,style:{outline:"none",...e.style},onMouseDown:Xa(e.onMouseDown,()=>{M.current=!0}),onFocus:Xa(e.onFocus,B=>{const j=!M.current;if(B.target===B.currentTarget&&j&&!T){const ee=new CustomEvent(Zm,FH);if(B.currentTarget.dispatchEvent(ee),!ee.defaultPrevented){const re=E().filter(q=>q.focusable),U=re.find(q=>q.active),I=re.find(q=>q.id===w),ie=[U,I,...re].filter(Boolean).map(q=>q.ref.current);lT(ie,g)}}M.current=!1}),onBlur:Xa(e.onBlur,()=>N(!1))})})}),iT="RovingFocusGroupItem",oT=K.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:a=!0,active:n=!1,tabStopId:o,children:l,...u}=e,f=P1(),h=o||f,g=PH(iT,r),v=g.currentTabStopId===h,p=aT(r),{onFocusableItemAdd:_,onFocusableItemRemove:b,currentTabStopId:w}=g;return K.useEffect(()=>{if(a)return _(),()=>b()},[a,_,b]),m.jsx(F1.ItemSlot,{scope:r,id:h,focusable:a,active:n,children:m.jsx(ys.span,{tabIndex:v?0:-1,"data-orientation":g.orientation,...u,ref:t,onMouseDown:Xa(e.onMouseDown,S=>{a?g.onItemFocus(h):S.preventDefault()}),onFocus:Xa(e.onFocus,()=>g.onItemFocus(h)),onKeyDown:Xa(e.onKeyDown,S=>{if(S.key==="Tab"&&S.shiftKey){g.onItemShiftTab();return}if(S.target!==S.currentTarget)return;const T=zH(S,g.orientation,g.dir);if(T!==void 0){if(S.metaKey||S.ctrlKey||S.altKey||S.shiftKey)return;S.preventDefault();let k=p().filter(E=>E.focusable).map(E=>E.ref.current);if(T==="last")k.reverse();else if(T==="prev"||T==="next"){T==="prev"&&k.reverse();const E=k.indexOf(S.currentTarget);k=g.loop?VH(k,E+1):k.slice(E+1)}setTimeout(()=>lT(k))}}),children:typeof l=="function"?l({isCurrentTabStop:v,hasTabStop:w!=null}):l})})});oT.displayName=iT;var BH={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function UH(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function zH(e,t,r){const a=UH(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(a))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(a)))return BH[a]}function lT(e,t=!1){const r=document.activeElement;for(const a of e)if(a===r||(a.focus({preventScroll:t}),document.activeElement!==r))return}function VH(e,t){return e.map((r,a)=>e[(t+a)%e.length])}var HH=sT,$H=oT,md="Tabs",[WH,S$]=Y0(md,[nT]),cT=nT(),[GH,Yg]=WH(md),uT=K.forwardRef((e,t)=>{const{__scopeTabs:r,value:a,onValueChange:n,defaultValue:o,orientation:l="horizontal",dir:u,activationMode:f="automatic",...h}=e,g=Qw(u),[v,p]=I1({prop:a,onChange:n,defaultProp:o??"",caller:md});return m.jsx(GH,{scope:r,baseId:P1(),value:v,onValueChange:p,orientation:l,dir:g,activationMode:f,children:m.jsx(ys.div,{dir:g,"data-orientation":l,...h,ref:t})})});uT.displayName=md;var fT="TabsList",dT=K.forwardRef((e,t)=>{const{__scopeTabs:r,loop:a=!0,...n}=e,o=Yg(fT,r),l=cT(r);return m.jsx(HH,{asChild:!0,...l,orientation:o.orientation,dir:o.dir,loop:a,children:m.jsx(ys.div,{role:"tablist","aria-orientation":o.orientation,...n,ref:t})})});dT.displayName=fT;var hT="TabsTrigger",mT=K.forwardRef((e,t)=>{const{__scopeTabs:r,value:a,disabled:n=!1,...o}=e,l=Yg(hT,r),u=cT(r),f=vT(l.baseId,a),h=pT(l.baseId,a),g=a===l.value;return m.jsx($H,{asChild:!0,...u,focusable:!n,active:g,children:m.jsx(ys.button,{type:"button",role:"tab","aria-selected":g,"aria-controls":h,"data-state":g?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:f,...o,ref:t,onMouseDown:Xa(e.onMouseDown,v=>{!n&&v.button===0&&v.ctrlKey===!1?l.onValueChange(a):v.preventDefault()}),onKeyDown:Xa(e.onKeyDown,v=>{[" ","Enter"].includes(v.key)&&l.onValueChange(a)}),onFocus:Xa(e.onFocus,()=>{const v=l.activationMode!=="manual";!g&&!n&&v&&l.onValueChange(a)})})})});mT.displayName=hT;var gT="TabsContent",xT=K.forwardRef((e,t)=>{const{__scopeTabs:r,value:a,forceMount:n,children:o,...l}=e,u=Yg(gT,r),f=vT(u.baseId,a),h=pT(u.baseId,a),g=a===u.value,v=K.useRef(g);return K.useEffect(()=>{const p=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(p)},[]),m.jsx(j1,{present:n||g,children:({present:p})=>m.jsx(ys.div,{"data-state":g?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":f,hidden:!p,id:h,tabIndex:0,...l,ref:t,style:{...e.style,animationDuration:v.current?"0s":void 0},children:p&&o})})});xT.displayName=gT;function vT(e,t){return`${e}-trigger-${t}`}function pT(e,t){return`${e}-content-${t}`}var qH=uT,yT=dT,_T=mT,wT=xT;const bT=qH,Xg=K.forwardRef(({className:e,...t},r)=>m.jsx(yT,{ref:r,className:Ye("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",e),...t}));Xg.displayName=yT.displayName;const Ri=K.forwardRef(({className:e,...t},r)=>m.jsx(_T,{ref:r,className:Ye("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",e),...t}));Ri.displayName=_T.displayName;const Fi=K.forwardRef(({className:e,...t},r)=>m.jsx(wT,{ref:r,className:Ye("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));Fi.displayName=wT.displayName;const YH=S4,XH=E4,KH=w4,ST=K.forwardRef(({className:e,...t},r)=>m.jsx(Zw,{ref:r,className:Ye("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));ST.displayName=Zw.displayName;const ET=K.forwardRef(({className:e,children:t,...r},a)=>m.jsxs(KH,{children:[m.jsx(ST,{}),m.jsxs(e2,{ref:a,className:Ye("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,m.jsxs(b4,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[m.jsx(Q0,{className:"h-4 w-4"}),m.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ET.displayName=e2.displayName;const TT=({className:e,...t})=>m.jsx("div",{className:Ye("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});TT.displayName="DialogHeader";const kT=({className:e,...t})=>m.jsx("div",{className:Ye("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});kT.displayName="DialogFooter";const AT=K.forwardRef(({className:e,...t},r)=>m.jsx(t2,{ref:r,className:Ye("text-lg font-semibold leading-none tracking-tight",e),...t}));AT.displayName=t2.displayName;const CT=K.forwardRef(({className:e,...t},r)=>m.jsx(r2,{ref:r,className:Ye("text-sm text-muted-foreground",e),...t}));CT.displayName=r2.displayName;function JH(){const{user:e}=jn(),[t,r]=K.useState([]),[a,n]=K.useState([]),[o,l]=K.useState([]),[u,f]=K.useState([]),[h,g]=K.useState([]),[v,p]=K.useState(""),[_,b]=K.useState(""),[w,S]=K.useState(""),[T,N]=K.useState(""),[k,E]=K.useState(""),[M,D]=K.useState(""),[A,B]=K.useState(""),[j,ee]=K.useState(""),[re,U]=K.useState(""),[I,ne]=K.useState(""),[ie,q]=K.useState(null),[ae,be]=K.useState(""),[z,fe]=K.useState("COMERCIAL"),[De,P]=K.useState(""),[X,Y]=K.useState(""),[Q,de]=K.useState(""),[Fe,Te]=K.useState(""),[Oe,Re]=K.useState(""),[Je,H]=K.useState("COMERCIAL"),[O,Ae]=K.useState("");K.useEffect(()=>{Pe()},[]);const Pe=async()=>{var ke;const[Ee,Xe,Qe,et,rt]=await Promise.all([ot.from("setores").select("*").order("nome"),ot.from("motivos_devolucao").select("*, setor:setores(nome)").order("nome"),ot.from("profiles").select("*").order("name"),ot.from("clientes").select("*").order("nome").limit(100),ot.from("devolucoes").select("vendedor").not("vendedor","is",null)]);if(Ee.data&&r(Ee.data.map(ye=>({id:ye.id,name:ye.nome}))),Xe.data&&n(Xe.data.map(ye=>({id:ye.id,name:ye.nome,sector_id:ye.sector_id,sector:ye.setor}))),Qe.data&&l(Qe.data),et.data&&f(et.data),rt.data){const ye=new Set;rt.data.forEach(xe=>{xe.vendedor&&xe.vendedor.trim()&&ye.add(xe.vendedor.trim().toUpperCase())}),(ke=et.data)==null||ke.forEach(xe=>{xe.vendedor&&xe.vendedor.trim()&&ye.add(xe.vendedor.trim().toUpperCase())}),g(Array.from(ye).sort())}},Se=async()=>{if(!_)return;const{error:Ee}=await ot.from("setores").insert({nome:_});Ee?Ke.error("Erro ao adicionar setor: "+Ee.message):(Ke.success("Setor adicionado!"),b(""),Pe())},Z=async()=>{if(!w||!w.trim()){Ke.error("Nome do motivo  obrigatrio");return}if(!T){Ke.error("Selecione um setor para o motivo");return}try{const{error:Ee}=await ot.from("motivos_devolucao").insert({nome:w.trim(),sector_id:T});Ee?(console.error("Erro ao adicionar motivo:",Ee),Ke.error("Erro ao adicionar motivo: "+Ee.message)):(Ke.success("Motivo adicionado!"),S(""),N(""),Pe())}catch(Ee){console.error("Erro ao adicionar motivo:",Ee),Ke.error("Erro ao adicionar motivo: "+(Ee.message||"Erro desconhecido"))}},le=async Ee=>{const{error:Xe}=await ot.from("motivos_devolucao").delete().eq("id",Ee);Xe?Ke.error("Erro ao excluir: "+Xe.message):(Ke.success("Excludo com sucesso"),Pe())},Ge=async()=>{var Ee,Xe;if(!k||!k.trim()){Ke.error("Nome do cliente  obrigatrio");return}if(!M||!M.trim()){Ke.error("CNPJ/CPF  obrigatrio");return}if(re&&re.length!==2){Ke.error("UF deve ter 2 caracteres");return}try{const{error:Qe}=await ot.from("clientes").insert({nome:k.trim(),cnpj_cpf:M.trim(),vendedor:(A==null?void 0:A.trim())||null,rede:(j==null?void 0:j.trim())||null,uf:(re==null?void 0:re.trim().toUpperCase())||null,municipio:(I==null?void 0:I.trim())||null});Qe?(console.error("Erro ao adicionar cliente:",Qe),Qe.code==="23505"||(Ee=Qe.message)!=null&&Ee.includes("duplicate")||(Xe=Qe.message)!=null&&Xe.includes("unique")?Ke.error("Cliente com este CNPJ/CPF j est cadastrado"):Ke.error("Erro ao adicionar cliente: "+Qe.message)):(Ke.success("Cliente adicionado!"),E(""),D(""),B(""),ee(""),U(""),ne(""),Pe())}catch(Qe){console.error("Erro ao adicionar cliente:",Qe),Ke.error("Erro ao adicionar cliente: "+(Qe.message||"Erro desconhecido"))}},kt=async()=>{var Qe,et,rt,ke;if(!Q||!Fe||!Oe){Ke.error("Nome, email e senha so obrigatrios");return}if(Oe.length<6){Ke.error("A senha deve ter pelo menos 6 caracteres");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Fe)){Ke.error("Email invlido");return}if(Je==="VENDEDOR"&&!O){Ke.error("Usurios do tipo VENDEDOR devem ter um vendedor selecionado");return}if(!["ADMIN","GESTOR","COMERCIAL","LOGISTICA","VENDEDOR"].includes(Je)){Ke.error("Role invlido. Selecione um role vlido.");return}try{const ye={name:Q,role:Je};Je==="VENDEDOR"&&O&&(ye.vendedor=O);const{data:xe,error:ze}=await ot.auth.signUp({email:Fe.trim().toLowerCase(),password:Oe,options:{data:ye,emailRedirectTo:void 0}});if(ze){console.error("Erro no auth.signUp:",ze),(Qe=ze.message)!=null&&Qe.includes("already registered")||(et=ze.message)!=null&&et.includes("already exists")?Ke.error("Este email j est cadastrado no sistema"):(rt=ze.message)!=null&&rt.includes("password")?Ke.error("Senha invlida. Verifique os requisitos de senha."):(ke=ze.message)!=null&&ke.includes("email")?Ke.error("Email invlido ou j cadastrado"):Ke.error(`Erro ao criar usurio: ${ze.message||"Erro desconhecido"}`);return}if(xe.user){await new Promise(gr=>setTimeout(gr,1e3));let xt=null,qt=null;const{data:lr,error:Nr}=await ot.from("profiles").select("*").eq("id",xe.user.id).single();if(xt=lr,qt=Nr,qt||!xt){console.error("Perfil no encontrado aps criao, tentando criar manualmente:",qt),await new Promise(br=>setTimeout(br,2e3));const{data:gr,error:xa}=await ot.from("profiles").select("*").eq("id",xe.user.id).single();if(xa||!gr){const{error:br}=await ot.from("profiles").insert({id:xe.user.id,name:Q,email:Fe.trim().toLowerCase(),role:Je,vendedor:Je==="VENDEDOR"?O:null});if(br){console.error("Erro ao inserir perfil:",br),Ke.error(`Usurio criado no Auth, mas erro ao criar perfil: ${br.message}. O trigger pode ter falhado. Verifique o perfil manualmente no Supabase.`);return}xt={id:xe.user.id}}else xt=gr}if(xt){const{error:gr}=await ot.from("profiles").update({name:Q,role:Je,vendedor:Je==="VENDEDOR"?O:null}).eq("id",xe.user.id);gr&&console.warn("Aviso ao atualizar perfil (pode ser normal):",gr)}Ke.success("Usurio criado com sucesso!"),de(""),Te(""),Re(""),H("COMERCIAL"),Ae(""),Pe()}else Ke.warning("Usurio criado, mas no foi possvel obter os dados. Recarregue a pgina.")}catch(ye){console.error("Erro ao criar usurio:",ye),Ke.error(`Erro ao criar usurio: ${ye.message||"Erro desconhecido"}`)}},nt=async()=>{if(ie){if(z==="VENDEDOR"&&!De){Ke.error("Usurios do tipo VENDEDOR devem ter um vendedor selecionado");return}try{const{error:Ee}=await ot.from("profiles").update({name:ae,role:z,vendedor:z==="VENDEDOR"?De:null}).eq("id",ie.id);if(Ee){Ke.error("Erro ao atualizar usurio: "+Ee.message);return}X&&X.length>=6&&(Ke.warning("Alterao de senha de outros usurios requer configurao de Edge Function ou uso da API Admin do Supabase. Por favor, use o Supabase Dashboard para alterar senhas."),Y("")),Ke.success("Usurio atualizado!"),q(null),Pe()}catch(Ee){Ke.error("Erro ao atualizar usurio: "+Ee.message)}}},st=async(Ee,Xe)=>{if(confirm(`Tem certeza que deseja excluir o usurio "${Xe}"? Esta ao no pode ser desfeita.`))try{const{error:Qe}=await ot.from("profiles").delete().eq("id",Ee);if(Qe){Ke.error("Erro ao excluir usurio: "+Qe.message);return}Ke.success("Usurio excludo com sucesso! (Nota: O registro no Auth pode precisar ser removido manualmente no Supabase Dashboard)"),Pe()}catch(Qe){Ke.error("Erro ao excluir usurio: "+Qe.message)}},Ze=async()=>{if(!v||!v.trim()){Ke.error("Nome do vendedor  obrigatrio");return}const Ee=v.trim().toUpperCase();if(h.includes(Ee)){Ke.warning("Este vendedor j est cadastrado");return}g([...h,Ee].sort()),p(""),Ke.success("Vendedor adicionado  lista!")};return(e==null?void 0:e.role)!=="ADMIN"?m.jsx("div",{className:"p-8 text-center",children:"Acesso restrito a administradores."}):m.jsxs("div",{className:"space-y-6",children:[m.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Configuraes"}),m.jsxs(bT,{defaultValue:"master-data",children:[m.jsxs(Xg,{children:[m.jsx(Ri,{value:"master-data",children:"Master Data (Setores/Motivos)"}),m.jsx(Ri,{value:"vendedores",children:"Vendedores"}),m.jsx(Ri,{value:"clientes",children:"Clientes"}),m.jsx(Ri,{value:"users",children:"Usurios"})]}),m.jsx(Fi,{value:"master-data",className:"space-y-6 mt-6",children:m.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[m.jsxs(Vt,{children:[m.jsxs(Ht,{children:[m.jsx($t,{children:"Setores"}),m.jsx(cn,{children:"Gerencie as reas responsveis."})]}),m.jsxs(Wt,{children:[m.jsxs("div",{className:"flex gap-2 mb-4",children:[m.jsx(Gr,{placeholder:"Novo Setor",value:_,onChange:Ee=>b(Ee.target.value)}),m.jsx(Dt,{onClick:Se,size:"icon",children:m.jsx(Jc,{className:"h-4 w-4"})})]}),m.jsx("div",{className:"rounded-md border max-h-[300px] overflow-y-auto",children:m.jsx(Jn,{children:m.jsx(Qn,{children:t.map(Ee=>m.jsx(Tr,{children:m.jsx(At,{children:Ee.name})},Ee.id))})})})]})]}),m.jsxs(Vt,{children:[m.jsxs(Ht,{children:[m.jsx($t,{children:"Motivos de Devoluo"}),m.jsx(cn,{children:"Associe motivos aos setores."})]}),m.jsxs(Wt,{children:[m.jsxs("div",{className:"flex flex-col gap-2 mb-4",children:[m.jsxs(Ra,{value:T,onValueChange:N,children:[m.jsx(Ea,{children:m.jsx(Fa,{placeholder:"Selecione o Setor"})}),m.jsx(Ta,{children:t.map(Ee=>m.jsx(Et,{value:Ee.id,children:Ee.name},Ee.id))})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx(Gr,{placeholder:"Novo Motivo",value:w,onChange:Ee=>S(Ee.target.value)}),m.jsx(Dt,{onClick:Z,size:"icon",children:m.jsx(Jc,{className:"h-4 w-4"})})]})]}),m.jsx("div",{className:"rounded-md border max-h-[300px] overflow-y-auto",children:m.jsxs(Jn,{children:[m.jsx(vs,{children:m.jsxs(Tr,{children:[m.jsx(gt,{children:"Motivo"}),m.jsx(gt,{children:"Setor"}),m.jsx(gt,{className:"w-[50px]"})]})}),m.jsx(Qn,{children:a.length===0?m.jsx(Tr,{children:m.jsx(At,{colSpan:3,className:"text-center text-muted-foreground",children:"Nenhum motivo cadastrado"})}):a.map(Ee=>{var Xe;return m.jsxs(Tr,{children:[m.jsx(At,{children:Ee.name}),m.jsx(At,{className:"text-xs text-muted-foreground",children:((Xe=Ee.sector)==null?void 0:Xe.name)||"-"}),m.jsx(At,{children:m.jsx(Dt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive",onClick:()=>le(Ee.id),children:m.jsx(nu,{className:"h-3 w-3"})})})]},Ee.id)})})]})})]})]})]})}),m.jsx(Fi,{value:"vendedores",className:"space-y-6 mt-6",children:m.jsxs(Vt,{children:[m.jsxs(Ht,{children:[m.jsx($t,{children:"Cadastro de Vendedores"}),m.jsx(cn,{children:"Gerencie a lista de vendedores disponveis no sistema."})]}),m.jsxs(Wt,{children:[m.jsxs("div",{className:"flex gap-2 mb-4",children:[m.jsx(Gr,{placeholder:"Nome do Vendedor",value:v,onChange:Ee=>p(Ee.target.value),onKeyPress:Ee=>Ee.key==="Enter"&&Ze()}),m.jsx(Dt,{onClick:Ze,size:"icon",children:m.jsx(Jc,{className:"h-4 w-4"})})]}),m.jsx("div",{className:"rounded-md border max-h-[400px] overflow-y-auto",children:m.jsxs(Jn,{children:[m.jsx(vs,{children:m.jsxs(Tr,{children:[m.jsx(gt,{children:"Nome"}),m.jsx(gt,{className:"text-right",children:"Aes"})]})}),m.jsxs(Qn,{children:[h.map((Ee,Xe)=>m.jsxs(Tr,{children:[m.jsx(At,{className:"font-medium",children:Ee}),m.jsx(At,{className:"text-right",children:m.jsx(Dt,{variant:"ghost",size:"icon",onClick:()=>{confirm(`Remover "${Ee}" da lista?`)&&(g(h.filter(Qe=>Qe!==Ee)),Ke.success("Vendedor removido da lista!"))},children:m.jsx(nu,{className:"h-4 w-4 text-destructive"})})})]},Xe)),h.length===0&&m.jsx(Tr,{children:m.jsx(At,{colSpan:2,className:"text-center text-muted-foreground",children:"Nenhum vendedor cadastrado. Adicione um acima."})})]})]})})]})]})}),m.jsx(Fi,{value:"clientes",className:"space-y-6 mt-6",children:m.jsxs(Vt,{children:[m.jsxs(Ht,{children:[m.jsx($t,{children:"Cadastro de Clientes"}),m.jsx(cn,{children:"Adicione novos clientes ao sistema."})]}),m.jsxs(Wt,{children:[m.jsxs("div",{className:"space-y-4 mb-6",children:[m.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{children:"Nome *"}),m.jsx(Gr,{value:k,onChange:Ee=>E(Ee.target.value),placeholder:"Nome do cliente"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{children:"CNPJ/CPF *"}),m.jsx(Gr,{value:M,onChange:Ee=>D(Ee.target.value),placeholder:"00.000.000/0000-00"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{children:"Vendedor"}),m.jsx(Gr,{value:A,onChange:Ee=>B(Ee.target.value),placeholder:"Nome do vendedor"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{children:"Rede"}),m.jsx(Gr,{value:j,onChange:Ee=>ee(Ee.target.value),placeholder:"Nome da rede"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{children:"UF"}),m.jsx(Gr,{value:re,onChange:Ee=>U(Ee.target.value.toUpperCase()),placeholder:"UF",maxLength:2})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{children:"Municpio"}),m.jsx(Gr,{value:I,onChange:Ee=>ne(Ee.target.value),placeholder:"Nome do municpio"})]})]}),m.jsxs(Dt,{onClick:Ge,children:[m.jsx(Jc,{className:"mr-2 h-4 w-4"}),"Adicionar Cliente"]})]}),m.jsx("div",{className:"rounded-md border max-h-[400px] overflow-y-auto",children:m.jsxs(Jn,{children:[m.jsx(vs,{children:m.jsxs(Tr,{children:[m.jsx(gt,{children:"Nome"}),m.jsx(gt,{children:"CNPJ/CPF"}),m.jsx(gt,{children:"Vendedor"}),m.jsx(gt,{children:"Rede"}),m.jsx(gt,{children:"UF"}),m.jsx(gt,{children:"Municpio"})]})}),m.jsx(Qn,{children:u.map(Ee=>m.jsxs(Tr,{children:[m.jsx(At,{className:"font-medium",children:Ee.nome}),m.jsx(At,{children:Ee.cnpj_cpf}),m.jsx(At,{children:Ee.vendedor||"-"}),m.jsx(At,{children:Ee.rede||"-"}),m.jsx(At,{children:Ee.uf||"-"}),m.jsx(At,{children:Ee.municipio||"-"})]},Ee.id))})]})})]})]})}),m.jsxs(Fi,{value:"users",className:"space-y-6 mt-6",children:[m.jsxs(Vt,{children:[m.jsxs(Ht,{children:[m.jsx($t,{children:"Cadastro de Usurios"}),m.jsx(cn,{children:"Adicione novos usurios ao sistema."})]}),m.jsx(Wt,{children:m.jsxs("div",{className:"space-y-4 mb-6 p-4 border rounded-lg",children:[m.jsx("h3",{className:"font-semibold mb-4",children:"Novo Usurio"}),m.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{children:"Nome *"}),m.jsx(Gr,{value:Q,onChange:Ee=>de(Ee.target.value),placeholder:"Nome completo"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{children:"Email *"}),m.jsx(Gr,{type:"email",value:Fe,onChange:Ee=>Te(Ee.target.value),placeholder:"email@exemplo.com"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{children:"Senha *"}),m.jsx(Gr,{type:"password",value:Oe,onChange:Ee=>Re(Ee.target.value),placeholder:"Senha"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{children:"Funo"}),m.jsxs(Ra,{value:Je,onValueChange:Ee=>{H(Ee),Ee!=="VENDEDOR"&&Ae("")},children:[m.jsx(Ea,{children:m.jsx(Fa,{})}),m.jsxs(Ta,{children:[m.jsx(Et,{value:"ADMIN",children:"ADMIN"}),m.jsx(Et,{value:"GESTOR",children:"GESTOR"}),m.jsx(Et,{value:"COMERCIAL",children:"COMERCIAL"}),m.jsx(Et,{value:"LOGISTICA",children:"LOGISTICA"}),m.jsx(Et,{value:"VENDEDOR",children:"VENDEDOR"})]})]})]}),Je==="VENDEDOR"&&m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{children:"Vendedor *"}),m.jsxs(Ra,{value:O,onValueChange:Ae,children:[m.jsx(Ea,{children:m.jsx(Fa,{placeholder:"Selecione o vendedor"})}),m.jsxs(Ta,{children:[h.map(Ee=>m.jsx(Et,{value:Ee,children:Ee},Ee)),h.length===0&&m.jsx(Et,{value:"",disabled:!0,children:"Nenhum vendedor cadastrado"})]})]})]})]}),m.jsxs(Dt,{onClick:kt,children:[m.jsx(Jc,{className:"mr-2 h-4 w-4"}),"Criar Usurio"]})]})})]}),m.jsxs(Vt,{children:[m.jsxs(Ht,{children:[m.jsx($t,{children:"Gesto de Usurios"}),m.jsx(cn,{children:"Visualize e gerencie os usurios do sistema."})]}),m.jsx(Wt,{children:m.jsx("div",{className:"rounded-md border",children:m.jsxs(Jn,{children:[m.jsx(vs,{children:m.jsxs(Tr,{children:[m.jsx(gt,{children:"Nome"}),m.jsx(gt,{children:"Email"}),m.jsx(gt,{children:"Funo"}),m.jsx(gt,{children:"Vendedor"}),m.jsx(gt,{className:"text-right",children:"Aes"})]})}),m.jsx(Qn,{children:o.map(Ee=>m.jsxs(Tr,{children:[m.jsx(At,{className:"font-medium",children:Ee.name}),m.jsx(At,{children:Ee.email}),m.jsx(At,{children:m.jsx(ln,{variant:Ee.role==="ADMIN"?"default":"secondary",children:Ee.role})}),m.jsx(At,{children:m.jsx(ln,{variant:"outline",children:Ee.vendedor||"GERAL"})}),m.jsx(At,{className:"text-right",children:m.jsxs("div",{className:"flex justify-end gap-2",children:[m.jsxs(YH,{children:[m.jsx(XH,{asChild:!0,children:m.jsx(Dt,{variant:"ghost",size:"icon",onClick:()=>{q(Ee),be(Ee.name),fe(Ee.role),P(Ee.vendedor||""),Y("")},children:m.jsx(RN,{className:"h-4 w-4"})})}),m.jsxs(ET,{children:[m.jsxs(TT,{children:[m.jsx(AT,{children:"Editar Usurio"}),m.jsxs(CT,{children:["Alterar permisses e dados de ",Ee.name]})]}),m.jsxs("div",{className:"space-y-4 py-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{children:"Nome"}),m.jsx(Gr,{value:ae,onChange:Xe=>be(Xe.target.value)})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{children:"Funo (Role)"}),m.jsxs(Ra,{value:z,onValueChange:Xe=>{fe(Xe),Xe!=="VENDEDOR"&&P("")},children:[m.jsx(Ea,{children:m.jsx(Fa,{})}),m.jsxs(Ta,{children:[m.jsx(Et,{value:"ADMIN",children:"ADMIN"}),m.jsx(Et,{value:"GESTOR",children:"GESTOR"}),m.jsx(Et,{value:"COMERCIAL",children:"COMERCIAL"}),m.jsx(Et,{value:"LOGISTICA",children:"LOGISTICA"}),m.jsx(Et,{value:"VENDEDOR",children:"VENDEDOR"})]})]})]}),z==="VENDEDOR"&&m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{children:"Vendedor *"}),m.jsxs(Ra,{value:De,onValueChange:P,children:[m.jsx(Ea,{children:m.jsx(Fa,{placeholder:"Selecione o vendedor"})}),m.jsxs(Ta,{children:[h.map(Xe=>m.jsx(Et,{value:Xe,children:Xe},Xe)),h.length===0&&m.jsx(Et,{value:"",disabled:!0,children:"Nenhum vendedor cadastrado"})]})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{children:"Nova Senha (opcional)"}),m.jsx(Gr,{type:"password",value:X,onChange:Xe=>Y(Xe.target.value),placeholder:"Deixe em branco para manter a senha atual",minLength:6}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Mnimo de 6 caracteres. Deixe em branco para no alterar."})]})]}),m.jsxs(kT,{children:[m.jsx(Dt,{variant:"outline",onClick:()=>{q(null),Y("")},children:"Cancelar"}),m.jsx(Dt,{onClick:nt,children:"Salvar Alteraes"})]})]})]}),m.jsx(Dt,{variant:"ghost",size:"icon",onClick:()=>st(Ee.id,Ee.name),disabled:Ee.id===(e==null?void 0:e.id),children:m.jsx(nu,{className:"h-4 w-4 text-destructive"})})]})})]},Ee.id))})]})})})]})]})]})]})}function QH(e,t=[]){let r=[];function a(o,l){const u=K.createContext(l);u.displayName=o+"Context";const f=r.length;r=[...r,l];const h=v=>{var T;const{scope:p,children:_,...b}=v,w=((T=p==null?void 0:p[e])==null?void 0:T[f])||u,S=K.useMemo(()=>b,Object.values(b));return m.jsx(w.Provider,{value:S,children:_})};h.displayName=o+"Provider";function g(v,p){var w;const _=((w=p==null?void 0:p[e])==null?void 0:w[f])||u,b=K.useContext(_);if(b)return b;if(l!==void 0)return l;throw new Error(`\`${v}\` must be used within \`${o}\``)}return[h,g]}const n=()=>{const o=r.map(l=>K.createContext(l));return function(u){const f=(u==null?void 0:u[e])||o;return K.useMemo(()=>({[`__scope${e}`]:{...u,[e]:f}}),[u,f])}};return n.scopeName=e,[a,ZH(n,...t)]}function ZH(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const a=e.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(o){const l=a.reduce((u,{useScope:f,scopeName:h})=>{const v=f(o)[`__scope${h}`];return{...u,...v}},{});return K.useMemo(()=>({[`__scope${t.scopeName}`]:l}),[l])}};return r.scopeName=t.scopeName,r}var e$=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Kg=e$.reduce((e,t)=>{const r=B1(`Primitive.${t}`),a=K.forwardRef((n,o)=>{const{asChild:l,...u}=n,f=l?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),m.jsx(f,{...u,ref:o})});return a.displayName=`Primitive.${t}`,{...e,[t]:a}},{}),t$=U4();function r$(){return t$.useSyncExternalStore(a$,()=>!0,()=>!1)}function a$(){return()=>{}}var Jg="Avatar",[n$,E$]=QH(Jg),[s$,NT]=n$(Jg),DT=K.forwardRef((e,t)=>{const{__scopeAvatar:r,...a}=e,[n,o]=K.useState("idle");return m.jsx(s$,{scope:r,imageLoadingStatus:n,onImageLoadingStatusChange:o,children:m.jsx(Kg.span,{...a,ref:t})})});DT.displayName=Jg;var OT="AvatarImage",RT=K.forwardRef((e,t)=>{const{__scopeAvatar:r,src:a,onLoadingStatusChange:n=()=>{},...o}=e,l=NT(OT,r),u=i$(a,o),f=M1(h=>{n(h),l.onImageLoadingStatusChange(h)});return xu(()=>{u!=="idle"&&f(u)},[u,f]),u==="loaded"?m.jsx(Kg.img,{...o,ref:t,src:a}):null});RT.displayName=OT;var FT="AvatarFallback",MT=K.forwardRef((e,t)=>{const{__scopeAvatar:r,delayMs:a,...n}=e,o=NT(FT,r),[l,u]=K.useState(a===void 0);return K.useEffect(()=>{if(a!==void 0){const f=window.setTimeout(()=>u(!0),a);return()=>window.clearTimeout(f)}},[a]),l&&o.imageLoadingStatus!=="loaded"?m.jsx(Kg.span,{...n,ref:t}):null});MT.displayName=FT;function zw(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function i$(e,{referrerPolicy:t,crossOrigin:r}){const a=r$(),n=K.useRef(null),o=a?(n.current||(n.current=new window.Image),n.current):null,[l,u]=K.useState(()=>zw(o,e));return xu(()=>{u(zw(o,e))},[o,e]),xu(()=>{const f=v=>()=>{u(v)};if(!o)return;const h=f("loaded"),g=f("error");return o.addEventListener("load",h),o.addEventListener("error",g),t&&(o.referrerPolicy=t),typeof r=="string"&&(o.crossOrigin=r),()=>{o.removeEventListener("load",h),o.removeEventListener("error",g)}},[o,r,t]),l}var jT=DT,IT=RT,PT=MT;const LT=K.forwardRef(({className:e,...t},r)=>m.jsx(jT,{ref:r,className:Ye("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));LT.displayName=jT.displayName;const BT=K.forwardRef(({className:e,...t},r)=>m.jsx(IT,{ref:r,className:Ye("aspect-square h-full w-full",e),...t}));BT.displayName=IT.displayName;const UT=K.forwardRef(({className:e,...t},r)=>m.jsx(PT,{ref:r,className:Ye("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));UT.displayName=PT.displayName;function o$(){const{user:e}=jn(),{filters:t}=Bu(),[r,a]=K.useState(""),[n,o]=K.useState(!1),[l,u]=K.useState([]),[f,h]=K.useState({myReturnsCount:0,approvalRate:0,totalValue:0,avgCompanyTicket:0,avgCompanyReturns:0}),[g,v]=K.useState([]),[p,_]=K.useState("");K.useEffect(()=>{e&&(b(),(e.role==="ADMIN"||e.role==="GESTOR")&&w())},[e,t]);const b=async()=>{if(!e)return;let T=ot.from("devolucoes").select("*");e.role==="VENDEDOR"&&e.vendedor?T=T.eq("vendedor",e.vendedor):T=T.ilike("vendedor",`%${e.name}%`),t.startDate&&(T=T.gte("data_emissao",t.startDate.toISOString())),t.endDate&&(T=T.lte("data_emissao",t.endDate.toISOString()));const{data:N}=await T;let k=ot.from("devolucoes").select("*");t.startDate&&(k=k.gte("data_emissao",t.startDate.toISOString())),t.endDate&&(k=k.lte("data_emissao",t.endDate.toISOString()));const{data:E}=await k;if(N){const M=N.length,D=N.reduce((z,fe)=>z+(Number(fe.valor_total_nota)||0),0),A=N.filter(z=>z.resultado&&z.resultado!=="PENDENTE VALIDAO"),B=N.filter(z=>z.resultado==="VALIDADA"||z.resultado==="LANADA").length,j=A.length>0?B/A.length*100:0,ee=(E==null?void 0:E.length)||0,re=(E==null?void 0:E.reduce((z,fe)=>z+(Number(fe.valor_total_nota)||0),0))||0,U=ee>0?re/ee:0,I=M>0?D/M:0;h({myReturnsCount:M,totalValue:D,approvalRate:Math.round(j),avgCompanyTicket:U,avgCompanyReturns:ee});const ne=N.reduce((z,fe)=>{const De=new Date(fe.data_emissao||fe.created_at),P=ir(De,"MMM yyyy",{locale:da});return z[P]||(z[P]={count:0,value:0}),z[P].count+=1,z[P].value+=Number(fe.valor_total_nota)||0,z},{}),ie=Object.entries(ne).map(([z,fe])=>({name:z,quantidade:fe.count,valor:fe.value})).sort((z,fe)=>{var Re,Je;const De={jan:1,fev:2,mar:3,abr:4,mai:5,jun:6,jul:7,ago:8,set:9,out:10,nov:11,dez:12},P=z.name.toLowerCase().split(" "),X=fe.name.toLowerCase().split(" "),Y=De[((Re=P[0])==null?void 0:Re.substring(0,3))||""]||0,Q=De[((Je=X[0])==null?void 0:Je.substring(0,3))||""]||0,de=parseInt(P[1]||"0"),Fe=parseInt(X[1]||"0"),Te=new Date(de,Y-1),Oe=new Date(Fe,Q-1);return Te.getTime()-Oe.getTime()});v(ie);const q=I>U?"acima":I<U?"abaixo":"igual",ae=U>0?Math.abs((I-U)/U*100).toFixed(1):"0";let be=`Voc registrou ${M} devolues neste perodo, totalizando R$ ${D.toLocaleString("pt-BR")}. `;be+=`Sua taxa de aprovao  de ${Math.round(j)}%. `,M>0&&ee>0&&(be+=`Seu ticket mdio (R$ ${I.toLocaleString("pt-BR",{maximumFractionDigits:0})}) est ${q} da mdia da empresa (R$ ${U.toLocaleString("pt-BR",{maximumFractionDigits:0})}). `,q!=="igual"&&(be+=`Diferena de ${ae}%. `)),be+=`A empresa registrou ${ee} devolues no total neste perodo.`,_(be)}},w=async()=>{let T=ot.from("logs_validacao").select(`
            *,
            user:profiles(name, email),
            devolucao:devolucoes(numero, nome_cliente)
        `).order("created_at",{ascending:!1}).limit(50);t.startDate&&(T=T.gte("created_at",t.startDate.toISOString())),t.endDate&&(T=T.lte("created_at",t.endDate.toISOString()));const{data:N}=await T;N&&u(N)},S=async T=>{T.preventDefault(),o(!0);try{const{error:N}=await ot.auth.updateUser({password:r});if(N)throw N;Ke.success("Senha atualizada com sucesso!"),a("")}catch(N){Ke.error(N.message)}finally{o(!1)}};return e?m.jsxs("div",{className:"space-y-6",children:[m.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Meu Perfil"}),m.jsx(nd,{}),m.jsxs("div",{className:"grid gap-6 md:grid-cols-7",children:[m.jsxs(Vt,{className:"md:col-span-2 h-fit",children:[m.jsxs(Ht,{className:"text-center",children:[m.jsx("div",{className:"flex justify-center mb-4",children:m.jsxs(LT,{className:"h-24 w-24 border-4 border-primary/10",children:[m.jsx(BT,{src:e.avatar_url}),m.jsx(UT,{className:"text-2xl font-bold text-primary bg-primary/10",children:e.name.charAt(0).toUpperCase()})]})}),m.jsx($t,{children:e.name}),m.jsx(cn,{children:e.email}),m.jsx("div",{className:"mt-2",children:m.jsx(ln,{variant:"outline",className:"border-primary text-primary",children:e.role})})]}),m.jsx(Wt,{children:m.jsxs("div",{className:"space-y-4 text-sm bg-muted/30 p-4 rounded-lg",children:[m.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[m.jsx(s1,{className:"h-4 w-4 text-primary"}),m.jsxs("span",{className:"truncate",title:e.id,children:["ID: ",e.id.slice(0,8),"..."]})]}),m.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[m.jsx(bN,{className:"h-4 w-4 text-primary"}),m.jsx("span",{className:"truncate",title:e.email,children:e.email})]}),m.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[m.jsx(GN,{className:"h-4 w-4 text-primary"}),m.jsxs("span",{children:["Acesso: ",e.role]})]})]})})]}),m.jsxs(Vt,{className:"md:col-span-5",children:[m.jsxs(Ht,{children:[m.jsx($t,{children:"Painel do Usurio"}),m.jsx(cn,{children:"Suas mtricas e configuraes pessoais"})]}),m.jsx(Wt,{children:m.jsxs(bT,{defaultValue:"overview",children:[m.jsxs(Xg,{className:"w-full justify-start",children:[m.jsx(Ri,{value:"overview",children:"Viso Geral"}),(e.role==="ADMIN"||e.role==="GESTOR")&&m.jsx(Ri,{value:"audit",children:"Histrico de Validaes"}),m.jsx(Ri,{value:"security",children:"Segurana"})]}),m.jsxs(Fi,{value:"overview",className:"space-y-6 mt-6",children:[m.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[m.jsxs(Vt,{className:"bg-primary/5 border-primary/20",children:[m.jsxs(Ht,{className:"pb-2 flex flex-row items-center justify-between",children:[m.jsx($t,{className:"text-sm font-medium text-muted-foreground",children:"Minhas Devolues"}),m.jsx(DN,{className:"h-4 w-4 text-primary"})]}),m.jsxs(Wt,{children:[m.jsx("div",{className:"text-2xl font-bold text-foreground",children:f.myReturnsCount}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"No perodo selecionado"})]})]}),m.jsxs(Vt,{children:[m.jsxs(Ht,{className:"pb-2 flex flex-row items-center justify-between",children:[m.jsx($t,{className:"text-sm font-medium text-muted-foreground",children:"Valor Envolvido"}),m.jsx(S2,{className:"h-4 w-4 text-muted-foreground"})]}),m.jsxs(Wt,{children:[m.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",f.totalValue.toLocaleString("pt-BR",{maximumFractionDigits:0})]}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Total devolvido"})]})]}),m.jsxs(Vt,{children:[m.jsxs(Ht,{className:"pb-2 flex flex-row items-center justify-between",children:[m.jsx($t,{className:"text-sm font-medium text-muted-foreground",children:"Taxa de Aprovao"}),m.jsx(zy,{className:"h-4 w-4 text-muted-foreground"})]}),m.jsxs(Wt,{children:[m.jsxs("div",{className:"text-2xl font-bold",children:[f.approvalRate,"%"]}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Das devolues finalizadas"})]})]})]}),g.length>0&&m.jsxs(Vt,{children:[m.jsxs(Ht,{children:[m.jsx($t,{children:"Minhas Devolues no Tempo"}),m.jsx(cn,{children:"Evoluo mensal das suas devolues"})]}),m.jsx(Wt,{children:m.jsx(co,{width:"100%",height:300,children:m.jsxs(z4,{data:g,children:[m.jsx(Nl,{strokeDasharray:"3 3",className:"stroke-muted/30"}),m.jsx(Dl,{dataKey:"name",className:"text-xs"}),m.jsx(ki,{yAxisId:"left",className:"text-xs"}),m.jsx(ki,{yAxisId:"right",orientation:"right",className:"text-xs",tickFormatter:T=>`R$${T}`}),m.jsx(uo,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)",color:"var(--foreground)"},formatter:(T,N)=>N==="quantidade"?[T,"Quantidade"]:N==="valor"?[`R$ ${(T||0).toLocaleString("pt-BR")}`,"Valor"]:[T,N||""]}),m.jsx(n2,{}),m.jsx(t1,{yAxisId:"left",type:"monotone",dataKey:"quantidade",stroke:"#073e29",strokeWidth:2,name:"Quantidade"}),m.jsx(t1,{yAxisId:"right",type:"monotone",dataKey:"valor",stroke:"#4a9170",strokeWidth:2,name:"Valor (R$)"})]})})})]}),f.myReturnsCount>0&&f.avgCompanyReturns>0&&m.jsxs(Vt,{children:[m.jsx(Ht,{children:m.jsx($t,{children:"Comparao com Mdia da Empresa"})}),m.jsxs(Wt,{children:[m.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx("div",{className:"text-sm text-muted-foreground",children:"Seu Ticket Mdio"}),m.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",f.myReturnsCount>0?(f.totalValue/f.myReturnsCount).toLocaleString("pt-BR",{maximumFractionDigits:0}):"0"]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("div",{className:"text-sm text-muted-foreground",children:"Ticket Mdio da Empresa"}),m.jsxs("div",{className:"text-2xl font-bold text-muted-foreground",children:["R$ ",f.avgCompanyTicket.toLocaleString("pt-BR",{maximumFractionDigits:0})]})]})]}),f.myReturnsCount>0&&m.jsx("div",{className:"mt-4 p-3 bg-muted/50 rounded-lg",children:m.jsx("div",{className:"text-sm",children:f.totalValue/f.myReturnsCount>f.avgCompanyTicket?m.jsxs("span",{className:"text-orange-600 dark:text-orange-400",children:[" Seu ticket mdio est ",(f.totalValue/f.myReturnsCount/f.avgCompanyTicket*100-100).toFixed(1),"% acima da mdia da empresa."]}):f.totalValue/f.myReturnsCount<f.avgCompanyTicket?m.jsxs("span",{className:"text-green-600 dark:text-green-400",children:[" Seu ticket mdio est ",(100-f.totalValue/f.myReturnsCount/f.avgCompanyTicket*100).toFixed(1),"% abaixo da mdia da empresa."]}):m.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:" Seu ticket mdio est igual  mdia da empresa."})})})]})]}),m.jsxs("div",{className:"rounded-lg border p-6 bg-card flex items-start gap-4 shadow-sm",children:[m.jsx("div",{className:"p-3 bg-primary/10 rounded-full",children:m.jsx(zy,{className:"h-6 w-6 text-primary"})}),m.jsxs("div",{children:[m.jsx("h3",{className:"font-semibold text-lg mb-1",children:"Resumo Automtico"}),m.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:p||(f.myReturnsCount>0?`Voc registrou ${f.myReturnsCount} devolues neste perodo, totalizando R$ ${f.totalValue.toLocaleString("pt-BR")}. Sua taxa de aprovao atual  de ${f.approvalRate}%.`:"Nenhuma atividade registrada para o perodo selecionado. Ajuste os filtros acima para ver seu histrico.")})]})]})]}),m.jsx(Fi,{value:"audit",className:"mt-6",children:m.jsx("div",{className:"rounded-md border",children:m.jsxs(Jn,{children:[m.jsx(vs,{children:m.jsxs(Tr,{children:[m.jsx(gt,{children:"Data"}),m.jsx(gt,{children:"Usurio"}),m.jsx(gt,{children:"Nota Fiscal"}),m.jsx(gt,{children:"Ao"}),m.jsx(gt,{children:"Status Anterior"})]})}),m.jsxs(Qn,{children:[l.map(T=>{var N,k,E;return m.jsxs(Tr,{children:[m.jsx(At,{className:"text-xs",children:ir(new Date(T.created_at),"dd/MM/yyyy HH:mm")}),m.jsx(At,{className:"font-medium",children:((N=T.user)==null?void 0:N.name)||"Sistema"}),m.jsx(At,{children:((k=T.devolucao)==null?void 0:k.numero)||((E=T.devolucao_id)==null?void 0:E.slice(0,8))||"-"}),m.jsx(At,{children:m.jsx(ln,{variant:T.acao==="SELECIONAR_MOTIVO"||T.status_novo==="VALIDADA"?"default":T.status_novo==="TRATATIVA DE ANULAO"?"destructive":"secondary",children:T.acao==="SELECIONAR_MOTIVO"?"Validou":T.acao==="ALTERAR_RESULTADO"?"Alterou Resultado":T.acao||"Ao"})}),m.jsxs(At,{className:"text-muted-foreground text-xs",children:[T.status_anterior,"  ",T.status_novo]})]},T.id)}),l.length===0&&m.jsx(Tr,{children:m.jsxs(At,{colSpan:5,className:"text-center py-12 text-muted-foreground",children:[m.jsx(mN,{className:"h-10 w-10 mx-auto mb-3 opacity-20"}),m.jsx("p",{children:"Nenhum registro de validao encontrado."})]})})]})]})})}),m.jsx(Fi,{value:"security",className:"mt-6",children:m.jsxs(Vt,{children:[m.jsxs(Ht,{children:[m.jsx($t,{children:"Alterar Senha"}),m.jsx(cn,{children:"Escolha uma senha forte para proteger sua conta."})]}),m.jsx(Wt,{children:m.jsxs("form",{onSubmit:S,className:"space-y-4 max-w-md",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(Zr,{htmlFor:"new-password",children:"Nova Senha"}),m.jsx(Gr,{id:"new-password",type:"password",value:r,onChange:T=>a(T.target.value),placeholder:"Mnimo de 6 caracteres",minLength:6})]}),m.jsx(Dt,{type:"submit",disabled:n||!r,children:n?"Atualizando...":"Atualizar Senha"})]})})]})})]})})]})]})]}):null}function l$({className:e,isOpen:t=!1,onClose:r}){const{user:a,logout:n}=jn(),o=D4(),l=()=>{const g=document.querySelector("html");g&&(g.classList.contains("dark")?g.classList.remove("dark"):g.classList.add("dark"))};if(!a)return null;console.log("Sidebar - User role:",a.role,"Tipo:",typeof a.role);const u=[{label:"Dashboard",icon:pN,href:"/dashboard",roles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"]},{label:"Validao",icon:A0,href:"/validation",roles:["COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"]},{label:"Relatrios",icon:oN,href:"/reports",roles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"]},{label:"Sincronizao",icon:b2,href:"/sync",roles:["LOGISTICA","ADMIN"]},{label:"Configuraes",icon:VN,href:"/settings",roles:["ADMIN"]}],f=typeof a.role=="string"?a.role.toUpperCase():a.role;console.log("Sidebar - Filtrando rotas com role:",f);const h=u.filter(g=>g.roles.includes(f));return console.log("Sidebar - Rotas filtradas:",h.map(g=>g.label)),m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:Ye("hidden lg:flex pb-12 w-64 border-r bg-card h-screen fixed left-0 top-0 z-30 shadow-lg flex-col dark:border-r-zinc-800 transition-transform duration-300 ease-in-out",t?"translate-x-0":"-translate-x-full",e),onClick:g=>g.stopPropagation(),children:[m.jsxs("div",{className:"px-6 py-8 flex flex-col items-center border-b border-border/50",children:[m.jsx("div",{className:"h-24 w-24 relative mb-3 bg-white rounded-full p-2 shadow-sm flex items-center justify-center overflow-hidden",children:m.jsx("img",{src:"https://i.ibb.co/b095hpJ/Chat-GPT-Image-25-de-dez-de-2025-15-24-45.png",alt:"Logo Doce Mel",className:"object-contain h-full w-full"})}),m.jsx("h2",{className:"text-xl font-bold tracking-tight text-primary font-serif",children:"Doce Mel"}),m.jsx("p",{className:"text-[10px] text-muted-foreground uppercase tracking-widest mt-1",children:"Gesto de Devolues"})]}),m.jsx("div",{className:"flex-1 overflow-y-auto py-4 px-3",children:m.jsx("div",{className:"space-y-1",children:h.map(g=>m.jsx(c0,{to:g.href,children:m.jsxs(Dt,{variant:o.pathname===g.href?"secondary":"ghost",className:Ye("w-full justify-start transition-all duration-200 mb-1",o.pathname===g.href?"bg-primary/10 text-primary font-bold border-r-4 border-primary rounded-r-none dark:text-primary dark:bg-primary/20":"hover:bg-muted text-muted-foreground hover:text-foreground"),children:[m.jsx(g.icon,{className:Ye("mr-3 h-4 w-4",o.pathname===g.href?"text-primary":"text-muted-foreground")}),g.label]})},g.href))})}),m.jsxs("div",{className:"p-4 border-t border-border/50 bg-muted/10",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[m.jsx("span",{className:"text-xs font-semibold text-muted-foreground",children:"Tema"}),m.jsxs(Dt,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:l,children:[m.jsx(Gy,{className:"h-4 w-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),m.jsx(Hy,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"})]})]}),m.jsxs("div",{className:"space-y-1 mb-4",children:[m.jsx(c0,{to:"/profile",children:m.jsxs(Dt,{variant:o.pathname==="/profile"?"secondary":"ghost",className:"w-full justify-start h-9",children:[m.jsx(s1,{className:"mr-2 h-4 w-4"}),"Perfil"]})}),m.jsxs(Dt,{variant:"ghost",className:"w-full justify-start text-destructive hover:text-destructive hover:bg-destructive/10 h-9",onClick:n,children:[m.jsx(Vy,{className:"mr-2 h-4 w-4"}),"Sair"]})]}),m.jsxs("div",{className:"flex items-center gap-3 px-2 py-2 rounded-lg bg-card border shadow-sm",children:[m.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/20 flex items-center justify-center text-primary font-bold text-xs",children:a.name.charAt(0).toUpperCase()}),m.jsxs("div",{className:"flex-1 overflow-hidden",children:[m.jsx("p",{className:"text-sm font-bold truncate text-foreground leading-none",children:a.name}),m.jsx("p",{className:"text-[10px] text-muted-foreground mt-1 truncate",children:a.role})]})]})]})]}),m.jsxs("div",{className:Ye("lg:hidden pb-12 w-64 border-r bg-card h-screen fixed left-0 top-0 z-40 shadow-lg flex flex-col dark:border-r-zinc-800 transition-transform duration-300 ease-in-out",t?"translate-x-0":"-translate-x-full",e),onClick:g=>g.stopPropagation(),children:[m.jsxs("div",{className:"px-6 py-8 flex flex-col items-center border-b border-border/50 relative",children:[m.jsx(Dt,{variant:"ghost",size:"icon",className:"absolute top-4 right-4",onClick:r,children:m.jsx(Q0,{className:"h-5 w-5"})}),m.jsx("div",{className:"h-24 w-24 relative mb-3 bg-white rounded-full p-2 shadow-sm flex items-center justify-center overflow-hidden",children:m.jsx("img",{src:"https://i.ibb.co/b095hpJ/Chat-GPT-Image-25-de-dez-de-2025-15-24-45.png",alt:"Logo Doce Mel",className:"object-contain h-full w-full"})}),m.jsx("h2",{className:"text-xl font-bold tracking-tight text-primary font-serif",children:"Doce Mel"}),m.jsx("p",{className:"text-[10px] text-muted-foreground uppercase tracking-widest mt-1",children:"Gesto de Devolues"})]}),m.jsx("div",{className:"flex-1 overflow-y-auto py-4 px-3",children:m.jsx("div",{className:"space-y-1",children:h.map(g=>m.jsx(c0,{to:g.href,onClick:r,children:m.jsxs(Dt,{variant:o.pathname===g.href?"secondary":"ghost",className:Ye("w-full justify-start transition-all duration-200 mb-1",o.pathname===g.href?"bg-primary/10 text-primary font-bold border-r-4 border-primary rounded-r-none dark:text-primary dark:bg-primary/20":"hover:bg-muted text-muted-foreground hover:text-foreground"),children:[m.jsx(g.icon,{className:Ye("mr-3 h-4 w-4",o.pathname===g.href?"text-primary":"text-muted-foreground")}),g.label]})},g.href))})}),m.jsxs("div",{className:"p-4 border-t border-border/50 bg-muted/10",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[m.jsx("span",{className:"text-xs font-semibold text-muted-foreground",children:"Tema"}),m.jsxs(Dt,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:l,children:[m.jsx(Gy,{className:"h-4 w-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),m.jsx(Hy,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"})]})]}),m.jsxs("div",{className:"space-y-1 mb-4",children:[m.jsx(c0,{to:"/profile",onClick:r,children:m.jsxs(Dt,{variant:o.pathname==="/profile"?"secondary":"ghost",className:"w-full justify-start h-9",children:[m.jsx(s1,{className:"mr-2 h-4 w-4"}),"Perfil"]})}),m.jsxs(Dt,{variant:"ghost",className:"w-full justify-start text-destructive hover:text-destructive hover:bg-destructive/10 h-9",onClick:n,children:[m.jsx(Vy,{className:"mr-2 h-4 w-4"}),"Sair"]})]}),m.jsxs("div",{className:"flex items-center gap-3 px-2 py-2 rounded-lg bg-card border shadow-sm",children:[m.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/20 flex items-center justify-center text-primary font-bold text-xs",children:a.name.charAt(0).toUpperCase()}),m.jsxs("div",{className:"flex-1 overflow-hidden",children:[m.jsx("p",{className:"text-sm font-bold truncate text-foreground leading-none",children:a.name}),m.jsx("p",{className:"text-[10px] text-muted-foreground mt-1 truncate",children:a.role})]})]})]})]})]})}function c$(){const[e,t]=K.useState(!0),r=()=>{t(!e)},a=()=>{t(!1)};return m.jsxs("div",{className:"flex h-screen bg-background relative",children:[e&&m.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:a}),m.jsx(Dt,{variant:"ghost",size:"icon",className:"fixed top-4 left-4 z-50",onClick:r,children:e?m.jsx(Q0,{className:"h-6 w-6"}):m.jsx(kN,{className:"h-6 w-6"})}),m.jsx(l$,{isOpen:e,onClose:a}),m.jsx("main",{className:`flex-1 overflow-y-auto transition-all duration-300 ${e?"lg:ml-64":"lg:ml-0"} pt-16 lg:pt-0`,onClick:()=>{e&&a()},children:m.jsx("div",{className:"p-4 lg:p-6",children:m.jsx(O4,{})})})]})}var u$=(e,t,r,a,n,o,l,u)=>{let f=document.documentElement,h=["light","dark"];function g(_){(Array.isArray(e)?e:[e]).forEach(b=>{let w=b==="class",S=w&&o?n.map(T=>o[T]||T):n;w?(f.classList.remove(...S),f.classList.add(o&&o[_]?o[_]:_)):f.setAttribute(b,_)}),v(_)}function v(_){u&&h.includes(_)&&(f.style.colorScheme=_)}function p(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(a)g(a);else try{let _=localStorage.getItem(t)||r,b=l&&_==="system"?p():_;g(b)}catch{}},f$=K.createContext(void 0),d$={setTheme:e=>{},themes:[]},h$=()=>{var e;return(e=K.useContext(f$))!=null?e:d$};K.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:a,enableColorScheme:n,defaultTheme:o,value:l,themes:u,nonce:f,scriptProps:h})=>{let g=JSON.stringify([r,t,o,e,u,l,a,n]).slice(1,-1);return K.createElement("script",{...h,suppressHydrationWarning:!0,nonce:typeof window>"u"?f:"",dangerouslySetInnerHTML:{__html:`(${u$.toString()})(${g})`}})});const m$=({...e})=>{const{theme:t="system"}=h$();return m.jsx(dF,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};function g$(){return m.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background",children:m.jsxs("div",{className:"max-w-md p-8 space-y-4 text-center",children:[m.jsx("div",{className:"text-destructive",children:m.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),m.jsx("h1",{className:"text-2xl font-bold",children:"Erro de Configurao"}),m.jsx("p",{className:"text-muted-foreground",children:"As variveis de ambiente do Supabase no esto configuradas."}),m.jsxs("p",{className:"text-sm text-muted-foreground",children:["Crie um arquivo ",m.jsx("code",{className:"px-2 py-1 bg-muted rounded",children:".env"})," na raiz do projeto com:"]}),m.jsx("pre",{className:"p-4 text-left bg-muted rounded-lg text-sm",children:`VITE_SUPABASE_URL=sua_url_aqui
VITE_SUPABASE_ANON_KEY=sua_chave_aqui`}),m.jsx("p",{className:"text-sm text-muted-foreground",children:"Aps configurar, reinicie o servidor de desenvolvimento."})]})})}function x$({children:e}){const{user:t,isLoading:r}=jn();return console.log("ProtectedRoute - isLoading:",r,"user:",t==null?void 0:t.email),r?m.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[m.jsx(Do,{className:"h-8 w-8 animate-spin text-primary"}),m.jsx("p",{className:"ml-4 text-sm text-muted-foreground",children:"Carregando..."})]}):t?m.jsx(m.Fragment,{children:e}):(console.log("ProtectedRoute - Redirecionando para /login"),m.jsx(C0,{to:"/login",replace:!0}))}function e1({children:e,allowedRoles:t}){const{user:r,isLoading:a}=jn();if(a)return m.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[m.jsx(Do,{className:"h-8 w-8 animate-spin text-primary"}),m.jsx("p",{className:"ml-4 text-sm text-muted-foreground",children:"Carregando..."})]});if(!r)return m.jsx(C0,{to:"/login",replace:!0});const n=typeof r.role=="string"?r.role.toUpperCase():r.role;return t.includes(n)?m.jsx(m.Fragment,{children:e}):(console.warn(` Acesso negado: usurio ${r.email} (${n}) tentou acessar rota permitida apenas para:`,t),m.jsx(C0,{to:"/dashboard",replace:!0}))}function v$(){const{setUser:e,setIsLoading:t}=jn(),[r,a]=K.useState(!1);return K.useEffect(()=>{let n=!0;console.log(" App - Inicializando autenticao...");const o=setTimeout(()=>{n&&(console.warn(" Timeout - forando setIsLoading(false)"),t(!1))},8e3),l=async(f,h)=>{var _,b,w;console.log(" Carregando perfil para:",h,"userId:",f);let g=null,v=!1;try{const S=Date.now(),T=ot.from("profiles").select("id, email, name, role, vendedor").eq("id",f).maybeSingle(),N=new Promise((A,B)=>{setTimeout(()=>{v||B(new Error("Query timeout aps 2 segundos"))},2e3)}),k=await Promise.race([T,N]);v=!0;const{data:E,error:M}=k,D=Date.now()-S;if(console.log(` Query executada em ${D}ms`),E&&!M){let A="COMERCIAL";if(E.role){const B=String(E.role).trim().toUpperCase();console.log(" Role processado:",B),["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"].includes(B)?A=B:console.warn(" Role invlido no banco:",B,"- usando COMERCIAL")}else console.warn(" Role est vazio no banco - usando COMERCIAL");return g={id:E.id,email:h,name:E.name||h.split("@")[0],role:A,vendedor:E.vendedor||null},console.log(" Perfil carregado do banco:",g),g}else console.warn(" Sem dados do perfil no banco. Erro:",M)}catch(S){v=!0,console.warn(" Timeout ou erro na query do banco, tentando fallback...",(S==null?void 0:S.message)||S)}try{console.log(" Tentando fallback 1: metadata do auth...");const{data:S,error:T}=await ot.auth.getUser();if(!T&&(S!=null&&S.user)){const N=(_=S.user.user_metadata)==null?void 0:_.role,k=N&&["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"].includes(String(N).toUpperCase())?String(N).toUpperCase():"COMERCIAL",E={id:f,email:h,name:((b=S.user.user_metadata)==null?void 0:b.name)||h.split("@")[0],role:k,vendedor:((w=S.user.user_metadata)==null?void 0:w.vendedor)||null};return console.log(" Usando fallback (metadata):",E),E}else console.warn(" Metadata retornou erro ou sem dados:",T)}catch(S){console.warn(" Erro ao buscar metadata:",S)}const p={id:f,email:h,name:h.split("@")[0],role:"COMERCIAL",vendedor:null};return console.log(" Usando fallback final (COMERCIAL) - query do banco falhou:",p),p},{data:{subscription:u}}=ot.auth.onAuthStateChange(async(f,h)=>{var g;if(console.log(" Auth mudou:",f,(g=h==null?void 0:h.user)==null?void 0:g.email),!!n){if(f==="TOKEN_REFRESHED"){console.log(" Token renovado - mantendo perfil atual");return}if(f!=="SIGNED_IN"&&f!=="SIGNED_OUT"&&f!=="USER_UPDATED"){console.log(" Evento ignorado:",f);return}try{if(h!=null&&h.user){const p=jn.getState().user;if(p&&p.id===h.user.id&&f!=="USER_UPDATED"){console.log(" Usurio j carregado, mantendo perfil atual:",p.role);return}const _=l(h.user.id,h.user.email),b=new Promise(S=>{setTimeout(()=>{const N=jn.getState().user;N&&N.id===h.user.id?(console.log(" Timeout - mantendo perfil atual:",N.role),S(N)):S({id:h.user.id,email:h.user.email,name:h.user.email.split("@")[0],role:"COMERCIAL",vendedor:null})},3e3)}),w=await Promise.race([_,b]);n&&w&&(console.log(" Usurio setado:",{email:w.email,role:w.role,name:w.name,id:w.id,vendedor:w.vendedor}),e(w))}else n&&(console.log(" Sem sesso"),e(null))}catch(v){console.error(" Erro no listener de auth:",v);const _=jn.getState().user;if(n&&(h!=null&&h.user)&&_&&_.id===h.user.id)console.log(" Erro ao recarregar - mantendo perfil atual:",_.role);else if(n&&(h!=null&&h.user)){const b={id:h.user.id,email:h.user.email,name:h.user.email.split("@")[0],role:"COMERCIAL",vendedor:null};console.log(" Usando perfil mnimo devido a erro:",b),e(b)}else e(null)}finally{n&&(t(!1),clearTimeout(o))}}});return ot.auth.getSession().then(async({data:{session:f}})=>{if(n)try{if(f!=null&&f.user){console.log(" Sesso encontrada:",f.user.email);const h=l(f.user.id,f.user.email),g=new Promise(p=>{setTimeout(()=>{p({id:f.user.id,email:f.user.email,name:f.user.email.split("@")[0],role:"COMERCIAL",vendedor:null})},3e3)}),v=await Promise.race([h,g]);n&&v&&(console.log(" Setando usurio inicial:",{email:v.email,role:v.role,name:v.name,vendedor:v.vendedor}),e(v))}else console.log(" Sem sesso inicial"),n&&e(null)}catch(h){if(console.error(" Erro ao carregar sesso inicial:",h),n&&(f!=null&&f.user)){const g={id:f.user.id,email:f.user.email,name:f.user.email.split("@")[0],role:"COMERCIAL",vendedor:null};console.log(" Usando perfil mnimo devido a erro:",g),e(g)}else e(null)}finally{n&&(t(!1),clearTimeout(o))}}).catch(f=>{console.error(" Erro ao verificar sesso:",f),n&&(e(null),t(!1),clearTimeout(o))}),()=>{console.log(" Cleanup"),n=!1,clearTimeout(o),u.unsubscribe()}},[e,t]),r?m.jsx(g$,{}):m.jsxs(R4,{children:[m.jsxs(F4,{children:[m.jsx(Ls,{path:"/login",element:m.jsx(bF,{})}),m.jsxs(Ls,{path:"/",element:m.jsx(x$,{children:m.jsx(c$,{})}),children:[m.jsx(Ls,{index:!0,element:m.jsx(C0,{to:"/dashboard",replace:!0})}),m.jsx(Ls,{path:"dashboard",element:m.jsx(gF,{})}),m.jsx(Ls,{path:"validation",element:m.jsx(e1,{allowedRoles:["COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"],children:m.jsx(RH,{})})}),m.jsx(Ls,{path:"reports",element:m.jsx(kH,{})}),m.jsx(Ls,{path:"sync",element:m.jsx(e1,{allowedRoles:["LOGISTICA","ADMIN"],children:m.jsx(AH,{})})}),m.jsx(Ls,{path:"settings",element:m.jsx(e1,{allowedRoles:["ADMIN"],children:m.jsx(JH,{})})}),m.jsx(Ls,{path:"profile",element:m.jsx(o$,{})})]})]}),m.jsx(m$,{})]})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log(" Service Worker registrado com sucesso:",e.scope)}).catch(e=>{console.warn(" Falha ao registrar Service Worker:",e)})});q4.createRoot(document.getElementById("root")).render(m.jsx(v$,{}));
