import{j as w,c as e2,T as t2,I as v5,S as r2,a as a2,P as b5,C as n2,V as x5,L as s2,b as i2,d as y5,e as w5,f as o2,R as _5,g as S5,h as Uf,u as Uu,i as k5,k as E5,o as T5,s as A5,l as C5,m as N5,n as j5,p as O5,q as D5,r as M5,t as um,v as xu,w as Ms,x as R5,y as dm,z as I5,A as F5,B as P5,D as cn,E as L5,F as B5,G as U5,H as fm,J as hm,_ as z5,K as zf,M as $5,N as V5,O as l2,Q as c2,U as H5,W as u2,X as q5,Y as d2,Z as W5,$ as f2,a0 as h2,a1 as G5,a2 as Y5,a3 as X5,a4 as p2}from"./ui-vendor-C68SU9xL.js";import{d as K5,e as Z5,r as Se,R as Xe,b as J5,c as Q5,u as e8,f as ur,g as t8,h as m2,L as sf,O as r8,B as a8,i as n8,j as Qn,N as Fo}from"./react-vendor-D3tagoQh.js";import{c as g2,R as Jr,A as v2,C as ca,X as ua,Y as $r,T as Qr,a as b2,L as Xl,B as Ya,b as Na,d as Fa,e as x2,P as s8,f as i8,g as o8,h as y2,r as l8,i as c8}from"./chart-vendor-9iNHXFEB.js";import{_ as u8}from"./pdf-vendor-ckwbz45p.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function e(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=e(n);fetch(n.href,o)}})();var J0={exports:{}},Jc={},Q0={exports:{}},ep={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bb;function d8(){return Bb||(Bb=1,function(t){function r(_,k){var A=_.length;_.push(k);e:for(;0<A;){var T=A-1>>>1,D=_[T];if(0<n(D,k))_[T]=k,_[A]=D,A=T;else break e}}function e(_){return _.length===0?null:_[0]}function a(_){if(_.length===0)return null;var k=_[0],A=_.pop();if(A!==k){_[0]=A;e:for(var T=0,D=_.length,B=D>>>1;T<B;){var F=2*(T+1)-1,Y=_[F],X=F+1,re=_[X];if(0>n(Y,A))X<D&&0>n(re,Y)?(_[T]=re,_[X]=A,T=X):(_[T]=Y,_[F]=A,T=F);else if(X<D&&0>n(re,A))_[T]=re,_[X]=A,T=X;else break e}}return k}function n(_,k){var A=_.sortIndex-k.sortIndex;return A!==0?A:_.id-k.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],i=[],u=1,p=null,f=3,h=!1,v=!1,b=!1,g=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function N(_){for(var k=e(i);k!==null;){if(k.callback===null)a(i);else if(k.startTime<=_)a(i),k.sortIndex=k.expirationTime,r(c,k);else break;k=e(i)}}function I(_){if(b=!1,N(_),!v)if(e(c)!==null)v=!0,P||(P=!0,W());else{var k=e(i);k!==null&&C(I,k.startTime-_)}}var P=!1,V=-1,U=5,H=-1;function G(){return g?!0:!(t.unstable_now()-H<U)}function Z(){if(g=!1,P){var _=t.unstable_now();H=_;var k=!0;try{e:{v=!1,b&&(b=!1,y(V),V=-1),h=!0;var A=f;try{t:{for(N(_),p=e(c);p!==null&&!(p.expirationTime>_&&G());){var T=p.callback;if(typeof T=="function"){p.callback=null,f=p.priorityLevel;var D=T(p.expirationTime<=_);if(_=t.unstable_now(),typeof D=="function"){p.callback=D,N(_),k=!0;break t}p===e(c)&&a(c),N(_)}else a(c);p=e(c)}if(p!==null)k=!0;else{var B=e(i);B!==null&&C(I,B.startTime-_),k=!1}}break e}finally{p=null,f=A,h=!1}k=void 0}}finally{k?W():P=!1}}}var W;if(typeof E=="function")W=function(){E(Z)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,R=O.port2;O.port1.onmessage=Z,W=function(){R.postMessage(null)}}else W=function(){x(Z,0)};function C(_,k){V=x(function(){_(t.unstable_now())},k)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_){_.callback=null},t.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<_?Math.floor(1e3/_):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(_){switch(f){case 1:case 2:case 3:var k=3;break;default:k=f}var A=f;f=k;try{return _()}finally{f=A}},t.unstable_requestPaint=function(){g=!0},t.unstable_runWithPriority=function(_,k){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var A=f;f=_;try{return k()}finally{f=A}},t.unstable_scheduleCallback=function(_,k,A){var T=t.unstable_now();switch(typeof A=="object"&&A!==null?(A=A.delay,A=typeof A=="number"&&0<A?T+A:T):A=T,_){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=A+D,_={id:u++,callback:k,priorityLevel:_,startTime:A,expirationTime:D,sortIndex:-1},A>T?(_.sortIndex=A,r(i,_),e(c)===null&&_===e(i)&&(b?(y(V),V=-1):b=!0,C(I,A-T))):(_.sortIndex=D,r(c,_),v||h||(v=!0,P||(P=!0,W()))),_},t.unstable_shouldYield=G,t.unstable_wrapCallback=function(_){var k=f;return function(){var A=f;f=k;try{return _.apply(this,arguments)}finally{f=A}}}}(ep)),ep}var Ub;function f8(){return Ub||(Ub=1,Q0.exports=d8()),Q0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zb;function h8(){if(zb)return Jc;zb=1;var t=f8(),r=K5(),e=Z5();function a(d){var m="https://react.dev/errors/"+d;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var S=2;S<arguments.length;S++)m+="&args[]="+encodeURIComponent(arguments[S])}return"Minified React error #"+d+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function o(d){var m=d,S=d;if(d.alternate)for(;m.return;)m=m.return;else{d=m;do m=d,(m.flags&4098)!==0&&(S=m.return),d=m.return;while(d)}return m.tag===3?S:null}function s(d){if(d.tag===13){var m=d.memoizedState;if(m===null&&(d=d.alternate,d!==null&&(m=d.memoizedState)),m!==null)return m.dehydrated}return null}function l(d){if(o(d)!==d)throw Error(a(188))}function c(d){var m=d.alternate;if(!m){if(m=o(d),m===null)throw Error(a(188));return m!==d?null:d}for(var S=d,j=m;;){var q=S.return;if(q===null)break;var J=q.alternate;if(J===null){if(j=q.return,j!==null){S=j;continue}break}if(q.child===J.child){for(J=q.child;J;){if(J===S)return l(q),d;if(J===j)return l(q),m;J=J.sibling}throw Error(a(188))}if(S.return!==j.return)S=q,j=J;else{for(var oe=!1,ge=q.child;ge;){if(ge===S){oe=!0,S=q,j=J;break}if(ge===j){oe=!0,j=q,S=J;break}ge=ge.sibling}if(!oe){for(ge=J.child;ge;){if(ge===S){oe=!0,S=J,j=q;break}if(ge===j){oe=!0,j=J,S=q;break}ge=ge.sibling}if(!oe)throw Error(a(189))}}if(S.alternate!==j)throw Error(a(190))}if(S.tag!==3)throw Error(a(188));return S.stateNode.current===S?d:m}function i(d){var m=d.tag;if(m===5||m===26||m===27||m===6)return d;for(d=d.child;d!==null;){if(m=i(d),m!==null)return m;d=d.sibling}return null}var u=Object.assign,p=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),h=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),y=Symbol.for("react.consumer"),E=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),V=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),H=Symbol.for("react.activity"),G=Symbol.for("react.memo_cache_sentinel"),Z=Symbol.iterator;function W(d){return d===null||typeof d!="object"?null:(d=Z&&d[Z]||d["@@iterator"],typeof d=="function"?d:null)}var O=Symbol.for("react.client.reference");function R(d){if(d==null)return null;if(typeof d=="function")return d.$$typeof===O?null:d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case v:return"Fragment";case g:return"Profiler";case b:return"StrictMode";case I:return"Suspense";case P:return"SuspenseList";case H:return"Activity"}if(typeof d=="object")switch(d.$$typeof){case h:return"Portal";case E:return(d.displayName||"Context")+".Provider";case y:return(d._context.displayName||"Context")+".Consumer";case N:var m=d.render;return d=d.displayName,d||(d=m.displayName||m.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case V:return m=d.displayName||null,m!==null?m:R(d.type)||"Memo";case U:m=d._payload,d=d._init;try{return R(d(m))}catch{}}return null}var C=Array.isArray,_=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,k=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,A={pending:!1,data:null,method:null,action:null},T=[],D=-1;function B(d){return{current:d}}function F(d){0>D||(d.current=T[D],T[D]=null,D--)}function Y(d,m){D++,T[D]=d.current,d.current=m}var X=B(null),re=B(null),z=B(null),ee=B(null);function L(d,m){switch(Y(z,m),Y(re,d),Y(X,null),m.nodeType){case 9:case 11:d=(d=m.documentElement)&&(d=d.namespaceURI)?hb(d):0;break;default:if(d=m.tagName,m=m.namespaceURI)m=hb(m),d=pb(m,d);else switch(d){case"svg":d=1;break;case"math":d=2;break;default:d=0}}F(X),Y(X,d)}function M(){F(X),F(re),F(z)}function K(d){d.memoizedState!==null&&Y(ee,d);var m=X.current,S=pb(m,d.type);m!==S&&(Y(re,d),Y(X,S))}function se(d){re.current===d&&(F(X),F(re)),ee.current===d&&(F(ee),Gc._currentValue=A)}var te=Object.prototype.hasOwnProperty,ae=t.unstable_scheduleCallback,Q=t.unstable_cancelCallback,fe=t.unstable_shouldYield,le=t.unstable_requestPaint,ne=t.unstable_now,ue=t.unstable_getCurrentPriorityLevel,he=t.unstable_ImmediatePriority,ke=t.unstable_UserBlockingPriority,pe=t.unstable_NormalPriority,Ce=t.unstable_LowPriority,Me=t.unstable_IdlePriority,Ie=t.log,Ye=t.unstable_setDisableYieldValue,at=null,rt=null;function it(d){if(typeof Ie=="function"&&Ye(d),rt&&typeof rt.setStrictMode=="function")try{rt.setStrictMode(at,d)}catch{}}var et=Math.clz32?Math.clz32:ht,st=Math.log,je=Math.LN2;function ht(d){return d>>>=0,d===0?32:31-(st(d)/je|0)|0}var Je=256,nt=4194304;function ct(d){var m=d&42;if(m!==0)return m;switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return d&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return d}}function _t(d,m,S){var j=d.pendingLanes;if(j===0)return 0;var q=0,J=d.suspendedLanes,oe=d.pingedLanes;d=d.warmLanes;var ge=j&134217727;return ge!==0?(j=ge&~J,j!==0?q=ct(j):(oe&=ge,oe!==0?q=ct(oe):S||(S=ge&~d,S!==0&&(q=ct(S))))):(ge=j&~J,ge!==0?q=ct(ge):oe!==0?q=ct(oe):S||(S=j&~d,S!==0&&(q=ct(S)))),q===0?0:m!==0&&m!==q&&(m&J)===0&&(J=q&-q,S=m&-m,J>=S||J===32&&(S&4194048)!==0)?m:q}function mt(d,m){return(d.pendingLanes&~(d.suspendedLanes&~d.pingedLanes)&m)===0}function gt(d,m){switch(d){case 1:case 2:case 4:case 8:case 64:return m+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function He(){var d=Je;return Je<<=1,(Je&4194048)===0&&(Je=256),d}function Ue(){var d=nt;return nt<<=1,(nt&62914560)===0&&(nt=4194304),d}function bt(d){for(var m=[],S=0;31>S;S++)m.push(d);return m}function tt(d,m){d.pendingLanes|=m,m!==268435456&&(d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0)}function dt(d,m,S,j,q,J){var oe=d.pendingLanes;d.pendingLanes=S,d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0,d.expiredLanes&=S,d.entangledLanes&=S,d.errorRecoveryDisabledLanes&=S,d.shellSuspendCounter=0;var ge=d.entanglements,Ne=d.expirationTimes,Ge=d.hiddenUpdates;for(S=oe&~S;0<S;){var lt=31-et(S),pt=1<<lt;ge[lt]=0,Ne[lt]=-1;var Ke=Ge[lt];if(Ke!==null)for(Ge[lt]=null,lt=0;lt<Ke.length;lt++){var Ze=Ke[lt];Ze!==null&&(Ze.lane&=-536870913)}S&=~pt}j!==0&&ut(d,j,0),J!==0&&q===0&&d.tag!==0&&(d.suspendedLanes|=J&~(oe&~m))}function ut(d,m,S){d.pendingLanes|=m,d.suspendedLanes&=~m;var j=31-et(m);d.entangledLanes|=m,d.entanglements[j]=d.entanglements[j]|1073741824|S&4194090}function vt(d,m){var S=d.entangledLanes|=m;for(d=d.entanglements;S;){var j=31-et(S),q=1<<j;q&m|d[j]&m&&(d[j]|=m),S&=~q}}function xt(d){switch(d){case 2:d=1;break;case 8:d=4;break;case 32:d=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:d=128;break;case 268435456:d=134217728;break;default:d=0}return d}function At(d){return d&=-d,2<d?8<d?(d&134217727)!==0?32:268435456:8:2}function Kt(){var d=k.p;return d!==0?d:(d=window.event,d===void 0?32:Mb(d.type))}function yt(d,m){var S=k.p;try{return k.p=d,m()}finally{k.p=S}}var Ct=Math.random().toString(36).slice(2),Ft="__reactFiber$"+Ct,kt="__reactProps$"+Ct,Ae="__reactContainer$"+Ct,Fe="__reactEvents$"+Ct,Qe="__reactListeners$"+Ct,ie="__reactHandles$"+Ct,_e="__reactResources$"+Ct,de="__reactMarker$"+Ct;function ve(d){delete d[Ft],delete d[kt],delete d[Fe],delete d[Qe],delete d[ie]}function be(d){var m=d[Ft];if(m)return m;for(var S=d.parentNode;S;){if(m=S[Ae]||S[Ft]){if(S=m.alternate,m.child!==null||S!==null&&S.child!==null)for(d=bb(d);d!==null;){if(S=d[Ft])return S;d=bb(d)}return m}d=S,S=d.parentNode}return null}function we(d){if(d=d[Ft]||d[Ae]){var m=d.tag;if(m===5||m===6||m===13||m===26||m===27||m===3)return d}return null}function De(d){var m=d.tag;if(m===5||m===26||m===27||m===6)return d.stateNode;throw Error(a(33))}function Le(d){var m=d[_e];return m||(m=d[_e]={hoistableStyles:new Map,hoistableScripts:new Map}),m}function Oe(d){d[de]=!0}var Pe=new Set,Be={};function xe(d,m){Ee(d,m),Ee(d+"Capture",m)}function Ee(d,m){for(Be[d]=m,d=0;d<m.length;d++)Pe.add(m[d])}var qe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ce={},Te={};function me(d){return te.call(Te,d)?!0:te.call(ce,d)?!1:qe.test(d)?Te[d]=!0:(ce[d]=!0,!1)}function ye(d,m,S){if(me(m))if(S===null)d.removeAttribute(m);else{switch(typeof S){case"undefined":case"function":case"symbol":d.removeAttribute(m);return;case"boolean":var j=m.toLowerCase().slice(0,5);if(j!=="data-"&&j!=="aria-"){d.removeAttribute(m);return}}d.setAttribute(m,""+S)}}function Ve(d,m,S){if(S===null)d.removeAttribute(m);else{switch(typeof S){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(m);return}d.setAttribute(m,""+S)}}function $e(d,m,S,j){if(j===null)d.removeAttribute(S);else{switch(typeof j){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(S);return}d.setAttributeNS(m,S,""+j)}}var ot,Rt;function Bt(d){if(ot===void 0)try{throw Error()}catch(S){var m=S.stack.trim().match(/\n( *(at )?)/);ot=m&&m[1]||"",Rt=-1<S.stack.indexOf(`
    at`)?" (<anonymous>)":-1<S.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ot+d+Rt}var Vt=!1;function Lt(d,m){if(!d||Vt)return"";Vt=!0;var S=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var j={DetermineComponentFrameRoot:function(){try{if(m){var pt=function(){throw Error()};if(Object.defineProperty(pt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(pt,[])}catch(Ze){var Ke=Ze}Reflect.construct(d,[],pt)}else{try{pt.call()}catch(Ze){Ke=Ze}d.call(pt.prototype)}}else{try{throw Error()}catch(Ze){Ke=Ze}(pt=d())&&typeof pt.catch=="function"&&pt.catch(function(){})}}catch(Ze){if(Ze&&Ke&&typeof Ze.stack=="string")return[Ze.stack,Ke.stack]}return[null,null]}};j.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var q=Object.getOwnPropertyDescriptor(j.DetermineComponentFrameRoot,"name");q&&q.configurable&&Object.defineProperty(j.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var J=j.DetermineComponentFrameRoot(),oe=J[0],ge=J[1];if(oe&&ge){var Ne=oe.split(`
`),Ge=ge.split(`
`);for(q=j=0;j<Ne.length&&!Ne[j].includes("DetermineComponentFrameRoot");)j++;for(;q<Ge.length&&!Ge[q].includes("DetermineComponentFrameRoot");)q++;if(j===Ne.length||q===Ge.length)for(j=Ne.length-1,q=Ge.length-1;1<=j&&0<=q&&Ne[j]!==Ge[q];)q--;for(;1<=j&&0<=q;j--,q--)if(Ne[j]!==Ge[q]){if(j!==1||q!==1)do if(j--,q--,0>q||Ne[j]!==Ge[q]){var lt=`
`+Ne[j].replace(" at new "," at ");return d.displayName&&lt.includes("<anonymous>")&&(lt=lt.replace("<anonymous>",d.displayName)),lt}while(1<=j&&0<=q);break}}}finally{Vt=!1,Error.prepareStackTrace=S}return(S=d?d.displayName||d.name:"")?Bt(S):""}function er(d){switch(d.tag){case 26:case 27:case 5:return Bt(d.type);case 16:return Bt("Lazy");case 13:return Bt("Suspense");case 19:return Bt("SuspenseList");case 0:case 15:return Lt(d.type,!1);case 11:return Lt(d.type.render,!1);case 1:return Lt(d.type,!0);case 31:return Bt("Activity");default:return""}}function gr(d){try{var m="";do m+=er(d),d=d.return;while(d);return m}catch(S){return`
Error generating stack: `+S.message+`
`+S.stack}}function tr(d){switch(typeof d){case"bigint":case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Mr(d){var m=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function ea(d){var m=Mr(d)?"checked":"value",S=Object.getOwnPropertyDescriptor(d.constructor.prototype,m),j=""+d[m];if(!d.hasOwnProperty(m)&&typeof S<"u"&&typeof S.get=="function"&&typeof S.set=="function"){var q=S.get,J=S.set;return Object.defineProperty(d,m,{configurable:!0,get:function(){return q.call(this)},set:function(oe){j=""+oe,J.call(this,oe)}}),Object.defineProperty(d,m,{enumerable:S.enumerable}),{getValue:function(){return j},setValue:function(oe){j=""+oe},stopTracking:function(){d._valueTracker=null,delete d[m]}}}}function ta(d){d._valueTracker||(d._valueTracker=ea(d))}function tn(d){if(!d)return!1;var m=d._valueTracker;if(!m)return!0;var S=m.getValue(),j="";return d&&(j=Mr(d)?d.checked?"true":"false":d.value),d=j,d!==S?(m.setValue(d),!0):!1}function An(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}var ui=/[\n"\\]/g;function fa(d){return d.replace(ui,function(m){return"\\"+m.charCodeAt(0).toString(16)+" "})}function ds(d,m,S,j,q,J,oe,ge){d.name="",oe!=null&&typeof oe!="function"&&typeof oe!="symbol"&&typeof oe!="boolean"?d.type=oe:d.removeAttribute("type"),m!=null?oe==="number"?(m===0&&d.value===""||d.value!=m)&&(d.value=""+tr(m)):d.value!==""+tr(m)&&(d.value=""+tr(m)):oe!=="submit"&&oe!=="reset"||d.removeAttribute("value"),m!=null?ir(d,oe,tr(m)):S!=null?ir(d,oe,tr(S)):j!=null&&d.removeAttribute("value"),q==null&&J!=null&&(d.defaultChecked=!!J),q!=null&&(d.checked=q&&typeof q!="function"&&typeof q!="symbol"),ge!=null&&typeof ge!="function"&&typeof ge!="symbol"&&typeof ge!="boolean"?d.name=""+tr(ge):d.removeAttribute("name")}function vr(d,m,S,j,q,J,oe,ge){if(J!=null&&typeof J!="function"&&typeof J!="symbol"&&typeof J!="boolean"&&(d.type=J),m!=null||S!=null){if(!(J!=="submit"&&J!=="reset"||m!=null))return;S=S!=null?""+tr(S):"",m=m!=null?""+tr(m):S,ge||m===d.value||(d.value=m),d.defaultValue=m}j=j??q,j=typeof j!="function"&&typeof j!="symbol"&&!!j,d.checked=ge?d.checked:!!j,d.defaultChecked=!!j,oe!=null&&typeof oe!="function"&&typeof oe!="symbol"&&typeof oe!="boolean"&&(d.name=oe)}function ir(d,m,S){m==="number"&&An(d.ownerDocument)===d||d.defaultValue===""+S||(d.defaultValue=""+S)}function Wa(d,m,S,j){if(d=d.options,m){m={};for(var q=0;q<S.length;q++)m["$"+S[q]]=!0;for(S=0;S<d.length;S++)q=m.hasOwnProperty("$"+d[S].value),d[S].selected!==q&&(d[S].selected=q),q&&j&&(d[S].defaultSelected=!0)}else{for(S=""+tr(S),m=null,q=0;q<d.length;q++){if(d[q].value===S){d[q].selected=!0,j&&(d[q].defaultSelected=!0);return}m!==null||d[q].disabled||(m=d[q])}m!==null&&(m.selected=!0)}}function fs(d,m,S){if(m!=null&&(m=""+tr(m),m!==d.value&&(d.value=m),S==null)){d.defaultValue!==m&&(d.defaultValue=m);return}d.defaultValue=S!=null?""+tr(S):""}function no(d,m,S,j){if(m==null){if(j!=null){if(S!=null)throw Error(a(92));if(C(j)){if(1<j.length)throw Error(a(93));j=j[0]}S=j}S==null&&(S=""),m=S}S=tr(m),d.defaultValue=S,j=d.textContent,j===S&&j!==""&&j!==null&&(d.value=j)}function ra(d,m){if(m){var S=d.firstChild;if(S&&S===d.lastChild&&S.nodeType===3){S.nodeValue=m;return}}d.textContent=m}var Wn=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Gn(d,m,S){var j=m.indexOf("--")===0;S==null||typeof S=="boolean"||S===""?j?d.setProperty(m,""):m==="float"?d.cssFloat="":d[m]="":j?d.setProperty(m,S):typeof S!="number"||S===0||Wn.has(m)?m==="float"?d.cssFloat=S:d[m]=(""+S).trim():d[m]=S+"px"}function di(d,m,S){if(m!=null&&typeof m!="object")throw Error(a(62));if(d=d.style,S!=null){for(var j in S)!S.hasOwnProperty(j)||m!=null&&m.hasOwnProperty(j)||(j.indexOf("--")===0?d.setProperty(j,""):j==="float"?d.cssFloat="":d[j]="");for(var q in m)j=m[q],m.hasOwnProperty(q)&&S[q]!==j&&Gn(d,q,j)}else for(var J in m)m.hasOwnProperty(J)&&Gn(d,J,m[J])}function fi(d){if(d.indexOf("-")===-1)return!1;switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hi=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function so(d){return hs.test(""+d)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":d}var pi=null;function io(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var Yn=null,Xn=null;function sc(d){var m=we(d);if(m&&(d=m.stateNode)){var S=d[kt]||null;e:switch(d=m.stateNode,m.type){case"input":if(ds(d,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name),m=S.name,S.type==="radio"&&m!=null){for(S=d;S.parentNode;)S=S.parentNode;for(S=S.querySelectorAll('input[name="'+fa(""+m)+'"][type="radio"]'),m=0;m<S.length;m++){var j=S[m];if(j!==d&&j.form===d.form){var q=j[kt]||null;if(!q)throw Error(a(90));ds(j,q.value,q.defaultValue,q.defaultValue,q.checked,q.defaultChecked,q.type,q.name)}}for(m=0;m<S.length;m++)j=S[m],j.form===d.form&&tn(j)}break e;case"textarea":fs(d,S.value,S.defaultValue);break e;case"select":m=S.value,m!=null&&Wa(d,!!S.multiple,m,!1)}}}var mi=!1;function oo(d,m,S){if(mi)return d(m,S);mi=!0;try{var j=d(m);return j}finally{if(mi=!1,(Yn!==null||Xn!==null)&&(Ld(),Yn&&(m=Yn,d=Xn,Xn=Yn=null,sc(m),d)))for(m=0;m<d.length;m++)sc(d[m])}}function ic(d,m){var S=d.stateNode;if(S===null)return null;var j=S[kt]||null;if(j===null)return null;S=j[m];e:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(j=!j.disabled)||(d=d.type,j=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!j;break e;default:d=!1}if(d)return null;if(S&&typeof S!="function")throw Error(a(231,m,typeof S));return S}var Ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),th=!1;if(Ps)try{var oc={};Object.defineProperty(oc,"passive",{get:function(){th=!0}}),window.addEventListener("test",oc,oc),window.removeEventListener("test",oc,oc)}catch{th=!1}var gi=null,rh=null,ed=null;function v1(){if(ed)return ed;var d,m=rh,S=m.length,j,q="value"in gi?gi.value:gi.textContent,J=q.length;for(d=0;d<S&&m[d]===q[d];d++);var oe=S-d;for(j=1;j<=oe&&m[S-j]===q[J-j];j++);return ed=q.slice(d,1<j?1-j:void 0)}function td(d){var m=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&m===13&&(d=13)):d=m,d===10&&(d=13),32<=d||d===13?d:0}function rd(){return!0}function b1(){return!1}function rn(d){function m(S,j,q,J,oe){this._reactName=S,this._targetInst=q,this.type=j,this.nativeEvent=J,this.target=oe,this.currentTarget=null;for(var ge in d)d.hasOwnProperty(ge)&&(S=d[ge],this[ge]=S?S(J):J[ge]);return this.isDefaultPrevented=(J.defaultPrevented!=null?J.defaultPrevented:J.returnValue===!1)?rd:b1,this.isPropagationStopped=b1,this}return u(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var S=this.nativeEvent;S&&(S.preventDefault?S.preventDefault():typeof S.returnValue!="unknown"&&(S.returnValue=!1),this.isDefaultPrevented=rd)},stopPropagation:function(){var S=this.nativeEvent;S&&(S.stopPropagation?S.stopPropagation():typeof S.cancelBubble!="unknown"&&(S.cancelBubble=!0),this.isPropagationStopped=rd)},persist:function(){},isPersistent:rd}),m}var lo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ad=rn(lo),lc=u({},lo,{view:0,detail:0}),v3=rn(lc),ah,nh,cc,nd=u({},lc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ih,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==cc&&(cc&&d.type==="mousemove"?(ah=d.screenX-cc.screenX,nh=d.screenY-cc.screenY):nh=ah=0,cc=d),ah)},movementY:function(d){return"movementY"in d?d.movementY:nh}}),x1=rn(nd),b3=u({},nd,{dataTransfer:0}),x3=rn(b3),y3=u({},lc,{relatedTarget:0}),sh=rn(y3),w3=u({},lo,{animationName:0,elapsedTime:0,pseudoElement:0}),_3=rn(w3),S3=u({},lo,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),k3=rn(S3),E3=u({},lo,{data:0}),y1=rn(E3),T3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},A3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},C3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function N3(d){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(d):(d=C3[d])?!!m[d]:!1}function ih(){return N3}var j3=u({},lc,{key:function(d){if(d.key){var m=T3[d.key]||d.key;if(m!=="Unidentified")return m}return d.type==="keypress"?(d=td(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?A3[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ih,charCode:function(d){return d.type==="keypress"?td(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?td(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),O3=rn(j3),D3=u({},nd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),w1=rn(D3),M3=u({},lc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ih}),R3=rn(M3),I3=u({},lo,{propertyName:0,elapsedTime:0,pseudoElement:0}),F3=rn(I3),P3=u({},nd,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),L3=rn(P3),B3=u({},lo,{newState:0,oldState:0}),U3=rn(B3),z3=[9,13,27,32],oh=Ps&&"CompositionEvent"in window,uc=null;Ps&&"documentMode"in document&&(uc=document.documentMode);var $3=Ps&&"TextEvent"in window&&!uc,_1=Ps&&(!oh||uc&&8<uc&&11>=uc),S1=" ",k1=!1;function E1(d,m){switch(d){case"keyup":return z3.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function T1(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var Yo=!1;function V3(d,m){switch(d){case"compositionend":return T1(m);case"keypress":return m.which!==32?null:(k1=!0,S1);case"textInput":return d=m.data,d===S1&&k1?null:d;default:return null}}function H3(d,m){if(Yo)return d==="compositionend"||!oh&&E1(d,m)?(d=v1(),ed=rh=gi=null,Yo=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return _1&&m.locale!=="ko"?null:m.data;default:return null}}var q3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function A1(d){var m=d&&d.nodeName&&d.nodeName.toLowerCase();return m==="input"?!!q3[d.type]:m==="textarea"}function C1(d,m,S,j){Yn?Xn?Xn.push(j):Xn=[j]:Yn=j,m=Hd(m,"onChange"),0<m.length&&(S=new ad("onChange","change",null,S,j),d.push({event:S,listeners:m}))}var dc=null,fc=null;function W3(d){lb(d,0)}function sd(d){var m=De(d);if(tn(m))return d}function N1(d,m){if(d==="change")return m}var j1=!1;if(Ps){var lh;if(Ps){var ch="oninput"in document;if(!ch){var O1=document.createElement("div");O1.setAttribute("oninput","return;"),ch=typeof O1.oninput=="function"}lh=ch}else lh=!1;j1=lh&&(!document.documentMode||9<document.documentMode)}function D1(){dc&&(dc.detachEvent("onpropertychange",M1),fc=dc=null)}function M1(d){if(d.propertyName==="value"&&sd(fc)){var m=[];C1(m,fc,d,io(d)),oo(W3,m)}}function G3(d,m,S){d==="focusin"?(D1(),dc=m,fc=S,dc.attachEvent("onpropertychange",M1)):d==="focusout"&&D1()}function Y3(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return sd(fc)}function X3(d,m){if(d==="click")return sd(m)}function K3(d,m){if(d==="input"||d==="change")return sd(m)}function Z3(d,m){return d===m&&(d!==0||1/d===1/m)||d!==d&&m!==m}var un=typeof Object.is=="function"?Object.is:Z3;function hc(d,m){if(un(d,m))return!0;if(typeof d!="object"||d===null||typeof m!="object"||m===null)return!1;var S=Object.keys(d),j=Object.keys(m);if(S.length!==j.length)return!1;for(j=0;j<S.length;j++){var q=S[j];if(!te.call(m,q)||!un(d[q],m[q]))return!1}return!0}function R1(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function I1(d,m){var S=R1(d);d=0;for(var j;S;){if(S.nodeType===3){if(j=d+S.textContent.length,d<=m&&j>=m)return{node:S,offset:m-d};d=j}e:{for(;S;){if(S.nextSibling){S=S.nextSibling;break e}S=S.parentNode}S=void 0}S=R1(S)}}function F1(d,m){return d&&m?d===m?!0:d&&d.nodeType===3?!1:m&&m.nodeType===3?F1(d,m.parentNode):"contains"in d?d.contains(m):d.compareDocumentPosition?!!(d.compareDocumentPosition(m)&16):!1:!1}function P1(d){d=d!=null&&d.ownerDocument!=null&&d.ownerDocument.defaultView!=null?d.ownerDocument.defaultView:window;for(var m=An(d.document);m instanceof d.HTMLIFrameElement;){try{var S=typeof m.contentWindow.location.href=="string"}catch{S=!1}if(S)d=m.contentWindow;else break;m=An(d.document)}return m}function uh(d){var m=d&&d.nodeName&&d.nodeName.toLowerCase();return m&&(m==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||m==="textarea"||d.contentEditable==="true")}var J3=Ps&&"documentMode"in document&&11>=document.documentMode,Xo=null,dh=null,pc=null,fh=!1;function L1(d,m,S){var j=S.window===S?S.document:S.nodeType===9?S:S.ownerDocument;fh||Xo==null||Xo!==An(j)||(j=Xo,"selectionStart"in j&&uh(j)?j={start:j.selectionStart,end:j.selectionEnd}:(j=(j.ownerDocument&&j.ownerDocument.defaultView||window).getSelection(),j={anchorNode:j.anchorNode,anchorOffset:j.anchorOffset,focusNode:j.focusNode,focusOffset:j.focusOffset}),pc&&hc(pc,j)||(pc=j,j=Hd(dh,"onSelect"),0<j.length&&(m=new ad("onSelect","select",null,m,S),d.push({event:m,listeners:j}),m.target=Xo)))}function co(d,m){var S={};return S[d.toLowerCase()]=m.toLowerCase(),S["Webkit"+d]="webkit"+m,S["Moz"+d]="moz"+m,S}var Ko={animationend:co("Animation","AnimationEnd"),animationiteration:co("Animation","AnimationIteration"),animationstart:co("Animation","AnimationStart"),transitionrun:co("Transition","TransitionRun"),transitionstart:co("Transition","TransitionStart"),transitioncancel:co("Transition","TransitionCancel"),transitionend:co("Transition","TransitionEnd")},hh={},B1={};Ps&&(B1=document.createElement("div").style,"AnimationEvent"in window||(delete Ko.animationend.animation,delete Ko.animationiteration.animation,delete Ko.animationstart.animation),"TransitionEvent"in window||delete Ko.transitionend.transition);function uo(d){if(hh[d])return hh[d];if(!Ko[d])return d;var m=Ko[d],S;for(S in m)if(m.hasOwnProperty(S)&&S in B1)return hh[d]=m[S];return d}var U1=uo("animationend"),z1=uo("animationiteration"),$1=uo("animationstart"),Q3=uo("transitionrun"),e6=uo("transitionstart"),t6=uo("transitioncancel"),V1=uo("transitionend"),H1=new Map,ph="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ph.push("scrollEnd");function Kn(d,m){H1.set(d,m),xe(m,[d])}var q1=new WeakMap;function Cn(d,m){if(typeof d=="object"&&d!==null){var S=q1.get(d);return S!==void 0?S:(m={value:d,source:m,stack:gr(m)},q1.set(d,m),m)}return{value:d,source:m,stack:gr(m)}}var Nn=[],Zo=0,mh=0;function id(){for(var d=Zo,m=mh=Zo=0;m<d;){var S=Nn[m];Nn[m++]=null;var j=Nn[m];Nn[m++]=null;var q=Nn[m];Nn[m++]=null;var J=Nn[m];if(Nn[m++]=null,j!==null&&q!==null){var oe=j.pending;oe===null?q.next=q:(q.next=oe.next,oe.next=q),j.pending=q}J!==0&&W1(S,q,J)}}function od(d,m,S,j){Nn[Zo++]=d,Nn[Zo++]=m,Nn[Zo++]=S,Nn[Zo++]=j,mh|=j,d.lanes|=j,d=d.alternate,d!==null&&(d.lanes|=j)}function gh(d,m,S,j){return od(d,m,S,j),ld(d)}function Jo(d,m){return od(d,null,null,m),ld(d)}function W1(d,m,S){d.lanes|=S;var j=d.alternate;j!==null&&(j.lanes|=S);for(var q=!1,J=d.return;J!==null;)J.childLanes|=S,j=J.alternate,j!==null&&(j.childLanes|=S),J.tag===22&&(d=J.stateNode,d===null||d._visibility&1||(q=!0)),d=J,J=J.return;return d.tag===3?(J=d.stateNode,q&&m!==null&&(q=31-et(S),d=J.hiddenUpdates,j=d[q],j===null?d[q]=[m]:j.push(m),m.lane=S|536870912),J):null}function ld(d){if(50<Bc)throw Bc=0,_0=null,Error(a(185));for(var m=d.return;m!==null;)d=m,m=d.return;return d.tag===3?d.stateNode:null}var Qo={};function r6(d,m,S,j){this.tag=d,this.key=S,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=j,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dn(d,m,S,j){return new r6(d,m,S,j)}function vh(d){return d=d.prototype,!(!d||!d.isReactComponent)}function Ls(d,m){var S=d.alternate;return S===null?(S=dn(d.tag,m,d.key,d.mode),S.elementType=d.elementType,S.type=d.type,S.stateNode=d.stateNode,S.alternate=d,d.alternate=S):(S.pendingProps=m,S.type=d.type,S.flags=0,S.subtreeFlags=0,S.deletions=null),S.flags=d.flags&65011712,S.childLanes=d.childLanes,S.lanes=d.lanes,S.child=d.child,S.memoizedProps=d.memoizedProps,S.memoizedState=d.memoizedState,S.updateQueue=d.updateQueue,m=d.dependencies,S.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},S.sibling=d.sibling,S.index=d.index,S.ref=d.ref,S.refCleanup=d.refCleanup,S}function G1(d,m){d.flags&=65011714;var S=d.alternate;return S===null?(d.childLanes=0,d.lanes=m,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=S.childLanes,d.lanes=S.lanes,d.child=S.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=S.memoizedProps,d.memoizedState=S.memoizedState,d.updateQueue=S.updateQueue,d.type=S.type,m=S.dependencies,d.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext}),d}function cd(d,m,S,j,q,J){var oe=0;if(j=d,typeof d=="function")vh(d)&&(oe=1);else if(typeof d=="string")oe=n5(d,S,X.current)?26:d==="html"||d==="head"||d==="body"?27:5;else e:switch(d){case H:return d=dn(31,S,m,q),d.elementType=H,d.lanes=J,d;case v:return fo(S.children,q,J,m);case b:oe=8,q|=24;break;case g:return d=dn(12,S,m,q|2),d.elementType=g,d.lanes=J,d;case I:return d=dn(13,S,m,q),d.elementType=I,d.lanes=J,d;case P:return d=dn(19,S,m,q),d.elementType=P,d.lanes=J,d;default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case x:case E:oe=10;break e;case y:oe=9;break e;case N:oe=11;break e;case V:oe=14;break e;case U:oe=16,j=null;break e}oe=29,S=Error(a(130,d===null?"null":typeof d,"")),j=null}return m=dn(oe,S,m,q),m.elementType=d,m.type=j,m.lanes=J,m}function fo(d,m,S,j){return d=dn(7,d,j,m),d.lanes=S,d}function bh(d,m,S){return d=dn(6,d,null,m),d.lanes=S,d}function xh(d,m,S){return m=dn(4,d.children!==null?d.children:[],d.key,m),m.lanes=S,m.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},m}var el=[],tl=0,ud=null,dd=0,jn=[],On=0,ho=null,Bs=1,Us="";function po(d,m){el[tl++]=dd,el[tl++]=ud,ud=d,dd=m}function Y1(d,m,S){jn[On++]=Bs,jn[On++]=Us,jn[On++]=ho,ho=d;var j=Bs;d=Us;var q=32-et(j)-1;j&=~(1<<q),S+=1;var J=32-et(m)+q;if(30<J){var oe=q-q%5;J=(j&(1<<oe)-1).toString(32),j>>=oe,q-=oe,Bs=1<<32-et(m)+q|S<<q|j,Us=J+d}else Bs=1<<J|S<<q|j,Us=d}function yh(d){d.return!==null&&(po(d,1),Y1(d,1,0))}function wh(d){for(;d===ud;)ud=el[--tl],el[tl]=null,dd=el[--tl],el[tl]=null;for(;d===ho;)ho=jn[--On],jn[On]=null,Us=jn[--On],jn[On]=null,Bs=jn[--On],jn[On]=null}var Ga=null,Hr=null,wr=!1,mo=null,ps=!1,_h=Error(a(519));function go(d){var m=Error(a(418,""));throw vc(Cn(m,d)),_h}function X1(d){var m=d.stateNode,S=d.type,j=d.memoizedProps;switch(m[Ft]=d,m[kt]=j,S){case"dialog":cr("cancel",m),cr("close",m);break;case"iframe":case"object":case"embed":cr("load",m);break;case"video":case"audio":for(S=0;S<zc.length;S++)cr(zc[S],m);break;case"source":cr("error",m);break;case"img":case"image":case"link":cr("error",m),cr("load",m);break;case"details":cr("toggle",m);break;case"input":cr("invalid",m),vr(m,j.value,j.defaultValue,j.checked,j.defaultChecked,j.type,j.name,!0),ta(m);break;case"select":cr("invalid",m);break;case"textarea":cr("invalid",m),no(m,j.value,j.defaultValue,j.children),ta(m)}S=j.children,typeof S!="string"&&typeof S!="number"&&typeof S!="bigint"||m.textContent===""+S||j.suppressHydrationWarning===!0||fb(m.textContent,S)?(j.popover!=null&&(cr("beforetoggle",m),cr("toggle",m)),j.onScroll!=null&&cr("scroll",m),j.onScrollEnd!=null&&cr("scrollend",m),j.onClick!=null&&(m.onclick=qd),m=!0):m=!1,m||go(d)}function K1(d){for(Ga=d.return;Ga;)switch(Ga.tag){case 5:case 13:ps=!1;return;case 27:case 3:ps=!0;return;default:Ga=Ga.return}}function mc(d){if(d!==Ga)return!1;if(!wr)return K1(d),wr=!0,!1;var m=d.tag,S;if((S=m!==3&&m!==27)&&((S=m===5)&&(S=d.type,S=!(S!=="form"&&S!=="button")||L0(d.type,d.memoizedProps)),S=!S),S&&Hr&&go(d),K1(d),m===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(a(317));e:{for(d=d.nextSibling,m=0;d;){if(d.nodeType===8)if(S=d.data,S==="/$"){if(m===0){Hr=Jn(d.nextSibling);break e}m--}else S!=="$"&&S!=="$!"&&S!=="$?"||m++;d=d.nextSibling}Hr=null}}else m===27?(m=Hr,Di(d.type)?(d=$0,$0=null,Hr=d):Hr=m):Hr=Ga?Jn(d.stateNode.nextSibling):null;return!0}function gc(){Hr=Ga=null,wr=!1}function Z1(){var d=mo;return d!==null&&(sn===null?sn=d:sn.push.apply(sn,d),mo=null),d}function vc(d){mo===null?mo=[d]:mo.push(d)}var Sh=B(null),vo=null,zs=null;function vi(d,m,S){Y(Sh,m._currentValue),m._currentValue=S}function $s(d){d._currentValue=Sh.current,F(Sh)}function kh(d,m,S){for(;d!==null;){var j=d.alternate;if((d.childLanes&m)!==m?(d.childLanes|=m,j!==null&&(j.childLanes|=m)):j!==null&&(j.childLanes&m)!==m&&(j.childLanes|=m),d===S)break;d=d.return}}function Eh(d,m,S,j){var q=d.child;for(q!==null&&(q.return=d);q!==null;){var J=q.dependencies;if(J!==null){var oe=q.child;J=J.firstContext;e:for(;J!==null;){var ge=J;J=q;for(var Ne=0;Ne<m.length;Ne++)if(ge.context===m[Ne]){J.lanes|=S,ge=J.alternate,ge!==null&&(ge.lanes|=S),kh(J.return,S,d),j||(oe=null);break e}J=ge.next}}else if(q.tag===18){if(oe=q.return,oe===null)throw Error(a(341));oe.lanes|=S,J=oe.alternate,J!==null&&(J.lanes|=S),kh(oe,S,d),oe=null}else oe=q.child;if(oe!==null)oe.return=q;else for(oe=q;oe!==null;){if(oe===d){oe=null;break}if(q=oe.sibling,q!==null){q.return=oe.return,oe=q;break}oe=oe.return}q=oe}}function bc(d,m,S,j){d=null;for(var q=m,J=!1;q!==null;){if(!J){if((q.flags&524288)!==0)J=!0;else if((q.flags&262144)!==0)break}if(q.tag===10){var oe=q.alternate;if(oe===null)throw Error(a(387));if(oe=oe.memoizedProps,oe!==null){var ge=q.type;un(q.pendingProps.value,oe.value)||(d!==null?d.push(ge):d=[ge])}}else if(q===ee.current){if(oe=q.alternate,oe===null)throw Error(a(387));oe.memoizedState.memoizedState!==q.memoizedState.memoizedState&&(d!==null?d.push(Gc):d=[Gc])}q=q.return}d!==null&&Eh(m,d,S,j),m.flags|=262144}function fd(d){for(d=d.firstContext;d!==null;){if(!un(d.context._currentValue,d.memoizedValue))return!0;d=d.next}return!1}function bo(d){vo=d,zs=null,d=d.dependencies,d!==null&&(d.firstContext=null)}function Ra(d){return J1(vo,d)}function hd(d,m){return vo===null&&bo(d),J1(d,m)}function J1(d,m){var S=m._currentValue;if(m={context:m,memoizedValue:S,next:null},zs===null){if(d===null)throw Error(a(308));zs=m,d.dependencies={lanes:0,firstContext:m},d.flags|=524288}else zs=zs.next=m;return S}var a6=typeof AbortController<"u"?AbortController:function(){var d=[],m=this.signal={aborted:!1,addEventListener:function(S,j){d.push(j)}};this.abort=function(){m.aborted=!0,d.forEach(function(S){return S()})}},n6=t.unstable_scheduleCallback,s6=t.unstable_NormalPriority,ha={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Th(){return{controller:new a6,data:new Map,refCount:0}}function xc(d){d.refCount--,d.refCount===0&&n6(s6,function(){d.controller.abort()})}var yc=null,Ah=0,rl=0,al=null;function i6(d,m){if(yc===null){var S=yc=[];Ah=0,rl=N0(),al={status:"pending",value:void 0,then:function(j){S.push(j)}}}return Ah++,m.then(Q1,Q1),m}function Q1(){if(--Ah===0&&yc!==null){al!==null&&(al.status="fulfilled");var d=yc;yc=null,rl=0,al=null;for(var m=0;m<d.length;m++)(0,d[m])()}}function o6(d,m){var S=[],j={status:"pending",value:null,reason:null,then:function(q){S.push(q)}};return d.then(function(){j.status="fulfilled",j.value=m;for(var q=0;q<S.length;q++)(0,S[q])(m)},function(q){for(j.status="rejected",j.reason=q,q=0;q<S.length;q++)(0,S[q])(void 0)}),j}var eg=_.S;_.S=function(d,m){typeof m=="object"&&m!==null&&typeof m.then=="function"&&i6(d,m),eg!==null&&eg(d,m)};var xo=B(null);function Ch(){var d=xo.current;return d!==null?d:Rr.pooledCache}function pd(d,m){m===null?Y(xo,xo.current):Y(xo,m.pool)}function tg(){var d=Ch();return d===null?null:{parent:ha._currentValue,pool:d}}var wc=Error(a(460)),rg=Error(a(474)),md=Error(a(542)),Nh={then:function(){}};function ag(d){return d=d.status,d==="fulfilled"||d==="rejected"}function gd(){}function ng(d,m,S){switch(S=d[S],S===void 0?d.push(m):S!==m&&(m.then(gd,gd),m=S),m.status){case"fulfilled":return m.value;case"rejected":throw d=m.reason,ig(d),d;default:if(typeof m.status=="string")m.then(gd,gd);else{if(d=Rr,d!==null&&100<d.shellSuspendCounter)throw Error(a(482));d=m,d.status="pending",d.then(function(j){if(m.status==="pending"){var q=m;q.status="fulfilled",q.value=j}},function(j){if(m.status==="pending"){var q=m;q.status="rejected",q.reason=j}})}switch(m.status){case"fulfilled":return m.value;case"rejected":throw d=m.reason,ig(d),d}throw _c=m,wc}}var _c=null;function sg(){if(_c===null)throw Error(a(459));var d=_c;return _c=null,d}function ig(d){if(d===wc||d===md)throw Error(a(483))}var bi=!1;function jh(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Oh(d,m){d=d.updateQueue,m.updateQueue===d&&(m.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,callbacks:null})}function xi(d){return{lane:d,tag:0,payload:null,callback:null,next:null}}function yi(d,m,S){var j=d.updateQueue;if(j===null)return null;if(j=j.shared,(Er&2)!==0){var q=j.pending;return q===null?m.next=m:(m.next=q.next,q.next=m),j.pending=m,m=ld(d),W1(d,null,S),m}return od(d,j,m,S),ld(d)}function Sc(d,m,S){if(m=m.updateQueue,m!==null&&(m=m.shared,(S&4194048)!==0)){var j=m.lanes;j&=d.pendingLanes,S|=j,m.lanes=S,vt(d,S)}}function Dh(d,m){var S=d.updateQueue,j=d.alternate;if(j!==null&&(j=j.updateQueue,S===j)){var q=null,J=null;if(S=S.firstBaseUpdate,S!==null){do{var oe={lane:S.lane,tag:S.tag,payload:S.payload,callback:null,next:null};J===null?q=J=oe:J=J.next=oe,S=S.next}while(S!==null);J===null?q=J=m:J=J.next=m}else q=J=m;S={baseState:j.baseState,firstBaseUpdate:q,lastBaseUpdate:J,shared:j.shared,callbacks:j.callbacks},d.updateQueue=S;return}d=S.lastBaseUpdate,d===null?S.firstBaseUpdate=m:d.next=m,S.lastBaseUpdate=m}var Mh=!1;function kc(){if(Mh){var d=al;if(d!==null)throw d}}function Ec(d,m,S,j){Mh=!1;var q=d.updateQueue;bi=!1;var J=q.firstBaseUpdate,oe=q.lastBaseUpdate,ge=q.shared.pending;if(ge!==null){q.shared.pending=null;var Ne=ge,Ge=Ne.next;Ne.next=null,oe===null?J=Ge:oe.next=Ge,oe=Ne;var lt=d.alternate;lt!==null&&(lt=lt.updateQueue,ge=lt.lastBaseUpdate,ge!==oe&&(ge===null?lt.firstBaseUpdate=Ge:ge.next=Ge,lt.lastBaseUpdate=Ne))}if(J!==null){var pt=q.baseState;oe=0,lt=Ge=Ne=null,ge=J;do{var Ke=ge.lane&-536870913,Ze=Ke!==ge.lane;if(Ze?(hr&Ke)===Ke:(j&Ke)===Ke){Ke!==0&&Ke===rl&&(Mh=!0),lt!==null&&(lt=lt.next={lane:0,tag:ge.tag,payload:ge.payload,callback:null,next:null});e:{var Zt=d,qt=ge;Ke=m;var Or=S;switch(qt.tag){case 1:if(Zt=qt.payload,typeof Zt=="function"){pt=Zt.call(Or,pt,Ke);break e}pt=Zt;break e;case 3:Zt.flags=Zt.flags&-65537|128;case 0:if(Zt=qt.payload,Ke=typeof Zt=="function"?Zt.call(Or,pt,Ke):Zt,Ke==null)break e;pt=u({},pt,Ke);break e;case 2:bi=!0}}Ke=ge.callback,Ke!==null&&(d.flags|=64,Ze&&(d.flags|=8192),Ze=q.callbacks,Ze===null?q.callbacks=[Ke]:Ze.push(Ke))}else Ze={lane:Ke,tag:ge.tag,payload:ge.payload,callback:ge.callback,next:null},lt===null?(Ge=lt=Ze,Ne=pt):lt=lt.next=Ze,oe|=Ke;if(ge=ge.next,ge===null){if(ge=q.shared.pending,ge===null)break;Ze=ge,ge=Ze.next,Ze.next=null,q.lastBaseUpdate=Ze,q.shared.pending=null}}while(!0);lt===null&&(Ne=pt),q.baseState=Ne,q.firstBaseUpdate=Ge,q.lastBaseUpdate=lt,J===null&&(q.shared.lanes=0),Ci|=oe,d.lanes=oe,d.memoizedState=pt}}function og(d,m){if(typeof d!="function")throw Error(a(191,d));d.call(m)}function lg(d,m){var S=d.callbacks;if(S!==null)for(d.callbacks=null,d=0;d<S.length;d++)og(S[d],m)}var nl=B(null),vd=B(0);function cg(d,m){d=Xs,Y(vd,d),Y(nl,m),Xs=d|m.baseLanes}function Rh(){Y(vd,Xs),Y(nl,nl.current)}function Ih(){Xs=vd.current,F(nl),F(vd)}var wi=0,nr=null,Nr=null,aa=null,bd=!1,sl=!1,yo=!1,xd=0,Tc=0,il=null,l6=0;function Xr(){throw Error(a(321))}function Fh(d,m){if(m===null)return!1;for(var S=0;S<m.length&&S<d.length;S++)if(!un(d[S],m[S]))return!1;return!0}function Ph(d,m,S,j,q,J){return wi=J,nr=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,_.H=d===null||d.memoizedState===null?Wg:Gg,yo=!1,J=S(j,q),yo=!1,sl&&(J=dg(m,S,j,q)),ug(d),J}function ug(d){_.H=Ed;var m=Nr!==null&&Nr.next!==null;if(wi=0,aa=Nr=nr=null,bd=!1,Tc=0,il=null,m)throw Error(a(300));d===null||xa||(d=d.dependencies,d!==null&&fd(d)&&(xa=!0))}function dg(d,m,S,j){nr=d;var q=0;do{if(sl&&(il=null),Tc=0,sl=!1,25<=q)throw Error(a(301));if(q+=1,aa=Nr=null,d.updateQueue!=null){var J=d.updateQueue;J.lastEffect=null,J.events=null,J.stores=null,J.memoCache!=null&&(J.memoCache.index=0)}_.H=m6,J=m(S,j)}while(sl);return J}function c6(){var d=_.H,m=d.useState()[0];return m=typeof m.then=="function"?Ac(m):m,d=d.useState()[0],(Nr!==null?Nr.memoizedState:null)!==d&&(nr.flags|=1024),m}function Lh(){var d=xd!==0;return xd=0,d}function Bh(d,m,S){m.updateQueue=d.updateQueue,m.flags&=-2053,d.lanes&=~S}function Uh(d){if(bd){for(d=d.memoizedState;d!==null;){var m=d.queue;m!==null&&(m.pending=null),d=d.next}bd=!1}wi=0,aa=Nr=nr=null,sl=!1,Tc=xd=0,il=null}function an(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return aa===null?nr.memoizedState=aa=d:aa=aa.next=d,aa}function na(){if(Nr===null){var d=nr.alternate;d=d!==null?d.memoizedState:null}else d=Nr.next;var m=aa===null?nr.memoizedState:aa.next;if(m!==null)aa=m,Nr=d;else{if(d===null)throw nr.alternate===null?Error(a(467)):Error(a(310));Nr=d,d={memoizedState:Nr.memoizedState,baseState:Nr.baseState,baseQueue:Nr.baseQueue,queue:Nr.queue,next:null},aa===null?nr.memoizedState=aa=d:aa=aa.next=d}return aa}function zh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ac(d){var m=Tc;return Tc+=1,il===null&&(il=[]),d=ng(il,d,m),m=nr,(aa===null?m.memoizedState:aa.next)===null&&(m=m.alternate,_.H=m===null||m.memoizedState===null?Wg:Gg),d}function yd(d){if(d!==null&&typeof d=="object"){if(typeof d.then=="function")return Ac(d);if(d.$$typeof===E)return Ra(d)}throw Error(a(438,String(d)))}function $h(d){var m=null,S=nr.updateQueue;if(S!==null&&(m=S.memoCache),m==null){var j=nr.alternate;j!==null&&(j=j.updateQueue,j!==null&&(j=j.memoCache,j!=null&&(m={data:j.data.map(function(q){return q.slice()}),index:0})))}if(m==null&&(m={data:[],index:0}),S===null&&(S=zh(),nr.updateQueue=S),S.memoCache=m,S=m.data[m.index],S===void 0)for(S=m.data[m.index]=Array(d),j=0;j<d;j++)S[j]=G;return m.index++,S}function Vs(d,m){return typeof m=="function"?m(d):m}function wd(d){var m=na();return Vh(m,Nr,d)}function Vh(d,m,S){var j=d.queue;if(j===null)throw Error(a(311));j.lastRenderedReducer=S;var q=d.baseQueue,J=j.pending;if(J!==null){if(q!==null){var oe=q.next;q.next=J.next,J.next=oe}m.baseQueue=q=J,j.pending=null}if(J=d.baseState,q===null)d.memoizedState=J;else{m=q.next;var ge=oe=null,Ne=null,Ge=m,lt=!1;do{var pt=Ge.lane&-536870913;if(pt!==Ge.lane?(hr&pt)===pt:(wi&pt)===pt){var Ke=Ge.revertLane;if(Ke===0)Ne!==null&&(Ne=Ne.next={lane:0,revertLane:0,action:Ge.action,hasEagerState:Ge.hasEagerState,eagerState:Ge.eagerState,next:null}),pt===rl&&(lt=!0);else if((wi&Ke)===Ke){Ge=Ge.next,Ke===rl&&(lt=!0);continue}else pt={lane:0,revertLane:Ge.revertLane,action:Ge.action,hasEagerState:Ge.hasEagerState,eagerState:Ge.eagerState,next:null},Ne===null?(ge=Ne=pt,oe=J):Ne=Ne.next=pt,nr.lanes|=Ke,Ci|=Ke;pt=Ge.action,yo&&S(J,pt),J=Ge.hasEagerState?Ge.eagerState:S(J,pt)}else Ke={lane:pt,revertLane:Ge.revertLane,action:Ge.action,hasEagerState:Ge.hasEagerState,eagerState:Ge.eagerState,next:null},Ne===null?(ge=Ne=Ke,oe=J):Ne=Ne.next=Ke,nr.lanes|=pt,Ci|=pt;Ge=Ge.next}while(Ge!==null&&Ge!==m);if(Ne===null?oe=J:Ne.next=ge,!un(J,d.memoizedState)&&(xa=!0,lt&&(S=al,S!==null)))throw S;d.memoizedState=J,d.baseState=oe,d.baseQueue=Ne,j.lastRenderedState=J}return q===null&&(j.lanes=0),[d.memoizedState,j.dispatch]}function Hh(d){var m=na(),S=m.queue;if(S===null)throw Error(a(311));S.lastRenderedReducer=d;var j=S.dispatch,q=S.pending,J=m.memoizedState;if(q!==null){S.pending=null;var oe=q=q.next;do J=d(J,oe.action),oe=oe.next;while(oe!==q);un(J,m.memoizedState)||(xa=!0),m.memoizedState=J,m.baseQueue===null&&(m.baseState=J),S.lastRenderedState=J}return[J,j]}function fg(d,m,S){var j=nr,q=na(),J=wr;if(J){if(S===void 0)throw Error(a(407));S=S()}else S=m();var oe=!un((Nr||q).memoizedState,S);oe&&(q.memoizedState=S,xa=!0),q=q.queue;var ge=mg.bind(null,j,q,d);if(Cc(2048,8,ge,[d]),q.getSnapshot!==m||oe||aa!==null&&aa.memoizedState.tag&1){if(j.flags|=2048,ol(9,_d(),pg.bind(null,j,q,S,m),null),Rr===null)throw Error(a(349));J||(wi&124)!==0||hg(j,m,S)}return S}function hg(d,m,S){d.flags|=16384,d={getSnapshot:m,value:S},m=nr.updateQueue,m===null?(m=zh(),nr.updateQueue=m,m.stores=[d]):(S=m.stores,S===null?m.stores=[d]:S.push(d))}function pg(d,m,S,j){m.value=S,m.getSnapshot=j,gg(m)&&vg(d)}function mg(d,m,S){return S(function(){gg(m)&&vg(d)})}function gg(d){var m=d.getSnapshot;d=d.value;try{var S=m();return!un(d,S)}catch{return!0}}function vg(d){var m=Jo(d,2);m!==null&&gn(m,d,2)}function qh(d){var m=an();if(typeof d=="function"){var S=d;if(d=S(),yo){it(!0);try{S()}finally{it(!1)}}}return m.memoizedState=m.baseState=d,m.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:d},m}function bg(d,m,S,j){return d.baseState=S,Vh(d,Nr,typeof j=="function"?j:Vs)}function u6(d,m,S,j,q){if(kd(d))throw Error(a(485));if(d=m.action,d!==null){var J={payload:q,action:d,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(oe){J.listeners.push(oe)}};_.T!==null?S(!0):J.isTransition=!1,j(J),S=m.pending,S===null?(J.next=m.pending=J,xg(m,J)):(J.next=S.next,m.pending=S.next=J)}}function xg(d,m){var S=m.action,j=m.payload,q=d.state;if(m.isTransition){var J=_.T,oe={};_.T=oe;try{var ge=S(q,j),Ne=_.S;Ne!==null&&Ne(oe,ge),yg(d,m,ge)}catch(Ge){Wh(d,m,Ge)}finally{_.T=J}}else try{J=S(q,j),yg(d,m,J)}catch(Ge){Wh(d,m,Ge)}}function yg(d,m,S){S!==null&&typeof S=="object"&&typeof S.then=="function"?S.then(function(j){wg(d,m,j)},function(j){return Wh(d,m,j)}):wg(d,m,S)}function wg(d,m,S){m.status="fulfilled",m.value=S,_g(m),d.state=S,m=d.pending,m!==null&&(S=m.next,S===m?d.pending=null:(S=S.next,m.next=S,xg(d,S)))}function Wh(d,m,S){var j=d.pending;if(d.pending=null,j!==null){j=j.next;do m.status="rejected",m.reason=S,_g(m),m=m.next;while(m!==j)}d.action=null}function _g(d){d=d.listeners;for(var m=0;m<d.length;m++)(0,d[m])()}function Sg(d,m){return m}function kg(d,m){if(wr){var S=Rr.formState;if(S!==null){e:{var j=nr;if(wr){if(Hr){t:{for(var q=Hr,J=ps;q.nodeType!==8;){if(!J){q=null;break t}if(q=Jn(q.nextSibling),q===null){q=null;break t}}J=q.data,q=J==="F!"||J==="F"?q:null}if(q){Hr=Jn(q.nextSibling),j=q.data==="F!";break e}}go(j)}j=!1}j&&(m=S[0])}}return S=an(),S.memoizedState=S.baseState=m,j={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sg,lastRenderedState:m},S.queue=j,S=Vg.bind(null,nr,j),j.dispatch=S,j=qh(!1),J=Zh.bind(null,nr,!1,j.queue),j=an(),q={state:m,dispatch:null,action:d,pending:null},j.queue=q,S=u6.bind(null,nr,q,J,S),q.dispatch=S,j.memoizedState=d,[m,S,!1]}function Eg(d){var m=na();return Tg(m,Nr,d)}function Tg(d,m,S){if(m=Vh(d,m,Sg)[0],d=wd(Vs)[0],typeof m=="object"&&m!==null&&typeof m.then=="function")try{var j=Ac(m)}catch(oe){throw oe===wc?md:oe}else j=m;m=na();var q=m.queue,J=q.dispatch;return S!==m.memoizedState&&(nr.flags|=2048,ol(9,_d(),d6.bind(null,q,S),null)),[j,J,d]}function d6(d,m){d.action=m}function Ag(d){var m=na(),S=Nr;if(S!==null)return Tg(m,S,d);na(),m=m.memoizedState,S=na();var j=S.queue.dispatch;return S.memoizedState=d,[m,j,!1]}function ol(d,m,S,j){return d={tag:d,create:S,deps:j,inst:m,next:null},m=nr.updateQueue,m===null&&(m=zh(),nr.updateQueue=m),S=m.lastEffect,S===null?m.lastEffect=d.next=d:(j=S.next,S.next=d,d.next=j,m.lastEffect=d),d}function _d(){return{destroy:void 0,resource:void 0}}function Cg(){return na().memoizedState}function Sd(d,m,S,j){var q=an();j=j===void 0?null:j,nr.flags|=d,q.memoizedState=ol(1|m,_d(),S,j)}function Cc(d,m,S,j){var q=na();j=j===void 0?null:j;var J=q.memoizedState.inst;Nr!==null&&j!==null&&Fh(j,Nr.memoizedState.deps)?q.memoizedState=ol(m,J,S,j):(nr.flags|=d,q.memoizedState=ol(1|m,J,S,j))}function Ng(d,m){Sd(8390656,8,d,m)}function jg(d,m){Cc(2048,8,d,m)}function Og(d,m){return Cc(4,2,d,m)}function Dg(d,m){return Cc(4,4,d,m)}function Mg(d,m){if(typeof m=="function"){d=d();var S=m(d);return function(){typeof S=="function"?S():m(null)}}if(m!=null)return d=d(),m.current=d,function(){m.current=null}}function Rg(d,m,S){S=S!=null?S.concat([d]):null,Cc(4,4,Mg.bind(null,m,d),S)}function Gh(){}function Ig(d,m){var S=na();m=m===void 0?null:m;var j=S.memoizedState;return m!==null&&Fh(m,j[1])?j[0]:(S.memoizedState=[d,m],d)}function Fg(d,m){var S=na();m=m===void 0?null:m;var j=S.memoizedState;if(m!==null&&Fh(m,j[1]))return j[0];if(j=d(),yo){it(!0);try{d()}finally{it(!1)}}return S.memoizedState=[j,m],j}function Yh(d,m,S){return S===void 0||(wi&1073741824)!==0?d.memoizedState=m:(d.memoizedState=S,d=Bv(),nr.lanes|=d,Ci|=d,S)}function Pg(d,m,S,j){return un(S,m)?S:nl.current!==null?(d=Yh(d,S,j),un(d,m)||(xa=!0),d):(wi&42)===0?(xa=!0,d.memoizedState=S):(d=Bv(),nr.lanes|=d,Ci|=d,m)}function Lg(d,m,S,j,q){var J=k.p;k.p=J!==0&&8>J?J:8;var oe=_.T,ge={};_.T=ge,Zh(d,!1,m,S);try{var Ne=q(),Ge=_.S;if(Ge!==null&&Ge(ge,Ne),Ne!==null&&typeof Ne=="object"&&typeof Ne.then=="function"){var lt=o6(Ne,j);Nc(d,m,lt,mn(d))}else Nc(d,m,j,mn(d))}catch(pt){Nc(d,m,{then:function(){},status:"rejected",reason:pt},mn())}finally{k.p=J,_.T=oe}}function f6(){}function Xh(d,m,S,j){if(d.tag!==5)throw Error(a(476));var q=Bg(d).queue;Lg(d,q,m,A,S===null?f6:function(){return Ug(d),S(j)})}function Bg(d){var m=d.memoizedState;if(m!==null)return m;m={memoizedState:A,baseState:A,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:A},next:null};var S={};return m.next={memoizedState:S,baseState:S,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:S},next:null},d.memoizedState=m,d=d.alternate,d!==null&&(d.memoizedState=m),m}function Ug(d){var m=Bg(d).next.queue;Nc(d,m,{},mn())}function Kh(){return Ra(Gc)}function zg(){return na().memoizedState}function $g(){return na().memoizedState}function h6(d){for(var m=d.return;m!==null;){switch(m.tag){case 24:case 3:var S=mn();d=xi(S);var j=yi(m,d,S);j!==null&&(gn(j,m,S),Sc(j,m,S)),m={cache:Th()},d.payload=m;return}m=m.return}}function p6(d,m,S){var j=mn();S={lane:j,revertLane:0,action:S,hasEagerState:!1,eagerState:null,next:null},kd(d)?Hg(m,S):(S=gh(d,m,S,j),S!==null&&(gn(S,d,j),qg(S,m,j)))}function Vg(d,m,S){var j=mn();Nc(d,m,S,j)}function Nc(d,m,S,j){var q={lane:j,revertLane:0,action:S,hasEagerState:!1,eagerState:null,next:null};if(kd(d))Hg(m,q);else{var J=d.alternate;if(d.lanes===0&&(J===null||J.lanes===0)&&(J=m.lastRenderedReducer,J!==null))try{var oe=m.lastRenderedState,ge=J(oe,S);if(q.hasEagerState=!0,q.eagerState=ge,un(ge,oe))return od(d,m,q,0),Rr===null&&id(),!1}catch{}finally{}if(S=gh(d,m,q,j),S!==null)return gn(S,d,j),qg(S,m,j),!0}return!1}function Zh(d,m,S,j){if(j={lane:2,revertLane:N0(),action:j,hasEagerState:!1,eagerState:null,next:null},kd(d)){if(m)throw Error(a(479))}else m=gh(d,S,j,2),m!==null&&gn(m,d,2)}function kd(d){var m=d.alternate;return d===nr||m!==null&&m===nr}function Hg(d,m){sl=bd=!0;var S=d.pending;S===null?m.next=m:(m.next=S.next,S.next=m),d.pending=m}function qg(d,m,S){if((S&4194048)!==0){var j=m.lanes;j&=d.pendingLanes,S|=j,m.lanes=S,vt(d,S)}}var Ed={readContext:Ra,use:yd,useCallback:Xr,useContext:Xr,useEffect:Xr,useImperativeHandle:Xr,useLayoutEffect:Xr,useInsertionEffect:Xr,useMemo:Xr,useReducer:Xr,useRef:Xr,useState:Xr,useDebugValue:Xr,useDeferredValue:Xr,useTransition:Xr,useSyncExternalStore:Xr,useId:Xr,useHostTransitionStatus:Xr,useFormState:Xr,useActionState:Xr,useOptimistic:Xr,useMemoCache:Xr,useCacheRefresh:Xr},Wg={readContext:Ra,use:yd,useCallback:function(d,m){return an().memoizedState=[d,m===void 0?null:m],d},useContext:Ra,useEffect:Ng,useImperativeHandle:function(d,m,S){S=S!=null?S.concat([d]):null,Sd(4194308,4,Mg.bind(null,m,d),S)},useLayoutEffect:function(d,m){return Sd(4194308,4,d,m)},useInsertionEffect:function(d,m){Sd(4,2,d,m)},useMemo:function(d,m){var S=an();m=m===void 0?null:m;var j=d();if(yo){it(!0);try{d()}finally{it(!1)}}return S.memoizedState=[j,m],j},useReducer:function(d,m,S){var j=an();if(S!==void 0){var q=S(m);if(yo){it(!0);try{S(m)}finally{it(!1)}}}else q=m;return j.memoizedState=j.baseState=q,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:q},j.queue=d,d=d.dispatch=p6.bind(null,nr,d),[j.memoizedState,d]},useRef:function(d){var m=an();return d={current:d},m.memoizedState=d},useState:function(d){d=qh(d);var m=d.queue,S=Vg.bind(null,nr,m);return m.dispatch=S,[d.memoizedState,S]},useDebugValue:Gh,useDeferredValue:function(d,m){var S=an();return Yh(S,d,m)},useTransition:function(){var d=qh(!1);return d=Lg.bind(null,nr,d.queue,!0,!1),an().memoizedState=d,[!1,d]},useSyncExternalStore:function(d,m,S){var j=nr,q=an();if(wr){if(S===void 0)throw Error(a(407));S=S()}else{if(S=m(),Rr===null)throw Error(a(349));(hr&124)!==0||hg(j,m,S)}q.memoizedState=S;var J={value:S,getSnapshot:m};return q.queue=J,Ng(mg.bind(null,j,J,d),[d]),j.flags|=2048,ol(9,_d(),pg.bind(null,j,J,S,m),null),S},useId:function(){var d=an(),m=Rr.identifierPrefix;if(wr){var S=Us,j=Bs;S=(j&~(1<<32-et(j)-1)).toString(32)+S,m=""+m+"R"+S,S=xd++,0<S&&(m+="H"+S.toString(32)),m+=""}else S=l6++,m=""+m+"r"+S.toString(32)+"";return d.memoizedState=m},useHostTransitionStatus:Kh,useFormState:kg,useActionState:kg,useOptimistic:function(d){var m=an();m.memoizedState=m.baseState=d;var S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return m.queue=S,m=Zh.bind(null,nr,!0,S),S.dispatch=m,[d,m]},useMemoCache:$h,useCacheRefresh:function(){return an().memoizedState=h6.bind(null,nr)}},Gg={readContext:Ra,use:yd,useCallback:Ig,useContext:Ra,useEffect:jg,useImperativeHandle:Rg,useInsertionEffect:Og,useLayoutEffect:Dg,useMemo:Fg,useReducer:wd,useRef:Cg,useState:function(){return wd(Vs)},useDebugValue:Gh,useDeferredValue:function(d,m){var S=na();return Pg(S,Nr.memoizedState,d,m)},useTransition:function(){var d=wd(Vs)[0],m=na().memoizedState;return[typeof d=="boolean"?d:Ac(d),m]},useSyncExternalStore:fg,useId:zg,useHostTransitionStatus:Kh,useFormState:Eg,useActionState:Eg,useOptimistic:function(d,m){var S=na();return bg(S,Nr,d,m)},useMemoCache:$h,useCacheRefresh:$g},m6={readContext:Ra,use:yd,useCallback:Ig,useContext:Ra,useEffect:jg,useImperativeHandle:Rg,useInsertionEffect:Og,useLayoutEffect:Dg,useMemo:Fg,useReducer:Hh,useRef:Cg,useState:function(){return Hh(Vs)},useDebugValue:Gh,useDeferredValue:function(d,m){var S=na();return Nr===null?Yh(S,d,m):Pg(S,Nr.memoizedState,d,m)},useTransition:function(){var d=Hh(Vs)[0],m=na().memoizedState;return[typeof d=="boolean"?d:Ac(d),m]},useSyncExternalStore:fg,useId:zg,useHostTransitionStatus:Kh,useFormState:Ag,useActionState:Ag,useOptimistic:function(d,m){var S=na();return Nr!==null?bg(S,Nr,d,m):(S.baseState=d,[d,S.queue.dispatch])},useMemoCache:$h,useCacheRefresh:$g},ll=null,jc=0;function Td(d){var m=jc;return jc+=1,ll===null&&(ll=[]),ng(ll,d,m)}function Oc(d,m){m=m.props.ref,d.ref=m!==void 0?m:null}function Ad(d,m){throw m.$$typeof===p?Error(a(525)):(d=Object.prototype.toString.call(m),Error(a(31,d==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":d)))}function Yg(d){var m=d._init;return m(d._payload)}function Xg(d){function m(ze,Re){if(d){var We=ze.deletions;We===null?(ze.deletions=[Re],ze.flags|=16):We.push(Re)}}function S(ze,Re){if(!d)return null;for(;Re!==null;)m(ze,Re),Re=Re.sibling;return null}function j(ze){for(var Re=new Map;ze!==null;)ze.key!==null?Re.set(ze.key,ze):Re.set(ze.index,ze),ze=ze.sibling;return Re}function q(ze,Re){return ze=Ls(ze,Re),ze.index=0,ze.sibling=null,ze}function J(ze,Re,We){return ze.index=We,d?(We=ze.alternate,We!==null?(We=We.index,We<Re?(ze.flags|=67108866,Re):We):(ze.flags|=67108866,Re)):(ze.flags|=1048576,Re)}function oe(ze){return d&&ze.alternate===null&&(ze.flags|=67108866),ze}function ge(ze,Re,We,ft){return Re===null||Re.tag!==6?(Re=bh(We,ze.mode,ft),Re.return=ze,Re):(Re=q(Re,We),Re.return=ze,Re)}function Ne(ze,Re,We,ft){var It=We.type;return It===v?lt(ze,Re,We.props.children,ft,We.key):Re!==null&&(Re.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===U&&Yg(It)===Re.type)?(Re=q(Re,We.props),Oc(Re,We),Re.return=ze,Re):(Re=cd(We.type,We.key,We.props,null,ze.mode,ft),Oc(Re,We),Re.return=ze,Re)}function Ge(ze,Re,We,ft){return Re===null||Re.tag!==4||Re.stateNode.containerInfo!==We.containerInfo||Re.stateNode.implementation!==We.implementation?(Re=xh(We,ze.mode,ft),Re.return=ze,Re):(Re=q(Re,We.children||[]),Re.return=ze,Re)}function lt(ze,Re,We,ft,It){return Re===null||Re.tag!==7?(Re=fo(We,ze.mode,ft,It),Re.return=ze,Re):(Re=q(Re,We),Re.return=ze,Re)}function pt(ze,Re,We){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return Re=bh(""+Re,ze.mode,We),Re.return=ze,Re;if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case f:return We=cd(Re.type,Re.key,Re.props,null,ze.mode,We),Oc(We,Re),We.return=ze,We;case h:return Re=xh(Re,ze.mode,We),Re.return=ze,Re;case U:var ft=Re._init;return Re=ft(Re._payload),pt(ze,Re,We)}if(C(Re)||W(Re))return Re=fo(Re,ze.mode,We,null),Re.return=ze,Re;if(typeof Re.then=="function")return pt(ze,Td(Re),We);if(Re.$$typeof===E)return pt(ze,hd(ze,Re),We);Ad(ze,Re)}return null}function Ke(ze,Re,We,ft){var It=Re!==null?Re.key:null;if(typeof We=="string"&&We!==""||typeof We=="number"||typeof We=="bigint")return It!==null?null:ge(ze,Re,""+We,ft);if(typeof We=="object"&&We!==null){switch(We.$$typeof){case f:return We.key===It?Ne(ze,Re,We,ft):null;case h:return We.key===It?Ge(ze,Re,We,ft):null;case U:return It=We._init,We=It(We._payload),Ke(ze,Re,We,ft)}if(C(We)||W(We))return It!==null?null:lt(ze,Re,We,ft,null);if(typeof We.then=="function")return Ke(ze,Re,Td(We),ft);if(We.$$typeof===E)return Ke(ze,Re,hd(ze,We),ft);Ad(ze,We)}return null}function Ze(ze,Re,We,ft,It){if(typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint")return ze=ze.get(We)||null,ge(Re,ze,""+ft,It);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case f:return ze=ze.get(ft.key===null?We:ft.key)||null,Ne(Re,ze,ft,It);case h:return ze=ze.get(ft.key===null?We:ft.key)||null,Ge(Re,ze,ft,It);case U:var or=ft._init;return ft=or(ft._payload),Ze(ze,Re,We,ft,It)}if(C(ft)||W(ft))return ze=ze.get(We)||null,lt(Re,ze,ft,It,null);if(typeof ft.then=="function")return Ze(ze,Re,We,Td(ft),It);if(ft.$$typeof===E)return Ze(ze,Re,We,hd(Re,ft),It);Ad(Re,ft)}return null}function Zt(ze,Re,We,ft){for(var It=null,or=null,zt=Re,Wt=Re=0,wa=null;zt!==null&&Wt<We.length;Wt++){zt.index>Wt?(wa=zt,zt=null):wa=zt.sibling;var xr=Ke(ze,zt,We[Wt],ft);if(xr===null){zt===null&&(zt=wa);break}d&&zt&&xr.alternate===null&&m(ze,zt),Re=J(xr,Re,Wt),or===null?It=xr:or.sibling=xr,or=xr,zt=wa}if(Wt===We.length)return S(ze,zt),wr&&po(ze,Wt),It;if(zt===null){for(;Wt<We.length;Wt++)zt=pt(ze,We[Wt],ft),zt!==null&&(Re=J(zt,Re,Wt),or===null?It=zt:or.sibling=zt,or=zt);return wr&&po(ze,Wt),It}for(zt=j(zt);Wt<We.length;Wt++)wa=Ze(zt,ze,Wt,We[Wt],ft),wa!==null&&(d&&wa.alternate!==null&&zt.delete(wa.key===null?Wt:wa.key),Re=J(wa,Re,Wt),or===null?It=wa:or.sibling=wa,or=wa);return d&&zt.forEach(function(Pi){return m(ze,Pi)}),wr&&po(ze,Wt),It}function qt(ze,Re,We,ft){if(We==null)throw Error(a(151));for(var It=null,or=null,zt=Re,Wt=Re=0,wa=null,xr=We.next();zt!==null&&!xr.done;Wt++,xr=We.next()){zt.index>Wt?(wa=zt,zt=null):wa=zt.sibling;var Pi=Ke(ze,zt,xr.value,ft);if(Pi===null){zt===null&&(zt=wa);break}d&&zt&&Pi.alternate===null&&m(ze,zt),Re=J(Pi,Re,Wt),or===null?It=Pi:or.sibling=Pi,or=Pi,zt=wa}if(xr.done)return S(ze,zt),wr&&po(ze,Wt),It;if(zt===null){for(;!xr.done;Wt++,xr=We.next())xr=pt(ze,xr.value,ft),xr!==null&&(Re=J(xr,Re,Wt),or===null?It=xr:or.sibling=xr,or=xr);return wr&&po(ze,Wt),It}for(zt=j(zt);!xr.done;Wt++,xr=We.next())xr=Ze(zt,ze,Wt,xr.value,ft),xr!==null&&(d&&xr.alternate!==null&&zt.delete(xr.key===null?Wt:xr.key),Re=J(xr,Re,Wt),or===null?It=xr:or.sibling=xr,or=xr);return d&&zt.forEach(function(g5){return m(ze,g5)}),wr&&po(ze,Wt),It}function Or(ze,Re,We,ft){if(typeof We=="object"&&We!==null&&We.type===v&&We.key===null&&(We=We.props.children),typeof We=="object"&&We!==null){switch(We.$$typeof){case f:e:{for(var It=We.key;Re!==null;){if(Re.key===It){if(It=We.type,It===v){if(Re.tag===7){S(ze,Re.sibling),ft=q(Re,We.props.children),ft.return=ze,ze=ft;break e}}else if(Re.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===U&&Yg(It)===Re.type){S(ze,Re.sibling),ft=q(Re,We.props),Oc(ft,We),ft.return=ze,ze=ft;break e}S(ze,Re);break}else m(ze,Re);Re=Re.sibling}We.type===v?(ft=fo(We.props.children,ze.mode,ft,We.key),ft.return=ze,ze=ft):(ft=cd(We.type,We.key,We.props,null,ze.mode,ft),Oc(ft,We),ft.return=ze,ze=ft)}return oe(ze);case h:e:{for(It=We.key;Re!==null;){if(Re.key===It)if(Re.tag===4&&Re.stateNode.containerInfo===We.containerInfo&&Re.stateNode.implementation===We.implementation){S(ze,Re.sibling),ft=q(Re,We.children||[]),ft.return=ze,ze=ft;break e}else{S(ze,Re);break}else m(ze,Re);Re=Re.sibling}ft=xh(We,ze.mode,ft),ft.return=ze,ze=ft}return oe(ze);case U:return It=We._init,We=It(We._payload),Or(ze,Re,We,ft)}if(C(We))return Zt(ze,Re,We,ft);if(W(We)){if(It=W(We),typeof It!="function")throw Error(a(150));return We=It.call(We),qt(ze,Re,We,ft)}if(typeof We.then=="function")return Or(ze,Re,Td(We),ft);if(We.$$typeof===E)return Or(ze,Re,hd(ze,We),ft);Ad(ze,We)}return typeof We=="string"&&We!==""||typeof We=="number"||typeof We=="bigint"?(We=""+We,Re!==null&&Re.tag===6?(S(ze,Re.sibling),ft=q(Re,We),ft.return=ze,ze=ft):(S(ze,Re),ft=bh(We,ze.mode,ft),ft.return=ze,ze=ft),oe(ze)):S(ze,Re)}return function(ze,Re,We,ft){try{jc=0;var It=Or(ze,Re,We,ft);return ll=null,It}catch(zt){if(zt===wc||zt===md)throw zt;var or=dn(29,zt,null,ze.mode);return or.lanes=ft,or.return=ze,or}finally{}}}var cl=Xg(!0),Kg=Xg(!1),Dn=B(null),ms=null;function _i(d){var m=d.alternate;Y(pa,pa.current&1),Y(Dn,d),ms===null&&(m===null||nl.current!==null||m.memoizedState!==null)&&(ms=d)}function Zg(d){if(d.tag===22){if(Y(pa,pa.current),Y(Dn,d),ms===null){var m=d.alternate;m!==null&&m.memoizedState!==null&&(ms=d)}}else Si()}function Si(){Y(pa,pa.current),Y(Dn,Dn.current)}function Hs(d){F(Dn),ms===d&&(ms=null),F(pa)}var pa=B(0);function Cd(d){for(var m=d;m!==null;){if(m.tag===13){var S=m.memoizedState;if(S!==null&&(S=S.dehydrated,S===null||S.data==="$?"||z0(S)))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}function Jh(d,m,S,j){m=d.memoizedState,S=S(j,m),S=S==null?m:u({},m,S),d.memoizedState=S,d.lanes===0&&(d.updateQueue.baseState=S)}var Qh={enqueueSetState:function(d,m,S){d=d._reactInternals;var j=mn(),q=xi(j);q.payload=m,S!=null&&(q.callback=S),m=yi(d,q,j),m!==null&&(gn(m,d,j),Sc(m,d,j))},enqueueReplaceState:function(d,m,S){d=d._reactInternals;var j=mn(),q=xi(j);q.tag=1,q.payload=m,S!=null&&(q.callback=S),m=yi(d,q,j),m!==null&&(gn(m,d,j),Sc(m,d,j))},enqueueForceUpdate:function(d,m){d=d._reactInternals;var S=mn(),j=xi(S);j.tag=2,m!=null&&(j.callback=m),m=yi(d,j,S),m!==null&&(gn(m,d,S),Sc(m,d,S))}};function Jg(d,m,S,j,q,J,oe){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(j,J,oe):m.prototype&&m.prototype.isPureReactComponent?!hc(S,j)||!hc(q,J):!0}function Qg(d,m,S,j){d=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(S,j),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(S,j),m.state!==d&&Qh.enqueueReplaceState(m,m.state,null)}function wo(d,m){var S=m;if("ref"in m){S={};for(var j in m)j!=="ref"&&(S[j]=m[j])}if(d=d.defaultProps){S===m&&(S=u({},S));for(var q in d)S[q]===void 0&&(S[q]=d[q])}return S}var Nd=typeof reportError=="function"?reportError:function(d){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var m=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof d=="object"&&d!==null&&typeof d.message=="string"?String(d.message):String(d),error:d});if(!window.dispatchEvent(m))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",d);return}console.error(d)};function ev(d){Nd(d)}function tv(d){console.error(d)}function rv(d){Nd(d)}function jd(d,m){try{var S=d.onUncaughtError;S(m.value,{componentStack:m.stack})}catch(j){setTimeout(function(){throw j})}}function av(d,m,S){try{var j=d.onCaughtError;j(S.value,{componentStack:S.stack,errorBoundary:m.tag===1?m.stateNode:null})}catch(q){setTimeout(function(){throw q})}}function e0(d,m,S){return S=xi(S),S.tag=3,S.payload={element:null},S.callback=function(){jd(d,m)},S}function nv(d){return d=xi(d),d.tag=3,d}function sv(d,m,S,j){var q=S.type.getDerivedStateFromError;if(typeof q=="function"){var J=j.value;d.payload=function(){return q(J)},d.callback=function(){av(m,S,j)}}var oe=S.stateNode;oe!==null&&typeof oe.componentDidCatch=="function"&&(d.callback=function(){av(m,S,j),typeof q!="function"&&(Ni===null?Ni=new Set([this]):Ni.add(this));var ge=j.stack;this.componentDidCatch(j.value,{componentStack:ge!==null?ge:""})})}function g6(d,m,S,j,q){if(S.flags|=32768,j!==null&&typeof j=="object"&&typeof j.then=="function"){if(m=S.alternate,m!==null&&bc(m,S,q,!0),S=Dn.current,S!==null){switch(S.tag){case 13:return ms===null?k0():S.alternate===null&&qr===0&&(qr=3),S.flags&=-257,S.flags|=65536,S.lanes=q,j===Nh?S.flags|=16384:(m=S.updateQueue,m===null?S.updateQueue=new Set([j]):m.add(j),T0(d,j,q)),!1;case 22:return S.flags|=65536,j===Nh?S.flags|=16384:(m=S.updateQueue,m===null?(m={transitions:null,markerInstances:null,retryQueue:new Set([j])},S.updateQueue=m):(S=m.retryQueue,S===null?m.retryQueue=new Set([j]):S.add(j)),T0(d,j,q)),!1}throw Error(a(435,S.tag))}return T0(d,j,q),k0(),!1}if(wr)return m=Dn.current,m!==null?((m.flags&65536)===0&&(m.flags|=256),m.flags|=65536,m.lanes=q,j!==_h&&(d=Error(a(422),{cause:j}),vc(Cn(d,S)))):(j!==_h&&(m=Error(a(423),{cause:j}),vc(Cn(m,S))),d=d.current.alternate,d.flags|=65536,q&=-q,d.lanes|=q,j=Cn(j,S),q=e0(d.stateNode,j,q),Dh(d,q),qr!==4&&(qr=2)),!1;var J=Error(a(520),{cause:j});if(J=Cn(J,S),Lc===null?Lc=[J]:Lc.push(J),qr!==4&&(qr=2),m===null)return!0;j=Cn(j,S),S=m;do{switch(S.tag){case 3:return S.flags|=65536,d=q&-q,S.lanes|=d,d=e0(S.stateNode,j,d),Dh(S,d),!1;case 1:if(m=S.type,J=S.stateNode,(S.flags&128)===0&&(typeof m.getDerivedStateFromError=="function"||J!==null&&typeof J.componentDidCatch=="function"&&(Ni===null||!Ni.has(J))))return S.flags|=65536,q&=-q,S.lanes|=q,q=nv(q),sv(q,d,S,j),Dh(S,q),!1}S=S.return}while(S!==null);return!1}var iv=Error(a(461)),xa=!1;function ka(d,m,S,j){m.child=d===null?Kg(m,null,S,j):cl(m,d.child,S,j)}function ov(d,m,S,j,q){S=S.render;var J=m.ref;if("ref"in j){var oe={};for(var ge in j)ge!=="ref"&&(oe[ge]=j[ge])}else oe=j;return bo(m),j=Ph(d,m,S,oe,J,q),ge=Lh(),d!==null&&!xa?(Bh(d,m,q),qs(d,m,q)):(wr&&ge&&yh(m),m.flags|=1,ka(d,m,j,q),m.child)}function lv(d,m,S,j,q){if(d===null){var J=S.type;return typeof J=="function"&&!vh(J)&&J.defaultProps===void 0&&S.compare===null?(m.tag=15,m.type=J,cv(d,m,J,j,q)):(d=cd(S.type,null,j,m,m.mode,q),d.ref=m.ref,d.return=m,m.child=d)}if(J=d.child,!l0(d,q)){var oe=J.memoizedProps;if(S=S.compare,S=S!==null?S:hc,S(oe,j)&&d.ref===m.ref)return qs(d,m,q)}return m.flags|=1,d=Ls(J,j),d.ref=m.ref,d.return=m,m.child=d}function cv(d,m,S,j,q){if(d!==null){var J=d.memoizedProps;if(hc(J,j)&&d.ref===m.ref)if(xa=!1,m.pendingProps=j=J,l0(d,q))(d.flags&131072)!==0&&(xa=!0);else return m.lanes=d.lanes,qs(d,m,q)}return t0(d,m,S,j,q)}function uv(d,m,S){var j=m.pendingProps,q=j.children,J=d!==null?d.memoizedState:null;if(j.mode==="hidden"){if((m.flags&128)!==0){if(j=J!==null?J.baseLanes|S:S,d!==null){for(q=m.child=d.child,J=0;q!==null;)J=J|q.lanes|q.childLanes,q=q.sibling;m.childLanes=J&~j}else m.childLanes=0,m.child=null;return dv(d,m,j,S)}if((S&536870912)!==0)m.memoizedState={baseLanes:0,cachePool:null},d!==null&&pd(m,J!==null?J.cachePool:null),J!==null?cg(m,J):Rh(),Zg(m);else return m.lanes=m.childLanes=536870912,dv(d,m,J!==null?J.baseLanes|S:S,S)}else J!==null?(pd(m,J.cachePool),cg(m,J),Si(),m.memoizedState=null):(d!==null&&pd(m,null),Rh(),Si());return ka(d,m,q,S),m.child}function dv(d,m,S,j){var q=Ch();return q=q===null?null:{parent:ha._currentValue,pool:q},m.memoizedState={baseLanes:S,cachePool:q},d!==null&&pd(m,null),Rh(),Zg(m),d!==null&&bc(d,m,j,!0),null}function Od(d,m){var S=m.ref;if(S===null)d!==null&&d.ref!==null&&(m.flags|=4194816);else{if(typeof S!="function"&&typeof S!="object")throw Error(a(284));(d===null||d.ref!==S)&&(m.flags|=4194816)}}function t0(d,m,S,j,q){return bo(m),S=Ph(d,m,S,j,void 0,q),j=Lh(),d!==null&&!xa?(Bh(d,m,q),qs(d,m,q)):(wr&&j&&yh(m),m.flags|=1,ka(d,m,S,q),m.child)}function fv(d,m,S,j,q,J){return bo(m),m.updateQueue=null,S=dg(m,j,S,q),ug(d),j=Lh(),d!==null&&!xa?(Bh(d,m,J),qs(d,m,J)):(wr&&j&&yh(m),m.flags|=1,ka(d,m,S,J),m.child)}function hv(d,m,S,j,q){if(bo(m),m.stateNode===null){var J=Qo,oe=S.contextType;typeof oe=="object"&&oe!==null&&(J=Ra(oe)),J=new S(j,J),m.memoizedState=J.state!==null&&J.state!==void 0?J.state:null,J.updater=Qh,m.stateNode=J,J._reactInternals=m,J=m.stateNode,J.props=j,J.state=m.memoizedState,J.refs={},jh(m),oe=S.contextType,J.context=typeof oe=="object"&&oe!==null?Ra(oe):Qo,J.state=m.memoizedState,oe=S.getDerivedStateFromProps,typeof oe=="function"&&(Jh(m,S,oe,j),J.state=m.memoizedState),typeof S.getDerivedStateFromProps=="function"||typeof J.getSnapshotBeforeUpdate=="function"||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(oe=J.state,typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount(),oe!==J.state&&Qh.enqueueReplaceState(J,J.state,null),Ec(m,j,J,q),kc(),J.state=m.memoizedState),typeof J.componentDidMount=="function"&&(m.flags|=4194308),j=!0}else if(d===null){J=m.stateNode;var ge=m.memoizedProps,Ne=wo(S,ge);J.props=Ne;var Ge=J.context,lt=S.contextType;oe=Qo,typeof lt=="object"&&lt!==null&&(oe=Ra(lt));var pt=S.getDerivedStateFromProps;lt=typeof pt=="function"||typeof J.getSnapshotBeforeUpdate=="function",ge=m.pendingProps!==ge,lt||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(ge||Ge!==oe)&&Qg(m,J,j,oe),bi=!1;var Ke=m.memoizedState;J.state=Ke,Ec(m,j,J,q),kc(),Ge=m.memoizedState,ge||Ke!==Ge||bi?(typeof pt=="function"&&(Jh(m,S,pt,j),Ge=m.memoizedState),(Ne=bi||Jg(m,S,Ne,j,Ke,Ge,oe))?(lt||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount()),typeof J.componentDidMount=="function"&&(m.flags|=4194308)):(typeof J.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=j,m.memoizedState=Ge),J.props=j,J.state=Ge,J.context=oe,j=Ne):(typeof J.componentDidMount=="function"&&(m.flags|=4194308),j=!1)}else{J=m.stateNode,Oh(d,m),oe=m.memoizedProps,lt=wo(S,oe),J.props=lt,pt=m.pendingProps,Ke=J.context,Ge=S.contextType,Ne=Qo,typeof Ge=="object"&&Ge!==null&&(Ne=Ra(Ge)),ge=S.getDerivedStateFromProps,(Ge=typeof ge=="function"||typeof J.getSnapshotBeforeUpdate=="function")||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(oe!==pt||Ke!==Ne)&&Qg(m,J,j,Ne),bi=!1,Ke=m.memoizedState,J.state=Ke,Ec(m,j,J,q),kc();var Ze=m.memoizedState;oe!==pt||Ke!==Ze||bi||d!==null&&d.dependencies!==null&&fd(d.dependencies)?(typeof ge=="function"&&(Jh(m,S,ge,j),Ze=m.memoizedState),(lt=bi||Jg(m,S,lt,j,Ke,Ze,Ne)||d!==null&&d.dependencies!==null&&fd(d.dependencies))?(Ge||typeof J.UNSAFE_componentWillUpdate!="function"&&typeof J.componentWillUpdate!="function"||(typeof J.componentWillUpdate=="function"&&J.componentWillUpdate(j,Ze,Ne),typeof J.UNSAFE_componentWillUpdate=="function"&&J.UNSAFE_componentWillUpdate(j,Ze,Ne)),typeof J.componentDidUpdate=="function"&&(m.flags|=4),typeof J.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof J.componentDidUpdate!="function"||oe===d.memoizedProps&&Ke===d.memoizedState||(m.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||oe===d.memoizedProps&&Ke===d.memoizedState||(m.flags|=1024),m.memoizedProps=j,m.memoizedState=Ze),J.props=j,J.state=Ze,J.context=Ne,j=lt):(typeof J.componentDidUpdate!="function"||oe===d.memoizedProps&&Ke===d.memoizedState||(m.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||oe===d.memoizedProps&&Ke===d.memoizedState||(m.flags|=1024),j=!1)}return J=j,Od(d,m),j=(m.flags&128)!==0,J||j?(J=m.stateNode,S=j&&typeof S.getDerivedStateFromError!="function"?null:J.render(),m.flags|=1,d!==null&&j?(m.child=cl(m,d.child,null,q),m.child=cl(m,null,S,q)):ka(d,m,S,q),m.memoizedState=J.state,d=m.child):d=qs(d,m,q),d}function pv(d,m,S,j){return gc(),m.flags|=256,ka(d,m,S,j),m.child}var r0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function a0(d){return{baseLanes:d,cachePool:tg()}}function n0(d,m,S){return d=d!==null?d.childLanes&~S:0,m&&(d|=Mn),d}function mv(d,m,S){var j=m.pendingProps,q=!1,J=(m.flags&128)!==0,oe;if((oe=J)||(oe=d!==null&&d.memoizedState===null?!1:(pa.current&2)!==0),oe&&(q=!0,m.flags&=-129),oe=(m.flags&32)!==0,m.flags&=-33,d===null){if(wr){if(q?_i(m):Si(),wr){var ge=Hr,Ne;if(Ne=ge){e:{for(Ne=ge,ge=ps;Ne.nodeType!==8;){if(!ge){ge=null;break e}if(Ne=Jn(Ne.nextSibling),Ne===null){ge=null;break e}}ge=Ne}ge!==null?(m.memoizedState={dehydrated:ge,treeContext:ho!==null?{id:Bs,overflow:Us}:null,retryLane:536870912,hydrationErrors:null},Ne=dn(18,null,null,0),Ne.stateNode=ge,Ne.return=m,m.child=Ne,Ga=m,Hr=null,Ne=!0):Ne=!1}Ne||go(m)}if(ge=m.memoizedState,ge!==null&&(ge=ge.dehydrated,ge!==null))return z0(ge)?m.lanes=32:m.lanes=536870912,null;Hs(m)}return ge=j.children,j=j.fallback,q?(Si(),q=m.mode,ge=Dd({mode:"hidden",children:ge},q),j=fo(j,q,S,null),ge.return=m,j.return=m,ge.sibling=j,m.child=ge,q=m.child,q.memoizedState=a0(S),q.childLanes=n0(d,oe,S),m.memoizedState=r0,j):(_i(m),s0(m,ge))}if(Ne=d.memoizedState,Ne!==null&&(ge=Ne.dehydrated,ge!==null)){if(J)m.flags&256?(_i(m),m.flags&=-257,m=i0(d,m,S)):m.memoizedState!==null?(Si(),m.child=d.child,m.flags|=128,m=null):(Si(),q=j.fallback,ge=m.mode,j=Dd({mode:"visible",children:j.children},ge),q=fo(q,ge,S,null),q.flags|=2,j.return=m,q.return=m,j.sibling=q,m.child=j,cl(m,d.child,null,S),j=m.child,j.memoizedState=a0(S),j.childLanes=n0(d,oe,S),m.memoizedState=r0,m=q);else if(_i(m),z0(ge)){if(oe=ge.nextSibling&&ge.nextSibling.dataset,oe)var Ge=oe.dgst;oe=Ge,j=Error(a(419)),j.stack="",j.digest=oe,vc({value:j,source:null,stack:null}),m=i0(d,m,S)}else if(xa||bc(d,m,S,!1),oe=(S&d.childLanes)!==0,xa||oe){if(oe=Rr,oe!==null&&(j=S&-S,j=(j&42)!==0?1:xt(j),j=(j&(oe.suspendedLanes|S))!==0?0:j,j!==0&&j!==Ne.retryLane))throw Ne.retryLane=j,Jo(d,j),gn(oe,d,j),iv;ge.data==="$?"||k0(),m=i0(d,m,S)}else ge.data==="$?"?(m.flags|=192,m.child=d.child,m=null):(d=Ne.treeContext,Hr=Jn(ge.nextSibling),Ga=m,wr=!0,mo=null,ps=!1,d!==null&&(jn[On++]=Bs,jn[On++]=Us,jn[On++]=ho,Bs=d.id,Us=d.overflow,ho=m),m=s0(m,j.children),m.flags|=4096);return m}return q?(Si(),q=j.fallback,ge=m.mode,Ne=d.child,Ge=Ne.sibling,j=Ls(Ne,{mode:"hidden",children:j.children}),j.subtreeFlags=Ne.subtreeFlags&65011712,Ge!==null?q=Ls(Ge,q):(q=fo(q,ge,S,null),q.flags|=2),q.return=m,j.return=m,j.sibling=q,m.child=j,j=q,q=m.child,ge=d.child.memoizedState,ge===null?ge=a0(S):(Ne=ge.cachePool,Ne!==null?(Ge=ha._currentValue,Ne=Ne.parent!==Ge?{parent:Ge,pool:Ge}:Ne):Ne=tg(),ge={baseLanes:ge.baseLanes|S,cachePool:Ne}),q.memoizedState=ge,q.childLanes=n0(d,oe,S),m.memoizedState=r0,j):(_i(m),S=d.child,d=S.sibling,S=Ls(S,{mode:"visible",children:j.children}),S.return=m,S.sibling=null,d!==null&&(oe=m.deletions,oe===null?(m.deletions=[d],m.flags|=16):oe.push(d)),m.child=S,m.memoizedState=null,S)}function s0(d,m){return m=Dd({mode:"visible",children:m},d.mode),m.return=d,d.child=m}function Dd(d,m){return d=dn(22,d,null,m),d.lanes=0,d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},d}function i0(d,m,S){return cl(m,d.child,null,S),d=s0(m,m.pendingProps.children),d.flags|=2,m.memoizedState=null,d}function gv(d,m,S){d.lanes|=m;var j=d.alternate;j!==null&&(j.lanes|=m),kh(d.return,m,S)}function o0(d,m,S,j,q){var J=d.memoizedState;J===null?d.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:j,tail:S,tailMode:q}:(J.isBackwards=m,J.rendering=null,J.renderingStartTime=0,J.last=j,J.tail=S,J.tailMode=q)}function vv(d,m,S){var j=m.pendingProps,q=j.revealOrder,J=j.tail;if(ka(d,m,j.children,S),j=pa.current,(j&2)!==0)j=j&1|2,m.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=m.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&gv(d,S,m);else if(d.tag===19)gv(d,S,m);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===m)break e;for(;d.sibling===null;){if(d.return===null||d.return===m)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}j&=1}switch(Y(pa,j),q){case"forwards":for(S=m.child,q=null;S!==null;)d=S.alternate,d!==null&&Cd(d)===null&&(q=S),S=S.sibling;S=q,S===null?(q=m.child,m.child=null):(q=S.sibling,S.sibling=null),o0(m,!1,q,S,J);break;case"backwards":for(S=null,q=m.child,m.child=null;q!==null;){if(d=q.alternate,d!==null&&Cd(d)===null){m.child=q;break}d=q.sibling,q.sibling=S,S=q,q=d}o0(m,!0,S,null,J);break;case"together":o0(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function qs(d,m,S){if(d!==null&&(m.dependencies=d.dependencies),Ci|=m.lanes,(S&m.childLanes)===0)if(d!==null){if(bc(d,m,S,!1),(S&m.childLanes)===0)return null}else return null;if(d!==null&&m.child!==d.child)throw Error(a(153));if(m.child!==null){for(d=m.child,S=Ls(d,d.pendingProps),m.child=S,S.return=m;d.sibling!==null;)d=d.sibling,S=S.sibling=Ls(d,d.pendingProps),S.return=m;S.sibling=null}return m.child}function l0(d,m){return(d.lanes&m)!==0?!0:(d=d.dependencies,!!(d!==null&&fd(d)))}function v6(d,m,S){switch(m.tag){case 3:L(m,m.stateNode.containerInfo),vi(m,ha,d.memoizedState.cache),gc();break;case 27:case 5:K(m);break;case 4:L(m,m.stateNode.containerInfo);break;case 10:vi(m,m.type,m.memoizedProps.value);break;case 13:var j=m.memoizedState;if(j!==null)return j.dehydrated!==null?(_i(m),m.flags|=128,null):(S&m.child.childLanes)!==0?mv(d,m,S):(_i(m),d=qs(d,m,S),d!==null?d.sibling:null);_i(m);break;case 19:var q=(d.flags&128)!==0;if(j=(S&m.childLanes)!==0,j||(bc(d,m,S,!1),j=(S&m.childLanes)!==0),q){if(j)return vv(d,m,S);m.flags|=128}if(q=m.memoizedState,q!==null&&(q.rendering=null,q.tail=null,q.lastEffect=null),Y(pa,pa.current),j)break;return null;case 22:case 23:return m.lanes=0,uv(d,m,S);case 24:vi(m,ha,d.memoizedState.cache)}return qs(d,m,S)}function bv(d,m,S){if(d!==null)if(d.memoizedProps!==m.pendingProps)xa=!0;else{if(!l0(d,S)&&(m.flags&128)===0)return xa=!1,v6(d,m,S);xa=(d.flags&131072)!==0}else xa=!1,wr&&(m.flags&1048576)!==0&&Y1(m,dd,m.index);switch(m.lanes=0,m.tag){case 16:e:{d=m.pendingProps;var j=m.elementType,q=j._init;if(j=q(j._payload),m.type=j,typeof j=="function")vh(j)?(d=wo(j,d),m.tag=1,m=hv(null,m,j,d,S)):(m.tag=0,m=t0(null,m,j,d,S));else{if(j!=null){if(q=j.$$typeof,q===N){m.tag=11,m=ov(null,m,j,d,S);break e}else if(q===V){m.tag=14,m=lv(null,m,j,d,S);break e}}throw m=R(j)||j,Error(a(306,m,""))}}return m;case 0:return t0(d,m,m.type,m.pendingProps,S);case 1:return j=m.type,q=wo(j,m.pendingProps),hv(d,m,j,q,S);case 3:e:{if(L(m,m.stateNode.containerInfo),d===null)throw Error(a(387));j=m.pendingProps;var J=m.memoizedState;q=J.element,Oh(d,m),Ec(m,j,null,S);var oe=m.memoizedState;if(j=oe.cache,vi(m,ha,j),j!==J.cache&&Eh(m,[ha],S,!0),kc(),j=oe.element,J.isDehydrated)if(J={element:j,isDehydrated:!1,cache:oe.cache},m.updateQueue.baseState=J,m.memoizedState=J,m.flags&256){m=pv(d,m,j,S);break e}else if(j!==q){q=Cn(Error(a(424)),m),vc(q),m=pv(d,m,j,S);break e}else{switch(d=m.stateNode.containerInfo,d.nodeType){case 9:d=d.body;break;default:d=d.nodeName==="HTML"?d.ownerDocument.body:d}for(Hr=Jn(d.firstChild),Ga=m,wr=!0,mo=null,ps=!0,S=Kg(m,null,j,S),m.child=S;S;)S.flags=S.flags&-3|4096,S=S.sibling}else{if(gc(),j===q){m=qs(d,m,S);break e}ka(d,m,j,S)}m=m.child}return m;case 26:return Od(d,m),d===null?(S=_b(m.type,null,m.pendingProps,null))?m.memoizedState=S:wr||(S=m.type,d=m.pendingProps,j=Wd(z.current).createElement(S),j[Ft]=m,j[kt]=d,Ta(j,S,d),Oe(j),m.stateNode=j):m.memoizedState=_b(m.type,d.memoizedProps,m.pendingProps,d.memoizedState),null;case 27:return K(m),d===null&&wr&&(j=m.stateNode=xb(m.type,m.pendingProps,z.current),Ga=m,ps=!0,q=Hr,Di(m.type)?($0=q,Hr=Jn(j.firstChild)):Hr=q),ka(d,m,m.pendingProps.children,S),Od(d,m),d===null&&(m.flags|=4194304),m.child;case 5:return d===null&&wr&&((q=j=Hr)&&(j=q6(j,m.type,m.pendingProps,ps),j!==null?(m.stateNode=j,Ga=m,Hr=Jn(j.firstChild),ps=!1,q=!0):q=!1),q||go(m)),K(m),q=m.type,J=m.pendingProps,oe=d!==null?d.memoizedProps:null,j=J.children,L0(q,J)?j=null:oe!==null&&L0(q,oe)&&(m.flags|=32),m.memoizedState!==null&&(q=Ph(d,m,c6,null,null,S),Gc._currentValue=q),Od(d,m),ka(d,m,j,S),m.child;case 6:return d===null&&wr&&((d=S=Hr)&&(S=W6(S,m.pendingProps,ps),S!==null?(m.stateNode=S,Ga=m,Hr=null,d=!0):d=!1),d||go(m)),null;case 13:return mv(d,m,S);case 4:return L(m,m.stateNode.containerInfo),j=m.pendingProps,d===null?m.child=cl(m,null,j,S):ka(d,m,j,S),m.child;case 11:return ov(d,m,m.type,m.pendingProps,S);case 7:return ka(d,m,m.pendingProps,S),m.child;case 8:return ka(d,m,m.pendingProps.children,S),m.child;case 12:return ka(d,m,m.pendingProps.children,S),m.child;case 10:return j=m.pendingProps,vi(m,m.type,j.value),ka(d,m,j.children,S),m.child;case 9:return q=m.type._context,j=m.pendingProps.children,bo(m),q=Ra(q),j=j(q),m.flags|=1,ka(d,m,j,S),m.child;case 14:return lv(d,m,m.type,m.pendingProps,S);case 15:return cv(d,m,m.type,m.pendingProps,S);case 19:return vv(d,m,S);case 31:return j=m.pendingProps,S=m.mode,j={mode:j.mode,children:j.children},d===null?(S=Dd(j,S),S.ref=m.ref,m.child=S,S.return=m,m=S):(S=Ls(d.child,j),S.ref=m.ref,m.child=S,S.return=m,m=S),m;case 22:return uv(d,m,S);case 24:return bo(m),j=Ra(ha),d===null?(q=Ch(),q===null&&(q=Rr,J=Th(),q.pooledCache=J,J.refCount++,J!==null&&(q.pooledCacheLanes|=S),q=J),m.memoizedState={parent:j,cache:q},jh(m),vi(m,ha,q)):((d.lanes&S)!==0&&(Oh(d,m),Ec(m,null,null,S),kc()),q=d.memoizedState,J=m.memoizedState,q.parent!==j?(q={parent:j,cache:j},m.memoizedState=q,m.lanes===0&&(m.memoizedState=m.updateQueue.baseState=q),vi(m,ha,j)):(j=J.cache,vi(m,ha,j),j!==q.cache&&Eh(m,[ha],S,!0))),ka(d,m,m.pendingProps.children,S),m.child;case 29:throw m.pendingProps}throw Error(a(156,m.tag))}function Ws(d){d.flags|=4}function xv(d,m){if(m.type!=="stylesheet"||(m.state.loading&4)!==0)d.flags&=-16777217;else if(d.flags|=16777216,!Ab(m)){if(m=Dn.current,m!==null&&((hr&4194048)===hr?ms!==null:(hr&62914560)!==hr&&(hr&536870912)===0||m!==ms))throw _c=Nh,rg;d.flags|=8192}}function Md(d,m){m!==null&&(d.flags|=4),d.flags&16384&&(m=d.tag!==22?Ue():536870912,d.lanes|=m,hl|=m)}function Dc(d,m){if(!wr)switch(d.tailMode){case"hidden":m=d.tail;for(var S=null;m!==null;)m.alternate!==null&&(S=m),m=m.sibling;S===null?d.tail=null:S.sibling=null;break;case"collapsed":S=d.tail;for(var j=null;S!==null;)S.alternate!==null&&(j=S),S=S.sibling;j===null?m||d.tail===null?d.tail=null:d.tail.sibling=null:j.sibling=null}}function Ur(d){var m=d.alternate!==null&&d.alternate.child===d.child,S=0,j=0;if(m)for(var q=d.child;q!==null;)S|=q.lanes|q.childLanes,j|=q.subtreeFlags&65011712,j|=q.flags&65011712,q.return=d,q=q.sibling;else for(q=d.child;q!==null;)S|=q.lanes|q.childLanes,j|=q.subtreeFlags,j|=q.flags,q.return=d,q=q.sibling;return d.subtreeFlags|=j,d.childLanes=S,m}function b6(d,m,S){var j=m.pendingProps;switch(wh(m),m.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ur(m),null;case 1:return Ur(m),null;case 3:return S=m.stateNode,j=null,d!==null&&(j=d.memoizedState.cache),m.memoizedState.cache!==j&&(m.flags|=2048),$s(ha),M(),S.pendingContext&&(S.context=S.pendingContext,S.pendingContext=null),(d===null||d.child===null)&&(mc(m)?Ws(m):d===null||d.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,Z1())),Ur(m),null;case 26:return S=m.memoizedState,d===null?(Ws(m),S!==null?(Ur(m),xv(m,S)):(Ur(m),m.flags&=-16777217)):S?S!==d.memoizedState?(Ws(m),Ur(m),xv(m,S)):(Ur(m),m.flags&=-16777217):(d.memoizedProps!==j&&Ws(m),Ur(m),m.flags&=-16777217),null;case 27:se(m),S=z.current;var q=m.type;if(d!==null&&m.stateNode!=null)d.memoizedProps!==j&&Ws(m);else{if(!j){if(m.stateNode===null)throw Error(a(166));return Ur(m),null}d=X.current,mc(m)?X1(m):(d=xb(q,j,S),m.stateNode=d,Ws(m))}return Ur(m),null;case 5:if(se(m),S=m.type,d!==null&&m.stateNode!=null)d.memoizedProps!==j&&Ws(m);else{if(!j){if(m.stateNode===null)throw Error(a(166));return Ur(m),null}if(d=X.current,mc(m))X1(m);else{switch(q=Wd(z.current),d){case 1:d=q.createElementNS("http://www.w3.org/2000/svg",S);break;case 2:d=q.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;default:switch(S){case"svg":d=q.createElementNS("http://www.w3.org/2000/svg",S);break;case"math":d=q.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;case"script":d=q.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild);break;case"select":d=typeof j.is=="string"?q.createElement("select",{is:j.is}):q.createElement("select"),j.multiple?d.multiple=!0:j.size&&(d.size=j.size);break;default:d=typeof j.is=="string"?q.createElement(S,{is:j.is}):q.createElement(S)}}d[Ft]=m,d[kt]=j;e:for(q=m.child;q!==null;){if(q.tag===5||q.tag===6)d.appendChild(q.stateNode);else if(q.tag!==4&&q.tag!==27&&q.child!==null){q.child.return=q,q=q.child;continue}if(q===m)break e;for(;q.sibling===null;){if(q.return===null||q.return===m)break e;q=q.return}q.sibling.return=q.return,q=q.sibling}m.stateNode=d;e:switch(Ta(d,S,j),S){case"button":case"input":case"select":case"textarea":d=!!j.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&Ws(m)}}return Ur(m),m.flags&=-16777217,null;case 6:if(d&&m.stateNode!=null)d.memoizedProps!==j&&Ws(m);else{if(typeof j!="string"&&m.stateNode===null)throw Error(a(166));if(d=z.current,mc(m)){if(d=m.stateNode,S=m.memoizedProps,j=null,q=Ga,q!==null)switch(q.tag){case 27:case 5:j=q.memoizedProps}d[Ft]=m,d=!!(d.nodeValue===S||j!==null&&j.suppressHydrationWarning===!0||fb(d.nodeValue,S)),d||go(m)}else d=Wd(d).createTextNode(j),d[Ft]=m,m.stateNode=d}return Ur(m),null;case 13:if(j=m.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(q=mc(m),j!==null&&j.dehydrated!==null){if(d===null){if(!q)throw Error(a(318));if(q=m.memoizedState,q=q!==null?q.dehydrated:null,!q)throw Error(a(317));q[Ft]=m}else gc(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;Ur(m),q=!1}else q=Z1(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=q),q=!0;if(!q)return m.flags&256?(Hs(m),m):(Hs(m),null)}if(Hs(m),(m.flags&128)!==0)return m.lanes=S,m;if(S=j!==null,d=d!==null&&d.memoizedState!==null,S){j=m.child,q=null,j.alternate!==null&&j.alternate.memoizedState!==null&&j.alternate.memoizedState.cachePool!==null&&(q=j.alternate.memoizedState.cachePool.pool);var J=null;j.memoizedState!==null&&j.memoizedState.cachePool!==null&&(J=j.memoizedState.cachePool.pool),J!==q&&(j.flags|=2048)}return S!==d&&S&&(m.child.flags|=8192),Md(m,m.updateQueue),Ur(m),null;case 4:return M(),d===null&&M0(m.stateNode.containerInfo),Ur(m),null;case 10:return $s(m.type),Ur(m),null;case 19:if(F(pa),q=m.memoizedState,q===null)return Ur(m),null;if(j=(m.flags&128)!==0,J=q.rendering,J===null)if(j)Dc(q,!1);else{if(qr!==0||d!==null&&(d.flags&128)!==0)for(d=m.child;d!==null;){if(J=Cd(d),J!==null){for(m.flags|=128,Dc(q,!1),d=J.updateQueue,m.updateQueue=d,Md(m,d),m.subtreeFlags=0,d=S,S=m.child;S!==null;)G1(S,d),S=S.sibling;return Y(pa,pa.current&1|2),m.child}d=d.sibling}q.tail!==null&&ne()>Fd&&(m.flags|=128,j=!0,Dc(q,!1),m.lanes=4194304)}else{if(!j)if(d=Cd(J),d!==null){if(m.flags|=128,j=!0,d=d.updateQueue,m.updateQueue=d,Md(m,d),Dc(q,!0),q.tail===null&&q.tailMode==="hidden"&&!J.alternate&&!wr)return Ur(m),null}else 2*ne()-q.renderingStartTime>Fd&&S!==536870912&&(m.flags|=128,j=!0,Dc(q,!1),m.lanes=4194304);q.isBackwards?(J.sibling=m.child,m.child=J):(d=q.last,d!==null?d.sibling=J:m.child=J,q.last=J)}return q.tail!==null?(m=q.tail,q.rendering=m,q.tail=m.sibling,q.renderingStartTime=ne(),m.sibling=null,d=pa.current,Y(pa,j?d&1|2:d&1),m):(Ur(m),null);case 22:case 23:return Hs(m),Ih(),j=m.memoizedState!==null,d!==null?d.memoizedState!==null!==j&&(m.flags|=8192):j&&(m.flags|=8192),j?(S&536870912)!==0&&(m.flags&128)===0&&(Ur(m),m.subtreeFlags&6&&(m.flags|=8192)):Ur(m),S=m.updateQueue,S!==null&&Md(m,S.retryQueue),S=null,d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(S=d.memoizedState.cachePool.pool),j=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(j=m.memoizedState.cachePool.pool),j!==S&&(m.flags|=2048),d!==null&&F(xo),null;case 24:return S=null,d!==null&&(S=d.memoizedState.cache),m.memoizedState.cache!==S&&(m.flags|=2048),$s(ha),Ur(m),null;case 25:return null;case 30:return null}throw Error(a(156,m.tag))}function x6(d,m){switch(wh(m),m.tag){case 1:return d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 3:return $s(ha),M(),d=m.flags,(d&65536)!==0&&(d&128)===0?(m.flags=d&-65537|128,m):null;case 26:case 27:case 5:return se(m),null;case 13:if(Hs(m),d=m.memoizedState,d!==null&&d.dehydrated!==null){if(m.alternate===null)throw Error(a(340));gc()}return d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 19:return F(pa),null;case 4:return M(),null;case 10:return $s(m.type),null;case 22:case 23:return Hs(m),Ih(),d!==null&&F(xo),d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 24:return $s(ha),null;case 25:return null;default:return null}}function yv(d,m){switch(wh(m),m.tag){case 3:$s(ha),M();break;case 26:case 27:case 5:se(m);break;case 4:M();break;case 13:Hs(m);break;case 19:F(pa);break;case 10:$s(m.type);break;case 22:case 23:Hs(m),Ih(),d!==null&&F(xo);break;case 24:$s(ha)}}function Mc(d,m){try{var S=m.updateQueue,j=S!==null?S.lastEffect:null;if(j!==null){var q=j.next;S=q;do{if((S.tag&d)===d){j=void 0;var J=S.create,oe=S.inst;j=J(),oe.destroy=j}S=S.next}while(S!==q)}}catch(ge){Dr(m,m.return,ge)}}function ki(d,m,S){try{var j=m.updateQueue,q=j!==null?j.lastEffect:null;if(q!==null){var J=q.next;j=J;do{if((j.tag&d)===d){var oe=j.inst,ge=oe.destroy;if(ge!==void 0){oe.destroy=void 0,q=m;var Ne=S,Ge=ge;try{Ge()}catch(lt){Dr(q,Ne,lt)}}}j=j.next}while(j!==J)}}catch(lt){Dr(m,m.return,lt)}}function wv(d){var m=d.updateQueue;if(m!==null){var S=d.stateNode;try{lg(m,S)}catch(j){Dr(d,d.return,j)}}}function _v(d,m,S){S.props=wo(d.type,d.memoizedProps),S.state=d.memoizedState;try{S.componentWillUnmount()}catch(j){Dr(d,m,j)}}function Rc(d,m){try{var S=d.ref;if(S!==null){switch(d.tag){case 26:case 27:case 5:var j=d.stateNode;break;case 30:j=d.stateNode;break;default:j=d.stateNode}typeof S=="function"?d.refCleanup=S(j):S.current=j}}catch(q){Dr(d,m,q)}}function gs(d,m){var S=d.ref,j=d.refCleanup;if(S!==null)if(typeof j=="function")try{j()}catch(q){Dr(d,m,q)}finally{d.refCleanup=null,d=d.alternate,d!=null&&(d.refCleanup=null)}else if(typeof S=="function")try{S(null)}catch(q){Dr(d,m,q)}else S.current=null}function Sv(d){var m=d.type,S=d.memoizedProps,j=d.stateNode;try{e:switch(m){case"button":case"input":case"select":case"textarea":S.autoFocus&&j.focus();break e;case"img":S.src?j.src=S.src:S.srcSet&&(j.srcset=S.srcSet)}}catch(q){Dr(d,d.return,q)}}function c0(d,m,S){try{var j=d.stateNode;U6(j,d.type,S,m),j[kt]=m}catch(q){Dr(d,d.return,q)}}function kv(d){return d.tag===5||d.tag===3||d.tag===26||d.tag===27&&Di(d.type)||d.tag===4}function u0(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||kv(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.tag===27&&Di(d.type)||d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function d0(d,m,S){var j=d.tag;if(j===5||j===6)d=d.stateNode,m?(S.nodeType===9?S.body:S.nodeName==="HTML"?S.ownerDocument.body:S).insertBefore(d,m):(m=S.nodeType===9?S.body:S.nodeName==="HTML"?S.ownerDocument.body:S,m.appendChild(d),S=S._reactRootContainer,S!=null||m.onclick!==null||(m.onclick=qd));else if(j!==4&&(j===27&&Di(d.type)&&(S=d.stateNode,m=null),d=d.child,d!==null))for(d0(d,m,S),d=d.sibling;d!==null;)d0(d,m,S),d=d.sibling}function Rd(d,m,S){var j=d.tag;if(j===5||j===6)d=d.stateNode,m?S.insertBefore(d,m):S.appendChild(d);else if(j!==4&&(j===27&&Di(d.type)&&(S=d.stateNode),d=d.child,d!==null))for(Rd(d,m,S),d=d.sibling;d!==null;)Rd(d,m,S),d=d.sibling}function Ev(d){var m=d.stateNode,S=d.memoizedProps;try{for(var j=d.type,q=m.attributes;q.length;)m.removeAttributeNode(q[0]);Ta(m,j,S),m[Ft]=d,m[kt]=S}catch(J){Dr(d,d.return,J)}}var Gs=!1,Kr=!1,f0=!1,Tv=typeof WeakSet=="function"?WeakSet:Set,ya=null;function y6(d,m){if(d=d.containerInfo,F0=Jd,d=P1(d),uh(d)){if("selectionStart"in d)var S={start:d.selectionStart,end:d.selectionEnd};else e:{S=(S=d.ownerDocument)&&S.defaultView||window;var j=S.getSelection&&S.getSelection();if(j&&j.rangeCount!==0){S=j.anchorNode;var q=j.anchorOffset,J=j.focusNode;j=j.focusOffset;try{S.nodeType,J.nodeType}catch{S=null;break e}var oe=0,ge=-1,Ne=-1,Ge=0,lt=0,pt=d,Ke=null;t:for(;;){for(var Ze;pt!==S||q!==0&&pt.nodeType!==3||(ge=oe+q),pt!==J||j!==0&&pt.nodeType!==3||(Ne=oe+j),pt.nodeType===3&&(oe+=pt.nodeValue.length),(Ze=pt.firstChild)!==null;)Ke=pt,pt=Ze;for(;;){if(pt===d)break t;if(Ke===S&&++Ge===q&&(ge=oe),Ke===J&&++lt===j&&(Ne=oe),(Ze=pt.nextSibling)!==null)break;pt=Ke,Ke=pt.parentNode}pt=Ze}S=ge===-1||Ne===-1?null:{start:ge,end:Ne}}else S=null}S=S||{start:0,end:0}}else S=null;for(P0={focusedElem:d,selectionRange:S},Jd=!1,ya=m;ya!==null;)if(m=ya,d=m.child,(m.subtreeFlags&1024)!==0&&d!==null)d.return=m,ya=d;else for(;ya!==null;){switch(m=ya,J=m.alternate,d=m.flags,m.tag){case 0:break;case 11:case 15:break;case 1:if((d&1024)!==0&&J!==null){d=void 0,S=m,q=J.memoizedProps,J=J.memoizedState,j=S.stateNode;try{var Zt=wo(S.type,q,S.elementType===S.type);d=j.getSnapshotBeforeUpdate(Zt,J),j.__reactInternalSnapshotBeforeUpdate=d}catch(qt){Dr(S,S.return,qt)}}break;case 3:if((d&1024)!==0){if(d=m.stateNode.containerInfo,S=d.nodeType,S===9)U0(d);else if(S===1)switch(d.nodeName){case"HEAD":case"HTML":case"BODY":U0(d);break;default:d.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(a(163))}if(d=m.sibling,d!==null){d.return=m.return,ya=d;break}ya=m.return}}function Av(d,m,S){var j=S.flags;switch(S.tag){case 0:case 11:case 15:Ei(d,S),j&4&&Mc(5,S);break;case 1:if(Ei(d,S),j&4)if(d=S.stateNode,m===null)try{d.componentDidMount()}catch(oe){Dr(S,S.return,oe)}else{var q=wo(S.type,m.memoizedProps);m=m.memoizedState;try{d.componentDidUpdate(q,m,d.__reactInternalSnapshotBeforeUpdate)}catch(oe){Dr(S,S.return,oe)}}j&64&&wv(S),j&512&&Rc(S,S.return);break;case 3:if(Ei(d,S),j&64&&(d=S.updateQueue,d!==null)){if(m=null,S.child!==null)switch(S.child.tag){case 27:case 5:m=S.child.stateNode;break;case 1:m=S.child.stateNode}try{lg(d,m)}catch(oe){Dr(S,S.return,oe)}}break;case 27:m===null&&j&4&&Ev(S);case 26:case 5:Ei(d,S),m===null&&j&4&&Sv(S),j&512&&Rc(S,S.return);break;case 12:Ei(d,S);break;case 13:Ei(d,S),j&4&&jv(d,S),j&64&&(d=S.memoizedState,d!==null&&(d=d.dehydrated,d!==null&&(S=N6.bind(null,S),G6(d,S))));break;case 22:if(j=S.memoizedState!==null||Gs,!j){m=m!==null&&m.memoizedState!==null||Kr,q=Gs;var J=Kr;Gs=j,(Kr=m)&&!J?Ti(d,S,(S.subtreeFlags&8772)!==0):Ei(d,S),Gs=q,Kr=J}break;case 30:break;default:Ei(d,S)}}function Cv(d){var m=d.alternate;m!==null&&(d.alternate=null,Cv(m)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(m=d.stateNode,m!==null&&ve(m)),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}var Lr=null,nn=!1;function Ys(d,m,S){for(S=S.child;S!==null;)Nv(d,m,S),S=S.sibling}function Nv(d,m,S){if(rt&&typeof rt.onCommitFiberUnmount=="function")try{rt.onCommitFiberUnmount(at,S)}catch{}switch(S.tag){case 26:Kr||gs(S,m),Ys(d,m,S),S.memoizedState?S.memoizedState.count--:S.stateNode&&(S=S.stateNode,S.parentNode.removeChild(S));break;case 27:Kr||gs(S,m);var j=Lr,q=nn;Di(S.type)&&(Lr=S.stateNode,nn=!1),Ys(d,m,S),Vc(S.stateNode),Lr=j,nn=q;break;case 5:Kr||gs(S,m);case 6:if(j=Lr,q=nn,Lr=null,Ys(d,m,S),Lr=j,nn=q,Lr!==null)if(nn)try{(Lr.nodeType===9?Lr.body:Lr.nodeName==="HTML"?Lr.ownerDocument.body:Lr).removeChild(S.stateNode)}catch(J){Dr(S,m,J)}else try{Lr.removeChild(S.stateNode)}catch(J){Dr(S,m,J)}break;case 18:Lr!==null&&(nn?(d=Lr,vb(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,S.stateNode),Zc(d)):vb(Lr,S.stateNode));break;case 4:j=Lr,q=nn,Lr=S.stateNode.containerInfo,nn=!0,Ys(d,m,S),Lr=j,nn=q;break;case 0:case 11:case 14:case 15:Kr||ki(2,S,m),Kr||ki(4,S,m),Ys(d,m,S);break;case 1:Kr||(gs(S,m),j=S.stateNode,typeof j.componentWillUnmount=="function"&&_v(S,m,j)),Ys(d,m,S);break;case 21:Ys(d,m,S);break;case 22:Kr=(j=Kr)||S.memoizedState!==null,Ys(d,m,S),Kr=j;break;default:Ys(d,m,S)}}function jv(d,m){if(m.memoizedState===null&&(d=m.alternate,d!==null&&(d=d.memoizedState,d!==null&&(d=d.dehydrated,d!==null))))try{Zc(d)}catch(S){Dr(m,m.return,S)}}function w6(d){switch(d.tag){case 13:case 19:var m=d.stateNode;return m===null&&(m=d.stateNode=new Tv),m;case 22:return d=d.stateNode,m=d._retryCache,m===null&&(m=d._retryCache=new Tv),m;default:throw Error(a(435,d.tag))}}function h0(d,m){var S=w6(d);m.forEach(function(j){var q=j6.bind(null,d,j);S.has(j)||(S.add(j),j.then(q,q))})}function fn(d,m){var S=m.deletions;if(S!==null)for(var j=0;j<S.length;j++){var q=S[j],J=d,oe=m,ge=oe;e:for(;ge!==null;){switch(ge.tag){case 27:if(Di(ge.type)){Lr=ge.stateNode,nn=!1;break e}break;case 5:Lr=ge.stateNode,nn=!1;break e;case 3:case 4:Lr=ge.stateNode.containerInfo,nn=!0;break e}ge=ge.return}if(Lr===null)throw Error(a(160));Nv(J,oe,q),Lr=null,nn=!1,J=q.alternate,J!==null&&(J.return=null),q.return=null}if(m.subtreeFlags&13878)for(m=m.child;m!==null;)Ov(m,d),m=m.sibling}var Zn=null;function Ov(d,m){var S=d.alternate,j=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:fn(m,d),hn(d),j&4&&(ki(3,d,d.return),Mc(3,d),ki(5,d,d.return));break;case 1:fn(m,d),hn(d),j&512&&(Kr||S===null||gs(S,S.return)),j&64&&Gs&&(d=d.updateQueue,d!==null&&(j=d.callbacks,j!==null&&(S=d.shared.hiddenCallbacks,d.shared.hiddenCallbacks=S===null?j:S.concat(j))));break;case 26:var q=Zn;if(fn(m,d),hn(d),j&512&&(Kr||S===null||gs(S,S.return)),j&4){var J=S!==null?S.memoizedState:null;if(j=d.memoizedState,S===null)if(j===null)if(d.stateNode===null){e:{j=d.type,S=d.memoizedProps,q=q.ownerDocument||q;t:switch(j){case"title":J=q.getElementsByTagName("title")[0],(!J||J[de]||J[Ft]||J.namespaceURI==="http://www.w3.org/2000/svg"||J.hasAttribute("itemprop"))&&(J=q.createElement(j),q.head.insertBefore(J,q.querySelector("head > title"))),Ta(J,j,S),J[Ft]=d,Oe(J),j=J;break e;case"link":var oe=Eb("link","href",q).get(j+(S.href||""));if(oe){for(var ge=0;ge<oe.length;ge++)if(J=oe[ge],J.getAttribute("href")===(S.href==null||S.href===""?null:S.href)&&J.getAttribute("rel")===(S.rel==null?null:S.rel)&&J.getAttribute("title")===(S.title==null?null:S.title)&&J.getAttribute("crossorigin")===(S.crossOrigin==null?null:S.crossOrigin)){oe.splice(ge,1);break t}}J=q.createElement(j),Ta(J,j,S),q.head.appendChild(J);break;case"meta":if(oe=Eb("meta","content",q).get(j+(S.content||""))){for(ge=0;ge<oe.length;ge++)if(J=oe[ge],J.getAttribute("content")===(S.content==null?null:""+S.content)&&J.getAttribute("name")===(S.name==null?null:S.name)&&J.getAttribute("property")===(S.property==null?null:S.property)&&J.getAttribute("http-equiv")===(S.httpEquiv==null?null:S.httpEquiv)&&J.getAttribute("charset")===(S.charSet==null?null:S.charSet)){oe.splice(ge,1);break t}}J=q.createElement(j),Ta(J,j,S),q.head.appendChild(J);break;default:throw Error(a(468,j))}J[Ft]=d,Oe(J),j=J}d.stateNode=j}else Tb(q,d.type,d.stateNode);else d.stateNode=kb(q,j,d.memoizedProps);else J!==j?(J===null?S.stateNode!==null&&(S=S.stateNode,S.parentNode.removeChild(S)):J.count--,j===null?Tb(q,d.type,d.stateNode):kb(q,j,d.memoizedProps)):j===null&&d.stateNode!==null&&c0(d,d.memoizedProps,S.memoizedProps)}break;case 27:fn(m,d),hn(d),j&512&&(Kr||S===null||gs(S,S.return)),S!==null&&j&4&&c0(d,d.memoizedProps,S.memoizedProps);break;case 5:if(fn(m,d),hn(d),j&512&&(Kr||S===null||gs(S,S.return)),d.flags&32){q=d.stateNode;try{ra(q,"")}catch(Ze){Dr(d,d.return,Ze)}}j&4&&d.stateNode!=null&&(q=d.memoizedProps,c0(d,q,S!==null?S.memoizedProps:q)),j&1024&&(f0=!0);break;case 6:if(fn(m,d),hn(d),j&4){if(d.stateNode===null)throw Error(a(162));j=d.memoizedProps,S=d.stateNode;try{S.nodeValue=j}catch(Ze){Dr(d,d.return,Ze)}}break;case 3:if(Xd=null,q=Zn,Zn=Gd(m.containerInfo),fn(m,d),Zn=q,hn(d),j&4&&S!==null&&S.memoizedState.isDehydrated)try{Zc(m.containerInfo)}catch(Ze){Dr(d,d.return,Ze)}f0&&(f0=!1,Dv(d));break;case 4:j=Zn,Zn=Gd(d.stateNode.containerInfo),fn(m,d),hn(d),Zn=j;break;case 12:fn(m,d),hn(d);break;case 13:fn(m,d),hn(d),d.child.flags&8192&&d.memoizedState!==null!=(S!==null&&S.memoizedState!==null)&&(x0=ne()),j&4&&(j=d.updateQueue,j!==null&&(d.updateQueue=null,h0(d,j)));break;case 22:q=d.memoizedState!==null;var Ne=S!==null&&S.memoizedState!==null,Ge=Gs,lt=Kr;if(Gs=Ge||q,Kr=lt||Ne,fn(m,d),Kr=lt,Gs=Ge,hn(d),j&8192)e:for(m=d.stateNode,m._visibility=q?m._visibility&-2:m._visibility|1,q&&(S===null||Ne||Gs||Kr||_o(d)),S=null,m=d;;){if(m.tag===5||m.tag===26){if(S===null){Ne=S=m;try{if(J=Ne.stateNode,q)oe=J.style,typeof oe.setProperty=="function"?oe.setProperty("display","none","important"):oe.display="none";else{ge=Ne.stateNode;var pt=Ne.memoizedProps.style,Ke=pt!=null&&pt.hasOwnProperty("display")?pt.display:null;ge.style.display=Ke==null||typeof Ke=="boolean"?"":(""+Ke).trim()}}catch(Ze){Dr(Ne,Ne.return,Ze)}}}else if(m.tag===6){if(S===null){Ne=m;try{Ne.stateNode.nodeValue=q?"":Ne.memoizedProps}catch(Ze){Dr(Ne,Ne.return,Ze)}}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===d)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===d)break e;for(;m.sibling===null;){if(m.return===null||m.return===d)break e;S===m&&(S=null),m=m.return}S===m&&(S=null),m.sibling.return=m.return,m=m.sibling}j&4&&(j=d.updateQueue,j!==null&&(S=j.retryQueue,S!==null&&(j.retryQueue=null,h0(d,S))));break;case 19:fn(m,d),hn(d),j&4&&(j=d.updateQueue,j!==null&&(d.updateQueue=null,h0(d,j)));break;case 30:break;case 21:break;default:fn(m,d),hn(d)}}function hn(d){var m=d.flags;if(m&2){try{for(var S,j=d.return;j!==null;){if(kv(j)){S=j;break}j=j.return}if(S==null)throw Error(a(160));switch(S.tag){case 27:var q=S.stateNode,J=u0(d);Rd(d,J,q);break;case 5:var oe=S.stateNode;S.flags&32&&(ra(oe,""),S.flags&=-33);var ge=u0(d);Rd(d,ge,oe);break;case 3:case 4:var Ne=S.stateNode.containerInfo,Ge=u0(d);d0(d,Ge,Ne);break;default:throw Error(a(161))}}catch(lt){Dr(d,d.return,lt)}d.flags&=-3}m&4096&&(d.flags&=-4097)}function Dv(d){if(d.subtreeFlags&1024)for(d=d.child;d!==null;){var m=d;Dv(m),m.tag===5&&m.flags&1024&&m.stateNode.reset(),d=d.sibling}}function Ei(d,m){if(m.subtreeFlags&8772)for(m=m.child;m!==null;)Av(d,m.alternate,m),m=m.sibling}function _o(d){for(d=d.child;d!==null;){var m=d;switch(m.tag){case 0:case 11:case 14:case 15:ki(4,m,m.return),_o(m);break;case 1:gs(m,m.return);var S=m.stateNode;typeof S.componentWillUnmount=="function"&&_v(m,m.return,S),_o(m);break;case 27:Vc(m.stateNode);case 26:case 5:gs(m,m.return),_o(m);break;case 22:m.memoizedState===null&&_o(m);break;case 30:_o(m);break;default:_o(m)}d=d.sibling}}function Ti(d,m,S){for(S=S&&(m.subtreeFlags&8772)!==0,m=m.child;m!==null;){var j=m.alternate,q=d,J=m,oe=J.flags;switch(J.tag){case 0:case 11:case 15:Ti(q,J,S),Mc(4,J);break;case 1:if(Ti(q,J,S),j=J,q=j.stateNode,typeof q.componentDidMount=="function")try{q.componentDidMount()}catch(Ge){Dr(j,j.return,Ge)}if(j=J,q=j.updateQueue,q!==null){var ge=j.stateNode;try{var Ne=q.shared.hiddenCallbacks;if(Ne!==null)for(q.shared.hiddenCallbacks=null,q=0;q<Ne.length;q++)og(Ne[q],ge)}catch(Ge){Dr(j,j.return,Ge)}}S&&oe&64&&wv(J),Rc(J,J.return);break;case 27:Ev(J);case 26:case 5:Ti(q,J,S),S&&j===null&&oe&4&&Sv(J),Rc(J,J.return);break;case 12:Ti(q,J,S);break;case 13:Ti(q,J,S),S&&oe&4&&jv(q,J);break;case 22:J.memoizedState===null&&Ti(q,J,S),Rc(J,J.return);break;case 30:break;default:Ti(q,J,S)}m=m.sibling}}function p0(d,m){var S=null;d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(S=d.memoizedState.cachePool.pool),d=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(d=m.memoizedState.cachePool.pool),d!==S&&(d!=null&&d.refCount++,S!=null&&xc(S))}function m0(d,m){d=null,m.alternate!==null&&(d=m.alternate.memoizedState.cache),m=m.memoizedState.cache,m!==d&&(m.refCount++,d!=null&&xc(d))}function vs(d,m,S,j){if(m.subtreeFlags&10256)for(m=m.child;m!==null;)Mv(d,m,S,j),m=m.sibling}function Mv(d,m,S,j){var q=m.flags;switch(m.tag){case 0:case 11:case 15:vs(d,m,S,j),q&2048&&Mc(9,m);break;case 1:vs(d,m,S,j);break;case 3:vs(d,m,S,j),q&2048&&(d=null,m.alternate!==null&&(d=m.alternate.memoizedState.cache),m=m.memoizedState.cache,m!==d&&(m.refCount++,d!=null&&xc(d)));break;case 12:if(q&2048){vs(d,m,S,j),d=m.stateNode;try{var J=m.memoizedProps,oe=J.id,ge=J.onPostCommit;typeof ge=="function"&&ge(oe,m.alternate===null?"mount":"update",d.passiveEffectDuration,-0)}catch(Ne){Dr(m,m.return,Ne)}}else vs(d,m,S,j);break;case 13:vs(d,m,S,j);break;case 23:break;case 22:J=m.stateNode,oe=m.alternate,m.memoizedState!==null?J._visibility&2?vs(d,m,S,j):Ic(d,m):J._visibility&2?vs(d,m,S,j):(J._visibility|=2,ul(d,m,S,j,(m.subtreeFlags&10256)!==0)),q&2048&&p0(oe,m);break;case 24:vs(d,m,S,j),q&2048&&m0(m.alternate,m);break;default:vs(d,m,S,j)}}function ul(d,m,S,j,q){for(q=q&&(m.subtreeFlags&10256)!==0,m=m.child;m!==null;){var J=d,oe=m,ge=S,Ne=j,Ge=oe.flags;switch(oe.tag){case 0:case 11:case 15:ul(J,oe,ge,Ne,q),Mc(8,oe);break;case 23:break;case 22:var lt=oe.stateNode;oe.memoizedState!==null?lt._visibility&2?ul(J,oe,ge,Ne,q):Ic(J,oe):(lt._visibility|=2,ul(J,oe,ge,Ne,q)),q&&Ge&2048&&p0(oe.alternate,oe);break;case 24:ul(J,oe,ge,Ne,q),q&&Ge&2048&&m0(oe.alternate,oe);break;default:ul(J,oe,ge,Ne,q)}m=m.sibling}}function Ic(d,m){if(m.subtreeFlags&10256)for(m=m.child;m!==null;){var S=d,j=m,q=j.flags;switch(j.tag){case 22:Ic(S,j),q&2048&&p0(j.alternate,j);break;case 24:Ic(S,j),q&2048&&m0(j.alternate,j);break;default:Ic(S,j)}m=m.sibling}}var Fc=8192;function dl(d){if(d.subtreeFlags&Fc)for(d=d.child;d!==null;)Rv(d),d=d.sibling}function Rv(d){switch(d.tag){case 26:dl(d),d.flags&Fc&&d.memoizedState!==null&&i5(Zn,d.memoizedState,d.memoizedProps);break;case 5:dl(d);break;case 3:case 4:var m=Zn;Zn=Gd(d.stateNode.containerInfo),dl(d),Zn=m;break;case 22:d.memoizedState===null&&(m=d.alternate,m!==null&&m.memoizedState!==null?(m=Fc,Fc=16777216,dl(d),Fc=m):dl(d));break;default:dl(d)}}function Iv(d){var m=d.alternate;if(m!==null&&(d=m.child,d!==null)){m.child=null;do m=d.sibling,d.sibling=null,d=m;while(d!==null)}}function Pc(d){var m=d.deletions;if((d.flags&16)!==0){if(m!==null)for(var S=0;S<m.length;S++){var j=m[S];ya=j,Pv(j,d)}Iv(d)}if(d.subtreeFlags&10256)for(d=d.child;d!==null;)Fv(d),d=d.sibling}function Fv(d){switch(d.tag){case 0:case 11:case 15:Pc(d),d.flags&2048&&ki(9,d,d.return);break;case 3:Pc(d);break;case 12:Pc(d);break;case 22:var m=d.stateNode;d.memoizedState!==null&&m._visibility&2&&(d.return===null||d.return.tag!==13)?(m._visibility&=-3,Id(d)):Pc(d);break;default:Pc(d)}}function Id(d){var m=d.deletions;if((d.flags&16)!==0){if(m!==null)for(var S=0;S<m.length;S++){var j=m[S];ya=j,Pv(j,d)}Iv(d)}for(d=d.child;d!==null;){switch(m=d,m.tag){case 0:case 11:case 15:ki(8,m,m.return),Id(m);break;case 22:S=m.stateNode,S._visibility&2&&(S._visibility&=-3,Id(m));break;default:Id(m)}d=d.sibling}}function Pv(d,m){for(;ya!==null;){var S=ya;switch(S.tag){case 0:case 11:case 15:ki(8,S,m);break;case 23:case 22:if(S.memoizedState!==null&&S.memoizedState.cachePool!==null){var j=S.memoizedState.cachePool.pool;j!=null&&j.refCount++}break;case 24:xc(S.memoizedState.cache)}if(j=S.child,j!==null)j.return=S,ya=j;else e:for(S=d;ya!==null;){j=ya;var q=j.sibling,J=j.return;if(Cv(j),j===S){ya=null;break e}if(q!==null){q.return=J,ya=q;break e}ya=J}}}var _6={getCacheForType:function(d){var m=Ra(ha),S=m.data.get(d);return S===void 0&&(S=d(),m.data.set(d,S)),S}},S6=typeof WeakMap=="function"?WeakMap:Map,Er=0,Rr=null,lr=null,hr=0,Tr=0,pn=null,Ai=!1,fl=!1,g0=!1,Xs=0,qr=0,Ci=0,So=0,v0=0,Mn=0,hl=0,Lc=null,sn=null,b0=!1,x0=0,Fd=1/0,Pd=null,Ni=null,Ea=0,ji=null,pl=null,ml=0,y0=0,w0=null,Lv=null,Bc=0,_0=null;function mn(){if((Er&2)!==0&&hr!==0)return hr&-hr;if(_.T!==null){var d=rl;return d!==0?d:N0()}return Kt()}function Bv(){Mn===0&&(Mn=(hr&536870912)===0||wr?He():536870912);var d=Dn.current;return d!==null&&(d.flags|=32),Mn}function gn(d,m,S){(d===Rr&&(Tr===2||Tr===9)||d.cancelPendingCommit!==null)&&(gl(d,0),Oi(d,hr,Mn,!1)),tt(d,S),((Er&2)===0||d!==Rr)&&(d===Rr&&((Er&2)===0&&(So|=S),qr===4&&Oi(d,hr,Mn,!1)),bs(d))}function Uv(d,m,S){if((Er&6)!==0)throw Error(a(327));var j=!S&&(m&124)===0&&(m&d.expiredLanes)===0||mt(d,m),q=j?T6(d,m):E0(d,m,!0),J=j;do{if(q===0){fl&&!j&&Oi(d,m,0,!1);break}else{if(S=d.current.alternate,J&&!k6(S)){q=E0(d,m,!1),J=!1;continue}if(q===2){if(J=m,d.errorRecoveryDisabledLanes&J)var oe=0;else oe=d.pendingLanes&-536870913,oe=oe!==0?oe:oe&536870912?536870912:0;if(oe!==0){m=oe;e:{var ge=d;q=Lc;var Ne=ge.current.memoizedState.isDehydrated;if(Ne&&(gl(ge,oe).flags|=256),oe=E0(ge,oe,!1),oe!==2){if(g0&&!Ne){ge.errorRecoveryDisabledLanes|=J,So|=J,q=4;break e}J=sn,sn=q,J!==null&&(sn===null?sn=J:sn.push.apply(sn,J))}q=oe}if(J=!1,q!==2)continue}}if(q===1){gl(d,0),Oi(d,m,0,!0);break}e:{switch(j=d,J=q,J){case 0:case 1:throw Error(a(345));case 4:if((m&4194048)!==m)break;case 6:Oi(j,m,Mn,!Ai);break e;case 2:sn=null;break;case 3:case 5:break;default:throw Error(a(329))}if((m&62914560)===m&&(q=x0+300-ne(),10<q)){if(Oi(j,m,Mn,!Ai),_t(j,0,!0)!==0)break e;j.timeoutHandle=mb(zv.bind(null,j,S,sn,Pd,b0,m,Mn,So,hl,Ai,J,2,-0,0),q);break e}zv(j,S,sn,Pd,b0,m,Mn,So,hl,Ai,J,0,-0,0)}}break}while(!0);bs(d)}function zv(d,m,S,j,q,J,oe,ge,Ne,Ge,lt,pt,Ke,Ze){if(d.timeoutHandle=-1,pt=m.subtreeFlags,(pt&8192||(pt&16785408)===16785408)&&(Wc={stylesheets:null,count:0,unsuspend:s5},Rv(m),pt=o5(),pt!==null)){d.cancelPendingCommit=pt(Yv.bind(null,d,m,J,S,j,q,oe,ge,Ne,lt,1,Ke,Ze)),Oi(d,J,oe,!Ge);return}Yv(d,m,J,S,j,q,oe,ge,Ne)}function k6(d){for(var m=d;;){var S=m.tag;if((S===0||S===11||S===15)&&m.flags&16384&&(S=m.updateQueue,S!==null&&(S=S.stores,S!==null)))for(var j=0;j<S.length;j++){var q=S[j],J=q.getSnapshot;q=q.value;try{if(!un(J(),q))return!1}catch{return!1}}if(S=m.child,m.subtreeFlags&16384&&S!==null)S.return=m,m=S;else{if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function Oi(d,m,S,j){m&=~v0,m&=~So,d.suspendedLanes|=m,d.pingedLanes&=~m,j&&(d.warmLanes|=m),j=d.expirationTimes;for(var q=m;0<q;){var J=31-et(q),oe=1<<J;j[J]=-1,q&=~oe}S!==0&&ut(d,S,m)}function Ld(){return(Er&6)===0?(Uc(0),!1):!0}function S0(){if(lr!==null){if(Tr===0)var d=lr.return;else d=lr,zs=vo=null,Uh(d),ll=null,jc=0,d=lr;for(;d!==null;)yv(d.alternate,d),d=d.return;lr=null}}function gl(d,m){var S=d.timeoutHandle;S!==-1&&(d.timeoutHandle=-1,$6(S)),S=d.cancelPendingCommit,S!==null&&(d.cancelPendingCommit=null,S()),S0(),Rr=d,lr=S=Ls(d.current,null),hr=m,Tr=0,pn=null,Ai=!1,fl=mt(d,m),g0=!1,hl=Mn=v0=So=Ci=qr=0,sn=Lc=null,b0=!1,(m&8)!==0&&(m|=m&32);var j=d.entangledLanes;if(j!==0)for(d=d.entanglements,j&=m;0<j;){var q=31-et(j),J=1<<q;m|=d[q],j&=~J}return Xs=m,id(),S}function $v(d,m){nr=null,_.H=Ed,m===wc||m===md?(m=sg(),Tr=3):m===rg?(m=sg(),Tr=4):Tr=m===iv?8:m!==null&&typeof m=="object"&&typeof m.then=="function"?6:1,pn=m,lr===null&&(qr=1,jd(d,Cn(m,d.current)))}function Vv(){var d=_.H;return _.H=Ed,d===null?Ed:d}function Hv(){var d=_.A;return _.A=_6,d}function k0(){qr=4,Ai||(hr&4194048)!==hr&&Dn.current!==null||(fl=!0),(Ci&134217727)===0&&(So&134217727)===0||Rr===null||Oi(Rr,hr,Mn,!1)}function E0(d,m,S){var j=Er;Er|=2;var q=Vv(),J=Hv();(Rr!==d||hr!==m)&&(Pd=null,gl(d,m)),m=!1;var oe=qr;e:do try{if(Tr!==0&&lr!==null){var ge=lr,Ne=pn;switch(Tr){case 8:S0(),oe=6;break e;case 3:case 2:case 9:case 6:Dn.current===null&&(m=!0);var Ge=Tr;if(Tr=0,pn=null,vl(d,ge,Ne,Ge),S&&fl){oe=0;break e}break;default:Ge=Tr,Tr=0,pn=null,vl(d,ge,Ne,Ge)}}E6(),oe=qr;break}catch(lt){$v(d,lt)}while(!0);return m&&d.shellSuspendCounter++,zs=vo=null,Er=j,_.H=q,_.A=J,lr===null&&(Rr=null,hr=0,id()),oe}function E6(){for(;lr!==null;)qv(lr)}function T6(d,m){var S=Er;Er|=2;var j=Vv(),q=Hv();Rr!==d||hr!==m?(Pd=null,Fd=ne()+500,gl(d,m)):fl=mt(d,m);e:do try{if(Tr!==0&&lr!==null){m=lr;var J=pn;t:switch(Tr){case 1:Tr=0,pn=null,vl(d,m,J,1);break;case 2:case 9:if(ag(J)){Tr=0,pn=null,Wv(m);break}m=function(){Tr!==2&&Tr!==9||Rr!==d||(Tr=7),bs(d)},J.then(m,m);break e;case 3:Tr=7;break e;case 4:Tr=5;break e;case 7:ag(J)?(Tr=0,pn=null,Wv(m)):(Tr=0,pn=null,vl(d,m,J,7));break;case 5:var oe=null;switch(lr.tag){case 26:oe=lr.memoizedState;case 5:case 27:var ge=lr;if(!oe||Ab(oe)){Tr=0,pn=null;var Ne=ge.sibling;if(Ne!==null)lr=Ne;else{var Ge=ge.return;Ge!==null?(lr=Ge,Bd(Ge)):lr=null}break t}}Tr=0,pn=null,vl(d,m,J,5);break;case 6:Tr=0,pn=null,vl(d,m,J,6);break;case 8:S0(),qr=6;break e;default:throw Error(a(462))}}A6();break}catch(lt){$v(d,lt)}while(!0);return zs=vo=null,_.H=j,_.A=q,Er=S,lr!==null?0:(Rr=null,hr=0,id(),qr)}function A6(){for(;lr!==null&&!fe();)qv(lr)}function qv(d){var m=bv(d.alternate,d,Xs);d.memoizedProps=d.pendingProps,m===null?Bd(d):lr=m}function Wv(d){var m=d,S=m.alternate;switch(m.tag){case 15:case 0:m=fv(S,m,m.pendingProps,m.type,void 0,hr);break;case 11:m=fv(S,m,m.pendingProps,m.type.render,m.ref,hr);break;case 5:Uh(m);default:yv(S,m),m=lr=G1(m,Xs),m=bv(S,m,Xs)}d.memoizedProps=d.pendingProps,m===null?Bd(d):lr=m}function vl(d,m,S,j){zs=vo=null,Uh(m),ll=null,jc=0;var q=m.return;try{if(g6(d,q,m,S,hr)){qr=1,jd(d,Cn(S,d.current)),lr=null;return}}catch(J){if(q!==null)throw lr=q,J;qr=1,jd(d,Cn(S,d.current)),lr=null;return}m.flags&32768?(wr||j===1?d=!0:fl||(hr&536870912)!==0?d=!1:(Ai=d=!0,(j===2||j===9||j===3||j===6)&&(j=Dn.current,j!==null&&j.tag===13&&(j.flags|=16384))),Gv(m,d)):Bd(m)}function Bd(d){var m=d;do{if((m.flags&32768)!==0){Gv(m,Ai);return}d=m.return;var S=b6(m.alternate,m,Xs);if(S!==null){lr=S;return}if(m=m.sibling,m!==null){lr=m;return}lr=m=d}while(m!==null);qr===0&&(qr=5)}function Gv(d,m){do{var S=x6(d.alternate,d);if(S!==null){S.flags&=32767,lr=S;return}if(S=d.return,S!==null&&(S.flags|=32768,S.subtreeFlags=0,S.deletions=null),!m&&(d=d.sibling,d!==null)){lr=d;return}lr=d=S}while(d!==null);qr=6,lr=null}function Yv(d,m,S,j,q,J,oe,ge,Ne){d.cancelPendingCommit=null;do Ud();while(Ea!==0);if((Er&6)!==0)throw Error(a(327));if(m!==null){if(m===d.current)throw Error(a(177));if(J=m.lanes|m.childLanes,J|=mh,dt(d,S,J,oe,ge,Ne),d===Rr&&(lr=Rr=null,hr=0),pl=m,ji=d,ml=S,y0=J,w0=q,Lv=j,(m.subtreeFlags&10256)!==0||(m.flags&10256)!==0?(d.callbackNode=null,d.callbackPriority=0,O6(pe,function(){return Qv(),null})):(d.callbackNode=null,d.callbackPriority=0),j=(m.flags&13878)!==0,(m.subtreeFlags&13878)!==0||j){j=_.T,_.T=null,q=k.p,k.p=2,oe=Er,Er|=4;try{y6(d,m,S)}finally{Er=oe,k.p=q,_.T=j}}Ea=1,Xv(),Kv(),Zv()}}function Xv(){if(Ea===1){Ea=0;var d=ji,m=pl,S=(m.flags&13878)!==0;if((m.subtreeFlags&13878)!==0||S){S=_.T,_.T=null;var j=k.p;k.p=2;var q=Er;Er|=4;try{Ov(m,d);var J=P0,oe=P1(d.containerInfo),ge=J.focusedElem,Ne=J.selectionRange;if(oe!==ge&&ge&&ge.ownerDocument&&F1(ge.ownerDocument.documentElement,ge)){if(Ne!==null&&uh(ge)){var Ge=Ne.start,lt=Ne.end;if(lt===void 0&&(lt=Ge),"selectionStart"in ge)ge.selectionStart=Ge,ge.selectionEnd=Math.min(lt,ge.value.length);else{var pt=ge.ownerDocument||document,Ke=pt&&pt.defaultView||window;if(Ke.getSelection){var Ze=Ke.getSelection(),Zt=ge.textContent.length,qt=Math.min(Ne.start,Zt),Or=Ne.end===void 0?qt:Math.min(Ne.end,Zt);!Ze.extend&&qt>Or&&(oe=Or,Or=qt,qt=oe);var ze=I1(ge,qt),Re=I1(ge,Or);if(ze&&Re&&(Ze.rangeCount!==1||Ze.anchorNode!==ze.node||Ze.anchorOffset!==ze.offset||Ze.focusNode!==Re.node||Ze.focusOffset!==Re.offset)){var We=pt.createRange();We.setStart(ze.node,ze.offset),Ze.removeAllRanges(),qt>Or?(Ze.addRange(We),Ze.extend(Re.node,Re.offset)):(We.setEnd(Re.node,Re.offset),Ze.addRange(We))}}}}for(pt=[],Ze=ge;Ze=Ze.parentNode;)Ze.nodeType===1&&pt.push({element:Ze,left:Ze.scrollLeft,top:Ze.scrollTop});for(typeof ge.focus=="function"&&ge.focus(),ge=0;ge<pt.length;ge++){var ft=pt[ge];ft.element.scrollLeft=ft.left,ft.element.scrollTop=ft.top}}Jd=!!F0,P0=F0=null}finally{Er=q,k.p=j,_.T=S}}d.current=m,Ea=2}}function Kv(){if(Ea===2){Ea=0;var d=ji,m=pl,S=(m.flags&8772)!==0;if((m.subtreeFlags&8772)!==0||S){S=_.T,_.T=null;var j=k.p;k.p=2;var q=Er;Er|=4;try{Av(d,m.alternate,m)}finally{Er=q,k.p=j,_.T=S}}Ea=3}}function Zv(){if(Ea===4||Ea===3){Ea=0,le();var d=ji,m=pl,S=ml,j=Lv;(m.subtreeFlags&10256)!==0||(m.flags&10256)!==0?Ea=5:(Ea=0,pl=ji=null,Jv(d,d.pendingLanes));var q=d.pendingLanes;if(q===0&&(Ni=null),At(S),m=m.stateNode,rt&&typeof rt.onCommitFiberRoot=="function")try{rt.onCommitFiberRoot(at,m,void 0,(m.current.flags&128)===128)}catch{}if(j!==null){m=_.T,q=k.p,k.p=2,_.T=null;try{for(var J=d.onRecoverableError,oe=0;oe<j.length;oe++){var ge=j[oe];J(ge.value,{componentStack:ge.stack})}}finally{_.T=m,k.p=q}}(ml&3)!==0&&Ud(),bs(d),q=d.pendingLanes,(S&4194090)!==0&&(q&42)!==0?d===_0?Bc++:(Bc=0,_0=d):Bc=0,Uc(0)}}function Jv(d,m){(d.pooledCacheLanes&=m)===0&&(m=d.pooledCache,m!=null&&(d.pooledCache=null,xc(m)))}function Ud(d){return Xv(),Kv(),Zv(),Qv()}function Qv(){if(Ea!==5)return!1;var d=ji,m=y0;y0=0;var S=At(ml),j=_.T,q=k.p;try{k.p=32>S?32:S,_.T=null,S=w0,w0=null;var J=ji,oe=ml;if(Ea=0,pl=ji=null,ml=0,(Er&6)!==0)throw Error(a(331));var ge=Er;if(Er|=4,Fv(J.current),Mv(J,J.current,oe,S),Er=ge,Uc(0,!1),rt&&typeof rt.onPostCommitFiberRoot=="function")try{rt.onPostCommitFiberRoot(at,J)}catch{}return!0}finally{k.p=q,_.T=j,Jv(d,m)}}function eb(d,m,S){m=Cn(S,m),m=e0(d.stateNode,m,2),d=yi(d,m,2),d!==null&&(tt(d,2),bs(d))}function Dr(d,m,S){if(d.tag===3)eb(d,d,S);else for(;m!==null;){if(m.tag===3){eb(m,d,S);break}else if(m.tag===1){var j=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof j.componentDidCatch=="function"&&(Ni===null||!Ni.has(j))){d=Cn(S,d),S=nv(2),j=yi(m,S,2),j!==null&&(sv(S,j,m,d),tt(j,2),bs(j));break}}m=m.return}}function T0(d,m,S){var j=d.pingCache;if(j===null){j=d.pingCache=new S6;var q=new Set;j.set(m,q)}else q=j.get(m),q===void 0&&(q=new Set,j.set(m,q));q.has(S)||(g0=!0,q.add(S),d=C6.bind(null,d,m,S),m.then(d,d))}function C6(d,m,S){var j=d.pingCache;j!==null&&j.delete(m),d.pingedLanes|=d.suspendedLanes&S,d.warmLanes&=~S,Rr===d&&(hr&S)===S&&(qr===4||qr===3&&(hr&62914560)===hr&&300>ne()-x0?(Er&2)===0&&gl(d,0):v0|=S,hl===hr&&(hl=0)),bs(d)}function tb(d,m){m===0&&(m=Ue()),d=Jo(d,m),d!==null&&(tt(d,m),bs(d))}function N6(d){var m=d.memoizedState,S=0;m!==null&&(S=m.retryLane),tb(d,S)}function j6(d,m){var S=0;switch(d.tag){case 13:var j=d.stateNode,q=d.memoizedState;q!==null&&(S=q.retryLane);break;case 19:j=d.stateNode;break;case 22:j=d.stateNode._retryCache;break;default:throw Error(a(314))}j!==null&&j.delete(m),tb(d,S)}function O6(d,m){return ae(d,m)}var zd=null,bl=null,A0=!1,$d=!1,C0=!1,ko=0;function bs(d){d!==bl&&d.next===null&&(bl===null?zd=bl=d:bl=bl.next=d),$d=!0,A0||(A0=!0,M6())}function Uc(d,m){if(!C0&&$d){C0=!0;do for(var S=!1,j=zd;j!==null;){if(d!==0){var q=j.pendingLanes;if(q===0)var J=0;else{var oe=j.suspendedLanes,ge=j.pingedLanes;J=(1<<31-et(42|d)+1)-1,J&=q&~(oe&~ge),J=J&201326741?J&201326741|1:J?J|2:0}J!==0&&(S=!0,sb(j,J))}else J=hr,J=_t(j,j===Rr?J:0,j.cancelPendingCommit!==null||j.timeoutHandle!==-1),(J&3)===0||mt(j,J)||(S=!0,sb(j,J));j=j.next}while(S);C0=!1}}function D6(){rb()}function rb(){$d=A0=!1;var d=0;ko!==0&&(z6()&&(d=ko),ko=0);for(var m=ne(),S=null,j=zd;j!==null;){var q=j.next,J=ab(j,m);J===0?(j.next=null,S===null?zd=q:S.next=q,q===null&&(bl=S)):(S=j,(d!==0||(J&3)!==0)&&($d=!0)),j=q}Uc(d)}function ab(d,m){for(var S=d.suspendedLanes,j=d.pingedLanes,q=d.expirationTimes,J=d.pendingLanes&-62914561;0<J;){var oe=31-et(J),ge=1<<oe,Ne=q[oe];Ne===-1?((ge&S)===0||(ge&j)!==0)&&(q[oe]=gt(ge,m)):Ne<=m&&(d.expiredLanes|=ge),J&=~ge}if(m=Rr,S=hr,S=_t(d,d===m?S:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),j=d.callbackNode,S===0||d===m&&(Tr===2||Tr===9)||d.cancelPendingCommit!==null)return j!==null&&j!==null&&Q(j),d.callbackNode=null,d.callbackPriority=0;if((S&3)===0||mt(d,S)){if(m=S&-S,m===d.callbackPriority)return m;switch(j!==null&&Q(j),At(S)){case 2:case 8:S=ke;break;case 32:S=pe;break;case 268435456:S=Me;break;default:S=pe}return j=nb.bind(null,d),S=ae(S,j),d.callbackPriority=m,d.callbackNode=S,m}return j!==null&&j!==null&&Q(j),d.callbackPriority=2,d.callbackNode=null,2}function nb(d,m){if(Ea!==0&&Ea!==5)return d.callbackNode=null,d.callbackPriority=0,null;var S=d.callbackNode;if(Ud()&&d.callbackNode!==S)return null;var j=hr;return j=_t(d,d===Rr?j:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),j===0?null:(Uv(d,j,m),ab(d,ne()),d.callbackNode!=null&&d.callbackNode===S?nb.bind(null,d):null)}function sb(d,m){if(Ud())return null;Uv(d,m,!0)}function M6(){V6(function(){(Er&6)!==0?ae(he,D6):rb()})}function N0(){return ko===0&&(ko=He()),ko}function ib(d){return d==null||typeof d=="symbol"||typeof d=="boolean"?null:typeof d=="function"?d:so(""+d)}function ob(d,m){var S=m.ownerDocument.createElement("input");return S.name=m.name,S.value=m.value,d.id&&S.setAttribute("form",d.id),m.parentNode.insertBefore(S,m),d=new FormData(d),S.parentNode.removeChild(S),d}function R6(d,m,S,j,q){if(m==="submit"&&S&&S.stateNode===q){var J=ib((q[kt]||null).action),oe=j.submitter;oe&&(m=(m=oe[kt]||null)?ib(m.formAction):oe.getAttribute("formAction"),m!==null&&(J=m,oe=null));var ge=new ad("action","action",null,j,q);d.push({event:ge,listeners:[{instance:null,listener:function(){if(j.defaultPrevented){if(ko!==0){var Ne=oe?ob(q,oe):new FormData(q);Xh(S,{pending:!0,data:Ne,method:q.method,action:J},null,Ne)}}else typeof J=="function"&&(ge.preventDefault(),Ne=oe?ob(q,oe):new FormData(q),Xh(S,{pending:!0,data:Ne,method:q.method,action:J},J,Ne))},currentTarget:q}]})}}for(var j0=0;j0<ph.length;j0++){var O0=ph[j0],I6=O0.toLowerCase(),F6=O0[0].toUpperCase()+O0.slice(1);Kn(I6,"on"+F6)}Kn(U1,"onAnimationEnd"),Kn(z1,"onAnimationIteration"),Kn($1,"onAnimationStart"),Kn("dblclick","onDoubleClick"),Kn("focusin","onFocus"),Kn("focusout","onBlur"),Kn(Q3,"onTransitionRun"),Kn(e6,"onTransitionStart"),Kn(t6,"onTransitionCancel"),Kn(V1,"onTransitionEnd"),Ee("onMouseEnter",["mouseout","mouseover"]),Ee("onMouseLeave",["mouseout","mouseover"]),Ee("onPointerEnter",["pointerout","pointerover"]),Ee("onPointerLeave",["pointerout","pointerover"]),xe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),xe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),xe("onBeforeInput",["compositionend","keypress","textInput","paste"]),xe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),xe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),xe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),P6=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(zc));function lb(d,m){m=(m&4)!==0;for(var S=0;S<d.length;S++){var j=d[S],q=j.event;j=j.listeners;e:{var J=void 0;if(m)for(var oe=j.length-1;0<=oe;oe--){var ge=j[oe],Ne=ge.instance,Ge=ge.currentTarget;if(ge=ge.listener,Ne!==J&&q.isPropagationStopped())break e;J=ge,q.currentTarget=Ge;try{J(q)}catch(lt){Nd(lt)}q.currentTarget=null,J=Ne}else for(oe=0;oe<j.length;oe++){if(ge=j[oe],Ne=ge.instance,Ge=ge.currentTarget,ge=ge.listener,Ne!==J&&q.isPropagationStopped())break e;J=ge,q.currentTarget=Ge;try{J(q)}catch(lt){Nd(lt)}q.currentTarget=null,J=Ne}}}}function cr(d,m){var S=m[Fe];S===void 0&&(S=m[Fe]=new Set);var j=d+"__bubble";S.has(j)||(cb(m,d,2,!1),S.add(j))}function D0(d,m,S){var j=0;m&&(j|=4),cb(S,d,j,m)}var Vd="_reactListening"+Math.random().toString(36).slice(2);function M0(d){if(!d[Vd]){d[Vd]=!0,Pe.forEach(function(S){S!=="selectionchange"&&(P6.has(S)||D0(S,!1,d),D0(S,!0,d))});var m=d.nodeType===9?d:d.ownerDocument;m===null||m[Vd]||(m[Vd]=!0,D0("selectionchange",!1,m))}}function cb(d,m,S,j){switch(Mb(m)){case 2:var q=u5;break;case 8:q=d5;break;default:q=G0}S=q.bind(null,m,S,d),q=void 0,!th||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(q=!0),j?q!==void 0?d.addEventListener(m,S,{capture:!0,passive:q}):d.addEventListener(m,S,!0):q!==void 0?d.addEventListener(m,S,{passive:q}):d.addEventListener(m,S,!1)}function R0(d,m,S,j,q){var J=j;if((m&1)===0&&(m&2)===0&&j!==null)e:for(;;){if(j===null)return;var oe=j.tag;if(oe===3||oe===4){var ge=j.stateNode.containerInfo;if(ge===q)break;if(oe===4)for(oe=j.return;oe!==null;){var Ne=oe.tag;if((Ne===3||Ne===4)&&oe.stateNode.containerInfo===q)return;oe=oe.return}for(;ge!==null;){if(oe=be(ge),oe===null)return;if(Ne=oe.tag,Ne===5||Ne===6||Ne===26||Ne===27){j=J=oe;continue e}ge=ge.parentNode}}j=j.return}oo(function(){var Ge=J,lt=io(S),pt=[];e:{var Ke=H1.get(d);if(Ke!==void 0){var Ze=ad,Zt=d;switch(d){case"keypress":if(td(S)===0)break e;case"keydown":case"keyup":Ze=O3;break;case"focusin":Zt="focus",Ze=sh;break;case"focusout":Zt="blur",Ze=sh;break;case"beforeblur":case"afterblur":Ze=sh;break;case"click":if(S.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ze=x1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ze=x3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ze=R3;break;case U1:case z1:case $1:Ze=_3;break;case V1:Ze=F3;break;case"scroll":case"scrollend":Ze=v3;break;case"wheel":Ze=L3;break;case"copy":case"cut":case"paste":Ze=k3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ze=w1;break;case"toggle":case"beforetoggle":Ze=U3}var qt=(m&4)!==0,Or=!qt&&(d==="scroll"||d==="scrollend"),ze=qt?Ke!==null?Ke+"Capture":null:Ke;qt=[];for(var Re=Ge,We;Re!==null;){var ft=Re;if(We=ft.stateNode,ft=ft.tag,ft!==5&&ft!==26&&ft!==27||We===null||ze===null||(ft=ic(Re,ze),ft!=null&&qt.push($c(Re,ft,We))),Or)break;Re=Re.return}0<qt.length&&(Ke=new Ze(Ke,Zt,null,S,lt),pt.push({event:Ke,listeners:qt}))}}if((m&7)===0){e:{if(Ke=d==="mouseover"||d==="pointerover",Ze=d==="mouseout"||d==="pointerout",Ke&&S!==pi&&(Zt=S.relatedTarget||S.fromElement)&&(be(Zt)||Zt[Ae]))break e;if((Ze||Ke)&&(Ke=lt.window===lt?lt:(Ke=lt.ownerDocument)?Ke.defaultView||Ke.parentWindow:window,Ze?(Zt=S.relatedTarget||S.toElement,Ze=Ge,Zt=Zt?be(Zt):null,Zt!==null&&(Or=o(Zt),qt=Zt.tag,Zt!==Or||qt!==5&&qt!==27&&qt!==6)&&(Zt=null)):(Ze=null,Zt=Ge),Ze!==Zt)){if(qt=x1,ft="onMouseLeave",ze="onMouseEnter",Re="mouse",(d==="pointerout"||d==="pointerover")&&(qt=w1,ft="onPointerLeave",ze="onPointerEnter",Re="pointer"),Or=Ze==null?Ke:De(Ze),We=Zt==null?Ke:De(Zt),Ke=new qt(ft,Re+"leave",Ze,S,lt),Ke.target=Or,Ke.relatedTarget=We,ft=null,be(lt)===Ge&&(qt=new qt(ze,Re+"enter",Zt,S,lt),qt.target=We,qt.relatedTarget=Or,ft=qt),Or=ft,Ze&&Zt)t:{for(qt=Ze,ze=Zt,Re=0,We=qt;We;We=xl(We))Re++;for(We=0,ft=ze;ft;ft=xl(ft))We++;for(;0<Re-We;)qt=xl(qt),Re--;for(;0<We-Re;)ze=xl(ze),We--;for(;Re--;){if(qt===ze||ze!==null&&qt===ze.alternate)break t;qt=xl(qt),ze=xl(ze)}qt=null}else qt=null;Ze!==null&&ub(pt,Ke,Ze,qt,!1),Zt!==null&&Or!==null&&ub(pt,Or,Zt,qt,!0)}}e:{if(Ke=Ge?De(Ge):window,Ze=Ke.nodeName&&Ke.nodeName.toLowerCase(),Ze==="select"||Ze==="input"&&Ke.type==="file")var It=N1;else if(A1(Ke))if(j1)It=K3;else{It=Y3;var or=G3}else Ze=Ke.nodeName,!Ze||Ze.toLowerCase()!=="input"||Ke.type!=="checkbox"&&Ke.type!=="radio"?Ge&&fi(Ge.elementType)&&(It=N1):It=X3;if(It&&(It=It(d,Ge))){C1(pt,It,S,lt);break e}or&&or(d,Ke,Ge),d==="focusout"&&Ge&&Ke.type==="number"&&Ge.memoizedProps.value!=null&&ir(Ke,"number",Ke.value)}switch(or=Ge?De(Ge):window,d){case"focusin":(A1(or)||or.contentEditable==="true")&&(Xo=or,dh=Ge,pc=null);break;case"focusout":pc=dh=Xo=null;break;case"mousedown":fh=!0;break;case"contextmenu":case"mouseup":case"dragend":fh=!1,L1(pt,S,lt);break;case"selectionchange":if(J3)break;case"keydown":case"keyup":L1(pt,S,lt)}var zt;if(oh)e:{switch(d){case"compositionstart":var Wt="onCompositionStart";break e;case"compositionend":Wt="onCompositionEnd";break e;case"compositionupdate":Wt="onCompositionUpdate";break e}Wt=void 0}else Yo?E1(d,S)&&(Wt="onCompositionEnd"):d==="keydown"&&S.keyCode===229&&(Wt="onCompositionStart");Wt&&(_1&&S.locale!=="ko"&&(Yo||Wt!=="onCompositionStart"?Wt==="onCompositionEnd"&&Yo&&(zt=v1()):(gi=lt,rh="value"in gi?gi.value:gi.textContent,Yo=!0)),or=Hd(Ge,Wt),0<or.length&&(Wt=new y1(Wt,d,null,S,lt),pt.push({event:Wt,listeners:or}),zt?Wt.data=zt:(zt=T1(S),zt!==null&&(Wt.data=zt)))),(zt=$3?V3(d,S):H3(d,S))&&(Wt=Hd(Ge,"onBeforeInput"),0<Wt.length&&(or=new y1("onBeforeInput","beforeinput",null,S,lt),pt.push({event:or,listeners:Wt}),or.data=zt)),R6(pt,d,Ge,S,lt)}lb(pt,m)})}function $c(d,m,S){return{instance:d,listener:m,currentTarget:S}}function Hd(d,m){for(var S=m+"Capture",j=[];d!==null;){var q=d,J=q.stateNode;if(q=q.tag,q!==5&&q!==26&&q!==27||J===null||(q=ic(d,S),q!=null&&j.unshift($c(d,q,J)),q=ic(d,m),q!=null&&j.push($c(d,q,J))),d.tag===3)return j;d=d.return}return[]}function xl(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5&&d.tag!==27);return d||null}function ub(d,m,S,j,q){for(var J=m._reactName,oe=[];S!==null&&S!==j;){var ge=S,Ne=ge.alternate,Ge=ge.stateNode;if(ge=ge.tag,Ne!==null&&Ne===j)break;ge!==5&&ge!==26&&ge!==27||Ge===null||(Ne=Ge,q?(Ge=ic(S,J),Ge!=null&&oe.unshift($c(S,Ge,Ne))):q||(Ge=ic(S,J),Ge!=null&&oe.push($c(S,Ge,Ne)))),S=S.return}oe.length!==0&&d.push({event:m,listeners:oe})}var L6=/\r\n?/g,B6=/\u0000|\uFFFD/g;function db(d){return(typeof d=="string"?d:""+d).replace(L6,`
`).replace(B6,"")}function fb(d,m){return m=db(m),db(d)===m}function qd(){}function jr(d,m,S,j,q,J){switch(S){case"children":typeof j=="string"?m==="body"||m==="textarea"&&j===""||ra(d,j):(typeof j=="number"||typeof j=="bigint")&&m!=="body"&&ra(d,""+j);break;case"className":Ve(d,"class",j);break;case"tabIndex":Ve(d,"tabindex",j);break;case"dir":case"role":case"viewBox":case"width":case"height":Ve(d,S,j);break;case"style":di(d,j,J);break;case"data":if(m!=="object"){Ve(d,"data",j);break}case"src":case"href":if(j===""&&(m!=="a"||S!=="href")){d.removeAttribute(S);break}if(j==null||typeof j=="function"||typeof j=="symbol"||typeof j=="boolean"){d.removeAttribute(S);break}j=so(""+j),d.setAttribute(S,j);break;case"action":case"formAction":if(typeof j=="function"){d.setAttribute(S,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof J=="function"&&(S==="formAction"?(m!=="input"&&jr(d,m,"name",q.name,q,null),jr(d,m,"formEncType",q.formEncType,q,null),jr(d,m,"formMethod",q.formMethod,q,null),jr(d,m,"formTarget",q.formTarget,q,null)):(jr(d,m,"encType",q.encType,q,null),jr(d,m,"method",q.method,q,null),jr(d,m,"target",q.target,q,null)));if(j==null||typeof j=="symbol"||typeof j=="boolean"){d.removeAttribute(S);break}j=so(""+j),d.setAttribute(S,j);break;case"onClick":j!=null&&(d.onclick=qd);break;case"onScroll":j!=null&&cr("scroll",d);break;case"onScrollEnd":j!=null&&cr("scrollend",d);break;case"dangerouslySetInnerHTML":if(j!=null){if(typeof j!="object"||!("__html"in j))throw Error(a(61));if(S=j.__html,S!=null){if(q.children!=null)throw Error(a(60));d.innerHTML=S}}break;case"multiple":d.multiple=j&&typeof j!="function"&&typeof j!="symbol";break;case"muted":d.muted=j&&typeof j!="function"&&typeof j!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(j==null||typeof j=="function"||typeof j=="boolean"||typeof j=="symbol"){d.removeAttribute("xlink:href");break}S=so(""+j),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",S);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":j!=null&&typeof j!="function"&&typeof j!="symbol"?d.setAttribute(S,""+j):d.removeAttribute(S);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":j&&typeof j!="function"&&typeof j!="symbol"?d.setAttribute(S,""):d.removeAttribute(S);break;case"capture":case"download":j===!0?d.setAttribute(S,""):j!==!1&&j!=null&&typeof j!="function"&&typeof j!="symbol"?d.setAttribute(S,j):d.removeAttribute(S);break;case"cols":case"rows":case"size":case"span":j!=null&&typeof j!="function"&&typeof j!="symbol"&&!isNaN(j)&&1<=j?d.setAttribute(S,j):d.removeAttribute(S);break;case"rowSpan":case"start":j==null||typeof j=="function"||typeof j=="symbol"||isNaN(j)?d.removeAttribute(S):d.setAttribute(S,j);break;case"popover":cr("beforetoggle",d),cr("toggle",d),ye(d,"popover",j);break;case"xlinkActuate":$e(d,"http://www.w3.org/1999/xlink","xlink:actuate",j);break;case"xlinkArcrole":$e(d,"http://www.w3.org/1999/xlink","xlink:arcrole",j);break;case"xlinkRole":$e(d,"http://www.w3.org/1999/xlink","xlink:role",j);break;case"xlinkShow":$e(d,"http://www.w3.org/1999/xlink","xlink:show",j);break;case"xlinkTitle":$e(d,"http://www.w3.org/1999/xlink","xlink:title",j);break;case"xlinkType":$e(d,"http://www.w3.org/1999/xlink","xlink:type",j);break;case"xmlBase":$e(d,"http://www.w3.org/XML/1998/namespace","xml:base",j);break;case"xmlLang":$e(d,"http://www.w3.org/XML/1998/namespace","xml:lang",j);break;case"xmlSpace":$e(d,"http://www.w3.org/XML/1998/namespace","xml:space",j);break;case"is":ye(d,"is",j);break;case"innerText":case"textContent":break;default:(!(2<S.length)||S[0]!=="o"&&S[0]!=="O"||S[1]!=="n"&&S[1]!=="N")&&(S=hi.get(S)||S,ye(d,S,j))}}function I0(d,m,S,j,q,J){switch(S){case"style":di(d,j,J);break;case"dangerouslySetInnerHTML":if(j!=null){if(typeof j!="object"||!("__html"in j))throw Error(a(61));if(S=j.__html,S!=null){if(q.children!=null)throw Error(a(60));d.innerHTML=S}}break;case"children":typeof j=="string"?ra(d,j):(typeof j=="number"||typeof j=="bigint")&&ra(d,""+j);break;case"onScroll":j!=null&&cr("scroll",d);break;case"onScrollEnd":j!=null&&cr("scrollend",d);break;case"onClick":j!=null&&(d.onclick=qd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Be.hasOwnProperty(S))e:{if(S[0]==="o"&&S[1]==="n"&&(q=S.endsWith("Capture"),m=S.slice(2,q?S.length-7:void 0),J=d[kt]||null,J=J!=null?J[S]:null,typeof J=="function"&&d.removeEventListener(m,J,q),typeof j=="function")){typeof J!="function"&&J!==null&&(S in d?d[S]=null:d.hasAttribute(S)&&d.removeAttribute(S)),d.addEventListener(m,j,q);break e}S in d?d[S]=j:j===!0?d.setAttribute(S,""):ye(d,S,j)}}}function Ta(d,m,S){switch(m){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":cr("error",d),cr("load",d);var j=!1,q=!1,J;for(J in S)if(S.hasOwnProperty(J)){var oe=S[J];if(oe!=null)switch(J){case"src":j=!0;break;case"srcSet":q=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,m));default:jr(d,m,J,oe,S,null)}}q&&jr(d,m,"srcSet",S.srcSet,S,null),j&&jr(d,m,"src",S.src,S,null);return;case"input":cr("invalid",d);var ge=J=oe=q=null,Ne=null,Ge=null;for(j in S)if(S.hasOwnProperty(j)){var lt=S[j];if(lt!=null)switch(j){case"name":q=lt;break;case"type":oe=lt;break;case"checked":Ne=lt;break;case"defaultChecked":Ge=lt;break;case"value":J=lt;break;case"defaultValue":ge=lt;break;case"children":case"dangerouslySetInnerHTML":if(lt!=null)throw Error(a(137,m));break;default:jr(d,m,j,lt,S,null)}}vr(d,J,ge,Ne,Ge,oe,q,!1),ta(d);return;case"select":cr("invalid",d),j=oe=J=null;for(q in S)if(S.hasOwnProperty(q)&&(ge=S[q],ge!=null))switch(q){case"value":J=ge;break;case"defaultValue":oe=ge;break;case"multiple":j=ge;default:jr(d,m,q,ge,S,null)}m=J,S=oe,d.multiple=!!j,m!=null?Wa(d,!!j,m,!1):S!=null&&Wa(d,!!j,S,!0);return;case"textarea":cr("invalid",d),J=q=j=null;for(oe in S)if(S.hasOwnProperty(oe)&&(ge=S[oe],ge!=null))switch(oe){case"value":j=ge;break;case"defaultValue":q=ge;break;case"children":J=ge;break;case"dangerouslySetInnerHTML":if(ge!=null)throw Error(a(91));break;default:jr(d,m,oe,ge,S,null)}no(d,j,q,J),ta(d);return;case"option":for(Ne in S)if(S.hasOwnProperty(Ne)&&(j=S[Ne],j!=null))switch(Ne){case"selected":d.selected=j&&typeof j!="function"&&typeof j!="symbol";break;default:jr(d,m,Ne,j,S,null)}return;case"dialog":cr("beforetoggle",d),cr("toggle",d),cr("cancel",d),cr("close",d);break;case"iframe":case"object":cr("load",d);break;case"video":case"audio":for(j=0;j<zc.length;j++)cr(zc[j],d);break;case"image":cr("error",d),cr("load",d);break;case"details":cr("toggle",d);break;case"embed":case"source":case"link":cr("error",d),cr("load",d);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ge in S)if(S.hasOwnProperty(Ge)&&(j=S[Ge],j!=null))switch(Ge){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,m));default:jr(d,m,Ge,j,S,null)}return;default:if(fi(m)){for(lt in S)S.hasOwnProperty(lt)&&(j=S[lt],j!==void 0&&I0(d,m,lt,j,S,void 0));return}}for(ge in S)S.hasOwnProperty(ge)&&(j=S[ge],j!=null&&jr(d,m,ge,j,S,null))}function U6(d,m,S,j){switch(m){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var q=null,J=null,oe=null,ge=null,Ne=null,Ge=null,lt=null;for(Ze in S){var pt=S[Ze];if(S.hasOwnProperty(Ze)&&pt!=null)switch(Ze){case"checked":break;case"value":break;case"defaultValue":Ne=pt;default:j.hasOwnProperty(Ze)||jr(d,m,Ze,null,j,pt)}}for(var Ke in j){var Ze=j[Ke];if(pt=S[Ke],j.hasOwnProperty(Ke)&&(Ze!=null||pt!=null))switch(Ke){case"type":J=Ze;break;case"name":q=Ze;break;case"checked":Ge=Ze;break;case"defaultChecked":lt=Ze;break;case"value":oe=Ze;break;case"defaultValue":ge=Ze;break;case"children":case"dangerouslySetInnerHTML":if(Ze!=null)throw Error(a(137,m));break;default:Ze!==pt&&jr(d,m,Ke,Ze,j,pt)}}ds(d,oe,ge,Ne,Ge,lt,J,q);return;case"select":Ze=oe=ge=Ke=null;for(J in S)if(Ne=S[J],S.hasOwnProperty(J)&&Ne!=null)switch(J){case"value":break;case"multiple":Ze=Ne;default:j.hasOwnProperty(J)||jr(d,m,J,null,j,Ne)}for(q in j)if(J=j[q],Ne=S[q],j.hasOwnProperty(q)&&(J!=null||Ne!=null))switch(q){case"value":Ke=J;break;case"defaultValue":ge=J;break;case"multiple":oe=J;default:J!==Ne&&jr(d,m,q,J,j,Ne)}m=ge,S=oe,j=Ze,Ke!=null?Wa(d,!!S,Ke,!1):!!j!=!!S&&(m!=null?Wa(d,!!S,m,!0):Wa(d,!!S,S?[]:"",!1));return;case"textarea":Ze=Ke=null;for(ge in S)if(q=S[ge],S.hasOwnProperty(ge)&&q!=null&&!j.hasOwnProperty(ge))switch(ge){case"value":break;case"children":break;default:jr(d,m,ge,null,j,q)}for(oe in j)if(q=j[oe],J=S[oe],j.hasOwnProperty(oe)&&(q!=null||J!=null))switch(oe){case"value":Ke=q;break;case"defaultValue":Ze=q;break;case"children":break;case"dangerouslySetInnerHTML":if(q!=null)throw Error(a(91));break;default:q!==J&&jr(d,m,oe,q,j,J)}fs(d,Ke,Ze);return;case"option":for(var Zt in S)if(Ke=S[Zt],S.hasOwnProperty(Zt)&&Ke!=null&&!j.hasOwnProperty(Zt))switch(Zt){case"selected":d.selected=!1;break;default:jr(d,m,Zt,null,j,Ke)}for(Ne in j)if(Ke=j[Ne],Ze=S[Ne],j.hasOwnProperty(Ne)&&Ke!==Ze&&(Ke!=null||Ze!=null))switch(Ne){case"selected":d.selected=Ke&&typeof Ke!="function"&&typeof Ke!="symbol";break;default:jr(d,m,Ne,Ke,j,Ze)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var qt in S)Ke=S[qt],S.hasOwnProperty(qt)&&Ke!=null&&!j.hasOwnProperty(qt)&&jr(d,m,qt,null,j,Ke);for(Ge in j)if(Ke=j[Ge],Ze=S[Ge],j.hasOwnProperty(Ge)&&Ke!==Ze&&(Ke!=null||Ze!=null))switch(Ge){case"children":case"dangerouslySetInnerHTML":if(Ke!=null)throw Error(a(137,m));break;default:jr(d,m,Ge,Ke,j,Ze)}return;default:if(fi(m)){for(var Or in S)Ke=S[Or],S.hasOwnProperty(Or)&&Ke!==void 0&&!j.hasOwnProperty(Or)&&I0(d,m,Or,void 0,j,Ke);for(lt in j)Ke=j[lt],Ze=S[lt],!j.hasOwnProperty(lt)||Ke===Ze||Ke===void 0&&Ze===void 0||I0(d,m,lt,Ke,j,Ze);return}}for(var ze in S)Ke=S[ze],S.hasOwnProperty(ze)&&Ke!=null&&!j.hasOwnProperty(ze)&&jr(d,m,ze,null,j,Ke);for(pt in j)Ke=j[pt],Ze=S[pt],!j.hasOwnProperty(pt)||Ke===Ze||Ke==null&&Ze==null||jr(d,m,pt,Ke,j,Ze)}var F0=null,P0=null;function Wd(d){return d.nodeType===9?d:d.ownerDocument}function hb(d){switch(d){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function pb(d,m){if(d===0)switch(m){case"svg":return 1;case"math":return 2;default:return 0}return d===1&&m==="foreignObject"?0:d}function L0(d,m){return d==="textarea"||d==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.children=="bigint"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var B0=null;function z6(){var d=window.event;return d&&d.type==="popstate"?d===B0?!1:(B0=d,!0):(B0=null,!1)}var mb=typeof setTimeout=="function"?setTimeout:void 0,$6=typeof clearTimeout=="function"?clearTimeout:void 0,gb=typeof Promise=="function"?Promise:void 0,V6=typeof queueMicrotask=="function"?queueMicrotask:typeof gb<"u"?function(d){return gb.resolve(null).then(d).catch(H6)}:mb;function H6(d){setTimeout(function(){throw d})}function Di(d){return d==="head"}function vb(d,m){var S=m,j=0,q=0;do{var J=S.nextSibling;if(d.removeChild(S),J&&J.nodeType===8)if(S=J.data,S==="/$"){if(0<j&&8>j){S=j;var oe=d.ownerDocument;if(S&1&&Vc(oe.documentElement),S&2&&Vc(oe.body),S&4)for(S=oe.head,Vc(S),oe=S.firstChild;oe;){var ge=oe.nextSibling,Ne=oe.nodeName;oe[de]||Ne==="SCRIPT"||Ne==="STYLE"||Ne==="LINK"&&oe.rel.toLowerCase()==="stylesheet"||S.removeChild(oe),oe=ge}}if(q===0){d.removeChild(J),Zc(m);return}q--}else S==="$"||S==="$?"||S==="$!"?q++:j=S.charCodeAt(0)-48;else j=0;S=J}while(S);Zc(m)}function U0(d){var m=d.firstChild;for(m&&m.nodeType===10&&(m=m.nextSibling);m;){var S=m;switch(m=m.nextSibling,S.nodeName){case"HTML":case"HEAD":case"BODY":U0(S),ve(S);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(S.rel.toLowerCase()==="stylesheet")continue}d.removeChild(S)}}function q6(d,m,S,j){for(;d.nodeType===1;){var q=S;if(d.nodeName.toLowerCase()!==m.toLowerCase()){if(!j&&(d.nodeName!=="INPUT"||d.type!=="hidden"))break}else if(j){if(!d[de])switch(m){case"meta":if(!d.hasAttribute("itemprop"))break;return d;case"link":if(J=d.getAttribute("rel"),J==="stylesheet"&&d.hasAttribute("data-precedence"))break;if(J!==q.rel||d.getAttribute("href")!==(q.href==null||q.href===""?null:q.href)||d.getAttribute("crossorigin")!==(q.crossOrigin==null?null:q.crossOrigin)||d.getAttribute("title")!==(q.title==null?null:q.title))break;return d;case"style":if(d.hasAttribute("data-precedence"))break;return d;case"script":if(J=d.getAttribute("src"),(J!==(q.src==null?null:q.src)||d.getAttribute("type")!==(q.type==null?null:q.type)||d.getAttribute("crossorigin")!==(q.crossOrigin==null?null:q.crossOrigin))&&J&&d.hasAttribute("async")&&!d.hasAttribute("itemprop"))break;return d;default:return d}}else if(m==="input"&&d.type==="hidden"){var J=q.name==null?null:""+q.name;if(q.type==="hidden"&&d.getAttribute("name")===J)return d}else return d;if(d=Jn(d.nextSibling),d===null)break}return null}function W6(d,m,S){if(m==="")return null;for(;d.nodeType!==3;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!S||(d=Jn(d.nextSibling),d===null))return null;return d}function z0(d){return d.data==="$!"||d.data==="$?"&&d.ownerDocument.readyState==="complete"}function G6(d,m){var S=d.ownerDocument;if(d.data!=="$?"||S.readyState==="complete")m();else{var j=function(){m(),S.removeEventListener("DOMContentLoaded",j)};S.addEventListener("DOMContentLoaded",j),d._reactRetry=j}}function Jn(d){for(;d!=null;d=d.nextSibling){var m=d.nodeType;if(m===1||m===3)break;if(m===8){if(m=d.data,m==="$"||m==="$!"||m==="$?"||m==="F!"||m==="F")break;if(m==="/$")return null}}return d}var $0=null;function bb(d){d=d.previousSibling;for(var m=0;d;){if(d.nodeType===8){var S=d.data;if(S==="$"||S==="$!"||S==="$?"){if(m===0)return d;m--}else S==="/$"&&m++}d=d.previousSibling}return null}function xb(d,m,S){switch(m=Wd(S),d){case"html":if(d=m.documentElement,!d)throw Error(a(452));return d;case"head":if(d=m.head,!d)throw Error(a(453));return d;case"body":if(d=m.body,!d)throw Error(a(454));return d;default:throw Error(a(451))}}function Vc(d){for(var m=d.attributes;m.length;)d.removeAttributeNode(m[0]);ve(d)}var Rn=new Map,yb=new Set;function Gd(d){return typeof d.getRootNode=="function"?d.getRootNode():d.nodeType===9?d:d.ownerDocument}var Ks=k.d;k.d={f:Y6,r:X6,D:K6,C:Z6,L:J6,m:Q6,X:t5,S:e5,M:r5};function Y6(){var d=Ks.f(),m=Ld();return d||m}function X6(d){var m=we(d);m!==null&&m.tag===5&&m.type==="form"?Ug(m):Ks.r(d)}var yl=typeof document>"u"?null:document;function wb(d,m,S){var j=yl;if(j&&typeof m=="string"&&m){var q=fa(m);q='link[rel="'+d+'"][href="'+q+'"]',typeof S=="string"&&(q+='[crossorigin="'+S+'"]'),yb.has(q)||(yb.add(q),d={rel:d,crossOrigin:S,href:m},j.querySelector(q)===null&&(m=j.createElement("link"),Ta(m,"link",d),Oe(m),j.head.appendChild(m)))}}function K6(d){Ks.D(d),wb("dns-prefetch",d,null)}function Z6(d,m){Ks.C(d,m),wb("preconnect",d,m)}function J6(d,m,S){Ks.L(d,m,S);var j=yl;if(j&&d&&m){var q='link[rel="preload"][as="'+fa(m)+'"]';m==="image"&&S&&S.imageSrcSet?(q+='[imagesrcset="'+fa(S.imageSrcSet)+'"]',typeof S.imageSizes=="string"&&(q+='[imagesizes="'+fa(S.imageSizes)+'"]')):q+='[href="'+fa(d)+'"]';var J=q;switch(m){case"style":J=wl(d);break;case"script":J=_l(d)}Rn.has(J)||(d=u({rel:"preload",href:m==="image"&&S&&S.imageSrcSet?void 0:d,as:m},S),Rn.set(J,d),j.querySelector(q)!==null||m==="style"&&j.querySelector(Hc(J))||m==="script"&&j.querySelector(qc(J))||(m=j.createElement("link"),Ta(m,"link",d),Oe(m),j.head.appendChild(m)))}}function Q6(d,m){Ks.m(d,m);var S=yl;if(S&&d){var j=m&&typeof m.as=="string"?m.as:"script",q='link[rel="modulepreload"][as="'+fa(j)+'"][href="'+fa(d)+'"]',J=q;switch(j){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":J=_l(d)}if(!Rn.has(J)&&(d=u({rel:"modulepreload",href:d},m),Rn.set(J,d),S.querySelector(q)===null)){switch(j){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(S.querySelector(qc(J)))return}j=S.createElement("link"),Ta(j,"link",d),Oe(j),S.head.appendChild(j)}}}function e5(d,m,S){Ks.S(d,m,S);var j=yl;if(j&&d){var q=Le(j).hoistableStyles,J=wl(d);m=m||"default";var oe=q.get(J);if(!oe){var ge={loading:0,preload:null};if(oe=j.querySelector(Hc(J)))ge.loading=5;else{d=u({rel:"stylesheet",href:d,"data-precedence":m},S),(S=Rn.get(J))&&V0(d,S);var Ne=oe=j.createElement("link");Oe(Ne),Ta(Ne,"link",d),Ne._p=new Promise(function(Ge,lt){Ne.onload=Ge,Ne.onerror=lt}),Ne.addEventListener("load",function(){ge.loading|=1}),Ne.addEventListener("error",function(){ge.loading|=2}),ge.loading|=4,Yd(oe,m,j)}oe={type:"stylesheet",instance:oe,count:1,state:ge},q.set(J,oe)}}}function t5(d,m){Ks.X(d,m);var S=yl;if(S&&d){var j=Le(S).hoistableScripts,q=_l(d),J=j.get(q);J||(J=S.querySelector(qc(q)),J||(d=u({src:d,async:!0},m),(m=Rn.get(q))&&H0(d,m),J=S.createElement("script"),Oe(J),Ta(J,"link",d),S.head.appendChild(J)),J={type:"script",instance:J,count:1,state:null},j.set(q,J))}}function r5(d,m){Ks.M(d,m);var S=yl;if(S&&d){var j=Le(S).hoistableScripts,q=_l(d),J=j.get(q);J||(J=S.querySelector(qc(q)),J||(d=u({src:d,async:!0,type:"module"},m),(m=Rn.get(q))&&H0(d,m),J=S.createElement("script"),Oe(J),Ta(J,"link",d),S.head.appendChild(J)),J={type:"script",instance:J,count:1,state:null},j.set(q,J))}}function _b(d,m,S,j){var q=(q=z.current)?Gd(q):null;if(!q)throw Error(a(446));switch(d){case"meta":case"title":return null;case"style":return typeof S.precedence=="string"&&typeof S.href=="string"?(m=wl(S.href),S=Le(q).hoistableStyles,j=S.get(m),j||(j={type:"style",instance:null,count:0,state:null},S.set(m,j)),j):{type:"void",instance:null,count:0,state:null};case"link":if(S.rel==="stylesheet"&&typeof S.href=="string"&&typeof S.precedence=="string"){d=wl(S.href);var J=Le(q).hoistableStyles,oe=J.get(d);if(oe||(q=q.ownerDocument||q,oe={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},J.set(d,oe),(J=q.querySelector(Hc(d)))&&!J._p&&(oe.instance=J,oe.state.loading=5),Rn.has(d)||(S={rel:"preload",as:"style",href:S.href,crossOrigin:S.crossOrigin,integrity:S.integrity,media:S.media,hrefLang:S.hrefLang,referrerPolicy:S.referrerPolicy},Rn.set(d,S),J||a5(q,d,S,oe.state))),m&&j===null)throw Error(a(528,""));return oe}if(m&&j!==null)throw Error(a(529,""));return null;case"script":return m=S.async,S=S.src,typeof S=="string"&&m&&typeof m!="function"&&typeof m!="symbol"?(m=_l(S),S=Le(q).hoistableScripts,j=S.get(m),j||(j={type:"script",instance:null,count:0,state:null},S.set(m,j)),j):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,d))}}function wl(d){return'href="'+fa(d)+'"'}function Hc(d){return'link[rel="stylesheet"]['+d+"]"}function Sb(d){return u({},d,{"data-precedence":d.precedence,precedence:null})}function a5(d,m,S,j){d.querySelector('link[rel="preload"][as="style"]['+m+"]")?j.loading=1:(m=d.createElement("link"),j.preload=m,m.addEventListener("load",function(){return j.loading|=1}),m.addEventListener("error",function(){return j.loading|=2}),Ta(m,"link",S),Oe(m),d.head.appendChild(m))}function _l(d){return'[src="'+fa(d)+'"]'}function qc(d){return"script[async]"+d}function kb(d,m,S){if(m.count++,m.instance===null)switch(m.type){case"style":var j=d.querySelector('style[data-href~="'+fa(S.href)+'"]');if(j)return m.instance=j,Oe(j),j;var q=u({},S,{"data-href":S.href,"data-precedence":S.precedence,href:null,precedence:null});return j=(d.ownerDocument||d).createElement("style"),Oe(j),Ta(j,"style",q),Yd(j,S.precedence,d),m.instance=j;case"stylesheet":q=wl(S.href);var J=d.querySelector(Hc(q));if(J)return m.state.loading|=4,m.instance=J,Oe(J),J;j=Sb(S),(q=Rn.get(q))&&V0(j,q),J=(d.ownerDocument||d).createElement("link"),Oe(J);var oe=J;return oe._p=new Promise(function(ge,Ne){oe.onload=ge,oe.onerror=Ne}),Ta(J,"link",j),m.state.loading|=4,Yd(J,S.precedence,d),m.instance=J;case"script":return J=_l(S.src),(q=d.querySelector(qc(J)))?(m.instance=q,Oe(q),q):(j=S,(q=Rn.get(J))&&(j=u({},S),H0(j,q)),d=d.ownerDocument||d,q=d.createElement("script"),Oe(q),Ta(q,"link",j),d.head.appendChild(q),m.instance=q);case"void":return null;default:throw Error(a(443,m.type))}else m.type==="stylesheet"&&(m.state.loading&4)===0&&(j=m.instance,m.state.loading|=4,Yd(j,S.precedence,d));return m.instance}function Yd(d,m,S){for(var j=S.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),q=j.length?j[j.length-1]:null,J=q,oe=0;oe<j.length;oe++){var ge=j[oe];if(ge.dataset.precedence===m)J=ge;else if(J!==q)break}J?J.parentNode.insertBefore(d,J.nextSibling):(m=S.nodeType===9?S.head:S,m.insertBefore(d,m.firstChild))}function V0(d,m){d.crossOrigin==null&&(d.crossOrigin=m.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=m.referrerPolicy),d.title==null&&(d.title=m.title)}function H0(d,m){d.crossOrigin==null&&(d.crossOrigin=m.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=m.referrerPolicy),d.integrity==null&&(d.integrity=m.integrity)}var Xd=null;function Eb(d,m,S){if(Xd===null){var j=new Map,q=Xd=new Map;q.set(S,j)}else q=Xd,j=q.get(S),j||(j=new Map,q.set(S,j));if(j.has(d))return j;for(j.set(d,null),S=S.getElementsByTagName(d),q=0;q<S.length;q++){var J=S[q];if(!(J[de]||J[Ft]||d==="link"&&J.getAttribute("rel")==="stylesheet")&&J.namespaceURI!=="http://www.w3.org/2000/svg"){var oe=J.getAttribute(m)||"";oe=d+oe;var ge=j.get(oe);ge?ge.push(J):j.set(oe,[J])}}return j}function Tb(d,m,S){d=d.ownerDocument||d,d.head.insertBefore(S,m==="title"?d.querySelector("head > title"):null)}function n5(d,m,S){if(S===1||m.itemProp!=null)return!1;switch(d){case"meta":case"title":return!0;case"style":if(typeof m.precedence!="string"||typeof m.href!="string"||m.href==="")break;return!0;case"link":if(typeof m.rel!="string"||typeof m.href!="string"||m.href===""||m.onLoad||m.onError)break;switch(m.rel){case"stylesheet":return d=m.disabled,typeof m.precedence=="string"&&d==null;default:return!0}case"script":if(m.async&&typeof m.async!="function"&&typeof m.async!="symbol"&&!m.onLoad&&!m.onError&&m.src&&typeof m.src=="string")return!0}return!1}function Ab(d){return!(d.type==="stylesheet"&&(d.state.loading&3)===0)}var Wc=null;function s5(){}function i5(d,m,S){if(Wc===null)throw Error(a(475));var j=Wc;if(m.type==="stylesheet"&&(typeof S.media!="string"||matchMedia(S.media).matches!==!1)&&(m.state.loading&4)===0){if(m.instance===null){var q=wl(S.href),J=d.querySelector(Hc(q));if(J){d=J._p,d!==null&&typeof d=="object"&&typeof d.then=="function"&&(j.count++,j=Kd.bind(j),d.then(j,j)),m.state.loading|=4,m.instance=J,Oe(J);return}J=d.ownerDocument||d,S=Sb(S),(q=Rn.get(q))&&V0(S,q),J=J.createElement("link"),Oe(J);var oe=J;oe._p=new Promise(function(ge,Ne){oe.onload=ge,oe.onerror=Ne}),Ta(J,"link",S),m.instance=J}j.stylesheets===null&&(j.stylesheets=new Map),j.stylesheets.set(m,d),(d=m.state.preload)&&(m.state.loading&3)===0&&(j.count++,m=Kd.bind(j),d.addEventListener("load",m),d.addEventListener("error",m))}}function o5(){if(Wc===null)throw Error(a(475));var d=Wc;return d.stylesheets&&d.count===0&&q0(d,d.stylesheets),0<d.count?function(m){var S=setTimeout(function(){if(d.stylesheets&&q0(d,d.stylesheets),d.unsuspend){var j=d.unsuspend;d.unsuspend=null,j()}},6e4);return d.unsuspend=m,function(){d.unsuspend=null,clearTimeout(S)}}:null}function Kd(){if(this.count--,this.count===0){if(this.stylesheets)q0(this,this.stylesheets);else if(this.unsuspend){var d=this.unsuspend;this.unsuspend=null,d()}}}var Zd=null;function q0(d,m){d.stylesheets=null,d.unsuspend!==null&&(d.count++,Zd=new Map,m.forEach(l5,d),Zd=null,Kd.call(d))}function l5(d,m){if(!(m.state.loading&4)){var S=Zd.get(d);if(S)var j=S.get(null);else{S=new Map,Zd.set(d,S);for(var q=d.querySelectorAll("link[data-precedence],style[data-precedence]"),J=0;J<q.length;J++){var oe=q[J];(oe.nodeName==="LINK"||oe.getAttribute("media")!=="not all")&&(S.set(oe.dataset.precedence,oe),j=oe)}j&&S.set(null,j)}q=m.instance,oe=q.getAttribute("data-precedence"),J=S.get(oe)||j,J===j&&S.set(null,q),S.set(oe,q),this.count++,j=Kd.bind(this),q.addEventListener("load",j),q.addEventListener("error",j),J?J.parentNode.insertBefore(q,J.nextSibling):(d=d.nodeType===9?d.head:d,d.insertBefore(q,d.firstChild)),m.state.loading|=4}}var Gc={$$typeof:E,Provider:null,Consumer:null,_currentValue:A,_currentValue2:A,_threadCount:0};function c5(d,m,S,j,q,J,oe,ge){this.tag=1,this.containerInfo=d,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=bt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bt(0),this.hiddenUpdates=bt(null),this.identifierPrefix=j,this.onUncaughtError=q,this.onCaughtError=J,this.onRecoverableError=oe,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ge,this.incompleteTransitions=new Map}function Cb(d,m,S,j,q,J,oe,ge,Ne,Ge,lt,pt){return d=new c5(d,m,S,oe,ge,Ne,Ge,pt),m=1,J===!0&&(m|=24),J=dn(3,null,null,m),d.current=J,J.stateNode=d,m=Th(),m.refCount++,d.pooledCache=m,m.refCount++,J.memoizedState={element:j,isDehydrated:S,cache:m},jh(J),d}function Nb(d){return d?(d=Qo,d):Qo}function jb(d,m,S,j,q,J){q=Nb(q),j.context===null?j.context=q:j.pendingContext=q,j=xi(m),j.payload={element:S},J=J===void 0?null:J,J!==null&&(j.callback=J),S=yi(d,j,m),S!==null&&(gn(S,d,m),Sc(S,d,m))}function Ob(d,m){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var S=d.retryLane;d.retryLane=S!==0&&S<m?S:m}}function W0(d,m){Ob(d,m),(d=d.alternate)&&Ob(d,m)}function Db(d){if(d.tag===13){var m=Jo(d,67108864);m!==null&&gn(m,d,67108864),W0(d,67108864)}}var Jd=!0;function u5(d,m,S,j){var q=_.T;_.T=null;var J=k.p;try{k.p=2,G0(d,m,S,j)}finally{k.p=J,_.T=q}}function d5(d,m,S,j){var q=_.T;_.T=null;var J=k.p;try{k.p=8,G0(d,m,S,j)}finally{k.p=J,_.T=q}}function G0(d,m,S,j){if(Jd){var q=Y0(j);if(q===null)R0(d,m,j,Qd,S),Rb(d,j);else if(h5(q,d,m,S,j))j.stopPropagation();else if(Rb(d,j),m&4&&-1<f5.indexOf(d)){for(;q!==null;){var J=we(q);if(J!==null)switch(J.tag){case 3:if(J=J.stateNode,J.current.memoizedState.isDehydrated){var oe=ct(J.pendingLanes);if(oe!==0){var ge=J;for(ge.pendingLanes|=2,ge.entangledLanes|=2;oe;){var Ne=1<<31-et(oe);ge.entanglements[1]|=Ne,oe&=~Ne}bs(J),(Er&6)===0&&(Fd=ne()+500,Uc(0))}}break;case 13:ge=Jo(J,2),ge!==null&&gn(ge,J,2),Ld(),W0(J,2)}if(J=Y0(j),J===null&&R0(d,m,j,Qd,S),J===q)break;q=J}q!==null&&j.stopPropagation()}else R0(d,m,j,null,S)}}function Y0(d){return d=io(d),X0(d)}var Qd=null;function X0(d){if(Qd=null,d=be(d),d!==null){var m=o(d);if(m===null)d=null;else{var S=m.tag;if(S===13){if(d=s(m),d!==null)return d;d=null}else if(S===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;d=null}else m!==d&&(d=null)}}return Qd=d,null}function Mb(d){switch(d){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ue()){case he:return 2;case ke:return 8;case pe:case Ce:return 32;case Me:return 268435456;default:return 32}default:return 32}}var K0=!1,Mi=null,Ri=null,Ii=null,Yc=new Map,Xc=new Map,Fi=[],f5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Rb(d,m){switch(d){case"focusin":case"focusout":Mi=null;break;case"dragenter":case"dragleave":Ri=null;break;case"mouseover":case"mouseout":Ii=null;break;case"pointerover":case"pointerout":Yc.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xc.delete(m.pointerId)}}function Kc(d,m,S,j,q,J){return d===null||d.nativeEvent!==J?(d={blockedOn:m,domEventName:S,eventSystemFlags:j,nativeEvent:J,targetContainers:[q]},m!==null&&(m=we(m),m!==null&&Db(m)),d):(d.eventSystemFlags|=j,m=d.targetContainers,q!==null&&m.indexOf(q)===-1&&m.push(q),d)}function h5(d,m,S,j,q){switch(m){case"focusin":return Mi=Kc(Mi,d,m,S,j,q),!0;case"dragenter":return Ri=Kc(Ri,d,m,S,j,q),!0;case"mouseover":return Ii=Kc(Ii,d,m,S,j,q),!0;case"pointerover":var J=q.pointerId;return Yc.set(J,Kc(Yc.get(J)||null,d,m,S,j,q)),!0;case"gotpointercapture":return J=q.pointerId,Xc.set(J,Kc(Xc.get(J)||null,d,m,S,j,q)),!0}return!1}function Ib(d){var m=be(d.target);if(m!==null){var S=o(m);if(S!==null){if(m=S.tag,m===13){if(m=s(S),m!==null){d.blockedOn=m,yt(d.priority,function(){if(S.tag===13){var j=mn();j=xt(j);var q=Jo(S,j);q!==null&&gn(q,S,j),W0(S,j)}});return}}else if(m===3&&S.stateNode.current.memoizedState.isDehydrated){d.blockedOn=S.tag===3?S.stateNode.containerInfo:null;return}}}d.blockedOn=null}function ef(d){if(d.blockedOn!==null)return!1;for(var m=d.targetContainers;0<m.length;){var S=Y0(d.nativeEvent);if(S===null){S=d.nativeEvent;var j=new S.constructor(S.type,S);pi=j,S.target.dispatchEvent(j),pi=null}else return m=we(S),m!==null&&Db(m),d.blockedOn=S,!1;m.shift()}return!0}function Fb(d,m,S){ef(d)&&S.delete(m)}function p5(){K0=!1,Mi!==null&&ef(Mi)&&(Mi=null),Ri!==null&&ef(Ri)&&(Ri=null),Ii!==null&&ef(Ii)&&(Ii=null),Yc.forEach(Fb),Xc.forEach(Fb)}function tf(d,m){d.blockedOn===m&&(d.blockedOn=null,K0||(K0=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,p5)))}var rf=null;function Pb(d){rf!==d&&(rf=d,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){rf===d&&(rf=null);for(var m=0;m<d.length;m+=3){var S=d[m],j=d[m+1],q=d[m+2];if(typeof j!="function"){if(X0(j||S)===null)continue;break}var J=we(S);J!==null&&(d.splice(m,3),m-=3,Xh(J,{pending:!0,data:q,method:S.method,action:j},j,q))}}))}function Zc(d){function m(Ne){return tf(Ne,d)}Mi!==null&&tf(Mi,d),Ri!==null&&tf(Ri,d),Ii!==null&&tf(Ii,d),Yc.forEach(m),Xc.forEach(m);for(var S=0;S<Fi.length;S++){var j=Fi[S];j.blockedOn===d&&(j.blockedOn=null)}for(;0<Fi.length&&(S=Fi[0],S.blockedOn===null);)Ib(S),S.blockedOn===null&&Fi.shift();if(S=(d.ownerDocument||d).$$reactFormReplay,S!=null)for(j=0;j<S.length;j+=3){var q=S[j],J=S[j+1],oe=q[kt]||null;if(typeof J=="function")oe||Pb(S);else if(oe){var ge=null;if(J&&J.hasAttribute("formAction")){if(q=J,oe=J[kt]||null)ge=oe.formAction;else if(X0(q)!==null)continue}else ge=oe.action;typeof ge=="function"?S[j+1]=ge:(S.splice(j,3),j-=3),Pb(S)}}}function Z0(d){this._internalRoot=d}af.prototype.render=Z0.prototype.render=function(d){var m=this._internalRoot;if(m===null)throw Error(a(409));var S=m.current,j=mn();jb(S,j,d,m,null,null)},af.prototype.unmount=Z0.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var m=d.containerInfo;jb(d.current,2,null,d,null,null),Ld(),m[Ae]=null}};function af(d){this._internalRoot=d}af.prototype.unstable_scheduleHydration=function(d){if(d){var m=Kt();d={blockedOn:null,target:d,priority:m};for(var S=0;S<Fi.length&&m!==0&&m<Fi[S].priority;S++);Fi.splice(S,0,d),S===0&&Ib(d)}};var Lb=r.version;if(Lb!=="19.1.0")throw Error(a(527,Lb,"19.1.0"));k.findDOMNode=function(d){var m=d._reactInternals;if(m===void 0)throw typeof d.render=="function"?Error(a(188)):(d=Object.keys(d).join(","),Error(a(268,d)));return d=c(m),d=d!==null?i(d):null,d=d===null?null:d.stateNode,d};var m5={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:_,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nf.isDisabled&&nf.supportsFiber)try{at=nf.inject(m5),rt=nf}catch{}}return Jc.createRoot=function(d,m){if(!n(d))throw Error(a(299));var S=!1,j="",q=ev,J=tv,oe=rv,ge=null;return m!=null&&(m.unstable_strictMode===!0&&(S=!0),m.identifierPrefix!==void 0&&(j=m.identifierPrefix),m.onUncaughtError!==void 0&&(q=m.onUncaughtError),m.onCaughtError!==void 0&&(J=m.onCaughtError),m.onRecoverableError!==void 0&&(oe=m.onRecoverableError),m.unstable_transitionCallbacks!==void 0&&(ge=m.unstable_transitionCallbacks)),m=Cb(d,1,!1,null,null,S,j,q,J,oe,ge,null),d[Ae]=m.current,M0(d),new Z0(m)},Jc.hydrateRoot=function(d,m,S){if(!n(d))throw Error(a(299));var j=!1,q="",J=ev,oe=tv,ge=rv,Ne=null,Ge=null;return S!=null&&(S.unstable_strictMode===!0&&(j=!0),S.identifierPrefix!==void 0&&(q=S.identifierPrefix),S.onUncaughtError!==void 0&&(J=S.onUncaughtError),S.onCaughtError!==void 0&&(oe=S.onCaughtError),S.onRecoverableError!==void 0&&(ge=S.onRecoverableError),S.unstable_transitionCallbacks!==void 0&&(Ne=S.unstable_transitionCallbacks),S.formState!==void 0&&(Ge=S.formState)),m=Cb(d,1,!0,m,S??null,j,q,J,oe,ge,Ne,Ge),m.context=Nb(null),S=m.current,j=mn(),j=xt(j),q=xi(j),q.callback=null,yi(S,q,j),S=j,m.current.lanes=S,tt(m,S),bs(m),d[Ae]=m.current,M0(d),new af(m)},Jc.version="19.1.0",Jc}var $b;function p8(){if($b)return J0.exports;$b=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(r){console.error(r)}}return t(),J0.exports=h8(),J0.exports}var m8=p8();const pm="-",g8=t=>{const r=b8(t),{conflictingClassGroups:e,conflictingClassGroupModifiers:a}=t;return{getClassGroupId:s=>{const l=s.split(pm);return l[0]===""&&l.length!==1&&l.shift(),w2(l,r)||v8(s)},getConflictingClassGroupIds:(s,l)=>{const c=e[s]||[];return l&&a[s]?[...c,...a[s]]:c}}},w2=(t,r)=>{var s;if(t.length===0)return r.classGroupId;const e=t[0],a=r.nextPart.get(e),n=a?w2(t.slice(1),a):void 0;if(n)return n;if(r.validators.length===0)return;const o=t.join(pm);return(s=r.validators.find(({validator:l})=>l(o)))==null?void 0:s.classGroupId},Vb=/^\[(.+)\]$/,v8=t=>{if(Vb.test(t)){const r=Vb.exec(t)[1],e=r==null?void 0:r.substring(0,r.indexOf(":"));if(e)return"arbitrary.."+e}},b8=t=>{const{theme:r,prefix:e}=t,a={nextPart:new Map,validators:[]};return y8(Object.entries(t.classGroups),e).forEach(([o,s])=>{Np(s,a,o,r)}),a},Np=(t,r,e,a)=>{t.forEach(n=>{if(typeof n=="string"){const o=n===""?r:Hb(r,n);o.classGroupId=e;return}if(typeof n=="function"){if(x8(n)){Np(n(a),r,e,a);return}r.validators.push({validator:n,classGroupId:e});return}Object.entries(n).forEach(([o,s])=>{Np(s,Hb(r,o),e,a)})})},Hb=(t,r)=>{let e=t;return r.split(pm).forEach(a=>{e.nextPart.has(a)||e.nextPart.set(a,{nextPart:new Map,validators:[]}),e=e.nextPart.get(a)}),e},x8=t=>t.isThemeGetter,y8=(t,r)=>r?t.map(([e,a])=>{const n=a.map(o=>typeof o=="string"?r+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([s,l])=>[r+s,l])):o);return[e,n]}):t,w8=t=>{if(t<1)return{get:()=>{},set:()=>{}};let r=0,e=new Map,a=new Map;const n=(o,s)=>{e.set(o,s),r++,r>t&&(r=0,a=e,e=new Map)};return{get(o){let s=e.get(o);if(s!==void 0)return s;if((s=a.get(o))!==void 0)return n(o,s),s},set(o,s){e.has(o)?e.set(o,s):n(o,s)}}},_2="!",_8=t=>{const{separator:r,experimentalParseClassName:e}=t,a=r.length===1,n=r[0],o=r.length,s=l=>{const c=[];let i=0,u=0,p;for(let g=0;g<l.length;g++){let x=l[g];if(i===0){if(x===n&&(a||l.slice(g,g+o)===r)){c.push(l.slice(u,g)),u=g+o;continue}if(x==="/"){p=g;continue}}x==="["?i++:x==="]"&&i--}const f=c.length===0?l:l.substring(u),h=f.startsWith(_2),v=h?f.substring(1):f,b=p&&p>u?p-u:void 0;return{modifiers:c,hasImportantModifier:h,baseClassName:v,maybePostfixModifierPosition:b}};return e?l=>e({className:l,parseClassName:s}):s},S8=t=>{if(t.length<=1)return t;const r=[];let e=[];return t.forEach(a=>{a[0]==="["?(r.push(...e.sort(),a),e=[]):e.push(a)}),r.push(...e.sort()),r},k8=t=>({cache:w8(t.cacheSize),parseClassName:_8(t),...g8(t)}),E8=/\s+/,T8=(t,r)=>{const{parseClassName:e,getClassGroupId:a,getConflictingClassGroupIds:n}=r,o=[],s=t.trim().split(E8);let l="";for(let c=s.length-1;c>=0;c-=1){const i=s[c],{modifiers:u,hasImportantModifier:p,baseClassName:f,maybePostfixModifierPosition:h}=e(i);let v=!!h,b=a(v?f.substring(0,h):f);if(!b){if(!v){l=i+(l.length>0?" "+l:l);continue}if(b=a(f),!b){l=i+(l.length>0?" "+l:l);continue}v=!1}const g=S8(u).join(":"),x=p?g+_2:g,y=x+b;if(o.includes(y))continue;o.push(y);const E=n(b,v);for(let N=0;N<E.length;++N){const I=E[N];o.push(x+I)}l=i+(l.length>0?" "+l:l)}return l};function A8(){let t=0,r,e,a="";for(;t<arguments.length;)(r=arguments[t++])&&(e=S2(r))&&(a&&(a+=" "),a+=e);return a}const S2=t=>{if(typeof t=="string")return t;let r,e="";for(let a=0;a<t.length;a++)t[a]&&(r=S2(t[a]))&&(e&&(e+=" "),e+=r);return e};function C8(t,...r){let e,a,n,o=s;function s(c){const i=r.reduce((u,p)=>p(u),t());return e=k8(i),a=e.cache.get,n=e.cache.set,o=l,l(c)}function l(c){const i=a(c);if(i)return i;const u=T8(c,e);return n(c,u),u}return function(){return o(A8.apply(null,arguments))}}const Pr=t=>{const r=e=>e[t]||[];return r.isThemeGetter=!0,r},k2=/^\[(?:([a-z-]+):)?(.+)\]$/i,N8=/^\d+\/\d+$/,j8=new Set(["px","full","screen"]),O8=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,D8=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,M8=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,R8=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,I8=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Zs=t=>Vl(t)||j8.has(t)||N8.test(t),Li=t=>Ql(t,"length",V8),Vl=t=>!!t&&!Number.isNaN(Number(t)),tp=t=>Ql(t,"number",Vl),Qc=t=>!!t&&Number.isInteger(Number(t)),F8=t=>t.endsWith("%")&&Vl(t.slice(0,-1)),ar=t=>k2.test(t),Bi=t=>O8.test(t),P8=new Set(["length","size","percentage"]),L8=t=>Ql(t,P8,E2),B8=t=>Ql(t,"position",E2),U8=new Set(["image","url"]),z8=t=>Ql(t,U8,q8),$8=t=>Ql(t,"",H8),eu=()=>!0,Ql=(t,r,e)=>{const a=k2.exec(t);return a?a[1]?typeof r=="string"?a[1]===r:r.has(a[1]):e(a[2]):!1},V8=t=>D8.test(t)&&!M8.test(t),E2=()=>!1,H8=t=>R8.test(t),q8=t=>I8.test(t),W8=()=>{const t=Pr("colors"),r=Pr("spacing"),e=Pr("blur"),a=Pr("brightness"),n=Pr("borderColor"),o=Pr("borderRadius"),s=Pr("borderSpacing"),l=Pr("borderWidth"),c=Pr("contrast"),i=Pr("grayscale"),u=Pr("hueRotate"),p=Pr("invert"),f=Pr("gap"),h=Pr("gradientColorStops"),v=Pr("gradientColorStopPositions"),b=Pr("inset"),g=Pr("margin"),x=Pr("opacity"),y=Pr("padding"),E=Pr("saturate"),N=Pr("scale"),I=Pr("sepia"),P=Pr("skew"),V=Pr("space"),U=Pr("translate"),H=()=>["auto","contain","none"],G=()=>["auto","hidden","clip","visible","scroll"],Z=()=>["auto",ar,r],W=()=>[ar,r],O=()=>["",Zs,Li],R=()=>["auto",Vl,ar],C=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],_=()=>["solid","dashed","dotted","double","none"],k=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],A=()=>["start","end","center","between","around","evenly","stretch"],T=()=>["","0",ar],D=()=>["auto","avoid","all","avoid-page","page","left","right","column"],B=()=>[Vl,ar];return{cacheSize:500,separator:":",theme:{colors:[eu],spacing:[Zs,Li],blur:["none","",Bi,ar],brightness:B(),borderColor:[t],borderRadius:["none","","full",Bi,ar],borderSpacing:W(),borderWidth:O(),contrast:B(),grayscale:T(),hueRotate:B(),invert:T(),gap:W(),gradientColorStops:[t],gradientColorStopPositions:[F8,Li],inset:Z(),margin:Z(),opacity:B(),padding:W(),saturate:B(),scale:B(),sepia:T(),skew:B(),space:W(),translate:W()},classGroups:{aspect:[{aspect:["auto","square","video",ar]}],container:["container"],columns:[{columns:[Bi]}],"break-after":[{"break-after":D()}],"break-before":[{"break-before":D()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...C(),ar]}],overflow:[{overflow:G()}],"overflow-x":[{"overflow-x":G()}],"overflow-y":[{"overflow-y":G()}],overscroll:[{overscroll:H()}],"overscroll-x":[{"overscroll-x":H()}],"overscroll-y":[{"overscroll-y":H()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Qc,ar]}],basis:[{basis:Z()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ar]}],grow:[{grow:T()}],shrink:[{shrink:T()}],order:[{order:["first","last","none",Qc,ar]}],"grid-cols":[{"grid-cols":[eu]}],"col-start-end":[{col:["auto",{span:["full",Qc,ar]},ar]}],"col-start":[{"col-start":R()}],"col-end":[{"col-end":R()}],"grid-rows":[{"grid-rows":[eu]}],"row-start-end":[{row:["auto",{span:[Qc,ar]},ar]}],"row-start":[{"row-start":R()}],"row-end":[{"row-end":R()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ar]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ar]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...A()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...A(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...A(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[V]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[V]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ar,r]}],"min-w":[{"min-w":[ar,r,"min","max","fit"]}],"max-w":[{"max-w":[ar,r,"none","full","min","max","fit","prose",{screen:[Bi]},Bi]}],h:[{h:[ar,r,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ar,r,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ar,r,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ar,r,"auto","min","max","fit"]}],"font-size":[{text:["base",Bi,Li]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",tp]}],"font-family":[{font:[eu]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ar]}],"line-clamp":[{"line-clamp":["none",Vl,tp]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Zs,ar]}],"list-image":[{"list-image":["none",ar]}],"list-style-type":[{list:["none","disc","decimal",ar]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[..._(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Zs,Li]}],"underline-offset":[{"underline-offset":["auto",Zs,ar]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:W()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ar]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ar]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...C(),B8]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",L8]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},z8]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[..._(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:_()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",..._()]}],"outline-offset":[{"outline-offset":[Zs,ar]}],"outline-w":[{outline:[Zs,Li]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:O()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Zs,Li]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Bi,$8]}],"shadow-color":[{shadow:[eu]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...k(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":k()}],filter:[{filter:["","none"]}],blur:[{blur:[e]}],brightness:[{brightness:[a]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Bi,ar]}],grayscale:[{grayscale:[i]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[p]}],saturate:[{saturate:[E]}],sepia:[{sepia:[I]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[e]}],"backdrop-brightness":[{"backdrop-brightness":[a]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[i]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[p]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[E]}],"backdrop-sepia":[{"backdrop-sepia":[I]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ar]}],duration:[{duration:B()}],ease:[{ease:["linear","in","out","in-out",ar]}],delay:[{delay:B()}],animate:[{animate:["none","spin","ping","pulse","bounce",ar]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[Qc,ar]}],"translate-x":[{"translate-x":[U]}],"translate-y":[{"translate-y":[U]}],"skew-x":[{"skew-x":[P]}],"skew-y":[{"skew-y":[P]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ar]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ar]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":W()}],"scroll-mx":[{"scroll-mx":W()}],"scroll-my":[{"scroll-my":W()}],"scroll-ms":[{"scroll-ms":W()}],"scroll-me":[{"scroll-me":W()}],"scroll-mt":[{"scroll-mt":W()}],"scroll-mr":[{"scroll-mr":W()}],"scroll-mb":[{"scroll-mb":W()}],"scroll-ml":[{"scroll-ml":W()}],"scroll-p":[{"scroll-p":W()}],"scroll-px":[{"scroll-px":W()}],"scroll-py":[{"scroll-py":W()}],"scroll-ps":[{"scroll-ps":W()}],"scroll-pe":[{"scroll-pe":W()}],"scroll-pt":[{"scroll-pt":W()}],"scroll-pr":[{"scroll-pr":W()}],"scroll-pb":[{"scroll-pb":W()}],"scroll-pl":[{"scroll-pl":W()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ar]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Zs,Li,tp]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},G8=C8(W8);function Et(...t){return G8(g2(t))}const Nt=Se.forwardRef(({className:t,...r},e)=>w.jsx("div",{ref:e,className:Et("rounded-xl border bg-card text-card-foreground shadow dark:shadow-[0_0_15px_-3px_rgba(255,255,255,0.05)]",t),...r}));Nt.displayName="Card";const Dt=Se.forwardRef(({className:t,...r},e)=>w.jsx("div",{ref:e,className:Et("flex flex-col space-y-1.5 p-6",t),...r}));Dt.displayName="CardHeader";const Mt=Se.forwardRef(({className:t,...r},e)=>w.jsx("div",{ref:e,className:Et("font-semibold leading-none tracking-tight",t),...r}));Mt.displayName="CardTitle";const Cr=Se.forwardRef(({className:t,...r},e)=>w.jsx("div",{ref:e,className:Et("text-sm text-muted-foreground",t),...r}));Cr.displayName="CardDescription";const jt=Se.forwardRef(({className:t,...r},e)=>w.jsx("div",{ref:e,className:Et("p-6 pt-0",t),...r}));jt.displayName="CardContent";const T2=Se.forwardRef(({className:t,...r},e)=>w.jsx("div",{ref:e,className:Et("flex items-center p-6 pt-0",t),...r}));T2.displayName="CardFooter";function Bn({title:t,value:r,description:e,icon:a,trend:n,trendValue:o}){return w.jsxs(Nt,{children:[w.jsxs(Dt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[w.jsx(Mt,{className:"text-sm font-medium",children:t}),w.jsx(a,{className:"h-4 w-4 text-muted-foreground"})]}),w.jsxs(jt,{children:[w.jsx("div",{className:"text-2xl font-bold",children:r}),(e||o)&&w.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[n==="up"&&w.jsxs("span",{className:"text-green-500 mr-1",children:[" ",o]}),n==="down"&&w.jsxs("span",{className:"text-red-500 mr-1",children:[" ",o]}),e]})]})]})}const qb=t=>{let r;const e=new Set,a=(i,u)=>{const p=typeof i=="function"?i(r):i;if(!Object.is(p,r)){const f=r;r=u??(typeof p!="object"||p===null)?p:Object.assign({},r,p),e.forEach(h=>h(r,f))}},n=()=>r,l={setState:a,getState:n,getInitialState:()=>c,subscribe:i=>(e.add(i),()=>e.delete(i))},c=r=t(a,n,l);return l},Y8=t=>t?qb(t):qb,X8=t=>t;function K8(t,r=X8){const e=Xe.useSyncExternalStore(t.subscribe,Xe.useCallback(()=>r(t.getState()),[t,r]),Xe.useCallback(()=>r(t.getInitialState()),[t,r]));return Xe.useDebugValue(e),e}const Wb=t=>{const r=Y8(t),e=a=>K8(r,a);return Object.assign(e,r),e},A2=t=>t?Wb(t):Wb,Z8=()=>{try{const t=localStorage.getItem("auth_user");if(t){const r=JSON.parse(t),e=r._cacheTime||0,n=Date.now()-e,o=24*60*60*1e3;if(n<o){const{_cacheTime:s,...l}=r;return l}else localStorage.removeItem("auth_user")}}catch(t){console.warn(" Erro ao carregar usurio do localStorage:",t),localStorage.removeItem("auth_user")}return null},Oa=A2(t=>({user:Z8(),isLoading:!0,setUser:r=>{if(t({user:r}),r)try{const e={...r,_cacheTime:Date.now()};localStorage.setItem("auth_user",JSON.stringify(e))}catch(e){console.warn(" Erro ao salvar usurio no localStorage:",e)}else localStorage.removeItem("auth_user")},setIsLoading:r=>t({isLoading:r}),logout:async()=>{const{supabase:r}=await u8(async()=>{const{supabase:e}=await Promise.resolve().then(()=>lN);return{supabase:e}},void 0);await r.auth.signOut(),localStorage.removeItem("auth_user"),Object.keys(localStorage).forEach(e=>{e.startsWith("profile_")&&localStorage.removeItem(e)}),t({user:null,isLoading:!1})}})),ec=A2(t=>({filters:{period:void 0},setFilters:r=>t(e=>({filters:{...e.filters,...r}})),resetFilters:()=>t({filters:{period:void 0}})}));var J8=Symbol.for("react.lazy"),Sf=J5[" use ".trim().toString()];function Q8(t){return typeof t=="object"&&t!==null&&"then"in t}function C2(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===J8&&"_payload"in t&&Q8(t._payload)}function mm(t){const r=tS(t),e=Se.forwardRef((a,n)=>{let{children:o,...s}=a;C2(o)&&typeof Sf=="function"&&(o=Sf(o._payload));const l=Se.Children.toArray(o),c=l.find(aS);if(c){const i=c.props.children,u=l.map(p=>p===c?Se.Children.count(i)>1?Se.Children.only(null):Se.isValidElement(i)?i.props.children:null:p);return w.jsx(r,{...s,ref:n,children:Se.isValidElement(i)?Se.cloneElement(i,void 0,u):null})}return w.jsx(r,{...s,ref:n,children:o})});return e.displayName=`${t}.Slot`,e}var eS=mm("Slot");function tS(t){const r=Se.forwardRef((e,a)=>{let{children:n,...o}=e;if(C2(n)&&typeof Sf=="function"&&(n=Sf(n._payload)),Se.isValidElement(n)){const s=sS(n),l=nS(o,n.props);return n.type!==Se.Fragment&&(l.ref=a?e2(a,s):s),Se.cloneElement(n,l)}return Se.Children.count(n)>1?Se.Children.only(null):null});return r.displayName=`${t}.SlotClone`,r}var rS=Symbol("radix.slottable");function aS(t){return Se.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===rS}function nS(t,r){const e={...r};for(const a in r){const n=t[a],o=r[a];/^on[A-Z]/.test(a)?n&&o?e[a]=(...l)=>{const c=o(...l);return n(...l),c}:n&&(e[a]=n):a==="style"?e[a]={...n,...o}:a==="className"&&(e[a]=[n,o].filter(Boolean).join(" "))}return{...t,...e}}function sS(t){var a,n;let r=(a=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:a.get,e=r&&"isReactWarning"in r&&r.isReactWarning;return e?t.ref:(r=(n=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:n.get,e=r&&"isReactWarning"in r&&r.isReactWarning,e?t.props.ref:t.props.ref||t.ref)}const Gb=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Yb=g2,$f=(t,r)=>e=>{var a;if((r==null?void 0:r.variants)==null)return Yb(t,e==null?void 0:e.class,e==null?void 0:e.className);const{variants:n,defaultVariants:o}=r,s=Object.keys(n).map(i=>{const u=e==null?void 0:e[i],p=o==null?void 0:o[i];if(u===null)return null;const f=Gb(u)||Gb(p);return n[i][f]}),l=e&&Object.entries(e).reduce((i,u)=>{let[p,f]=u;return f===void 0||(i[p]=f),i},{}),c=r==null||(a=r.compoundVariants)===null||a===void 0?void 0:a.reduce((i,u)=>{let{class:p,className:f,...h}=u;return Object.entries(h).every(v=>{let[b,g]=v;return Array.isArray(g)?g.includes({...o,...l}[b]):{...o,...l}[b]===g})?[...i,p,f]:i},[]);return Yb(t,s,c,e==null?void 0:e.class,e==null?void 0:e.className)},jp=$f("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Ot=Se.forwardRef(({className:t,variant:r,size:e,asChild:a=!1,...n},o)=>{const s=a?eS:"button";return w.jsx(s,{className:Et(jp({variant:r,size:e,className:t})),ref:o,...n})});Ot.displayName="Button";const _r=Se.forwardRef(({className:t,type:r,...e},a)=>w.jsx("input",{type:r,className:Et("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...e}));_r.displayName="Input";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),oS=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(r,e,a)=>a?a.toUpperCase():e.toLowerCase()),Xb=t=>{const r=oS(t);return r.charAt(0).toUpperCase()+r.slice(1)},N2=(...t)=>t.filter((r,e,a)=>!!r&&r.trim()!==""&&a.indexOf(r)===e).join(" ").trim(),lS=t=>{for(const r in t)if(r.startsWith("aria-")||r==="role"||r==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var cS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uS=Se.forwardRef(({color:t="currentColor",size:r=24,strokeWidth:e=2,absoluteStrokeWidth:a,className:n="",children:o,iconNode:s,...l},c)=>Se.createElement("svg",{ref:c,...cS,width:r,height:r,stroke:t,strokeWidth:a?Number(e)*24/Number(r):e,className:N2("lucide",n),...!o&&!lS(l)&&{"aria-hidden":"true"},...l},[...s.map(([i,u])=>Se.createElement(i,u)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=(t,r)=>{const e=Se.forwardRef(({className:a,...n},o)=>Se.createElement(uS,{ref:o,iconNode:r,className:N2(`lucide-${iS(Xb(t))}`,`lucide-${t}`,a),...n}));return e.displayName=Xb(t),e};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dS=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],j2=Ht("arrow-down",dS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fS=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],O2=Ht("arrow-up-down",fS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hS=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],D2=Ht("arrow-up",hS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],mS=Ht("calendar",pS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gS=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Kb=Ht("chart-column",gS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],bS=Ht("check",vS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xS=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],zu=Ht("chevron-down",xS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],yu=Ht("chevron-left",yS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wS=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],wu=Ht("chevron-right",wS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _S=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],M2=Ht("chevron-up",_S);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],R2=Ht("circle-alert",SS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ao=Ht("circle-x",kS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ES=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],TS=Ht("cloud-upload",ES);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AS=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Op=Ht("dollar-sign",AS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]],NS=Ht("file-chart-column-increasing",CS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],OS=Ht("file-spreadsheet",jS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],MS=Ht("file-text",DS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RS=[["path",{d:"M12.531 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14v6a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341l.427-.473",key:"ol2ft2"}],["path",{d:"m16.5 3.5 5 5",key:"15e6fa"}],["path",{d:"m21.5 3.5-5 5",key:"m0lwru"}]],IS=Ht("funnel-x",RS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FS=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],PS=Ht("history",FS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Zb=Ht("info",LS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BS=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],US=Ht("layers",BS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zS=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],Jb=Ht("layout-dashboard",zS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $S=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],oi=Ht("loader-circle",$S);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VS=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Dp=Ht("log-out",VS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HS=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],qS=Ht("mail",HS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WS=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Mp=Ht("map-pin",WS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GS=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],YS=Ht("menu",GS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XS=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],Qb=Ht("moon",XS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KS=[["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}],["path",{d:"m17 13 5 5m-5 0 5-5",key:"im3w4b"}]],Ul=Ht("package-x",KS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZS=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],JS=Ht("package",ZS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QS=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],ex=Ht("pen",QS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ek=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],tk=Ht("percent",ek);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rk=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],tu=Ht("plus",rk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ak=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],nk=Ht("printer",ak);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sk=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],I2=Ht("refresh-ccw",sk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ik=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],gm=Ht("refresh-cw",ik);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ok=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],lk=Ht("save",ok);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ck=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],uk=Ht("search",ck);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dk=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],fk=Ht("send",dk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hk=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],pk=Ht("settings",hk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mk=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Rp=Ht("share-2",mk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gk=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],tx=Ht("shield",gk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vk=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],_f=Ht("square-check-big",vk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bk=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],rx=Ht("square-pen",bk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xk=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],ax=Ht("square",xk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yk=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],nx=Ht("sun",yk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wk=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],zn=Ht("trash-2",wk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _k=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],sx=Ht("trending-down",_k);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sk=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],_u=Ht("trending-up",Sk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kk=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Rl=Ht("triangle-alert",kk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ek=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ip=Ht("user",Ek);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Vf=Ht("x",Tk),$n=_5,Vn=S5,xn=Se.forwardRef(({className:t,children:r,...e},a)=>w.jsxs(t2,{ref:a,className:Et("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...e,children:[r,w.jsx(v5,{asChild:!0,children:w.jsx(zu,{className:"h-4 w-4 opacity-50"})})]}));xn.displayName=t2.displayName;const F2=Se.forwardRef(({className:t,...r},e)=>w.jsx(r2,{ref:e,className:Et("flex cursor-default items-center justify-center py-1",t),...r,children:w.jsx(M2,{className:"h-4 w-4"})}));F2.displayName=r2.displayName;const P2=Se.forwardRef(({className:t,...r},e)=>w.jsx(a2,{ref:e,className:Et("flex cursor-default items-center justify-center py-1",t),...r,children:w.jsx(zu,{className:"h-4 w-4"})}));P2.displayName=a2.displayName;const yn=Se.forwardRef(({className:t,children:r,position:e="popper",...a},n)=>w.jsx(b5,{children:w.jsxs(n2,{ref:n,className:Et("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",e==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:e,...a,children:[w.jsx(F2,{}),w.jsx(x5,{className:Et("p-1",e==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),w.jsx(P2,{})]})}));yn.displayName=n2.displayName;const Ak=Se.forwardRef(({className:t,...r},e)=>w.jsx(s2,{ref:e,className:Et("px-2 py-1.5 text-sm font-semibold",t),...r}));Ak.displayName=s2.displayName;const sr=Se.forwardRef(({className:t,children:r,...e},a)=>w.jsxs(i2,{ref:a,className:Et("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...e,children:[w.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:w.jsx(y5,{children:w.jsx(bS,{className:"h-4 w-4"})})}),w.jsx(w5,{children:r})]}));sr.displayName=i2.displayName;const Ck=Se.forwardRef(({className:t,...r},e)=>w.jsx(o2,{ref:e,className:Et("-mx-1 my-1 h-px bg-muted",t),...r}));Ck.displayName=o2.displayName;var vm="Popper",[L2,B2]=Uf(vm),[Nk,U2]=L2(vm),z2=t=>{const{__scopePopper:r,children:e}=t,[a,n]=Se.useState(null);return w.jsx(Nk,{scope:r,anchor:a,onAnchorChange:n,children:e})};z2.displayName=vm;var $2="PopperAnchor",V2=Se.forwardRef((t,r)=>{const{__scopePopper:e,virtualRef:a,...n}=t,o=U2($2,e),s=Se.useRef(null),l=Uu(r,s),c=Se.useRef(null);return Se.useEffect(()=>{const i=c.current;c.current=(a==null?void 0:a.current)||s.current,i!==c.current&&o.onAnchorChange(c.current)}),a?null:w.jsx(Ms.div,{...n,ref:l})});V2.displayName=$2;var bm="PopperContent",[jk,Ok]=L2(bm),H2=Se.forwardRef((t,r)=>{var ee,L,M,K,se,te;const{__scopePopper:e,side:a="bottom",sideOffset:n=0,align:o="center",alignOffset:s=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:i=[],collisionPadding:u=0,sticky:p="partial",hideWhenDetached:f=!1,updatePositionStrategy:h="optimized",onPlaced:v,...b}=t,g=U2(bm,e),[x,y]=Se.useState(null),E=Uu(r,ae=>y(ae)),[N,I]=Se.useState(null),P=k5(N),V=(P==null?void 0:P.width)??0,U=(P==null?void 0:P.height)??0,H=a+(o!=="center"?"-"+o:""),G=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},Z=Array.isArray(i)?i:[i],W=Z.length>0,O={padding:G,boundary:Z.filter(Mk),altBoundary:W},{refs:R,floatingStyles:C,placement:_,isPositioned:k,middlewareData:A}=E5({strategy:"fixed",placement:H,whileElementsMounted:(...ae)=>M5(...ae,{animationFrame:h==="always"}),elements:{reference:g.anchor},middleware:[T5({mainAxis:n+U,alignmentAxis:s}),c&&A5({mainAxis:!0,crossAxis:!1,limiter:p==="partial"?D5():void 0,...O}),c&&C5({...O}),N5({...O,apply:({elements:ae,rects:Q,availableWidth:fe,availableHeight:le})=>{const{width:ne,height:ue}=Q.reference,he=ae.floating.style;he.setProperty("--radix-popper-available-width",`${fe}px`),he.setProperty("--radix-popper-available-height",`${le}px`),he.setProperty("--radix-popper-anchor-width",`${ne}px`),he.setProperty("--radix-popper-anchor-height",`${ue}px`)}}),N&&j5({element:N,padding:l}),Rk({arrowWidth:V,arrowHeight:U}),f&&O5({strategy:"referenceHidden",...O})]}),[T,D]=G2(_),B=um(v);xu(()=>{k&&(B==null||B())},[k,B]);const F=(ee=A.arrow)==null?void 0:ee.x,Y=(L=A.arrow)==null?void 0:L.y,X=((M=A.arrow)==null?void 0:M.centerOffset)!==0,[re,z]=Se.useState();return xu(()=>{x&&z(window.getComputedStyle(x).zIndex)},[x]),w.jsx("div",{ref:R.setFloating,"data-radix-popper-content-wrapper":"",style:{...C,transform:k?C.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:re,"--radix-popper-transform-origin":[(K=A.transformOrigin)==null?void 0:K.x,(se=A.transformOrigin)==null?void 0:se.y].join(" "),...((te=A.hide)==null?void 0:te.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:w.jsx(jk,{scope:e,placedSide:T,onArrowChange:I,arrowX:F,arrowY:Y,shouldHideArrow:X,children:w.jsx(Ms.div,{"data-side":T,"data-align":D,...b,ref:E,style:{...b.style,animation:k?void 0:"none"}})})})});H2.displayName=bm;var q2="PopperArrow",Dk={top:"bottom",right:"left",bottom:"top",left:"right"},W2=Se.forwardRef(function(r,e){const{__scopePopper:a,...n}=r,o=Ok(q2,a),s=Dk[o.placedSide];return w.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:w.jsx(R5,{...n,ref:e,style:{...n.style,display:"block"}})})});W2.displayName=q2;function Mk(t){return t!==null}var Rk=t=>({name:"transformOrigin",options:t,fn(r){var g,x,y;const{placement:e,rects:a,middlewareData:n}=r,s=((g=n.arrow)==null?void 0:g.centerOffset)!==0,l=s?0:t.arrowWidth,c=s?0:t.arrowHeight,[i,u]=G2(e),p={start:"0%",center:"50%",end:"100%"}[u],f=(((x=n.arrow)==null?void 0:x.x)??0)+l/2,h=(((y=n.arrow)==null?void 0:y.y)??0)+c/2;let v="",b="";return i==="bottom"?(v=s?p:`${f}px`,b=`${-c}px`):i==="top"?(v=s?p:`${f}px`,b=`${a.floating.height+c}px`):i==="right"?(v=`${-c}px`,b=s?p:`${h}px`):i==="left"&&(v=`${a.floating.width+c}px`,b=s?p:`${h}px`),{data:{x:v,y:b}}}});function G2(t){const[r,e="center"]=t.split("-");return[r,e]}var Ik=z2,Y2=V2,Fk=H2,Pk=W2;function Lk(t){const r=Bk(t),e=Se.forwardRef((a,n)=>{const{children:o,...s}=a,l=Se.Children.toArray(o),c=l.find(zk);if(c){const i=c.props.children,u=l.map(p=>p===c?Se.Children.count(i)>1?Se.Children.only(null):Se.isValidElement(i)?i.props.children:null:p);return w.jsx(r,{...s,ref:n,children:Se.isValidElement(i)?Se.cloneElement(i,void 0,u):null})}return w.jsx(r,{...s,ref:n,children:o})});return e.displayName=`${t}.Slot`,e}function Bk(t){const r=Se.forwardRef((e,a)=>{const{children:n,...o}=e;if(Se.isValidElement(n)){const s=Vk(n),l=$k(o,n.props);return n.type!==Se.Fragment&&(l.ref=a?e2(a,s):s),Se.cloneElement(n,l)}return Se.Children.count(n)>1?Se.Children.only(null):null});return r.displayName=`${t}.SlotClone`,r}var Uk=Symbol("radix.slottable");function zk(t){return Se.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Uk}function $k(t,r){const e={...r};for(const a in r){const n=t[a],o=r[a];/^on[A-Z]/.test(a)?n&&o?e[a]=(...l)=>{const c=o(...l);return n(...l),c}:n&&(e[a]=n):a==="style"?e[a]={...n,...o}:a==="className"&&(e[a]=[n,o].filter(Boolean).join(" "))}return{...t,...e}}function Vk(t){var a,n;let r=(a=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:a.get,e=r&&"isReactWarning"in r&&r.isReactWarning;return e?t.ref:(r=(n=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:n.get,e=r&&"isReactWarning"in r&&r.isReactWarning,e?t.props.ref:t.props.ref||t.ref)}var Hf="Popover",[X2,KB]=Uf(Hf,[B2]),$u=B2(),[Hk,ro]=X2(Hf),K2=t=>{const{__scopePopover:r,children:e,open:a,defaultOpen:n,onOpenChange:o,modal:s=!1}=t,l=$u(r),c=Se.useRef(null),[i,u]=Se.useState(!1),[p,f]=fm({prop:a,defaultProp:n??!1,onChange:o,caller:Hf});return w.jsx(Ik,{...l,children:w.jsx(Hk,{scope:r,contentId:hm(),triggerRef:c,open:p,onOpenChange:f,onOpenToggle:Se.useCallback(()=>f(h=>!h),[f]),hasCustomAnchor:i,onCustomAnchorAdd:Se.useCallback(()=>u(!0),[]),onCustomAnchorRemove:Se.useCallback(()=>u(!1),[]),modal:s,children:e})})};K2.displayName=Hf;var Z2="PopoverAnchor",qk=Se.forwardRef((t,r)=>{const{__scopePopover:e,...a}=t,n=ro(Z2,e),o=$u(e),{onCustomAnchorAdd:s,onCustomAnchorRemove:l}=n;return Se.useEffect(()=>(s(),()=>l()),[s,l]),w.jsx(Y2,{...o,...a,ref:r})});qk.displayName=Z2;var J2="PopoverTrigger",Q2=Se.forwardRef((t,r)=>{const{__scopePopover:e,...a}=t,n=ro(J2,e),o=$u(e),s=Uu(r,n.triggerRef),l=w.jsx(Ms.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":nw(n.open),...a,ref:s,onClick:cn(t.onClick,n.onOpenToggle)});return n.hasCustomAnchor?l:w.jsx(Y2,{asChild:!0,...o,children:l})});Q2.displayName=J2;var xm="PopoverPortal",[Wk,Gk]=X2(xm,{forceMount:void 0}),ew=t=>{const{__scopePopover:r,forceMount:e,children:a,container:n}=t,o=ro(xm,r);return w.jsx(Wk,{scope:r,forceMount:e,children:w.jsx(dm,{present:e||o.open,children:w.jsx(I5,{asChild:!0,container:n,children:a})})})};ew.displayName=xm;var Kl="PopoverContent",tw=Se.forwardRef((t,r)=>{const e=Gk(Kl,t.__scopePopover),{forceMount:a=e.forceMount,...n}=t,o=ro(Kl,t.__scopePopover);return w.jsx(dm,{present:a||o.open,children:o.modal?w.jsx(Xk,{...n,ref:r}):w.jsx(Kk,{...n,ref:r})})});tw.displayName=Kl;var Yk=Lk("PopoverContent.RemoveScroll"),Xk=Se.forwardRef((t,r)=>{const e=ro(Kl,t.__scopePopover),a=Se.useRef(null),n=Uu(r,a),o=Se.useRef(!1);return Se.useEffect(()=>{const s=a.current;if(s)return F5(s)},[]),w.jsx(P5,{as:Yk,allowPinchZoom:!0,children:w.jsx(rw,{...t,ref:n,trapFocus:e.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:cn(t.onCloseAutoFocus,s=>{var l;s.preventDefault(),o.current||(l=e.triggerRef.current)==null||l.focus()}),onPointerDownOutside:cn(t.onPointerDownOutside,s=>{const l=s.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,i=l.button===2||c;o.current=i},{checkForDefaultPrevented:!1}),onFocusOutside:cn(t.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1})})})}),Kk=Se.forwardRef((t,r)=>{const e=ro(Kl,t.__scopePopover),a=Se.useRef(!1),n=Se.useRef(!1);return w.jsx(rw,{...t,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var s,l;(s=t.onCloseAutoFocus)==null||s.call(t,o),o.defaultPrevented||(a.current||(l=e.triggerRef.current)==null||l.focus(),o.preventDefault()),a.current=!1,n.current=!1},onInteractOutside:o=>{var c,i;(c=t.onInteractOutside)==null||c.call(t,o),o.defaultPrevented||(a.current=!0,o.detail.originalEvent.type==="pointerdown"&&(n.current=!0));const s=o.target;((i=e.triggerRef.current)==null?void 0:i.contains(s))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&n.current&&o.preventDefault()}})}),rw=Se.forwardRef((t,r)=>{const{__scopePopover:e,trapFocus:a,onOpenAutoFocus:n,onCloseAutoFocus:o,disableOutsidePointerEvents:s,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:i,onInteractOutside:u,...p}=t,f=ro(Kl,e),h=$u(e);return L5(),w.jsx(B5,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:n,onUnmountAutoFocus:o,children:w.jsx(U5,{asChild:!0,disableOutsidePointerEvents:s,onInteractOutside:u,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:i,onDismiss:()=>f.onOpenChange(!1),children:w.jsx(Fk,{"data-state":nw(f.open),role:"dialog",id:f.contentId,...h,...p,ref:r,style:{...p.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),aw="PopoverClose",Zk=Se.forwardRef((t,r)=>{const{__scopePopover:e,...a}=t,n=ro(aw,e);return w.jsx(Ms.button,{type:"button",...a,ref:r,onClick:cn(t.onClick,()=>n.onOpenChange(!1))})});Zk.displayName=aw;var Jk="PopoverArrow",Qk=Se.forwardRef((t,r)=>{const{__scopePopover:e,...a}=t,n=$u(e);return w.jsx(Pk,{...n,...a,ref:r})});Qk.displayName=Jk;function nw(t){return t?"open":"closed"}var eE=K2,tE=Q2,rE=ew,sw=tw;const aE=eE,nE=tE,iw=Se.forwardRef(({className:t,align:r="center",sideOffset:e=4,...a},n)=>w.jsx(rE,{children:w.jsx(sw,{ref:n,align:r,sideOffset:e,className:Et("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",t),...a})}));iw.displayName=sw.displayName;function sE(t,r,e="long"){return new Intl.DateTimeFormat("en-US",{hour:"numeric",timeZone:t,timeZoneName:e}).format(r).split(/\s/g).slice(2).join(" ")}const rp={},ru={};function Mo(t,r){try{const a=(rp[t]||(rp[t]=new Intl.DateTimeFormat("en-US",{timeZone:t,timeZoneName:"longOffset"}).format))(r).split("GMT")[1];return a in ru?ru[a]:ix(a,a.split(":"))}catch{if(t in ru)return ru[t];const e=t==null?void 0:t.match(iE);return e?ix(t,e.slice(1)):NaN}}const iE=/([+-]\d\d):?(\d\d)?/;function ix(t,r){const e=+(r[0]||0),a=+(r[1]||0),n=+(r[2]||0)/60;return ru[t]=e*60+a>0?e*60+a+n:e*60-a-n}class Ts extends Date{constructor(...r){super(),r.length>1&&typeof r[r.length-1]=="string"&&(this.timeZone=r.pop()),this.internal=new Date,isNaN(Mo(this.timeZone,this))?this.setTime(NaN):r.length?typeof r[0]=="number"&&(r.length===1||r.length===2&&typeof r[1]!="number")?this.setTime(r[0]):typeof r[0]=="string"?this.setTime(+new Date(r[0])):r[0]instanceof Date?this.setTime(+r[0]):(this.setTime(+new Date(...r)),ow(this),Fp(this)):this.setTime(Date.now())}static tz(r,...e){return e.length?new Ts(...e,r):new Ts(Date.now(),r)}withTimeZone(r){return new Ts(+this,r)}getTimezoneOffset(){const r=-Mo(this.timeZone,this);return r>0?Math.floor(r):Math.ceil(r)}setTime(r){return Date.prototype.setTime.apply(this,arguments),Fp(this),+this}[Symbol.for("constructDateFrom")](r){return new Ts(+new Date(r),this.timeZone)}}const ox=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(t=>{if(!ox.test(t))return;const r=t.replace(ox,"$1UTC");Ts.prototype[r]&&(t.startsWith("get")?Ts.prototype[t]=function(){return this.internal[r]()}:(Ts.prototype[t]=function(){return Date.prototype[r].apply(this.internal,arguments),oE(this),+this},Ts.prototype[r]=function(){return Date.prototype[r].apply(this,arguments),Fp(this),+this}))});function Fp(t){t.internal.setTime(+t),t.internal.setUTCSeconds(t.internal.getUTCSeconds()-Math.round(-Mo(t.timeZone,t)*60))}function oE(t){Date.prototype.setFullYear.call(t,t.internal.getUTCFullYear(),t.internal.getUTCMonth(),t.internal.getUTCDate()),Date.prototype.setHours.call(t,t.internal.getUTCHours(),t.internal.getUTCMinutes(),t.internal.getUTCSeconds(),t.internal.getUTCMilliseconds()),ow(t)}function ow(t){const r=Mo(t.timeZone,t),e=r>0?Math.floor(r):Math.ceil(r),a=new Date(+t);a.setUTCHours(a.getUTCHours()-1);const n=-new Date(+t).getTimezoneOffset(),o=-new Date(+a).getTimezoneOffset(),s=n-o,l=Date.prototype.getHours.apply(t)!==t.internal.getUTCHours();s&&l&&t.internal.setUTCMinutes(t.internal.getUTCMinutes()+s);const c=n-e;c&&Date.prototype.setUTCMinutes.call(t,Date.prototype.getUTCMinutes.call(t)+c);const i=new Date(+t);i.setUTCSeconds(0);const u=n>0?i.getSeconds():(i.getSeconds()-60)%60,p=Math.round(-(Mo(t.timeZone,t)*60))%60;(p||u)&&(t.internal.setUTCSeconds(t.internal.getUTCSeconds()+p),Date.prototype.setUTCSeconds.call(t,Date.prototype.getUTCSeconds.call(t)+p+u));const f=Mo(t.timeZone,t),h=f>0?Math.floor(f):Math.ceil(f),b=-new Date(+t).getTimezoneOffset()-h,g=h!==e,x=b-c;if(g&&x){Date.prototype.setUTCMinutes.call(t,Date.prototype.getUTCMinutes.call(t)+x);const y=Mo(t.timeZone,t),E=y>0?Math.floor(y):Math.ceil(y),N=h-E;N&&(t.internal.setUTCMinutes(t.internal.getUTCMinutes()+N),Date.prototype.setUTCMinutes.call(t,Date.prototype.getUTCMinutes.call(t)+N))}}class Pa extends Ts{static tz(r,...e){return e.length?new Pa(...e,r):new Pa(Date.now(),r)}toISOString(){const[r,e,a]=this.tzComponents(),n=`${r}${e}:${a}`;return this.internal.toISOString().slice(0,-1)+n}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[r,e,a,n]=this.internal.toUTCString().split(" ");return`${r==null?void 0:r.slice(0,-1)} ${a} ${e} ${n}`}toTimeString(){const r=this.internal.toUTCString().split(" ")[4],[e,a,n]=this.tzComponents();return`${r} GMT${e}${a}${n} (${sE(this.timeZone,this)})`}toLocaleString(r,e){return Date.prototype.toLocaleString.call(this,r,{...e,timeZone:(e==null?void 0:e.timeZone)||this.timeZone})}toLocaleDateString(r,e){return Date.prototype.toLocaleDateString.call(this,r,{...e,timeZone:(e==null?void 0:e.timeZone)||this.timeZone})}toLocaleTimeString(r,e){return Date.prototype.toLocaleTimeString.call(this,r,{...e,timeZone:(e==null?void 0:e.timeZone)||this.timeZone})}tzComponents(){const r=this.getTimezoneOffset(),e=r>0?"-":"+",a=String(Math.floor(Math.abs(r)/60)).padStart(2,"0"),n=String(Math.abs(r)%60).padStart(2,"0");return[e,a,n]}withTimeZone(r){return new Pa(+this,r)}[Symbol.for("constructDateFrom")](r){return new Pa(+new Date(r),this.timeZone)}}const lw=6048e5,lE=864e5,lx=Symbol.for("constructDateFrom");function da(t,r){return typeof t=="function"?t(r):t&&typeof t=="object"&&lx in t?t[lx](r):t instanceof Date?new t.constructor(r):new Date(r)}function Sr(t,r){return da(r||t,t)}function ym(t,r,e){const a=Sr(t,e==null?void 0:e.in);return isNaN(r)?da(t,NaN):(r&&a.setDate(a.getDate()+r),a)}function wm(t,r,e){const a=Sr(t,e==null?void 0:e.in);if(isNaN(r))return da(t,NaN);if(!r)return a;const n=a.getDate(),o=da(t,a.getTime());o.setMonth(a.getMonth()+r+1,0);const s=o.getDate();return n>=s?o:(a.setFullYear(o.getFullYear(),o.getMonth(),n),a)}let cE={};function Vu(){return cE}function Ji(t,r){var l,c,i,u;const e=Vu(),a=(r==null?void 0:r.weekStartsOn)??((c=(l=r==null?void 0:r.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??e.weekStartsOn??((u=(i=e.locale)==null?void 0:i.options)==null?void 0:u.weekStartsOn)??0,n=Sr(t,r==null?void 0:r.in),o=n.getDay(),s=(o<a?7:0)+o-a;return n.setDate(n.getDate()-s),n.setHours(0,0,0,0),n}function Su(t,r){return Ji(t,{...r,weekStartsOn:1})}function cw(t,r){const e=Sr(t,r==null?void 0:r.in),a=e.getFullYear(),n=da(e,0);n.setFullYear(a+1,0,4),n.setHours(0,0,0,0);const o=Su(n),s=da(e,0);s.setFullYear(a,0,4),s.setHours(0,0,0,0);const l=Su(s);return e.getTime()>=o.getTime()?a+1:e.getTime()>=l.getTime()?a:a-1}function cx(t){const r=Sr(t),e=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return e.setUTCFullYear(r.getFullYear()),+t-+e}function tc(t,...r){const e=da.bind(null,r.find(a=>typeof a=="object"));return r.map(e)}function Ki(t,r){const e=Sr(t,r==null?void 0:r.in);return e.setHours(0,0,0,0),e}function _m(t,r,e){const[a,n]=tc(e==null?void 0:e.in,t,r),o=Ki(a),s=Ki(n),l=+o-cx(o),c=+s-cx(s);return Math.round((l-c)/lE)}function uE(t,r){const e=cw(t,r),a=da(t,0);return a.setFullYear(e,0,4),a.setHours(0,0,0,0),Su(a)}function uw(t,r,e){return ym(t,r*7,e)}function dE(t,r,e){return wm(t,r*12,e)}function fE(t,r){let e,a=r==null?void 0:r.in;return t.forEach(n=>{!a&&typeof n=="object"&&(a=da.bind(null,n));const o=Sr(n,a);(!e||e<o||isNaN(+o))&&(e=o)}),da(a,e||NaN)}function hE(t,r){let e,a=r==null?void 0:r.in;return t.forEach(n=>{!a&&typeof n=="object"&&(a=da.bind(null,n));const o=Sr(n,a);(!e||e>o||isNaN(+o))&&(e=o)}),da(a,e||NaN)}function pE(t,r,e){const[a,n]=tc(e==null?void 0:e.in,t,r);return+Ki(a)==+Ki(n)}function dw(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function mE(t){return!(!dw(t)&&typeof t!="number"||isNaN(+Sr(t)))}function fw(t,r,e){const[a,n]=tc(e==null?void 0:e.in,t,r),o=a.getFullYear()-n.getFullYear(),s=a.getMonth()-n.getMonth();return o*12+s}function ap(t,r){const e=Sr(t,r==null?void 0:r.in);return e.setHours(23,59,59,999),e}function Pp(t,r){const e=Sr(t,r==null?void 0:r.in),a=e.getMonth();return e.setFullYear(e.getFullYear(),a+1,0),e.setHours(23,59,59,999),e}function hw(t,r){const[e,a]=tc(t,r.start,r.end);return{start:e,end:a}}function gE(t,r){const{start:e,end:a}=hw(r==null?void 0:r.in,t);let n=+e>+a;const o=n?+e:+a,s=n?a:e;s.setHours(0,0,0,0),s.setDate(1);let l=1;const c=[];for(;+s<=o;)c.push(da(e,s)),s.setMonth(s.getMonth()+l);return n?c.reverse():c}function vE(t,r){const e=Sr(t,r==null?void 0:r.in),a=e.getMonth(),n=a-a%3;return e.setMonth(n,1),e.setHours(0,0,0,0),e}function Lp(t,r){const e=Sr(t,r==null?void 0:r.in);return e.setDate(1),e.setHours(0,0,0,0),e}function Bp(t,r){const e=Sr(t,r==null?void 0:r.in),a=e.getFullYear();return e.setFullYear(a+1,0,0),e.setHours(23,59,59,999),e}function Sm(t,r){const e=Sr(t,r==null?void 0:r.in);return e.setFullYear(e.getFullYear(),0,1),e.setHours(0,0,0,0),e}function bE(t,r){const{start:e,end:a}=hw(r==null?void 0:r.in,t);let n=+e>+a;const o=n?+e:+a,s=n?a:e;s.setHours(0,0,0,0),s.setMonth(0,1);let l=1;const c=[];for(;+s<=o;)c.push(da(e,s)),s.setFullYear(s.getFullYear()+l);return n?c.reverse():c}function kf(t,r){var l,c,i,u;const e=Vu(),a=(r==null?void 0:r.weekStartsOn)??((c=(l=r==null?void 0:r.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??e.weekStartsOn??((u=(i=e.locale)==null?void 0:i.options)==null?void 0:u.weekStartsOn)??0,n=Sr(t,r==null?void 0:r.in),o=n.getDay(),s=(o<a?-7:0)+6-(o-a);return n.setDate(n.getDate()+s),n.setHours(23,59,59,999),n}function xE(t,r){return kf(t,{...r,weekStartsOn:1})}function yE(t,r){const e=Sr(t,r==null?void 0:r.in),a=e.getMonth(),n=a-a%3+3;return e.setMonth(n,0),e.setHours(23,59,59,999),e}const wE={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},_E=(t,r,e)=>{let a;const n=wE[t];return typeof n=="string"?a=n:r===1?a=n.one:a=n.other.replace("{{count}}",r.toString()),e!=null&&e.addSuffix?e.comparison&&e.comparison>0?"in "+a:a+" ago":a};function Hl(t){return(r={})=>{const e=r.width?String(r.width):t.defaultWidth;return t.formats[e]||t.formats[t.defaultWidth]}}const SE={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},kE={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},EE={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},TE={date:Hl({formats:SE,defaultWidth:"full"}),time:Hl({formats:kE,defaultWidth:"full"}),dateTime:Hl({formats:EE,defaultWidth:"full"})},AE={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},CE=(t,r,e,a)=>AE[t];function ks(t){return(r,e)=>{const a=e!=null&&e.context?String(e.context):"standalone";let n;if(a==="formatting"&&t.formattingValues){const s=t.defaultFormattingWidth||t.defaultWidth,l=e!=null&&e.width?String(e.width):s;n=t.formattingValues[l]||t.formattingValues[s]}else{const s=t.defaultWidth,l=e!=null&&e.width?String(e.width):t.defaultWidth;n=t.values[l]||t.values[s]}const o=t.argumentCallback?t.argumentCallback(r):r;return n[o]}}const NE={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},jE={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},OE={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},DE={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},ME={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},RE={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},IE=(t,r)=>{const e=Number(t),a=e%100;if(a>20||a<10)switch(a%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"},FE={ordinalNumber:IE,era:ks({values:NE,defaultWidth:"wide"}),quarter:ks({values:jE,defaultWidth:"wide",argumentCallback:t=>t-1}),month:ks({values:OE,defaultWidth:"wide"}),day:ks({values:DE,defaultWidth:"wide"}),dayPeriod:ks({values:ME,defaultWidth:"wide",formattingValues:RE,defaultFormattingWidth:"wide"})};function Es(t){return(r,e={})=>{const a=e.width,n=a&&t.matchPatterns[a]||t.matchPatterns[t.defaultMatchWidth],o=r.match(n);if(!o)return null;const s=o[0],l=a&&t.parsePatterns[a]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?LE(l,p=>p.test(s)):PE(l,p=>p.test(s));let i;i=t.valueCallback?t.valueCallback(c):c,i=e.valueCallback?e.valueCallback(i):i;const u=r.slice(s.length);return{value:i,rest:u}}}function PE(t,r){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&r(t[e]))return e}function LE(t,r){for(let e=0;e<t.length;e++)if(r(t[e]))return e}function pw(t){return(r,e={})=>{const a=r.match(t.matchPattern);if(!a)return null;const n=a[0],o=r.match(t.parsePattern);if(!o)return null;let s=t.valueCallback?t.valueCallback(o[0]):o[0];s=e.valueCallback?e.valueCallback(s):s;const l=r.slice(n.length);return{value:s,rest:l}}}const BE=/^(\d+)(th|st|nd|rd)?/i,UE=/\d+/i,zE={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},$E={any:[/^b/i,/^(a|c)/i]},VE={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},HE={any:[/1/i,/2/i,/3/i,/4/i]},qE={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},WE={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},GE={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},YE={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},XE={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},KE={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},ZE={ordinalNumber:pw({matchPattern:BE,parsePattern:UE,valueCallback:t=>parseInt(t,10)}),era:Es({matchPatterns:zE,defaultMatchWidth:"wide",parsePatterns:$E,defaultParseWidth:"any"}),quarter:Es({matchPatterns:VE,defaultMatchWidth:"wide",parsePatterns:HE,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Es({matchPatterns:qE,defaultMatchWidth:"wide",parsePatterns:WE,defaultParseWidth:"any"}),day:Es({matchPatterns:GE,defaultMatchWidth:"wide",parsePatterns:YE,defaultParseWidth:"any"}),dayPeriod:Es({matchPatterns:XE,defaultMatchWidth:"any",parsePatterns:KE,defaultParseWidth:"any"})},Il={code:"en-US",formatDistance:_E,formatLong:TE,formatRelative:CE,localize:FE,match:ZE,options:{weekStartsOn:0,firstWeekContainsDate:1}};function JE(t,r){const e=Sr(t,r==null?void 0:r.in);return _m(e,Sm(e))+1}function km(t,r){const e=Sr(t,r==null?void 0:r.in),a=+Su(e)-+uE(e);return Math.round(a/lw)+1}function mw(t,r){var u,p,f,h;const e=Sr(t,r==null?void 0:r.in),a=e.getFullYear(),n=Vu(),o=(r==null?void 0:r.firstWeekContainsDate)??((p=(u=r==null?void 0:r.locale)==null?void 0:u.options)==null?void 0:p.firstWeekContainsDate)??n.firstWeekContainsDate??((h=(f=n.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,s=da((r==null?void 0:r.in)||t,0);s.setFullYear(a+1,0,o),s.setHours(0,0,0,0);const l=Ji(s,r),c=da((r==null?void 0:r.in)||t,0);c.setFullYear(a,0,o),c.setHours(0,0,0,0);const i=Ji(c,r);return+e>=+l?a+1:+e>=+i?a:a-1}function QE(t,r){var l,c,i,u;const e=Vu(),a=(r==null?void 0:r.firstWeekContainsDate)??((c=(l=r==null?void 0:r.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??e.firstWeekContainsDate??((u=(i=e.locale)==null?void 0:i.options)==null?void 0:u.firstWeekContainsDate)??1,n=mw(t,r),o=da((r==null?void 0:r.in)||t,0);return o.setFullYear(n,0,a),o.setHours(0,0,0,0),Ji(o,r)}function Em(t,r){const e=Sr(t,r==null?void 0:r.in),a=+Ji(e,r)-+QE(e,r);return Math.round(a/lw)+1}function Ar(t,r){const e=t<0?"-":"",a=Math.abs(t).toString().padStart(r,"0");return e+a}const Ui={y(t,r){const e=t.getFullYear(),a=e>0?e:1-e;return Ar(r==="yy"?a%100:a,r.length)},M(t,r){const e=t.getMonth();return r==="M"?String(e+1):Ar(e+1,2)},d(t,r){return Ar(t.getDate(),r.length)},a(t,r){const e=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return e.toUpperCase();case"aaa":return e;case"aaaaa":return e[0];case"aaaa":default:return e==="am"?"a.m.":"p.m."}},h(t,r){return Ar(t.getHours()%12||12,r.length)},H(t,r){return Ar(t.getHours(),r.length)},m(t,r){return Ar(t.getMinutes(),r.length)},s(t,r){return Ar(t.getSeconds(),r.length)},S(t,r){const e=r.length,a=t.getMilliseconds(),n=Math.trunc(a*Math.pow(10,e-3));return Ar(n,r.length)}},Sl={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},ux={G:function(t,r,e){const a=t.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return e.era(a,{width:"abbreviated"});case"GGGGG":return e.era(a,{width:"narrow"});case"GGGG":default:return e.era(a,{width:"wide"})}},y:function(t,r,e){if(r==="yo"){const a=t.getFullYear(),n=a>0?a:1-a;return e.ordinalNumber(n,{unit:"year"})}return Ui.y(t,r)},Y:function(t,r,e,a){const n=mw(t,a),o=n>0?n:1-n;if(r==="YY"){const s=o%100;return Ar(s,2)}return r==="Yo"?e.ordinalNumber(o,{unit:"year"}):Ar(o,r.length)},R:function(t,r){const e=cw(t);return Ar(e,r.length)},u:function(t,r){const e=t.getFullYear();return Ar(e,r.length)},Q:function(t,r,e){const a=Math.ceil((t.getMonth()+1)/3);switch(r){case"Q":return String(a);case"QQ":return Ar(a,2);case"Qo":return e.ordinalNumber(a,{unit:"quarter"});case"QQQ":return e.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return e.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return e.quarter(a,{width:"wide",context:"formatting"})}},q:function(t,r,e){const a=Math.ceil((t.getMonth()+1)/3);switch(r){case"q":return String(a);case"qq":return Ar(a,2);case"qo":return e.ordinalNumber(a,{unit:"quarter"});case"qqq":return e.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return e.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return e.quarter(a,{width:"wide",context:"standalone"})}},M:function(t,r,e){const a=t.getMonth();switch(r){case"M":case"MM":return Ui.M(t,r);case"Mo":return e.ordinalNumber(a+1,{unit:"month"});case"MMM":return e.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return e.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return e.month(a,{width:"wide",context:"formatting"})}},L:function(t,r,e){const a=t.getMonth();switch(r){case"L":return String(a+1);case"LL":return Ar(a+1,2);case"Lo":return e.ordinalNumber(a+1,{unit:"month"});case"LLL":return e.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return e.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return e.month(a,{width:"wide",context:"standalone"})}},w:function(t,r,e,a){const n=Em(t,a);return r==="wo"?e.ordinalNumber(n,{unit:"week"}):Ar(n,r.length)},I:function(t,r,e){const a=km(t);return r==="Io"?e.ordinalNumber(a,{unit:"week"}):Ar(a,r.length)},d:function(t,r,e){return r==="do"?e.ordinalNumber(t.getDate(),{unit:"date"}):Ui.d(t,r)},D:function(t,r,e){const a=JE(t);return r==="Do"?e.ordinalNumber(a,{unit:"dayOfYear"}):Ar(a,r.length)},E:function(t,r,e){const a=t.getDay();switch(r){case"E":case"EE":case"EEE":return e.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return e.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return e.day(a,{width:"short",context:"formatting"});case"EEEE":default:return e.day(a,{width:"wide",context:"formatting"})}},e:function(t,r,e,a){const n=t.getDay(),o=(n-a.weekStartsOn+8)%7||7;switch(r){case"e":return String(o);case"ee":return Ar(o,2);case"eo":return e.ordinalNumber(o,{unit:"day"});case"eee":return e.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return e.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return e.day(n,{width:"short",context:"formatting"});case"eeee":default:return e.day(n,{width:"wide",context:"formatting"})}},c:function(t,r,e,a){const n=t.getDay(),o=(n-a.weekStartsOn+8)%7||7;switch(r){case"c":return String(o);case"cc":return Ar(o,r.length);case"co":return e.ordinalNumber(o,{unit:"day"});case"ccc":return e.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return e.day(n,{width:"narrow",context:"standalone"});case"cccccc":return e.day(n,{width:"short",context:"standalone"});case"cccc":default:return e.day(n,{width:"wide",context:"standalone"})}},i:function(t,r,e){const a=t.getDay(),n=a===0?7:a;switch(r){case"i":return String(n);case"ii":return Ar(n,r.length);case"io":return e.ordinalNumber(n,{unit:"day"});case"iii":return e.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return e.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return e.day(a,{width:"short",context:"formatting"});case"iiii":default:return e.day(a,{width:"wide",context:"formatting"})}},a:function(t,r,e){const n=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return e.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return e.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return e.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return e.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(t,r,e){const a=t.getHours();let n;switch(a===12?n=Sl.noon:a===0?n=Sl.midnight:n=a/12>=1?"pm":"am",r){case"b":case"bb":return e.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return e.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return e.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return e.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(t,r,e){const a=t.getHours();let n;switch(a>=17?n=Sl.evening:a>=12?n=Sl.afternoon:a>=4?n=Sl.morning:n=Sl.night,r){case"B":case"BB":case"BBB":return e.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return e.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return e.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(t,r,e){if(r==="ho"){let a=t.getHours()%12;return a===0&&(a=12),e.ordinalNumber(a,{unit:"hour"})}return Ui.h(t,r)},H:function(t,r,e){return r==="Ho"?e.ordinalNumber(t.getHours(),{unit:"hour"}):Ui.H(t,r)},K:function(t,r,e){const a=t.getHours()%12;return r==="Ko"?e.ordinalNumber(a,{unit:"hour"}):Ar(a,r.length)},k:function(t,r,e){let a=t.getHours();return a===0&&(a=24),r==="ko"?e.ordinalNumber(a,{unit:"hour"}):Ar(a,r.length)},m:function(t,r,e){return r==="mo"?e.ordinalNumber(t.getMinutes(),{unit:"minute"}):Ui.m(t,r)},s:function(t,r,e){return r==="so"?e.ordinalNumber(t.getSeconds(),{unit:"second"}):Ui.s(t,r)},S:function(t,r){return Ui.S(t,r)},X:function(t,r,e){const a=t.getTimezoneOffset();if(a===0)return"Z";switch(r){case"X":return fx(a);case"XXXX":case"XX":return Co(a);case"XXXXX":case"XXX":default:return Co(a,":")}},x:function(t,r,e){const a=t.getTimezoneOffset();switch(r){case"x":return fx(a);case"xxxx":case"xx":return Co(a);case"xxxxx":case"xxx":default:return Co(a,":")}},O:function(t,r,e){const a=t.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+dx(a,":");case"OOOO":default:return"GMT"+Co(a,":")}},z:function(t,r,e){const a=t.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+dx(a,":");case"zzzz":default:return"GMT"+Co(a,":")}},t:function(t,r,e){const a=Math.trunc(+t/1e3);return Ar(a,r.length)},T:function(t,r,e){return Ar(+t,r.length)}};function dx(t,r=""){const e=t>0?"-":"+",a=Math.abs(t),n=Math.trunc(a/60),o=a%60;return o===0?e+String(n):e+String(n)+r+Ar(o,2)}function fx(t,r){return t%60===0?(t>0?"-":"+")+Ar(Math.abs(t)/60,2):Co(t,r)}function Co(t,r=""){const e=t>0?"-":"+",a=Math.abs(t),n=Ar(Math.trunc(a/60),2),o=Ar(a%60,2);return e+n+r+o}const hx=(t,r)=>{switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},gw=(t,r)=>{switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},eT=(t,r)=>{const e=t.match(/(P+)(p+)?/)||[],a=e[1],n=e[2];if(!n)return hx(t,r);let o;switch(a){case"P":o=r.dateTime({width:"short"});break;case"PP":o=r.dateTime({width:"medium"});break;case"PPP":o=r.dateTime({width:"long"});break;case"PPPP":default:o=r.dateTime({width:"full"});break}return o.replace("{{date}}",hx(a,r)).replace("{{time}}",gw(n,r))},tT={p:gw,P:eT},rT=/^D+$/,aT=/^Y+$/,nT=["D","DD","YY","YYYY"];function sT(t){return rT.test(t)}function iT(t){return aT.test(t)}function oT(t,r,e){const a=lT(t,r,e);if(console.warn(a),nT.includes(t))throw new RangeError(a)}function lT(t,r,e){const a=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${r}\`) for formatting ${a} to the input \`${e}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const cT=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,uT=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,dT=/^'([^]*?)'?$/,fT=/''/g,hT=/[a-zA-Z]/;function Xt(t,r,e){var u,p,f,h,v,b,g,x;const a=Vu(),n=(e==null?void 0:e.locale)??a.locale??Il,o=(e==null?void 0:e.firstWeekContainsDate)??((p=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:p.firstWeekContainsDate)??a.firstWeekContainsDate??((h=(f=a.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,s=(e==null?void 0:e.weekStartsOn)??((b=(v=e==null?void 0:e.locale)==null?void 0:v.options)==null?void 0:b.weekStartsOn)??a.weekStartsOn??((x=(g=a.locale)==null?void 0:g.options)==null?void 0:x.weekStartsOn)??0,l=Sr(t,e==null?void 0:e.in);if(!mE(l))throw new RangeError("Invalid time value");let c=r.match(uT).map(y=>{const E=y[0];if(E==="p"||E==="P"){const N=tT[E];return N(y,n.formatLong)}return y}).join("").match(cT).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const E=y[0];if(E==="'")return{isToken:!1,value:pT(y)};if(ux[E])return{isToken:!0,value:y};if(E.match(hT))throw new RangeError("Format string contains an unescaped latin alphabet character `"+E+"`");return{isToken:!1,value:y}});n.localize.preprocessor&&(c=n.localize.preprocessor(l,c));const i={firstWeekContainsDate:o,weekStartsOn:s,locale:n};return c.map(y=>{if(!y.isToken)return y.value;const E=y.value;(!(e!=null&&e.useAdditionalWeekYearTokens)&&iT(E)||!(e!=null&&e.useAdditionalDayOfYearTokens)&&sT(E))&&oT(E,r,String(t));const N=ux[E[0]];return N(l,E,n.localize,i)}).join("")}function pT(t){const r=t.match(dT);return r?r[1].replace(fT,"'"):t}function mT(t,r){const e=Sr(t,r==null?void 0:r.in),a=e.getFullYear(),n=e.getMonth(),o=da(e,0);return o.setFullYear(a,n+1,0),o.setHours(0,0,0,0),o.getDate()}function gT(t,r){return Sr(t,r==null?void 0:r.in).getMonth()}function vT(t,r){return Sr(t,r==null?void 0:r.in).getFullYear()}function bT(t,r){return+Sr(t)>+Sr(r)}function xT(t,r){return+Sr(t)<+Sr(r)}function yT(t,r,e){const[a,n]=tc(e==null?void 0:e.in,t,r);return a.getFullYear()===n.getFullYear()&&a.getMonth()===n.getMonth()}function wT(t,r,e){const[a,n]=tc(e==null?void 0:e.in,t,r);return a.getFullYear()===n.getFullYear()}function _T(t,r,e){return ym(t,-1,e)}function ST(t,r,e){const a=Sr(t,e==null?void 0:e.in),n=a.getFullYear(),o=a.getDate(),s=da(t,0);s.setFullYear(n,r,15),s.setHours(0,0,0,0);const l=mT(s);return a.setMonth(r,Math.min(o,l)),a}function kT(t,r,e){const a=Sr(t,e==null?void 0:e.in);return isNaN(+a)?da(t,NaN):(a.setFullYear(r),a)}function ET(t,r,e){return wm(t,-1,e)}function TT(t,r,e){return uw(t,-1,e)}const px=5,AT=4;function CT(t,r){const e=r.startOfMonth(t),a=e.getDay()>0?e.getDay():7,n=r.addDays(t,-a+1),o=r.addDays(n,px*7-1);return r.getMonth(t)===r.getMonth(o)?px:AT}function vw(t,r){const e=r.startOfMonth(t),a=e.getDay();return a===1?e:a===0?r.addDays(e,-1*6):r.addDays(e,-1*(a-1))}function NT(t,r){const e=vw(t,r),a=CT(t,r);return r.addDays(e,a*7-1)}const jT={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 ms",other:"cerca de {{count}} meses"},xMonths:{one:"1 ms",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},OT=(t,r,e)=>{let a;const n=jT[t];return typeof n=="string"?a=n:r===1?a=n.one:a=n.other.replace("{{count}}",String(r)),e!=null&&e.addSuffix?e.comparison&&e.comparison>0?"em "+a:"h "+a:a},DT={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},MT={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},RT={full:"{{date}} 's' {{time}}",long:"{{date}} 's' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},IT={date:Hl({formats:DT,defaultWidth:"full"}),time:Hl({formats:MT,defaultWidth:"full"}),dateTime:Hl({formats:RT,defaultWidth:"full"})},FT={lastWeek:t=>{const r=t.getDay();return"'"+(r===0||r===6?"ltimo":"ltima")+"' eeee 's' p"},yesterday:"'ontem s' p",today:"'hoje s' p",tomorrow:"'amanh s' p",nextWeek:"eeee 's' p",other:"P"},PT=(t,r,e,a)=>{const n=FT[t];return typeof n=="function"?n(r):n},LT={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},BT={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},UT={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},zT={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","tera","quarta","quinta","sexta","sbado"],wide:["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"]},$T={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"}},VT={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},HT=(t,r)=>{const e=Number(t);return(r==null?void 0:r.unit)==="week"?e+"":e+""},qT={ordinalNumber:HT,era:ks({values:LT,defaultWidth:"wide"}),quarter:ks({values:BT,defaultWidth:"wide",argumentCallback:t=>t-1}),month:ks({values:UT,defaultWidth:"wide"}),day:ks({values:zT,defaultWidth:"wide"}),dayPeriod:ks({values:$T,defaultWidth:"wide",formattingValues:VT,defaultFormattingWidth:"wide"})},WT=/^(\d+)[o]?/i,GT=/\d+/i,YT={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},XT={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},KT={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},ZT={any:[/1/i,/2/i,/3/i,/4/i]},JT={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|maro|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},QT={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},eA={narrow:/^(dom|[23456]?|s[a]b)/i,short:/^(dom|[23456]?|s[a]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a]b)/i,wide:/^(domingo|(segunda|ter[c]a|quarta|quinta|sexta)([- ]feira)?|s[a]bado)/i},tA={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a]b/i]},rA={narrow:/^(a|p|mn|md|(da) (manh|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh|tarde|noite))/i},aA={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},nA={ordinalNumber:pw({matchPattern:WT,parsePattern:GT,valueCallback:t=>parseInt(t,10)}),era:Es({matchPatterns:YT,defaultMatchWidth:"wide",parsePatterns:XT,defaultParseWidth:"any"}),quarter:Es({matchPatterns:KT,defaultMatchWidth:"wide",parsePatterns:ZT,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Es({matchPatterns:JT,defaultMatchWidth:"wide",parsePatterns:QT,defaultParseWidth:"any"}),day:Es({matchPatterns:eA,defaultMatchWidth:"wide",parsePatterns:tA,defaultParseWidth:"any"}),dayPeriod:Es({matchPatterns:rA,defaultMatchWidth:"any",parsePatterns:aA,defaultParseWidth:"any"})},yr={code:"pt-BR",formatDistance:OT,formatLong:IT,formatRelative:PT,localize:qT,match:nA,options:{weekStartsOn:0,firstWeekContainsDate:1}},bw={...Il,labels:{labelDayButton:(t,r,e,a)=>{let n;a&&typeof a.format=="function"?n=a.format.bind(a):n=(s,l)=>Xt(s,l,{locale:Il,...e});let o=n(t,"PPPP");return r.today&&(o=`Today, ${o}`),r.selected&&(o=`${o}, selected`),o},labelMonthDropdown:"Choose the Month",labelNext:"Go to the Next Month",labelPrevious:"Go to the Previous Month",labelWeekNumber:t=>`Week ${t}`,labelYearDropdown:"Choose the Year",labelGrid:(t,r,e)=>{let a;return e&&typeof e.format=="function"?a=e.format.bind(e):a=(n,o)=>Xt(n,o,{locale:Il,...r}),a(t,"LLLL yyyy")},labelGridcell:(t,r,e,a)=>{let n;a&&typeof a.format=="function"?n=a.format.bind(a):n=(s,l)=>Xt(s,l,{locale:Il,...e});let o=n(t,"PPPP");return r!=null&&r.today&&(o=`Today, ${o}`),o},labelNav:"Navigation bar",labelWeekNumberHeader:"Week Number",labelWeekday:(t,r,e)=>{let a;return e&&typeof e.format=="function"?a=e.format.bind(e):a=(n,o)=>Xt(n,o,{locale:Il,...r}),a(t,"cccc")}}};class En{constructor(r,e){this.Date=Date,this.today=()=>{var a;return(a=this.overrides)!=null&&a.today?this.overrides.today():this.options.timeZone?Pa.tz(this.options.timeZone):new this.Date},this.newDate=(a,n,o)=>{var s;return(s=this.overrides)!=null&&s.newDate?this.overrides.newDate(a,n,o):this.options.timeZone?new Pa(a,n,o,this.options.timeZone):new Date(a,n,o)},this.addDays=(a,n)=>{var o;return(o=this.overrides)!=null&&o.addDays?this.overrides.addDays(a,n):ym(a,n)},this.addMonths=(a,n)=>{var o;return(o=this.overrides)!=null&&o.addMonths?this.overrides.addMonths(a,n):wm(a,n)},this.addWeeks=(a,n)=>{var o;return(o=this.overrides)!=null&&o.addWeeks?this.overrides.addWeeks(a,n):uw(a,n)},this.addYears=(a,n)=>{var o;return(o=this.overrides)!=null&&o.addYears?this.overrides.addYears(a,n):dE(a,n)},this.differenceInCalendarDays=(a,n)=>{var o;return(o=this.overrides)!=null&&o.differenceInCalendarDays?this.overrides.differenceInCalendarDays(a,n):_m(a,n)},this.differenceInCalendarMonths=(a,n)=>{var o;return(o=this.overrides)!=null&&o.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(a,n):fw(a,n)},this.eachMonthOfInterval=a=>{var n;return(n=this.overrides)!=null&&n.eachMonthOfInterval?this.overrides.eachMonthOfInterval(a):gE(a)},this.eachYearOfInterval=a=>{var l;const n=(l=this.overrides)!=null&&l.eachYearOfInterval?this.overrides.eachYearOfInterval(a):bE(a),o=new Set(n.map(c=>this.getYear(c)));if(o.size===n.length)return n;const s=[];return o.forEach(c=>{s.push(new Date(c,0,1))}),s},this.endOfBroadcastWeek=a=>{var n;return(n=this.overrides)!=null&&n.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(a):NT(a,this)},this.endOfISOWeek=a=>{var n;return(n=this.overrides)!=null&&n.endOfISOWeek?this.overrides.endOfISOWeek(a):xE(a)},this.endOfMonth=a=>{var n;return(n=this.overrides)!=null&&n.endOfMonth?this.overrides.endOfMonth(a):Pp(a)},this.endOfWeek=(a,n)=>{var o;return(o=this.overrides)!=null&&o.endOfWeek?this.overrides.endOfWeek(a,n):kf(a,this.options)},this.endOfYear=a=>{var n;return(n=this.overrides)!=null&&n.endOfYear?this.overrides.endOfYear(a):Bp(a)},this.format=(a,n,o)=>{var l;const s=(l=this.overrides)!=null&&l.format?this.overrides.format(a,n,this.options):Xt(a,n,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(s):s},this.getISOWeek=a=>{var n;return(n=this.overrides)!=null&&n.getISOWeek?this.overrides.getISOWeek(a):km(a)},this.getMonth=(a,n)=>{var o;return(o=this.overrides)!=null&&o.getMonth?this.overrides.getMonth(a,this.options):gT(a,this.options)},this.getYear=(a,n)=>{var o;return(o=this.overrides)!=null&&o.getYear?this.overrides.getYear(a,this.options):vT(a,this.options)},this.getWeek=(a,n)=>{var o;return(o=this.overrides)!=null&&o.getWeek?this.overrides.getWeek(a,this.options):Em(a,this.options)},this.isAfter=(a,n)=>{var o;return(o=this.overrides)!=null&&o.isAfter?this.overrides.isAfter(a,n):bT(a,n)},this.isBefore=(a,n)=>{var o;return(o=this.overrides)!=null&&o.isBefore?this.overrides.isBefore(a,n):xT(a,n)},this.isDate=a=>{var n;return(n=this.overrides)!=null&&n.isDate?this.overrides.isDate(a):dw(a)},this.isSameDay=(a,n)=>{var o;return(o=this.overrides)!=null&&o.isSameDay?this.overrides.isSameDay(a,n):pE(a,n)},this.isSameMonth=(a,n)=>{var o;return(o=this.overrides)!=null&&o.isSameMonth?this.overrides.isSameMonth(a,n):yT(a,n)},this.isSameYear=(a,n)=>{var o;return(o=this.overrides)!=null&&o.isSameYear?this.overrides.isSameYear(a,n):wT(a,n)},this.max=a=>{var n;return(n=this.overrides)!=null&&n.max?this.overrides.max(a):fE(a)},this.min=a=>{var n;return(n=this.overrides)!=null&&n.min?this.overrides.min(a):hE(a)},this.setMonth=(a,n)=>{var o;return(o=this.overrides)!=null&&o.setMonth?this.overrides.setMonth(a,n):ST(a,n)},this.setYear=(a,n)=>{var o;return(o=this.overrides)!=null&&o.setYear?this.overrides.setYear(a,n):kT(a,n)},this.startOfBroadcastWeek=(a,n)=>{var o;return(o=this.overrides)!=null&&o.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(a,this):vw(a,this)},this.startOfDay=a=>{var n;return(n=this.overrides)!=null&&n.startOfDay?this.overrides.startOfDay(a):Ki(a)},this.startOfISOWeek=a=>{var n;return(n=this.overrides)!=null&&n.startOfISOWeek?this.overrides.startOfISOWeek(a):Su(a)},this.startOfMonth=a=>{var n;return(n=this.overrides)!=null&&n.startOfMonth?this.overrides.startOfMonth(a):Lp(a)},this.startOfWeek=(a,n)=>{var o;return(o=this.overrides)!=null&&o.startOfWeek?this.overrides.startOfWeek(a,this.options):Ji(a,this.options)},this.startOfYear=a=>{var n;return(n=this.overrides)!=null&&n.startOfYear?this.overrides.startOfYear(a):Sm(a)},this.options={locale:bw,...r},this.overrides=e}getDigitMap(){const{numerals:r="latn"}=this.options,e=new Intl.NumberFormat("en-US",{numberingSystem:r}),a={};for(let n=0;n<10;n++)a[n.toString()]=e.format(n);return a}replaceDigits(r){const e=this.getDigitMap();return r.replace(/\d/g,a=>e[a]||a)}formatNumber(r){return this.replaceDigits(r.toString())}getMonthYearOrder(){var e;const r=(e=this.options.locale)==null?void 0:e.code;return r&&En.yearFirstLocales.has(r)?"year-first":"month-first"}formatMonthYear(r){const{locale:e,timeZone:a,numerals:n}=this.options,o=e==null?void 0:e.code;if(o&&En.yearFirstLocales.has(o))try{return new Intl.DateTimeFormat(o,{month:"long",year:"numeric",timeZone:a,numberingSystem:n}).format(r)}catch{}const s=this.getMonthYearOrder()==="year-first"?"y LLLL":"LLLL y";return this.format(r,s)}}En.yearFirstLocales=new Set(["eu","hu","ja","ja-Hira","ja-JP","ko","ko-KR","lt","lt-LT","lv","lv-LV","mn","mn-MN","zh","zh-CN","zh-HK","zh-TW"]);const Rs=new En;class xw{constructor(r,e,a=Rs){this.date=r,this.displayMonth=e,this.outside=!!(e&&!a.isSameMonth(r,e)),this.dateLib=a,this.isoDate=a.format(r,"yyyy-MM-dd"),this.displayMonthId=a.format(e,"yyyy-MM"),this.dateMonthId=a.format(r,"yyyy-MM")}isEqualTo(r){return this.dateLib.isSameDay(r.date,this.date)&&this.dateLib.isSameMonth(r.displayMonth,this.displayMonth)}}class sA{constructor(r,e){this.date=r,this.weeks=e}}class iA{constructor(r,e){this.days=e,this.weekNumber=r}}function oA(t){return Xe.createElement("button",{...t})}function lA(t){return Xe.createElement("span",{...t})}function cA(t){const{size:r=24,orientation:e="left",className:a}=t;return Xe.createElement("svg",{className:a,width:r,height:r,viewBox:"0 0 24 24"},e==="up"&&Xe.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),e==="down"&&Xe.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),e==="left"&&Xe.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),e==="right"&&Xe.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function uA(t){const{day:r,modifiers:e,...a}=t;return Xe.createElement("td",{...a})}function dA(t){const{day:r,modifiers:e,...a}=t,n=Xe.useRef(null);return Xe.useEffect(()=>{var o;e.focused&&((o=n.current)==null||o.focus())},[e.focused]),Xe.createElement("button",{ref:n,...a})}var $t;(function(t){t.Root="root",t.Chevron="chevron",t.Day="day",t.DayButton="day_button",t.CaptionLabel="caption_label",t.Dropdowns="dropdowns",t.Dropdown="dropdown",t.DropdownRoot="dropdown_root",t.Footer="footer",t.MonthGrid="month_grid",t.MonthCaption="month_caption",t.MonthsDropdown="months_dropdown",t.Month="month",t.Months="months",t.Nav="nav",t.NextMonthButton="button_next",t.PreviousMonthButton="button_previous",t.Week="week",t.Weeks="weeks",t.Weekday="weekday",t.Weekdays="weekdays",t.WeekNumber="week_number",t.WeekNumberHeader="week_number_header",t.YearsDropdown="years_dropdown"})($t||($t={}));var Vr;(function(t){t.disabled="disabled",t.hidden="hidden",t.outside="outside",t.focused="focused",t.today="today"})(Vr||(Vr={}));var os;(function(t){t.range_end="range_end",t.range_middle="range_middle",t.range_start="range_start",t.selected="selected"})(os||(os={}));var bn;(function(t){t.weeks_before_enter="weeks_before_enter",t.weeks_before_exit="weeks_before_exit",t.weeks_after_enter="weeks_after_enter",t.weeks_after_exit="weeks_after_exit",t.caption_after_enter="caption_after_enter",t.caption_after_exit="caption_after_exit",t.caption_before_enter="caption_before_enter",t.caption_before_exit="caption_before_exit"})(bn||(bn={}));function fA(t){const{options:r,className:e,components:a,classNames:n,...o}=t,s=[n[$t.Dropdown],e].join(" "),l=r==null?void 0:r.find(({value:c})=>c===o.value);return Xe.createElement("span",{"data-disabled":o.disabled,className:n[$t.DropdownRoot]},Xe.createElement(a.Select,{className:s,...o},r==null?void 0:r.map(({value:c,label:i,disabled:u})=>Xe.createElement(a.Option,{key:c,value:c,disabled:u},i))),Xe.createElement("span",{className:n[$t.CaptionLabel],"aria-hidden":!0},l==null?void 0:l.label,Xe.createElement(a.Chevron,{orientation:"down",size:18,className:n[$t.Chevron]})))}function hA(t){return Xe.createElement("div",{...t})}function pA(t){return Xe.createElement("div",{...t})}function mA(t){const{calendarMonth:r,displayIndex:e,...a}=t;return Xe.createElement("div",{...a},t.children)}function gA(t){const{calendarMonth:r,displayIndex:e,...a}=t;return Xe.createElement("div",{...a})}function vA(t){return Xe.createElement("table",{...t})}function bA(t){return Xe.createElement("div",{...t})}const yw=Se.createContext(void 0);function Hu(){const t=Se.useContext(yw);if(t===void 0)throw new Error("useDayPicker() must be used within a custom component.");return t}function xA(t){const{components:r}=Hu();return Xe.createElement(r.Dropdown,{...t})}function yA(t){const{onPreviousClick:r,onNextClick:e,previousMonth:a,nextMonth:n,...o}=t,{components:s,classNames:l,labels:{labelPrevious:c,labelNext:i}}=Hu(),u=Se.useCallback(f=>{n&&(e==null||e(f))},[n,e]),p=Se.useCallback(f=>{a&&(r==null||r(f))},[a,r]);return Xe.createElement("nav",{...o},Xe.createElement(s.PreviousMonthButton,{type:"button",className:l[$t.PreviousMonthButton],tabIndex:a?void 0:-1,"aria-disabled":a?void 0:!0,"aria-label":c(a),onClick:p},Xe.createElement(s.Chevron,{disabled:a?void 0:!0,className:l[$t.Chevron],orientation:"left"})),Xe.createElement(s.NextMonthButton,{type:"button",className:l[$t.NextMonthButton],tabIndex:n?void 0:-1,"aria-disabled":n?void 0:!0,"aria-label":i(n),onClick:u},Xe.createElement(s.Chevron,{disabled:n?void 0:!0,orientation:"right",className:l[$t.Chevron]})))}function wA(t){const{components:r}=Hu();return Xe.createElement(r.Button,{...t})}function _A(t){return Xe.createElement("option",{...t})}function SA(t){const{components:r}=Hu();return Xe.createElement(r.Button,{...t})}function kA(t){const{rootRef:r,...e}=t;return Xe.createElement("div",{...e,ref:r})}function EA(t){return Xe.createElement("select",{...t})}function TA(t){const{week:r,...e}=t;return Xe.createElement("tr",{...e})}function AA(t){return Xe.createElement("th",{...t})}function CA(t){return Xe.createElement("thead",{"aria-hidden":!0},Xe.createElement("tr",{...t}))}function NA(t){const{week:r,...e}=t;return Xe.createElement("th",{...e})}function jA(t){return Xe.createElement("th",{...t})}function OA(t){return Xe.createElement("tbody",{...t})}function DA(t){const{components:r}=Hu();return Xe.createElement(r.Dropdown,{...t})}const MA=Object.freeze(Object.defineProperty({__proto__:null,Button:oA,CaptionLabel:lA,Chevron:cA,Day:uA,DayButton:dA,Dropdown:fA,DropdownNav:hA,Footer:pA,Month:mA,MonthCaption:gA,MonthGrid:vA,Months:bA,MonthsDropdown:xA,Nav:yA,NextMonthButton:wA,Option:_A,PreviousMonthButton:SA,Root:kA,Select:EA,Week:TA,WeekNumber:NA,WeekNumberHeader:jA,Weekday:AA,Weekdays:CA,Weeks:OA,YearsDropdown:DA},Symbol.toStringTag,{value:"Module"}));function ei(t,r,e=!1,a=Rs){let{from:n,to:o}=t;const{differenceInCalendarDays:s,isSameDay:l}=a;return n&&o?(s(o,n)<0&&([n,o]=[o,n]),s(r,n)>=(e?1:0)&&s(o,r)>=(e?1:0)):!e&&o?l(o,r):!e&&n?l(n,r):!1}function Tm(t){return!!(t&&typeof t=="object"&&"before"in t&&"after"in t)}function qf(t){return!!(t&&typeof t=="object"&&"from"in t)}function Am(t){return!!(t&&typeof t=="object"&&"after"in t)}function Cm(t){return!!(t&&typeof t=="object"&&"before"in t)}function ww(t){return!!(t&&typeof t=="object"&&"dayOfWeek"in t)}function _w(t,r){return Array.isArray(t)&&t.every(r.isDate)}function ti(t,r,e=Rs){const a=Array.isArray(r)?r:[r],{isSameDay:n,differenceInCalendarDays:o,isAfter:s}=e;return a.some(l=>{if(typeof l=="boolean")return l;if(e.isDate(l))return n(t,l);if(_w(l,e))return l.some(c=>n(t,c));if(qf(l))return ei(l,t,!1,e);if(ww(l))return Array.isArray(l.dayOfWeek)?l.dayOfWeek.includes(t.getDay()):l.dayOfWeek===t.getDay();if(Tm(l)){const c=o(l.before,t),i=o(l.after,t),u=c>0,p=i<0;return s(l.before,l.after)?p&&u:u||p}return Am(l)?o(t,l.after)>0:Cm(l)?o(l.before,t)>0:typeof l=="function"?l(t):!1})}function RA(t,r,e,a,n){const{disabled:o,hidden:s,modifiers:l,showOutsideDays:c,broadcastCalendar:i,today:u=n.today()}=r,{isSameDay:p,isSameMonth:f,startOfMonth:h,isBefore:v,endOfMonth:b,isAfter:g}=n,x=e&&h(e),y=a&&b(a),E={[Vr.focused]:[],[Vr.outside]:[],[Vr.disabled]:[],[Vr.hidden]:[],[Vr.today]:[]},N={};for(const I of t){const{date:P,displayMonth:V}=I,U=!!(V&&!f(P,V)),H=!!(x&&v(P,x)),G=!!(y&&g(P,y)),Z=!!(o&&ti(P,o,n)),W=!!(s&&ti(P,s,n))||H||G||!i&&!c&&U||i&&c===!1&&U,O=p(P,u);U&&E.outside.push(I),Z&&E.disabled.push(I),W&&E.hidden.push(I),O&&E.today.push(I),l&&Object.keys(l).forEach(R=>{const C=l==null?void 0:l[R];C&&ti(P,C,n)&&(N[R]?N[R].push(I):N[R]=[I])})}return I=>{const P={[Vr.focused]:!1,[Vr.disabled]:!1,[Vr.hidden]:!1,[Vr.outside]:!1,[Vr.today]:!1},V={};for(const U in E){const H=E[U];P[U]=H.some(G=>G===I)}for(const U in N)V[U]=N[U].some(H=>H===I);return{...P,...V}}}function IA(t,r,e={}){return Object.entries(t).filter(([,n])=>n===!0).reduce((n,[o])=>(e[o]?n.push(e[o]):r[Vr[o]]?n.push(r[Vr[o]]):r[os[o]]&&n.push(r[os[o]]),n),[r[$t.Day]])}function FA(t){return{...MA,...t}}function PA(t){const r={"data-mode":t.mode??void 0,"data-required":"required"in t?t.required:void 0,"data-multiple-months":t.numberOfMonths&&t.numberOfMonths>1||void 0,"data-week-numbers":t.showWeekNumber||void 0,"data-broadcast-calendar":t.broadcastCalendar||void 0,"data-nav-layout":t.navLayout||void 0};return Object.entries(t).forEach(([e,a])=>{e.startsWith("data-")&&(r[e]=a)}),r}function Nm(){const t={};for(const r in $t)t[$t[r]]=`rdp-${$t[r]}`;for(const r in Vr)t[Vr[r]]=`rdp-${Vr[r]}`;for(const r in os)t[os[r]]=`rdp-${os[r]}`;for(const r in bn)t[bn[r]]=`rdp-${bn[r]}`;return t}function Sw(t,r,e){return(e??new En(r)).formatMonthYear(t)}const LA=Sw;function BA(t,r,e){return(e??new En(r)).format(t,"d")}function UA(t,r=Rs){return r.format(t,"LLLL")}function zA(t,r,e){return(e??new En(r)).format(t,"cccccc")}function $A(t,r=Rs){return t<10?r.formatNumber(`0${t.toLocaleString()}`):r.formatNumber(`${t.toLocaleString()}`)}function VA(){return""}function kw(t,r=Rs){return r.format(t,"yyyy")}const HA=kw,qA=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:Sw,formatDay:BA,formatMonthCaption:LA,formatMonthDropdown:UA,formatWeekNumber:$A,formatWeekNumberHeader:VA,formatWeekdayName:zA,formatYearCaption:HA,formatYearDropdown:kw},Symbol.toStringTag,{value:"Module"}));function WA(t){return t!=null&&t.formatMonthCaption&&!t.formatCaption&&(t.formatCaption=t.formatMonthCaption),t!=null&&t.formatYearCaption&&!t.formatYearDropdown&&(t.formatYearDropdown=t.formatYearCaption),{...qA,...t}}function jm(t,r,e,a){let n=(a??new En(e)).format(t,"PPPP");return r.today&&(n=`Today, ${n}`),r.selected&&(n=`${n}, selected`),n}const GA=jm;function Om(t,r,e){return(e??new En(r)).formatMonthYear(t)}const YA=Om;function Ew(t,r,e,a){let n=(a??new En(e)).format(t,"PPPP");return r!=null&&r.today&&(n=`Today, ${n}`),n}function Tw(t){return"Choose the Month"}function Aw(){return""}const XA="Go to the Next Month";function Cw(t,r){return XA}function Nw(t){return"Go to the Previous Month"}function jw(t,r,e){return(e??new En(r)).format(t,"cccc")}function Ow(t,r){return`Week ${t}`}function Dw(t){return"Week Number"}function Mw(t){return"Choose the Year"}const KA=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:YA,labelDay:GA,labelDayButton:jm,labelGrid:Om,labelGridcell:Ew,labelMonthDropdown:Tw,labelNav:Aw,labelNext:Cw,labelPrevious:Nw,labelWeekNumber:Ow,labelWeekNumberHeader:Dw,labelWeekday:jw,labelYearDropdown:Mw},Symbol.toStringTag,{value:"Module"})),es=(t,r,e)=>r||(e?typeof e=="function"?e:(...a)=>e:t);function ZA(t,r){var a;const e=((a=r.locale)==null?void 0:a.labels)??{};return{...KA,...t??{},labelDayButton:es(jm,t==null?void 0:t.labelDayButton,e.labelDayButton),labelMonthDropdown:es(Tw,t==null?void 0:t.labelMonthDropdown,e.labelMonthDropdown),labelNext:es(Cw,t==null?void 0:t.labelNext,e.labelNext),labelPrevious:es(Nw,t==null?void 0:t.labelPrevious,e.labelPrevious),labelWeekNumber:es(Ow,t==null?void 0:t.labelWeekNumber,e.labelWeekNumber),labelYearDropdown:es(Mw,t==null?void 0:t.labelYearDropdown,e.labelYearDropdown),labelGrid:es(Om,t==null?void 0:t.labelGrid,e.labelGrid),labelGridcell:es(Ew,t==null?void 0:t.labelGridcell,e.labelGridcell),labelNav:es(Aw,t==null?void 0:t.labelNav,e.labelNav),labelWeekNumberHeader:es(Dw,t==null?void 0:t.labelWeekNumberHeader,e.labelWeekNumberHeader),labelWeekday:es(jw,t==null?void 0:t.labelWeekday,e.labelWeekday)}}function JA(t,r,e,a,n){const{startOfMonth:o,startOfYear:s,endOfYear:l,eachMonthOfInterval:c,getMonth:i}=n;return c({start:s(t),end:l(t)}).map(f=>{const h=a.formatMonthDropdown(f,n),v=i(f),b=r&&f<o(r)||e&&f>o(e)||!1;return{value:v,label:h,disabled:b}})}function QA(t,r={},e={}){let a={...r==null?void 0:r[$t.Day]};return Object.entries(t).filter(([,n])=>n===!0).forEach(([n])=>{a={...a,...e==null?void 0:e[n]}}),a}function e9(t,r,e,a){const n=a??t.today(),o=e?t.startOfBroadcastWeek(n,t):r?t.startOfISOWeek(n):t.startOfWeek(n),s=[];for(let l=0;l<7;l++){const c=t.addDays(o,l);s.push(c)}return s}function t9(t,r,e,a,n=!1){if(!t||!r)return;const{startOfYear:o,endOfYear:s,eachYearOfInterval:l,getYear:c}=a,i=o(t),u=s(r),p=l({start:i,end:u});return n&&p.reverse(),p.map(f=>{const h=e.formatYearDropdown(f,a);return{value:c(f),label:h,disabled:!1}})}function r9(t,r={}){var l;const{weekStartsOn:e,locale:a}=r,n=e??((l=a==null?void 0:a.options)==null?void 0:l.weekStartsOn)??0,o=c=>{const i=typeof c=="number"||typeof c=="string"?new Date(c):c;return new Pa(i.getFullYear(),i.getMonth(),i.getDate(),12,0,0,t)},s=c=>{const i=o(c);return new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0,0)};return{today:()=>o(Pa.tz(t)),newDate:(c,i,u)=>new Pa(c,i,u,12,0,0,t),startOfDay:c=>o(c),startOfWeek:(c,i)=>{const u=o(c),p=(i==null?void 0:i.weekStartsOn)??n,f=(u.getDay()-p+7)%7;return u.setDate(u.getDate()-f),u},startOfISOWeek:c=>{const i=o(c),u=(i.getDay()-1+7)%7;return i.setDate(i.getDate()-u),i},startOfMonth:c=>{const i=o(c);return i.setDate(1),i},startOfYear:c=>{const i=o(c);return i.setMonth(0,1),i},endOfWeek:(c,i)=>{const u=o(c),h=((((i==null?void 0:i.weekStartsOn)??n)+6)%7-u.getDay()+7)%7;return u.setDate(u.getDate()+h),u},endOfISOWeek:c=>{const i=o(c),u=(7-i.getDay())%7;return i.setDate(i.getDate()+u),i},endOfMonth:c=>{const i=o(c);return i.setMonth(i.getMonth()+1,0),i},endOfYear:c=>{const i=o(c);return i.setMonth(11,31),i},eachMonthOfInterval:c=>{const i=o(c.start),u=o(c.end),p=[],f=new Pa(i.getFullYear(),i.getMonth(),1,12,0,0,t),h=u.getFullYear()*12+u.getMonth();for(;f.getFullYear()*12+f.getMonth()<=h;)p.push(new Pa(f,t)),f.setMonth(f.getMonth()+1,1);return p},addDays:(c,i)=>{const u=o(c);return u.setDate(u.getDate()+i),u},addWeeks:(c,i)=>{const u=o(c);return u.setDate(u.getDate()+i*7),u},addMonths:(c,i)=>{const u=o(c);return u.setMonth(u.getMonth()+i),u},addYears:(c,i)=>{const u=o(c);return u.setFullYear(u.getFullYear()+i),u},eachYearOfInterval:c=>{const i=o(c.start),u=o(c.end),p=[],f=new Pa(i.getFullYear(),0,1,12,0,0,t);for(;f.getFullYear()<=u.getFullYear();)p.push(new Pa(f,t)),f.setFullYear(f.getFullYear()+1,0,1);return p},getWeek:(c,i)=>{var p;const u=s(c);return Em(u,{weekStartsOn:(i==null?void 0:i.weekStartsOn)??n,firstWeekContainsDate:(i==null?void 0:i.firstWeekContainsDate)??((p=a==null?void 0:a.options)==null?void 0:p.firstWeekContainsDate)??1})},getISOWeek:c=>{const i=s(c);return km(i)},differenceInCalendarDays:(c,i)=>{const u=s(c),p=s(i);return _m(u,p)},differenceInCalendarMonths:(c,i)=>{const u=s(c),p=s(i);return fw(u,p)}}}const qu=t=>t instanceof HTMLElement?t:null,np=t=>[...t.querySelectorAll("[data-animated-month]")??[]],a9=t=>qu(t.querySelector("[data-animated-month]")),sp=t=>qu(t.querySelector("[data-animated-caption]")),ip=t=>qu(t.querySelector("[data-animated-weeks]")),n9=t=>qu(t.querySelector("[data-animated-nav]")),s9=t=>qu(t.querySelector("[data-animated-weekdays]"));function i9(t,r,{classNames:e,months:a,focused:n,dateLib:o}){const s=Se.useRef(null),l=Se.useRef(a),c=Se.useRef(!1);Se.useLayoutEffect(()=>{const i=l.current;if(l.current=a,!r||!t.current||!(t.current instanceof HTMLElement)||a.length===0||i.length===0||a.length!==i.length)return;const u=o.isSameMonth(a[0].date,i[0].date),p=o.isAfter(a[0].date,i[0].date),f=p?e[bn.caption_after_enter]:e[bn.caption_before_enter],h=p?e[bn.weeks_after_enter]:e[bn.weeks_before_enter],v=s.current,b=t.current.cloneNode(!0);if(b instanceof HTMLElement?(np(b).forEach(E=>{if(!(E instanceof HTMLElement))return;const N=a9(E);N&&E.contains(N)&&E.removeChild(N);const I=sp(E);I&&I.classList.remove(f);const P=ip(E);P&&P.classList.remove(h)}),s.current=b):s.current=null,c.current||u||n)return;const g=v instanceof HTMLElement?np(v):[],x=np(t.current);if(x!=null&&x.every(y=>y instanceof HTMLElement)&&g&&g.every(y=>y instanceof HTMLElement)){c.current=!0,t.current.style.isolation="isolate";const y=n9(t.current);y&&(y.style.zIndex="1"),x.forEach((E,N)=>{const I=g[N];if(!I)return;E.style.position="relative",E.style.overflow="hidden";const P=sp(E);P&&P.classList.add(f);const V=ip(E);V&&V.classList.add(h);const U=()=>{c.current=!1,t.current&&(t.current.style.isolation=""),y&&(y.style.zIndex=""),P&&P.classList.remove(f),V&&V.classList.remove(h),E.style.position="",E.style.overflow="",E.contains(I)&&E.removeChild(I)};I.style.pointerEvents="none",I.style.position="absolute",I.style.overflow="hidden",I.setAttribute("aria-hidden","true");const H=s9(I);H&&(H.style.opacity="0");const G=sp(I);G&&(G.classList.add(p?e[bn.caption_before_exit]:e[bn.caption_after_exit]),G.addEventListener("animationend",U));const Z=ip(I);Z&&Z.classList.add(p?e[bn.weeks_before_exit]:e[bn.weeks_after_exit]),E.insertBefore(I,E.firstChild)})}})}function o9(t,r,e,a){const n=t[0],o=t[t.length-1],{ISOWeek:s,fixedWeeks:l,broadcastCalendar:c}=e??{},{addDays:i,differenceInCalendarDays:u,differenceInCalendarMonths:p,endOfBroadcastWeek:f,endOfISOWeek:h,endOfMonth:v,endOfWeek:b,isAfter:g,startOfBroadcastWeek:x,startOfISOWeek:y,startOfWeek:E}=a,N=c?x(n,a):s?y(n):E(n),I=c?f(o):s?h(v(o)):b(v(o)),P=r&&(c?f(r):s?h(r):b(r)),V=P&&g(I,P)?P:I,U=u(V,N),H=p(o,n)+1,G=[];for(let O=0;O<=U;O++){const R=i(N,O);G.push(R)}const W=(c?35:42)*H;if(l&&G.length<W){const O=W-G.length;for(let R=0;R<O;R++){const C=i(G[G.length-1],1);G.push(C)}}return G}function l9(t){const r=[];return t.reduce((e,a)=>{const n=a.weeks.reduce((o,s)=>o.concat(s.days.slice()),r.slice());return e.concat(n.slice())},r.slice())}function c9(t,r,e,a){const{numberOfMonths:n=1}=e,o=[];for(let s=0;s<n;s++){const l=a.addMonths(t,s);if(r&&l>r)break;o.push(l)}return o}function mx(t,r,e,a){const{month:n,defaultMonth:o,today:s=a.today(),numberOfMonths:l=1}=t;let c=n||o||s;const{differenceInCalendarMonths:i,addMonths:u,startOfMonth:p}=a;if(e&&i(e,c)<l-1){const f=-1*(l-1);c=u(e,f)}return r&&i(c,r)<0&&(c=r),p(c)}function u9(t,r,e,a){const{addDays:n,endOfBroadcastWeek:o,endOfISOWeek:s,endOfMonth:l,endOfWeek:c,getISOWeek:i,getWeek:u,startOfBroadcastWeek:p,startOfISOWeek:f,startOfWeek:h}=a,v=t.reduce((b,g)=>{const x=e.broadcastCalendar?p(g,a):e.ISOWeek?f(g):h(g),y=e.broadcastCalendar?o(g):e.ISOWeek?s(l(g)):c(l(g)),E=r.filter(V=>V>=x&&V<=y),N=e.broadcastCalendar?35:42;if(e.fixedWeeks&&E.length<N){const V=r.filter(U=>{const H=N-E.length;return U>y&&U<=n(y,H)});E.push(...V)}const I=E.reduce((V,U)=>{const H=e.ISOWeek?i(U):u(U),G=V.find(W=>W.weekNumber===H),Z=new xw(U,g,a);return G?G.days.push(Z):V.push(new iA(H,[Z])),V},[]),P=new sA(g,I);return b.push(P),b},[]);return e.reverseMonths?v.reverse():v}function d9(t,r){let{startMonth:e,endMonth:a}=t;const{startOfYear:n,startOfDay:o,startOfMonth:s,endOfMonth:l,addYears:c,endOfYear:i,newDate:u,today:p}=r,{fromYear:f,toYear:h,fromMonth:v,toMonth:b}=t;!e&&v&&(e=v),!e&&f&&(e=r.newDate(f,0,1)),!a&&b&&(a=b),!a&&h&&(a=u(h,11,31));const g=t.captionLayout==="dropdown"||t.captionLayout==="dropdown-years";return e?e=s(e):f?e=u(f,0,1):!e&&g&&(e=n(c(t.today??p(),-100))),a?a=l(a):h?a=u(h,11,31):!a&&g&&(a=i(t.today??p())),[e&&o(e),a&&o(a)]}function f9(t,r,e,a){if(e.disableNavigation)return;const{pagedNavigation:n,numberOfMonths:o=1}=e,{startOfMonth:s,addMonths:l,differenceInCalendarMonths:c}=a,i=n?o:1,u=s(t);if(!r)return l(u,i);if(!(c(r,t)<o))return l(u,i)}function h9(t,r,e,a){if(e.disableNavigation)return;const{pagedNavigation:n,numberOfMonths:o}=e,{startOfMonth:s,addMonths:l,differenceInCalendarMonths:c}=a,i=n?o??1:1,u=s(t);if(!r)return l(u,-i);if(!(c(u,r)<=0))return l(u,-i)}function p9(t){const r=[];return t.reduce((e,a)=>e.concat(a.weeks.slice()),r.slice())}function Wf(t,r){const[e,a]=Se.useState(t);return[r===void 0?e:r,a]}function m9(t,r){var N;const[e,a]=d9(t,r),{startOfMonth:n,endOfMonth:o}=r,s=mx(t,e,a,r),[l,c]=Wf(s,t.month?s:void 0);Se.useEffect(()=>{const I=mx(t,e,a,r);c(I)},[t.timeZone]);const{months:i,weeks:u,days:p,previousMonth:f,nextMonth:h}=Se.useMemo(()=>{const I=c9(l,a,{numberOfMonths:t.numberOfMonths},r),P=o9(I,t.endMonth?o(t.endMonth):void 0,{ISOWeek:t.ISOWeek,fixedWeeks:t.fixedWeeks,broadcastCalendar:t.broadcastCalendar},r),V=u9(I,P,{broadcastCalendar:t.broadcastCalendar,fixedWeeks:t.fixedWeeks,ISOWeek:t.ISOWeek,reverseMonths:t.reverseMonths},r),U=p9(V),H=l9(V),G=h9(l,e,t,r),Z=f9(l,a,t,r);return{months:V,weeks:U,days:H,previousMonth:G,nextMonth:Z}},[r,l.getTime(),a==null?void 0:a.getTime(),e==null?void 0:e.getTime(),t.disableNavigation,t.broadcastCalendar,(N=t.endMonth)==null?void 0:N.getTime(),t.fixedWeeks,t.ISOWeek,t.numberOfMonths,t.pagedNavigation,t.reverseMonths]),{disableNavigation:v,onMonthChange:b}=t,g=I=>u.some(P=>P.days.some(V=>V.isEqualTo(I))),x=I=>{if(v)return;let P=n(I);e&&P<n(e)&&(P=n(e)),a&&P>n(a)&&(P=n(a)),c(P),b==null||b(P)};return{months:i,weeks:u,days:p,navStart:e,navEnd:a,previousMonth:f,nextMonth:h,goToMonth:x,goToDay:I=>{g(I)||x(I.date)}}}var Ss;(function(t){t[t.Today=0]="Today",t[t.Selected=1]="Selected",t[t.LastFocused=2]="LastFocused",t[t.FocusedModifier=3]="FocusedModifier"})(Ss||(Ss={}));function gx(t){return!t[Vr.disabled]&&!t[Vr.hidden]&&!t[Vr.outside]}function g9(t,r,e,a){let n,o=-1;for(const s of t){const l=r(s);gx(l)&&(l[Vr.focused]&&o<Ss.FocusedModifier?(n=s,o=Ss.FocusedModifier):a!=null&&a.isEqualTo(s)&&o<Ss.LastFocused?(n=s,o=Ss.LastFocused):e(s.date)&&o<Ss.Selected?(n=s,o=Ss.Selected):l[Vr.today]&&o<Ss.Today&&(n=s,o=Ss.Today))}return n||(n=t.find(s=>gx(r(s)))),n}function v9(t,r,e,a,n,o,s){const{ISOWeek:l,broadcastCalendar:c}=o,{addDays:i,addMonths:u,addWeeks:p,addYears:f,endOfBroadcastWeek:h,endOfISOWeek:v,endOfWeek:b,max:g,min:x,startOfBroadcastWeek:y,startOfISOWeek:E,startOfWeek:N}=s;let P={day:i,week:p,month:u,year:f,startOfWeek:V=>c?y(V,s):l?E(V):N(V),endOfWeek:V=>c?h(V):l?v(V):b(V)}[t](e,r==="after"?1:-1);return r==="before"&&a?P=g([a,P]):r==="after"&&n&&(P=x([n,P])),P}function Rw(t,r,e,a,n,o,s,l=0){if(l>365)return;const c=v9(t,r,e.date,a,n,o,s),i=!!(o.disabled&&ti(c,o.disabled,s)),u=!!(o.hidden&&ti(c,o.hidden,s)),p=c,f=new xw(c,p,s);return!i&&!u?f:Rw(t,r,f,a,n,o,s,l+1)}function b9(t,r,e,a,n){const{autoFocus:o}=t,[s,l]=Se.useState(),c=g9(r.days,e,a||(()=>!1),s),[i,u]=Se.useState(o?c:void 0);return{isFocusTarget:b=>!!(c!=null&&c.isEqualTo(b)),setFocused:u,focused:i,blur:()=>{l(i),u(void 0)},moveFocus:(b,g)=>{if(!i)return;const x=Rw(b,g,i,r.navStart,r.navEnd,t,n);x&&(t.disableNavigation&&!r.days.some(E=>E.isEqualTo(x))||(r.goToDay(x),u(x)))}}}function x9(t,r){const{selected:e,required:a,onSelect:n}=t,[o,s]=Wf(e,n?e:void 0),l=n?e:o,{isSameDay:c}=r,i=h=>(l==null?void 0:l.some(v=>c(v,h)))??!1,{min:u,max:p}=t;return{selected:l,select:(h,v,b)=>{let g=[...l??[]];if(i(h)){if((l==null?void 0:l.length)===u||a&&(l==null?void 0:l.length)===1)return;g=l==null?void 0:l.filter(x=>!c(x,h))}else(l==null?void 0:l.length)===p?g=[h]:g=[...g,h];return n||s(g),n==null||n(g,h,v,b),g},isSelected:i}}function y9(t,r,e=0,a=0,n=!1,o=Rs){const{from:s,to:l}=r||{},{isSameDay:c,isAfter:i,isBefore:u}=o;let p;if(!s&&!l)p={from:t,to:e>0?void 0:t};else if(s&&!l)c(s,t)?e===0?p={from:s,to:t}:n?p={from:s,to:void 0}:p=void 0:u(t,s)?p={from:t,to:s}:p={from:s,to:t};else if(s&&l)if(c(s,t)&&c(l,t))n?p={from:s,to:l}:p=void 0;else if(c(s,t))p={from:s,to:e>0?void 0:t};else if(c(l,t))p={from:t,to:e>0?void 0:t};else if(u(t,s))p={from:t,to:l};else if(i(t,s))p={from:s,to:t};else if(i(t,l))p={from:s,to:t};else throw new Error("Invalid range");if(p!=null&&p.from&&(p!=null&&p.to)){const f=o.differenceInCalendarDays(p.to,p.from);a>0&&f>a?p={from:t,to:void 0}:e>1&&f<e&&(p={from:t,to:void 0})}return p}function w9(t,r,e=Rs){const a=Array.isArray(r)?r:[r];let n=t.from;const o=e.differenceInCalendarDays(t.to,t.from),s=Math.min(o,6);for(let l=0;l<=s;l++){if(a.includes(n.getDay()))return!0;n=e.addDays(n,1)}return!1}function vx(t,r,e=Rs){return ei(t,r.from,!1,e)||ei(t,r.to,!1,e)||ei(r,t.from,!1,e)||ei(r,t.to,!1,e)}function _9(t,r,e=Rs){const a=Array.isArray(r)?r:[r];if(a.filter(l=>typeof l!="function").some(l=>typeof l=="boolean"?l:e.isDate(l)?ei(t,l,!1,e):_w(l,e)?l.some(c=>ei(t,c,!1,e)):qf(l)?l.from&&l.to?vx(t,{from:l.from,to:l.to},e):!1:ww(l)?w9(t,l.dayOfWeek,e):Tm(l)?e.isAfter(l.before,l.after)?vx(t,{from:e.addDays(l.after,1),to:e.addDays(l.before,-1)},e):ti(t.from,l,e)||ti(t.to,l,e):Am(l)||Cm(l)?ti(t.from,l,e)||ti(t.to,l,e):!1))return!0;const s=a.filter(l=>typeof l=="function");if(s.length){let l=t.from;const c=e.differenceInCalendarDays(t.to,t.from);for(let i=0;i<=c;i++){if(s.some(u=>u(l)))return!0;l=e.addDays(l,1)}}return!1}function S9(t,r){const{disabled:e,excludeDisabled:a,selected:n,required:o,onSelect:s}=t,[l,c]=Wf(n,s?n:void 0),i=s?n:l;return{selected:i,select:(f,h,v)=>{const{min:b,max:g}=t,x=f?y9(f,i,b,g,o,r):void 0;return a&&e&&(x!=null&&x.from)&&x.to&&_9({from:x.from,to:x.to},e,r)&&(x.from=f,x.to=void 0),s||c(x),s==null||s(x,f,h,v),x},isSelected:f=>i&&ei(i,f,!1,r)}}function k9(t,r){const{selected:e,required:a,onSelect:n}=t,[o,s]=Wf(e,n?e:void 0),l=n?e:o,{isSameDay:c}=r;return{selected:l,select:(p,f,h)=>{let v=p;return!a&&l&&l&&c(p,l)&&(v=void 0),n||s(v),n==null||n(v,p,f,h),v},isSelected:p=>l?c(l,p):!1}}function E9(t,r){const e=k9(t,r),a=x9(t,r),n=S9(t,r);switch(t.mode){case"single":return e;case"multiple":return a;case"range":return n;default:return}}function Pn(t,r){return t instanceof Pa&&t.timeZone===r?t:new Pa(t,r)}function kl(t,r,e){return Pn(t,r)}function bx(t,r,e){return typeof t=="boolean"||typeof t=="function"?t:t instanceof Date?kl(t,r):Array.isArray(t)?t.map(a=>a instanceof Date?kl(a,r):a):qf(t)?{...t,from:t.from?Pn(t.from,r):t.from,to:t.to?Pn(t.to,r):t.to}:Tm(t)?{before:kl(t.before,r),after:kl(t.after,r)}:Am(t)?{after:kl(t.after,r)}:Cm(t)?{before:kl(t.before,r)}:t}function op(t,r,e){return t&&(Array.isArray(t)?t.map(a=>bx(a,r)):bx(t,r))}function T9(t){var He;let r=t;const e=r.timeZone;if(e&&(r={...t,timeZone:e},r.today&&(r.today=Pn(r.today,e)),r.month&&(r.month=Pn(r.month,e)),r.defaultMonth&&(r.defaultMonth=Pn(r.defaultMonth,e)),r.startMonth&&(r.startMonth=Pn(r.startMonth,e)),r.endMonth&&(r.endMonth=Pn(r.endMonth,e)),r.mode==="single"&&r.selected?r.selected=Pn(r.selected,e):r.mode==="multiple"&&r.selected?r.selected=(He=r.selected)==null?void 0:He.map(Ue=>Pn(Ue,e)):r.mode==="range"&&r.selected&&(r.selected={from:r.selected.from?Pn(r.selected.from,e):r.selected.from,to:r.selected.to?Pn(r.selected.to,e):r.selected.to}),r.disabled!==void 0&&(r.disabled=op(r.disabled,e)),r.hidden!==void 0&&(r.hidden=op(r.hidden,e)),r.modifiers)){const Ue={};Object.keys(r.modifiers).forEach(bt=>{var tt;Ue[bt]=op((tt=r.modifiers)==null?void 0:tt[bt],e)}),r.modifiers=Ue}const{components:a,formatters:n,labels:o,dateLib:s,locale:l,classNames:c}=Se.useMemo(()=>{const Ue={...bw,...r.locale},bt=r.broadcastCalendar?1:r.weekStartsOn,tt=r.noonSafe&&r.timeZone?r9(r.timeZone,{weekStartsOn:bt,locale:Ue}):void 0,dt=r.dateLib&&tt?{...tt,...r.dateLib}:r.dateLib??tt,ut=new En({locale:Ue,weekStartsOn:bt,firstWeekContainsDate:r.firstWeekContainsDate,useAdditionalWeekYearTokens:r.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:r.useAdditionalDayOfYearTokens,timeZone:r.timeZone,numerals:r.numerals},dt);return{dateLib:ut,components:FA(r.components),formatters:WA(r.formatters),labels:ZA(r.labels,ut.options),locale:Ue,classNames:{...Nm(),...r.classNames}}},[r.locale,r.broadcastCalendar,r.weekStartsOn,r.firstWeekContainsDate,r.useAdditionalWeekYearTokens,r.useAdditionalDayOfYearTokens,r.timeZone,r.numerals,r.dateLib,r.noonSafe,r.components,r.formatters,r.labels,r.classNames]);r.today||(r={...r,today:s.today()});const{captionLayout:i,mode:u,navLayout:p,numberOfMonths:f=1,onDayBlur:h,onDayClick:v,onDayFocus:b,onDayKeyDown:g,onDayMouseEnter:x,onDayMouseLeave:y,onNextClick:E,onPrevClick:N,showWeekNumber:I,styles:P}=r,{formatCaption:V,formatDay:U,formatMonthDropdown:H,formatWeekNumber:G,formatWeekNumberHeader:Z,formatWeekdayName:W,formatYearDropdown:O}=n,R=m9(r,s),{days:C,months:_,navStart:k,navEnd:A,previousMonth:T,nextMonth:D,goToMonth:B}=R,F=RA(C,r,k,A,s),{isSelected:Y,select:X,selected:re}=E9(r,s)??{},{blur:z,focused:ee,isFocusTarget:L,moveFocus:M,setFocused:K}=b9(r,R,F,Y??(()=>!1),s),{labelDayButton:se,labelGridcell:te,labelGrid:ae,labelMonthDropdown:Q,labelNav:fe,labelPrevious:le,labelNext:ne,labelWeekday:ue,labelWeekNumber:he,labelWeekNumberHeader:ke,labelYearDropdown:pe}=o,Ce=Se.useMemo(()=>e9(s,r.ISOWeek,r.broadcastCalendar,r.today),[s,r.ISOWeek,r.broadcastCalendar,r.today]),Me=u!==void 0||v!==void 0,Ie=Se.useCallback(()=>{T&&(B(T),N==null||N(T))},[T,B,N]),Ye=Se.useCallback(()=>{D&&(B(D),E==null||E(D))},[B,D,E]),at=Se.useCallback((Ue,bt)=>tt=>{tt.preventDefault(),tt.stopPropagation(),K(Ue),!bt.disabled&&(X==null||X(Ue.date,bt,tt),v==null||v(Ue.date,bt,tt))},[X,v,K]),rt=Se.useCallback((Ue,bt)=>tt=>{K(Ue),b==null||b(Ue.date,bt,tt)},[b,K]),it=Se.useCallback((Ue,bt)=>tt=>{z(),h==null||h(Ue.date,bt,tt)},[z,h]),et=Se.useCallback((Ue,bt)=>tt=>{const dt={ArrowLeft:[tt.shiftKey?"month":"day",r.dir==="rtl"?"after":"before"],ArrowRight:[tt.shiftKey?"month":"day",r.dir==="rtl"?"before":"after"],ArrowDown:[tt.shiftKey?"year":"week","after"],ArrowUp:[tt.shiftKey?"year":"week","before"],PageUp:[tt.shiftKey?"year":"month","before"],PageDown:[tt.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(dt[tt.key]){tt.preventDefault(),tt.stopPropagation();const[ut,vt]=dt[tt.key];M(ut,vt)}g==null||g(Ue.date,bt,tt)},[M,g,r.dir]),st=Se.useCallback((Ue,bt)=>tt=>{x==null||x(Ue.date,bt,tt)},[x]),je=Se.useCallback((Ue,bt)=>tt=>{y==null||y(Ue.date,bt,tt)},[y]),ht=Se.useCallback(Ue=>bt=>{const tt=Number(bt.target.value),dt=s.setMonth(s.startOfMonth(Ue),tt);B(dt)},[s,B]),Je=Se.useCallback(Ue=>bt=>{const tt=Number(bt.target.value),dt=s.setYear(s.startOfMonth(Ue),tt);B(dt)},[s,B]),{className:nt,style:ct}=Se.useMemo(()=>({className:[c[$t.Root],r.className].filter(Boolean).join(" "),style:{...P==null?void 0:P[$t.Root],...r.style}}),[c,r.className,r.style,P]),_t=PA(r),mt=Se.useRef(null);i9(mt,!!r.animate,{classNames:c,months:_,focused:ee,dateLib:s});const gt={dayPickerProps:r,selected:re,select:X,isSelected:Y,months:_,nextMonth:D,previousMonth:T,goToMonth:B,getModifiers:F,components:a,classNames:c,styles:P,labels:o,formatters:n};return Xe.createElement(yw.Provider,{value:gt},Xe.createElement(a.Root,{rootRef:r.animate?mt:void 0,className:nt,style:ct,dir:r.dir,id:r.id,lang:r.lang,nonce:r.nonce,title:r.title,role:r.role,"aria-label":r["aria-label"],"aria-labelledby":r["aria-labelledby"],..._t},Xe.createElement(a.Months,{className:c[$t.Months],style:P==null?void 0:P[$t.Months]},!r.hideNavigation&&!p&&Xe.createElement(a.Nav,{"data-animated-nav":r.animate?"true":void 0,className:c[$t.Nav],style:P==null?void 0:P[$t.Nav],"aria-label":fe(),onPreviousClick:Ie,onNextClick:Ye,previousMonth:T,nextMonth:D}),_.map((Ue,bt)=>Xe.createElement(a.Month,{"data-animated-month":r.animate?"true":void 0,className:c[$t.Month],style:P==null?void 0:P[$t.Month],key:bt,displayIndex:bt,calendarMonth:Ue},p==="around"&&!r.hideNavigation&&bt===0&&Xe.createElement(a.PreviousMonthButton,{type:"button",className:c[$t.PreviousMonthButton],tabIndex:T?void 0:-1,"aria-disabled":T?void 0:!0,"aria-label":le(T),onClick:Ie,"data-animated-button":r.animate?"true":void 0},Xe.createElement(a.Chevron,{disabled:T?void 0:!0,className:c[$t.Chevron],orientation:r.dir==="rtl"?"right":"left"})),Xe.createElement(a.MonthCaption,{"data-animated-caption":r.animate?"true":void 0,className:c[$t.MonthCaption],style:P==null?void 0:P[$t.MonthCaption],calendarMonth:Ue,displayIndex:bt},i!=null&&i.startsWith("dropdown")?Xe.createElement(a.DropdownNav,{className:c[$t.Dropdowns],style:P==null?void 0:P[$t.Dropdowns]},(()=>{const tt=i==="dropdown"||i==="dropdown-months"?Xe.createElement(a.MonthsDropdown,{key:"month",className:c[$t.MonthsDropdown],"aria-label":Q(),classNames:c,components:a,disabled:!!r.disableNavigation,onChange:ht(Ue.date),options:JA(Ue.date,k,A,n,s),style:P==null?void 0:P[$t.Dropdown],value:s.getMonth(Ue.date)}):Xe.createElement("span",{key:"month"},H(Ue.date,s)),dt=i==="dropdown"||i==="dropdown-years"?Xe.createElement(a.YearsDropdown,{key:"year",className:c[$t.YearsDropdown],"aria-label":pe(s.options),classNames:c,components:a,disabled:!!r.disableNavigation,onChange:Je(Ue.date),options:t9(k,A,n,s,!!r.reverseYears),style:P==null?void 0:P[$t.Dropdown],value:s.getYear(Ue.date)}):Xe.createElement("span",{key:"year"},O(Ue.date,s));return s.getMonthYearOrder()==="year-first"?[dt,tt]:[tt,dt]})(),Xe.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},V(Ue.date,s.options,s))):Xe.createElement(a.CaptionLabel,{className:c[$t.CaptionLabel],role:"status","aria-live":"polite"},V(Ue.date,s.options,s))),p==="around"&&!r.hideNavigation&&bt===f-1&&Xe.createElement(a.NextMonthButton,{type:"button",className:c[$t.NextMonthButton],tabIndex:D?void 0:-1,"aria-disabled":D?void 0:!0,"aria-label":ne(D),onClick:Ye,"data-animated-button":r.animate?"true":void 0},Xe.createElement(a.Chevron,{disabled:D?void 0:!0,className:c[$t.Chevron],orientation:r.dir==="rtl"?"left":"right"})),bt===f-1&&p==="after"&&!r.hideNavigation&&Xe.createElement(a.Nav,{"data-animated-nav":r.animate?"true":void 0,className:c[$t.Nav],style:P==null?void 0:P[$t.Nav],"aria-label":fe(),onPreviousClick:Ie,onNextClick:Ye,previousMonth:T,nextMonth:D}),Xe.createElement(a.MonthGrid,{role:"grid","aria-multiselectable":u==="multiple"||u==="range","aria-label":ae(Ue.date,s.options,s)||void 0,className:c[$t.MonthGrid],style:P==null?void 0:P[$t.MonthGrid]},!r.hideWeekdays&&Xe.createElement(a.Weekdays,{"data-animated-weekdays":r.animate?"true":void 0,className:c[$t.Weekdays],style:P==null?void 0:P[$t.Weekdays]},I&&Xe.createElement(a.WeekNumberHeader,{"aria-label":ke(s.options),className:c[$t.WeekNumberHeader],style:P==null?void 0:P[$t.WeekNumberHeader],scope:"col"},Z()),Ce.map(tt=>Xe.createElement(a.Weekday,{"aria-label":ue(tt,s.options,s),className:c[$t.Weekday],key:String(tt),style:P==null?void 0:P[$t.Weekday],scope:"col"},W(tt,s.options,s)))),Xe.createElement(a.Weeks,{"data-animated-weeks":r.animate?"true":void 0,className:c[$t.Weeks],style:P==null?void 0:P[$t.Weeks]},Ue.weeks.map(tt=>Xe.createElement(a.Week,{className:c[$t.Week],key:tt.weekNumber,style:P==null?void 0:P[$t.Week],week:tt},I&&Xe.createElement(a.WeekNumber,{week:tt,style:P==null?void 0:P[$t.WeekNumber],"aria-label":he(tt.weekNumber,{locale:l}),className:c[$t.WeekNumber],scope:"row",role:"rowheader"},G(tt.weekNumber,s)),tt.days.map(dt=>{const{date:ut}=dt,vt=F(dt);if(vt[Vr.focused]=!vt.hidden&&!!(ee!=null&&ee.isEqualTo(dt)),vt[os.selected]=(Y==null?void 0:Y(ut))||vt.selected,qf(re)){const{from:yt,to:Ct}=re;vt[os.range_start]=!!(yt&&Ct&&s.isSameDay(ut,yt)),vt[os.range_end]=!!(yt&&Ct&&s.isSameDay(ut,Ct)),vt[os.range_middle]=ei(re,ut,!0,s)}const xt=QA(vt,P,r.modifiersStyles),At=IA(vt,c,r.modifiersClassNames),Kt=!Me&&!vt.hidden?te(ut,vt,s.options,s):void 0;return Xe.createElement(a.Day,{key:`${dt.isoDate}_${dt.displayMonthId}`,day:dt,modifiers:vt,className:At.join(" "),style:xt,role:"gridcell","aria-selected":vt.selected||void 0,"aria-label":Kt,"data-day":dt.isoDate,"data-month":dt.outside?dt.dateMonthId:void 0,"data-selected":vt.selected||void 0,"data-disabled":vt.disabled||void 0,"data-hidden":vt.hidden||void 0,"data-outside":dt.outside||void 0,"data-focused":vt.focused||void 0,"data-today":vt.today||void 0},!vt.hidden&&Me?Xe.createElement(a.DayButton,{className:c[$t.DayButton],style:P==null?void 0:P[$t.DayButton],type:"button",day:dt,modifiers:vt,disabled:!vt.focused&&vt.disabled||void 0,"aria-disabled":vt.focused&&vt.disabled||void 0,tabIndex:L(dt)?0:-1,"aria-label":se(ut,vt,s.options,s),onClick:at(dt,vt),onBlur:it(dt,vt),onFocus:rt(dt,vt),onKeyDown:et(dt,vt),onMouseEnter:st(dt,vt),onMouseLeave:je(dt,vt)},U(ut,s.options,s)):!vt.hidden&&U(dt.date,s.options,s))})))))))),r.footer&&Xe.createElement(a.Footer,{className:c[$t.Footer],style:P==null?void 0:P[$t.Footer],role:"status","aria-live":"polite"},r.footer)))}function Iw({className:t,classNames:r,showOutsideDays:e=!0,captionLayout:a="label",buttonVariant:n="ghost",formatters:o,components:s,...l}){const c=Nm();return w.jsx(T9,{showOutsideDays:e,className:Et("bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,t),captionLayout:a,formatters:{formatMonthDropdown:i=>i.toLocaleString("default",{month:"short"}),...o},classNames:{root:Et("w-fit",c.root),months:Et("relative flex flex-col gap-4 md:flex-row",c.months),month:Et("flex w-full flex-col gap-4",c.month),nav:Et("absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1",c.nav),button_previous:Et(jp({variant:n}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",c.button_previous),button_next:Et(jp({variant:n}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",c.button_next),month_caption:Et("flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]",c.month_caption),dropdowns:Et("flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium",c.dropdowns),dropdown_root:Et("has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border",c.dropdown_root),dropdown:Et("bg-popover absolute inset-0 opacity-0",c.dropdown),caption_label:Et("select-none font-medium",a==="label"?"text-sm":"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5",c.caption_label),table:"w-full border-collapse",weekdays:Et("flex",c.weekdays),weekday:Et("text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal",c.weekday),week:Et("mt-2 flex w-full",c.week),week_number_header:Et("w-[--cell-size] select-none",c.week_number_header),week_number:Et("text-muted-foreground select-none text-[0.8rem]",c.week_number),day:Et("group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md",c.day),range_start:Et("bg-accent rounded-l-md",c.range_start),range_middle:Et("rounded-none",c.range_middle),range_end:Et("bg-accent rounded-r-md",c.range_end),today:Et("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",c.today),outside:Et("text-muted-foreground aria-selected:text-muted-foreground",c.outside),disabled:Et("text-muted-foreground opacity-50",c.disabled),hidden:Et("invisible",c.hidden),...r},components:{Root:({className:i,rootRef:u,...p})=>w.jsx("div",{"data-slot":"calendar",ref:u,className:Et(i),...p}),Chevron:({className:i,orientation:u,...p})=>u==="left"?w.jsx(yu,{className:Et("size-4",i),...p}):u==="right"?w.jsx(wu,{className:Et("size-4",i),...p}):w.jsx(zu,{className:Et("size-4",i),...p}),DayButton:A9,WeekNumber:({children:i,...u})=>w.jsx("td",{...u,children:w.jsx("div",{className:"flex size-[--cell-size] items-center justify-center text-center",children:i})}),...s},...l})}function A9({className:t,day:r,modifiers:e,...a}){const n=Nm(),o=Se.useRef(null);return Se.useEffect(()=>{var s;e.focused&&((s=o.current)==null||s.focus())},[e.focused]),w.jsx(Ot,{ref:o,variant:"ghost",size:"icon","data-day":r.date.toLocaleDateString(),"data-selected-single":e.selected&&!e.range_start&&!e.range_end&&!e.range_middle,"data-range-start":e.range_start,"data-range-end":e.range_end,"data-range-middle":e.range_middle,className:Et("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70",n.day,t),...a})}const C9=$f("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Un({className:t,variant:r,...e}){return w.jsx("div",{className:Et(C9({variant:r}),t),...e})}const N9=t=>t?(...r)=>t(...r):(...r)=>fetch(...r);class Dm extends Error{constructor(r,e="FunctionsError",a){super(r),this.name=e,this.context=a}}class j9 extends Dm{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class xx extends Dm{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class yx extends Dm{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var Up;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Up||(Up={}));class O9{constructor(r,{headers:e={},customFetch:a,region:n=Up.Any}={}){this.url=r,this.headers=e,this.region=n,this.fetch=N9(a)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r){return z5(this,arguments,void 0,function*(e,a={}){var n;let o,s;try{const{headers:l,method:c,body:i,signal:u,timeout:p}=a;let f={},{region:h}=a;h||(h=this.region);const v=new URL(`${this.url}/${e}`);h&&h!=="any"&&(f["x-region"]=h,v.searchParams.set("forceFunctionRegion",h));let b;i&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",b=i):typeof i=="string"?(f["Content-Type"]="text/plain",b=i):typeof FormData<"u"&&i instanceof FormData?b=i:(f["Content-Type"]="application/json",b=JSON.stringify(i)):b=i;let g=u;p&&(s=new AbortController,o=setTimeout(()=>s.abort(),p),u?(g=s.signal,u.addEventListener("abort",()=>s.abort())):g=s.signal);const x=yield this.fetch(v.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),l),body:b,signal:g}).catch(I=>{throw new j9(I)}),y=x.headers.get("x-relay-error");if(y&&y==="true")throw new xx(x);if(!x.ok)throw new yx(x);let E=((n=x.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),N;return E==="application/json"?N=yield x.json():E==="application/octet-stream"||E==="application/pdf"?N=yield x.blob():E==="text/event-stream"?N=x:E==="multipart/form-data"?N=yield x.formData():N=yield x.text(),{data:N,error:null,response:x}}catch(l){return{data:null,error:l,response:l instanceof yx||l instanceof xx?l.context:void 0}}finally{o&&clearTimeout(o)}})}}var D9=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},M9=class{constructor(t){var r,e;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(e=t.isMaybeSingle)!==null&&e!==void 0?e:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){var e=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let n=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{let s=null,l=null,c=null,i=o.status,u=o.statusText;if(o.ok){var p,f;if(e.method!=="HEAD"){var h;const x=await o.text();x===""||(e.headers.get("Accept")==="text/csv"||e.headers.get("Accept")&&(!((h=e.headers.get("Accept"))===null||h===void 0)&&h.includes("application/vnd.pgrst.plan+text"))?l=x:l=JSON.parse(x))}const b=(p=e.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),g=(f=o.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");b&&g&&g.length>1&&(c=parseInt(g[1])),e.isMaybeSingle&&e.method==="GET"&&Array.isArray(l)&&(l.length>1?(s={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,c=null,i=406,u="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var v;const b=await o.text();try{s=JSON.parse(b),Array.isArray(s)&&o.status===404&&(l=[],s=null,i=200,u="OK")}catch{o.status===404&&b===""?(i=204,u="No Content"):s={message:b}}if(s&&e.isMaybeSingle&&(!(s==null||(v=s.details)===null||v===void 0)&&v.includes("0 rows"))&&(s=null,i=200,u="OK"),s&&e.shouldThrowOnError)throw new D9(s)}return{error:s,data:l,count:c,status:i,statusText:u}});return this.shouldThrowOnError||(n=n.catch(o=>{var s;let l="";const c=o==null?void 0:o.cause;if(c){var i,u,p,f;const v=(i=c==null?void 0:c.message)!==null&&i!==void 0?i:"",b=(u=c==null?void 0:c.code)!==null&&u!==void 0?u:"";l=`${(p=o==null?void 0:o.name)!==null&&p!==void 0?p:"FetchError"}: ${o==null?void 0:o.message}`,l+=`

Caused by: ${(f=c==null?void 0:c.name)!==null&&f!==void 0?f:"Error"}: ${v}`,b&&(l+=` (${b})`),c!=null&&c.stack&&(l+=`
${c.stack}`)}else{var h;l=(h=o==null?void 0:o.stack)!==null&&h!==void 0?h:""}return{error:{message:`${(s=o==null?void 0:o.name)!==null&&s!==void 0?s:"FetchError"}: ${o==null?void 0:o.message}`,details:l,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),n.then(t,r)}returns(){return this}overrideTypes(){return this}},R9=class extends M9{select(t){let r=!1;const e=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",e),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:e,foreignTable:a,referencedTable:n=a}={}){const o=n?`${n}.order`:"order",s=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${s?`${s},`:""}${t}.${r?"asc":"desc"}${e===void 0?"":e?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:e=r}={}){const a=typeof e>"u"?"limit":`${e}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:e,referencedTable:a=e}={}){const n=typeof a>"u"?"offset":`${a}.offset`,o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(n,`${t}`),this.url.searchParams.set(o,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:e=!1,buffers:a=!1,wal:n=!1,format:o="text"}={}){var s;const l=[t?"analyze":null,r?"verbose":null,e?"settings":null,a?"buffers":null,n?"wal":null].filter(Boolean).join("|"),c=(s=this.headers.get("Accept"))!==null&&s!==void 0?s:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${c}"; options=${l};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const wx=new RegExp("[,()]");var Fl=class extends R9{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}regexMatch(t,r){return this.url.searchParams.append(t,`match.${r}`),this}regexIMatch(t,r){return this.url.searchParams.append(t,`imatch.${r}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}isDistinct(t,r){return this.url.searchParams.append(t,`isdistinct.${r}`),this}in(t,r){const e=Array.from(new Set(r)).map(a=>typeof a=="string"&&wx.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${e})`),this}notIn(t,r){const e=Array.from(new Set(r)).map(a=>typeof a=="string"&&wx.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`not.in.(${e})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:e,type:a}={}){let n="";a==="plain"?n="pl":a==="phrase"?n="ph":a==="websearch"&&(n="w");const o=e===void 0?"":`(${e})`;return this.url.searchParams.append(t,`${n}fts${o}.${r}`),this}match(t){return Object.entries(t).forEach(([r,e])=>{this.url.searchParams.append(r,`eq.${e}`)}),this}not(t,r,e){return this.url.searchParams.append(t,`not.${r}.${e}`),this}or(t,{foreignTable:r,referencedTable:e=r}={}){const a=e?`${e}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,e){return this.url.searchParams.append(t,`${r}.${e}`),this}},I9=class{constructor(t,{headers:r={},schema:e,fetch:a}){this.url=t,this.headers=new Headers(r),this.schema=e,this.fetch=a}select(t,r){const{head:e=!1,count:a}=r??{},n=e?"HEAD":"GET";let o=!1;const s=(t??"*").split("").map(l=>/\s/.test(l)&&!o?"":(l==='"'&&(o=!o),l)).join("");return this.url.searchParams.set("select",s),a&&this.headers.append("Prefer",`count=${a}`),new Fl({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:e=!0}={}){var a;const n="POST";if(r&&this.headers.append("Prefer",`count=${r}`),e||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const o=t.reduce((s,l)=>s.concat(Object.keys(l)),[]);if(o.length>0){const s=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",s.join(","))}}return new Fl({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:e=!1,count:a,defaultToNull:n=!0}={}){var o;const s="POST";if(this.headers.append("Prefer",`resolution=${e?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),a&&this.headers.append("Prefer",`count=${a}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,i)=>c.concat(Object.keys(i)),[]);if(l.length>0){const c=[...new Set(l)].map(i=>`"${i}"`);this.url.searchParams.set("columns",c.join(","))}}return new Fl({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(t,{count:r}={}){var e;const a="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Fl({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}delete({count:t}={}){var r;const e="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Fl({method:e,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}},F9=class Fw{constructor(r,{headers:e={},schema:a,fetch:n}={}){this.url=r,this.headers=new Headers(e),this.schemaName=a,this.fetch=n}from(r){if(!r||typeof r!="string"||r.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new I9(new URL(`${this.url}/${r}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(r){return new Fw(this.url,{headers:this.headers,schema:r,fetch:this.fetch})}rpc(r,e={},{head:a=!1,get:n=!1,count:o}={}){var s;let l;const c=new URL(`${this.url}/rpc/${r}`);let i;a||n?(l=a?"HEAD":"GET",Object.entries(e).filter(([p,f])=>f!==void 0).map(([p,f])=>[p,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([p,f])=>{c.searchParams.append(p,f)})):(l="POST",i=e);const u=new Headers(this.headers);return o&&u.set("Prefer",`count=${o}`),new Fl({method:l,url:c,headers:u,schema:this.schemaName,body:i,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}};class P9{constructor(){}static detectEnvironment(){var r;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((r=navigator.userAgent)===null||r===void 0)&&r.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const e=process.versions;if(e&&e.node){const a=e.node,n=parseInt(a.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const r=this.detectEnvironment();if(r.constructor)return r.constructor;let e=r.error||"WebSocket not supported in this environment.";throw r.workaround&&(e+=`

Suggested solution: ${r.workaround}`),new Error(e)}static createWebSocket(r,e){const a=this.getWebSocketConstructor();return new a(r,e)}static isWebSocketSupported(){try{const r=this.detectEnvironment();return r.type==="native"||r.type==="ws"}catch{return!1}}}const L9="2.89.0",B9=`realtime-js/${L9}`,Pw="1.0.0",U9="2.0.0",_x=Pw,zp=1e4,z9=1e3,$9=100;var Vi;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Vi||(Vi={}));var ma;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(ma||(ma={}));var ss;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ss||(ss={}));var $p;(function(t){t.websocket="websocket"})($p||($p={}));var jo;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(jo||(jo={}));class V9{constructor(r){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=r??[]}encode(r,e){if(r.event===this.BROADCAST_EVENT&&!(r.payload instanceof ArrayBuffer)&&typeof r.payload.event=="string")return e(this._binaryEncodeUserBroadcastPush(r));let a=[r.join_ref,r.ref,r.topic,r.event,r.payload];return e(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(r){var e;return this._isArrayBuffer((e=r.payload)===null||e===void 0?void 0:e.payload)?this._encodeBinaryUserBroadcastPush(r):this._encodeJsonUserBroadcastPush(r)}_encodeBinaryUserBroadcastPush(r){var e,a;const n=(a=(e=r.payload)===null||e===void 0?void 0:e.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(r,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(r){var e,a;const n=(a=(e=r.payload)===null||e===void 0?void 0:e.payload)!==null&&a!==void 0?a:{},s=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(r,this.JSON_ENCODING,s)}_encodeUserBroadcastPush(r,e,a){var n,o;const s=r.topic,l=(n=r.ref)!==null&&n!==void 0?n:"",c=(o=r.join_ref)!==null&&o!==void 0?o:"",i=r.payload.event,u=this.allowedMetadataKeys?this._pick(r.payload,this.allowedMetadataKeys):{},p=Object.keys(u).length===0?"":JSON.stringify(u);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(s.length>255)throw new Error(`topic length ${s.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`userEvent length ${i.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`metadata length ${p.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+s.length+i.length+p.length,h=new ArrayBuffer(this.HEADER_LENGTH+f);let v=new DataView(h),b=0;v.setUint8(b++,this.KINDS.userBroadcastPush),v.setUint8(b++,c.length),v.setUint8(b++,l.length),v.setUint8(b++,s.length),v.setUint8(b++,i.length),v.setUint8(b++,p.length),v.setUint8(b++,e),Array.from(c,x=>v.setUint8(b++,x.charCodeAt(0))),Array.from(l,x=>v.setUint8(b++,x.charCodeAt(0))),Array.from(s,x=>v.setUint8(b++,x.charCodeAt(0))),Array.from(i,x=>v.setUint8(b++,x.charCodeAt(0))),Array.from(p,x=>v.setUint8(b++,x.charCodeAt(0)));var g=new Uint8Array(h.byteLength+a.byteLength);return g.set(new Uint8Array(h),0),g.set(new Uint8Array(a),h.byteLength),g.buffer}decode(r,e){if(this._isArrayBuffer(r)){let a=this._binaryDecode(r);return e(a)}if(typeof r=="string"){const a=JSON.parse(r),[n,o,s,l,c]=a;return e({join_ref:n,ref:o,topic:s,event:l,payload:c})}return e({})}_binaryDecode(r){const e=new DataView(r),a=e.getUint8(0),n=new TextDecoder;switch(a){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(r,e,n)}}_decodeUserBroadcast(r,e,a){const n=e.getUint8(1),o=e.getUint8(2),s=e.getUint8(3),l=e.getUint8(4);let c=this.HEADER_LENGTH+4;const i=a.decode(r.slice(c,c+n));c=c+n;const u=a.decode(r.slice(c,c+o));c=c+o;const p=a.decode(r.slice(c,c+s));c=c+s;const f=r.slice(c,r.byteLength),h=l===this.JSON_ENCODING?JSON.parse(a.decode(f)):f,v={type:this.BROADCAST_EVENT,event:u,payload:h};return s>0&&(v.meta=JSON.parse(p)),{join_ref:null,ref:null,topic:i,event:this.BROADCAST_EVENT,payload:v}}_isArrayBuffer(r){var e;return r instanceof ArrayBuffer||((e=r==null?void 0:r.constructor)===null||e===void 0?void 0:e.name)==="ArrayBuffer"}_pick(r,e){return!r||typeof r!="object"?{}:Object.fromEntries(Object.entries(r).filter(([a])=>e.includes(a)))}}class Lw{constructor(r,e){this.callback=r,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ir;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ir||(Ir={}));const Sx=(t,r,e={})=>{var a;const n=(a=e.skipTypes)!==null&&a!==void 0?a:[];return r?Object.keys(r).reduce((o,s)=>(o[s]=H9(s,t,r,n),o),{}):{}},H9=(t,r,e,a)=>{const n=r.find(l=>l.name===t),o=n==null?void 0:n.type,s=e[t];return o&&!a.includes(o)?Bw(o,s):Vp(s)},Bw=(t,r)=>{if(t.charAt(0)==="_"){const e=t.slice(1,t.length);return Y9(r,e)}switch(t){case Ir.bool:return q9(r);case Ir.float4:case Ir.float8:case Ir.int2:case Ir.int4:case Ir.int8:case Ir.numeric:case Ir.oid:return W9(r);case Ir.json:case Ir.jsonb:return G9(r);case Ir.timestamp:return X9(r);case Ir.abstime:case Ir.date:case Ir.daterange:case Ir.int4range:case Ir.int8range:case Ir.money:case Ir.reltime:case Ir.text:case Ir.time:case Ir.timestamptz:case Ir.timetz:case Ir.tsrange:case Ir.tstzrange:return Vp(r);default:return Vp(r)}},Vp=t=>t,q9=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},W9=t=>{if(typeof t=="string"){const r=parseFloat(t);if(!Number.isNaN(r))return r}return t},G9=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},Y9=(t,r)=>{if(typeof t!="string")return t;const e=t.length-1,a=t[e];if(t[0]==="{"&&a==="}"){let o;const s=t.slice(1,e);try{o=JSON.parse("["+s+"]")}catch{o=s?s.split(","):[]}return o.map(l=>Bw(r,l))}return t},X9=t=>typeof t=="string"?t.replace(" ","T"):t,Uw=t=>{const r=new URL(t);return r.protocol=r.protocol.replace(/^ws/i,"http"),r.pathname=r.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),r.pathname===""||r.pathname==="/"?r.pathname="/api/broadcast":r.pathname=r.pathname+"/api/broadcast",r.href};class lp{constructor(r,e,a={},n=zp){this.channel=r,this.event=e,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,e){var a;return this._hasReceived(r)&&e((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:r,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:e}){this.recHooks.filter(a=>a.status===r).forEach(a=>a.callback(e))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var kx;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(kx||(kx={}));class lu{constructor(r,e){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(e==null?void 0:e.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},n=>{const{onJoin:o,onLeave:s,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=lu.syncState(this.state,n,o,s),this.pendingDiffs.forEach(c=>{this.state=lu.syncDiff(this.state,c,o,s)}),this.pendingDiffs=[],l()}),this.channel._on(a.diff,{},n=>{const{onJoin:o,onLeave:s,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=lu.syncDiff(this.state,n,o,s),l())}),this.onJoin((n,o,s)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:o,newPresences:s})}),this.onLeave((n,o,s)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:o,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,e,a,n){const o=this.cloneDeep(r),s=this.transformState(e),l={},c={};return this.map(o,(i,u)=>{s[i]||(c[i]=u)}),this.map(s,(i,u)=>{const p=o[i];if(p){const f=u.map(g=>g.presence_ref),h=p.map(g=>g.presence_ref),v=u.filter(g=>h.indexOf(g.presence_ref)<0),b=p.filter(g=>f.indexOf(g.presence_ref)<0);v.length>0&&(l[i]=v),b.length>0&&(c[i]=b)}else l[i]=u}),this.syncDiff(o,{joins:l,leaves:c},a,n)}static syncDiff(r,e,a,n){const{joins:o,leaves:s}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(o,(l,c)=>{var i;const u=(i=r[l])!==null&&i!==void 0?i:[];if(r[l]=this.cloneDeep(c),u.length>0){const p=r[l].map(h=>h.presence_ref),f=u.filter(h=>p.indexOf(h.presence_ref)<0);r[l].unshift(...f)}a(l,u,c)}),this.map(s,(l,c)=>{let i=r[l];if(!i)return;const u=c.map(p=>p.presence_ref);i=i.filter(p=>u.indexOf(p.presence_ref)<0),r[l]=i,n(l,i,c),i.length===0&&delete r[l]}),r}static map(r,e){return Object.getOwnPropertyNames(r).map(a=>e(a,r[a]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((e,a)=>{const n=r[a];return"metas"in n?e[a]=n.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):e[a]=n,e},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ex;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Ex||(Ex={}));var cu;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(cu||(cu={}));var Qs;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Qs||(Qs={}));class zl{constructor(r,e={config:{}},a){var n,o;if(this.topic=r,this.params=e,this.socket=a,this.bindings={},this.state=ma.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new lp(this,ss.join,this.params,this.timeout),this.rejoinTimer=new Lw(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ma.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ma.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ma.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ma.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ma.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ss.reply,{},(s,l)=>{this._trigger(this._replyEventName(l),s)}),this.presence=new lu(this),this.broadcastEndpointURL=Uw(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(r,e=this.timeout){var a,n,o;if(this.socket.isConnected()||this.socket.connect(),this.state==ma.closed){const{config:{broadcast:s,presence:l,private:c}}=this.params,i=(n=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(h=>h.filter))!==null&&n!==void 0?n:[],u=!!this.bindings[cu.PRESENCE]&&this.bindings[cu.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,p={},f={broadcast:s,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:i,private:c};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(h=>r==null?void 0:r(Qs.CHANNEL_ERROR,h)),this._onClose(()=>r==null?void 0:r(Qs.CLOSED)),this.updateJoinPayload(Object.assign({config:f},p)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",async({postgres_changes:h})=>{var v;if(this.socket._isManualToken()||this.socket.setAuth(),h===void 0){r==null||r(Qs.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,g=(v=b==null?void 0:b.length)!==null&&v!==void 0?v:0,x=[];for(let y=0;y<g;y++){const E=b[y],{filter:{event:N,schema:I,table:P,filter:V}}=E,U=h&&h[y];if(U&&U.event===N&&zl.isFilterValueEqual(U.schema,I)&&zl.isFilterValueEqual(U.table,P)&&zl.isFilterValueEqual(U.filter,V))x.push(Object.assign(Object.assign({},E),{id:U.id}));else{this.unsubscribe(),this.state=ma.errored,r==null||r(Qs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,r&&r(Qs.SUBSCRIBED);return}}).receive("error",h=>{this.state=ma.errored,r==null||r(Qs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{r==null||r(Qs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,e={}){return await this.send({type:"presence",event:"track",payload:r},e.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,e,a){return this.state===ma.joined&&r===cu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(r,e,a)}async httpSend(r,e,a={}){var n;if(e==null)return Promise.reject("Payload is required for httpSend()");const o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const s={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:e,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,s,(n=a.timeout)!==null&&n!==void 0?n:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const i=await l.json();c=i.error||i.message||c}catch{}return Promise.reject(new Error(c))}async send(r,e={}){var a,n;if(!this._canPush()&&r.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:s}=r,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:s,private:this.private}]})};try{const i=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=e.timeout)!==null&&a!==void 0?a:this.timeout);return await((n=i.body)===null||n===void 0?void 0:n.cancel()),i.ok?"ok":"error"}catch(i){return i.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var s,l,c;const i=this._push(r.type,r,e.timeout||this.timeout);r.type==="broadcast"&&!(!((c=(l=(s=this.params)===null||s===void 0?void 0:s.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),i.receive("ok",()=>o("ok")),i.receive("error",()=>o("error")),i.receive("timeout",()=>o("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=ma.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ss.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(n=>{a=new lp(this,ss.leave,{},r),a.receive("ok",()=>{e(),n("ok")}).receive("timeout",()=>{e(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(r=>r.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ma.closed,this.bindings={}}async _fetchWithTimeout(r,e,a){const n=new AbortController,o=setTimeout(()=>n.abort(),a),s=await this.socket.fetch(r,Object.assign(Object.assign({},e),{signal:n.signal}));return clearTimeout(o),s}_push(r,e,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new lp(this,r,e,a);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(r){if(r.startTimeout(),this.pushBuffer.push(r),this.pushBuffer.length>$9){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(r,e,a){return e}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,e,a){var n,o;const s=r.toLocaleLowerCase(),{close:l,error:c,leave:i,join:u}=ss;if(a&&[l,c,i,u].indexOf(s)>=0&&a!==this._joinRef())return;let f=this._onMessage(s,e,a);if(e&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(h=>{var v,b,g;return((v=h.filter)===null||v===void 0?void 0:v.event)==="*"||((g=(b=h.filter)===null||b===void 0?void 0:b.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===s}).map(h=>h.callback(f,a)):(o=this.bindings[s])===null||o===void 0||o.filter(h=>{var v,b,g,x,y,E;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in h){const N=h.id,I=(v=h.filter)===null||v===void 0?void 0:v.event;return N&&((b=e.ids)===null||b===void 0?void 0:b.includes(N))&&(I==="*"||(I==null?void 0:I.toLocaleLowerCase())===((g=e.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const N=(y=(x=h==null?void 0:h.filter)===null||x===void 0?void 0:x.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return N==="*"||N===((E=e==null?void 0:e.event)===null||E===void 0?void 0:E.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===s}).map(h=>{if(typeof f=="object"&&"ids"in f){const v=f.data,{schema:b,table:g,commit_timestamp:x,type:y,errors:E}=v;f=Object.assign(Object.assign({},{schema:b,table:g,commit_timestamp:x,eventType:y,new:{},old:{},errors:E}),this._getPayloadRecords(v))}h.callback(f,a)})}_isClosed(){return this.state===ma.closed}_isJoined(){return this.state===ma.joined}_isJoining(){return this.state===ma.joining}_isLeaving(){return this.state===ma.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,e,a){const n=r.toLocaleLowerCase(),o={type:n,filter:e,callback:a};return this.bindings[n]?this.bindings[n].push(o):this.bindings[n]=[o],this}_off(r,e){const a=r.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(n=>{var o;return!(((o=n.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===a&&zl.isEqual(n.filter,e))})),this}static isEqual(r,e){if(Object.keys(r).length!==Object.keys(e).length)return!1;for(const a in r)if(r[a]!==e[a])return!1;return!0}static isFilterValueEqual(r,e){return(r??void 0)===(e??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(ss.close,{},r)}_onError(r){this._on(ss.error,{},e=>r(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ma.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const e={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(e.new=Sx(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(e.old=Sx(r.columns,r.old_record)),e}}const cp=()=>{},of={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},K9=[1e3,2e3,5e3,1e4],Z9=1e4,J9=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Q9{constructor(r,e){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=zp,this.transport=null,this.heartbeatIntervalMs=of.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=cp,this.ref=0,this.reconnectTimer=null,this.vsn=_x,this.logger=cp,this.conn=null,this.sendBuffer=[],this.serializer=new V9,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...o)=>n(...o):(...o)=>fetch(...o),!(!((a=e==null?void 0:e.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=e.params.apikey,this.endPoint=`${r}/${$p.websocket}`,this.httpEndpoint=Uw(r),this._initializeOptions(e),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(e==null?void 0:e.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=P9.createWebSocket(this.endpointURL())}catch(r){this._setConnectionState("disconnected");const e=r.message;throw e.includes("Node.js")?new Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(r,e){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(r?this.conn.close(r,e??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(r){const e=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),e}async removeAllChannels(){const r=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),r}log(r,e,a){this.logger(r,e,a)}connectionState(){switch(this.conn&&this.conn.readyState){case Vi.connecting:return jo.Connecting;case Vi.open:return jo.Open;case Vi.closing:return jo.Closing;default:return jo.Closed}}isConnected(){return this.connectionState()===jo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(r,e={config:{}}){const a=`realtime:${r}`,n=this.getChannels().find(o=>o.topic===a);if(n)return n;{const o=new zl(`realtime:${r}`,e,this);return this.channels.push(o),o}}push(r){const{topic:e,event:a,payload:n,ref:o}=r,s=()=>{this.encode(r,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${e} ${a} (${o})`,n),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(r=null){this._authPromise=this._performAuth(r);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var r;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,(r=this.conn)===null||r===void 0||r.close(z9,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout()},of.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")}onHeartbeat(r){this.heartbeatCallback=r}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let e=this.channels.find(a=>a.topic===r&&(a._isJoined()||a._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${r}"`),e.unsubscribe())}_remove(r){this.channels=this.channels.filter(e=>e.topic!==r.topic)}_onConnMessage(r){this.decode(r.data,e=>{if(e.topic==="phoenix"&&e.event==="phx_reply")try{this.heartbeatCallback(e.payload.status==="ok"?"ok":"error")}catch(i){this.log("error","error in heartbeat callback",i)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:n,payload:o,ref:s}=e,l=s?`(${s})`:"",c=o.status||"";this.log("receive",`${c} ${a} ${n} ${l}`.trim(),o),this.channels.filter(i=>i._isMember(a)).forEach(i=>i._trigger(n,o,s)),this._triggerStateCallbacks("message",e)})}_clearTimer(r){var e;r==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):r==="reconnect"&&((e=this.reconnectTimer)===null||e===void 0||e.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r),this.conn.readyState===Vi.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Vi.open||this.conn.readyState===Vi.connecting)try{this.conn.close()}catch(r){this.log("error","Error closing connection",r)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(r=>r.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this._terminateWorker()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(r){var e;this._setConnectionState("disconnected"),this.log("transport","close",r),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout(),this._triggerStateCallbacks("close",r)}_onConnError(r){this._setConnectionState("disconnected"),this.log("transport",`${r}`),this._triggerChanError(),this._triggerStateCallbacks("error",r)}_triggerChanError(){this.channels.forEach(r=>r._trigger(ss.error))}_appendParams(r,e){if(Object.keys(e).length===0)return r;const a=r.match(/\?/)?"&":"?",n=new URLSearchParams(e);return`${r}${a}${n}`}_workerObjectUrl(r){let e;if(r)e=r;else{const a=new Blob([J9],{type:"application/javascript"});e=URL.createObjectURL(a)}return e}_setConnectionState(r,e=!1){this._connectionState=r,r==="connecting"?this._wasManualDisconnect=!1:r==="disconnecting"&&(this._wasManualDisconnect=e)}async _performAuth(r=null){let e,a=!1;if(r)e=r,a=!0;else if(this.accessToken)try{e=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),e=this.accessTokenValue}else e=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(n=>{const o={access_token:e,version:B9};e&&n.updateJoinPayload(o),n.joinedOnce&&n._isJoined()&&n._push(ss.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(r="general"){this._isManualToken()||this.setAuth().catch(e=>{this.log("error",`Error setting auth in ${r}`,e)})}_triggerStateCallbacks(r,e){try{this.stateChangeCallbacks[r].forEach(a=>{try{a(e)}catch(n){this.log("error",`error in ${r} callback`,n)}})}catch(a){this.log("error",`error triggering ${r} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new Lw(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},of.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(r){var e,a,n,o,s,l,c,i,u,p,f,h;switch(this.transport=(e=r==null?void 0:r.transport)!==null&&e!==void 0?e:null,this.timeout=(a=r==null?void 0:r.timeout)!==null&&a!==void 0?a:zp,this.heartbeatIntervalMs=(n=r==null?void 0:r.heartbeatIntervalMs)!==null&&n!==void 0?n:of.HEARTBEAT_INTERVAL,this.worker=(o=r==null?void 0:r.worker)!==null&&o!==void 0?o:!1,this.accessToken=(s=r==null?void 0:r.accessToken)!==null&&s!==void 0?s:null,this.heartbeatCallback=(l=r==null?void 0:r.heartbeatCallback)!==null&&l!==void 0?l:cp,this.vsn=(c=r==null?void 0:r.vsn)!==null&&c!==void 0?c:_x,r!=null&&r.params&&(this.params=r.params),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(i=r==null?void 0:r.reconnectAfterMs)!==null&&i!==void 0?i:v=>K9[v-1]||Z9,this.vsn){case Pw:this.encode=(u=r==null?void 0:r.encode)!==null&&u!==void 0?u:(v,b)=>b(JSON.stringify(v)),this.decode=(p=r==null?void 0:r.decode)!==null&&p!==void 0?p:(v,b)=>b(JSON.parse(v));break;case U9:this.encode=(f=r==null?void 0:r.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(h=r==null?void 0:r.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=r==null?void 0:r.workerUrl}}}var ku=class extends Error{constructor(t,r){var e;super(t),this.name="IcebergError",this.status=r.status,this.icebergType=r.icebergType,this.icebergCode=r.icebergCode,this.details=r.details,this.isCommitStateUnknown=r.icebergType==="CommitStateUnknownException"||[500,502,504].includes(r.status)&&((e=r.icebergType)==null?void 0:e.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function e7(t,r,e){const a=new URL(r,t);if(e)for(const[n,o]of Object.entries(e))o!==void 0&&a.searchParams.set(n,o);return a.toString()}async function t7(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function r7(t){const r=t.fetchImpl??globalThis.fetch;return{async request({method:e,path:a,query:n,body:o,headers:s}){const l=e7(t.baseUrl,a,n),c=await t7(t.auth),i=await r(l,{method:e,headers:{...o?{"Content-Type":"application/json"}:{},...c,...s},body:o?JSON.stringify(o):void 0}),u=await i.text(),p=(i.headers.get("content-type")||"").includes("application/json"),f=p&&u?JSON.parse(u):u;if(!i.ok){const h=p?f:void 0,v=h==null?void 0:h.error;throw new ku((v==null?void 0:v.message)??`Request failed with status ${i.status}`,{status:i.status,icebergType:v==null?void 0:v.type,icebergCode:v==null?void 0:v.code,details:h})}return{status:i.status,headers:i.headers,data:f}}}}function lf(t){return t.join("")}var a7=class{constructor(t,r=""){this.client=t,this.prefix=r}async listNamespaces(t){const r=t?{parent:lf(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:r})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(t,r){const e={namespace:t.namespace,properties:r==null?void 0:r.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:e})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${lf(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${lf(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${lf(t.namespace)}`}),!0}catch(r){if(r instanceof ku&&r.status===404)return!1;throw r}}async createNamespaceIfNotExists(t,r){try{return await this.createNamespace(t,r)}catch(e){if(e instanceof ku&&e.status===409)return;throw e}}};function El(t){return t.join("")}var n7=class{constructor(t,r="",e){this.client=t,this.prefix=r,this.accessDelegation=e}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables`})).data.identifiers}async createTable(t,r){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables`,body:r,headers:e})).data.metadata}async updateTable(t,r){const e=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables/${t.name}`,body:r});return{"metadata-location":e.data["metadata-location"],metadata:e.data.metadata}}async dropTable(t,r){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((r==null?void 0:r.purge)??!1)}})}async loadTable(t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables/${t.name}`,headers:r})).data.metadata}async tableExists(t){const r={};this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables/${t.name}`,headers:r}),!0}catch(e){if(e instanceof ku&&e.status===404)return!1;throw e}}async createTableIfNotExists(t,r){try{return await this.createTable(t,r)}catch(e){if(e instanceof ku&&e.status===409)return await this.loadTable({namespace:t.namespace,name:r.name});throw e}}},s7=class{constructor(t){var a;let r="v1";t.catalogName&&(r+=`/${t.catalogName}`);const e=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=r7({baseUrl:e,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(a=t.accessDelegation)==null?void 0:a.join(","),this.namespaceOps=new a7(this.client,r),this.tableOps=new n7(this.client,r,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,r){return this.namespaceOps.createNamespace(t,r)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,r){return this.tableOps.createTable(t,r)}async updateTable(t,r){return this.tableOps.updateTable(t,r)}async dropTable(t,r){await this.tableOps.dropTable(t,r)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,r){return this.namespaceOps.createNamespaceIfNotExists(t,r)}async createTableIfNotExists(t,r){return this.tableOps.createTableIfNotExists(t,r)}},Gf=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function zr(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var i7=class extends Gf{constructor(t,r,e){super(t),this.name="StorageApiError",this.status=r,this.statusCode=e}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Hp=class extends Gf{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}};const Mm=t=>t?(...r)=>t(...r):(...r)=>fetch(...r),o7=()=>Response,qp=t=>{if(Array.isArray(t))return t.map(e=>qp(e));if(typeof t=="function"||t!==Object(t))return t;const r={};return Object.entries(t).forEach(([e,a])=>{const n=e.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));r[n]=qp(a)}),r},l7=t=>{if(typeof t!="object"||t===null)return!1;const r=Object.getPrototypeOf(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},c7=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Eu(t){"@babel/helpers - typeof";return Eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Eu(t)}function u7(t,r){if(Eu(t)!="object"||!t)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var a=e.call(t,r);if(Eu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function d7(t){var r=u7(t,"string");return Eu(r)=="symbol"?r:r+""}function f7(t,r,e){return(r=d7(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function Tx(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,a)}return e}function Yt(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?Tx(Object(e),!0).forEach(function(a){f7(t,a,e[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Tx(Object(e)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(e,a))})}return t}const up=t=>{var r;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(r=t.error)===null||r===void 0?void 0:r.message)||JSON.stringify(t)},h7=async(t,r,e)=>{t instanceof await o7()&&!(e!=null&&e.noResolveJson)?t.json().then(a=>{const n=t.status||500,o=(a==null?void 0:a.statusCode)||n+"";r(new i7(up(a),n,o))}).catch(a=>{r(new Hp(up(a),a))}):r(new Hp(up(t),t))},p7=(t,r,e,a)=>{const n={method:t,headers:(r==null?void 0:r.headers)||{}};return t==="GET"||!a?n:(l7(a)?(n.headers=Yt({"Content-Type":"application/json"},r==null?void 0:r.headers),n.body=JSON.stringify(a)):n.body=a,r!=null&&r.duplex&&(n.duplex=r.duplex),Yt(Yt({},n),e))};async function Wu(t,r,e,a,n,o){return new Promise((s,l)=>{t(e,p7(r,a,n,o)).then(c=>{if(!c.ok)throw c;return a!=null&&a.noResolveJson?c:c.json()}).then(c=>s(c)).catch(c=>h7(c,l,a))})}async function Tu(t,r,e,a){return Wu(t,"GET",r,e,a)}async function ns(t,r,e,a,n){return Wu(t,"POST",r,a,n,e)}async function Wp(t,r,e,a,n){return Wu(t,"PUT",r,a,n,e)}async function m7(t,r,e,a){return Wu(t,"HEAD",r,Yt(Yt({},e),{},{noResolveJson:!0}),a)}async function Rm(t,r,e,a,n){return Wu(t,"DELETE",r,a,n,e)}var g7=class{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(zr(r))return{data:null,error:r};throw r}}};let zw;zw=Symbol.toStringTag;var v7=class{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[zw]="BlobDownloadBuilder",this.promise=null}asStream(){return new g7(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(zr(r))return{data:null,error:r};throw r}}};const b7={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ax={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var x7=class{constructor(t,r={},e,a){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=e,this.fetch=Mm(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,r,e,a){var n=this;try{let o;const s=Yt(Yt({},Ax),a);let l=Yt(Yt({},n.headers),t==="POST"&&{"x-upsert":String(s.upsert)});const c=s.metadata;typeof Blob<"u"&&e instanceof Blob?(o=new FormData,o.append("cacheControl",s.cacheControl),c&&o.append("metadata",n.encodeMetadata(c)),o.append("",e)):typeof FormData<"u"&&e instanceof FormData?(o=e,o.has("cacheControl")||o.append("cacheControl",s.cacheControl),c&&!o.has("metadata")&&o.append("metadata",n.encodeMetadata(c))):(o=e,l["cache-control"]=`max-age=${s.cacheControl}`,l["content-type"]=s.contentType,c&&(l["x-metadata"]=n.toBase64(n.encodeMetadata(c))),(typeof ReadableStream<"u"&&o instanceof ReadableStream||o&&typeof o=="object"&&"pipe"in o&&typeof o.pipe=="function")&&!s.duplex&&(s.duplex="half")),a!=null&&a.headers&&(l=Yt(Yt({},l),a.headers));const i=n._removeEmptyFolders(r),u=n._getFinalPath(i),p=await(t=="PUT"?Wp:ns)(n.fetch,`${n.url}/object/${u}`,o,Yt({headers:l},s!=null&&s.duplex?{duplex:s.duplex}:{}));return{data:{path:i,id:p.Id,fullPath:p.Key},error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(zr(o))return{data:null,error:o};throw o}}async upload(t,r,e){return this.uploadOrUpdate("POST",t,r,e)}async uploadToSignedUrl(t,r,e,a){var n=this;const o=n._removeEmptyFolders(t),s=n._getFinalPath(o),l=new URL(n.url+`/object/upload/sign/${s}`);l.searchParams.set("token",r);try{let c;const i=Yt({upsert:Ax.upsert},a),u=Yt(Yt({},n.headers),{"x-upsert":String(i.upsert)});return typeof Blob<"u"&&e instanceof Blob?(c=new FormData,c.append("cacheControl",i.cacheControl),c.append("",e)):typeof FormData<"u"&&e instanceof FormData?(c=e,c.append("cacheControl",i.cacheControl)):(c=e,u["cache-control"]=`max-age=${i.cacheControl}`,u["content-type"]=i.contentType),{data:{path:o,fullPath:(await Wp(n.fetch,l.toString(),c,{headers:u})).Key},error:null}}catch(c){if(n.shouldThrowOnError)throw c;if(zr(c))return{data:null,error:c};throw c}}async createSignedUploadUrl(t,r){var e=this;try{let a=e._getFinalPath(t);const n=Yt({},e.headers);r!=null&&r.upsert&&(n["x-upsert"]="true");const o=await ns(e.fetch,`${e.url}/object/upload/sign/${a}`,{},{headers:n}),s=new URL(e.url+o.url),l=s.searchParams.get("token");if(!l)throw new Gf("No token returned by API");return{data:{signedUrl:s.toString(),path:t,token:l},error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(zr(a))return{data:null,error:a};throw a}}async update(t,r,e){return this.uploadOrUpdate("PUT",t,r,e)}async move(t,r,e){var a=this;try{return{data:await ns(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:t,destinationKey:r,destinationBucket:e==null?void 0:e.destinationBucket},{headers:a.headers}),error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(zr(n))return{data:null,error:n};throw n}}async copy(t,r,e){var a=this;try{return{data:{path:(await ns(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:t,destinationKey:r,destinationBucket:e==null?void 0:e.destinationBucket},{headers:a.headers})).Key},error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(zr(n))return{data:null,error:n};throw n}}async createSignedUrl(t,r,e){var a=this;try{let n=a._getFinalPath(t),o=await ns(a.fetch,`${a.url}/object/sign/${n}`,Yt({expiresIn:r},e!=null&&e.transform?{transform:e.transform}:{}),{headers:a.headers});const s=e!=null&&e.download?`&download=${e.download===!0?"":e.download}`:"";return o={signedUrl:encodeURI(`${a.url}${o.signedURL}${s}`)},{data:o,error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(zr(n))return{data:null,error:n};throw n}}async createSignedUrls(t,r,e){var a=this;try{const n=await ns(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:r,paths:t},{headers:a.headers}),o=e!=null&&e.download?`&download=${e.download===!0?"":e.download}`:"";return{data:n.map(s=>Yt(Yt({},s),{},{signedUrl:s.signedURL?encodeURI(`${a.url}${s.signedURL}${o}`):null})),error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(zr(n))return{data:null,error:n};throw n}}download(t,r){const e=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),n=a?`?${a}`:"",o=this._getFinalPath(t),s=()=>Tu(this.fetch,`${this.url}/${e}/${o}${n}`,{headers:this.headers,noResolveJson:!0});return new v7(s,this.shouldThrowOnError)}async info(t){var r=this;const e=r._getFinalPath(t);try{return{data:qp(await Tu(r.fetch,`${r.url}/object/info/${e}`,{headers:r.headers})),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(zr(a))return{data:null,error:a};throw a}}async exists(t){var r=this;const e=r._getFinalPath(t);try{return await m7(r.fetch,`${r.url}/object/${e}`,{headers:r.headers}),{data:!0,error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(zr(a)&&a instanceof Hp){const n=a.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:a}}throw a}}getPublicUrl(t,r){const e=this._getFinalPath(t),a=[],n=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";n!==""&&a.push(n);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});s!==""&&a.push(s);let l=a.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${e}${l}`)}}}async remove(t){var r=this;try{return{data:await Rm(r.fetch,`${r.url}/object/${r.bucketId}`,{prefixes:t},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(zr(e))return{data:null,error:e};throw e}}async list(t,r,e){var a=this;try{const n=Yt(Yt(Yt({},b7),r),{},{prefix:t||""});return{data:await ns(a.fetch,`${a.url}/object/list/${a.bucketId}`,n,{headers:a.headers},e),error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(zr(n))return{data:null,error:n};throw n}}async listV2(t,r){var e=this;try{const a=Yt({},t);return{data:await ns(e.fetch,`${e.url}/object/list-v2/${e.bucketId}`,a,{headers:e.headers},r),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(zr(a))return{data:null,error:a};throw a}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}};const $w="2.89.0",Vw={"X-Client-Info":`storage-js/${$w}`};var y7=class{constructor(t,r={},e,a){this.shouldThrowOnError=!1;const n=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase.")),this.url=n.href.replace(/\/$/,""),this.headers=Yt(Yt({},Vw),r),this.fetch=Mm(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var r=this;try{const e=r.listBucketOptionsToQueryString(t);return{data:await Tu(r.fetch,`${r.url}/bucket${e}`,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(zr(e))return{data:null,error:e};throw e}}async getBucket(t){var r=this;try{return{data:await Tu(r.fetch,`${r.url}/bucket/${t}`,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(zr(e))return{data:null,error:e};throw e}}async createBucket(t,r={public:!1}){var e=this;try{return{data:await ns(e.fetch,`${e.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:e.headers}),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(zr(a))return{data:null,error:a};throw a}}async updateBucket(t,r){var e=this;try{return{data:await Wp(e.fetch,`${e.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:e.headers}),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(zr(a))return{data:null,error:a};throw a}}async emptyBucket(t){var r=this;try{return{data:await ns(r.fetch,`${r.url}/bucket/${t}/empty`,{},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(zr(e))return{data:null,error:e};throw e}}async deleteBucket(t){var r=this;try{return{data:await Rm(r.fetch,`${r.url}/bucket/${t}`,{},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(zr(e))return{data:null,error:e};throw e}}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}},w7=class{constructor(t,r={},e){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Yt(Yt({},Vw),r),this.fetch=Mm(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var r=this;try{return{data:await ns(r.fetch,`${r.url}/bucket`,{name:t},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(zr(e))return{data:null,error:e};throw e}}async listBuckets(t){var r=this;try{const e=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&e.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&e.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&e.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&e.set("sortOrder",t.sortOrder),t!=null&&t.search&&e.set("search",t.search);const a=e.toString(),n=a?`${r.url}/bucket?${a}`:`${r.url}/bucket`;return{data:await Tu(r.fetch,n,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(zr(e))return{data:null,error:e};throw e}}async deleteBucket(t){var r=this;try{return{data:await Rm(r.fetch,`${r.url}/bucket/${t}`,{},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(zr(e))return{data:null,error:e};throw e}}from(t){var r=this;if(!c7(t))throw new Gf("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const e=new s7({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>r.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(e,{get(n,o){const s=n[o];return typeof s!="function"?s:async(...l)=>{try{return{data:await s.apply(n,l),error:null}}catch(c){if(a)throw c;return{data:null,error:c}}}}})}};const Im={"X-Client-Info":`storage-js/${$w}`,"Content-Type":"application/json"};var Hw=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function _n(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var dp=class extends Hw{constructor(t,r,e){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=e}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},_7=class extends Hw{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}};const Fm=t=>t?(...r)=>t(...r):(...r)=>fetch(...r),S7=t=>{if(typeof t!="object"||t===null)return!1;const r=Object.getPrototypeOf(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Cx=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),k7=async(t,r,e)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(e!=null&&e.noResolveJson)){const a=t.status||500,n=t;if(typeof n.json=="function")n.json().then(o=>{const s=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||a+"";r(new dp(Cx(o),a,s))}).catch(()=>{const o=a+"";r(new dp(n.statusText||`HTTP ${a} error`,a,o))});else{const o=a+"";r(new dp(n.statusText||`HTTP ${a} error`,a,o))}}else r(new _7(Cx(t),t))},E7=(t,r,e,a)=>{const n={method:t,headers:(r==null?void 0:r.headers)||{}};return a?(S7(a)?(n.headers=Yt({"Content-Type":"application/json"},r==null?void 0:r.headers),n.body=JSON.stringify(a)):n.body=a,Yt(Yt({},n),e)):n};async function T7(t,r,e,a,n,o){return new Promise((s,l)=>{t(e,E7(r,a,n,o)).then(c=>{if(!c.ok)throw c;if(a!=null&&a.noResolveJson)return c;const i=c.headers.get("content-type");return!i||!i.includes("application/json")?{}:c.json()}).then(c=>s(c)).catch(c=>k7(c,l,a))})}async function Sn(t,r,e,a,n){return T7(t,"POST",r,a,n,e)}var A7=class{constructor(t,r={},e){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Yt(Yt({},Im),r),this.fetch=Fm(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var r=this;try{return{data:await Sn(r.fetch,`${r.url}/CreateIndex`,t,{headers:r.headers})||{},error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_n(e))return{data:null,error:e};throw e}}async getIndex(t,r){var e=this;try{return{data:await Sn(e.fetch,`${e.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:e.headers}),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(_n(a))return{data:null,error:a};throw a}}async listIndexes(t){var r=this;try{return{data:await Sn(r.fetch,`${r.url}/ListIndexes`,t,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_n(e))return{data:null,error:e};throw e}}async deleteIndex(t,r){var e=this;try{return{data:await Sn(e.fetch,`${e.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:e.headers})||{},error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(_n(a))return{data:null,error:a};throw a}}},C7=class{constructor(t,r={},e){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Yt(Yt({},Im),r),this.fetch=Fm(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var r=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Sn(r.fetch,`${r.url}/PutVectors`,t,{headers:r.headers})||{},error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_n(e))return{data:null,error:e};throw e}}async getVectors(t){var r=this;try{return{data:await Sn(r.fetch,`${r.url}/GetVectors`,t,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_n(e))return{data:null,error:e};throw e}}async listVectors(t){var r=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await Sn(r.fetch,`${r.url}/ListVectors`,t,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_n(e))return{data:null,error:e};throw e}}async queryVectors(t){var r=this;try{return{data:await Sn(r.fetch,`${r.url}/QueryVectors`,t,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_n(e))return{data:null,error:e};throw e}}async deleteVectors(t){var r=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Sn(r.fetch,`${r.url}/DeleteVectors`,t,{headers:r.headers})||{},error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_n(e))return{data:null,error:e};throw e}}},N7=class{constructor(t,r={},e){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Yt(Yt({},Im),r),this.fetch=Fm(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var r=this;try{return{data:await Sn(r.fetch,`${r.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:r.headers})||{},error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_n(e))return{data:null,error:e};throw e}}async getBucket(t){var r=this;try{return{data:await Sn(r.fetch,`${r.url}/GetVectorBucket`,{vectorBucketName:t},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_n(e))return{data:null,error:e};throw e}}async listBuckets(t={}){var r=this;try{return{data:await Sn(r.fetch,`${r.url}/ListVectorBuckets`,t,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_n(e))return{data:null,error:e};throw e}}async deleteBucket(t){var r=this;try{return{data:await Sn(r.fetch,`${r.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:r.headers})||{},error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_n(e))return{data:null,error:e};throw e}}},j7=class extends N7{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new O7(this.url,this.headers,t,this.fetch)}async createBucket(t){var r=()=>super.createBucket,e=this;return r().call(e,t)}async getBucket(t){var r=()=>super.getBucket,e=this;return r().call(e,t)}async listBuckets(t={}){var r=()=>super.listBuckets,e=this;return r().call(e,t)}async deleteBucket(t){var r=()=>super.deleteBucket,e=this;return r().call(e,t)}},O7=class extends A7{constructor(t,r,e,a){super(t,r,a),this.vectorBucketName=e}async createIndex(t){var r=()=>super.createIndex,e=this;return r().call(e,Yt(Yt({},t),{},{vectorBucketName:e.vectorBucketName}))}async listIndexes(t={}){var r=()=>super.listIndexes,e=this;return r().call(e,Yt(Yt({},t),{},{vectorBucketName:e.vectorBucketName}))}async getIndex(t){var r=()=>super.getIndex,e=this;return r().call(e,e.vectorBucketName,t)}async deleteIndex(t){var r=()=>super.deleteIndex,e=this;return r().call(e,e.vectorBucketName,t)}index(t){return new D7(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},D7=class extends C7{constructor(t,r,e,a,n){super(t,r,n),this.vectorBucketName=e,this.indexName=a}async putVectors(t){var r=()=>super.putVectors,e=this;return r().call(e,Yt(Yt({},t),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}async getVectors(t){var r=()=>super.getVectors,e=this;return r().call(e,Yt(Yt({},t),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}async listVectors(t={}){var r=()=>super.listVectors,e=this;return r().call(e,Yt(Yt({},t),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}async queryVectors(t){var r=()=>super.queryVectors,e=this;return r().call(e,Yt(Yt({},t),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}async deleteVectors(t){var r=()=>super.deleteVectors,e=this;return r().call(e,Yt(Yt({},t),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}},M7=class extends y7{constructor(t,r={},e,a){super(t,r,e,a)}from(t){return new x7(this.url,this.headers,t,this.fetch)}get vectors(){return new j7(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new w7(this.url+"/iceberg",this.headers,this.fetch)}};const qw="2.89.0",Pl=30*1e3,Gp=3,fp=Gp*Pl,R7="http://localhost:9999",I7="supabase.auth.token",F7={"X-Client-Info":`gotrue-js/${qw}`},Yp="X-Supabase-Api-Version",Ww={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},P7=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,L7=10*60*1e3;class Au extends Error{constructor(r,e,a){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=a}}function Ut(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class B7 extends Au{constructor(r,e,a){super(r,e,a),this.name="AuthApiError",this.status=e,this.code=a}}function U7(t){return Ut(t)&&t.name==="AuthApiError"}class Oo extends Au{constructor(r,e){super(r),this.name="AuthUnknownError",this.originalError=e}}class li extends Au{constructor(r,e,a,n){super(r,a,n),this.name=e,this.status=a}}class vn extends li{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function z7(t){return Ut(t)&&t.name==="AuthSessionMissingError"}class Tl extends li{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class cf extends li{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class uf extends li{constructor(r,e=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function $7(t){return Ut(t)&&t.name==="AuthImplicitGrantRedirectError"}class Nx extends li{constructor(r,e=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class V7 extends li{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Xp extends li{constructor(r,e){super(r,"AuthRetryableFetchError",e,void 0)}}function hp(t){return Ut(t)&&t.name==="AuthRetryableFetchError"}class jx extends li{constructor(r,e,a){super(r,"AuthWeakPasswordError",e,"weak_password"),this.reasons=a}}class Kp extends li{constructor(r){super(r,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ef="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ox=` 	
\r=`.split(""),H7=(()=>{const t=new Array(128);for(let r=0;r<t.length;r+=1)t[r]=-1;for(let r=0;r<Ox.length;r+=1)t[Ox[r].charCodeAt(0)]=-2;for(let r=0;r<Ef.length;r+=1)t[Ef[r].charCodeAt(0)]=r;return t})();function Dx(t,r,e){if(t!==null)for(r.queue=r.queue<<8|t,r.queuedBits+=8;r.queuedBits>=6;){const a=r.queue>>r.queuedBits-6&63;e(Ef[a]),r.queuedBits-=6}else if(r.queuedBits>0)for(r.queue=r.queue<<6-r.queuedBits,r.queuedBits=6;r.queuedBits>=6;){const a=r.queue>>r.queuedBits-6&63;e(Ef[a]),r.queuedBits-=6}}function Gw(t,r,e){const a=H7[t];if(a>-1)for(r.queue=r.queue<<6|a,r.queuedBits+=6;r.queuedBits>=8;)e(r.queue>>r.queuedBits-8&255),r.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Mx(t){const r=[],e=s=>{r.push(String.fromCodePoint(s))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},o=s=>{G7(s,a,e)};for(let s=0;s<t.length;s+=1)Gw(t.charCodeAt(s),n,o);return r.join("")}function q7(t,r){if(t<=127){r(t);return}else if(t<=2047){r(192|t>>6),r(128|t&63);return}else if(t<=65535){r(224|t>>12),r(128|t>>6&63),r(128|t&63);return}else if(t<=1114111){r(240|t>>18),r(128|t>>12&63),r(128|t>>6&63),r(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function W7(t,r){for(let e=0;e<t.length;e+=1){let a=t.charCodeAt(e);if(a>55295&&a<=56319){const n=(a-55296)*1024&65535;a=(t.charCodeAt(e+1)-56320&65535|n)+65536,e+=1}q7(a,r)}}function G7(t,r,e){if(r.utf8seq===0){if(t<=127){e(t);return}for(let a=1;a<6;a+=1)if((t>>7-a&1)===0){r.utf8seq=a;break}if(r.utf8seq===2)r.codepoint=t&31;else if(r.utf8seq===3)r.codepoint=t&15;else if(r.utf8seq===4)r.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");r.utf8seq-=1}else if(r.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");r.codepoint=r.codepoint<<6|t&63,r.utf8seq-=1,r.utf8seq===0&&e(r.codepoint)}}function ql(t){const r=[],e={queue:0,queuedBits:0},a=n=>{r.push(n)};for(let n=0;n<t.length;n+=1)Gw(t.charCodeAt(n),e,a);return new Uint8Array(r)}function Y7(t){const r=[];return W7(t,e=>r.push(e)),new Uint8Array(r)}function Ro(t){const r=[],e={queue:0,queuedBits:0},a=n=>{r.push(n)};return t.forEach(n=>Dx(n,e,a)),Dx(null,e,a),r.join("")}function X7(t){return Math.round(Date.now()/1e3)+t}function K7(){return Symbol("auth-callback")}const Ca=()=>typeof window<"u"&&typeof document<"u",Eo={tested:!1,writable:!1},Yw=()=>{if(!Ca())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Eo.tested)return Eo.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Eo.tested=!0,Eo.writable=!0}catch{Eo.tested=!0,Eo.writable=!1}return Eo.writable};function Z7(t){const r={},e=new URL(t);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((n,o)=>{r[o]=n})}catch{}return e.searchParams.forEach((a,n)=>{r[n]=a}),r}const Xw=t=>t?(...r)=>t(...r):(...r)=>fetch(...r),J7=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Ll=async(t,r,e)=>{await t.setItem(r,JSON.stringify(e))},To=async(t,r)=>{const e=await t.getItem(r);if(!e)return null;try{return JSON.parse(e)}catch{return e}},Aa=async(t,r)=>{await t.removeItem(r)};class Yf{constructor(){this.promise=new Yf.promiseConstructor((r,e)=>{this.resolve=r,this.reject=e})}}Yf.promiseConstructor=Promise;function pp(t){const r=t.split(".");if(r.length!==3)throw new Kp("Invalid JWT structure");for(let a=0;a<r.length;a++)if(!P7.test(r[a]))throw new Kp("JWT not in base64url format");return{header:JSON.parse(Mx(r[0])),payload:JSON.parse(Mx(r[1])),signature:ql(r[2]),raw:{header:r[0],payload:r[1]}}}async function Q7(t){return await new Promise(r=>{setTimeout(()=>r(null),t)})}function eC(t,r){return new Promise((a,n)=>{(async()=>{for(let o=0;o<1/0;o++)try{const s=await t(o);if(!r(o,null,s)){a(s);return}}catch(s){if(!r(o,s)){n(s);return}}})()})}function tC(t){return("0"+t.toString(16)).substr(-2)}function rC(){const r=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=e.length;let n="";for(let o=0;o<56;o++)n+=e.charAt(Math.floor(Math.random()*a));return n}return crypto.getRandomValues(r),Array.from(r,tC).join("")}async function aC(t){const e=new TextEncoder().encode(t),a=await crypto.subtle.digest("SHA-256",e),n=new Uint8Array(a);return Array.from(n).map(o=>String.fromCharCode(o)).join("")}async function nC(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const e=await aC(t);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Al(t,r,e=!1){const a=rC();let n=a;e&&(n+="/PASSWORD_RECOVERY"),await Ll(t,`${r}-code-verifier`,n);const o=await nC(a);return[o,a===o?"plain":"s256"]}const sC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function iC(t){const r=t.headers.get(Yp);if(!r||!r.match(sC))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}function oC(t){if(!t)throw new Error("Missing exp claim");const r=Math.floor(Date.now()/1e3);if(t<=r)throw new Error("JWT has expired")}function lC(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const cC=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Cl(t){if(!cC.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function mp(){const t={};return new Proxy(t,{get:(r,e)=>{if(e==="__isUserNotAvailableProxy")return!0;if(typeof e=="symbol"){const a=e.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${e}" property of the session object is not supported. Please use getUser() instead.`)},set:(r,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(r,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function uC(t,r){return new Proxy(t,{get:(e,a,n)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const o=a.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)"||o==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(e,a,n)}return!r.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),r.value=!0),Reflect.get(e,a,n)}})}function Rx(t){return JSON.parse(JSON.stringify(t))}const No=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),dC=[502,503,504];async function Ix(t){var r;if(!J7(t))throw new Xp(No(t),0);if(dC.includes(t.status))throw new Xp(No(t),t.status);let e;try{e=await t.json()}catch(o){throw new Oo(No(o),o)}let a;const n=iC(t);if(n&&n.getTime()>=Ww["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?a=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(a=e.error_code),a){if(a==="weak_password")throw new jx(No(e),t.status,((r=e.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(a==="session_not_found")throw new vn}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((o,s)=>o&&typeof s=="string",!0))throw new jx(No(e),t.status,e.weak_password.reasons);throw new B7(No(e),t.status||500,a)}const fC=(t,r,e,a)=>{const n={method:t,headers:(r==null?void 0:r.headers)||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r==null?void 0:r.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),e))};async function Gt(t,r,e,a){var n;const o=Object.assign({},a==null?void 0:a.headers);o[Yp]||(o[Yp]=Ww["2024-01-01"].name),a!=null&&a.jwt&&(o.Authorization=`Bearer ${a.jwt}`);const s=(n=a==null?void 0:a.query)!==null&&n!==void 0?n:{};a!=null&&a.redirectTo&&(s.redirect_to=a.redirectTo);const l=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",c=await hC(t,r,e+l,{headers:o,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(c):{data:Object.assign({},c),error:null}}async function hC(t,r,e,a,n,o){const s=fC(r,a,n,o);let l;try{l=await t(e,Object.assign({},s))}catch(c){throw console.error(c),new Xp(No(c),0)}if(l.ok||await Ix(l),a!=null&&a.noResolveJson)return l;try{return await l.json()}catch(c){await Ix(c)}}function as(t){var r;let e=null;gC(t)&&(e=Object.assign({},t),t.expires_at||(e.expires_at=X7(t.expires_in)));const a=(r=t.user)!==null&&r!==void 0?r:t;return{data:{session:e,user:a},error:null}}function Fx(t){const r=as(t);return!r.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((e,a)=>e&&typeof a=="string",!0)&&(r.data.weak_password=t.weak_password),r}function Hi(t){var r;return{data:{user:(r=t.user)!==null&&r!==void 0?r:t},error:null}}function pC(t){return{data:t,error:null}}function mC(t){const{action_link:r,email_otp:e,hashed_token:a,redirect_to:n,verification_type:o}=t,s=zf(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:r,email_otp:e,hashed_token:a,redirect_to:n,verification_type:o},c=Object.assign({},s);return{data:{properties:l,user:c},error:null}}function Px(t){return t}function gC(t){return t.access_token&&t.refresh_token&&t.expires_in}const gp=["global","local","others"];class vC{constructor({url:r="",headers:e={},fetch:a}){this.url=r,this.headers=e,this.fetch=Xw(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(r,e=gp[0]){if(gp.indexOf(e)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${gp.join(", ")}`);try{return await Gt(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(a){if(Ut(a))return{data:null,error:a};throw a}}async inviteUserByEmail(r,e={}){try{return await Gt(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:Hi})}catch(a){if(Ut(a))return{data:{user:null},error:a};throw a}}async generateLink(r){try{const{options:e}=r,a=zf(r,["options"]),n=Object.assign(Object.assign({},a),e);return"newEmail"in a&&(n.new_email=a==null?void 0:a.newEmail,delete n.newEmail),await Gt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:mC,redirectTo:e==null?void 0:e.redirectTo})}catch(e){if(Ut(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(r){try{return await Gt(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:Hi})}catch(e){if(Ut(e))return{data:{user:null},error:e};throw e}}async listUsers(r){var e,a,n,o,s,l,c;try{const i={nextPage:null,lastPage:0,total:0},u=await Gt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(e=r==null?void 0:r.page)===null||e===void 0?void 0:e.toString())!==null&&a!==void 0?a:"",per_page:(o=(n=r==null?void 0:r.perPage)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:""},xform:Px});if(u.error)throw u.error;const p=await u.json(),f=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(v=>{const b=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(v.split(";")[1].split("=")[1]);i[`${g}Page`]=b}),i.total=parseInt(f)),{data:Object.assign(Object.assign({},p),i),error:null}}catch(i){if(Ut(i))return{data:{users:[]},error:i};throw i}}async getUserById(r){Cl(r);try{return await Gt(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:Hi})}catch(e){if(Ut(e))return{data:{user:null},error:e};throw e}}async updateUserById(r,e){Cl(r);try{return await Gt(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:e,headers:this.headers,xform:Hi})}catch(a){if(Ut(a))return{data:{user:null},error:a};throw a}}async deleteUser(r,e=!1){Cl(r);try{return await Gt(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:e},xform:Hi})}catch(a){if(Ut(a))return{data:{user:null},error:a};throw a}}async _listFactors(r){Cl(r.userId);try{const{data:e,error:a}=await Gt(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:e,error:a}}catch(e){if(Ut(e))return{data:null,error:e};throw e}}async _deleteFactor(r){Cl(r.userId),Cl(r.id);try{return{data:await Gt(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(e){if(Ut(e))return{data:null,error:e};throw e}}async _listOAuthClients(r){var e,a,n,o,s,l,c;try{const i={nextPage:null,lastPage:0,total:0},u=await Gt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(e=r==null?void 0:r.page)===null||e===void 0?void 0:e.toString())!==null&&a!==void 0?a:"",per_page:(o=(n=r==null?void 0:r.perPage)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:""},xform:Px});if(u.error)throw u.error;const p=await u.json(),f=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(v=>{const b=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(v.split(";")[1].split("=")[1]);i[`${g}Page`]=b}),i.total=parseInt(f)),{data:Object.assign(Object.assign({},p),i),error:null}}catch(i){if(Ut(i))return{data:{clients:[]},error:i};throw i}}async _createOAuthClient(r){try{return await Gt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:r,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(Ut(e))return{data:null,error:e};throw e}}async _getOAuthClient(r){try{return await Gt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${r}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(Ut(e))return{data:null,error:e};throw e}}async _updateOAuthClient(r,e){try{return await Gt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${r}`,{body:e,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(Ut(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(r){try{return await Gt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${r}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(e){if(Ut(e))return{data:null,error:e};throw e}}async _regenerateOAuthClientSecret(r){try{return await Gt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${r}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(Ut(e))return{data:null,error:e};throw e}}}function Lx(t={}){return{getItem:r=>t[r]||null,setItem:(r,e)=>{t[r]=e},removeItem:r=>{delete t[r]}}}const Nl={debug:!!(globalThis&&Yw()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Kw extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class bC extends Kw{}async function xC(t,r,e){Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,r);const a=new globalThis.AbortController;return r>0&&setTimeout(()=>{a.abort(),Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async n=>{if(n){Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await e()}finally{Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(r===0)throw Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new bC(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Nl.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await e()}}))}function yC(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Zw(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function wC(t){return parseInt(t,16)}function _C(t){const r=new TextEncoder().encode(t);return"0x"+Array.from(r,a=>a.toString(16).padStart(2,"0")).join("")}function SC(t){var r;const{chainId:e,domain:a,expirationTime:n,issuedAt:o=new Date,nonce:s,notBefore:l,requestId:c,resources:i,scheme:u,uri:p,version:f}=t;{if(!Number.isInteger(e))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${e}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(s&&s.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${s}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((r=t.statement)===null||r===void 0)&&r.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const h=Zw(t.address),v=u?`${u}://${a}`:a,b=t.statement?`${t.statement}
`:"",g=`${v} wants you to sign in with your Ethereum account:
${h}

${b}`;let x=`URI: ${p}
Version: ${f}
Chain ID: ${e}${s?`
Nonce: ${s}`:""}
Issued At: ${o.toISOString()}`;if(n&&(x+=`
Expiration Time: ${n.toISOString()}`),l&&(x+=`
Not Before: ${l.toISOString()}`),c&&(x+=`
Request ID: ${c}`),i){let y=`
Resources:`;for(const E of i){if(!E||typeof E!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${E}`);y+=`
- ${E}`}x+=y}return`${g}
${x}`}class la extends Error{constructor({message:r,code:e,cause:a,name:n}){var o;super(r,{cause:a}),this.__isWebAuthnError=!0,this.name=(o=n??(a instanceof Error?a.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=e}}class Tf extends la{constructor(r,e){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e,message:r}),this.name="WebAuthnUnknownError",this.originalError=e}}function kC({error:t,options:r}){var e,a,n;const{publicKey:o}=r;if(!o)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(r.signal instanceof AbortSignal)return new la({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((e=o.authenticatorSelection)===null||e===void 0?void 0:e.requireResidentKey)===!0)return new la({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(r.mediation==="conditional"&&((a=o.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new la({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((n=o.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new la({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new la({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new la({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return o.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new la({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new la({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(Jw(s)){if(o.rp.id!==s)return new la({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new la({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new la({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new la({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new la({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function EC({error:t,options:r}){const{publicKey:e}=r;if(!e)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(r.signal instanceof AbortSignal)return new la({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new la({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const a=window.location.hostname;if(Jw(a)){if(e.rpId!==a)return new la({message:`The RP ID "${e.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new la({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new la({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new la({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class TC{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const r=new AbortController;return this.controller=r,r.signal}cancelCeremony(){if(this.controller){const r=new Error("Manually cancelling existing WebAuthn API call");r.name="AbortError",this.controller.abort(r),this.controller=void 0}}}const AC=new TC;function CC(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:r,user:e,excludeCredentials:a}=t,n=zf(t,["challenge","user","excludeCredentials"]),o=ql(r).buffer,s=Object.assign(Object.assign({},e),{id:ql(e.id).buffer}),l=Object.assign(Object.assign({},n),{challenge:o,user:s});if(a&&a.length>0){l.excludeCredentials=new Array(a.length);for(let c=0;c<a.length;c++){const i=a[c];l.excludeCredentials[c]=Object.assign(Object.assign({},i),{id:ql(i.id).buffer,type:i.type||"public-key",transports:i.transports})}}return l}function NC(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:r,allowCredentials:e}=t,a=zf(t,["challenge","allowCredentials"]),n=ql(r).buffer,o=Object.assign(Object.assign({},a),{challenge:n});if(e&&e.length>0){o.allowCredentials=new Array(e.length);for(let s=0;s<e.length;s++){const l=e[s];o.allowCredentials[s]=Object.assign(Object.assign({},l),{id:ql(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return o}function jC(t){var r;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const e=t;return{id:t.id,rawId:t.id,response:{attestationObject:Ro(new Uint8Array(t.response.attestationObject)),clientDataJSON:Ro(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(r=e.authenticatorAttachment)!==null&&r!==void 0?r:void 0}}function OC(t){var r;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const e=t,a=t.getClientExtensionResults(),n=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Ro(new Uint8Array(n.authenticatorData)),clientDataJSON:Ro(new Uint8Array(n.clientDataJSON)),signature:Ro(new Uint8Array(n.signature)),userHandle:n.userHandle?Ro(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(r=e.authenticatorAttachment)!==null&&r!==void 0?r:void 0}}function Jw(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Bx(){var t,r;return!!(Ca()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((r=navigator==null?void 0:navigator.credentials)===null||r===void 0?void 0:r.get)=="function")}async function DC(t){try{const r=await navigator.credentials.create(t);return r?r instanceof PublicKeyCredential?{data:r,error:null}:{data:null,error:new Tf("Browser returned unexpected credential type",r)}:{data:null,error:new Tf("Empty credential response",r)}}catch(r){return{data:null,error:kC({error:r,options:t})}}}async function MC(t){try{const r=await navigator.credentials.get(t);return r?r instanceof PublicKeyCredential?{data:r,error:null}:{data:null,error:new Tf("Browser returned unexpected credential type",r)}:{data:null,error:new Tf("Empty credential response",r)}}catch(r){return{data:null,error:EC({error:r,options:t})}}}const RC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},IC={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Af(...t){const r=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),e=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),a={};for(const n of t)if(n)for(const o in n){const s=n[o];if(s!==void 0)if(Array.isArray(s))a[o]=s;else if(e(s))a[o]=s;else if(r(s)){const l=a[o];r(l)?a[o]=Af(l,s):a[o]=Af(s)}else a[o]=s}return a}function FC(t,r){return Af(RC,t,r||{})}function PC(t,r){return Af(IC,t,r||{})}class LC{constructor(r){this.client=r,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(r){return this.client.mfa.enroll(Object.assign(Object.assign({},r),{factorType:"webauthn"}))}async _challenge({factorId:r,webauthn:e,friendlyName:a,signal:n},o){try{const{data:s,error:l}=await this.client.mfa.challenge({factorId:r,webauthn:e});if(!s)return{data:null,error:l};const c=n??AC.createNewAbortSignal();if(s.webauthn.type==="create"){const{user:i}=s.webauthn.credential_options.publicKey;i.name||(i.name=`${i.id}:${a}`),i.displayName||(i.displayName=i.name)}switch(s.webauthn.type){case"create":{const i=FC(s.webauthn.credential_options.publicKey,o==null?void 0:o.create),{data:u,error:p}=await DC({publicKey:i,signal:c});return u?{data:{factorId:r,challengeId:s.id,webauthn:{type:s.webauthn.type,credential_response:u}},error:null}:{data:null,error:p}}case"request":{const i=PC(s.webauthn.credential_options.publicKey,o==null?void 0:o.request),{data:u,error:p}=await MC(Object.assign(Object.assign({},s.webauthn.credential_options),{publicKey:i,signal:c}));return u?{data:{factorId:r,challengeId:s.id,webauthn:{type:s.webauthn.type,credential_response:u}},error:null}:{data:null,error:p}}}}catch(s){return Ut(s)?{data:null,error:s}:{data:null,error:new Oo("Unexpected error in challenge",s)}}}async _verify({challengeId:r,factorId:e,webauthn:a}){return this.client.mfa.verify({factorId:e,challengeId:r,webauthn:a})}async _authenticate({factorId:r,webauthn:{rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},o){if(!e)return{data:null,error:new Au("rpId is required for WebAuthn authentication")};try{if(!Bx())return{data:null,error:new Oo("Browser does not support WebAuthn",null)};const{data:s,error:l}=await this.challenge({factorId:r,webauthn:{rpId:e,rpOrigins:a},signal:n},{request:o});if(!s)return{data:null,error:l};const{webauthn:c}=s;return this._verify({factorId:r,challengeId:s.challengeId,webauthn:{type:c.type,rpId:e,rpOrigins:a,credential_response:c.credential_response}})}catch(s){return Ut(s)?{data:null,error:s}:{data:null,error:new Oo("Unexpected error in authenticate",s)}}}async _register({friendlyName:r,webauthn:{rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},o){if(!e)return{data:null,error:new Au("rpId is required for WebAuthn registration")};try{if(!Bx())return{data:null,error:new Oo("Browser does not support WebAuthn",null)};const{data:s,error:l}=await this._enroll({friendlyName:r});if(!s)return await this.client.mfa.listFactors().then(u=>{var p;return(p=u.data)===null||p===void 0?void 0:p.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===r&&f.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:l};const{data:c,error:i}=await this._challenge({factorId:s.id,friendlyName:s.friendly_name,webauthn:{rpId:e,rpOrigins:a},signal:n},{create:o});return c?this._verify({factorId:s.id,challengeId:c.challengeId,webauthn:{rpId:e,rpOrigins:a,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:i}}catch(s){return Ut(s)?{data:null,error:s}:{data:null,error:new Oo("Unexpected error in register",s)}}}}yC();const BC={url:R7,storageKey:I7,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:F7,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Ux(t,r,e){return await e()}const jl={};class Cu{get jwks(){var r,e;return(e=(r=jl[this.storageKey])===null||r===void 0?void 0:r.jwks)!==null&&e!==void 0?e:{keys:[]}}set jwks(r){jl[this.storageKey]=Object.assign(Object.assign({},jl[this.storageKey]),{jwks:r})}get jwks_cached_at(){var r,e;return(e=(r=jl[this.storageKey])===null||r===void 0?void 0:r.cachedAt)!==null&&e!==void 0?e:Number.MIN_SAFE_INTEGER}set jwks_cached_at(r){jl[this.storageKey]=Object.assign(Object.assign({},jl[this.storageKey]),{cachedAt:r})}constructor(r){var e,a,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const o=Object.assign(Object.assign({},BC),r);if(this.storageKey=o.storageKey,this.instanceID=(e=Cu.nextInstanceID[this.storageKey])!==null&&e!==void 0?e:0,Cu.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.instanceID>0&&Ca()){const s=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(s),this.logDebugMessages&&console.trace(s)}if(this.persistSession=o.persistSession,this.autoRefreshToken=o.autoRefreshToken,this.admin=new vC({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=Xw(o.fetch),this.lock=o.lock||Ux,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,this.throwOnError=o.throwOnError,o.lock?this.lock=o.lock:this.persistSession&&Ca()&&(!((a=globalThis==null?void 0:globalThis.navigator)===null||a===void 0)&&a.locks)?this.lock=xC:this.lock=Ux,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new LC(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:Yw()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Lx(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=Lx(this.memoryStorage)),Ca()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(r){if(this.throwOnError&&r&&r.error)throw r.error;return r}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${qw}) ${new Date().toISOString()}`}_debug(...r){return this.logDebugMessages&&this.logger(this._logPrefix(),...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{let e={},a="none";if(Ca()&&(e=Z7(window.location.href),this._isImplicitGrantCallback(e)?a="implicit":await this._isPKCECallback(e)&&(a="pkce")),Ca()&&this.detectSessionInUrl&&a!=="none"){const{data:n,error:o}=await this._getSessionFromURL(e,a);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),$7(o)){const c=(r=o.details)===null||r===void 0?void 0:r.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:s,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",s,"redirect type",l),await this._saveSession(s),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return Ut(e)?this._returnResult({error:e}):this._returnResult({error:new Oo("Unexpected error during initialization",e)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var e,a,n;try{const o=await Gt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(e=r==null?void 0:r.options)===null||e===void 0?void 0:e.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(n=r==null?void 0:r.options)===null||n===void 0?void 0:n.captchaToken}},xform:as}),{data:s,error:l}=o;if(l||!s)return this._returnResult({data:{user:null,session:null},error:l});const c=s.session,i=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:i,session:c},error:null})}catch(o){if(Ut(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signUp(r){var e,a,n;try{let o;if("email"in r){const{email:u,password:p,options:f}=r;let h=null,v=null;this.flowType==="pkce"&&([h,v]=await Al(this.storage,this.storageKey)),o=await Gt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:p,data:(e=f==null?void 0:f.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:h,code_challenge_method:v},xform:as})}else if("phone"in r){const{phone:u,password:p,options:f}=r;o=await Gt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:p,data:(a=f==null?void 0:f.data)!==null&&a!==void 0?a:{},channel:(n=f==null?void 0:f.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:as})}else throw new cf("You must provide either an email or phone number and a password");const{data:s,error:l}=o;if(l||!s)return await Aa(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=s.session,i=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:i,session:c},error:null})}catch(o){if(await Aa(this.storage,`${this.storageKey}-code-verifier`),Ut(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithPassword(r){try{let e;if("email"in r){const{email:o,password:s,options:l}=r;e=await Gt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:s,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Fx})}else if("phone"in r){const{phone:o,password:s,options:l}=r;e=await Gt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:s,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Fx})}else throw new cf("You must provide either an email or phone number and a password");const{data:a,error:n}=e;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!a||!a.session||!a.user){const o=new Tl;return this._returnResult({data:{user:null,session:null},error:o})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(e){if(Ut(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOAuth(r){var e,a,n,o;return await this._handleProviderSignIn(r.provider,{redirectTo:(e=r.options)===null||e===void 0?void 0:e.redirectTo,scopes:(a=r.options)===null||a===void 0?void 0:a.scopes,queryParams:(n=r.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(o=r.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(r))}async signInWithWeb3(r){const{chain:e}=r;switch(e){case"ethereum":return await this.signInWithEthereum(r);case"solana":return await this.signInWithSolana(r);default:throw new Error(`@supabase/auth-js: Unsupported chain "${e}"`)}}async signInWithEthereum(r){var e,a,n,o,s,l,c,i,u,p,f;let h,v;if("message"in r)h=r.message,v=r.signature;else{const{chain:b,wallet:g,statement:x,options:y}=r;let E;if(Ca())if(typeof g=="object")E=g;else{const H=window;if("ethereum"in H&&typeof H.ethereum=="object"&&"request"in H.ethereum&&typeof H.ethereum.request=="function")E=H.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=g}const N=new URL((e=y==null?void 0:y.url)!==null&&e!==void 0?e:window.location.href),I=await E.request({method:"eth_requestAccounts"}).then(H=>H).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!I||I.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const P=Zw(I[0]);let V=(a=y==null?void 0:y.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!V){const H=await E.request({method:"eth_chainId"});V=wC(H)}const U={domain:N.host,address:P,statement:x,uri:N.href,version:"1",chainId:V,nonce:(n=y==null?void 0:y.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(s=(o=y==null?void 0:y.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&s!==void 0?s:new Date,expirationTime:(l=y==null?void 0:y.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=y==null?void 0:y.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(i=y==null?void 0:y.signInWithEthereum)===null||i===void 0?void 0:i.requestId,resources:(u=y==null?void 0:y.signInWithEthereum)===null||u===void 0?void 0:u.resources};h=SC(U),v=await E.request({method:"personal_sign",params:[_C(h),P]})}try{const{data:b,error:g}=await Gt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:v},!((p=r.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(f=r.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:as});if(g)throw g;if(!b||!b.session||!b.user){const x=new Tl;return this._returnResult({data:{user:null,session:null},error:x})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:g})}catch(b){if(Ut(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async signInWithSolana(r){var e,a,n,o,s,l,c,i,u,p,f,h;let v,b;if("message"in r)v=r.message,b=r.signature;else{const{chain:g,wallet:x,statement:y,options:E}=r;let N;if(Ca())if(typeof x=="object")N=x;else{const P=window;if("solana"in P&&typeof P.solana=="object"&&("signIn"in P.solana&&typeof P.solana.signIn=="function"||"signMessage"in P.solana&&typeof P.solana.signMessage=="function"))N=P.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(E!=null&&E.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=x}const I=new URL((e=E==null?void 0:E.url)!==null&&e!==void 0?e:window.location.href);if("signIn"in N&&N.signIn){const P=await N.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},E==null?void 0:E.signInWithSolana),{version:"1",domain:I.host,uri:I.href}),y?{statement:y}:null));let V;if(Array.isArray(P)&&P[0]&&typeof P[0]=="object")V=P[0];else if(P&&typeof P=="object"&&"signedMessage"in P&&"signature"in P)V=P;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in V&&"signature"in V&&(typeof V.signedMessage=="string"||V.signedMessage instanceof Uint8Array)&&V.signature instanceof Uint8Array)v=typeof V.signedMessage=="string"?V.signedMessage:new TextDecoder().decode(V.signedMessage),b=V.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in N)||typeof N.signMessage!="function"||!("publicKey"in N)||typeof N!="object"||!N.publicKey||!("toBase58"in N.publicKey)||typeof N.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${I.host} wants you to sign in with your Solana account:`,N.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${I.href}`,`Issued At: ${(n=(a=E==null?void 0:E.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((o=E==null?void 0:E.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${E.signInWithSolana.notBefore}`]:[],...!((s=E==null?void 0:E.signInWithSolana)===null||s===void 0)&&s.expirationTime?[`Expiration Time: ${E.signInWithSolana.expirationTime}`]:[],...!((l=E==null?void 0:E.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${E.signInWithSolana.chainId}`]:[],...!((c=E==null?void 0:E.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${E.signInWithSolana.nonce}`]:[],...!((i=E==null?void 0:E.signInWithSolana)===null||i===void 0)&&i.requestId?[`Request ID: ${E.signInWithSolana.requestId}`]:[],...!((p=(u=E==null?void 0:E.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||p===void 0)&&p.length?["Resources",...E.signInWithSolana.resources.map(V=>`- ${V}`)]:[]].join(`
`);const P=await N.signMessage(new TextEncoder().encode(v),"utf8");if(!P||!(P instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=P}}try{const{data:g,error:x}=await Gt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Ro(b)},!((f=r.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=r.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:as});if(x)throw x;if(!g||!g.session||!g.user){const y=new Tl;return this._returnResult({data:{user:null,session:null},error:y})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:x})}catch(g){if(Ut(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(r){const e=await To(this.storage,`${this.storageKey}-code-verifier`),[a,n]=(e??"").split("/");try{if(!a&&this.flowType==="pkce")throw new V7;const{data:o,error:s}=await Gt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:a},xform:as});if(await Aa(this.storage,`${this.storageKey}-code-verifier`),s)throw s;if(!o||!o.session||!o.user){const l=new Tl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign(Object.assign({},o),{redirectType:n??null}),error:s})}catch(o){if(await Aa(this.storage,`${this.storageKey}-code-verifier`),Ut(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}}async signInWithIdToken(r){try{const{options:e,provider:a,token:n,access_token:o,nonce:s}=r,l=await Gt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:n,access_token:o,nonce:s,gotrue_meta_security:{captcha_token:e==null?void 0:e.captchaToken}},xform:as}),{data:c,error:i}=l;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!c||!c.session||!c.user){const u=new Tl;return this._returnResult({data:{user:null,session:null},error:u})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:i})}catch(e){if(Ut(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOtp(r){var e,a,n,o,s;try{if("email"in r){const{email:l,options:c}=r;let i=null,u=null;this.flowType==="pkce"&&([i,u]=await Al(this.storage,this.storageKey));const{error:p}=await Gt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(e=c==null?void 0:c.data)!==null&&e!==void 0?e:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:i,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in r){const{phone:l,options:c}=r,{data:i,error:u}=await Gt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(o=c==null?void 0:c.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(s=c==null?void 0:c.channel)!==null&&s!==void 0?s:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:u})}throw new cf("You must provide either an email or phone number.")}catch(l){if(await Aa(this.storage,`${this.storageKey}-code-verifier`),Ut(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(r){var e,a;try{let n,o;"options"in r&&(n=(e=r.options)===null||e===void 0?void 0:e.redirectTo,o=(a=r.options)===null||a===void 0?void 0:a.captchaToken);const{data:s,error:l}=await Gt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:o}}),redirectTo:n,xform:as});if(l)throw l;if(!s)throw new Error("An error occurred on token verification.");const c=s.session,i=s.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:i,session:c},error:null})}catch(n){if(Ut(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(r){var e,a,n,o,s;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Al(this.storage,this.storageKey));const i=await Gt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(a=(e=r.options)===null||e===void 0?void 0:e.redirectTo)!==null&&a!==void 0?a:void 0}),!((n=r==null?void 0:r.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:pC});return!((o=i.data)===null||o===void 0)&&o.url&&Ca()&&!(!((s=r.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(i.data.url),this._returnResult(i)}catch(l){if(await Aa(this.storage,`${this.storageKey}-code-verifier`),Ut(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:e},error:a}=r;if(a)throw a;if(!e)throw new vn;const{error:n}=await Gt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(r){if(Ut(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async resend(r){try{const e=`${this.url}/resend`;if("email"in r){const{email:a,type:n,options:o}=r,{error:s}=await Gt(this.fetch,"POST",e,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:s})}else if("phone"in r){const{phone:a,type:n,options:o}=r,{data:s,error:l}=await Gt(this.fetch,"POST",e,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:l})}throw new cf("You must provide either an email or phone number and a type")}catch(e){if(Ut(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(r,e){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await a,await e()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=e();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const e=await this.__loadSession();return await r(e)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const e=await To(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",e),e!==null&&(this._isValidSession(e)?r=e:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const a=r.expires_at?r.expires_at*1e3-Date.now()<fp:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",r.expires_at),!a){if(this.userStorage){const s=await To(this.userStorage,this.storageKey+"-user");s!=null&&s.user?r.user=s.user:r.user=mp()}if(this.storage.isServer&&r.user&&!r.user.__isUserNotAvailableProxy){const s={value:this.suppressGetSessionWarning};r.user=uC(r.user,s),s.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:r},error:null}}const{data:n,error:o}=await this._callRefreshToken(r.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(r){if(r)return await this._getUser(r);await this.initializePromise;const e=await this._acquireLock(-1,async()=>await this._getUser());return e.data.user&&(this.suppressGetSessionWarning=!0),e}async _getUser(r){try{return r?await Gt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:Hi}):await this._useSession(async e=>{var a,n,o;const{data:s,error:l}=e;if(l)throw l;return!(!((a=s.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new vn}:await Gt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&o!==void 0?o:void 0,xform:Hi})})}catch(e){if(Ut(e))return z7(e)&&(await this._removeSession(),await Aa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:e});throw e}}async updateUser(r,e={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,e))}async _updateUser(r,e={}){try{return await this._useSession(async a=>{const{data:n,error:o}=a;if(o)throw o;if(!n.session)throw new vn;const s=n.session;let l=null,c=null;this.flowType==="pkce"&&r.email!=null&&([l,c]=await Al(this.storage,this.storageKey));const{data:i,error:u}=await Gt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e==null?void 0:e.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:l,code_challenge_method:c}),jwt:s.access_token,xform:Hi});if(u)throw u;return s.user=i.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),this._returnResult({data:{user:s.user},error:null})})}catch(a){if(await Aa(this.storage,`${this.storageKey}-code-verifier`),Ut(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new vn;const e=Date.now()/1e3;let a=e,n=!0,o=null;const{payload:s}=pp(r.access_token);if(s.exp&&(a=s.exp,n=a<=e),n){const{data:l,error:c}=await this._callRefreshToken(r.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};o=l}else{const{data:l,error:c}=await this._getUser(r.access_token);if(c)throw c;o={access_token:r.access_token,refresh_token:r.refresh_token,user:l.user,token_type:"bearer",expires_in:a-e,expires_at:a},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(e){if(Ut(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async e=>{var a;if(!r){const{data:s,error:l}=e;if(l)throw l;r=(a=s.session)!==null&&a!==void 0?a:void 0}if(!(r!=null&&r.refresh_token))throw new vn;const{data:n,error:o}=await this._callRefreshToken(r.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(e){if(Ut(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _getSessionFromURL(r,e){try{if(!Ca())throw new uf("No browser detected.");if(r.error||r.error_description||r.error_code)throw new uf(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(e){case"implicit":if(this.flowType==="pkce")throw new Nx("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new uf("Not a valid implicit grant flow url.");break;default:}if(e==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new Nx("No code detected.");const{data:y,error:E}=await this._exchangeCodeForSession(r.code);if(E)throw E;const N=new URL(window.location.href);return N.searchParams.delete("code"),window.history.replaceState(window.history.state,"",N.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:o,refresh_token:s,expires_in:l,expires_at:c,token_type:i}=r;if(!o||!l||!s||!i)throw new uf("No session defined in URL");const u=Math.round(Date.now()/1e3),p=parseInt(l);let f=u+p;c&&(f=parseInt(c));const h=f-u;h*1e3<=Pl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${p}s`);const v=f-p;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,f,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,f,u);const{data:b,error:g}=await this._getUser(o);if(g)throw g;const x={provider_token:a,provider_refresh_token:n,access_token:o,expires_in:p,expires_at:f,refresh_token:s,token_type:i,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:r.type},error:null})}catch(a){if(Ut(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(r){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),r):!!(r.access_token||r.error_description)}async _isPKCECallback(r){const e=await To(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&e)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async e=>{var a;const{data:n,error:o}=e;if(o)return this._returnResult({error:o});const s=(a=n.session)===null||a===void 0?void 0:a.access_token;if(s){const{error:l}=await this.admin.signOut(s,r);if(l&&!(U7(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return r!=="others"&&(await this._removeSession(),await Aa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(r){const e=K7(),a={id:e,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",e),this.stateChangeEmitters.delete(e)}};return this._debug("#onAuthStateChange()","registered callback with id",e),this.stateChangeEmitters.set(e,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(e)})))(),{data:{subscription:a}}}async _emitInitialSession(r){return await this._useSession(async e=>{var a,n;try{const{data:{session:o},error:s}=e;if(s)throw s;await((a=this.stateChangeEmitters.get(r))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",r,"session",o)}catch(o){await((n=this.stateChangeEmitters.get(r))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",o),console.error(o)}})}async resetPasswordForEmail(r,e={}){let a=null,n=null;this.flowType==="pkce"&&([a,n]=await Al(this.storage,this.storageKey,!0));try{return await Gt(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(o){if(await Aa(this.storage,`${this.storageKey}-code-verifier`),Ut(o))return this._returnResult({data:null,error:o});throw o}}async getUserIdentities(){var r;try{const{data:e,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(r=e.user.identities)!==null&&r!==void 0?r:[]},error:null})}catch(e){if(Ut(e))return this._returnResult({data:null,error:e});throw e}}async linkIdentity(r){return"token"in r?this.linkIdentityIdToken(r):this.linkIdentityOAuth(r)}async linkIdentityOAuth(r){var e;try{const{data:a,error:n}=await this._useSession(async o=>{var s,l,c,i,u;const{data:p,error:f}=o;if(f)throw f;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(s=r.options)===null||s===void 0?void 0:s.redirectTo,scopes:(l=r.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=r.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Gt(this.fetch,"GET",h,{headers:this.headers,jwt:(u=(i=p.session)===null||i===void 0?void 0:i.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return Ca()&&!(!((e=r.options)===null||e===void 0)&&e.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),this._returnResult({data:{provider:r.provider,url:a==null?void 0:a.url},error:null})}catch(a){if(Ut(a))return this._returnResult({data:{provider:r.provider,url:null},error:a});throw a}}async linkIdentityIdToken(r){return await this._useSession(async e=>{var a;try{const{error:n,data:{session:o}}=e;if(n)throw n;const{options:s,provider:l,token:c,access_token:i,nonce:u}=r,p=await Gt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=o==null?void 0:o.access_token)!==null&&a!==void 0?a:void 0,body:{provider:l,id_token:c,access_token:i,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:as}),{data:f,error:h}=p;return h?this._returnResult({data:{user:null,session:null},error:h}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Tl}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:h}))}catch(n){if(await Aa(this.storage,`${this.storageKey}-code-verifier`),Ut(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(r){try{return await this._useSession(async e=>{var a,n;const{data:o,error:s}=e;if(s)throw s;return await Gt(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(n=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:void 0})})}catch(e){if(Ut(e))return this._returnResult({data:null,error:e});throw e}}async _refreshAccessToken(r){const e=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(e,"begin");try{const a=Date.now();return await eC(async n=>(n>0&&await Q7(200*Math.pow(2,n-1)),this._debug(e,"refreshing attempt",n),await Gt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:as})),(n,o)=>{const s=200*Math.pow(2,n);return o&&hp(o)&&Date.now()+s-a<Pl})}catch(a){if(this._debug(e,"error",a),Ut(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(e,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,e){const a=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",e,"url",a),Ca()&&!e.skipBrowserRedirect&&window.location.assign(a),{data:{provider:r,url:a},error:null}}async _recoverAndRefresh(){var r,e;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const n=await To(this.storage,this.storageKey);if(n&&this.userStorage){let s=await To(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!s&&(s={user:n.user},await Ll(this.userStorage,this.storageKey+"-user",s)),n.user=(r=s==null?void 0:s.user)!==null&&r!==void 0?r:mp()}else if(n&&!n.user&&!n.user){const s=await To(this.storage,this.storageKey+"-user");s&&(s!=null&&s.user)?(n.user=s.user,await Aa(this.storage,this.storageKey+"-user"),await Ll(this.storage,this.storageKey,n)):n.user=mp()}if(this._debug(a,"session from storage",n),!this._isValidSession(n)){this._debug(a,"session is not valid"),n!==null&&await this._removeSession();return}const o=((e=n.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<fp;if(this._debug(a,`session has${o?"":" not"} expired with margin of ${fp}s`),o){if(this.autoRefreshToken&&n.refresh_token){const{error:s}=await this._callRefreshToken(n.refresh_token);s&&(console.error(s),hp(s)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:s,error:l}=await this._getUser(n.access_token);!l&&(s!=null&&s.user)?(n.user=s.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(s){console.error("Error getting user data:",s),this._debug(a,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(a,"error",n),console.error(n);return}finally{this._debug(a,"end")}}async _callRefreshToken(r){var e,a;if(!r)throw new vn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Yf;const{data:o,error:s}=await this._refreshAccessToken(r);if(s)throw s;if(!o.session)throw new vn;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const l={data:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(n,"error",o),Ut(o)){const s={data:null,error:o};return hp(o)||await this._removeSession(),(e=this.refreshingDeferred)===null||e===void 0||e.resolve(s),s}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(o),o}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(r,e,a=!0){const n=`#_notifyAllSubscribers(${r})`;this._debug(n,"begin",e,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:r,session:e});const o=[],s=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(r,e)}catch(c){o.push(c)}});if(await Promise.all(s),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(n,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0,await Aa(this.storage,`${this.storageKey}-code-verifier`);const e=Object.assign({},r),a=e.user&&e.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&e.user&&await Ll(this.userStorage,this.storageKey+"-user",{user:e.user});const n=Object.assign({},e);delete n.user;const o=Rx(n);await Ll(this.storage,this.storageKey,o)}else{const n=Rx(e);await Ll(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Aa(this.storage,this.storageKey),await Aa(this.storage,this.storageKey+"-code-verifier"),await Aa(this.storage,this.storageKey+"-user"),this.userStorage&&await Aa(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&Ca()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",r)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),Pl);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async e=>{const{data:{session:a}}=e;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((a.expires_at*1e3-r)/Pl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Pl}ms, refresh threshold is ${Gp} ticks`),n<=Gp&&await this._callRefreshToken(a.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof Kw)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ca()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const e=`#_onVisibilityChanged(${r})`;this._debug(e,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(e,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,e,a){const n=[`provider=${encodeURIComponent(e)}`];if(a!=null&&a.redirectTo&&n.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&n.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[o,s]=await Al(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(s)}`});n.push(l.toString())}if(a!=null&&a.queryParams){const o=new URLSearchParams(a.queryParams);n.push(o.toString())}return a!=null&&a.skipBrowserRedirect&&n.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${r}?${n.join("&")}`}async _unenroll(r){try{return await this._useSession(async e=>{var a;const{data:n,error:o}=e;return o?this._returnResult({data:null,error:o}):await Gt(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token})})}catch(e){if(Ut(e))return this._returnResult({data:null,error:e});throw e}}async _enroll(r){try{return await this._useSession(async e=>{var a,n;const{data:o,error:s}=e;if(s)return this._returnResult({data:null,error:s});const l=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:r.factorType==="totp"?{issuer:r.issuer}:{}),{data:c,error:i}=await Gt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(a=o==null?void 0:o.session)===null||a===void 0?void 0:a.access_token});return i?this._returnResult({data:null,error:i}):(r.factorType==="totp"&&c.type==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(e){if(Ut(e))return this._returnResult({data:null,error:e});throw e}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var a;const{data:n,error:o}=e;if(o)return this._returnResult({data:null,error:o});const s=Object.assign({challenge_id:r.challengeId},"webauthn"in r?{webauthn:Object.assign(Object.assign({},r.webauthn),{credential_response:r.webauthn.type==="create"?jC(r.webauthn.credential_response):OC(r.webauthn.credential_response)})}:{code:r.code}),{data:l,error:c}=await Gt(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:s,headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(e){if(Ut(e))return this._returnResult({data:null,error:e});throw e}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var a;const{data:n,error:o}=e;if(o)return this._returnResult({data:null,error:o});const s=await Gt(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:r,headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});if(s.error)return s;const{data:l}=s;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:CC(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:NC(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(e){if(Ut(e))return this._returnResult({data:null,error:e});throw e}})}async _challengeAndVerify(r){const{data:e,error:a}=await this._challenge({factorId:r.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:r.factorId,challengeId:e.id,code:r.code})}async _listFactors(){var r;const{data:{user:e},error:a}=await this.getUser();if(a)return{data:null,error:a};const n={all:[],phone:[],totp:[],webauthn:[]};for(const o of(r=e==null?void 0:e.factors)!==null&&r!==void 0?r:[])n.all.push(o),o.status==="verified"&&n[o.factor_type].push(o);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var r,e;const{data:{session:a},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=pp(a.access_token);let s=null;o.aal&&(s=o.aal);let l=s;((e=(r=a.user.factors)===null||r===void 0?void 0:r.filter(u=>u.status==="verified"))!==null&&e!==void 0?e:[]).length>0&&(l="aal2");const i=o.amr||[];return{data:{currentLevel:s,nextLevel:l,currentAuthenticationMethods:i},error:null}}async _getAuthorizationDetails(r){try{return await this._useSession(async e=>{const{data:{session:a},error:n}=e;return n?this._returnResult({data:null,error:n}):a?await Gt(this.fetch,"GET",`${this.url}/oauth/authorizations/${r}`,{headers:this.headers,jwt:a.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new vn})})}catch(e){if(Ut(e))return this._returnResult({data:null,error:e});throw e}}async _approveAuthorization(r,e){try{return await this._useSession(async a=>{const{data:{session:n},error:o}=a;if(o)return this._returnResult({data:null,error:o});if(!n)return this._returnResult({data:null,error:new vn});const s=await Gt(this.fetch,"POST",`${this.url}/oauth/authorizations/${r}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return s.data&&s.data.redirect_url&&Ca()&&!(e!=null&&e.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(a){if(Ut(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(r,e){try{return await this._useSession(async a=>{const{data:{session:n},error:o}=a;if(o)return this._returnResult({data:null,error:o});if(!n)return this._returnResult({data:null,error:new vn});const s=await Gt(this.fetch,"POST",`${this.url}/oauth/authorizations/${r}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return s.data&&s.data.redirect_url&&Ca()&&!(e!=null&&e.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(a){if(Ut(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async r=>{const{data:{session:e},error:a}=r;return a?this._returnResult({data:null,error:a}):e?await Gt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:e.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new vn})})}catch(r){if(Ut(r))return this._returnResult({data:null,error:r});throw r}}async _revokeOAuthGrant(r){try{return await this._useSession(async e=>{const{data:{session:a},error:n}=e;return n?this._returnResult({data:null,error:n}):a?(await Gt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:r.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new vn})})}catch(e){if(Ut(e))return this._returnResult({data:null,error:e});throw e}}async fetchJwk(r,e={keys:[]}){let a=e.keys.find(l=>l.kid===r);if(a)return a;const n=Date.now();if(a=this.jwks.keys.find(l=>l.kid===r),a&&this.jwks_cached_at+L7>n)return a;const{data:o,error:s}=await Gt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=n,a=o.keys.find(l=>l.kid===r),!a)?null:a}async getClaims(r,e={}){try{let a=r;if(!a){const{data:h,error:v}=await this.getSession();if(v||!h.session)return this._returnResult({data:null,error:v});a=h.session.access_token}const{header:n,payload:o,signature:s,raw:{header:l,payload:c}}=pp(a);e!=null&&e.allowExpired||oC(o.exp);const i=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,e!=null&&e.keys?{keys:e.keys}:e==null?void 0:e.jwks);if(!i){const{error:h}=await this.getUser(a);if(h)throw h;return{data:{claims:o,header:n,signature:s},error:null}}const u=lC(n.alg),p=await crypto.subtle.importKey("jwk",i,u,!0,["verify"]);if(!await crypto.subtle.verify(u,p,s,Y7(`${l}.${c}`)))throw new Kp("Invalid JWT signature");return{data:{claims:o,header:n,signature:s},error:null}}catch(a){if(Ut(a))return this._returnResult({data:null,error:a});throw a}}}Cu.nextInstanceID={};const UC=Cu,zC="2.89.0";let au="";typeof Deno<"u"?au="deno":typeof document<"u"?au="web":typeof navigator<"u"&&navigator.product==="ReactNative"?au="react-native":au="node";const $C={"X-Client-Info":`supabase-js-${au}/${zC}`},VC={headers:$C},HC={schema:"public"},qC={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},WC={};function Nu(t){"@babel/helpers - typeof";return Nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Nu(t)}function GC(t,r){if(Nu(t)!="object"||!t)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var a=e.call(t,r);if(Nu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function YC(t){var r=GC(t,"string");return Nu(r)=="symbol"?r:r+""}function XC(t,r,e){return(r=YC(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function zx(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);r&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,a)}return e}function Wr(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?zx(Object(e),!0).forEach(function(a){XC(t,a,e[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):zx(Object(e)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(e,a))})}return t}const KC=t=>t?(...r)=>t(...r):(...r)=>fetch(...r),ZC=()=>Headers,JC=(t,r,e)=>{const a=KC(e),n=ZC();return async(o,s)=>{var l;const c=(l=await r())!==null&&l!==void 0?l:t;let i=new n(s==null?void 0:s.headers);return i.has("apikey")||i.set("apikey",t),i.has("Authorization")||i.set("Authorization",`Bearer ${c}`),a(o,Wr(Wr({},s),{},{headers:i}))}};function QC(t){return t.endsWith("/")?t:t+"/"}function eN(t,r){var e,a;const{db:n,auth:o,realtime:s,global:l}=t,{db:c,auth:i,realtime:u,global:p}=r,f={db:Wr(Wr({},c),n),auth:Wr(Wr({},i),o),realtime:Wr(Wr({},u),s),storage:{},global:Wr(Wr(Wr({},p),l),{},{headers:Wr(Wr({},(e=p==null?void 0:p.headers)!==null&&e!==void 0?e:{}),(a=l==null?void 0:l.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function tN(t){const r=t==null?void 0:t.trim();if(!r)throw new Error("supabaseUrl is required.");if(!r.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(QC(r))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var rN=class extends UC{constructor(t){super(t)}},aN=class{constructor(t,r,e){var a,n;this.supabaseUrl=t,this.supabaseKey=r;const o=tN(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const s=`sb-${o.hostname.split(".")[0]}-auth-token`,l={db:HC,realtime:WC,auth:Wr(Wr({},qC),{},{storageKey:s}),global:VC},c=eN(e??{},l);if(this.storageKey=(a=c.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(n=c.global.headers)!==null&&n!==void 0?n:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(u,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}});else{var i;this.auth=this._initSupabaseAuthClient((i=c.auth)!==null&&i!==void 0?i:{},this.headers,c.global.fetch)}this.fetch=JC(r,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Wr({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&this.accessToken().then(u=>this.realtime.setAuth(u)).catch(u=>console.warn("Failed to set initial Realtime auth token:",u)),this.rest=new F9(new URL("rest/v1",o).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new M7(this.storageUrl.href,this.headers,this.fetch,e==null?void 0:e.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new O9(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},e={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,e)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,r,e;if(t.accessToken)return await t.accessToken();const{data:a}=await t.auth.getSession();return(r=(e=a.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:e,storage:a,userStorage:n,storageKey:o,flowType:s,lock:l,debug:c,throwOnError:i},u,p){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new rN({url:this.authUrl.href,headers:Wr(Wr({},f),u),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:e,storage:a,userStorage:n,flowType:s,lock:l,debug:c,throwOnError:i,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new Q9(this.realtimeUrl.href,Wr(Wr({},t),{},{params:Wr(Wr({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,r,e){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==e?(this.changedAccessToken=e,this.realtime.setAuth(e)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const nN=(t,r,e)=>new aN(t,r,e);function sN(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}sN()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const iN="https://tqelhhitxpahzllngamh.supabase.co",oN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRxZWxoaGl0eHBhaHpsbG5nYW1oIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY2NzMwMjksImV4cCI6MjA4MjI0OTAyOX0.fqtBXBNmMA1yGud_PXNqzXduEmW75kZ9b8CkttymFzI",St=nN(iN,oN),lN=Object.freeze(Object.defineProperty({__proto__:null,supabase:St},Symbol.toStringTag,{value:"Module"}));function Xf(){var h,v,b,g,x,y,E;const{filters:t,setFilters:r,resetFilters:e}=ec(),[a,n]=Se.useState(t.startDate),[o,s]=Se.useState([]),[l,c]=Se.useState([]),[i,u]=Se.useState([]),[p,f]=Se.useState([]);return Se.useEffect(()=>{(async()=>{const[I,P,V,U]=await Promise.all([St.from("setores").select("*").order("nome"),St.from("motivos_devolucao").select("id, nome").order("nome"),St.from("clientes").select("nome").order("nome"),St.from("devolucoes").select("vendedor").not("vendedor","is",null)]);if(I.data&&s(I.data.map(H=>({id:H.id,name:H.nome}))),P.data&&c(P.data),V.data){const H=Array.from(new Set(V.data.map(G=>G.nome))).filter(Boolean);u(H.map(G=>({nome:G})))}if(U.data){const H=Array.from(new Set(U.data.map(G=>G.vendedor))).filter(Boolean);f(H)}})()},[]),w.jsxs("div",{className:"w-full bg-card border-b p-4 space-y-4",children:[w.jsxs("div",{className:"relative w-full",children:[w.jsx(uk,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),w.jsx(_r,{placeholder:"Buscar por cliente, vendedor, cidade...",className:"pl-8",value:t.search||"",onChange:N=>r({search:N.target.value})})]}),w.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-2",children:[w.jsxs($n,{value:((h=t.resultado)==null?void 0:h[0])||"all",onValueChange:N=>r({resultado:N==="all"?void 0:[N]}),children:[w.jsx(xn,{className:"w-full",children:w.jsx(Vn,{placeholder:"Resultado"})}),w.jsxs(yn,{children:[w.jsx(sr,{value:"all",children:"Todos os Resultados"}),w.jsx(sr,{value:"PENDENTE VALIDAO",children:"PENDENTE VALIDAO"}),w.jsx(sr,{value:"VALIDADA",children:"VALIDADA"}),w.jsx(sr,{value:"LANADA",children:"LANADA"}),w.jsx(sr,{value:"TRATATIVA DE ANULAO",children:"TRATATIVA DE ANULAO"}),w.jsx(sr,{value:"ANULADA/CANCELADA",children:"ANULADA/CANCELADA"})]})]}),w.jsxs($n,{value:((v=t.motivo)==null?void 0:v[0])||"all",onValueChange:N=>r({motivo:N==="all"?void 0:[N]}),children:[w.jsx(xn,{className:"w-full",children:w.jsx(Vn,{placeholder:"Motivo"})}),w.jsxs(yn,{children:[w.jsx(sr,{value:"all",children:"Todos os Motivos"}),l.map(N=>w.jsx(sr,{value:N.id,children:N.nome},N.id))]})]}),w.jsxs($n,{value:((b=t.cliente)==null?void 0:b[0])||"all",onValueChange:N=>r({cliente:N==="all"?void 0:[N]}),children:[w.jsx(xn,{className:"w-full",children:w.jsx(Vn,{placeholder:"Cliente"})}),w.jsxs(yn,{children:[w.jsx(sr,{value:"all",children:"Todos os Clientes"}),i.slice(0,100).map((N,I)=>w.jsx(sr,{value:N.nome,children:N.nome},I))]})]}),w.jsxs($n,{value:((g=t.vendedor)==null?void 0:g[0])||"all",onValueChange:N=>r({vendedor:N==="all"?void 0:[N]}),children:[w.jsx(xn,{className:"w-full",children:w.jsx(Vn,{placeholder:"Vendedor"})}),w.jsxs(yn,{children:[w.jsx(sr,{value:"all",children:"Todos os Vendedores"}),p.map(N=>w.jsx(sr,{value:N,children:N},N))]})]}),w.jsxs($n,{value:((x=t.setor)==null?void 0:x[0])||"all",onValueChange:N=>r({setor:N==="all"?void 0:[N]}),children:[w.jsxs(xn,{className:"w-full",children:[w.jsx(US,{className:"mr-2 h-4 w-4 text-muted-foreground"}),w.jsx(Vn,{placeholder:"Setor"})]}),w.jsxs(yn,{children:[w.jsx(sr,{value:"all",children:"Todos os Setores"}),o.map(N=>w.jsx(sr,{value:N.id,children:N.name},N.id))]})]}),w.jsxs($n,{value:t.period||"all",onValueChange:N=>r({period:N==="all"?void 0:N}),children:[w.jsx(xn,{className:"w-full",children:w.jsx(Vn,{placeholder:"Perodo"})}),w.jsxs(yn,{children:[w.jsx(sr,{value:"all",children:"Todos os Perodos"}),w.jsx(sr,{value:"TODAY",children:"Hoje"}),w.jsx(sr,{value:"YESTERDAY",children:"Ontem"}),w.jsx(sr,{value:"THIS_WEEK",children:"Esta Semana"}),w.jsx(sr,{value:"LAST_WEEK",children:"Semana Passada"}),w.jsx(sr,{value:"THIS_MONTH",children:"Ms Atual"}),w.jsx(sr,{value:"LAST_MONTH",children:"Ms Anterior"}),w.jsx(sr,{value:"THIS_QUARTER",children:"Trimestre Atual"}),w.jsx(sr,{value:"THIS_SEMESTER",children:"Semestre Atual"}),w.jsx(sr,{value:"THIS_YEAR",children:"Ano Atual"}),w.jsx(sr,{value:"LAST_YEAR_AND_THIS_YEAR",children:"Ano Anterior + Ano Atual"})]})]})]}),w.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-start sm:items-center justify-between",children:[w.jsxs(aE,{children:[w.jsx(nE,{asChild:!0,children:w.jsxs(Ot,{variant:"outline",className:Et("w-full sm:w-[200px] justify-start text-left font-normal",!a&&"text-muted-foreground"),children:[w.jsx(mS,{className:"mr-2 h-4 w-4"}),a?Xt(a,"dd/MM/yyyy"):w.jsx("span",{children:"Data Especfica"})]})}),w.jsx(iw,{className:"w-auto p-0",align:"start",children:w.jsx(Iw,{mode:"single",selected:a,onSelect:N=>{n(N),r({startDate:N})},initialFocus:!0})})]}),w.jsxs(Ot,{variant:"ghost",size:"sm",onClick:()=>{e(),n(void 0)},className:"w-full sm:w-auto",children:[w.jsx(IS,{className:"mr-2 h-4 w-4"}),"Limpar Filtros"]})]}),w.jsxs("div",{className:"flex gap-2 flex-wrap",children:[t.period&&w.jsxs(Un,{variant:"secondary",children:["Perodo: ",t.period]}),t.search&&w.jsxs(Un,{variant:"secondary",children:["Busca: ",t.search]}),t.setor&&t.setor.length>0&&w.jsxs(Un,{variant:"secondary",children:["Setor: ",((y=o.find(N=>{var I;return N.id===((I=t.setor)==null?void 0:I[0])}))==null?void 0:y.name)||"Selecionado"]}),t.resultado&&t.resultado.length>0&&w.jsxs(Un,{variant:"secondary",children:["Resultado: ",t.resultado[0]]}),t.motivo&&t.motivo.length>0&&w.jsxs(Un,{variant:"secondary",children:["Motivo: ",((E=l.find(N=>{var I;return N.id===((I=t.motivo)==null?void 0:I[0])}))==null?void 0:E.nome)||"Selecionado"]}),t.cliente&&t.cliente.length>0&&w.jsxs(Un,{variant:"secondary",children:["Cliente: ",t.cliente[0]]}),t.vendedor&&t.vendedor.length>0&&w.jsxs(Un,{variant:"secondary",children:["Vendedor: ",t.vendedor[0]]})]})]})}function Qi({title:t,description:r}){const[e,a]=Se.useState(!1),[n,o]=Se.useState(new Date);Se.useEffect(()=>{const c=()=>{a(document.documentElement.classList.contains("dark"))};c();const i=new MutationObserver(c);return i.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>i.disconnect()},[]),Se.useEffect(()=>{const c=setInterval(()=>{o(new Date)},1e3);return()=>clearInterval(c)},[]);const l=(c=>{const u=c.getTime()+c.getTimezoneOffset()*6e4;return new Date(u+-180*6e4)})(n);return w.jsx("div",{className:`w-full rounded-lg p-6 mb-6 ${e?"bg-gradient-to-r from-blue-600/20 to-blue-800/20 border border-blue-500/30":"bg-gradient-to-r from-green-600/10 to-green-700/10 border border-green-500/30"}`,children:w.jsxs("div",{className:"flex items-start justify-between",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx("h1",{className:`text-3xl font-bold tracking-tight mb-2 ${e?"text-blue-100":"text-green-900"}`,children:t}),w.jsx("p",{className:`text-sm ${e?"text-blue-200/80":"text-green-800/80"}`,children:r})]}),w.jsxs("div",{className:`text-right ml-4 ${e?"text-blue-200":"text-green-800"}`,children:[w.jsx("div",{className:"text-sm font-medium",children:Xt(l,"dd/MM/yyyy",{locale:yr})}),w.jsxs("div",{className:"text-xs font-mono",children:[Xt(l,"HH:mm:ss",{locale:yr})," (BRT)"]})]})]})})}function cN(t,r){let e=0;const a=new Date(t);a.setHours(0,0,0,0);const n=new Date(r);for(n.setHours(0,0,0,0);a<=n;){const o=a.getDay();o!==0&&o!==6&&e++,a.setDate(a.getDate()+1)}return e}function ju(t){if(!t)return{};const r=new Date;switch(t){case"TODAY":return{startDate:Ki(r),endDate:ap(r)};case"YESTERDAY":const e=_T(r);return{startDate:Ki(e),endDate:ap(e)};case"THIS_WEEK":return{startDate:Ji(r,{weekStartsOn:1}),endDate:kf(r,{weekStartsOn:1})};case"LAST_WEEK":const a=TT(r);return{startDate:Ji(a,{weekStartsOn:1}),endDate:kf(a,{weekStartsOn:1})};case"THIS_MONTH":return{startDate:Lp(r),endDate:Pp(r)};case"LAST_MONTH":const n=ET(r);return{startDate:Lp(n),endDate:Pp(n)};case"THIS_QUARTER":return{startDate:vE(r),endDate:yE(r)};case"THIS_SEMESTER":const o=r.getMonth()<6?new Date(r.getFullYear(),0,1):new Date(r.getFullYear(),6,1),s=r.getMonth()<6?new Date(r.getFullYear(),5,30):new Date(r.getFullYear(),11,31);return{startDate:Ki(o),endDate:ap(s)};case"THIS_YEAR":return{startDate:Sm(r),endDate:Bp(r)};case"LAST_YEAR_AND_THIS_YEAR":const l=r.getFullYear()-1;return{startDate:new Date(l,0,1),endDate:Bp(r)};default:return{}}}function uN(t){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style");e.type="text/css",r.appendChild(e),e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}const dN=t=>{switch(t){case"success":return pN;case"info":return gN;case"warning":return mN;case"error":return vN;default:return null}},fN=Array(12).fill(0),hN=({visible:t,className:r})=>Xe.createElement("div",{className:["sonner-loading-wrapper",r].filter(Boolean).join(" "),"data-visible":t},Xe.createElement("div",{className:"sonner-spinner"},fN.map((e,a)=>Xe.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${a}`})))),pN=Xe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Xe.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),mN=Xe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Xe.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),gN=Xe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Xe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),vN=Xe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Xe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),bN=Xe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Xe.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Xe.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),xN=()=>{const[t,r]=Xe.useState(document.hidden);return Xe.useEffect(()=>{const e=()=>{r(document.hidden)};return document.addEventListener("visibilitychange",e),()=>window.removeEventListener("visibilitychange",e)},[]),t};let Zp=1;class yN{constructor(){this.subscribe=r=>(this.subscribers.push(r),()=>{const e=this.subscribers.indexOf(r);this.subscribers.splice(e,1)}),this.publish=r=>{this.subscribers.forEach(e=>e(r))},this.addToast=r=>{this.publish(r),this.toasts=[...this.toasts,r]},this.create=r=>{var e;const{message:a,...n}=r,o=typeof(r==null?void 0:r.id)=="number"||((e=r.id)==null?void 0:e.length)>0?r.id:Zp++,s=this.toasts.find(c=>c.id===o),l=r.dismissible===void 0?!0:r.dismissible;return this.dismissedToasts.has(o)&&this.dismissedToasts.delete(o),s?this.toasts=this.toasts.map(c=>c.id===o?(this.publish({...c,...r,id:o,title:a}),{...c,...r,id:o,dismissible:l,title:a}):c):this.addToast({title:a,...n,dismissible:l,id:o}),o},this.dismiss=r=>(r?(this.dismissedToasts.add(r),requestAnimationFrame(()=>this.subscribers.forEach(e=>e({id:r,dismiss:!0})))):this.toasts.forEach(e=>{this.subscribers.forEach(a=>a({id:e.id,dismiss:!0}))}),r),this.message=(r,e)=>this.create({...e,message:r}),this.error=(r,e)=>this.create({...e,message:r,type:"error"}),this.success=(r,e)=>this.create({...e,type:"success",message:r}),this.info=(r,e)=>this.create({...e,type:"info",message:r}),this.warning=(r,e)=>this.create({...e,type:"warning",message:r}),this.loading=(r,e)=>this.create({...e,type:"loading",message:r}),this.promise=(r,e)=>{if(!e)return;let a;e.loading!==void 0&&(a=this.create({...e,promise:r,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));const n=Promise.resolve(r instanceof Function?r():r);let o=a!==void 0,s;const l=n.then(async i=>{if(s=["resolve",i],Xe.isValidElement(i))o=!1,this.create({id:a,type:"default",message:i});else if(_N(i)&&!i.ok){o=!1;const p=typeof e.error=="function"?await e.error(`HTTP error! status: ${i.status}`):e.error,f=typeof e.description=="function"?await e.description(`HTTP error! status: ${i.status}`):e.description,v=typeof p=="object"&&!Xe.isValidElement(p)?p:{message:p};this.create({id:a,type:"error",description:f,...v})}else if(i instanceof Error){o=!1;const p=typeof e.error=="function"?await e.error(i):e.error,f=typeof e.description=="function"?await e.description(i):e.description,v=typeof p=="object"&&!Xe.isValidElement(p)?p:{message:p};this.create({id:a,type:"error",description:f,...v})}else if(e.success!==void 0){o=!1;const p=typeof e.success=="function"?await e.success(i):e.success,f=typeof e.description=="function"?await e.description(i):e.description,v=typeof p=="object"&&!Xe.isValidElement(p)?p:{message:p};this.create({id:a,type:"success",description:f,...v})}}).catch(async i=>{if(s=["reject",i],e.error!==void 0){o=!1;const u=typeof e.error=="function"?await e.error(i):e.error,p=typeof e.description=="function"?await e.description(i):e.description,h=typeof u=="object"&&!Xe.isValidElement(u)?u:{message:u};this.create({id:a,type:"error",description:p,...h})}}).finally(()=>{o&&(this.dismiss(a),a=void 0),e.finally==null||e.finally.call(e)}),c=()=>new Promise((i,u)=>l.then(()=>s[0]==="reject"?u(s[1]):i(s[1])).catch(u));return typeof a!="string"&&typeof a!="number"?{unwrap:c}:Object.assign(a,{unwrap:c})},this.custom=(r,e)=>{const a=(e==null?void 0:e.id)||Zp++;return this.create({jsx:r(a),id:a,...e}),a},this.getActiveToasts=()=>this.toasts.filter(r=>!this.dismissedToasts.has(r.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const on=new yN,wN=(t,r)=>{const e=(r==null?void 0:r.id)||Zp++;return on.addToast({title:t,...r,id:e}),e},_N=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",SN=wN,kN=()=>on.toasts,EN=()=>on.getActiveToasts(),wt=Object.assign(SN,{success:on.success,info:on.info,warning:on.warning,error:on.error,custom:on.custom,message:on.message,promise:on.promise,dismiss:on.dismiss,loading:on.loading},{getHistory:kN,getToasts:EN});uN("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function df(t){return t.label!==void 0}const TN=3,AN="24px",CN="16px",$x=4e3,NN=356,jN=14,ON=45,DN=200;function xs(...t){return t.filter(Boolean).join(" ")}function MN(t){const[r,e]=t.split("-"),a=[];return r&&a.push(r),e&&a.push(e),a}const RN=t=>{var r,e,a,n,o,s,l,c,i;const{invert:u,toast:p,unstyled:f,interacting:h,setHeights:v,visibleToasts:b,heights:g,index:x,toasts:y,expanded:E,removeToast:N,defaultRichColors:I,closeButton:P,style:V,cancelButtonStyle:U,actionButtonStyle:H,className:G="",descriptionClassName:Z="",duration:W,position:O,gap:R,expandByDefault:C,classNames:_,icons:k,closeButtonAriaLabel:A="Close toast"}=t,[T,D]=Xe.useState(null),[B,F]=Xe.useState(null),[Y,X]=Xe.useState(!1),[re,z]=Xe.useState(!1),[ee,L]=Xe.useState(!1),[M,K]=Xe.useState(!1),[se,te]=Xe.useState(!1),[ae,Q]=Xe.useState(0),[fe,le]=Xe.useState(0),ne=Xe.useRef(p.duration||W||$x),ue=Xe.useRef(null),he=Xe.useRef(null),ke=x===0,pe=x+1<=b,Ce=p.type,Me=p.dismissible!==!1,Ie=p.className||"",Ye=p.descriptionClassName||"",at=Xe.useMemo(()=>g.findIndex(ut=>ut.toastId===p.id)||0,[g,p.id]),rt=Xe.useMemo(()=>{var ut;return(ut=p.closeButton)!=null?ut:P},[p.closeButton,P]),it=Xe.useMemo(()=>p.duration||W||$x,[p.duration,W]),et=Xe.useRef(0),st=Xe.useRef(0),je=Xe.useRef(0),ht=Xe.useRef(null),[Je,nt]=O.split("-"),ct=Xe.useMemo(()=>g.reduce((ut,vt,xt)=>xt>=at?ut:ut+vt.height,0),[g,at]),_t=xN(),mt=p.invert||u,gt=Ce==="loading";st.current=Xe.useMemo(()=>at*R+ct,[at,ct]),Xe.useEffect(()=>{ne.current=it},[it]),Xe.useEffect(()=>{X(!0)},[]),Xe.useEffect(()=>{const ut=he.current;if(ut){const vt=ut.getBoundingClientRect().height;return le(vt),v(xt=>[{toastId:p.id,height:vt,position:p.position},...xt]),()=>v(xt=>xt.filter(At=>At.toastId!==p.id))}},[v,p.id]),Xe.useLayoutEffect(()=>{if(!Y)return;const ut=he.current,vt=ut.style.height;ut.style.height="auto";const xt=ut.getBoundingClientRect().height;ut.style.height=vt,le(xt),v(At=>At.find(yt=>yt.toastId===p.id)?At.map(yt=>yt.toastId===p.id?{...yt,height:xt}:yt):[{toastId:p.id,height:xt,position:p.position},...At])},[Y,p.title,p.description,v,p.id,p.jsx,p.action,p.cancel]);const He=Xe.useCallback(()=>{z(!0),Q(st.current),v(ut=>ut.filter(vt=>vt.toastId!==p.id)),setTimeout(()=>{N(p)},DN)},[p,N,v,st]);Xe.useEffect(()=>{if(p.promise&&Ce==="loading"||p.duration===1/0||p.type==="loading")return;let ut;return E||h||_t?(()=>{if(je.current<et.current){const At=new Date().getTime()-et.current;ne.current=ne.current-At}je.current=new Date().getTime()})():(()=>{ne.current!==1/0&&(et.current=new Date().getTime(),ut=setTimeout(()=>{p.onAutoClose==null||p.onAutoClose.call(p,p),He()},ne.current))})(),()=>clearTimeout(ut)},[E,h,p,Ce,_t,He]),Xe.useEffect(()=>{p.delete&&(He(),p.onDismiss==null||p.onDismiss.call(p,p))},[He,p.delete]);function Ue(){var ut;if(k!=null&&k.loading){var vt;return Xe.createElement("div",{className:xs(_==null?void 0:_.loader,p==null||(vt=p.classNames)==null?void 0:vt.loader,"sonner-loader"),"data-visible":Ce==="loading"},k.loading)}return Xe.createElement(hN,{className:xs(_==null?void 0:_.loader,p==null||(ut=p.classNames)==null?void 0:ut.loader),visible:Ce==="loading"})}const bt=p.icon||(k==null?void 0:k[Ce])||dN(Ce);var tt,dt;return Xe.createElement("li",{tabIndex:0,ref:he,className:xs(G,Ie,_==null?void 0:_.toast,p==null||(r=p.classNames)==null?void 0:r.toast,_==null?void 0:_.default,_==null?void 0:_[Ce],p==null||(e=p.classNames)==null?void 0:e[Ce]),"data-sonner-toast":"","data-rich-colors":(tt=p.richColors)!=null?tt:I,"data-styled":!(p.jsx||p.unstyled||f),"data-mounted":Y,"data-promise":!!p.promise,"data-swiped":se,"data-removed":re,"data-visible":pe,"data-y-position":Je,"data-x-position":nt,"data-index":x,"data-front":ke,"data-swiping":ee,"data-dismissible":Me,"data-type":Ce,"data-invert":mt,"data-swipe-out":M,"data-swipe-direction":B,"data-expanded":!!(E||C&&Y),"data-testid":p.testId,style:{"--index":x,"--toasts-before":x,"--z-index":y.length-x,"--offset":`${re?ae:st.current}px`,"--initial-height":C?"auto":`${fe}px`,...V,...p.style},onDragEnd:()=>{L(!1),D(null),ht.current=null},onPointerDown:ut=>{ut.button!==2&&(gt||!Me||(ue.current=new Date,Q(st.current),ut.target.setPointerCapture(ut.pointerId),ut.target.tagName!=="BUTTON"&&(L(!0),ht.current={x:ut.clientX,y:ut.clientY})))},onPointerUp:()=>{var ut,vt,xt;if(M||!Me)return;ht.current=null;const At=Number(((ut=he.current)==null?void 0:ut.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Kt=Number(((vt=he.current)==null?void 0:vt.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),yt=new Date().getTime()-((xt=ue.current)==null?void 0:xt.getTime()),Ct=T==="x"?At:Kt,Ft=Math.abs(Ct)/yt;if(Math.abs(Ct)>=ON||Ft>.11){Q(st.current),p.onDismiss==null||p.onDismiss.call(p,p),F(T==="x"?At>0?"right":"left":Kt>0?"down":"up"),He(),K(!0);return}else{var kt,Ae;(kt=he.current)==null||kt.style.setProperty("--swipe-amount-x","0px"),(Ae=he.current)==null||Ae.style.setProperty("--swipe-amount-y","0px")}te(!1),L(!1),D(null)},onPointerMove:ut=>{var vt,xt,At;if(!ht.current||!Me||((vt=window.getSelection())==null?void 0:vt.toString().length)>0)return;const yt=ut.clientY-ht.current.y,Ct=ut.clientX-ht.current.x;var Ft;const kt=(Ft=t.swipeDirections)!=null?Ft:MN(O);!T&&(Math.abs(Ct)>1||Math.abs(yt)>1)&&D(Math.abs(Ct)>Math.abs(yt)?"x":"y");let Ae={x:0,y:0};const Fe=Qe=>1/(1.5+Math.abs(Qe)/20);if(T==="y"){if(kt.includes("top")||kt.includes("bottom"))if(kt.includes("top")&&yt<0||kt.includes("bottom")&&yt>0)Ae.y=yt;else{const Qe=yt*Fe(yt);Ae.y=Math.abs(Qe)<Math.abs(yt)?Qe:yt}}else if(T==="x"&&(kt.includes("left")||kt.includes("right")))if(kt.includes("left")&&Ct<0||kt.includes("right")&&Ct>0)Ae.x=Ct;else{const Qe=Ct*Fe(Ct);Ae.x=Math.abs(Qe)<Math.abs(Ct)?Qe:Ct}(Math.abs(Ae.x)>0||Math.abs(Ae.y)>0)&&te(!0),(xt=he.current)==null||xt.style.setProperty("--swipe-amount-x",`${Ae.x}px`),(At=he.current)==null||At.style.setProperty("--swipe-amount-y",`${Ae.y}px`)}},rt&&!p.jsx&&Ce!=="loading"?Xe.createElement("button",{"aria-label":A,"data-disabled":gt,"data-close-button":!0,onClick:gt||!Me?()=>{}:()=>{He(),p.onDismiss==null||p.onDismiss.call(p,p)},className:xs(_==null?void 0:_.closeButton,p==null||(a=p.classNames)==null?void 0:a.closeButton)},(dt=k==null?void 0:k.close)!=null?dt:bN):null,(Ce||p.icon||p.promise)&&p.icon!==null&&((k==null?void 0:k[Ce])!==null||p.icon)?Xe.createElement("div",{"data-icon":"",className:xs(_==null?void 0:_.icon,p==null||(n=p.classNames)==null?void 0:n.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||Ue():null,p.type!=="loading"?bt:null):null,Xe.createElement("div",{"data-content":"",className:xs(_==null?void 0:_.content,p==null||(o=p.classNames)==null?void 0:o.content)},Xe.createElement("div",{"data-title":"",className:xs(_==null?void 0:_.title,p==null||(s=p.classNames)==null?void 0:s.title)},p.jsx?p.jsx:typeof p.title=="function"?p.title():p.title),p.description?Xe.createElement("div",{"data-description":"",className:xs(Z,Ye,_==null?void 0:_.description,p==null||(l=p.classNames)==null?void 0:l.description)},typeof p.description=="function"?p.description():p.description):null),Xe.isValidElement(p.cancel)?p.cancel:p.cancel&&df(p.cancel)?Xe.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||U,onClick:ut=>{df(p.cancel)&&Me&&(p.cancel.onClick==null||p.cancel.onClick.call(p.cancel,ut),He())},className:xs(_==null?void 0:_.cancelButton,p==null||(c=p.classNames)==null?void 0:c.cancelButton)},p.cancel.label):null,Xe.isValidElement(p.action)?p.action:p.action&&df(p.action)?Xe.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||H,onClick:ut=>{df(p.action)&&(p.action.onClick==null||p.action.onClick.call(p.action,ut),!ut.defaultPrevented&&He())},className:xs(_==null?void 0:_.actionButton,p==null||(i=p.classNames)==null?void 0:i.actionButton)},p.action.label):null)};function Vx(){if(typeof window>"u"||typeof document>"u")return"ltr";const t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function IN(t,r){const e={};return[t,r].forEach((a,n)=>{const o=n===1,s=o?"--mobile-offset":"--offset",l=o?CN:AN;function c(i){["top","right","bottom","left"].forEach(u=>{e[`${s}-${u}`]=typeof i=="number"?`${i}px`:i})}typeof a=="number"||typeof a=="string"?c(a):typeof a=="object"?["top","right","bottom","left"].forEach(i=>{a[i]===void 0?e[`${s}-${i}`]=l:e[`${s}-${i}`]=typeof a[i]=="number"?`${a[i]}px`:a[i]}):c(l)}),e}const FN=Xe.forwardRef(function(r,e){const{id:a,invert:n,position:o="bottom-right",hotkey:s=["altKey","KeyT"],expand:l,closeButton:c,className:i,offset:u,mobileOffset:p,theme:f="light",richColors:h,duration:v,style:b,visibleToasts:g=TN,toastOptions:x,dir:y=Vx(),gap:E=jN,icons:N,containerAriaLabel:I="Notifications"}=r,[P,V]=Xe.useState([]),U=Xe.useMemo(()=>a?P.filter(Y=>Y.toasterId===a):P.filter(Y=>!Y.toasterId),[P,a]),H=Xe.useMemo(()=>Array.from(new Set([o].concat(U.filter(Y=>Y.position).map(Y=>Y.position)))),[U,o]),[G,Z]=Xe.useState([]),[W,O]=Xe.useState(!1),[R,C]=Xe.useState(!1),[_,k]=Xe.useState(f!=="system"?f:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),A=Xe.useRef(null),T=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),D=Xe.useRef(null),B=Xe.useRef(!1),F=Xe.useCallback(Y=>{V(X=>{var re;return(re=X.find(z=>z.id===Y.id))!=null&&re.delete||on.dismiss(Y.id),X.filter(({id:z})=>z!==Y.id)})},[]);return Xe.useEffect(()=>on.subscribe(Y=>{if(Y.dismiss){requestAnimationFrame(()=>{V(X=>X.map(re=>re.id===Y.id?{...re,delete:!0}:re))});return}setTimeout(()=>{Q5.flushSync(()=>{V(X=>{const re=X.findIndex(z=>z.id===Y.id);return re!==-1?[...X.slice(0,re),{...X[re],...Y},...X.slice(re+1)]:[Y,...X]})})})}),[P]),Xe.useEffect(()=>{if(f!=="system"){k(f);return}if(f==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?k("dark"):k("light")),typeof window>"u")return;const Y=window.matchMedia("(prefers-color-scheme: dark)");try{Y.addEventListener("change",({matches:X})=>{k(X?"dark":"light")})}catch{Y.addListener(({matches:re})=>{try{k(re?"dark":"light")}catch(z){console.error(z)}})}},[f]),Xe.useEffect(()=>{P.length<=1&&O(!1)},[P]),Xe.useEffect(()=>{const Y=X=>{var re;if(s.every(L=>X[L]||X.code===L)){var ee;O(!0),(ee=A.current)==null||ee.focus()}X.code==="Escape"&&(document.activeElement===A.current||(re=A.current)!=null&&re.contains(document.activeElement))&&O(!1)};return document.addEventListener("keydown",Y),()=>document.removeEventListener("keydown",Y)},[s]),Xe.useEffect(()=>{if(A.current)return()=>{D.current&&(D.current.focus({preventScroll:!0}),D.current=null,B.current=!1)}},[A.current]),Xe.createElement("section",{ref:e,"aria-label":`${I} ${T}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},H.map((Y,X)=>{var re;const[z,ee]=Y.split("-");return U.length?Xe.createElement("ol",{key:Y,dir:y==="auto"?Vx():y,tabIndex:-1,ref:A,className:i,"data-sonner-toaster":!0,"data-sonner-theme":_,"data-y-position":z,"data-x-position":ee,style:{"--front-toast-height":`${((re=G[0])==null?void 0:re.height)||0}px`,"--width":`${NN}px`,"--gap":`${E}px`,...b,...IN(u,p)},onBlur:L=>{B.current&&!L.currentTarget.contains(L.relatedTarget)&&(B.current=!1,D.current&&(D.current.focus({preventScroll:!0}),D.current=null))},onFocus:L=>{L.target instanceof HTMLElement&&L.target.dataset.dismissible==="false"||B.current||(B.current=!0,D.current=L.relatedTarget)},onMouseEnter:()=>O(!0),onMouseMove:()=>O(!0),onMouseLeave:()=>{R||O(!1)},onDragEnd:()=>O(!1),onPointerDown:L=>{L.target instanceof HTMLElement&&L.target.dataset.dismissible==="false"||C(!0)},onPointerUp:()=>C(!1)},U.filter(L=>!L.position&&X===0||L.position===Y).map((L,M)=>{var K,se;return Xe.createElement(RN,{key:L.id,icons:N,index:M,toast:L,defaultRichColors:h,duration:(K=x==null?void 0:x.duration)!=null?K:v,className:x==null?void 0:x.className,descriptionClassName:x==null?void 0:x.descriptionClassName,invert:n,visibleToasts:g,closeButton:(se=x==null?void 0:x.closeButton)!=null?se:c,interacting:R,position:Y,style:x==null?void 0:x.style,unstyled:x==null?void 0:x.unstyled,classNames:x==null?void 0:x.classNames,cancelButtonStyle:x==null?void 0:x.cancelButtonStyle,actionButtonStyle:x==null?void 0:x.actionButtonStyle,closeButtonAriaLabel:x==null?void 0:x.closeButtonAriaLabel,removeToast:F,toasts:U.filter(te=>te.position==L.position),heights:G.filter(te=>te.position==L.position),setHeights:Z,expandByDefault:l,gap:E,expanded:W,swipeDirections:r.swipeDirections})})):null}))}),PN=["#17432a","#17432a","#17432a","#17432a","#17432a","#17432a"],LN=["#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7"],Js=({x:t,y:r,payload:e})=>{const n=e.value.split(" ");let o=[],s="";return n.forEach(l=>{(s+l).length<=10?s+=`${l} `:(s.trim()&&o.push(s.trim()),s=`${l} `)}),s.trim()&&o.push(s.trim()),w.jsx("g",{transform:`translate(${t},${r})`,children:w.jsx("text",{x:0,y:0,dy:16,textAnchor:"middle",fill:"currentColor",fontSize:10,fontWeight:"bold",children:o.map((l,c)=>w.jsx("tspan",{x:"0",dy:c===0?0:14,children:l},c))})})};function BN(){const{filters:t}=ec(),{user:r}=Oa(),[e,a]=Se.useState(!0),[n,o]=Se.useState({totalValue:0,totalReturns:0,avgTicket:0,slaBreach:0,totalProducts:0}),[s,l]=Se.useState(0),[c,i]=Se.useState([]),[u,p]=Se.useState([]),[f,h]=Se.useState([]),[v,b]=Se.useState([]),[g,x]=Se.useState([]),[y,E]=Se.useState([]),[N,I]=Se.useState([]),[P,V]=Se.useState([]),[U,H]=Se.useState([]),[G,Z]=Se.useState(!1),[W,O]=Se.useState([]),[R,C]=Se.useState([]),[_,k]=Se.useState([]),[A,T]=Se.useState([]),[D,B]=Se.useState([]),[F,Y]=Se.useState([]);Se.useEffect(()=>{const M=()=>{Z(document.documentElement.classList.contains("dark"))};M();const K=new MutationObserver(M);return K.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>K.disconnect()},[]);const X=G?LN:PN;Se.useEffect(()=>{re()},[t,r]);const re=async()=>{try{a(!0);const M=(r==null?void 0:r.role)==="VENDEDOR"?r.vendedor:null;let K=St.from("devolucoes").select(`
          *,
          motivos_devolucao(nome),
          setores(nome),
          itens:itens_devolucao(quantidade, descricao, motivo_id, valor_total_bruto, unidade)
      `);r&&r.role==="VENDEDOR"&&M&&(K=K.eq("vendedor",M),console.log(" Dashboard - Filtrando por vendedor:",M));const se=t.period&&!t.startDate&&!t.endDate?ju(t.period):{},te=t.startDate||se.startDate,ae=t.endDate||se.endDate;K=K.in("resultado",["PENDENTE VALIDAO","TRATATIVA DE ANULAO","VALIDADA"]),t.search&&(K=K.or(`nome_cliente.ilike.%${t.search}%,vendedor.ilike.%${t.search}%,numero.ilike.%${t.search}%`)),t.motivo&&t.motivo.length>0&&(K=K.in("motivo_id",t.motivo)),t.cliente&&t.cliente.length>0&&(K=K.in("nome_cliente",t.cliente)),t.vendedor&&t.vendedor.length>0&&(K=K.in("vendedor",t.vendedor)),t.setor&&t.setor.length>0&&(K=K.in("setor_id",t.setor)),te&&(K=K.gte("data_emissao",te.toISOString().split("T")[0])),ae&&(K=K.lte("data_emissao",ae.toISOString().split("T")[0]));const{data:Q,error:fe}=await K;if(fe){console.error(" Erro ao buscar dados do Dashboard:",fe),wt.error("Erro ao carregar dados do Dashboard: "+fe.message),a(!1);return}if(!Q||Q.length===0){console.log(" Nenhuma devoluo encontrada para os filtros selecionados"),o({totalValue:0,totalReturns:0,avgTicket:0,slaBreach:0,totalProducts:0}),l(0),i([]),p([]),h([]),b([]),E([]),I([]),V([]),H([]),x([]),T([]),O([]),C([]),k([]),a(!1);return}if(Q){console.log(` Dashboard: ${Q.length} devolues carregadas`);const le=Q.reduce((xe,Ee)=>xe+(Number(Ee.valor_total_nota)||0),0),ne=Q.length,ue=ne>0?le/ne:0,he=Q.reduce((xe,Ee)=>{const qe=Ee.itens||[];return xe+qe.reduce((ce,Te)=>ce+(Number(Te.quantidade)||0),0)},0),ke=Q.filter(xe=>xe.prazo==="EM ATRASO").length,pe=Q.filter(xe=>xe.resultado==="PENDENTE VALIDAO"||xe.resultado==="TRATATIVA DE ANULAO").reduce((xe,Ee)=>xe+(Number(Ee.valor_total_nota)||0),0);o({totalValue:le,totalReturns:ne,avgTicket:ue,slaBreach:ke,totalProducts:he}),l(pe);const Ce=Q.reduce((xe,Ee)=>{const qe=new Date(Ee.data_emissao||Ee.created_at),ce=Xt(qe,"dd/MM",{locale:yr});return xe[ce]||(xe[ce]={value:0,count:0}),xe[ce].value+=Number(Ee.valor_total_nota)||0,xe[ce].count+=1,xe},{}),Me=Object.keys(Ce).sort((xe,Ee)=>{const qe=new Date(xe.split("/").reverse().join("-")),ce=new Date(Ee.split("/").reverse().join("-"));return qe.getTime()-ce.getTime()}).map(xe=>({name:xe,value:Ce[xe].value,count:Ce[xe].count}));i(Me);const Ie={};Q.forEach(xe=>{const Ee=xe.nome_cliente||"Desconhecido",qe=Number(xe.valor_total_nota)||0;Ie[Ee]||(Ie[Ee]={valor:0,detalhes:[]}),Ie[Ee].valor+=qe,Ie[Ee].detalhes.push({cliente:Ee,nota:xe.numero||"-"})});const Ye=Object.entries(Ie).map(([xe,Ee])=>({name:xe,value:Ee.valor,quantidade:Ee.detalhes.length,detalhes:Ee.detalhes})).sort((xe,Ee)=>Ee.value-xe.value).slice(0,10);p(Ye);const at={};Q.forEach(xe=>{const Ee=xe.vendedor||"Desconhecido",qe=Number(xe.valor_total_nota)||0;at[Ee]||(at[Ee]={valor:0,detalhes:[]}),at[Ee].valor+=qe,at[Ee].detalhes.push({cliente:xe.nome_cliente||"Desconhecido",nota:xe.numero||"-"})});const rt=Object.entries(at).map(([xe,Ee])=>({name:xe,value:Ee.valor,quantidade:Ee.detalhes.length,detalhes:Ee.detalhes})).sort((xe,Ee)=>Ee.value-xe.value).slice(0,5);h(rt);const it={};Q.forEach(xe=>{let Ee=xe.rede||"Sem rede";Ee==="Sem rede"&&xe.cnpj_destinatario&&(Ee=xe.rede||"Sem rede");const qe=Number(xe.valor_total_nota)||0;it[Ee]||(it[Ee]={valor:0,detalhes:[]}),it[Ee].valor+=qe,it[Ee].detalhes.push({cliente:xe.nome_cliente||"Desconhecido",nota:xe.numero||"-"})});const et=Object.entries(it).map(([xe,Ee])=>({name:xe,value:Ee.valor,quantidade:Ee.detalhes.length,detalhes:Ee.detalhes})).sort((xe,Ee)=>Ee.value-xe.value).slice(0,5);b(et);const st=Object.entries(Ie).map(([xe,Ee])=>({name:xe,value:Ee.valor,detalhes:Ee.detalhes})).sort((xe,Ee)=>Ee.value-xe.value);let je=0;const ht=st.reduce((xe,Ee)=>xe+Ee.value,0),Je=st.map((xe,Ee)=>(je+=xe.value,{name:xe.name.length>15?xe.name.substring(0,15)+"...":xe.name,value:xe.value,cumulative:je,percentage:je/ht*100,index:Ee+1,quantidade:xe.detalhes.length,detalhes:xe.detalhes})).slice(0,10);E(Je);const nt=Q.filter(xe=>xe.resultado==="PENDENTE VALIDAO"),ct={};nt.forEach(xe=>{const Ee=xe.itens||[],qe=xe.rede||"Sem rede";Ee.forEach(ce=>{const ye=(ce.descricao||"Desconhecido").split(" ").slice(0,2).join(" ");ct[ye]||(ct[ye]={});const Ve=Number(ce.quantidade)||0,$e=ce.unidade||"UN";ct[ye][qe]||(ct[ye][qe]={quantidade:0,unidade:$e}),ct[ye][qe].quantidade+=Ve})});const _t=Object.keys(ct),mt=new Set;nt.forEach(xe=>{const Ee=xe.rede||"Sem rede";mt.add(Ee)});const gt=Array.from(mt).slice(0,8),He=_t.map(xe=>{const Ee={produto:xe};return gt.forEach(qe=>{var Te;const ce=(Te=ct[xe])==null?void 0:Te[qe];Ee[qe]=ce||{quantidade:0,unidade:"UN"}}),Ee});I(He);const Ue=Q.reduce((xe,Ee)=>{const qe=Ee.motivos_devolucao,ce=typeof qe=="object"&&(qe!=null&&qe.nome)?qe.nome:typeof qe=="string"?qe:null;return ce&&ce!=="No informado"&&ce!=="no informado"&&ce!=="NO INFORMADO"&&(xe[ce]=(xe[ce]||0)+1),xe},{}),bt=Object.entries(Ue).map(([xe,Ee])=>({name:xe,value:Ee})).sort((xe,Ee)=>Ee.value-xe.value).slice(0,5);console.log(" Reasons Chart:",bt),x(bt);const tt=Q.reduce((xe,Ee)=>{const qe=Ee.cidade_origem||"N/A";return xe[qe]=(xe[qe]||0)+(Number(Ee.valor_total_nota)||0),xe},{}),dt=Object.entries(tt).map(([xe,Ee])=>({name:xe,value:Ee})).sort((xe,Ee)=>Ee.value-xe.value).slice(0,6);console.log(" Municpio Chart:",dt),T(dt);const ut={};Q.filter(xe=>xe.resultado==="TRATATIVA DE ANULAO").forEach(xe=>{const Ee=new Date(xe.data_emissao||xe.created_at),qe=Xt(Ee,"dd/MM",{locale:yr});ut[qe]||(ut[qe]=[]),ut[qe].push({cliente:xe.nome_cliente||"Desconhecido",nota:xe.numero||"-"})});const vt=Object.keys(ut).sort((xe,Ee)=>{const qe=new Date(xe.split("/").reverse().join("-")),ce=new Date(Ee.split("/").reverse().join("-"));return qe.getTime()-ce.getTime()}).map(xe=>({name:xe,quantidade:ut[xe].length,detalhes:ut[xe]}));O(vt);const xt={};Q.filter(xe=>xe.resultado==="ANULADA/CANCELADA").forEach(xe=>{const Ee=new Date(xe.data_emissao||xe.created_at),qe=Xt(Ee,"dd/MM",{locale:yr});xt[qe]||(xt[qe]=[]),xt[qe].push({cliente:xe.nome_cliente||"Desconhecido",nota:xe.numero||"-"})});const At=Object.keys(xt).sort((xe,Ee)=>{const qe=new Date(xe.split("/").reverse().join("-")),ce=new Date(Ee.split("/").reverse().join("-"));return qe.getTime()-ce.getTime()}).map(xe=>({name:xe,quantidade:xt[xe].length,detalhes:xt[xe]}));C(At);const Kt=xe=>{if(!xe)return null;const Ee=xe.toUpperCase().trim();return["CX","CX1","CXI","CX10","CXS","FD"].includes(Ee)?"CX":["UN","UND","UN1","UNID","BD","BDJ","KG","KG1","KGS","PTC","PT","PT1","PC","PC1","SC","SC1"].includes(Ee)?"UN":null},yt={},Ct={};Q.forEach(xe=>{(xe.itens||[]).forEach(qe=>{const ce=qe.descricao||"Desconhecido",Te=Number(qe.quantidade)||0,me=qe.unidade||"",ye=Kt(me);ye==="CX"?(yt[ce]||(yt[ce]={quantidade:0,unidade:me}),yt[ce].quantidade+=Te):ye==="UN"&&(Ct[ce]||(Ct[ce]={quantidade:0,unidade:me}),Ct[ce].quantidade+=Te)})});const Ft=Object.entries(yt).map(([xe,Ee])=>({name:xe.split(" ").slice(0,2).join(" "),nameFull:xe,quantidade:Ee.quantidade,unidade:Ee.unidade,tipo:"CX"})).sort((xe,Ee)=>Ee.quantidade-xe.quantidade).slice(0,5),kt=Object.entries(Ct).map(([xe,Ee])=>({name:xe.split(" ").slice(0,2).join(" "),nameFull:xe,quantidade:Ee.quantidade,unidade:Ee.unidade,tipo:"UN"})).sort((xe,Ee)=>Ee.quantidade-xe.quantidade).slice(0,5),Ae=[...Ft,...kt];console.log(" Top Produtos:",Ae),k(Ae);const Fe={};Q.filter(xe=>xe.resultado==="TRATATIVA DE ANULAO"||xe.resultado==="ANULADA/CANCELADA").forEach(xe=>{const Ee=xe.nome_cliente||"Desconhecido";Fe[Ee]||(Fe[Ee]={count:0,detalhes:[]}),Fe[Ee].count+=1,Fe[Ee].detalhes.push({cliente:Ee,nota:xe.numero||"-"})});const Qe=Object.entries(Fe).map(([xe,Ee])=>({name:xe,count:Ee.count,quantidade:Ee.detalhes.length,detalhes:Ee.detalhes})).sort((xe,Ee)=>Ee.count-xe.count).slice(0,5);B(Qe);const ie={};Q.forEach(xe=>{var ce;const Ee=xe.rede||"Sem rede",qe=(ce=xe.motivos_devolucao)==null?void 0:ce.nome;!qe||qe==="No informado"||qe==="no informado"||qe==="NO INFORMADO"||(ie[Ee]||(ie[Ee]={}),ie[Ee][qe]||(ie[Ee][qe]={count:0,detalhes:[]}),ie[Ee][qe].count+=1,ie[Ee][qe].detalhes.push({cliente:xe.nome_cliente||"Desconhecido",nota:xe.numero||"-"}))});const _e=[];Object.entries(ie).sort((xe,Ee)=>{const qe=Object.values(xe[1]).reduce((Te,me)=>Te+me.count,0);return Object.values(Ee[1]).reduce((Te,me)=>Te+me.count,0)-qe}).slice(0,5).forEach(([xe,Ee])=>{const qe=Object.entries(Ee).sort((ce,Te)=>Te[1].count-ce[1].count)[0];qe&&_e.push({rede:xe.length>15?xe.substring(0,15)+"...":xe,motivo:qe[0].length>20?qe[0].substring(0,20)+"...":qe[0],count:qe[1].count,quantidade:qe[1].detalhes.length,detalhes:qe[1].detalhes})}),Y(_e);const de=[];if(ne>0&&de.push(` Total de ${ne} devoluo(es) no perodo selecionado, totalizando R$ ${le.toLocaleString("pt-BR",{minimumFractionDigits:2})}.`),Ye.length>0&&le>0){const xe=Ye[0].value/le*100;xe>20&&de.push(` Cliente "${Ye[0].name}" concentra ${xe.toFixed(1)}% do valor total de devolues.`)}if(he>0&&ne>0){const xe=he/ne;de.push(` Mdia de ${xe.toFixed(1)} produtos por devoluo.`)}if(rt.length>0&&de.push(` Vendedor "${rt[0].name}" lidera em devolues com R$ ${rt[0].value.toLocaleString("pt-BR")}.`),Je.length>0){const xe=Je.findIndex(Ee=>Ee.percentage>=80);xe>=0&&xe<5&&de.push(` Regra 80/20: ${xe+1} clientes concentram 80% do valor de devolues.`)}if(Ae.length>0){const xe=Ae[0];de.push(` Produto "${xe.name}"  o mais devolvido com ${xe.quantidade} unidades.`)}const ve=Q.filter(xe=>xe.resultado==="TRATATIVA DE ANULAO"||xe.resultado==="ANULADA/CANCELADA").length,be=ne>0?ve/ne*100:0;if(be>10?de.push(` Taxa de cancelamento alta: ${be.toFixed(1)}% das devolues esto em cancelamento.`):ve>0&&de.push(` ${ve} devoluo(es) em processo de cancelamento.`),bt.length>0){const xe=bt[0];de.push(` Motivo mais frequente: "${xe.name}" com ${xe.value} ocorrncia(s).`)}if(ue>0){const xe=Q.filter(Ee=>Number(Ee.valor_total_nota)>ue*1.5).length;xe>0&&de.push(` ${xe} devoluo(es) com valor acima de 150% do ticket mdio.`)}if(et.length>0&&le>0){const xe=et[0].value/le*100;xe>15&&de.push(` Rede "${et[0].name}" representa ${xe.toFixed(1)}% do valor devolvido.`)}if(Me.length>=2){const xe=Me[Me.length-1].value,Ee=Me[Me.length-2].value;if(Ee>0){const qe=(xe-Ee)/Ee*100;if(Math.abs(qe)>20){const ce=qe>0?"aumento":"reduo";de.push(` ${ce.charAt(0).toUpperCase()+ce.slice(1)} de ${Math.abs(qe).toFixed(1)}% no valor devolvido comparado ao perodo anterior.`)}}}console.log(" Insights:",de),V(de);const we=[],De=Q.filter(xe=>xe.prazo==="EM ATRASO");if(De.length>0){const xe=De.reduce((Ee,qe)=>Ee+(Number(qe.valor_total_nota)||0),0);we.push({type:"warning",message:`${De.length} nota(s) em atraso`,count:De.length,total:De.length,value:xe})}ne>50&&we.push({type:"info",message:`Total de ${ne} notas no perodo (acima de 50)`,count:ne,total:ne});const Le=Q.filter(xe=>xe.resultado==="PENDENTE VALIDAO");if(Le.length>20){const xe=Le.reduce((Ee,qe)=>Ee+(Number(qe.valor_total_nota)||0),0);we.push({type:"warning",message:`${Le.length} nota(s) pendentes de validao (acima de 20)`,count:Le.length,total:Le.length,value:xe})}const Oe=Q.filter(xe=>Number(xe.valor_total_nota)>1e3);if(Oe.length>0){const xe=Oe.reduce((Ee,qe)=>Ee+(Number(qe.valor_total_nota)||0),0);we.push({type:"warning",message:`${Oe.length} nota(s) com valor acima de R$ 1.000,00`,count:Oe.length,total:Oe.length,value:xe})}const Pe={};Le.forEach(xe=>{const Ee=xe.nome_cliente||"Desconhecido";Pe[Ee]||(Pe[Ee]=[]),Pe[Ee].push(xe)}),Object.entries(Pe).forEach(([xe,Ee])=>{if(Ee.length>5){const qe=Ee.reduce((ce,Te)=>ce+(Number(Te.valor_total_nota)||0),0);we.push({type:"error",message:`Cliente "${xe}" tem ${Ee.length} notas pendentes de validao`,cliente:xe,count:Ee.length,total:Ee.length,value:qe})}});const Be=Q.filter(xe=>xe.resultado==="TRATATIVA DE ANULAO");if(Be.length>0){const xe=Be.reduce((Ee,qe)=>Ee+(Number(qe.valor_total_nota)||0),0);we.push({type:"error",message:`${Be.length} nota(s) em tratativa de anulao`,detalhes:Be.map(Ee=>`NF ${Ee.numero} - ${Ee.nome_cliente||"Sem cliente"} - R$ ${(Number(Ee.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`),count:Be.length,total:Be.length,value:xe})}H(we)}}catch(M){console.error(" Erro ao processar dados do Dashboard:",M),wt.error("Erro ao processar dados: "+(M.message||"Erro desconhecido"))}finally{a(!1)}},z=({value:M})=>{const Q=-90+Math.min(M/4e4,1)*180,le=M<1e4?{color:"#10b981",label:"Normal",icon:"",bg:"bg-green-50"}:M<2e4?{color:"#f59e0b",label:"Ateno",icon:"",bg:"bg-yellow-50"}:{color:"#ef4444",label:"Crtico",icon:"",bg:"bg-red-50"};return w.jsxs("div",{className:"w-full max-w-sm mx-auto",children:[w.jsx("div",{className:"relative w-full",style:{paddingBottom:"50%"},children:w.jsxs("svg",{viewBox:"0 0 200 120",className:"absolute inset-0 w-full h-full",children:[w.jsx("path",{d:"M 20 100 A 80 80 0 0 1 65 35",fill:"none",stroke:"#10b981",strokeWidth:"20",strokeLinecap:"round"}),w.jsx("path",{d:"M 65 35 A 80 80 0 0 1 135 35",fill:"none",stroke:"#f59e0b",strokeWidth:"20",strokeLinecap:"round"}),w.jsx("path",{d:"M 135 35 A 80 80 0 0 1 180 100",fill:"none",stroke:"#ef4444",strokeWidth:"20",strokeLinecap:"round"}),[{val:0,angle:-90,label:"15k"},{val:1e4,angle:-45,label:"20k"},{val:15e3,angle:-22.5,label:"25k"},{val:2e4,angle:0,label:"35k"},{val:4e4,angle:90,label:"40k"}].map((ne,ue)=>{const he=ne.angle*Math.PI/180,ke=100+70*Math.cos(he),pe=100+70*Math.sin(he),Ce=100+85*Math.cos(he),Me=100+85*Math.sin(he),Ie=100+98*Math.cos(he),Ye=100+98*Math.sin(he);return w.jsxs("g",{children:[w.jsx("line",{x1:ke,y1:pe,x2:Ce,y2:Me,stroke:"#374151",strokeWidth:"3"}),w.jsx("text",{x:Ie,y:Ye,textAnchor:"middle",dominantBaseline:"middle",className:"text-[9px] fill-gray-700 font-bold",children:ne.label})]},ue)}),[5e3,12500,17500,25e3,3e4,35e3].map((ne,ue)=>{const pe=(-90+ne/4e4*180)*Math.PI/180,Ce=100+75*Math.cos(pe),Me=100+75*Math.sin(pe),Ie=100+85*Math.cos(pe),Ye=100+85*Math.sin(pe);return w.jsx("line",{x1:Ce,y1:Me,x2:Ie,y2:Ye,stroke:"#9ca3af",strokeWidth:"1.5"},`minor-${ue}`)}),w.jsxs("g",{transform:`rotate(${Q} 100 100)`,children:[w.jsx("path",{d:"M 100 100 L 96 94 L 98 25 L 100 20 L 102 25 L 104 94 Z",fill:"rgba(0,0,0,0.15)",transform:"translate(2, 2)"}),w.jsx("path",{d:"M 100 100 L 96 94 L 98 25 L 100 20 L 102 25 L 104 94 Z",fill:le.color,stroke:"#fff",strokeWidth:"1.5"}),w.jsx("path",{d:"M 100 20 L 99 25 L 99 70 L 100 70 Z",fill:"rgba(255,255,255,0.3)"})]}),w.jsx("circle",{cx:"101",cy:"101",r:"10",fill:"rgba(0,0,0,0.1)"}),w.jsx("circle",{cx:"100",cy:"100",r:"10",fill:"#fff",stroke:le.color,strokeWidth:"3"}),w.jsx("circle",{cx:"100",cy:"100",r:"5",fill:le.color}),w.jsx("circle",{cx:"98",cy:"98",r:"2",fill:"rgba(255,255,255,0.6)"})]})}),w.jsxs("div",{className:"mt-6 space-y-3",children:[w.jsx("div",{className:`${le.bg} rounded-xl p-5 border-2 shadow-lg`,style:{borderColor:le.color},children:w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"text-xs text-gray-600 font-medium mb-1",children:"VALOR TOTAL"}),w.jsxs("div",{className:"text-4xl font-bold tracking-tight",style:{color:le.color},children:["R$ ",M.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),w.jsxs("div",{className:"flex items-center justify-center gap-2 mt-3",children:[w.jsx("span",{className:"text-2xl",children:le.icon}),w.jsx("span",{className:"text-xl font-bold uppercase tracking-wide",style:{color:le.color},children:le.label})]})]})}),w.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[w.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg border-2 border-green-200",children:[w.jsx("div",{className:"font-bold text-green-700 mb-1",children:" Normal"}),w.jsx("div",{className:"text-green-600 font-semibold",children:"0 - 10k"})]}),w.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg border-2 border-yellow-200",children:[w.jsx("div",{className:"font-bold text-yellow-700 mb-1",children:" Ateno"}),w.jsx("div",{className:"text-yellow-600 font-semibold",children:"10k - 20k"})]}),w.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg border-2 border-red-200",children:[w.jsx("div",{className:"font-bold text-red-700 mb-1",children:" Crtico"}),w.jsx("div",{className:"text-red-600 font-semibold",children:"20k - 40k"})]})]})]})]})},ee=({alert:M})=>{const[K,se]=Se.useState(!1),ae={error:{bg:"bg-gradient-to-r from-red-50 to-red-100/50 dark:from-red-950/20 dark:to-red-900/10",border:"border-red-300 dark:border-red-800/50",iconBg:"bg-red-500",textColor:"text-red-800 dark:text-red-300",icon:Ao,badge:"bg-red-500 text-white"},warning:{bg:"bg-gradient-to-r from-amber-50 to-amber-100/50 dark:from-amber-950/20 dark:to-amber-900/10",border:"border-amber-300 dark:border-amber-800/50",iconBg:"bg-amber-500",textColor:"text-amber-800 dark:text-amber-300",icon:Rl,badge:"bg-amber-500 text-white"},info:{bg:"bg-gradient-to-r from-blue-50 to-blue-100/50 dark:from-blue-950/20 dark:to-blue-900/10",border:"border-blue-300 dark:border-blue-800/50",iconBg:"bg-blue-500",textColor:"text-blue-800 dark:text-blue-300",icon:Zb,badge:"bg-blue-500 text-white"}}[M.type],Q=ae.icon,le=M.detalhes&&M.detalhes.length>0&&M.message.includes("tratativa de anulao");return w.jsx("div",{className:`${ae.bg} rounded-xl border-2 ${ae.border} shadow-sm hover:shadow-md transition-all duration-200`,children:w.jsx("div",{className:"p-4",children:w.jsxs("div",{className:"flex items-start gap-3",children:[w.jsx("div",{className:`${ae.iconBg} rounded-lg p-2 shadow-lg flex-shrink-0`,children:w.jsx(Q,{className:"h-5 w-5 text-white"})}),w.jsxs("div",{className:"flex-1 min-w-0",children:[w.jsxs("div",{className:"flex items-start justify-between gap-2",children:[w.jsx("p",{className:`font-semibold text-sm leading-relaxed ${ae.textColor}`,children:M.message}),M.count&&w.jsx("span",{className:`${ae.badge} px-2.5 py-1 rounded-full text-xs font-bold flex-shrink-0 shadow-sm`,children:M.count})]}),M.value!==void 0&&w.jsx("div",{className:"mt-2 flex items-baseline gap-2",children:w.jsxs("span",{className:`text-2xl font-bold ${ae.textColor}`,children:["R$ ",M.value.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),le&&w.jsxs("div",{className:"mt-3",children:[w.jsx("button",{onClick:()=>se(!K),className:`flex items-center gap-1 text-xs font-semibold ${ae.textColor} hover:underline`,children:K?w.jsxs(w.Fragment,{children:[w.jsx(M2,{className:"h-3 w-3"}),"Ocultar detalhes"]}):w.jsxs(w.Fragment,{children:[w.jsx(zu,{className:"h-3 w-3"}),"Ver ",M.total," itens"]})}),K&&w.jsxs("div",{className:"mt-2 space-y-1 pl-4 border-l-2 border-current/20",children:[M.detalhes.slice(0,5).map((ne,ue)=>w.jsxs("div",{className:`text-xs ${ae.textColor} opacity-90 flex items-start gap-2`,children:[w.jsx("span",{className:"mt-1",children:""}),w.jsx("span",{children:ne})]},ue)),M.total>5&&w.jsxs("div",{className:`text-xs font-semibold ${ae.textColor} mt-2`,children:["... e mais ",M.total-5," itens"]})]})]})]})]})})})},L=({active:M,payload:K})=>{if(!M||!(K!=null&&K.length))return null;const se=K[0].payload,te=se.quantidade||se.count||se.value||0,ae=se.detalhes||[],Q=ae&&ae.length>0;return w.jsxs("div",{className:"bg-card border border-border rounded-md p-3 shadow-md",children:[w.jsx("p",{className:"text-sm font-bold text-foreground mb-1",children:"Detalhes"}),se.value&&typeof se.value=="number"&&se.value>1e3?w.jsxs("p",{className:"text-sm font-bold text-primary",children:["R$ ",se.value.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}):w.jsxs("p",{className:"text-sm font-bold text-primary",children:[te," ",se.count!==void 0?"nota(s)":se.value!==void 0?"ocorrncia(s)":"item(s)"]}),Q&&w.jsx("div",{className:"mt-2 space-y-1 max-h-[200px] overflow-y-auto",children:ae.map((fe,le)=>w.jsxs("p",{className:"text-xs text-muted-foreground",children:[w.jsx("span",{className:"font-medium text-foreground",children:fe.cliente}),w.jsx("span",{className:"mx-1",children:""}),w.jsxs("span",{className:"text-primary",children:["NF: ",fe.nota]})]},le))})]})};return e?w.jsx("div",{className:"flex items-center justify-center min-h-screen",children:w.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"})}):w.jsxs("div",{className:"space-y-6",children:[w.jsx(Qi,{title:"Dashboard Pendncias",description:"Viso geral das devolues pendentes (Pendente Validao, Tratativa de Anulao e Validadas) com KPIs, grficos e insights automticos para anlise estratgica."}),w.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[w.jsx(Xf,{}),w.jsxs(Ot,{variant:"outline",size:"sm",onClick:re,className:"w-full md:w-auto shrink-0",children:[w.jsx(gm,{className:"mr-2 h-4 w-4"}),"Atualizar"]})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[U.length>0&&w.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl border-2 border-gray-200 dark:border-gray-700 shadow-lg",children:[w.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-white dark:from-gray-800 dark:to-gray-900 p-6 border-b-2 border-gray-200 dark:border-gray-700",children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"bg-gradient-to-br from-orange-500 to-red-500 rounded-xl p-3 shadow-lg",children:w.jsx(Rl,{className:"h-6 w-6 text-white"})}),w.jsxs("div",{children:[w.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-gray-200",children:"Central de Alertas"}),w.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Monitoramento de devolues e pendncias"})]})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[U.filter(M=>M.type==="error").length>0&&w.jsxs("div",{className:"flex items-center gap-1.5 bg-red-100 dark:bg-red-900/30 px-3 py-1.5 rounded-full border border-red-300 dark:border-red-700",children:[w.jsx(Ao,{className:"h-4 w-4 text-red-600 dark:text-red-400"}),w.jsx("span",{className:"text-sm font-bold text-red-700 dark:text-red-300",children:U.filter(M=>M.type==="error").length})]}),U.filter(M=>M.type==="warning").length>0&&w.jsxs("div",{className:"flex items-center gap-1.5 bg-amber-100 dark:bg-amber-900/30 px-3 py-1.5 rounded-full border border-amber-300 dark:border-amber-700",children:[w.jsx(Rl,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}),w.jsx("span",{className:"text-sm font-bold text-amber-700 dark:text-amber-300",children:U.filter(M=>M.type==="warning").length})]}),U.filter(M=>M.type==="info").length>0&&w.jsxs("div",{className:"flex items-center gap-1.5 bg-blue-100 dark:bg-blue-900/30 px-3 py-1.5 rounded-full border border-blue-300 dark:border-blue-700",children:[w.jsx(Zb,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),w.jsx("span",{className:"text-sm font-bold text-blue-700 dark:text-blue-300",children:U.filter(M=>M.type==="info").length})]})]})]})}),w.jsx("div",{className:"p-6",children:w.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:U.map((M,K)=>w.jsx(ee,{alert:M},K))})}),w.jsx("style",{children:`
              .custom-scrollbar::-webkit-scrollbar {
                width: 8px;
              }
              .custom-scrollbar::-webkit-scrollbar-track {
                background: #f1f5f9;
                border-radius: 10px;
              }
              .custom-scrollbar::-webkit-scrollbar-thumb {
                background: #cbd5e1;
                border-radius: 10px;
              }
              .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                background: #94a3b8;
              }
            `})]}),w.jsxs(Nt,{className:"border-2",children:[w.jsxs(Dt,{className:"pb-3",children:[w.jsx(Mt,{className:"text-center text-sm font-semibold",children:"Status de Validao"}),w.jsx(Cr,{className:"text-center text-xs",children:"Valor total de notas pendentes e em tratativa de anulao"})]}),w.jsx(jt,{className:"pt-0",children:w.jsx(z,{value:s})})]})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[w.jsx(Bn,{title:"Valor Total Devolvido",value:`R$ ${n.totalValue.toLocaleString("pt-BR",{maximumFractionDigits:0})}`,icon:Op,trend:"up",trendValue:"vs perodo anterior"}),w.jsx(Bn,{title:"Total de Devolues",value:n.totalReturns,icon:I2,description:"Neste perodo"}),w.jsx(Bn,{title:"Produtos Devolvidos",value:n.totalProducts.toFixed(2),icon:Ul,description:"Quantidade total"}),w.jsx(Bn,{title:"Ticket Mdio",value:`R$ ${n.avgTicket.toLocaleString("pt-BR",{maximumFractionDigits:0})}`,icon:_u}),w.jsx(Bn,{title:"Fora do SLA",value:n.slaBreach,icon:Rl,description:"Devolues atrasadas",trend:"down",trendValue:"0"})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[w.jsxs(Nt,{className:"col-span-4",children:[w.jsx(Dt,{children:w.jsx(Mt,{children:"Evoluo no Tempo"})}),w.jsx(jt,{className:"pl-2",children:w.jsx(Jr,{width:"100%",height:350,children:w.jsxs(v2,{data:c,children:[w.jsx("defs",{children:w.jsxs("linearGradient",{id:"colorValue",x1:"0",y1:"0",x2:"0",y2:"1",children:[w.jsx("stop",{offset:"5%",stopColor:X[0],stopOpacity:.8}),w.jsx("stop",{offset:"95%",stopColor:X[0],stopOpacity:0})]})}),w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",height:60,tick:w.jsx(Js,{})}),w.jsx($r,{className:"text-[6px] font-size-6px font-bold",tickFormatter:M=>`R$${M}`}),w.jsx(Qr,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)",color:"var(--foreground)",fontSize:"11px",fontWeight:"bold"},formatter:(M,K)=>K==="value"?[`R$ ${(M||0).toFixed(2)}`,"Valor Total"]:K==="count"?[`${M||0}`,"Qtd de Notas"]:[M,K||""],labelFormatter:M=>`Data: ${M}`}),w.jsx(b2,{type:"monotone",dataKey:"value",stroke:X[0],fillOpacity:1,fill:"url(#colorValue)"}),w.jsx(Xl,{type:"monotone",dataKey:"count",stroke:X[1],strokeWidth:2,dot:{fill:X[1],r:4}})]})})})]}),w.jsxs(Nt,{className:"col-span-4",children:[w.jsx(Dt,{children:w.jsx(Mt,{children:"Top Clientes (Valor)"})}),w.jsx(jt,{children:w.jsx(Jr,{width:"100%",height:350,children:w.jsxs(Ya,{data:u,children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",height:60,tick:w.jsx(Js,{})}),w.jsx($r,{className:"text-[6px] font-bold",tickFormatter:M=>`R$${M}`}),w.jsx(Qr,{content:w.jsx(L,{})}),w.jsx(Na,{dataKey:"value",fill:X[0],radius:[8,8,0,0],children:w.jsx(Fa,{dataKey:"value",position:"top",content:({value:M})=>w.jsx("text",{x:0,y:0,dy:-5,fill:G?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(M||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[w.jsxs(Nt,{children:[w.jsx(Dt,{children:w.jsx(Mt,{children:"Top Vendedores (Valor)"})}),w.jsx(jt,{children:w.jsx(Jr,{width:"100%",height:300,children:w.jsxs(Ya,{data:f,children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",height:60,tick:w.jsx(Js,{})}),w.jsx($r,{className:"text-[10px] font-bold",tickFormatter:M=>`R$${M}`}),w.jsx(Qr,{content:w.jsx(L,{})}),w.jsx(Na,{dataKey:"value",fill:X[1],radius:[8,8,0,0],children:w.jsx(Fa,{dataKey:"value",position:"top",content:({value:M})=>w.jsx("text",{x:0,y:0,dy:-5,fill:G?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(M||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{children:w.jsx(Mt,{children:"Top Redes (Valor)"})}),w.jsx(jt,{children:w.jsx(Jr,{width:"100%",height:300,children:w.jsxs(Ya,{data:v,children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",height:60,tick:w.jsx(Js,{})}),w.jsx($r,{className:"text-[10px] font-bold",tickFormatter:M=>`R$${M}`}),w.jsx(Qr,{content:w.jsx(L,{})}),w.jsx(Na,{dataKey:"value",fill:X[2],radius:[8,8,0,0],children:w.jsx(Fa,{dataKey:"value",position:"top",content:({value:M})=>w.jsx("text",{x:0,y:0,dy:-5,fill:G?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(M||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Top 5 Clientes com Reincidncia"}),w.jsx(Cr,{children:"Clientes com mais notas em TRATATIVA DE ANULAO e ANULADA/CANCELADA"})]}),w.jsx(jt,{children:w.jsx(Jr,{width:"100%",height:300,children:w.jsxs(Ya,{data:D,children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",height:60,tick:w.jsx(Js,{})}),w.jsx($r,{className:"text-[10px] font-bold"}),w.jsx(Qr,{content:w.jsx(L,{})}),w.jsx(Na,{dataKey:"count",fill:X[3],radius:[8,8,0,0],children:w.jsx(Fa,{dataKey:"count",position:"top",content:({value:M})=>w.jsx("text",{x:0,y:0,dy:-5,fill:G?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`${M||0}`})})})]})})})]}),w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Motivos Mais Recorrentes por Rede"}),w.jsx(Cr,{children:"Principais motivos de devoluo por rede (Top 5 redes)"})]}),w.jsx(jt,{children:w.jsx(Jr,{width:"100%",height:300,children:w.jsxs(Ya,{data:F,layout:"vertical",children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{type:"number",className:"text-[10px] font-bold"}),w.jsx($r,{type:"category",dataKey:"rede",width:100,tick:w.jsx(Js,{})}),w.jsx(Qr,{content:w.jsx(L,{})}),w.jsx(Na,{dataKey:"count",fill:X[4],radius:[0,8,8,0],children:w.jsx(Fa,{dataKey:"count",position:"right",content:({value:M})=>w.jsx("text",{x:0,y:0,dx:5,fill:G?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"start",children:`${M||0}`})})})]})})})]})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[w.jsxs(Nt,{children:[w.jsx(Dt,{children:w.jsx(Mt,{children:"Anlise de Pareto (80/20)"})}),w.jsxs(jt,{children:[w.jsx(Jr,{width:"100%",height:350,children:w.jsxs(x2,{data:y,children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",height:60,tick:w.jsx(Js,{})}),w.jsx($r,{yAxisId:"left",className:"text-[10px] font-bold",tickFormatter:M=>`R$${M}`}),w.jsx($r,{yAxisId:"right",orientation:"right",className:"text-[10px] font-bold",tickFormatter:M=>`${M}%`}),w.jsx(Qr,{content:w.jsx(L,{})}),w.jsx(Na,{yAxisId:"left",dataKey:"value",fill:X[0],radius:[8,8,0,0],children:w.jsx(Fa,{dataKey:"value",position:"top",content:({value:M})=>w.jsx("text",{x:0,y:0,dy:-5,fill:G?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(M||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})}),w.jsx(Xl,{yAxisId:"right",type:"monotone",dataKey:"percentage",stroke:X[3],strokeWidth:2})]})}),w.jsx("div",{className:"mt-4 text-xs text-muted-foreground",children:"Linha mostra o percentual acumulado. A regra 80/20 indica que poucos clientes concentram a maioria do valor."})]})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{children:w.jsx(Mt,{children:"Insights Automticos"})}),w.jsx(jt,{children:w.jsx("div",{className:"space-y-3",children:P.length>0?P.map((M,K)=>w.jsx("div",{className:"p-3 bg-muted/50 rounded-lg text-sm",children:M},K)):w.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum insight disponvel no momento."})})})]})]}),N.length>0&&w.jsxs(Nt,{children:[w.jsx(Dt,{children:w.jsx(Mt,{children:"Heatmap: Produto  Rede"})}),w.jsx(jt,{children:w.jsx("div",{className:"overflow-x-auto",children:w.jsxs("table",{className:"w-full text-xs border-collapse",children:[w.jsx("thead",{children:w.jsxs("tr",{children:[w.jsx("th",{className:"border p-2 text-left bg-muted text-xs",children:"Produto"}),N[0]&&Object.keys(N[0]).filter(M=>M!=="produto").map(M=>w.jsx("th",{className:"border p-2 bg-muted text-xs",children:M.length>15?M.substring(0,15)+"...":M},M))]})}),w.jsx("tbody",{children:N.map((M,K)=>w.jsxs("tr",{children:[w.jsx("td",{className:"border p-2 font-medium text-xs",children:M.produto.length>20?M.produto.substring(0,20)+"...":M.produto}),Object.keys(M).filter(se=>se!=="produto").map(se=>{const te=M[se]||{quantidade:0,unidade:"UN"},ae=typeof te=="object"?te.quantidade:te,Q=typeof te=="object"?te.unidade:"UN",fe=Math.max(...N.map(ne=>Math.max(...Object.keys(ne).filter(ue=>ue!=="produto").map(ue=>{const he=ne[ue];return typeof he=="object"?he.quantidade:he||0})))),le=fe>0?ae/fe*100:0;return w.jsx("td",{className:"border p-2 text-center text-xs",style:{backgroundColor:le>0?G?`rgba(210, 248, 247, ${le/100})`:`rgba(23, 67, 42, ${le/100})`:"transparent",color:le>50?G?"#000":"#fff":"inherit"},title:`${ae.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})} ${Q}`,children:ae>0?`${ae.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})} ${Q}`:"-"},se)})]},K))})]})})})]}),(W.length>0||R.length>0)&&w.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[w.jsxs(Nt,{children:[w.jsx(Dt,{children:w.jsxs(Mt,{className:"flex items-center gap-2",children:[w.jsx(Ao,{className:"h-5 w-5 text-orange-500"}),"Notas em Cancelamento"]})}),w.jsx(jt,{children:W.length>0?w.jsx(Jr,{width:"100%",height:300,children:w.jsxs(Ya,{data:W,children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",height:60,tick:w.jsx(Js,{})}),w.jsx($r,{className:"text-[10px] font-bold"}),w.jsx(Qr,{content:w.jsx(L,{})}),w.jsx(Na,{dataKey:"quantidade",fill:X[0],radius:[8,8,0,0],children:w.jsx(Fa,{dataKey:"quantidade",position:"inside",fill:"#f1f1e5",fontSize:13,fontWeight:"bold"})})]})}):w.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-muted-foreground text-center p-4",children:[w.jsx(Ao,{className:"h-10 w-10 mb-2 opacity-20"}),w.jsx("p",{className:"text-sm",children:"Nenhuma nota em cancelamento encontrada."})]})})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{children:w.jsxs(Mt,{className:"flex items-center gap-2",children:[w.jsx(Ao,{className:"h-5 w-5 text-red-500"}),"Notas Canceladas"]})}),w.jsx(jt,{children:R.length>0?w.jsx(Jr,{width:"100%",height:300,children:w.jsxs(Ya,{data:R,children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",height:60,tick:w.jsx(Js,{})}),w.jsx($r,{className:"text-[10px] font-bold"}),w.jsx(Qr,{content:w.jsx(L,{})}),w.jsx(Na,{dataKey:"quantidade",fill:X[1],radius:[8,8,0,0]})]})}):w.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-muted-foreground text-center p-4",children:[w.jsx(Ao,{className:"h-10 w-10 mb-2 opacity-20"}),w.jsx("p",{className:"text-sm",children:"Nenhuma nota cancelada encontrada."})]})})]})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[w.jsxs(Nt,{className:"col-span-1",children:[w.jsx(Dt,{children:w.jsx(Mt,{className:"text-base",children:"Principais Motivos"})}),w.jsx(jt,{children:g.length>0?w.jsx("div",{className:"h-[250px]",children:w.jsx(Jr,{width:"100%",height:"100%",children:w.jsxs(s8,{children:[w.jsx(i8,{data:g,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:g.map((M,K)=>w.jsx(o8,{fill:X[K%X.length]},`cell-${K}`))}),w.jsx(Qr,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)"}}),w.jsx(y2,{verticalAlign:"bottom",height:60,iconType:"circle",wrapperStyle:{fontSize:"9px",paddingTop:"8px"},formatter:M=>{const se=M.length>20?M.substring(0,20)+"...":M;return w.jsx("span",{style:{fontSize:"9px"},children:se})}})]})})}):w.jsxs("div",{className:"flex flex-col items-center justify-center h-[250px] text-muted-foreground text-center p-4",children:[w.jsx(Rl,{className:"h-10 w-10 mb-2 opacity-20"}),w.jsx("p",{className:"text-sm",children:"Nenhum motivo encontrado para o perodo selecionado."})]})})]}),w.jsxs(Nt,{className:"col-span-1",children:[w.jsx(Dt,{children:w.jsx(Mt,{className:"text-base",children:"Distribuio por Municpio"})}),w.jsx(jt,{children:w.jsx("div",{className:"space-y-4",children:A.length>0?A.map((M,K)=>w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(Mp,{className:"h-4 w-4 text-muted-foreground"}),w.jsx("span",{className:"text-sm font-medium truncate max-w-[120px]",title:M.name,children:M.name})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"h-2 bg-muted rounded-full w-24 overflow-hidden",children:w.jsx("div",{className:"h-full bg-primary",style:{width:`${M.value/(n.totalValue||1)*100}%`}})}),w.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:[(M.value/(n.totalValue||1)*100).toFixed(0),"%"]})]})]},K)):w.jsx("div",{className:"text-center text-sm text-muted-foreground py-8",children:"Nenhum dado disponvel"})})})]}),w.jsxs(Nt,{className:"col-span-1",children:[w.jsx(Dt,{children:w.jsx(Mt,{className:"text-base",children:"Produtos Crticos"})}),w.jsx(jt,{children:_.length>0?w.jsxs("div",{className:"space-y-4 max-h-[400px] overflow-y-auto",children:[w.jsxs("div",{children:[w.jsx("h4",{className:"text-xs font-bold text-muted-foreground mb-2",children:"Top 5 em CX"}),w.jsx("div",{className:"space-y-2",children:_.filter(M=>M.tipo==="CX").length>0?_.filter(M=>M.tipo==="CX").map((M,K)=>w.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-muted/50",children:[w.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[w.jsxs("span",{className:"text-xs font-bold text-muted-foreground w-6",children:[K+1,""]}),w.jsx("span",{className:"text-sm font-medium truncate",title:M.nameFull||M.name,children:M.name})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("span",{className:"text-sm font-bold",children:M.quantidade.toFixed(2)}),w.jsx("span",{className:"text-xs text-muted-foreground",children:M.unidade||"CX"})]})]},`cx-${K}`)):w.jsx("div",{className:"text-xs text-muted-foreground p-2",children:"Nenhum produto em CX encontrado"})})]}),w.jsxs("div",{children:[w.jsx("h4",{className:"text-xs font-bold text-muted-foreground mb-2",children:"Top 5 em UN"}),w.jsx("div",{className:"space-y-2",children:_.filter(M=>M.tipo==="UN").length>0?_.filter(M=>M.tipo==="UN").map((M,K)=>w.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-muted/50",children:[w.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[w.jsxs("span",{className:"text-xs font-bold text-muted-foreground w-6",children:[K+1,""]}),w.jsx("span",{className:"text-sm font-medium truncate",title:M.nameFull||M.name,children:M.name})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("span",{className:"text-sm font-bold",children:M.quantidade.toFixed(2)}),w.jsx("span",{className:"text-xs text-muted-foreground",children:M.unidade||"UN"})]})]},`un-${K}`)):w.jsx("div",{className:"text-xs text-muted-foreground p-2",children:"Nenhum produto em UN encontrado"})})]})]}):w.jsxs("div",{className:"flex flex-col items-center justify-center h-[250px] text-muted-foreground text-center p-4",children:[w.jsx(Ul,{className:"h-10 w-10 mb-2 opacity-20"}),w.jsx("p",{className:"text-sm",children:"Nenhum produto encontrado para o perodo selecionado."})]})})]})]})]})}var UN=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],zN=UN.reduce((t,r)=>{const e=mm(`Primitive.${r}`),a=Se.forwardRef((n,o)=>{const{asChild:s,...l}=n,c=s?e:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),w.jsx(c,{...l,ref:o})});return a.displayName=`Primitive.${r}`,{...t,[r]:a}},{}),$N="Label",Qw=Se.forwardRef((t,r)=>w.jsx(zN.label,{...t,ref:r,onMouseDown:e=>{var n;e.target.closest("button, input, select, textarea")||((n=t.onMouseDown)==null||n.call(t,e),!e.defaultPrevented&&e.detail>1&&e.preventDefault())}}));Qw.displayName=$N;var e_=Qw;const VN=$f("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),kr=Se.forwardRef(({className:t,...r},e)=>w.jsx(e_,{ref:e,className:Et(VN(),t),...r}));kr.displayName=e_.displayName;const Ba=Se.forwardRef(({className:t,...r},e)=>w.jsx("div",{className:"relative w-full overflow-auto",children:w.jsx("table",{ref:e,className:Et("w-full caption-bottom text-sm",t),...r})}));Ba.displayName="Table";const Za=Se.forwardRef(({className:t,...r},e)=>w.jsx("thead",{ref:e,className:Et("[&_tr]:border-b",t),...r}));Za.displayName="TableHeader";const Ua=Se.forwardRef(({className:t,...r},e)=>w.jsx("tbody",{ref:e,className:Et("[&_tr:last-child]:border-0",t),...r}));Ua.displayName="TableBody";const HN=Se.forwardRef(({className:t,...r},e)=>w.jsx("tfoot",{ref:e,className:Et("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...r}));HN.displayName="TableFooter";const dr=Se.forwardRef(({className:t,...r},e)=>w.jsx("tr",{ref:e,className:Et("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...r}));dr.displayName="TableRow";const Tt=Se.forwardRef(({className:t,...r},e)=>w.jsx("th",{ref:e,className:Et("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r}));Tt.displayName="TableHead";const Pt=Se.forwardRef(({className:t,...r},e)=>w.jsx("td",{ref:e,className:Et("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r}));Pt.displayName="TableCell";const qN=Se.forwardRef(({className:t,...r},e)=>w.jsx("caption",{ref:e,className:Et("mt-4 text-sm text-muted-foreground",t),...r}));qN.displayName="TableCaption";const WN=["#17432a","#17432a","#17432a","#17432a","#17432a","#17432a"],GN=["#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7"],ys=({x:t,y:r,payload:e})=>{const n=e.value.split(" ");let o=[],s="";return n.forEach(l=>{(s+l).length<=10?s+=`${l} `:(s.trim()&&o.push(s.trim()),s=`${l} `)}),s.trim()&&o.push(s.trim()),w.jsx("g",{transform:`translate(${t},${r})`,children:w.jsx("text",{x:0,y:0,dy:16,textAnchor:"middle",fill:"currentColor",fontSize:10,fontWeight:"bold",children:o.map((l,c)=>w.jsx("tspan",{x:"0",dy:c===0?0:14,children:l},c))})})};function YN(){const{filters:t}=ec(),{user:r}=Oa(),[e,a]=Se.useState(!0),[n,o]=Se.useState({totalValue:0,totalReturns:0,avgTicket:0,totalProducts:0,valorTotalLancado:0,notasLancadas:0,valorTotalCancelado:0,notasCanceladas:0}),[s,l]=Se.useState([]),[c,i]=Se.useState([]),[u,p]=Se.useState([]),[f,h]=Se.useState([]),[v,b]=Se.useState([]),[g,x]=Se.useState([]),[y,E]=Se.useState(!1),[N,I]=Se.useState([]),[P,V]=Se.useState([]),[U,H]=Se.useState([]),[G,Z]=Se.useState([]),[W,O]=Se.useState([]),[R,C]=Se.useState([]),[_,k]=Se.useState("KG"),[A,T]=Se.useState(""),[D,B]=Se.useState([]),[F,Y]=Se.useState([]),[X,re]=Se.useState([]),[z,ee]=Se.useState([]);Se.useEffect(()=>{const ae=()=>{E(document.documentElement.classList.contains("dark"))};ae();const Q=new MutationObserver(ae);return Q.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>Q.disconnect()},[]);const L=y?GN:WN;Se.useEffect(()=>{M()},[t,r,_]);const M=async()=>{try{a(!0);const ae=(r==null?void 0:r.role)==="VENDEDOR"?r.vendedor:null;let Q=St.from("devolucoes").select(`
          *,
          motivos_devolucao(nome, setores:setores(nome)),
          setores(nome),
          itens:itens_devolucao(quantidade, descricao, motivo_id, valor_total_bruto, unidade)
      `);r&&r.role==="VENDEDOR"&&ae&&(Q=Q.eq("vendedor",ae),console.log(" Dashboard Lanadas - Filtrando por vendedor:",ae));const fe=t.period&&!t.startDate&&!t.endDate?ju(t.period):{},le=t.startDate||fe.startDate,ne=t.endDate||fe.endDate;Q=Q.in("resultado",["LANADA","ANULADA/CANCELADA"]),t.search&&(Q=Q.or(`nome_cliente.ilike.%${t.search}%,vendedor.ilike.%${t.search}%,numero.ilike.%${t.search}%`)),t.motivo&&t.motivo.length>0&&(Q=Q.in("motivo_id",t.motivo)),t.cliente&&t.cliente.length>0&&(Q=Q.in("nome_cliente",t.cliente)),t.vendedor&&t.vendedor.length>0&&(Q=Q.in("vendedor",t.vendedor)),t.setor&&t.setor.length>0&&(Q=Q.in("setor_id",t.setor)),le&&(Q=Q.gte("data_emissao",le.toISOString().split("T")[0])),ne&&(Q=Q.lte("data_emissao",ne.toISOString().split("T")[0]));const{data:ue,error:he}=await Q;if(he){console.error(" Erro ao buscar dados do Dashboard Lanadas:",he),wt.error("Erro ao carregar dados do Dashboard Lanadas: "+he.message),a(!1);return}if(!ue||ue.length===0){console.log(" Nenhuma devoluo encontrada para os filtros selecionados"),o({totalValue:0,totalReturns:0,avgTicket:0,totalProducts:0,valorTotalLancado:0,notasLancadas:0,valorTotalCancelado:0,notasCanceladas:0}),l([]),i([]),p([]),h([]),b([]),x([]),I([]),Z([]),O([]),C([]),B([]),Y([]),re([]),ee([]),a(!1);return}if(ue){console.log(` Dashboard Lanadas: ${ue.length} devolues carregadas`);const ke=ue.reduce((me,ye)=>me+(Number(ye.valor_total_nota)||0),0),pe=ue.length,Ce=pe>0?ke/pe:0,Me=ue.reduce((me,ye)=>{const Ve=ye.itens||[];return me+Ve.reduce(($e,ot)=>$e+(Number(ot.quantidade)||0),0)},0),Ie=ue.filter(me=>me.resultado==="LANADA"),Ye=ue.filter(me=>me.resultado==="ANULADA/CANCELADA"),at=Ie.reduce((me,ye)=>me+(Number(ye.valor_total_nota)||0),0),rt=Ye.reduce((me,ye)=>me+(Number(ye.valor_total_nota)||0),0);o({totalValue:ke,totalReturns:pe,avgTicket:Ce,totalProducts:Me,valorTotalLancado:at,notasLancadas:Ie.length,valorTotalCancelado:rt,notasCanceladas:Ye.length});const it=ue.reduce((me,ye)=>{const Ve=new Date(ye.data_emissao||ye.created_at),$e=Xt(Ve,"dd/MM",{locale:yr});return me[$e]||(me[$e]={value:0,count:0}),me[$e].value+=Number(ye.valor_total_nota)||0,me[$e].count+=1,me},{}),et=Object.keys(it).sort((me,ye)=>{const Ve=new Date(me.split("/").reverse().join("-")),$e=new Date(ye.split("/").reverse().join("-"));return Ve.getTime()-$e.getTime()}).map(me=>({name:me,value:it[me].value,count:it[me].count}));l(et);const st={};ue.forEach(me=>{const ye=me.nome_cliente||"Desconhecido",Ve=Number(me.valor_total_nota)||0;st[ye]||(st[ye]={valor:0,detalhes:[]}),st[ye].valor+=Ve,st[ye].detalhes.push({cliente:ye,nota:me.numero||"-"})});const je=Object.entries(st).map(([me,ye])=>({name:me,value:ye.valor,quantidade:ye.detalhes.length,detalhes:ye.detalhes})).sort((me,ye)=>ye.value-me.value).slice(0,10);i(je);const ht={};ue.forEach(me=>{const ye=me.vendedor||"Desconhecido",Ve=Number(me.valor_total_nota)||0;ht[ye]||(ht[ye]={valor:0,detalhes:[]}),ht[ye].valor+=Ve,ht[ye].detalhes.push({cliente:me.nome_cliente||"Desconhecido",nota:me.numero||"-"})});const Je=Object.entries(ht).map(([me,ye])=>({name:me,value:ye.valor,quantidade:ye.detalhes.length,detalhes:ye.detalhes})).sort((me,ye)=>ye.value-me.value).slice(0,5);p(Je);const nt={};ue.forEach(me=>{let ye=me.rede||"Sem rede";ye==="Sem rede"&&me.cnpj_destinatario&&(ye=me.rede||"Sem rede");const Ve=Number(me.valor_total_nota)||0;nt[ye]||(nt[ye]={valor:0,detalhes:[]}),nt[ye].valor+=Ve,nt[ye].detalhes.push({cliente:me.nome_cliente||"Desconhecido",nota:me.numero||"-"})});const ct=Object.entries(nt).map(([me,ye])=>({name:me,value:ye.valor,quantidade:ye.detalhes.length,detalhes:ye.detalhes})).sort((me,ye)=>ye.value-me.value).slice(0,5);h(ct);const _t=Object.entries(st).map(([me,ye])=>({name:me,value:ye.valor,detalhes:ye.detalhes})).sort((me,ye)=>ye.value-me.value);let mt=0;const gt=_t.reduce((me,ye)=>me+ye.value,0),He=_t.map((me,ye)=>(mt+=me.value,{name:me.name.length>15?me.name.substring(0,15)+"...":me.name,value:me.value,cumulative:mt,percentage:mt/gt*100,index:ye+1,quantidade:me.detalhes.length,detalhes:me.detalhes})).slice(0,10);b(He);const Ue=ue.reduce((me,ye)=>{const Ve=ye.cidade_origem||"N/A";return me[Ve]=(me[Ve]||0)+(Number(ye.valor_total_nota)||0),me},{}),bt=Object.entries(Ue).map(([me,ye])=>({name:me,value:ye})).sort((me,ye)=>ye.value-me.value).slice(0,6);console.log(" Municpio Chart:",bt),I(bt);const tt={};ue.filter(me=>me.resultado==="ANULADA/CANCELADA").forEach(me=>{const ye=me.nome_cliente||"Desconhecido";tt[ye]||(tt[ye]={count:0,detalhes:[]}),tt[ye].count+=1,tt[ye].detalhes.push({cliente:ye,nota:me.numero||"-"})});const dt=Object.entries(tt).map(([me,ye])=>({name:me,count:ye.count,quantidade:ye.detalhes.length,detalhes:ye.detalhes})).sort((me,ye)=>ye.count-me.count).slice(0,5);V(dt);const ut={};ue.forEach(me=>{var $e;const ye=me.rede||"Sem rede",Ve=($e=me.motivos_devolucao)==null?void 0:$e.nome;!Ve||Ve==="No informado"||Ve==="no informado"||Ve==="NO INFORMADO"||(ut[ye]||(ut[ye]={}),ut[ye][Ve]||(ut[ye][Ve]={count:0,detalhes:[]}),ut[ye][Ve].count+=1,ut[ye][Ve].detalhes.push({cliente:me.nome_cliente||"Desconhecido",nota:me.numero||"-"}))});const vt=[];Object.entries(ut).sort((me,ye)=>{const Ve=Object.values(me[1]).reduce((ot,Rt)=>ot+Rt.count,0);return Object.values(ye[1]).reduce((ot,Rt)=>ot+Rt.count,0)-Ve}).slice(0,5).forEach(([me,ye])=>{const Ve=Object.entries(ye).sort(($e,ot)=>ot[1].count-$e[1].count)[0];Ve&&vt.push({rede:me.length>15?me.substring(0,15)+"...":me,motivo:Ve[0].length>20?Ve[0].substring(0,20)+"...":Ve[0],count:Ve[1].count,quantidade:Ve[1].detalhes.length,detalhes:Ve[1].detalhes})}),H(vt);const xt=[];if(pe>0&&xt.push(` Total de ${pe} devoluo(es) no perodo selecionado, totalizando R$ ${ke.toLocaleString("pt-BR",{minimumFractionDigits:2})}.`),je.length>0&&ke>0){const me=je[0].value/ke*100;me>20&&xt.push(` Cliente "${je[0].name}" concentra ${me.toFixed(1)}% do valor total de devolues.`)}if(Me>0&&pe>0){const me=Me/pe;xt.push(` Mdia de ${me.toFixed(1)} produtos por devoluo.`)}if(Je.length>0&&xt.push(` Vendedor "${Je[0].name}" lidera em devolues com R$ ${Je[0].value.toLocaleString("pt-BR")}.`),He.length>0){const me=He.findIndex(ye=>ye.percentage>=80);me>=0&&me<5&&xt.push(` Regra 80/20: ${me+1} clientes concentram 80% do valor de devolues.`)}const At=ue.filter(me=>me.resultado==="ANULADA/CANCELADA").length,Kt=pe>0?At/pe*100:0;if(Kt>10?xt.push(` Taxa de cancelamento alta: ${Kt.toFixed(1)}% das devolues esto em cancelamento.`):At>0&&xt.push(` ${At} devoluo(es) em processo de cancelamento.`),Ce>0){const me=ue.filter(ye=>Number(ye.valor_total_nota)>Ce*1.5).length;me>0&&xt.push(` ${me} devoluo(es) com valor acima de 150% do ticket mdio.`)}if(ct.length>0&&ke>0){const me=ct[0].value/ke*100;me>15&&xt.push(` Rede "${ct[0].name}" representa ${me.toFixed(1)}% do valor devolvido.`)}if(et.length>=2){const me=et[et.length-1].value,ye=et[et.length-2].value;if(ye>0){const Ve=(me-ye)/ye*100;if(Math.abs(Ve)>20){const $e=Ve>0?"aumento":"reduo";xt.push(` ${$e.charAt(0).toUpperCase()+$e.slice(1)} de ${Math.abs(Ve).toFixed(1)}% no valor devolvido comparado ao perodo anterior.`)}}}console.log(" Insights:",xt),x(xt);const yt=[],Ct=ue.filter(me=>me.prazo==="EM ATRASO");if(Ct.length>0){const me=Ct.reduce((ye,Ve)=>ye+(Number(Ve.valor_total_nota)||0),0);yt.push({type:"warning",message:`${Ct.length} nota(s) em atraso`,count:Ct.length,total:Ct.length,value:me})}if(pe>50&&yt.push({type:"info",message:`Total de ${pe} notas no perodo (acima de 50)`,count:pe,total:pe}),Ie.length>20){const me=Ie.reduce((ye,Ve)=>ye+(Number(Ve.valor_total_nota)||0),0);yt.push({type:"info",message:`${Ie.length} nota(s) lanadas (acima de 20)`,count:Ie.length,total:Ie.length,value:me})}const Ft=ue.filter(me=>Number(me.valor_total_nota)>1e3);if(Ft.length>0){const me=Ft.reduce((ye,Ve)=>ye+(Number(Ve.valor_total_nota)||0),0);yt.push({type:"warning",message:`${Ft.length} nota(s) com valor acima de R$ 1.000,00`,count:Ft.length,total:Ft.length,value:me})}const kt={};Ie.forEach(me=>{const ye=me.nome_cliente||"Desconhecido";kt[ye]||(kt[ye]=[]),kt[ye].push(me)}),Object.entries(kt).forEach(([me,ye])=>{if(ye.length>5){const Ve=ye.reduce(($e,ot)=>$e+(Number(ot.valor_total_nota)||0),0);yt.push({type:"info",message:`Cliente "${me}" tem ${ye.length} notas lanadas`,cliente:me,count:ye.length,total:ye.length,value:Ve})}});const Ae=ue.filter(me=>me.resultado==="ANULADA/CANCELADA");if(Ae.length>0){const me=Ae.reduce((ye,Ve)=>ye+(Number(Ve.valor_total_nota)||0),0);yt.push({type:"warning",message:`${Ae.length} nota(s) anuladas/canceladas`,detalhes:Ae.map(ye=>`NF ${ye.numero} - ${ye.nome_cliente||"Sem cliente"} - R$ ${(Number(ye.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`),count:Ae.length,total:Ae.length,value:me})}const Fe={};ue.filter(me=>me.resultado==="LANADA").forEach(me=>{var $e;const ye=(($e=me.motivos_devolucao)==null?void 0:$e.nome)||"Sem motivo",Ve=Number(me.valor_total_nota)||0;Fe[ye]||(Fe[ye]={valorTotal:0,quantidade:0}),Fe[ye].valorTotal+=Ve,Fe[ye].quantidade+=1});const Qe=Object.entries(Fe).map(([me,ye])=>({name:me,valorTotal:ye.valorTotal,quantidade:ye.quantidade})).sort((me,ye)=>ye.valorTotal-me.valorTotal);Z(Qe);const ie={};ue.filter(me=>me.resultado==="LANADA").forEach(me=>{var $e,ot,Rt;const ye=((ot=($e=me.motivos_devolucao)==null?void 0:$e.setores)==null?void 0:ot.nome)||((Rt=me.setores)==null?void 0:Rt.nome)||"Sem setor",Ve=Number(me.valor_total_nota)||0;ie[ye]||(ie[ye]={valorTotal:0,quantidade:0}),ie[ye].valorTotal+=Ve,ie[ye].quantidade+=1});const _e=Object.entries(ie).map(([me,ye])=>({name:me,valorTotal:ye.valorTotal,quantidade:ye.quantidade})).sort((me,ye)=>ye.valorTotal-me.valorTotal);O(_e);const de={};ue.forEach(me=>{(me.itens||[]).forEach(Ve=>{const $e=Ve.descricao||"Desconhecido",ot=Number(Ve.quantidade)||0,Rt=(Ve.unidade||"").toUpperCase().trim();de[$e]||(de[$e]={quantidadeKG:0,quantidadeCX:0,descricao:$e}),["KG","KG1","KGS"].includes(Rt)?de[$e].quantidadeKG+=ot:["CX","CX1","CXI","CX10","CXS","FD"].includes(Rt)&&(de[$e].quantidadeCX+=ot)})});const ve=Object.entries(de).map(([me,ye])=>({name:me.length>30?me.substring(0,30)+"...":me,nameFull:me,quantidadeKG:ye.quantidadeKG,quantidadeCX:ye.quantidadeCX,quantidade:_==="KG"?ye.quantidadeKG:ye.quantidadeCX})).filter(me=>me.quantidade>0).sort((me,ye)=>ye.quantidade-me.quantidade).slice(0,20);C(ve);const be=ue.filter(me=>me.resultado==="LANADA"),we=Object.entries(Fe).sort((me,ye)=>ye[1].valorTotal-me[1].valorTotal).slice(0,10).map(([me])=>me),De={};be.forEach(me=>{var $e;const ye=(($e=me.motivos_devolucao)==null?void 0:$e.nome)||"Sem motivo";if(!we.includes(ye))return;(me.itens||[]).forEach(ot=>{const Rt=ot.descricao||"Desconhecido";De[Rt]||(De[Rt]={}),De[Rt][ye]||(De[Rt][ye]={quantidade:0,valorTotal:0}),De[Rt][ye].quantidade+=Number(ot.quantidade)||0,De[Rt][ye].valorTotal+=Number(ot.valor_total_bruto)||0})});const Le=Object.entries(de).map(([me,ye])=>({name:me,quantidadeTotal:_==="KG"?ye.quantidadeKG:ye.quantidadeCX})).sort((me,ye)=>ye.quantidadeTotal-me.quantidadeTotal).slice(0,5).map(me=>me.name),Oe=[];Le.forEach(me=>{if(De[me]){const ye=Object.entries(De[me]).map(([Ve,$e])=>({produto:me,motivo:Ve,quantidade:$e.quantidade,valorTotal:$e.valorTotal})).sort((Ve,$e)=>$e.quantidade-Ve.quantidade).slice(0,5);Oe.push(...ye)}}),B(Oe);const Pe={};be.forEach(me=>{var $e;const ye=me.vendedor||"Desconhecido",Ve=(($e=me.motivos_devolucao)==null?void 0:$e.nome)||"Sem motivo";Pe[ye]||(Pe[ye]={}),Pe[ye][Ve]||(Pe[ye][Ve]={quantidade:0,valorTotal:0}),Pe[ye][Ve].quantidade+=1,Pe[ye][Ve].valorTotal+=Number(me.valor_total_nota)||0});const Be=[];Object.entries(Pe).forEach(([me,ye])=>{const Ve=Object.entries(ye).map(([$e,ot])=>({vendedor:me,motivo:$e,quantidade:ot.quantidade,valorTotal:ot.valorTotal})).sort(($e,ot)=>ot.quantidade-$e.quantidade).slice(0,5);Be.push(...Ve)}),Y(Be);const xe={};be.forEach(me=>{var $e,ot,Rt,Bt;const ye=((ot=($e=me.motivos_devolucao)==null?void 0:$e.setores)==null?void 0:ot.nome)||((Rt=me.setores)==null?void 0:Rt.nome)||"Sem setor",Ve=((Bt=me.motivos_devolucao)==null?void 0:Bt.nome)||"Sem motivo";xe[ye]||(xe[ye]={}),xe[ye][Ve]||(xe[ye][Ve]={quantidade:0,valorTotal:0}),xe[ye][Ve].quantidade+=1,xe[ye][Ve].valorTotal+=Number(me.valor_total_nota)||0});const Ee=[];Object.entries(xe).forEach(([me,ye])=>{const Ve=Object.entries(ye).map(([$e,ot])=>({setor:me,motivo:$e,quantidade:ot.quantidade,valorTotal:ot.valorTotal})).sort(($e,ot)=>ot.quantidade-$e.quantidade).slice(0,5);Ee.push(...Ve)}),re(Ee);const qe=Object.entries(st).sort((me,ye)=>ye[1].valor-me[1].valor).slice(0,10).map(([me])=>me),ce={};be.forEach(me=>{var $e;const ye=me.nome_cliente||"Desconhecido";if(!qe.includes(ye))return;const Ve=(($e=me.motivos_devolucao)==null?void 0:$e.nome)||"Sem motivo";ce[ye]||(ce[ye]={}),ce[ye][Ve]||(ce[ye][Ve]={quantidade:0,valorTotal:0}),ce[ye][Ve].quantidade+=1,ce[ye][Ve].valorTotal+=Number(me.valor_total_nota)||0});const Te=[];Object.entries(ce).forEach(([me,ye])=>{const Ve=Object.entries(ye).map(([$e,ot])=>({cliente:me,motivo:$e,quantidade:ot.quantidade,valorTotal:ot.valorTotal})).sort(($e,ot)=>ot.quantidade-$e.quantidade).slice(0,5);Te.push(...Ve)}),ee(Te)}}catch(ae){console.error(" Erro ao processar dados do Dashboard Lanadas:",ae),wt.error("Erro ao processar dados: "+(ae.message||"Erro desconhecido"))}finally{a(!1)}},K=({active:ae,payload:Q})=>{if(!ae||!(Q!=null&&Q.length))return null;const fe=Q[0].payload,le=fe.quantidade||fe.count||fe.value||0,ne=fe.detalhes||[],ue=ne&&ne.length>0;return w.jsxs("div",{className:"bg-card border border-border rounded-md p-3 shadow-md",children:[w.jsx("p",{className:"text-sm font-bold text-foreground mb-1",children:"Detalhes"}),fe.value&&typeof fe.value=="number"&&fe.value>1e3?w.jsxs("p",{className:"text-sm font-bold text-primary",children:["R$ ",fe.value.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}):w.jsxs("p",{className:"text-sm font-bold text-primary",children:[le," ",fe.count!==void 0?"nota(s)":fe.value!==void 0?"ocorrncia(s)":"item(s)"]}),ue&&w.jsx("div",{className:"mt-2 space-y-1 max-h-[200px] overflow-y-auto",children:ne.map((he,ke)=>w.jsxs("p",{className:"text-xs text-muted-foreground",children:[w.jsx("span",{className:"font-medium text-foreground",children:he.cliente}),w.jsx("span",{className:"mx-1",children:""}),w.jsxs("span",{className:"text-primary",children:["NF: ",he.nota]})]},ke))})]})},se=()=>{const ae=t.startDate&&t.endDate?`${Xt(t.startDate,"dd/MM/yyyy",{locale:yr})} a ${Xt(t.endDate,"dd/MM/yyyy",{locale:yr})}`:t.period||"Todos os perodos";let Q="Todos os perodos";if(t.startDate)Q=Xt(t.startDate,"MMMM 'de' yyyy",{locale:yr});else if(t.period){const pe=ju(t.period);pe.startDate&&(Q=Xt(pe.startDate,"MMMM 'de' yyyy",{locale:yr}))}const le=(r==null?void 0:r.role)==="VENDEDOR"&&(r!=null&&r.vendedor)?r.vendedor:"Geral",ne=`Dashboard Devolues Lanadas - ${Q} - ${le}`,ue=[];t.motivo&&t.motivo.length>0&&ue.push(`Motivos: ${t.motivo.length} selecionado(s)`),t.cliente&&t.cliente.length>0&&ue.push(`Clientes: ${t.cliente.length} selecionado(s)`),t.vendedor&&t.vendedor.length>0&&ue.push(`Vendedores: ${t.vendedor.length} selecionado(s)`),t.setor&&t.setor.length>0&&ue.push(`Setores: ${t.setor.length} selecionado(s)`),t.search&&ue.push(`Busca: "${t.search}"`);const he=`
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>${ne}</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"><\/script>
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
  
  @page {
    size: A4 portrait;
    margin: 15mm;
  }
  
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: white;
    padding: 10px;
    color: #333;
    font-size: 9px;
  }
  
  .page {
    page-break-after: auto;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }
  
  .header {
    background: linear-gradient(135deg, #073e29 0%, #0a4d33 100%);
    color: white;
    padding: 12px;
    border-radius: 6px;
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    gap: 15px;
  }
  
  .header-logo {
    width: 50px;
    height: 50px;
    background: white;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }
  
  .header-logo img {
    width: 100%;
    height: 100%;
    object-fit: contain;
  }
  
  .header-content {
    flex: 1;
  }
  
  .header h1 {
    font-size: 18px;
    margin-bottom: 4px;
  }
  
  .header-info {
    font-size: 9px;
    opacity: 0.95;
    margin-bottom: 3px;
  }
  
  .header-filters {
    font-size: 8px;
    opacity: 0.85;
    margin-top: 4px;
  }
  
  .kpi-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 6px;
    margin-bottom: 12px;
  }
  
  .kpi-card {
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 8px;
    background: #f9fafb;
  }
  
  .kpi-title {
    font-size: 7px;
    color: #666;
    margin-bottom: 3px;
  }
  
  .kpi-value {
    font-size: 13px;
    font-weight: bold;
    color: #073e29;
  }
  
  .kpi-desc {
    font-size: 6px;
    color: #999;
    margin-top: 2px;
  }
  
  .chart-section {
    margin-bottom: 10px;
    page-break-inside: avoid;
    break-inside: avoid;
  }
  
  .chart-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-bottom: 10px;
  }
  
  .chart-title {
    font-size: 11px;
    font-weight: bold;
    margin-bottom: 6px;
    color: #073e29;
    border-bottom: 2px solid #073e29;
    padding-bottom: 3px;
  }

  .chart-container {
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 6px;
    background: white;
    height: 140px;
    position: relative;
    width: 100%;
  }
  
  .insights-container {
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 6px;
    background: white;
    height: 140px;
    position: relative;
    width: 100%;
    overflow-y: auto;
  }
  
  .insight-item {
    font-size: 8px;
    margin-bottom: 4px;
    padding-left: 6px;
    line-height: 1.4;
    color: #333;
  }
  
  .devolucao-vendas-card {
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 10px;
    background: #f9fafb;
    margin-bottom: 12px;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  
  .devolucao-vendas-title {
    font-size: 11px;
    font-weight: bold;
    color: #073e29;
    margin-bottom: 4px;
  }
  
  .devolucao-vendas-content {
    display: flex;
    gap: 12px;
    align-items: flex-end;
  }
  
  .devolucao-vendas-input {
    flex: 1;
  }
  
  .devolucao-vendas-input label {
    font-size: 8px;
    color: #666;
    display: block;
    margin-bottom: 4px;
  }
  
  .devolucao-vendas-input input {
    width: 100%;
    padding: 6px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 10px;
  }
  
  .devolucao-vendas-result {
    flex: 1;
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 8px;
    background: white;
  }
  
  .devolucao-vendas-result-title {
    font-size: 7px;
    color: #666;
    margin-bottom: 3px;
  }
  
  .devolucao-vendas-result-value {
    font-size: 16px;
    font-weight: bold;
    color: #073e29;
  }
  
  .devolucao-vendas-result-desc {
    font-size: 6px;
    color: #999;
    margin-top: 2px;
  }
  
  .tables-section {
    margin-top: 12px;
    margin-bottom: 12px;
  }
  
  .tables-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-bottom: 10px;
  }
  
  .table-card {
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 8px;
    background: white;
    page-break-inside: avoid;
    break-inside: avoid;
  }
  
  .table-title {
    font-size: 10px;
    font-weight: bold;
    color: #073e29;
    margin-bottom: 4px;
    border-bottom: 1px solid #073e29;
    padding-bottom: 3px;
  }
  
  .table-description {
    font-size: 7px;
    color: #666;
    margin-bottom: 6px;
  }
  
  .table-container {
    overflow-x: auto;
  }
  
  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 7px;
  }
  
  table th {
    background: #f9fafb;
    border: 1px solid #ddd;
    padding: 4px;
    text-align: left;
    font-weight: bold;
    color: #073e29;
  }
  
  table td {
    border: 1px solid #ddd;
    padding: 4px;
    color: #333;
  }
  
  table tr:nth-child(even) {
    background: #f9fafb;
  }
  
  .text-right {
    text-align: right;
  }
  
  .footer {
    margin-top: auto;
    padding-top: 12px;
    border-top: 2px solid #073e29;
    text-align: center;
    font-size: 7px;
    color: #666;
  }
  
  @media print {
    body {
      padding: 0;
    }
    .no-print {
      display: none !important;
    }
    .chart-container, .chart-container-full {
      page-break-inside: avoid;
    }
  }
</style>
</head>
<body>
<button class="no-print" onclick="window.print()" style="position: fixed; top: 10px; right: 10px; z-index: 1000; background: #073e29; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold;">
   Imprimir
</button>

<!-- PGINA 1: Header + KPIs + 3 Sees com 2 Grficos -->
<div class="page">
  <div class="header">
    <div class="header-logo">
      <img src="/logo.png" alt="Logo" onerror="this.style.display='none'" style="background-color: #073e29;">
    </div>
    <div class="header-content">
      <h1>${ne}</h1>
      <div class="header-info">Relatrio Gerado em ${Xt(new Date,"dd/MM/yyyy 's' HH:mm",{locale:yr})}</div>
      <div class="header-info">Perodo: ${ae}</div>
      ${ue.length>0?`<div class="header-filters">Filtros: ${ue.join(" | ")}</div>`:""}
    </div>
  </div>
  
  <div class="kpi-grid">
    <div class="kpi-card">
      <div class="kpi-title">Valor Total Devolvido</div>
      <div class="kpi-value">R$ ${n.valorTotalLancado.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}</div>
      <div class="kpi-desc">Resultado: LANADA</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">Notas Lanadas</div>
      <div class="kpi-value">${n.notasLancadas}</div>
      <div class="kpi-desc">Resultado: LANADA</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">Valor Total Cancelado</div>
      <div class="kpi-value">R$ ${n.valorTotalCancelado.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}</div>
      <div class="kpi-desc">Resultado: ANULADA/CANCELADA</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">Notas Canceladas</div>
      <div class="kpi-value">${n.notasCanceladas}</div>
      <div class="kpi-desc">Resultado: ANULADA/CANCELADA</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">Produtos Devolvidos</div>
      <div class="kpi-value">${n.totalProducts.toFixed(2)}</div>
      <div class="kpi-desc">Quantidade total</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">Ticket Mdio</div>
      <div class="kpi-value">R$ ${n.avgTicket.toLocaleString("pt-BR",{maximumFractionDigits:0})}</div>
    </div>
  </div>
  
  <!-- Card Devoluo sobre Vendas -->
  <div class="devolucao-vendas-card">
    <div class="devolucao-vendas-title">Devoluo sobre Vendas</div>
    <div class="devolucao-vendas-content">
      <div class="devolucao-vendas-input">
        <label>Valor de Vendas (R$)</label>
        <input type="number" id="valorVendasInput" value="${A||""}" readonly style="background: #f0f0f0; cursor: not-allowed;" />
      </div>
      <div class="devolucao-vendas-result">
        <div class="devolucao-vendas-result-title">Devoluo sobre Vendas</div>
        <div class="devolucao-vendas-result-value">
          ${A&&Number(A)>0?`${(n.valorTotalLancado/Number(A)*100).toFixed(2)}%`:"0.00%"}
        </div>
        <div class="devolucao-vendas-result-desc">Resultado: LANADA</div>
      </div>
    </div>
  </div>
  
  <!-- Seo 1: Evoluo no Tempo | Top Clientes -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Evoluo no Tempo</div>
      <div class="chart-container">
        <canvas id="chartEvolucao"></canvas>
      </div>
    </div>
    <div class="chart-section">
      <div class="chart-title">Top Clientes (Valor)</div>
      <div class="chart-container">
        <canvas id="chartTopClientes"></canvas>
      </div>
    </div>
  </div>
  
  <!-- Seo 2: Top Vendedores | Top Redes -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Top Vendedores (Valor)</div>
      <div class="chart-container">
        <canvas id="chartVendedores"></canvas>
      </div>
    </div>
    <div class="chart-section">
      <div class="chart-title">Top Redes (Valor)</div>
      <div class="chart-container">
        <canvas id="chartRedes"></canvas>
      </div>
    </div>
  </div>
  
  <!-- Seo 3: Anlise de Pareto | Clientes com Reincidncia -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Anlise de Pareto (80/20)</div>
      <div class="chart-container">
        <canvas id="chartPareto"></canvas>
      </div>
    </div>
    <div class="chart-section">
      <div class="chart-title">Clientes com Reincidncia</div>
      <div class="chart-container">
        <canvas id="chartReincidencia"></canvas>
      </div>
    </div>
  </div>
  
  <!-- Seo 4: Devolues Por Motivo | Devolues Por Setores -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Devolues Por Motivo (Apenas LANADA)</div>
      <div class="chart-container">
        <canvas id="chartMotivos"></canvas>
      </div>
    </div>
    <div class="chart-section">
      <div class="chart-title">Devolues Por Setores (Apenas LANADA)</div>
      <div class="chart-container">
        <canvas id="chartSetores"></canvas>
      </div>
    </div>
  </div>
  
  <!-- Seo 5: Top 20 Produtos | Insights -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Top 20 Produtos mais devolvidos (${_})</div>
      <div class="chart-container">
        <canvas id="chartProdutos"></canvas>
      </div>
    </div>
    ${g.length>0?`
    <div class="chart-section">
      <div class="chart-title">Insights Automticos</div>
      <div class="insights-container">
        ${g.map(pe=>`
          <div class="insight-item">${pe}</div>
        `).join("")}
      </div>
    </div>
    `:'<div class="chart-section"></div>'}
  </div>
  
  <!-- Tabelas de Motivos -->
  <div class="tables-section">
    <div class="tables-grid">
      <!-- Tabela 1: Motivos por Produto -->
      <div class="table-card">
        <div class="table-title">Motivos por Produto</div>
        <div class="table-description">5 produtos mais devolvidos do top 10 maiores motivos (Apenas LANADA)</div>
        <div class="table-container">
          ${D.length>0?`
          <table>
            <thead>
              <tr>
                <th>Produto</th>
                <th>Motivo</th>
                <th class="text-right">Qtd</th>
                <th class="text-right">Valor</th>
              </tr>
            </thead>
            <tbody>
              ${D.map(pe=>`
                <tr>
                  <td>${(pe.produto||"").length>20?(pe.produto||"").substring(0,20)+"...":pe.produto||""}</td>
                  <td>${(pe.motivo||"").length>20?(pe.motivo||"").substring(0,20)+"...":pe.motivo||""}</td>
                  <td class="text-right">${(pe.quantidade||0).toFixed(2)}</td>
                  <td class="text-right">R$ ${(pe.valorTotal||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          `:'<p style="text-align: center; color: #999; font-size: 8px; padding: 10px;">Nenhum dado disponvel</p>'}
        </div>
      </div>
      
      <!-- Tabela 2: Motivos por Vendedor -->
      <div class="table-card">
        <div class="table-title">Motivos por Vendedor</div>
        <div class="table-description">5 motivos mais devolvidos por vendedor (Apenas LANADA)</div>
        <div class="table-container">
          ${F.length>0?`
          <table>
            <thead>
              <tr>
                <th>Vendedor</th>
                <th>Motivo</th>
                <th class="text-right">Qtd</th>
                <th class="text-right">Valor</th>
              </tr>
            </thead>
            <tbody>
              ${F.map(pe=>`
                <tr>
                  <td>${(pe.vendedor||"").length>15?(pe.vendedor||"").substring(0,15)+"...":pe.vendedor||""}</td>
                  <td>${(pe.motivo||"").length>20?(pe.motivo||"").substring(0,20)+"...":pe.motivo||""}</td>
                  <td class="text-right">${pe.quantidade||0}</td>
                  <td class="text-right">R$ ${(pe.valorTotal||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          `:'<p style="text-align: center; color: #999; font-size: 8px; padding: 10px;">Nenhum dado disponvel</p>'}
        </div>
      </div>
      
      <!-- Tabela 3: Motivos por Setor -->
      <div class="table-card">
        <div class="table-title">Motivos por Setor</div>
        <div class="table-description">Top 5 motivos mais devolvidos por setor (Apenas LANADA)</div>
        <div class="table-container">
          ${X.length>0?`
          <table>
            <thead>
              <tr>
                <th>Setor</th>
                <th>Motivo</th>
                <th class="text-right">Qtd</th>
                <th class="text-right">Valor</th>
              </tr>
            </thead>
            <tbody>
              ${X.map(pe=>`
                <tr>
                  <td>${pe.setor||""}</td>
                  <td>${(pe.motivo||"").length>20?(pe.motivo||"").substring(0,20)+"...":pe.motivo||""}</td>
                  <td class="text-right">${pe.quantidade||0}</td>
                  <td class="text-right">R$ ${(pe.valorTotal||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          `:'<p style="text-align: center; color: #999; font-size: 8px; padding: 10px;">Nenhum dado disponvel</p>'}
        </div>
      </div>
      
      <!-- Tabela 4: Motivos por Cliente -->
      <div class="table-card">
        <div class="table-title">Motivos por Cliente</div>
        <div class="table-description">Top 5 motivos mais devolvidos do top 10 clientes (Apenas LANADA)</div>
        <div class="table-container">
          ${z.length>0?`
          <table>
            <thead>
              <tr>
                <th>Cliente</th>
                <th>Motivo</th>
                <th class="text-right">Qtd</th>
                <th class="text-right">Valor</th>
              </tr>
            </thead>
            <tbody>
              ${z.map(pe=>`
                <tr>
                  <td>${(pe.cliente||"").length>20?(pe.cliente||"").substring(0,20)+"...":pe.cliente||""}</td>
                  <td>${(pe.motivo||"").length>20?(pe.motivo||"").substring(0,20)+"...":pe.motivo||""}</td>
                  <td class="text-right">${pe.quantidade||0}</td>
                  <td class="text-right">R$ ${(pe.valorTotal||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          `:'<p style="text-align: center; color: #999; font-size: 8px; padding: 10px;">Nenhum dado disponvel</p>'}
        </div>
      </div>
    </div>
  </div>
  
  <div class="footer">
    <p>Relatrio gerado automaticamente pelo Sistema de Devolues - Grupo Doce Mel</p>
    <p>Data de gerao: ${Xt(new Date,"dd/MM/yyyy 's' HH:mm:ss",{locale:yr})}</p>
  </div>
</div>

<script>
  Chart.defaults.font.size = 8;
  Chart.defaults.color = '#1f2937';
  Chart.defaults.borderColor = '#e5e7eb';
  
  // Grfico de Evoluo no Tempo
  new Chart(document.getElementById('chartEvolucao'), {
    type: 'line',
    data: {
      labels: ${JSON.stringify(s.map(pe=>pe.name))},
      datasets: [{
        label: 'Valor Total (R$)',
        data: ${JSON.stringify(s.map(pe=>pe.value))},
        borderColor: '#17432a',
        backgroundColor: 'rgba(23, 67, 42, 0.15)',
        borderWidth: 2,
        fill: true,
        tension: 0.4
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#17432a',
          borderWidth: 1,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            color: '#1f2937',
            font: { size: 8 },
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR')
          },
          grid: { color: '#e5e7eb' }
        },
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 8 }
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
  
  // Grfico Top Clientes
  new Chart(document.getElementById('chartTopClientes'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(c.map(pe=>pe.name.length>12?pe.name.substring(0,12)+"...":pe.name))},
      datasets: [{
        label: 'Valor (R$)',
        data: ${JSON.stringify(c.map(pe=>pe.value))},
        backgroundColor: '#17432a',
        borderColor: '#0a4d33',
        borderWidth: 1
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      indexAxis: 'y',
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#17432a',
          borderWidth: 1,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.x.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      },
      scales: {
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 8 },
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR')
          },
          grid: { color: '#e5e7eb' }
        },
        y: {
          ticks: {
            color: '#1f2937',
            font: { size: 8 }
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
  
  // Grfico Top Vendedores
  new Chart(document.getElementById('chartVendedores'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(u.map(pe=>pe.name.length>12?pe.name.substring(0,12)+"...":pe.name))},
      datasets: [{
        label: 'Valor (R$)',
        data: ${JSON.stringify(u.map(pe=>pe.value))},
        backgroundColor: '#0a4d33',
        borderColor: '#17432a',
        borderWidth: 1
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#0a4d33',
          borderWidth: 1,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            color: '#1f2937',
            font: { size: 8 },
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR')
          },
          grid: { color: '#e5e7eb' }
        },
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 8 }
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
  
  // Grfico Top Redes
  new Chart(document.getElementById('chartRedes'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(f.map(pe=>pe.name.length>12?pe.name.substring(0,12)+"...":pe.name))},
      datasets: [{
        label: 'Valor (R$)',
        data: ${JSON.stringify(f.map(pe=>pe.value))},
        backgroundColor: '#065f46',
        borderColor: '#0a4d33',
        borderWidth: 1
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#065f46',
          borderWidth: 1,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            color: '#1f2937',
            font: { size: 8 },
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR')
          },
          grid: { color: '#e5e7eb' }
        },
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 8 }
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
  
  // Grfico Pareto
  new Chart(document.getElementById('chartPareto'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(v.map(pe=>pe.name.length>10?pe.name.substring(0,10)+"...":pe.name))},
      datasets: [{
        type: 'bar',
        label: 'Valor (R$)',
        data: ${JSON.stringify(v.map(pe=>pe.value))},
        backgroundColor: '#17432a',
        borderColor: '#0a4d33',
        borderWidth: 1,
        yAxisID: 'y'
      }, {
        type: 'line',
        label: '% Acumulado',
        data: ${JSON.stringify(v.map(pe=>pe.percentage))},
        borderColor: '#dc2626',
        backgroundColor: 'rgba(220, 38, 38, 0.1)',
        borderWidth: 2,
        yAxisID: 'y1',
        pointRadius: 3,
        pointBackgroundColor: '#dc2626'
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      interaction: {
        mode: 'index',
        intersect: false,
      },
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#17432a',
          borderWidth: 1
        }
      },
      scales: {
        y: {
          type: 'linear',
          display: true,
          position: 'left',
          ticks: {
            color: '#1f2937',
            font: { size: 8 },
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR')
          },
          grid: { color: '#e5e7eb' }
        },
        y1: {
          type: 'linear',
          display: true,
          position: 'right',
          max: 100,
          ticks: {
            color: '#dc2626',
            font: { size: 8 },
            callback: (value) => value + '%'
          },
          grid: {
            drawOnChartArea: false,
          }
        },
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 8 }
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
  
  // Grfico Reincidncia
  new Chart(document.getElementById('chartReincidencia'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(P.map(pe=>pe.name.length>12?pe.name.substring(0,12)+"...":pe.name))},
      datasets: [{
        label: 'Notas Canceladas',
        data: ${JSON.stringify(P.map(pe=>pe.count))},
        backgroundColor: '#dc2626',
        borderColor: '#b91c1c',
        borderWidth: 1
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#dc2626',
          borderWidth: 1
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            color: '#1f2937',
            font: { size: 8 },
            stepSize: 1
          },
          grid: { color: '#e5e7eb' }
        },
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 8 }
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
  
  // Grfico Motivos (Colunas Verticais)
  new Chart(document.getElementById('chartMotivos'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(G.map(pe=>pe.name.length>20?pe.name.substring(0,20)+"...":pe.name))},
      datasets: [{
        label: 'Valor Total (R$)',
        data: ${JSON.stringify(G.map(pe=>pe.valorTotal))},
        backgroundColor: '#17432a',
        borderColor: '#0a4d33',
        borderWidth: 1
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      indexAxis: 'x',
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#17432a',
          borderWidth: 1,
          callbacks: {
            label: (context) => {
              const dataIndex = context.dataIndex;
              const quantidade = ${JSON.stringify(G.map(pe=>pe.quantidade))}[dataIndex];
              return [
                'Valor: R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 }),
                'Quantidade: ' + quantidade + ' nota(s)'
              ];
            }
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            color: '#1f2937',
            font: { size: 8 },
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR')
          },
          grid: { color: '#e5e7eb' }
        },
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 7 },
            maxRotation: 45,
            minRotation: 45
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
  
  // Grfico Setores (Colunas Verticais)
  new Chart(document.getElementById('chartSetores'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(W.map(pe=>pe.name))},
      datasets: [{
        label: 'Valor Total (R$)',
        data: ${JSON.stringify(W.map(pe=>pe.valorTotal))},
        backgroundColor: '#0a4d33',
        borderColor: '#17432a',
        borderWidth: 1
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      indexAxis: 'x',
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#0a4d33',
          borderWidth: 1,
          callbacks: {
            label: (context) => {
              const dataIndex = context.dataIndex;
              const quantidade = ${JSON.stringify(W.map(pe=>pe.quantidade))}[dataIndex];
              return [
                'Valor: R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 }),
                'Quantidade: ' + quantidade + ' nota(s)'
              ];
            }
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            color: '#1f2937',
            font: { size: 8 },
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR')
          },
          grid: { color: '#e5e7eb' }
        },
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 8 }
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
  
  // Grfico Produtos (Colunas Verticais)
  new Chart(document.getElementById('chartProdutos'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(R.map(pe=>(pe.nameFull||pe.name).length>15?(pe.nameFull||pe.name).substring(0,15)+"...":pe.nameFull||pe.name))},
      datasets: [{
        label: 'Quantidade (${_})',
        data: ${JSON.stringify(R.map(pe=>pe.quantidade))},
        backgroundColor: '#065f46',
        borderColor: '#0a4d33',
        borderWidth: 1
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      indexAxis: 'x',
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#065f46',
          borderWidth: 1,
          callbacks: {
            title: (items) => {
              const index = items[0].dataIndex;
              return ${JSON.stringify(R.map(pe=>pe.nameFull||pe.name))}[index] || '';
            },
            label: (context) => context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ' ${_}'
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            color: '#1f2937',
            font: { size: 8 }
          },
          grid: { color: '#e5e7eb' }
        },
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 7 },
            maxRotation: 45,
            minRotation: 45
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
<\/script>
</body>
</html>
  `,ke=window.open("","_blank");ke&&(ke.document.write(he),ke.document.close())},te=({active:ae,payload:Q})=>{if(!ae||!(Q!=null&&Q.length))return null;const fe=Q[0].payload,le=fe.valorTotal||0,ne=fe.quantidade||fe.count||0,ue=fe.name||fe.nameFull||"",he=fe.nameFull||ue,ke=fe.nameFull?_:fe.unidade||"nota(s)";return w.jsxs("div",{className:"bg-card border border-border rounded-md p-3 shadow-md",children:[w.jsx("p",{className:"text-sm font-bold text-foreground mb-2",children:he}),w.jsxs("div",{className:"space-y-1",children:[le>0&&w.jsxs("p",{className:"text-sm font-bold text-primary",children:["Valor Total: R$ ",le.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),ne>0&&w.jsxs("p",{className:"text-sm text-muted-foreground",children:[le>0?"Quantidade: ":"",ne.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})," ",ke]})]})]})};return e?w.jsx("div",{className:"flex items-center justify-center min-h-screen",children:w.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"})}):w.jsxs("div",{className:"space-y-6",children:[w.jsx(Qi,{title:"Dashboard Lanadas",description:"Viso geral das devolues lanadas (Lanadas e Anuladas/Canceladas) com KPIs, grficos e insights automticos para anlise estratgica."}),w.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[w.jsx(Xf,{}),w.jsxs("div",{className:"flex flex-col gap-2 w-full md:w-auto",children:[w.jsxs(Ot,{variant:"outline",size:"sm",onClick:se,className:"w-full md:w-auto shrink-0",children:[w.jsx(nk,{className:"mr-2 h-4 w-4"}),"Imprimir Dashboard"]}),w.jsxs(Ot,{variant:"outline",size:"sm",onClick:M,className:"w-full md:w-auto shrink-0",children:[w.jsx(gm,{className:"mr-2 h-4 w-4"}),"Atualizar"]})]})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-6",children:[w.jsx(Bn,{title:"Valor Total Devolvido",value:`R$ ${n.valorTotalLancado.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:Op,description:"Resultado: LANADA"}),w.jsx(Bn,{title:"Notas Lanadas",value:n.notasLancadas,icon:I2,description:"Resultado: LANADA"}),w.jsx(Bn,{title:"Valor Total Cancelado",value:`R$ ${n.valorTotalCancelado.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:Op,description:"Resultado: ANULADA/CANCELADA"}),w.jsx(Bn,{title:"Notas Canceladas",value:n.notasCanceladas,icon:Ao,description:"Resultado: ANULADA/CANCELADA"}),w.jsx(Bn,{title:"Produtos Devolvidos",value:n.totalProducts.toFixed(2),icon:Ul,description:"Quantidade total"}),w.jsx(Bn,{title:"Ticket Mdio",value:`R$ ${n.avgTicket.toLocaleString("pt-BR",{maximumFractionDigits:0})}`,icon:_u})]}),w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Devoluo sobre Vendas"}),w.jsx(Cr,{children:"Calcule o percentual de devolues sobre o valor de vendas"})]}),w.jsx(jt,{children:w.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-end",children:[w.jsxs("div",{className:"flex-1",children:[w.jsx(kr,{htmlFor:"valorVendas",children:"Valor de Vendas (R$)"}),w.jsx(_r,{id:"valorVendas",type:"number",placeholder:"Digite o valor de vendas",value:A,onChange:ae=>T(ae.target.value),className:"mt-2"})]}),w.jsx("div",{className:"flex-1",children:w.jsx(Bn,{title:"Devoluo sobre Vendas",value:A&&Number(A)>0?`${(n.valorTotalLancado/Number(A)*100).toFixed(2)}%`:"0.00%",icon:tk,description:"Resultado: LANADA"})})]})})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[w.jsxs(Nt,{className:"col-span-4",children:[w.jsx(Dt,{children:w.jsx(Mt,{children:"Evoluo no Tempo"})}),w.jsx(jt,{className:"pl-2",children:w.jsx(Jr,{width:"100%",height:350,children:w.jsxs(v2,{data:s,children:[w.jsx("defs",{children:w.jsxs("linearGradient",{id:"colorValue",x1:"0",y1:"0",x2:"0",y2:"1",children:[w.jsx("stop",{offset:"5%",stopColor:L[0],stopOpacity:.8}),w.jsx("stop",{offset:"95%",stopColor:L[0],stopOpacity:0})]})}),w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",height:60,tick:w.jsx(ys,{})}),w.jsx($r,{className:"text-[6px] font-size-6px font-bold",tickFormatter:ae=>`R$${ae}`}),w.jsx(Qr,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)",color:"var(--foreground)",fontSize:"11px",fontWeight:"bold"},formatter:(ae,Q)=>Q==="value"?[`R$ ${(ae||0).toFixed(2)}`,"Valor Total"]:Q==="count"?[`${ae||0}`,"Qtd de Notas"]:[ae,Q||""],labelFormatter:ae=>`Data: ${ae}`}),w.jsx(b2,{type:"monotone",dataKey:"value",stroke:L[0],fillOpacity:1,fill:"url(#colorValue)"}),w.jsx(Xl,{type:"monotone",dataKey:"count",stroke:L[1],strokeWidth:2,dot:{fill:L[1],r:4}})]})})})]}),w.jsxs(Nt,{className:"col-span-4",children:[w.jsx(Dt,{children:w.jsx(Mt,{children:"Top Clientes (Valor)"})}),w.jsx(jt,{children:w.jsx(Jr,{width:"100%",height:350,children:w.jsxs(Ya,{data:c,children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",height:60,tick:w.jsx(ys,{})}),w.jsx($r,{className:"text-[6px] font-bold",tickFormatter:ae=>`R$${ae}`}),w.jsx(Qr,{content:w.jsx(K,{})}),w.jsx(Na,{dataKey:"value",fill:L[0],radius:[8,8,0,0],children:w.jsx(Fa,{dataKey:"value",position:"top",content:({value:ae})=>w.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(ae||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[w.jsxs(Nt,{children:[w.jsx(Dt,{children:w.jsx(Mt,{children:"Top Vendedores (Valor)"})}),w.jsx(jt,{children:w.jsx(Jr,{width:"100%",height:300,children:w.jsxs(Ya,{data:u,children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",height:60,tick:w.jsx(ys,{})}),w.jsx($r,{className:"text-[10px] font-bold",tickFormatter:ae=>`R$${ae}`}),w.jsx(Qr,{content:w.jsx(K,{})}),w.jsx(Na,{dataKey:"value",fill:L[1],radius:[8,8,0,0],children:w.jsx(Fa,{dataKey:"value",position:"top",content:({value:ae})=>w.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(ae||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{children:w.jsx(Mt,{children:"Top Redes (Valor)"})}),w.jsx(jt,{children:w.jsx(Jr,{width:"100%",height:300,children:w.jsxs(Ya,{data:f,children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",height:60,tick:w.jsx(ys,{})}),w.jsx($r,{className:"text-[10px] font-bold",tickFormatter:ae=>`R$${ae}`}),w.jsx(Qr,{content:w.jsx(K,{})}),w.jsx(Na,{dataKey:"value",fill:L[2],radius:[8,8,0,0],children:w.jsx(Fa,{dataKey:"value",position:"top",content:({value:ae})=>w.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(ae||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Top 5 Clientes com Reincidncia"}),w.jsx(Cr,{children:"Clientes com mais notas ANULADAS/CANCELADAS"})]}),w.jsx(jt,{children:w.jsx(Jr,{width:"100%",height:300,children:w.jsxs(Ya,{data:P,children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",height:60,tick:w.jsx(ys,{})}),w.jsx($r,{className:"text-[10px] font-bold"}),w.jsx(Qr,{content:w.jsx(K,{})}),w.jsx(Na,{dataKey:"count",fill:L[3],radius:[8,8,0,0],children:w.jsx(Fa,{dataKey:"count",position:"top",content:({value:ae})=>w.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`${ae||0}`})})})]})})})]}),w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Motivos Mais Recorrentes por Rede"}),w.jsx(Cr,{children:"Principais motivos de devoluo por rede (Top 5 redes)"})]}),w.jsx(jt,{children:w.jsx(Jr,{width:"100%",height:300,children:w.jsxs(Ya,{data:U,layout:"vertical",children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{type:"number",className:"text-[10px] font-bold"}),w.jsx($r,{type:"category",dataKey:"rede",width:100,tick:w.jsx(ys,{})}),w.jsx(Qr,{content:w.jsx(K,{})}),w.jsx(Na,{dataKey:"count",fill:L[4],radius:[0,8,8,0],children:w.jsx(Fa,{dataKey:"count",position:"right",content:({value:ae})=>w.jsx("text",{x:0,y:0,dx:5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"start",children:`${ae||0}`})})})]})})})]})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[w.jsxs(Nt,{children:[w.jsx(Dt,{children:w.jsx(Mt,{children:"Anlise de Pareto (80/20)"})}),w.jsxs(jt,{children:[w.jsx(Jr,{width:"100%",height:350,children:w.jsxs(x2,{data:v,children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",height:60,tick:w.jsx(ys,{})}),w.jsx($r,{yAxisId:"left",className:"text-[10px] font-bold",tickFormatter:ae=>`R$${ae}`}),w.jsx($r,{yAxisId:"right",orientation:"right",className:"text-[10px] font-bold",tickFormatter:ae=>`${ae}%`}),w.jsx(Qr,{content:w.jsx(K,{})}),w.jsx(Na,{yAxisId:"left",dataKey:"value",fill:L[0],radius:[8,8,0,0],children:w.jsx(Fa,{dataKey:"value",position:"top",content:({value:ae})=>w.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(ae||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})}),w.jsx(Xl,{yAxisId:"right",type:"monotone",dataKey:"percentage",stroke:L[3],strokeWidth:2})]})}),w.jsx("div",{className:"mt-4 text-xs text-muted-foreground",children:"Linha mostra o percentual acumulado. A regra 80/20 indica que poucos clientes concentram a maioria do valor."})]})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{children:w.jsx(Mt,{children:"Insights Automticos"})}),w.jsx(jt,{children:w.jsx("div",{className:"space-y-3",children:g.length>0?g.map((ae,Q)=>w.jsx("div",{className:"p-3 bg-muted/50 rounded-lg text-sm",children:ae},Q)):w.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum insight disponvel no momento."})})})]})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Devolues Por Motivo"}),w.jsx(Cr,{children:"Valor total e quantidade de notas por motivo"})]}),w.jsx(jt,{children:G.length>0?w.jsx(Jr,{width:"100%",height:300,children:w.jsxs(Ya,{data:G,children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",height:60,tick:w.jsx(ys,{})}),w.jsx($r,{className:"text-[10px] font-bold",tickFormatter:ae=>`R$${ae}`}),w.jsx(Qr,{content:w.jsx(te,{})}),w.jsx(Na,{dataKey:"valorTotal",fill:L[0],radius:[8,8,0,0],children:w.jsx(Fa,{dataKey:"valorTotal",position:"top",content:({value:ae})=>w.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:9,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(ae||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})}):w.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-muted-foreground text-center p-4",children:[w.jsx(Ul,{className:"h-10 w-10 mb-2 opacity-20"}),w.jsx("p",{className:"text-sm",children:"Nenhum dado disponvel."})]})})]}),w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Devolues Por Setores"}),w.jsx(Cr,{children:"Valor total e quantidade de notas por setor"})]}),w.jsx(jt,{children:W.length>0?w.jsx(Jr,{width:"100%",height:300,children:w.jsxs(Ya,{data:W,children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",height:60,tick:w.jsx(ys,{})}),w.jsx($r,{className:"text-[10px] font-bold",tickFormatter:ae=>`R$${ae}`}),w.jsx(Qr,{content:w.jsx(te,{})}),w.jsx(Na,{dataKey:"valorTotal",fill:L[0],radius:[8,8,0,0],children:w.jsx(Fa,{dataKey:"valorTotal",position:"top",content:({value:ae})=>w.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:9,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(ae||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})}):w.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-muted-foreground text-center p-4",children:[w.jsx(Ul,{className:"h-10 w-10 mb-2 opacity-20"}),w.jsx("p",{className:"text-sm",children:"Nenhum dado disponvel."})]})})]})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{children:w.jsx(Mt,{className:"text-base",children:"Distribuio por Municpio"})}),w.jsx(jt,{children:N.length>0?w.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[w.jsx("div",{className:"space-y-4",children:N.slice(0,10).map((ae,Q)=>w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(Mp,{className:"h-4 w-4 text-muted-foreground"}),w.jsx("span",{className:"text-sm font-medium truncate max-w-[120px]",title:ae.name,children:ae.name})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"h-2 bg-muted rounded-full w-24 overflow-hidden",children:w.jsx("div",{className:"h-full bg-primary",style:{width:`${ae.value/(n.totalValue||1)*100}%`}})}),w.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:[(ae.value/(n.totalValue||1)*100).toFixed(0),"%"]})]})]},Q))}),w.jsx("div",{className:"space-y-4",children:N.slice(10,20).map((ae,Q)=>w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx(Mp,{className:"h-4 w-4 text-muted-foreground"}),w.jsx("span",{className:"text-sm font-medium truncate max-w-[120px]",title:ae.name,children:ae.name})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("div",{className:"h-2 bg-muted rounded-full w-24 overflow-hidden",children:w.jsx("div",{className:"h-full bg-primary",style:{width:`${ae.value/(n.totalValue||1)*100}%`}})}),w.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:[(ae.value/(n.totalValue||1)*100).toFixed(0),"%"]})]})]},Q+10))})]}):w.jsx("div",{className:"text-center text-sm text-muted-foreground py-8",children:"Nenhum dado disponvel"})})]}),w.jsxs(Nt,{className:"col-span-4",children:[w.jsx(Dt,{children:w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx(Mt,{children:"Top 20 Produtos mais devolvidos"}),w.jsxs($n,{value:_,onValueChange:ae=>k(ae),children:[w.jsx(xn,{className:"w-[120px]",children:w.jsx(Vn,{})}),w.jsxs(yn,{children:[w.jsx(sr,{value:"KG",children:"KG"}),w.jsx(sr,{value:"CX",children:"CX"})]})]})]})}),w.jsx(jt,{className:"pl-2",children:R.length>0?w.jsx(Jr,{width:"100%",height:350,children:w.jsxs(Ya,{data:R,children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",height:80,tick:w.jsx(ys,{})}),w.jsx($r,{className:"text-[10px] font-bold"}),w.jsx(Qr,{content:w.jsx(te,{})}),w.jsx(Na,{dataKey:"quantidade",fill:L[0],radius:[8,8,0,0],children:w.jsx(Fa,{dataKey:"quantidade",position:"top",content:({value:ae})=>w.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`${(ae||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})} ${_}`})})})]})}):w.jsxs("div",{className:"flex flex-col items-center justify-center h-[350px] text-muted-foreground text-center p-4",children:[w.jsx(Ul,{className:"h-10 w-10 mb-2 opacity-20"}),w.jsx("p",{className:"text-sm",children:"Nenhum produto encontrado para o perodo selecionado."})]})})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Motivos por Produto"}),w.jsx(Cr,{children:"5 produtos mais devolvidos do top 10 maiores motivos (Apenas LANADA)"})]}),w.jsx(jt,{children:D.length>0?w.jsx("div",{className:"rounded-md border",children:w.jsxs(Ba,{children:[w.jsx(Za,{children:w.jsxs(dr,{children:[w.jsx(Tt,{className:"text-[10px]",children:"Produto"}),w.jsx(Tt,{className:"text-[10px]",children:"Motivo"}),w.jsx(Tt,{className:"text-[10px] text-right",children:"Qtd"}),w.jsx(Tt,{className:"text-[10px] text-right",children:"Valor"})]})}),w.jsx(Ua,{children:D.map((ae,Q)=>w.jsxs(dr,{children:[w.jsx(Pt,{className:"text-[10px] font-medium",children:ae.produto.length>20?ae.produto.substring(0,20)+"...":ae.produto}),w.jsx(Pt,{className:"text-[10px]",children:ae.motivo.length>20?ae.motivo.substring(0,20)+"...":ae.motivo}),w.jsx(Pt,{className:"text-[10px] text-right",children:ae.quantidade.toFixed(2)}),w.jsxs(Pt,{className:"text-[10px] text-right",children:["R$ ",ae.valorTotal.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},Q))})]})}):w.jsx("div",{className:"text-center text-sm text-muted-foreground py-8",children:"Nenhum dado disponvel"})})]}),w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Motivos por Vendedor"}),w.jsx(Cr,{children:"5 motivos mais devolvidos por vendedor (Apenas LANADA)"})]}),w.jsx(jt,{children:F.length>0?w.jsx("div",{className:"rounded-md border",children:w.jsxs(Ba,{children:[w.jsx(Za,{children:w.jsxs(dr,{children:[w.jsx(Tt,{className:"text-[10px]",children:"Vendedor"}),w.jsx(Tt,{className:"text-[10px]",children:"Motivo"}),w.jsx(Tt,{className:"text-[10px] text-right",children:"Qtd"}),w.jsx(Tt,{className:"text-[10px] text-right",children:"Valor"})]})}),w.jsx(Ua,{children:F.map((ae,Q)=>w.jsxs(dr,{children:[w.jsx(Pt,{className:"text-[10px] font-medium",children:ae.vendedor.length>15?ae.vendedor.substring(0,15)+"...":ae.vendedor}),w.jsx(Pt,{className:"text-[10px]",children:ae.motivo.length>20?ae.motivo.substring(0,20)+"...":ae.motivo}),w.jsx(Pt,{className:"text-[10px] text-right",children:ae.quantidade}),w.jsxs(Pt,{className:"text-[10px] text-right",children:["R$ ",ae.valorTotal.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},Q))})]})}):w.jsx("div",{className:"text-center text-sm text-muted-foreground py-8",children:"Nenhum dado disponvel"})})]}),w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Motivos por Setor"}),w.jsx(Cr,{children:"Top 5 motivos mais devolvidos por setor (Apenas LANADA)"})]}),w.jsx(jt,{children:X.length>0?w.jsx("div",{className:"rounded-md border",children:w.jsxs(Ba,{children:[w.jsx(Za,{children:w.jsxs(dr,{children:[w.jsx(Tt,{className:"text-[10px]",children:"Setor"}),w.jsx(Tt,{className:"text-[10px]",children:"Motivo"}),w.jsx(Tt,{className:"text-[10px] text-right",children:"Qtd"}),w.jsx(Tt,{className:"text-[10px] text-right",children:"Valor"})]})}),w.jsx(Ua,{children:X.map((ae,Q)=>w.jsxs(dr,{children:[w.jsx(Pt,{className:"text-[10px] font-medium",children:ae.setor}),w.jsx(Pt,{className:"text-[10px]",children:ae.motivo.length>20?ae.motivo.substring(0,20)+"...":ae.motivo}),w.jsx(Pt,{className:"text-[10px] text-right",children:ae.quantidade}),w.jsxs(Pt,{className:"text-[10px] text-right",children:["R$ ",ae.valorTotal.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},Q))})]})}):w.jsx("div",{className:"text-center text-sm text-muted-foreground py-8",children:"Nenhum dado disponvel"})})]}),w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Motivos por Cliente"}),w.jsx(Cr,{children:"Top 5 motivos mais devolvidos do top 10 clientes (Apenas LANADA)"})]}),w.jsx(jt,{children:z.length>0?w.jsx("div",{className:"rounded-md border",children:w.jsxs(Ba,{children:[w.jsx(Za,{children:w.jsxs(dr,{children:[w.jsx(Tt,{className:"text-[10px]",children:"Cliente"}),w.jsx(Tt,{className:"text-[10px]",children:"Motivo"}),w.jsx(Tt,{className:"text-[10px] text-right",children:"Qtd"}),w.jsx(Tt,{className:"text-[10px] text-right",children:"Valor"})]})}),w.jsx(Ua,{children:z.map((ae,Q)=>w.jsxs(dr,{children:[w.jsx(Pt,{className:"text-[10px] font-medium",children:ae.cliente.length>20?ae.cliente.substring(0,20)+"...":ae.cliente}),w.jsx(Pt,{className:"text-[10px]",children:ae.motivo.length>20?ae.motivo.substring(0,20)+"...":ae.motivo}),w.jsx(Pt,{className:"text-[10px] text-right",children:ae.quantidade}),w.jsxs(Pt,{className:"text-[10px] text-right",children:["R$ ",ae.valorTotal.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},Q))})]})}):w.jsx("div",{className:"text-center text-sm text-muted-foreground py-8",children:"Nenhum dado disponvel"})})]})]})]})}const XN=$f("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),t_=Se.forwardRef(({className:t,variant:r,...e},a)=>w.jsx("div",{ref:a,role:"alert",className:Et(XN({variant:r}),t),...e}));t_.displayName="Alert";const r_=Se.forwardRef(({className:t,...r},e)=>w.jsx("div",{ref:e,className:Et("text-sm [&_p]:leading-relaxed",t),...r}));r_.displayName="AlertDescription";const KN=Se.forwardRef(({className:t,...r},e)=>w.jsx("h5",{ref:e,className:Et("mb-1 font-medium leading-none tracking-tight",t),...r}));KN.displayName="AlertTitle";function ZN(){const[t,r]=Se.useState(""),[e,a]=Se.useState(""),[n,o]=Se.useState(""),[s,l]=Se.useState(!0),[c,i]=Se.useState(!1),[u,p]=Se.useState(null),f=e8();Se.useEffect(()=>{(async()=>{const{data:{session:b}}=await St.auth.getSession();b!=null&&b.user&&f("/dashboard")})()},[f]);const h=async v=>{v.preventDefault(),i(!0),p(null);const b=t.trim();try{if(s){const{data:g,error:x}=await St.auth.signInWithPassword({email:b,password:e});if(x)throw x;g.user&&(console.log(" Login bem-sucedido!"),wt.success("Login realizado com sucesso!"),i(!1),setTimeout(()=>{f("/dashboard")},300))}else{const{data:g,error:x}=await St.auth.signUp({email:b,password:e,options:{data:{name:n}}});if(x)throw x;g.user&&(wt.success("Conta criada com sucesso! Voc j pode entrar."),g.session?f("/dashboard"):l(!0))}}catch(g){console.error(g);let x=g.message;x.includes("Invalid login credentials")?x="Usurio no encontrado ou senha incorreta.":x.includes("User already registered")&&(x="Este email j est cadastrado. Tente fazer login."),p(x),wt.error("Erro de Autenticao")}finally{i(!1)}};return w.jsxs("div",{className:"flex items-center justify-center min-h-screen bg-background relative overflow-hidden",children:[w.jsx("div",{className:"absolute w-full h-1/2 bg-primary/10 -skew-y-3 origin-top-left z-0"}),w.jsxs(Nt,{className:"w-full max-w-md z-10 border-t-4 border-t-primary shadow-2xl bg-card",children:[w.jsxs(Dt,{className:"text-center pb-2",children:[w.jsx("div",{className:"mx-auto mb-6 flex items-center justify-center",children:w.jsx("div",{className:"h-32 w-32 relative flex items-center justify-center bg-white rounded-full shadow-md p-3",children:w.jsx("img",{src:"https://i.ibb.co/zTq5KR0s/Chat-GPT-Image-26-de-dez-de-2025-19-10-20-removebg-preview.png",alt:"Logo Doce Mel",className:"object-contain h-full w-full",style:{backgroundColor:"unset",borderColor:"transparent",background:"unset",borderStyle:"none",borderImage:"none"}})})}),w.jsx("h1",{className:"text-2xl font-bold text-primary font-serif tracking-wide",children:"GRUPO DOCE MEL"}),w.jsx(Mt,{className:"text-lg font-medium text-foreground/80",children:"Gesto de Devolues"}),w.jsx(Cr,{children:s?"Entre com suas credenciais.":"Crie sua conta de Administrador."})]}),w.jsxs("form",{onSubmit:h,children:[w.jsxs(jt,{className:"space-y-4",children:[u&&w.jsxs(t_,{variant:"destructive",children:[w.jsx(R2,{className:"h-4 w-4"}),w.jsx(r_,{children:u})]}),!s&&w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{htmlFor:"name",children:"Nome Completo"}),w.jsx(_r,{id:"name",placeholder:"Ex: Obedys",value:n,onChange:v=>o(v.target.value),required:!s})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{htmlFor:"email",children:"Email"}),w.jsx(_r,{id:"email",type:"email",placeholder:"email@exemplo.com",value:t,onChange:v=>r(v.target.value),required:!0})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{htmlFor:"password",children:"Senha"}),w.jsx(_r,{id:"password",type:"password",value:e,onChange:v=>a(v.target.value),required:!0})]})]}),w.jsxs(T2,{className:"flex flex-col gap-4 bg-muted/20 pt-6",children:[w.jsxs(Ot,{type:"submit",className:"w-full font-bold text-md h-11",disabled:c,children:[c&&w.jsx(oi,{className:"mr-2 h-4 w-4 animate-spin"}),s?"ENTRAR":"CRIAR CONTA"]}),w.jsx(Ot,{type:"button",variant:"link",onClick:()=>{l(!s),p(null)},children:s?"No possui acesso? Solicite aqui":"J possui conta? Voltar ao login"})]})]})]}),w.jsx("div",{className:"absolute bottom-4 text-center text-xs text-muted-foreground opacity-50",children:" 2025 Grupo Doce Mel."})]})}const a_=H5,Pm=Se.forwardRef(({className:t,...r},e)=>w.jsx($5,{ref:e,className:Et("border-b",t),...r}));Pm.displayName="AccordionItem";const Lm=Se.forwardRef(({className:t,children:r,...e},a)=>w.jsx(V5,{className:"flex",children:w.jsxs(l2,{ref:a,className:Et("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180",t),...e,children:[r,w.jsx(zu,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})}));Lm.displayName=l2.displayName;const Bm=Se.forwardRef(({className:t,children:r,...e},a)=>w.jsx(c2,{ref:a,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...e,children:w.jsx("div",{className:Et("pb-4 pt-0",t),children:r})}));Bm.displayName=c2.displayName;const ri=G5,JN=Y5,QN=q5,n_=Se.forwardRef(({className:t,...r},e)=>w.jsx(u2,{ref:e,className:Et("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r}));n_.displayName=u2.displayName;const As=Se.forwardRef(({className:t,children:r,...e},a)=>w.jsxs(QN,{children:[w.jsx(n_,{}),w.jsxs(d2,{ref:a,className:Et("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e,children:[r,w.jsxs(W5,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[w.jsx(Vf,{className:"h-4 w-4"}),w.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));As.displayName=d2.displayName;const Cs=({className:t,...r})=>w.jsx("div",{className:Et("flex flex-col space-y-1.5 text-center sm:text-left",t),...r});Cs.displayName="DialogHeader";const Ns=({className:t,...r})=>w.jsx("div",{className:Et("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r});Ns.displayName="DialogFooter";const js=Se.forwardRef(({className:t,...r},e)=>w.jsx(f2,{ref:e,className:Et("text-lg font-semibold leading-none tracking-tight",t),...r}));js.displayName=f2.displayName;const Os=Se.forwardRef(({className:t,...r},e)=>w.jsx(h2,{ref:e,className:Et("text-sm text-muted-foreground",t),...r}));Os.displayName=h2.displayName;function ff(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var vp={exports:{}};/*! ExcelJS 19-10-2023 */var Hx;function ej(){return Hx||(Hx=1,function(t,r){(function(e){t.exports=e()})(function(){return function e(a,n,o){function s(i,u){if(!n[i]){if(!a[i]){var p=typeof ff=="function"&&ff;if(!u&&p)return p(i,!0);if(l)return l(i,!0);var f=new Error("Cannot find module '"+i+"'");throw f.code="MODULE_NOT_FOUND",f}var h=n[i]={exports:{}};a[i][0].call(h.exports,function(v){return s(a[i][1][v]||v)},h,h.exports,e,a,n,o)}return n[i].exports}for(var l=typeof ff=="function"&&ff,c=0;c<o.length;c++)s(o[c]);return s}({1:[function(e,a,n){const o=e("fs"),s=e("fast-csv"),l=e("dayjs/plugin/customParseFormat"),c=e("dayjs/plugin/utc"),i=e("dayjs").extend(l).extend(c),u=e("../utils/stream-buf"),{fs:{exists:p}}=e("../utils/utils"),f={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}};a.exports=class{constructor(h){this.workbook=h,this.worksheet=null}async readFile(h,v){if(v=v||{},!await p(h))throw new Error("File not found: "+h);const b=o.createReadStream(h),g=await this.read(b,v);return b.close(),g}read(h,v){return v=v||{},new Promise((b,g)=>{const x=this.workbook.addWorksheet(v.sheetName),y=v.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],E=v.map||function(I){if(I==="")return null;const P=Number(I);if(!Number.isNaN(P)&&P!==1/0)return P;const V=y.reduce((H,G)=>{if(H)return H;const Z=i(I,G,!0);return Z.isValid()?Z:null},null);if(V)return new Date(V.valueOf());const U=f[I];return U!==void 0?U:I},N=s.parse(v.parserOptions).on("data",I=>{x.addRow(I.map(E))}).on("end",()=>{N.emit("worksheet",x)});N.on("worksheet",b).on("error",g),h.pipe(N)})}createInputStream(){throw new Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(h,v){return new Promise((b,g)=>{v=v||{};const x=this.workbook.getWorksheet(v.sheetName||v.sheetId),y=s.format(v.formatterOptions);h.on("finish",()=>{b()}),y.on("error",g),y.pipe(h);const{dateFormat:E,dateUTC:N}=v,I=v.map||(U=>{if(U){if(U.text||U.hyperlink)return U.hyperlink||U.text||"";if(U.formula||U.result)return U.result||"";if(U instanceof Date)return E?N?i.utc(U).format(E):i(U).format(E):N?i.utc(U).format():i(U).format();if(U.error)return U.error;if(typeof U=="object")return JSON.stringify(U)}return U}),P=v.includeEmptyRows===void 0||v.includeEmptyRows;let V=1;x&&x.eachRow((U,H)=>{if(P)for(;V++<H-1;)y.write([]);const{values:G}=U;G.shift(),y.write(G.map(I)),V=H}),y.end()})}writeFile(h,v){const b={encoding:(v=v||{}).encoding||"utf8"},g=o.createWriteStream(h,b);return this.write(g,v)}async writeBuffer(h){const v=new u;return await this.write(v,h),v.read()}}},{"../utils/stream-buf":24,"../utils/utils":27,dayjs:391,"dayjs/plugin/customParseFormat":392,"dayjs/plugin/utc":393,"fast-csv":424,fs:216}],2:[function(e,a,n){const o=e("../utils/col-cache");class s{constructor(c,i){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(this.worksheet=c,i)if(typeof i=="string"){const p=o.decodeAddress(i);this.nativeCol=p.col+u,this.nativeColOff=0,this.nativeRow=p.row+u,this.nativeRowOff=0}else i.nativeCol!==void 0?(this.nativeCol=i.nativeCol||0,this.nativeColOff=i.nativeColOff||0,this.nativeRow=i.nativeRow||0,this.nativeRowOff=i.nativeRowOff||0):i.col!==void 0?(this.col=i.col+u,this.row=i.row+u):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0);else this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0}static asInstance(c){return c instanceof s||c==null?c:new s(c)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(c){this.nativeCol=Math.floor(c),this.nativeColOff=Math.floor((c-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(c){this.nativeRow=Math.floor(c),this.nativeRowOff=Math.floor((c-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(1e4*this.worksheet.getColumn(this.nativeCol+1).width):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(1e4*this.worksheet.getRow(this.nativeRow+1).height):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(c){this.nativeCol=c.nativeCol,this.nativeColOff=c.nativeColOff,this.nativeRow=c.nativeRow,this.nativeRowOff=c.nativeRowOff}}a.exports=s},{"../utils/col-cache":19}],3:[function(e,a,n){const o=e("../utils/col-cache"),s=e("../utils/under-dash"),l=e("./enums"),{slideFormula:c}=e("../utils/shared-formula"),i=e("./note");class u{constructor(h,v,b){if(!h||!v)throw new Error("A Cell needs a Row");this._row=h,this._column=v,o.validateAddress(b),this._address=b,this._value=p.create(u.Types.Null,this),this.style=this._mergeStyle(h.style,v.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(h){this.style.numFmt=h}get font(){return this.style.font}set font(h){this.style.font=h}get alignment(){return this.style.alignment}set alignment(h){this.style.alignment=h}get border(){return this.style.border}set border(h){this.style.border=h}get fill(){return this.style.fill}set fill(h){this.style.fill=h}get protection(){return this.style.protection}set protection(h){this.style.protection=h}_mergeStyle(h,v,b){const g=h&&h.numFmt||v&&v.numFmt;g&&(b.numFmt=g);const x=h&&h.font||v&&v.font;x&&(b.font=x);const y=h&&h.alignment||v&&v.alignment;y&&(b.alignment=y);const E=h&&h.border||v&&v.border;E&&(b.border=E);const N=h&&h.fill||v&&v.fill;N&&(b.fill=N);const I=h&&h.protection||v&&v.protection;return I&&(b.protection=I),b}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return`$${this._column.letter}$${this.row}`}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===u.Types.Merge}merge(h,v){this._value.release(),this._value=p.create(u.Types.Merge,this,h),v||(this.style=h.style)}unmerge(){this.type===u.Types.Merge&&(this._value.release(),this._value=p.create(u.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(h){return this._value.type===u.Types.Merge&&this._value.isMergedTo(h)}get master(){return this.type===u.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===u.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(h){this.type!==u.Types.Merge?(this._value.release(),this._value=p.create(p.getType(h),this,h)):this._value.master.value=h}get note(){return this._comment&&this._comment.note}set note(h){this._comment=new i(h)}get text(){return this._value.toString()}get html(){return s.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(h){this.type===u.Types.String&&(this._value=p.create(u.Types.Hyperlink,this,{text:this._value.value,hyperlink:h}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){const{worksheet:h}=this._row;return{sheetName:h.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(h){this.names=[h]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(h){const{definedNames:v}=this.workbook;v.removeAllNames(this.fullAddress),h.forEach(b=>{v.addEx(this.fullAddress,b)})}addName(h){this.workbook.definedNames.addEx(this.fullAddress,h)}removeName(h){this.workbook.definedNames.removeEx(this.fullAddress,h)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(h){this._dataValidations.add(this.address,h)}get model(){const{model:h}=this._value;return h.style=this.style,this._comment&&(h.comment=this._comment.model),h}set model(h){if(this._value.release(),this._value=p.create(h.type,this),this._value.model=h,h.comment)switch(h.comment.type){case"note":this._comment=i.fromModel(h.comment)}h.style?this.style=h.style:this.style={}}}u.Types=l.ValueType;const p={getType:f=>f==null?u.Types.Null:f instanceof String||typeof f=="string"?u.Types.String:typeof f=="number"?u.Types.Number:typeof f=="boolean"?u.Types.Boolean:f instanceof Date?u.Types.Date:f.text&&f.hyperlink?u.Types.Hyperlink:f.formula||f.sharedFormula?u.Types.Formula:f.richText?u.Types.RichText:f.sharedString?u.Types.SharedString:f.error?u.Types.Error:u.Types.JSON,types:[{t:u.Types.Null,f:class{constructor(f){this.model={address:f.address,type:u.Types.Null}}get value(){return null}set value(f){}get type(){return u.Types.Null}get effectiveType(){return u.Types.Null}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return""}release(){}toString(){return""}}},{t:u.Types.Number,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Number,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Number}get effectiveType(){return u.Types.Number}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.String,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.String,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.String}get effectiveType(){return u.Types.String}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return`"${this.model.value.replace(/"/g,'""')}"`}release(){}toString(){return this.model.value}}},{t:u.Types.Date,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Date,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Date}get effectiveType(){return u.Types.Date}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.Hyperlink,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Hyperlink,text:h?h.text:void 0,hyperlink:h?h.hyperlink:void 0},h&&h.tooltip&&(this.model.tooltip=h.tooltip)}get value(){const f={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(f.tooltip=this.model.tooltip),f}set value(f){this.model={text:f.text,hyperlink:f.hyperlink},f.tooltip&&(this.model.tooltip=f.tooltip)}get text(){return this.model.text}set text(f){this.model.text=f}get hyperlink(){return this.model.hyperlink}set hyperlink(f){this.model.hyperlink=f}get type(){return u.Types.Hyperlink}get effectiveType(){return u.Types.Hyperlink}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}}},{t:u.Types.Formula,f:class{constructor(f,h){this.cell=f,this.model={address:f.address,type:u.Types.Formula,shareType:h?h.shareType:void 0,ref:h?h.ref:void 0,formula:h?h.formula:void 0,sharedFormula:h?h.sharedFormula:void 0,result:h?h.result:void 0}}_copyModel(f){const h={},v=b=>{const g=f[b];g&&(h[b]=g)};return v("formula"),v("result"),v("ref"),v("shareType"),v("sharedFormula"),h}get value(){return this._copyModel(this.model)}set value(f){this.model=this._copyModel(f)}validate(f){switch(p.getType(f)){case u.Types.Null:case u.Types.String:case u.Types.Number:case u.Types.Date:break;case u.Types.Hyperlink:case u.Types.Formula:default:throw new Error("Cannot process that type of result value")}}get dependencies(){return{ranges:this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),cells:this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g)}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(f){this.model.formula=f}get formulaType(){return this.model.formula?l.FormulaType.Master:this.model.sharedFormula?l.FormulaType.Shared:l.FormulaType.None}get result(){return this.model.result}set result(f){this.model.result=f}get type(){return u.Types.Formula}get effectiveType(){const f=this.model.result;return f==null?l.ValueType.Null:f instanceof String||typeof f=="string"?l.ValueType.String:typeof f=="number"?l.ValueType.Number:f instanceof Date?l.ValueType.Date:f.text&&f.hyperlink?l.ValueType.Hyperlink:f.formula?l.ValueType.Formula:l.ValueType.Null}get address(){return this.model.address}set address(f){this.model.address=f}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){const{worksheet:f}=this.cell,h=f.findCell(this.model.sharedFormula);this._translatedFormula=h&&c(h.formula,h.address,this.model.address)}return this._translatedFormula}toCsvString(){return""+(this.model.result||"")}release(){}toString(){return this.model.result?this.model.result.toString():""}}},{t:u.Types.Merge,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Merge,master:h?h.address:void 0},this._master=h,h&&h.addMergeRef()}get value(){return this._master.value}set value(f){f instanceof u?(this._master&&this._master.releaseMergeRef(),f.addMergeRef(),this._master=f):this._master.value=f}isMergedTo(f){return f===this._master}get master(){return this._master}get type(){return u.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}}},{t:u.Types.JSON,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.String,value:JSON.stringify(h),rawValue:h}}get value(){return this.model.rawValue}set value(f){this.model.rawValue=f,this.model.value=JSON.stringify(f)}get type(){return u.Types.String}get effectiveType(){return u.Types.String}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}}},{t:u.Types.SharedString,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.SharedString,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.SharedString}get effectiveType(){return u.Types.SharedString}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.RichText,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.String,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}toString(){return this.model.value.richText.map(f=>f.text).join("")}get type(){return u.Types.RichText}get effectiveType(){return u.Types.RichText}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return`"${this.text.replace(/"/g,'""')}"`}release(){}}},{t:u.Types.Boolean,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Boolean,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Boolean}get effectiveType(){return u.Types.Boolean}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.Error,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Error,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Error}get effectiveType(){return u.Types.Error}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}}}].reduce((f,h)=>(f[h.t]=h.f,f),[]),create(f,h,v){const b=this.types[f];if(!b)throw new Error("Could not create Value of type "+f);return new b(h,v)}};a.exports=u},{"../utils/col-cache":19,"../utils/shared-formula":23,"../utils/under-dash":26,"./enums":7,"./note":9}],4:[function(e,a,n){const o=e("../utils/under-dash"),s=e("./enums"),l=e("../utils/col-cache");class c{constructor(u,p,f){this._worksheet=u,this._number=p,f!==!1&&(this.defn=f)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return l.n2l(this._number)}get isCustomWidth(){return this.width!==void 0&&this.width!==9}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(u){u?(this.key=u.key,this.width=u.width!==void 0?u.width:9,this.outlineLevel=u.outlineLevel,u.style?this.style=u.style:this.style={},this.header=u.header,this._hidden=!!u.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(u){u!==void 0?(this._header=u,this.headers.forEach((p,f)=>{this._worksheet.getCell(f+1,this.number).value=p})):this._header=void 0}get key(){return this._key}set key(u){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=u,u&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(u){this._hidden=u}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(u){this._outlineLevel=u}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(u){return this.width===u.width&&this.hidden===u.hidden&&this.outlineLevel===u.outlineLevel&&o.isEqual(this.style,u.style)}get isDefault(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;const u=this.style;return!u||!(u.font||u.numFmt||u.alignment||u.border||u.fill||u.protection)}get headerCount(){return this.headers.length}eachCell(u,p){const f=this.number;p||(p=u,u=null),this._worksheet.eachRow(u,(h,v)=>{p(h.getCell(f),v)})}get values(){const u=[];return this.eachCell((p,f)=>{p&&p.type!==s.ValueType.Null&&(u[f]=p.value)}),u}set values(u){if(!u)return;const p=this.number;let f=0;u.hasOwnProperty("0")&&(f=1),u.forEach((h,v)=>{this._worksheet.getCell(v+f,p).value=h})}_applyStyle(u,p){return this.style[u]=p,this.eachCell(f=>{f[u]=p}),p}get numFmt(){return this.style.numFmt}set numFmt(u){this._applyStyle("numFmt",u)}get font(){return this.style.font}set font(u){this._applyStyle("font",u)}get alignment(){return this.style.alignment}set alignment(u){this._applyStyle("alignment",u)}get protection(){return this.style.protection}set protection(u){this._applyStyle("protection",u)}get border(){return this.style.border}set border(u){this._applyStyle("border",u)}get fill(){return this.style.fill}set fill(u){this._applyStyle("fill",u)}static toModel(u){const p=[];let f=null;return u&&u.forEach((h,v)=>{h.isDefault?f&&(f=null):f&&h.equivalentTo(f)?f.max=v+1:(f={min:v+1,max:v+1,width:h.width!==void 0?h.width:9,style:h.style,isCustomWidth:h.isCustomWidth,hidden:h.hidden,outlineLevel:h.outlineLevel,collapsed:h.collapsed},p.push(f))}),p.length?p:void 0}static fromModel(u,p){const f=[];let h=1,v=0;for(p=(p=p||[]).sort(function(b,g){return b.min-g.min});v<p.length;){const b=p[v++];for(;h<b.min;)f.push(new c(u,h++));for(;h<=b.max;)f.push(new c(u,h++,b))}return f.length?f:null}}a.exports=c},{"../utils/col-cache":19,"../utils/under-dash":26,"./enums":7}],5:[function(e,a,n){a.exports=class{constructor(o){this.model=o||{}}add(o,s){return this.model[o]=s}find(o){return this.model[o]}remove(o){this.model[o]=void 0}}},{}],6:[function(e,a,n){const o=e("../utils/under-dash"),s=e("../utils/col-cache"),l=e("../utils/cell-matrix"),c=e("./range"),i=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/;a.exports=class{constructor(){this.matrixMap={}}getMatrix(u){return this.matrixMap[u]||(this.matrixMap[u]=new l)}add(u,p){const f=s.decodeEx(u);this.addEx(f,p)}addEx(u,p){const f=this.getMatrix(p);if(u.top)for(let h=u.left;h<=u.right;h++)for(let v=u.top;v<=u.bottom;v++){const b={sheetName:u.sheetName,address:s.n2l(h)+v,row:v,col:h};f.addCellEx(b)}else f.addCellEx(u)}remove(u,p){const f=s.decodeEx(u);this.removeEx(f,p)}removeEx(u,p){this.getMatrix(p).removeCellEx(u)}removeAllNames(u){o.each(this.matrixMap,p=>{p.removeCellEx(u)})}forEach(u){o.each(this.matrixMap,(p,f)=>{p.forEach(h=>{u(f,h)})})}getNames(u){return this.getNamesEx(s.decodeEx(u))}getNamesEx(u){return o.map(this.matrixMap,(p,f)=>p.findCellEx(u)&&f).filter(Boolean)}_explore(u,p){p.mark=!1;const{sheetName:f}=p,h=new c(p.row,p.col,p.row,p.col,f);let v,b;function g(y,E){const N=u.findCellAt(f,y,p.col);return!(!N||!N.mark)&&(h[E]=y,N.mark=!1,!0)}for(b=p.row-1;g(b,"top");b--);for(b=p.row+1;g(b,"bottom");b++);function x(y,E){const N=[];for(b=h.top;b<=h.bottom;b++){const I=u.findCellAt(f,b,y);if(!I||!I.mark)return!1;N.push(I)}h[E]=y;for(let I=0;I<N.length;I++)N[I].mark=!1;return!0}for(v=p.col-1;x(v,"left");v--);for(v=p.col+1;x(v,"right");v++);return h}getRanges(u,p){return(p=p||this.matrixMap[u])?(p.forEach(f=>{f.mark=!0}),{name:u,ranges:p.map(f=>f.mark&&this._explore(p,f)).filter(Boolean).map(f=>f.$shortRange)}):{name:u,ranges:[]}}normaliseMatrix(u,p){u.forEachInSheet(p,(f,h,v)=>{f&&(f.row===h&&f.col===v||(f.row=h,f.col=v,f.address=s.n2l(v)+h))})}spliceRows(u,p,f,h){o.each(this.matrixMap,v=>{v.spliceRows(u,p,f,h),this.normaliseMatrix(v,u)})}spliceColumns(u,p,f,h){o.each(this.matrixMap,v=>{v.spliceColumns(u,p,f,h),this.normaliseMatrix(v,u)})}get model(){return o.map(this.matrixMap,(u,p)=>this.getRanges(p,u)).filter(u=>u.ranges.length)}set model(u){const p=this.matrixMap={};u.forEach(f=>{const h=p[f.name]=new l;f.ranges.forEach(v=>{i.test(v.split("!").pop()||"")&&h.addCell(v)})})}}},{"../utils/cell-matrix":18,"../utils/col-cache":19,"../utils/under-dash":26,"./range":10}],7:[function(e,a,n){a.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}},{}],8:[function(e,a,n){const o=e("../utils/col-cache"),s=e("./anchor");a.exports=class{constructor(l,c){this.worksheet=l,this.model=c}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw new Error("Invalid Image Type")}}set model(l){let{type:c,imageId:i,range:u,hyperlinks:p}=l;if(this.type=c,this.imageId=i,c==="image")if(typeof u=="string"){const f=o.decode(u);this.range={tl:new s(this.worksheet,{col:f.left,row:f.top},-1),br:new s(this.worksheet,{col:f.right,row:f.bottom},0),editAs:"oneCell"}}else this.range={tl:new s(this.worksheet,u.tl,0),br:u.br&&new s(this.worksheet,u.br,0),ext:u.ext,editAs:u.editAs,hyperlinks:p||u.hyperlinks}}}},{"../utils/col-cache":19,"./anchor":2}],9:[function(e,a,n){const o=e("../utils/under-dash");class s{constructor(c){this.note=c}get model(){let c=null;switch(typeof this.note){case"string":c={type:"note",note:{texts:[{text:this.note}]}};break;default:c={type:"note",note:this.note}}return o.deepMerge({},s.DEFAULT_CONFIGS,c)}set model(c){const{note:i}=c,{texts:u}=i;u.length===1&&Object.keys(u[0]).length===1?this.note=u[0].text:this.note=i}static fromModel(c){const i=new s;return i.model=c,i}}s.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},a.exports=s},{"../utils/under-dash":26}],10:[function(e,a,n){const o=e("../utils/col-cache");class s{constructor(){this.decode(arguments)}setTLBR(c,i,u,p,f){if(arguments.length<4){const h=o.decodeAddress(c),v=o.decodeAddress(i);this.model={top:Math.min(h.row,v.row),left:Math.min(h.col,v.col),bottom:Math.max(h.row,v.row),right:Math.max(h.col,v.col),sheetName:u},this.setTLBR(h.row,h.col,v.row,v.col,f)}else this.model={top:Math.min(c,u),left:Math.min(i,p),bottom:Math.max(c,u),right:Math.max(i,p),sheetName:f}}decode(c){switch(c.length){case 5:this.setTLBR(c[0],c[1],c[2],c[3],c[4]);break;case 4:this.setTLBR(c[0],c[1],c[2],c[3]);break;case 3:this.setTLBR(c[0],c[1],c[2]);break;case 2:this.setTLBR(c[0],c[1]);break;case 1:{const i=c[0];if(i instanceof s)this.model={top:i.model.top,left:i.model.left,bottom:i.model.bottom,right:i.model.right,sheetName:i.sheetName};else if(i instanceof Array)this.decode(i);else if(i.top&&i.left&&i.bottom&&i.right)this.model={top:i.top,left:i.left,bottom:i.bottom,right:i.right,sheetName:i.sheetName};else{const u=o.decodeEx(i);u.top?this.model={top:u.top,left:u.left,bottom:u.bottom,right:u.right,sheetName:u.sheetName}:this.model={top:u.row,left:u.col,bottom:u.row,right:u.col,sheetName:u.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error("Invalid number of arguments to _getDimensions() - "+c.length)}}get top(){return this.model.top||1}set top(c){this.model.top=c}get left(){return this.model.left||1}set left(c){this.model.left=c}get bottom(){return this.model.bottom||1}set bottom(c){this.model.bottom=c}get right(){return this.model.right||1}set right(c){this.model.right=c}get sheetName(){return this.model.sheetName}set sheetName(c){this.model.sheetName=c}get _serialisedSheetName(){const{sheetName:c}=this.model;return c?/^[a-zA-Z0-9]*$/.test(c)?c+"!":`'${c}'!`:""}expand(c,i,u,p){(!this.model.top||c<this.top)&&(this.top=c),(!this.model.left||i<this.left)&&(this.left=i),(!this.model.bottom||u>this.bottom)&&(this.bottom=u),(!this.model.right||p>this.right)&&(this.right=p)}expandRow(c){if(c){const{dimensions:i,number:u}=c;i&&this.expand(u,i.min,u,i.max)}}expandToAddress(c){const i=o.decodeEx(c);this.expand(i.row,i.col,i.row,i.col)}get tl(){return o.n2l(this.left)+this.top}get $t$l(){return`$${o.n2l(this.left)}$${this.top}`}get br(){return o.n2l(this.right)+this.bottom}get $b$r(){return`$${o.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(c){return(!c.sheetName||!this.sheetName||c.sheetName===this.sheetName)&&!(c.bottom<this.top)&&!(c.top>this.bottom)&&!(c.right<this.left)&&!(c.left>this.right)}contains(c){const i=o.decodeEx(c);return this.containsEx(i)}containsEx(c){return(!c.sheetName||!this.sheetName||c.sheetName===this.sheetName)&&c.row>=this.top&&c.row<=this.bottom&&c.col>=this.left&&c.col<=this.right}forEachAddress(c){for(let i=this.left;i<=this.right;i++)for(let u=this.top;u<=this.bottom;u++)c(o.encodeAddress(u,i),u,i)}}a.exports=s},{"../utils/col-cache":19}],11:[function(e,a,n){const o=e("../utils/under-dash"),s=e("./enums"),l=e("../utils/col-cache"),c=e("./cell");a.exports=class{constructor(i,u){this._worksheet=i,this._number=u,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(i){return this._cells[i-1]}getCellEx(i){let u=this._cells[i.col-1];if(!u){const p=this._worksheet.getColumn(i.col);u=new c(this,p,i.address),this._cells[i.col-1]=u}return u}getCell(i){if(typeof i=="string"){const u=this._worksheet.getColumnKey(i);i=u?u.number:l.l2n(i)}return this._cells[i-1]||this.getCellEx({address:l.encodeAddress(this._number,i),row:this._number,col:i})}splice(i,u){const p=i+u;for(var f=arguments.length,h=new Array(f>2?f-2:0),v=2;v<f;v++)h[v-2]=arguments[v];const b=h.length-u,g=this._cells.length;let x,y,E;if(b<0)for(x=i+h.length;x<=g;x++)E=this._cells[x-1],y=this._cells[x-b-1],y?(E=this.getCell(x),E.value=y.value,E.style=y.style,E._comment=y._comment):E&&(E.value=null,E.style={},E._comment=void 0);else if(b>0)for(x=g;x>=p;x--)y=this._cells[x-1],y?(E=this.getCell(x+b),E.value=y.value,E.style=y.style,E._comment=y._comment):this._cells[x+b-1]=void 0;for(x=0;x<h.length;x++)E=this.getCell(i+x),E.value=h[x],E.style={},E._comment=void 0}eachCell(i,u){if(u||(u=i,i=null),i&&i.includeEmpty){const p=this._cells.length;for(let f=1;f<=p;f++)u(this.getCell(f),f)}else this._cells.forEach((p,f)=>{p&&p.type!==s.ValueType.Null&&u(p,f+1)})}addPageBreak(i,u){const p=this._worksheet,f=Math.max(0,i-1)||0,h=Math.max(0,u-1)||16838,v={id:this._number,max:h,man:1};f&&(v.min=f),p.rowBreaks.push(v)}get values(){const i=[];return this._cells.forEach(u=>{u&&u.type!==s.ValueType.Null&&(i[u.col]=u.value)}),i}set values(i){if(this._cells=[],i)if(i instanceof Array){let u=0;i.hasOwnProperty("0")&&(u=1),i.forEach((p,f)=>{p!==void 0&&(this.getCellEx({address:l.encodeAddress(this._number,f+u),row:this._number,col:f+u}).value=p)})}else this._worksheet.eachColumnKey((u,p)=>{i[p]!==void 0&&(this.getCellEx({address:l.encodeAddress(this._number,u.number),row:this._number,col:u.number}).value=i[p])})}get hasValues(){return o.some(this._cells,i=>i&&i.type!==s.ValueType.Null)}get cellCount(){return this._cells.length}get actualCellCount(){let i=0;return this.eachCell(()=>{i++}),i}get dimensions(){let i=0,u=0;return this._cells.forEach(p=>{p&&p.type!==s.ValueType.Null&&((!i||i>p.col)&&(i=p.col),u<p.col&&(u=p.col))}),i>0?{min:i,max:u}:null}_applyStyle(i,u){return this.style[i]=u,this._cells.forEach(p=>{p&&(p[i]=u)}),u}get numFmt(){return this.style.numFmt}set numFmt(i){this._applyStyle("numFmt",i)}get font(){return this.style.font}set font(i){this._applyStyle("font",i)}get alignment(){return this.style.alignment}set alignment(i){this._applyStyle("alignment",i)}get protection(){return this.style.protection}set protection(i){this._applyStyle("protection",i)}get border(){return this.style.border}set border(i){this._applyStyle("border",i)}get fill(){return this.style.fill}set fill(i){this._applyStyle("fill",i)}get hidden(){return!!this._hidden}set hidden(i){this._hidden=i}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(i){this._outlineLevel=i}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){const i=[];let u=0,p=0;return this._cells.forEach(f=>{if(f){const h=f.model;h&&((!u||u>f.col)&&(u=f.col),p<f.col&&(p=f.col),i.push(h))}}),this.height||i.length?{cells:i,number:this.number,min:u,max:p,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(i){if(i.number!==this._number)throw new Error("Invalid row number in model");let u;this._cells=[],i.cells.forEach(p=>{switch(p.type){case c.Types.Merge:break;default:{let f;if(p.address)f=l.decodeAddress(p.address);else if(u){const{row:h}=u,v=u.col+1;f={row:h,col:v,address:l.encodeAddress(h,v),$col$row:`$${l.n2l(v)}$${h}`}}u=f,this.getCellEx(f).model=p;break}}}),i.height?this.height=i.height:delete this.height,this.hidden=i.hidden,this.outlineLevel=i.outlineLevel||0,this.style=i.style&&JSON.parse(JSON.stringify(i.style))||{}}}},{"../utils/col-cache":19,"../utils/under-dash":26,"./cell":3,"./enums":7}],12:[function(e,a,n){const o=e("../utils/col-cache");class s{constructor(c,i,u){this.table=c,this.column=i,this.index=u}_set(c,i){this.table.cacheState(),this.column[c]=i}get name(){return this.column.name}set name(c){this._set("name",c)}get filterButton(){return this.column.filterButton}set filterButton(c){this.column.filterButton=c}get style(){return this.column.style}set style(c){this.column.style=c}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(c){this._set("totalsRowLabel",c)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(c){this._set("totalsRowFunction",c)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(c){this._set("totalsRowResult",c)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(c){this._set("totalsRowFormula",c)}}a.exports=class{constructor(l,c){this.worksheet=l,c&&(this.table=c,this.validate(),this.store())}getFormula(l){switch(l.totalsRowFunction){case"none":return null;case"average":return`SUBTOTAL(101,${this.table.name}[${l.name}])`;case"countNums":return`SUBTOTAL(102,${this.table.name}[${l.name}])`;case"count":return`SUBTOTAL(103,${this.table.name}[${l.name}])`;case"max":return`SUBTOTAL(104,${this.table.name}[${l.name}])`;case"min":return`SUBTOTAL(105,${this.table.name}[${l.name}])`;case"stdDev":return`SUBTOTAL(106,${this.table.name}[${l.name}])`;case"var":return`SUBTOTAL(107,${this.table.name}[${l.name}])`;case"sum":return`SUBTOTAL(109,${this.table.name}[${l.name}])`;case"custom":return l.totalsRowFormula;default:throw new Error("Invalid Totals Row Function: "+l.totalsRowFunction)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){const{table:l}=this,c=(b,g,x)=>{b[g]===void 0&&(b[g]=x)};c(l,"headerRow",!0),c(l,"totalsRow",!1),c(l,"style",{}),c(l.style,"theme","TableStyleMedium2"),c(l.style,"showFirstColumn",!1),c(l.style,"showLastColumn",!1),c(l.style,"showRowStripes",!1),c(l.style,"showColumnStripes",!1);const i=(b,g)=>{if(!b)throw new Error(g)};i(l.ref,"Table must have ref"),i(l.columns,"Table must have column definitions"),i(l.rows,"Table must have row definitions"),l.tl=o.decodeAddress(l.ref);const{row:u,col:p}=l.tl;i(u>0,"Table must be on valid row"),i(p>0,"Table must be on valid col");const{width:f,filterHeight:h,tableHeight:v}=this;l.autoFilterRef=o.encode(u,p,u+h-1,p+f-1),l.tableRef=o.encode(u,p,u+v-1,p+f-1),l.columns.forEach((b,g)=>{i(b.name,`Column ${g} must have a name`),g===0?c(b,"totalsRowLabel","Total"):(c(b,"totalsRowFunction","none"),b.totalsRowFormula=this.getFormula(b))})}store(){const l=(h,v)=>{v&&Object.keys(v).forEach(b=>{h[b]=v[b]})},{worksheet:c,table:i}=this,{row:u,col:p}=i.tl;let f=0;if(i.headerRow){const h=c.getRow(u+f++);i.columns.forEach((v,b)=>{const{style:g,name:x}=v,y=h.getCell(p+b);y.value=x,l(y,g)})}if(i.rows.forEach(h=>{const v=c.getRow(u+f++);h.forEach((b,g)=>{const x=v.getCell(p+g);x.value=b,l(x,i.columns[g].style)})}),i.totalsRow){const h=c.getRow(u+f++);i.columns.forEach((v,b)=>{const g=h.getCell(p+b);if(b===0)g.value=v.totalsRowLabel;else{const x=this.getFormula(v);g.value=x?{formula:v.totalsRowFormula,result:v.totalsRowResult}:null}l(g,v.style)})}}load(l){const{table:c}=this,{row:i,col:u}=c.tl;let p=0;if(c.headerRow){const f=l.getRow(i+p++);c.columns.forEach((h,v)=>{f.getCell(u+v).value=h.name})}if(c.rows.forEach(f=>{const h=l.getRow(i+p++);f.forEach((v,b)=>{h.getCell(u+b).value=v})}),c.totalsRow){const f=l.getRow(i+p++);c.columns.forEach((h,v)=>{const b=f.getCell(u+v);v===0?b.value=h.totalsRowLabel:this.getFormula(h)&&(b.value={formula:h.totalsRowFormula,result:h.totalsRowResult})})}}get model(){return this.table}set model(l){this.table=l}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();const l=o.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let c=0;c<this._cache.tableHeight;c++){const i=this.worksheet.getRow(l.row+c);for(let u=0;u<this._cache.width;u++)i.getCell(l.col+u).value=null}else{for(let c=this.tableHeight;c<this._cache.tableHeight;c++){const i=this.worksheet.getRow(l.row+c);for(let u=0;u<this._cache.width;u++)i.getCell(l.col+u).value=null}for(let c=0;c<this.tableHeight;c++){const i=this.worksheet.getRow(l.row+c);for(let u=this.width;u<this._cache.width;u++)i.getCell(l.col+u).value=null}}this.store()}addRow(l,c){this.cacheState(),c===void 0?this.table.rows.push(l):this.table.rows.splice(c,0,l)}removeRows(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.rows.splice(l,c)}getColumn(l){const c=this.table.columns[l];return new s(this,c,l)}addColumn(l,c,i){this.cacheState(),i===void 0?(this.table.columns.push(l),this.table.rows.forEach((u,p)=>{u.push(c[p])})):(this.table.columns.splice(i,0,l),this.table.rows.forEach((u,p)=>{u.splice(i,0,c[p])}))}removeColumns(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.columns.splice(l,c),this.table.rows.forEach(i=>{i.splice(l,c)})}_assign(l,c,i){this.cacheState(),l[c]=i}get ref(){return this.table.ref}set ref(l){this._assign(this.table,"ref",l)}get name(){return this.table.name}set name(l){this.table.name=l}get displayName(){return this.table.displyName||this.table.name}set displayNamename(l){this.table.displayName=l}get headerRow(){return this.table.headerRow}set headerRow(l){this._assign(this.table,"headerRow",l)}get totalsRow(){return this.table.totalsRow}set totalsRow(l){this._assign(this.table,"totalsRow",l)}get theme(){return this.table.style.name}set theme(l){this.table.style.name=l}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(l){this.table.style.showFirstColumn=l}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(l){this.table.style.showLastColumn=l}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(l){this.table.style.showRowStripes=l}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(l){this.table.style.showColumnStripes=l}}},{"../utils/col-cache":19}],13:[function(e,a,n){const o=e("./worksheet"),s=e("./defined-names"),l=e("../xlsx/xlsx"),c=e("../csv/csv");a.exports=class{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new s}get xlsx(){return this._xlsx||(this._xlsx=new l(this)),this._xlsx}get csv(){return this._csv||(this._csv=new c(this)),this._csv}get nextId(){for(let i=1;i<this._worksheets.length;i++)if(!this._worksheets[i])return i;return this._worksheets.length||1}addWorksheet(i,u){const p=this.nextId;u&&(typeof u=="string"?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),u={properties:{tabColor:{argb:u}}}):(u.argb||u.theme||u.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),u={properties:{tabColor:u}}));const f=this._worksheets.reduce((b,g)=>(g&&g.orderNo)>b?g.orderNo:b,0),h=Object.assign({},u,{id:p,name:i,orderNo:f+1,workbook:this}),v=new o(h);return this._worksheets[p]=v,v}removeWorksheetEx(i){delete this._worksheets[i.id]}removeWorksheet(i){const u=this.getWorksheet(i);u&&u.destroy()}getWorksheet(i){return i===void 0?this._worksheets.find(Boolean):typeof i=="number"?this._worksheets[i]:typeof i=="string"?this._worksheets.find(u=>u&&u.name===i):void 0}get worksheets(){return this._worksheets.slice(1).sort((i,u)=>i.orderNo-u.orderNo).filter(Boolean)}eachSheet(i){this.worksheets.forEach(u=>{i(u,u.id)})}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(i){const u=this.media.length;return this.media.push(Object.assign({},i,{type:"image"})),u}getImage(i){return this.media[i]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(i=>i.model),sheets:this.worksheets.map(i=>i.model).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(i){this.creator=i.creator,this.lastModifiedBy=i.lastModifiedBy,this.lastPrinted=i.lastPrinted,this.created=i.created,this.modified=i.modified,this.company=i.company,this.manager=i.manager,this.title=i.title,this.subject=i.subject,this.keywords=i.keywords,this.category=i.category,this.description=i.description,this.language=i.language,this.revision=i.revision,this.contentStatus=i.contentStatus,this.properties=i.properties,this.calcProperties=i.calcProperties,this._worksheets=[],i.worksheets.forEach(u=>{const{id:p,name:f,state:h}=u,v=i.sheets&&i.sheets.findIndex(b=>b.id===p);(this._worksheets[p]=new o({id:p,name:f,orderNo:v,state:h,workbook:this})).model=u}),this._definedNames.model=i.definedNames,this.views=i.views,this._themes=i.themes,this.media=i.media||[]}}},{"../csv/csv":1,"../xlsx/xlsx":144,"./defined-names":6,"./worksheet":14}],14:[function(e,a,n){const o=e("../utils/under-dash"),s=e("../utils/col-cache"),l=e("./range"),c=e("./row"),i=e("./column"),u=e("./enums"),p=e("./image"),f=e("./table"),h=e("./data-validations"),v=e("../utils/encryptor"),{copyStyle:b}=e("../utils/copy-style");a.exports=class{constructor(g){g=g||{},this._workbook=g.workbook,this.id=g.id,this.orderNo=g.orderNo,this.name=g.name,this.state=g.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},g.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!(!g.pageSetup||!g.pageSetup.fitToWidth&&!g.pageSetup.fitToHeight||g.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},g.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},g.headerFooter),this.dataValidations=new h,this.views=g.views||[],this.autoFilter=g.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get name(){return this._name}set name(g){if(g===void 0&&(g="sheet"+this.id),this._name!==g){if(typeof g!="string")throw new Error("The name has to be a string.");if(g==="")throw new Error("The name can't be empty.");if(g==="History")throw new Error('The name "History" is protected. Please use a different name.');if(/[*?:/\\[\]]/.test(g))throw new Error(`Worksheet name ${g} cannot include any of the following characters: * ? : \\ / [ ]`);if(/(^')|('$)/.test(g))throw new Error("The first or last character of worksheet name cannot be a single quotation mark: "+g);if(g&&g.length>31&&(console.warn(`Worksheet name ${g} exceeds 31 chars. This will be truncated`),g=g.substring(0,31)),this._workbook._worksheets.find(x=>x&&x.name.toLowerCase()===g.toLowerCase()))throw new Error("Worksheet name already exists: "+g);this._name=g}}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){const g=new l;return this._rows.forEach(x=>{if(x){const y=x.dimensions;y&&g.expand(x.number,y.min,x.number,y.max)}}),g}get columns(){return this._columns}set columns(g){this._headerRowCount=g.reduce((E,N)=>{const I=(N.header?1:N.headers&&N.headers.length)||0;return Math.max(E,I)},0);let x=1;const y=this._columns=[];g.forEach(E=>{const N=new i(this,x++,!1);y.push(N),N.defn=E})}getColumnKey(g){return this._keys[g]}setColumnKey(g,x){this._keys[g]=x}deleteColumnKey(g){delete this._keys[g]}eachColumnKey(g){o.each(this._keys,g)}getColumn(g){if(typeof g=="string"){const x=this._keys[g];if(x)return x;g=s.l2n(g)}if(this._columns||(this._columns=[]),g>this._columns.length){let x=this._columns.length+1;for(;x<=g;)this._columns.push(new i(this,x++))}return this._columns[g-1]}spliceColumns(g,x){const y=this._rows.length;for(var E=arguments.length,N=new Array(E>2?E-2:0),I=2;I<E;I++)N[I-2]=arguments[I];if(N.length>0)for(let H=0;H<y;H++){const G=[g,x];N.forEach(W=>{G.push(W[H]||null)});const Z=this.getRow(H+1);Z.splice.apply(Z,G)}else this._rows.forEach(H=>{H&&H.splice(g,x)});const P=N.length-x,V=g+x,U=this._columns.length;if(P<0)for(let H=g+N.length;H<=U;H++)this.getColumn(H).defn=this.getColumn(H-P).defn;else if(P>0)for(let H=U;H>=V;H--)this.getColumn(H+P).defn=this.getColumn(H).defn;for(let H=g;H<g+N.length;H++)this.getColumn(H).defn=null;this.workbook.definedNames.spliceColumns(this.name,g,x,N.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let g=0;return this.eachRow(x=>{g=Math.max(g,x.cellCount)}),g}get actualColumnCount(){const g=[];let x=0;return this.eachRow(y=>{y.eachCell(E=>{let{col:N}=E;g[N]||(g[N]=!0,x++)})}),x}_commitRow(){}get _lastRowNumber(){const g=this._rows;let x=g.length;for(;x>0&&g[x-1]===void 0;)x--;return x}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(g){return this._rows[g-1]}findRows(g,x){return this._rows.slice(g-1,g-1+x)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let g=0;return this.eachRow(()=>{g++}),g}getRow(g){let x=this._rows[g-1];return x||(x=this._rows[g-1]=new c(this,g)),x}getRows(g,x){if(x<1)return;const y=[];for(let E=g;E<g+x;E++)y.push(this.getRow(E));return y}addRow(g){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const y=this._nextRow,E=this.getRow(y);return E.values=g,this._setStyleOption(y,x[0]==="i"?x:"n"),E}addRows(g){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const y=[];return g.forEach(E=>{y.push(this.addRow(E,x))}),y}insertRow(g,x){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";return this.spliceRows(g,0,x),this._setStyleOption(g,y),this.getRow(g)}insertRows(g,x){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";if(this.spliceRows(g,0,...x),y!=="n")for(let E=0;E<x.length;E++)y[0]==="o"&&this.findRow(x.length+g+E)!==void 0?this._copyStyle(x.length+g+E,g+E,y[1]==="+"):y[0]==="i"&&this.findRow(g-1)!==void 0&&this._copyStyle(g-1,g+E,y[1]==="+");return this.getRows(g,x.length)}_setStyleOption(g){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";x[0]==="o"&&this.findRow(g+1)!==void 0?this._copyStyle(g+1,g,x[1]==="+"):x[0]==="i"&&this.findRow(g-1)!==void 0&&this._copyStyle(g-1,g,x[1]==="+")}_copyStyle(g,x){let y=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const E=this.getRow(g),N=this.getRow(x);N.style=b(E.style),E.eachCell({includeEmpty:y},(I,P)=>{N.getCell(P).style=b(I.style)}),N.height=E.height}duplicateRow(g,x){let y=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const E=this._rows[g-1],N=new Array(x).fill(E.values);this.spliceRows(g+1,y?0:x,...N);for(let I=0;I<x;I++){const P=this._rows[g+I];P.style=E.style,P.height=E.height,E.eachCell({includeEmpty:!0},(V,U)=>{P.getCell(U).style=V.style})}}spliceRows(g,x){const y=g+x;for(var E=arguments.length,N=new Array(E>2?E-2:0),I=2;I<E;I++)N[I-2]=arguments[I];const P=N.length,V=P-x,U=this._rows.length;let H,G;if(V<0)for(g===U&&(this._rows[U-1]=void 0),H=y;H<=U;H++)if(G=this._rows[H-1],G){const Z=this.getRow(H+V);Z.values=G.values,Z.style=G.style,Z.height=G.height,G.eachCell({includeEmpty:!0},(W,O)=>{Z.getCell(O).style=W.style}),this._rows[H-1]=void 0}else this._rows[H+V-1]=void 0;else if(V>0)for(H=U;H>=y;H--)if(G=this._rows[H-1],G){const Z=this.getRow(H+V);Z.values=G.values,Z.style=G.style,Z.height=G.height,G.eachCell({includeEmpty:!0},(W,O)=>{if(Z.getCell(O).style=W.style,W._value.constructor.name==="MergeValue"){const R=this.getRow(W._row._number+P).getCell(O),C=W._value._master,_=this.getRow(C._row._number+P).getCell(C._column._number);R.merge(_)}})}else this._rows[H+V-1]=void 0;for(H=0;H<P;H++){const Z=this.getRow(g+H);Z.style={},Z.values=N[H]}this.workbook.definedNames.spliceRows(this.name,g,x,P)}eachRow(g,x){if(x||(x=g,g=void 0),g&&g.includeEmpty){const y=this._rows.length;for(let E=1;E<=y;E++)x(this.getRow(E),E)}else this._rows.forEach(y=>{y&&y.hasValues&&x(y,y.number)})}getSheetValues(){const g=[];return this._rows.forEach(x=>{x&&(g[x.number]=x.values)}),g}findCell(g,x){const y=s.getAddress(g,x),E=this._rows[y.row-1];return E?E.findCell(y.col):void 0}getCell(g,x){const y=s.getAddress(g,x);return this.getRow(y.row).getCellEx(y)}mergeCells(){for(var g=arguments.length,x=new Array(g),y=0;y<g;y++)x[y]=arguments[y];const E=new l(x);this._mergeCellsInternal(E)}mergeCellsWithoutStyle(){for(var g=arguments.length,x=new Array(g),y=0;y<g;y++)x[y]=arguments[y];const E=new l(x);this._mergeCellsInternal(E,!0)}_mergeCellsInternal(g,x){o.each(this._merges,E=>{if(E.intersects(g))throw new Error("Cannot merge already merged cells")});const y=this.getCell(g.top,g.left);for(let E=g.top;E<=g.bottom;E++)for(let N=g.left;N<=g.right;N++)(E>g.top||N>g.left)&&this.getCell(E,N).merge(y,x);this._merges[y.address]=g}_unMergeMaster(g){const x=this._merges[g.address];if(x){for(let y=x.top;y<=x.bottom;y++)for(let E=x.left;E<=x.right;E++)this.getCell(y,E).unmerge();delete this._merges[g.address]}}get hasMerges(){return o.some(this._merges,Boolean)}unMergeCells(){for(var g=arguments.length,x=new Array(g),y=0;y<g;y++)x[y]=arguments[y];const E=new l(x);for(let N=E.top;N<=E.bottom;N++)for(let I=E.left;I<=E.right;I++){const P=this.findCell(N,I);P&&(P.type===u.ValueType.Merge?this._unMergeMaster(P.master):this._merges[P.address]&&this._unMergeMaster(P))}}fillFormula(g,x,y){let E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"shared";const N=s.decode(g),{top:I,left:P,bottom:V,right:U}=N,H=U-P+1,G=s.encodeAddress(I,P),Z=E==="shared";let W;W=typeof y=="function"?y:Array.isArray(y)?Array.isArray(y[0])?(R,C)=>y[R-I][C-P]:(R,C)=>y[(R-I)*H+(C-P)]:()=>{};let O=!0;for(let R=I;R<=V;R++)for(let C=P;C<=U;C++)O?(this.getCell(R,C).value={shareType:E,formula:x,ref:g,result:W(R,C)},O=!1):this.getCell(R,C).value=Z?{sharedFormula:G,result:W(R,C)}:W(R,C)}addImage(g,x){const y={type:"image",imageId:g,range:x};this._media.push(new p(this,y))}getImages(){return this._media.filter(g=>g.type==="image")}addBackgroundImage(g){const x={type:"background",imageId:g};this._media.push(new p(this,x))}getBackgroundImageId(){const g=this._media.find(x=>x.type==="background");return g&&g.imageId}protect(g,x){return new Promise(y=>{this.sheetProtection={sheet:!0},x&&"spinCount"in x&&(x.spinCount=Number.isFinite(x.spinCount)?Math.round(Math.max(0,x.spinCount)):1e5),g&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=v.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=x&&"spinCount"in x?x.spinCount:1e5,this.sheetProtection.hashValue=v.convertPasswordToHash(g,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),x&&(this.sheetProtection=Object.assign(this.sheetProtection,x),!g&&"spinCount"in x&&delete this.sheetProtection.spinCount),y()})}unprotect(){this.sheetProtection=null}addTable(g){const x=new f(this,g);return this.tables[g.name]=x,x}getTable(g){return this.tables[g]}removeTable(g){delete this.tables[g]}getTables(){return Object.values(this.tables)}addConditionalFormatting(g){this.conditionalFormattings.push(g)}removeConditionalFormatting(g){typeof g=="number"?this.conditionalFormattings.splice(g,1):this.conditionalFormattings=g instanceof Function?this.conditionalFormattings.filter(g):[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(g){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=g}get model(){const g={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(E=>E.model),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(E=>E.model),conditionalFormattings:this.conditionalFormattings};g.cols=i.toModel(this.columns);const x=g.rows=[],y=g.dimensions=new l;return this._rows.forEach(E=>{const N=E&&E.model;N&&(y.expand(N.number,N.min,N.number,N.max),x.push(N))}),g.merges=[],o.each(this._merges,E=>{g.merges.push(E.range)}),g}_parseRows(g){this._rows=[],g.rows.forEach(x=>{const y=new c(this,x.number);this._rows[y.number-1]=y,y.model=x})}_parseMergeCells(g){o.each(g.mergeCells,x=>{this.mergeCellsWithoutStyle(x)})}set model(g){this.name=g.name,this._columns=i.fromModel(this,g.cols),this._parseRows(g),this._parseMergeCells(g),this.dataValidations=new h(g.dataValidations),this.properties=g.properties,this.pageSetup=g.pageSetup,this.headerFooter=g.headerFooter,this.views=g.views,this.autoFilter=g.autoFilter,this._media=g.media.map(x=>new p(this,x)),this.sheetProtection=g.sheetProtection,this.tables=g.tables.reduce((x,y)=>{const E=new f;return E.model=y,x[y.name]=E,x},{}),this.conditionalFormattings=g.conditionalFormattings}}},{"../utils/col-cache":19,"../utils/copy-style":20,"../utils/encryptor":21,"../utils/under-dash":26,"./column":4,"./data-validations":5,"./enums":7,"./image":8,"./range":10,"./row":11,"./table":12}],15:[function(e,a,n){e("core-js/modules/es.promise"),e("core-js/modules/es.promise.finally"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.values"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.async-iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.find-index"),e("core-js/modules/es.array.find"),e("core-js/modules/es.string.from-code-point"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.number.is-nan"),e("regenerator-runtime/runtime");const o={Workbook:e("./doc/workbook")},s=e("./doc/enums");Object.keys(s).forEach(l=>{o[l]=s[l]}),a.exports=o},{"./doc/enums":7,"./doc/workbook":13,"core-js/modules/es.array.find":359,"core-js/modules/es.array.find-index":358,"core-js/modules/es.array.includes":360,"core-js/modules/es.array.iterator":361,"core-js/modules/es.number.is-nan":363,"core-js/modules/es.object.assign":364,"core-js/modules/es.object.keys":366,"core-js/modules/es.object.values":367,"core-js/modules/es.promise":372,"core-js/modules/es.promise.finally":371,"core-js/modules/es.string.from-code-point":376,"core-js/modules/es.string.includes":377,"core-js/modules/es.symbol":381,"core-js/modules/es.symbol.async-iterator":378,"regenerator-runtime/runtime":492}],16:[function(e,a,n){const o=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");n.bufferToString=function(s){return typeof s=="string"?s:o?o.decode(s):s.toString()}},{}],17:[function(e,a,n){const o=typeof TextEncoder>"u"?null:new TextEncoder("utf-8"),{Buffer:s}=e("buffer");n.stringToBuffer=function(l){return typeof l!="string"?l:o?s.from(o.encode(l).buffer):s.from(l)}},{buffer:220}],18:[function(e,a,n){const o=e("./under-dash"),s=e("./col-cache");a.exports=class{constructor(l){this.template=l,this.sheets={}}addCell(l){this.addCellEx(s.decodeEx(l))}getCell(l){return this.findCellEx(s.decodeEx(l),!0)}findCell(l){return this.findCellEx(s.decodeEx(l),!1)}findCellAt(l,c,i){const u=this.sheets[l],p=u&&u[c];return p&&p[i]}addCellEx(l){if(l.top)for(let c=l.top;c<=l.bottom;c++)for(let i=l.left;i<=l.right;i++)this.getCellAt(l.sheetName,c,i);else this.findCellEx(l,!0)}getCellEx(l){return this.findCellEx(l,!0)}findCellEx(l,c){const i=this.findSheet(l,c),u=this.findSheetRow(i,l,c);return this.findRowCell(u,l,c)}getCellAt(l,c,i){const u=this.sheets[l]||(this.sheets[l]=[]),p=u[c]||(u[c]=[]);return p[i]||(p[i]={sheetName:l,address:s.n2l(i)+c,row:c,col:i})}removeCellEx(l){const c=this.findSheet(l);if(!c)return;const i=this.findSheetRow(c,l);i&&delete i[l.col]}forEachInSheet(l,c){const i=this.sheets[l];i&&i.forEach((u,p)=>{u&&u.forEach((f,h)=>{f&&c(f,p,h)})})}forEach(l){o.each(this.sheets,(c,i)=>{this.forEachInSheet(i,l)})}map(l){const c=[];return this.forEach(i=>{c.push(l(i))}),c}findSheet(l,c){const i=l.sheetName;return this.sheets[i]?this.sheets[i]:c?this.sheets[i]=[]:void 0}findSheetRow(l,c,i){const{row:u}=c;return l&&l[u]?l[u]:i?l[u]=[]:void 0}findRowCell(l,c,i){const{col:u}=c;return l&&l[u]?l[u]:i?l[u]=this.template?Object.assign(c,JSON.parse(JSON.stringify(this.template))):c:void 0}spliceRows(l,c,i,u){const p=this.sheets[l];if(p){const f=[];for(let h=0;h<u;h++)f.push([]);p.splice(c,i,...f)}}spliceColumns(l,c,i,u){const p=this.sheets[l];if(p){const f=[];for(let h=0;h<u;h++)f.push(null);o.each(p,h=>{h.splice(c,i,...f)})}}}},{"./col-cache":19,"./under-dash":26}],19:[function(e,a,n){const o=/^[A-Z]+\d+$/,s={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:l=>l<=26?1:l<=676?2:3,_fill(l){let c,i,u,p,f,h=1;if(l>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&l>=1){for(;h<=26;)c=this._dictionary[h-1],this._n2l[h]=c,this._l2n[c]=h,h++;this._l2nFill=1}if(this._l2nFill<2&&l>=2){for(h=27;h<=702;)i=h-27,u=i%26,p=Math.floor(i/26),c=this._dictionary[p]+this._dictionary[u],this._n2l[h]=c,this._l2n[c]=h,h++;this._l2nFill=2}if(this._l2nFill<3&&l>=3){for(h=703;h<=16384;)i=h-703,u=i%26,p=Math.floor(i/26)%26,f=Math.floor(i/676),c=this._dictionary[f]+this._dictionary[p]+this._dictionary[u],this._n2l[h]=c,this._l2n[c]=h,h++;this._l2nFill=3}},l2n(l){if(this._l2n[l]||this._fill(l.length),!this._l2n[l])throw new Error("Out of bounds. Invalid column letter: "+l);return this._l2n[l]},n2l(l){if(l<1||l>16384)throw new Error(l+" is out of bounds. Excel supports columns from 1 to 16384");return this._n2l[l]||this._fill(this._level(l)),this._n2l[l]},_hash:{},validateAddress(l){if(!o.test(l))throw new Error("Invalid Address: "+l);return!0},decodeAddress(l){const c=l.length<5&&this._hash[l];if(c)return c;let i=!1,u="",p=0,f=!1,h="",v=0;for(let g,x=0;x<l.length;x++)if(g=l.charCodeAt(x),!f&&g>=65&&g<=90)i=!0,u+=l[x],p=26*p+g-64;else if(g>=48&&g<=57)f=!0,h+=l[x],v=10*v+g-48;else if(f&&i&&g!==36)break;if(i){if(p>16384)throw new Error("Out of bounds. Invalid column letter: "+u)}else p=void 0;f||(v=void 0);const b={address:l=u+h,col:p,row:v,$col$row:`$${u}$${h}`};return p<=100&&v<=100&&(this._hash[l]=b,this._hash[b.$col$row]=b),b},getAddress(l,c){if(c){const i=this.n2l(c)+l;return this.decodeAddress(i)}return this.decodeAddress(l)},decode(l){const c=l.split(":");if(c.length===2){const i=this.decodeAddress(c[0]),u=this.decodeAddress(c[1]),p={top:Math.min(i.row,u.row),left:Math.min(i.col,u.col),bottom:Math.max(i.row,u.row),right:Math.max(i.col,u.col)};return p.tl=this.n2l(p.left)+p.top,p.br=this.n2l(p.right)+p.bottom,p.dimensions=`${p.tl}:${p.br}`,p}return this.decodeAddress(l)},decodeEx(l){const c=l.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),i=c[1]||c[2],u=c[3],p=u.split(":");if(p.length>1){let h=this.decodeAddress(p[0]),v=this.decodeAddress(p[1]);const b=Math.min(h.row,v.row),g=Math.min(h.col,v.col),x=Math.max(h.row,v.row),y=Math.max(h.col,v.col);return h=this.n2l(g)+b,v=this.n2l(y)+x,{top:b,left:g,bottom:x,right:y,sheetName:i,tl:{address:h,col:g,row:b,$col$row:`$${this.n2l(g)}$${b}`,sheetName:i},br:{address:v,col:y,row:x,$col$row:`$${this.n2l(y)}$${x}`,sheetName:i},dimensions:`${h}:${v}`}}if(u.startsWith("#"))return i?{sheetName:i,error:u}:{error:u};const f=this.decodeAddress(u);return i?{sheetName:i,...f}:f},encodeAddress:(l,c)=>s.n2l(c)+l,encode(){switch(arguments.length){case 2:return s.encodeAddress(arguments[0],arguments[1]);case 4:return`${s.encodeAddress(arguments[0],arguments[1])}:${s.encodeAddress(arguments[2],arguments[3])}`;default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange(l,c){const[i,u,,p,f]=l,[h,v]=c;return h>=i&&h<=p&&v>=u&&v<=f}};a.exports=s},{}],20:[function(e,a,n){const o=(l,c)=>({...l,...c.reduce((i,u)=>(l[u]&&(i[u]={...l[u]}),i),{})}),s=function(l,c,i){let u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];l[i]&&(c[i]=o(l[i],u))};n.copyStyle=l=>{if(!l)return l;if(c=l,Object.keys(c).length===0)return{};var c;const i={...l};return s(l,i,"font",["color"]),s(l,i,"alignment"),s(l,i,"protection"),l.border&&(s(l,i,"border"),s(l.border,i.border,"top",["color"]),s(l.border,i.border,"left",["color"]),s(l.border,i.border,"bottom",["color"]),s(l.border,i.border,"right",["color"]),s(l.border,i.border,"diagonal",["color"])),l.fill&&(s(l,i,"fill",["fgColor","bgColor","center"]),l.fill.stops&&(i.fill.stops=l.fill.stops.map(u=>o(u,["color"])))),i}},{}],21:[function(e,a,n){(function(o){(function(){const s=e("crypto"),l={hash(c){const i=s.createHash(c);for(var u=arguments.length,p=new Array(u>1?u-1:0),f=1;f<u;f++)p[f-1]=arguments[f];return i.update(o.concat(p)),i.digest()},convertPasswordToHash(c,i,u,p){if(i=i.toLowerCase(),s.getHashes().indexOf(i)<0)throw new Error(`Hash algorithm '${i}' not supported!`);const f=o.from(c,"utf16le");let h=this.hash(i,o.from(u,"base64"),f);for(let v=0;v<p;v++){const b=o.alloc(4);b.writeUInt32LE(v,0),h=this.hash(i,h,b)}return h.toString("base64")},randomBytes:c=>s.randomBytes(c)};a.exports=l}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220,crypto:390}],22:[function(e,a,n){const{SaxesParser:o}=e("saxes"),{PassThrough:s}=e("readable-stream"),{bufferToString:l}=e("./browser-buffer-decode");a.exports=async function*(c){c.pipe&&!c[Symbol.asyncIterator]&&(c=c.pipe(new s));const i=new o;let u;i.on("error",f=>{u=f});let p=[];i.on("opentag",f=>p.push({eventType:"opentag",value:f})),i.on("text",f=>p.push({eventType:"text",value:f})),i.on("closetag",f=>p.push({eventType:"closetag",value:f}));for await(const f of c){if(i.write(l(f)),u)throw u;yield p,p=[]}}},{"./browser-buffer-decode":16,"readable-stream":491,saxes:496}],23:[function(e,a,n){const o=e("./col-cache"),s=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,l=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;a.exports={slideFormula:function(c,i,u){const p=o.decode(i),f=o.decode(u);return c.replace(s,(h,v,b,g,x)=>{if(x)return h;const y=l.exec(g);if(y){const E=y[1],N=y[2].toUpperCase(),I=y[3],P=y[4];if(N.length>3||N.length===3&&N>"XFD")return h;let V=o.l2n(N),U=parseInt(P,10);return E||(V+=f.col-p.col),I||(U+=f.row-p.row),(v||"")+(E||"")+o.n2l(V)+(I||"")+U}return h})}}},{"./col-cache":19}],24:[function(e,a,n){(function(o,s){(function(){const l=e("readable-stream"),c=e("./utils"),i=e("./string-buf");class u{constructor(g,x){this._data=g,this._encoding=x}get length(){return this.toBuffer().length}copy(g,x,y,E){return this.toBuffer().copy(g,x,y,E)}toBuffer(){return this._buffer||(this._buffer=s.from(this._data,this._encoding)),this._buffer}}class p{constructor(g){this._data=g}get length(){return this._data.length}copy(g,x,y,E){return this._data._buf.copy(g,x,y,E)}toBuffer(){return this._data.toBuffer()}}class f{constructor(g){this._data=g}get length(){return this._data.length}copy(g,x,y,E){this._data.copy(g,x,y,E)}toBuffer(){return this._data}}class h{constructor(g){this.size=g,this.buffer=s.alloc(g),this.iRead=0,this.iWrite=0}toBuffer(){if(this.iRead===0&&this.iWrite===this.size)return this.buffer;const g=s.alloc(this.iWrite-this.iRead);return this.buffer.copy(g,0,this.iRead,this.iWrite),g}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(g){let x;return g===0?null:g===void 0||g>=this.length?(x=this.toBuffer(),this.iRead=this.iWrite,x):(x=s.alloc(g),this.buffer.copy(x,0,this.iRead,g),this.iRead+=g,x)}write(g,x,y){const E=Math.min(y,this.size-this.iWrite);return g.copy(this.buffer,this.iWrite,x,x+E),this.iWrite+=E,E}}const v=function(b){b=b||{},this.bufSize=b.bufSize||1048576,this.buffers=[],this.batch=b.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};c.inherits(v,l.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return s.concat(this.buffers.map(b=>b.toBuffer()))}},_getWritableBuffer(){if(this.buffers.length){const g=this.buffers[this.buffers.length-1];if(!g.full)return g}const b=new h(this.bufSize);return this.buffers.push(b),b},async _pipe(b){await Promise.all(this.pipes.map(function(g){return new Promise(x=>{g.write(b.toBuffer(),()=>{x()})})}))},_writeToBuffers(b){let g=0;const x=b.length;for(;g<x;)g+=this._getWritableBuffer().write(b,g,x-g)},async write(b,g,x){let y;if(g instanceof Function&&(x=g,g="utf8"),x=x||c.nop,b instanceof i)y=new p(b);else if(b instanceof s)y=new f(b);else{if(!(typeof b=="string"||b instanceof String||b instanceof ArrayBuffer))throw new Error("Chunk must be one of type String, Buffer or StringBuf.");y=new u(b,g)}if(this.pipes.length)if(this.batch)for(this._writeToBuffers(y);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(y),o.nextTick(x)):(await this._pipe(y),x());else this.paused||this.emit("data",y.toBuffer()),this._writeToBuffers(y),this.emit("readable");return!0},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(b,g,x){const y=E=>{E?x(E):(this._flush(),this.pipes.forEach(N=>{N.end()}),this.emit("finish"))};b?this.write(b,g,y):y()},read(b){let g;if(b){for(g=[];b&&this.buffers.length&&!this.buffers[0].eod;){const x=this.buffers[0],y=x.read(b);b-=y.length,g.push(y),x.eod&&x.full&&this.buffers.shift()}return s.concat(g)}return g=this.buffers.map(x=>x.toBuffer()).filter(Boolean),this.buffers=[],s.concat(g)},setEncoding(b){this.encoding=b},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(b){this.pipes.push(b),!this.paused&&this.buffers.length&&this.end()},unpipe(b){this.pipes=this.pipes.filter(g=>g!==b)},unshift(){throw new Error("Not Implemented")},wrap(){throw new Error("Not Implemented")}}),a.exports=v}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"./string-buf":25,"./utils":27,_process:467,buffer:220,"readable-stream":491}],25:[function(e,a,n){(function(o){(function(){a.exports=class{constructor(s){this._buf=o.alloc(s&&s.size||16384),this._encoding=s&&s.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=o.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(s){s=s||0,this._buffer=void 0,this._inPos=s}_grow(s){let l=2*this._buf.length;for(;l<s;)l*=2;const c=o.alloc(l);this._buf.copy(c,0),this._buf=c}addText(s){this._buffer=void 0;let l=this._inPos+this._buf.write(s,this._inPos,this._encoding);for(;l>=this._buf.length-4;)this._grow(this._inPos+s.length),l=this._inPos+this._buf.write(s,this._inPos,this._encoding);this._inPos=l}addStringBuf(s){s.length&&(this._buffer=void 0,this.length+s.length>this.capacity&&this._grow(this.length+s.length),s._buf.copy(this._buf,this._inPos,0,s.length),this._inPos+=s.length)}}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220}],26:[function(e,a,n){const{toString:o}=Object.prototype,s=/["&<>]/,l={each:function(c,i){c&&(Array.isArray(c)?c.forEach(i):Object.keys(c).forEach(u=>{i(c[u],u)}))},some:function(c,i){return!!c&&(Array.isArray(c)?c.some(i):Object.keys(c).some(u=>i(c[u],u)))},every:function(c,i){return!c||(Array.isArray(c)?c.every(i):Object.keys(c).every(u=>i(c[u],u)))},map:function(c,i){return c?Array.isArray(c)?c.map(i):Object.keys(c).map(u=>i(c[u],u)):[]},keyBy:(c,i)=>c.reduce((u,p)=>(u[p[i]]=p,u),{}),isEqual:function(c,i){const u=typeof c,p=typeof i,f=Array.isArray(c),h=Array.isArray(i);let v;if(u!==p)return!1;switch(typeof c){case"object":if(f||h)return!(!f||!h)&&c.length===i.length&&c.every((b,g)=>{const x=i[g];return l.isEqual(b,x)});if(c===null||i===null)return c===i;if(v=Object.keys(c),Object.keys(i).length!==v.length)return!1;for(const b of v)if(!i.hasOwnProperty(b))return!1;return l.every(c,(b,g)=>{const x=i[g];return l.isEqual(b,x)});default:return c===i}},escapeHtml(c){const i=s.exec(c);if(!i)return c;let u="",p="",f=0,h=i.index;for(;h<c.length;h++){switch(c.charAt(h)){case'"':p="&quot;";break;case"&":p="&amp;";break;case"'":p="&apos;";break;case"<":p="&lt;";break;case">":p="&gt;";break;default:continue}f!==h&&(u+=c.substring(f,h)),f=h+1,u+=p}return f!==h?u+c.substring(f,h):u},strcmp:(c,i)=>c<i?-1:c>i?1:0,isUndefined:c=>o.call(c)==="[object Undefined]",isObject:c=>o.call(c)==="[object Object]",deepMerge(){const c=arguments[0]||{},{length:i}=arguments;let u,p,f;function h(v,b){u=c[b],f=Array.isArray(v),l.isObject(v)||f?(f?(f=!1,p=u&&Array.isArray(u)?u:[]):p=u&&l.isObject(u)?u:{},c[b]=l.deepMerge(p,v)):l.isUndefined(v)||(c[b]=v)}for(let v=0;v<i;v++)l.each(arguments[v],h);return c}};a.exports=l},{}],27:[function(e,a,n){(function(o,s){(function(){const l=e("fs"),c=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,i={nop(){},promiseImmediate:u=>new Promise(p=>{o.setImmediate?s(()=>{p(u)}):setTimeout(()=>{p(u)},1)}),inherits:function(u,p,f,h){u.super_=p,h||(h=f,f=null),f&&Object.keys(f).forEach(b=>{Object.defineProperty(u,b,Object.getOwnPropertyDescriptor(f,b))});const v={constructor:{value:u,enumerable:!1,writable:!1,configurable:!0}};h&&Object.keys(h).forEach(b=>{v[b]=Object.getOwnPropertyDescriptor(h,b)}),u.prototype=Object.create(p.prototype,v)},dateToExcel:(u,p)=>25569+u.getTime()/864e5-(p?1462:0),excelToDate(u,p){const f=Math.round(24*(u-25569+(p?1462:0))*3600*1e3);return new Date(f)},parsePath(u){const p=u.lastIndexOf("/");return{path:u.substring(0,p),name:u.substring(p+1)}},getRelsPath(u){const p=i.parsePath(u);return`${p.path}/_rels/${p.name}.rels`},xmlEncode(u){const p=c.exec(u);if(!p)return u;let f="",h="",v=0,b=p.index;for(;b<u.length;b++){const g=u.charCodeAt(b);switch(g){case 34:h="&quot;";break;case 38:h="&amp;";break;case 39:h="&apos;";break;case 60:h="&lt;";break;case 62:h="&gt;";break;case 127:h="";break;default:if(g<=31&&(g<=8||g>=11&&g!==13)){h="";break}continue}v!==b&&(f+=u.substring(v,b)),v=b+1,h&&(f+=h)}return v!==b?f+u.substring(v,b):f},xmlDecode:u=>u.replace(/&([a-z]*);/g,p=>{switch(p){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return p}}),validInt(u){const p=parseInt(u,10);return Number.isNaN(p)?0:p},isDateFmt(u){return u?(u=(u=u.replace(/\[[^\]]*]/g,"")).replace(/"[^"]*"/g,"")).match(/[ymdhMsb]+/)!==null:!1},fs:{exists:u=>new Promise(p=>{l.access(u,l.constants.F_OK,f=>{p(!f)})})},toIsoDateString:u=>u.toIsoString().subsstr(0,10),parseBoolean:u=>u===!0||u==="true"||u===1||u==="1"};a.exports=i}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{},e("timers").setImmediate)},{fs:216,timers:523}],28:[function(e,a,n){const o=e("./under-dash"),s=e("./utils");function l(u,p,f){u.push(` ${p}="${s.xmlEncode(f.toString())}"`)}function c(u,p){if(p){const f=[];o.each(p,(h,v)=>{h!==void 0&&l(f,v,h)}),u.push(f.join(""))}}class i{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(p){const f=this._xml;f.push("<?xml"),c(f,p),f.push(`?>
`)}openNode(p,f){const h=this.tos,v=this._xml;h&&this.open&&v.push(">"),this._stack.push(p),v.push("<"),v.push(p),c(v,f),this.leaf=!0,this.open=!0}addAttribute(p,f){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");f!==void 0&&l(this._xml,p,f)}addAttributes(p){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");c(this._xml,p)}writeText(p){const f=this._xml;this.open&&(f.push(">"),this.open=!1),this.leaf=!1,f.push(s.xmlEncode(p.toString()))}writeXml(p){this.open&&(this._xml.push(">"),this.open=!1),this.leaf=!1,this._xml.push(p)}closeNode(){const p=this._stack.pop(),f=this._xml;this.leaf?f.push("/>"):(f.push("</"),f.push(p),f.push(">")),this.open=!1,this.leaf=!1}leafNode(p,f,h){this.openNode(p,f),h!==void 0&&this.writeText(h),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){const p=this._rollbacks.pop();this._xml.length>p.xml&&this._xml.splice(p.xml,this._xml.length-p.xml),this._stack.length>p.stack&&this._stack.splice(p.stack,this._stack.length-p.stack),this.leaf=p.leaf,this.open=p.open}get xml(){return this.closeAll(),this._xml.join("")}}i.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},a.exports=i},{"./under-dash":26,"./utils":27}],29:[function(e,a,n){(function(o){(function(){const s=e("events"),l=e("jszip"),c=e("./stream-buf"),{stringToBuffer:i}=e("./browser-buffer-encode");class u extends s.EventEmitter{constructor(f){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},f),this.zip=new l,this.stream=new c}append(f,h){h.hasOwnProperty("base64")&&h.base64?this.zip.file(h.name,f,{base64:!0}):(o.browser&&typeof f=="string"&&(f=i(f)),this.zip.file(h.name,f))}async finalize(){const f=await this.zip.generateAsync(this.options);this.stream.end(f),this.emit("finish")}read(f){return this.stream.read(f)}setEncoding(f){return this.stream.setEncoding(f)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(f,h){return this.stream.pipe(f,h)}unpipe(f){return this.stream.unpipe(f)}unshift(f){return this.stream.unshift(f)}wrap(f){return this.stream.wrap(f)}}a.exports={ZipWriter:u}}).call(this)}).call(this,e("_process"))},{"./browser-buffer-encode":17,"./stream-buf":24,_process:467,events:422,jszip:441}],30:[function(e,a,n){a.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},28:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy""m""d""',"zh-cn":'yyyy""m""d""',"ja-jp":'yyyy""m""d""',"ko-kr":'yyyy"" mm"" dd""'},32:{"zh-tw":'hh""mm""',"zh-cn":'h""mm""',"ja-jp":'h""mm""',"ko-kr":'h"" mm""'},33:{"zh-tw":'hh""mm""ss""',"zh-cn":'h""mm""ss""',"ja-jp":'h""mm""ss""',"ko-kr":'h"" mm"" ss""'},34:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},51:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},52:{"zh-tw":'/ hh""mm""',"zh-cn":'yyyy""m""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'m""d""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},55:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},58:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}},{}],31:[function(e,a,n){a.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}},{}],32:[function(e,a,n){const o=e("../../utils/parse-sax"),s=e("../../utils/xml-stream");class l{prepare(){}render(){}parseOpen(i){}parseText(i){}parseClose(i){}reconcile(i,u){}reset(){this.model=null,this.map&&Object.values(this.map).forEach(i=>{i instanceof l?i.reset():i.xform&&i.xform.reset()})}mergeModel(i){this.model=Object.assign(this.model||{},i)}async parse(i){for await(const u of i)for(const{eventType:p,value:f}of u)if(p==="opentag")this.parseOpen(f);else if(p==="text")this.parseText(f);else if(p==="closetag"&&!this.parseClose(f.name))return this.model;return this.model}async parseStream(i){return this.parse(o(i))}get xml(){return this.toXml(this.model)}toXml(i){const u=new s;return this.render(u,i),u.xml}static toAttribute(i,u){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(i===void 0){if(p)return u}else if(p||i!==u)return i.toString()}static toStringAttribute(i,u){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return l.toAttribute(i,u,p)}static toStringValue(i,u){return i===void 0?u:i}static toBoolAttribute(i,u){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(i===void 0){if(p)return u}else if(p||i!==u)return i?"1":"0"}static toBoolValue(i,u){return i===void 0?u:i==="1"}static toIntAttribute(i,u){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return l.toAttribute(i,u,p)}static toIntValue(i,u){return i===void 0?u:parseInt(i,10)}static toFloatAttribute(i,u){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return l.toAttribute(i,u,p)}static toFloatValue(i,u){return i===void 0?u:parseFloat(i)}}a.exports=l},{"../../utils/parse-sax":22,"../../utils/xml-stream":28}],33:[function(e,a,n){const o=e("../base-xform"),s=e("../../../utils/col-cache");function l(i){try{return s.decodeEx(i),!0}catch{return!1}}function c(i){const u=[];let p=!1,f="";return i.split(",").forEach(h=>{if(!h)return;const v=(h.match(/'/g)||[]).length;if(!v)return void(p?f+=h+",":l(h)&&u.push(h));const b=v%2==0;!p&&b&&l(h)?u.push(h):p&&!b?(p=!1,l(f+h)&&u.push(f+h),f=""):(p=!0,f+=h+",")}),u}a.exports=class extends o{render(i,u){i.openNode("definedName",{name:u.name,localSheetId:u.localSheetId}),i.writeText(u.ranges.join(",")),i.closeNode()}parseOpen(i){switch(i.name){case"definedName":return this._parsedName=i.attributes.name,this._parsedLocalSheetId=i.attributes.localSheetId,this._parsedText=[],!0;default:return!1}}parseText(i){this._parsedText.push(i)}parseClose(){return this.model={name:this._parsedName,ranges:c(this._parsedText.join(""))},this._parsedLocalSheetId!==void 0&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}}},{"../../../utils/col-cache":19,"../base-xform":32}],34:[function(e,a,n){const o=e("../../../utils/utils"),s=e("../base-xform");a.exports=class extends s{render(l,c){l.leafNode("sheet",{sheetId:c.id,name:c.name,state:c.state,"r:id":c.rId})}parseOpen(l){return l.name==="sheet"&&(this.model={name:o.xmlDecode(l.attributes.name),id:parseInt(l.attributes.sheetId,10),state:l.attributes.state,rId:l.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/utils":27,"../base-xform":32}],35:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{render(s,l){s.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:l.fullCalcOnLoad?1:void 0})}parseOpen(s){return s.name==="calcPr"&&(this.model={},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],36:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{render(s,l){s.leafNode("workbookPr",{date1904:l.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(s){return s.name==="workbookPr"&&(this.model={date1904:s.attributes.date1904==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],37:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{render(s,l){const c={xWindow:l.x||0,yWindow:l.y||0,windowWidth:l.width||12e3,windowHeight:l.height||24e3,firstSheet:l.firstSheet,activeTab:l.activeTab};l.visibility&&l.visibility!=="visible"&&(c.visibility=l.visibility),s.leafNode("workbookView",c)}parseOpen(s){if(s.name==="workbookView"){const l=this.model={},c=function(u,p,f){const h=p!==void 0?l[u]=p:f;h!==void 0&&(l[u]=h)},i=function(u,p,f){const h=p!==void 0?l[u]=parseInt(p,10):f;h!==void 0&&(l[u]=h)};return i("x",s.attributes.xWindow,0),i("y",s.attributes.yWindow,0),i("width",s.attributes.windowWidth,25e3),i("height",s.attributes.windowHeight,1e4),c("visibility",s.attributes.visibility,"visible"),i("activeTab",s.attributes.activeTab,void 0),i("firstSheet",s.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],38:[function(e,a,n){const o=e("../../../utils/under-dash"),s=e("../../../utils/col-cache"),l=e("../../../utils/xml-stream"),c=e("../base-xform"),i=e("../static-xform"),u=e("../list-xform"),p=e("./defined-name-xform"),f=e("./sheet-xform"),h=e("./workbook-view-xform"),v=e("./workbook-properties-xform"),b=e("./workbook-calc-properties-xform");class g extends c{constructor(){super(),this.map={fileVersion:g.STATIC_XFORMS.fileVersion,workbookPr:new v,bookViews:new u({tag:"bookViews",count:!1,childXform:new h}),sheets:new u({tag:"sheets",count:!1,childXform:new f}),definedNames:new u({tag:"definedNames",count:!1,childXform:new p}),calcPr:new b}}prepare(y){y.sheets=y.worksheets;const E=[];let N=0;y.sheets.forEach(I=>{if(I.pageSetup&&I.pageSetup.printArea&&I.pageSetup.printArea.split("&&").forEach(P=>{const V=P.split(":"),U={name:"_xlnm.Print_Area",ranges:[`'${I.name}'!$${V[0]}:$${V[1]}`],localSheetId:N};E.push(U)}),I.pageSetup&&(I.pageSetup.printTitlesRow||I.pageSetup.printTitlesColumn)){const P=[];if(I.pageSetup.printTitlesColumn){const U=I.pageSetup.printTitlesColumn.split(":");P.push(`'${I.name}'!$${U[0]}:$${U[1]}`)}if(I.pageSetup.printTitlesRow){const U=I.pageSetup.printTitlesRow.split(":");P.push(`'${I.name}'!$${U[0]}:$${U[1]}`)}const V={name:"_xlnm.Print_Titles",ranges:P,localSheetId:N};E.push(V)}N++}),E.length&&(y.definedNames=y.definedNames.concat(E)),(y.media||[]).forEach((I,P)=>{I.name=I.type+(P+1)})}render(y,E){y.openXml(l.StdDocAttributes),y.openNode("workbook",g.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(y),this.map.workbookPr.render(y,E.properties),this.map.bookViews.render(y,E.views),this.map.sheets.render(y,E.sheets),this.map.definedNames.render(y,E.definedNames),this.map.calcPr.render(y,E.calcProperties),y.closeNode()}parseOpen(y){if(this.parser)return this.parser.parseOpen(y),!0;switch(y.name){case"workbook":return!0;default:return this.parser=this.map[y.name],this.parser&&this.parser.parseOpen(y),!0}}parseText(y){this.parser&&this.parser.parseText(y)}parseClose(y){if(this.parser)return this.parser.parseClose(y)||(this.parser=void 0),!0;switch(y){case"workbook":return this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1;default:return!0}}reconcile(y){const E=(y.workbookRels||[]).reduce((U,H)=>(U[H.Id]=H,U),{}),N=[];let I,P=0;(y.sheets||[]).forEach(U=>{const H=E[U.rId];H&&(I=y.worksheetHash["xl/"+H.Target.replace(/^(\s|\/xl\/)+/,"")],I&&(I.name=U.name,I.id=U.id,I.state=U.state,N[P++]=I))});const V=[];o.each(y.definedNames,U=>{if(U.name==="_xlnm.Print_Area"){if(I=N[U.localSheetId],I){I.pageSetup||(I.pageSetup={});const H=s.decodeEx(U.ranges[0]);I.pageSetup.printArea=I.pageSetup.printArea?`${I.pageSetup.printArea}&&${H.dimensions}`:H.dimensions}}else if(U.name==="_xlnm.Print_Titles"){if(I=N[U.localSheetId],I){I.pageSetup||(I.pageSetup={});const H=U.ranges.join(","),G=/\$/g,Z=/\$\d+:\$\d+/,W=H.match(Z);if(W&&W.length){const C=W[0];I.pageSetup.printTitlesRow=C.replace(G,"")}const O=/\$[A-Z]+:\$[A-Z]+/,R=H.match(O);if(R&&R.length){const C=R[0];I.pageSetup.printTitlesColumn=C.replace(G,"")}}}else V.push(U)}),y.definedNames=V,y.media.forEach((U,H)=>{U.index=H})}}g.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},g.STATIC_XFORMS={fileVersion:new i({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})},a.exports=g},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./defined-name-xform":33,"./sheet-xform":34,"./workbook-calc-properties-xform":35,"./workbook-properties-xform":36,"./workbook-view-xform":37}],39:[function(e,a,n){const o=e("../strings/rich-text-xform"),s=e("../../../utils/utils"),l=e("../base-xform"),c=a.exports=function(i){this.model=i};s.inherits(c,l,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new o),this._richTextXform},render(i,u){u=u||this.model,i.openNode("comment",{ref:u.ref,authorId:0}),i.openNode("text"),u&&u.note&&u.note.texts&&u.note.texts.forEach(p=>{this.richTextXform.render(i,p)}),i.closeNode(),i.closeNode()},parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case"comment":return this.model={type:"note",note:{texts:[]},...i.attributes},!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(i),!0;default:return!1}},parseText(i){this.parser&&this.parser.parseText(i)},parseClose(i){switch(i){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(i),!0}}})},{"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],40:[function(e,a,n){const o=e("../../../utils/xml-stream"),s=e("../../../utils/utils"),l=e("../base-xform"),c=e("./comment-xform"),i=a.exports=function(){this.map={comment:new c}};s.inherits(i,l,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(u,p){p=p||this.model,u.openXml(o.StdDocAttributes),u.openNode("comments",i.COMMENTS_ATTRIBUTES),u.openNode("authors"),u.leafNode("author",null,"Author"),u.closeNode(),u.openNode("commentList"),p.comments.forEach(f=>{this.map.comment.render(u,f)}),u.closeNode(),u.closeNode()},parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(u),!0;default:return!1}},parseText(u){this.parser&&this.parser.parseText(u)},parseClose(u){switch(u){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(u),!0}}})},{"../../../utils/utils":27,"../../../utils/xml-stream":28,"../base-xform":32,"./comment-xform":39}],41:[function(e,a,n){const o=e("../../base-xform");a.exports=class extends o{constructor(s){super(),this._model=s}get tag(){return this._model&&this._model.tag}render(s,l,c){(l===c[2]||this.tag==="x:SizeWithCells"&&l===c[1])&&s.leafNode(this.tag)}parseOpen(s){switch(s.name){case this.tag:return this.model={},this.model[this.tag]=!0,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../base-xform":32}],42:[function(e,a,n){const o=e("../../base-xform");a.exports=class extends o{constructor(s){super(),this._model=s}get tag(){return this._model&&this._model.tag}render(s,l){s.leafNode(this.tag,null,l)}parseOpen(s){switch(s.name){case this.tag:return this.text="",!0;default:return!1}}parseText(s){this.text=s}parseClose(){return!1}}},{"../../base-xform":32}],43:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"x:Anchor"}getAnchorRect(s){const l=Math.floor(s.left),c=Math.floor(68*(s.left-l)),i=Math.floor(s.top),u=Math.floor(18*(s.top-i)),p=Math.floor(s.right),f=Math.floor(68*(s.right-p)),h=Math.floor(s.bottom);return[l,c,i,u,p,f,h,Math.floor(18*(s.bottom-h))]}getDefaultRect(s){const l=s.col,c=Math.max(s.row-2,0);return[l,6,c,14,l+2,2,c+4,16]}render(s,l){const c=l.anchor?this.getAnchorRect(l.anchor):this.getDefaultRect(l.refAddress);s.leafNode("x:Anchor",null,c.join(", "))}parseOpen(s){switch(s.name){case this.tag:return this.text="",!0;default:return!1}}parseText(s){this.text=s}parseClose(){return!1}}},{"../base-xform":32}],44:[function(e,a,n){const o=e("../base-xform"),s=e("./vml-anchor-xform"),l=e("./style/vml-protection-xform"),c=e("./style/vml-position-xform"),i=["twoCells","oneCells","absolute"];a.exports=class extends o{constructor(){super(),this.map={"x:Anchor":new s,"x:Locked":new l({tag:"x:Locked"}),"x:LockText":new l({tag:"x:LockText"}),"x:SizeWithCells":new c({tag:"x:SizeWithCells"}),"x:MoveWithCells":new c({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(u,p){const{protection:f,editAs:h}=p.note;u.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(u,h,i),this.map["x:SizeWithCells"].render(u,h,i),this.map["x:Anchor"].render(u,p),this.map["x:Locked"].render(u,f.locked),u.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(u,f.lockText),u.leafNode("x:Row",null,p.refAddress.row-1),u.leafNode("x:Column",null,p.refAddress.col-1),u.closeNode()}parseOpen(u){switch(u.name){case this.tag:this.reset(),this.model={anchor:[],protection:{},editAs:""};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.normalizeModel(),!1;default:return!0}}normalizeModel(){const u=Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model),p=Object.keys(u).length;this.model.editAs=i[p],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}}},{"../base-xform":32,"./style/vml-position-xform":41,"./style/vml-protection-xform":42,"./vml-anchor-xform":43}],45:[function(e,a,n){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("./vml-shape-xform");class c extends s{constructor(){super(),this.map={"v:shape":new l}}get tag(){return"xml"}render(u,p){u.openXml(o.StdDocAttributes),u.openNode(this.tag,c.DRAWING_ATTRIBUTES),u.openNode("o:shapelayout",{"v:ext":"edit"}),u.leafNode("o:idmap",{"v:ext":"edit",data:1}),u.closeNode(),u.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),u.leafNode("v:stroke",{joinstyle:"miter"}),u.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),u.closeNode(),p.comments.forEach((f,h)=>{this.map["v:shape"].render(u,f,h)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset(),this.model={comments:[]};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0;switch(u){case this.tag:return!1;default:return!0}}reconcile(u,p){u.anchors.forEach(f=>{f.br?this.map["xdr:twoCellAnchor"].reconcile(f,p):this.map["xdr:oneCellAnchor"].reconcile(f,p)})}}c.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},a.exports=c},{"../../../utils/xml-stream":28,"../base-xform":32,"./vml-shape-xform":46}],46:[function(e,a,n){const o=e("../base-xform"),s=e("./vml-textbox-xform"),l=e("./vml-client-data-xform");class c extends o{constructor(){super(),this.map={"v:textbox":new s,"x:ClientData":new l}}get tag(){return"v:shape"}render(u,p,f){u.openNode("v:shape",c.V_SHAPE_ATTRIBUTES(p,f)),u.leafNode("v:fill",{color2:"infoBackground [80]"}),u.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),u.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(u,p),this.map["x:ClientData"].render(u,p),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset(),this.model={margins:{insetmode:u.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1;default:return!0}}}c.V_SHAPE_ATTRIBUTES=(i,u)=>({id:"_x0000_s"+(1025+u),type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":i.note.margins&&i.note.margins.insetmode}),a.exports=c},{"../base-xform":32,"./vml-client-data-xform":44,"./vml-textbox-xform":47}],47:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"v:textbox"}conversionUnit(s,l,c){return`${parseFloat(s)*l.toFixed(2)}${c}`}reverseConversionUnit(s){return(s||"").split(",").map(l=>Number(parseFloat(this.conversionUnit(parseFloat(l),.1,"")).toFixed(2)))}render(s,l){const c={style:"mso-direction-alt:auto"};if(l&&l.note){let{inset:i}=l.note&&l.note.margins;Array.isArray(i)&&(i=i.map(u=>this.conversionUnit(u,10,"mm")).join(",")),i&&(c.inset=i)}s.openNode("v:textbox",c),s.leafNode("div",{style:"text-align:left"}),s.closeNode()}parseOpen(s){switch(s.name){case this.tag:return this.model={inset:this.reverseConversionUnit(s.attributes.inset)},!0;default:return!0}}parseText(){}parseClose(s){switch(s){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],48:[function(e,a,n){const o=e("./base-xform");a.exports=class extends o{createNewModel(s){return{}}parseOpen(s){return this.parser=this.parser||this.map[s.name],this.parser?(this.parser.parseOpen(s),!0):s.name===this.tag&&(this.model=this.createNewModel(s),!0)}parseText(s){this.parser&&this.parser.parseText(s)}onParserClose(s,l){this.model[s]=l.model}parseClose(s){return this.parser?(this.parser.parseClose(s)||(this.onParserClose(s,this.parser),this.parser=void 0),!0):s!==this.tag}}},{"./base-xform":32}],49:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{render(s,l){s.openNode("HeadingPairs"),s.openNode("vt:vector",{size:2,baseType:"variant"}),s.openNode("vt:variant"),s.leafNode("vt:lpstr",void 0,"Worksheets"),s.closeNode(),s.openNode("vt:variant"),s.leafNode("vt:i4",void 0,l.length),s.closeNode(),s.closeNode(),s.closeNode()}parseOpen(s){return s.name==="HeadingPairs"}parseText(){}parseClose(s){return s!=="HeadingPairs"}}},{"../base-xform":32}],50:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{render(s,l){s.openNode("TitlesOfParts"),s.openNode("vt:vector",{size:l.length,baseType:"lpstr"}),l.forEach(c=>{s.leafNode("vt:lpstr",void 0,c.name)}),s.closeNode(),s.closeNode()}parseOpen(s){return s.name==="TitlesOfParts"}parseText(){}parseClose(s){return s!=="TitlesOfParts"}}},{"../base-xform":32}],51:[function(e,a,n){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("../simple/string-xform"),c=e("./app-heading-pairs-xform"),i=e("./app-titles-of-parts-xform");class u extends s{constructor(){super(),this.map={Company:new l({tag:"Company"}),Manager:new l({tag:"Manager"}),HeadingPairs:new c,TitleOfParts:new i}}render(f,h){f.openXml(o.StdDocAttributes),f.openNode("Properties",u.PROPERTY_ATTRIBUTES),f.leafNode("Application",void 0,"Microsoft Excel"),f.leafNode("DocSecurity",void 0,"0"),f.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(f,h.worksheets),this.map.TitleOfParts.render(f,h.worksheets),this.map.Company.render(f,h.company||""),this.map.Manager.render(f,h.manager),f.leafNode("LinksUpToDate",void 0,"false"),f.leafNode("SharedDoc",void 0,"false"),f.leafNode("HyperlinksChanged",void 0,"false"),f.leafNode("AppVersion",void 0,"16.0300"),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"Properties":return!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.parser=void 0),!0;switch(f){case"Properties":return this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1;default:return!0}}}u.DateFormat=function(p){return p.toISOString().replace(/[.]\d{3,6}/,"")},u.DateAttrs={"xsi:type":"dcterms:W3CDTF"},u.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},a.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/string-xform":119,"./app-heading-pairs-xform":49,"./app-titles-of-parts-xform":50}],52:[function(e,a,n){const o=e("../../../utils/xml-stream"),s=e("../base-xform");class l extends s{render(i,u){i.openXml(o.StdDocAttributes),i.openNode("Types",l.PROPERTY_ATTRIBUTES);const p={};(u.media||[]).forEach(f=>{if(f.type==="image"){const h=f.extension;p[h]||(p[h]=!0,i.leafNode("Default",{Extension:h,ContentType:"image/"+h}))}}),i.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),i.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),i.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),u.worksheets.forEach(f=>{const h=`/xl/worksheets/sheet${f.id}.xml`;i.leafNode("Override",{PartName:h,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),i.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),i.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),u.sharedStrings&&u.sharedStrings.count&&i.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),u.tables&&u.tables.forEach(f=>{i.leafNode("Override",{PartName:"/xl/tables/"+f.target,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),u.drawings&&u.drawings.forEach(f=>{i.leafNode("Override",{PartName:`/xl/drawings/${f.name}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),u.commentRefs&&(i.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),u.commentRefs.forEach(f=>{let{commentName:h}=f;i.leafNode("Override",{PartName:`/xl/${h}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),i.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),i.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),i.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}}l.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},a.exports=l},{"../../../utils/xml-stream":28,"../base-xform":32}],53:[function(e,a,n){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("../simple/date-xform"),c=e("../simple/string-xform"),i=e("../simple/integer-xform");class u extends s{constructor(){super(),this.map={"dc:creator":new c({tag:"dc:creator"}),"dc:title":new c({tag:"dc:title"}),"dc:subject":new c({tag:"dc:subject"}),"dc:description":new c({tag:"dc:description"}),"dc:identifier":new c({tag:"dc:identifier"}),"dc:language":new c({tag:"dc:language"}),"cp:keywords":new c({tag:"cp:keywords"}),"cp:category":new c({tag:"cp:category"}),"cp:lastModifiedBy":new c({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new l({tag:"cp:lastPrinted",format:u.DateFormat}),"cp:revision":new i({tag:"cp:revision"}),"cp:version":new c({tag:"cp:version"}),"cp:contentStatus":new c({tag:"cp:contentStatus"}),"cp:contentType":new c({tag:"cp:contentType"}),"dcterms:created":new l({tag:"dcterms:created",attrs:u.DateAttrs,format:u.DateFormat}),"dcterms:modified":new l({tag:"dcterms:modified",attrs:u.DateAttrs,format:u.DateFormat})}}render(f,h){f.openXml(o.StdDocAttributes),f.openNode("cp:coreProperties",u.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(f,h.creator),this.map["dc:title"].render(f,h.title),this.map["dc:subject"].render(f,h.subject),this.map["dc:description"].render(f,h.description),this.map["dc:identifier"].render(f,h.identifier),this.map["dc:language"].render(f,h.language),this.map["cp:keywords"].render(f,h.keywords),this.map["cp:category"].render(f,h.category),this.map["cp:lastModifiedBy"].render(f,h.lastModifiedBy),this.map["cp:lastPrinted"].render(f,h.lastPrinted),this.map["cp:revision"].render(f,h.revision),this.map["cp:version"].render(f,h.version),this.map["cp:contentStatus"].render(f,h.contentStatus),this.map["cp:contentType"].render(f,h.contentType),this.map["dcterms:created"].render(f,h.created),this.map["dcterms:modified"].render(f,h.modified),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[f.name],this.parser)return this.parser.parseOpen(f),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(f))}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.parser=void 0),!0;switch(f){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error("Unexpected xml node in parseClose: "+f)}}}u.DateFormat=function(p){return p.toISOString().replace(/[.]\d{3}/,"")},u.DateAttrs={"xsi:type":"dcterms:W3CDTF"},u.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},a.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/date-xform":117,"../simple/integer-xform":118,"../simple/string-xform":119}],54:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{render(s,l){s.leafNode("Relationship",l)}parseOpen(s){switch(s.name){case"Relationship":return this.model=s.attributes,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],55:[function(e,a,n){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("./relationship-xform");class c extends s{constructor(){super(),this.map={Relationship:new l}}render(u,p){p=p||this._values,u.openXml(o.StdDocAttributes),u.openNode("Relationships",c.RELATIONSHIPS_ATTRIBUTES),p.forEach(f=>{this.map.Relationship.render(u,f)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"Relationships":return this.model=[],!0;default:if(this.parser=this.map[u.name],this.parser)return this.parser.parseOpen(u),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(u))}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.push(this.parser.model),this.parser=void 0),!0;switch(u){case"Relationships":return!1;default:throw new Error("Unexpected xml node in parseClose: "+u)}}}c.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},a.exports=c},{"../../../utils/xml-stream":28,"../base-xform":32,"./relationship-xform":54}],56:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{parseOpen(s){if(this.parser)return this.parser.parseOpen(s),!0;switch(s.name){case this.tag:this.reset(),this.model={range:{editAs:s.attributes.editAs||"oneCell"}};break;default:this.parser=this.map[s.name],this.parser&&this.parser.parseOpen(s)}return!0}parseText(s){this.parser&&this.parser.parseText(s)}reconcilePicture(s,l){if(s&&s.rId){const c=l.rels[s.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(c){const i=c[1],u=l.mediaIndex[i];return l.media[u]}}}}},{"../base-xform":32}],57:[function(e,a,n){const o=e("../base-xform"),s=e("./blip-xform");a.exports=class extends o{constructor(){super(),this.map={"a:blip":new s}}get tag(){return"xdr:blipFill"}render(l,c){l.openNode(this.tag),this.map["a:blip"].render(l,c),l.openNode("a:stretch"),l.leafNode("a:fillRect"),l.closeNode(),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:this.reset();break;default:this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)}return!0}parseText(){}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model=this.map["a:blip"].model,!1;default:return!0}}}},{"../base-xform":32,"./blip-xform":58}],58:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"a:blip"}render(s,l){s.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":l.rId,cstate:"print"})}parseOpen(s){switch(s.name){case this.tag:return this.model={rId:s.attributes["r:embed"]},!0;default:return!0}}parseText(){}parseClose(s){switch(s){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],59:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"xdr:cNvPicPr"}render(s){s.openNode(this.tag),s.leafNode("a:picLocks",{noChangeAspect:"1"}),s.closeNode()}parseOpen(s){switch(s.name){case this.tag:default:return!0}}parseText(){}parseClose(s){switch(s){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],60:[function(e,a,n){const o=e("../base-xform"),s=e("./hlink-click-xform"),l=e("./ext-lst-xform");a.exports=class extends o{constructor(){super(),this.map={"a:hlinkClick":new s,"a:extLst":new l}}get tag(){return"xdr:cNvPr"}render(c,i){c.openNode(this.tag,{id:i.index,name:"Picture "+i.index}),this.map["a:hlinkClick"].render(c,i),this.map["a:extLst"].render(c,i),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:this.reset();break;default:this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)}return!0}parseText(){}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;switch(c){case this.tag:return this.model=this.map["a:hlinkClick"].model,!1;default:return!0}}}},{"../base-xform":32,"./ext-lst-xform":63,"./hlink-click-xform":65}],61:[function(e,a,n){const o=e("../base-xform"),s=e("../simple/integer-xform");a.exports=class extends o{constructor(l){super(),this.tag=l.tag,this.map={"xdr:col":new s({tag:"xdr:col",zero:!0}),"xdr:colOff":new s({tag:"xdr:colOff",zero:!0}),"xdr:row":new s({tag:"xdr:row",zero:!0}),"xdr:rowOff":new s({tag:"xdr:rowOff",zero:!0})}}render(l,c){l.openNode(this.tag),this.map["xdr:col"].render(l,c.nativeCol),this.map["xdr:colOff"].render(l,c.nativeColOff),this.map["xdr:row"].render(l,c.nativeRow),this.map["xdr:rowOff"].render(l,c.nativeRowOff),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:this.reset();break;default:this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)}return!0}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1;default:return!0}}}},{"../base-xform":32,"../simple/integer-xform":118}],62:[function(e,a,n){const o=e("../../../utils/col-cache"),s=e("../../../utils/xml-stream"),l=e("../base-xform"),c=e("./two-cell-anchor-xform"),i=e("./one-cell-anchor-xform");class u extends l{constructor(){super(),this.map={"xdr:twoCellAnchor":new c,"xdr:oneCellAnchor":new i}}prepare(f){f.anchors.forEach((h,v)=>{h.anchorType=function(b){return(typeof b.range=="string"?o.decode(b.range):b.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor"}(h),this.map[h.anchorType].prepare(h,{index:v})})}get tag(){return"xdr:wsDr"}render(f,h){f.openXml(s.StdDocAttributes),f.openNode(this.tag,u.DRAWING_ATTRIBUTES),h.anchors.forEach(v=>{this.map[v.anchorType].render(f,v)}),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case this.tag:this.reset(),this.model={anchors:[]};break;default:this.parser=this.map[f.name],this.parser&&this.parser.parseOpen(f)}return!0}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0;switch(f){case this.tag:return!1;default:return!0}}reconcile(f,h){f.anchors.forEach(v=>{v.br?this.map["xdr:twoCellAnchor"].reconcile(v,h):this.map["xdr:oneCellAnchor"].reconcile(v,h)})}}u.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},a.exports=u},{"../../../utils/col-cache":19,"../../../utils/xml-stream":28,"../base-xform":32,"./one-cell-anchor-xform":67,"./two-cell-anchor-xform":70}],63:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"a:extLst"}render(s){s.openNode(this.tag),s.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),s.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),s.closeNode(),s.closeNode()}parseOpen(s){switch(s.name){case this.tag:default:return!0}}parseText(){}parseClose(s){switch(s){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],64:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.map={}}render(s,l){s.openNode(this.tag);const c=Math.floor(9525*l.width),i=Math.floor(9525*l.height);s.addAttribute("cx",c),s.addAttribute("cy",i),s.closeNode()}parseOpen(s){return s.name===this.tag&&(this.model={width:parseInt(s.attributes.cx||"0",10)/9525,height:parseInt(s.attributes.cy||"0",10)/9525},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],65:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"a:hlinkClick"}render(s,l){l.hyperlinks&&l.hyperlinks.rId&&s.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":l.hyperlinks.rId,tooltip:l.hyperlinks.tooltip})}parseOpen(s){switch(s.name){case this.tag:return this.model={hyperlinks:{rId:s.attributes["r:id"],tooltip:s.attributes.tooltip}},!0;default:return!0}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],66:[function(e,a,n){const o=e("../base-xform"),s=e("./c-nv-pr-xform"),l=e("./c-nv-pic-pr-xform");a.exports=class extends o{constructor(){super(),this.map={"xdr:cNvPr":new s,"xdr:cNvPicPr":new l}}get tag(){return"xdr:nvPicPr"}render(c,i){c.openNode(this.tag),this.map["xdr:cNvPr"].render(c,i),this.map["xdr:cNvPicPr"].render(c,i),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:this.reset();break;default:this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)}return!0}parseText(){}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;switch(c){case this.tag:return this.model=this.map["xdr:cNvPr"].model,!1;default:return!0}}}},{"../base-xform":32,"./c-nv-pic-pr-xform":59,"./c-nv-pr-xform":60}],67:[function(e,a,n){const o=e("./base-cell-anchor-xform"),s=e("../static-xform"),l=e("./cell-position-xform"),c=e("./ext-xform"),i=e("./pic-xform");a.exports=class extends o{constructor(){super(),this.map={"xdr:from":new l({tag:"xdr:from"}),"xdr:ext":new c({tag:"xdr:ext"}),"xdr:pic":new i,"xdr:clientData":new s({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(u,p){this.map["xdr:pic"].prepare(u.picture,p)}render(u,p){u.openNode(this.tag,{editAs:p.range.editAs||"oneCell"}),this.map["xdr:from"].render(u,p.range.tl),this.map["xdr:ext"].render(u,p.range.ext),this.map["xdr:pic"].render(u,p.picture),this.map["xdr:clientData"].render(u,{}),u.closeNode()}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(u,p){u.medium=this.reconcilePicture(u.picture,p)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./ext-xform":64,"./pic-xform":68}],68:[function(e,a,n){const o=e("../base-xform"),s=e("../static-xform"),l=e("./blip-fill-xform"),c=e("./nv-pic-pr-xform"),i=e("./sp-pr");a.exports=class extends o{constructor(){super(),this.map={"xdr:nvPicPr":new c,"xdr:blipFill":new l,"xdr:spPr":new s(i)}}get tag(){return"xdr:pic"}prepare(u,p){u.index=p.index+1}render(u,p){u.openNode(this.tag),this.map["xdr:nvPicPr"].render(u,p),this.map["xdr:blipFill"].render(u,p),this.map["xdr:spPr"].render(u,p),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset();break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(){}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.mergeModel(this.parser.model),this.parser=void 0),!0;switch(u){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"../static-xform":120,"./blip-fill-xform":57,"./nv-pic-pr-xform":66,"./sp-pr":69}],69:[function(e,a,n){a.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}},{}],70:[function(e,a,n){const o=e("./base-cell-anchor-xform"),s=e("../static-xform"),l=e("./cell-position-xform"),c=e("./pic-xform");a.exports=class extends o{constructor(){super(),this.map={"xdr:from":new l({tag:"xdr:from"}),"xdr:to":new l({tag:"xdr:to"}),"xdr:pic":new c,"xdr:clientData":new s({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(i,u){this.map["xdr:pic"].prepare(i.picture,u)}render(i,u){i.openNode(this.tag,{editAs:u.range.editAs||"oneCell"}),this.map["xdr:from"].render(i,u.range.tl),this.map["xdr:to"].render(i,u.range.br),this.map["xdr:pic"].render(i,u.picture),this.map["xdr:clientData"].render(i,{}),i.closeNode()}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.parser=void 0),!0;switch(i){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(i,u){i.medium=this.reconcilePicture(i.picture,u)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./pic-xform":68}],71:[function(e,a,n){const o=e("./base-xform");a.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.always=!!s.always,this.count=s.count,this.empty=s.empty,this.$count=s.$count||"count",this.$=s.$,this.childXform=s.childXform,this.maxItems=s.maxItems}prepare(s,l){const{childXform:c}=this;s&&s.forEach((i,u)=>{l.index=u,c.prepare(i,l)})}render(s,l){if(this.always||l&&l.length){s.openNode(this.tag,this.$),this.count&&s.addAttribute(this.$count,l&&l.length||0);const{childXform:c}=this;(l||[]).forEach((i,u)=>{c.render(s,i,u)}),s.closeNode()}else this.empty&&s.leafNode(this.tag)}parseOpen(s){if(this.parser)return this.parser.parseOpen(s),!0;switch(s.name){case this.tag:return this.model=[],!0;default:return!!this.childXform.parseOpen(s)&&(this.parser=this.childXform,!0)}}parseText(s){this.parser&&this.parser.parseText(s)}parseClose(s){if(this.parser){if(!this.parser.parseClose(s)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw new Error(`Max ${this.childXform.tag} count (${this.maxItems}) exceeded`);return!0}return!1}reconcile(s,l){if(s){const{childXform:c}=this;s.forEach(i=>{c.reconcile(i,l)})}}}},{"./base-xform":32}],72:[function(e,a,n){const o=e("../../../utils/col-cache"),s=e("../base-xform");a.exports=class extends s{get tag(){return"autoFilter"}render(l,c){if(c)if(typeof c=="string")l.leafNode("autoFilter",{ref:c});else{const i=function(f){return typeof f=="string"?f:o.getAddress(f.row,f.column).address},u=i(c.from),p=i(c.to);u&&p&&l.leafNode("autoFilter",{ref:`${u}:${p}`})}}parseOpen(l){l.name==="autoFilter"&&(this.model=l.attributes.ref)}}},{"../../../utils/col-cache":19,"../base-xform":32}],73:[function(e,a,n){const o=e("../../../utils/utils"),s=e("../base-xform"),l=e("../../../doc/range"),c=e("../../../doc/enums"),i=e("../strings/rich-text-xform");function u(p){if(p==null)return c.ValueType.Null;if(p instanceof String||typeof p=="string")return c.ValueType.String;if(typeof p=="number")return c.ValueType.Number;if(typeof p=="boolean")return c.ValueType.Boolean;if(p instanceof Date)return c.ValueType.Date;if(p.text&&p.hyperlink)return c.ValueType.Hyperlink;if(p.formula)return c.ValueType.Formula;if(p.error)return c.ValueType.Error;throw new Error("I could not understand type of value")}a.exports=class extends s{constructor(){super(),this.richTextXForm=new i}get tag(){return"c"}prepare(p,f){const h=f.styles.addStyleModel(p.style||{},function(v){switch(v.type){case c.ValueType.Formula:return u(v.result);default:return v.type}}(p));switch(h&&(p.styleId=h),p.comment&&f.comments.push({...p.comment,ref:p.address}),p.type){case c.ValueType.String:case c.ValueType.RichText:f.sharedStrings&&(p.ssId=f.sharedStrings.add(p.value));break;case c.ValueType.Date:f.date1904&&(p.date1904=!0);break;case c.ValueType.Hyperlink:f.sharedStrings&&p.text!==void 0&&p.text!==null&&(p.ssId=f.sharedStrings.add(p.text)),f.hyperlinks.push({address:p.address,target:p.hyperlink,tooltip:p.tooltip});break;case c.ValueType.Merge:f.merges.add(p);break;case c.ValueType.Formula:if(f.date1904&&(p.date1904=!0),p.shareType==="shared"&&(p.si=f.siFormulae++),p.formula)f.formulae[p.address]=p;else if(p.sharedFormula){const v=f.formulae[p.sharedFormula];if(!v)throw new Error("Shared Formula master must exist above and or left of clone for cell "+p.address);v.si===void 0?(v.shareType="shared",v.si=f.siFormulae++,v.range=new l(v.address,p.address)):v.range&&v.range.expandToAddress(p.address),p.si=v.si}}}renderFormula(p,f){let h=null;switch(f.shareType){case"shared":h={t:"shared",ref:f.ref||f.range.range,si:f.si};break;case"array":h={t:"array",ref:f.ref};break;default:f.si!==void 0&&(h={t:"shared",si:f.si})}switch(u(f.result)){case c.ValueType.Null:p.leafNode("f",h,f.formula);break;case c.ValueType.String:p.addAttribute("t","str"),p.leafNode("f",h,f.formula),p.leafNode("v",null,f.result);break;case c.ValueType.Number:p.leafNode("f",h,f.formula),p.leafNode("v",null,f.result);break;case c.ValueType.Boolean:p.addAttribute("t","b"),p.leafNode("f",h,f.formula),p.leafNode("v",null,f.result?1:0);break;case c.ValueType.Error:p.addAttribute("t","e"),p.leafNode("f",h,f.formula),p.leafNode("v",null,f.result.error);break;case c.ValueType.Date:p.leafNode("f",h,f.formula),p.leafNode("v",null,o.dateToExcel(f.result,f.date1904));break;default:throw new Error("I could not understand type of value")}}render(p,f){if(f.type!==c.ValueType.Null||f.styleId){switch(p.openNode("c"),p.addAttribute("r",f.address),f.styleId&&p.addAttribute("s",f.styleId),f.type){case c.ValueType.Null:break;case c.ValueType.Number:p.leafNode("v",null,f.value);break;case c.ValueType.Boolean:p.addAttribute("t","b"),p.leafNode("v",null,f.value?"1":"0");break;case c.ValueType.Error:p.addAttribute("t","e"),p.leafNode("v",null,f.value.error);break;case c.ValueType.String:case c.ValueType.RichText:f.ssId!==void 0?(p.addAttribute("t","s"),p.leafNode("v",null,f.ssId)):f.value&&f.value.richText?(p.addAttribute("t","inlineStr"),p.openNode("is"),f.value.richText.forEach(h=>{this.richTextXForm.render(p,h)}),p.closeNode("is")):(p.addAttribute("t","str"),p.leafNode("v",null,f.value));break;case c.ValueType.Date:p.leafNode("v",null,o.dateToExcel(f.value,f.date1904));break;case c.ValueType.Hyperlink:f.ssId!==void 0?(p.addAttribute("t","s"),p.leafNode("v",null,f.ssId)):(p.addAttribute("t","str"),p.leafNode("v",null,f.text));break;case c.ValueType.Formula:this.renderFormula(p,f);break;case c.ValueType.Merge:}p.closeNode()}}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;switch(p.name){case"c":return this.model={address:p.attributes.r},this.t=p.attributes.t,p.attributes.s&&(this.model.styleId=parseInt(p.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=p.attributes.si,this.model.shareType=p.attributes.t,this.model.ref=p.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(p),!0;default:return!1}}parseText(p){if(this.parser)this.parser.parseText(p);else switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+p:p;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+p:p:this.model.value=this.model.value?this.model.value+p:p}}parseClose(p){switch(p){case"c":{const{model:f}=this;if(f.formula||f.shareType)f.type=c.ValueType.Formula,f.value&&(this.t==="str"?f.result=o.xmlDecode(f.value):this.t==="b"?f.result=parseInt(f.value,10)!==0:this.t==="e"?f.result={error:f.value}:f.result=parseFloat(f.value),f.value=void 0);else if(f.value!==void 0)switch(this.t){case"s":f.type=c.ValueType.String,f.value=parseInt(f.value,10);break;case"str":f.type=c.ValueType.String,f.value=o.xmlDecode(f.value);break;case"inlineStr":f.type=c.ValueType.String;break;case"b":f.type=c.ValueType.Boolean,f.value=parseInt(f.value,10)!==0;break;case"e":f.type=c.ValueType.Error,f.value={error:f.value};break;default:f.type=c.ValueType.Number,f.value=parseFloat(f.value)}else f.styleId?f.type=c.ValueType.Null:f.type=c.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?(this.parser.parseClose(p),!0):(this.currentNode=void 0,!0);case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return!!this.parser&&(this.parser.parseClose(p),!0)}}reconcile(p,f){const h=p.styleId&&f.styles&&f.styles.getStyleModel(p.styleId);switch(h&&(p.style=h),p.styleId!==void 0&&(p.styleId=void 0),p.type){case c.ValueType.String:typeof p.value=="number"&&f.sharedStrings&&(p.value=f.sharedStrings.getString(p.value)),p.value.richText&&(p.type=c.ValueType.RichText);break;case c.ValueType.Number:h&&o.isDateFmt(h.numFmt)&&(p.type=c.ValueType.Date,p.value=o.excelToDate(p.value,f.date1904));break;case c.ValueType.Formula:p.result!==void 0&&h&&o.isDateFmt(h.numFmt)&&(p.result=o.excelToDate(p.result,f.date1904)),p.shareType==="shared"&&(p.ref?f.formulae[p.si]=p.address:(p.sharedFormula=f.formulae[p.si],delete p.shareType),delete p.si)}const v=f.hyperlinkMap[p.address];v&&(p.type===c.ValueType.Formula?(p.text=p.result,p.result=void 0):(p.text=p.value,p.value=void 0),p.type=c.ValueType.Hyperlink,p.hyperlink=v);const b=f.commentsMap&&f.commentsMap[p.address];b&&(p.comment=b)}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],74:[function(e,a,n){const o=e("../../base-xform");a.exports=class extends o{get tag(){return"x14:cfIcon"}render(s,l){s.leafNode(this.tag,{iconSet:l.iconSet,iconId:l.iconId})}parseOpen(s){let{attributes:l}=s;this.model={iconSet:l.iconSet,iconId:o.toIntValue(l.iconId)}}parseClose(s){return s!==this.tag}}},{"../../base-xform":32}],75:[function(e,a,n){const{v4:o}=e("uuid"),s=e("../../base-xform"),l=e("../../composite-xform"),c=e("./databar-ext-xform"),i=e("./icon-set-ext-xform"),u={"3Triangles":!0,"3Stars":!0,"5Boxes":!0};class p extends l{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new c,"x14:iconSet":this.iconSetXform=new i}}get tag(){return"x14:cfRule"}static isExt(h){return h.type==="dataBar"?c.isExt(h):!(h.type!=="iconSet"||!h.custom&&!u[h.iconSet])}prepare(h){p.isExt(h)&&(h.x14Id=`{${o()}}`.toUpperCase())}render(h,v){if(p.isExt(v))switch(v.type){case"dataBar":this.renderDataBar(h,v);break;case"iconSet":this.renderIconSet(h,v)}}renderDataBar(h,v){h.openNode(this.tag,{type:"dataBar",id:v.x14Id}),this.databarXform.render(h,v),h.closeNode()}renderIconSet(h,v){h.openNode(this.tag,{type:"iconSet",priority:v.priority,id:v.x14Id||`{${o()}}`}),this.iconSetXform.render(h,v),h.closeNode()}createNewModel(h){let{attributes:v}=h;return{type:v.type,x14Id:v.id,priority:s.toIntValue(v.priority)}}onParserClose(h,v){Object.assign(this.model,v.model)}}a.exports=p},{"../../base-xform":32,"../../composite-xform":48,"./databar-ext-xform":79,"./icon-set-ext-xform":81,uuid:528}],76:[function(e,a,n){const o=e("../../composite-xform"),s=e("./f-ext-xform");a.exports=class extends o{constructor(){super(),this.map={"xm:f":this.fExtXform=new s}}get tag(){return"x14:cfvo"}render(l,c){l.openNode(this.tag,{type:c.type}),c.value!==void 0&&this.fExtXform.render(l,c.value),l.closeNode()}createNewModel(l){return{type:l.attributes.type}}onParserClose(l,c){switch(l){case"xm:f":this.model.value=c.model?parseFloat(c.model):0}}}},{"../../composite-xform":48,"./f-ext-xform":80}],77:[function(e,a,n){const o=e("../../composite-xform"),s=e("./sqref-ext-xform"),l=e("./cf-rule-ext-xform");a.exports=class extends o{constructor(){super(),this.map={"xm:sqref":this.sqRef=new s,"x14:cfRule":this.cfRule=new l}}get tag(){return"x14:conditionalFormatting"}prepare(c,i){c.rules.forEach(u=>{this.cfRule.prepare(u,i)})}render(c,i){i.rules.some(l.isExt)&&(c.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),i.rules.filter(l.isExt).forEach(u=>this.cfRule.render(c,u)),this.sqRef.render(c,i.ref),c.closeNode())}createNewModel(){return{rules:[]}}onParserClose(c,i){switch(c){case"xm:sqref":this.model.ref=i.model;break;case"x14:cfRule":this.model.rules.push(i.model)}}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./sqref-ext-xform":82}],78:[function(e,a,n){const o=e("../../composite-xform"),s=e("./cf-rule-ext-xform"),l=e("./conditional-formatting-ext-xform");a.exports=class extends o{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new l}}get tag(){return"x14:conditionalFormattings"}hasContent(c){return c.hasExtContent===void 0&&(c.hasExtContent=c.some(i=>i.rules.some(s.isExt))),c.hasExtContent}prepare(c,i){c.forEach(u=>{this.cfXform.prepare(u,i)})}render(c,i){this.hasContent(i)&&(c.openNode(this.tag),i.forEach(u=>this.cfXform.render(c,u)),c.closeNode())}createNewModel(){return[]}onParserClose(c,i){this.model.push(i.model)}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./conditional-formatting-ext-xform":77}],79:[function(e,a,n){const o=e("../../base-xform"),s=e("../../composite-xform"),l=e("../../style/color-xform"),c=e("./cfvo-ext-xform");a.exports=class extends s{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new c,"x14:borderColor":this.borderColorXform=new l("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new l("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new l("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new l("x14:axisColor")}}static isExt(i){return!i.gradient}get tag(){return"x14:dataBar"}render(i,u){i.openNode(this.tag,{minLength:o.toIntAttribute(u.minLength,0,!0),maxLength:o.toIntAttribute(u.maxLength,100,!0),border:o.toBoolAttribute(u.border,!1),gradient:o.toBoolAttribute(u.gradient,!0),negativeBarColorSameAsPositive:o.toBoolAttribute(u.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:o.toBoolAttribute(u.negativeBarBorderColorSameAsPositive,!0),axisPosition:o.toAttribute(u.axisPosition,"auto"),direction:o.toAttribute(u.direction,"leftToRight")}),u.cfvo.forEach(p=>{this.cfvoXform.render(i,p)}),this.borderColorXform.render(i,u.borderColor),this.negativeBorderColorXform.render(i,u.negativeBorderColor),this.negativeFillColorXform.render(i,u.negativeFillColor),this.axisColorXform.render(i,u.axisColor),i.closeNode()}createNewModel(i){let{attributes:u}=i;return{cfvo:[],minLength:o.toIntValue(u.minLength,0),maxLength:o.toIntValue(u.maxLength,100),border:o.toBoolValue(u.border,!1),gradient:o.toBoolValue(u.gradient,!0),negativeBarColorSameAsPositive:o.toBoolValue(u.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:o.toBoolValue(u.negativeBarBorderColorSameAsPositive,!0),axisPosition:o.toStringValue(u.axisPosition,"auto"),direction:o.toStringValue(u.direction,"leftToRight")}}onParserClose(i,u){const[,p]=i.split(":");switch(p){case"cfvo":this.model.cfvo.push(u.model);break;default:this.model[p]=u.model}}}},{"../../base-xform":32,"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-ext-xform":76}],80:[function(e,a,n){const o=e("../../base-xform");a.exports=class extends o{get tag(){return"xm:f"}render(s,l){s.leafNode(this.tag,null,l)}parseOpen(){this.model=""}parseText(s){this.model+=s}parseClose(s){return s!==this.tag}}},{"../../base-xform":32}],81:[function(e,a,n){const o=e("../../base-xform"),s=e("../../composite-xform"),l=e("./cfvo-ext-xform"),c=e("./cf-icon-ext-xform");a.exports=class extends s{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new l,"x14:cfIcon":this.cfIconXform=new c}}get tag(){return"x14:iconSet"}render(i,u){i.openNode(this.tag,{iconSet:o.toStringAttribute(u.iconSet),reverse:o.toBoolAttribute(u.reverse,!1),showValue:o.toBoolAttribute(u.showValue,!0),custom:o.toBoolAttribute(u.icons,!1)}),u.cfvo.forEach(p=>{this.cfvoXform.render(i,p)}),u.icons&&u.icons.forEach((p,f)=>{p.iconId=f,this.cfIconXform.render(i,p)}),i.closeNode()}createNewModel(i){let{attributes:u}=i;return{cfvo:[],iconSet:o.toStringValue(u.iconSet,"3TrafficLights"),reverse:o.toBoolValue(u.reverse,!1),showValue:o.toBoolValue(u.showValue,!0)}}onParserClose(i,u){const[,p]=i.split(":");switch(p){case"cfvo":this.model.cfvo.push(u.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(u.model);break;default:this.model[p]=u.model}}}},{"../../base-xform":32,"../../composite-xform":48,"./cf-icon-ext-xform":74,"./cfvo-ext-xform":76}],82:[function(e,a,n){const o=e("../../base-xform");a.exports=class extends o{get tag(){return"xm:sqref"}render(s,l){s.leafNode(this.tag,null,l)}parseOpen(){this.model=""}parseText(s){this.model+=s}parseClose(s){return s!==this.tag}}},{"../../base-xform":32}],83:[function(e,a,n){const o=e("../../base-xform"),s=e("../../composite-xform"),l=e("../../../../doc/range"),c=e("./databar-xform"),i=e("./ext-lst-ref-xform"),u=e("./formula-xform"),p=e("./color-scale-xform"),f=e("./icon-set-xform"),h={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},v=g=>{const{type:x,operator:y}=g;switch(x){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:x};default:return{type:x,operator:y}}};class b extends s{constructor(){super(),this.map={dataBar:this.databarXform=new c,extLst:this.extLstRefXform=new i,formula:this.formulaXform=new u,colorScale:this.colorScaleXform=new p,iconSet:this.iconSetXform=new f}}get tag(){return"cfRule"}static isPrimitive(x){return x.type!=="iconSet"||!x.custom&&!h[x.iconSet]}render(x,y){switch(y.type){case"expression":this.renderExpression(x,y);break;case"cellIs":this.renderCellIs(x,y);break;case"top10":this.renderTop10(x,y);break;case"aboveAverage":this.renderAboveAverage(x,y);break;case"dataBar":this.renderDataBar(x,y);break;case"colorScale":this.renderColorScale(x,y);break;case"iconSet":this.renderIconSet(x,y);break;case"containsText":this.renderText(x,y);break;case"timePeriod":this.renderTimePeriod(x,y)}}renderExpression(x,y){x.openNode(this.tag,{type:"expression",dxfId:y.dxfId,priority:y.priority}),this.formulaXform.render(x,y.formulae[0]),x.closeNode()}renderCellIs(x,y){x.openNode(this.tag,{type:"cellIs",dxfId:y.dxfId,priority:y.priority,operator:y.operator}),y.formulae.forEach(E=>{this.formulaXform.render(x,E)}),x.closeNode()}renderTop10(x,y){x.leafNode(this.tag,{type:"top10",dxfId:y.dxfId,priority:y.priority,percent:o.toBoolAttribute(y.percent,!1),bottom:o.toBoolAttribute(y.bottom,!1),rank:o.toIntValue(y.rank,10,!0)})}renderAboveAverage(x,y){x.leafNode(this.tag,{type:"aboveAverage",dxfId:y.dxfId,priority:y.priority,aboveAverage:o.toBoolAttribute(y.aboveAverage,!0)})}renderDataBar(x,y){x.openNode(this.tag,{type:"dataBar",priority:y.priority}),this.databarXform.render(x,y),this.extLstRefXform.render(x,y),x.closeNode()}renderColorScale(x,y){x.openNode(this.tag,{type:"colorScale",priority:y.priority}),this.colorScaleXform.render(x,y),x.closeNode()}renderIconSet(x,y){b.isPrimitive(y)&&(x.openNode(this.tag,{type:"iconSet",priority:y.priority}),this.iconSetXform.render(x,y),x.closeNode())}renderText(x,y){x.openNode(this.tag,{type:y.operator,dxfId:y.dxfId,priority:y.priority,operator:o.toStringAttribute(y.operator,"containsText")});const E=(N=>{if(N.formulae&&N.formulae[0])return N.formulae[0];const I=new l(N.ref),{tl:P}=I;switch(N.operator){case"containsText":return`NOT(ISERROR(SEARCH("${N.text}",${P})))`;case"containsBlanks":return`LEN(TRIM(${P}))=0`;case"notContainsBlanks":return`LEN(TRIM(${P}))>0`;case"containsErrors":return`ISERROR(${P})`;case"notContainsErrors":return`NOT(ISERROR(${P}))`;default:return}})(y);E&&this.formulaXform.render(x,E),x.closeNode()}renderTimePeriod(x,y){x.openNode(this.tag,{type:"timePeriod",dxfId:y.dxfId,priority:y.priority,timePeriod:y.timePeriod});const E=(N=>{if(N.formulae&&N.formulae[0])return N.formulae[0];const I=new l(N.ref),{tl:P}=I;switch(N.timePeriod){case"thisWeek":return`AND(TODAY()-ROUNDDOWN(${P},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${P},0)-TODAY()<=7-WEEKDAY(TODAY()))`;case"lastWeek":return`AND(TODAY()-ROUNDDOWN(${P},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${P},0)<(WEEKDAY(TODAY())+7))`;case"nextWeek":return`AND(ROUNDDOWN(${P},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${P},0)-TODAY()<(15-WEEKDAY(TODAY())))`;case"yesterday":return`FLOOR(${P},1)=TODAY()-1`;case"today":return`FLOOR(${P},1)=TODAY()`;case"tomorrow":return`FLOOR(${P},1)=TODAY()+1`;case"last7Days":return`AND(TODAY()-FLOOR(${P},1)<=6,FLOOR(${P},1)<=TODAY())`;case"lastMonth":return`AND(MONTH(${P})=MONTH(EDATE(TODAY(),0-1)),YEAR(${P})=YEAR(EDATE(TODAY(),0-1)))`;case"thisMonth":return`AND(MONTH(${P})=MONTH(TODAY()),YEAR(${P})=YEAR(TODAY()))`;case"nextMonth":return`AND(MONTH(${P})=MONTH(EDATE(TODAY(),0+1)),YEAR(${P})=YEAR(EDATE(TODAY(),0+1)))`;default:return}})(y);E&&this.formulaXform.render(x,E),x.closeNode()}createNewModel(x){let{attributes:y}=x;return{...v(y),dxfId:o.toIntValue(y.dxfId),priority:o.toIntValue(y.priority),timePeriod:y.timePeriod,percent:o.toBoolValue(y.percent),bottom:o.toBoolValue(y.bottom),rank:o.toIntValue(y.rank),aboveAverage:o.toBoolValue(y.aboveAverage)}}onParserClose(x,y){switch(x){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,y.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(y.model)}}}a.exports=b},{"../../../../doc/range":10,"../../base-xform":32,"../../composite-xform":48,"./color-scale-xform":85,"./databar-xform":88,"./ext-lst-ref-xform":89,"./formula-xform":90,"./icon-set-xform":91}],84:[function(e,a,n){const o=e("../../base-xform");a.exports=class extends o{get tag(){return"cfvo"}render(s,l){s.leafNode(this.tag,{type:l.type,val:l.value})}parseOpen(s){this.model={type:s.attributes.type,value:o.toFloatValue(s.attributes.val)}}parseClose(s){return s!==this.tag}}},{"../../base-xform":32}],85:[function(e,a,n){const o=e("../../composite-xform"),s=e("../../style/color-xform"),l=e("./cfvo-xform");a.exports=class extends o{constructor(){super(),this.map={cfvo:this.cfvoXform=new l,color:this.colorXform=new s}}get tag(){return"colorScale"}render(c,i){c.openNode(this.tag),i.cfvo.forEach(u=>{this.cfvoXform.render(c,u)}),i.color.forEach(u=>{this.colorXform.render(c,u)}),c.closeNode()}createNewModel(c){return{cfvo:[],color:[]}}onParserClose(c,i){this.model[c].push(i.model)}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],86:[function(e,a,n){const o=e("../../composite-xform"),s=e("./cf-rule-xform");a.exports=class extends o{constructor(){super(),this.map={cfRule:new s}}get tag(){return"conditionalFormatting"}render(l,c){c.rules.some(s.isPrimitive)&&(l.openNode(this.tag,{sqref:c.ref}),c.rules.forEach(i=>{s.isPrimitive(i)&&(i.ref=c.ref,this.map.cfRule.render(l,i))}),l.closeNode())}createNewModel(l){let{attributes:c}=l;return{ref:c.sqref,rules:[]}}onParserClose(l,c){this.model.rules.push(c.model)}}},{"../../composite-xform":48,"./cf-rule-xform":83}],87:[function(e,a,n){const o=e("../../base-xform"),s=e("./conditional-formatting-xform");a.exports=class extends o{constructor(){super(),this.cfXform=new s}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(l,c){let i=l.reduce((u,p)=>Math.max(u,...p.rules.map(f=>f.priority||0)),1);l.forEach(u=>{u.rules.forEach(p=>{p.priority||(p.priority=i++),p.style&&(p.dxfId=c.styles.addDxfStyle(p.style))})})}render(l,c){c.forEach(i=>{this.cfXform.render(l,i)})}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"conditionalFormatting":return this.parser=this.cfXform,this.parser.parseOpen(l),!0;default:return!1}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){return!!this.parser&&(!!this.parser.parseClose(l)||(this.model.push(this.parser.model),this.parser=void 0,!1))}reconcile(l,c){l.forEach(i=>{i.rules.forEach(u=>{u.dxfId!==void 0&&(u.style=c.styles.getDxfStyle(u.dxfId),delete u.dxfId)})})}}},{"../../base-xform":32,"./conditional-formatting-xform":86}],88:[function(e,a,n){const o=e("../../composite-xform"),s=e("../../style/color-xform"),l=e("./cfvo-xform");a.exports=class extends o{constructor(){super(),this.map={cfvo:this.cfvoXform=new l,color:this.colorXform=new s}}get tag(){return"dataBar"}render(c,i){c.openNode(this.tag),i.cfvo.forEach(u=>{this.cfvoXform.render(c,u)}),this.colorXform.render(c,i.color),c.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(c,i){switch(c){case"cfvo":this.model.cfvo.push(i.model);break;case"color":this.model.color=i.model}}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],89:[function(e,a,n){const o=e("../../base-xform"),s=e("../../composite-xform");class l extends o{get tag(){return"x14:id"}render(u,p){u.leafNode(this.tag,null,p)}parseOpen(){this.model=""}parseText(u){this.model+=u}parseClose(u){return u!==this.tag}}class c extends s{constructor(){super(),this.map={"x14:id":this.idXform=new l}}get tag(){return"ext"}render(u,p){u.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(u,p.x14Id),u.closeNode()}createNewModel(){return{}}onParserClose(u,p){this.model.x14Id=p.model}}a.exports=class extends s{constructor(){super(),this.map={ext:new c}}get tag(){return"extLst"}render(i,u){i.openNode(this.tag),this.map.ext.render(i,u),i.closeNode()}createNewModel(){return{}}onParserClose(i,u){Object.assign(this.model,u.model)}}},{"../../base-xform":32,"../../composite-xform":48}],90:[function(e,a,n){const o=e("../../base-xform");a.exports=class extends o{get tag(){return"formula"}render(s,l){s.leafNode(this.tag,null,l)}parseOpen(){this.model=""}parseText(s){this.model+=s}parseClose(s){return s!==this.tag}}},{"../../base-xform":32}],91:[function(e,a,n){const o=e("../../base-xform"),s=e("../../composite-xform"),l=e("./cfvo-xform");a.exports=class extends s{constructor(){super(),this.map={cfvo:this.cfvoXform=new l}}get tag(){return"iconSet"}render(c,i){c.openNode(this.tag,{iconSet:o.toStringAttribute(i.iconSet,"3TrafficLights"),reverse:o.toBoolAttribute(i.reverse,!1),showValue:o.toBoolAttribute(i.showValue,!0)}),i.cfvo.forEach(u=>{this.cfvoXform.render(c,u)}),c.closeNode()}createNewModel(c){let{attributes:i}=c;return{iconSet:o.toStringValue(i.iconSet,"3TrafficLights"),reverse:o.toBoolValue(i.reverse),showValue:o.toBoolValue(i.showValue),cfvo:[]}}onParserClose(c,i){this.model[c].push(i.model)}}},{"../../base-xform":32,"../../composite-xform":48,"./cfvo-xform":84}],92:[function(e,a,n){const o=e("../../../utils/utils"),s=e("../base-xform");a.exports=class extends s{get tag(){return"col"}prepare(l,c){const i=c.styles.addStyleModel(l.style||{});i&&(l.styleId=i)}render(l,c){l.openNode("col"),l.addAttribute("min",c.min),l.addAttribute("max",c.max),c.width&&l.addAttribute("width",c.width),c.styleId&&l.addAttribute("style",c.styleId),c.hidden&&l.addAttribute("hidden","1"),c.bestFit&&l.addAttribute("bestFit","1"),c.outlineLevel&&l.addAttribute("outlineLevel",c.outlineLevel),c.collapsed&&l.addAttribute("collapsed","1"),l.addAttribute("customWidth","1"),l.closeNode()}parseOpen(l){if(l.name==="col"){const c=this.model={min:parseInt(l.attributes.min||"0",10),max:parseInt(l.attributes.max||"0",10),width:l.attributes.width===void 0?void 0:parseFloat(l.attributes.width||"0")};return l.attributes.style&&(c.styleId=parseInt(l.attributes.style,10)),o.parseBoolean(l.attributes.hidden)&&(c.hidden=!0),o.parseBoolean(l.attributes.bestFit)&&(c.bestFit=!0),l.attributes.outlineLevel&&(c.outlineLevel=parseInt(l.attributes.outlineLevel,10)),o.parseBoolean(l.attributes.collapsed)&&(c.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(l,c){l.styleId&&(l.style=c.styles.getStyleModel(l.styleId))}}},{"../../../utils/utils":27,"../base-xform":32}],93:[function(e,a,n){const o=e("../../../utils/under-dash"),s=e("../../../utils/utils"),l=e("../../../utils/col-cache"),c=e("../base-xform"),i=e("../../../doc/range");function u(f,h,v,b){const g=h[v];g!==void 0?f[v]=g:b!==void 0&&(f[v]=b)}function p(f,h,v,b){const g=h[v];g!==void 0&&(f[v]=s.parseBoolean(g))}a.exports=class extends c{get tag(){return"dataValidations"}render(f,h){const v=function(b){const g=o.map(b,(E,N)=>({address:N,dataValidation:E,marked:!1})).sort((E,N)=>o.strcmp(E.address,N.address)),x=o.keyBy(g,"address"),y=(E,N,I)=>{for(let P=0;P<N;P++){const V=l.encodeAddress(E.row+P,I);if(!b[V]||!o.isEqual(b[E.address],b[V]))return!1}return!0};return g.map(E=>{if(!E.marked){const N=l.decodeEx(E.address);if(N.dimensions)return x[N.dimensions].marked=!0,{...E.dataValidation,sqref:E.address};let I=1,P=l.encodeAddress(N.row+I,N.col);for(;b[P]&&o.isEqual(E.dataValidation,b[P]);)I++,P=l.encodeAddress(N.row+I,N.col);let V=1;for(;y(N,I,N.col+V);)V++;for(let U=0;U<I;U++)for(let H=0;H<V;H++)P=l.encodeAddress(N.row+U,N.col+H),x[P].marked=!0;if(I>1||V>1){const U=N.row+(I-1),H=N.col+(V-1);return{...E.dataValidation,sqref:`${E.address}:${l.encodeAddress(U,H)}`}}return{...E.dataValidation,sqref:E.address}}return null}).filter(Boolean)}(h);v.length&&(f.openNode("dataValidations",{count:v.length}),v.forEach(b=>{f.openNode("dataValidation"),b.type!=="any"&&(f.addAttribute("type",b.type),b.operator&&b.type!=="list"&&b.operator!=="between"&&f.addAttribute("operator",b.operator),b.allowBlank&&f.addAttribute("allowBlank","1")),b.showInputMessage&&f.addAttribute("showInputMessage","1"),b.promptTitle&&f.addAttribute("promptTitle",b.promptTitle),b.prompt&&f.addAttribute("prompt",b.prompt),b.showErrorMessage&&f.addAttribute("showErrorMessage","1"),b.errorStyle&&f.addAttribute("errorStyle",b.errorStyle),b.errorTitle&&f.addAttribute("errorTitle",b.errorTitle),b.error&&f.addAttribute("error",b.error),f.addAttribute("sqref",b.sqref),(b.formulae||[]).forEach((g,x)=>{f.openNode("formula"+(x+1)),b.type==="date"?f.writeText(s.dateToExcel(new Date(g))):f.writeText(g),f.closeNode()}),f.closeNode()}),f.closeNode())}parseOpen(f){switch(f.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=f.attributes.sqref;const h={type:f.attributes.type||"any",formulae:[]};switch(f.attributes.type&&p(h,f.attributes,"allowBlank"),p(h,f.attributes,"showInputMessage"),p(h,f.attributes,"showErrorMessage"),h.type){case"any":case"list":case"custom":break;default:u(h,f.attributes,"operator","between")}return u(h,f.attributes,"promptTitle"),u(h,f.attributes,"prompt"),u(h,f.attributes,"errorStyle"),u(h,f.attributes,"errorTitle"),u(h,f.attributes,"error"),this._dataValidation=h,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(f){this._formula&&this._formula.push(f)}parseClose(f){switch(f){case"dataValidations":return!1;case"dataValidation":return this._dataValidation.formulae&&this._dataValidation.formulae.length||(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(h=>{h.includes(":")?new i(h).forEachAddress(v=>{this.model[v]=this._dataValidation}):this.model[h]=this._dataValidation}),!0;case"formula1":case"formula2":{let h=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":h=parseInt(h,10);break;case"decimal":h=parseFloat(h);break;case"date":h=s.excelToDate(parseFloat(h))}return this._dataValidation.formulae.push(h),this._formula=void 0,!0}default:return!0}}}},{"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/utils":27,"../base-xform":32}],94:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"dimension"}render(s,l){l&&s.leafNode("dimension",{ref:l})}parseOpen(s){return s.name==="dimension"&&(this.model=s.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],95:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"drawing"}render(s,l){l&&s.leafNode(this.tag,{"r:id":l.rId})}parseOpen(s){switch(s.name){case this.tag:return this.model={rId:s.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],96:[function(e,a,n){const o=e("../composite-xform"),s=e("./cf-ext/conditional-formattings-ext-xform");class l extends o{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new s}}get tag(){return"ext"}hasContent(i){return this.conditionalFormattings.hasContent(i.conditionalFormattings)}prepare(i,u){this.conditionalFormattings.prepare(i.conditionalFormattings,u)}render(i,u){i.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(i,u.conditionalFormattings),i.closeNode()}createNewModel(){return{}}onParserClose(i,u){this.model[i]=u.model}}a.exports=class extends o{constructor(){super(),this.map={ext:this.ext=new l}}get tag(){return"extLst"}prepare(c,i){this.ext.prepare(c,i)}hasContent(c){return this.ext.hasContent(c)}render(c,i){this.hasContent(i)&&(c.openNode("extLst"),this.ext.render(c,i),c.closeNode())}createNewModel(){return{}}onParserClose(c,i){Object.assign(this.model,i.model)}}},{"../composite-xform":48,"./cf-ext/conditional-formattings-ext-xform":78}],97:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"headerFooter"}render(s,l){if(l){s.addRollback();let c=!1;s.openNode("headerFooter"),l.differentFirst&&(s.addAttribute("differentFirst","1"),c=!0),l.differentOddEven&&(s.addAttribute("differentOddEven","1"),c=!0),l.oddHeader&&typeof l.oddHeader=="string"&&(s.leafNode("oddHeader",null,l.oddHeader),c=!0),l.oddFooter&&typeof l.oddFooter=="string"&&(s.leafNode("oddFooter",null,l.oddFooter),c=!0),l.evenHeader&&typeof l.evenHeader=="string"&&(s.leafNode("evenHeader",null,l.evenHeader),c=!0),l.evenFooter&&typeof l.evenFooter=="string"&&(s.leafNode("evenFooter",null,l.evenFooter),c=!0),l.firstHeader&&typeof l.firstHeader=="string"&&(s.leafNode("firstHeader",null,l.firstHeader),c=!0),l.firstFooter&&typeof l.firstFooter=="string"&&(s.leafNode("firstFooter",null,l.firstFooter),c=!0),c?(s.closeNode(),s.commit()):s.rollback()}}parseOpen(s){switch(s.name){case"headerFooter":return this.model={},s.attributes.differentFirst&&(this.model.differentFirst=parseInt(s.attributes.differentFirst,0)===1),s.attributes.differentOddEven&&(this.model.differentOddEven=parseInt(s.attributes.differentOddEven,0)===1),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(s){switch(this.currentNode){case"oddHeader":this.model.oddHeader=s;break;case"oddFooter":this.model.oddFooter=s;break;case"evenHeader":this.model.evenHeader=s;break;case"evenFooter":this.model.evenFooter=s;break;case"firstHeader":this.model.firstHeader=s;break;case"firstFooter":this.model.firstFooter=s}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}}},{"../base-xform":32}],98:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"hyperlink"}render(s,l){this.isInternalLink(l)?s.leafNode("hyperlink",{ref:l.address,"r:id":l.rId,tooltip:l.tooltip,location:l.target}):s.leafNode("hyperlink",{ref:l.address,"r:id":l.rId,tooltip:l.tooltip})}parseOpen(s){return s.name==="hyperlink"&&(this.model={address:s.attributes.ref,rId:s.attributes["r:id"],tooltip:s.attributes.tooltip},s.attributes.location&&(this.model.target=s.attributes.location),!0)}parseText(){}parseClose(){return!1}isInternalLink(s){return s.target&&/^[^!]+![a-zA-Z]+[\d]+$/.test(s.target)}}},{"../base-xform":32}],99:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"mergeCell"}render(s,l){s.leafNode("mergeCell",{ref:l})}parseOpen(s){return s.name==="mergeCell"&&(this.model=s.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],100:[function(e,a,n){const o=e("../../../utils/under-dash"),s=e("../../../doc/range"),l=e("../../../utils/col-cache"),c=e("../../../doc/enums");a.exports=class{constructor(){this.merges={}}add(i){if(this.merges[i.master])this.merges[i.master].expandToAddress(i.address);else{const u=`${i.master}:${i.address}`;this.merges[i.master]=new s(u)}}get mergeCells(){return o.map(this.merges,i=>i.range)}reconcile(i,u){o.each(i,p=>{const f=l.decode(p);for(let h=f.top;h<=f.bottom;h++){const v=u[h-1];for(let b=f.left;b<=f.right;b++){const g=v.cells[b-1];g?g.type===c.ValueType.Merge&&(g.master=f.tl):v.cells[b]={type:c.ValueType.Null,address:l.encodeAddress(h,b)}}}})}getMasterAddress(i){const u=this.hash[i];return u&&u.tl}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26}],101:[function(e,a,n){const o=e("../base-xform"),s=l=>l!==void 0;a.exports=class extends o{get tag(){return"outlinePr"}render(l,c){return!(!c||!s(c.summaryBelow)&&!s(c.summaryRight))&&(l.leafNode(this.tag,{summaryBelow:s(c.summaryBelow)?Number(c.summaryBelow):void 0,summaryRight:s(c.summaryRight)?Number(c.summaryRight):void 0}),!0)}parseOpen(l){return l.name===this.tag&&(this.model={summaryBelow:s(l.attributes.summaryBelow)?!!Number(l.attributes.summaryBelow):void 0,summaryRight:s(l.attributes.summaryRight)?!!Number(l.attributes.summaryRight):void 0},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],102:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"brk"}render(s,l){s.leafNode("brk",l)}parseOpen(s){return s.name==="brk"&&(this.model=s.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],103:[function(e,a,n){const o=e("../../../utils/under-dash"),s=e("../base-xform");a.exports=class extends s{get tag(){return"pageMargins"}render(l,c){if(c){const i={left:c.left,right:c.right,top:c.top,bottom:c.bottom,header:c.header,footer:c.footer};o.some(i,u=>u!==void 0)&&l.leafNode(this.tag,i)}}parseOpen(l){switch(l.name){case this.tag:return this.model={left:parseFloat(l.attributes.left||.7),right:parseFloat(l.attributes.right||.7),top:parseFloat(l.attributes.top||.75),bottom:parseFloat(l.attributes.bottom||.75),header:parseFloat(l.attributes.header||.3),footer:parseFloat(l.attributes.footer||.3)},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],104:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"pageSetUpPr"}render(s,l){return!(!l||!l.fitToPage)&&(s.leafNode(this.tag,{fitToPage:l.fitToPage?"1":void 0}),!0)}parseOpen(s){return s.name===this.tag&&(this.model={fitToPage:s.attributes.fitToPage==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],105:[function(e,a,n){const o=e("../../../utils/under-dash"),s=e("../base-xform");function l(p){return p?"1":void 0}function c(p){switch(p){case"overThenDown":return p;default:return}}function i(p){switch(p){case"atEnd":case"asDisplyed":return p;default:return}}function u(p){switch(p){case"dash":case"blank":case"NA":return p;default:return}}a.exports=class extends s{get tag(){return"pageSetup"}render(p,f){if(f){const h={paperSize:f.paperSize,orientation:f.orientation,horizontalDpi:f.horizontalDpi,verticalDpi:f.verticalDpi,pageOrder:c(f.pageOrder),blackAndWhite:l(f.blackAndWhite),draft:l(f.draft),cellComments:i(f.cellComments),errors:u(f.errors),scale:f.scale,fitToWidth:f.fitToWidth,fitToHeight:f.fitToHeight,firstPageNumber:f.firstPageNumber,useFirstPageNumber:l(f.firstPageNumber),usePrinterDefaults:l(f.usePrinterDefaults),copies:f.copies};o.some(h,v=>v!==void 0)&&p.leafNode(this.tag,h)}}parseOpen(p){switch(p.name){case this.tag:return this.model={paperSize:(f=p.attributes.paperSize,f!==void 0?parseInt(f,10):void 0),orientation:p.attributes.orientation||"portrait",horizontalDpi:parseInt(p.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(p.attributes.verticalDpi||"4294967295",10),pageOrder:p.attributes.pageOrder||"downThenOver",blackAndWhite:p.attributes.blackAndWhite==="1",draft:p.attributes.draft==="1",cellComments:p.attributes.cellComments||"None",errors:p.attributes.errors||"displayed",scale:parseInt(p.attributes.scale||"100",10),fitToWidth:parseInt(p.attributes.fitToWidth||"1",10),fitToHeight:parseInt(p.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(p.attributes.firstPageNumber||"1",10),useFirstPageNumber:p.attributes.useFirstPageNumber==="1",usePrinterDefaults:p.attributes.usePrinterDefaults==="1",copies:parseInt(p.attributes.copies||"1",10)},!0;default:return!1}var f}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],106:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"picture"}render(s,l){l&&s.leafNode(this.tag,{"r:id":l.rId})}parseOpen(s){switch(s.name){case this.tag:return this.model={rId:s.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],107:[function(e,a,n){const o=e("../../../utils/under-dash"),s=e("../base-xform");function l(c){return c?"1":void 0}a.exports=class extends s{get tag(){return"printOptions"}render(c,i){if(i){const u={headings:l(i.showRowColHeaders),gridLines:l(i.showGridLines),horizontalCentered:l(i.horizontalCentered),verticalCentered:l(i.verticalCentered)};o.some(u,p=>p!==void 0)&&c.leafNode(this.tag,u)}}parseOpen(c){switch(c.name){case this.tag:return this.model={showRowColHeaders:c.attributes.headings==="1",showGridLines:c.attributes.gridLines==="1",horizontalCentered:c.attributes.horizontalCentered==="1",verticalCentered:c.attributes.verticalCentered==="1"},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],108:[function(e,a,n){const o=e("./page-breaks-xform"),s=e("../list-xform");a.exports=class extends s{constructor(){super({tag:"rowBreaks",count:!0,childXform:new o})}render(l,c){if(c&&c.length){l.openNode(this.tag,this.$),this.count&&(l.addAttribute(this.$count,c.length),l.addAttribute("manualBreakCount",c.length));const{childXform:i}=this;c.forEach(u=>{i.render(l,u)}),l.closeNode()}else this.empty&&l.leafNode(this.tag)}}},{"../list-xform":71,"./page-breaks-xform":102}],109:[function(e,a,n){const o=e("../base-xform"),s=e("../../../utils/utils"),l=e("./cell-xform");a.exports=class extends o{constructor(c){super(),this.maxItems=c&&c.maxItems,this.map={c:new l}}get tag(){return"row"}prepare(c,i){const u=i.styles.addStyleModel(c.style);u&&(c.styleId=u);const p=this.map.c;c.cells.forEach(f=>{p.prepare(f,i)})}render(c,i,u){c.openNode("row"),c.addAttribute("r",i.number),i.height&&(c.addAttribute("ht",i.height),c.addAttribute("customHeight","1")),i.hidden&&c.addAttribute("hidden","1"),i.min>0&&i.max>0&&i.min<=i.max&&c.addAttribute("spans",`${i.min}:${i.max}`),i.styleId&&(c.addAttribute("s",i.styleId),c.addAttribute("customFormat","1")),c.addAttribute("x14ac:dyDescent","0.25"),i.outlineLevel&&c.addAttribute("outlineLevel",i.outlineLevel),i.collapsed&&c.addAttribute("collapsed","1");const p=this.map.c;i.cells.forEach(f=>{p.render(c,f,u)}),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;if(c.name==="row"){this.numRowsSeen+=1;const i=c.attributes.spans?c.attributes.spans.split(":").map(p=>parseInt(p,10)):[void 0,void 0],u=this.model={number:parseInt(c.attributes.r,10),min:i[0],max:i[1],cells:[]};return c.attributes.s&&(u.styleId=parseInt(c.attributes.s,10)),s.parseBoolean(c.attributes.hidden)&&(u.hidden=!0),s.parseBoolean(c.attributes.bestFit)&&(u.bestFit=!0),c.attributes.ht&&(u.height=parseFloat(c.attributes.ht)),c.attributes.outlineLevel&&(u.outlineLevel=parseInt(c.attributes.outlineLevel,10)),s.parseBoolean(c.attributes.collapsed)&&(u.collapsed=!0),!0}return this.parser=this.map[c.name],!!this.parser&&(this.parser.parseOpen(c),!0)}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser){if(!this.parser.parseClose(c)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw new Error(`Max column count (${this.maxItems}) exceeded`);this.parser=void 0}return!0}return!1}reconcile(c,i){c.style=c.styleId?i.styles.getStyleModel(c.styleId):{},c.styleId!==void 0&&(c.styleId=void 0);const u=this.map.c;c.cells.forEach(p=>{u.reconcile(p,i)})}}},{"../../../utils/utils":27,"../base-xform":32,"./cell-xform":73}],110:[function(e,a,n){const o=e("../../../utils/under-dash"),s=e("../base-xform");a.exports=class extends s{get tag(){return"sheetFormatPr"}render(l,c){if(c){const i={defaultRowHeight:c.defaultRowHeight,outlineLevelRow:c.outlineLevelRow,outlineLevelCol:c.outlineLevelCol,"x14ac:dyDescent":c.dyDescent};c.defaultColWidth&&(i.defaultColWidth=c.defaultColWidth),c.defaultRowHeight&&c.defaultRowHeight===15||(i.customHeight="1"),o.some(i,u=>u!==void 0)&&l.leafNode("sheetFormatPr",i)}}parseOpen(l){return l.name==="sheetFormatPr"&&(this.model={defaultRowHeight:parseFloat(l.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(l.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(l.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(l.attributes.outlineLevelCol||"0",10)},l.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(l.attributes.defaultColWidth)),!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],111:[function(e,a,n){const o=e("../base-xform"),s=e("../style/color-xform"),l=e("./page-setup-properties-xform"),c=e("./outline-properties-xform");a.exports=class extends o{constructor(){super(),this.map={tabColor:new s("tabColor"),pageSetUpPr:new l,outlinePr:new c}}get tag(){return"sheetPr"}render(i,u){if(u){i.addRollback(),i.openNode("sheetPr");let p=!1;p=this.map.tabColor.render(i,u.tabColor)||p,p=this.map.pageSetUpPr.render(i,u.pageSetup)||p,p=this.map.outlinePr.render(i,u.outlineProperties)||p,p?(i.closeNode(),i.commit()):i.rollback()}}parseOpen(i){return this.parser?(this.parser.parseOpen(i),!0):i.name===this.tag?(this.reset(),!0):!!this.map[i.name]&&(this.parser=this.map[i.name],this.parser.parseOpen(i),!0)}parseText(i){return!!this.parser&&(this.parser.parseText(i),!0)}parseClose(i){return this.parser?(this.parser.parseClose(i)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}}},{"../base-xform":32,"../style/color-xform":128,"./outline-properties-xform":101,"./page-setup-properties-xform":104}],112:[function(e,a,n){const o=e("../../../utils/under-dash"),s=e("../base-xform");function l(i,u){return i?u:void 0}function c(i,u){return i===u||void 0}a.exports=class extends s{get tag(){return"sheetProtection"}render(i,u){if(u){const p={sheet:l(u.sheet,"1"),selectLockedCells:u.selectLockedCells===!1?"1":void 0,selectUnlockedCells:u.selectUnlockedCells===!1?"1":void 0,formatCells:l(u.formatCells,"0"),formatColumns:l(u.formatColumns,"0"),formatRows:l(u.formatRows,"0"),insertColumns:l(u.insertColumns,"0"),insertRows:l(u.insertRows,"0"),insertHyperlinks:l(u.insertHyperlinks,"0"),deleteColumns:l(u.deleteColumns,"0"),deleteRows:l(u.deleteRows,"0"),sort:l(u.sort,"0"),autoFilter:l(u.autoFilter,"0"),pivotTables:l(u.pivotTables,"0")};u.sheet&&(p.algorithmName=u.algorithmName,p.hashValue=u.hashValue,p.saltValue=u.saltValue,p.spinCount=u.spinCount,p.objects=l(u.objects===!1,"1"),p.scenarios=l(u.scenarios===!1,"1")),o.some(p,f=>f!==void 0)&&i.leafNode(this.tag,p)}}parseOpen(i){switch(i.name){case this.tag:return this.model={sheet:c(i.attributes.sheet,"1"),objects:i.attributes.objects!=="1"&&void 0,scenarios:i.attributes.scenarios!=="1"&&void 0,selectLockedCells:i.attributes.selectLockedCells!=="1"&&void 0,selectUnlockedCells:i.attributes.selectUnlockedCells!=="1"&&void 0,formatCells:c(i.attributes.formatCells,"0"),formatColumns:c(i.attributes.formatColumns,"0"),formatRows:c(i.attributes.formatRows,"0"),insertColumns:c(i.attributes.insertColumns,"0"),insertRows:c(i.attributes.insertRows,"0"),insertHyperlinks:c(i.attributes.insertHyperlinks,"0"),deleteColumns:c(i.attributes.deleteColumns,"0"),deleteRows:c(i.attributes.deleteRows,"0"),sort:c(i.attributes.sort,"0"),autoFilter:c(i.attributes.autoFilter,"0"),pivotTables:c(i.attributes.pivotTables,"0")},i.attributes.algorithmName&&(this.model.algorithmName=i.attributes.algorithmName,this.model.hashValue=i.attributes.hashValue,this.model.saltValue=i.attributes.saltValue,this.model.spinCount=parseInt(i.attributes.spinCount,10)),!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],113:[function(e,a,n){const o=e("../../../utils/col-cache"),s=e("../base-xform"),l={frozen:"frozen",frozenSplit:"frozen",split:"split"};a.exports=class extends s{get tag(){return"sheetView"}prepare(c){switch(c.state){case"frozen":case"split":break;default:c.state="normal"}}render(c,i){c.openNode("sheetView",{workbookViewId:i.workbookViewId||0});const u=function(b,g,x){x&&c.addAttribute(b,g)};let p,f,h,v;switch(u("rightToLeft","1",i.rightToLeft===!0),u("tabSelected","1",i.tabSelected),u("showRuler","0",i.showRuler===!1),u("showRowColHeaders","0",i.showRowColHeaders===!1),u("showGridLines","0",i.showGridLines===!1),u("zoomScale",i.zoomScale,i.zoomScale),u("zoomScaleNormal",i.zoomScaleNormal,i.zoomScaleNormal),u("view",i.style,i.style),i.state){case"frozen":f=i.xSplit||0,h=i.ySplit||0,p=i.topLeftCell||o.getAddress(h+1,f+1).address,v=(i.xSplit&&i.ySplit?"bottomRight":i.xSplit&&"topRight")||"bottomLeft",c.leafNode("pane",{xSplit:i.xSplit||void 0,ySplit:i.ySplit||void 0,topLeftCell:p,activePane:v,state:"frozen"}),c.leafNode("selection",{pane:v,activeCell:i.activeCell,sqref:i.activeCell});break;case"split":i.activePane==="topLeft"&&(i.activePane=void 0),c.leafNode("pane",{xSplit:i.xSplit||void 0,ySplit:i.ySplit||void 0,topLeftCell:i.topLeftCell,activePane:i.activePane}),c.leafNode("selection",{pane:i.activePane,activeCell:i.activeCell,sqref:i.activeCell});break;case"normal":i.activeCell&&c.leafNode("selection",{activeCell:i.activeCell,sqref:i.activeCell})}c.closeNode()}parseOpen(c){switch(c.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(c.attributes.workbookViewId,10),rightToLeft:c.attributes.rightToLeft==="1",tabSelected:c.attributes.tabSelected==="1",showRuler:c.attributes.showRuler!=="0",showRowColHeaders:c.attributes.showRowColHeaders!=="0",showGridLines:c.attributes.showGridLines!=="0",zoomScale:parseInt(c.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(c.attributes.zoomScaleNormal||"100",10),style:c.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(c.attributes.xSplit||"0",10),ySplit:parseInt(c.attributes.ySplit||"0",10),topLeftCell:c.attributes.topLeftCell,activePane:c.attributes.activePane||"topLeft",state:c.attributes.state},!0;case"selection":{const i=c.attributes.pane||"topLeft";return this.selections[i]={pane:i,activeCell:c.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(c){let i,u;switch(c){case"sheetView":return this.sheetView&&this.pane?(i=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:l[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},this.model.state==="split"&&(i.activePane=this.pane.activePane),u=this.selections[this.pane.activePane],u&&u.activeCell&&(i.activeCell=u.activeCell),this.sheetView.style&&(i.style=this.sheetView.style)):(i=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},u=this.selections.topLeft,u&&u.activeCell&&(i.activeCell=u.activeCell),this.sheetView.style&&(i.style=this.sheetView.style)),!1;default:return!0}}reconcile(){}}},{"../../../utils/col-cache":19,"../base-xform":32}],114:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"tablePart"}render(s,l){l&&s.leafNode(this.tag,{"r:id":l.rId})}parseOpen(s){switch(s.name){case this.tag:return this.model={rId:s.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],115:[function(e,a,n){const o=e("../../../utils/under-dash"),s=e("../../../utils/col-cache"),l=e("../../../utils/xml-stream"),c=e("../../rel-type"),i=e("./merges"),u=e("../base-xform"),p=e("../list-xform"),f=e("./row-xform"),h=e("./col-xform"),v=e("./dimension-xform"),b=e("./hyperlink-xform"),g=e("./merge-cell-xform"),x=e("./data-validations-xform"),y=e("./sheet-properties-xform"),E=e("./sheet-format-properties-xform"),N=e("./sheet-view-xform"),I=e("./sheet-protection-xform"),P=e("./page-margins-xform"),V=e("./page-setup-xform"),U=e("./print-options-xform"),H=e("./auto-filter-xform"),G=e("./picture-xform"),Z=e("./drawing-xform"),W=e("./table-part-xform"),O=e("./row-breaks-xform"),R=e("./header-footer-xform"),C=e("./cf/conditional-formattings-xform"),_=e("./ext-lst-xform"),k=(T,D)=>{if(!D||!D.length)return T;if(!T||!T.length)return D;const B={},F={};return T.forEach(Y=>{B[Y.ref]=Y,Y.rules.forEach(X=>{const{x14Id:re}=X;re&&(F[re]=X)})}),D.forEach(Y=>{Y.rules.forEach(X=>{const re=F[X.x14Id];re?((z,ee)=>{Object.keys(ee).forEach(L=>{const M=z[L],K=ee[L];M===void 0&&K!==void 0&&(z[L]=K)})})(re,X):B[Y.ref]?B[Y.ref].rules.push(X):T.push({ref:Y.ref,rules:[X]})})}),T};class A extends u{constructor(D){super();const{maxRows:B,maxCols:F,ignoreNodes:Y}=D||{};this.ignoreNodes=Y||[],this.map={sheetPr:new y,dimension:new v,sheetViews:new p({tag:"sheetViews",count:!1,childXform:new N}),sheetFormatPr:new E,cols:new p({tag:"cols",count:!1,childXform:new h}),sheetData:new p({tag:"sheetData",count:!1,empty:!0,childXform:new f({maxItems:F}),maxItems:B}),autoFilter:new H,mergeCells:new p({tag:"mergeCells",count:!0,childXform:new g}),rowBreaks:new O,hyperlinks:new p({tag:"hyperlinks",count:!1,childXform:new b}),pageMargins:new P,dataValidations:new x,pageSetup:new V,headerFooter:new R,printOptions:new U,picture:new G,drawing:new Z,sheetProtection:new I,tableParts:new p({tag:"tableParts",count:!0,childXform:new W}),conditionalFormatting:new C,extLst:new _}}prepare(D,B){B.merges=new i,D.hyperlinks=B.hyperlinks=[],D.comments=B.comments=[],B.formulae={},B.siFormulae=0,this.map.cols.prepare(D.cols,B),this.map.sheetData.prepare(D.rows,B),this.map.conditionalFormatting.prepare(D.conditionalFormattings,B),D.mergeCells=B.merges.mergeCells;const F=D.rels=[];function Y(z){return"rId"+(z.length+1)}if(D.hyperlinks.forEach(z=>{const ee=Y(F);z.rId=ee,F.push({Id:ee,Type:c.Hyperlink,Target:z.target,TargetMode:"External"})}),D.comments.length>0){const z={Id:Y(F),Type:c.Comments,Target:`../comments${D.id}.xml`};F.push(z);const ee={Id:Y(F),Type:c.VmlDrawing,Target:`../drawings/vmlDrawing${D.id}.vml`};F.push(ee),D.comments.forEach(L=>{L.refAddress=s.decodeAddress(L.ref)}),B.commentRefs.push({commentName:"comments"+D.id,vmlDrawing:"vmlDrawing"+D.id})}const X=[];let re;D.media.forEach(z=>{if(z.type==="background"){const ee=Y(F);re=B.media[z.imageId],F.push({Id:ee,Type:c.Image,Target:`../media/${re.name}.${re.extension}`}),D.background={rId:ee},D.image=B.media[z.imageId]}else if(z.type==="image"){let{drawing:ee}=D;re=B.media[z.imageId],ee||(ee=D.drawing={rId:Y(F),name:"drawing"+ ++B.drawingsCount,anchors:[],rels:[]},B.drawings.push(ee),F.push({Id:ee.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/${ee.name}.xml`}));let L=this.preImageId===z.imageId?X[z.imageId]:X[ee.rels.length];L||(L=Y(ee.rels),X[ee.rels.length]=L,ee.rels.push({Id:L,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/${re.name}.${re.extension}`}));const M={picture:{rId:L},range:z.range};if(z.hyperlinks&&z.hyperlinks.hyperlink){const K=Y(ee.rels);X[ee.rels.length]=K,M.picture.hyperlinks={tooltip:z.hyperlinks.tooltip,rId:K},ee.rels.push({Id:K,Type:c.Hyperlink,Target:z.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=z.imageId,ee.anchors.push(M)}}),D.tables.forEach(z=>{const ee=Y(F);z.rId=ee,F.push({Id:ee,Type:c.Table,Target:"../tables/"+z.target}),z.columns.forEach(L=>{const{style:M}=L;M&&(L.dxfId=B.styles.addDxfStyle(M))})}),this.map.extLst.prepare(D,B)}render(D,B){D.openXml(l.StdDocAttributes),D.openNode("worksheet",A.WORKSHEET_ATTRIBUTES);const F=B.properties?{defaultRowHeight:B.properties.defaultRowHeight,dyDescent:B.properties.dyDescent,outlineLevelCol:B.properties.outlineLevelCol,outlineLevelRow:B.properties.outlineLevelRow}:void 0;B.properties&&B.properties.defaultColWidth&&(F.defaultColWidth=B.properties.defaultColWidth);const Y={outlineProperties:B.properties&&B.properties.outlineProperties,tabColor:B.properties&&B.properties.tabColor,pageSetup:B.pageSetup&&B.pageSetup.fitToPage?{fitToPage:B.pageSetup.fitToPage}:void 0},X=B.pageSetup&&B.pageSetup.margins,re={showRowColHeaders:B.pageSetup&&B.pageSetup.showRowColHeaders,showGridLines:B.pageSetup&&B.pageSetup.showGridLines,horizontalCentered:B.pageSetup&&B.pageSetup.horizontalCentered,verticalCentered:B.pageSetup&&B.pageSetup.verticalCentered},z=B.sheetProtection;this.map.sheetPr.render(D,Y),this.map.dimension.render(D,B.dimensions),this.map.sheetViews.render(D,B.views),this.map.sheetFormatPr.render(D,F),this.map.cols.render(D,B.cols),this.map.sheetData.render(D,B.rows),this.map.sheetProtection.render(D,z),this.map.autoFilter.render(D,B.autoFilter),this.map.mergeCells.render(D,B.mergeCells),this.map.conditionalFormatting.render(D,B.conditionalFormattings),this.map.dataValidations.render(D,B.dataValidations),this.map.hyperlinks.render(D,B.hyperlinks),this.map.printOptions.render(D,re),this.map.pageMargins.render(D,X),this.map.pageSetup.render(D,B.pageSetup),this.map.headerFooter.render(D,B.headerFooter),this.map.rowBreaks.render(D,B.rowBreaks),this.map.drawing.render(D,B.drawing),this.map.picture.render(D,B.background),this.map.tableParts.render(D,B.tables),this.map.extLst.render(D,B),B.rels&&B.rels.forEach(ee=>{ee.Type===c.VmlDrawing&&D.leafNode("legacyDrawing",{"r:id":ee.Id})}),D.closeNode()}parseOpen(D){return this.parser?(this.parser.parseOpen(D),!0):D.name==="worksheet"?(o.each(this.map,B=>{B.reset()}),!0):(this.map[D.name]&&!this.ignoreNodes.includes(D.name)&&(this.parser=this.map[D.name],this.parser.parseOpen(D)),!0)}parseText(D){this.parser&&this.parser.parseText(D)}parseClose(D){if(this.parser)return this.parser.parseClose(D)||(this.parser=void 0),!0;switch(D){case"worksheet":{const B=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(B.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(B.outlineProperties=this.map.sheetPr.model.outlineProperties);const F={fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},Y=Object.assign(F,this.map.pageSetup.model,this.map.printOptions.model),X=k(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:B,views:this.map.sheetViews.model,pageSetup:Y,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:X},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}default:return!0}}reconcile(D,B){const F=(D.relationships||[]).reduce((X,re)=>{if(X[re.Id]=re,re.Type===c.Comments&&(D.comments=B.comments[re.Target].comments),re.Type===c.VmlDrawing&&D.comments&&D.comments.length){const z=B.vmlDrawings[re.Target].comments;D.comments.forEach((ee,L)=>{ee.note=Object.assign({},ee.note,z[L])})}return X},{});if(B.commentsMap=(D.comments||[]).reduce((X,re)=>(re.ref&&(X[re.ref]=re),X),{}),B.hyperlinkMap=(D.hyperlinks||[]).reduce((X,re)=>(re.rId&&(X[re.address]=F[re.rId].Target),X),{}),B.formulae={},D.rows=D.rows&&D.rows.filter(Boolean)||[],D.rows.forEach(X=>{X.cells=X.cells&&X.cells.filter(Boolean)||[]}),this.map.cols.reconcile(D.cols,B),this.map.sheetData.reconcile(D.rows,B),this.map.conditionalFormatting.reconcile(D.conditionalFormattings,B),D.media=[],D.drawing){const X=F[D.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(X){const re=X[1];B.drawings[re].anchors.forEach(z=>{if(z.medium){const ee={type:"image",imageId:z.medium.index,range:z.range,hyperlinks:z.picture.hyperlinks};D.media.push(ee)}})}}const Y=D.background&&F[D.background.rId];if(Y){const X=Y.Target.split("/media/")[1],re=B.mediaIndex&&B.mediaIndex[X];re!==void 0&&D.media.push({type:"background",imageId:re})}D.tables=(D.tables||[]).map(X=>{const re=F[X.rId];return B.tables[re.Target]}),delete D.relationships,delete D.hyperlinks,delete D.comments}}A.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},a.exports=A},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../../rel-type":31,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":72,"./cf/conditional-formattings-xform":87,"./col-xform":92,"./data-validations-xform":93,"./dimension-xform":94,"./drawing-xform":95,"./ext-lst-xform":96,"./header-footer-xform":97,"./hyperlink-xform":98,"./merge-cell-xform":99,"./merges":100,"./page-margins-xform":103,"./page-setup-xform":105,"./picture-xform":106,"./print-options-xform":107,"./row-breaks-xform":108,"./row-xform":109,"./sheet-format-properties-xform":110,"./sheet-properties-xform":111,"./sheet-protection-xform":112,"./sheet-view-xform":113,"./table-part-xform":114}],116:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.attr=s.attr}render(s,l){l&&(s.openNode(this.tag),s.closeNode())}parseOpen(s){s.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],117:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.attr=s.attr,this.attrs=s.attrs,this._format=s.format||function(l){try{return Number.isNaN(l.getTime())?"":l.toISOString()}catch{return""}},this._parse=s.parse||function(l){return new Date(l)}}render(s,l){l&&(s.openNode(this.tag),this.attrs&&s.addAttributes(this.attrs),this.attr?s.addAttribute(this.attr,this._format(l)):s.writeText(this._format(l)),s.closeNode())}parseOpen(s){s.name===this.tag&&(this.attr?this.model=this._parse(s.attributes[this.attr]):this.text=[])}parseText(s){this.attr||this.text.push(s)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}}},{"../base-xform":32}],118:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.attr=s.attr,this.attrs=s.attrs,this.zero=s.zero}render(s,l){(l||this.zero)&&(s.openNode(this.tag),this.attrs&&s.addAttributes(this.attrs),this.attr?s.addAttribute(this.attr,l):s.writeText(l),s.closeNode())}parseOpen(s){return s.name===this.tag&&(this.attr?this.model=parseInt(s.attributes[this.attr],10):this.text=[],!0)}parseText(s){this.attr||this.text.push(s)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}}},{"../base-xform":32}],119:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.attr=s.attr,this.attrs=s.attrs}render(s,l){l!==void 0&&(s.openNode(this.tag),this.attrs&&s.addAttributes(this.attrs),this.attr?s.addAttribute(this.attr,l):s.writeText(l),s.closeNode())}parseOpen(s){s.name===this.tag&&(this.attr?this.model=s.attributes[this.attr]:this.text=[])}parseText(s){this.attr||this.text.push(s)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}}},{"../base-xform":32}],120:[function(e,a,n){const o=e("./base-xform"),s=e("../../utils/xml-stream");a.exports=class extends o{constructor(l){super(),this._model=l}render(l){if(!this._xml){const c=new s;(function i(u,p){u.openNode(p.tag,p.$),p.c&&p.c.forEach(f=>{i(u,f)}),p.t&&u.writeText(p.t),u.closeNode()})(c,this._model),this._xml=c.xml}l.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(l){switch(l){case this._model.tag:return!1;default:return!0}}}},{"../../utils/xml-stream":28,"./base-xform":32}],121:[function(e,a,n){const o=e("./text-xform"),s=e("./rich-text-xform"),l=e("../base-xform");a.exports=class extends l{constructor(){super(),this.map={r:new s,t:new o}}get tag(){return"rPh"}render(c,i){if(c.openNode(this.tag,{sb:i.sb||0,eb:i.eb||0}),i&&i.hasOwnProperty("richText")&&i.richText){const{r:u}=this.map;i.richText.forEach(p=>{u.render(c,p)})}else i&&this.map.t.render(c,i.text);c.closeNode()}parseOpen(c){const{name:i}=c;return this.parser?(this.parser.parseOpen(c),!0):i===this.tag?(this.model={sb:parseInt(c.attributes.sb,10),eb:parseInt(c.attributes.eb,10)},!0):(this.parser=this.map[i],!!this.parser&&(this.parser.parseOpen(c),!0))}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser){if(!this.parser.parseClose(c)){switch(c){case"r":{let i=this.model.richText;i||(i=this.model.richText=[]),i.push(this.parser.model);break}case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}switch(c){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./rich-text-xform":122,"./text-xform":125}],122:[function(e,a,n){const o=e("./text-xform"),s=e("../style/font-xform"),l=e("../base-xform");class c extends l{constructor(u){super(),this.model=u}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new o)}get fontXform(){return this._fontXform||(this._fontXform=new s(c.FONT_OPTIONS))}render(u,p){p=p||this.model,u.openNode("r"),p.font&&this.fontXform.render(u,p.font),this.textXform.render(u,p.text),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(u),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){switch(u){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(u),!0}}}c.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},a.exports=c},{"../base-xform":32,"../style/font-xform":131,"./text-xform":125}],123:[function(e,a,n){const o=e("./text-xform"),s=e("./rich-text-xform"),l=e("./phonetic-text-xform"),c=e("../base-xform");a.exports=class extends c{constructor(i){super(),this.model=i,this.map={r:new s,t:new o,rPh:new l}}get tag(){return"si"}render(i,u){i.openNode(this.tag),u&&u.hasOwnProperty("richText")&&u.richText?u.richText.length?u.richText.forEach(p=>{this.map.r.render(i,p)}):this.map.t.render(i,""):u!=null&&this.map.t.render(i,u),i.closeNode()}parseOpen(i){const{name:u}=i;return this.parser?(this.parser.parseOpen(i),!0):u===this.tag?(this.model={},!0):(this.parser=this.map[u],!!this.parser&&(this.parser.parseOpen(i),!0))}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser){if(!this.parser.parseClose(i)){switch(i){case"r":{let u=this.model.richText;u||(u=this.model.richText=[]),u.push(this.parser.model);break}case"t":this.model=this.parser.model}this.parser=void 0}return!0}switch(i){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./phonetic-text-xform":121,"./rich-text-xform":122,"./text-xform":125}],124:[function(e,a,n){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("./shared-string-xform");a.exports=class extends s{constructor(c){super(),this.model=c||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new l)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(c){return this.model.values[c]}add(c){return c.richText?this.addRichText(c):this.addText(c)}addText(c){let i=this.hash[c];return i===void 0&&(i=this.hash[c]=this.model.values.length,this.model.values.push(c)),this.model.count++,i}addRichText(c){const i=this.sharedStringXform.toXml(c);let u=this.rich[i];return u===void 0&&(u=this.rich[i]=this.model.values.length,this.model.values.push(c)),this.model.count++,u}render(c,i){i=i||this._values,c.openXml(o.StdDocAttributes),c.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:i.count,uniqueCount:i.values.length});const u=this.sharedStringXform;i.values.forEach(p=>{u.render(c,p)}),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(c),!0;default:throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(c))}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;switch(c){case"sst":return!1;default:throw new Error("Unexpected xml node in parseClose: "+c)}}}},{"../../../utils/xml-stream":28,"../base-xform":32,"./shared-string-xform":123}],125:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"t"}render(s,l){s.openNode("t"),/^\s|\n|\s$/.test(l)&&s.addAttribute("xml:space","preserve"),s.writeText(l),s.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,(s,l)=>String.fromCharCode(parseInt(l,16)))}parseOpen(s){switch(s.name){case"t":return this._text=[],!0;default:return!1}}parseText(s){this._text.push(s)}parseClose(){return!1}}},{"../base-xform":32}],126:[function(e,a,n){const o=e("../../../doc/enums"),s=e("../../../utils/utils"),l=e("../base-xform"),c={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce((u,p)=>(u[p]=!0,u),{}),horizontal(u){return this.horizontalValues[u]?u:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce((u,p)=>(u[p]=!0,u),{}),vertical(u){return u==="middle"?"center":this.verticalValues[u]?u:void 0},wrapText:u=>!!u||void 0,shrinkToFit:u=>!!u||void 0,textRotation(u){switch(u){case"vertical":return u;default:return(u=s.validInt(u))>=-90&&u<=90?u:void 0}},indent:u=>(u=s.validInt(u),Math.max(0,u)),readingOrder(u){switch(u){case"ltr":return o.ReadingOrder.LeftToRight;case"rtl":return o.ReadingOrder.RightToLeft;default:return}}},i={toXml(u){if(u=c.textRotation(u)){if(u==="vertical")return 255;const p=Math.round(u);if(p>=0&&p<=90)return p;if(p<0&&p>=-90)return 90-p}},toModel(u){const p=s.validInt(u);if(p!==void 0){if(p===255)return"vertical";if(p>=0&&p<=90)return p;if(p>90&&p<=180)return 90-p}}};a.exports=class extends l{get tag(){return"alignment"}render(u,p){u.addRollback(),u.openNode("alignment");let f=!1;function h(v,b){b&&(u.addAttribute(v,b),f=!0)}h("horizontal",c.horizontal(p.horizontal)),h("vertical",c.vertical(p.vertical)),h("wrapText",!!c.wrapText(p.wrapText)&&"1"),h("shrinkToFit",!!c.shrinkToFit(p.shrinkToFit)&&"1"),h("indent",c.indent(p.indent)),h("textRotation",i.toXml(p.textRotation)),h("readingOrder",c.readingOrder(p.readingOrder)),u.closeNode(),f?u.commit():u.rollback()}parseOpen(u){const p={};let f=!1;function h(v,b,g){v&&(p[b]=g,f=!0)}h(u.attributes.horizontal,"horizontal",u.attributes.horizontal),h(u.attributes.vertical,"vertical",u.attributes.vertical==="center"?"middle":u.attributes.vertical),h(u.attributes.wrapText,"wrapText",s.parseBoolean(u.attributes.wrapText)),h(u.attributes.shrinkToFit,"shrinkToFit",s.parseBoolean(u.attributes.shrinkToFit)),h(u.attributes.indent,"indent",parseInt(u.attributes.indent,10)),h(u.attributes.textRotation,"textRotation",i.toModel(u.attributes.textRotation)),h(u.attributes.readingOrder,"readingOrder",u.attributes.readingOrder==="2"?"rtl":"ltr"),this.model=f?p:null}parseText(){}parseClose(){return!1}}},{"../../../doc/enums":7,"../../../utils/utils":27,"../base-xform":32}],127:[function(e,a,n){const o=e("../base-xform"),s=e("../../../utils/utils"),l=e("./color-xform");class c extends o{constructor(u){super(),this.name=u,this.map={color:new l}}get tag(){return this.name}render(u,p,f){const h=p&&p.color||f||this.defaultColor;u.openNode(this.name),p&&p.style&&(u.addAttribute("style",p.style),h&&this.map.color.render(u,h)),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.name:{const{style:p}=u.attributes;return this.model=p?{style:p}:void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.parser=void 0),!0):(u===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(u){return c.validStyleValues[u]}}c.validStyleValues=["thin","dashed","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce((i,u)=>(i[u]=!0,i),{}),a.exports=class extends o{constructor(){super(),this.map={top:new c("top"),left:new c("left"),bottom:new c("bottom"),right:new c("right"),diagonal:new c("diagonal")}}render(i,u){const{color:p}=u;function f(h,v){h&&!h.color&&u.color&&(h={...h,color:u.color}),v.render(i,h,p)}i.openNode("border"),u.diagonal&&u.diagonal.style&&(u.diagonal.up&&i.addAttribute("diagonalUp","1"),u.diagonal.down&&i.addAttribute("diagonalDown","1")),f(u.left,this.map.left),f(u.right,this.map.right),f(u.top,this.map.top),f(u.bottom,this.map.bottom),f(u.diagonal,this.map.diagonal),i.closeNode()}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case"border":return this.reset(),this.diagonalUp=s.parseBoolean(i.attributes.diagonalUp),this.diagonalDown=s.parseBoolean(i.attributes.diagonalDown),!0;default:return this.parser=this.map[i.name],!!this.parser&&(this.parser.parseOpen(i),!0)}}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.parser=void 0),!0;if(i==="border"){const u=this.model={},p=function(f,h,v){h&&(v&&Object.assign(h,v),u[f]=h)};p("left",this.map.left.model),p("right",this.map.right.model),p("top",this.map.top.model),p("bottom",this.map.bottom.model),p("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}}},{"../../../utils/utils":27,"../base-xform":32,"./color-xform":128}],128:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{constructor(s){super(),this.name=s||"color"}get tag(){return this.name}render(s,l){return!!l&&(s.openNode(this.name),l.argb?s.addAttribute("rgb",l.argb):l.theme!==void 0?(s.addAttribute("theme",l.theme),l.tint!==void 0&&s.addAttribute("tint",l.tint)):l.indexed!==void 0?s.addAttribute("indexed",l.indexed):s.addAttribute("auto","1"),s.closeNode(),!0)}parseOpen(s){return s.name===this.name&&(s.attributes.rgb?this.model={argb:s.attributes.rgb}:s.attributes.theme?(this.model={theme:parseInt(s.attributes.theme,10)},s.attributes.tint&&(this.model.tint=parseFloat(s.attributes.tint))):s.attributes.indexed?this.model={indexed:parseInt(s.attributes.indexed,10)}:this.model=void 0,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],129:[function(e,a,n){const o=e("../base-xform"),s=e("./alignment-xform"),l=e("./border-xform"),c=e("./fill-xform"),i=e("./font-xform"),u=e("./numfmt-xform"),p=e("./protection-xform");a.exports=class extends o{constructor(){super(),this.map={alignment:new s,border:new l,fill:new c,font:new i,numFmt:new u,protection:new p}}get tag(){return"dxf"}render(f,h){if(f.openNode(this.tag),h.font&&this.map.font.render(f,h.font),h.numFmt&&h.numFmtId){const v={id:h.numFmtId,formatCode:h.numFmt};this.map.numFmt.render(f,v)}h.fill&&this.map.fill.render(f,h.fill),h.alignment&&this.map.alignment.render(f,h.alignment),h.border&&this.map.border.render(f,h.border),h.protection&&this.map.protection.render(f,h.protection),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case this.tag:return this.reset(),!0;default:return this.parser=this.map[f.name],this.parser&&this.parser.parseOpen(f),!0}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return this.parser?(this.parser.parseClose(f)||(this.parser=void 0),!0):f!==this.tag||(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1)}}},{"../base-xform":32,"./alignment-xform":126,"./border-xform":127,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./protection-xform":133}],130:[function(e,a,n){const o=e("../base-xform"),s=e("./color-xform");class l extends o{constructor(){super(),this.map={color:new s}}get tag(){return"stop"}render(f,h){f.openNode("stop"),f.addAttribute("position",h.position),this.map.color.render(f,h.color),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"stop":return this.model={position:parseFloat(f.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(f),!0;default:return!1}}parseText(){}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model.color=this.parser.model,this.parser=void 0),!0)}}class c extends o{constructor(){super(),this.map={fgColor:new s("fgColor"),bgColor:new s("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(f,h){f.openNode("patternFill"),f.addAttribute("patternType",h.pattern),h.fgColor&&this.map.fgColor.render(f,h.fgColor),h.bgColor&&this.map.bgColor.render(f,h.bgColor),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"patternFill":return this.model={type:"pattern",pattern:f.attributes.patternType},!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.parser.model&&(this.model[f]=this.parser.model),this.parser=void 0),!0)}}class i extends o{constructor(){super(),this.map={stop:new l}}get name(){return"gradient"}get tag(){return"gradientFill"}render(f,h){switch(f.openNode("gradientFill"),h.gradient){case"angle":f.addAttribute("degree",h.degree);break;case"path":f.addAttribute("type","path"),h.center.left&&(f.addAttribute("left",h.center.left),h.center.right===void 0&&f.addAttribute("right",h.center.left)),h.center.right&&f.addAttribute("right",h.center.right),h.center.top&&(f.addAttribute("top",h.center.top),h.center.bottom===void 0&&f.addAttribute("bottom",h.center.top)),h.center.bottom&&f.addAttribute("bottom",h.center.bottom)}const v=this.map.stop;h.stops.forEach(b=>{v.render(f,b)}),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"gradientFill":{const h=this.model={stops:[]};return f.attributes.degree?(h.gradient="angle",h.degree=parseInt(f.attributes.degree,10)):f.attributes.type==="path"&&(h.gradient="path",h.center={left:f.attributes.left?parseFloat(f.attributes.left):0,top:f.attributes.top?parseFloat(f.attributes.top):0},f.attributes.right!==f.attributes.left&&(h.center.right=f.attributes.right?parseFloat(f.attributes.right):0),f.attributes.bottom!==f.attributes.top&&(h.center.bottom=f.attributes.bottom?parseFloat(f.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(f),!0;default:return!1}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0)}}class u extends o{constructor(){super(),this.map={patternFill:new c,gradientFill:new i}}get tag(){return"fill"}render(f,h){switch(f.addRollback(),f.openNode("fill"),h.type){case"pattern":this.map.patternFill.render(f,h);break;case"gradient":this.map.gradientFill.render(f,h);break;default:return void f.rollback()}f.closeNode(),f.commit()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"fill":return this.model={},!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0)}validStyle(f){return u.validPatternValues[f]}}u.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce((p,f)=>(p[f]=!0,p),{}),u.StopXform=l,u.PatternFillXform=c,u.GradientFillXform=i,a.exports=u},{"../base-xform":32,"./color-xform":128}],131:[function(e,a,n){const o=e("./color-xform"),s=e("../simple/boolean-xform"),l=e("../simple/integer-xform"),c=e("../simple/string-xform"),i=e("./underline-xform"),u=e("../../../utils/under-dash"),p=e("../base-xform");class f extends p{constructor(v){super(),this.options=v||f.OPTIONS,this.map={b:{prop:"bold",xform:new s({tag:"b",attr:"val"})},i:{prop:"italic",xform:new s({tag:"i",attr:"val"})},u:{prop:"underline",xform:new i},charset:{prop:"charset",xform:new l({tag:"charset",attr:"val"})},color:{prop:"color",xform:new o},condense:{prop:"condense",xform:new s({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new s({tag:"extend",attr:"val"})},family:{prop:"family",xform:new l({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new s({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new c({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new c({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new s({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new s({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new l({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new c({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(v,b){const{map:g}=this;v.openNode(this.options.tagName),u.each(this.map,(x,y)=>{g[y].xform.render(v,b[x.prop])}),v.closeNode()}parseOpen(v){if(this.parser)return this.parser.parseOpen(v),!0;if(this.map[v.name])return this.parser=this.map[v.name].xform,this.parser.parseOpen(v);switch(v.name){case this.options.tagName:return this.model={},!0;default:return!1}}parseText(v){this.parser&&this.parser.parseText(v)}parseClose(v){if(this.parser&&!this.parser.parseClose(v)){const b=this.map[v];return this.parser.model&&(this.model[b.prop]=this.parser.model),this.parser=void 0,!0}switch(v){case this.options.tagName:return!1;default:return!0}}}f.OPTIONS={tagName:"font",fontNameTag:"name"},a.exports=f},{"../../../utils/under-dash":26,"../base-xform":32,"../simple/boolean-xform":116,"../simple/integer-xform":118,"../simple/string-xform":119,"./color-xform":128,"./underline-xform":136}],132:[function(e,a,n){const o=e("../../../utils/under-dash"),s=e("../../defaultnumformats"),l=e("../base-xform"),c=function(){const u={};return o.each(s,(p,f)=>{p.f&&(u[p.f]=parseInt(f,10))}),u}();class i extends l{constructor(p,f){super(),this.id=p,this.formatCode=f}get tag(){return"numFmt"}render(p,f){p.leafNode("numFmt",{numFmtId:f.id,formatCode:f.formatCode})}parseOpen(p){switch(p.name){case"numFmt":return this.model={id:parseInt(p.attributes.numFmtId,10),formatCode:p.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0;default:return!1}}parseText(){}parseClose(){return!1}}i.getDefaultFmtId=function(u){return c[u]},i.getDefaultFmtCode=function(u){return s[u]&&s[u].f},a.exports=i},{"../../../utils/under-dash":26,"../../defaultnumformats":30,"../base-xform":32}],133:[function(e,a,n){const o=e("../base-xform"),s={boolean:(l,c)=>l===void 0?c:l};a.exports=class extends o{get tag(){return"protection"}render(l,c){l.addRollback(),l.openNode("protection");let i=!1;function u(p,f){f!==void 0&&(l.addAttribute(p,f),i=!0)}u("locked",s.boolean(c.locked,!0)?void 0:"0"),u("hidden",s.boolean(c.hidden,!1)?"1":void 0),l.closeNode(),i?l.commit():l.rollback()}parseOpen(l){const c={locked:l.attributes.locked!=="0",hidden:l.attributes.hidden==="1"},i=!c.locked||c.hidden;this.model=i?c:null}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],134:[function(e,a,n){const o=e("../base-xform"),s=e("./alignment-xform"),l=e("./protection-xform");a.exports=class extends o{constructor(c){super(),this.xfId=!(!c||!c.xfId),this.map={alignment:new s,protection:new l}}get tag(){return"xf"}render(c,i){c.openNode("xf",{numFmtId:i.numFmtId||0,fontId:i.fontId||0,fillId:i.fillId||0,borderId:i.borderId||0}),this.xfId&&c.addAttribute("xfId",i.xfId||0),i.numFmtId&&c.addAttribute("applyNumberFormat","1"),i.fontId&&c.addAttribute("applyFont","1"),i.fillId&&c.addAttribute("applyFill","1"),i.borderId&&c.addAttribute("applyBorder","1"),i.alignment&&c.addAttribute("applyAlignment","1"),i.protection&&c.addAttribute("applyProtection","1"),i.alignment&&this.map.alignment.render(c,i.alignment),i.protection&&this.map.protection.render(c,i.protection),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"xf":return this.model={numFmtId:parseInt(c.attributes.numFmtId,10),fontId:parseInt(c.attributes.fontId,10),fillId:parseInt(c.attributes.fillId,10),borderId:parseInt(c.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(c.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(c),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(c),!0;default:return!1}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):c!=="xf"}}},{"../base-xform":32,"./alignment-xform":126,"./protection-xform":133}],135:[function(e,a,n){const o=e("../../../doc/enums"),s=e("../../../utils/xml-stream"),l=e("../base-xform"),c=e("../static-xform"),i=e("../list-xform"),u=e("./font-xform"),p=e("./fill-xform"),f=e("./border-xform"),h=e("./numfmt-xform"),v=e("./style-xform"),b=e("./dxf-xform");class g extends l{constructor(y){super(),this.map={numFmts:new i({tag:"numFmts",count:!0,childXform:new h}),fonts:new i({tag:"fonts",count:!0,childXform:new u,$:{"x14ac:knownFonts":1}}),fills:new i({tag:"fills",count:!0,childXform:new p}),borders:new i({tag:"borders",count:!0,childXform:new f}),cellStyleXfs:new i({tag:"cellStyleXfs",count:!0,childXform:new v}),cellXfs:new i({tag:"cellXfs",count:!0,childXform:new v({xfId:!0})}),dxfs:new i({tag:"dxfs",always:!0,count:!0,childXform:new b}),numFmt:new h,font:new u,fill:new p,border:new f,style:new v({xfId:!0}),cellStyles:g.STATIC_XFORMS.cellStyles,tableStyles:g.STATIC_XFORMS.tableStyles,extLst:g.STATIC_XFORMS.extLst},y&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(y,E){E=E||this.model,y.openXml(s.StdDocAttributes),y.openNode("styleSheet",g.STYLESHEET_ATTRIBUTES),this.index?(E.numFmts&&E.numFmts.length&&(y.openNode("numFmts",{count:E.numFmts.length}),E.numFmts.forEach(N=>{y.writeXml(N)}),y.closeNode()),E.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),y.openNode("fonts",{count:E.fonts.length,"x14ac:knownFonts":1}),E.fonts.forEach(N=>{y.writeXml(N)}),y.closeNode(),y.openNode("fills",{count:E.fills.length}),E.fills.forEach(N=>{y.writeXml(N)}),y.closeNode(),y.openNode("borders",{count:E.borders.length}),E.borders.forEach(N=>{y.writeXml(N)}),y.closeNode(),this.map.cellStyleXfs.render(y,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),y.openNode("cellXfs",{count:E.styles.length}),E.styles.forEach(N=>{y.writeXml(N)}),y.closeNode()):(this.map.numFmts.render(y,E.numFmts),this.map.fonts.render(y,E.fonts),this.map.fills.render(y,E.fills),this.map.borders.render(y,E.borders),this.map.cellStyleXfs.render(y,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(y,E.styles)),g.STATIC_XFORMS.cellStyles.render(y),this.map.dxfs.render(y,E.dxfs),g.STATIC_XFORMS.tableStyles.render(y),g.STATIC_XFORMS.extLst.render(y),y.closeNode()}parseOpen(y){if(this.parser)return this.parser.parseOpen(y),!0;switch(y.name){case"styleSheet":return this.initIndex(),!0;default:return this.parser=this.map[y.name],this.parser&&this.parser.parseOpen(y),!0}}parseText(y){this.parser&&this.parser.parseText(y)}parseClose(y){if(this.parser)return this.parser.parseClose(y)||(this.parser=void 0),!0;switch(y){case"styleSheet":{this.model={};const E=(N,I)=>{I.model&&I.model.length&&(this.model[N]=I.model)};if(E("numFmts",this.map.numFmts),E("fonts",this.map.fonts),E("fills",this.map.fills),E("borders",this.map.borders),E("styles",this.map.cellXfs),E("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){const N=this.index.numFmt;this.model.numFmts.forEach(I=>{N[I.id]=I.formatCode})}return!1}default:return!0}}addStyleModel(y,E){if(!y)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(y))return this.weakMap.get(y);const N={};if(E=E||o.ValueType.Number,y.numFmt)N.numFmtId=this._addNumFmtStr(y.numFmt);else switch(E){case o.ValueType.Number:N.numFmtId=this._addNumFmtStr("General");break;case o.ValueType.Date:N.numFmtId=this._addNumFmtStr("mm-dd-yy")}y.font&&(N.fontId=this._addFont(y.font)),y.border&&(N.borderId=this._addBorder(y.border)),y.fill&&(N.fillId=this._addFill(y.fill)),y.alignment&&(N.alignment=y.alignment),y.protection&&(N.protection=y.protection);const I=this._addStyle(N);return this.weakMap&&this.weakMap.set(y,I),I}getStyleModel(y){const E=this.model.styles[y];if(!E)return null;let N=this.index.model[y];if(N)return N;if(N=this.index.model[y]={},E.numFmtId){const P=this.index.numFmt[E.numFmtId]||h.getDefaultFmtCode(E.numFmtId);P&&(N.numFmt=P)}function I(P,V,U){if(U||U===0){const H=V[U];H&&(N[P]=H)}}return I("font",this.model.fonts,E.fontId),I("border",this.model.borders,E.borderId),I("fill",this.model.fills,E.fillId),E.alignment&&(N.alignment=E.alignment),E.protection&&(N.protection=E.protection),N}addDxfStyle(y){return y.numFmt&&(y.numFmtId=this._addNumFmtStr(y.numFmt)),this.model.dxfs.push(y),this.model.dxfs.length-1}getDxfStyle(y){return this.model.dxfs[y]}_addStyle(y){const E=this.map.style.toXml(y);let N=this.index.style[E];return N===void 0&&(N=this.index.style[E]=this.model.styles.length,this.model.styles.push(E)),N}_addNumFmtStr(y){let E=h.getDefaultFmtId(y);if(E!==void 0||(E=this.index.numFmt[y],E!==void 0))return E;E=this.index.numFmt[y]=164+this.model.numFmts.length;const N=this.map.numFmt.toXml({id:E,formatCode:y});return this.model.numFmts.push(N),E}_addFont(y){const E=this.map.font.toXml(y);let N=this.index.font[E];return N===void 0&&(N=this.index.font[E]=this.model.fonts.length,this.model.fonts.push(E)),N}_addBorder(y){const E=this.map.border.toXml(y);let N=this.index.border[E];return N===void 0&&(N=this.index.border[E]=this.model.borders.length,this.model.borders.push(E)),N}_addFill(y){const E=this.map.fill.toXml(y);let N=this.index.fill[E];return N===void 0&&(N=this.index.fill[E]=this.model.fills.length,this.model.fills.push(E)),N}}g.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"},g.STATIC_XFORMS={cellStyles:new c({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new c({tag:"dxfs",$:{count:0}}),tableStyles:new c({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new c({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})},g.Mock=class extends g{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(x){return x.autodrain(),Promise.resolve()}addStyleModel(x,y){switch(y){case o.ValueType.Date:return this.dateStyleId;default:return 0}}get dateStyleId(){if(!this._dateStyleId){const x={numFmtId:h.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(x)}return this._dateStyleId}getStyleModel(){return{}}},a.exports=g},{"../../../doc/enums":7,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./border-xform":127,"./dxf-xform":129,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./style-xform":134}],136:[function(e,a,n){const o=e("../base-xform");class s extends o{constructor(c){super(),this.model=c}get tag(){return"u"}render(c,i){if((i=i||this.model)===!0)c.leafNode("u");else{const u=s.Attributes[i];u&&c.leafNode("u",u)}}parseOpen(c){c.name==="u"&&(this.model=c.attributes.val||!0)}parseText(){}parseClose(){return!1}}s.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},a.exports=s},{"../base-xform":32}],137:[function(e,a,n){const o=e("../base-xform"),s=e("./filter-column-xform");a.exports=class extends o{constructor(){super(),this.map={filterColumn:new s}}get tag(){return"autoFilter"}prepare(l){l.columns.forEach((c,i)=>{this.map.filterColumn.prepare(c,{index:i})})}render(l,c){return l.openNode(this.tag,{ref:c.autoFilterRef}),c.columns.forEach(i=>{this.map.filterColumn.render(l,i)}),l.closeNode(),!0}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:return this.model={autoFilterRef:l.attributes.ref,columns:[]},!0;default:if(this.parser=this.map[l.name],this.parser)return this.parseOpen(l),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(l))}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;switch(l){case this.tag:return!1;default:throw new Error("Unexpected xml node in parseClose: "+l)}}}},{"../base-xform":32,"./filter-column-xform":139}],138:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"customFilter"}render(s,l){s.leafNode(this.tag,{val:l.val,operator:l.operator})}parseOpen(s){return s.name===this.tag&&(this.model={val:s.attributes.val,operator:s.attributes.operator},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],139:[function(e,a,n){const o=e("../base-xform"),s=e("../list-xform"),l=e("./custom-filter-xform"),c=e("./filter-xform");a.exports=class extends o{constructor(){super(),this.map={customFilters:new s({tag:"customFilters",count:!1,empty:!0,childXform:new l}),filters:new s({tag:"filters",count:!1,empty:!0,childXform:new c})}}get tag(){return"filterColumn"}prepare(i,u){i.colId=u.index.toString()}render(i,u){return u.customFilters?(i.openNode(this.tag,{colId:u.colId,hiddenButton:u.filterButton?"0":"1"}),this.map.customFilters.render(i,u.customFilters),i.closeNode(),!0):(i.leafNode(this.tag,{colId:u.colId,hiddenButton:u.filterButton?"0":"1"}),!0)}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;const{attributes:u}=i;switch(i.name){case this.tag:return this.model={filterButton:u.hiddenButton==="0"},!0;default:if(this.parser=this.map[i.name],this.parser)return this.parseOpen(i),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(i))}}parseText(){}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.parser=void 0),!0;switch(i){case this.tag:return this.model.customFilters=this.map.customFilters.model,!1;default:return!0}}}},{"../base-xform":32,"../list-xform":71,"./custom-filter-xform":138,"./filter-xform":140}],140:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"filter"}render(s,l){s.leafNode(this.tag,{val:l.val})}parseOpen(s){return s.name===this.tag&&(this.model={val:s.attributes.val},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],141:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"tableColumn"}prepare(s,l){s.id=l.index+1}render(s,l){return s.leafNode(this.tag,{id:l.id.toString(),name:l.name,totalsRowLabel:l.totalsRowLabel,totalsRowFunction:l.totalsRowFunction,dxfId:l.dxfId}),!0}parseOpen(s){if(s.name===this.tag){const{attributes:l}=s;return this.model={name:l.name,totalsRowLabel:l.totalsRowLabel,totalsRowFunction:l.totalsRowFunction,dxfId:l.dxfId},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],142:[function(e,a,n){const o=e("../base-xform");a.exports=class extends o{get tag(){return"tableStyleInfo"}render(s,l){return s.leafNode(this.tag,{name:l.theme?l.theme:void 0,showFirstColumn:l.showFirstColumn?"1":"0",showLastColumn:l.showLastColumn?"1":"0",showRowStripes:l.showRowStripes?"1":"0",showColumnStripes:l.showColumnStripes?"1":"0"}),!0}parseOpen(s){if(s.name===this.tag){const{attributes:l}=s;return this.model={theme:l.name?l.name:null,showFirstColumn:l.showFirstColumn==="1",showLastColumn:l.showLastColumn==="1",showRowStripes:l.showRowStripes==="1",showColumnStripes:l.showColumnStripes==="1"},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],143:[function(e,a,n){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("../list-xform"),c=e("./auto-filter-xform"),i=e("./table-column-xform"),u=e("./table-style-info-xform");class p extends s{constructor(){super(),this.map={autoFilter:new c,tableColumns:new l({tag:"tableColumns",count:!0,empty:!0,childXform:new i}),tableStyleInfo:new u}}prepare(h,v){this.map.autoFilter.prepare(h),this.map.tableColumns.prepare(h.columns,v)}get tag(){return"table"}render(h,v){h.openXml(o.StdDocAttributes),h.openNode(this.tag,{...p.TABLE_ATTRIBUTES,id:v.id,name:v.name,displayName:v.displayName||v.name,ref:v.tableRef,totalsRowCount:v.totalsRow?"1":void 0,totalsRowShown:v.totalsRow?void 0:"1",headerRowCount:v.headerRow?"1":"0"}),this.map.autoFilter.render(h,v),this.map.tableColumns.render(h,v.columns),this.map.tableStyleInfo.render(h,v.style),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;const{name:v,attributes:b}=h;switch(v){case this.tag:this.reset(),this.model={name:b.name,displayName:b.displayName||b.name,tableRef:b.ref,totalsRow:b.totalsRowCount==="1",headerRow:b.headerRowCount==="1"};break;default:this.parser=this.map[h.name],this.parser&&this.parser.parseOpen(h)}return!0}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){if(this.parser)return this.parser.parseClose(h)||(this.parser=void 0),!0;switch(h){case this.tag:return this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach((v,b)=>{this.model.columns[b].filterButton=v.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1;default:return!0}}reconcile(h,v){h.columns.forEach(b=>{b.dxfId!==void 0&&(b.style=v.styles.getDxfStyle(b.dxfId))})}}p.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},a.exports=p},{"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":137,"./table-column-xform":141,"./table-style-info-xform":142}],144:[function(e,a,n){(function(o,s){(function(){const l=e("fs"),c=e("jszip"),{PassThrough:i}=e("readable-stream"),u=e("../utils/zip-stream"),p=e("../utils/stream-buf"),f=e("../utils/utils"),h=e("../utils/xml-stream"),{bufferToString:v}=e("../utils/browser-buffer-decode"),b=e("./xform/style/styles-xform"),g=e("./xform/core/core-xform"),x=e("./xform/strings/shared-strings-xform"),y=e("./xform/core/relationships-xform"),E=e("./xform/core/content-types-xform"),N=e("./xform/core/app-xform"),I=e("./xform/book/workbook-xform"),P=e("./xform/sheet/worksheet-xform"),V=e("./xform/drawing/drawing-xform"),U=e("./xform/table/table-xform"),H=e("./xform/comment/comments-xform"),G=e("./xform/comment/vml-notes-xform"),Z=e("./xml/theme1");class W{constructor(R){this.workbook=R}async readFile(R,C){if(!await f.fs.exists(R))throw new Error("File not found: "+R);const _=l.createReadStream(R);try{const k=await this.read(_,C);return _.close(),k}catch(k){throw _.close(),k}}parseRels(R){return new y().parseStream(R)}parseWorkbook(R){return new I().parseStream(R)}parseSharedStrings(R){return new x().parseStream(R)}reconcile(R,C){const _=new I,k=new P(C),A=new V,T=new U;_.reconcile(R);const D={media:R.media,mediaIndex:R.mediaIndex};Object.keys(R.drawings).forEach(Y=>{const X=R.drawings[Y],re=R.drawingRels[Y];re&&(D.rels=re.reduce((z,ee)=>(z[ee.Id]=ee,z),{}),(X.anchors||[]).forEach(z=>{const ee=z.picture&&z.picture.hyperlinks;ee&&D.rels[ee.rId]&&(ee.hyperlink=D.rels[ee.rId].Target,delete ee.rId)}),A.reconcile(X,D))});const B={styles:R.styles};Object.values(R.tables).forEach(Y=>{T.reconcile(Y,B)});const F={styles:R.styles,sharedStrings:R.sharedStrings,media:R.media,mediaIndex:R.mediaIndex,date1904:R.properties&&R.properties.date1904,drawings:R.drawings,comments:R.comments,tables:R.tables,vmlDrawings:R.vmlDrawings};R.worksheets.forEach(Y=>{Y.relationships=R.worksheetRels[Y.sheetNo],k.reconcile(Y,F)}),delete R.worksheetHash,delete R.worksheetRels,delete R.globalRels,delete R.sharedStrings,delete R.workbookRels,delete R.sheetDefs,delete R.styles,delete R.mediaIndex,delete R.drawings,delete R.drawingRels,delete R.vmlDrawings}async _processWorksheetEntry(R,C,_,k,A){const T=new P(k),D=await T.parseStream(R);D.sheetNo=_,C.worksheetHash[A]=D,C.worksheets.push(D)}async _processCommentEntry(R,C,_){const k=new H,A=await k.parseStream(R);C.comments[`../${_}.xml`]=A}async _processTableEntry(R,C,_){const k=new U,A=await k.parseStream(R);C.tables[`../tables/${_}.xml`]=A}async _processWorksheetRelsEntry(R,C,_){const k=new y,A=await k.parseStream(R);C.worksheetRels[_]=A}async _processMediaEntry(R,C,_){const k=_.lastIndexOf(".");if(k>=1){const A=_.substr(k+1),T=_.substr(0,k);await new Promise((D,B)=>{const F=new p;F.on("finish",()=>{C.mediaIndex[_]=C.media.length,C.mediaIndex[T]=C.media.length;const Y={type:"image",name:T,extension:A,buffer:F.toBuffer()};C.media.push(Y),D()}),R.on("error",Y=>{B(Y)}),R.pipe(F)})}}async _processDrawingEntry(R,C,_){const k=new V,A=await k.parseStream(R);C.drawings[_]=A}async _processDrawingRelsEntry(R,C,_){const k=new y,A=await k.parseStream(R);C.drawingRels[_]=A}async _processVmlDrawingEntry(R,C,_){const k=new G,A=await k.parseStream(R);C.vmlDrawings[`../drawings/${_}.vml`]=A}async _processThemeEntry(R,C,_){await new Promise((k,A)=>{const T=new p;R.on("error",A),T.on("error",A),T.on("finish",()=>{C.themes[_]=T.read().toString(),k()}),R.pipe(T)})}createInputStream(){throw new Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}async read(R,C){!R[Symbol.asyncIterator]&&R.pipe&&(R=R.pipe(new i));const _=[];for await(const k of R)_.push(k);return this.load(s.concat(_),C)}async load(R,C){let _;_=C&&C.base64?s.from(R.toString(),"base64"):R;const k={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}},A=await c.loadAsync(_);for(const T of Object.values(A.files))if(!T.dir){let D,B=T.name;if(B[0]==="/"&&(B=B.substr(1)),B.match(/xl\/media\//)||B.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))D=new i,D.write(await T.async("nodebuffer"));else{let F;D=new i({writableObjectMode:!0,readableObjectMode:!0}),F=o.browser?v(await T.async("nodebuffer")):await T.async("string");const Y=16384;for(let X=0;X<F.length;X+=Y)D.write(F.substring(X,X+Y))}switch(D.end(),B){case"_rels/.rels":k.globalRels=await this.parseRels(D);break;case"xl/workbook.xml":{const F=await this.parseWorkbook(D);k.sheets=F.sheets,k.definedNames=F.definedNames,k.views=F.views,k.properties=F.properties,k.calcProperties=F.calcProperties;break}case"xl/_rels/workbook.xml.rels":k.workbookRels=await this.parseRels(D);break;case"xl/sharedStrings.xml":k.sharedStrings=new x,await k.sharedStrings.parseStream(D);break;case"xl/styles.xml":k.styles=new b,await k.styles.parseStream(D);break;case"docProps/app.xml":{const F=new N,Y=await F.parseStream(D);k.company=Y.company,k.manager=Y.manager;break}case"docProps/core.xml":{const F=new g,Y=await F.parseStream(D);Object.assign(k,Y);break}default:{let F=B.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if(F){await this._processWorksheetEntry(D,k,F[1],C,B);break}if(F=B.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),F){await this._processWorksheetRelsEntry(D,k,F[1]);break}if(F=B.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/),F){await this._processThemeEntry(D,k,F[1]);break}if(F=B.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/),F){await this._processMediaEntry(D,k,F[1]);break}if(F=B.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/),F){await this._processDrawingEntry(D,k,F[1]);break}if(F=B.match(/xl\/(comments\d+)[.]xml/),F){await this._processCommentEntry(D,k,F[1]);break}if(F=B.match(/xl\/tables\/(table\d+)[.]xml/),F){await this._processTableEntry(D,k,F[1]);break}if(F=B.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/),F){await this._processDrawingRelsEntry(D,k,F[1]);break}if(F=B.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/),F){await this._processVmlDrawingEntry(D,k,F[1]);break}}}}return this.reconcile(k,C),this.workbook.model=k,this.workbook}async addMedia(R,C){await Promise.all(C.media.map(async _=>{if(_.type==="image"){const k=`xl/media/${_.name}.${_.extension}`;if(_.filename){const A=await function(T,D){return new Promise((B,F)=>{l.readFile(T,D,(Y,X)=>{Y?F(Y):B(X)})})}(_.filename);return R.append(A,{name:k})}if(_.buffer)return R.append(_.buffer,{name:k});if(_.base64){const A=_.base64,T=A.substring(A.indexOf(",")+1);return R.append(T,{name:k,base64:!0})}}throw new Error("Unsupported media")}))}addDrawings(R,C){const _=new V,k=new y;C.worksheets.forEach(A=>{const{drawing:T}=A;if(T){_.prepare(T,{});let D=_.toXml(T);R.append(D,{name:`xl/drawings/${T.name}.xml`}),D=k.toXml(T.rels),R.append(D,{name:`xl/drawings/_rels/${T.name}.xml.rels`})}})}addTables(R,C){const _=new U;C.worksheets.forEach(k=>{const{tables:A}=k;A.forEach(T=>{_.prepare(T,{});const D=_.toXml(T);R.append(D,{name:"xl/tables/"+T.target})})})}async addContentTypes(R,C){const _=new E().toXml(C);R.append(_,{name:"[Content_Types].xml"})}async addApp(R,C){const _=new N().toXml(C);R.append(_,{name:"docProps/app.xml"})}async addCore(R,C){const _=new g;R.append(_.toXml(C),{name:"docProps/core.xml"})}async addThemes(R,C){const _=C.themes||{theme1:Z};Object.keys(_).forEach(k=>{const A=_[k],T=`xl/theme/${k}.xml`;R.append(A,{name:T})})}async addOfficeRels(R){const C=new y().toXml([{Id:"rId1",Type:W.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:W.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:W.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);R.append(C,{name:"_rels/.rels"})}async addWorkbookRels(R,C){let _=1;const k=[{Id:"rId"+_++,Type:W.RelType.Styles,Target:"styles.xml"},{Id:"rId"+_++,Type:W.RelType.Theme,Target:"theme/theme1.xml"}];C.sharedStrings.count&&k.push({Id:"rId"+_++,Type:W.RelType.SharedStrings,Target:"sharedStrings.xml"}),C.worksheets.forEach(T=>{T.rId="rId"+_++,k.push({Id:T.rId,Type:W.RelType.Worksheet,Target:`worksheets/sheet${T.id}.xml`})});const A=new y().toXml(k);R.append(A,{name:"xl/_rels/workbook.xml.rels"})}async addSharedStrings(R,C){C.sharedStrings&&C.sharedStrings.count&&R.append(C.sharedStrings.xml,{name:"xl/sharedStrings.xml"})}async addStyles(R,C){const{xml:_}=C.styles;_&&R.append(_,{name:"xl/styles.xml"})}async addWorkbook(R,C){const _=new I;R.append(_.toXml(C),{name:"xl/workbook.xml"})}async addWorksheets(R,C){const _=new P,k=new y,A=new H,T=new G;C.worksheets.forEach(D=>{let B=new h;_.render(B,D),R.append(B.xml,{name:`xl/worksheets/sheet${D.id}.xml`}),D.rels&&D.rels.length&&(B=new h,k.render(B,D.rels),R.append(B.xml,{name:`xl/worksheets/_rels/sheet${D.id}.xml.rels`})),D.comments.length>0&&(B=new h,A.render(B,D),R.append(B.xml,{name:`xl/comments${D.id}.xml`}),B=new h,T.render(B,D),R.append(B.xml,{name:`xl/drawings/vmlDrawing${D.id}.vml`}))})}_finalize(R){return new Promise((C,_)=>{R.on("finish",()=>{C(this)}),R.on("error",_),R.finalize()})}prepareModel(R,C){R.creator=R.creator||"ExcelJS",R.lastModifiedBy=R.lastModifiedBy||"ExcelJS",R.created=R.created||new Date,R.modified=R.modified||new Date,R.useSharedStrings=C.useSharedStrings===void 0||C.useSharedStrings,R.useStyles=C.useStyles===void 0||C.useStyles,R.sharedStrings=new x,R.styles=R.useStyles?new b(!0):new b.Mock;const _=new I,k=new P;_.prepare(R);const A={sharedStrings:R.sharedStrings,styles:R.styles,date1904:R.properties.date1904,drawingsCount:0,media:R.media};A.drawings=R.drawings=[],A.commentRefs=R.commentRefs=[];let T=0;R.tables=[],R.worksheets.forEach(D=>{D.tables.forEach(B=>{T++,B.target=`table${T}.xml`,B.id=T,R.tables.push(B)}),k.prepare(D,A)})}async write(R,C){C=C||{};const{model:_}=this.workbook,k=new u.ZipWriter(C.zip);return k.pipe(R),this.prepareModel(_,C),await this.addContentTypes(k,_),await this.addOfficeRels(k,_),await this.addWorkbookRels(k,_),await this.addWorksheets(k,_),await this.addSharedStrings(k,_),await this.addDrawings(k,_),await this.addTables(k,_),await Promise.all([this.addThemes(k,_),this.addStyles(k,_)]),await this.addMedia(k,_),await Promise.all([this.addApp(k,_),this.addCore(k,_)]),await this.addWorkbook(k,_),this._finalize(k)}writeFile(R,C){const _=l.createWriteStream(R);return new Promise((k,A)=>{_.on("finish",()=>{k()}),_.on("error",T=>{A(T)}),this.write(_,C).then(()=>{_.end()}).catch(T=>{A(T)})})}async writeBuffer(R){const C=new p;return await this.write(C,R),C.read()}}W.RelType=e("./rel-type"),a.exports=W}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"../utils/browser-buffer-decode":16,"../utils/stream-buf":24,"../utils/utils":27,"../utils/xml-stream":28,"../utils/zip-stream":29,"./rel-type":31,"./xform/book/workbook-xform":38,"./xform/comment/comments-xform":40,"./xform/comment/vml-notes-xform":45,"./xform/core/app-xform":51,"./xform/core/content-types-xform":52,"./xform/core/core-xform":53,"./xform/core/relationships-xform":55,"./xform/drawing/drawing-xform":62,"./xform/sheet/worksheet-xform":115,"./xform/strings/shared-strings-xform":124,"./xform/style/styles-xform":135,"./xform/table/table-xform":143,"./xml/theme1":145,_process:467,buffer:220,fs:216,jszip:441,"readable-stream":491}],145:[function(e,a,n){a.exports=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>`},{}],146:[function(e,a,n){(function(o){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.CsvFormatterStream=void 0;const s=e("stream"),l=e("./formatter");class c extends s.Transform{constructor(u){super({writableObjectMode:u.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=u,this.rowFormatter=new l.RowFormatter(u),this.hasWrittenBOM=!u.writeBOM}transform(u){return this.rowFormatter.rowTransform=u,this}_transform(u,p,f){let h=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(u,(v,b)=>v?(h=!0,f(v)):(b&&b.forEach(g=>{this.push(o.from(g,"utf8"))}),h=!0,f()))}catch(v){if(h)throw v;f(v)}}_flush(u){this.rowFormatter.finish((p,f)=>p?u(p):(f&&f.forEach(h=>{this.push(o.from(h,"utf8"))}),u()))}}n.CsvFormatterStream=c}).call(this)}).call(this,e("buffer").Buffer)},{"./formatter":150,buffer:220,stream:505}],147:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FormatterOptions=void 0,n.FormatterOptions=class{constructor(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var s;this.objectMode=!0,this.delimiter=",",this.rowDelimiter=`
`,this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,o||{}),(o==null?void 0:o.quoteHeaders)===void 0&&(this.quoteHeaders=this.quoteColumns),(o==null?void 0:o.quote)===!0?this.quote='"':(o==null?void 0:o.quote)===!1&&(this.quote=""),typeof(o==null?void 0:o.escape)!="string"&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&((s=o.writeHeaders)===null||s===void 0||s),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote=`${this.escape}${this.quote}`}}},{}],148:[function(e,a,n){var o=function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(n,"__esModule",{value:!0}),n.FieldFormatter=void 0;const s=o(e("lodash.isboolean")),l=o(e("lodash.isnil")),c=o(e("lodash.escaperegexp"));n.FieldFormatter=class{constructor(i){this._headers=null,this.formatterOptions=i,i.headers!==null&&(this.headers=i.headers),this.REPLACE_REGEXP=new RegExp(i.quote,"g");const u=`[${i.delimiter}${c.default(i.rowDelimiter)}|\r|
]`;this.ESCAPE_REGEXP=new RegExp(u)}set headers(i){this._headers=i}shouldQuote(i,u){const p=u?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return s.default(p)?p:Array.isArray(p)?p[i]:this._headers!==null&&p[this._headers[i]]}format(i,u,p){const f=(""+(l.default(i)?"":i)).replace(/\0/g,""),{formatterOptions:h}=this;return h.quote!==""&&f.indexOf(h.quote)!==-1?this.quoteField(f.replace(this.REPLACE_REGEXP,h.escapedQuote)):f.search(this.ESCAPE_REGEXP)!==-1||this.shouldQuote(u,p)?this.quoteField(f):f}quoteField(i){const{quote:u}=this.formatterOptions;return`${u}${i}${u}`}}},{"lodash.escaperegexp":442,"lodash.isboolean":444,"lodash.isnil":447}],149:[function(e,a,n){var o=function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(n,"__esModule",{value:!0}),n.RowFormatter=void 0;const s=o(e("lodash.isfunction")),l=o(e("lodash.isequal")),c=e("./FieldFormatter"),i=e("../types");class u{constructor(f){this.rowCount=0,this.formatterOptions=f,this.fieldFormatter=new c.FieldFormatter(f),this.headers=f.headers,this.shouldWriteHeaders=f.shouldWriteHeaders,this.hasWrittenHeaders=!1,this.headers!==null&&(this.fieldFormatter.headers=this.headers),f.transform&&(this.rowTransform=f.transform)}static isRowHashArray(f){return!!Array.isArray(f)&&Array.isArray(f[0])&&f[0].length===2}static isRowArray(f){return Array.isArray(f)&&!this.isRowHashArray(f)}static gatherHeaders(f){return u.isRowHashArray(f)?f.map(h=>h[0]):Array.isArray(f)?f:Object.keys(f)}static createTransform(f){return i.isSyncTransform(f)?(h,v)=>{let b=null;try{b=f(h)}catch(g){return v(g)}return v(null,b)}:(h,v)=>{f(h,v)}}set rowTransform(f){if(!s.default(f))throw new TypeError("The transform should be a function");this._rowTransform=u.createTransform(f)}format(f,h){this.callTransformer(f,(v,b)=>{if(v)return h(v);if(!f)return h(null);const g=[];if(b){const{shouldFormatColumns:x,headers:y}=this.checkHeaders(b);if(this.shouldWriteHeaders&&y&&!this.hasWrittenHeaders&&(g.push(this.formatColumns(y,!0)),this.hasWrittenHeaders=!0),x){const E=this.gatherColumns(b);g.push(this.formatColumns(E,!1))}}return h(null,g)})}finish(f){const h=[];if(this.formatterOptions.alwaysWriteHeaders&&this.rowCount===0){if(!this.headers)return f(new Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));h.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&h.push(this.formatterOptions.rowDelimiter),f(null,h)}checkHeaders(f){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};const h=u.gatherHeaders(f);return this.headers=h,this.fieldFormatter.headers=h,this.shouldWriteHeaders?{shouldFormatColumns:!l.default(h,f),headers:h}:{shouldFormatColumns:!0,headers:null}}gatherColumns(f){if(this.headers===null)throw new Error("Headers is currently null");return Array.isArray(f)?u.isRowHashArray(f)?this.headers.map((h,v)=>{const b=f[v];return b?b[1]:""}):u.isRowArray(f)&&!this.shouldWriteHeaders?f:this.headers.map((h,v)=>f[v]):this.headers.map(h=>f[h])}callTransformer(f,h){return this._rowTransform?this._rowTransform(f,h):h(null,f)}formatColumns(f,h){const v=f.map((g,x)=>this.fieldFormatter.format(g,x,h)).join(this.formatterOptions.delimiter),{rowCount:b}=this;return this.rowCount+=1,b?[this.formatterOptions.rowDelimiter,v].join(""):v}}n.RowFormatter=u},{"../types":152,"./FieldFormatter":148,"lodash.isequal":445,"lodash.isfunction":446}],150:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldFormatter=n.RowFormatter=void 0;var o=e("./RowFormatter");Object.defineProperty(n,"RowFormatter",{enumerable:!0,get:function(){return o.RowFormatter}});var s=e("./FieldFormatter");Object.defineProperty(n,"FieldFormatter",{enumerable:!0,get:function(){return s.FieldFormatter}})},{"./FieldFormatter":148,"./RowFormatter":149}],151:[function(e,a,n){(function(o){(function(){var s=Object.create?function(x,y,E,N){N===void 0&&(N=E),Object.defineProperty(x,N,{enumerable:!0,get:function(){return y[E]}})}:function(x,y,E,N){N===void 0&&(N=E),x[N]=y[E]},l=Object.create?function(x,y){Object.defineProperty(x,"default",{enumerable:!0,value:y})}:function(x,y){x.default=y},c=function(x){if(x&&x.__esModule)return x;var y={};if(x!=null)for(var E in x)E!=="default"&&Object.prototype.hasOwnProperty.call(x,E)&&s(y,x,E);return l(y,x),y},i=function(x,y){for(var E in x)E==="default"||Object.prototype.hasOwnProperty.call(y,E)||s(y,x,E)};Object.defineProperty(n,"__esModule",{value:!0}),n.writeToPath=n.writeToString=n.writeToBuffer=n.writeToStream=n.write=n.format=n.FormatterOptions=n.CsvFormatterStream=void 0;const u=e("util"),p=e("stream"),f=c(e("fs")),h=e("./FormatterOptions"),v=e("./CsvFormatterStream");i(e("./types"),n);var b=e("./CsvFormatterStream");Object.defineProperty(n,"CsvFormatterStream",{enumerable:!0,get:function(){return b.CsvFormatterStream}});var g=e("./FormatterOptions");Object.defineProperty(n,"FormatterOptions",{enumerable:!0,get:function(){return g.FormatterOptions}}),n.format=x=>new v.CsvFormatterStream(new h.FormatterOptions(x)),n.write=(x,y)=>{const E=n.format(y),N=u.promisify((I,P)=>{E.write(I,void 0,P)});return x.reduce((I,P)=>I.then(()=>N(P)),Promise.resolve()).then(()=>E.end()).catch(I=>{E.emit("error",I)}),E},n.writeToStream=(x,y,E)=>n.write(y,E).pipe(x),n.writeToBuffer=function(x){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const E=[],N=new p.Writable({write(I,P,V){E.push(I),V()}});return new Promise((I,P)=>{N.on("error",P).on("finish",()=>I(o.concat(E))),n.write(x,y).pipe(N)})},n.writeToString=(x,y)=>n.writeToBuffer(x,y).then(E=>E.toString()),n.writeToPath=(x,y,E)=>{const N=f.createWriteStream(x,{encoding:"utf8"});return n.write(y,E).pipe(N)}}).call(this)}).call(this,e("buffer").Buffer)},{"./CsvFormatterStream":146,"./FormatterOptions":147,"./types":152,buffer:220,fs:216,stream:505,util:527}],152:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isSyncTransform=void 0,n.isSyncTransform=o=>o.length===1},{}],153:[function(e,a,n){(function(o){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.CsvParserStream=void 0;const s=e("string_decoder"),l=e("stream"),c=e("./transforms"),i=e("./parser");class u extends l.Transform{constructor(f){super({objectMode:f.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=f,this.parser=new i.Parser(f),this.headerTransformer=new c.HeaderTransformer(f),this.decoder=new s.StringDecoder(f.encoding),this.rowTransformerValidator=new c.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(f){return this.rowTransformerValidator.rowTransform=f,this}validate(f){return this.rowTransformerValidator.rowValidator=f,this}emit(f){if(f==="end")return this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1;for(var h=arguments.length,v=new Array(h>1?h-1:0),b=1;b<h;b++)v[b-1]=arguments[b];return super.emit(f,...v)}_transform(f,h,v){if(this.hasHitRowLimit)return v();const b=u.wrapDoneCallback(v);try{const{lines:g}=this,x=g+this.decoder.write(f),y=this.parse(x,!0);return this.processRows(y,b)}catch(g){return b(g)}}_flush(f){const h=u.wrapDoneCallback(f);if(this.hasHitRowLimit)return h();try{const v=this.lines+this.decoder.end(),b=this.parse(v,!1);return this.processRows(b,h)}catch(v){return h(v)}}parse(f,h){if(!f)return[];const{line:v,rows:b}=this.parser.parse(f,h);return this.lines=v,b}processRows(f,h){const v=f.length,b=g=>{const x=N=>N?h(N):g%100!=0?b(g+1):void o(()=>b(g+1));if(this.checkAndEmitHeaders(),g>=v||this.hasHitRowLimit)return h();if(this.parsedLineCount+=1,this.shouldSkipLine)return x();const y=f[g];this.rowCount+=1,this.parsedRowCount+=1;const E=this.rowCount;return this.transformRow(y,(N,I)=>{if(N)return this.rowCount-=1,x(N);if(!I)return x(new Error("expected transform result"));if(I.isValid){if(I.row)return this.pushRow(I.row,x)}else this.emit("data-invalid",I.row,E,I.reason);return x()})};b(0)}transformRow(f,h){try{this.headerTransformer.transform(f,(v,b)=>v?h(v):b?b.isValid?b.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(b.row,h):this.skipRow(h):(this.rowCount-=1,this.parsedRowCount-=1,h(null,{row:null,isValid:!0})):this.shouldEmitRows?h(null,{isValid:!1,row:f}):this.skipRow(h):h(new Error("Expected result from header transform")))}catch(v){h(v)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(f){return this.rowCount-=1,f(null,{row:null,isValid:!0})}pushRow(f,h){try{this.parserOptions.objectMode?this.push(f):this.push(JSON.stringify(f)),h()}catch(v){h(v)}}static wrapDoneCallback(f){let h=!1;return function(v){if(v){if(h)throw v;return h=!0,void f(v)}for(var b=arguments.length,g=new Array(b>1?b-1:0),x=1;x<b;x++)g[x-1]=arguments[x];f(...g)}}}n.CsvParserStream=u}).call(this)}).call(this,e("timers").setImmediate)},{"./parser":165,"./transforms":168,stream:505,string_decoder:218,timers:523}],154:[function(e,a,n){var o=function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(n,"__esModule",{value:!0}),n.ParserOptions=void 0;const s=o(e("lodash.escaperegexp")),l=o(e("lodash.isnil"));n.ParserOptions=class{constructor(c){var i;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,c||{}),this.delimiter.length>1)throw new Error("delimiter option must be one character long");this.escapedDelimiter=s.default(this.delimiter),this.escapeChar=(i=this.escape)!==null&&i!==void 0?i:this.quote,this.supportsComments=!l.default(this.comment),this.NEXT_TOKEN_REGEXP=new RegExp(`([^\\s]|\\r\\n|\\n|\\r|${this.escapedDelimiter})`),this.maxRows>0&&(this.limitRows=!0)}}},{"lodash.escaperegexp":442,"lodash.isnil":447}],155:[function(e,a,n){var o=Object.create?function(b,g,x,y){y===void 0&&(y=x),Object.defineProperty(b,y,{enumerable:!0,get:function(){return g[x]}})}:function(b,g,x,y){y===void 0&&(y=x),b[y]=g[x]},s=Object.create?function(b,g){Object.defineProperty(b,"default",{enumerable:!0,value:g})}:function(b,g){b.default=g},l=function(b){if(b&&b.__esModule)return b;var g={};if(b!=null)for(var x in b)x!=="default"&&Object.prototype.hasOwnProperty.call(b,x)&&o(g,b,x);return s(g,b),g},c=function(b,g){for(var x in b)x==="default"||Object.prototype.hasOwnProperty.call(g,x)||o(g,b,x)};Object.defineProperty(n,"__esModule",{value:!0}),n.parseString=n.parseFile=n.parseStream=n.parse=n.ParserOptions=n.CsvParserStream=void 0;const i=l(e("fs")),u=e("stream"),p=e("./ParserOptions"),f=e("./CsvParserStream");c(e("./types"),n);var h=e("./CsvParserStream");Object.defineProperty(n,"CsvParserStream",{enumerable:!0,get:function(){return h.CsvParserStream}});var v=e("./ParserOptions");Object.defineProperty(n,"ParserOptions",{enumerable:!0,get:function(){return v.ParserOptions}}),n.parse=b=>new f.CsvParserStream(new p.ParserOptions(b)),n.parseStream=(b,g)=>b.pipe(new f.CsvParserStream(new p.ParserOptions(g))),n.parseFile=function(b){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return i.createReadStream(b).pipe(new f.CsvParserStream(new p.ParserOptions(g)))},n.parseString=(b,g)=>{const x=new u.Readable;return x.push(b),x.push(null),x.pipe(new f.CsvParserStream(new p.ParserOptions(g)))}},{"./CsvParserStream":153,"./ParserOptions":154,"./types":169,fs:216,stream:505}],156:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Parser=void 0;const o=e("./Scanner"),s=e("./RowParser"),l=e("./Token");class c{constructor(u){this.parserOptions=u,this.rowParser=new s.RowParser(this.parserOptions)}static removeBOM(u){return u&&u.charCodeAt(0)===65279?u.slice(1):u}parse(u,p){const f=new o.Scanner({line:c.removeBOM(u),parserOptions:this.parserOptions,hasMoreData:p});return this.parserOptions.supportsComments?this.parseWithComments(f):this.parseWithoutComments(f)}parseWithoutComments(u){const p=[];let f=!0;for(;f;)f=this.parseRow(u,p);return{line:u.line,rows:p}}parseWithComments(u){const{parserOptions:p}=this,f=[];for(let h=u.nextCharacterToken;h!==null;h=u.nextCharacterToken)if(l.Token.isTokenComment(h,p)){if(u.advancePastLine()===null)return{line:u.lineFromCursor,rows:f};if(!u.hasMoreCharacters)return{line:u.lineFromCursor,rows:f};u.truncateToCursor()}else if(!this.parseRow(u,f))break;return{line:u.line,rows:f}}parseRow(u,p){if(!u.nextNonSpaceToken)return!1;const f=this.rowParser.parse(u);return f!==null&&(this.parserOptions.ignoreEmpty&&s.RowParser.isEmptyRow(f)||p.push(f),!0)}}n.Parser=c},{"./RowParser":157,"./Scanner":158,"./Token":159}],157:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.RowParser=void 0;const o=e("./column"),s=e("./Token");n.RowParser=class{constructor(l){this.parserOptions=l,this.columnParser=new o.ColumnParser(l)}static isEmptyRow(l){return l.join("").replace(/\s+/g,"")===""}parse(l){const{parserOptions:c}=this,{hasMoreData:i}=l,u=l,p=[];let f=this.getStartToken(u,p);for(;f;){if(s.Token.isTokenRowDelimiter(f))return u.advancePastToken(f),!u.hasMoreCharacters&&s.Token.isTokenCarriageReturn(f,c)&&i?null:(u.truncateToCursor(),p);if(!this.shouldSkipColumnParse(u,f,p)){const h=this.columnParser.parse(u);if(h===null)return null;p.push(h)}f=u.nextNonSpaceToken}return i?null:(u.truncateToCursor(),p)}getStartToken(l,c){const i=l.nextNonSpaceToken;return i!==null&&s.Token.isTokenDelimiter(i,this.parserOptions)?(c.push(""),l.nextNonSpaceToken):i}shouldSkipColumnParse(l,c,i){const{parserOptions:u}=this;if(s.Token.isTokenDelimiter(c,u)){l.advancePastToken(c);const p=l.nextCharacterToken;if(!l.hasMoreCharacters||p!==null&&s.Token.isTokenRowDelimiter(p)||p!==null&&s.Token.isTokenDelimiter(p,u))return i.push(""),!0}return!1}}},{"./Token":159,"./column":164}],158:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Scanner=void 0;const o=e("./Token"),s=/((?:\r\n)|\n|\r)/;n.Scanner=class{constructor(l){this.cursor=0,this.line=l.line,this.lineLength=this.line.length,this.parserOptions=l.parserOptions,this.hasMoreData=l.hasMoreData,this.cursor=l.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){const{lineFromCursor:l}=this,c=this.parserOptions.NEXT_TOKEN_REGEXP;if(l.search(c)===-1)return null;const i=c.exec(l);if(i==null)return null;const u=i[1],p=this.cursor+(i.index||0);return new o.Token({token:u,startCursor:p,endCursor:p+u.length-1})}get nextCharacterToken(){const{cursor:l,lineLength:c}=this;return c<=l?null:new o.Token({token:this.line[l],startCursor:l,endCursor:l})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){const l=s.exec(this.lineFromCursor);return l?(this.cursor+=(l.index||0)+l[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(l){return this.cursor=l,this}advanceToToken(l){return this.cursor=l.startCursor,this}advancePastToken(l){return this.cursor=l.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}}},{"./Token":159}],159:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Token=void 0,n.Token=class{constructor(o){this.token=o.token,this.startCursor=o.startCursor,this.endCursor=o.endCursor}static isTokenRowDelimiter(o){const s=o.token;return s==="\r"||s===`
`||s===`\r
`}static isTokenCarriageReturn(o,s){return o.token===s.carriageReturn}static isTokenComment(o,s){return s.supportsComments&&!!o&&o.token===s.comment}static isTokenEscapeCharacter(o,s){return o.token===s.escapeChar}static isTokenQuote(o,s){return o.token===s.quote}static isTokenDelimiter(o,s){return o.token===s.delimiter}}},{}],160:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ColumnFormatter=void 0,n.ColumnFormatter=class{constructor(o){o.trim?this.format=s=>s.trim():o.ltrim?this.format=s=>s.trimLeft():o.rtrim?this.format=s=>s.trimRight():this.format=s=>s}}},{}],161:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ColumnParser=void 0;const o=e("./NonQuotedColumnParser"),s=e("./QuotedColumnParser"),l=e("../Token");n.ColumnParser=class{constructor(c){this.parserOptions=c,this.quotedColumnParser=new s.QuotedColumnParser(c),this.nonQuotedColumnParser=new o.NonQuotedColumnParser(c)}parse(c){const{nextNonSpaceToken:i}=c;return i!==null&&l.Token.isTokenQuote(i,this.parserOptions)?(c.advanceToToken(i),this.quotedColumnParser.parse(c)):this.nonQuotedColumnParser.parse(c)}}},{"../Token":159,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],162:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.NonQuotedColumnParser=void 0;const o=e("./ColumnFormatter"),s=e("../Token");n.NonQuotedColumnParser=class{constructor(l){this.parserOptions=l,this.columnFormatter=new o.ColumnFormatter(l)}parse(l){if(!l.hasMoreCharacters)return null;const{parserOptions:c}=this,i=[];let u=l.nextCharacterToken;for(;u&&!s.Token.isTokenDelimiter(u,c)&&!s.Token.isTokenRowDelimiter(u);u=l.nextCharacterToken)i.push(u.token),l.advancePastToken(u);return this.columnFormatter.format(i.join(""))}}},{"../Token":159,"./ColumnFormatter":160}],163:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.QuotedColumnParser=void 0;const o=e("./ColumnFormatter"),s=e("../Token");n.QuotedColumnParser=class{constructor(l){this.parserOptions=l,this.columnFormatter=new o.ColumnFormatter(l)}parse(l){if(!l.hasMoreCharacters)return null;const c=l.cursor,{foundClosingQuote:i,col:u}=this.gatherDataBetweenQuotes(l);if(!i){if(l.advanceTo(c),!l.hasMoreData)throw new Error(`Parse Error: missing closing: '${this.parserOptions.quote||""}' in line: at '${l.lineFromCursor.replace(/[\r\n]/g,"\\n'")}'`);return null}return this.checkForMalformedColumn(l),u}gatherDataBetweenQuotes(l){const{parserOptions:c}=this;let i=!1,u=!1;const p=[];let f=l.nextCharacterToken;for(;!u&&f!==null;f=l.nextCharacterToken){const h=s.Token.isTokenQuote(f,c);if(!i&&h)i=!0;else if(i)if(s.Token.isTokenEscapeCharacter(f,c)){l.advancePastToken(f);const v=l.nextCharacterToken;v!==null&&(s.Token.isTokenQuote(v,c)||s.Token.isTokenEscapeCharacter(v,c))?(p.push(v.token),f=v):h?u=!0:p.push(f.token)}else h?u=!0:p.push(f.token);l.advancePastToken(f)}return{col:this.columnFormatter.format(p.join("")),foundClosingQuote:u}}checkForMalformedColumn(l){const{parserOptions:c}=this,{nextNonSpaceToken:i}=l;if(i){const u=s.Token.isTokenDelimiter(i,c),p=s.Token.isTokenRowDelimiter(i);if(!u&&!p){const f=l.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw new Error(`Parse Error: expected: '${c.escapedDelimiter}' OR new line got: '${i.token}'. at '${f}`)}l.advanceToToken(i)}else l.hasMoreData||l.advancePastLine()}}},{"../Token":159,"./ColumnFormatter":160}],164:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ColumnFormatter=n.QuotedColumnParser=n.NonQuotedColumnParser=n.ColumnParser=void 0;var o=e("./ColumnParser");Object.defineProperty(n,"ColumnParser",{enumerable:!0,get:function(){return o.ColumnParser}});var s=e("./NonQuotedColumnParser");Object.defineProperty(n,"NonQuotedColumnParser",{enumerable:!0,get:function(){return s.NonQuotedColumnParser}});var l=e("./QuotedColumnParser");Object.defineProperty(n,"QuotedColumnParser",{enumerable:!0,get:function(){return l.QuotedColumnParser}});var c=e("./ColumnFormatter");Object.defineProperty(n,"ColumnFormatter",{enumerable:!0,get:function(){return c.ColumnFormatter}})},{"./ColumnFormatter":160,"./ColumnParser":161,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],165:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.QuotedColumnParser=n.NonQuotedColumnParser=n.ColumnParser=n.Token=n.Scanner=n.RowParser=n.Parser=void 0;var o=e("./Parser");Object.defineProperty(n,"Parser",{enumerable:!0,get:function(){return o.Parser}});var s=e("./RowParser");Object.defineProperty(n,"RowParser",{enumerable:!0,get:function(){return s.RowParser}});var l=e("./Scanner");Object.defineProperty(n,"Scanner",{enumerable:!0,get:function(){return l.Scanner}});var c=e("./Token");Object.defineProperty(n,"Token",{enumerable:!0,get:function(){return c.Token}});var i=e("./column");Object.defineProperty(n,"ColumnParser",{enumerable:!0,get:function(){return i.ColumnParser}}),Object.defineProperty(n,"NonQuotedColumnParser",{enumerable:!0,get:function(){return i.NonQuotedColumnParser}}),Object.defineProperty(n,"QuotedColumnParser",{enumerable:!0,get:function(){return i.QuotedColumnParser}})},{"./Parser":156,"./RowParser":157,"./Scanner":158,"./Token":159,"./column":164}],166:[function(e,a,n){var o=function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(n,"__esModule",{value:!0}),n.HeaderTransformer=void 0;const s=o(e("lodash.isundefined")),l=o(e("lodash.isfunction")),c=o(e("lodash.uniq")),i=o(e("lodash.groupby"));n.HeaderTransformer=class{constructor(u){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=u,u.headers===!0?this.shouldUseFirstRow=!0:Array.isArray(u.headers)?this.setHeaders(u.headers):l.default(u.headers)&&(this.headersTransform=u.headers)}transform(u,p){return this.shouldMapRow(u)?p(null,this.processRow(u)):p(null,{row:null,isValid:!0})}shouldMapRow(u){const{parserOptions:p}=this;if(!this.headersTransform&&p.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw new Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(u)){if(this.headersTransform)this.setHeaders(this.headersTransform(u));else{if(!this.shouldUseFirstRow)return!0;this.setHeaders(u)}return!1}return!0}processRow(u){if(!this.headers)return{row:u,isValid:!0};const{parserOptions:p}=this;if(!p.discardUnmappedColumns&&u.length>this.headersLength){if(!p.strictColumnHandling)throw new Error(`Unexpected Error: column header mismatch expected: ${this.headersLength} columns got: ${u.length}`);return{row:u,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${u.length}`}}return p.strictColumnHandling&&u.length<this.headersLength?{row:u,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${u.length}`}:{row:this.mapHeaders(u),isValid:!0}}mapHeaders(u){const p={},{headers:f,headersLength:h}=this;for(let v=0;v<h;v+=1){const b=f[v];if(!s.default(b)){const g=u[v];s.default(g)?p[b]="":p[b]=g}}return p}setHeaders(u){var p;const f=u.filter(h=>!!h);if(c.default(f).length!==f.length){const h=i.default(f),v=Object.keys(h).filter(b=>h[b].length>1);throw new Error("Duplicate headers found "+JSON.stringify(v))}this.headers=u,this.receivedHeaders=!0,this.headersLength=((p=this.headers)===null||p===void 0?void 0:p.length)||0}}},{"lodash.groupby":443,"lodash.isfunction":446,"lodash.isundefined":448,"lodash.uniq":449}],167:[function(e,a,n){var o=function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(n,"__esModule",{value:!0}),n.RowTransformerValidator=void 0;const s=o(e("lodash.isfunction")),l=e("../types");class c{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(u){return l.isSyncTransform(u)?(p,f)=>{let h=null;try{h=u(p)}catch(v){return f(v)}return f(null,h)}:u}static createValidator(u){return l.isSyncValidate(u)?(p,f)=>{f(null,{row:p,isValid:u(p)})}:(p,f)=>{u(p,(h,v,b)=>h?f(h):f(null,v?{row:p,isValid:v,reason:b}:{row:p,isValid:!1,reason:b}))}}set rowTransform(u){if(!s.default(u))throw new TypeError("The transform should be a function");this._rowTransform=c.createTransform(u)}set rowValidator(u){if(!s.default(u))throw new TypeError("The validate should be a function");this._rowValidator=c.createValidator(u)}transformAndValidate(u,p){return this.callTransformer(u,(f,h)=>f?p(f):h?this.callValidator(h,(v,b)=>v?p(v):b&&!b.isValid?p(null,{row:h,isValid:!1,reason:b.reason}):p(null,{row:h,isValid:!0})):p(null,{row:null,isValid:!0}))}callTransformer(u,p){return this._rowTransform?this._rowTransform(u,p):p(null,u)}callValidator(u,p){return this._rowValidator?this._rowValidator(u,p):p(null,{row:u,isValid:!0})}}n.RowTransformerValidator=c},{"../types":169,"lodash.isfunction":446}],168:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.HeaderTransformer=n.RowTransformerValidator=void 0;var o=e("./RowTransformerValidator");Object.defineProperty(n,"RowTransformerValidator",{enumerable:!0,get:function(){return o.RowTransformerValidator}});var s=e("./HeaderTransformer");Object.defineProperty(n,"HeaderTransformer",{enumerable:!0,get:function(){return s.HeaderTransformer}})},{"./HeaderTransformer":166,"./RowTransformerValidator":167}],169:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.isSyncValidate=n.isSyncTransform=void 0,n.isSyncTransform=o=>o.length===1,n.isSyncValidate=o=>o.length===1},{}],170:[function(e,a,n){const o=n;o.bignum=e("bn.js"),o.define=e("./asn1/api").define,o.base=e("./asn1/base"),o.constants=e("./asn1/constants"),o.decoders=e("./asn1/decoders"),o.encoders=e("./asn1/encoders")},{"./asn1/api":171,"./asn1/base":173,"./asn1/constants":177,"./asn1/decoders":179,"./asn1/encoders":182,"bn.js":184}],171:[function(e,a,n){const o=e("./encoders"),s=e("./decoders"),l=e("inherits");function c(i,u){this.name=i,this.body=u,this.decoders={},this.encoders={}}n.define=function(i,u){return new c(i,u)},c.prototype._createNamed=function(i){const u=this.name;function p(f){this._initNamed(f,u)}return l(p,i),p.prototype._initNamed=function(f,h){i.call(this,f,h)},new p(this)},c.prototype._getDecoder=function(i){return i=i||"der",this.decoders.hasOwnProperty(i)||(this.decoders[i]=this._createNamed(s[i])),this.decoders[i]},c.prototype.decode=function(i,u,p){return this._getDecoder(u).decode(i,p)},c.prototype._getEncoder=function(i){return i=i||"der",this.encoders.hasOwnProperty(i)||(this.encoders[i]=this._createNamed(o[i])),this.encoders[i]},c.prototype.encode=function(i,u,p){return this._getEncoder(u).encode(i,p)}},{"./decoders":179,"./encoders":182,inherits:440}],172:[function(e,a,n){const o=e("inherits"),s=e("../base/reporter").Reporter,l=e("safer-buffer").Buffer;function c(u,p){s.call(this,p),l.isBuffer(u)?(this.base=u,this.offset=0,this.length=u.length):this.error("Input not Buffer")}function i(u,p){if(Array.isArray(u))this.length=0,this.value=u.map(function(f){return i.isEncoderBuffer(f)||(f=new i(f,p)),this.length+=f.length,f},this);else if(typeof u=="number"){if(!(0<=u&&u<=255))return p.error("non-byte EncoderBuffer value");this.value=u,this.length=1}else if(typeof u=="string")this.value=u,this.length=l.byteLength(u);else{if(!l.isBuffer(u))return p.error("Unsupported type: "+typeof u);this.value=u,this.length=u.length}}o(c,s),n.DecoderBuffer=c,c.isDecoderBuffer=function(u){return u instanceof c?!0:typeof u=="object"&&l.isBuffer(u.base)&&u.constructor.name==="DecoderBuffer"&&typeof u.offset=="number"&&typeof u.length=="number"&&typeof u.save=="function"&&typeof u.restore=="function"&&typeof u.isEmpty=="function"&&typeof u.readUInt8=="function"&&typeof u.skip=="function"&&typeof u.raw=="function"},c.prototype.save=function(){return{offset:this.offset,reporter:s.prototype.save.call(this)}},c.prototype.restore=function(u){const p=new c(this.base);return p.offset=u.offset,p.length=this.offset,this.offset=u.offset,s.prototype.restore.call(this,u.reporter),p},c.prototype.isEmpty=function(){return this.offset===this.length},c.prototype.readUInt8=function(u){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(u||"DecoderBuffer overrun")},c.prototype.skip=function(u,p){if(!(this.offset+u<=this.length))return this.error(p||"DecoderBuffer overrun");const f=new c(this.base);return f._reporterState=this._reporterState,f.offset=this.offset,f.length=this.offset+u,this.offset+=u,f},c.prototype.raw=function(u){return this.base.slice(u?u.offset:this.offset,this.length)},n.EncoderBuffer=i,i.isEncoderBuffer=function(u){return u instanceof i?!0:typeof u=="object"&&u.constructor.name==="EncoderBuffer"&&typeof u.length=="number"&&typeof u.join=="function"},i.prototype.join=function(u,p){return u||(u=l.alloc(this.length)),p||(p=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(f){f.join(u,p),p+=f.length}):(typeof this.value=="number"?u[p]=this.value:typeof this.value=="string"?u.write(this.value,p):l.isBuffer(this.value)&&this.value.copy(u,p),p+=this.length)),u}},{"../base/reporter":175,inherits:440,"safer-buffer":495}],173:[function(e,a,n){const o=n;o.Reporter=e("./reporter").Reporter,o.DecoderBuffer=e("./buffer").DecoderBuffer,o.EncoderBuffer=e("./buffer").EncoderBuffer,o.Node=e("./node")},{"./buffer":172,"./node":174,"./reporter":175}],174:[function(e,a,n){const o=e("../base/reporter").Reporter,s=e("../base/buffer").EncoderBuffer,l=e("../base/buffer").DecoderBuffer,c=e("minimalistic-assert"),i=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],u=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(i);function p(h,v,b){const g={};this._baseState=g,g.name=b,g.enc=h,g.parent=v||null,g.children=null,g.tag=null,g.args=null,g.reverseArgs=null,g.choice=null,g.optional=!1,g.any=!1,g.obj=!1,g.use=null,g.useDecoder=null,g.key=null,g.default=null,g.explicit=null,g.implicit=null,g.contains=null,g.parent||(g.children=[],this._wrap())}a.exports=p;const f=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];p.prototype.clone=function(){const h=this._baseState,v={};f.forEach(function(g){v[g]=h[g]});const b=new this.constructor(v.parent);return b._baseState=v,b},p.prototype._wrap=function(){const h=this._baseState;u.forEach(function(v){this[v]=function(){const b=new this.constructor(this);return h.children.push(b),b[v].apply(b,arguments)}},this)},p.prototype._init=function(h){const v=this._baseState;c(v.parent===null),h.call(this),v.children=v.children.filter(function(b){return b._baseState.parent===this},this),c.equal(v.children.length,1,"Root node can have only one child")},p.prototype._useArgs=function(h){const v=this._baseState,b=h.filter(function(g){return g instanceof this.constructor},this);h=h.filter(function(g){return!(g instanceof this.constructor)},this),b.length!==0&&(c(v.children===null),v.children=b,b.forEach(function(g){g._baseState.parent=this},this)),h.length!==0&&(c(v.args===null),v.args=h,v.reverseArgs=h.map(function(g){if(typeof g!="object"||g.constructor!==Object)return g;const x={};return Object.keys(g).forEach(function(y){y==(0|y)&&(y|=0);const E=g[y];x[E]=y}),x}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(h){p.prototype[h]=function(){const v=this._baseState;throw new Error(h+" not implemented for encoding: "+v.enc)}}),i.forEach(function(h){p.prototype[h]=function(){const v=this._baseState,b=Array.prototype.slice.call(arguments);return c(v.tag===null),v.tag=h,this._useArgs(b),this}}),p.prototype.use=function(h){c(h);const v=this._baseState;return c(v.use===null),v.use=h,this},p.prototype.optional=function(){return this._baseState.optional=!0,this},p.prototype.def=function(h){const v=this._baseState;return c(v.default===null),v.default=h,v.optional=!0,this},p.prototype.explicit=function(h){const v=this._baseState;return c(v.explicit===null&&v.implicit===null),v.explicit=h,this},p.prototype.implicit=function(h){const v=this._baseState;return c(v.explicit===null&&v.implicit===null),v.implicit=h,this},p.prototype.obj=function(){const h=this._baseState,v=Array.prototype.slice.call(arguments);return h.obj=!0,v.length!==0&&this._useArgs(v),this},p.prototype.key=function(h){const v=this._baseState;return c(v.key===null),v.key=h,this},p.prototype.any=function(){return this._baseState.any=!0,this},p.prototype.choice=function(h){const v=this._baseState;return c(v.choice===null),v.choice=h,this._useArgs(Object.keys(h).map(function(b){return h[b]})),this},p.prototype.contains=function(h){const v=this._baseState;return c(v.use===null),v.contains=h,this},p.prototype._decode=function(h,v){const b=this._baseState;if(b.parent===null)return h.wrapResult(b.children[0]._decode(h,v));let g,x=b.default,y=!0,E=null;if(b.key!==null&&(E=h.enterKey(b.key)),b.optional){let N=null;if(b.explicit!==null?N=b.explicit:b.implicit!==null?N=b.implicit:b.tag!==null&&(N=b.tag),N!==null||b.any){if(y=this._peekTag(h,N,b.any),h.isError(y))return y}else{const I=h.save();try{b.choice===null?this._decodeGeneric(b.tag,h,v):this._decodeChoice(h,v),y=!0}catch{y=!1}h.restore(I)}}if(b.obj&&y&&(g=h.enterObject()),y){if(b.explicit!==null){const I=this._decodeTag(h,b.explicit);if(h.isError(I))return I;h=I}const N=h.offset;if(b.use===null&&b.choice===null){let I;b.any&&(I=h.save());const P=this._decodeTag(h,b.implicit!==null?b.implicit:b.tag,b.any);if(h.isError(P))return P;b.any?x=h.raw(I):h=P}if(v&&v.track&&b.tag!==null&&v.track(h.path(),N,h.length,"tagged"),v&&v.track&&b.tag!==null&&v.track(h.path(),h.offset,h.length,"content"),b.any||(x=b.choice===null?this._decodeGeneric(b.tag,h,v):this._decodeChoice(h,v)),h.isError(x))return x;if(b.any||b.choice!==null||b.children===null||b.children.forEach(function(I){I._decode(h,v)}),b.contains&&(b.tag==="octstr"||b.tag==="bitstr")){const I=new l(x);x=this._getUse(b.contains,h._reporterState.obj)._decode(I,v)}}return b.obj&&y&&(x=h.leaveObject(g)),b.key===null||x===null&&y!==!0?E!==null&&h.exitKey(E):h.leaveKey(E,b.key,x),x},p.prototype._decodeGeneric=function(h,v,b){const g=this._baseState;return h==="seq"||h==="set"?null:h==="seqof"||h==="setof"?this._decodeList(v,h,g.args[0],b):/str$/.test(h)?this._decodeStr(v,h,b):h==="objid"&&g.args?this._decodeObjid(v,g.args[0],g.args[1],b):h==="objid"?this._decodeObjid(v,null,null,b):h==="gentime"||h==="utctime"?this._decodeTime(v,h,b):h==="null_"?this._decodeNull(v,b):h==="bool"?this._decodeBool(v,b):h==="objDesc"?this._decodeStr(v,h,b):h==="int"||h==="enum"?this._decodeInt(v,g.args&&g.args[0],b):g.use!==null?this._getUse(g.use,v._reporterState.obj)._decode(v,b):v.error("unknown tag: "+h)},p.prototype._getUse=function(h,v){const b=this._baseState;return b.useDecoder=this._use(h,v),c(b.useDecoder._baseState.parent===null),b.useDecoder=b.useDecoder._baseState.children[0],b.implicit!==b.useDecoder._baseState.implicit&&(b.useDecoder=b.useDecoder.clone(),b.useDecoder._baseState.implicit=b.implicit),b.useDecoder},p.prototype._decodeChoice=function(h,v){const b=this._baseState;let g=null,x=!1;return Object.keys(b.choice).some(function(y){const E=h.save(),N=b.choice[y];try{const I=N._decode(h,v);if(h.isError(I))return!1;g={type:y,value:I},x=!0}catch{return h.restore(E),!1}return!0},this),x?g:h.error("Choice not matched")},p.prototype._createEncoderBuffer=function(h){return new s(h,this.reporter)},p.prototype._encode=function(h,v,b){const g=this._baseState;if(g.default!==null&&g.default===h)return;const x=this._encodeValue(h,v,b);return x===void 0||this._skipDefault(x,v,b)?void 0:x},p.prototype._encodeValue=function(h,v,b){const g=this._baseState;if(g.parent===null)return g.children[0]._encode(h,v||new o);let x=null;if(this.reporter=v,g.optional&&h===void 0){if(g.default===null)return;h=g.default}let y=null,E=!1;if(g.any)x=this._createEncoderBuffer(h);else if(g.choice)x=this._encodeChoice(h,v);else if(g.contains)y=this._getUse(g.contains,b)._encode(h,v),E=!0;else if(g.children)y=g.children.map(function(N){if(N._baseState.tag==="null_")return N._encode(null,v,h);if(N._baseState.key===null)return v.error("Child should have a key");const I=v.enterKey(N._baseState.key);if(typeof h!="object")return v.error("Child expected, but input is not object");const P=N._encode(h[N._baseState.key],v,h);return v.leaveKey(I),P},this).filter(function(N){return N}),y=this._createEncoderBuffer(y);else if(g.tag==="seqof"||g.tag==="setof"){if(!g.args||g.args.length!==1)return v.error("Too many args for : "+g.tag);if(!Array.isArray(h))return v.error("seqof/setof, but data is not Array");const N=this.clone();N._baseState.implicit=null,y=this._createEncoderBuffer(h.map(function(I){const P=this._baseState;return this._getUse(P.args[0],h)._encode(I,v)},N))}else g.use!==null?x=this._getUse(g.use,b)._encode(h,v):(y=this._encodePrimitive(g.tag,h),E=!0);if(!g.any&&g.choice===null){const N=g.implicit!==null?g.implicit:g.tag,I=g.implicit===null?"universal":"context";N===null?g.use===null&&v.error("Tag could be omitted only for .use()"):g.use===null&&(x=this._encodeComposite(N,E,I,y))}return g.explicit!==null&&(x=this._encodeComposite(g.explicit,!1,"context",x)),x},p.prototype._encodeChoice=function(h,v){const b=this._baseState,g=b.choice[h.type];return g||c(!1,h.type+" not found in "+JSON.stringify(Object.keys(b.choice))),g._encode(h.value,v)},p.prototype._encodePrimitive=function(h,v){const b=this._baseState;if(/str$/.test(h))return this._encodeStr(v,h);if(h==="objid"&&b.args)return this._encodeObjid(v,b.reverseArgs[0],b.args[1]);if(h==="objid")return this._encodeObjid(v,null,null);if(h==="gentime"||h==="utctime")return this._encodeTime(v,h);if(h==="null_")return this._encodeNull();if(h==="int"||h==="enum")return this._encodeInt(v,b.args&&b.reverseArgs[0]);if(h==="bool")return this._encodeBool(v);if(h==="objDesc")return this._encodeStr(v,h);throw new Error("Unsupported tag: "+h)},p.prototype._isNumstr=function(h){return/^[0-9 ]*$/.test(h)},p.prototype._isPrintstr=function(h){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(h)}},{"../base/buffer":172,"../base/reporter":175,"minimalistic-assert":453}],175:[function(e,a,n){const o=e("inherits");function s(c){this._reporterState={obj:null,path:[],options:c||{},errors:[]}}function l(c,i){this.path=c,this.rethrow(i)}n.Reporter=s,s.prototype.isError=function(c){return c instanceof l},s.prototype.save=function(){const c=this._reporterState;return{obj:c.obj,pathLen:c.path.length}},s.prototype.restore=function(c){const i=this._reporterState;i.obj=c.obj,i.path=i.path.slice(0,c.pathLen)},s.prototype.enterKey=function(c){return this._reporterState.path.push(c)},s.prototype.exitKey=function(c){const i=this._reporterState;i.path=i.path.slice(0,c-1)},s.prototype.leaveKey=function(c,i,u){const p=this._reporterState;this.exitKey(c),p.obj!==null&&(p.obj[i]=u)},s.prototype.path=function(){return this._reporterState.path.join("/")},s.prototype.enterObject=function(){const c=this._reporterState,i=c.obj;return c.obj={},i},s.prototype.leaveObject=function(c){const i=this._reporterState,u=i.obj;return i.obj=c,u},s.prototype.error=function(c){let i;const u=this._reporterState,p=c instanceof l;if(i=p?c:new l(u.path.map(function(f){return"["+JSON.stringify(f)+"]"}).join(""),c.message||c,c.stack),!u.options.partial)throw i;return p||u.errors.push(i),i},s.prototype.wrapResult=function(c){const i=this._reporterState;return i.options.partial?{result:this.isError(c)?null:c,errors:i.errors}:c},o(l,Error),l.prototype.rethrow=function(c){if(this.message=c+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,l),!this.stack)try{throw new Error(this.message)}catch(i){this.stack=i.stack}return this}},{inherits:440}],176:[function(e,a,n){function o(s){const l={};return Object.keys(s).forEach(function(c){(0|c)==c&&(c|=0);const i=s[c];l[i]=c}),l}n.tagClass={0:"universal",1:"application",2:"context",3:"private"},n.tagClassByName=o(n.tagClass),n.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},n.tagByName=o(n.tag)},{}],177:[function(e,a,n){const o=n;o._reverse=function(s){const l={};return Object.keys(s).forEach(function(c){(0|c)==c&&(c|=0);const i=s[c];l[i]=c}),l},o.der=e("./der")},{"./der":176}],178:[function(e,a,n){const o=e("inherits"),s=e("bn.js"),l=e("../base/buffer").DecoderBuffer,c=e("../base/node"),i=e("../constants/der");function u(v){this.enc="der",this.name=v.name,this.entity=v,this.tree=new p,this.tree._init(v.body)}function p(v){c.call(this,"der",v)}function f(v,b){let g=v.readUInt8(b);if(v.isError(g))return g;const x=i.tagClass[g>>6],y=(32&g)==0;if((31&g)==31){let E=g;for(g=0;(128&E)==128;){if(E=v.readUInt8(b),v.isError(E))return E;g<<=7,g|=127&E}}else g&=31;return{cls:x,primitive:y,tag:g,tagStr:i.tag[g]}}function h(v,b,g){let x=v.readUInt8(g);if(v.isError(x))return x;if(!b&&x===128)return null;if((128&x)==0)return x;const y=127&x;if(y>4)return v.error("length octect is too long");x=0;for(let E=0;E<y;E++){x<<=8;const N=v.readUInt8(g);if(v.isError(N))return N;x|=N}return x}a.exports=u,u.prototype.decode=function(v,b){return l.isDecoderBuffer(v)||(v=new l(v,b)),this.tree._decode(v,b)},o(p,c),p.prototype._peekTag=function(v,b,g){if(v.isEmpty())return!1;const x=v.save(),y=f(v,'Failed to peek tag: "'+b+'"');return v.isError(y)?y:(v.restore(x),y.tag===b||y.tagStr===b||y.tagStr+"of"===b||g)},p.prototype._decodeTag=function(v,b,g){const x=f(v,'Failed to decode tag of "'+b+'"');if(v.isError(x))return x;let y=h(v,x.primitive,'Failed to get length of "'+b+'"');if(v.isError(y))return y;if(!g&&x.tag!==b&&x.tagStr!==b&&x.tagStr+"of"!==b)return v.error('Failed to match tag: "'+b+'"');if(x.primitive||y!==null)return v.skip(y,'Failed to match body of: "'+b+'"');const E=v.save(),N=this._skipUntilEnd(v,'Failed to skip indefinite length body: "'+this.tag+'"');return v.isError(N)?N:(y=v.offset-E.offset,v.restore(E),v.skip(y,'Failed to match body of: "'+b+'"'))},p.prototype._skipUntilEnd=function(v,b){for(;;){const g=f(v,b);if(v.isError(g))return g;const x=h(v,g.primitive,b);if(v.isError(x))return x;let y;if(y=g.primitive||x!==null?v.skip(x):this._skipUntilEnd(v,b),v.isError(y))return y;if(g.tagStr==="end")break}},p.prototype._decodeList=function(v,b,g,x){const y=[];for(;!v.isEmpty();){const E=this._peekTag(v,"end");if(v.isError(E))return E;const N=g.decode(v,"der",x);if(v.isError(N)&&E)break;y.push(N)}return y},p.prototype._decodeStr=function(v,b){if(b==="bitstr"){const g=v.readUInt8();return v.isError(g)?g:{unused:g,data:v.raw()}}if(b==="bmpstr"){const g=v.raw();if(g.length%2==1)return v.error("Decoding of string type: bmpstr length mismatch");let x="";for(let y=0;y<g.length/2;y++)x+=String.fromCharCode(g.readUInt16BE(2*y));return x}if(b==="numstr"){const g=v.raw().toString("ascii");return this._isNumstr(g)?g:v.error("Decoding of string type: numstr unsupported characters")}if(b==="octstr"||b==="objDesc")return v.raw();if(b==="printstr"){const g=v.raw().toString("ascii");return this._isPrintstr(g)?g:v.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(b)?v.raw().toString():v.error("Decoding of string type: "+b+" unsupported")},p.prototype._decodeObjid=function(v,b,g){let x;const y=[];let E=0,N=0;for(;!v.isEmpty();)N=v.readUInt8(),E<<=7,E|=127&N,(128&N)==0&&(y.push(E),E=0);128&N&&y.push(E);const I=y[0]/40|0,P=y[0]%40;if(x=g?y:[I,P].concat(y.slice(1)),b){let V=b[x.join(" ")];V===void 0&&(V=b[x.join(".")]),V!==void 0&&(x=V)}return x},p.prototype._decodeTime=function(v,b){const g=v.raw().toString();let x,y,E,N,I,P;if(b==="gentime")x=0|g.slice(0,4),y=0|g.slice(4,6),E=0|g.slice(6,8),N=0|g.slice(8,10),I=0|g.slice(10,12),P=0|g.slice(12,14);else{if(b!=="utctime")return v.error("Decoding "+b+" time is not supported yet");x=0|g.slice(0,2),y=0|g.slice(2,4),E=0|g.slice(4,6),N=0|g.slice(6,8),I=0|g.slice(8,10),P=0|g.slice(10,12),x=x<70?2e3+x:1900+x}return Date.UTC(x,y-1,E,N,I,P,0)},p.prototype._decodeNull=function(){return null},p.prototype._decodeBool=function(v){const b=v.readUInt8();return v.isError(b)?b:b!==0},p.prototype._decodeInt=function(v,b){const g=v.raw();let x=new s(g);return b&&(x=b[x.toString(10)]||x),x},p.prototype._use=function(v,b){return typeof v=="function"&&(v=v(b)),v._getDecoder("der").tree}},{"../base/buffer":172,"../base/node":174,"../constants/der":176,"bn.js":184,inherits:440}],179:[function(e,a,n){const o=n;o.der=e("./der"),o.pem=e("./pem")},{"./der":178,"./pem":180}],180:[function(e,a,n){const o=e("inherits"),s=e("safer-buffer").Buffer,l=e("./der");function c(i){l.call(this,i),this.enc="pem"}o(c,l),a.exports=c,c.prototype.decode=function(i,u){const p=i.toString().split(/[\r\n]+/g),f=u.label.toUpperCase(),h=/^-----(BEGIN|END) ([^-]+)-----$/;let v=-1,b=-1;for(let y=0;y<p.length;y++){const E=p[y].match(h);if(E!==null&&E[2]===f){if(v!==-1){if(E[1]!=="END")break;b=y;break}if(E[1]!=="BEGIN")break;v=y}}if(v===-1||b===-1)throw new Error("PEM section not found for: "+f);const g=p.slice(v+1,b).join("");g.replace(/[^a-z0-9+/=]+/gi,"");const x=s.from(g,"base64");return l.prototype.decode.call(this,x,u)}},{"./der":178,inherits:440,"safer-buffer":495}],181:[function(e,a,n){const o=e("inherits"),s=e("safer-buffer").Buffer,l=e("../base/node"),c=e("../constants/der");function i(f){this.enc="der",this.name=f.name,this.entity=f,this.tree=new u,this.tree._init(f.body)}function u(f){l.call(this,"der",f)}function p(f){return f<10?"0"+f:f}a.exports=i,i.prototype.encode=function(f,h){return this.tree._encode(f,h).join()},o(u,l),u.prototype._encodeComposite=function(f,h,v,b){const g=function(E,N,I,P){let V;if(E==="seqof"?E="seq":E==="setof"&&(E="set"),c.tagByName.hasOwnProperty(E))V=c.tagByName[E];else{if(typeof E!="number"||(0|E)!==E)return P.error("Unknown tag: "+E);V=E}return V>=31?P.error("Multi-octet tag encoding unsupported"):(N||(V|=32),V|=c.tagClassByName[I||"universal"]<<6,V)}(f,h,v,this.reporter);if(b.length<128){const E=s.alloc(2);return E[0]=g,E[1]=b.length,this._createEncoderBuffer([E,b])}let x=1;for(let E=b.length;E>=256;E>>=8)x++;const y=s.alloc(2+x);y[0]=g,y[1]=128|x;for(let E=1+x,N=b.length;N>0;E--,N>>=8)y[E]=255&N;return this._createEncoderBuffer([y,b])},u.prototype._encodeStr=function(f,h){if(h==="bitstr")return this._createEncoderBuffer([0|f.unused,f.data]);if(h==="bmpstr"){const v=s.alloc(2*f.length);for(let b=0;b<f.length;b++)v.writeUInt16BE(f.charCodeAt(b),2*b);return this._createEncoderBuffer(v)}return h==="numstr"?this._isNumstr(f)?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: numstr supports only digits and space"):h==="printstr"?this._isPrintstr(f)?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(h)||h==="objDesc"?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: "+h+" unsupported")},u.prototype._encodeObjid=function(f,h,v){if(typeof f=="string"){if(!h)return this.reporter.error("string objid given, but no values map found");if(!h.hasOwnProperty(f))return this.reporter.error("objid not found in values map");f=h[f].split(/[\s.]+/g);for(let y=0;y<f.length;y++)f[y]|=0}else if(Array.isArray(f)){f=f.slice();for(let y=0;y<f.length;y++)f[y]|=0}if(!Array.isArray(f))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(f));if(!v){if(f[1]>=40)return this.reporter.error("Second objid identifier OOB");f.splice(0,2,40*f[0]+f[1])}let b=0;for(let y=0;y<f.length;y++){let E=f[y];for(b++;E>=128;E>>=7)b++}const g=s.alloc(b);let x=g.length-1;for(let y=f.length-1;y>=0;y--){let E=f[y];for(g[x--]=127&E;(E>>=7)>0;)g[x--]=128|127&E}return this._createEncoderBuffer(g)},u.prototype._encodeTime=function(f,h){let v;const b=new Date(f);return h==="gentime"?v=[p(b.getUTCFullYear()),p(b.getUTCMonth()+1),p(b.getUTCDate()),p(b.getUTCHours()),p(b.getUTCMinutes()),p(b.getUTCSeconds()),"Z"].join(""):h==="utctime"?v=[p(b.getUTCFullYear()%100),p(b.getUTCMonth()+1),p(b.getUTCDate()),p(b.getUTCHours()),p(b.getUTCMinutes()),p(b.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+h+" time is not supported yet"),this._encodeStr(v,"octstr")},u.prototype._encodeNull=function(){return this._createEncoderBuffer("")},u.prototype._encodeInt=function(f,h){if(typeof f=="string"){if(!h)return this.reporter.error("String int or enum given, but no values map");if(!h.hasOwnProperty(f))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(f));f=h[f]}if(typeof f!="number"&&!s.isBuffer(f)){const g=f.toArray();!f.sign&&128&g[0]&&g.unshift(0),f=s.from(g)}if(s.isBuffer(f)){let g=f.length;f.length===0&&g++;const x=s.alloc(g);return f.copy(x),f.length===0&&(x[0]=0),this._createEncoderBuffer(x)}if(f<128)return this._createEncoderBuffer(f);if(f<256)return this._createEncoderBuffer([0,f]);let v=1;for(let g=f;g>=256;g>>=8)v++;const b=new Array(v);for(let g=b.length-1;g>=0;g--)b[g]=255&f,f>>=8;return 128&b[0]&&b.unshift(0),this._createEncoderBuffer(s.from(b))},u.prototype._encodeBool=function(f){return this._createEncoderBuffer(f?255:0)},u.prototype._use=function(f,h){return typeof f=="function"&&(f=f(h)),f._getEncoder("der").tree},u.prototype._skipDefault=function(f,h,v){const b=this._baseState;let g;if(b.default===null)return!1;const x=f.join();if(b.defaultBuffer===void 0&&(b.defaultBuffer=this._encodeValue(b.default,h,v).join()),x.length!==b.defaultBuffer.length)return!1;for(g=0;g<x.length;g++)if(x[g]!==b.defaultBuffer[g])return!1;return!0}},{"../base/node":174,"../constants/der":176,inherits:440,"safer-buffer":495}],182:[function(e,a,n){const o=n;o.der=e("./der"),o.pem=e("./pem")},{"./der":181,"./pem":183}],183:[function(e,a,n){const o=e("inherits"),s=e("./der");function l(c){s.call(this,c),this.enc="pem"}o(l,s),a.exports=l,l.prototype.encode=function(c,i){const u=s.prototype.encode.call(this,c).toString("base64"),p=["-----BEGIN "+i.label+"-----"];for(let f=0;f<u.length;f+=64)p.push(u.slice(f,f+64));return p.push("-----END "+i.label+"-----"),p.join(`
`)}},{"./der":181,inherits:440}],184:[function(e,a,n){(function(o,s){function l(O,R){if(!O)throw new Error(R||"Assertion failed")}function c(O,R){O.super_=R;var C=function(){};C.prototype=R.prototype,O.prototype=new C,O.prototype.constructor=O}function i(O,R,C){if(i.isBN(O))return O;this.negative=0,this.words=null,this.length=0,this.red=null,O!==null&&(R!=="le"&&R!=="be"||(C=R,R=10),this._init(O||0,R||10,C||"be"))}var u;typeof o=="object"?o.exports=i:(void 0).BN=i,i.BN=i,i.wordSize=26;try{u=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:e("buffer").Buffer}catch{}function p(O,R){var C=O.charCodeAt(R);return C>=65&&C<=70?C-55:C>=97&&C<=102?C-87:C-48&15}function f(O,R,C){var _=p(O,C);return C-1>=R&&(_|=p(O,C-1)<<4),_}function h(O,R,C,_){for(var k=0,A=Math.min(O.length,C),T=R;T<A;T++){var D=O.charCodeAt(T)-48;k*=_,k+=D>=49?D-49+10:D>=17?D-17+10:D}return k}i.isBN=function(O){return O instanceof i||O!==null&&typeof O=="object"&&O.constructor.wordSize===i.wordSize&&Array.isArray(O.words)},i.max=function(O,R){return O.cmp(R)>0?O:R},i.min=function(O,R){return O.cmp(R)<0?O:R},i.prototype._init=function(O,R,C){if(typeof O=="number")return this._initNumber(O,R,C);if(typeof O=="object")return this._initArray(O,R,C);R==="hex"&&(R=16),l(R===(0|R)&&R>=2&&R<=36);var _=0;(O=O.toString().replace(/\s+/g,""))[0]==="-"&&(_++,this.negative=1),_<O.length&&(R===16?this._parseHex(O,_,C):(this._parseBase(O,R,_),C==="le"&&this._initArray(this.toArray(),R,C)))},i.prototype._initNumber=function(O,R,C){O<0&&(this.negative=1,O=-O),O<67108864?(this.words=[67108863&O],this.length=1):O<4503599627370496?(this.words=[67108863&O,O/67108864&67108863],this.length=2):(l(O<9007199254740992),this.words=[67108863&O,O/67108864&67108863,1],this.length=3),C==="le"&&this._initArray(this.toArray(),R,C)},i.prototype._initArray=function(O,R,C){if(l(typeof O.length=="number"),O.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(O.length/3),this.words=new Array(this.length);for(var _=0;_<this.length;_++)this.words[_]=0;var k,A,T=0;if(C==="be")for(_=O.length-1,k=0;_>=0;_-=3)A=O[_]|O[_-1]<<8|O[_-2]<<16,this.words[k]|=A<<T&67108863,this.words[k+1]=A>>>26-T&67108863,(T+=24)>=26&&(T-=26,k++);else if(C==="le")for(_=0,k=0;_<O.length;_+=3)A=O[_]|O[_+1]<<8|O[_+2]<<16,this.words[k]|=A<<T&67108863,this.words[k+1]=A>>>26-T&67108863,(T+=24)>=26&&(T-=26,k++);return this.strip()},i.prototype._parseHex=function(O,R,C){this.length=Math.ceil((O.length-R)/6),this.words=new Array(this.length);for(var _=0;_<this.length;_++)this.words[_]=0;var k,A=0,T=0;if(C==="be")for(_=O.length-1;_>=R;_-=2)k=f(O,R,_)<<A,this.words[T]|=67108863&k,A>=18?(A-=18,T+=1,this.words[T]|=k>>>26):A+=8;else for(_=(O.length-R)%2==0?R+1:R;_<O.length;_+=2)k=f(O,R,_)<<A,this.words[T]|=67108863&k,A>=18?(A-=18,T+=1,this.words[T]|=k>>>26):A+=8;this.strip()},i.prototype._parseBase=function(O,R,C){this.words=[0],this.length=1;for(var _=0,k=1;k<=67108863;k*=R)_++;_--,k=k/R|0;for(var A=O.length-C,T=A%_,D=Math.min(A,A-T)+C,B=0,F=C;F<D;F+=_)B=h(O,F,F+_,R),this.imuln(k),this.words[0]+B<67108864?this.words[0]+=B:this._iaddn(B);if(T!==0){var Y=1;for(B=h(O,F,O.length,R),F=0;F<T;F++)Y*=R;this.imuln(Y),this.words[0]+B<67108864?this.words[0]+=B:this._iaddn(B)}this.strip()},i.prototype.copy=function(O){O.words=new Array(this.length);for(var R=0;R<this.length;R++)O.words[R]=this.words[R];O.length=this.length,O.negative=this.negative,O.red=this.red},i.prototype.clone=function(){var O=new i(null);return this.copy(O),O},i.prototype._expand=function(O){for(;this.length<O;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var v=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],b=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],g=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function x(O,R,C){C.negative=R.negative^O.negative;var _=O.length+R.length|0;C.length=_,_=_-1|0;var k=0|O.words[0],A=0|R.words[0],T=k*A,D=67108863&T,B=T/67108864|0;C.words[0]=D;for(var F=1;F<_;F++){for(var Y=B>>>26,X=67108863&B,re=Math.min(F,R.length-1),z=Math.max(0,F-O.length+1);z<=re;z++){var ee=F-z|0;Y+=(T=(k=0|O.words[ee])*(A=0|R.words[z])+X)/67108864|0,X=67108863&T}C.words[F]=0|X,B=0|Y}return B!==0?C.words[F]=0|B:C.length--,C.strip()}i.prototype.toString=function(O,R){var C;if(R=0|R||1,(O=O||10)===16||O==="hex"){C="";for(var _=0,k=0,A=0;A<this.length;A++){var T=this.words[A],D=(16777215&(T<<_|k)).toString(16);C=(k=T>>>24-_&16777215)!==0||A!==this.length-1?v[6-D.length]+D+C:D+C,(_+=2)>=26&&(_-=26,A--)}for(k!==0&&(C=k.toString(16)+C);C.length%R!=0;)C="0"+C;return this.negative!==0&&(C="-"+C),C}if(O===(0|O)&&O>=2&&O<=36){var B=b[O],F=g[O];C="";var Y=this.clone();for(Y.negative=0;!Y.isZero();){var X=Y.modn(F).toString(O);C=(Y=Y.idivn(F)).isZero()?X+C:v[B-X.length]+X+C}for(this.isZero()&&(C="0"+C);C.length%R!=0;)C="0"+C;return this.negative!==0&&(C="-"+C),C}l(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var O=this.words[0];return this.length===2?O+=67108864*this.words[1]:this.length===3&&this.words[2]===1?O+=4503599627370496+67108864*this.words[1]:this.length>2&&l(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-O:O},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(O,R){return l(u!==void 0),this.toArrayLike(u,O,R)},i.prototype.toArray=function(O,R){return this.toArrayLike(Array,O,R)},i.prototype.toArrayLike=function(O,R,C){var _=this.byteLength(),k=C||Math.max(1,_);l(_<=k,"byte array longer than desired length"),l(k>0,"Requested array length <= 0"),this.strip();var A,T,D=R==="le",B=new O(k),F=this.clone();if(D){for(T=0;!F.isZero();T++)A=F.andln(255),F.iushrn(8),B[T]=A;for(;T<k;T++)B[T]=0}else{for(T=0;T<k-_;T++)B[T]=0;for(T=0;!F.isZero();T++)A=F.andln(255),F.iushrn(8),B[k-T-1]=A}return B},Math.clz32?i.prototype._countBits=function(O){return 32-Math.clz32(O)}:i.prototype._countBits=function(O){var R=O,C=0;return R>=4096&&(C+=13,R>>>=13),R>=64&&(C+=7,R>>>=7),R>=8&&(C+=4,R>>>=4),R>=2&&(C+=2,R>>>=2),C+R},i.prototype._zeroBits=function(O){if(O===0)return 26;var R=O,C=0;return(8191&R)==0&&(C+=13,R>>>=13),(127&R)==0&&(C+=7,R>>>=7),(15&R)==0&&(C+=4,R>>>=4),(3&R)==0&&(C+=2,R>>>=2),(1&R)==0&&C++,C},i.prototype.bitLength=function(){var O=this.words[this.length-1],R=this._countBits(O);return 26*(this.length-1)+R},i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var O=0,R=0;R<this.length;R++){var C=this._zeroBits(this.words[R]);if(O+=C,C!==26)break}return O},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(O){return this.negative!==0?this.abs().inotn(O).iaddn(1):this.clone()},i.prototype.fromTwos=function(O){return this.testn(O-1)?this.notn(O).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(O){for(;this.length<O.length;)this.words[this.length++]=0;for(var R=0;R<O.length;R++)this.words[R]=this.words[R]|O.words[R];return this.strip()},i.prototype.ior=function(O){return l((this.negative|O.negative)==0),this.iuor(O)},i.prototype.or=function(O){return this.length>O.length?this.clone().ior(O):O.clone().ior(this)},i.prototype.uor=function(O){return this.length>O.length?this.clone().iuor(O):O.clone().iuor(this)},i.prototype.iuand=function(O){var R;R=this.length>O.length?O:this;for(var C=0;C<R.length;C++)this.words[C]=this.words[C]&O.words[C];return this.length=R.length,this.strip()},i.prototype.iand=function(O){return l((this.negative|O.negative)==0),this.iuand(O)},i.prototype.and=function(O){return this.length>O.length?this.clone().iand(O):O.clone().iand(this)},i.prototype.uand=function(O){return this.length>O.length?this.clone().iuand(O):O.clone().iuand(this)},i.prototype.iuxor=function(O){var R,C;this.length>O.length?(R=this,C=O):(R=O,C=this);for(var _=0;_<C.length;_++)this.words[_]=R.words[_]^C.words[_];if(this!==R)for(;_<R.length;_++)this.words[_]=R.words[_];return this.length=R.length,this.strip()},i.prototype.ixor=function(O){return l((this.negative|O.negative)==0),this.iuxor(O)},i.prototype.xor=function(O){return this.length>O.length?this.clone().ixor(O):O.clone().ixor(this)},i.prototype.uxor=function(O){return this.length>O.length?this.clone().iuxor(O):O.clone().iuxor(this)},i.prototype.inotn=function(O){l(typeof O=="number"&&O>=0);var R=0|Math.ceil(O/26),C=O%26;this._expand(R),C>0&&R--;for(var _=0;_<R;_++)this.words[_]=67108863&~this.words[_];return C>0&&(this.words[_]=~this.words[_]&67108863>>26-C),this.strip()},i.prototype.notn=function(O){return this.clone().inotn(O)},i.prototype.setn=function(O,R){l(typeof O=="number"&&O>=0);var C=O/26|0,_=O%26;return this._expand(C+1),this.words[C]=R?this.words[C]|1<<_:this.words[C]&~(1<<_),this.strip()},i.prototype.iadd=function(O){var R,C,_;if(this.negative!==0&&O.negative===0)return this.negative=0,R=this.isub(O),this.negative^=1,this._normSign();if(this.negative===0&&O.negative!==0)return O.negative=0,R=this.isub(O),O.negative=1,R._normSign();this.length>O.length?(C=this,_=O):(C=O,_=this);for(var k=0,A=0;A<_.length;A++)R=(0|C.words[A])+(0|_.words[A])+k,this.words[A]=67108863&R,k=R>>>26;for(;k!==0&&A<C.length;A++)R=(0|C.words[A])+k,this.words[A]=67108863&R,k=R>>>26;if(this.length=C.length,k!==0)this.words[this.length]=k,this.length++;else if(C!==this)for(;A<C.length;A++)this.words[A]=C.words[A];return this},i.prototype.add=function(O){var R;return O.negative!==0&&this.negative===0?(O.negative=0,R=this.sub(O),O.negative^=1,R):O.negative===0&&this.negative!==0?(this.negative=0,R=O.sub(this),this.negative=1,R):this.length>O.length?this.clone().iadd(O):O.clone().iadd(this)},i.prototype.isub=function(O){if(O.negative!==0){O.negative=0;var R=this.iadd(O);return O.negative=1,R._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(O),this.negative=1,this._normSign();var C,_,k=this.cmp(O);if(k===0)return this.negative=0,this.length=1,this.words[0]=0,this;k>0?(C=this,_=O):(C=O,_=this);for(var A=0,T=0;T<_.length;T++)A=(R=(0|C.words[T])-(0|_.words[T])+A)>>26,this.words[T]=67108863&R;for(;A!==0&&T<C.length;T++)A=(R=(0|C.words[T])+A)>>26,this.words[T]=67108863&R;if(A===0&&T<C.length&&C!==this)for(;T<C.length;T++)this.words[T]=C.words[T];return this.length=Math.max(this.length,T),C!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(O){return this.clone().isub(O)};var y=function(O,R,C){var _,k,A,T=O.words,D=R.words,B=C.words,F=0,Y=0|T[0],X=8191&Y,re=Y>>>13,z=0|T[1],ee=8191&z,L=z>>>13,M=0|T[2],K=8191&M,se=M>>>13,te=0|T[3],ae=8191&te,Q=te>>>13,fe=0|T[4],le=8191&fe,ne=fe>>>13,ue=0|T[5],he=8191&ue,ke=ue>>>13,pe=0|T[6],Ce=8191&pe,Me=pe>>>13,Ie=0|T[7],Ye=8191&Ie,at=Ie>>>13,rt=0|T[8],it=8191&rt,et=rt>>>13,st=0|T[9],je=8191&st,ht=st>>>13,Je=0|D[0],nt=8191&Je,ct=Je>>>13,_t=0|D[1],mt=8191&_t,gt=_t>>>13,He=0|D[2],Ue=8191&He,bt=He>>>13,tt=0|D[3],dt=8191&tt,ut=tt>>>13,vt=0|D[4],xt=8191&vt,At=vt>>>13,Kt=0|D[5],yt=8191&Kt,Ct=Kt>>>13,Ft=0|D[6],kt=8191&Ft,Ae=Ft>>>13,Fe=0|D[7],Qe=8191&Fe,ie=Fe>>>13,_e=0|D[8],de=8191&_e,ve=_e>>>13,be=0|D[9],we=8191&be,De=be>>>13;C.negative=O.negative^R.negative,C.length=19;var Le=(F+(_=Math.imul(X,nt))|0)+((8191&(k=(k=Math.imul(X,ct))+Math.imul(re,nt)|0))<<13)|0;F=((A=Math.imul(re,ct))+(k>>>13)|0)+(Le>>>26)|0,Le&=67108863,_=Math.imul(ee,nt),k=(k=Math.imul(ee,ct))+Math.imul(L,nt)|0,A=Math.imul(L,ct);var Oe=(F+(_=_+Math.imul(X,mt)|0)|0)+((8191&(k=(k=k+Math.imul(X,gt)|0)+Math.imul(re,mt)|0))<<13)|0;F=((A=A+Math.imul(re,gt)|0)+(k>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,_=Math.imul(K,nt),k=(k=Math.imul(K,ct))+Math.imul(se,nt)|0,A=Math.imul(se,ct),_=_+Math.imul(ee,mt)|0,k=(k=k+Math.imul(ee,gt)|0)+Math.imul(L,mt)|0,A=A+Math.imul(L,gt)|0;var Pe=(F+(_=_+Math.imul(X,Ue)|0)|0)+((8191&(k=(k=k+Math.imul(X,bt)|0)+Math.imul(re,Ue)|0))<<13)|0;F=((A=A+Math.imul(re,bt)|0)+(k>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,_=Math.imul(ae,nt),k=(k=Math.imul(ae,ct))+Math.imul(Q,nt)|0,A=Math.imul(Q,ct),_=_+Math.imul(K,mt)|0,k=(k=k+Math.imul(K,gt)|0)+Math.imul(se,mt)|0,A=A+Math.imul(se,gt)|0,_=_+Math.imul(ee,Ue)|0,k=(k=k+Math.imul(ee,bt)|0)+Math.imul(L,Ue)|0,A=A+Math.imul(L,bt)|0;var Be=(F+(_=_+Math.imul(X,dt)|0)|0)+((8191&(k=(k=k+Math.imul(X,ut)|0)+Math.imul(re,dt)|0))<<13)|0;F=((A=A+Math.imul(re,ut)|0)+(k>>>13)|0)+(Be>>>26)|0,Be&=67108863,_=Math.imul(le,nt),k=(k=Math.imul(le,ct))+Math.imul(ne,nt)|0,A=Math.imul(ne,ct),_=_+Math.imul(ae,mt)|0,k=(k=k+Math.imul(ae,gt)|0)+Math.imul(Q,mt)|0,A=A+Math.imul(Q,gt)|0,_=_+Math.imul(K,Ue)|0,k=(k=k+Math.imul(K,bt)|0)+Math.imul(se,Ue)|0,A=A+Math.imul(se,bt)|0,_=_+Math.imul(ee,dt)|0,k=(k=k+Math.imul(ee,ut)|0)+Math.imul(L,dt)|0,A=A+Math.imul(L,ut)|0;var xe=(F+(_=_+Math.imul(X,xt)|0)|0)+((8191&(k=(k=k+Math.imul(X,At)|0)+Math.imul(re,xt)|0))<<13)|0;F=((A=A+Math.imul(re,At)|0)+(k>>>13)|0)+(xe>>>26)|0,xe&=67108863,_=Math.imul(he,nt),k=(k=Math.imul(he,ct))+Math.imul(ke,nt)|0,A=Math.imul(ke,ct),_=_+Math.imul(le,mt)|0,k=(k=k+Math.imul(le,gt)|0)+Math.imul(ne,mt)|0,A=A+Math.imul(ne,gt)|0,_=_+Math.imul(ae,Ue)|0,k=(k=k+Math.imul(ae,bt)|0)+Math.imul(Q,Ue)|0,A=A+Math.imul(Q,bt)|0,_=_+Math.imul(K,dt)|0,k=(k=k+Math.imul(K,ut)|0)+Math.imul(se,dt)|0,A=A+Math.imul(se,ut)|0,_=_+Math.imul(ee,xt)|0,k=(k=k+Math.imul(ee,At)|0)+Math.imul(L,xt)|0,A=A+Math.imul(L,At)|0;var Ee=(F+(_=_+Math.imul(X,yt)|0)|0)+((8191&(k=(k=k+Math.imul(X,Ct)|0)+Math.imul(re,yt)|0))<<13)|0;F=((A=A+Math.imul(re,Ct)|0)+(k>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,_=Math.imul(Ce,nt),k=(k=Math.imul(Ce,ct))+Math.imul(Me,nt)|0,A=Math.imul(Me,ct),_=_+Math.imul(he,mt)|0,k=(k=k+Math.imul(he,gt)|0)+Math.imul(ke,mt)|0,A=A+Math.imul(ke,gt)|0,_=_+Math.imul(le,Ue)|0,k=(k=k+Math.imul(le,bt)|0)+Math.imul(ne,Ue)|0,A=A+Math.imul(ne,bt)|0,_=_+Math.imul(ae,dt)|0,k=(k=k+Math.imul(ae,ut)|0)+Math.imul(Q,dt)|0,A=A+Math.imul(Q,ut)|0,_=_+Math.imul(K,xt)|0,k=(k=k+Math.imul(K,At)|0)+Math.imul(se,xt)|0,A=A+Math.imul(se,At)|0,_=_+Math.imul(ee,yt)|0,k=(k=k+Math.imul(ee,Ct)|0)+Math.imul(L,yt)|0,A=A+Math.imul(L,Ct)|0;var qe=(F+(_=_+Math.imul(X,kt)|0)|0)+((8191&(k=(k=k+Math.imul(X,Ae)|0)+Math.imul(re,kt)|0))<<13)|0;F=((A=A+Math.imul(re,Ae)|0)+(k>>>13)|0)+(qe>>>26)|0,qe&=67108863,_=Math.imul(Ye,nt),k=(k=Math.imul(Ye,ct))+Math.imul(at,nt)|0,A=Math.imul(at,ct),_=_+Math.imul(Ce,mt)|0,k=(k=k+Math.imul(Ce,gt)|0)+Math.imul(Me,mt)|0,A=A+Math.imul(Me,gt)|0,_=_+Math.imul(he,Ue)|0,k=(k=k+Math.imul(he,bt)|0)+Math.imul(ke,Ue)|0,A=A+Math.imul(ke,bt)|0,_=_+Math.imul(le,dt)|0,k=(k=k+Math.imul(le,ut)|0)+Math.imul(ne,dt)|0,A=A+Math.imul(ne,ut)|0,_=_+Math.imul(ae,xt)|0,k=(k=k+Math.imul(ae,At)|0)+Math.imul(Q,xt)|0,A=A+Math.imul(Q,At)|0,_=_+Math.imul(K,yt)|0,k=(k=k+Math.imul(K,Ct)|0)+Math.imul(se,yt)|0,A=A+Math.imul(se,Ct)|0,_=_+Math.imul(ee,kt)|0,k=(k=k+Math.imul(ee,Ae)|0)+Math.imul(L,kt)|0,A=A+Math.imul(L,Ae)|0;var ce=(F+(_=_+Math.imul(X,Qe)|0)|0)+((8191&(k=(k=k+Math.imul(X,ie)|0)+Math.imul(re,Qe)|0))<<13)|0;F=((A=A+Math.imul(re,ie)|0)+(k>>>13)|0)+(ce>>>26)|0,ce&=67108863,_=Math.imul(it,nt),k=(k=Math.imul(it,ct))+Math.imul(et,nt)|0,A=Math.imul(et,ct),_=_+Math.imul(Ye,mt)|0,k=(k=k+Math.imul(Ye,gt)|0)+Math.imul(at,mt)|0,A=A+Math.imul(at,gt)|0,_=_+Math.imul(Ce,Ue)|0,k=(k=k+Math.imul(Ce,bt)|0)+Math.imul(Me,Ue)|0,A=A+Math.imul(Me,bt)|0,_=_+Math.imul(he,dt)|0,k=(k=k+Math.imul(he,ut)|0)+Math.imul(ke,dt)|0,A=A+Math.imul(ke,ut)|0,_=_+Math.imul(le,xt)|0,k=(k=k+Math.imul(le,At)|0)+Math.imul(ne,xt)|0,A=A+Math.imul(ne,At)|0,_=_+Math.imul(ae,yt)|0,k=(k=k+Math.imul(ae,Ct)|0)+Math.imul(Q,yt)|0,A=A+Math.imul(Q,Ct)|0,_=_+Math.imul(K,kt)|0,k=(k=k+Math.imul(K,Ae)|0)+Math.imul(se,kt)|0,A=A+Math.imul(se,Ae)|0,_=_+Math.imul(ee,Qe)|0,k=(k=k+Math.imul(ee,ie)|0)+Math.imul(L,Qe)|0,A=A+Math.imul(L,ie)|0;var Te=(F+(_=_+Math.imul(X,de)|0)|0)+((8191&(k=(k=k+Math.imul(X,ve)|0)+Math.imul(re,de)|0))<<13)|0;F=((A=A+Math.imul(re,ve)|0)+(k>>>13)|0)+(Te>>>26)|0,Te&=67108863,_=Math.imul(je,nt),k=(k=Math.imul(je,ct))+Math.imul(ht,nt)|0,A=Math.imul(ht,ct),_=_+Math.imul(it,mt)|0,k=(k=k+Math.imul(it,gt)|0)+Math.imul(et,mt)|0,A=A+Math.imul(et,gt)|0,_=_+Math.imul(Ye,Ue)|0,k=(k=k+Math.imul(Ye,bt)|0)+Math.imul(at,Ue)|0,A=A+Math.imul(at,bt)|0,_=_+Math.imul(Ce,dt)|0,k=(k=k+Math.imul(Ce,ut)|0)+Math.imul(Me,dt)|0,A=A+Math.imul(Me,ut)|0,_=_+Math.imul(he,xt)|0,k=(k=k+Math.imul(he,At)|0)+Math.imul(ke,xt)|0,A=A+Math.imul(ke,At)|0,_=_+Math.imul(le,yt)|0,k=(k=k+Math.imul(le,Ct)|0)+Math.imul(ne,yt)|0,A=A+Math.imul(ne,Ct)|0,_=_+Math.imul(ae,kt)|0,k=(k=k+Math.imul(ae,Ae)|0)+Math.imul(Q,kt)|0,A=A+Math.imul(Q,Ae)|0,_=_+Math.imul(K,Qe)|0,k=(k=k+Math.imul(K,ie)|0)+Math.imul(se,Qe)|0,A=A+Math.imul(se,ie)|0,_=_+Math.imul(ee,de)|0,k=(k=k+Math.imul(ee,ve)|0)+Math.imul(L,de)|0,A=A+Math.imul(L,ve)|0;var me=(F+(_=_+Math.imul(X,we)|0)|0)+((8191&(k=(k=k+Math.imul(X,De)|0)+Math.imul(re,we)|0))<<13)|0;F=((A=A+Math.imul(re,De)|0)+(k>>>13)|0)+(me>>>26)|0,me&=67108863,_=Math.imul(je,mt),k=(k=Math.imul(je,gt))+Math.imul(ht,mt)|0,A=Math.imul(ht,gt),_=_+Math.imul(it,Ue)|0,k=(k=k+Math.imul(it,bt)|0)+Math.imul(et,Ue)|0,A=A+Math.imul(et,bt)|0,_=_+Math.imul(Ye,dt)|0,k=(k=k+Math.imul(Ye,ut)|0)+Math.imul(at,dt)|0,A=A+Math.imul(at,ut)|0,_=_+Math.imul(Ce,xt)|0,k=(k=k+Math.imul(Ce,At)|0)+Math.imul(Me,xt)|0,A=A+Math.imul(Me,At)|0,_=_+Math.imul(he,yt)|0,k=(k=k+Math.imul(he,Ct)|0)+Math.imul(ke,yt)|0,A=A+Math.imul(ke,Ct)|0,_=_+Math.imul(le,kt)|0,k=(k=k+Math.imul(le,Ae)|0)+Math.imul(ne,kt)|0,A=A+Math.imul(ne,Ae)|0,_=_+Math.imul(ae,Qe)|0,k=(k=k+Math.imul(ae,ie)|0)+Math.imul(Q,Qe)|0,A=A+Math.imul(Q,ie)|0,_=_+Math.imul(K,de)|0,k=(k=k+Math.imul(K,ve)|0)+Math.imul(se,de)|0,A=A+Math.imul(se,ve)|0;var ye=(F+(_=_+Math.imul(ee,we)|0)|0)+((8191&(k=(k=k+Math.imul(ee,De)|0)+Math.imul(L,we)|0))<<13)|0;F=((A=A+Math.imul(L,De)|0)+(k>>>13)|0)+(ye>>>26)|0,ye&=67108863,_=Math.imul(je,Ue),k=(k=Math.imul(je,bt))+Math.imul(ht,Ue)|0,A=Math.imul(ht,bt),_=_+Math.imul(it,dt)|0,k=(k=k+Math.imul(it,ut)|0)+Math.imul(et,dt)|0,A=A+Math.imul(et,ut)|0,_=_+Math.imul(Ye,xt)|0,k=(k=k+Math.imul(Ye,At)|0)+Math.imul(at,xt)|0,A=A+Math.imul(at,At)|0,_=_+Math.imul(Ce,yt)|0,k=(k=k+Math.imul(Ce,Ct)|0)+Math.imul(Me,yt)|0,A=A+Math.imul(Me,Ct)|0,_=_+Math.imul(he,kt)|0,k=(k=k+Math.imul(he,Ae)|0)+Math.imul(ke,kt)|0,A=A+Math.imul(ke,Ae)|0,_=_+Math.imul(le,Qe)|0,k=(k=k+Math.imul(le,ie)|0)+Math.imul(ne,Qe)|0,A=A+Math.imul(ne,ie)|0,_=_+Math.imul(ae,de)|0,k=(k=k+Math.imul(ae,ve)|0)+Math.imul(Q,de)|0,A=A+Math.imul(Q,ve)|0;var Ve=(F+(_=_+Math.imul(K,we)|0)|0)+((8191&(k=(k=k+Math.imul(K,De)|0)+Math.imul(se,we)|0))<<13)|0;F=((A=A+Math.imul(se,De)|0)+(k>>>13)|0)+(Ve>>>26)|0,Ve&=67108863,_=Math.imul(je,dt),k=(k=Math.imul(je,ut))+Math.imul(ht,dt)|0,A=Math.imul(ht,ut),_=_+Math.imul(it,xt)|0,k=(k=k+Math.imul(it,At)|0)+Math.imul(et,xt)|0,A=A+Math.imul(et,At)|0,_=_+Math.imul(Ye,yt)|0,k=(k=k+Math.imul(Ye,Ct)|0)+Math.imul(at,yt)|0,A=A+Math.imul(at,Ct)|0,_=_+Math.imul(Ce,kt)|0,k=(k=k+Math.imul(Ce,Ae)|0)+Math.imul(Me,kt)|0,A=A+Math.imul(Me,Ae)|0,_=_+Math.imul(he,Qe)|0,k=(k=k+Math.imul(he,ie)|0)+Math.imul(ke,Qe)|0,A=A+Math.imul(ke,ie)|0,_=_+Math.imul(le,de)|0,k=(k=k+Math.imul(le,ve)|0)+Math.imul(ne,de)|0,A=A+Math.imul(ne,ve)|0;var $e=(F+(_=_+Math.imul(ae,we)|0)|0)+((8191&(k=(k=k+Math.imul(ae,De)|0)+Math.imul(Q,we)|0))<<13)|0;F=((A=A+Math.imul(Q,De)|0)+(k>>>13)|0)+($e>>>26)|0,$e&=67108863,_=Math.imul(je,xt),k=(k=Math.imul(je,At))+Math.imul(ht,xt)|0,A=Math.imul(ht,At),_=_+Math.imul(it,yt)|0,k=(k=k+Math.imul(it,Ct)|0)+Math.imul(et,yt)|0,A=A+Math.imul(et,Ct)|0,_=_+Math.imul(Ye,kt)|0,k=(k=k+Math.imul(Ye,Ae)|0)+Math.imul(at,kt)|0,A=A+Math.imul(at,Ae)|0,_=_+Math.imul(Ce,Qe)|0,k=(k=k+Math.imul(Ce,ie)|0)+Math.imul(Me,Qe)|0,A=A+Math.imul(Me,ie)|0,_=_+Math.imul(he,de)|0,k=(k=k+Math.imul(he,ve)|0)+Math.imul(ke,de)|0,A=A+Math.imul(ke,ve)|0;var ot=(F+(_=_+Math.imul(le,we)|0)|0)+((8191&(k=(k=k+Math.imul(le,De)|0)+Math.imul(ne,we)|0))<<13)|0;F=((A=A+Math.imul(ne,De)|0)+(k>>>13)|0)+(ot>>>26)|0,ot&=67108863,_=Math.imul(je,yt),k=(k=Math.imul(je,Ct))+Math.imul(ht,yt)|0,A=Math.imul(ht,Ct),_=_+Math.imul(it,kt)|0,k=(k=k+Math.imul(it,Ae)|0)+Math.imul(et,kt)|0,A=A+Math.imul(et,Ae)|0,_=_+Math.imul(Ye,Qe)|0,k=(k=k+Math.imul(Ye,ie)|0)+Math.imul(at,Qe)|0,A=A+Math.imul(at,ie)|0,_=_+Math.imul(Ce,de)|0,k=(k=k+Math.imul(Ce,ve)|0)+Math.imul(Me,de)|0,A=A+Math.imul(Me,ve)|0;var Rt=(F+(_=_+Math.imul(he,we)|0)|0)+((8191&(k=(k=k+Math.imul(he,De)|0)+Math.imul(ke,we)|0))<<13)|0;F=((A=A+Math.imul(ke,De)|0)+(k>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,_=Math.imul(je,kt),k=(k=Math.imul(je,Ae))+Math.imul(ht,kt)|0,A=Math.imul(ht,Ae),_=_+Math.imul(it,Qe)|0,k=(k=k+Math.imul(it,ie)|0)+Math.imul(et,Qe)|0,A=A+Math.imul(et,ie)|0,_=_+Math.imul(Ye,de)|0,k=(k=k+Math.imul(Ye,ve)|0)+Math.imul(at,de)|0,A=A+Math.imul(at,ve)|0;var Bt=(F+(_=_+Math.imul(Ce,we)|0)|0)+((8191&(k=(k=k+Math.imul(Ce,De)|0)+Math.imul(Me,we)|0))<<13)|0;F=((A=A+Math.imul(Me,De)|0)+(k>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,_=Math.imul(je,Qe),k=(k=Math.imul(je,ie))+Math.imul(ht,Qe)|0,A=Math.imul(ht,ie),_=_+Math.imul(it,de)|0,k=(k=k+Math.imul(it,ve)|0)+Math.imul(et,de)|0,A=A+Math.imul(et,ve)|0;var Vt=(F+(_=_+Math.imul(Ye,we)|0)|0)+((8191&(k=(k=k+Math.imul(Ye,De)|0)+Math.imul(at,we)|0))<<13)|0;F=((A=A+Math.imul(at,De)|0)+(k>>>13)|0)+(Vt>>>26)|0,Vt&=67108863,_=Math.imul(je,de),k=(k=Math.imul(je,ve))+Math.imul(ht,de)|0,A=Math.imul(ht,ve);var Lt=(F+(_=_+Math.imul(it,we)|0)|0)+((8191&(k=(k=k+Math.imul(it,De)|0)+Math.imul(et,we)|0))<<13)|0;F=((A=A+Math.imul(et,De)|0)+(k>>>13)|0)+(Lt>>>26)|0,Lt&=67108863;var er=(F+(_=Math.imul(je,we))|0)+((8191&(k=(k=Math.imul(je,De))+Math.imul(ht,we)|0))<<13)|0;return F=((A=Math.imul(ht,De))+(k>>>13)|0)+(er>>>26)|0,er&=67108863,B[0]=Le,B[1]=Oe,B[2]=Pe,B[3]=Be,B[4]=xe,B[5]=Ee,B[6]=qe,B[7]=ce,B[8]=Te,B[9]=me,B[10]=ye,B[11]=Ve,B[12]=$e,B[13]=ot,B[14]=Rt,B[15]=Bt,B[16]=Vt,B[17]=Lt,B[18]=er,F!==0&&(B[19]=F,C.length++),C};function E(O,R,C){return new N().mulp(O,R,C)}function N(O,R){this.x=O,this.y=R}Math.imul||(y=x),i.prototype.mulTo=function(O,R){var C=this.length+O.length;return this.length===10&&O.length===10?y(this,O,R):C<63?x(this,O,R):C<1024?function(_,k,A){A.negative=k.negative^_.negative,A.length=_.length+k.length;for(var T=0,D=0,B=0;B<A.length-1;B++){var F=D;D=0;for(var Y=67108863&T,X=Math.min(B,k.length-1),re=Math.max(0,B-_.length+1);re<=X;re++){var z=B-re,ee=(0|_.words[z])*(0|k.words[re]),L=67108863&ee;Y=67108863&(L=L+Y|0),D+=(F=(F=F+(ee/67108864|0)|0)+(L>>>26)|0)>>>26,F&=67108863}A.words[B]=Y,T=F,F=D}return T!==0?A.words[B]=T:A.length--,A.strip()}(this,O,R):E(this,O,R)},N.prototype.makeRBT=function(O){for(var R=new Array(O),C=i.prototype._countBits(O)-1,_=0;_<O;_++)R[_]=this.revBin(_,C,O);return R},N.prototype.revBin=function(O,R,C){if(O===0||O===C-1)return O;for(var _=0,k=0;k<R;k++)_|=(1&O)<<R-k-1,O>>=1;return _},N.prototype.permute=function(O,R,C,_,k,A){for(var T=0;T<A;T++)_[T]=R[O[T]],k[T]=C[O[T]]},N.prototype.transform=function(O,R,C,_,k,A){this.permute(A,O,R,C,_,k);for(var T=1;T<k;T<<=1)for(var D=T<<1,B=Math.cos(2*Math.PI/D),F=Math.sin(2*Math.PI/D),Y=0;Y<k;Y+=D)for(var X=B,re=F,z=0;z<T;z++){var ee=C[Y+z],L=_[Y+z],M=C[Y+z+T],K=_[Y+z+T],se=X*M-re*K;K=X*K+re*M,M=se,C[Y+z]=ee+M,_[Y+z]=L+K,C[Y+z+T]=ee-M,_[Y+z+T]=L-K,z!==D&&(se=B*X-F*re,re=B*re+F*X,X=se)}},N.prototype.guessLen13b=function(O,R){var C=1|Math.max(R,O),_=1&C,k=0;for(C=C/2|0;C;C>>>=1)k++;return 1<<k+1+_},N.prototype.conjugate=function(O,R,C){if(!(C<=1))for(var _=0;_<C/2;_++){var k=O[_];O[_]=O[C-_-1],O[C-_-1]=k,k=R[_],R[_]=-R[C-_-1],R[C-_-1]=-k}},N.prototype.normalize13b=function(O,R){for(var C=0,_=0;_<R/2;_++){var k=8192*Math.round(O[2*_+1]/R)+Math.round(O[2*_]/R)+C;O[_]=67108863&k,C=k<67108864?0:k/67108864|0}return O},N.prototype.convert13b=function(O,R,C,_){for(var k=0,A=0;A<R;A++)k+=0|O[A],C[2*A]=8191&k,k>>>=13,C[2*A+1]=8191&k,k>>>=13;for(A=2*R;A<_;++A)C[A]=0;l(k===0),l((-8192&k)==0)},N.prototype.stub=function(O){for(var R=new Array(O),C=0;C<O;C++)R[C]=0;return R},N.prototype.mulp=function(O,R,C){var _=2*this.guessLen13b(O.length,R.length),k=this.makeRBT(_),A=this.stub(_),T=new Array(_),D=new Array(_),B=new Array(_),F=new Array(_),Y=new Array(_),X=new Array(_),re=C.words;re.length=_,this.convert13b(O.words,O.length,T,_),this.convert13b(R.words,R.length,F,_),this.transform(T,A,D,B,_,k),this.transform(F,A,Y,X,_,k);for(var z=0;z<_;z++){var ee=D[z]*Y[z]-B[z]*X[z];B[z]=D[z]*X[z]+B[z]*Y[z],D[z]=ee}return this.conjugate(D,B,_),this.transform(D,B,re,A,_,k),this.conjugate(re,A,_),this.normalize13b(re,_),C.negative=O.negative^R.negative,C.length=O.length+R.length,C.strip()},i.prototype.mul=function(O){var R=new i(null);return R.words=new Array(this.length+O.length),this.mulTo(O,R)},i.prototype.mulf=function(O){var R=new i(null);return R.words=new Array(this.length+O.length),E(this,O,R)},i.prototype.imul=function(O){return this.clone().mulTo(O,this)},i.prototype.imuln=function(O){l(typeof O=="number"),l(O<67108864);for(var R=0,C=0;C<this.length;C++){var _=(0|this.words[C])*O,k=(67108863&_)+(67108863&R);R>>=26,R+=_/67108864|0,R+=k>>>26,this.words[C]=67108863&k}return R!==0&&(this.words[C]=R,this.length++),this},i.prototype.muln=function(O){return this.clone().imuln(O)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(O){var R=function(A){for(var T=new Array(A.bitLength()),D=0;D<T.length;D++){var B=D/26|0,F=D%26;T[D]=(A.words[B]&1<<F)>>>F}return T}(O);if(R.length===0)return new i(1);for(var C=this,_=0;_<R.length&&R[_]===0;_++,C=C.sqr());if(++_<R.length)for(var k=C.sqr();_<R.length;_++,k=k.sqr())R[_]!==0&&(C=C.mul(k));return C},i.prototype.iushln=function(O){l(typeof O=="number"&&O>=0);var R,C=O%26,_=(O-C)/26,k=67108863>>>26-C<<26-C;if(C!==0){var A=0;for(R=0;R<this.length;R++){var T=this.words[R]&k,D=(0|this.words[R])-T<<C;this.words[R]=D|A,A=T>>>26-C}A&&(this.words[R]=A,this.length++)}if(_!==0){for(R=this.length-1;R>=0;R--)this.words[R+_]=this.words[R];for(R=0;R<_;R++)this.words[R]=0;this.length+=_}return this.strip()},i.prototype.ishln=function(O){return l(this.negative===0),this.iushln(O)},i.prototype.iushrn=function(O,R,C){var _;l(typeof O=="number"&&O>=0),_=R?(R-R%26)/26:0;var k=O%26,A=Math.min((O-k)/26,this.length),T=67108863^67108863>>>k<<k,D=C;if(_-=A,_=Math.max(0,_),D){for(var B=0;B<A;B++)D.words[B]=this.words[B];D.length=A}if(A!==0)if(this.length>A)for(this.length-=A,B=0;B<this.length;B++)this.words[B]=this.words[B+A];else this.words[0]=0,this.length=1;var F=0;for(B=this.length-1;B>=0&&(F!==0||B>=_);B--){var Y=0|this.words[B];this.words[B]=F<<26-k|Y>>>k,F=Y&T}return D&&F!==0&&(D.words[D.length++]=F),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(O,R,C){return l(this.negative===0),this.iushrn(O,R,C)},i.prototype.shln=function(O){return this.clone().ishln(O)},i.prototype.ushln=function(O){return this.clone().iushln(O)},i.prototype.shrn=function(O){return this.clone().ishrn(O)},i.prototype.ushrn=function(O){return this.clone().iushrn(O)},i.prototype.testn=function(O){l(typeof O=="number"&&O>=0);var R=O%26,C=(O-R)/26,_=1<<R;return!(this.length<=C)&&!!(this.words[C]&_)},i.prototype.imaskn=function(O){l(typeof O=="number"&&O>=0);var R=O%26,C=(O-R)/26;if(l(this.negative===0,"imaskn works only with positive numbers"),this.length<=C)return this;if(R!==0&&C++,this.length=Math.min(C,this.length),R!==0){var _=67108863^67108863>>>R<<R;this.words[this.length-1]&=_}return this.strip()},i.prototype.maskn=function(O){return this.clone().imaskn(O)},i.prototype.iaddn=function(O){return l(typeof O=="number"),l(O<67108864),O<0?this.isubn(-O):this.negative!==0?this.length===1&&(0|this.words[0])<O?(this.words[0]=O-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(O),this.negative=1,this):this._iaddn(O)},i.prototype._iaddn=function(O){this.words[0]+=O;for(var R=0;R<this.length&&this.words[R]>=67108864;R++)this.words[R]-=67108864,R===this.length-1?this.words[R+1]=1:this.words[R+1]++;return this.length=Math.max(this.length,R+1),this},i.prototype.isubn=function(O){if(l(typeof O=="number"),l(O<67108864),O<0)return this.iaddn(-O);if(this.negative!==0)return this.negative=0,this.iaddn(O),this.negative=1,this;if(this.words[0]-=O,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var R=0;R<this.length&&this.words[R]<0;R++)this.words[R]+=67108864,this.words[R+1]-=1;return this.strip()},i.prototype.addn=function(O){return this.clone().iaddn(O)},i.prototype.subn=function(O){return this.clone().isubn(O)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(O,R,C){var _,k,A=O.length+C;this._expand(A);var T=0;for(_=0;_<O.length;_++){k=(0|this.words[_+C])+T;var D=(0|O.words[_])*R;T=((k-=67108863&D)>>26)-(D/67108864|0),this.words[_+C]=67108863&k}for(;_<this.length-C;_++)T=(k=(0|this.words[_+C])+T)>>26,this.words[_+C]=67108863&k;if(T===0)return this.strip();for(l(T===-1),T=0,_=0;_<this.length;_++)T=(k=-(0|this.words[_])+T)>>26,this.words[_]=67108863&k;return this.negative=1,this.strip()},i.prototype._wordDiv=function(O,R){var C=(this.length,O.length),_=this.clone(),k=O,A=0|k.words[k.length-1];(C=26-this._countBits(A))!==0&&(k=k.ushln(C),_.iushln(C),A=0|k.words[k.length-1]);var T,D=_.length-k.length;if(R!=="mod"){(T=new i(null)).length=D+1,T.words=new Array(T.length);for(var B=0;B<T.length;B++)T.words[B]=0}var F=_.clone()._ishlnsubmul(k,1,D);F.negative===0&&(_=F,T&&(T.words[D]=1));for(var Y=D-1;Y>=0;Y--){var X=67108864*(0|_.words[k.length+Y])+(0|_.words[k.length+Y-1]);for(X=Math.min(X/A|0,67108863),_._ishlnsubmul(k,X,Y);_.negative!==0;)X--,_.negative=0,_._ishlnsubmul(k,1,Y),_.isZero()||(_.negative^=1);T&&(T.words[Y]=X)}return T&&T.strip(),_.strip(),R!=="div"&&C!==0&&_.iushrn(C),{div:T||null,mod:_}},i.prototype.divmod=function(O,R,C){return l(!O.isZero()),this.isZero()?{div:new i(0),mod:new i(0)}:this.negative!==0&&O.negative===0?(A=this.neg().divmod(O,R),R!=="mod"&&(_=A.div.neg()),R!=="div"&&(k=A.mod.neg(),C&&k.negative!==0&&k.iadd(O)),{div:_,mod:k}):this.negative===0&&O.negative!==0?(A=this.divmod(O.neg(),R),R!=="mod"&&(_=A.div.neg()),{div:_,mod:A.mod}):(this.negative&O.negative)!=0?(A=this.neg().divmod(O.neg(),R),R!=="div"&&(k=A.mod.neg(),C&&k.negative!==0&&k.isub(O)),{div:A.div,mod:k}):O.length>this.length||this.cmp(O)<0?{div:new i(0),mod:this}:O.length===1?R==="div"?{div:this.divn(O.words[0]),mod:null}:R==="mod"?{div:null,mod:new i(this.modn(O.words[0]))}:{div:this.divn(O.words[0]),mod:new i(this.modn(O.words[0]))}:this._wordDiv(O,R);var _,k,A},i.prototype.div=function(O){return this.divmod(O,"div",!1).div},i.prototype.mod=function(O){return this.divmod(O,"mod",!1).mod},i.prototype.umod=function(O){return this.divmod(O,"mod",!0).mod},i.prototype.divRound=function(O){var R=this.divmod(O);if(R.mod.isZero())return R.div;var C=R.div.negative!==0?R.mod.isub(O):R.mod,_=O.ushrn(1),k=O.andln(1),A=C.cmp(_);return A<0||k===1&&A===0?R.div:R.div.negative!==0?R.div.isubn(1):R.div.iaddn(1)},i.prototype.modn=function(O){l(O<=67108863);for(var R=(1<<26)%O,C=0,_=this.length-1;_>=0;_--)C=(R*C+(0|this.words[_]))%O;return C},i.prototype.idivn=function(O){l(O<=67108863);for(var R=0,C=this.length-1;C>=0;C--){var _=(0|this.words[C])+67108864*R;this.words[C]=_/O|0,R=_%O}return this.strip()},i.prototype.divn=function(O){return this.clone().idivn(O)},i.prototype.egcd=function(O){l(O.negative===0),l(!O.isZero());var R=this,C=O.clone();R=R.negative!==0?R.umod(O):R.clone();for(var _=new i(1),k=new i(0),A=new i(0),T=new i(1),D=0;R.isEven()&&C.isEven();)R.iushrn(1),C.iushrn(1),++D;for(var B=C.clone(),F=R.clone();!R.isZero();){for(var Y=0,X=1;(R.words[0]&X)==0&&Y<26;++Y,X<<=1);if(Y>0)for(R.iushrn(Y);Y-- >0;)(_.isOdd()||k.isOdd())&&(_.iadd(B),k.isub(F)),_.iushrn(1),k.iushrn(1);for(var re=0,z=1;(C.words[0]&z)==0&&re<26;++re,z<<=1);if(re>0)for(C.iushrn(re);re-- >0;)(A.isOdd()||T.isOdd())&&(A.iadd(B),T.isub(F)),A.iushrn(1),T.iushrn(1);R.cmp(C)>=0?(R.isub(C),_.isub(A),k.isub(T)):(C.isub(R),A.isub(_),T.isub(k))}return{a:A,b:T,gcd:C.iushln(D)}},i.prototype._invmp=function(O){l(O.negative===0),l(!O.isZero());var R=this,C=O.clone();R=R.negative!==0?R.umod(O):R.clone();for(var _,k=new i(1),A=new i(0),T=C.clone();R.cmpn(1)>0&&C.cmpn(1)>0;){for(var D=0,B=1;(R.words[0]&B)==0&&D<26;++D,B<<=1);if(D>0)for(R.iushrn(D);D-- >0;)k.isOdd()&&k.iadd(T),k.iushrn(1);for(var F=0,Y=1;(C.words[0]&Y)==0&&F<26;++F,Y<<=1);if(F>0)for(C.iushrn(F);F-- >0;)A.isOdd()&&A.iadd(T),A.iushrn(1);R.cmp(C)>=0?(R.isub(C),k.isub(A)):(C.isub(R),A.isub(k))}return(_=R.cmpn(1)===0?k:A).cmpn(0)<0&&_.iadd(O),_},i.prototype.gcd=function(O){if(this.isZero())return O.abs();if(O.isZero())return this.abs();var R=this.clone(),C=O.clone();R.negative=0,C.negative=0;for(var _=0;R.isEven()&&C.isEven();_++)R.iushrn(1),C.iushrn(1);for(;;){for(;R.isEven();)R.iushrn(1);for(;C.isEven();)C.iushrn(1);var k=R.cmp(C);if(k<0){var A=R;R=C,C=A}else if(k===0||C.cmpn(1)===0)break;R.isub(C)}return C.iushln(_)},i.prototype.invm=function(O){return this.egcd(O).a.umod(O)},i.prototype.isEven=function(){return(1&this.words[0])==0},i.prototype.isOdd=function(){return(1&this.words[0])==1},i.prototype.andln=function(O){return this.words[0]&O},i.prototype.bincn=function(O){l(typeof O=="number");var R=O%26,C=(O-R)/26,_=1<<R;if(this.length<=C)return this._expand(C+1),this.words[C]|=_,this;for(var k=_,A=C;k!==0&&A<this.length;A++){var T=0|this.words[A];k=(T+=k)>>>26,T&=67108863,this.words[A]=T}return k!==0&&(this.words[A]=k,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(O){var R,C=O<0;if(this.negative!==0&&!C)return-1;if(this.negative===0&&C)return 1;if(this.strip(),this.length>1)R=1;else{C&&(O=-O),l(O<=67108863,"Number is too big");var _=0|this.words[0];R=_===O?0:_<O?-1:1}return this.negative!==0?0|-R:R},i.prototype.cmp=function(O){if(this.negative!==0&&O.negative===0)return-1;if(this.negative===0&&O.negative!==0)return 1;var R=this.ucmp(O);return this.negative!==0?0|-R:R},i.prototype.ucmp=function(O){if(this.length>O.length)return 1;if(this.length<O.length)return-1;for(var R=0,C=this.length-1;C>=0;C--){var _=0|this.words[C],k=0|O.words[C];if(_!==k){_<k?R=-1:_>k&&(R=1);break}}return R},i.prototype.gtn=function(O){return this.cmpn(O)===1},i.prototype.gt=function(O){return this.cmp(O)===1},i.prototype.gten=function(O){return this.cmpn(O)>=0},i.prototype.gte=function(O){return this.cmp(O)>=0},i.prototype.ltn=function(O){return this.cmpn(O)===-1},i.prototype.lt=function(O){return this.cmp(O)===-1},i.prototype.lten=function(O){return this.cmpn(O)<=0},i.prototype.lte=function(O){return this.cmp(O)<=0},i.prototype.eqn=function(O){return this.cmpn(O)===0},i.prototype.eq=function(O){return this.cmp(O)===0},i.red=function(O){return new Z(O)},i.prototype.toRed=function(O){return l(!this.red,"Already a number in reduction context"),l(this.negative===0,"red works only with positives"),O.convertTo(this)._forceRed(O)},i.prototype.fromRed=function(){return l(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(O){return this.red=O,this},i.prototype.forceRed=function(O){return l(!this.red,"Already a number in reduction context"),this._forceRed(O)},i.prototype.redAdd=function(O){return l(this.red,"redAdd works only with red numbers"),this.red.add(this,O)},i.prototype.redIAdd=function(O){return l(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,O)},i.prototype.redSub=function(O){return l(this.red,"redSub works only with red numbers"),this.red.sub(this,O)},i.prototype.redISub=function(O){return l(this.red,"redISub works only with red numbers"),this.red.isub(this,O)},i.prototype.redShl=function(O){return l(this.red,"redShl works only with red numbers"),this.red.shl(this,O)},i.prototype.redMul=function(O){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,O),this.red.mul(this,O)},i.prototype.redIMul=function(O){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,O),this.red.imul(this,O)},i.prototype.redSqr=function(){return l(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return l(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return l(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return l(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return l(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(O){return l(this.red&&!O.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,O)};var I={k256:null,p224:null,p192:null,p25519:null};function P(O,R){this.name=O,this.p=new i(R,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function V(){P.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function U(){P.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function H(){P.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function G(){P.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function Z(O){if(typeof O=="string"){var R=i._prime(O);this.m=R.p,this.prime=R}else l(O.gtn(1),"modulus must be greater than 1"),this.m=O,this.prime=null}function W(O){Z.call(this,O),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}P.prototype._tmp=function(){var O=new i(null);return O.words=new Array(Math.ceil(this.n/13)),O},P.prototype.ireduce=function(O){var R,C=O;do this.split(C,this.tmp),R=(C=(C=this.imulK(C)).iadd(this.tmp)).bitLength();while(R>this.n);var _=R<this.n?-1:C.ucmp(this.p);return _===0?(C.words[0]=0,C.length=1):_>0?C.isub(this.p):C.strip!==void 0?C.strip():C._strip(),C},P.prototype.split=function(O,R){O.iushrn(this.n,0,R)},P.prototype.imulK=function(O){return O.imul(this.k)},c(V,P),V.prototype.split=function(O,R){for(var C=Math.min(O.length,9),_=0;_<C;_++)R.words[_]=O.words[_];if(R.length=C,O.length<=9)return O.words[0]=0,void(O.length=1);var k=O.words[9];for(R.words[R.length++]=4194303&k,_=10;_<O.length;_++){var A=0|O.words[_];O.words[_-10]=(4194303&A)<<4|k>>>22,k=A}k>>>=22,O.words[_-10]=k,k===0&&O.length>10?O.length-=10:O.length-=9},V.prototype.imulK=function(O){O.words[O.length]=0,O.words[O.length+1]=0,O.length+=2;for(var R=0,C=0;C<O.length;C++){var _=0|O.words[C];R+=977*_,O.words[C]=67108863&R,R=64*_+(R/67108864|0)}return O.words[O.length-1]===0&&(O.length--,O.words[O.length-1]===0&&O.length--),O},c(U,P),c(H,P),c(G,P),G.prototype.imulK=function(O){for(var R=0,C=0;C<O.length;C++){var _=19*(0|O.words[C])+R,k=67108863&_;_>>>=26,O.words[C]=k,R=_}return R!==0&&(O.words[O.length++]=R),O},i._prime=function(O){if(I[O])return I[O];var R;if(O==="k256")R=new V;else if(O==="p224")R=new U;else if(O==="p192")R=new H;else{if(O!=="p25519")throw new Error("Unknown prime "+O);R=new G}return I[O]=R,R},Z.prototype._verify1=function(O){l(O.negative===0,"red works only with positives"),l(O.red,"red works only with red numbers")},Z.prototype._verify2=function(O,R){l((O.negative|R.negative)==0,"red works only with positives"),l(O.red&&O.red===R.red,"red works only with red numbers")},Z.prototype.imod=function(O){return this.prime?this.prime.ireduce(O)._forceRed(this):O.umod(this.m)._forceRed(this)},Z.prototype.neg=function(O){return O.isZero()?O.clone():this.m.sub(O)._forceRed(this)},Z.prototype.add=function(O,R){this._verify2(O,R);var C=O.add(R);return C.cmp(this.m)>=0&&C.isub(this.m),C._forceRed(this)},Z.prototype.iadd=function(O,R){this._verify2(O,R);var C=O.iadd(R);return C.cmp(this.m)>=0&&C.isub(this.m),C},Z.prototype.sub=function(O,R){this._verify2(O,R);var C=O.sub(R);return C.cmpn(0)<0&&C.iadd(this.m),C._forceRed(this)},Z.prototype.isub=function(O,R){this._verify2(O,R);var C=O.isub(R);return C.cmpn(0)<0&&C.iadd(this.m),C},Z.prototype.shl=function(O,R){return this._verify1(O),this.imod(O.ushln(R))},Z.prototype.imul=function(O,R){return this._verify2(O,R),this.imod(O.imul(R))},Z.prototype.mul=function(O,R){return this._verify2(O,R),this.imod(O.mul(R))},Z.prototype.isqr=function(O){return this.imul(O,O.clone())},Z.prototype.sqr=function(O){return this.mul(O,O)},Z.prototype.sqrt=function(O){if(O.isZero())return O.clone();var R=this.m.andln(3);if(l(R%2==1),R===3){var C=this.m.add(new i(1)).iushrn(2);return this.pow(O,C)}for(var _=this.m.subn(1),k=0;!_.isZero()&&_.andln(1)===0;)k++,_.iushrn(1);l(!_.isZero());var A=new i(1).toRed(this),T=A.redNeg(),D=this.m.subn(1).iushrn(1),B=this.m.bitLength();for(B=new i(2*B*B).toRed(this);this.pow(B,D).cmp(T)!==0;)B.redIAdd(T);for(var F=this.pow(B,_),Y=this.pow(O,_.addn(1).iushrn(1)),X=this.pow(O,_),re=k;X.cmp(A)!==0;){for(var z=X,ee=0;z.cmp(A)!==0;ee++)z=z.redSqr();l(ee<re);var L=this.pow(F,new i(1).iushln(re-ee-1));Y=Y.redMul(L),F=L.redSqr(),X=X.redMul(F),re=ee}return Y},Z.prototype.invm=function(O){var R=O._invmp(this.m);return R.negative!==0?(R.negative=0,this.imod(R).redNeg()):this.imod(R)},Z.prototype.pow=function(O,R){if(R.isZero())return new i(1).toRed(this);if(R.cmpn(1)===0)return O.clone();var C=new Array(16);C[0]=new i(1).toRed(this),C[1]=O;for(var _=2;_<C.length;_++)C[_]=this.mul(C[_-1],O);var k=C[0],A=0,T=0,D=R.bitLength()%26;for(D===0&&(D=26),_=R.length-1;_>=0;_--){for(var B=R.words[_],F=D-1;F>=0;F--){var Y=B>>F&1;k!==C[0]&&(k=this.sqr(k)),Y!==0||A!==0?(A<<=1,A|=Y,(++T===4||_===0&&F===0)&&(k=this.mul(k,C[A]),T=0,A=0)):T=0}D=26}return k},Z.prototype.convertTo=function(O){var R=O.umod(this.m);return R===O?R.clone():R},Z.prototype.convertFrom=function(O){var R=O.clone();return R.red=null,R},i.mont=function(O){return new W(O)},c(W,Z),W.prototype.convertTo=function(O){return this.imod(O.ushln(this.shift))},W.prototype.convertFrom=function(O){var R=this.imod(O.mul(this.rinv));return R.red=null,R},W.prototype.imul=function(O,R){if(O.isZero()||R.isZero())return O.words[0]=0,O.length=1,O;var C=O.imul(R),_=C.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),k=C.isub(_).iushrn(this.shift),A=k;return k.cmp(this.m)>=0?A=k.isub(this.m):k.cmpn(0)<0&&(A=k.iadd(this.m)),A._forceRed(this)},W.prototype.mul=function(O,R){if(O.isZero()||R.isZero())return new i(0)._forceRed(this);var C=O.mul(R),_=C.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),k=C.isub(_).iushrn(this.shift),A=k;return k.cmp(this.m)>=0?A=k.isub(this.m):k.cmpn(0)<0&&(A=k.iadd(this.m)),A._forceRed(this)},W.prototype.invm=function(O){return this.imod(O._invmp(this.m).mul(this.r2))._forceRed(this)}})(a===void 0||a)},{buffer:188}],185:[function(e,a,n){n.byteLength=function(h){var v=p(h),b=v[0],g=v[1];return 3*(b+g)/4-g},n.toByteArray=function(h){var v,b,g=p(h),x=g[0],y=g[1],E=new l(function(P,V,U){return 3*(V+U)/4-U}(0,x,y)),N=0,I=y>0?x-4:x;for(b=0;b<I;b+=4)v=s[h.charCodeAt(b)]<<18|s[h.charCodeAt(b+1)]<<12|s[h.charCodeAt(b+2)]<<6|s[h.charCodeAt(b+3)],E[N++]=v>>16&255,E[N++]=v>>8&255,E[N++]=255&v;return y===2&&(v=s[h.charCodeAt(b)]<<2|s[h.charCodeAt(b+1)]>>4,E[N++]=255&v),y===1&&(v=s[h.charCodeAt(b)]<<10|s[h.charCodeAt(b+1)]<<4|s[h.charCodeAt(b+2)]>>2,E[N++]=v>>8&255,E[N++]=255&v),E},n.fromByteArray=function(h){for(var v,b=h.length,g=b%3,x=[],y=0,E=b-g;y<E;y+=16383)x.push(f(h,y,y+16383>E?E:y+16383));return g===1?(v=h[b-1],x.push(o[v>>2]+o[v<<4&63]+"==")):g===2&&(v=(h[b-2]<<8)+h[b-1],x.push(o[v>>10]+o[v>>4&63]+o[v<<2&63]+"=")),x.join("")};for(var o=[],s=[],l=typeof Uint8Array<"u"?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,u=c.length;i<u;++i)o[i]=c[i],s[c.charCodeAt(i)]=i;function p(h){var v=h.length;if(v%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var b=h.indexOf("=");return b===-1&&(b=v),[b,b===v?0:4-b%4]}function f(h,v,b){for(var g,x,y=[],E=v;E<b;E+=3)g=(h[E]<<16&16711680)+(h[E+1]<<8&65280)+(255&h[E+2]),y.push(o[(x=g)>>18&63]+o[x>>12&63]+o[x>>6&63]+o[63&x]);return y.join("")}s[45]=62,s[95]=63},{}],186:[function(e,a,n){(function(o,s){function l(C,_){if(!C)throw new Error(_||"Assertion failed")}function c(C,_){C.super_=_;var k=function(){};k.prototype=_.prototype,C.prototype=new k,C.prototype.constructor=C}function i(C,_,k){if(i.isBN(C))return C;this.negative=0,this.words=null,this.length=0,this.red=null,C!==null&&(_!=="le"&&_!=="be"||(k=_,_=10),this._init(C||0,_||10,k||"be"))}var u;typeof o=="object"?o.exports=i:(void 0).BN=i,i.BN=i,i.wordSize=26;try{u=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:e("buffer").Buffer}catch{}function p(C,_){var k=C.charCodeAt(_);return k>=48&&k<=57?k-48:k>=65&&k<=70?k-55:k>=97&&k<=102?k-87:void l(!1,"Invalid character in "+C)}function f(C,_,k){var A=p(C,k);return k-1>=_&&(A|=p(C,k-1)<<4),A}function h(C,_,k,A){for(var T=0,D=0,B=Math.min(C.length,k),F=_;F<B;F++){var Y=C.charCodeAt(F)-48;T*=A,D=Y>=49?Y-49+10:Y>=17?Y-17+10:Y,l(Y>=0&&D<A,"Invalid character"),T+=D}return T}function v(C,_){C.words=_.words,C.length=_.length,C.negative=_.negative,C.red=_.red}if(i.isBN=function(C){return C instanceof i||C!==null&&typeof C=="object"&&C.constructor.wordSize===i.wordSize&&Array.isArray(C.words)},i.max=function(C,_){return C.cmp(_)>0?C:_},i.min=function(C,_){return C.cmp(_)<0?C:_},i.prototype._init=function(C,_,k){if(typeof C=="number")return this._initNumber(C,_,k);if(typeof C=="object")return this._initArray(C,_,k);_==="hex"&&(_=16),l(_===(0|_)&&_>=2&&_<=36);var A=0;(C=C.toString().replace(/\s+/g,""))[0]==="-"&&(A++,this.negative=1),A<C.length&&(_===16?this._parseHex(C,A,k):(this._parseBase(C,_,A),k==="le"&&this._initArray(this.toArray(),_,k)))},i.prototype._initNumber=function(C,_,k){C<0&&(this.negative=1,C=-C),C<67108864?(this.words=[67108863&C],this.length=1):C<4503599627370496?(this.words=[67108863&C,C/67108864&67108863],this.length=2):(l(C<9007199254740992),this.words=[67108863&C,C/67108864&67108863,1],this.length=3),k==="le"&&this._initArray(this.toArray(),_,k)},i.prototype._initArray=function(C,_,k){if(l(typeof C.length=="number"),C.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(C.length/3),this.words=new Array(this.length);for(var A=0;A<this.length;A++)this.words[A]=0;var T,D,B=0;if(k==="be")for(A=C.length-1,T=0;A>=0;A-=3)D=C[A]|C[A-1]<<8|C[A-2]<<16,this.words[T]|=D<<B&67108863,this.words[T+1]=D>>>26-B&67108863,(B+=24)>=26&&(B-=26,T++);else if(k==="le")for(A=0,T=0;A<C.length;A+=3)D=C[A]|C[A+1]<<8|C[A+2]<<16,this.words[T]|=D<<B&67108863,this.words[T+1]=D>>>26-B&67108863,(B+=24)>=26&&(B-=26,T++);return this._strip()},i.prototype._parseHex=function(C,_,k){this.length=Math.ceil((C.length-_)/6),this.words=new Array(this.length);for(var A=0;A<this.length;A++)this.words[A]=0;var T,D=0,B=0;if(k==="be")for(A=C.length-1;A>=_;A-=2)T=f(C,_,A)<<D,this.words[B]|=67108863&T,D>=18?(D-=18,B+=1,this.words[B]|=T>>>26):D+=8;else for(A=(C.length-_)%2==0?_+1:_;A<C.length;A+=2)T=f(C,_,A)<<D,this.words[B]|=67108863&T,D>=18?(D-=18,B+=1,this.words[B]|=T>>>26):D+=8;this._strip()},i.prototype._parseBase=function(C,_,k){this.words=[0],this.length=1;for(var A=0,T=1;T<=67108863;T*=_)A++;A--,T=T/_|0;for(var D=C.length-k,B=D%A,F=Math.min(D,D-B)+k,Y=0,X=k;X<F;X+=A)Y=h(C,X,X+A,_),this.imuln(T),this.words[0]+Y<67108864?this.words[0]+=Y:this._iaddn(Y);if(B!==0){var re=1;for(Y=h(C,X,C.length,_),X=0;X<B;X++)re*=_;this.imuln(re),this.words[0]+Y<67108864?this.words[0]+=Y:this._iaddn(Y)}this._strip()},i.prototype.copy=function(C){C.words=new Array(this.length);for(var _=0;_<this.length;_++)C.words[_]=this.words[_];C.length=this.length,C.negative=this.negative,C.red=this.red},i.prototype._move=function(C){v(C,this)},i.prototype.clone=function(){var C=new i(null);return this.copy(C),C},i.prototype._expand=function(C){for(;this.length<C;)this.words[this.length++]=0;return this},i.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{i.prototype[Symbol.for("nodejs.util.inspect.custom")]=b}catch{i.prototype.inspect=b}else i.prototype.inspect=b;function b(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var g=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],x=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(C,_){var k;if(_=0|_||1,(C=C||10)===16||C==="hex"){k="";for(var A=0,T=0,D=0;D<this.length;D++){var B=this.words[D],F=(16777215&(B<<A|T)).toString(16);T=B>>>24-A&16777215,(A+=2)>=26&&(A-=26,D--),k=T!==0||D!==this.length-1?g[6-F.length]+F+k:F+k}for(T!==0&&(k=T.toString(16)+k);k.length%_!=0;)k="0"+k;return this.negative!==0&&(k="-"+k),k}if(C===(0|C)&&C>=2&&C<=36){var Y=x[C],X=y[C];k="";var re=this.clone();for(re.negative=0;!re.isZero();){var z=re.modrn(X).toString(C);k=(re=re.idivn(X)).isZero()?z+k:g[Y-z.length]+z+k}for(this.isZero()&&(k="0"+k);k.length%_!=0;)k="0"+k;return this.negative!==0&&(k="-"+k),k}l(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var C=this.words[0];return this.length===2?C+=67108864*this.words[1]:this.length===3&&this.words[2]===1?C+=4503599627370496+67108864*this.words[1]:this.length>2&&l(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-C:C},i.prototype.toJSON=function(){return this.toString(16,2)},u&&(i.prototype.toBuffer=function(C,_){return this.toArrayLike(u,C,_)}),i.prototype.toArray=function(C,_){return this.toArrayLike(Array,C,_)};function E(C,_,k){k.negative=_.negative^C.negative;var A=C.length+_.length|0;k.length=A,A=A-1|0;var T=0|C.words[0],D=0|_.words[0],B=T*D,F=67108863&B,Y=B/67108864|0;k.words[0]=F;for(var X=1;X<A;X++){for(var re=Y>>>26,z=67108863&Y,ee=Math.min(X,_.length-1),L=Math.max(0,X-C.length+1);L<=ee;L++){var M=X-L|0;re+=(B=(T=0|C.words[M])*(D=0|_.words[L])+z)/67108864|0,z=67108863&B}k.words[X]=0|z,Y=0|re}return Y!==0?k.words[X]=0|Y:k.length--,k._strip()}i.prototype.toArrayLike=function(C,_,k){this._strip();var A=this.byteLength(),T=k||Math.max(1,A);l(A<=T,"byte array longer than desired length"),l(T>0,"Requested array length <= 0");var D=function(B,F){return B.allocUnsafe?B.allocUnsafe(F):new B(F)}(C,T);return this["_toArrayLike"+(_==="le"?"LE":"BE")](D,A),D},i.prototype._toArrayLikeLE=function(C,_){for(var k=0,A=0,T=0,D=0;T<this.length;T++){var B=this.words[T]<<D|A;C[k++]=255&B,k<C.length&&(C[k++]=B>>8&255),k<C.length&&(C[k++]=B>>16&255),D===6?(k<C.length&&(C[k++]=B>>24&255),A=0,D=0):(A=B>>>24,D+=2)}if(k<C.length)for(C[k++]=A;k<C.length;)C[k++]=0},i.prototype._toArrayLikeBE=function(C,_){for(var k=C.length-1,A=0,T=0,D=0;T<this.length;T++){var B=this.words[T]<<D|A;C[k--]=255&B,k>=0&&(C[k--]=B>>8&255),k>=0&&(C[k--]=B>>16&255),D===6?(k>=0&&(C[k--]=B>>24&255),A=0,D=0):(A=B>>>24,D+=2)}if(k>=0)for(C[k--]=A;k>=0;)C[k--]=0},Math.clz32?i.prototype._countBits=function(C){return 32-Math.clz32(C)}:i.prototype._countBits=function(C){var _=C,k=0;return _>=4096&&(k+=13,_>>>=13),_>=64&&(k+=7,_>>>=7),_>=8&&(k+=4,_>>>=4),_>=2&&(k+=2,_>>>=2),k+_},i.prototype._zeroBits=function(C){if(C===0)return 26;var _=C,k=0;return(8191&_)==0&&(k+=13,_>>>=13),(127&_)==0&&(k+=7,_>>>=7),(15&_)==0&&(k+=4,_>>>=4),(3&_)==0&&(k+=2,_>>>=2),(1&_)==0&&k++,k},i.prototype.bitLength=function(){var C=this.words[this.length-1],_=this._countBits(C);return 26*(this.length-1)+_},i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var C=0,_=0;_<this.length;_++){var k=this._zeroBits(this.words[_]);if(C+=k,k!==26)break}return C},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(C){return this.negative!==0?this.abs().inotn(C).iaddn(1):this.clone()},i.prototype.fromTwos=function(C){return this.testn(C-1)?this.notn(C).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(C){for(;this.length<C.length;)this.words[this.length++]=0;for(var _=0;_<C.length;_++)this.words[_]=this.words[_]|C.words[_];return this._strip()},i.prototype.ior=function(C){return l((this.negative|C.negative)==0),this.iuor(C)},i.prototype.or=function(C){return this.length>C.length?this.clone().ior(C):C.clone().ior(this)},i.prototype.uor=function(C){return this.length>C.length?this.clone().iuor(C):C.clone().iuor(this)},i.prototype.iuand=function(C){var _;_=this.length>C.length?C:this;for(var k=0;k<_.length;k++)this.words[k]=this.words[k]&C.words[k];return this.length=_.length,this._strip()},i.prototype.iand=function(C){return l((this.negative|C.negative)==0),this.iuand(C)},i.prototype.and=function(C){return this.length>C.length?this.clone().iand(C):C.clone().iand(this)},i.prototype.uand=function(C){return this.length>C.length?this.clone().iuand(C):C.clone().iuand(this)},i.prototype.iuxor=function(C){var _,k;this.length>C.length?(_=this,k=C):(_=C,k=this);for(var A=0;A<k.length;A++)this.words[A]=_.words[A]^k.words[A];if(this!==_)for(;A<_.length;A++)this.words[A]=_.words[A];return this.length=_.length,this._strip()},i.prototype.ixor=function(C){return l((this.negative|C.negative)==0),this.iuxor(C)},i.prototype.xor=function(C){return this.length>C.length?this.clone().ixor(C):C.clone().ixor(this)},i.prototype.uxor=function(C){return this.length>C.length?this.clone().iuxor(C):C.clone().iuxor(this)},i.prototype.inotn=function(C){l(typeof C=="number"&&C>=0);var _=0|Math.ceil(C/26),k=C%26;this._expand(_),k>0&&_--;for(var A=0;A<_;A++)this.words[A]=67108863&~this.words[A];return k>0&&(this.words[A]=~this.words[A]&67108863>>26-k),this._strip()},i.prototype.notn=function(C){return this.clone().inotn(C)},i.prototype.setn=function(C,_){l(typeof C=="number"&&C>=0);var k=C/26|0,A=C%26;return this._expand(k+1),this.words[k]=_?this.words[k]|1<<A:this.words[k]&~(1<<A),this._strip()},i.prototype.iadd=function(C){var _,k,A;if(this.negative!==0&&C.negative===0)return this.negative=0,_=this.isub(C),this.negative^=1,this._normSign();if(this.negative===0&&C.negative!==0)return C.negative=0,_=this.isub(C),C.negative=1,_._normSign();this.length>C.length?(k=this,A=C):(k=C,A=this);for(var T=0,D=0;D<A.length;D++)_=(0|k.words[D])+(0|A.words[D])+T,this.words[D]=67108863&_,T=_>>>26;for(;T!==0&&D<k.length;D++)_=(0|k.words[D])+T,this.words[D]=67108863&_,T=_>>>26;if(this.length=k.length,T!==0)this.words[this.length]=T,this.length++;else if(k!==this)for(;D<k.length;D++)this.words[D]=k.words[D];return this},i.prototype.add=function(C){var _;return C.negative!==0&&this.negative===0?(C.negative=0,_=this.sub(C),C.negative^=1,_):C.negative===0&&this.negative!==0?(this.negative=0,_=C.sub(this),this.negative=1,_):this.length>C.length?this.clone().iadd(C):C.clone().iadd(this)},i.prototype.isub=function(C){if(C.negative!==0){C.negative=0;var _=this.iadd(C);return C.negative=1,_._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(C),this.negative=1,this._normSign();var k,A,T=this.cmp(C);if(T===0)return this.negative=0,this.length=1,this.words[0]=0,this;T>0?(k=this,A=C):(k=C,A=this);for(var D=0,B=0;B<A.length;B++)D=(_=(0|k.words[B])-(0|A.words[B])+D)>>26,this.words[B]=67108863&_;for(;D!==0&&B<k.length;B++)D=(_=(0|k.words[B])+D)>>26,this.words[B]=67108863&_;if(D===0&&B<k.length&&k!==this)for(;B<k.length;B++)this.words[B]=k.words[B];return this.length=Math.max(this.length,B),k!==this&&(this.negative=1),this._strip()},i.prototype.sub=function(C){return this.clone().isub(C)};var N=function(C,_,k){var A,T,D,B=C.words,F=_.words,Y=k.words,X=0,re=0|B[0],z=8191&re,ee=re>>>13,L=0|B[1],M=8191&L,K=L>>>13,se=0|B[2],te=8191&se,ae=se>>>13,Q=0|B[3],fe=8191&Q,le=Q>>>13,ne=0|B[4],ue=8191&ne,he=ne>>>13,ke=0|B[5],pe=8191&ke,Ce=ke>>>13,Me=0|B[6],Ie=8191&Me,Ye=Me>>>13,at=0|B[7],rt=8191&at,it=at>>>13,et=0|B[8],st=8191&et,je=et>>>13,ht=0|B[9],Je=8191&ht,nt=ht>>>13,ct=0|F[0],_t=8191&ct,mt=ct>>>13,gt=0|F[1],He=8191&gt,Ue=gt>>>13,bt=0|F[2],tt=8191&bt,dt=bt>>>13,ut=0|F[3],vt=8191&ut,xt=ut>>>13,At=0|F[4],Kt=8191&At,yt=At>>>13,Ct=0|F[5],Ft=8191&Ct,kt=Ct>>>13,Ae=0|F[6],Fe=8191&Ae,Qe=Ae>>>13,ie=0|F[7],_e=8191&ie,de=ie>>>13,ve=0|F[8],be=8191&ve,we=ve>>>13,De=0|F[9],Le=8191&De,Oe=De>>>13;k.negative=C.negative^_.negative,k.length=19;var Pe=(X+(A=Math.imul(z,_t))|0)+((8191&(T=(T=Math.imul(z,mt))+Math.imul(ee,_t)|0))<<13)|0;X=((D=Math.imul(ee,mt))+(T>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,A=Math.imul(M,_t),T=(T=Math.imul(M,mt))+Math.imul(K,_t)|0,D=Math.imul(K,mt);var Be=(X+(A=A+Math.imul(z,He)|0)|0)+((8191&(T=(T=T+Math.imul(z,Ue)|0)+Math.imul(ee,He)|0))<<13)|0;X=((D=D+Math.imul(ee,Ue)|0)+(T>>>13)|0)+(Be>>>26)|0,Be&=67108863,A=Math.imul(te,_t),T=(T=Math.imul(te,mt))+Math.imul(ae,_t)|0,D=Math.imul(ae,mt),A=A+Math.imul(M,He)|0,T=(T=T+Math.imul(M,Ue)|0)+Math.imul(K,He)|0,D=D+Math.imul(K,Ue)|0;var xe=(X+(A=A+Math.imul(z,tt)|0)|0)+((8191&(T=(T=T+Math.imul(z,dt)|0)+Math.imul(ee,tt)|0))<<13)|0;X=((D=D+Math.imul(ee,dt)|0)+(T>>>13)|0)+(xe>>>26)|0,xe&=67108863,A=Math.imul(fe,_t),T=(T=Math.imul(fe,mt))+Math.imul(le,_t)|0,D=Math.imul(le,mt),A=A+Math.imul(te,He)|0,T=(T=T+Math.imul(te,Ue)|0)+Math.imul(ae,He)|0,D=D+Math.imul(ae,Ue)|0,A=A+Math.imul(M,tt)|0,T=(T=T+Math.imul(M,dt)|0)+Math.imul(K,tt)|0,D=D+Math.imul(K,dt)|0;var Ee=(X+(A=A+Math.imul(z,vt)|0)|0)+((8191&(T=(T=T+Math.imul(z,xt)|0)+Math.imul(ee,vt)|0))<<13)|0;X=((D=D+Math.imul(ee,xt)|0)+(T>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,A=Math.imul(ue,_t),T=(T=Math.imul(ue,mt))+Math.imul(he,_t)|0,D=Math.imul(he,mt),A=A+Math.imul(fe,He)|0,T=(T=T+Math.imul(fe,Ue)|0)+Math.imul(le,He)|0,D=D+Math.imul(le,Ue)|0,A=A+Math.imul(te,tt)|0,T=(T=T+Math.imul(te,dt)|0)+Math.imul(ae,tt)|0,D=D+Math.imul(ae,dt)|0,A=A+Math.imul(M,vt)|0,T=(T=T+Math.imul(M,xt)|0)+Math.imul(K,vt)|0,D=D+Math.imul(K,xt)|0;var qe=(X+(A=A+Math.imul(z,Kt)|0)|0)+((8191&(T=(T=T+Math.imul(z,yt)|0)+Math.imul(ee,Kt)|0))<<13)|0;X=((D=D+Math.imul(ee,yt)|0)+(T>>>13)|0)+(qe>>>26)|0,qe&=67108863,A=Math.imul(pe,_t),T=(T=Math.imul(pe,mt))+Math.imul(Ce,_t)|0,D=Math.imul(Ce,mt),A=A+Math.imul(ue,He)|0,T=(T=T+Math.imul(ue,Ue)|0)+Math.imul(he,He)|0,D=D+Math.imul(he,Ue)|0,A=A+Math.imul(fe,tt)|0,T=(T=T+Math.imul(fe,dt)|0)+Math.imul(le,tt)|0,D=D+Math.imul(le,dt)|0,A=A+Math.imul(te,vt)|0,T=(T=T+Math.imul(te,xt)|0)+Math.imul(ae,vt)|0,D=D+Math.imul(ae,xt)|0,A=A+Math.imul(M,Kt)|0,T=(T=T+Math.imul(M,yt)|0)+Math.imul(K,Kt)|0,D=D+Math.imul(K,yt)|0;var ce=(X+(A=A+Math.imul(z,Ft)|0)|0)+((8191&(T=(T=T+Math.imul(z,kt)|0)+Math.imul(ee,Ft)|0))<<13)|0;X=((D=D+Math.imul(ee,kt)|0)+(T>>>13)|0)+(ce>>>26)|0,ce&=67108863,A=Math.imul(Ie,_t),T=(T=Math.imul(Ie,mt))+Math.imul(Ye,_t)|0,D=Math.imul(Ye,mt),A=A+Math.imul(pe,He)|0,T=(T=T+Math.imul(pe,Ue)|0)+Math.imul(Ce,He)|0,D=D+Math.imul(Ce,Ue)|0,A=A+Math.imul(ue,tt)|0,T=(T=T+Math.imul(ue,dt)|0)+Math.imul(he,tt)|0,D=D+Math.imul(he,dt)|0,A=A+Math.imul(fe,vt)|0,T=(T=T+Math.imul(fe,xt)|0)+Math.imul(le,vt)|0,D=D+Math.imul(le,xt)|0,A=A+Math.imul(te,Kt)|0,T=(T=T+Math.imul(te,yt)|0)+Math.imul(ae,Kt)|0,D=D+Math.imul(ae,yt)|0,A=A+Math.imul(M,Ft)|0,T=(T=T+Math.imul(M,kt)|0)+Math.imul(K,Ft)|0,D=D+Math.imul(K,kt)|0;var Te=(X+(A=A+Math.imul(z,Fe)|0)|0)+((8191&(T=(T=T+Math.imul(z,Qe)|0)+Math.imul(ee,Fe)|0))<<13)|0;X=((D=D+Math.imul(ee,Qe)|0)+(T>>>13)|0)+(Te>>>26)|0,Te&=67108863,A=Math.imul(rt,_t),T=(T=Math.imul(rt,mt))+Math.imul(it,_t)|0,D=Math.imul(it,mt),A=A+Math.imul(Ie,He)|0,T=(T=T+Math.imul(Ie,Ue)|0)+Math.imul(Ye,He)|0,D=D+Math.imul(Ye,Ue)|0,A=A+Math.imul(pe,tt)|0,T=(T=T+Math.imul(pe,dt)|0)+Math.imul(Ce,tt)|0,D=D+Math.imul(Ce,dt)|0,A=A+Math.imul(ue,vt)|0,T=(T=T+Math.imul(ue,xt)|0)+Math.imul(he,vt)|0,D=D+Math.imul(he,xt)|0,A=A+Math.imul(fe,Kt)|0,T=(T=T+Math.imul(fe,yt)|0)+Math.imul(le,Kt)|0,D=D+Math.imul(le,yt)|0,A=A+Math.imul(te,Ft)|0,T=(T=T+Math.imul(te,kt)|0)+Math.imul(ae,Ft)|0,D=D+Math.imul(ae,kt)|0,A=A+Math.imul(M,Fe)|0,T=(T=T+Math.imul(M,Qe)|0)+Math.imul(K,Fe)|0,D=D+Math.imul(K,Qe)|0;var me=(X+(A=A+Math.imul(z,_e)|0)|0)+((8191&(T=(T=T+Math.imul(z,de)|0)+Math.imul(ee,_e)|0))<<13)|0;X=((D=D+Math.imul(ee,de)|0)+(T>>>13)|0)+(me>>>26)|0,me&=67108863,A=Math.imul(st,_t),T=(T=Math.imul(st,mt))+Math.imul(je,_t)|0,D=Math.imul(je,mt),A=A+Math.imul(rt,He)|0,T=(T=T+Math.imul(rt,Ue)|0)+Math.imul(it,He)|0,D=D+Math.imul(it,Ue)|0,A=A+Math.imul(Ie,tt)|0,T=(T=T+Math.imul(Ie,dt)|0)+Math.imul(Ye,tt)|0,D=D+Math.imul(Ye,dt)|0,A=A+Math.imul(pe,vt)|0,T=(T=T+Math.imul(pe,xt)|0)+Math.imul(Ce,vt)|0,D=D+Math.imul(Ce,xt)|0,A=A+Math.imul(ue,Kt)|0,T=(T=T+Math.imul(ue,yt)|0)+Math.imul(he,Kt)|0,D=D+Math.imul(he,yt)|0,A=A+Math.imul(fe,Ft)|0,T=(T=T+Math.imul(fe,kt)|0)+Math.imul(le,Ft)|0,D=D+Math.imul(le,kt)|0,A=A+Math.imul(te,Fe)|0,T=(T=T+Math.imul(te,Qe)|0)+Math.imul(ae,Fe)|0,D=D+Math.imul(ae,Qe)|0,A=A+Math.imul(M,_e)|0,T=(T=T+Math.imul(M,de)|0)+Math.imul(K,_e)|0,D=D+Math.imul(K,de)|0;var ye=(X+(A=A+Math.imul(z,be)|0)|0)+((8191&(T=(T=T+Math.imul(z,we)|0)+Math.imul(ee,be)|0))<<13)|0;X=((D=D+Math.imul(ee,we)|0)+(T>>>13)|0)+(ye>>>26)|0,ye&=67108863,A=Math.imul(Je,_t),T=(T=Math.imul(Je,mt))+Math.imul(nt,_t)|0,D=Math.imul(nt,mt),A=A+Math.imul(st,He)|0,T=(T=T+Math.imul(st,Ue)|0)+Math.imul(je,He)|0,D=D+Math.imul(je,Ue)|0,A=A+Math.imul(rt,tt)|0,T=(T=T+Math.imul(rt,dt)|0)+Math.imul(it,tt)|0,D=D+Math.imul(it,dt)|0,A=A+Math.imul(Ie,vt)|0,T=(T=T+Math.imul(Ie,xt)|0)+Math.imul(Ye,vt)|0,D=D+Math.imul(Ye,xt)|0,A=A+Math.imul(pe,Kt)|0,T=(T=T+Math.imul(pe,yt)|0)+Math.imul(Ce,Kt)|0,D=D+Math.imul(Ce,yt)|0,A=A+Math.imul(ue,Ft)|0,T=(T=T+Math.imul(ue,kt)|0)+Math.imul(he,Ft)|0,D=D+Math.imul(he,kt)|0,A=A+Math.imul(fe,Fe)|0,T=(T=T+Math.imul(fe,Qe)|0)+Math.imul(le,Fe)|0,D=D+Math.imul(le,Qe)|0,A=A+Math.imul(te,_e)|0,T=(T=T+Math.imul(te,de)|0)+Math.imul(ae,_e)|0,D=D+Math.imul(ae,de)|0,A=A+Math.imul(M,be)|0,T=(T=T+Math.imul(M,we)|0)+Math.imul(K,be)|0,D=D+Math.imul(K,we)|0;var Ve=(X+(A=A+Math.imul(z,Le)|0)|0)+((8191&(T=(T=T+Math.imul(z,Oe)|0)+Math.imul(ee,Le)|0))<<13)|0;X=((D=D+Math.imul(ee,Oe)|0)+(T>>>13)|0)+(Ve>>>26)|0,Ve&=67108863,A=Math.imul(Je,He),T=(T=Math.imul(Je,Ue))+Math.imul(nt,He)|0,D=Math.imul(nt,Ue),A=A+Math.imul(st,tt)|0,T=(T=T+Math.imul(st,dt)|0)+Math.imul(je,tt)|0,D=D+Math.imul(je,dt)|0,A=A+Math.imul(rt,vt)|0,T=(T=T+Math.imul(rt,xt)|0)+Math.imul(it,vt)|0,D=D+Math.imul(it,xt)|0,A=A+Math.imul(Ie,Kt)|0,T=(T=T+Math.imul(Ie,yt)|0)+Math.imul(Ye,Kt)|0,D=D+Math.imul(Ye,yt)|0,A=A+Math.imul(pe,Ft)|0,T=(T=T+Math.imul(pe,kt)|0)+Math.imul(Ce,Ft)|0,D=D+Math.imul(Ce,kt)|0,A=A+Math.imul(ue,Fe)|0,T=(T=T+Math.imul(ue,Qe)|0)+Math.imul(he,Fe)|0,D=D+Math.imul(he,Qe)|0,A=A+Math.imul(fe,_e)|0,T=(T=T+Math.imul(fe,de)|0)+Math.imul(le,_e)|0,D=D+Math.imul(le,de)|0,A=A+Math.imul(te,be)|0,T=(T=T+Math.imul(te,we)|0)+Math.imul(ae,be)|0,D=D+Math.imul(ae,we)|0;var $e=(X+(A=A+Math.imul(M,Le)|0)|0)+((8191&(T=(T=T+Math.imul(M,Oe)|0)+Math.imul(K,Le)|0))<<13)|0;X=((D=D+Math.imul(K,Oe)|0)+(T>>>13)|0)+($e>>>26)|0,$e&=67108863,A=Math.imul(Je,tt),T=(T=Math.imul(Je,dt))+Math.imul(nt,tt)|0,D=Math.imul(nt,dt),A=A+Math.imul(st,vt)|0,T=(T=T+Math.imul(st,xt)|0)+Math.imul(je,vt)|0,D=D+Math.imul(je,xt)|0,A=A+Math.imul(rt,Kt)|0,T=(T=T+Math.imul(rt,yt)|0)+Math.imul(it,Kt)|0,D=D+Math.imul(it,yt)|0,A=A+Math.imul(Ie,Ft)|0,T=(T=T+Math.imul(Ie,kt)|0)+Math.imul(Ye,Ft)|0,D=D+Math.imul(Ye,kt)|0,A=A+Math.imul(pe,Fe)|0,T=(T=T+Math.imul(pe,Qe)|0)+Math.imul(Ce,Fe)|0,D=D+Math.imul(Ce,Qe)|0,A=A+Math.imul(ue,_e)|0,T=(T=T+Math.imul(ue,de)|0)+Math.imul(he,_e)|0,D=D+Math.imul(he,de)|0,A=A+Math.imul(fe,be)|0,T=(T=T+Math.imul(fe,we)|0)+Math.imul(le,be)|0,D=D+Math.imul(le,we)|0;var ot=(X+(A=A+Math.imul(te,Le)|0)|0)+((8191&(T=(T=T+Math.imul(te,Oe)|0)+Math.imul(ae,Le)|0))<<13)|0;X=((D=D+Math.imul(ae,Oe)|0)+(T>>>13)|0)+(ot>>>26)|0,ot&=67108863,A=Math.imul(Je,vt),T=(T=Math.imul(Je,xt))+Math.imul(nt,vt)|0,D=Math.imul(nt,xt),A=A+Math.imul(st,Kt)|0,T=(T=T+Math.imul(st,yt)|0)+Math.imul(je,Kt)|0,D=D+Math.imul(je,yt)|0,A=A+Math.imul(rt,Ft)|0,T=(T=T+Math.imul(rt,kt)|0)+Math.imul(it,Ft)|0,D=D+Math.imul(it,kt)|0,A=A+Math.imul(Ie,Fe)|0,T=(T=T+Math.imul(Ie,Qe)|0)+Math.imul(Ye,Fe)|0,D=D+Math.imul(Ye,Qe)|0,A=A+Math.imul(pe,_e)|0,T=(T=T+Math.imul(pe,de)|0)+Math.imul(Ce,_e)|0,D=D+Math.imul(Ce,de)|0,A=A+Math.imul(ue,be)|0,T=(T=T+Math.imul(ue,we)|0)+Math.imul(he,be)|0,D=D+Math.imul(he,we)|0;var Rt=(X+(A=A+Math.imul(fe,Le)|0)|0)+((8191&(T=(T=T+Math.imul(fe,Oe)|0)+Math.imul(le,Le)|0))<<13)|0;X=((D=D+Math.imul(le,Oe)|0)+(T>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,A=Math.imul(Je,Kt),T=(T=Math.imul(Je,yt))+Math.imul(nt,Kt)|0,D=Math.imul(nt,yt),A=A+Math.imul(st,Ft)|0,T=(T=T+Math.imul(st,kt)|0)+Math.imul(je,Ft)|0,D=D+Math.imul(je,kt)|0,A=A+Math.imul(rt,Fe)|0,T=(T=T+Math.imul(rt,Qe)|0)+Math.imul(it,Fe)|0,D=D+Math.imul(it,Qe)|0,A=A+Math.imul(Ie,_e)|0,T=(T=T+Math.imul(Ie,de)|0)+Math.imul(Ye,_e)|0,D=D+Math.imul(Ye,de)|0,A=A+Math.imul(pe,be)|0,T=(T=T+Math.imul(pe,we)|0)+Math.imul(Ce,be)|0,D=D+Math.imul(Ce,we)|0;var Bt=(X+(A=A+Math.imul(ue,Le)|0)|0)+((8191&(T=(T=T+Math.imul(ue,Oe)|0)+Math.imul(he,Le)|0))<<13)|0;X=((D=D+Math.imul(he,Oe)|0)+(T>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,A=Math.imul(Je,Ft),T=(T=Math.imul(Je,kt))+Math.imul(nt,Ft)|0,D=Math.imul(nt,kt),A=A+Math.imul(st,Fe)|0,T=(T=T+Math.imul(st,Qe)|0)+Math.imul(je,Fe)|0,D=D+Math.imul(je,Qe)|0,A=A+Math.imul(rt,_e)|0,T=(T=T+Math.imul(rt,de)|0)+Math.imul(it,_e)|0,D=D+Math.imul(it,de)|0,A=A+Math.imul(Ie,be)|0,T=(T=T+Math.imul(Ie,we)|0)+Math.imul(Ye,be)|0,D=D+Math.imul(Ye,we)|0;var Vt=(X+(A=A+Math.imul(pe,Le)|0)|0)+((8191&(T=(T=T+Math.imul(pe,Oe)|0)+Math.imul(Ce,Le)|0))<<13)|0;X=((D=D+Math.imul(Ce,Oe)|0)+(T>>>13)|0)+(Vt>>>26)|0,Vt&=67108863,A=Math.imul(Je,Fe),T=(T=Math.imul(Je,Qe))+Math.imul(nt,Fe)|0,D=Math.imul(nt,Qe),A=A+Math.imul(st,_e)|0,T=(T=T+Math.imul(st,de)|0)+Math.imul(je,_e)|0,D=D+Math.imul(je,de)|0,A=A+Math.imul(rt,be)|0,T=(T=T+Math.imul(rt,we)|0)+Math.imul(it,be)|0,D=D+Math.imul(it,we)|0;var Lt=(X+(A=A+Math.imul(Ie,Le)|0)|0)+((8191&(T=(T=T+Math.imul(Ie,Oe)|0)+Math.imul(Ye,Le)|0))<<13)|0;X=((D=D+Math.imul(Ye,Oe)|0)+(T>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,A=Math.imul(Je,_e),T=(T=Math.imul(Je,de))+Math.imul(nt,_e)|0,D=Math.imul(nt,de),A=A+Math.imul(st,be)|0,T=(T=T+Math.imul(st,we)|0)+Math.imul(je,be)|0,D=D+Math.imul(je,we)|0;var er=(X+(A=A+Math.imul(rt,Le)|0)|0)+((8191&(T=(T=T+Math.imul(rt,Oe)|0)+Math.imul(it,Le)|0))<<13)|0;X=((D=D+Math.imul(it,Oe)|0)+(T>>>13)|0)+(er>>>26)|0,er&=67108863,A=Math.imul(Je,be),T=(T=Math.imul(Je,we))+Math.imul(nt,be)|0,D=Math.imul(nt,we);var gr=(X+(A=A+Math.imul(st,Le)|0)|0)+((8191&(T=(T=T+Math.imul(st,Oe)|0)+Math.imul(je,Le)|0))<<13)|0;X=((D=D+Math.imul(je,Oe)|0)+(T>>>13)|0)+(gr>>>26)|0,gr&=67108863;var tr=(X+(A=Math.imul(Je,Le))|0)+((8191&(T=(T=Math.imul(Je,Oe))+Math.imul(nt,Le)|0))<<13)|0;return X=((D=Math.imul(nt,Oe))+(T>>>13)|0)+(tr>>>26)|0,tr&=67108863,Y[0]=Pe,Y[1]=Be,Y[2]=xe,Y[3]=Ee,Y[4]=qe,Y[5]=ce,Y[6]=Te,Y[7]=me,Y[8]=ye,Y[9]=Ve,Y[10]=$e,Y[11]=ot,Y[12]=Rt,Y[13]=Bt,Y[14]=Vt,Y[15]=Lt,Y[16]=er,Y[17]=gr,Y[18]=tr,X!==0&&(Y[19]=X,k.length++),k};function I(C,_,k){k.negative=_.negative^C.negative,k.length=C.length+_.length;for(var A=0,T=0,D=0;D<k.length-1;D++){var B=T;T=0;for(var F=67108863&A,Y=Math.min(D,_.length-1),X=Math.max(0,D-C.length+1);X<=Y;X++){var re=D-X,z=(0|C.words[re])*(0|_.words[X]),ee=67108863&z;F=67108863&(ee=ee+F|0),T+=(B=(B=B+(z/67108864|0)|0)+(ee>>>26)|0)>>>26,B&=67108863}k.words[D]=F,A=B,B=T}return A!==0?k.words[D]=A:k.length--,k._strip()}function P(C,_,k){return I(C,_,k)}Math.imul||(N=E),i.prototype.mulTo=function(C,_){var k=this.length+C.length;return this.length===10&&C.length===10?N(this,C,_):k<63?E(this,C,_):k<1024?I(this,C,_):P(this,C,_)},i.prototype.mul=function(C){var _=new i(null);return _.words=new Array(this.length+C.length),this.mulTo(C,_)},i.prototype.mulf=function(C){var _=new i(null);return _.words=new Array(this.length+C.length),P(this,C,_)},i.prototype.imul=function(C){return this.clone().mulTo(C,this)},i.prototype.imuln=function(C){var _=C<0;_&&(C=-C),l(typeof C=="number"),l(C<67108864);for(var k=0,A=0;A<this.length;A++){var T=(0|this.words[A])*C,D=(67108863&T)+(67108863&k);k>>=26,k+=T/67108864|0,k+=D>>>26,this.words[A]=67108863&D}return k!==0&&(this.words[A]=k,this.length++),_?this.ineg():this},i.prototype.muln=function(C){return this.clone().imuln(C)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(C){var _=function(D){for(var B=new Array(D.bitLength()),F=0;F<B.length;F++){var Y=F/26|0,X=F%26;B[F]=D.words[Y]>>>X&1}return B}(C);if(_.length===0)return new i(1);for(var k=this,A=0;A<_.length&&_[A]===0;A++,k=k.sqr());if(++A<_.length)for(var T=k.sqr();A<_.length;A++,T=T.sqr())_[A]!==0&&(k=k.mul(T));return k},i.prototype.iushln=function(C){l(typeof C=="number"&&C>=0);var _,k=C%26,A=(C-k)/26,T=67108863>>>26-k<<26-k;if(k!==0){var D=0;for(_=0;_<this.length;_++){var B=this.words[_]&T,F=(0|this.words[_])-B<<k;this.words[_]=F|D,D=B>>>26-k}D&&(this.words[_]=D,this.length++)}if(A!==0){for(_=this.length-1;_>=0;_--)this.words[_+A]=this.words[_];for(_=0;_<A;_++)this.words[_]=0;this.length+=A}return this._strip()},i.prototype.ishln=function(C){return l(this.negative===0),this.iushln(C)},i.prototype.iushrn=function(C,_,k){var A;l(typeof C=="number"&&C>=0),A=_?(_-_%26)/26:0;var T=C%26,D=Math.min((C-T)/26,this.length),B=67108863^67108863>>>T<<T,F=k;if(A-=D,A=Math.max(0,A),F){for(var Y=0;Y<D;Y++)F.words[Y]=this.words[Y];F.length=D}if(D!==0)if(this.length>D)for(this.length-=D,Y=0;Y<this.length;Y++)this.words[Y]=this.words[Y+D];else this.words[0]=0,this.length=1;var X=0;for(Y=this.length-1;Y>=0&&(X!==0||Y>=A);Y--){var re=0|this.words[Y];this.words[Y]=X<<26-T|re>>>T,X=re&B}return F&&X!==0&&(F.words[F.length++]=X),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},i.prototype.ishrn=function(C,_,k){return l(this.negative===0),this.iushrn(C,_,k)},i.prototype.shln=function(C){return this.clone().ishln(C)},i.prototype.ushln=function(C){return this.clone().iushln(C)},i.prototype.shrn=function(C){return this.clone().ishrn(C)},i.prototype.ushrn=function(C){return this.clone().iushrn(C)},i.prototype.testn=function(C){l(typeof C=="number"&&C>=0);var _=C%26,k=(C-_)/26,A=1<<_;return!(this.length<=k)&&!!(this.words[k]&A)},i.prototype.imaskn=function(C){l(typeof C=="number"&&C>=0);var _=C%26,k=(C-_)/26;if(l(this.negative===0,"imaskn works only with positive numbers"),this.length<=k)return this;if(_!==0&&k++,this.length=Math.min(k,this.length),_!==0){var A=67108863^67108863>>>_<<_;this.words[this.length-1]&=A}return this._strip()},i.prototype.maskn=function(C){return this.clone().imaskn(C)},i.prototype.iaddn=function(C){return l(typeof C=="number"),l(C<67108864),C<0?this.isubn(-C):this.negative!==0?this.length===1&&(0|this.words[0])<=C?(this.words[0]=C-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(C),this.negative=1,this):this._iaddn(C)},i.prototype._iaddn=function(C){this.words[0]+=C;for(var _=0;_<this.length&&this.words[_]>=67108864;_++)this.words[_]-=67108864,_===this.length-1?this.words[_+1]=1:this.words[_+1]++;return this.length=Math.max(this.length,_+1),this},i.prototype.isubn=function(C){if(l(typeof C=="number"),l(C<67108864),C<0)return this.iaddn(-C);if(this.negative!==0)return this.negative=0,this.iaddn(C),this.negative=1,this;if(this.words[0]-=C,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var _=0;_<this.length&&this.words[_]<0;_++)this.words[_]+=67108864,this.words[_+1]-=1;return this._strip()},i.prototype.addn=function(C){return this.clone().iaddn(C)},i.prototype.subn=function(C){return this.clone().isubn(C)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(C,_,k){var A,T,D=C.length+k;this._expand(D);var B=0;for(A=0;A<C.length;A++){T=(0|this.words[A+k])+B;var F=(0|C.words[A])*_;B=((T-=67108863&F)>>26)-(F/67108864|0),this.words[A+k]=67108863&T}for(;A<this.length-k;A++)B=(T=(0|this.words[A+k])+B)>>26,this.words[A+k]=67108863&T;if(B===0)return this._strip();for(l(B===-1),B=0,A=0;A<this.length;A++)B=(T=-(0|this.words[A])+B)>>26,this.words[A]=67108863&T;return this.negative=1,this._strip()},i.prototype._wordDiv=function(C,_){var k=(this.length,C.length),A=this.clone(),T=C,D=0|T.words[T.length-1];(k=26-this._countBits(D))!==0&&(T=T.ushln(k),A.iushln(k),D=0|T.words[T.length-1]);var B,F=A.length-T.length;if(_!=="mod"){(B=new i(null)).length=F+1,B.words=new Array(B.length);for(var Y=0;Y<B.length;Y++)B.words[Y]=0}var X=A.clone()._ishlnsubmul(T,1,F);X.negative===0&&(A=X,B&&(B.words[F]=1));for(var re=F-1;re>=0;re--){var z=67108864*(0|A.words[T.length+re])+(0|A.words[T.length+re-1]);for(z=Math.min(z/D|0,67108863),A._ishlnsubmul(T,z,re);A.negative!==0;)z--,A.negative=0,A._ishlnsubmul(T,1,re),A.isZero()||(A.negative^=1);B&&(B.words[re]=z)}return B&&B._strip(),A._strip(),_!=="div"&&k!==0&&A.iushrn(k),{div:B||null,mod:A}},i.prototype.divmod=function(C,_,k){return l(!C.isZero()),this.isZero()?{div:new i(0),mod:new i(0)}:this.negative!==0&&C.negative===0?(D=this.neg().divmod(C,_),_!=="mod"&&(A=D.div.neg()),_!=="div"&&(T=D.mod.neg(),k&&T.negative!==0&&T.iadd(C)),{div:A,mod:T}):this.negative===0&&C.negative!==0?(D=this.divmod(C.neg(),_),_!=="mod"&&(A=D.div.neg()),{div:A,mod:D.mod}):(this.negative&C.negative)!=0?(D=this.neg().divmod(C.neg(),_),_!=="div"&&(T=D.mod.neg(),k&&T.negative!==0&&T.isub(C)),{div:D.div,mod:T}):C.length>this.length||this.cmp(C)<0?{div:new i(0),mod:this}:C.length===1?_==="div"?{div:this.divn(C.words[0]),mod:null}:_==="mod"?{div:null,mod:new i(this.modrn(C.words[0]))}:{div:this.divn(C.words[0]),mod:new i(this.modrn(C.words[0]))}:this._wordDiv(C,_);var A,T,D},i.prototype.div=function(C){return this.divmod(C,"div",!1).div},i.prototype.mod=function(C){return this.divmod(C,"mod",!1).mod},i.prototype.umod=function(C){return this.divmod(C,"mod",!0).mod},i.prototype.divRound=function(C){var _=this.divmod(C);if(_.mod.isZero())return _.div;var k=_.div.negative!==0?_.mod.isub(C):_.mod,A=C.ushrn(1),T=C.andln(1),D=k.cmp(A);return D<0||T===1&&D===0?_.div:_.div.negative!==0?_.div.isubn(1):_.div.iaddn(1)},i.prototype.modrn=function(C){var _=C<0;_&&(C=-C),l(C<=67108863);for(var k=(1<<26)%C,A=0,T=this.length-1;T>=0;T--)A=(k*A+(0|this.words[T]))%C;return _?-A:A},i.prototype.modn=function(C){return this.modrn(C)},i.prototype.idivn=function(C){var _=C<0;_&&(C=-C),l(C<=67108863);for(var k=0,A=this.length-1;A>=0;A--){var T=(0|this.words[A])+67108864*k;this.words[A]=T/C|0,k=T%C}return this._strip(),_?this.ineg():this},i.prototype.divn=function(C){return this.clone().idivn(C)},i.prototype.egcd=function(C){l(C.negative===0),l(!C.isZero());var _=this,k=C.clone();_=_.negative!==0?_.umod(C):_.clone();for(var A=new i(1),T=new i(0),D=new i(0),B=new i(1),F=0;_.isEven()&&k.isEven();)_.iushrn(1),k.iushrn(1),++F;for(var Y=k.clone(),X=_.clone();!_.isZero();){for(var re=0,z=1;(_.words[0]&z)==0&&re<26;++re,z<<=1);if(re>0)for(_.iushrn(re);re-- >0;)(A.isOdd()||T.isOdd())&&(A.iadd(Y),T.isub(X)),A.iushrn(1),T.iushrn(1);for(var ee=0,L=1;(k.words[0]&L)==0&&ee<26;++ee,L<<=1);if(ee>0)for(k.iushrn(ee);ee-- >0;)(D.isOdd()||B.isOdd())&&(D.iadd(Y),B.isub(X)),D.iushrn(1),B.iushrn(1);_.cmp(k)>=0?(_.isub(k),A.isub(D),T.isub(B)):(k.isub(_),D.isub(A),B.isub(T))}return{a:D,b:B,gcd:k.iushln(F)}},i.prototype._invmp=function(C){l(C.negative===0),l(!C.isZero());var _=this,k=C.clone();_=_.negative!==0?_.umod(C):_.clone();for(var A,T=new i(1),D=new i(0),B=k.clone();_.cmpn(1)>0&&k.cmpn(1)>0;){for(var F=0,Y=1;(_.words[0]&Y)==0&&F<26;++F,Y<<=1);if(F>0)for(_.iushrn(F);F-- >0;)T.isOdd()&&T.iadd(B),T.iushrn(1);for(var X=0,re=1;(k.words[0]&re)==0&&X<26;++X,re<<=1);if(X>0)for(k.iushrn(X);X-- >0;)D.isOdd()&&D.iadd(B),D.iushrn(1);_.cmp(k)>=0?(_.isub(k),T.isub(D)):(k.isub(_),D.isub(T))}return(A=_.cmpn(1)===0?T:D).cmpn(0)<0&&A.iadd(C),A},i.prototype.gcd=function(C){if(this.isZero())return C.abs();if(C.isZero())return this.abs();var _=this.clone(),k=C.clone();_.negative=0,k.negative=0;for(var A=0;_.isEven()&&k.isEven();A++)_.iushrn(1),k.iushrn(1);for(;;){for(;_.isEven();)_.iushrn(1);for(;k.isEven();)k.iushrn(1);var T=_.cmp(k);if(T<0){var D=_;_=k,k=D}else if(T===0||k.cmpn(1)===0)break;_.isub(k)}return k.iushln(A)},i.prototype.invm=function(C){return this.egcd(C).a.umod(C)},i.prototype.isEven=function(){return(1&this.words[0])==0},i.prototype.isOdd=function(){return(1&this.words[0])==1},i.prototype.andln=function(C){return this.words[0]&C},i.prototype.bincn=function(C){l(typeof C=="number");var _=C%26,k=(C-_)/26,A=1<<_;if(this.length<=k)return this._expand(k+1),this.words[k]|=A,this;for(var T=A,D=k;T!==0&&D<this.length;D++){var B=0|this.words[D];T=(B+=T)>>>26,B&=67108863,this.words[D]=B}return T!==0&&(this.words[D]=T,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(C){var _,k=C<0;if(this.negative!==0&&!k)return-1;if(this.negative===0&&k)return 1;if(this._strip(),this.length>1)_=1;else{k&&(C=-C),l(C<=67108863,"Number is too big");var A=0|this.words[0];_=A===C?0:A<C?-1:1}return this.negative!==0?0|-_:_},i.prototype.cmp=function(C){if(this.negative!==0&&C.negative===0)return-1;if(this.negative===0&&C.negative!==0)return 1;var _=this.ucmp(C);return this.negative!==0?0|-_:_},i.prototype.ucmp=function(C){if(this.length>C.length)return 1;if(this.length<C.length)return-1;for(var _=0,k=this.length-1;k>=0;k--){var A=0|this.words[k],T=0|C.words[k];if(A!==T){A<T?_=-1:A>T&&(_=1);break}}return _},i.prototype.gtn=function(C){return this.cmpn(C)===1},i.prototype.gt=function(C){return this.cmp(C)===1},i.prototype.gten=function(C){return this.cmpn(C)>=0},i.prototype.gte=function(C){return this.cmp(C)>=0},i.prototype.ltn=function(C){return this.cmpn(C)===-1},i.prototype.lt=function(C){return this.cmp(C)===-1},i.prototype.lten=function(C){return this.cmpn(C)<=0},i.prototype.lte=function(C){return this.cmp(C)<=0},i.prototype.eqn=function(C){return this.cmpn(C)===0},i.prototype.eq=function(C){return this.cmp(C)===0},i.red=function(C){return new O(C)},i.prototype.toRed=function(C){return l(!this.red,"Already a number in reduction context"),l(this.negative===0,"red works only with positives"),C.convertTo(this)._forceRed(C)},i.prototype.fromRed=function(){return l(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(C){return this.red=C,this},i.prototype.forceRed=function(C){return l(!this.red,"Already a number in reduction context"),this._forceRed(C)},i.prototype.redAdd=function(C){return l(this.red,"redAdd works only with red numbers"),this.red.add(this,C)},i.prototype.redIAdd=function(C){return l(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,C)},i.prototype.redSub=function(C){return l(this.red,"redSub works only with red numbers"),this.red.sub(this,C)},i.prototype.redISub=function(C){return l(this.red,"redISub works only with red numbers"),this.red.isub(this,C)},i.prototype.redShl=function(C){return l(this.red,"redShl works only with red numbers"),this.red.shl(this,C)},i.prototype.redMul=function(C){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,C),this.red.mul(this,C)},i.prototype.redIMul=function(C){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,C),this.red.imul(this,C)},i.prototype.redSqr=function(){return l(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return l(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return l(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return l(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return l(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(C){return l(this.red&&!C.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,C)};var V={k256:null,p224:null,p192:null,p25519:null};function U(C,_){this.name=C,this.p=new i(_,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function H(){U.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function G(){U.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function Z(){U.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function W(){U.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function O(C){if(typeof C=="string"){var _=i._prime(C);this.m=_.p,this.prime=_}else l(C.gtn(1),"modulus must be greater than 1"),this.m=C,this.prime=null}function R(C){O.call(this,C),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}U.prototype._tmp=function(){var C=new i(null);return C.words=new Array(Math.ceil(this.n/13)),C},U.prototype.ireduce=function(C){var _,k=C;do this.split(k,this.tmp),_=(k=(k=this.imulK(k)).iadd(this.tmp)).bitLength();while(_>this.n);var A=_<this.n?-1:k.ucmp(this.p);return A===0?(k.words[0]=0,k.length=1):A>0?k.isub(this.p):k.strip!==void 0?k.strip():k._strip(),k},U.prototype.split=function(C,_){C.iushrn(this.n,0,_)},U.prototype.imulK=function(C){return C.imul(this.k)},c(H,U),H.prototype.split=function(C,_){for(var k=Math.min(C.length,9),A=0;A<k;A++)_.words[A]=C.words[A];if(_.length=k,C.length<=9)return C.words[0]=0,void(C.length=1);var T=C.words[9];for(_.words[_.length++]=4194303&T,A=10;A<C.length;A++){var D=0|C.words[A];C.words[A-10]=(4194303&D)<<4|T>>>22,T=D}T>>>=22,C.words[A-10]=T,T===0&&C.length>10?C.length-=10:C.length-=9},H.prototype.imulK=function(C){C.words[C.length]=0,C.words[C.length+1]=0,C.length+=2;for(var _=0,k=0;k<C.length;k++){var A=0|C.words[k];_+=977*A,C.words[k]=67108863&_,_=64*A+(_/67108864|0)}return C.words[C.length-1]===0&&(C.length--,C.words[C.length-1]===0&&C.length--),C},c(G,U),c(Z,U),c(W,U),W.prototype.imulK=function(C){for(var _=0,k=0;k<C.length;k++){var A=19*(0|C.words[k])+_,T=67108863&A;A>>>=26,C.words[k]=T,_=A}return _!==0&&(C.words[C.length++]=_),C},i._prime=function(C){if(V[C])return V[C];var _;if(C==="k256")_=new H;else if(C==="p224")_=new G;else if(C==="p192")_=new Z;else{if(C!=="p25519")throw new Error("Unknown prime "+C);_=new W}return V[C]=_,_},O.prototype._verify1=function(C){l(C.negative===0,"red works only with positives"),l(C.red,"red works only with red numbers")},O.prototype._verify2=function(C,_){l((C.negative|_.negative)==0,"red works only with positives"),l(C.red&&C.red===_.red,"red works only with red numbers")},O.prototype.imod=function(C){return this.prime?this.prime.ireduce(C)._forceRed(this):(v(C,C.umod(this.m)._forceRed(this)),C)},O.prototype.neg=function(C){return C.isZero()?C.clone():this.m.sub(C)._forceRed(this)},O.prototype.add=function(C,_){this._verify2(C,_);var k=C.add(_);return k.cmp(this.m)>=0&&k.isub(this.m),k._forceRed(this)},O.prototype.iadd=function(C,_){this._verify2(C,_);var k=C.iadd(_);return k.cmp(this.m)>=0&&k.isub(this.m),k},O.prototype.sub=function(C,_){this._verify2(C,_);var k=C.sub(_);return k.cmpn(0)<0&&k.iadd(this.m),k._forceRed(this)},O.prototype.isub=function(C,_){this._verify2(C,_);var k=C.isub(_);return k.cmpn(0)<0&&k.iadd(this.m),k},O.prototype.shl=function(C,_){return this._verify1(C),this.imod(C.ushln(_))},O.prototype.imul=function(C,_){return this._verify2(C,_),this.imod(C.imul(_))},O.prototype.mul=function(C,_){return this._verify2(C,_),this.imod(C.mul(_))},O.prototype.isqr=function(C){return this.imul(C,C.clone())},O.prototype.sqr=function(C){return this.mul(C,C)},O.prototype.sqrt=function(C){if(C.isZero())return C.clone();var _=this.m.andln(3);if(l(_%2==1),_===3){var k=this.m.add(new i(1)).iushrn(2);return this.pow(C,k)}for(var A=this.m.subn(1),T=0;!A.isZero()&&A.andln(1)===0;)T++,A.iushrn(1);l(!A.isZero());var D=new i(1).toRed(this),B=D.redNeg(),F=this.m.subn(1).iushrn(1),Y=this.m.bitLength();for(Y=new i(2*Y*Y).toRed(this);this.pow(Y,F).cmp(B)!==0;)Y.redIAdd(B);for(var X=this.pow(Y,A),re=this.pow(C,A.addn(1).iushrn(1)),z=this.pow(C,A),ee=T;z.cmp(D)!==0;){for(var L=z,M=0;L.cmp(D)!==0;M++)L=L.redSqr();l(M<ee);var K=this.pow(X,new i(1).iushln(ee-M-1));re=re.redMul(K),X=K.redSqr(),z=z.redMul(X),ee=M}return re},O.prototype.invm=function(C){var _=C._invmp(this.m);return _.negative!==0?(_.negative=0,this.imod(_).redNeg()):this.imod(_)},O.prototype.pow=function(C,_){if(_.isZero())return new i(1).toRed(this);if(_.cmpn(1)===0)return C.clone();var k=new Array(16);k[0]=new i(1).toRed(this),k[1]=C;for(var A=2;A<k.length;A++)k[A]=this.mul(k[A-1],C);var T=k[0],D=0,B=0,F=_.bitLength()%26;for(F===0&&(F=26),A=_.length-1;A>=0;A--){for(var Y=_.words[A],X=F-1;X>=0;X--){var re=Y>>X&1;T!==k[0]&&(T=this.sqr(T)),re!==0||D!==0?(D<<=1,D|=re,(++B===4||A===0&&X===0)&&(T=this.mul(T,k[D]),B=0,D=0)):B=0}F=26}return T},O.prototype.convertTo=function(C){var _=C.umod(this.m);return _===C?_.clone():_},O.prototype.convertFrom=function(C){var _=C.clone();return _.red=null,_},i.mont=function(C){return new R(C)},c(R,O),R.prototype.convertTo=function(C){return this.imod(C.ushln(this.shift))},R.prototype.convertFrom=function(C){var _=this.imod(C.mul(this.rinv));return _.red=null,_},R.prototype.imul=function(C,_){if(C.isZero()||_.isZero())return C.words[0]=0,C.length=1,C;var k=C.imul(_),A=k.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),T=k.isub(A).iushrn(this.shift),D=T;return T.cmp(this.m)>=0?D=T.isub(this.m):T.cmpn(0)<0&&(D=T.iadd(this.m)),D._forceRed(this)},R.prototype.mul=function(C,_){if(C.isZero()||_.isZero())return new i(0)._forceRed(this);var k=C.mul(_),A=k.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),T=k.isub(A).iushrn(this.shift),D=T;return T.cmp(this.m)>=0?D=T.isub(this.m):T.cmpn(0)<0&&(D=T.iadd(this.m)),D._forceRed(this)},R.prototype.invm=function(C){return this.imod(C._invmp(this.m).mul(this.r2))._forceRed(this)}})(a===void 0||a)},{buffer:188}],187:[function(e,a,n){var o;function s(c){this.rand=c}if(a.exports=function(c){return o||(o=new s(null)),o.generate(c)},a.exports.Rand=s,s.prototype.generate=function(c){return this._rand(c)},s.prototype._rand=function(c){if(this.rand.getBytes)return this.rand.getBytes(c);for(var i=new Uint8Array(c),u=0;u<i.length;u++)i[u]=this.rand.getByte();return i},typeof self=="object")self.crypto&&self.crypto.getRandomValues?s.prototype._rand=function(c){var i=new Uint8Array(c);return self.crypto.getRandomValues(i),i}:self.msCrypto&&self.msCrypto.getRandomValues?s.prototype._rand=function(c){var i=new Uint8Array(c);return self.msCrypto.getRandomValues(i),i}:typeof window=="object"&&(s.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var l=e("crypto");if(typeof l.randomBytes!="function")throw new Error("Not supported");s.prototype._rand=function(c){return l.randomBytes(c)}}catch{}},{crypto:188}],188:[function(e,a,n){},{}],189:[function(e,a,n){var o=e("safe-buffer").Buffer;function s(f){o.isBuffer(f)||(f=o.from(f));for(var h=f.length/4|0,v=new Array(h),b=0;b<h;b++)v[b]=f.readUInt32BE(4*b);return v}function l(f){for(;0<f.length;f++)f[0]=0}function c(f,h,v,b,g){for(var x,y,E,N,I=v[0],P=v[1],V=v[2],U=v[3],H=f[0]^h[0],G=f[1]^h[1],Z=f[2]^h[2],W=f[3]^h[3],O=4,R=1;R<g;R++)x=I[H>>>24]^P[G>>>16&255]^V[Z>>>8&255]^U[255&W]^h[O++],y=I[G>>>24]^P[Z>>>16&255]^V[W>>>8&255]^U[255&H]^h[O++],E=I[Z>>>24]^P[W>>>16&255]^V[H>>>8&255]^U[255&G]^h[O++],N=I[W>>>24]^P[H>>>16&255]^V[G>>>8&255]^U[255&Z]^h[O++],H=x,G=y,Z=E,W=N;return x=(b[H>>>24]<<24|b[G>>>16&255]<<16|b[Z>>>8&255]<<8|b[255&W])^h[O++],y=(b[G>>>24]<<24|b[Z>>>16&255]<<16|b[W>>>8&255]<<8|b[255&H])^h[O++],E=(b[Z>>>24]<<24|b[W>>>16&255]<<16|b[H>>>8&255]<<8|b[255&G])^h[O++],N=(b[W>>>24]<<24|b[H>>>16&255]<<16|b[G>>>8&255]<<8|b[255&Z])^h[O++],[x>>>=0,y>>>=0,E>>>=0,N>>>=0]}var i=[0,1,2,4,8,16,32,64,128,27,54],u=function(){for(var f=new Array(256),h=0;h<256;h++)f[h]=h<128?h<<1:h<<1^283;for(var v=[],b=[],g=[[],[],[],[]],x=[[],[],[],[]],y=0,E=0,N=0;N<256;++N){var I=E^E<<1^E<<2^E<<3^E<<4;I=I>>>8^255&I^99,v[y]=I,b[I]=y;var P=f[y],V=f[P],U=f[V],H=257*f[I]^16843008*I;g[0][y]=H<<24|H>>>8,g[1][y]=H<<16|H>>>16,g[2][y]=H<<8|H>>>24,g[3][y]=H,H=16843009*U^65537*V^257*P^16843008*y,x[0][I]=H<<24|H>>>8,x[1][I]=H<<16|H>>>16,x[2][I]=H<<8|H>>>24,x[3][I]=H,y===0?y=E=1:(y=P^f[f[f[U^P]]],E^=f[f[E]])}return{SBOX:v,INV_SBOX:b,SUB_MIX:g,INV_SUB_MIX:x}}();function p(f){this._key=s(f),this._reset()}p.blockSize=16,p.keySize=32,p.prototype.blockSize=p.blockSize,p.prototype.keySize=p.keySize,p.prototype._reset=function(){for(var f=this._key,h=f.length,v=h+6,b=4*(v+1),g=[],x=0;x<h;x++)g[x]=f[x];for(x=h;x<b;x++){var y=g[x-1];x%h==0?(y=y<<8|y>>>24,y=u.SBOX[y>>>24]<<24|u.SBOX[y>>>16&255]<<16|u.SBOX[y>>>8&255]<<8|u.SBOX[255&y],y^=i[x/h|0]<<24):h>6&&x%h==4&&(y=u.SBOX[y>>>24]<<24|u.SBOX[y>>>16&255]<<16|u.SBOX[y>>>8&255]<<8|u.SBOX[255&y]),g[x]=g[x-h]^y}for(var E=[],N=0;N<b;N++){var I=b-N,P=g[I-(N%4?0:4)];E[N]=N<4||I<=4?P:u.INV_SUB_MIX[0][u.SBOX[P>>>24]]^u.INV_SUB_MIX[1][u.SBOX[P>>>16&255]]^u.INV_SUB_MIX[2][u.SBOX[P>>>8&255]]^u.INV_SUB_MIX[3][u.SBOX[255&P]]}this._nRounds=v,this._keySchedule=g,this._invKeySchedule=E},p.prototype.encryptBlockRaw=function(f){return c(f=s(f),this._keySchedule,u.SUB_MIX,u.SBOX,this._nRounds)},p.prototype.encryptBlock=function(f){var h=this.encryptBlockRaw(f),v=o.allocUnsafe(16);return v.writeUInt32BE(h[0],0),v.writeUInt32BE(h[1],4),v.writeUInt32BE(h[2],8),v.writeUInt32BE(h[3],12),v},p.prototype.decryptBlock=function(f){var h=(f=s(f))[1];f[1]=f[3],f[3]=h;var v=c(f,this._invKeySchedule,u.INV_SUB_MIX,u.INV_SBOX,this._nRounds),b=o.allocUnsafe(16);return b.writeUInt32BE(v[0],0),b.writeUInt32BE(v[3],4),b.writeUInt32BE(v[2],8),b.writeUInt32BE(v[1],12),b},p.prototype.scrub=function(){l(this._keySchedule),l(this._invKeySchedule),l(this._key)},a.exports.AES=p},{"safe-buffer":494}],190:[function(e,a,n){var o=e("./aes"),s=e("safe-buffer").Buffer,l=e("cipher-base"),c=e("inherits"),i=e("./ghash"),u=e("buffer-xor"),p=e("./incr32");function f(h,v,b,g){l.call(this);var x=s.alloc(4,0);this._cipher=new o.AES(v);var y=this._cipher.encryptBlock(x);this._ghash=new i(y),b=function(E,N,I){if(N.length===12)return E._finID=s.concat([N,s.from([0,0,0,1])]),s.concat([N,s.from([0,0,0,2])]);var P=new i(I),V=N.length,U=V%16;P.update(N),U&&(U=16-U,P.update(s.alloc(U,0))),P.update(s.alloc(8,0));var H=8*V,G=s.alloc(8);G.writeUIntBE(H,0,8),P.update(G),E._finID=P.state;var Z=s.from(E._finID);return p(Z),Z}(this,b,y),this._prev=s.from(b),this._cache=s.allocUnsafe(0),this._secCache=s.allocUnsafe(0),this._decrypt=g,this._alen=0,this._len=0,this._mode=h,this._authTag=null,this._called=!1}c(f,l),f.prototype._update=function(h){if(!this._called&&this._alen){var v=16-this._alen%16;v<16&&(v=s.alloc(v,0),this._ghash.update(v))}this._called=!0;var b=this._mode.encrypt(this,h);return this._decrypt?this._ghash.update(h):this._ghash.update(b),this._len+=h.length,b},f.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var h=u(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(v,b){var g=0;v.length!==b.length&&g++;for(var x=Math.min(v.length,b.length),y=0;y<x;++y)g+=v[y]^b[y];return g}(h,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=h,this._cipher.scrub()},f.prototype.getAuthTag=function(){if(this._decrypt||!s.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},f.prototype.setAuthTag=function(h){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=h},f.prototype.setAAD=function(h){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(h),this._alen+=h.length},a.exports=f},{"./aes":189,"./ghash":194,"./incr32":195,"buffer-xor":219,"cipher-base":221,inherits:440,"safe-buffer":494}],191:[function(e,a,n){var o=e("./encrypter"),s=e("./decrypter"),l=e("./modes/list.json");n.createCipher=n.Cipher=o.createCipher,n.createCipheriv=n.Cipheriv=o.createCipheriv,n.createDecipher=n.Decipher=s.createDecipher,n.createDecipheriv=n.Decipheriv=s.createDecipheriv,n.listCiphers=n.getCiphers=function(){return Object.keys(l)}},{"./decrypter":192,"./encrypter":193,"./modes/list.json":203}],192:[function(e,a,n){var o=e("./authCipher"),s=e("safe-buffer").Buffer,l=e("./modes"),c=e("./streamCipher"),i=e("cipher-base"),u=e("./aes"),p=e("evp_bytestokey");function f(b,g,x){i.call(this),this._cache=new h,this._last=void 0,this._cipher=new u.AES(g),this._prev=s.from(x),this._mode=b,this._autopadding=!0}function h(){this.cache=s.allocUnsafe(0)}function v(b,g,x){var y=l[b.toLowerCase()];if(!y)throw new TypeError("invalid suite type");if(typeof x=="string"&&(x=s.from(x)),y.mode!=="GCM"&&x.length!==y.iv)throw new TypeError("invalid iv length "+x.length);if(typeof g=="string"&&(g=s.from(g)),g.length!==y.key/8)throw new TypeError("invalid key length "+g.length);return y.type==="stream"?new c(y.module,g,x,!0):y.type==="auth"?new o(y.module,g,x,!0):new f(y.module,g,x)}e("inherits")(f,i),f.prototype._update=function(b){var g,x;this._cache.add(b);for(var y=[];g=this._cache.get(this._autopadding);)x=this._mode.decrypt(this,g),y.push(x);return s.concat(y)},f.prototype._final=function(){var b=this._cache.flush();if(this._autopadding)return function(g){var x=g[15];if(x<1||x>16)throw new Error("unable to decrypt data");for(var y=-1;++y<x;)if(g[y+(16-x)]!==x)throw new Error("unable to decrypt data");if(x!==16)return g.slice(0,16-x)}(this._mode.decrypt(this,b));if(b)throw new Error("data not multiple of block length")},f.prototype.setAutoPadding=function(b){return this._autopadding=!!b,this},h.prototype.add=function(b){this.cache=s.concat([this.cache,b])},h.prototype.get=function(b){var g;if(b){if(this.cache.length>16)return g=this.cache.slice(0,16),this.cache=this.cache.slice(16),g}else if(this.cache.length>=16)return g=this.cache.slice(0,16),this.cache=this.cache.slice(16),g;return null},h.prototype.flush=function(){if(this.cache.length)return this.cache},n.createDecipher=function(b,g){var x=l[b.toLowerCase()];if(!x)throw new TypeError("invalid suite type");var y=p(g,!1,x.key,x.iv);return v(b,y.key,y.iv)},n.createDecipheriv=v},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],193:[function(e,a,n){var o=e("./modes"),s=e("./authCipher"),l=e("safe-buffer").Buffer,c=e("./streamCipher"),i=e("cipher-base"),u=e("./aes"),p=e("evp_bytestokey");function f(g,x,y){i.call(this),this._cache=new v,this._cipher=new u.AES(x),this._prev=l.from(y),this._mode=g,this._autopadding=!0}e("inherits")(f,i),f.prototype._update=function(g){var x,y;this._cache.add(g);for(var E=[];x=this._cache.get();)y=this._mode.encrypt(this,x),E.push(y);return l.concat(E)};var h=l.alloc(16,16);function v(){this.cache=l.allocUnsafe(0)}function b(g,x,y){var E=o[g.toLowerCase()];if(!E)throw new TypeError("invalid suite type");if(typeof x=="string"&&(x=l.from(x)),x.length!==E.key/8)throw new TypeError("invalid key length "+x.length);if(typeof y=="string"&&(y=l.from(y)),E.mode!=="GCM"&&y.length!==E.iv)throw new TypeError("invalid iv length "+y.length);return E.type==="stream"?new c(E.module,x,y):E.type==="auth"?new s(E.module,x,y):new f(E.module,x,y)}f.prototype._final=function(){var g=this._cache.flush();if(this._autopadding)return g=this._mode.encrypt(this,g),this._cipher.scrub(),g;if(!g.equals(h))throw this._cipher.scrub(),new Error("data not multiple of block length")},f.prototype.setAutoPadding=function(g){return this._autopadding=!!g,this},v.prototype.add=function(g){this.cache=l.concat([this.cache,g])},v.prototype.get=function(){if(this.cache.length>15){var g=this.cache.slice(0,16);return this.cache=this.cache.slice(16),g}return null},v.prototype.flush=function(){for(var g=16-this.cache.length,x=l.allocUnsafe(g),y=-1;++y<g;)x.writeUInt8(g,y);return l.concat([this.cache,x])},n.createCipheriv=b,n.createCipher=function(g,x){var y=o[g.toLowerCase()];if(!y)throw new TypeError("invalid suite type");var E=p(x,!1,y.key,y.iv);return b(g,E.key,E.iv)}},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],194:[function(e,a,n){var o=e("safe-buffer").Buffer,s=o.alloc(16,0);function l(i){var u=o.allocUnsafe(16);return u.writeUInt32BE(i[0]>>>0,0),u.writeUInt32BE(i[1]>>>0,4),u.writeUInt32BE(i[2]>>>0,8),u.writeUInt32BE(i[3]>>>0,12),u}function c(i){this.h=i,this.state=o.alloc(16,0),this.cache=o.allocUnsafe(0)}c.prototype.ghash=function(i){for(var u=-1;++u<i.length;)this.state[u]^=i[u];this._multiply()},c.prototype._multiply=function(){for(var i,u,p,f=[(i=this.h).readUInt32BE(0),i.readUInt32BE(4),i.readUInt32BE(8),i.readUInt32BE(12)],h=[0,0,0,0],v=-1;++v<128;){for((this.state[~~(v/8)]&1<<7-v%8)!=0&&(h[0]^=f[0],h[1]^=f[1],h[2]^=f[2],h[3]^=f[3]),p=(1&f[3])!=0,u=3;u>0;u--)f[u]=f[u]>>>1|(1&f[u-1])<<31;f[0]=f[0]>>>1,p&&(f[0]=f[0]^225<<24)}this.state=l(h)},c.prototype.update=function(i){var u;for(this.cache=o.concat([this.cache,i]);this.cache.length>=16;)u=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(u)},c.prototype.final=function(i,u){return this.cache.length&&this.ghash(o.concat([this.cache,s],16)),this.ghash(l([0,i,0,u])),this.state},a.exports=c},{"safe-buffer":494}],195:[function(e,a,n){a.exports=function(o){for(var s,l=o.length;l--;){if((s=o.readUInt8(l))!==255){s++,o.writeUInt8(s,l);break}o.writeUInt8(0,l)}}},{}],196:[function(e,a,n){var o=e("buffer-xor");n.encrypt=function(s,l){var c=o(l,s._prev);return s._prev=s._cipher.encryptBlock(c),s._prev},n.decrypt=function(s,l){var c=s._prev;s._prev=l;var i=s._cipher.decryptBlock(l);return o(i,c)}},{"buffer-xor":219}],197:[function(e,a,n){var o=e("safe-buffer").Buffer,s=e("buffer-xor");function l(c,i,u){var p=i.length,f=s(i,c._cache);return c._cache=c._cache.slice(p),c._prev=o.concat([c._prev,u?i:f]),f}n.encrypt=function(c,i,u){for(var p,f=o.allocUnsafe(0);i.length;){if(c._cache.length===0&&(c._cache=c._cipher.encryptBlock(c._prev),c._prev=o.allocUnsafe(0)),!(c._cache.length<=i.length)){f=o.concat([f,l(c,i,u)]);break}p=c._cache.length,f=o.concat([f,l(c,i.slice(0,p),u)]),i=i.slice(p)}return f}},{"buffer-xor":219,"safe-buffer":494}],198:[function(e,a,n){var o=e("safe-buffer").Buffer;function s(c,i,u){for(var p,f,h=-1,v=0;++h<8;)p=i&1<<7-h?128:0,v+=(128&(f=c._cipher.encryptBlock(c._prev)[0]^p))>>h%8,c._prev=l(c._prev,u?p:f);return v}function l(c,i){var u=c.length,p=-1,f=o.allocUnsafe(c.length);for(c=o.concat([c,o.from([i])]);++p<u;)f[p]=c[p]<<1|c[p+1]>>7;return f}n.encrypt=function(c,i,u){for(var p=i.length,f=o.allocUnsafe(p),h=-1;++h<p;)f[h]=s(c,i[h],u);return f}},{"safe-buffer":494}],199:[function(e,a,n){var o=e("safe-buffer").Buffer;function s(l,c,i){var u=l._cipher.encryptBlock(l._prev)[0]^c;return l._prev=o.concat([l._prev.slice(1),o.from([i?c:u])]),u}n.encrypt=function(l,c,i){for(var u=c.length,p=o.allocUnsafe(u),f=-1;++f<u;)p[f]=s(l,c[f],i);return p}},{"safe-buffer":494}],200:[function(e,a,n){var o=e("buffer-xor"),s=e("safe-buffer").Buffer,l=e("../incr32");function c(i){var u=i._cipher.encryptBlockRaw(i._prev);return l(i._prev),u}n.encrypt=function(i,u){var p=Math.ceil(u.length/16),f=i._cache.length;i._cache=s.concat([i._cache,s.allocUnsafe(16*p)]);for(var h=0;h<p;h++){var v=c(i),b=f+16*h;i._cache.writeUInt32BE(v[0],b+0),i._cache.writeUInt32BE(v[1],b+4),i._cache.writeUInt32BE(v[2],b+8),i._cache.writeUInt32BE(v[3],b+12)}var g=i._cache.slice(0,u.length);return i._cache=i._cache.slice(u.length),o(u,g)}},{"../incr32":195,"buffer-xor":219,"safe-buffer":494}],201:[function(e,a,n){n.encrypt=function(o,s){return o._cipher.encryptBlock(s)},n.decrypt=function(o,s){return o._cipher.decryptBlock(s)}},{}],202:[function(e,a,n){var o={ECB:e("./ecb"),CBC:e("./cbc"),CFB:e("./cfb"),CFB8:e("./cfb8"),CFB1:e("./cfb1"),OFB:e("./ofb"),CTR:e("./ctr"),GCM:e("./ctr")},s=e("./list.json");for(var l in s)s[l].module=o[s[l].mode];a.exports=s},{"./cbc":196,"./cfb":197,"./cfb1":198,"./cfb8":199,"./ctr":200,"./ecb":201,"./list.json":203,"./ofb":204}],203:[function(e,a,n){a.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],204:[function(e,a,n){(function(o){(function(){var s=e("buffer-xor");function l(c){return c._prev=c._cipher.encryptBlock(c._prev),c._prev}n.encrypt=function(c,i){for(;c._cache.length<i.length;)c._cache=o.concat([c._cache,l(c)]);var u=c._cache.slice(0,i.length);return c._cache=c._cache.slice(i.length),s(i,u)}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220,"buffer-xor":219}],205:[function(e,a,n){var o=e("./aes"),s=e("safe-buffer").Buffer,l=e("cipher-base");function c(i,u,p,f){l.call(this),this._cipher=new o.AES(u),this._prev=s.from(p),this._cache=s.allocUnsafe(0),this._secCache=s.allocUnsafe(0),this._decrypt=f,this._mode=i}e("inherits")(c,l),c.prototype._update=function(i){return this._mode.encrypt(this,i,this._decrypt)},c.prototype._final=function(){this._cipher.scrub()},a.exports=c},{"./aes":189,"cipher-base":221,inherits:440,"safe-buffer":494}],206:[function(e,a,n){var o=e("browserify-des"),s=e("browserify-aes/browser"),l=e("browserify-aes/modes"),c=e("browserify-des/modes"),i=e("evp_bytestokey");function u(f,h,v){if(f=f.toLowerCase(),l[f])return s.createCipheriv(f,h,v);if(c[f])return new o({key:h,iv:v,mode:f});throw new TypeError("invalid suite type")}function p(f,h,v){if(f=f.toLowerCase(),l[f])return s.createDecipheriv(f,h,v);if(c[f])return new o({key:h,iv:v,mode:f,decrypt:!0});throw new TypeError("invalid suite type")}n.createCipher=n.Cipher=function(f,h){var v,b;if(f=f.toLowerCase(),l[f])v=l[f].key,b=l[f].iv;else{if(!c[f])throw new TypeError("invalid suite type");v=8*c[f].key,b=c[f].iv}var g=i(h,!1,v,b);return u(f,g.key,g.iv)},n.createCipheriv=n.Cipheriv=u,n.createDecipher=n.Decipher=function(f,h){var v,b;if(f=f.toLowerCase(),l[f])v=l[f].key,b=l[f].iv;else{if(!c[f])throw new TypeError("invalid suite type");v=8*c[f].key,b=c[f].iv}var g=i(h,!1,v,b);return p(f,g.key,g.iv)},n.createDecipheriv=n.Decipheriv=p,n.listCiphers=n.getCiphers=function(){return Object.keys(c).concat(s.getCiphers())}},{"browserify-aes/browser":191,"browserify-aes/modes":202,"browserify-des":207,"browserify-des/modes":208,evp_bytestokey:423}],207:[function(e,a,n){var o=e("cipher-base"),s=e("des.js"),l=e("inherits"),c=e("safe-buffer").Buffer,i={"des-ede3-cbc":s.CBC.instantiate(s.EDE),"des-ede3":s.EDE,"des-ede-cbc":s.CBC.instantiate(s.EDE),"des-ede":s.EDE,"des-cbc":s.CBC.instantiate(s.DES),"des-ecb":s.DES};function u(p){o.call(this);var f,h=p.mode.toLowerCase(),v=i[h];f=p.decrypt?"decrypt":"encrypt";var b=p.key;c.isBuffer(b)||(b=c.from(b)),h!=="des-ede"&&h!=="des-ede-cbc"||(b=c.concat([b,b.slice(0,8)]));var g=p.iv;c.isBuffer(g)||(g=c.from(g)),this._des=v.create({key:b,iv:g,type:f})}i.des=i["des-cbc"],i.des3=i["des-ede3-cbc"],a.exports=u,l(u,o),u.prototype._update=function(p){return c.from(this._des.update(p))},u.prototype._final=function(){return c.from(this._des.final())}},{"cipher-base":221,"des.js":394,inherits:440,"safe-buffer":494}],208:[function(e,a,n){n["des-ecb"]={key:8,iv:0},n["des-cbc"]=n.des={key:8,iv:8},n["des-ede3-cbc"]=n.des3={key:24,iv:8},n["des-ede3"]={key:24,iv:0},n["des-ede-cbc"]={key:16,iv:8},n["des-ede"]={key:16,iv:0}},{}],209:[function(e,a,n){(function(o){(function(){var s=e("bn.js"),l=e("randombytes");function c(u){var p,f=u.modulus.byteLength();do p=new s(l(f));while(p.cmp(u.modulus)>=0||!p.umod(u.prime1)||!p.umod(u.prime2));return p}function i(u,p){var f=function(V){var U=c(V);return{blinder:U.toRed(s.mont(V.modulus)).redPow(new s(V.publicExponent)).fromRed(),unblinder:U.invm(V.modulus)}}(p),h=p.modulus.byteLength(),v=new s(u).mul(f.blinder).umod(p.modulus),b=v.toRed(s.mont(p.prime1)),g=v.toRed(s.mont(p.prime2)),x=p.coefficient,y=p.prime1,E=p.prime2,N=b.redPow(p.exponent1).fromRed(),I=g.redPow(p.exponent2).fromRed(),P=N.isub(I).imul(x).umod(y).imul(E);return I.iadd(P).imul(f.unblinder).umod(p.modulus).toArrayLike(o,"be",h)}i.getr=c,a.exports=i}).call(this)}).call(this,e("buffer").Buffer)},{"bn.js":186,buffer:220,randombytes:475}],210:[function(e,a,n){a.exports=e("./browser/algorithms.json")},{"./browser/algorithms.json":211}],211:[function(e,a,n){a.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],212:[function(e,a,n){a.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],213:[function(e,a,n){var o=e("safe-buffer").Buffer,s=e("create-hash"),l=e("readable-stream"),c=e("inherits"),i=e("./sign"),u=e("./verify"),p=e("./algorithms.json");function f(g){l.Writable.call(this);var x=p[g];if(!x)throw new Error("Unknown message digest");this._hashType=x.hash,this._hash=s(x.hash),this._tag=x.id,this._signType=x.sign}function h(g){l.Writable.call(this);var x=p[g];if(!x)throw new Error("Unknown message digest");this._hash=s(x.hash),this._tag=x.id,this._signType=x.sign}function v(g){return new f(g)}function b(g){return new h(g)}Object.keys(p).forEach(function(g){p[g].id=o.from(p[g].id,"hex"),p[g.toLowerCase()]=p[g]}),c(f,l.Writable),f.prototype._write=function(g,x,y){this._hash.update(g),y()},f.prototype.update=function(g,x){return typeof g=="string"&&(g=o.from(g,x)),this._hash.update(g),this},f.prototype.sign=function(g,x){this.end();var y=this._hash.digest(),E=i(y,g,this._hashType,this._signType,this._tag);return x?E.toString(x):E},c(h,l.Writable),h.prototype._write=function(g,x,y){this._hash.update(g),y()},h.prototype.update=function(g,x){return typeof g=="string"&&(g=o.from(g,x)),this._hash.update(g),this},h.prototype.verify=function(g,x,y){typeof x=="string"&&(x=o.from(x,y)),this.end();var E=this._hash.digest();return u(x,E,g,this._signType,this._tag)},a.exports={Sign:v,Verify:b,createSign:v,createVerify:b}},{"./algorithms.json":211,"./sign":214,"./verify":215,"create-hash":386,inherits:440,"readable-stream":491,"safe-buffer":494}],214:[function(e,a,n){var o=e("safe-buffer").Buffer,s=e("create-hmac"),l=e("browserify-rsa"),c=e("elliptic").ec,i=e("bn.js"),u=e("parse-asn1"),p=e("./curves.json");function f(g,x,y,E){if((g=o.from(g.toArray())).length<x.byteLength()){var N=o.alloc(x.byteLength()-g.length);g=o.concat([N,g])}var I=y.length,P=function(H,G){H=(H=h(H,G)).mod(G);var Z=o.from(H.toArray());if(Z.length<G.byteLength()){var W=o.alloc(G.byteLength()-Z.length);Z=o.concat([W,Z])}return Z}(y,x),V=o.alloc(I);V.fill(1);var U=o.alloc(I);return U=s(E,U).update(V).update(o.from([0])).update(g).update(P).digest(),V=s(E,U).update(V).digest(),{k:U=s(E,U).update(V).update(o.from([1])).update(g).update(P).digest(),v:V=s(E,U).update(V).digest()}}function h(g,x){var y=new i(g),E=(g.length<<3)-x.bitLength();return E>0&&y.ishrn(E),y}function v(g,x,y){var E,N;do{for(E=o.alloc(0);8*E.length<g.bitLength();)x.v=s(y,x.k).update(x.v).digest(),E=o.concat([E,x.v]);N=h(E,g),x.k=s(y,x.k).update(x.v).update(o.from([0])).digest(),x.v=s(y,x.k).update(x.v).digest()}while(N.cmp(g)!==-1);return N}function b(g,x,y,E){return g.toRed(i.mont(y)).redPow(x).fromRed().mod(E)}a.exports=function(g,x,y,E,N){var I=u(x);if(I.curve){if(E!=="ecdsa"&&E!=="ecdsa/rsa")throw new Error("wrong private key type");return function(H,G){var Z=p[G.curve.join(".")];if(!Z)throw new Error("unknown curve "+G.curve.join("."));var W=new c(Z).keyFromPrivate(G.privateKey).sign(H);return o.from(W.toDER())}(g,I)}if(I.type==="dsa"){if(E!=="dsa")throw new Error("wrong private key type");return function(H,G,Z){for(var W,O=G.params.priv_key,R=G.params.p,C=G.params.q,_=G.params.g,k=new i(0),A=h(H,C).mod(C),T=!1,D=f(O,C,H,Z);T===!1;)W=v(C,D,Z),k=b(_,W,R,C),(T=W.invm(C).imul(A.add(O.mul(k))).mod(C)).cmpn(0)===0&&(T=!1,k=new i(0));return function(B,F){B=B.toArray(),F=F.toArray(),128&B[0]&&(B=[0].concat(B)),128&F[0]&&(F=[0].concat(F));var Y=[48,B.length+F.length+4,2,B.length];return Y=Y.concat(B,[2,F.length],F),o.from(Y)}(k,T)}(g,I,y)}if(E!=="rsa"&&E!=="ecdsa/rsa")throw new Error("wrong private key type");g=o.concat([N,g]);for(var P=I.modulus.byteLength(),V=[0,1];g.length+V.length+1<P;)V.push(255);V.push(0);for(var U=-1;++U<g.length;)V.push(g[U]);return l(V,I)},a.exports.getKey=f,a.exports.makeKey=v},{"./curves.json":212,"bn.js":186,"browserify-rsa":209,"create-hmac":388,elliptic:405,"parse-asn1":459,"safe-buffer":494}],215:[function(e,a,n){var o=e("safe-buffer").Buffer,s=e("bn.js"),l=e("elliptic").ec,c=e("parse-asn1"),i=e("./curves.json");function u(p,f){if(p.cmpn(0)<=0)throw new Error("invalid sig");if(p.cmp(f)>=f)throw new Error("invalid sig")}a.exports=function(p,f,h,v,b){var g=c(h);if(g.type==="ec"){if(v!=="ecdsa"&&v!=="ecdsa/rsa")throw new Error("wrong public key type");return function(V,U,H){var G=i[H.data.algorithm.curve.join(".")];if(!G)throw new Error("unknown curve "+H.data.algorithm.curve.join("."));var Z=new l(G),W=H.data.subjectPrivateKey.data;return Z.verify(U,V,W)}(p,f,g)}if(g.type==="dsa"){if(v!=="dsa")throw new Error("wrong public key type");return function(V,U,H){var G=H.data.p,Z=H.data.q,W=H.data.g,O=H.data.pub_key,R=c.signature.decode(V,"der"),C=R.s,_=R.r;u(C,Z),u(_,Z);var k=s.mont(G),A=C.invm(Z);return W.toRed(k).redPow(new s(U).mul(A).mod(Z)).fromRed().mul(O.toRed(k).redPow(_.mul(A).mod(Z)).fromRed()).mod(G).mod(Z).cmp(_)===0}(p,f,g)}if(v!=="rsa"&&v!=="ecdsa/rsa")throw new Error("wrong public key type");f=o.concat([b,f]);for(var x=g.modulus.byteLength(),y=[1],E=0;f.length+y.length+2<x;)y.push(255),E++;y.push(0);for(var N=-1;++N<f.length;)y.push(f[N]);y=o.from(y);var I=s.mont(g.modulus);p=(p=new s(p).toRed(I)).redPow(new s(g.publicExponent)),p=o.from(p.fromRed().toArray());var P=E<8?1:0;for(x=Math.min(p.length,y.length),p.length!==y.length&&(P=1),N=-1;++N<x;)P|=p[N]^y[N];return P===0}},{"./curves.json":212,"bn.js":186,elliptic:405,"parse-asn1":459,"safe-buffer":494}],216:[function(e,a,n){},{}],217:[function(e,a,n){var o=e("buffer"),s=o.Buffer;function l(i,u){for(var p in i)u[p]=i[p]}function c(i,u,p){return s(i,u,p)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?a.exports=o:(l(o,n),n.Buffer=c),l(s,c),c.from=function(i,u,p){if(typeof i=="number")throw new TypeError("Argument must not be a number");return s(i,u,p)},c.alloc=function(i,u,p){if(typeof i!="number")throw new TypeError("Argument must be a number");var f=s(i);return u!==void 0?typeof p=="string"?f.fill(u,p):f.fill(u):f.fill(0),f},c.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return s(i)},c.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return o.SlowBuffer(i)}},{buffer:220}],218:[function(e,a,n){var o=e("safe-buffer").Buffer,s=o.isEncoding||function(g){switch((g=""+g)&&g.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function l(g){var x;switch(this.encoding=function(y){var E=function(N){if(!N)return"utf8";for(var I;;)switch(N){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return N;default:if(I)return;N=(""+N).toLowerCase(),I=!0}}(y);if(typeof E!="string"&&(o.isEncoding===s||!s(y)))throw new Error("Unknown encoding: "+y);return E||y}(g),this.encoding){case"utf16le":this.text=u,this.end=p,x=4;break;case"utf8":this.fillLast=i,x=4;break;case"base64":this.text=f,this.end=h,x=3;break;default:return this.write=v,void(this.end=b)}this.lastNeed=0,this.lastTotal=0,this.lastChar=o.allocUnsafe(x)}function c(g){return g<=127?0:g>>5==6?2:g>>4==14?3:g>>3==30?4:g>>6==2?-1:-2}function i(g){var x=this.lastTotal-this.lastNeed,y=function(E,N,I){if((192&N[0])!=128)return E.lastNeed=0,"";if(E.lastNeed>1&&N.length>1){if((192&N[1])!=128)return E.lastNeed=1,"";if(E.lastNeed>2&&N.length>2&&(192&N[2])!=128)return E.lastNeed=2,""}}(this,g);return y!==void 0?y:this.lastNeed<=g.length?(g.copy(this.lastChar,x,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(g.copy(this.lastChar,x,0,g.length),void(this.lastNeed-=g.length))}function u(g,x){if((g.length-x)%2==0){var y=g.toString("utf16le",x);if(y){var E=y.charCodeAt(y.length-1);if(E>=55296&&E<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=g[g.length-2],this.lastChar[1]=g[g.length-1],y.slice(0,-1)}return y}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=g[g.length-1],g.toString("utf16le",x,g.length-1)}function p(g){var x=g&&g.length?this.write(g):"";if(this.lastNeed){var y=this.lastTotal-this.lastNeed;return x+this.lastChar.toString("utf16le",0,y)}return x}function f(g,x){var y=(g.length-x)%3;return y===0?g.toString("base64",x):(this.lastNeed=3-y,this.lastTotal=3,y===1?this.lastChar[0]=g[g.length-1]:(this.lastChar[0]=g[g.length-2],this.lastChar[1]=g[g.length-1]),g.toString("base64",x,g.length-y))}function h(g){var x=g&&g.length?this.write(g):"";return this.lastNeed?x+this.lastChar.toString("base64",0,3-this.lastNeed):x}function v(g){return g.toString(this.encoding)}function b(g){return g&&g.length?this.write(g):""}n.StringDecoder=l,l.prototype.write=function(g){if(g.length===0)return"";var x,y;if(this.lastNeed){if((x=this.fillLast(g))===void 0)return"";y=this.lastNeed,this.lastNeed=0}else y=0;return y<g.length?x?x+this.text(g,y):this.text(g,y):x||""},l.prototype.end=function(g){var x=g&&g.length?this.write(g):"";return this.lastNeed?x+"":x},l.prototype.text=function(g,x){var y=function(N,I,P){var V=I.length-1;if(V<P)return 0;var U=c(I[V]);return U>=0?(U>0&&(N.lastNeed=U-1),U):--V<P||U===-2?0:(U=c(I[V]))>=0?(U>0&&(N.lastNeed=U-2),U):--V<P||U===-2?0:(U=c(I[V]))>=0?(U>0&&(U===2?U=0:N.lastNeed=U-3),U):0}(this,g,x);if(!this.lastNeed)return g.toString("utf8",x);this.lastTotal=y;var E=g.length-(y-this.lastNeed);return g.copy(this.lastChar,0,E),g.toString("utf8",x,E)},l.prototype.fillLast=function(g){if(this.lastNeed<=g.length)return g.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);g.copy(this.lastChar,this.lastTotal-this.lastNeed,0,g.length),this.lastNeed-=g.length}},{"safe-buffer":217}],219:[function(e,a,n){(function(o){(function(){a.exports=function(s,l){for(var c=Math.min(s.length,l.length),i=new o(c),u=0;u<c;++u)i[u]=s[u]^l[u];return i}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220}],220:[function(e,a,n){(function(o){(function(){var s=e("base64-js"),l=e("ieee754");n.Buffer=i,n.SlowBuffer=function(L){return+L!=L&&(L=0),i.alloc(+L)},n.INSPECT_MAX_BYTES=50;function c(L){if(L>2147483647)throw new RangeError('The value "'+L+'" is invalid for option "size"');var M=new Uint8Array(L);return M.__proto__=i.prototype,M}function i(L,M,K){if(typeof L=="number"){if(typeof M=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(L)}return u(L,M,K)}function u(L,M,K){if(typeof L=="string")return function(ae,Q){if(typeof Q=="string"&&Q!==""||(Q="utf8"),!i.isEncoding(Q))throw new TypeError("Unknown encoding: "+Q);var fe=0|b(ae,Q),le=c(fe),ne=le.write(ae,Q);return ne!==fe&&(le=le.slice(0,ne)),le}(L,M);if(ArrayBuffer.isView(L))return h(L);if(L==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L);if(z(L,ArrayBuffer)||L&&z(L.buffer,ArrayBuffer))return function(ae,Q,fe){if(Q<0||ae.byteLength<Q)throw new RangeError('"offset" is outside of buffer bounds');if(ae.byteLength<Q+(fe||0))throw new RangeError('"length" is outside of buffer bounds');var le;return le=Q===void 0&&fe===void 0?new Uint8Array(ae):fe===void 0?new Uint8Array(ae,Q):new Uint8Array(ae,Q,fe),le.__proto__=i.prototype,le}(L,M,K);if(typeof L=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var se=L.valueOf&&L.valueOf();if(se!=null&&se!==L)return i.from(se,M,K);var te=function(ae){if(i.isBuffer(ae)){var Q=0|v(ae.length),fe=c(Q);return fe.length===0||ae.copy(fe,0,0,Q),fe}if(ae.length!==void 0)return typeof ae.length!="number"||ee(ae.length)?c(0):h(ae);if(ae.type==="Buffer"&&Array.isArray(ae.data))return h(ae.data)}(L);if(te)return te;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof L[Symbol.toPrimitive]=="function")return i.from(L[Symbol.toPrimitive]("string"),M,K);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L)}function p(L){if(typeof L!="number")throw new TypeError('"size" argument must be of type number');if(L<0)throw new RangeError('The value "'+L+'" is invalid for option "size"')}function f(L){return p(L),c(L<0?0:0|v(L))}function h(L){for(var M=L.length<0?0:0|v(L.length),K=c(M),se=0;se<M;se+=1)K[se]=255&L[se];return K}function v(L){if(L>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|L}function b(L,M){if(i.isBuffer(L))return L.length;if(ArrayBuffer.isView(L)||z(L,ArrayBuffer))return L.byteLength;if(typeof L!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof L);var K=L.length,se=arguments.length>2&&arguments[2]===!0;if(!se&&K===0)return 0;for(var te=!1;;)switch(M){case"ascii":case"latin1":case"binary":return K;case"utf8":case"utf-8":return Y(L).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*K;case"hex":return K>>>1;case"base64":return X(L).length;default:if(te)return se?-1:Y(L).length;M=(""+M).toLowerCase(),te=!0}}function g(L,M,K){var se=!1;if((M===void 0||M<0)&&(M=0),M>this.length||((K===void 0||K>this.length)&&(K=this.length),K<=0)||(K>>>=0)<=(M>>>=0))return"";for(L||(L="utf8");;)switch(L){case"hex":return R(this,M,K);case"utf8":case"utf-8":return Z(this,M,K);case"ascii":return W(this,M,K);case"latin1":case"binary":return O(this,M,K);case"base64":return G(this,M,K);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,M,K);default:if(se)throw new TypeError("Unknown encoding: "+L);L=(L+"").toLowerCase(),se=!0}}function x(L,M,K){var se=L[M];L[M]=L[K],L[K]=se}function y(L,M,K,se,te){if(L.length===0)return-1;if(typeof K=="string"?(se=K,K=0):K>2147483647?K=2147483647:K<-2147483648&&(K=-2147483648),ee(K=+K)&&(K=te?0:L.length-1),K<0&&(K=L.length+K),K>=L.length){if(te)return-1;K=L.length-1}else if(K<0){if(!te)return-1;K=0}if(typeof M=="string"&&(M=i.from(M,se)),i.isBuffer(M))return M.length===0?-1:E(L,M,K,se,te);if(typeof M=="number")return M&=255,typeof Uint8Array.prototype.indexOf=="function"?te?Uint8Array.prototype.indexOf.call(L,M,K):Uint8Array.prototype.lastIndexOf.call(L,M,K):E(L,[M],K,se,te);throw new TypeError("val must be string, number or Buffer")}function E(L,M,K,se,te){var ae,Q=1,fe=L.length,le=M.length;if(se!==void 0&&((se=String(se).toLowerCase())==="ucs2"||se==="ucs-2"||se==="utf16le"||se==="utf-16le")){if(L.length<2||M.length<2)return-1;Q=2,fe/=2,le/=2,K/=2}function ne(pe,Ce){return Q===1?pe[Ce]:pe.readUInt16BE(Ce*Q)}if(te){var ue=-1;for(ae=K;ae<fe;ae++)if(ne(L,ae)===ne(M,ue===-1?0:ae-ue)){if(ue===-1&&(ue=ae),ae-ue+1===le)return ue*Q}else ue!==-1&&(ae-=ae-ue),ue=-1}else for(K+le>fe&&(K=fe-le),ae=K;ae>=0;ae--){for(var he=!0,ke=0;ke<le;ke++)if(ne(L,ae+ke)!==ne(M,ke)){he=!1;break}if(he)return ae}return-1}function N(L,M,K,se){K=Number(K)||0;var te=L.length-K;se?(se=Number(se))>te&&(se=te):se=te;var ae=M.length;se>ae/2&&(se=ae/2);for(var Q=0;Q<se;++Q){var fe=parseInt(M.substr(2*Q,2),16);if(ee(fe))return Q;L[K+Q]=fe}return Q}function I(L,M,K,se){return re(Y(M,L.length-K),L,K,se)}function P(L,M,K,se){return re(function(te){for(var ae=[],Q=0;Q<te.length;++Q)ae.push(255&te.charCodeAt(Q));return ae}(M),L,K,se)}function V(L,M,K,se){return P(L,M,K,se)}function U(L,M,K,se){return re(X(M),L,K,se)}function H(L,M,K,se){return re(function(te,ae){for(var Q,fe,le,ne=[],ue=0;ue<te.length&&!((ae-=2)<0);++ue)Q=te.charCodeAt(ue),fe=Q>>8,le=Q%256,ne.push(le),ne.push(fe);return ne}(M,L.length-K),L,K,se)}function G(L,M,K){return M===0&&K===L.length?s.fromByteArray(L):s.fromByteArray(L.slice(M,K))}function Z(L,M,K){K=Math.min(L.length,K);for(var se=[],te=M;te<K;){var ae,Q,fe,le,ne=L[te],ue=null,he=ne>239?4:ne>223?3:ne>191?2:1;if(te+he<=K)switch(he){case 1:ne<128&&(ue=ne);break;case 2:(192&(ae=L[te+1]))==128&&(le=(31&ne)<<6|63&ae)>127&&(ue=le);break;case 3:ae=L[te+1],Q=L[te+2],(192&ae)==128&&(192&Q)==128&&(le=(15&ne)<<12|(63&ae)<<6|63&Q)>2047&&(le<55296||le>57343)&&(ue=le);break;case 4:ae=L[te+1],Q=L[te+2],fe=L[te+3],(192&ae)==128&&(192&Q)==128&&(192&fe)==128&&(le=(15&ne)<<18|(63&ae)<<12|(63&Q)<<6|63&fe)>65535&&le<1114112&&(ue=le)}ue===null?(ue=65533,he=1):ue>65535&&(ue-=65536,se.push(ue>>>10&1023|55296),ue=56320|1023&ue),se.push(ue),te+=he}return function(ke){var pe=ke.length;if(pe<=4096)return String.fromCharCode.apply(String,ke);for(var Ce="",Me=0;Me<pe;)Ce+=String.fromCharCode.apply(String,ke.slice(Me,Me+=4096));return Ce}(se)}n.kMaxLength=2147483647,i.TYPED_ARRAY_SUPPORT=function(){try{var L=new Uint8Array(1);return L.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},L.foo()===42}catch{return!1}}(),i.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(i.prototype,"parent",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.buffer}}),Object.defineProperty(i.prototype,"offset",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),i.poolSize=8192,i.from=function(L,M,K){return u(L,M,K)},i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,i.alloc=function(L,M,K){return function(se,te,ae){return p(se),se<=0?c(se):te!==void 0?typeof ae=="string"?c(se).fill(te,ae):c(se).fill(te):c(se)}(L,M,K)},i.allocUnsafe=function(L){return f(L)},i.allocUnsafeSlow=function(L){return f(L)},i.isBuffer=function(L){return L!=null&&L._isBuffer===!0&&L!==i.prototype},i.compare=function(L,M){if(z(L,Uint8Array)&&(L=i.from(L,L.offset,L.byteLength)),z(M,Uint8Array)&&(M=i.from(M,M.offset,M.byteLength)),!i.isBuffer(L)||!i.isBuffer(M))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(L===M)return 0;for(var K=L.length,se=M.length,te=0,ae=Math.min(K,se);te<ae;++te)if(L[te]!==M[te]){K=L[te],se=M[te];break}return K<se?-1:se<K?1:0},i.isEncoding=function(L){switch(String(L).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(L,M){if(!Array.isArray(L))throw new TypeError('"list" argument must be an Array of Buffers');if(L.length===0)return i.alloc(0);var K;if(M===void 0)for(M=0,K=0;K<L.length;++K)M+=L[K].length;var se=i.allocUnsafe(M),te=0;for(K=0;K<L.length;++K){var ae=L[K];if(z(ae,Uint8Array)&&(ae=i.from(ae)),!i.isBuffer(ae))throw new TypeError('"list" argument must be an Array of Buffers');ae.copy(se,te),te+=ae.length}return se},i.byteLength=b,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var L=this.length;if(L%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var M=0;M<L;M+=2)x(this,M,M+1);return this},i.prototype.swap32=function(){var L=this.length;if(L%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var M=0;M<L;M+=4)x(this,M,M+3),x(this,M+1,M+2);return this},i.prototype.swap64=function(){var L=this.length;if(L%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var M=0;M<L;M+=8)x(this,M,M+7),x(this,M+1,M+6),x(this,M+2,M+5),x(this,M+3,M+4);return this},i.prototype.toString=function(){var L=this.length;return L===0?"":arguments.length===0?Z(this,0,L):g.apply(this,arguments)},i.prototype.toLocaleString=i.prototype.toString,i.prototype.equals=function(L){if(!i.isBuffer(L))throw new TypeError("Argument must be a Buffer");return this===L||i.compare(this,L)===0},i.prototype.inspect=function(){var L="",M=n.INSPECT_MAX_BYTES;return L=this.toString("hex",0,M).replace(/(.{2})/g,"$1 ").trim(),this.length>M&&(L+=" ... "),"<Buffer "+L+">"},i.prototype.compare=function(L,M,K,se,te){if(z(L,Uint8Array)&&(L=i.from(L,L.offset,L.byteLength)),!i.isBuffer(L))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof L);if(M===void 0&&(M=0),K===void 0&&(K=L?L.length:0),se===void 0&&(se=0),te===void 0&&(te=this.length),M<0||K>L.length||se<0||te>this.length)throw new RangeError("out of range index");if(se>=te&&M>=K)return 0;if(se>=te)return-1;if(M>=K)return 1;if(this===L)return 0;for(var ae=(te>>>=0)-(se>>>=0),Q=(K>>>=0)-(M>>>=0),fe=Math.min(ae,Q),le=this.slice(se,te),ne=L.slice(M,K),ue=0;ue<fe;++ue)if(le[ue]!==ne[ue]){ae=le[ue],Q=ne[ue];break}return ae<Q?-1:Q<ae?1:0},i.prototype.includes=function(L,M,K){return this.indexOf(L,M,K)!==-1},i.prototype.indexOf=function(L,M,K){return y(this,L,M,K,!0)},i.prototype.lastIndexOf=function(L,M,K){return y(this,L,M,K,!1)},i.prototype.write=function(L,M,K,se){if(M===void 0)se="utf8",K=this.length,M=0;else if(K===void 0&&typeof M=="string")se=M,K=this.length,M=0;else{if(!isFinite(M))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");M>>>=0,isFinite(K)?(K>>>=0,se===void 0&&(se="utf8")):(se=K,K=void 0)}var te=this.length-M;if((K===void 0||K>te)&&(K=te),L.length>0&&(K<0||M<0)||M>this.length)throw new RangeError("Attempt to write outside buffer bounds");se||(se="utf8");for(var ae=!1;;)switch(se){case"hex":return N(this,L,M,K);case"utf8":case"utf-8":return I(this,L,M,K);case"ascii":return P(this,L,M,K);case"latin1":case"binary":return V(this,L,M,K);case"base64":return U(this,L,M,K);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H(this,L,M,K);default:if(ae)throw new TypeError("Unknown encoding: "+se);se=(""+se).toLowerCase(),ae=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function W(L,M,K){var se="";K=Math.min(L.length,K);for(var te=M;te<K;++te)se+=String.fromCharCode(127&L[te]);return se}function O(L,M,K){var se="";K=Math.min(L.length,K);for(var te=M;te<K;++te)se+=String.fromCharCode(L[te]);return se}function R(L,M,K){var se=L.length;(!M||M<0)&&(M=0),(!K||K<0||K>se)&&(K=se);for(var te="",ae=M;ae<K;++ae)te+=F(L[ae]);return te}function C(L,M,K){for(var se=L.slice(M,K),te="",ae=0;ae<se.length;ae+=2)te+=String.fromCharCode(se[ae]+256*se[ae+1]);return te}function _(L,M,K){if(L%1!=0||L<0)throw new RangeError("offset is not uint");if(L+M>K)throw new RangeError("Trying to access beyond buffer length")}function k(L,M,K,se,te,ae){if(!i.isBuffer(L))throw new TypeError('"buffer" argument must be a Buffer instance');if(M>te||M<ae)throw new RangeError('"value" argument is out of bounds');if(K+se>L.length)throw new RangeError("Index out of range")}function A(L,M,K,se,te,ae){if(K+se>L.length)throw new RangeError("Index out of range");if(K<0)throw new RangeError("Index out of range")}function T(L,M,K,se,te){return M=+M,K>>>=0,te||A(L,0,K,4),l.write(L,M,K,se,23,4),K+4}function D(L,M,K,se,te){return M=+M,K>>>=0,te||A(L,0,K,8),l.write(L,M,K,se,52,8),K+8}i.prototype.slice=function(L,M){var K=this.length;(L=~~L)<0?(L+=K)<0&&(L=0):L>K&&(L=K),(M=M===void 0?K:~~M)<0?(M+=K)<0&&(M=0):M>K&&(M=K),M<L&&(M=L);var se=this.subarray(L,M);return se.__proto__=i.prototype,se},i.prototype.readUIntLE=function(L,M,K){L>>>=0,M>>>=0,K||_(L,M,this.length);for(var se=this[L],te=1,ae=0;++ae<M&&(te*=256);)se+=this[L+ae]*te;return se},i.prototype.readUIntBE=function(L,M,K){L>>>=0,M>>>=0,K||_(L,M,this.length);for(var se=this[L+--M],te=1;M>0&&(te*=256);)se+=this[L+--M]*te;return se},i.prototype.readUInt8=function(L,M){return L>>>=0,M||_(L,1,this.length),this[L]},i.prototype.readUInt16LE=function(L,M){return L>>>=0,M||_(L,2,this.length),this[L]|this[L+1]<<8},i.prototype.readUInt16BE=function(L,M){return L>>>=0,M||_(L,2,this.length),this[L]<<8|this[L+1]},i.prototype.readUInt32LE=function(L,M){return L>>>=0,M||_(L,4,this.length),(this[L]|this[L+1]<<8|this[L+2]<<16)+16777216*this[L+3]},i.prototype.readUInt32BE=function(L,M){return L>>>=0,M||_(L,4,this.length),16777216*this[L]+(this[L+1]<<16|this[L+2]<<8|this[L+3])},i.prototype.readIntLE=function(L,M,K){L>>>=0,M>>>=0,K||_(L,M,this.length);for(var se=this[L],te=1,ae=0;++ae<M&&(te*=256);)se+=this[L+ae]*te;return se>=(te*=128)&&(se-=Math.pow(2,8*M)),se},i.prototype.readIntBE=function(L,M,K){L>>>=0,M>>>=0,K||_(L,M,this.length);for(var se=M,te=1,ae=this[L+--se];se>0&&(te*=256);)ae+=this[L+--se]*te;return ae>=(te*=128)&&(ae-=Math.pow(2,8*M)),ae},i.prototype.readInt8=function(L,M){return L>>>=0,M||_(L,1,this.length),128&this[L]?-1*(255-this[L]+1):this[L]},i.prototype.readInt16LE=function(L,M){L>>>=0,M||_(L,2,this.length);var K=this[L]|this[L+1]<<8;return 32768&K?4294901760|K:K},i.prototype.readInt16BE=function(L,M){L>>>=0,M||_(L,2,this.length);var K=this[L+1]|this[L]<<8;return 32768&K?4294901760|K:K},i.prototype.readInt32LE=function(L,M){return L>>>=0,M||_(L,4,this.length),this[L]|this[L+1]<<8|this[L+2]<<16|this[L+3]<<24},i.prototype.readInt32BE=function(L,M){return L>>>=0,M||_(L,4,this.length),this[L]<<24|this[L+1]<<16|this[L+2]<<8|this[L+3]},i.prototype.readFloatLE=function(L,M){return L>>>=0,M||_(L,4,this.length),l.read(this,L,!0,23,4)},i.prototype.readFloatBE=function(L,M){return L>>>=0,M||_(L,4,this.length),l.read(this,L,!1,23,4)},i.prototype.readDoubleLE=function(L,M){return L>>>=0,M||_(L,8,this.length),l.read(this,L,!0,52,8)},i.prototype.readDoubleBE=function(L,M){return L>>>=0,M||_(L,8,this.length),l.read(this,L,!1,52,8)},i.prototype.writeUIntLE=function(L,M,K,se){L=+L,M>>>=0,K>>>=0,se||k(this,L,M,K,Math.pow(2,8*K)-1,0);var te=1,ae=0;for(this[M]=255&L;++ae<K&&(te*=256);)this[M+ae]=L/te&255;return M+K},i.prototype.writeUIntBE=function(L,M,K,se){L=+L,M>>>=0,K>>>=0,se||k(this,L,M,K,Math.pow(2,8*K)-1,0);var te=K-1,ae=1;for(this[M+te]=255&L;--te>=0&&(ae*=256);)this[M+te]=L/ae&255;return M+K},i.prototype.writeUInt8=function(L,M,K){return L=+L,M>>>=0,K||k(this,L,M,1,255,0),this[M]=255&L,M+1},i.prototype.writeUInt16LE=function(L,M,K){return L=+L,M>>>=0,K||k(this,L,M,2,65535,0),this[M]=255&L,this[M+1]=L>>>8,M+2},i.prototype.writeUInt16BE=function(L,M,K){return L=+L,M>>>=0,K||k(this,L,M,2,65535,0),this[M]=L>>>8,this[M+1]=255&L,M+2},i.prototype.writeUInt32LE=function(L,M,K){return L=+L,M>>>=0,K||k(this,L,M,4,4294967295,0),this[M+3]=L>>>24,this[M+2]=L>>>16,this[M+1]=L>>>8,this[M]=255&L,M+4},i.prototype.writeUInt32BE=function(L,M,K){return L=+L,M>>>=0,K||k(this,L,M,4,4294967295,0),this[M]=L>>>24,this[M+1]=L>>>16,this[M+2]=L>>>8,this[M+3]=255&L,M+4},i.prototype.writeIntLE=function(L,M,K,se){if(L=+L,M>>>=0,!se){var te=Math.pow(2,8*K-1);k(this,L,M,K,te-1,-te)}var ae=0,Q=1,fe=0;for(this[M]=255&L;++ae<K&&(Q*=256);)L<0&&fe===0&&this[M+ae-1]!==0&&(fe=1),this[M+ae]=(L/Q>>0)-fe&255;return M+K},i.prototype.writeIntBE=function(L,M,K,se){if(L=+L,M>>>=0,!se){var te=Math.pow(2,8*K-1);k(this,L,M,K,te-1,-te)}var ae=K-1,Q=1,fe=0;for(this[M+ae]=255&L;--ae>=0&&(Q*=256);)L<0&&fe===0&&this[M+ae+1]!==0&&(fe=1),this[M+ae]=(L/Q>>0)-fe&255;return M+K},i.prototype.writeInt8=function(L,M,K){return L=+L,M>>>=0,K||k(this,L,M,1,127,-128),L<0&&(L=255+L+1),this[M]=255&L,M+1},i.prototype.writeInt16LE=function(L,M,K){return L=+L,M>>>=0,K||k(this,L,M,2,32767,-32768),this[M]=255&L,this[M+1]=L>>>8,M+2},i.prototype.writeInt16BE=function(L,M,K){return L=+L,M>>>=0,K||k(this,L,M,2,32767,-32768),this[M]=L>>>8,this[M+1]=255&L,M+2},i.prototype.writeInt32LE=function(L,M,K){return L=+L,M>>>=0,K||k(this,L,M,4,2147483647,-2147483648),this[M]=255&L,this[M+1]=L>>>8,this[M+2]=L>>>16,this[M+3]=L>>>24,M+4},i.prototype.writeInt32BE=function(L,M,K){return L=+L,M>>>=0,K||k(this,L,M,4,2147483647,-2147483648),L<0&&(L=4294967295+L+1),this[M]=L>>>24,this[M+1]=L>>>16,this[M+2]=L>>>8,this[M+3]=255&L,M+4},i.prototype.writeFloatLE=function(L,M,K){return T(this,L,M,!0,K)},i.prototype.writeFloatBE=function(L,M,K){return T(this,L,M,!1,K)},i.prototype.writeDoubleLE=function(L,M,K){return D(this,L,M,!0,K)},i.prototype.writeDoubleBE=function(L,M,K){return D(this,L,M,!1,K)},i.prototype.copy=function(L,M,K,se){if(!i.isBuffer(L))throw new TypeError("argument should be a Buffer");if(K||(K=0),se||se===0||(se=this.length),M>=L.length&&(M=L.length),M||(M=0),se>0&&se<K&&(se=K),se===K||L.length===0||this.length===0)return 0;if(M<0)throw new RangeError("targetStart out of bounds");if(K<0||K>=this.length)throw new RangeError("Index out of range");if(se<0)throw new RangeError("sourceEnd out of bounds");se>this.length&&(se=this.length),L.length-M<se-K&&(se=L.length-M+K);var te=se-K;if(this===L&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(M,K,se);else if(this===L&&K<M&&M<se)for(var ae=te-1;ae>=0;--ae)L[ae+M]=this[ae+K];else Uint8Array.prototype.set.call(L,this.subarray(K,se),M);return te},i.prototype.fill=function(L,M,K,se){if(typeof L=="string"){if(typeof M=="string"?(se=M,M=0,K=this.length):typeof K=="string"&&(se=K,K=this.length),se!==void 0&&typeof se!="string")throw new TypeError("encoding must be a string");if(typeof se=="string"&&!i.isEncoding(se))throw new TypeError("Unknown encoding: "+se);if(L.length===1){var te=L.charCodeAt(0);(se==="utf8"&&te<128||se==="latin1")&&(L=te)}}else typeof L=="number"&&(L&=255);if(M<0||this.length<M||this.length<K)throw new RangeError("Out of range index");if(K<=M)return this;var ae;if(M>>>=0,K=K===void 0?this.length:K>>>0,L||(L=0),typeof L=="number")for(ae=M;ae<K;++ae)this[ae]=L;else{var Q=i.isBuffer(L)?L:i.from(L,se),fe=Q.length;if(fe===0)throw new TypeError('The value "'+L+'" is invalid for argument "value"');for(ae=0;ae<K-M;++ae)this[ae+M]=Q[ae%fe]}return this};var B=/[^+/0-9A-Za-z-_]/g;function F(L){return L<16?"0"+L.toString(16):L.toString(16)}function Y(L,M){var K;M=M||1/0;for(var se=L.length,te=null,ae=[],Q=0;Q<se;++Q){if((K=L.charCodeAt(Q))>55295&&K<57344){if(!te){if(K>56319){(M-=3)>-1&&ae.push(239,191,189);continue}if(Q+1===se){(M-=3)>-1&&ae.push(239,191,189);continue}te=K;continue}if(K<56320){(M-=3)>-1&&ae.push(239,191,189),te=K;continue}K=65536+(te-55296<<10|K-56320)}else te&&(M-=3)>-1&&ae.push(239,191,189);if(te=null,K<128){if((M-=1)<0)break;ae.push(K)}else if(K<2048){if((M-=2)<0)break;ae.push(K>>6|192,63&K|128)}else if(K<65536){if((M-=3)<0)break;ae.push(K>>12|224,K>>6&63|128,63&K|128)}else{if(!(K<1114112))throw new Error("Invalid code point");if((M-=4)<0)break;ae.push(K>>18|240,K>>12&63|128,K>>6&63|128,63&K|128)}}return ae}function X(L){return s.toByteArray(function(M){if((M=(M=M.split("=")[0]).trim().replace(B,"")).length<2)return"";for(;M.length%4!=0;)M+="=";return M}(L))}function re(L,M,K,se){for(var te=0;te<se&&!(te+K>=M.length||te>=L.length);++te)M[te+K]=L[te];return te}function z(L,M){return L instanceof M||L!=null&&L.constructor!=null&&L.constructor.name!=null&&L.constructor.name===M.name}function ee(L){return L!=L}}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":185,buffer:220,ieee754:439}],221:[function(e,a,n){var o=e("safe-buffer").Buffer,s=e("stream").Transform,l=e("string_decoder").StringDecoder;function c(i){s.call(this),this.hashMode=typeof i=="string",this.hashMode?this[i]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}e("inherits")(c,s),c.prototype.update=function(i,u,p){typeof i=="string"&&(i=o.from(i,u));var f=this._update(i);return this.hashMode?this:(p&&(f=this._toString(f,p)),f)},c.prototype.setAutoPadding=function(){},c.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},c.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},c.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},c.prototype._transform=function(i,u,p){var f;try{this.hashMode?this._update(i):this.push(this._update(i))}catch(h){f=h}finally{p(f)}},c.prototype._flush=function(i){var u;try{this.push(this.__final())}catch(p){u=p}i(u)},c.prototype._finalOrDigest=function(i){var u=this.__final()||o.alloc(0);return i&&(u=this._toString(u,i,!0)),u},c.prototype._toString=function(i,u,p){if(this._decoder||(this._decoder=new l(u),this._encoding=u),this._encoding!==u)throw new Error("can't switch encodings");var f=this._decoder.write(i);return p&&(f+=this._decoder.end()),f},a.exports=c},{inherits:440,"safe-buffer":494,stream:505,string_decoder:218}],222:[function(e,a,n){var o=e("../internals/is-callable"),s=e("../internals/try-to-string"),l=TypeError;a.exports=function(c){if(o(c))return c;throw new l(s(c)+" is not a function")}},{"../internals/is-callable":285,"../internals/try-to-string":349}],223:[function(e,a,n){var o=e("../internals/is-constructor"),s=e("../internals/try-to-string"),l=TypeError;a.exports=function(c){if(o(c))return c;throw new l(s(c)+" is not a constructor")}},{"../internals/is-constructor":286,"../internals/try-to-string":349}],224:[function(e,a,n){var o=e("../internals/is-callable"),s=String,l=TypeError;a.exports=function(c){if(typeof c=="object"||o(c))return c;throw new l("Can't set "+s(c)+" as a prototype")}},{"../internals/is-callable":285}],225:[function(e,a,n){var o=e("../internals/well-known-symbol"),s=e("../internals/object-create"),l=e("../internals/object-define-property").f,c=o("unscopables"),i=Array.prototype;i[c]===void 0&&l(i,c,{configurable:!0,value:s(null)}),a.exports=function(u){i[c][u]=!0}},{"../internals/object-create":306,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],226:[function(e,a,n){var o=e("../internals/object-is-prototype-of"),s=TypeError;a.exports=function(l,c){if(o(c,l))return l;throw new s("Incorrect invocation")}},{"../internals/object-is-prototype-of":314}],227:[function(e,a,n){var o=e("../internals/is-object"),s=String,l=TypeError;a.exports=function(c){if(o(c))return c;throw new l(s(c)+" is not an object")}},{"../internals/is-object":289}],228:[function(e,a,n){var o=e("../internals/to-indexed-object"),s=e("../internals/to-absolute-index"),l=e("../internals/length-of-array-like"),c=function(i){return function(u,p,f){var h,v=o(u),b=l(v),g=s(f,b);if(i&&p!=p){for(;b>g;)if((h=v[g++])!=h)return!0}else for(;b>g;g++)if((i||g in v)&&v[g]===p)return i||g||0;return!i&&-1}};a.exports={includes:c(!0),indexOf:c(!1)}},{"../internals/length-of-array-like":299,"../internals/to-absolute-index":340,"../internals/to-indexed-object":341}],229:[function(e,a,n){var o=e("../internals/function-bind-context"),s=e("../internals/function-uncurry-this"),l=e("../internals/indexed-object"),c=e("../internals/to-object"),i=e("../internals/length-of-array-like"),u=e("../internals/array-species-create"),p=s([].push),f=function(h){var v=h===1,b=h===2,g=h===3,x=h===4,y=h===6,E=h===7,N=h===5||y;return function(I,P,V,U){for(var H,G,Z=c(I),W=l(Z),O=o(P,V),R=i(W),C=0,_=U||u,k=v?_(I,R):b||E?_(I,0):void 0;R>C;C++)if((N||C in W)&&(G=O(H=W[C],C,Z),h))if(v)k[C]=G;else if(G)switch(h){case 3:return!0;case 5:return H;case 6:return C;case 2:p(k,H)}else switch(h){case 4:return!1;case 7:p(k,H)}return y?-1:g||x?x:k}};a.exports={forEach:f(0),map:f(1),filter:f(2),some:f(3),every:f(4),find:f(5),findIndex:f(6),filterReject:f(7)}},{"../internals/array-species-create":233,"../internals/function-bind-context":262,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/length-of-array-like":299,"../internals/to-object":344}],230:[function(e,a,n){var o=e("../internals/to-absolute-index"),s=e("../internals/length-of-array-like"),l=e("../internals/create-property"),c=Array,i=Math.max;a.exports=function(u,p,f){for(var h=s(u),v=o(p,h),b=o(f===void 0?h:f,h),g=c(i(b-v,0)),x=0;v<b;v++,x++)l(g,x,u[v]);return g.length=x,g}},{"../internals/create-property":243,"../internals/length-of-array-like":299,"../internals/to-absolute-index":340}],231:[function(e,a,n){var o=e("../internals/function-uncurry-this");a.exports=o([].slice)},{"../internals/function-uncurry-this":268}],232:[function(e,a,n){var o=e("../internals/is-array"),s=e("../internals/is-constructor"),l=e("../internals/is-object"),c=e("../internals/well-known-symbol")("species"),i=Array;a.exports=function(u){var p;return o(u)&&(p=u.constructor,(s(p)&&(p===i||o(p.prototype))||l(p)&&(p=p[c])===null)&&(p=void 0)),p===void 0?i:p}},{"../internals/is-array":284,"../internals/is-constructor":286,"../internals/is-object":289,"../internals/well-known-symbol":357}],233:[function(e,a,n){var o=e("../internals/array-species-constructor");a.exports=function(s,l){return new(o(s))(l===0?0:l)}},{"../internals/array-species-constructor":232}],234:[function(e,a,n){var o=e("../internals/well-known-symbol")("iterator"),s=!1;try{var l=0,c={next:function(){return{done:!!l++}},return:function(){s=!0}};c[o]=function(){return this},Array.from(c,function(){throw 2})}catch{}a.exports=function(i,u){try{if(!u&&!s)return!1}catch{return!1}var p=!1;try{var f={};f[o]=function(){return{next:function(){return{done:p=!0}}}},i(f)}catch{}return p}},{"../internals/well-known-symbol":357}],235:[function(e,a,n){var o=e("../internals/function-uncurry-this"),s=o({}.toString),l=o("".slice);a.exports=function(c){return l(s(c),8,-1)}},{"../internals/function-uncurry-this":268}],236:[function(e,a,n){var o=e("../internals/to-string-tag-support"),s=e("../internals/is-callable"),l=e("../internals/classof-raw"),c=e("../internals/well-known-symbol")("toStringTag"),i=Object,u=l(function(){return arguments}())==="Arguments";a.exports=o?l:function(p){var f,h,v;return p===void 0?"Undefined":p===null?"Null":typeof(h=function(b,g){try{return b[g]}catch{}}(f=i(p),c))=="string"?h:u?l(f):(v=l(f))==="Object"&&s(f.callee)?"Arguments":v}},{"../internals/classof-raw":235,"../internals/is-callable":285,"../internals/to-string-tag-support":347,"../internals/well-known-symbol":357}],237:[function(e,a,n){var o=e("../internals/has-own-property"),s=e("../internals/own-keys"),l=e("../internals/object-get-own-property-descriptor"),c=e("../internals/object-define-property");a.exports=function(i,u,p){for(var f=s(u),h=c.f,v=l.f,b=0;b<f.length;b++){var g=f[b];o(i,g)||p&&o(p,g)||h(i,g,v(u,g))}}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/own-keys":321}],238:[function(e,a,n){var o=e("../internals/well-known-symbol")("match");a.exports=function(s){var l=/./;try{"/./"[s](l)}catch{try{return l[o]=!1,"/./"[s](l)}catch{}}return!1}},{"../internals/well-known-symbol":357}],239:[function(e,a,n){var o=e("../internals/fails");a.exports=!o(function(){function s(){}return s.prototype.constructor=null,Object.getPrototypeOf(new s)!==s.prototype})},{"../internals/fails":260}],240:[function(e,a,n){a.exports=function(o,s){return{value:o,done:s}}},{}],241:[function(e,a,n){var o=e("../internals/descriptors"),s=e("../internals/object-define-property"),l=e("../internals/create-property-descriptor");a.exports=o?function(c,i,u){return s.f(c,i,l(1,u))}:function(c,i,u){return c[i]=u,c}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/object-define-property":308}],242:[function(e,a,n){a.exports=function(o,s){return{enumerable:!(1&o),configurable:!(2&o),writable:!(4&o),value:s}}},{}],243:[function(e,a,n){var o=e("../internals/to-property-key"),s=e("../internals/object-define-property"),l=e("../internals/create-property-descriptor");a.exports=function(c,i,u){var p=o(i);p in c?s.f(c,p,l(0,u)):c[p]=u}},{"../internals/create-property-descriptor":242,"../internals/object-define-property":308,"../internals/to-property-key":346}],244:[function(e,a,n){var o=e("../internals/make-built-in"),s=e("../internals/object-define-property");a.exports=function(l,c,i){return i.get&&o(i.get,c,{getter:!0}),i.set&&o(i.set,c,{setter:!0}),s.f(l,c,i)}},{"../internals/make-built-in":300,"../internals/object-define-property":308}],245:[function(e,a,n){var o=e("../internals/is-callable"),s=e("../internals/object-define-property"),l=e("../internals/make-built-in"),c=e("../internals/define-global-property");a.exports=function(i,u,p,f){f||(f={});var h=f.enumerable,v=f.name!==void 0?f.name:u;if(o(p)&&l(p,v,f),f.global)h?i[u]=p:c(u,p);else{try{f.unsafe?i[u]&&(h=!0):delete i[u]}catch{}h?i[u]=p:s.f(i,u,{value:p,enumerable:!1,configurable:!f.nonConfigurable,writable:!f.nonWritable})}return i}},{"../internals/define-global-property":246,"../internals/is-callable":285,"../internals/make-built-in":300,"../internals/object-define-property":308}],246:[function(e,a,n){var o=e("../internals/global"),s=Object.defineProperty;a.exports=function(l,c){try{s(o,l,{value:c,configurable:!0,writable:!0})}catch{o[l]=c}return c}},{"../internals/global":274}],247:[function(e,a,n){var o=e("../internals/fails");a.exports=!o(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},{"../internals/fails":260}],248:[function(e,a,n){var o=typeof document=="object"&&document.all,s=o===void 0&&o!==void 0;a.exports={all:o,IS_HTMLDDA:s}},{}],249:[function(e,a,n){var o=e("../internals/global"),s=e("../internals/is-object"),l=o.document,c=s(l)&&s(l.createElement);a.exports=function(i){return c?l.createElement(i):{}}},{"../internals/global":274,"../internals/is-object":289}],250:[function(e,a,n){var o=e("../internals/engine-is-deno"),s=e("../internals/engine-is-node");a.exports=!o&&!s&&typeof window=="object"&&typeof document=="object"},{"../internals/engine-is-deno":251,"../internals/engine-is-node":254}],251:[function(e,a,n){a.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},{}],252:[function(e,a,n){var o=e("../internals/engine-user-agent");a.exports=/ipad|iphone|ipod/i.test(o)&&typeof Pebble<"u"},{"../internals/engine-user-agent":256}],253:[function(e,a,n){var o=e("../internals/engine-user-agent");a.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(o)},{"../internals/engine-user-agent":256}],254:[function(e,a,n){var o=e("../internals/global"),s=e("../internals/classof-raw");a.exports=s(o.process)==="process"},{"../internals/classof-raw":235,"../internals/global":274}],255:[function(e,a,n){var o=e("../internals/engine-user-agent");a.exports=/web0s(?!.*chrome)/i.test(o)},{"../internals/engine-user-agent":256}],256:[function(e,a,n){a.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},{}],257:[function(e,a,n){var o,s,l=e("../internals/global"),c=e("../internals/engine-user-agent"),i=l.process,u=l.Deno,p=i&&i.versions||u&&u.version,f=p&&p.v8;f&&(s=(o=f.split("."))[0]>0&&o[0]<4?1:+(o[0]+o[1])),!s&&c&&(!(o=c.match(/Edge\/(\d+)/))||o[1]>=74)&&(o=c.match(/Chrome\/(\d+)/))&&(s=+o[1]),a.exports=s},{"../internals/engine-user-agent":256,"../internals/global":274}],258:[function(e,a,n){a.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],259:[function(e,a,n){var o=e("../internals/global"),s=e("../internals/object-get-own-property-descriptor").f,l=e("../internals/create-non-enumerable-property"),c=e("../internals/define-built-in"),i=e("../internals/define-global-property"),u=e("../internals/copy-constructor-properties"),p=e("../internals/is-forced");a.exports=function(f,h){var v,b,g,x,y,E=f.target,N=f.global,I=f.stat;if(v=N?o:I?o[E]||i(E,{}):(o[E]||{}).prototype)for(b in h){if(x=h[b],g=f.dontCallGetSet?(y=s(v,b))&&y.value:v[b],!p(N?b:E+(I?".":"#")+b,f.forced)&&g!==void 0){if(typeof x==typeof g)continue;u(x,g)}(f.sham||g&&g.sham)&&l(x,"sham",!0),c(v,b,x,f)}}},{"../internals/copy-constructor-properties":237,"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/define-global-property":246,"../internals/global":274,"../internals/is-forced":287,"../internals/object-get-own-property-descriptor":309}],260:[function(e,a,n){a.exports=function(o){try{return!!o()}catch{return!0}}},{}],261:[function(e,a,n){var o=e("../internals/function-bind-native"),s=Function.prototype,l=s.apply,c=s.call;a.exports=typeof Reflect=="object"&&Reflect.apply||(o?c.bind(l):function(){return c.apply(l,arguments)})},{"../internals/function-bind-native":263}],262:[function(e,a,n){var o=e("../internals/function-uncurry-this-clause"),s=e("../internals/a-callable"),l=e("../internals/function-bind-native"),c=o(o.bind);a.exports=function(i,u){return s(i),u===void 0?i:l?c(i,u):function(){return i.apply(u,arguments)}}},{"../internals/a-callable":222,"../internals/function-bind-native":263,"../internals/function-uncurry-this-clause":267}],263:[function(e,a,n){var o=e("../internals/fails");a.exports=!o(function(){var s=(function(){}).bind();return typeof s!="function"||s.hasOwnProperty("prototype")})},{"../internals/fails":260}],264:[function(e,a,n){var o=e("../internals/function-bind-native"),s=Function.prototype.call;a.exports=o?s.bind(s):function(){return s.apply(s,arguments)}},{"../internals/function-bind-native":263}],265:[function(e,a,n){var o=e("../internals/descriptors"),s=e("../internals/has-own-property"),l=Function.prototype,c=o&&Object.getOwnPropertyDescriptor,i=s(l,"name"),u=i&&(function(){}).name==="something",p=i&&(!o||o&&c(l,"name").configurable);a.exports={EXISTS:i,PROPER:u,CONFIGURABLE:p}},{"../internals/descriptors":247,"../internals/has-own-property":275}],266:[function(e,a,n){var o=e("../internals/function-uncurry-this"),s=e("../internals/a-callable");a.exports=function(l,c,i){try{return o(s(Object.getOwnPropertyDescriptor(l,c)[i]))}catch{}}},{"../internals/a-callable":222,"../internals/function-uncurry-this":268}],267:[function(e,a,n){var o=e("../internals/classof-raw"),s=e("../internals/function-uncurry-this");a.exports=function(l){if(o(l)==="Function")return s(l)}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268}],268:[function(e,a,n){var o=e("../internals/function-bind-native"),s=Function.prototype,l=s.call,c=o&&s.bind.bind(l,l);a.exports=o?c:function(i){return function(){return l.apply(i,arguments)}}},{"../internals/function-bind-native":263}],269:[function(e,a,n){var o=e("../internals/global"),s=e("../internals/is-callable"),l=function(c){return s(c)?c:void 0};a.exports=function(c,i){return arguments.length<2?l(o[c]):o[c]&&o[c][i]}},{"../internals/global":274,"../internals/is-callable":285}],270:[function(e,a,n){var o=e("../internals/classof"),s=e("../internals/get-method"),l=e("../internals/is-null-or-undefined"),c=e("../internals/iterators"),i=e("../internals/well-known-symbol")("iterator");a.exports=function(u){if(!l(u))return s(u,i)||s(u,"@@iterator")||c[o(u)]}},{"../internals/classof":236,"../internals/get-method":273,"../internals/is-null-or-undefined":288,"../internals/iterators":298,"../internals/well-known-symbol":357}],271:[function(e,a,n){var o=e("../internals/function-call"),s=e("../internals/a-callable"),l=e("../internals/an-object"),c=e("../internals/try-to-string"),i=e("../internals/get-iterator-method"),u=TypeError;a.exports=function(p,f){var h=arguments.length<2?i(p):f;if(s(h))return l(o(h,p));throw new u(c(p)+" is not iterable")}},{"../internals/a-callable":222,"../internals/an-object":227,"../internals/function-call":264,"../internals/get-iterator-method":270,"../internals/try-to-string":349}],272:[function(e,a,n){var o=e("../internals/function-uncurry-this"),s=e("../internals/is-array"),l=e("../internals/is-callable"),c=e("../internals/classof-raw"),i=e("../internals/to-string"),u=o([].push);a.exports=function(p){if(l(p))return p;if(s(p)){for(var f=p.length,h=[],v=0;v<f;v++){var b=p[v];typeof b=="string"?u(h,b):typeof b!="number"&&c(b)!=="Number"&&c(b)!=="String"||u(h,i(b))}var g=h.length,x=!0;return function(y,E){if(x)return x=!1,E;if(s(this))return E;for(var N=0;N<g;N++)if(h[N]===y)return E}}}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268,"../internals/is-array":284,"../internals/is-callable":285,"../internals/to-string":348}],273:[function(e,a,n){var o=e("../internals/a-callable"),s=e("../internals/is-null-or-undefined");a.exports=function(l,c){var i=l[c];return s(i)?void 0:o(i)}},{"../internals/a-callable":222,"../internals/is-null-or-undefined":288}],274:[function(e,a,n){(function(o){(function(){var s=function(l){return l&&l.Math===Math&&l};a.exports=s(typeof globalThis=="object"&&globalThis)||s(typeof window=="object"&&window)||s(typeof self=="object"&&self)||s(typeof o=="object"&&o)||function(){return this}()||this||Function("return this")()}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],275:[function(e,a,n){var o=e("../internals/function-uncurry-this"),s=e("../internals/to-object"),l=o({}.hasOwnProperty);a.exports=Object.hasOwn||function(c,i){return l(s(c),i)}},{"../internals/function-uncurry-this":268,"../internals/to-object":344}],276:[function(e,a,n){a.exports={}},{}],277:[function(e,a,n){a.exports=function(o,s){try{arguments.length===1?console.error(o):console.error(o,s)}catch{}}},{}],278:[function(e,a,n){var o=e("../internals/get-built-in");a.exports=o("document","documentElement")},{"../internals/get-built-in":269}],279:[function(e,a,n){var o=e("../internals/descriptors"),s=e("../internals/fails"),l=e("../internals/document-create-element");a.exports=!o&&!s(function(){return Object.defineProperty(l("div"),"a",{get:function(){return 7}}).a!==7})},{"../internals/descriptors":247,"../internals/document-create-element":249,"../internals/fails":260}],280:[function(e,a,n){var o=e("../internals/function-uncurry-this"),s=e("../internals/fails"),l=e("../internals/classof-raw"),c=Object,i=o("".split);a.exports=s(function(){return!c("z").propertyIsEnumerable(0)})?function(u){return l(u)==="String"?i(u,""):c(u)}:c},{"../internals/classof-raw":235,"../internals/fails":260,"../internals/function-uncurry-this":268}],281:[function(e,a,n){var o=e("../internals/function-uncurry-this"),s=e("../internals/is-callable"),l=e("../internals/shared-store"),c=o(Function.toString);s(l.inspectSource)||(l.inspectSource=function(i){return c(i)}),a.exports=l.inspectSource},{"../internals/function-uncurry-this":268,"../internals/is-callable":285,"../internals/shared-store":333}],282:[function(e,a,n){var o,s,l,c=e("../internals/weak-map-basic-detection"),i=e("../internals/global"),u=e("../internals/is-object"),p=e("../internals/create-non-enumerable-property"),f=e("../internals/has-own-property"),h=e("../internals/shared-store"),v=e("../internals/shared-key"),b=e("../internals/hidden-keys"),g=i.TypeError,x=i.WeakMap;if(c||h.state){var y=h.state||(h.state=new x);y.get=y.get,y.has=y.has,y.set=y.set,o=function(N,I){if(y.has(N))throw new g("Object already initialized");return I.facade=N,y.set(N,I),I},s=function(N){return y.get(N)||{}},l=function(N){return y.has(N)}}else{var E=v("state");b[E]=!0,o=function(N,I){if(f(N,E))throw new g("Object already initialized");return I.facade=N,p(N,E,I),I},s=function(N){return f(N,E)?N[E]:{}},l=function(N){return f(N,E)}}a.exports={set:o,get:s,has:l,enforce:function(N){return l(N)?s(N):o(N,{})},getterFor:function(N){return function(I){var P;if(!u(I)||(P=s(I)).type!==N)throw new g("Incompatible receiver, "+N+" required");return P}}}},{"../internals/create-non-enumerable-property":241,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/is-object":289,"../internals/shared-key":332,"../internals/shared-store":333,"../internals/weak-map-basic-detection":354}],283:[function(e,a,n){var o=e("../internals/well-known-symbol"),s=e("../internals/iterators"),l=o("iterator"),c=Array.prototype;a.exports=function(i){return i!==void 0&&(s.Array===i||c[l]===i)}},{"../internals/iterators":298,"../internals/well-known-symbol":357}],284:[function(e,a,n){var o=e("../internals/classof-raw");a.exports=Array.isArray||function(s){return o(s)==="Array"}},{"../internals/classof-raw":235}],285:[function(e,a,n){var o=e("../internals/document-all"),s=o.all;a.exports=o.IS_HTMLDDA?function(l){return typeof l=="function"||l===s}:function(l){return typeof l=="function"}},{"../internals/document-all":248}],286:[function(e,a,n){var o=e("../internals/function-uncurry-this"),s=e("../internals/fails"),l=e("../internals/is-callable"),c=e("../internals/classof"),i=e("../internals/get-built-in"),u=e("../internals/inspect-source"),p=function(){},f=[],h=i("Reflect","construct"),v=/^\s*(?:class|function)\b/,b=o(v.exec),g=!v.test(p),x=function(E){if(!l(E))return!1;try{return h(p,f,E),!0}catch{return!1}},y=function(E){if(!l(E))return!1;switch(c(E)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return g||!!b(v,u(E))}catch{return!0}};y.sham=!0,a.exports=!h||s(function(){var E;return x(x.call)||!x(Object)||!x(function(){E=!0})||E})?y:x},{"../internals/classof":236,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/inspect-source":281,"../internals/is-callable":285}],287:[function(e,a,n){var o=e("../internals/fails"),s=e("../internals/is-callable"),l=/#|\.prototype\./,c=function(h,v){var b=u[i(h)];return b===f||b!==p&&(s(v)?o(v):!!v)},i=c.normalize=function(h){return String(h).replace(l,".").toLowerCase()},u=c.data={},p=c.NATIVE="N",f=c.POLYFILL="P";a.exports=c},{"../internals/fails":260,"../internals/is-callable":285}],288:[function(e,a,n){a.exports=function(o){return o==null}},{}],289:[function(e,a,n){var o=e("../internals/is-callable"),s=e("../internals/document-all"),l=s.all;a.exports=s.IS_HTMLDDA?function(c){return typeof c=="object"?c!==null:o(c)||c===l}:function(c){return typeof c=="object"?c!==null:o(c)}},{"../internals/document-all":248,"../internals/is-callable":285}],290:[function(e,a,n){a.exports=!1},{}],291:[function(e,a,n){var o=e("../internals/is-object"),s=e("../internals/classof-raw"),l=e("../internals/well-known-symbol")("match");a.exports=function(c){var i;return o(c)&&((i=c[l])!==void 0?!!i:s(c)==="RegExp")}},{"../internals/classof-raw":235,"../internals/is-object":289,"../internals/well-known-symbol":357}],292:[function(e,a,n){var o=e("../internals/get-built-in"),s=e("../internals/is-callable"),l=e("../internals/object-is-prototype-of"),c=e("../internals/use-symbol-as-uid"),i=Object;a.exports=c?function(u){return typeof u=="symbol"}:function(u){var p=o("Symbol");return s(p)&&l(p.prototype,i(u))}},{"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/object-is-prototype-of":314,"../internals/use-symbol-as-uid":351}],293:[function(e,a,n){var o=e("../internals/function-bind-context"),s=e("../internals/function-call"),l=e("../internals/an-object"),c=e("../internals/try-to-string"),i=e("../internals/is-array-iterator-method"),u=e("../internals/length-of-array-like"),p=e("../internals/object-is-prototype-of"),f=e("../internals/get-iterator"),h=e("../internals/get-iterator-method"),v=e("../internals/iterator-close"),b=TypeError,g=function(y,E){this.stopped=y,this.result=E},x=g.prototype;a.exports=function(y,E,N){var I,P,V,U,H,G,Z,W=N&&N.that,O=!(!N||!N.AS_ENTRIES),R=!(!N||!N.IS_RECORD),C=!(!N||!N.IS_ITERATOR),_=!(!N||!N.INTERRUPTED),k=o(E,W),A=function(D){return I&&v(I,"normal",D),new g(!0,D)},T=function(D){return O?(l(D),_?k(D[0],D[1],A):k(D[0],D[1])):_?k(D,A):k(D)};if(R)I=y.iterator;else if(C)I=y;else{if(!(P=h(y)))throw new b(c(y)+" is not iterable");if(i(P)){for(V=0,U=u(y);U>V;V++)if((H=T(y[V]))&&p(x,H))return H;return new g(!1)}I=f(y,P)}for(G=R?y.next:I.next;!(Z=s(G,I)).done;){try{H=T(Z.value)}catch(D){v(I,"throw",D)}if(typeof H=="object"&&H&&p(x,H))return H}return new g(!1)}},{"../internals/an-object":227,"../internals/function-bind-context":262,"../internals/function-call":264,"../internals/get-iterator":271,"../internals/get-iterator-method":270,"../internals/is-array-iterator-method":283,"../internals/iterator-close":294,"../internals/length-of-array-like":299,"../internals/object-is-prototype-of":314,"../internals/try-to-string":349}],294:[function(e,a,n){var o=e("../internals/function-call"),s=e("../internals/an-object"),l=e("../internals/get-method");a.exports=function(c,i,u){var p,f;s(c);try{if(!(p=l(c,"return"))){if(i==="throw")throw u;return u}p=o(p,c)}catch(h){f=!0,p=h}if(i==="throw")throw u;if(f)throw p;return s(p),u}},{"../internals/an-object":227,"../internals/function-call":264,"../internals/get-method":273}],295:[function(e,a,n){var o=e("../internals/iterators-core").IteratorPrototype,s=e("../internals/object-create"),l=e("../internals/create-property-descriptor"),c=e("../internals/set-to-string-tag"),i=e("../internals/iterators"),u=function(){return this};a.exports=function(p,f,h,v){var b=f+" Iterator";return p.prototype=s(o,{next:l(+!v,h)}),c(p,b,!1,!0),i[b]=u,p}},{"../internals/create-property-descriptor":242,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-create":306,"../internals/set-to-string-tag":331}],296:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/function-call"),l=e("../internals/is-pure"),c=e("../internals/function-name"),i=e("../internals/is-callable"),u=e("../internals/iterator-create-constructor"),p=e("../internals/object-get-prototype-of"),f=e("../internals/object-set-prototype-of"),h=e("../internals/set-to-string-tag"),v=e("../internals/create-non-enumerable-property"),b=e("../internals/define-built-in"),g=e("../internals/well-known-symbol"),x=e("../internals/iterators"),y=e("../internals/iterators-core"),E=c.PROPER,N=c.CONFIGURABLE,I=y.IteratorPrototype,P=y.BUGGY_SAFARI_ITERATORS,V=g("iterator"),U=function(){return this};a.exports=function(H,G,Z,W,O,R,C){u(Z,G,W);var _,k,A,T=function(z){if(z===O&&X)return X;if(!P&&z&&z in F)return F[z];switch(z){case"keys":case"values":case"entries":return function(){return new Z(this,z)}}return function(){return new Z(this)}},D=G+" Iterator",B=!1,F=H.prototype,Y=F[V]||F["@@iterator"]||O&&F[O],X=!P&&Y||T(O),re=G==="Array"&&F.entries||Y;if(re&&(_=p(re.call(new H)))!==Object.prototype&&_.next&&(l||p(_)===I||(f?f(_,I):i(_[V])||b(_,V,U)),h(_,D,!0,!0),l&&(x[D]=U)),E&&O==="values"&&Y&&Y.name!=="values"&&(!l&&N?v(F,"name","values"):(B=!0,X=function(){return s(Y,this)})),O)if(k={values:T("values"),keys:R?X:T("keys"),entries:T("entries")},C)for(A in k)(P||B||!(A in F))&&b(F,A,k[A]);else o({target:G,proto:!0,forced:P||B},k);return l&&!C||F[V]===X||b(F,V,X,{name:O}),x[G]=X,k}},{"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/export":259,"../internals/function-call":264,"../internals/function-name":265,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/iterator-create-constructor":295,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-get-prototype-of":313,"../internals/object-set-prototype-of":318,"../internals/set-to-string-tag":331,"../internals/well-known-symbol":357}],297:[function(e,a,n){var o,s,l,c=e("../internals/fails"),i=e("../internals/is-callable"),u=e("../internals/is-object"),p=e("../internals/object-create"),f=e("../internals/object-get-prototype-of"),h=e("../internals/define-built-in"),v=e("../internals/well-known-symbol"),b=e("../internals/is-pure"),g=v("iterator"),x=!1;[].keys&&("next"in(l=[].keys())?(s=f(f(l)))!==Object.prototype&&(o=s):x=!0),!u(o)||c(function(){var y={};return o[g].call(y)!==y})?o={}:b&&(o=p(o)),i(o[g])||h(o,g,function(){return this}),a.exports={IteratorPrototype:o,BUGGY_SAFARI_ITERATORS:x}},{"../internals/define-built-in":245,"../internals/fails":260,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-get-prototype-of":313,"../internals/well-known-symbol":357}],298:[function(e,a,n){arguments[4][276][0].apply(n,arguments)},{dup:276}],299:[function(e,a,n){var o=e("../internals/to-length");a.exports=function(s){return o(s.length)}},{"../internals/to-length":343}],300:[function(e,a,n){var o=e("../internals/function-uncurry-this"),s=e("../internals/fails"),l=e("../internals/is-callable"),c=e("../internals/has-own-property"),i=e("../internals/descriptors"),u=e("../internals/function-name").CONFIGURABLE,p=e("../internals/inspect-source"),f=e("../internals/internal-state"),h=f.enforce,v=f.get,b=String,g=Object.defineProperty,x=o("".slice),y=o("".replace),E=o([].join),N=i&&!s(function(){return g(function(){},"length",{value:8}).length!==8}),I=String(String).split("String"),P=a.exports=function(V,U,H){x(b(U),0,7)==="Symbol("&&(U="["+y(b(U),/^Symbol\(([^)]*)\)/,"$1")+"]"),H&&H.getter&&(U="get "+U),H&&H.setter&&(U="set "+U),(!c(V,"name")||u&&V.name!==U)&&(i?g(V,"name",{value:U,configurable:!0}):V.name=U),N&&H&&c(H,"arity")&&V.length!==H.arity&&g(V,"length",{value:H.arity});try{H&&c(H,"constructor")&&H.constructor?i&&g(V,"prototype",{writable:!1}):V.prototype&&(V.prototype=void 0)}catch{}var G=h(V);return c(G,"source")||(G.source=E(I,typeof U=="string"?U:"")),V};Function.prototype.toString=P(function(){return l(this)&&v(this).source||p(this)},"toString")},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-name":265,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/inspect-source":281,"../internals/internal-state":282,"../internals/is-callable":285}],301:[function(e,a,n){var o=Math.ceil,s=Math.floor;a.exports=Math.trunc||function(l){var c=+l;return(c>0?s:o)(c)}},{}],302:[function(e,a,n){var o,s,l,c,i,u=e("../internals/global"),p=e("../internals/function-bind-context"),f=e("../internals/object-get-own-property-descriptor").f,h=e("../internals/task").set,v=e("../internals/queue"),b=e("../internals/engine-is-ios"),g=e("../internals/engine-is-ios-pebble"),x=e("../internals/engine-is-webos-webkit"),y=e("../internals/engine-is-node"),E=u.MutationObserver||u.WebKitMutationObserver,N=u.document,I=u.process,P=u.Promise,V=f(u,"queueMicrotask"),U=V&&V.value;if(!U){var H=new v,G=function(){var Z,W;for(y&&(Z=I.domain)&&Z.exit();W=H.get();)try{W()}catch(O){throw H.head&&o(),O}Z&&Z.enter()};b||y||x||!E||!N?!g&&P&&P.resolve?((c=P.resolve(void 0)).constructor=P,i=p(c.then,c),o=function(){i(G)}):y?o=function(){I.nextTick(G)}:(h=p(h,u),o=function(){h(G)}):(s=!0,l=N.createTextNode(""),new E(G).observe(l,{characterData:!0}),o=function(){l.data=s=!s}),U=function(Z){H.head||o(),H.add(Z)}}a.exports=U},{"../internals/engine-is-ios":253,"../internals/engine-is-ios-pebble":252,"../internals/engine-is-node":254,"../internals/engine-is-webos-webkit":255,"../internals/function-bind-context":262,"../internals/global":274,"../internals/object-get-own-property-descriptor":309,"../internals/queue":328,"../internals/task":339}],303:[function(e,a,n){var o=e("../internals/a-callable"),s=TypeError,l=function(c){var i,u;this.promise=new c(function(p,f){if(i!==void 0||u!==void 0)throw new s("Bad Promise constructor");i=p,u=f}),this.resolve=o(i),this.reject=o(u)};a.exports.f=function(c){return new l(c)}},{"../internals/a-callable":222}],304:[function(e,a,n){var o=e("../internals/is-regexp"),s=TypeError;a.exports=function(l){if(o(l))throw new s("The method doesn't accept regular expressions");return l}},{"../internals/is-regexp":291}],305:[function(e,a,n){var o=e("../internals/descriptors"),s=e("../internals/function-uncurry-this"),l=e("../internals/function-call"),c=e("../internals/fails"),i=e("../internals/object-keys"),u=e("../internals/object-get-own-property-symbols"),p=e("../internals/object-property-is-enumerable"),f=e("../internals/to-object"),h=e("../internals/indexed-object"),v=Object.assign,b=Object.defineProperty,g=s([].concat);a.exports=!v||c(function(){if(o&&v({b:1},v(b({},"a",{enumerable:!0,get:function(){b(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var x={},y={},E=Symbol("assign detection");return x[E]=7,"abcdefghijklmnopqrst".split("").forEach(function(N){y[N]=N}),v({},x)[E]!==7||i(v({},y)).join("")!=="abcdefghijklmnopqrst"})?function(x,y){for(var E=f(x),N=arguments.length,I=1,P=u.f,V=p.f;N>I;)for(var U,H=h(arguments[I++]),G=P?g(i(H),P(H)):i(H),Z=G.length,W=0;Z>W;)U=G[W++],o&&!l(V,H,U)||(E[U]=H[U]);return E}:v},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/object-get-own-property-symbols":312,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-object":344}],306:[function(e,a,n){var o,s=e("../internals/an-object"),l=e("../internals/object-define-properties"),c=e("../internals/enum-bug-keys"),i=e("../internals/hidden-keys"),u=e("../internals/html"),p=e("../internals/document-create-element"),f=e("../internals/shared-key"),h=f("IE_PROTO"),v=function(){},b=function(y){return"<script>"+y+"<\/script>"},g=function(y){y.write(b("")),y.close();var E=y.parentWindow.Object;return y=null,E},x=function(){try{o=new ActiveXObject("htmlfile")}catch{}var y,E;x=typeof document<"u"?document.domain&&o?g(o):((E=p("iframe")).style.display="none",u.appendChild(E),E.src="javascript:",(y=E.contentWindow.document).open(),y.write(b("document.F=Object")),y.close(),y.F):g(o);for(var N=c.length;N--;)delete x.prototype[c[N]];return x()};i[h]=!0,a.exports=Object.create||function(y,E){var N;return y!==null?(v.prototype=s(y),N=new v,v.prototype=null,N[h]=y):N=x(),E===void 0?N:l.f(N,E)}},{"../internals/an-object":227,"../internals/document-create-element":249,"../internals/enum-bug-keys":258,"../internals/hidden-keys":276,"../internals/html":278,"../internals/object-define-properties":307,"../internals/shared-key":332}],307:[function(e,a,n){var o=e("../internals/descriptors"),s=e("../internals/v8-prototype-define-bug"),l=e("../internals/object-define-property"),c=e("../internals/an-object"),i=e("../internals/to-indexed-object"),u=e("../internals/object-keys");n.f=o&&!s?Object.defineProperties:function(p,f){c(p);for(var h,v=i(f),b=u(f),g=b.length,x=0;g>x;)l.f(p,h=b[x++],v[h]);return p}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/object-define-property":308,"../internals/object-keys":316,"../internals/to-indexed-object":341,"../internals/v8-prototype-define-bug":352}],308:[function(e,a,n){var o=e("../internals/descriptors"),s=e("../internals/ie8-dom-define"),l=e("../internals/v8-prototype-define-bug"),c=e("../internals/an-object"),i=e("../internals/to-property-key"),u=TypeError,p=Object.defineProperty,f=Object.getOwnPropertyDescriptor;n.f=o?l?function(h,v,b){if(c(h),v=i(v),c(b),typeof h=="function"&&v==="prototype"&&"value"in b&&"writable"in b&&!b.writable){var g=f(h,v);g&&g.writable&&(h[v]=b.value,b={configurable:"configurable"in b?b.configurable:g.configurable,enumerable:"enumerable"in b?b.enumerable:g.enumerable,writable:!1})}return p(h,v,b)}:p:function(h,v,b){if(c(h),v=i(v),c(b),s)try{return p(h,v,b)}catch{}if("get"in b||"set"in b)throw new u("Accessors not supported");return"value"in b&&(h[v]=b.value),h}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/ie8-dom-define":279,"../internals/to-property-key":346,"../internals/v8-prototype-define-bug":352}],309:[function(e,a,n){var o=e("../internals/descriptors"),s=e("../internals/function-call"),l=e("../internals/object-property-is-enumerable"),c=e("../internals/create-property-descriptor"),i=e("../internals/to-indexed-object"),u=e("../internals/to-property-key"),p=e("../internals/has-own-property"),f=e("../internals/ie8-dom-define"),h=Object.getOwnPropertyDescriptor;n.f=o?h:function(v,b){if(v=i(v),b=u(b),f)try{return h(v,b)}catch{}if(p(v,b))return c(!s(l.f,v,b),v[b])}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/function-call":264,"../internals/has-own-property":275,"../internals/ie8-dom-define":279,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341,"../internals/to-property-key":346}],310:[function(e,a,n){var o=e("../internals/classof-raw"),s=e("../internals/to-indexed-object"),l=e("../internals/object-get-own-property-names").f,c=e("../internals/array-slice-simple"),i=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];a.exports.f=function(u){return i&&o(u)==="Window"?function(p){try{return l(p)}catch{return c(i)}}(u):l(s(u))}},{"../internals/array-slice-simple":230,"../internals/classof-raw":235,"../internals/object-get-own-property-names":311,"../internals/to-indexed-object":341}],311:[function(e,a,n){var o=e("../internals/object-keys-internal"),s=e("../internals/enum-bug-keys").concat("length","prototype");n.f=Object.getOwnPropertyNames||function(l){return o(l,s)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],312:[function(e,a,n){n.f=Object.getOwnPropertySymbols},{}],313:[function(e,a,n){var o=e("../internals/has-own-property"),s=e("../internals/is-callable"),l=e("../internals/to-object"),c=e("../internals/shared-key"),i=e("../internals/correct-prototype-getter"),u=c("IE_PROTO"),p=Object,f=p.prototype;a.exports=i?p.getPrototypeOf:function(h){var v=l(h);if(o(v,u))return v[u];var b=v.constructor;return s(b)&&v instanceof b?b.prototype:v instanceof p?f:null}},{"../internals/correct-prototype-getter":239,"../internals/has-own-property":275,"../internals/is-callable":285,"../internals/shared-key":332,"../internals/to-object":344}],314:[function(e,a,n){var o=e("../internals/function-uncurry-this");a.exports=o({}.isPrototypeOf)},{"../internals/function-uncurry-this":268}],315:[function(e,a,n){var o=e("../internals/function-uncurry-this"),s=e("../internals/has-own-property"),l=e("../internals/to-indexed-object"),c=e("../internals/array-includes").indexOf,i=e("../internals/hidden-keys"),u=o([].push);a.exports=function(p,f){var h,v=l(p),b=0,g=[];for(h in v)!s(i,h)&&s(v,h)&&u(g,h);for(;f.length>b;)s(v,h=f[b++])&&(~c(g,h)||u(g,h));return g}},{"../internals/array-includes":228,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/to-indexed-object":341}],316:[function(e,a,n){var o=e("../internals/object-keys-internal"),s=e("../internals/enum-bug-keys");a.exports=Object.keys||function(l){return o(l,s)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],317:[function(e,a,n){var o={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,l=s&&!o.call({1:2},1);n.f=l?function(c){var i=s(this,c);return!!i&&i.enumerable}:o},{}],318:[function(e,a,n){var o=e("../internals/function-uncurry-this-accessor"),s=e("../internals/an-object"),l=e("../internals/a-possible-prototype");a.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var c,i=!1,u={};try{(c=o(Object.prototype,"__proto__","set"))(u,[]),i=u instanceof Array}catch{}return function(p,f){return s(p),l(f),i?c(p,f):p.__proto__=f,p}}():void 0)},{"../internals/a-possible-prototype":224,"../internals/an-object":227,"../internals/function-uncurry-this-accessor":266}],319:[function(e,a,n){var o=e("../internals/descriptors"),s=e("../internals/fails"),l=e("../internals/function-uncurry-this"),c=e("../internals/object-get-prototype-of"),i=e("../internals/object-keys"),u=e("../internals/to-indexed-object"),p=l(e("../internals/object-property-is-enumerable").f),f=l([].push),h=o&&s(function(){var b=Object.create(null);return b[2]=2,!p(b,2)}),v=function(b){return function(g){for(var x,y=u(g),E=i(y),N=h&&c(y)===null,I=E.length,P=0,V=[];I>P;)x=E[P++],o&&!(N?x in y:p(y,x))||f(V,b?[x,y[x]]:y[x]);return V}};a.exports={entries:v(!0),values:v(!1)}},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/object-get-prototype-of":313,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341}],320:[function(e,a,n){var o=e("../internals/function-call"),s=e("../internals/is-callable"),l=e("../internals/is-object"),c=TypeError;a.exports=function(i,u){var p,f;if(u==="string"&&s(p=i.toString)&&!l(f=o(p,i))||s(p=i.valueOf)&&!l(f=o(p,i))||u!=="string"&&s(p=i.toString)&&!l(f=o(p,i)))return f;throw new c("Can't convert object to primitive value")}},{"../internals/function-call":264,"../internals/is-callable":285,"../internals/is-object":289}],321:[function(e,a,n){var o=e("../internals/get-built-in"),s=e("../internals/function-uncurry-this"),l=e("../internals/object-get-own-property-names"),c=e("../internals/object-get-own-property-symbols"),i=e("../internals/an-object"),u=s([].concat);a.exports=o("Reflect","ownKeys")||function(p){var f=l.f(i(p)),h=c.f;return h?u(f,h(p)):f}},{"../internals/an-object":227,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-symbols":312}],322:[function(e,a,n){var o=e("../internals/global");a.exports=o},{"../internals/global":274}],323:[function(e,a,n){a.exports=function(o){try{return{error:!1,value:o()}}catch(s){return{error:!0,value:s}}}},{}],324:[function(e,a,n){var o=e("../internals/global"),s=e("../internals/promise-native-constructor"),l=e("../internals/is-callable"),c=e("../internals/is-forced"),i=e("../internals/inspect-source"),u=e("../internals/well-known-symbol"),p=e("../internals/engine-is-browser"),f=e("../internals/engine-is-deno"),h=e("../internals/is-pure"),v=e("../internals/engine-v8-version"),b=s&&s.prototype,g=u("species"),x=!1,y=l(o.PromiseRejectionEvent),E=c("Promise",function(){var N=i(s),I=N!==String(s);if(!I&&v===66||h&&(!b.catch||!b.finally))return!0;if(!v||v<51||!/native code/.test(N)){var P=new s(function(U){U(1)}),V=function(U){U(function(){},function(){})};if((P.constructor={})[g]=V,!(x=P.then(function(){})instanceof V))return!0}return!I&&(p||f)&&!y});a.exports={CONSTRUCTOR:E,REJECTION_EVENT:y,SUBCLASSING:x}},{"../internals/engine-is-browser":250,"../internals/engine-is-deno":251,"../internals/engine-v8-version":257,"../internals/global":274,"../internals/inspect-source":281,"../internals/is-callable":285,"../internals/is-forced":287,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/well-known-symbol":357}],325:[function(e,a,n){var o=e("../internals/global");a.exports=o.Promise},{"../internals/global":274}],326:[function(e,a,n){var o=e("../internals/an-object"),s=e("../internals/is-object"),l=e("../internals/new-promise-capability");a.exports=function(c,i){if(o(c),s(i)&&i.constructor===c)return i;var u=l.f(c);return(0,u.resolve)(i),u.promise}},{"../internals/an-object":227,"../internals/is-object":289,"../internals/new-promise-capability":303}],327:[function(e,a,n){var o=e("../internals/promise-native-constructor"),s=e("../internals/check-correctness-of-iteration"),l=e("../internals/promise-constructor-detection").CONSTRUCTOR;a.exports=l||!s(function(c){o.all(c).then(void 0,function(){})})},{"../internals/check-correctness-of-iteration":234,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],328:[function(e,a,n){var o=function(){this.head=null,this.tail=null};o.prototype={add:function(s){var l={item:s,next:null},c=this.tail;c?c.next=l:this.head=l,this.tail=l},get:function(){var s=this.head;if(s)return(this.head=s.next)===null&&(this.tail=null),s.item}},a.exports=o},{}],329:[function(e,a,n){var o=e("../internals/is-null-or-undefined"),s=TypeError;a.exports=function(l){if(o(l))throw new s("Can't call method on "+l);return l}},{"../internals/is-null-or-undefined":288}],330:[function(e,a,n){var o=e("../internals/get-built-in"),s=e("../internals/define-built-in-accessor"),l=e("../internals/well-known-symbol"),c=e("../internals/descriptors"),i=l("species");a.exports=function(u){var p=o(u);c&&p&&!p[i]&&s(p,i,{configurable:!0,get:function(){return this}})}},{"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],331:[function(e,a,n){var o=e("../internals/object-define-property").f,s=e("../internals/has-own-property"),l=e("../internals/well-known-symbol")("toStringTag");a.exports=function(c,i,u){c&&!u&&(c=c.prototype),c&&!s(c,l)&&o(c,l,{configurable:!0,value:i})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],332:[function(e,a,n){var o=e("../internals/shared"),s=e("../internals/uid"),l=o("keys");a.exports=function(c){return l[c]||(l[c]=s(c))}},{"../internals/shared":334,"../internals/uid":350}],333:[function(e,a,n){var o=e("../internals/global"),s=e("../internals/define-global-property"),l=o["__core-js_shared__"]||s("__core-js_shared__",{});a.exports=l},{"../internals/define-global-property":246,"../internals/global":274}],334:[function(e,a,n){var o=e("../internals/is-pure"),s=e("../internals/shared-store");(a.exports=function(l,c){return s[l]||(s[l]=c!==void 0?c:{})})("versions",[]).push({version:"3.33.0",mode:o?"pure":"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})},{"../internals/is-pure":290,"../internals/shared-store":333}],335:[function(e,a,n){var o=e("../internals/an-object"),s=e("../internals/a-constructor"),l=e("../internals/is-null-or-undefined"),c=e("../internals/well-known-symbol")("species");a.exports=function(i,u){var p,f=o(i).constructor;return f===void 0||l(p=o(f)[c])?u:s(p)}},{"../internals/a-constructor":223,"../internals/an-object":227,"../internals/is-null-or-undefined":288,"../internals/well-known-symbol":357}],336:[function(e,a,n){var o=e("../internals/engine-v8-version"),s=e("../internals/fails"),l=e("../internals/global").String;a.exports=!!Object.getOwnPropertySymbols&&!s(function(){var c=Symbol("symbol detection");return!l(c)||!(Object(c)instanceof Symbol)||!Symbol.sham&&o&&o<41})},{"../internals/engine-v8-version":257,"../internals/fails":260,"../internals/global":274}],337:[function(e,a,n){var o=e("../internals/function-call"),s=e("../internals/get-built-in"),l=e("../internals/well-known-symbol"),c=e("../internals/define-built-in");a.exports=function(){var i=s("Symbol"),u=i&&i.prototype,p=u&&u.valueOf,f=l("toPrimitive");u&&!u[f]&&c(u,f,function(h){return o(p,this)},{arity:1})}},{"../internals/define-built-in":245,"../internals/function-call":264,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],338:[function(e,a,n){var o=e("../internals/symbol-constructor-detection");a.exports=o&&!!Symbol.for&&!!Symbol.keyFor},{"../internals/symbol-constructor-detection":336}],339:[function(e,a,n){var o,s,l,c,i=e("../internals/global"),u=e("../internals/function-apply"),p=e("../internals/function-bind-context"),f=e("../internals/is-callable"),h=e("../internals/has-own-property"),v=e("../internals/fails"),b=e("../internals/html"),g=e("../internals/array-slice"),x=e("../internals/document-create-element"),y=e("../internals/validate-arguments-length"),E=e("../internals/engine-is-ios"),N=e("../internals/engine-is-node"),I=i.setImmediate,P=i.clearImmediate,V=i.process,U=i.Dispatch,H=i.Function,G=i.MessageChannel,Z=i.String,W=0,O={};v(function(){o=i.location});var R=function(A){if(h(O,A)){var T=O[A];delete O[A],T()}},C=function(A){return function(){R(A)}},_=function(A){R(A.data)},k=function(A){i.postMessage(Z(A),o.protocol+"//"+o.host)};I&&P||(I=function(A){y(arguments.length,1);var T=f(A)?A:H(A),D=g(arguments,1);return O[++W]=function(){u(T,void 0,D)},s(W),W},P=function(A){delete O[A]},N?s=function(A){V.nextTick(C(A))}:U&&U.now?s=function(A){U.now(C(A))}:G&&!E?(c=(l=new G).port2,l.port1.onmessage=_,s=p(c.postMessage,c)):i.addEventListener&&f(i.postMessage)&&!i.importScripts&&o&&o.protocol!=="file:"&&!v(k)?(s=k,i.addEventListener("message",_,!1)):s="onreadystatechange"in x("script")?function(A){b.appendChild(x("script")).onreadystatechange=function(){b.removeChild(this),R(A)}}:function(A){setTimeout(C(A),0)}),a.exports={set:I,clear:P}},{"../internals/array-slice":231,"../internals/document-create-element":249,"../internals/engine-is-ios":253,"../internals/engine-is-node":254,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-bind-context":262,"../internals/global":274,"../internals/has-own-property":275,"../internals/html":278,"../internals/is-callable":285,"../internals/validate-arguments-length":353}],340:[function(e,a,n){var o=e("../internals/to-integer-or-infinity"),s=Math.max,l=Math.min;a.exports=function(c,i){var u=o(c);return u<0?s(u+i,0):l(u,i)}},{"../internals/to-integer-or-infinity":342}],341:[function(e,a,n){var o=e("../internals/indexed-object"),s=e("../internals/require-object-coercible");a.exports=function(l){return o(s(l))}},{"../internals/indexed-object":280,"../internals/require-object-coercible":329}],342:[function(e,a,n){var o=e("../internals/math-trunc");a.exports=function(s){var l=+s;return l!=l||l===0?0:o(l)}},{"../internals/math-trunc":301}],343:[function(e,a,n){var o=e("../internals/to-integer-or-infinity"),s=Math.min;a.exports=function(l){return l>0?s(o(l),9007199254740991):0}},{"../internals/to-integer-or-infinity":342}],344:[function(e,a,n){var o=e("../internals/require-object-coercible"),s=Object;a.exports=function(l){return s(o(l))}},{"../internals/require-object-coercible":329}],345:[function(e,a,n){var o=e("../internals/function-call"),s=e("../internals/is-object"),l=e("../internals/is-symbol"),c=e("../internals/get-method"),i=e("../internals/ordinary-to-primitive"),u=e("../internals/well-known-symbol"),p=TypeError,f=u("toPrimitive");a.exports=function(h,v){if(!s(h)||l(h))return h;var b,g=c(h,f);if(g){if(v===void 0&&(v="default"),b=o(g,h,v),!s(b)||l(b))return b;throw new p("Can't convert object to primitive value")}return v===void 0&&(v="number"),i(h,v)}},{"../internals/function-call":264,"../internals/get-method":273,"../internals/is-object":289,"../internals/is-symbol":292,"../internals/ordinary-to-primitive":320,"../internals/well-known-symbol":357}],346:[function(e,a,n){var o=e("../internals/to-primitive"),s=e("../internals/is-symbol");a.exports=function(l){var c=o(l,"string");return s(c)?c:c+""}},{"../internals/is-symbol":292,"../internals/to-primitive":345}],347:[function(e,a,n){var o={};o[e("../internals/well-known-symbol")("toStringTag")]="z",a.exports=String(o)==="[object z]"},{"../internals/well-known-symbol":357}],348:[function(e,a,n){var o=e("../internals/classof"),s=String;a.exports=function(l){if(o(l)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return s(l)}},{"../internals/classof":236}],349:[function(e,a,n){var o=String;a.exports=function(s){try{return o(s)}catch{return"Object"}}},{}],350:[function(e,a,n){var o=e("../internals/function-uncurry-this"),s=0,l=Math.random(),c=o(1 .toString);a.exports=function(i){return"Symbol("+(i===void 0?"":i)+")_"+c(++s+l,36)}},{"../internals/function-uncurry-this":268}],351:[function(e,a,n){var o=e("../internals/symbol-constructor-detection");a.exports=o&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/symbol-constructor-detection":336}],352:[function(e,a,n){var o=e("../internals/descriptors"),s=e("../internals/fails");a.exports=o&&s(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},{"../internals/descriptors":247,"../internals/fails":260}],353:[function(e,a,n){var o=TypeError;a.exports=function(s,l){if(s<l)throw new o("Not enough arguments");return s}},{}],354:[function(e,a,n){var o=e("../internals/global"),s=e("../internals/is-callable"),l=o.WeakMap;a.exports=s(l)&&/native code/.test(String(l))},{"../internals/global":274,"../internals/is-callable":285}],355:[function(e,a,n){var o=e("../internals/path"),s=e("../internals/has-own-property"),l=e("../internals/well-known-symbol-wrapped"),c=e("../internals/object-define-property").f;a.exports=function(i){var u=o.Symbol||(o.Symbol={});s(u,i)||c(u,i,{value:l.f(i)})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/path":322,"../internals/well-known-symbol-wrapped":356}],356:[function(e,a,n){var o=e("../internals/well-known-symbol");n.f=o},{"../internals/well-known-symbol":357}],357:[function(e,a,n){var o=e("../internals/global"),s=e("../internals/shared"),l=e("../internals/has-own-property"),c=e("../internals/uid"),i=e("../internals/symbol-constructor-detection"),u=e("../internals/use-symbol-as-uid"),p=o.Symbol,f=s("wks"),h=u?p.for||p:p&&p.withoutSetter||c;a.exports=function(v){return l(f,v)||(f[v]=i&&l(p,v)?p[v]:h("Symbol."+v)),f[v]}},{"../internals/global":274,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-constructor-detection":336,"../internals/uid":350,"../internals/use-symbol-as-uid":351}],358:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/array-iteration").findIndex,l=e("../internals/add-to-unscopables"),c=!0;"findIndex"in[]&&Array(1).findIndex(function(){c=!1}),o({target:"Array",proto:!0,forced:c},{findIndex:function(i){return s(this,i,arguments.length>1?arguments[1]:void 0)}}),l("findIndex")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],359:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/array-iteration").find,l=e("../internals/add-to-unscopables"),c=!0;"find"in[]&&Array(1).find(function(){c=!1}),o({target:"Array",proto:!0,forced:c},{find:function(i){return s(this,i,arguments.length>1?arguments[1]:void 0)}}),l("find")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],360:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/array-includes").includes,l=e("../internals/fails"),c=e("../internals/add-to-unscopables");o({target:"Array",proto:!0,forced:l(function(){return!Array(1).includes()})},{includes:function(i){return s(this,i,arguments.length>1?arguments[1]:void 0)}}),c("includes")},{"../internals/add-to-unscopables":225,"../internals/array-includes":228,"../internals/export":259,"../internals/fails":260}],361:[function(e,a,n){var o=e("../internals/to-indexed-object"),s=e("../internals/add-to-unscopables"),l=e("../internals/iterators"),c=e("../internals/internal-state"),i=e("../internals/object-define-property").f,u=e("../internals/iterator-define"),p=e("../internals/create-iter-result-object"),f=e("../internals/is-pure"),h=e("../internals/descriptors"),v=c.set,b=c.getterFor("Array Iterator");a.exports=u(Array,"Array",function(x,y){v(this,{type:"Array Iterator",target:o(x),index:0,kind:y})},function(){var x=b(this),y=x.target,E=x.kind,N=x.index++;if(!y||N>=y.length)return x.target=void 0,p(void 0,!0);switch(E){case"keys":return p(N,!1);case"values":return p(y[N],!1)}return p([N,y[N]],!1)},"values");var g=l.Arguments=l.Array;if(s("keys"),s("values"),s("entries"),!f&&h&&g.name!=="values")try{i(g,"name",{value:"values"})}catch{}},{"../internals/add-to-unscopables":225,"../internals/create-iter-result-object":240,"../internals/descriptors":247,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/iterator-define":296,"../internals/iterators":298,"../internals/object-define-property":308,"../internals/to-indexed-object":341}],362:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/get-built-in"),l=e("../internals/function-apply"),c=e("../internals/function-call"),i=e("../internals/function-uncurry-this"),u=e("../internals/fails"),p=e("../internals/is-callable"),f=e("../internals/is-symbol"),h=e("../internals/array-slice"),v=e("../internals/get-json-replacer-function"),b=e("../internals/symbol-constructor-detection"),g=String,x=s("JSON","stringify"),y=i(/./.exec),E=i("".charAt),N=i("".charCodeAt),I=i("".replace),P=i(1 .toString),V=/[\uD800-\uDFFF]/g,U=/^[\uD800-\uDBFF]$/,H=/^[\uDC00-\uDFFF]$/,G=!b||u(function(){var R=s("Symbol")("stringify detection");return x([R])!=="[null]"||x({a:R})!=="{}"||x(Object(R))!=="{}"}),Z=u(function(){return x("\uDF06\uD834")!=='"\\udf06\\ud834"'||x("\uDEAD")!=='"\\udead"'}),W=function(R,C){var _=h(arguments),k=v(C);if(p(k)||R!==void 0&&!f(R))return _[1]=function(A,T){if(p(k)&&(T=c(k,this,g(A),T)),!f(T))return T},l(x,null,_)},O=function(R,C,_){var k=E(_,C-1),A=E(_,C+1);return y(U,R)&&!y(H,A)||y(H,R)&&!y(U,k)?"\\u"+P(N(R,0),16):R};x&&o({target:"JSON",stat:!0,arity:3,forced:G||Z},{stringify:function(R,C,_){var k=h(arguments),A=l(G?W:x,null,k);return Z&&typeof A=="string"?I(A,V,O):A}})},{"../internals/array-slice":231,"../internals/export":259,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/get-json-replacer-function":272,"../internals/is-callable":285,"../internals/is-symbol":292,"../internals/symbol-constructor-detection":336}],363:[function(e,a,n){e("../internals/export")({target:"Number",stat:!0},{isNaN:function(o){return o!=o}})},{"../internals/export":259}],364:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/object-assign");o({target:"Object",stat:!0,arity:2,forced:Object.assign!==s},{assign:s})},{"../internals/export":259,"../internals/object-assign":305}],365:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/symbol-constructor-detection"),l=e("../internals/fails"),c=e("../internals/object-get-own-property-symbols"),i=e("../internals/to-object");o({target:"Object",stat:!0,forced:!s||l(function(){c.f(1)})},{getOwnPropertySymbols:function(u){var p=c.f;return p?p(i(u)):[]}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-get-own-property-symbols":312,"../internals/symbol-constructor-detection":336,"../internals/to-object":344}],366:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/to-object"),l=e("../internals/object-keys");o({target:"Object",stat:!0,forced:e("../internals/fails")(function(){l(1)})},{keys:function(c){return l(s(c))}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-keys":316,"../internals/to-object":344}],367:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/object-to-array").values;o({target:"Object",stat:!0},{values:function(l){return s(l)}})},{"../internals/export":259,"../internals/object-to-array":319}],368:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/function-call"),l=e("../internals/a-callable"),c=e("../internals/new-promise-capability"),i=e("../internals/perform"),u=e("../internals/iterate");o({target:"Promise",stat:!0,forced:e("../internals/promise-statics-incorrect-iteration")},{all:function(p){var f=this,h=c.f(f),v=h.resolve,b=h.reject,g=i(function(){var x=l(f.resolve),y=[],E=0,N=1;u(p,function(I){var P=E++,V=!1;N++,s(x,f,I).then(function(U){V||(V=!0,y[P]=U,--N||v(y))},b)}),--N||v(y)});return g.error&&b(g.value),h.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],369:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/is-pure"),l=e("../internals/promise-constructor-detection").CONSTRUCTOR,c=e("../internals/promise-native-constructor"),i=e("../internals/get-built-in"),u=e("../internals/is-callable"),p=e("../internals/define-built-in"),f=c&&c.prototype;if(o({target:"Promise",proto:!0,forced:l,real:!0},{catch:function(v){return this.then(void 0,v)}}),!s&&u(c)){var h=i("Promise").prototype.catch;f.catch!==h&&p(f,"catch",h,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],370:[function(e,a,n){var o,s,l,c=e("../internals/export"),i=e("../internals/is-pure"),u=e("../internals/engine-is-node"),p=e("../internals/global"),f=e("../internals/function-call"),h=e("../internals/define-built-in"),v=e("../internals/object-set-prototype-of"),b=e("../internals/set-to-string-tag"),g=e("../internals/set-species"),x=e("../internals/a-callable"),y=e("../internals/is-callable"),E=e("../internals/is-object"),N=e("../internals/an-instance"),I=e("../internals/species-constructor"),P=e("../internals/task").set,V=e("../internals/microtask"),U=e("../internals/host-report-errors"),H=e("../internals/perform"),G=e("../internals/queue"),Z=e("../internals/internal-state"),W=e("../internals/promise-native-constructor"),O=e("../internals/promise-constructor-detection"),R=e("../internals/new-promise-capability"),C=O.CONSTRUCTOR,_=O.REJECTION_EVENT,k=O.SUBCLASSING,A=Z.getterFor("Promise"),T=Z.set,D=W&&W.prototype,B=W,F=D,Y=p.TypeError,X=p.document,re=p.process,z=R.f,ee=z,L=!!(X&&X.createEvent&&p.dispatchEvent),M=function(he){var ke;return!(!E(he)||!y(ke=he.then))&&ke},K=function(he,ke){var pe,Ce,Me,Ie=ke.value,Ye=ke.state===1,at=Ye?he.ok:he.fail,rt=he.resolve,it=he.reject,et=he.domain;try{at?(Ye||(ke.rejection===2&&fe(ke),ke.rejection=1),at===!0?pe=Ie:(et&&et.enter(),pe=at(Ie),et&&(et.exit(),Me=!0)),pe===he.promise?it(new Y("Promise-chain cycle")):(Ce=M(pe))?f(Ce,pe,rt,it):rt(pe)):it(Ie)}catch(st){et&&!Me&&et.exit(),it(st)}},se=function(he,ke){he.notified||(he.notified=!0,V(function(){for(var pe,Ce=he.reactions;pe=Ce.get();)K(pe,he);he.notified=!1,ke&&!he.rejection&&ae(he)}))},te=function(he,ke,pe){var Ce,Me;L?((Ce=X.createEvent("Event")).promise=ke,Ce.reason=pe,Ce.initEvent(he,!1,!0),p.dispatchEvent(Ce)):Ce={promise:ke,reason:pe},!_&&(Me=p["on"+he])?Me(Ce):he==="unhandledrejection"&&U("Unhandled promise rejection",pe)},ae=function(he){f(P,p,function(){var ke,pe=he.facade,Ce=he.value;if(Q(he)&&(ke=H(function(){u?re.emit("unhandledRejection",Ce,pe):te("unhandledrejection",pe,Ce)}),he.rejection=u||Q(he)?2:1,ke.error))throw ke.value})},Q=function(he){return he.rejection!==1&&!he.parent},fe=function(he){f(P,p,function(){var ke=he.facade;u?re.emit("rejectionHandled",ke):te("rejectionhandled",ke,he.value)})},le=function(he,ke,pe){return function(Ce){he(ke,Ce,pe)}},ne=function(he,ke,pe){he.done||(he.done=!0,pe&&(he=pe),he.value=ke,he.state=2,se(he,!0))},ue=function(he,ke,pe){if(!he.done){he.done=!0,pe&&(he=pe);try{if(he.facade===ke)throw new Y("Promise can't be resolved itself");var Ce=M(ke);Ce?V(function(){var Me={done:!1};try{f(Ce,ke,le(ue,Me,he),le(ne,Me,he))}catch(Ie){ne(Me,Ie,he)}}):(he.value=ke,he.state=1,se(he,!1))}catch(Me){ne({done:!1},Me,he)}}};if(C&&(F=(B=function(he){N(this,F),x(he),f(o,this);var ke=A(this);try{he(le(ue,ke),le(ne,ke))}catch(pe){ne(ke,pe)}}).prototype,(o=function(he){T(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new G,rejection:!1,state:0,value:void 0})}).prototype=h(F,"then",function(he,ke){var pe=A(this),Ce=z(I(this,B));return pe.parent=!0,Ce.ok=!y(he)||he,Ce.fail=y(ke)&&ke,Ce.domain=u?re.domain:void 0,pe.state===0?pe.reactions.add(Ce):V(function(){K(Ce,pe)}),Ce.promise}),s=function(){var he=new o,ke=A(he);this.promise=he,this.resolve=le(ue,ke),this.reject=le(ne,ke)},R.f=z=function(he){return he===B||he===void 0?new s(he):ee(he)},!i&&y(W)&&D!==Object.prototype)){l=D.then,k||h(D,"then",function(he,ke){var pe=this;return new B(function(Ce,Me){f(l,pe,Ce,Me)}).then(he,ke)},{unsafe:!0});try{delete D.constructor}catch{}v&&v(D,F)}c({global:!0,constructor:!0,wrap:!0,forced:C},{Promise:B}),b(B,"Promise",!1,!0),g("Promise")},{"../internals/a-callable":222,"../internals/an-instance":226,"../internals/define-built-in":245,"../internals/engine-is-node":254,"../internals/export":259,"../internals/function-call":264,"../internals/global":274,"../internals/host-report-errors":277,"../internals/internal-state":282,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/microtask":302,"../internals/new-promise-capability":303,"../internals/object-set-prototype-of":318,"../internals/perform":323,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/queue":328,"../internals/set-species":330,"../internals/set-to-string-tag":331,"../internals/species-constructor":335,"../internals/task":339}],371:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/is-pure"),l=e("../internals/promise-native-constructor"),c=e("../internals/fails"),i=e("../internals/get-built-in"),u=e("../internals/is-callable"),p=e("../internals/species-constructor"),f=e("../internals/promise-resolve"),h=e("../internals/define-built-in"),v=l&&l.prototype;if(o({target:"Promise",proto:!0,real:!0,forced:!!l&&c(function(){v.finally.call({then:function(){}},function(){})})},{finally:function(g){var x=p(this,i("Promise")),y=u(g);return this.then(y?function(E){return f(x,g()).then(function(){return E})}:g,y?function(E){return f(x,g()).then(function(){throw E})}:g)}}),!s&&u(l)){var b=i("Promise").prototype.finally;v.finally!==b&&h(v,"finally",b,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/fails":260,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326,"../internals/species-constructor":335}],372:[function(e,a,n){e("../modules/es.promise.constructor"),e("../modules/es.promise.all"),e("../modules/es.promise.catch"),e("../modules/es.promise.race"),e("../modules/es.promise.reject"),e("../modules/es.promise.resolve")},{"../modules/es.promise.all":368,"../modules/es.promise.catch":369,"../modules/es.promise.constructor":370,"../modules/es.promise.race":373,"../modules/es.promise.reject":374,"../modules/es.promise.resolve":375}],373:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/function-call"),l=e("../internals/a-callable"),c=e("../internals/new-promise-capability"),i=e("../internals/perform"),u=e("../internals/iterate");o({target:"Promise",stat:!0,forced:e("../internals/promise-statics-incorrect-iteration")},{race:function(p){var f=this,h=c.f(f),v=h.reject,b=i(function(){var g=l(f.resolve);u(p,function(x){s(g,f,x).then(h.resolve,v)})});return b.error&&v(b.value),h.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],374:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/function-call"),l=e("../internals/new-promise-capability");o({target:"Promise",stat:!0,forced:e("../internals/promise-constructor-detection").CONSTRUCTOR},{reject:function(c){var i=l.f(this);return s(i.reject,void 0,c),i.promise}})},{"../internals/export":259,"../internals/function-call":264,"../internals/new-promise-capability":303,"../internals/promise-constructor-detection":324}],375:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/get-built-in"),l=e("../internals/is-pure"),c=e("../internals/promise-native-constructor"),i=e("../internals/promise-constructor-detection").CONSTRUCTOR,u=e("../internals/promise-resolve"),p=s("Promise"),f=l&&!i;o({target:"Promise",stat:!0,forced:l||i},{resolve:function(h){return u(f&&this===p?c:this,h)}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326}],376:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/function-uncurry-this"),l=e("../internals/to-absolute-index"),c=RangeError,i=String.fromCharCode,u=String.fromCodePoint,p=s([].join);o({target:"String",stat:!0,arity:1,forced:!!u&&u.length!==1},{fromCodePoint:function(f){for(var h,v=[],b=arguments.length,g=0;b>g;){if(h=+arguments[g++],l(h,1114111)!==h)throw new c(h+" is not a valid code point");v[g]=h<65536?i(h):i(55296+((h-=65536)>>10),h%1024+56320)}return p(v,"")}})},{"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/to-absolute-index":340}],377:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/function-uncurry-this"),l=e("../internals/not-a-regexp"),c=e("../internals/require-object-coercible"),i=e("../internals/to-string"),u=e("../internals/correct-is-regexp-logic"),p=s("".indexOf);o({target:"String",proto:!0,forced:!u("includes")},{includes:function(f){return!!~p(i(c(this)),i(l(f)),arguments.length>1?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":238,"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/not-a-regexp":304,"../internals/require-object-coercible":329,"../internals/to-string":348}],378:[function(e,a,n){e("../internals/well-known-symbol-define")("asyncIterator")},{"../internals/well-known-symbol-define":355}],379:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/global"),l=e("../internals/function-call"),c=e("../internals/function-uncurry-this"),i=e("../internals/is-pure"),u=e("../internals/descriptors"),p=e("../internals/symbol-constructor-detection"),f=e("../internals/fails"),h=e("../internals/has-own-property"),v=e("../internals/object-is-prototype-of"),b=e("../internals/an-object"),g=e("../internals/to-indexed-object"),x=e("../internals/to-property-key"),y=e("../internals/to-string"),E=e("../internals/create-property-descriptor"),N=e("../internals/object-create"),I=e("../internals/object-keys"),P=e("../internals/object-get-own-property-names"),V=e("../internals/object-get-own-property-names-external"),U=e("../internals/object-get-own-property-symbols"),H=e("../internals/object-get-own-property-descriptor"),G=e("../internals/object-define-property"),Z=e("../internals/object-define-properties"),W=e("../internals/object-property-is-enumerable"),O=e("../internals/define-built-in"),R=e("../internals/define-built-in-accessor"),C=e("../internals/shared"),_=e("../internals/shared-key"),k=e("../internals/hidden-keys"),A=e("../internals/uid"),T=e("../internals/well-known-symbol"),D=e("../internals/well-known-symbol-wrapped"),B=e("../internals/well-known-symbol-define"),F=e("../internals/symbol-define-to-primitive"),Y=e("../internals/set-to-string-tag"),X=e("../internals/internal-state"),re=e("../internals/array-iteration").forEach,z=_("hidden"),ee=X.set,L=X.getterFor("Symbol"),M=Object.prototype,K=s.Symbol,se=K&&K.prototype,te=s.RangeError,ae=s.TypeError,Q=s.QObject,fe=H.f,le=G.f,ne=V.f,ue=W.f,he=c([].push),ke=C("symbols"),pe=C("op-symbols"),Ce=C("wks"),Me=!Q||!Q.prototype||!Q.prototype.findChild,Ie=function(Je,nt,ct){var _t=fe(M,nt);_t&&delete M[nt],le(Je,nt,ct),_t&&Je!==M&&le(M,nt,_t)},Ye=u&&f(function(){return N(le({},"a",{get:function(){return le(this,"a",{value:7}).a}})).a!==7})?Ie:le,at=function(Je,nt){var ct=ke[Je]=N(se);return ee(ct,{type:"Symbol",tag:Je,description:nt}),u||(ct.description=nt),ct},rt=function(Je,nt,ct){Je===M&&rt(pe,nt,ct),b(Je);var _t=x(nt);return b(ct),h(ke,_t)?(ct.enumerable?(h(Je,z)&&Je[z][_t]&&(Je[z][_t]=!1),ct=N(ct,{enumerable:E(0,!1)})):(h(Je,z)||le(Je,z,E(1,{})),Je[z][_t]=!0),Ye(Je,_t,ct)):le(Je,_t,ct)},it=function(Je,nt){b(Je);var ct=g(nt),_t=I(ct).concat(ht(ct));return re(_t,function(mt){u&&!l(et,ct,mt)||rt(Je,mt,ct[mt])}),Je},et=function(Je){var nt=x(Je),ct=l(ue,this,nt);return!(this===M&&h(ke,nt)&&!h(pe,nt))&&(!(ct||!h(this,nt)||!h(ke,nt)||h(this,z)&&this[z][nt])||ct)},st=function(Je,nt){var ct=g(Je),_t=x(nt);if(ct!==M||!h(ke,_t)||h(pe,_t)){var mt=fe(ct,_t);return!mt||!h(ke,_t)||h(ct,z)&&ct[z][_t]||(mt.enumerable=!0),mt}},je=function(Je){var nt=ne(g(Je)),ct=[];return re(nt,function(_t){h(ke,_t)||h(k,_t)||he(ct,_t)}),ct},ht=function(Je){var nt=Je===M,ct=ne(nt?pe:g(Je)),_t=[];return re(ct,function(mt){!h(ke,mt)||nt&&!h(M,mt)||he(_t,ke[mt])}),_t};p||(O(se=(K=function(){if(v(se,this))throw new ae("Symbol is not a constructor");var Je=arguments.length&&arguments[0]!==void 0?y(arguments[0]):void 0,nt=A(Je),ct=function(_t){this===M&&l(ct,pe,_t),h(this,z)&&h(this[z],nt)&&(this[z][nt]=!1);var mt=E(1,_t);try{Ye(this,nt,mt)}catch(gt){if(!(gt instanceof te))throw gt;Ie(this,nt,mt)}};return u&&Me&&Ye(M,nt,{configurable:!0,set:ct}),at(nt,Je)}).prototype,"toString",function(){return L(this).tag}),O(K,"withoutSetter",function(Je){return at(A(Je),Je)}),W.f=et,G.f=rt,Z.f=it,H.f=st,P.f=V.f=je,U.f=ht,D.f=function(Je){return at(T(Je),Je)},u&&(R(se,"description",{configurable:!0,get:function(){return L(this).description}}),i||O(M,"propertyIsEnumerable",et,{unsafe:!0}))),o({global:!0,constructor:!0,wrap:!0,forced:!p,sham:!p},{Symbol:K}),re(I(Ce),function(Je){B(Je)}),o({target:"Symbol",stat:!0,forced:!p},{useSetter:function(){Me=!0},useSimple:function(){Me=!1}}),o({target:"Object",stat:!0,forced:!p,sham:!u},{create:function(Je,nt){return nt===void 0?N(Je):it(N(Je),nt)},defineProperty:rt,defineProperties:it,getOwnPropertyDescriptor:st}),o({target:"Object",stat:!0,forced:!p},{getOwnPropertyNames:je}),F(),Y(K,"Symbol"),k[z]=!0},{"../internals/an-object":227,"../internals/array-iteration":229,"../internals/create-property-descriptor":242,"../internals/define-built-in":245,"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/export":259,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-define-properties":307,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-names-external":310,"../internals/object-get-own-property-symbols":312,"../internals/object-is-prototype-of":314,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/set-to-string-tag":331,"../internals/shared":334,"../internals/shared-key":332,"../internals/symbol-constructor-detection":336,"../internals/symbol-define-to-primitive":337,"../internals/to-indexed-object":341,"../internals/to-property-key":346,"../internals/to-string":348,"../internals/uid":350,"../internals/well-known-symbol":357,"../internals/well-known-symbol-define":355,"../internals/well-known-symbol-wrapped":356}],380:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/get-built-in"),l=e("../internals/has-own-property"),c=e("../internals/to-string"),i=e("../internals/shared"),u=e("../internals/symbol-registry-detection"),p=i("string-to-symbol-registry"),f=i("symbol-to-string-registry");o({target:"Symbol",stat:!0,forced:!u},{for:function(h){var v=c(h);if(l(p,v))return p[v];var b=s("Symbol")(v);return p[v]=b,f[b]=v,b}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/to-string":348}],381:[function(e,a,n){e("../modules/es.symbol.constructor"),e("../modules/es.symbol.for"),e("../modules/es.symbol.key-for"),e("../modules/es.json.stringify"),e("../modules/es.object.get-own-property-symbols")},{"../modules/es.json.stringify":362,"../modules/es.object.get-own-property-symbols":365,"../modules/es.symbol.constructor":379,"../modules/es.symbol.for":380,"../modules/es.symbol.key-for":382}],382:[function(e,a,n){var o=e("../internals/export"),s=e("../internals/has-own-property"),l=e("../internals/is-symbol"),c=e("../internals/try-to-string"),i=e("../internals/shared"),u=e("../internals/symbol-registry-detection"),p=i("symbol-to-string-registry");o({target:"Symbol",stat:!0,forced:!u},{keyFor:function(f){if(!l(f))throw new TypeError(c(f)+" is not a symbol");if(s(p,f))return p[f]}})},{"../internals/export":259,"../internals/has-own-property":275,"../internals/is-symbol":292,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/try-to-string":349}],383:[function(e,a,n){function o(s){return Object.prototype.toString.call(s)}n.isArray=function(s){return Array.isArray?Array.isArray(s):o(s)==="[object Array]"},n.isBoolean=function(s){return typeof s=="boolean"},n.isNull=function(s){return s===null},n.isNullOrUndefined=function(s){return s==null},n.isNumber=function(s){return typeof s=="number"},n.isString=function(s){return typeof s=="string"},n.isSymbol=function(s){return typeof s=="symbol"},n.isUndefined=function(s){return s===void 0},n.isRegExp=function(s){return o(s)==="[object RegExp]"},n.isObject=function(s){return typeof s=="object"&&s!==null},n.isDate=function(s){return o(s)==="[object Date]"},n.isError=function(s){return o(s)==="[object Error]"||s instanceof Error},n.isFunction=function(s){return typeof s=="function"},n.isPrimitive=function(s){return s===null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||typeof s=="symbol"||s===void 0},n.isBuffer=e("buffer").Buffer.isBuffer},{buffer:220}],384:[function(e,a,n){(function(o){(function(){var s=e("elliptic"),l=e("bn.js");a.exports=function(p){return new i(p)};var c={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function i(p){this.curveType=c[p],this.curveType||(this.curveType={name:p}),this.curve=new s.ec(this.curveType.name),this.keys=void 0}function u(p,f,h){Array.isArray(p)||(p=p.toArray());var v=new o(p);if(h&&v.length<h){var b=new o(h-v.length);b.fill(0),v=o.concat([b,v])}return f?v.toString(f):v}c.p224=c.secp224r1,c.p256=c.secp256r1=c.prime256v1,c.p192=c.secp192r1=c.prime192v1,c.p384=c.secp384r1,c.p521=c.secp521r1,i.prototype.generateKeys=function(p,f){return this.keys=this.curve.genKeyPair(),this.getPublicKey(p,f)},i.prototype.computeSecret=function(p,f,h){return f=f||"utf8",o.isBuffer(p)||(p=new o(p,f)),u(this.curve.keyFromPublic(p).getPublic().mul(this.keys.getPrivate()).getX(),h,this.curveType.byteLength)},i.prototype.getPublicKey=function(p,f){var h=this.keys.getPublic(f==="compressed",!0);return f==="hybrid"&&(h[h.length-1]%2?h[0]=7:h[0]=6),u(h,p)},i.prototype.getPrivateKey=function(p){return u(this.keys.getPrivate(),p)},i.prototype.setPublicKey=function(p,f){return f=f||"utf8",o.isBuffer(p)||(p=new o(p,f)),this.keys._importPublic(p),this},i.prototype.setPrivateKey=function(p,f){f=f||"utf8",o.isBuffer(p)||(p=new o(p,f));var h=new l(p);return h=h.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(h),this}}).call(this)}).call(this,e("buffer").Buffer)},{"bn.js":385,buffer:220,elliptic:405}],385:[function(e,a,n){arguments[4][184][0].apply(n,arguments)},{buffer:188,dup:184}],386:[function(e,a,n){var o=e("inherits"),s=e("md5.js"),l=e("ripemd160"),c=e("sha.js"),i=e("cipher-base");function u(p){i.call(this,"digest"),this._hash=p}o(u,i),u.prototype._update=function(p){this._hash.update(p)},u.prototype._final=function(){return this._hash.digest()},a.exports=function(p){return(p=p.toLowerCase())==="md5"?new s:p==="rmd160"||p==="ripemd160"?new l:new u(c(p))}},{"cipher-base":221,inherits:440,"md5.js":450,ripemd160:493,"sha.js":498}],387:[function(e,a,n){var o=e("md5.js");a.exports=function(s){return new o().update(s).digest()}},{"md5.js":450}],388:[function(e,a,n){var o=e("inherits"),s=e("./legacy"),l=e("cipher-base"),c=e("safe-buffer").Buffer,i=e("create-hash/md5"),u=e("ripemd160"),p=e("sha.js"),f=c.alloc(128);function h(v,b){l.call(this,"digest"),typeof b=="string"&&(b=c.from(b));var g=v==="sha512"||v==="sha384"?128:64;this._alg=v,this._key=b,b.length>g?b=(v==="rmd160"?new u:p(v)).update(b).digest():b.length<g&&(b=c.concat([b,f],g));for(var x=this._ipad=c.allocUnsafe(g),y=this._opad=c.allocUnsafe(g),E=0;E<g;E++)x[E]=54^b[E],y[E]=92^b[E];this._hash=v==="rmd160"?new u:p(v),this._hash.update(x)}o(h,l),h.prototype._update=function(v){this._hash.update(v)},h.prototype._final=function(){var v=this._hash.digest();return(this._alg==="rmd160"?new u:p(this._alg)).update(this._opad).update(v).digest()},a.exports=function(v,b){return(v=v.toLowerCase())==="rmd160"||v==="ripemd160"?new h("rmd160",b):v==="md5"?new s(i,b):new h(v,b)}},{"./legacy":389,"cipher-base":221,"create-hash/md5":387,inherits:440,ripemd160:493,"safe-buffer":494,"sha.js":498}],389:[function(e,a,n){var o=e("inherits"),s=e("safe-buffer").Buffer,l=e("cipher-base"),c=s.alloc(128);function i(u,p){l.call(this,"digest"),typeof p=="string"&&(p=s.from(p)),this._alg=u,this._key=p,p.length>64?p=u(p):p.length<64&&(p=s.concat([p,c],64));for(var f=this._ipad=s.allocUnsafe(64),h=this._opad=s.allocUnsafe(64),v=0;v<64;v++)f[v]=54^p[v],h[v]=92^p[v];this._hash=[f]}o(i,l),i.prototype._update=function(u){this._hash.push(u)},i.prototype._final=function(){var u=this._alg(s.concat(this._hash));return this._alg(s.concat([this._opad,u]))},a.exports=i},{"cipher-base":221,inherits:440,"safe-buffer":494}],390:[function(e,a,n){n.randomBytes=n.rng=n.pseudoRandomBytes=n.prng=e("randombytes"),n.createHash=n.Hash=e("create-hash"),n.createHmac=n.Hmac=e("create-hmac");var o=e("browserify-sign/algos"),s=Object.keys(o),l=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(s);n.getHashes=function(){return l};var c=e("pbkdf2");n.pbkdf2=c.pbkdf2,n.pbkdf2Sync=c.pbkdf2Sync;var i=e("browserify-cipher");n.Cipher=i.Cipher,n.createCipher=i.createCipher,n.Cipheriv=i.Cipheriv,n.createCipheriv=i.createCipheriv,n.Decipher=i.Decipher,n.createDecipher=i.createDecipher,n.Decipheriv=i.Decipheriv,n.createDecipheriv=i.createDecipheriv,n.getCiphers=i.getCiphers,n.listCiphers=i.listCiphers;var u=e("diffie-hellman");n.DiffieHellmanGroup=u.DiffieHellmanGroup,n.createDiffieHellmanGroup=u.createDiffieHellmanGroup,n.getDiffieHellman=u.getDiffieHellman,n.createDiffieHellman=u.createDiffieHellman,n.DiffieHellman=u.DiffieHellman;var p=e("browserify-sign");n.createSign=p.createSign,n.Sign=p.Sign,n.createVerify=p.createVerify,n.Verify=p.Verify,n.createECDH=e("create-ecdh");var f=e("public-encrypt");n.publicEncrypt=f.publicEncrypt,n.privateEncrypt=f.privateEncrypt,n.publicDecrypt=f.publicDecrypt,n.privateDecrypt=f.privateDecrypt;var h=e("randomfill");n.randomFill=h.randomFill,n.randomFillSync=h.randomFillSync,n.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},n.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":206,"browserify-sign":213,"browserify-sign/algos":210,"create-ecdh":384,"create-hash":386,"create-hmac":388,"diffie-hellman":400,pbkdf2:460,"public-encrypt":468,randombytes:475,randomfill:476}],391:[function(e,a,n){(function(o,s){typeof n=="object"&&a!==void 0?a.exports=s():(o=typeof globalThis<"u"?globalThis:o||self).dayjs=s()})(void 0,function(){var o=6e4,s=36e5,l="millisecond",c="second",i="minute",u="hour",p="day",f="week",h="month",v="quarter",b="year",g="date",x="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,E=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,N={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(_){var k=["th","st","nd","rd"],A=_%100;return"["+_+(k[(A-20)%10]||k[A]||k[0])+"]"}},I=function(_,k,A){var T=String(_);return!T||T.length>=k?_:""+Array(k+1-T.length).join(A)+_},P={s:I,z:function(_){var k=-_.utcOffset(),A=Math.abs(k),T=Math.floor(A/60),D=A%60;return(k<=0?"+":"-")+I(T,2,"0")+":"+I(D,2,"0")},m:function _(k,A){if(k.date()<A.date())return-_(A,k);var T=12*(A.year()-k.year())+(A.month()-k.month()),D=k.clone().add(T,h),B=A-D<0,F=k.clone().add(T+(B?-1:1),h);return+(-(T+(A-D)/(B?D-F:F-D))||0)},a:function(_){return _<0?Math.ceil(_)||0:Math.floor(_)},p:function(_){return{M:h,y:b,w:f,d:p,D:g,h:u,m:i,s:c,ms:l,Q:v}[_]||String(_||"").toLowerCase().replace(/s$/,"")},u:function(_){return _===void 0}},V="en",U={};U[V]=N;var H="$isDayjsObject",G=function(_){return _ instanceof R||!(!_||!_[H])},Z=function _(k,A,T){var D;if(!k)return V;if(typeof k=="string"){var B=k.toLowerCase();U[B]&&(D=B),A&&(U[B]=A,D=B);var F=k.split("-");if(!D&&F.length>1)return _(F[0])}else{var Y=k.name;U[Y]=k,D=Y}return!T&&D&&(V=D),D||!T&&V},W=function(_,k){if(G(_))return _.clone();var A=typeof k=="object"?k:{};return A.date=_,A.args=arguments,new R(A)},O=P;O.l=Z,O.i=G,O.w=function(_,k){return W(_,{locale:k.$L,utc:k.$u,x:k.$x,$offset:k.$offset})};var R=function(){function _(A){this.$L=Z(A.locale,null,!0),this.parse(A),this.$x=this.$x||A.x||{},this[H]=!0}var k=_.prototype;return k.parse=function(A){this.$d=function(T){var D=T.date,B=T.utc;if(D===null)return new Date(NaN);if(O.u(D))return new Date;if(D instanceof Date)return new Date(D);if(typeof D=="string"&&!/Z$/i.test(D)){var F=D.match(y);if(F){var Y=F[2]-1||0,X=(F[7]||"0").substring(0,3);return B?new Date(Date.UTC(F[1],Y,F[3]||1,F[4]||0,F[5]||0,F[6]||0,X)):new Date(F[1],Y,F[3]||1,F[4]||0,F[5]||0,F[6]||0,X)}}return new Date(D)}(A),this.init()},k.init=function(){var A=this.$d;this.$y=A.getFullYear(),this.$M=A.getMonth(),this.$D=A.getDate(),this.$W=A.getDay(),this.$H=A.getHours(),this.$m=A.getMinutes(),this.$s=A.getSeconds(),this.$ms=A.getMilliseconds()},k.$utils=function(){return O},k.isValid=function(){return this.$d.toString()!==x},k.isSame=function(A,T){var D=W(A);return this.startOf(T)<=D&&D<=this.endOf(T)},k.isAfter=function(A,T){return W(A)<this.startOf(T)},k.isBefore=function(A,T){return this.endOf(T)<W(A)},k.$g=function(A,T,D){return O.u(A)?this[T]:this.set(D,A)},k.unix=function(){return Math.floor(this.valueOf()/1e3)},k.valueOf=function(){return this.$d.getTime()},k.startOf=function(A,T){var D=this,B=!!O.u(T)||T,F=O.p(A),Y=function(se,te){var ae=O.w(D.$u?Date.UTC(D.$y,te,se):new Date(D.$y,te,se),D);return B?ae:ae.endOf(p)},X=function(se,te){return O.w(D.toDate()[se].apply(D.toDate("s"),(B?[0,0,0,0]:[23,59,59,999]).slice(te)),D)},re=this.$W,z=this.$M,ee=this.$D,L="set"+(this.$u?"UTC":"");switch(F){case b:return B?Y(1,0):Y(31,11);case h:return B?Y(1,z):Y(0,z+1);case f:var M=this.$locale().weekStart||0,K=(re<M?re+7:re)-M;return Y(B?ee-K:ee+(6-K),z);case p:case g:return X(L+"Hours",0);case u:return X(L+"Minutes",1);case i:return X(L+"Seconds",2);case c:return X(L+"Milliseconds",3);default:return this.clone()}},k.endOf=function(A){return this.startOf(A,!1)},k.$set=function(A,T){var D,B=O.p(A),F="set"+(this.$u?"UTC":""),Y=(D={},D[p]=F+"Date",D[g]=F+"Date",D[h]=F+"Month",D[b]=F+"FullYear",D[u]=F+"Hours",D[i]=F+"Minutes",D[c]=F+"Seconds",D[l]=F+"Milliseconds",D)[B],X=B===p?this.$D+(T-this.$W):T;if(B===h||B===b){var re=this.clone().set(g,1);re.$d[Y](X),re.init(),this.$d=re.set(g,Math.min(this.$D,re.daysInMonth())).$d}else Y&&this.$d[Y](X);return this.init(),this},k.set=function(A,T){return this.clone().$set(A,T)},k.get=function(A){return this[O.p(A)]()},k.add=function(A,T){var D,B=this;A=Number(A);var F=O.p(T),Y=function(z){var ee=W(B);return O.w(ee.date(ee.date()+Math.round(z*A)),B)};if(F===h)return this.set(h,this.$M+A);if(F===b)return this.set(b,this.$y+A);if(F===p)return Y(1);if(F===f)return Y(7);var X=(D={},D[i]=o,D[u]=s,D[c]=1e3,D)[F]||1,re=this.$d.getTime()+A*X;return O.w(re,this)},k.subtract=function(A,T){return this.add(-1*A,T)},k.format=function(A){var T=this,D=this.$locale();if(!this.isValid())return D.invalidDate||x;var B=A||"YYYY-MM-DDTHH:mm:ssZ",F=O.z(this),Y=this.$H,X=this.$m,re=this.$M,z=D.weekdays,ee=D.months,L=D.meridiem,M=function(te,ae,Q,fe){return te&&(te[ae]||te(T,B))||Q[ae].slice(0,fe)},K=function(te){return O.s(Y%12||12,te,"0")},se=L||function(te,ae,Q){var fe=te<12?"AM":"PM";return Q?fe.toLowerCase():fe};return B.replace(E,function(te,ae){return ae||function(Q){switch(Q){case"YY":return String(T.$y).slice(-2);case"YYYY":return O.s(T.$y,4,"0");case"M":return re+1;case"MM":return O.s(re+1,2,"0");case"MMM":return M(D.monthsShort,re,ee,3);case"MMMM":return M(ee,re);case"D":return T.$D;case"DD":return O.s(T.$D,2,"0");case"d":return String(T.$W);case"dd":return M(D.weekdaysMin,T.$W,z,2);case"ddd":return M(D.weekdaysShort,T.$W,z,3);case"dddd":return z[T.$W];case"H":return String(Y);case"HH":return O.s(Y,2,"0");case"h":return K(1);case"hh":return K(2);case"a":return se(Y,X,!0);case"A":return se(Y,X,!1);case"m":return String(X);case"mm":return O.s(X,2,"0");case"s":return String(T.$s);case"ss":return O.s(T.$s,2,"0");case"SSS":return O.s(T.$ms,3,"0");case"Z":return F}return null}(te)||F.replace(":","")})},k.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},k.diff=function(A,T,D){var B,F=this,Y=O.p(T),X=W(A),re=(X.utcOffset()-this.utcOffset())*o,z=this-X,ee=function(){return O.m(F,X)};switch(Y){case b:B=ee()/12;break;case h:B=ee();break;case v:B=ee()/3;break;case f:B=(z-re)/6048e5;break;case p:B=(z-re)/864e5;break;case u:B=z/s;break;case i:B=z/o;break;case c:B=z/1e3;break;default:B=z}return D?B:O.a(B)},k.daysInMonth=function(){return this.endOf(h).$D},k.$locale=function(){return U[this.$L]},k.locale=function(A,T){if(!A)return this.$L;var D=this.clone(),B=Z(A,T,!0);return B&&(D.$L=B),D},k.clone=function(){return O.w(this.$d,this)},k.toDate=function(){return new Date(this.valueOf())},k.toJSON=function(){return this.isValid()?this.toISOString():null},k.toISOString=function(){return this.$d.toISOString()},k.toString=function(){return this.$d.toUTCString()},_}(),C=R.prototype;return W.prototype=C,[["$ms",l],["$s",c],["$m",i],["$H",u],["$W",p],["$M",h],["$y",b],["$D",g]].forEach(function(_){C[_[1]]=function(k){return this.$g(k,_[0],_[1])}}),W.extend=function(_,k){return _.$i||(_(k,R,W),_.$i=!0),W},W.locale=Z,W.isDayjs=G,W.unix=function(_){return W(1e3*_)},W.en=U[V],W.Ls=U,W.p={},W})},{}],392:[function(e,a,n){(function(o,s){typeof n=="object"&&a!==void 0?a.exports=s():(o=typeof globalThis<"u"?globalThis:o||self).dayjs_plugin_customParseFormat=s()})(void 0,function(){var o={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},s=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,l=/\d\d/,c=/\d\d?/,i=/\d*[^-_:/,()\s\d]+/,u={},p=function(y){return(y=+y)+(y>68?1900:2e3)},f=function(y){return function(E){this[y]=+E}},h=[/[+-]\d\d:?(\d\d)?|Z/,function(y){(this.zone||(this.zone={})).offset=function(E){if(!E||E==="Z")return 0;var N=E.match(/([+-]|\d\d)/g),I=60*N[1]+(+N[2]||0);return I===0?0:N[0]==="+"?-I:I}(y)}],v=function(y){var E=u[y];return E&&(E.indexOf?E:E.s.concat(E.f))},b=function(y,E){var N,I=u.meridiem;if(I){for(var P=1;P<=24;P+=1)if(y.indexOf(I(P,0,E))>-1){N=P>12;break}}else N=y===(E?"pm":"PM");return N},g={A:[i,function(y){this.afternoon=b(y,!1)}],a:[i,function(y){this.afternoon=b(y,!0)}],S:[/\d/,function(y){this.milliseconds=100*+y}],SS:[l,function(y){this.milliseconds=10*+y}],SSS:[/\d{3}/,function(y){this.milliseconds=+y}],s:[c,f("seconds")],ss:[c,f("seconds")],m:[c,f("minutes")],mm:[c,f("minutes")],H:[c,f("hours")],h:[c,f("hours")],HH:[c,f("hours")],hh:[c,f("hours")],D:[c,f("day")],DD:[l,f("day")],Do:[i,function(y){var E=u.ordinal,N=y.match(/\d+/);if(this.day=N[0],E)for(var I=1;I<=31;I+=1)E(I).replace(/\[|\]/g,"")===y&&(this.day=I)}],M:[c,f("month")],MM:[l,f("month")],MMM:[i,function(y){var E=v("months"),N=(v("monthsShort")||E.map(function(I){return I.slice(0,3)})).indexOf(y)+1;if(N<1)throw new Error;this.month=N%12||N}],MMMM:[i,function(y){var E=v("months").indexOf(y)+1;if(E<1)throw new Error;this.month=E%12||E}],Y:[/[+-]?\d+/,f("year")],YY:[l,function(y){this.year=p(y)}],YYYY:[/\d{4}/,f("year")],Z:h,ZZ:h};function x(y){var E,N;E=y,N=u&&u.formats;for(var I=(y=E.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(W,O,R){var C=R&&R.toUpperCase();return O||N[R]||o[R]||N[C].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(_,k,A){return k||A.slice(1)})})).match(s),P=I.length,V=0;V<P;V+=1){var U=I[V],H=g[U],G=H&&H[0],Z=H&&H[1];I[V]=Z?{regex:G,parser:Z}:U.replace(/^\[|\]$/g,"")}return function(W){for(var O={},R=0,C=0;R<P;R+=1){var _=I[R];if(typeof _=="string")C+=_.length;else{var k=_.regex,A=_.parser,T=W.slice(C),D=k.exec(T)[0];A.call(O,D),W=W.replace(D,"")}}return function(B){var F=B.afternoon;if(F!==void 0){var Y=B.hours;F?Y<12&&(B.hours+=12):Y===12&&(B.hours=0),delete B.afternoon}}(O),O}}return function(y,E,N){N.p.customParseFormat=!0,y&&y.parseTwoDigitYear&&(p=y.parseTwoDigitYear);var I=E.prototype,P=I.parse;I.parse=function(V){var U=V.date,H=V.utc,G=V.args;this.$u=H;var Z=G[1];if(typeof Z=="string"){var W=G[2]===!0,O=G[3]===!0,R=W||O,C=G[2];O&&(C=G[2]),u=this.$locale(),!W&&C&&(u=N.Ls[C]),this.$d=function(T,D,B){try{if(["x","X"].indexOf(D)>-1)return new Date((D==="X"?1e3:1)*T);var F=x(D)(T),Y=F.year,X=F.month,re=F.day,z=F.hours,ee=F.minutes,L=F.seconds,M=F.milliseconds,K=F.zone,se=new Date,te=re||(Y||X?1:se.getDate()),ae=Y||se.getFullYear(),Q=0;Y&&!X||(Q=X>0?X-1:se.getMonth());var fe=z||0,le=ee||0,ne=L||0,ue=M||0;return K?new Date(Date.UTC(ae,Q,te,fe,le,ne,ue+60*K.offset*1e3)):B?new Date(Date.UTC(ae,Q,te,fe,le,ne,ue)):new Date(ae,Q,te,fe,le,ne,ue)}catch{return new Date("")}}(U,Z,H),this.init(),C&&C!==!0&&(this.$L=this.locale(C).$L),R&&U!=this.format(Z)&&(this.$d=new Date("")),u={}}else if(Z instanceof Array)for(var _=Z.length,k=1;k<=_;k+=1){G[1]=Z[k-1];var A=N.apply(this,G);if(A.isValid()){this.$d=A.$d,this.$L=A.$L,this.init();break}k===_&&(this.$d=new Date(""))}else P.call(this,V)}}})},{}],393:[function(e,a,n){(function(o,s){typeof n=="object"&&a!==void 0?a.exports=s():(o=typeof globalThis<"u"?globalThis:o||self).dayjs_plugin_utc=s()})(void 0,function(){var o="minute",s=/[+-]\d\d(?::?\d\d)?/g,l=/([+-]|\d\d)/g;return function(c,i,u){var p=i.prototype;u.utc=function(y){var E={date:y,utc:!0,args:arguments};return new i(E)},p.utc=function(y){var E=u(this.toDate(),{locale:this.$L,utc:!0});return y?E.add(this.utcOffset(),o):E},p.local=function(){return u(this.toDate(),{locale:this.$L,utc:!1})};var f=p.parse;p.parse=function(y){y.utc&&(this.$u=!0),this.$utils().u(y.$offset)||(this.$offset=y.$offset),f.call(this,y)};var h=p.init;p.init=function(){if(this.$u){var y=this.$d;this.$y=y.getUTCFullYear(),this.$M=y.getUTCMonth(),this.$D=y.getUTCDate(),this.$W=y.getUTCDay(),this.$H=y.getUTCHours(),this.$m=y.getUTCMinutes(),this.$s=y.getUTCSeconds(),this.$ms=y.getUTCMilliseconds()}else h.call(this)};var v=p.utcOffset;p.utcOffset=function(y,E){var N=this.$utils().u;if(N(y))return this.$u?0:N(this.$offset)?v.call(this):this.$offset;if(typeof y=="string"&&(y=function(U){U===void 0&&(U="");var H=U.match(s);if(!H)return null;var G=(""+H[0]).match(l)||["-",0,0],Z=G[0],W=60*+G[1]+ +G[2];return W===0?0:Z==="+"?W:-W}(y))===null)return this;var I=Math.abs(y)<=16?60*y:y,P=this;if(E)return P.$offset=I,P.$u=y===0,P;if(y!==0){var V=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(P=this.local().add(I+V,o)).$offset=I,P.$x.$localOffset=V}else P=this.utc();return P};var b=p.format;p.format=function(y){var E=y||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return b.call(this,E)},p.valueOf=function(){var y=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*y},p.isUTC=function(){return!!this.$u},p.toISOString=function(){return this.toDate().toISOString()},p.toString=function(){return this.toDate().toUTCString()};var g=p.toDate;p.toDate=function(y){return y==="s"&&this.$offset?u(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():g.call(this)};var x=p.diff;p.diff=function(y,E,N){if(y&&this.$u===y.$u)return x.call(this,y,E,N);var I=this.local(),P=u(y).local();return x.call(I,P,E,N)}}})},{}],394:[function(e,a,n){n.utils=e("./des/utils"),n.Cipher=e("./des/cipher"),n.DES=e("./des/des"),n.CBC=e("./des/cbc"),n.EDE=e("./des/ede")},{"./des/cbc":395,"./des/cipher":396,"./des/des":397,"./des/ede":398,"./des/utils":399}],395:[function(e,a,n){var o=e("minimalistic-assert"),s=e("inherits"),l={};function c(i){o.equal(i.length,8,"Invalid IV length"),this.iv=new Array(8);for(var u=0;u<this.iv.length;u++)this.iv[u]=i[u]}n.instantiate=function(i){function u(v){i.call(this,v),this._cbcInit()}s(u,i);for(var p=Object.keys(l),f=0;f<p.length;f++){var h=p[f];u.prototype[h]=l[h]}return u.create=function(v){return new u(v)},u},l._cbcInit=function(){var i=new c(this.options.iv);this._cbcState=i},l._update=function(i,u,p,f){var h=this._cbcState,v=this.constructor.super_.prototype,b=h.iv;if(this.type==="encrypt"){for(var g=0;g<this.blockSize;g++)b[g]^=i[u+g];for(v._update.call(this,b,0,p,f),g=0;g<this.blockSize;g++)b[g]=p[f+g]}else{for(v._update.call(this,i,u,p,f),g=0;g<this.blockSize;g++)p[f+g]^=b[g];for(g=0;g<this.blockSize;g++)b[g]=i[u+g]}}},{inherits:440,"minimalistic-assert":453}],396:[function(e,a,n){var o=e("minimalistic-assert");function s(l){this.options=l,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=l.padding!==!1}a.exports=s,s.prototype._init=function(){},s.prototype.update=function(l){return l.length===0?[]:this.type==="decrypt"?this._updateDecrypt(l):this._updateEncrypt(l)},s.prototype._buffer=function(l,c){for(var i=Math.min(this.buffer.length-this.bufferOff,l.length-c),u=0;u<i;u++)this.buffer[this.bufferOff+u]=l[c+u];return this.bufferOff+=i,i},s.prototype._flushBuffer=function(l,c){return this._update(this.buffer,0,l,c),this.bufferOff=0,this.blockSize},s.prototype._updateEncrypt=function(l){var c=0,i=0,u=(this.bufferOff+l.length)/this.blockSize|0,p=new Array(u*this.blockSize);this.bufferOff!==0&&(c+=this._buffer(l,c),this.bufferOff===this.buffer.length&&(i+=this._flushBuffer(p,i)));for(var f=l.length-(l.length-c)%this.blockSize;c<f;c+=this.blockSize)this._update(l,c,p,i),i+=this.blockSize;for(;c<l.length;c++,this.bufferOff++)this.buffer[this.bufferOff]=l[c];return p},s.prototype._updateDecrypt=function(l){for(var c=0,i=0,u=Math.ceil((this.bufferOff+l.length)/this.blockSize)-1,p=new Array(u*this.blockSize);u>0;u--)c+=this._buffer(l,c),i+=this._flushBuffer(p,i);return c+=this._buffer(l,c),p},s.prototype.final=function(l){var c,i;return l&&(c=this.update(l)),i=this.type==="encrypt"?this._finalEncrypt():this._finalDecrypt(),c?c.concat(i):i},s.prototype._pad=function(l,c){if(c===0)return!1;for(;c<l.length;)l[c++]=0;return!0},s.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var l=new Array(this.blockSize);return this._update(this.buffer,0,l,0),l},s.prototype._unpad=function(l){return l},s.prototype._finalDecrypt=function(){o.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var l=new Array(this.blockSize);return this._flushBuffer(l,0),this._unpad(l)}},{"minimalistic-assert":453}],397:[function(e,a,n){var o=e("minimalistic-assert"),s=e("inherits"),l=e("./utils"),c=e("./cipher");function i(){this.tmp=new Array(2),this.keys=null}function u(f){c.call(this,f);var h=new i;this._desState=h,this.deriveKeys(h,f.key)}s(u,c),a.exports=u,u.create=function(f){return new u(f)};var p=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];u.prototype.deriveKeys=function(f,h){f.keys=new Array(32),o.equal(h.length,this.blockSize,"Invalid key length");var v=l.readUInt32BE(h,0),b=l.readUInt32BE(h,4);l.pc1(v,b,f.tmp,0),v=f.tmp[0],b=f.tmp[1];for(var g=0;g<f.keys.length;g+=2){var x=p[g>>>1];v=l.r28shl(v,x),b=l.r28shl(b,x),l.pc2(v,b,f.keys,g)}},u.prototype._update=function(f,h,v,b){var g=this._desState,x=l.readUInt32BE(f,h),y=l.readUInt32BE(f,h+4);l.ip(x,y,g.tmp,0),x=g.tmp[0],y=g.tmp[1],this.type==="encrypt"?this._encrypt(g,x,y,g.tmp,0):this._decrypt(g,x,y,g.tmp,0),x=g.tmp[0],y=g.tmp[1],l.writeUInt32BE(v,x,b),l.writeUInt32BE(v,y,b+4)},u.prototype._pad=function(f,h){if(this.padding===!1)return!1;for(var v=f.length-h,b=h;b<f.length;b++)f[b]=v;return!0},u.prototype._unpad=function(f){if(this.padding===!1)return f;for(var h=f[f.length-1],v=f.length-h;v<f.length;v++)o.equal(f[v],h);return f.slice(0,f.length-h)},u.prototype._encrypt=function(f,h,v,b,g){for(var x=h,y=v,E=0;E<f.keys.length;E+=2){var N=f.keys[E],I=f.keys[E+1];l.expand(y,f.tmp,0),N^=f.tmp[0],I^=f.tmp[1];var P=l.substitute(N,I),V=y;y=(x^l.permute(P))>>>0,x=V}l.rip(y,x,b,g)},u.prototype._decrypt=function(f,h,v,b,g){for(var x=v,y=h,E=f.keys.length-2;E>=0;E-=2){var N=f.keys[E],I=f.keys[E+1];l.expand(x,f.tmp,0),N^=f.tmp[0],I^=f.tmp[1];var P=l.substitute(N,I),V=x;x=(y^l.permute(P))>>>0,y=V}l.rip(x,y,b,g)}},{"./cipher":396,"./utils":399,inherits:440,"minimalistic-assert":453}],398:[function(e,a,n){var o=e("minimalistic-assert"),s=e("inherits"),l=e("./cipher"),c=e("./des");function i(p,f){o.equal(f.length,24,"Invalid key length");var h=f.slice(0,8),v=f.slice(8,16),b=f.slice(16,24);this.ciphers=p==="encrypt"?[c.create({type:"encrypt",key:h}),c.create({type:"decrypt",key:v}),c.create({type:"encrypt",key:b})]:[c.create({type:"decrypt",key:b}),c.create({type:"encrypt",key:v}),c.create({type:"decrypt",key:h})]}function u(p){l.call(this,p);var f=new i(this.type,this.options.key);this._edeState=f}s(u,l),a.exports=u,u.create=function(p){return new u(p)},u.prototype._update=function(p,f,h,v){var b=this._edeState;b.ciphers[0]._update(p,f,h,v),b.ciphers[1]._update(h,v,h,v),b.ciphers[2]._update(h,v,h,v)},u.prototype._pad=c.prototype._pad,u.prototype._unpad=c.prototype._unpad},{"./cipher":396,"./des":397,inherits:440,"minimalistic-assert":453}],399:[function(e,a,n){n.readUInt32BE=function(c,i){return(c[0+i]<<24|c[1+i]<<16|c[2+i]<<8|c[3+i])>>>0},n.writeUInt32BE=function(c,i,u){c[0+u]=i>>>24,c[1+u]=i>>>16&255,c[2+u]=i>>>8&255,c[3+u]=255&i},n.ip=function(c,i,u,p){for(var f=0,h=0,v=6;v>=0;v-=2){for(var b=0;b<=24;b+=8)f<<=1,f|=i>>>b+v&1;for(b=0;b<=24;b+=8)f<<=1,f|=c>>>b+v&1}for(v=6;v>=0;v-=2){for(b=1;b<=25;b+=8)h<<=1,h|=i>>>b+v&1;for(b=1;b<=25;b+=8)h<<=1,h|=c>>>b+v&1}u[p+0]=f>>>0,u[p+1]=h>>>0},n.rip=function(c,i,u,p){for(var f=0,h=0,v=0;v<4;v++)for(var b=24;b>=0;b-=8)f<<=1,f|=i>>>b+v&1,f<<=1,f|=c>>>b+v&1;for(v=4;v<8;v++)for(b=24;b>=0;b-=8)h<<=1,h|=i>>>b+v&1,h<<=1,h|=c>>>b+v&1;u[p+0]=f>>>0,u[p+1]=h>>>0},n.pc1=function(c,i,u,p){for(var f=0,h=0,v=7;v>=5;v--){for(var b=0;b<=24;b+=8)f<<=1,f|=i>>b+v&1;for(b=0;b<=24;b+=8)f<<=1,f|=c>>b+v&1}for(b=0;b<=24;b+=8)f<<=1,f|=i>>b+v&1;for(v=1;v<=3;v++){for(b=0;b<=24;b+=8)h<<=1,h|=i>>b+v&1;for(b=0;b<=24;b+=8)h<<=1,h|=c>>b+v&1}for(b=0;b<=24;b+=8)h<<=1,h|=c>>b+v&1;u[p+0]=f>>>0,u[p+1]=h>>>0},n.r28shl=function(c,i){return c<<i&268435455|c>>>28-i};var o=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];n.pc2=function(c,i,u,p){for(var f=0,h=0,v=o.length>>>1,b=0;b<v;b++)f<<=1,f|=c>>>o[b]&1;for(b=v;b<o.length;b++)h<<=1,h|=i>>>o[b]&1;u[p+0]=f>>>0,u[p+1]=h>>>0},n.expand=function(c,i,u){var p=0,f=0;p=(1&c)<<5|c>>>27;for(var h=23;h>=15;h-=4)p<<=6,p|=c>>>h&63;for(h=11;h>=3;h-=4)f|=c>>>h&63,f<<=6;f|=(31&c)<<1|c>>>31,i[u+0]=p>>>0,i[u+1]=f>>>0};var s=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];n.substitute=function(c,i){for(var u=0,p=0;p<4;p++)u<<=4,u|=s[64*p+(c>>>18-6*p&63)];for(p=0;p<4;p++)u<<=4,u|=s[256+64*p+(i>>>18-6*p&63)];return u>>>0};var l=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];n.permute=function(c){for(var i=0,u=0;u<l.length;u++)i<<=1,i|=c>>>l[u]&1;return i>>>0},n.padSplit=function(c,i,u){for(var p=c.toString(2);p.length<i;)p="0"+p;for(var f=[],h=0;h<i;h+=u)f.push(p.slice(h,h+u));return f.join(" ")}},{}],400:[function(e,a,n){(function(o){(function(){var s=e("./lib/generatePrime"),l=e("./lib/primes.json"),c=e("./lib/dh"),i={binary:!0,hex:!0,base64:!0};n.DiffieHellmanGroup=n.createDiffieHellmanGroup=n.getDiffieHellman=function(u){var p=new o(l[u].prime,"hex"),f=new o(l[u].gen,"hex");return new c(p,f)},n.createDiffieHellman=n.DiffieHellman=function u(p,f,h,v){return o.isBuffer(f)||i[f]===void 0?u(p,"binary",f,h):(f=f||"binary",v=v||"binary",h=h||new o([2]),o.isBuffer(h)||(h=new o(h,v)),typeof p=="number"?new c(s(p,h),h,!0):(o.isBuffer(p)||(p=new o(p,f)),new c(p,h,!0)))}}).call(this)}).call(this,e("buffer").Buffer)},{"./lib/dh":401,"./lib/generatePrime":402,"./lib/primes.json":403,buffer:220}],401:[function(e,a,n){(function(o){(function(){var s=e("bn.js"),l=new(e("miller-rabin")),c=new s(24),i=new s(11),u=new s(10),p=new s(3),f=new s(7),h=e("./generatePrime"),v=e("randombytes");function b(N,I){return I=I||"utf8",o.isBuffer(N)||(N=new o(N,I)),this._pub=new s(N),this}function g(N,I){return I=I||"utf8",o.isBuffer(N)||(N=new o(N,I)),this._priv=new s(N),this}a.exports=y;var x={};function y(N,I,P){this.setGenerator(I),this.__prime=new s(N),this._prime=s.mont(this.__prime),this._primeLen=N.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,P?(this.setPublicKey=b,this.setPrivateKey=g):this._primeCode=8}function E(N,I){var P=new o(N.toArray());return I?P.toString(I):P}Object.defineProperty(y.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=function(N,I){var P=I.toString("hex"),V=[P,N.toString(16)].join("_");if(V in x)return x[V];var U,H=0;if(N.isEven()||!h.simpleSieve||!h.fermatTest(N)||!l.test(N))return H+=1,H+=P==="02"||P==="05"?8:4,x[V]=H,H;switch(l.test(N.shrn(1))||(H+=2),P){case"02":N.mod(c).cmp(i)&&(H+=8);break;case"05":(U=N.mod(u)).cmp(p)&&U.cmp(f)&&(H+=8);break;default:H+=4}return x[V]=H,H}(this.__prime,this.__gen)),this._primeCode}}),y.prototype.generateKeys=function(){return this._priv||(this._priv=new s(v(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},y.prototype.computeSecret=function(N){var I=(N=(N=new s(N)).toRed(this._prime)).redPow(this._priv).fromRed(),P=new o(I.toArray()),V=this.getPrime();if(P.length<V.length){var U=new o(V.length-P.length);U.fill(0),P=o.concat([U,P])}return P},y.prototype.getPublicKey=function(N){return E(this._pub,N)},y.prototype.getPrivateKey=function(N){return E(this._priv,N)},y.prototype.getPrime=function(N){return E(this.__prime,N)},y.prototype.getGenerator=function(N){return E(this._gen,N)},y.prototype.setGenerator=function(N,I){return I=I||"utf8",o.isBuffer(N)||(N=new o(N,I)),this.__gen=N,this._gen=new s(N),this}}).call(this)}).call(this,e("buffer").Buffer)},{"./generatePrime":402,"bn.js":404,buffer:220,"miller-rabin":451,randombytes:475}],402:[function(e,a,n){var o=e("randombytes");a.exports=N,N.simpleSieve=y,N.fermatTest=E;var s=e("bn.js"),l=new s(24),c=new(e("miller-rabin")),i=new s(1),u=new s(2),p=new s(5),f=(new s(16),new s(8),new s(10)),h=new s(3),v=(new s(7),new s(11)),b=new s(4),g=(new s(12),null);function x(){if(g!==null)return g;var I=[];I[0]=2;for(var P=1,V=3;V<1048576;V+=2){for(var U=Math.ceil(Math.sqrt(V)),H=0;H<P&&I[H]<=U&&V%I[H]!=0;H++);P!==H&&I[H]<=U||(I[P++]=V)}return g=I,I}function y(I){for(var P=x(),V=0;V<P.length;V++)if(I.modn(P[V])===0)return I.cmpn(P[V])===0;return!0}function E(I){var P=s.mont(I);return u.toRed(P).redPow(I.subn(1)).fromRed().cmpn(1)===0}function N(I,P){if(I<16)return new s(P===2||P===5?[140,123]:[140,39]);var V,U;for(P=new s(P);;){for(V=new s(o(Math.ceil(I/8)));V.bitLength()>I;)V.ishrn(1);if(V.isEven()&&V.iadd(i),V.testn(1)||V.iadd(u),P.cmp(u)){if(!P.cmp(p))for(;V.mod(f).cmp(h);)V.iadd(b)}else for(;V.mod(l).cmp(v);)V.iadd(b);if(y(U=V.shrn(1))&&y(V)&&E(U)&&E(V)&&c.test(U)&&c.test(V))return V}}},{"bn.js":404,"miller-rabin":451,randombytes:475}],403:[function(e,a,n){a.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],404:[function(e,a,n){arguments[4][184][0].apply(n,arguments)},{buffer:188,dup:184}],405:[function(e,a,n){var o=n;o.version=e("../package.json").version,o.utils=e("./elliptic/utils"),o.rand=e("brorand"),o.curve=e("./elliptic/curve"),o.curves=e("./elliptic/curves"),o.ec=e("./elliptic/ec"),o.eddsa=e("./elliptic/eddsa")},{"../package.json":421,"./elliptic/curve":408,"./elliptic/curves":411,"./elliptic/ec":412,"./elliptic/eddsa":415,"./elliptic/utils":419,brorand:187}],406:[function(e,a,n){var o=e("bn.js"),s=e("../utils"),l=s.getNAF,c=s.getJSF,i=s.assert;function u(f,h){this.type=f,this.p=new o(h.p,16),this.red=h.prime?o.red(h.prime):o.mont(this.p),this.zero=new o(0).toRed(this.red),this.one=new o(1).toRed(this.red),this.two=new o(2).toRed(this.red),this.n=h.n&&new o(h.n,16),this.g=h.g&&this.pointFromJSON(h.g,h.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var v=this.n&&this.p.div(this.n);!v||v.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function p(f,h){this.curve=f,this.type=h,this.precomputed=null}a.exports=u,u.prototype.point=function(){throw new Error("Not implemented")},u.prototype.validate=function(){throw new Error("Not implemented")},u.prototype._fixedNafMul=function(f,h){i(f.precomputed);var v=f._getDoubles(),b=l(h,1,this._bitLength),g=(1<<v.step+1)-(v.step%2==0?2:1);g/=3;var x,y,E=[];for(x=0;x<b.length;x+=v.step){y=0;for(var N=x+v.step-1;N>=x;N--)y=(y<<1)+b[N];E.push(y)}for(var I=this.jpoint(null,null,null),P=this.jpoint(null,null,null),V=g;V>0;V--){for(x=0;x<E.length;x++)(y=E[x])===V?P=P.mixedAdd(v.points[x]):y===-V&&(P=P.mixedAdd(v.points[x].neg()));I=I.add(P)}return I.toP()},u.prototype._wnafMul=function(f,h){var v=4,b=f._getNAFPoints(v);v=b.wnd;for(var g=b.points,x=l(h,v,this._bitLength),y=this.jpoint(null,null,null),E=x.length-1;E>=0;E--){for(var N=0;E>=0&&x[E]===0;E--)N++;if(E>=0&&N++,y=y.dblp(N),E<0)break;var I=x[E];i(I!==0),y=f.type==="affine"?I>0?y.mixedAdd(g[I-1>>1]):y.mixedAdd(g[-I-1>>1].neg()):I>0?y.add(g[I-1>>1]):y.add(g[-I-1>>1].neg())}return f.type==="affine"?y.toP():y},u.prototype._wnafMulAdd=function(f,h,v,b,g){var x,y,E,N=this._wnafT1,I=this._wnafT2,P=this._wnafT3,V=0;for(x=0;x<b;x++){var U=(E=h[x])._getNAFPoints(f);N[x]=U.wnd,I[x]=U.points}for(x=b-1;x>=1;x-=2){var H=x-1,G=x;if(N[H]===1&&N[G]===1){var Z=[h[H],null,null,h[G]];h[H].y.cmp(h[G].y)===0?(Z[1]=h[H].add(h[G]),Z[2]=h[H].toJ().mixedAdd(h[G].neg())):h[H].y.cmp(h[G].y.redNeg())===0?(Z[1]=h[H].toJ().mixedAdd(h[G]),Z[2]=h[H].add(h[G].neg())):(Z[1]=h[H].toJ().mixedAdd(h[G]),Z[2]=h[H].toJ().mixedAdd(h[G].neg()));var W=[-3,-1,-5,-7,0,7,5,1,3],O=c(v[H],v[G]);for(V=Math.max(O[0].length,V),P[H]=new Array(V),P[G]=new Array(V),y=0;y<V;y++){var R=0|O[0][y],C=0|O[1][y];P[H][y]=W[3*(R+1)+(C+1)],P[G][y]=0,I[H]=Z}}else P[H]=l(v[H],N[H],this._bitLength),P[G]=l(v[G],N[G],this._bitLength),V=Math.max(P[H].length,V),V=Math.max(P[G].length,V)}var _=this.jpoint(null,null,null),k=this._wnafT4;for(x=V;x>=0;x--){for(var A=0;x>=0;){var T=!0;for(y=0;y<b;y++)k[y]=0|P[y][x],k[y]!==0&&(T=!1);if(!T)break;A++,x--}if(x>=0&&A++,_=_.dblp(A),x<0)break;for(y=0;y<b;y++){var D=k[y];D!==0&&(D>0?E=I[y][D-1>>1]:D<0&&(E=I[y][-D-1>>1].neg()),_=E.type==="affine"?_.mixedAdd(E):_.add(E))}}for(x=0;x<b;x++)I[x]=null;return g?_:_.toP()},u.BasePoint=p,p.prototype.eq=function(){throw new Error("Not implemented")},p.prototype.validate=function(){return this.curve.validate(this)},u.prototype.decodePoint=function(f,h){f=s.toArray(f,h);var v=this.p.byteLength();if((f[0]===4||f[0]===6||f[0]===7)&&f.length-1==2*v)return f[0]===6?i(f[f.length-1]%2==0):f[0]===7&&i(f[f.length-1]%2==1),this.point(f.slice(1,1+v),f.slice(1+v,1+2*v));if((f[0]===2||f[0]===3)&&f.length-1===v)return this.pointFromX(f.slice(1,1+v),f[0]===3);throw new Error("Unknown point format")},p.prototype.encodeCompressed=function(f){return this.encode(f,!0)},p.prototype._encode=function(f){var h=this.curve.p.byteLength(),v=this.getX().toArray("be",h);return f?[this.getY().isEven()?2:3].concat(v):[4].concat(v,this.getY().toArray("be",h))},p.prototype.encode=function(f,h){return s.encode(this._encode(h),f)},p.prototype.precompute=function(f){if(this.precomputed)return this;var h={doubles:null,naf:null,beta:null};return h.naf=this._getNAFPoints(8),h.doubles=this._getDoubles(4,f),h.beta=this._getBeta(),this.precomputed=h,this},p.prototype._hasDoubles=function(f){if(!this.precomputed)return!1;var h=this.precomputed.doubles;return!!h&&h.points.length>=Math.ceil((f.bitLength()+1)/h.step)},p.prototype._getDoubles=function(f,h){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var v=[this],b=this,g=0;g<h;g+=f){for(var x=0;x<f;x++)b=b.dbl();v.push(b)}return{step:f,points:v}},p.prototype._getNAFPoints=function(f){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var h=[this],v=(1<<f)-1,b=v===1?null:this.dbl(),g=1;g<v;g++)h[g]=h[g-1].add(b);return{wnd:f,points:h}},p.prototype._getBeta=function(){return null},p.prototype.dblp=function(f){for(var h=this,v=0;v<f;v++)h=h.dbl();return h}},{"../utils":419,"bn.js":420}],407:[function(e,a,n){var o=e("../utils"),s=e("bn.js"),l=e("inherits"),c=e("./base"),i=o.assert;function u(f){this.twisted=(0|f.a)!=1,this.mOneA=this.twisted&&(0|f.a)==-1,this.extended=this.mOneA,c.call(this,"edwards",f),this.a=new s(f.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new s(f.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new s(f.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),i(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(0|f.c)==1}function p(f,h,v,b,g){c.BasePoint.call(this,f,"projective"),h===null&&v===null&&b===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new s(h,16),this.y=new s(v,16),this.z=b?new s(b,16):this.curve.one,this.t=g&&new s(g,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}l(u,c),a.exports=u,u.prototype._mulA=function(f){return this.mOneA?f.redNeg():this.a.redMul(f)},u.prototype._mulC=function(f){return this.oneC?f:this.c.redMul(f)},u.prototype.jpoint=function(f,h,v,b){return this.point(f,h,v,b)},u.prototype.pointFromX=function(f,h){(f=new s(f,16)).red||(f=f.toRed(this.red));var v=f.redSqr(),b=this.c2.redSub(this.a.redMul(v)),g=this.one.redSub(this.c2.redMul(this.d).redMul(v)),x=b.redMul(g.redInvm()),y=x.redSqrt();if(y.redSqr().redSub(x).cmp(this.zero)!==0)throw new Error("invalid point");var E=y.fromRed().isOdd();return(h&&!E||!h&&E)&&(y=y.redNeg()),this.point(f,y)},u.prototype.pointFromY=function(f,h){(f=new s(f,16)).red||(f=f.toRed(this.red));var v=f.redSqr(),b=v.redSub(this.c2),g=v.redMul(this.d).redMul(this.c2).redSub(this.a),x=b.redMul(g.redInvm());if(x.cmp(this.zero)===0){if(h)throw new Error("invalid point");return this.point(this.zero,f)}var y=x.redSqrt();if(y.redSqr().redSub(x).cmp(this.zero)!==0)throw new Error("invalid point");return y.fromRed().isOdd()!==h&&(y=y.redNeg()),this.point(y,f)},u.prototype.validate=function(f){if(f.isInfinity())return!0;f.normalize();var h=f.x.redSqr(),v=f.y.redSqr(),b=h.redMul(this.a).redAdd(v),g=this.c2.redMul(this.one.redAdd(this.d.redMul(h).redMul(v)));return b.cmp(g)===0},l(p,c.BasePoint),u.prototype.pointFromJSON=function(f){return p.fromJSON(this,f)},u.prototype.point=function(f,h,v,b){return new p(this,f,h,v,b)},p.fromJSON=function(f,h){return new p(f,h[0],h[1],h[2])},p.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},p.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},p.prototype._extDbl=function(){var f=this.x.redSqr(),h=this.y.redSqr(),v=this.z.redSqr();v=v.redIAdd(v);var b=this.curve._mulA(f),g=this.x.redAdd(this.y).redSqr().redISub(f).redISub(h),x=b.redAdd(h),y=x.redSub(v),E=b.redSub(h),N=g.redMul(y),I=x.redMul(E),P=g.redMul(E),V=y.redMul(x);return this.curve.point(N,I,V,P)},p.prototype._projDbl=function(){var f,h,v,b,g,x,y=this.x.redAdd(this.y).redSqr(),E=this.x.redSqr(),N=this.y.redSqr();if(this.curve.twisted){var I=(b=this.curve._mulA(E)).redAdd(N);this.zOne?(f=y.redSub(E).redSub(N).redMul(I.redSub(this.curve.two)),h=I.redMul(b.redSub(N)),v=I.redSqr().redSub(I).redSub(I)):(g=this.z.redSqr(),x=I.redSub(g).redISub(g),f=y.redSub(E).redISub(N).redMul(x),h=I.redMul(b.redSub(N)),v=I.redMul(x))}else b=E.redAdd(N),g=this.curve._mulC(this.z).redSqr(),x=b.redSub(g).redSub(g),f=this.curve._mulC(y.redISub(b)).redMul(x),h=this.curve._mulC(b).redMul(E.redISub(N)),v=b.redMul(x);return this.curve.point(f,h,v)},p.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},p.prototype._extAdd=function(f){var h=this.y.redSub(this.x).redMul(f.y.redSub(f.x)),v=this.y.redAdd(this.x).redMul(f.y.redAdd(f.x)),b=this.t.redMul(this.curve.dd).redMul(f.t),g=this.z.redMul(f.z.redAdd(f.z)),x=v.redSub(h),y=g.redSub(b),E=g.redAdd(b),N=v.redAdd(h),I=x.redMul(y),P=E.redMul(N),V=x.redMul(N),U=y.redMul(E);return this.curve.point(I,P,U,V)},p.prototype._projAdd=function(f){var h,v,b=this.z.redMul(f.z),g=b.redSqr(),x=this.x.redMul(f.x),y=this.y.redMul(f.y),E=this.curve.d.redMul(x).redMul(y),N=g.redSub(E),I=g.redAdd(E),P=this.x.redAdd(this.y).redMul(f.x.redAdd(f.y)).redISub(x).redISub(y),V=b.redMul(N).redMul(P);return this.curve.twisted?(h=b.redMul(I).redMul(y.redSub(this.curve._mulA(x))),v=N.redMul(I)):(h=b.redMul(I).redMul(y.redSub(x)),v=this.curve._mulC(N).redMul(I)),this.curve.point(V,h,v)},p.prototype.add=function(f){return this.isInfinity()?f:f.isInfinity()?this:this.curve.extended?this._extAdd(f):this._projAdd(f)},p.prototype.mul=function(f){return this._hasDoubles(f)?this.curve._fixedNafMul(this,f):this.curve._wnafMul(this,f)},p.prototype.mulAdd=function(f,h,v){return this.curve._wnafMulAdd(1,[this,h],[f,v],2,!1)},p.prototype.jmulAdd=function(f,h,v){return this.curve._wnafMulAdd(1,[this,h],[f,v],2,!0)},p.prototype.normalize=function(){if(this.zOne)return this;var f=this.z.redInvm();return this.x=this.x.redMul(f),this.y=this.y.redMul(f),this.t&&(this.t=this.t.redMul(f)),this.z=this.curve.one,this.zOne=!0,this},p.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},p.prototype.getX=function(){return this.normalize(),this.x.fromRed()},p.prototype.getY=function(){return this.normalize(),this.y.fromRed()},p.prototype.eq=function(f){return this===f||this.getX().cmp(f.getX())===0&&this.getY().cmp(f.getY())===0},p.prototype.eqXToP=function(f){var h=f.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(h)===0)return!0;for(var v=f.clone(),b=this.curve.redN.redMul(this.z);;){if(v.iadd(this.curve.n),v.cmp(this.curve.p)>=0)return!1;if(h.redIAdd(b),this.x.cmp(h)===0)return!0}},p.prototype.toP=p.prototype.normalize,p.prototype.mixedAdd=p.prototype.add},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],408:[function(e,a,n){var o=n;o.base=e("./base"),o.short=e("./short"),o.mont=e("./mont"),o.edwards=e("./edwards")},{"./base":406,"./edwards":407,"./mont":409,"./short":410}],409:[function(e,a,n){var o=e("bn.js"),s=e("inherits"),l=e("./base"),c=e("../utils");function i(p){l.call(this,"mont",p),this.a=new o(p.a,16).toRed(this.red),this.b=new o(p.b,16).toRed(this.red),this.i4=new o(4).toRed(this.red).redInvm(),this.two=new o(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function u(p,f,h){l.BasePoint.call(this,p,"projective"),f===null&&h===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new o(f,16),this.z=new o(h,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}s(i,l),a.exports=i,i.prototype.validate=function(p){var f=p.normalize().x,h=f.redSqr(),v=h.redMul(f).redAdd(h.redMul(this.a)).redAdd(f);return v.redSqrt().redSqr().cmp(v)===0},s(u,l.BasePoint),i.prototype.decodePoint=function(p,f){return this.point(c.toArray(p,f),1)},i.prototype.point=function(p,f){return new u(this,p,f)},i.prototype.pointFromJSON=function(p){return u.fromJSON(this,p)},u.prototype.precompute=function(){},u.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},u.fromJSON=function(p,f){return new u(p,f[0],f[1]||p.one)},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return this.z.cmpn(0)===0},u.prototype.dbl=function(){var p=this.x.redAdd(this.z).redSqr(),f=this.x.redSub(this.z).redSqr(),h=p.redSub(f),v=p.redMul(f),b=h.redMul(f.redAdd(this.curve.a24.redMul(h)));return this.curve.point(v,b)},u.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.diffAdd=function(p,f){var h=this.x.redAdd(this.z),v=this.x.redSub(this.z),b=p.x.redAdd(p.z),g=p.x.redSub(p.z).redMul(h),x=b.redMul(v),y=f.z.redMul(g.redAdd(x).redSqr()),E=f.x.redMul(g.redISub(x).redSqr());return this.curve.point(y,E)},u.prototype.mul=function(p){for(var f=p.clone(),h=this,v=this.curve.point(null,null),b=[];f.cmpn(0)!==0;f.iushrn(1))b.push(f.andln(1));for(var g=b.length-1;g>=0;g--)b[g]===0?(h=h.diffAdd(v,this),v=v.dbl()):(v=h.diffAdd(v,this),h=h.dbl());return v},u.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.eq=function(p){return this.getX().cmp(p.getX())===0},u.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},u.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],410:[function(e,a,n){var o=e("../utils"),s=e("bn.js"),l=e("inherits"),c=e("./base"),i=o.assert;function u(h){c.call(this,"short",h),this.a=new s(h.a,16).toRed(this.red),this.b=new s(h.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(h),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function p(h,v,b,g){c.BasePoint.call(this,h,"affine"),v===null&&b===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new s(v,16),this.y=new s(b,16),g&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function f(h,v,b,g){c.BasePoint.call(this,h,"jacobian"),v===null&&b===null&&g===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new s(0)):(this.x=new s(v,16),this.y=new s(b,16),this.z=new s(g,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}l(u,c),a.exports=u,u.prototype._getEndomorphism=function(h){if(this.zeroA&&this.g&&this.n&&this.p.modn(3)===1){var v,b;if(h.beta)v=new s(h.beta,16).toRed(this.red);else{var g=this._getEndoRoots(this.p);v=(v=g[0].cmp(g[1])<0?g[0]:g[1]).toRed(this.red)}if(h.lambda)b=new s(h.lambda,16);else{var x=this._getEndoRoots(this.n);this.g.mul(x[0]).x.cmp(this.g.x.redMul(v))===0?b=x[0]:(b=x[1],i(this.g.mul(b).x.cmp(this.g.x.redMul(v))===0))}return{beta:v,lambda:b,basis:h.basis?h.basis.map(function(y){return{a:new s(y.a,16),b:new s(y.b,16)}}):this._getEndoBasis(b)}}},u.prototype._getEndoRoots=function(h){var v=h===this.p?this.red:s.mont(h),b=new s(2).toRed(v).redInvm(),g=b.redNeg(),x=new s(3).toRed(v).redNeg().redSqrt().redMul(b);return[g.redAdd(x).fromRed(),g.redSub(x).fromRed()]},u.prototype._getEndoBasis=function(h){for(var v,b,g,x,y,E,N,I,P,V=this.n.ushrn(Math.floor(this.n.bitLength()/2)),U=h,H=this.n.clone(),G=new s(1),Z=new s(0),W=new s(0),O=new s(1),R=0;U.cmpn(0)!==0;){var C=H.div(U);I=H.sub(C.mul(U)),P=W.sub(C.mul(G));var _=O.sub(C.mul(Z));if(!g&&I.cmp(V)<0)v=N.neg(),b=G,g=I.neg(),x=P;else if(g&&++R==2)break;N=I,H=U,U=I,W=G,G=P,O=Z,Z=_}y=I.neg(),E=P;var k=g.sqr().add(x.sqr());return y.sqr().add(E.sqr()).cmp(k)>=0&&(y=v,E=b),g.negative&&(g=g.neg(),x=x.neg()),y.negative&&(y=y.neg(),E=E.neg()),[{a:g,b:x},{a:y,b:E}]},u.prototype._endoSplit=function(h){var v=this.endo.basis,b=v[0],g=v[1],x=g.b.mul(h).divRound(this.n),y=b.b.neg().mul(h).divRound(this.n),E=x.mul(b.a),N=y.mul(g.a),I=x.mul(b.b),P=y.mul(g.b);return{k1:h.sub(E).sub(N),k2:I.add(P).neg()}},u.prototype.pointFromX=function(h,v){(h=new s(h,16)).red||(h=h.toRed(this.red));var b=h.redSqr().redMul(h).redIAdd(h.redMul(this.a)).redIAdd(this.b),g=b.redSqrt();if(g.redSqr().redSub(b).cmp(this.zero)!==0)throw new Error("invalid point");var x=g.fromRed().isOdd();return(v&&!x||!v&&x)&&(g=g.redNeg()),this.point(h,g)},u.prototype.validate=function(h){if(h.inf)return!0;var v=h.x,b=h.y,g=this.a.redMul(v),x=v.redSqr().redMul(v).redIAdd(g).redIAdd(this.b);return b.redSqr().redISub(x).cmpn(0)===0},u.prototype._endoWnafMulAdd=function(h,v,b){for(var g=this._endoWnafT1,x=this._endoWnafT2,y=0;y<h.length;y++){var E=this._endoSplit(v[y]),N=h[y],I=N._getBeta();E.k1.negative&&(E.k1.ineg(),N=N.neg(!0)),E.k2.negative&&(E.k2.ineg(),I=I.neg(!0)),g[2*y]=N,g[2*y+1]=I,x[2*y]=E.k1,x[2*y+1]=E.k2}for(var P=this._wnafMulAdd(1,g,x,2*y,b),V=0;V<2*y;V++)g[V]=null,x[V]=null;return P},l(p,c.BasePoint),u.prototype.point=function(h,v,b){return new p(this,h,v,b)},u.prototype.pointFromJSON=function(h,v){return p.fromJSON(this,h,v)},p.prototype._getBeta=function(){if(this.curve.endo){var h=this.precomputed;if(h&&h.beta)return h.beta;var v=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(h){var b=this.curve,g=function(x){return b.point(x.x.redMul(b.endo.beta),x.y)};h.beta=v,v.precomputed={beta:null,naf:h.naf&&{wnd:h.naf.wnd,points:h.naf.points.map(g)},doubles:h.doubles&&{step:h.doubles.step,points:h.doubles.points.map(g)}}}return v}},p.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},p.fromJSON=function(h,v,b){typeof v=="string"&&(v=JSON.parse(v));var g=h.point(v[0],v[1],b);if(!v[2])return g;function x(E){return h.point(E[0],E[1],b)}var y=v[2];return g.precomputed={beta:null,doubles:y.doubles&&{step:y.doubles.step,points:[g].concat(y.doubles.points.map(x))},naf:y.naf&&{wnd:y.naf.wnd,points:[g].concat(y.naf.points.map(x))}},g},p.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},p.prototype.isInfinity=function(){return this.inf},p.prototype.add=function(h){if(this.inf)return h;if(h.inf)return this;if(this.eq(h))return this.dbl();if(this.neg().eq(h))return this.curve.point(null,null);if(this.x.cmp(h.x)===0)return this.curve.point(null,null);var v=this.y.redSub(h.y);v.cmpn(0)!==0&&(v=v.redMul(this.x.redSub(h.x).redInvm()));var b=v.redSqr().redISub(this.x).redISub(h.x),g=v.redMul(this.x.redSub(b)).redISub(this.y);return this.curve.point(b,g)},p.prototype.dbl=function(){if(this.inf)return this;var h=this.y.redAdd(this.y);if(h.cmpn(0)===0)return this.curve.point(null,null);var v=this.curve.a,b=this.x.redSqr(),g=h.redInvm(),x=b.redAdd(b).redIAdd(b).redIAdd(v).redMul(g),y=x.redSqr().redISub(this.x.redAdd(this.x)),E=x.redMul(this.x.redSub(y)).redISub(this.y);return this.curve.point(y,E)},p.prototype.getX=function(){return this.x.fromRed()},p.prototype.getY=function(){return this.y.fromRed()},p.prototype.mul=function(h){return h=new s(h,16),this.isInfinity()?this:this._hasDoubles(h)?this.curve._fixedNafMul(this,h):this.curve.endo?this.curve._endoWnafMulAdd([this],[h]):this.curve._wnafMul(this,h)},p.prototype.mulAdd=function(h,v,b){var g=[this,v],x=[h,b];return this.curve.endo?this.curve._endoWnafMulAdd(g,x):this.curve._wnafMulAdd(1,g,x,2)},p.prototype.jmulAdd=function(h,v,b){var g=[this,v],x=[h,b];return this.curve.endo?this.curve._endoWnafMulAdd(g,x,!0):this.curve._wnafMulAdd(1,g,x,2,!0)},p.prototype.eq=function(h){return this===h||this.inf===h.inf&&(this.inf||this.x.cmp(h.x)===0&&this.y.cmp(h.y)===0)},p.prototype.neg=function(h){if(this.inf)return this;var v=this.curve.point(this.x,this.y.redNeg());if(h&&this.precomputed){var b=this.precomputed,g=function(x){return x.neg()};v.precomputed={naf:b.naf&&{wnd:b.naf.wnd,points:b.naf.points.map(g)},doubles:b.doubles&&{step:b.doubles.step,points:b.doubles.points.map(g)}}}return v},p.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},l(f,c.BasePoint),u.prototype.jpoint=function(h,v,b){return new f(this,h,v,b)},f.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var h=this.z.redInvm(),v=h.redSqr(),b=this.x.redMul(v),g=this.y.redMul(v).redMul(h);return this.curve.point(b,g)},f.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},f.prototype.add=function(h){if(this.isInfinity())return h;if(h.isInfinity())return this;var v=h.z.redSqr(),b=this.z.redSqr(),g=this.x.redMul(v),x=h.x.redMul(b),y=this.y.redMul(v.redMul(h.z)),E=h.y.redMul(b.redMul(this.z)),N=g.redSub(x),I=y.redSub(E);if(N.cmpn(0)===0)return I.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var P=N.redSqr(),V=P.redMul(N),U=g.redMul(P),H=I.redSqr().redIAdd(V).redISub(U).redISub(U),G=I.redMul(U.redISub(H)).redISub(y.redMul(V)),Z=this.z.redMul(h.z).redMul(N);return this.curve.jpoint(H,G,Z)},f.prototype.mixedAdd=function(h){if(this.isInfinity())return h.toJ();if(h.isInfinity())return this;var v=this.z.redSqr(),b=this.x,g=h.x.redMul(v),x=this.y,y=h.y.redMul(v).redMul(this.z),E=b.redSub(g),N=x.redSub(y);if(E.cmpn(0)===0)return N.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var I=E.redSqr(),P=I.redMul(E),V=b.redMul(I),U=N.redSqr().redIAdd(P).redISub(V).redISub(V),H=N.redMul(V.redISub(U)).redISub(x.redMul(P)),G=this.z.redMul(E);return this.curve.jpoint(U,H,G)},f.prototype.dblp=function(h){if(h===0)return this;if(this.isInfinity())return this;if(!h)return this.dbl();var v;if(this.curve.zeroA||this.curve.threeA){var b=this;for(v=0;v<h;v++)b=b.dbl();return b}var g=this.curve.a,x=this.curve.tinv,y=this.x,E=this.y,N=this.z,I=N.redSqr().redSqr(),P=E.redAdd(E);for(v=0;v<h;v++){var V=y.redSqr(),U=P.redSqr(),H=U.redSqr(),G=V.redAdd(V).redIAdd(V).redIAdd(g.redMul(I)),Z=y.redMul(U),W=G.redSqr().redISub(Z.redAdd(Z)),O=Z.redISub(W),R=G.redMul(O);R=R.redIAdd(R).redISub(H);var C=P.redMul(N);v+1<h&&(I=I.redMul(H)),y=W,N=C,P=R}return this.curve.jpoint(y,P.redMul(x),N)},f.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},f.prototype._zeroDbl=function(){var h,v,b;if(this.zOne){var g=this.x.redSqr(),x=this.y.redSqr(),y=x.redSqr(),E=this.x.redAdd(x).redSqr().redISub(g).redISub(y);E=E.redIAdd(E);var N=g.redAdd(g).redIAdd(g),I=N.redSqr().redISub(E).redISub(E),P=y.redIAdd(y);P=(P=P.redIAdd(P)).redIAdd(P),h=I,v=N.redMul(E.redISub(I)).redISub(P),b=this.y.redAdd(this.y)}else{var V=this.x.redSqr(),U=this.y.redSqr(),H=U.redSqr(),G=this.x.redAdd(U).redSqr().redISub(V).redISub(H);G=G.redIAdd(G);var Z=V.redAdd(V).redIAdd(V),W=Z.redSqr(),O=H.redIAdd(H);O=(O=O.redIAdd(O)).redIAdd(O),h=W.redISub(G).redISub(G),v=Z.redMul(G.redISub(h)).redISub(O),b=(b=this.y.redMul(this.z)).redIAdd(b)}return this.curve.jpoint(h,v,b)},f.prototype._threeDbl=function(){var h,v,b;if(this.zOne){var g=this.x.redSqr(),x=this.y.redSqr(),y=x.redSqr(),E=this.x.redAdd(x).redSqr().redISub(g).redISub(y);E=E.redIAdd(E);var N=g.redAdd(g).redIAdd(g).redIAdd(this.curve.a),I=N.redSqr().redISub(E).redISub(E);h=I;var P=y.redIAdd(y);P=(P=P.redIAdd(P)).redIAdd(P),v=N.redMul(E.redISub(I)).redISub(P),b=this.y.redAdd(this.y)}else{var V=this.z.redSqr(),U=this.y.redSqr(),H=this.x.redMul(U),G=this.x.redSub(V).redMul(this.x.redAdd(V));G=G.redAdd(G).redIAdd(G);var Z=H.redIAdd(H),W=(Z=Z.redIAdd(Z)).redAdd(Z);h=G.redSqr().redISub(W),b=this.y.redAdd(this.z).redSqr().redISub(U).redISub(V);var O=U.redSqr();O=(O=(O=O.redIAdd(O)).redIAdd(O)).redIAdd(O),v=G.redMul(Z.redISub(h)).redISub(O)}return this.curve.jpoint(h,v,b)},f.prototype._dbl=function(){var h=this.curve.a,v=this.x,b=this.y,g=this.z,x=g.redSqr().redSqr(),y=v.redSqr(),E=b.redSqr(),N=y.redAdd(y).redIAdd(y).redIAdd(h.redMul(x)),I=v.redAdd(v),P=(I=I.redIAdd(I)).redMul(E),V=N.redSqr().redISub(P.redAdd(P)),U=P.redISub(V),H=E.redSqr();H=(H=(H=H.redIAdd(H)).redIAdd(H)).redIAdd(H);var G=N.redMul(U).redISub(H),Z=b.redAdd(b).redMul(g);return this.curve.jpoint(V,G,Z)},f.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var h=this.x.redSqr(),v=this.y.redSqr(),b=this.z.redSqr(),g=v.redSqr(),x=h.redAdd(h).redIAdd(h),y=x.redSqr(),E=this.x.redAdd(v).redSqr().redISub(h).redISub(g),N=(E=(E=(E=E.redIAdd(E)).redAdd(E).redIAdd(E)).redISub(y)).redSqr(),I=g.redIAdd(g);I=(I=(I=I.redIAdd(I)).redIAdd(I)).redIAdd(I);var P=x.redIAdd(E).redSqr().redISub(y).redISub(N).redISub(I),V=v.redMul(P);V=(V=V.redIAdd(V)).redIAdd(V);var U=this.x.redMul(N).redISub(V);U=(U=U.redIAdd(U)).redIAdd(U);var H=this.y.redMul(P.redMul(I.redISub(P)).redISub(E.redMul(N)));H=(H=(H=H.redIAdd(H)).redIAdd(H)).redIAdd(H);var G=this.z.redAdd(E).redSqr().redISub(b).redISub(N);return this.curve.jpoint(U,H,G)},f.prototype.mul=function(h,v){return h=new s(h,v),this.curve._wnafMul(this,h)},f.prototype.eq=function(h){if(h.type==="affine")return this.eq(h.toJ());if(this===h)return!0;var v=this.z.redSqr(),b=h.z.redSqr();if(this.x.redMul(b).redISub(h.x.redMul(v)).cmpn(0)!==0)return!1;var g=v.redMul(this.z),x=b.redMul(h.z);return this.y.redMul(x).redISub(h.y.redMul(g)).cmpn(0)===0},f.prototype.eqXToP=function(h){var v=this.z.redSqr(),b=h.toRed(this.curve.red).redMul(v);if(this.x.cmp(b)===0)return!0;for(var g=h.clone(),x=this.curve.redN.redMul(v);;){if(g.iadd(this.curve.n),g.cmp(this.curve.p)>=0)return!1;if(b.redIAdd(x),this.x.cmp(b)===0)return!0}},f.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},f.prototype.isInfinity=function(){return this.z.cmpn(0)===0}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],411:[function(e,a,n){var o,s=n,l=e("hash.js"),c=e("./curve"),i=e("./utils").assert;function u(f){f.type==="short"?this.curve=new c.short(f):f.type==="edwards"?this.curve=new c.edwards(f):this.curve=new c.mont(f),this.g=this.curve.g,this.n=this.curve.n,this.hash=f.hash,i(this.g.validate(),"Invalid curve"),i(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function p(f,h){Object.defineProperty(s,f,{configurable:!0,enumerable:!0,get:function(){var v=new u(h);return Object.defineProperty(s,f,{configurable:!0,enumerable:!0,value:v}),v}})}s.PresetCurve=u,p("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:l.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),p("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:l.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),p("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:l.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),p("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:l.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),p("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:l.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),p("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:l.sha256,gRed:!1,g:["9"]}),p("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:l.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{o=e("./precomputed/secp256k1")}catch{o=void 0}p("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:l.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",o]})},{"./curve":408,"./precomputed/secp256k1":418,"./utils":419,"hash.js":426}],412:[function(e,a,n){var o=e("bn.js"),s=e("hmac-drbg"),l=e("../utils"),c=e("../curves"),i=e("brorand"),u=l.assert,p=e("./key"),f=e("./signature");function h(v){if(!(this instanceof h))return new h(v);typeof v=="string"&&(u(Object.prototype.hasOwnProperty.call(c,v),"Unknown curve "+v),v=c[v]),v instanceof c.PresetCurve&&(v={curve:v}),this.curve=v.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=v.curve.g,this.g.precompute(v.curve.n.bitLength()+1),this.hash=v.hash||v.curve.hash}a.exports=h,h.prototype.keyPair=function(v){return new p(this,v)},h.prototype.keyFromPrivate=function(v,b){return p.fromPrivate(this,v,b)},h.prototype.keyFromPublic=function(v,b){return p.fromPublic(this,v,b)},h.prototype.genKeyPair=function(v){v||(v={});for(var b=new s({hash:this.hash,pers:v.pers,persEnc:v.persEnc||"utf8",entropy:v.entropy||i(this.hash.hmacStrength),entropyEnc:v.entropy&&v.entropyEnc||"utf8",nonce:this.n.toArray()}),g=this.n.byteLength(),x=this.n.sub(new o(2));;){var y=new o(b.generate(g));if(!(y.cmp(x)>0))return y.iaddn(1),this.keyFromPrivate(y)}},h.prototype._truncateToN=function(v,b){var g=8*v.byteLength()-this.n.bitLength();return g>0&&(v=v.ushrn(g)),!b&&v.cmp(this.n)>=0?v.sub(this.n):v},h.prototype.sign=function(v,b,g,x){typeof g=="object"&&(x=g,g=null),x||(x={}),b=this.keyFromPrivate(b,g),v=this._truncateToN(new o(v,16));for(var y=this.n.byteLength(),E=b.getPrivate().toArray("be",y),N=v.toArray("be",y),I=new s({hash:this.hash,entropy:E,nonce:N,pers:x.pers,persEnc:x.persEnc||"utf8"}),P=this.n.sub(new o(1)),V=0;;V++){var U=x.k?x.k(V):new o(I.generate(this.n.byteLength()));if(!((U=this._truncateToN(U,!0)).cmpn(1)<=0||U.cmp(P)>=0)){var H=this.g.mul(U);if(!H.isInfinity()){var G=H.getX(),Z=G.umod(this.n);if(Z.cmpn(0)!==0){var W=U.invm(this.n).mul(Z.mul(b.getPrivate()).iadd(v));if((W=W.umod(this.n)).cmpn(0)!==0){var O=(H.getY().isOdd()?1:0)|(G.cmp(Z)!==0?2:0);return x.canonical&&W.cmp(this.nh)>0&&(W=this.n.sub(W),O^=1),new f({r:Z,s:W,recoveryParam:O})}}}}}},h.prototype.verify=function(v,b,g,x){v=this._truncateToN(new o(v,16)),g=this.keyFromPublic(g,x);var y=(b=new f(b,"hex")).r,E=b.s;if(y.cmpn(1)<0||y.cmp(this.n)>=0||E.cmpn(1)<0||E.cmp(this.n)>=0)return!1;var N,I=E.invm(this.n),P=I.mul(v).umod(this.n),V=I.mul(y).umod(this.n);return this.curve._maxwellTrick?!(N=this.g.jmulAdd(P,g.getPublic(),V)).isInfinity()&&N.eqXToP(y):!(N=this.g.mulAdd(P,g.getPublic(),V)).isInfinity()&&N.getX().umod(this.n).cmp(y)===0},h.prototype.recoverPubKey=function(v,b,g,x){u((3&g)===g,"The recovery param is more than two bits"),b=new f(b,x);var y=this.n,E=new o(v),N=b.r,I=b.s,P=1&g,V=g>>1;if(N.cmp(this.curve.p.umod(this.curve.n))>=0&&V)throw new Error("Unable to find sencond key candinate");N=V?this.curve.pointFromX(N.add(this.curve.n),P):this.curve.pointFromX(N,P);var U=b.r.invm(y),H=y.sub(E).mul(U).umod(y),G=I.mul(U).umod(y);return this.g.mulAdd(H,N,G)},h.prototype.getKeyRecoveryParam=function(v,b,g,x){if((b=new f(b,x)).recoveryParam!==null)return b.recoveryParam;for(var y=0;y<4;y++){var E;try{E=this.recoverPubKey(v,b,y)}catch{continue}if(E.eq(g))return y}throw new Error("Unable to find valid recovery factor")}},{"../curves":411,"../utils":419,"./key":413,"./signature":414,"bn.js":420,brorand:187,"hmac-drbg":438}],413:[function(e,a,n){var o=e("bn.js"),s=e("../utils").assert;function l(c,i){this.ec=c,this.priv=null,this.pub=null,i.priv&&this._importPrivate(i.priv,i.privEnc),i.pub&&this._importPublic(i.pub,i.pubEnc)}a.exports=l,l.fromPublic=function(c,i,u){return i instanceof l?i:new l(c,{pub:i,pubEnc:u})},l.fromPrivate=function(c,i,u){return i instanceof l?i:new l(c,{priv:i,privEnc:u})},l.prototype.validate=function(){var c=this.getPublic();return c.isInfinity()?{result:!1,reason:"Invalid public key"}:c.validate()?c.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},l.prototype.getPublic=function(c,i){return typeof c=="string"&&(i=c,c=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),i?this.pub.encode(i,c):this.pub},l.prototype.getPrivate=function(c){return c==="hex"?this.priv.toString(16,2):this.priv},l.prototype._importPrivate=function(c,i){this.priv=new o(c,i||16),this.priv=this.priv.umod(this.ec.curve.n)},l.prototype._importPublic=function(c,i){if(c.x||c.y)return this.ec.curve.type==="mont"?s(c.x,"Need x coordinate"):this.ec.curve.type!=="short"&&this.ec.curve.type!=="edwards"||s(c.x&&c.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(c.x,c.y));this.pub=this.ec.curve.decodePoint(c,i)},l.prototype.derive=function(c){return c.validate()||s(c.validate(),"public point not validated"),c.mul(this.priv).getX()},l.prototype.sign=function(c,i,u){return this.ec.sign(c,this,i,u)},l.prototype.verify=function(c,i){return this.ec.verify(c,i,this)},l.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":419,"bn.js":420}],414:[function(e,a,n){var o=e("bn.js"),s=e("../utils"),l=s.assert;function c(h,v){if(h instanceof c)return h;this._importDER(h,v)||(l(h.r&&h.s,"Signature without r or s"),this.r=new o(h.r,16),this.s=new o(h.s,16),h.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=h.recoveryParam)}function i(){this.place=0}function u(h,v){var b=h[v.place++];if(!(128&b))return b;var g=15&b;if(g===0||g>4)return!1;for(var x=0,y=0,E=v.place;y<g;y++,E++)x<<=8,x|=h[E],x>>>=0;return!(x<=127)&&(v.place=E,x)}function p(h){for(var v=0,b=h.length-1;!h[v]&&!(128&h[v+1])&&v<b;)v++;return v===0?h:h.slice(v)}function f(h,v){if(v<128)h.push(v);else{var b=1+(Math.log(v)/Math.LN2>>>3);for(h.push(128|b);--b;)h.push(v>>>(b<<3)&255);h.push(v)}}a.exports=c,c.prototype._importDER=function(h,v){h=s.toArray(h,v);var b=new i;if(h[b.place++]!==48)return!1;var g=u(h,b);if(g===!1||g+b.place!==h.length||h[b.place++]!==2)return!1;var x=u(h,b);if(x===!1)return!1;var y=h.slice(b.place,x+b.place);if(b.place+=x,h[b.place++]!==2)return!1;var E=u(h,b);if(E===!1||h.length!==E+b.place)return!1;var N=h.slice(b.place,E+b.place);if(y[0]===0){if(!(128&y[1]))return!1;y=y.slice(1)}if(N[0]===0){if(!(128&N[1]))return!1;N=N.slice(1)}return this.r=new o(y),this.s=new o(N),this.recoveryParam=null,!0},c.prototype.toDER=function(h){var v=this.r.toArray(),b=this.s.toArray();for(128&v[0]&&(v=[0].concat(v)),128&b[0]&&(b=[0].concat(b)),v=p(v),b=p(b);!(b[0]||128&b[1]);)b=b.slice(1);var g=[2];f(g,v.length),(g=g.concat(v)).push(2),f(g,b.length);var x=g.concat(b),y=[48];return f(y,x.length),y=y.concat(x),s.encode(y,h)}},{"../utils":419,"bn.js":420}],415:[function(e,a,n){var o=e("hash.js"),s=e("../curves"),l=e("../utils"),c=l.assert,i=l.parseBytes,u=e("./key"),p=e("./signature");function f(h){if(c(h==="ed25519","only tested with ed25519 so far"),!(this instanceof f))return new f(h);h=s[h].curve,this.curve=h,this.g=h.g,this.g.precompute(h.n.bitLength()+1),this.pointClass=h.point().constructor,this.encodingLength=Math.ceil(h.n.bitLength()/8),this.hash=o.sha512}a.exports=f,f.prototype.sign=function(h,v){h=i(h);var b=this.keyFromSecret(v),g=this.hashInt(b.messagePrefix(),h),x=this.g.mul(g),y=this.encodePoint(x),E=this.hashInt(y,b.pubBytes(),h).mul(b.priv()),N=g.add(E).umod(this.curve.n);return this.makeSignature({R:x,S:N,Rencoded:y})},f.prototype.verify=function(h,v,b){h=i(h),v=this.makeSignature(v);var g=this.keyFromPublic(b),x=this.hashInt(v.Rencoded(),g.pubBytes(),h),y=this.g.mul(v.S());return v.R().add(g.pub().mul(x)).eq(y)},f.prototype.hashInt=function(){for(var h=this.hash(),v=0;v<arguments.length;v++)h.update(arguments[v]);return l.intFromLE(h.digest()).umod(this.curve.n)},f.prototype.keyFromPublic=function(h){return u.fromPublic(this,h)},f.prototype.keyFromSecret=function(h){return u.fromSecret(this,h)},f.prototype.makeSignature=function(h){return h instanceof p?h:new p(this,h)},f.prototype.encodePoint=function(h){var v=h.getY().toArray("le",this.encodingLength);return v[this.encodingLength-1]|=h.getX().isOdd()?128:0,v},f.prototype.decodePoint=function(h){var v=(h=l.parseBytes(h)).length-1,b=h.slice(0,v).concat(-129&h[v]),g=(128&h[v])!=0,x=l.intFromLE(b);return this.curve.pointFromY(x,g)},f.prototype.encodeInt=function(h){return h.toArray("le",this.encodingLength)},f.prototype.decodeInt=function(h){return l.intFromLE(h)},f.prototype.isPoint=function(h){return h instanceof this.pointClass}},{"../curves":411,"../utils":419,"./key":416,"./signature":417,"hash.js":426}],416:[function(e,a,n){var o=e("../utils"),s=o.assert,l=o.parseBytes,c=o.cachedProperty;function i(u,p){this.eddsa=u,this._secret=l(p.secret),u.isPoint(p.pub)?this._pub=p.pub:this._pubBytes=l(p.pub)}i.fromPublic=function(u,p){return p instanceof i?p:new i(u,{pub:p})},i.fromSecret=function(u,p){return p instanceof i?p:new i(u,{secret:p})},i.prototype.secret=function(){return this._secret},c(i,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),c(i,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),c(i,"privBytes",function(){var u=this.eddsa,p=this.hash(),f=u.encodingLength-1,h=p.slice(0,u.encodingLength);return h[0]&=248,h[f]&=127,h[f]|=64,h}),c(i,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),c(i,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),c(i,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),i.prototype.sign=function(u){return s(this._secret,"KeyPair can only verify"),this.eddsa.sign(u,this)},i.prototype.verify=function(u,p){return this.eddsa.verify(u,p,this)},i.prototype.getSecret=function(u){return s(this._secret,"KeyPair is public only"),o.encode(this.secret(),u)},i.prototype.getPublic=function(u){return o.encode(this.pubBytes(),u)},a.exports=i},{"../utils":419}],417:[function(e,a,n){var o=e("bn.js"),s=e("../utils"),l=s.assert,c=s.cachedProperty,i=s.parseBytes;function u(p,f){this.eddsa=p,typeof f!="object"&&(f=i(f)),Array.isArray(f)&&(f={R:f.slice(0,p.encodingLength),S:f.slice(p.encodingLength)}),l(f.R&&f.S,"Signature without R or S"),p.isPoint(f.R)&&(this._R=f.R),f.S instanceof o&&(this._S=f.S),this._Rencoded=Array.isArray(f.R)?f.R:f.Rencoded,this._Sencoded=Array.isArray(f.S)?f.S:f.Sencoded}c(u,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),c(u,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),c(u,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),c(u,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),u.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},u.prototype.toHex=function(){return s.encode(this.toBytes(),"hex").toUpperCase()},a.exports=u},{"../utils":419,"bn.js":420}],418:[function(e,a,n){a.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],419:[function(e,a,n){var o=n,s=e("bn.js"),l=e("minimalistic-assert"),c=e("minimalistic-crypto-utils");o.assert=l,o.toArray=c.toArray,o.zero2=c.zero2,o.toHex=c.toHex,o.encode=c.encode,o.getNAF=function(i,u,p){var f=new Array(Math.max(i.bitLength(),p)+1);f.fill(0);for(var h=1<<u+1,v=i.clone(),b=0;b<f.length;b++){var g,x=v.andln(h-1);v.isOdd()?(g=x>(h>>1)-1?(h>>1)-x:x,v.isubn(g)):g=0,f[b]=g,v.iushrn(1)}return f},o.getJSF=function(i,u){var p=[[],[]];i=i.clone(),u=u.clone();for(var f,h=0,v=0;i.cmpn(-h)>0||u.cmpn(-v)>0;){var b,g,x=i.andln(3)+h&3,y=u.andln(3)+v&3;x===3&&(x=-1),y===3&&(y=-1),b=(1&x)==0?0:(f=i.andln(7)+h&7)!==3&&f!==5||y!==2?x:-x,p[0].push(b),g=(1&y)==0?0:(f=u.andln(7)+v&7)!==3&&f!==5||x!==2?y:-y,p[1].push(g),2*h===b+1&&(h=1-h),2*v===g+1&&(v=1-v),i.iushrn(1),u.iushrn(1)}return p},o.cachedProperty=function(i,u,p){var f="_"+u;i.prototype[u]=function(){return this[f]!==void 0?this[f]:this[f]=p.call(this)}},o.parseBytes=function(i){return typeof i=="string"?o.toArray(i,"hex"):i},o.intFromLE=function(i){return new s(i,"hex","le")}},{"bn.js":420,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],420:[function(e,a,n){arguments[4][184][0].apply(n,arguments)},{buffer:188,dup:184}],421:[function(e,a,n){a.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}],422:[function(e,a,n){var o=Object.create||function(U){var H=function(){};return H.prototype=U,new H},s=Object.keys||function(U){var H=[];for(var G in U)Object.prototype.hasOwnProperty.call(U,G)&&H.push(G);return G},l=Function.prototype.bind||function(U){var H=this;return function(){return H.apply(U,arguments)}};function c(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=o(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}a.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0;var i,u=10;try{var p={};Object.defineProperty&&Object.defineProperty(p,"x",{value:0}),i=p.x===0}catch{i=!1}function f(U){return U._maxListeners===void 0?c.defaultMaxListeners:U._maxListeners}function h(U,H,G){if(H)U.call(G);else for(var Z=U.length,W=V(U,Z),O=0;O<Z;++O)W[O].call(G)}function v(U,H,G,Z){if(H)U.call(G,Z);else for(var W=U.length,O=V(U,W),R=0;R<W;++R)O[R].call(G,Z)}function b(U,H,G,Z,W){if(H)U.call(G,Z,W);else for(var O=U.length,R=V(U,O),C=0;C<O;++C)R[C].call(G,Z,W)}function g(U,H,G,Z,W,O){if(H)U.call(G,Z,W,O);else for(var R=U.length,C=V(U,R),_=0;_<R;++_)C[_].call(G,Z,W,O)}function x(U,H,G,Z){if(H)U.apply(G,Z);else for(var W=U.length,O=V(U,W),R=0;R<W;++R)O[R].apply(G,Z)}function y(U,H,G,Z){var W,O,R;if(typeof G!="function")throw new TypeError('"listener" argument must be a function');if((O=U._events)?(O.newListener&&(U.emit("newListener",H,G.listener?G.listener:G),O=U._events),R=O[H]):(O=U._events=o(null),U._eventsCount=0),R){if(typeof R=="function"?R=O[H]=Z?[G,R]:[R,G]:Z?R.unshift(G):R.push(G),!R.warned&&(W=f(U))&&W>0&&R.length>W){R.warned=!0;var C=new Error("Possible EventEmitter memory leak detected. "+R.length+' "'+String(H)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');C.name="MaxListenersExceededWarning",C.emitter=U,C.type=H,C.count=R.length,typeof console=="object"&&console.warn&&console.warn("%s: %s",C.name,C.message)}}else R=O[H]=G,++U._eventsCount;return U}function E(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var U=new Array(arguments.length),H=0;H<U.length;++H)U[H]=arguments[H];this.listener.apply(this.target,U)}}function N(U,H,G){var Z={fired:!1,wrapFn:void 0,target:U,type:H,listener:G},W=l.call(E,Z);return W.listener=G,Z.wrapFn=W,W}function I(U,H,G){var Z=U._events;if(!Z)return[];var W=Z[H];return W?typeof W=="function"?G?[W.listener||W]:[W]:G?function(O){for(var R=new Array(O.length),C=0;C<R.length;++C)R[C]=O[C].listener||O[C];return R}(W):V(W,W.length):[]}function P(U){var H=this._events;if(H){var G=H[U];if(typeof G=="function")return 1;if(G)return G.length}return 0}function V(U,H){for(var G=new Array(H),Z=0;Z<H;++Z)G[Z]=U[Z];return G}i?Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(U){if(typeof U!="number"||U<0||U!=U)throw new TypeError('"defaultMaxListeners" must be a positive number');u=U}}):c.defaultMaxListeners=u,c.prototype.setMaxListeners=function(U){if(typeof U!="number"||U<0||isNaN(U))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=U,this},c.prototype.getMaxListeners=function(){return f(this)},c.prototype.emit=function(U){var H,G,Z,W,O,R,C=U==="error";if(R=this._events)C=C&&R.error==null;else if(!C)return!1;if(C){if(arguments.length>1&&(H=arguments[1]),H instanceof Error)throw H;var _=new Error('Unhandled "error" event. ('+H+")");throw _.context=H,_}if(!(G=R[U]))return!1;var k=typeof G=="function";switch(Z=arguments.length){case 1:h(G,k,this);break;case 2:v(G,k,this,arguments[1]);break;case 3:b(G,k,this,arguments[1],arguments[2]);break;case 4:g(G,k,this,arguments[1],arguments[2],arguments[3]);break;default:for(W=new Array(Z-1),O=1;O<Z;O++)W[O-1]=arguments[O];x(G,k,this,W)}return!0},c.prototype.addListener=function(U,H){return y(this,U,H,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(U,H){return y(this,U,H,!0)},c.prototype.once=function(U,H){if(typeof H!="function")throw new TypeError('"listener" argument must be a function');return this.on(U,N(this,U,H)),this},c.prototype.prependOnceListener=function(U,H){if(typeof H!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(U,N(this,U,H)),this},c.prototype.removeListener=function(U,H){var G,Z,W,O,R;if(typeof H!="function")throw new TypeError('"listener" argument must be a function');if(!(Z=this._events))return this;if(!(G=Z[U]))return this;if(G===H||G.listener===H)--this._eventsCount==0?this._events=o(null):(delete Z[U],Z.removeListener&&this.emit("removeListener",U,G.listener||H));else if(typeof G!="function"){for(W=-1,O=G.length-1;O>=0;O--)if(G[O]===H||G[O].listener===H){R=G[O].listener,W=O;break}if(W<0)return this;W===0?G.shift():function(C,_){for(var k=_,A=k+1,T=C.length;A<T;k+=1,A+=1)C[k]=C[A];C.pop()}(G,W),G.length===1&&(Z[U]=G[0]),Z.removeListener&&this.emit("removeListener",U,R||H)}return this},c.prototype.removeAllListeners=function(U){var H,G,Z;if(!(G=this._events))return this;if(!G.removeListener)return arguments.length===0?(this._events=o(null),this._eventsCount=0):G[U]&&(--this._eventsCount==0?this._events=o(null):delete G[U]),this;if(arguments.length===0){var W,O=s(G);for(Z=0;Z<O.length;++Z)(W=O[Z])!=="removeListener"&&this.removeAllListeners(W);return this.removeAllListeners("removeListener"),this._events=o(null),this._eventsCount=0,this}if(typeof(H=G[U])=="function")this.removeListener(U,H);else if(H)for(Z=H.length-1;Z>=0;Z--)this.removeListener(U,H[Z]);return this},c.prototype.listeners=function(U){return I(this,U,!0)},c.prototype.rawListeners=function(U){return I(this,U,!1)},c.listenerCount=function(U,H){return typeof U.listenerCount=="function"?U.listenerCount(H):P.call(U,H)},c.prototype.listenerCount=P,c.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],423:[function(e,a,n){var o=e("safe-buffer").Buffer,s=e("md5.js");a.exports=function(l,c,i,u){if(o.isBuffer(l)||(l=o.from(l,"binary")),c&&(o.isBuffer(c)||(c=o.from(c,"binary")),c.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var p=i/8,f=o.alloc(p),h=o.alloc(u||0),v=o.alloc(0);p>0||u>0;){var b=new s;b.update(v),b.update(l),c&&b.update(c),v=b.digest();var g=0;if(p>0){var x=f.length-p;g=Math.min(p,v.length),v.copy(f,x,0,g),p-=g}if(g<v.length&&u>0){var y=h.length-u,E=Math.min(u,v.length-g);v.copy(h,y,g,g+E),u-=E}}return v.fill(0),{key:f,iv:h}}},{"md5.js":450,"safe-buffer":494}],424:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CsvParserStream=n.ParserOptions=n.parseFile=n.parseStream=n.parseString=n.parse=n.FormatterOptions=n.CsvFormatterStream=n.writeToPath=n.writeToString=n.writeToBuffer=n.writeToStream=n.write=n.format=void 0;var o=e("@fast-csv/format");Object.defineProperty(n,"format",{enumerable:!0,get:function(){return o.format}}),Object.defineProperty(n,"write",{enumerable:!0,get:function(){return o.write}}),Object.defineProperty(n,"writeToStream",{enumerable:!0,get:function(){return o.writeToStream}}),Object.defineProperty(n,"writeToBuffer",{enumerable:!0,get:function(){return o.writeToBuffer}}),Object.defineProperty(n,"writeToString",{enumerable:!0,get:function(){return o.writeToString}}),Object.defineProperty(n,"writeToPath",{enumerable:!0,get:function(){return o.writeToPath}}),Object.defineProperty(n,"CsvFormatterStream",{enumerable:!0,get:function(){return o.CsvFormatterStream}}),Object.defineProperty(n,"FormatterOptions",{enumerable:!0,get:function(){return o.FormatterOptions}});var s=e("@fast-csv/parse");Object.defineProperty(n,"parse",{enumerable:!0,get:function(){return s.parse}}),Object.defineProperty(n,"parseString",{enumerable:!0,get:function(){return s.parseString}}),Object.defineProperty(n,"parseStream",{enumerable:!0,get:function(){return s.parseStream}}),Object.defineProperty(n,"parseFile",{enumerable:!0,get:function(){return s.parseFile}}),Object.defineProperty(n,"ParserOptions",{enumerable:!0,get:function(){return s.ParserOptions}}),Object.defineProperty(n,"CsvParserStream",{enumerable:!0,get:function(){return s.CsvParserStream}})},{"@fast-csv/format":151,"@fast-csv/parse":155}],425:[function(e,a,n){var o=e("safe-buffer").Buffer,s=e("readable-stream").Transform;function l(c){s.call(this),this._block=o.allocUnsafe(c),this._blockSize=c,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}e("inherits")(l,s),l.prototype._transform=function(c,i,u){var p=null;try{this.update(c,i)}catch(f){p=f}u(p)},l.prototype._flush=function(c){var i=null;try{this.push(this.digest())}catch(u){i=u}c(i)},l.prototype.update=function(c,i){if(function(b,g){if(!o.isBuffer(b)&&typeof b!="string")throw new TypeError(g+" must be a string or a buffer")}(c,"Data"),this._finalized)throw new Error("Digest already called");o.isBuffer(c)||(c=o.from(c,i));for(var u=this._block,p=0;this._blockOffset+c.length-p>=this._blockSize;){for(var f=this._blockOffset;f<this._blockSize;)u[f++]=c[p++];this._update(),this._blockOffset=0}for(;p<c.length;)u[this._blockOffset++]=c[p++];for(var h=0,v=8*c.length;v>0;++h)this._length[h]+=v,(v=this._length[h]/4294967296|0)>0&&(this._length[h]-=4294967296*v);return this},l.prototype._update=function(){throw new Error("_update is not implemented")},l.prototype.digest=function(c){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var i=this._digest();c!==void 0&&(i=i.toString(c)),this._block.fill(0),this._blockOffset=0;for(var u=0;u<4;++u)this._length[u]=0;return i},l.prototype._digest=function(){throw new Error("_digest is not implemented")},a.exports=l},{inherits:440,"readable-stream":491,"safe-buffer":494}],426:[function(e,a,n){var o=n;o.utils=e("./hash/utils"),o.common=e("./hash/common"),o.sha=e("./hash/sha"),o.ripemd=e("./hash/ripemd"),o.hmac=e("./hash/hmac"),o.sha1=o.sha.sha1,o.sha256=o.sha.sha256,o.sha224=o.sha.sha224,o.sha384=o.sha.sha384,o.sha512=o.sha.sha512,o.ripemd160=o.ripemd.ripemd160},{"./hash/common":427,"./hash/hmac":428,"./hash/ripemd":429,"./hash/sha":430,"./hash/utils":437}],427:[function(e,a,n){var o=e("./utils"),s=e("minimalistic-assert");function l(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}n.BlockHash=l,l.prototype.update=function(c,i){if(c=o.toArray(c,i),this.pending?this.pending=this.pending.concat(c):this.pending=c,this.pendingTotal+=c.length,this.pending.length>=this._delta8){var u=(c=this.pending).length%this._delta8;this.pending=c.slice(c.length-u,c.length),this.pending.length===0&&(this.pending=null),c=o.join32(c,0,c.length-u,this.endian);for(var p=0;p<c.length;p+=this._delta32)this._update(c,p,p+this._delta32)}return this},l.prototype.digest=function(c){return this.update(this._pad()),s(this.pending===null),this._digest(c)},l.prototype._pad=function(){var c=this.pendingTotal,i=this._delta8,u=i-(c+this.padLength)%i,p=new Array(u+this.padLength);p[0]=128;for(var f=1;f<u;f++)p[f]=0;if(c<<=3,this.endian==="big"){for(var h=8;h<this.padLength;h++)p[f++]=0;p[f++]=0,p[f++]=0,p[f++]=0,p[f++]=0,p[f++]=c>>>24&255,p[f++]=c>>>16&255,p[f++]=c>>>8&255,p[f++]=255&c}else for(p[f++]=255&c,p[f++]=c>>>8&255,p[f++]=c>>>16&255,p[f++]=c>>>24&255,p[f++]=0,p[f++]=0,p[f++]=0,p[f++]=0,h=8;h<this.padLength;h++)p[f++]=0;return p}},{"./utils":437,"minimalistic-assert":453}],428:[function(e,a,n){var o=e("./utils"),s=e("minimalistic-assert");function l(c,i,u){if(!(this instanceof l))return new l(c,i,u);this.Hash=c,this.blockSize=c.blockSize/8,this.outSize=c.outSize/8,this.inner=null,this.outer=null,this._init(o.toArray(i,u))}a.exports=l,l.prototype._init=function(c){c.length>this.blockSize&&(c=new this.Hash().update(c).digest()),s(c.length<=this.blockSize);for(var i=c.length;i<this.blockSize;i++)c.push(0);for(i=0;i<c.length;i++)c[i]^=54;for(this.inner=new this.Hash().update(c),i=0;i<c.length;i++)c[i]^=106;this.outer=new this.Hash().update(c)},l.prototype.update=function(c,i){return this.inner.update(c,i),this},l.prototype.digest=function(c){return this.outer.update(this.inner.digest()),this.outer.digest(c)}},{"./utils":437,"minimalistic-assert":453}],429:[function(e,a,n){var o=e("./utils"),s=e("./common"),l=o.rotl32,c=o.sum32,i=o.sum32_3,u=o.sum32_4,p=s.BlockHash;function f(){if(!(this instanceof f))return new f;p.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function h(N,I,P,V){return N<=15?I^P^V:N<=31?I&P|~I&V:N<=47?(I|~P)^V:N<=63?I&V|P&~V:I^(P|~V)}function v(N){return N<=15?0:N<=31?1518500249:N<=47?1859775393:N<=63?2400959708:2840853838}function b(N){return N<=15?1352829926:N<=31?1548603684:N<=47?1836072691:N<=63?2053994217:0}o.inherits(f,p),n.ripemd160=f,f.blockSize=512,f.outSize=160,f.hmacStrength=192,f.padLength=64,f.prototype._update=function(N,I){for(var P=this.h[0],V=this.h[1],U=this.h[2],H=this.h[3],G=this.h[4],Z=P,W=V,O=U,R=H,C=G,_=0;_<80;_++){var k=c(l(u(P,h(_,V,U,H),N[g[_]+I],v(_)),y[_]),G);P=G,G=H,H=l(U,10),U=V,V=k,k=c(l(u(Z,h(79-_,W,O,R),N[x[_]+I],b(_)),E[_]),C),Z=C,C=R,R=l(O,10),O=W,W=k}k=i(this.h[1],U,R),this.h[1]=i(this.h[2],H,C),this.h[2]=i(this.h[3],G,Z),this.h[3]=i(this.h[4],P,W),this.h[4]=i(this.h[0],V,O),this.h[0]=k},f.prototype._digest=function(N){return N==="hex"?o.toHex32(this.h,"little"):o.split32(this.h,"little")};var g=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],x=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],y=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],E=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":427,"./utils":437}],430:[function(e,a,n){n.sha1=e("./sha/1"),n.sha224=e("./sha/224"),n.sha256=e("./sha/256"),n.sha384=e("./sha/384"),n.sha512=e("./sha/512")},{"./sha/1":431,"./sha/224":432,"./sha/256":433,"./sha/384":434,"./sha/512":435}],431:[function(e,a,n){var o=e("../utils"),s=e("../common"),l=e("./common"),c=o.rotl32,i=o.sum32,u=o.sum32_5,p=l.ft_1,f=s.BlockHash,h=[1518500249,1859775393,2400959708,3395469782];function v(){if(!(this instanceof v))return new v;f.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}o.inherits(v,f),a.exports=v,v.blockSize=512,v.outSize=160,v.hmacStrength=80,v.padLength=64,v.prototype._update=function(b,g){for(var x=this.W,y=0;y<16;y++)x[y]=b[g+y];for(;y<x.length;y++)x[y]=c(x[y-3]^x[y-8]^x[y-14]^x[y-16],1);var E=this.h[0],N=this.h[1],I=this.h[2],P=this.h[3],V=this.h[4];for(y=0;y<x.length;y++){var U=~~(y/20),H=u(c(E,5),p(U,N,I,P),V,x[y],h[U]);V=P,P=I,I=c(N,30),N=E,E=H}this.h[0]=i(this.h[0],E),this.h[1]=i(this.h[1],N),this.h[2]=i(this.h[2],I),this.h[3]=i(this.h[3],P),this.h[4]=i(this.h[4],V)},v.prototype._digest=function(b){return b==="hex"?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436}],432:[function(e,a,n){var o=e("../utils"),s=e("./256");function l(){if(!(this instanceof l))return new l;s.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}o.inherits(l,s),a.exports=l,l.blockSize=512,l.outSize=224,l.hmacStrength=192,l.padLength=64,l.prototype._digest=function(c){return c==="hex"?o.toHex32(this.h.slice(0,7),"big"):o.split32(this.h.slice(0,7),"big")}},{"../utils":437,"./256":433}],433:[function(e,a,n){var o=e("../utils"),s=e("../common"),l=e("./common"),c=e("minimalistic-assert"),i=o.sum32,u=o.sum32_4,p=o.sum32_5,f=l.ch32,h=l.maj32,v=l.s0_256,b=l.s1_256,g=l.g0_256,x=l.g1_256,y=s.BlockHash,E=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function N(){if(!(this instanceof N))return new N;y.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=E,this.W=new Array(64)}o.inherits(N,y),a.exports=N,N.blockSize=512,N.outSize=256,N.hmacStrength=192,N.padLength=64,N.prototype._update=function(I,P){for(var V=this.W,U=0;U<16;U++)V[U]=I[P+U];for(;U<V.length;U++)V[U]=u(x(V[U-2]),V[U-7],g(V[U-15]),V[U-16]);var H=this.h[0],G=this.h[1],Z=this.h[2],W=this.h[3],O=this.h[4],R=this.h[5],C=this.h[6],_=this.h[7];for(c(this.k.length===V.length),U=0;U<V.length;U++){var k=p(_,b(O),f(O,R,C),this.k[U],V[U]),A=i(v(H),h(H,G,Z));_=C,C=R,R=O,O=i(W,k),W=Z,Z=G,G=H,H=i(k,A)}this.h[0]=i(this.h[0],H),this.h[1]=i(this.h[1],G),this.h[2]=i(this.h[2],Z),this.h[3]=i(this.h[3],W),this.h[4]=i(this.h[4],O),this.h[5]=i(this.h[5],R),this.h[6]=i(this.h[6],C),this.h[7]=i(this.h[7],_)},N.prototype._digest=function(I){return I==="hex"?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436,"minimalistic-assert":453}],434:[function(e,a,n){var o=e("../utils"),s=e("./512");function l(){if(!(this instanceof l))return new l;s.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}o.inherits(l,s),a.exports=l,l.blockSize=1024,l.outSize=384,l.hmacStrength=192,l.padLength=128,l.prototype._digest=function(c){return c==="hex"?o.toHex32(this.h.slice(0,12),"big"):o.split32(this.h.slice(0,12),"big")}},{"../utils":437,"./512":435}],435:[function(e,a,n){var o=e("../utils"),s=e("../common"),l=e("minimalistic-assert"),c=o.rotr64_hi,i=o.rotr64_lo,u=o.shr64_hi,p=o.shr64_lo,f=o.sum64,h=o.sum64_hi,v=o.sum64_lo,b=o.sum64_4_hi,g=o.sum64_4_lo,x=o.sum64_5_hi,y=o.sum64_5_lo,E=s.BlockHash,N=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function I(){if(!(this instanceof I))return new I;E.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=N,this.W=new Array(160)}function P(A,T,D,B,F){var Y=A&D^~A&F;return Y<0&&(Y+=4294967296),Y}function V(A,T,D,B,F,Y){var X=T&B^~T&Y;return X<0&&(X+=4294967296),X}function U(A,T,D,B,F){var Y=A&D^A&F^D&F;return Y<0&&(Y+=4294967296),Y}function H(A,T,D,B,F,Y){var X=T&B^T&Y^B&Y;return X<0&&(X+=4294967296),X}function G(A,T){var D=c(A,T,28)^c(T,A,2)^c(T,A,7);return D<0&&(D+=4294967296),D}function Z(A,T){var D=i(A,T,28)^i(T,A,2)^i(T,A,7);return D<0&&(D+=4294967296),D}function W(A,T){var D=c(A,T,14)^c(A,T,18)^c(T,A,9);return D<0&&(D+=4294967296),D}function O(A,T){var D=i(A,T,14)^i(A,T,18)^i(T,A,9);return D<0&&(D+=4294967296),D}function R(A,T){var D=c(A,T,1)^c(A,T,8)^u(A,T,7);return D<0&&(D+=4294967296),D}function C(A,T){var D=i(A,T,1)^i(A,T,8)^p(A,T,7);return D<0&&(D+=4294967296),D}function _(A,T){var D=c(A,T,19)^c(T,A,29)^u(A,T,6);return D<0&&(D+=4294967296),D}function k(A,T){var D=i(A,T,19)^i(T,A,29)^p(A,T,6);return D<0&&(D+=4294967296),D}o.inherits(I,E),a.exports=I,I.blockSize=1024,I.outSize=512,I.hmacStrength=192,I.padLength=128,I.prototype._prepareBlock=function(A,T){for(var D=this.W,B=0;B<32;B++)D[B]=A[T+B];for(;B<D.length;B+=2){var F=_(D[B-4],D[B-3]),Y=k(D[B-4],D[B-3]),X=D[B-14],re=D[B-13],z=R(D[B-30],D[B-29]),ee=C(D[B-30],D[B-29]),L=D[B-32],M=D[B-31];D[B]=b(F,Y,X,re,z,ee,L,M),D[B+1]=g(F,Y,X,re,z,ee,L,M)}},I.prototype._update=function(A,T){this._prepareBlock(A,T);var D=this.W,B=this.h[0],F=this.h[1],Y=this.h[2],X=this.h[3],re=this.h[4],z=this.h[5],ee=this.h[6],L=this.h[7],M=this.h[8],K=this.h[9],se=this.h[10],te=this.h[11],ae=this.h[12],Q=this.h[13],fe=this.h[14],le=this.h[15];l(this.k.length===D.length);for(var ne=0;ne<D.length;ne+=2){var ue=fe,he=le,ke=W(M,K),pe=O(M,K),Ce=P(M,K,se,te,ae),Me=V(M,K,se,te,ae,Q),Ie=this.k[ne],Ye=this.k[ne+1],at=D[ne],rt=D[ne+1],it=x(ue,he,ke,pe,Ce,Me,Ie,Ye,at,rt),et=y(ue,he,ke,pe,Ce,Me,Ie,Ye,at,rt);ue=G(B,F),he=Z(B,F),ke=U(B,F,Y,X,re),pe=H(B,F,Y,X,re,z);var st=h(ue,he,ke,pe),je=v(ue,he,ke,pe);fe=ae,le=Q,ae=se,Q=te,se=M,te=K,M=h(ee,L,it,et),K=v(L,L,it,et),ee=re,L=z,re=Y,z=X,Y=B,X=F,B=h(it,et,st,je),F=v(it,et,st,je)}f(this.h,0,B,F),f(this.h,2,Y,X),f(this.h,4,re,z),f(this.h,6,ee,L),f(this.h,8,M,K),f(this.h,10,se,te),f(this.h,12,ae,Q),f(this.h,14,fe,le)},I.prototype._digest=function(A){return A==="hex"?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":427,"../utils":437,"minimalistic-assert":453}],436:[function(e,a,n){var o=e("../utils").rotr32;function s(i,u,p){return i&u^~i&p}function l(i,u,p){return i&u^i&p^u&p}function c(i,u,p){return i^u^p}n.ft_1=function(i,u,p,f){return i===0?s(u,p,f):i===1||i===3?c(u,p,f):i===2?l(u,p,f):void 0},n.ch32=s,n.maj32=l,n.p32=c,n.s0_256=function(i){return o(i,2)^o(i,13)^o(i,22)},n.s1_256=function(i){return o(i,6)^o(i,11)^o(i,25)},n.g0_256=function(i){return o(i,7)^o(i,18)^i>>>3},n.g1_256=function(i){return o(i,17)^o(i,19)^i>>>10}},{"../utils":437}],437:[function(e,a,n){var o=e("minimalistic-assert"),s=e("inherits");function l(p,f){return(64512&p.charCodeAt(f))==55296&&!(f<0||f+1>=p.length)&&(64512&p.charCodeAt(f+1))==56320}function c(p){return(p>>>24|p>>>8&65280|p<<8&16711680|(255&p)<<24)>>>0}function i(p){return p.length===1?"0"+p:p}function u(p){return p.length===7?"0"+p:p.length===6?"00"+p:p.length===5?"000"+p:p.length===4?"0000"+p:p.length===3?"00000"+p:p.length===2?"000000"+p:p.length===1?"0000000"+p:p}n.inherits=s,n.toArray=function(p,f){if(Array.isArray(p))return p.slice();if(!p)return[];var h=[];if(typeof p=="string")if(f){if(f==="hex")for((p=p.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(p="0"+p),b=0;b<p.length;b+=2)h.push(parseInt(p[b]+p[b+1],16))}else for(var v=0,b=0;b<p.length;b++){var g=p.charCodeAt(b);g<128?h[v++]=g:g<2048?(h[v++]=g>>6|192,h[v++]=63&g|128):l(p,b)?(g=65536+((1023&g)<<10)+(1023&p.charCodeAt(++b)),h[v++]=g>>18|240,h[v++]=g>>12&63|128,h[v++]=g>>6&63|128,h[v++]=63&g|128):(h[v++]=g>>12|224,h[v++]=g>>6&63|128,h[v++]=63&g|128)}else for(b=0;b<p.length;b++)h[b]=0|p[b];return h},n.toHex=function(p){for(var f="",h=0;h<p.length;h++)f+=i(p[h].toString(16));return f},n.htonl=c,n.toHex32=function(p,f){for(var h="",v=0;v<p.length;v++){var b=p[v];f==="little"&&(b=c(b)),h+=u(b.toString(16))}return h},n.zero2=i,n.zero8=u,n.join32=function(p,f,h,v){var b=h-f;o(b%4==0);for(var g=new Array(b/4),x=0,y=f;x<g.length;x++,y+=4){var E;E=v==="big"?p[y]<<24|p[y+1]<<16|p[y+2]<<8|p[y+3]:p[y+3]<<24|p[y+2]<<16|p[y+1]<<8|p[y],g[x]=E>>>0}return g},n.split32=function(p,f){for(var h=new Array(4*p.length),v=0,b=0;v<p.length;v++,b+=4){var g=p[v];f==="big"?(h[b]=g>>>24,h[b+1]=g>>>16&255,h[b+2]=g>>>8&255,h[b+3]=255&g):(h[b+3]=g>>>24,h[b+2]=g>>>16&255,h[b+1]=g>>>8&255,h[b]=255&g)}return h},n.rotr32=function(p,f){return p>>>f|p<<32-f},n.rotl32=function(p,f){return p<<f|p>>>32-f},n.sum32=function(p,f){return p+f>>>0},n.sum32_3=function(p,f,h){return p+f+h>>>0},n.sum32_4=function(p,f,h,v){return p+f+h+v>>>0},n.sum32_5=function(p,f,h,v,b){return p+f+h+v+b>>>0},n.sum64=function(p,f,h,v){var b=p[f],g=v+p[f+1]>>>0,x=(g<v?1:0)+h+b;p[f]=x>>>0,p[f+1]=g},n.sum64_hi=function(p,f,h,v){return(f+v>>>0<f?1:0)+p+h>>>0},n.sum64_lo=function(p,f,h,v){return f+v>>>0},n.sum64_4_hi=function(p,f,h,v,b,g,x,y){var E=0,N=f;return E+=(N=N+v>>>0)<f?1:0,E+=(N=N+g>>>0)<g?1:0,p+h+b+x+(E+=(N=N+y>>>0)<y?1:0)>>>0},n.sum64_4_lo=function(p,f,h,v,b,g,x,y){return f+v+g+y>>>0},n.sum64_5_hi=function(p,f,h,v,b,g,x,y,E,N){var I=0,P=f;return I+=(P=P+v>>>0)<f?1:0,I+=(P=P+g>>>0)<g?1:0,I+=(P=P+y>>>0)<y?1:0,p+h+b+x+E+(I+=(P=P+N>>>0)<N?1:0)>>>0},n.sum64_5_lo=function(p,f,h,v,b,g,x,y,E,N){return f+v+g+y+N>>>0},n.rotr64_hi=function(p,f,h){return(f<<32-h|p>>>h)>>>0},n.rotr64_lo=function(p,f,h){return(p<<32-h|f>>>h)>>>0},n.shr64_hi=function(p,f,h){return p>>>h},n.shr64_lo=function(p,f,h){return(p<<32-h|f>>>h)>>>0}},{inherits:440,"minimalistic-assert":453}],438:[function(e,a,n){var o=e("hash.js"),s=e("minimalistic-crypto-utils"),l=e("minimalistic-assert");function c(i){if(!(this instanceof c))return new c(i);this.hash=i.hash,this.predResist=!!i.predResist,this.outLen=this.hash.outSize,this.minEntropy=i.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var u=s.toArray(i.entropy,i.entropyEnc||"hex"),p=s.toArray(i.nonce,i.nonceEnc||"hex"),f=s.toArray(i.pers,i.persEnc||"hex");l(u.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(u,p,f)}a.exports=c,c.prototype._init=function(i,u,p){var f=i.concat(u).concat(p);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var h=0;h<this.V.length;h++)this.K[h]=0,this.V[h]=1;this._update(f),this._reseed=1,this.reseedInterval=281474976710656},c.prototype._hmac=function(){return new o.hmac(this.hash,this.K)},c.prototype._update=function(i){var u=this._hmac().update(this.V).update([0]);i&&(u=u.update(i)),this.K=u.digest(),this.V=this._hmac().update(this.V).digest(),i&&(this.K=this._hmac().update(this.V).update([1]).update(i).digest(),this.V=this._hmac().update(this.V).digest())},c.prototype.reseed=function(i,u,p,f){typeof u!="string"&&(f=p,p=u,u=null),i=s.toArray(i,u),p=s.toArray(p,f),l(i.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(i.concat(p||[])),this._reseed=1},c.prototype.generate=function(i,u,p,f){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof u!="string"&&(f=p,p=u,u=null),p&&(p=s.toArray(p,f||"hex"),this._update(p));for(var h=[];h.length<i;)this.V=this._hmac().update(this.V).digest(),h=h.concat(this.V);var v=h.slice(0,i);return this._update(p),this._reseed++,s.encode(v,u)}},{"hash.js":426,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],439:[function(e,a,n){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */n.read=function(o,s,l,c,i){var u,p,f=8*i-c-1,h=(1<<f)-1,v=h>>1,b=-7,g=l?i-1:0,x=l?-1:1,y=o[s+g];for(g+=x,u=y&(1<<-b)-1,y>>=-b,b+=f;b>0;u=256*u+o[s+g],g+=x,b-=8);for(p=u&(1<<-b)-1,u>>=-b,b+=c;b>0;p=256*p+o[s+g],g+=x,b-=8);if(u===0)u=1-v;else{if(u===h)return p?NaN:1/0*(y?-1:1);p+=Math.pow(2,c),u-=v}return(y?-1:1)*p*Math.pow(2,u-c)},n.write=function(o,s,l,c,i,u){var p,f,h,v=8*u-i-1,b=(1<<v)-1,g=b>>1,x=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=c?0:u-1,E=c?1:-1,N=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(f=isNaN(s)?1:0,p=b):(p=Math.floor(Math.log(s)/Math.LN2),s*(h=Math.pow(2,-p))<1&&(p--,h*=2),(s+=p+g>=1?x/h:x*Math.pow(2,1-g))*h>=2&&(p++,h/=2),p+g>=b?(f=0,p=b):p+g>=1?(f=(s*h-1)*Math.pow(2,i),p+=g):(f=s*Math.pow(2,g-1)*Math.pow(2,i),p=0));i>=8;o[l+y]=255&f,y+=E,f/=256,i-=8);for(p=p<<i|f,v+=i;v>0;o[l+y]=255&p,y+=E,p/=256,v-=8);o[l+y-E]|=128*N}},{}],440:[function(e,a,n){typeof Object.create=="function"?a.exports=function(o,s){s&&(o.super_=s,o.prototype=Object.create(s.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}))}:a.exports=function(o,s){if(s){o.super_=s;var l=function(){};l.prototype=s.prototype,o.prototype=new l,o.prototype.constructor=o}}},{}],441:[function(e,a,n){(function(o,s,l,c,i,u,p,f){(function(){/*!

		JSZip v3.10.1 - A JavaScript class for generating and reading zip files
		<http://stuartk.com/jszip>

		(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
		Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

		JSZip uses the library pako released under the MIT license :
		https://github.com/nodeca/pako/blob/main/LICENSE
		*/(function(h){typeof n=="object"&&a!==void 0?a.exports=h():(typeof window<"u"?window:s!==void 0?s:typeof self<"u"?self:this).JSZip=h()})(function(){return function h(v,b,g){function x(N,I){if(!b[N]){if(!v[N]){var P=typeof e=="function"&&e;if(!I&&P)return P(N,!0);if(y)return y(N,!0);var V=new Error("Cannot find module '"+N+"'");throw V.code="MODULE_NOT_FOUND",V}var U=b[N]={exports:{}};v[N][0].call(U.exports,function(H){return x(v[N][1][H]||H)},U,U.exports,h,v,b,g)}return b[N].exports}for(var y=typeof e=="function"&&e,E=0;E<g.length;E++)x(g[E]);return x}({1:[function(h,v,b){var g=h("./utils"),x=h("./support"),y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";b.encode=function(E){for(var N,I,P,V,U,H,G,Z=[],W=0,O=E.length,R=O,C=g.getTypeOf(E)!=="string";W<E.length;)R=O-W,P=C?(N=E[W++],I=W<O?E[W++]:0,W<O?E[W++]:0):(N=E.charCodeAt(W++),I=W<O?E.charCodeAt(W++):0,W<O?E.charCodeAt(W++):0),V=N>>2,U=(3&N)<<4|I>>4,H=1<R?(15&I)<<2|P>>6:64,G=2<R?63&P:64,Z.push(y.charAt(V)+y.charAt(U)+y.charAt(H)+y.charAt(G));return Z.join("")},b.decode=function(E){var N,I,P,V,U,H,G=0,Z=0,W="data:";if(E.substr(0,W.length)===W)throw new Error("Invalid base64 input, it looks like a data url.");var O,R=3*(E=E.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(E.charAt(E.length-1)===y.charAt(64)&&R--,E.charAt(E.length-2)===y.charAt(64)&&R--,R%1!=0)throw new Error("Invalid base64 input, bad content length.");for(O=x.uint8array?new Uint8Array(0|R):new Array(0|R);G<E.length;)N=y.indexOf(E.charAt(G++))<<2|(V=y.indexOf(E.charAt(G++)))>>4,I=(15&V)<<4|(U=y.indexOf(E.charAt(G++)))>>2,P=(3&U)<<6|(H=y.indexOf(E.charAt(G++))),O[Z++]=N,U!==64&&(O[Z++]=I),H!==64&&(O[Z++]=P);return O}},{"./support":30,"./utils":32}],2:[function(h,v,b){var g=h("./external"),x=h("./stream/DataWorker"),y=h("./stream/Crc32Probe"),E=h("./stream/DataLengthProbe");function N(I,P,V,U,H){this.compressedSize=I,this.uncompressedSize=P,this.crc32=V,this.compression=U,this.compressedContent=H}N.prototype={getContentWorker:function(){var I=new x(g.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new E("data_length")),P=this;return I.on("end",function(){if(this.streamInfo.data_length!==P.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),I},getCompressedWorker:function(){return new x(g.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},N.createWorkerFrom=function(I,P,V){return I.pipe(new y).pipe(new E("uncompressedSize")).pipe(P.compressWorker(V)).pipe(new E("compressedSize")).withStreamInfo("compression",P)},v.exports=N},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(h,v,b){var g=h("./stream/GenericWorker");b.STORE={magic:"\0\0",compressWorker:function(){return new g("STORE compression")},uncompressWorker:function(){return new g("STORE decompression")}},b.DEFLATE=h("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(h,v,b){var g=h("./utils"),x=function(){for(var y,E=[],N=0;N<256;N++){y=N;for(var I=0;I<8;I++)y=1&y?3988292384^y>>>1:y>>>1;E[N]=y}return E}();v.exports=function(y,E){return y!==void 0&&y.length?g.getTypeOf(y)!=="string"?function(N,I,P,V){var U=x,H=0+P;N^=-1;for(var G=0;G<H;G++)N=N>>>8^U[255&(N^I[G])];return-1^N}(0|E,y,y.length):function(N,I,P,V){var U=x,H=0+P;N^=-1;for(var G=0;G<H;G++)N=N>>>8^U[255&(N^I.charCodeAt(G))];return-1^N}(0|E,y,y.length):0}},{"./utils":32}],5:[function(h,v,b){b.base64=!1,b.binary=!1,b.dir=!1,b.createFolders=!0,b.date=null,b.compression=null,b.compressionOptions=null,b.comment=null,b.unixPermissions=null,b.dosPermissions=null},{}],6:[function(h,v,b){var g;g=typeof Promise<"u"?Promise:h("lie"),v.exports={Promise:g}},{lie:37}],7:[function(h,v,b){var g=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",x=h("pako"),y=h("./utils"),E=h("./stream/GenericWorker"),N=g?"uint8array":"array";function I(P,V){E.call(this,"FlateWorker/"+P),this._pako=null,this._pakoAction=P,this._pakoOptions=V,this.meta={}}b.magic="\b\0",y.inherits(I,E),I.prototype.processChunk=function(P){this.meta=P.meta,this._pako===null&&this._createPako(),this._pako.push(y.transformTo(N,P.data),!1)},I.prototype.flush=function(){E.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},I.prototype.cleanUp=function(){E.prototype.cleanUp.call(this),this._pako=null},I.prototype._createPako=function(){this._pako=new x[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var P=this;this._pako.onData=function(V){P.push({data:V,meta:P.meta})}},b.compressWorker=function(P){return new I("Deflate",P)},b.uncompressWorker=function(){return new I("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(h,v,b){function g(U,H){var G,Z="";for(G=0;G<H;G++)Z+=String.fromCharCode(255&U),U>>>=8;return Z}function x(U,H,G,Z,W,O){var R,C,_=U.file,k=U.compression,A=O!==N.utf8encode,T=y.transformTo("string",O(_.name)),D=y.transformTo("string",N.utf8encode(_.name)),B=_.comment,F=y.transformTo("string",O(B)),Y=y.transformTo("string",N.utf8encode(B)),X=D.length!==_.name.length,re=Y.length!==B.length,z="",ee="",L="",M=_.dir,K=_.date,se={crc32:0,compressedSize:0,uncompressedSize:0};H&&!G||(se.crc32=U.crc32,se.compressedSize=U.compressedSize,se.uncompressedSize=U.uncompressedSize);var te=0;H&&(te|=8),A||!X&&!re||(te|=2048);var ae=0,Q=0;M&&(ae|=16),W==="UNIX"?(Q=798,ae|=function(le,ne){var ue=le;return le||(ue=ne?16893:33204),(65535&ue)<<16}(_.unixPermissions,M)):(Q=20,ae|=function(le){return 63&(le||0)}(_.dosPermissions)),R=K.getUTCHours(),R<<=6,R|=K.getUTCMinutes(),R<<=5,R|=K.getUTCSeconds()/2,C=K.getUTCFullYear()-1980,C<<=4,C|=K.getUTCMonth()+1,C<<=5,C|=K.getUTCDate(),X&&(ee=g(1,1)+g(I(T),4)+D,z+="up"+g(ee.length,2)+ee),re&&(L=g(1,1)+g(I(F),4)+Y,z+="uc"+g(L.length,2)+L);var fe="";return fe+=`
\0`,fe+=g(te,2),fe+=k.magic,fe+=g(R,2),fe+=g(C,2),fe+=g(se.crc32,4),fe+=g(se.compressedSize,4),fe+=g(se.uncompressedSize,4),fe+=g(T.length,2),fe+=g(z.length,2),{fileRecord:P.LOCAL_FILE_HEADER+fe+T+z,dirRecord:P.CENTRAL_FILE_HEADER+g(Q,2)+fe+g(F.length,2)+"\0\0\0\0"+g(ae,4)+g(Z,4)+T+z+F}}var y=h("../utils"),E=h("../stream/GenericWorker"),N=h("../utf8"),I=h("../crc32"),P=h("../signature");function V(U,H,G,Z){E.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=H,this.zipPlatform=G,this.encodeFileName=Z,this.streamFiles=U,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}y.inherits(V,E),V.prototype.push=function(U){var H=U.meta.percent||0,G=this.entriesCount,Z=this._sources.length;this.accumulate?this.contentBuffer.push(U):(this.bytesWritten+=U.data.length,E.prototype.push.call(this,{data:U.data,meta:{currentFile:this.currentFile,percent:G?(H+100*(G-Z-1))/G:100}}))},V.prototype.openedSource=function(U){this.currentSourceOffset=this.bytesWritten,this.currentFile=U.file.name;var H=this.streamFiles&&!U.file.dir;if(H){var G=x(U,H,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:G.fileRecord,meta:{percent:0}})}else this.accumulate=!0},V.prototype.closedSource=function(U){this.accumulate=!1;var H=this.streamFiles&&!U.file.dir,G=x(U,H,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(G.dirRecord),H)this.push({data:function(Z){return P.DATA_DESCRIPTOR+g(Z.crc32,4)+g(Z.compressedSize,4)+g(Z.uncompressedSize,4)}(U),meta:{percent:100}});else for(this.push({data:G.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},V.prototype.flush=function(){for(var U=this.bytesWritten,H=0;H<this.dirRecords.length;H++)this.push({data:this.dirRecords[H],meta:{percent:100}});var G=this.bytesWritten-U,Z=function(W,O,R,C,_){var k=y.transformTo("string",_(C));return P.CENTRAL_DIRECTORY_END+"\0\0\0\0"+g(W,2)+g(W,2)+g(O,4)+g(R,4)+g(k.length,2)+k}(this.dirRecords.length,G,U,this.zipComment,this.encodeFileName);this.push({data:Z,meta:{percent:100}})},V.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},V.prototype.registerPrevious=function(U){this._sources.push(U);var H=this;return U.on("data",function(G){H.processChunk(G)}),U.on("end",function(){H.closedSource(H.previous.streamInfo),H._sources.length?H.prepareNextSource():H.end()}),U.on("error",function(G){H.error(G)}),this},V.prototype.resume=function(){return!!E.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},V.prototype.error=function(U){var H=this._sources;if(!E.prototype.error.call(this,U))return!1;for(var G=0;G<H.length;G++)try{H[G].error(U)}catch{}return!0},V.prototype.lock=function(){E.prototype.lock.call(this);for(var U=this._sources,H=0;H<U.length;H++)U[H].lock()},v.exports=V},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(h,v,b){var g=h("../compressions"),x=h("./ZipFileWorker");b.generateWorker=function(y,E,N){var I=new x(E.streamFiles,N,E.platform,E.encodeFileName),P=0;try{y.forEach(function(V,U){P++;var H=function(O,R){var C=O||R,_=g[C];if(!_)throw new Error(C+" is not a valid compression method !");return _}(U.options.compression,E.compression),G=U.options.compressionOptions||E.compressionOptions||{},Z=U.dir,W=U.date;U._compressWorker(H,G).withStreamInfo("file",{name:V,dir:Z,date:W,comment:U.comment||"",unixPermissions:U.unixPermissions,dosPermissions:U.dosPermissions}).pipe(I)}),I.entriesCount=P}catch(V){I.error(V)}return I}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(h,v,b){function g(){if(!(this instanceof g))return new g;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var x=new g;for(var y in this)typeof this[y]!="function"&&(x[y]=this[y]);return x}}(g.prototype=h("./object")).loadAsync=h("./load"),g.support=h("./support"),g.defaults=h("./defaults"),g.version="3.10.1",g.loadAsync=function(x,y){return new g().loadAsync(x,y)},g.external=h("./external"),v.exports=g},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(h,v,b){var g=h("./utils"),x=h("./external"),y=h("./utf8"),E=h("./zipEntries"),N=h("./stream/Crc32Probe"),I=h("./nodejsUtils");function P(V){return new x.Promise(function(U,H){var G=V.decompressed.getContentWorker().pipe(new N);G.on("error",function(Z){H(Z)}).on("end",function(){G.streamInfo.crc32!==V.decompressed.crc32?H(new Error("Corrupted zip : CRC32 mismatch")):U()}).resume()})}v.exports=function(V,U){var H=this;return U=g.extend(U||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:y.utf8decode}),I.isNode&&I.isStream(V)?x.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):g.prepareContent("the loaded zip file",V,!0,U.optimizedBinaryString,U.base64).then(function(G){var Z=new E(U);return Z.load(G),Z}).then(function(G){var Z=[x.Promise.resolve(G)],W=G.files;if(U.checkCRC32)for(var O=0;O<W.length;O++)Z.push(P(W[O]));return x.Promise.all(Z)}).then(function(G){for(var Z=G.shift(),W=Z.files,O=0;O<W.length;O++){var R=W[O],C=R.fileNameStr,_=g.resolve(R.fileNameStr);H.file(_,R.decompressed,{binary:!0,optimizedBinaryString:!0,date:R.date,dir:R.dir,comment:R.fileCommentStr.length?R.fileCommentStr:null,unixPermissions:R.unixPermissions,dosPermissions:R.dosPermissions,createFolders:U.createFolders}),R.dir||(H.file(_).unsafeOriginalName=C)}return Z.zipComment.length&&(H.comment=Z.zipComment),H})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(h,v,b){var g=h("../utils"),x=h("../stream/GenericWorker");function y(E,N){x.call(this,"Nodejs stream input adapter for "+E),this._upstreamEnded=!1,this._bindStream(N)}g.inherits(y,x),y.prototype._bindStream=function(E){var N=this;(this._stream=E).pause(),E.on("data",function(I){N.push({data:I,meta:{percent:0}})}).on("error",function(I){N.isPaused?this.generatedError=I:N.error(I)}).on("end",function(){N.isPaused?N._upstreamEnded=!0:N.end()})},y.prototype.pause=function(){return!!x.prototype.pause.call(this)&&(this._stream.pause(),!0)},y.prototype.resume=function(){return!!x.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},v.exports=y},{"../stream/GenericWorker":28,"../utils":32}],13:[function(h,v,b){var g=h("readable-stream").Readable;function x(y,E,N){g.call(this,E),this._helper=y;var I=this;y.on("data",function(P,V){I.push(P)||I._helper.pause(),N&&N(V)}).on("error",function(P){I.emit("error",P)}).on("end",function(){I.push(null)})}h("../utils").inherits(x,g),x.prototype._read=function(){this._helper.resume()},v.exports=x},{"../utils":32,"readable-stream":16}],14:[function(h,v,b){v.exports={isNode:l!==void 0,newBufferFrom:function(g,x){if(l.from&&l.from!==Uint8Array.from)return l.from(g,x);if(typeof g=="number")throw new Error('The "data" argument must not be a number');return new l(g,x)},allocBuffer:function(g){if(l.alloc)return l.alloc(g);var x=new l(g);return x.fill(0),x},isBuffer:function(g){return l.isBuffer(g)},isStream:function(g){return g&&typeof g.on=="function"&&typeof g.pause=="function"&&typeof g.resume=="function"}}},{}],15:[function(h,v,b){function g(_,k,A){var T,D=y.getTypeOf(k),B=y.extend(A||{},I);B.date=B.date||new Date,B.compression!==null&&(B.compression=B.compression.toUpperCase()),typeof B.unixPermissions=="string"&&(B.unixPermissions=parseInt(B.unixPermissions,8)),B.unixPermissions&&16384&B.unixPermissions&&(B.dir=!0),B.dosPermissions&&16&B.dosPermissions&&(B.dir=!0),B.dir&&(_=W(_)),B.createFolders&&(T=Z(_))&&O.call(this,T,!0);var F=D==="string"&&B.binary===!1&&B.base64===!1;A&&A.binary!==void 0||(B.binary=!F),(k instanceof P&&k.uncompressedSize===0||B.dir||!k||k.length===0)&&(B.base64=!1,B.binary=!0,k="",B.compression="STORE",D="string");var Y;Y=k instanceof P||k instanceof E?k:H.isNode&&H.isStream(k)?new G(_,k):y.prepareContent(_,k,B.binary,B.optimizedBinaryString,B.base64);var X=new V(_,Y,B);this.files[_]=X}var x=h("./utf8"),y=h("./utils"),E=h("./stream/GenericWorker"),N=h("./stream/StreamHelper"),I=h("./defaults"),P=h("./compressedObject"),V=h("./zipObject"),U=h("./generate"),H=h("./nodejsUtils"),G=h("./nodejs/NodejsStreamInputAdapter"),Z=function(_){_.slice(-1)==="/"&&(_=_.substring(0,_.length-1));var k=_.lastIndexOf("/");return 0<k?_.substring(0,k):""},W=function(_){return _.slice(-1)!=="/"&&(_+="/"),_},O=function(_,k){return k=k!==void 0?k:I.createFolders,_=W(_),this.files[_]||g.call(this,_,null,{dir:!0,createFolders:k}),this.files[_]};function R(_){return Object.prototype.toString.call(_)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(_){var k,A,T;for(k in this.files)T=this.files[k],(A=k.slice(this.root.length,k.length))&&k.slice(0,this.root.length)===this.root&&_(A,T)},filter:function(_){var k=[];return this.forEach(function(A,T){_(A,T)&&k.push(T)}),k},file:function(_,k,A){if(arguments.length!==1)return _=this.root+_,g.call(this,_,k,A),this;if(R(_)){var T=_;return this.filter(function(B,F){return!F.dir&&T.test(B)})}var D=this.files[this.root+_];return D&&!D.dir?D:null},folder:function(_){if(!_)return this;if(R(_))return this.filter(function(D,B){return B.dir&&_.test(D)});var k=this.root+_,A=O.call(this,k),T=this.clone();return T.root=A.name,T},remove:function(_){_=this.root+_;var k=this.files[_];if(k||(_.slice(-1)!=="/"&&(_+="/"),k=this.files[_]),k&&!k.dir)delete this.files[_];else for(var A=this.filter(function(D,B){return B.name.slice(0,_.length)===_}),T=0;T<A.length;T++)delete this.files[A[T].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(_){var k,A={};try{if((A=y.extend(_||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:x.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");y.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var T=A.comment||this.comment||"";k=U.generateWorker(this,A,T)}catch(D){(k=new E("error")).error(D)}return new N(k,A.type||"string",A.mimeType)},generateAsync:function(_,k){return this.generateInternalStream(_).accumulate(k)},generateNodeStream:function(_,k){return(_=_||{}).type||(_.type="nodebuffer"),this.generateInternalStream(_).toNodejsStream(k)}};v.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(h,v,b){v.exports=h("stream")},{stream:void 0}],17:[function(h,v,b){var g=h("./DataReader");function x(y){g.call(this,y);for(var E=0;E<this.data.length;E++)y[E]=255&y[E]}h("../utils").inherits(x,g),x.prototype.byteAt=function(y){return this.data[this.zero+y]},x.prototype.lastIndexOfSignature=function(y){for(var E=y.charCodeAt(0),N=y.charCodeAt(1),I=y.charCodeAt(2),P=y.charCodeAt(3),V=this.length-4;0<=V;--V)if(this.data[V]===E&&this.data[V+1]===N&&this.data[V+2]===I&&this.data[V+3]===P)return V-this.zero;return-1},x.prototype.readAndCheckSignature=function(y){var E=y.charCodeAt(0),N=y.charCodeAt(1),I=y.charCodeAt(2),P=y.charCodeAt(3),V=this.readData(4);return E===V[0]&&N===V[1]&&I===V[2]&&P===V[3]},x.prototype.readData=function(y){if(this.checkOffset(y),y===0)return[];var E=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,E},v.exports=x},{"../utils":32,"./DataReader":18}],18:[function(h,v,b){var g=h("../utils");function x(y){this.data=y,this.length=y.length,this.index=0,this.zero=0}x.prototype={checkOffset:function(y){this.checkIndex(this.index+y)},checkIndex:function(y){if(this.length<this.zero+y||y<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+y+"). Corrupted zip ?")},setIndex:function(y){this.checkIndex(y),this.index=y},skip:function(y){this.setIndex(this.index+y)},byteAt:function(){},readInt:function(y){var E,N=0;for(this.checkOffset(y),E=this.index+y-1;E>=this.index;E--)N=(N<<8)+this.byteAt(E);return this.index+=y,N},readString:function(y){return g.transformTo("string",this.readData(y))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var y=this.readInt(4);return new Date(Date.UTC(1980+(y>>25&127),(y>>21&15)-1,y>>16&31,y>>11&31,y>>5&63,(31&y)<<1))}},v.exports=x},{"../utils":32}],19:[function(h,v,b){var g=h("./Uint8ArrayReader");function x(y){g.call(this,y)}h("../utils").inherits(x,g),x.prototype.readData=function(y){this.checkOffset(y);var E=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,E},v.exports=x},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(h,v,b){var g=h("./DataReader");function x(y){g.call(this,y)}h("../utils").inherits(x,g),x.prototype.byteAt=function(y){return this.data.charCodeAt(this.zero+y)},x.prototype.lastIndexOfSignature=function(y){return this.data.lastIndexOf(y)-this.zero},x.prototype.readAndCheckSignature=function(y){return y===this.readData(4)},x.prototype.readData=function(y){this.checkOffset(y);var E=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,E},v.exports=x},{"../utils":32,"./DataReader":18}],21:[function(h,v,b){var g=h("./ArrayReader");function x(y){g.call(this,y)}h("../utils").inherits(x,g),x.prototype.readData=function(y){if(this.checkOffset(y),y===0)return new Uint8Array(0);var E=this.data.subarray(this.zero+this.index,this.zero+this.index+y);return this.index+=y,E},v.exports=x},{"../utils":32,"./ArrayReader":17}],22:[function(h,v,b){var g=h("../utils"),x=h("../support"),y=h("./ArrayReader"),E=h("./StringReader"),N=h("./NodeBufferReader"),I=h("./Uint8ArrayReader");v.exports=function(P){var V=g.getTypeOf(P);return g.checkSupport(V),V!=="string"||x.uint8array?V==="nodebuffer"?new N(P):x.uint8array?new I(g.transformTo("uint8array",P)):new y(g.transformTo("array",P)):new E(P)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(h,v,b){b.LOCAL_FILE_HEADER="PK",b.CENTRAL_FILE_HEADER="PK",b.CENTRAL_DIRECTORY_END="PK",b.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",b.ZIP64_CENTRAL_DIRECTORY_END="PK",b.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(h,v,b){var g=h("./GenericWorker"),x=h("../utils");function y(E){g.call(this,"ConvertWorker to "+E),this.destType=E}x.inherits(y,g),y.prototype.processChunk=function(E){this.push({data:x.transformTo(this.destType,E.data),meta:E.meta})},v.exports=y},{"../utils":32,"./GenericWorker":28}],25:[function(h,v,b){var g=h("./GenericWorker"),x=h("../crc32");function y(){g.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}h("../utils").inherits(y,g),y.prototype.processChunk=function(E){this.streamInfo.crc32=x(E.data,this.streamInfo.crc32||0),this.push(E)},v.exports=y},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(h,v,b){var g=h("../utils"),x=h("./GenericWorker");function y(E){x.call(this,"DataLengthProbe for "+E),this.propName=E,this.withStreamInfo(E,0)}g.inherits(y,x),y.prototype.processChunk=function(E){if(E){var N=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=N+E.data.length}x.prototype.processChunk.call(this,E)},v.exports=y},{"../utils":32,"./GenericWorker":28}],27:[function(h,v,b){var g=h("../utils"),x=h("./GenericWorker");function y(E){x.call(this,"DataWorker");var N=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,E.then(function(I){N.dataIsReady=!0,N.data=I,N.max=I&&I.length||0,N.type=g.getTypeOf(I),N.isPaused||N._tickAndRepeat()},function(I){N.error(I)})}g.inherits(y,x),y.prototype.cleanUp=function(){x.prototype.cleanUp.call(this),this.data=null},y.prototype.resume=function(){return!!x.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,g.delay(this._tickAndRepeat,[],this)),!0)},y.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(g.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},y.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var E=null,N=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":E=this.data.substring(this.index,N);break;case"uint8array":E=this.data.subarray(this.index,N);break;case"array":case"nodebuffer":E=this.data.slice(this.index,N)}return this.index=N,this.push({data:E,meta:{percent:this.max?this.index/this.max*100:0}})},v.exports=y},{"../utils":32,"./GenericWorker":28}],28:[function(h,v,b){function g(x){this.name=x||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}g.prototype={push:function(x){this.emit("data",x)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(x){this.emit("error",x)}return!0},error:function(x){return!this.isFinished&&(this.isPaused?this.generatedError=x:(this.isFinished=!0,this.emit("error",x),this.previous&&this.previous.error(x),this.cleanUp()),!0)},on:function(x,y){return this._listeners[x].push(y),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(x,y){if(this._listeners[x])for(var E=0;E<this._listeners[x].length;E++)this._listeners[x][E].call(this,y)},pipe:function(x){return x.registerPrevious(this)},registerPrevious:function(x){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=x.streamInfo,this.mergeStreamInfo(),this.previous=x;var y=this;return x.on("data",function(E){y.processChunk(E)}),x.on("end",function(){y.end()}),x.on("error",function(E){y.error(E)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var x=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),x=!0),this.previous&&this.previous.resume(),!x},flush:function(){},processChunk:function(x){this.push(x)},withStreamInfo:function(x,y){return this.extraStreamInfo[x]=y,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var x in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,x)&&(this.streamInfo[x]=this.extraStreamInfo[x])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var x="Worker "+this.name;return this.previous?this.previous+" -> "+x:x}},v.exports=g},{}],29:[function(h,v,b){var g=h("../utils"),x=h("./ConvertWorker"),y=h("./GenericWorker"),E=h("../base64"),N=h("../support"),I=h("../external"),P=null;if(N.nodestream)try{P=h("../nodejs/NodejsStreamOutputAdapter")}catch{}function V(U,H,G){var Z=H;switch(H){case"blob":case"arraybuffer":Z="uint8array";break;case"base64":Z="string"}try{this._internalType=Z,this._outputType=H,this._mimeType=G,g.checkSupport(Z),this._worker=U.pipe(new x(Z)),U.lock()}catch(W){this._worker=new y("error"),this._worker.error(W)}}V.prototype={accumulate:function(U){return function(H,G){return new I.Promise(function(Z,W){var O=[],R=H._internalType,C=H._outputType,_=H._mimeType;H.on("data",function(k,A){O.push(k),G&&G(A)}).on("error",function(k){O=[],W(k)}).on("end",function(){try{var k=function(A,T,D){switch(A){case"blob":return g.newBlob(g.transformTo("arraybuffer",T),D);case"base64":return E.encode(T);default:return g.transformTo(A,T)}}(C,function(A,T){var D,B=0,F=null,Y=0;for(D=0;D<T.length;D++)Y+=T[D].length;switch(A){case"string":return T.join("");case"array":return Array.prototype.concat.apply([],T);case"uint8array":for(F=new Uint8Array(Y),D=0;D<T.length;D++)F.set(T[D],B),B+=T[D].length;return F;case"nodebuffer":return l.concat(T);default:throw new Error("concat : unsupported type '"+A+"'")}}(R,O),_);Z(k)}catch(A){W(A)}O=[]}).resume()})}(this,U)},on:function(U,H){var G=this;return U==="data"?this._worker.on(U,function(Z){H.call(G,Z.data,Z.meta)}):this._worker.on(U,function(){g.delay(H,arguments,G)}),this},resume:function(){return g.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(U){if(g.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new P(this,{objectMode:this._outputType!=="nodebuffer"},U)}},v.exports=V},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(h,v,b){if(b.base64=!0,b.array=!0,b.string=!0,b.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",b.nodebuffer=l!==void 0,b.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")b.blob=!1;else{var g=new ArrayBuffer(0);try{b.blob=new Blob([g],{type:"application/zip"}).size===0}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);x.append(g),b.blob=x.getBlob("application/zip").size===0}catch{b.blob=!1}}}try{b.nodestream=!!h("readable-stream").Readable}catch{b.nodestream=!1}},{"readable-stream":16}],31:[function(h,v,b){for(var g=h("./utils"),x=h("./support"),y=h("./nodejsUtils"),E=h("./stream/GenericWorker"),N=new Array(256),I=0;I<256;I++)N[I]=252<=I?6:248<=I?5:240<=I?4:224<=I?3:192<=I?2:1;function P(){E.call(this,"utf-8 decode"),this.leftOver=null}function V(){E.call(this,"utf-8 encode")}N[254]=N[254]=1,b.utf8encode=function(U){return x.nodebuffer?y.newBufferFrom(U,"utf-8"):function(H){var G,Z,W,O,R,C=H.length,_=0;for(O=0;O<C;O++)(64512&(Z=H.charCodeAt(O)))==55296&&O+1<C&&(64512&(W=H.charCodeAt(O+1)))==56320&&(Z=65536+(Z-55296<<10)+(W-56320),O++),_+=Z<128?1:Z<2048?2:Z<65536?3:4;for(G=x.uint8array?new Uint8Array(_):new Array(_),O=R=0;R<_;O++)(64512&(Z=H.charCodeAt(O)))==55296&&O+1<C&&(64512&(W=H.charCodeAt(O+1)))==56320&&(Z=65536+(Z-55296<<10)+(W-56320),O++),Z<128?G[R++]=Z:(Z<2048?G[R++]=192|Z>>>6:(Z<65536?G[R++]=224|Z>>>12:(G[R++]=240|Z>>>18,G[R++]=128|Z>>>12&63),G[R++]=128|Z>>>6&63),G[R++]=128|63&Z);return G}(U)},b.utf8decode=function(U){return x.nodebuffer?g.transformTo("nodebuffer",U).toString("utf-8"):function(H){var G,Z,W,O,R=H.length,C=new Array(2*R);for(G=Z=0;G<R;)if((W=H[G++])<128)C[Z++]=W;else if(4<(O=N[W]))C[Z++]=65533,G+=O-1;else{for(W&=O===2?31:O===3?15:7;1<O&&G<R;)W=W<<6|63&H[G++],O--;1<O?C[Z++]=65533:W<65536?C[Z++]=W:(W-=65536,C[Z++]=55296|W>>10&1023,C[Z++]=56320|1023&W)}return C.length!==Z&&(C.subarray?C=C.subarray(0,Z):C.length=Z),g.applyFromCharCode(C)}(U=g.transformTo(x.uint8array?"uint8array":"array",U))},g.inherits(P,E),P.prototype.processChunk=function(U){var H=g.transformTo(x.uint8array?"uint8array":"array",U.data);if(this.leftOver&&this.leftOver.length){if(x.uint8array){var G=H;(H=new Uint8Array(G.length+this.leftOver.length)).set(this.leftOver,0),H.set(G,this.leftOver.length)}else H=this.leftOver.concat(H);this.leftOver=null}var Z=function(O,R){var C;for((R=R||O.length)>O.length&&(R=O.length),C=R-1;0<=C&&(192&O[C])==128;)C--;return C<0||C===0?R:C+N[O[C]]>R?C:R}(H),W=H;Z!==H.length&&(x.uint8array?(W=H.subarray(0,Z),this.leftOver=H.subarray(Z,H.length)):(W=H.slice(0,Z),this.leftOver=H.slice(Z,H.length))),this.push({data:b.utf8decode(W),meta:U.meta})},P.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:b.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},b.Utf8DecodeWorker=P,g.inherits(V,E),V.prototype.processChunk=function(U){this.push({data:b.utf8encode(U.data),meta:U.meta})},b.Utf8EncodeWorker=V},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(h,v,b){var g=h("./support"),x=h("./base64"),y=h("./nodejsUtils"),E=h("./external");function N(G){return G}function I(G,Z){for(var W=0;W<G.length;++W)Z[W]=255&G.charCodeAt(W);return Z}h("setimmediate"),b.newBlob=function(G,Z){b.checkSupport("blob");try{return new Blob([G],{type:Z})}catch{try{var W=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return W.append(G),W.getBlob(Z)}catch{throw new Error("Bug : can't construct the Blob.")}}};var P={stringifyByChunk:function(G,Z,W){var O=[],R=0,C=G.length;if(C<=W)return String.fromCharCode.apply(null,G);for(;R<C;)Z==="array"||Z==="nodebuffer"?O.push(String.fromCharCode.apply(null,G.slice(R,Math.min(R+W,C)))):O.push(String.fromCharCode.apply(null,G.subarray(R,Math.min(R+W,C)))),R+=W;return O.join("")},stringifyByChar:function(G){for(var Z="",W=0;W<G.length;W++)Z+=String.fromCharCode(G[W]);return Z},applyCanBeUsed:{uint8array:function(){try{return g.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return g.nodebuffer&&String.fromCharCode.apply(null,y.allocBuffer(1)).length===1}catch{return!1}}()}};function V(G){var Z=65536,W=b.getTypeOf(G),O=!0;if(W==="uint8array"?O=P.applyCanBeUsed.uint8array:W==="nodebuffer"&&(O=P.applyCanBeUsed.nodebuffer),O)for(;1<Z;)try{return P.stringifyByChunk(G,W,Z)}catch{Z=Math.floor(Z/2)}return P.stringifyByChar(G)}function U(G,Z){for(var W=0;W<G.length;W++)Z[W]=G[W];return Z}b.applyFromCharCode=V;var H={};H.string={string:N,array:function(G){return I(G,new Array(G.length))},arraybuffer:function(G){return H.string.uint8array(G).buffer},uint8array:function(G){return I(G,new Uint8Array(G.length))},nodebuffer:function(G){return I(G,y.allocBuffer(G.length))}},H.array={string:V,array:N,arraybuffer:function(G){return new Uint8Array(G).buffer},uint8array:function(G){return new Uint8Array(G)},nodebuffer:function(G){return y.newBufferFrom(G)}},H.arraybuffer={string:function(G){return V(new Uint8Array(G))},array:function(G){return U(new Uint8Array(G),new Array(G.byteLength))},arraybuffer:N,uint8array:function(G){return new Uint8Array(G)},nodebuffer:function(G){return y.newBufferFrom(new Uint8Array(G))}},H.uint8array={string:V,array:function(G){return U(G,new Array(G.length))},arraybuffer:function(G){return G.buffer},uint8array:N,nodebuffer:function(G){return y.newBufferFrom(G)}},H.nodebuffer={string:V,array:function(G){return U(G,new Array(G.length))},arraybuffer:function(G){return H.nodebuffer.uint8array(G).buffer},uint8array:function(G){return U(G,new Uint8Array(G.length))},nodebuffer:N},b.transformTo=function(G,Z){if(Z=Z||"",!G)return Z;b.checkSupport(G);var W=b.getTypeOf(Z);return H[W][G](Z)},b.resolve=function(G){for(var Z=G.split("/"),W=[],O=0;O<Z.length;O++){var R=Z[O];R==="."||R===""&&O!==0&&O!==Z.length-1||(R===".."?W.pop():W.push(R))}return W.join("/")},b.getTypeOf=function(G){return typeof G=="string"?"string":Object.prototype.toString.call(G)==="[object Array]"?"array":g.nodebuffer&&y.isBuffer(G)?"nodebuffer":g.uint8array&&G instanceof Uint8Array?"uint8array":g.arraybuffer&&G instanceof ArrayBuffer?"arraybuffer":void 0},b.checkSupport=function(G){if(!g[G.toLowerCase()])throw new Error(G+" is not supported by this platform")},b.MAX_VALUE_16BITS=65535,b.MAX_VALUE_32BITS=-1,b.pretty=function(G){var Z,W,O="";for(W=0;W<(G||"").length;W++)O+="\\x"+((Z=G.charCodeAt(W))<16?"0":"")+Z.toString(16).toUpperCase();return O},b.delay=function(G,Z,W){f(function(){G.apply(W||null,Z||[])})},b.inherits=function(G,Z){function W(){}W.prototype=Z.prototype,G.prototype=new W},b.extend=function(){var G,Z,W={};for(G=0;G<arguments.length;G++)for(Z in arguments[G])Object.prototype.hasOwnProperty.call(arguments[G],Z)&&W[Z]===void 0&&(W[Z]=arguments[G][Z]);return W},b.prepareContent=function(G,Z,W,O,R){return E.Promise.resolve(Z).then(function(C){return g.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new E.Promise(function(_,k){var A=new FileReader;A.onload=function(T){_(T.target.result)},A.onerror=function(T){k(T.target.error)},A.readAsArrayBuffer(C)}):C}).then(function(C){var _=b.getTypeOf(C);return _?(_==="arraybuffer"?C=b.transformTo("uint8array",C):_==="string"&&(R?C=x.decode(C):W&&O!==!0&&(C=function(k){return I(k,g.uint8array?new Uint8Array(k.length):new Array(k.length))}(C))),C):E.Promise.reject(new Error("Can't read the data of '"+G+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(h,v,b){var g=h("./reader/readerFor"),x=h("./utils"),y=h("./signature"),E=h("./zipEntry"),N=h("./support");function I(P){this.files=[],this.loadOptions=P}I.prototype={checkSignature:function(P){if(!this.reader.readAndCheckSignature(P)){this.reader.index-=4;var V=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+x.pretty(V)+", expected "+x.pretty(P)+")")}},isSignature:function(P,V){var U=this.reader.index;this.reader.setIndex(P);var H=this.reader.readString(4)===V;return this.reader.setIndex(U),H},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var P=this.reader.readData(this.zipCommentLength),V=N.uint8array?"uint8array":"array",U=x.transformTo(V,P);this.zipComment=this.loadOptions.decodeFileName(U)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var P,V,U,H=this.zip64EndOfCentralSize-44;0<H;)P=this.reader.readInt(2),V=this.reader.readInt(4),U=this.reader.readData(V),this.zip64ExtensibleData[P]={id:P,length:V,value:U}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var P,V;for(P=0;P<this.files.length;P++)V=this.files[P],this.reader.setIndex(V.localHeaderOffset),this.checkSignature(y.LOCAL_FILE_HEADER),V.readLocalPart(this.reader),V.handleUTF8(),V.processAttributes()},readCentralDir:function(){var P;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(y.CENTRAL_FILE_HEADER);)(P=new E({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(P);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var P=this.reader.lastIndexOfSignature(y.CENTRAL_DIRECTORY_END);if(P<0)throw this.isSignature(0,y.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(P);var V=P;if(this.checkSignature(y.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===x.MAX_VALUE_16BITS||this.diskWithCentralDirStart===x.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===x.MAX_VALUE_16BITS||this.centralDirRecords===x.MAX_VALUE_16BITS||this.centralDirSize===x.MAX_VALUE_32BITS||this.centralDirOffset===x.MAX_VALUE_32BITS){if(this.zip64=!0,(P=this.reader.lastIndexOfSignature(y.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(P),this.checkSignature(y.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,y.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(y.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(y.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var U=this.centralDirOffset+this.centralDirSize;this.zip64&&(U+=20,U+=12+this.zip64EndOfCentralSize);var H=V-U;if(0<H)this.isSignature(V,y.CENTRAL_FILE_HEADER)||(this.reader.zero=H);else if(H<0)throw new Error("Corrupted zip: missing "+Math.abs(H)+" bytes.")},prepareReader:function(P){this.reader=g(P)},load:function(P){this.prepareReader(P),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},v.exports=I},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(h,v,b){var g=h("./reader/readerFor"),x=h("./utils"),y=h("./compressedObject"),E=h("./crc32"),N=h("./utf8"),I=h("./compressions"),P=h("./support");function V(U,H){this.options=U,this.loadOptions=H}V.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(U){var H,G;if(U.skip(22),this.fileNameLength=U.readInt(2),G=U.readInt(2),this.fileName=U.readData(this.fileNameLength),U.skip(G),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((H=function(Z){for(var W in I)if(Object.prototype.hasOwnProperty.call(I,W)&&I[W].magic===Z)return I[W];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+x.pretty(this.compressionMethod)+" unknown (inner file : "+x.transformTo("string",this.fileName)+")");this.decompressed=new y(this.compressedSize,this.uncompressedSize,this.crc32,H,U.readData(this.compressedSize))},readCentralPart:function(U){this.versionMadeBy=U.readInt(2),U.skip(2),this.bitFlag=U.readInt(2),this.compressionMethod=U.readString(2),this.date=U.readDate(),this.crc32=U.readInt(4),this.compressedSize=U.readInt(4),this.uncompressedSize=U.readInt(4);var H=U.readInt(2);if(this.extraFieldsLength=U.readInt(2),this.fileCommentLength=U.readInt(2),this.diskNumberStart=U.readInt(2),this.internalFileAttributes=U.readInt(2),this.externalFileAttributes=U.readInt(4),this.localHeaderOffset=U.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");U.skip(H),this.readExtraFields(U),this.parseZIP64ExtraField(U),this.fileComment=U.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var U=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),U==0&&(this.dosPermissions=63&this.externalFileAttributes),U==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var U=g(this.extraFields[1].value);this.uncompressedSize===x.MAX_VALUE_32BITS&&(this.uncompressedSize=U.readInt(8)),this.compressedSize===x.MAX_VALUE_32BITS&&(this.compressedSize=U.readInt(8)),this.localHeaderOffset===x.MAX_VALUE_32BITS&&(this.localHeaderOffset=U.readInt(8)),this.diskNumberStart===x.MAX_VALUE_32BITS&&(this.diskNumberStart=U.readInt(4))}},readExtraFields:function(U){var H,G,Z,W=U.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});U.index+4<W;)H=U.readInt(2),G=U.readInt(2),Z=U.readData(G),this.extraFields[H]={id:H,length:G,value:Z};U.setIndex(W)},handleUTF8:function(){var U=P.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=N.utf8decode(this.fileName),this.fileCommentStr=N.utf8decode(this.fileComment);else{var H=this.findExtraFieldUnicodePath();if(H!==null)this.fileNameStr=H;else{var G=x.transformTo(U,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(G)}var Z=this.findExtraFieldUnicodeComment();if(Z!==null)this.fileCommentStr=Z;else{var W=x.transformTo(U,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(W)}}},findExtraFieldUnicodePath:function(){var U=this.extraFields[28789];if(U){var H=g(U.value);return H.readInt(1)!==1||E(this.fileName)!==H.readInt(4)?null:N.utf8decode(H.readData(U.length-5))}return null},findExtraFieldUnicodeComment:function(){var U=this.extraFields[25461];if(U){var H=g(U.value);return H.readInt(1)!==1||E(this.fileComment)!==H.readInt(4)?null:N.utf8decode(H.readData(U.length-5))}return null}},v.exports=V},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(h,v,b){function g(H,G,Z){this.name=H,this.dir=Z.dir,this.date=Z.date,this.comment=Z.comment,this.unixPermissions=Z.unixPermissions,this.dosPermissions=Z.dosPermissions,this._data=G,this._dataBinary=Z.binary,this.options={compression:Z.compression,compressionOptions:Z.compressionOptions}}var x=h("./stream/StreamHelper"),y=h("./stream/DataWorker"),E=h("./utf8"),N=h("./compressedObject"),I=h("./stream/GenericWorker");g.prototype={internalStream:function(H){var G=null,Z="string";try{if(!H)throw new Error("No output type specified.");var W=(Z=H.toLowerCase())==="string"||Z==="text";Z!=="binarystring"&&Z!=="text"||(Z="string"),G=this._decompressWorker();var O=!this._dataBinary;O&&!W&&(G=G.pipe(new E.Utf8EncodeWorker)),!O&&W&&(G=G.pipe(new E.Utf8DecodeWorker))}catch(R){(G=new I("error")).error(R)}return new x(G,Z,"")},async:function(H,G){return this.internalStream(H).accumulate(G)},nodeStream:function(H,G){return this.internalStream(H||"nodebuffer").toNodejsStream(G)},_compressWorker:function(H,G){if(this._data instanceof N&&this._data.compression.magic===H.magic)return this._data.getCompressedWorker();var Z=this._decompressWorker();return this._dataBinary||(Z=Z.pipe(new E.Utf8EncodeWorker)),N.createWorkerFrom(Z,H,G)},_decompressWorker:function(){return this._data instanceof N?this._data.getContentWorker():this._data instanceof I?this._data:new y(this._data)}};for(var P=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],V=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},U=0;U<P.length;U++)g.prototype[P[U]]=V;v.exports=g},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(h,v,b){(function(g){var x,y,E=g.MutationObserver||g.WebKitMutationObserver;if(E){var N=0,I=new E(H),P=g.document.createTextNode("");I.observe(P,{characterData:!0}),x=function(){P.data=N=++N%2}}else if(g.setImmediate||g.MessageChannel===void 0)x="document"in g&&"onreadystatechange"in g.document.createElement("script")?function(){var G=g.document.createElement("script");G.onreadystatechange=function(){H(),G.onreadystatechange=null,G.parentNode.removeChild(G),G=null},g.document.documentElement.appendChild(G)}:function(){setTimeout(H,0)};else{var V=new g.MessageChannel;V.port1.onmessage=H,x=function(){V.port2.postMessage(0)}}var U=[];function H(){var G,Z;y=!0;for(var W=U.length;W;){for(Z=U,U=[],G=-1;++G<W;)Z[G]();W=U.length}y=!1}v.exports=function(G){U.push(G)!==1||y||x()}}).call(this,s!==void 0?s:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(h,v,b){var g=h("immediate");function x(){}var y={},E=["REJECTED"],N=["FULFILLED"],I=["PENDING"];function P(W){if(typeof W!="function")throw new TypeError("resolver must be a function");this.state=I,this.queue=[],this.outcome=void 0,W!==x&&G(this,W)}function V(W,O,R){this.promise=W,typeof O=="function"&&(this.onFulfilled=O,this.callFulfilled=this.otherCallFulfilled),typeof R=="function"&&(this.onRejected=R,this.callRejected=this.otherCallRejected)}function U(W,O,R){g(function(){var C;try{C=O(R)}catch(_){return y.reject(W,_)}C===W?y.reject(W,new TypeError("Cannot resolve promise with itself")):y.resolve(W,C)})}function H(W){var O=W&&W.then;if(W&&(typeof W=="object"||typeof W=="function")&&typeof O=="function")return function(){O.apply(W,arguments)}}function G(W,O){var R=!1;function C(A){R||(R=!0,y.reject(W,A))}function _(A){R||(R=!0,y.resolve(W,A))}var k=Z(function(){O(_,C)});k.status==="error"&&C(k.value)}function Z(W,O){var R={};try{R.value=W(O),R.status="success"}catch(C){R.status="error",R.value=C}return R}(v.exports=P).prototype.finally=function(W){if(typeof W!="function")return this;var O=this.constructor;return this.then(function(R){return O.resolve(W()).then(function(){return R})},function(R){return O.resolve(W()).then(function(){throw R})})},P.prototype.catch=function(W){return this.then(null,W)},P.prototype.then=function(W,O){if(typeof W!="function"&&this.state===N||typeof O!="function"&&this.state===E)return this;var R=new this.constructor(x);return this.state!==I?U(R,this.state===N?W:O,this.outcome):this.queue.push(new V(R,W,O)),R},V.prototype.callFulfilled=function(W){y.resolve(this.promise,W)},V.prototype.otherCallFulfilled=function(W){U(this.promise,this.onFulfilled,W)},V.prototype.callRejected=function(W){y.reject(this.promise,W)},V.prototype.otherCallRejected=function(W){U(this.promise,this.onRejected,W)},y.resolve=function(W,O){var R=Z(H,O);if(R.status==="error")return y.reject(W,R.value);var C=R.value;if(C)G(W,C);else{W.state=N,W.outcome=O;for(var _=-1,k=W.queue.length;++_<k;)W.queue[_].callFulfilled(O)}return W},y.reject=function(W,O){W.state=E,W.outcome=O;for(var R=-1,C=W.queue.length;++R<C;)W.queue[R].callRejected(O);return W},P.resolve=function(W){return W instanceof this?W:y.resolve(new this(x),W)},P.reject=function(W){var O=new this(x);return y.reject(O,W)},P.all=function(W){var O=this;if(Object.prototype.toString.call(W)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=W.length,C=!1;if(!R)return this.resolve([]);for(var _=new Array(R),k=0,A=-1,T=new this(x);++A<R;)D(W[A],A);return T;function D(B,F){O.resolve(B).then(function(Y){_[F]=Y,++k!==R||C||(C=!0,y.resolve(T,_))},function(Y){C||(C=!0,y.reject(T,Y))})}},P.race=function(W){if(Object.prototype.toString.call(W)!=="[object Array]")return this.reject(new TypeError("must be an array"));var O=W.length,R=!1;if(!O)return this.resolve([]);for(var C,_=-1,k=new this(x);++_<O;)C=W[_],this.resolve(C).then(function(A){R||(R=!0,y.resolve(k,A))},function(A){R||(R=!0,y.reject(k,A))});return k}},{immediate:36}],38:[function(h,v,b){var g={};(0,h("./lib/utils/common").assign)(g,h("./lib/deflate"),h("./lib/inflate"),h("./lib/zlib/constants")),v.exports=g},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(h,v,b){var g=h("./zlib/deflate"),x=h("./utils/common"),y=h("./utils/strings"),E=h("./zlib/messages"),N=h("./zlib/zstream"),I=Object.prototype.toString;function P(U){if(!(this instanceof P))return new P(U);this.options=x.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},U||{});var H=this.options;H.raw&&0<H.windowBits?H.windowBits=-H.windowBits:H.gzip&&0<H.windowBits&&H.windowBits<16&&(H.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new N,this.strm.avail_out=0;var G=g.deflateInit2(this.strm,H.level,H.method,H.windowBits,H.memLevel,H.strategy);if(G!==0)throw new Error(E[G]);if(H.header&&g.deflateSetHeader(this.strm,H.header),H.dictionary){var Z;if(Z=typeof H.dictionary=="string"?y.string2buf(H.dictionary):I.call(H.dictionary)==="[object ArrayBuffer]"?new Uint8Array(H.dictionary):H.dictionary,(G=g.deflateSetDictionary(this.strm,Z))!==0)throw new Error(E[G]);this._dict_set=!0}}function V(U,H){var G=new P(H);if(G.push(U,!0),G.err)throw G.msg||E[G.err];return G.result}P.prototype.push=function(U,H){var G,Z,W=this.strm,O=this.options.chunkSize;if(this.ended)return!1;Z=H===~~H?H:H===!0?4:0,typeof U=="string"?W.input=y.string2buf(U):I.call(U)==="[object ArrayBuffer]"?W.input=new Uint8Array(U):W.input=U,W.next_in=0,W.avail_in=W.input.length;do{if(W.avail_out===0&&(W.output=new x.Buf8(O),W.next_out=0,W.avail_out=O),(G=g.deflate(W,Z))!==1&&G!==0)return this.onEnd(G),!(this.ended=!0);W.avail_out!==0&&(W.avail_in!==0||Z!==4&&Z!==2)||(this.options.to==="string"?this.onData(y.buf2binstring(x.shrinkBuf(W.output,W.next_out))):this.onData(x.shrinkBuf(W.output,W.next_out)))}while((0<W.avail_in||W.avail_out===0)&&G!==1);return Z===4?(G=g.deflateEnd(this.strm),this.onEnd(G),this.ended=!0,G===0):Z!==2||(this.onEnd(0),!(W.avail_out=0))},P.prototype.onData=function(U){this.chunks.push(U)},P.prototype.onEnd=function(U){U===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=x.flattenChunks(this.chunks)),this.chunks=[],this.err=U,this.msg=this.strm.msg},b.Deflate=P,b.deflate=V,b.deflateRaw=function(U,H){return(H=H||{}).raw=!0,V(U,H)},b.gzip=function(U,H){return(H=H||{}).gzip=!0,V(U,H)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(h,v,b){var g=h("./zlib/inflate"),x=h("./utils/common"),y=h("./utils/strings"),E=h("./zlib/constants"),N=h("./zlib/messages"),I=h("./zlib/zstream"),P=h("./zlib/gzheader"),V=Object.prototype.toString;function U(G){if(!(this instanceof U))return new U(G);this.options=x.assign({chunkSize:16384,windowBits:0,to:""},G||{});var Z=this.options;Z.raw&&0<=Z.windowBits&&Z.windowBits<16&&(Z.windowBits=-Z.windowBits,Z.windowBits===0&&(Z.windowBits=-15)),!(0<=Z.windowBits&&Z.windowBits<16)||G&&G.windowBits||(Z.windowBits+=32),15<Z.windowBits&&Z.windowBits<48&&(15&Z.windowBits)==0&&(Z.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new I,this.strm.avail_out=0;var W=g.inflateInit2(this.strm,Z.windowBits);if(W!==E.Z_OK)throw new Error(N[W]);this.header=new P,g.inflateGetHeader(this.strm,this.header)}function H(G,Z){var W=new U(Z);if(W.push(G,!0),W.err)throw W.msg||N[W.err];return W.result}U.prototype.push=function(G,Z){var W,O,R,C,_,k,A=this.strm,T=this.options.chunkSize,D=this.options.dictionary,B=!1;if(this.ended)return!1;O=Z===~~Z?Z:Z===!0?E.Z_FINISH:E.Z_NO_FLUSH,typeof G=="string"?A.input=y.binstring2buf(G):V.call(G)==="[object ArrayBuffer]"?A.input=new Uint8Array(G):A.input=G,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new x.Buf8(T),A.next_out=0,A.avail_out=T),(W=g.inflate(A,E.Z_NO_FLUSH))===E.Z_NEED_DICT&&D&&(k=typeof D=="string"?y.string2buf(D):V.call(D)==="[object ArrayBuffer]"?new Uint8Array(D):D,W=g.inflateSetDictionary(this.strm,k)),W===E.Z_BUF_ERROR&&B===!0&&(W=E.Z_OK,B=!1),W!==E.Z_STREAM_END&&W!==E.Z_OK)return this.onEnd(W),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&W!==E.Z_STREAM_END&&(A.avail_in!==0||O!==E.Z_FINISH&&O!==E.Z_SYNC_FLUSH)||(this.options.to==="string"?(R=y.utf8border(A.output,A.next_out),C=A.next_out-R,_=y.buf2string(A.output,R),A.next_out=C,A.avail_out=T-C,C&&x.arraySet(A.output,A.output,R,C,0),this.onData(_)):this.onData(x.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(B=!0)}while((0<A.avail_in||A.avail_out===0)&&W!==E.Z_STREAM_END);return W===E.Z_STREAM_END&&(O=E.Z_FINISH),O===E.Z_FINISH?(W=g.inflateEnd(this.strm),this.onEnd(W),this.ended=!0,W===E.Z_OK):O!==E.Z_SYNC_FLUSH||(this.onEnd(E.Z_OK),!(A.avail_out=0))},U.prototype.onData=function(G){this.chunks.push(G)},U.prototype.onEnd=function(G){G===E.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=x.flattenChunks(this.chunks)),this.chunks=[],this.err=G,this.msg=this.strm.msg},b.Inflate=U,b.inflate=H,b.inflateRaw=function(G,Z){return(Z=Z||{}).raw=!0,H(G,Z)},b.ungzip=H},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(h,v,b){var g=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";b.assign=function(E){for(var N=Array.prototype.slice.call(arguments,1);N.length;){var I=N.shift();if(I){if(typeof I!="object")throw new TypeError(I+"must be non-object");for(var P in I)I.hasOwnProperty(P)&&(E[P]=I[P])}}return E},b.shrinkBuf=function(E,N){return E.length===N?E:E.subarray?E.subarray(0,N):(E.length=N,E)};var x={arraySet:function(E,N,I,P,V){if(N.subarray&&E.subarray)E.set(N.subarray(I,I+P),V);else for(var U=0;U<P;U++)E[V+U]=N[I+U]},flattenChunks:function(E){var N,I,P,V,U,H;for(N=P=0,I=E.length;N<I;N++)P+=E[N].length;for(H=new Uint8Array(P),N=V=0,I=E.length;N<I;N++)U=E[N],H.set(U,V),V+=U.length;return H}},y={arraySet:function(E,N,I,P,V){for(var U=0;U<P;U++)E[V+U]=N[I+U]},flattenChunks:function(E){return[].concat.apply([],E)}};b.setTyped=function(E){E?(b.Buf8=Uint8Array,b.Buf16=Uint16Array,b.Buf32=Int32Array,b.assign(b,x)):(b.Buf8=Array,b.Buf16=Array,b.Buf32=Array,b.assign(b,y))},b.setTyped(g)},{}],42:[function(h,v,b){var g=h("./common"),x=!0,y=!0;try{String.fromCharCode.apply(null,[0])}catch{x=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{y=!1}for(var E=new g.Buf8(256),N=0;N<256;N++)E[N]=252<=N?6:248<=N?5:240<=N?4:224<=N?3:192<=N?2:1;function I(P,V){if(V<65537&&(P.subarray&&y||!P.subarray&&x))return String.fromCharCode.apply(null,g.shrinkBuf(P,V));for(var U="",H=0;H<V;H++)U+=String.fromCharCode(P[H]);return U}E[254]=E[254]=1,b.string2buf=function(P){var V,U,H,G,Z,W=P.length,O=0;for(G=0;G<W;G++)(64512&(U=P.charCodeAt(G)))==55296&&G+1<W&&(64512&(H=P.charCodeAt(G+1)))==56320&&(U=65536+(U-55296<<10)+(H-56320),G++),O+=U<128?1:U<2048?2:U<65536?3:4;for(V=new g.Buf8(O),G=Z=0;Z<O;G++)(64512&(U=P.charCodeAt(G)))==55296&&G+1<W&&(64512&(H=P.charCodeAt(G+1)))==56320&&(U=65536+(U-55296<<10)+(H-56320),G++),U<128?V[Z++]=U:(U<2048?V[Z++]=192|U>>>6:(U<65536?V[Z++]=224|U>>>12:(V[Z++]=240|U>>>18,V[Z++]=128|U>>>12&63),V[Z++]=128|U>>>6&63),V[Z++]=128|63&U);return V},b.buf2binstring=function(P){return I(P,P.length)},b.binstring2buf=function(P){for(var V=new g.Buf8(P.length),U=0,H=V.length;U<H;U++)V[U]=P.charCodeAt(U);return V},b.buf2string=function(P,V){var U,H,G,Z,W=V||P.length,O=new Array(2*W);for(U=H=0;U<W;)if((G=P[U++])<128)O[H++]=G;else if(4<(Z=E[G]))O[H++]=65533,U+=Z-1;else{for(G&=Z===2?31:Z===3?15:7;1<Z&&U<W;)G=G<<6|63&P[U++],Z--;1<Z?O[H++]=65533:G<65536?O[H++]=G:(G-=65536,O[H++]=55296|G>>10&1023,O[H++]=56320|1023&G)}return I(O,H)},b.utf8border=function(P,V){var U;for((V=V||P.length)>P.length&&(V=P.length),U=V-1;0<=U&&(192&P[U])==128;)U--;return U<0||U===0?V:U+E[P[U]]>V?U:V}},{"./common":41}],43:[function(h,v,b){v.exports=function(g,x,y,E){for(var N=65535&g|0,I=g>>>16&65535|0,P=0;y!==0;){for(y-=P=2e3<y?2e3:y;I=I+(N=N+x[E++]|0)|0,--P;);N%=65521,I%=65521}return N|I<<16|0}},{}],44:[function(h,v,b){v.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(h,v,b){var g=function(){for(var x,y=[],E=0;E<256;E++){x=E;for(var N=0;N<8;N++)x=1&x?3988292384^x>>>1:x>>>1;y[E]=x}return y}();v.exports=function(x,y,E,N){var I=g,P=N+E;x^=-1;for(var V=N;V<P;V++)x=x>>>8^I[255&(x^y[V])];return-1^x}},{}],46:[function(h,v,b){var g,x=h("../utils/common"),y=h("./trees"),E=h("./adler32"),N=h("./crc32"),I=h("./messages"),P=-2,V=258,U=262,H=113;function G(z,ee){return z.msg=I[ee],ee}function Z(z){return(z<<1)-(4<z?9:0)}function W(z){for(var ee=z.length;0<=--ee;)z[ee]=0}function O(z){var ee=z.state,L=ee.pending;L>z.avail_out&&(L=z.avail_out),L!==0&&(x.arraySet(z.output,ee.pending_buf,ee.pending_out,L,z.next_out),z.next_out+=L,ee.pending_out+=L,z.total_out+=L,z.avail_out-=L,ee.pending-=L,ee.pending===0&&(ee.pending_out=0))}function R(z,ee){y._tr_flush_block(z,0<=z.block_start?z.block_start:-1,z.strstart-z.block_start,ee),z.block_start=z.strstart,O(z.strm)}function C(z,ee){z.pending_buf[z.pending++]=ee}function _(z,ee){z.pending_buf[z.pending++]=ee>>>8&255,z.pending_buf[z.pending++]=255&ee}function k(z,ee){var L,M,K=z.max_chain_length,se=z.strstart,te=z.prev_length,ae=z.nice_match,Q=z.strstart>z.w_size-U?z.strstart-(z.w_size-U):0,fe=z.window,le=z.w_mask,ne=z.prev,ue=z.strstart+V,he=fe[se+te-1],ke=fe[se+te];z.prev_length>=z.good_match&&(K>>=2),ae>z.lookahead&&(ae=z.lookahead);do if(fe[(L=ee)+te]===ke&&fe[L+te-1]===he&&fe[L]===fe[se]&&fe[++L]===fe[se+1]){se+=2,L++;do;while(fe[++se]===fe[++L]&&fe[++se]===fe[++L]&&fe[++se]===fe[++L]&&fe[++se]===fe[++L]&&fe[++se]===fe[++L]&&fe[++se]===fe[++L]&&fe[++se]===fe[++L]&&fe[++se]===fe[++L]&&se<ue);if(M=V-(ue-se),se=ue-V,te<M){if(z.match_start=ee,ae<=(te=M))break;he=fe[se+te-1],ke=fe[se+te]}}while((ee=ne[ee&le])>Q&&--K!=0);return te<=z.lookahead?te:z.lookahead}function A(z){var ee,L,M,K,se,te,ae,Q,fe,le,ne=z.w_size;do{if(K=z.window_size-z.lookahead-z.strstart,z.strstart>=ne+(ne-U)){for(x.arraySet(z.window,z.window,ne,ne,0),z.match_start-=ne,z.strstart-=ne,z.block_start-=ne,ee=L=z.hash_size;M=z.head[--ee],z.head[ee]=ne<=M?M-ne:0,--L;);for(ee=L=ne;M=z.prev[--ee],z.prev[ee]=ne<=M?M-ne:0,--L;);K+=ne}if(z.strm.avail_in===0)break;if(te=z.strm,ae=z.window,Q=z.strstart+z.lookahead,le=void 0,(fe=K)<(le=te.avail_in)&&(le=fe),L=le===0?0:(te.avail_in-=le,x.arraySet(ae,te.input,te.next_in,le,Q),te.state.wrap===1?te.adler=E(te.adler,ae,le,Q):te.state.wrap===2&&(te.adler=N(te.adler,ae,le,Q)),te.next_in+=le,te.total_in+=le,le),z.lookahead+=L,z.lookahead+z.insert>=3)for(se=z.strstart-z.insert,z.ins_h=z.window[se],z.ins_h=(z.ins_h<<z.hash_shift^z.window[se+1])&z.hash_mask;z.insert&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[se+3-1])&z.hash_mask,z.prev[se&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=se,se++,z.insert--,!(z.lookahead+z.insert<3)););}while(z.lookahead<U&&z.strm.avail_in!==0)}function T(z,ee){for(var L,M;;){if(z.lookahead<U){if(A(z),z.lookahead<U&&ee===0)return 1;if(z.lookahead===0)break}if(L=0,z.lookahead>=3&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+3-1])&z.hash_mask,L=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),L!==0&&z.strstart-L<=z.w_size-U&&(z.match_length=k(z,L)),z.match_length>=3)if(M=y._tr_tally(z,z.strstart-z.match_start,z.match_length-3),z.lookahead-=z.match_length,z.match_length<=z.max_lazy_match&&z.lookahead>=3){for(z.match_length--;z.strstart++,z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+3-1])&z.hash_mask,L=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart,--z.match_length!=0;);z.strstart++}else z.strstart+=z.match_length,z.match_length=0,z.ins_h=z.window[z.strstart],z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+1])&z.hash_mask;else M=y._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++;if(M&&(R(z,!1),z.strm.avail_out===0))return 1}return z.insert=z.strstart<2?z.strstart:2,ee===4?(R(z,!0),z.strm.avail_out===0?3:4):z.last_lit&&(R(z,!1),z.strm.avail_out===0)?1:2}function D(z,ee){for(var L,M,K;;){if(z.lookahead<U){if(A(z),z.lookahead<U&&ee===0)return 1;if(z.lookahead===0)break}if(L=0,z.lookahead>=3&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+3-1])&z.hash_mask,L=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),z.prev_length=z.match_length,z.prev_match=z.match_start,z.match_length=2,L!==0&&z.prev_length<z.max_lazy_match&&z.strstart-L<=z.w_size-U&&(z.match_length=k(z,L),z.match_length<=5&&(z.strategy===1||z.match_length===3&&4096<z.strstart-z.match_start)&&(z.match_length=2)),z.prev_length>=3&&z.match_length<=z.prev_length){for(K=z.strstart+z.lookahead-3,M=y._tr_tally(z,z.strstart-1-z.prev_match,z.prev_length-3),z.lookahead-=z.prev_length-1,z.prev_length-=2;++z.strstart<=K&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+3-1])&z.hash_mask,L=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),--z.prev_length!=0;);if(z.match_available=0,z.match_length=2,z.strstart++,M&&(R(z,!1),z.strm.avail_out===0))return 1}else if(z.match_available){if((M=y._tr_tally(z,0,z.window[z.strstart-1]))&&R(z,!1),z.strstart++,z.lookahead--,z.strm.avail_out===0)return 1}else z.match_available=1,z.strstart++,z.lookahead--}return z.match_available&&(M=y._tr_tally(z,0,z.window[z.strstart-1]),z.match_available=0),z.insert=z.strstart<2?z.strstart:2,ee===4?(R(z,!0),z.strm.avail_out===0?3:4):z.last_lit&&(R(z,!1),z.strm.avail_out===0)?1:2}function B(z,ee,L,M,K){this.good_length=z,this.max_lazy=ee,this.nice_length=L,this.max_chain=M,this.func=K}function F(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new x.Buf16(1146),this.dyn_dtree=new x.Buf16(122),this.bl_tree=new x.Buf16(78),W(this.dyn_ltree),W(this.dyn_dtree),W(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new x.Buf16(16),this.heap=new x.Buf16(573),W(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new x.Buf16(573),W(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Y(z){var ee;return z&&z.state?(z.total_in=z.total_out=0,z.data_type=2,(ee=z.state).pending=0,ee.pending_out=0,ee.wrap<0&&(ee.wrap=-ee.wrap),ee.status=ee.wrap?42:H,z.adler=ee.wrap===2?0:1,ee.last_flush=0,y._tr_init(ee),0):G(z,P)}function X(z){var ee=Y(z);return ee===0&&function(L){L.window_size=2*L.w_size,W(L.head),L.max_lazy_match=g[L.level].max_lazy,L.good_match=g[L.level].good_length,L.nice_match=g[L.level].nice_length,L.max_chain_length=g[L.level].max_chain,L.strstart=0,L.block_start=0,L.lookahead=0,L.insert=0,L.match_length=L.prev_length=2,L.match_available=0,L.ins_h=0}(z.state),ee}function re(z,ee,L,M,K,se){if(!z)return P;var te=1;if(ee===-1&&(ee=6),M<0?(te=0,M=-M):15<M&&(te=2,M-=16),K<1||9<K||L!==8||M<8||15<M||ee<0||9<ee||se<0||4<se)return G(z,P);M===8&&(M=9);var ae=new F;return(z.state=ae).strm=z,ae.wrap=te,ae.gzhead=null,ae.w_bits=M,ae.w_size=1<<ae.w_bits,ae.w_mask=ae.w_size-1,ae.hash_bits=K+7,ae.hash_size=1<<ae.hash_bits,ae.hash_mask=ae.hash_size-1,ae.hash_shift=~~((ae.hash_bits+3-1)/3),ae.window=new x.Buf8(2*ae.w_size),ae.head=new x.Buf16(ae.hash_size),ae.prev=new x.Buf16(ae.w_size),ae.lit_bufsize=1<<K+6,ae.pending_buf_size=4*ae.lit_bufsize,ae.pending_buf=new x.Buf8(ae.pending_buf_size),ae.d_buf=1*ae.lit_bufsize,ae.l_buf=3*ae.lit_bufsize,ae.level=ee,ae.strategy=se,ae.method=L,X(z)}g=[new B(0,0,0,0,function(z,ee){var L=65535;for(L>z.pending_buf_size-5&&(L=z.pending_buf_size-5);;){if(z.lookahead<=1){if(A(z),z.lookahead===0&&ee===0)return 1;if(z.lookahead===0)break}z.strstart+=z.lookahead,z.lookahead=0;var M=z.block_start+L;if((z.strstart===0||z.strstart>=M)&&(z.lookahead=z.strstart-M,z.strstart=M,R(z,!1),z.strm.avail_out===0)||z.strstart-z.block_start>=z.w_size-U&&(R(z,!1),z.strm.avail_out===0))return 1}return z.insert=0,ee===4?(R(z,!0),z.strm.avail_out===0?3:4):(z.strstart>z.block_start&&(R(z,!1),z.strm.avail_out),1)}),new B(4,4,8,4,T),new B(4,5,16,8,T),new B(4,6,32,32,T),new B(4,4,16,16,D),new B(8,16,32,32,D),new B(8,16,128,128,D),new B(8,32,128,256,D),new B(32,128,258,1024,D),new B(32,258,258,4096,D)],b.deflateInit=function(z,ee){return re(z,ee,8,15,8,0)},b.deflateInit2=re,b.deflateReset=X,b.deflateResetKeep=Y,b.deflateSetHeader=function(z,ee){return z&&z.state?z.state.wrap!==2?P:(z.state.gzhead=ee,0):P},b.deflate=function(z,ee){var L,M,K,se;if(!z||!z.state||5<ee||ee<0)return z?G(z,P):P;if(M=z.state,!z.output||!z.input&&z.avail_in!==0||M.status===666&&ee!==4)return G(z,z.avail_out===0?-5:P);if(M.strm=z,L=M.last_flush,M.last_flush=ee,M.status===42)if(M.wrap===2)z.adler=0,C(M,31),C(M,139),C(M,8),M.gzhead?(C(M,(M.gzhead.text?1:0)+(M.gzhead.hcrc?2:0)+(M.gzhead.extra?4:0)+(M.gzhead.name?8:0)+(M.gzhead.comment?16:0)),C(M,255&M.gzhead.time),C(M,M.gzhead.time>>8&255),C(M,M.gzhead.time>>16&255),C(M,M.gzhead.time>>24&255),C(M,M.level===9?2:2<=M.strategy||M.level<2?4:0),C(M,255&M.gzhead.os),M.gzhead.extra&&M.gzhead.extra.length&&(C(M,255&M.gzhead.extra.length),C(M,M.gzhead.extra.length>>8&255)),M.gzhead.hcrc&&(z.adler=N(z.adler,M.pending_buf,M.pending,0)),M.gzindex=0,M.status=69):(C(M,0),C(M,0),C(M,0),C(M,0),C(M,0),C(M,M.level===9?2:2<=M.strategy||M.level<2?4:0),C(M,3),M.status=H);else{var te=8+(M.w_bits-8<<4)<<8;te|=(2<=M.strategy||M.level<2?0:M.level<6?1:M.level===6?2:3)<<6,M.strstart!==0&&(te|=32),te+=31-te%31,M.status=H,_(M,te),M.strstart!==0&&(_(M,z.adler>>>16),_(M,65535&z.adler)),z.adler=1}if(M.status===69)if(M.gzhead.extra){for(K=M.pending;M.gzindex<(65535&M.gzhead.extra.length)&&(M.pending!==M.pending_buf_size||(M.gzhead.hcrc&&M.pending>K&&(z.adler=N(z.adler,M.pending_buf,M.pending-K,K)),O(z),K=M.pending,M.pending!==M.pending_buf_size));)C(M,255&M.gzhead.extra[M.gzindex]),M.gzindex++;M.gzhead.hcrc&&M.pending>K&&(z.adler=N(z.adler,M.pending_buf,M.pending-K,K)),M.gzindex===M.gzhead.extra.length&&(M.gzindex=0,M.status=73)}else M.status=73;if(M.status===73)if(M.gzhead.name){K=M.pending;do{if(M.pending===M.pending_buf_size&&(M.gzhead.hcrc&&M.pending>K&&(z.adler=N(z.adler,M.pending_buf,M.pending-K,K)),O(z),K=M.pending,M.pending===M.pending_buf_size)){se=1;break}se=M.gzindex<M.gzhead.name.length?255&M.gzhead.name.charCodeAt(M.gzindex++):0,C(M,se)}while(se!==0);M.gzhead.hcrc&&M.pending>K&&(z.adler=N(z.adler,M.pending_buf,M.pending-K,K)),se===0&&(M.gzindex=0,M.status=91)}else M.status=91;if(M.status===91)if(M.gzhead.comment){K=M.pending;do{if(M.pending===M.pending_buf_size&&(M.gzhead.hcrc&&M.pending>K&&(z.adler=N(z.adler,M.pending_buf,M.pending-K,K)),O(z),K=M.pending,M.pending===M.pending_buf_size)){se=1;break}se=M.gzindex<M.gzhead.comment.length?255&M.gzhead.comment.charCodeAt(M.gzindex++):0,C(M,se)}while(se!==0);M.gzhead.hcrc&&M.pending>K&&(z.adler=N(z.adler,M.pending_buf,M.pending-K,K)),se===0&&(M.status=103)}else M.status=103;if(M.status===103&&(M.gzhead.hcrc?(M.pending+2>M.pending_buf_size&&O(z),M.pending+2<=M.pending_buf_size&&(C(M,255&z.adler),C(M,z.adler>>8&255),z.adler=0,M.status=H)):M.status=H),M.pending!==0){if(O(z),z.avail_out===0)return M.last_flush=-1,0}else if(z.avail_in===0&&Z(ee)<=Z(L)&&ee!==4)return G(z,-5);if(M.status===666&&z.avail_in!==0)return G(z,-5);if(z.avail_in!==0||M.lookahead!==0||ee!==0&&M.status!==666){var ae=M.strategy===2?function(Q,fe){for(var le;;){if(Q.lookahead===0&&(A(Q),Q.lookahead===0)){if(fe===0)return 1;break}if(Q.match_length=0,le=y._tr_tally(Q,0,Q.window[Q.strstart]),Q.lookahead--,Q.strstart++,le&&(R(Q,!1),Q.strm.avail_out===0))return 1}return Q.insert=0,fe===4?(R(Q,!0),Q.strm.avail_out===0?3:4):Q.last_lit&&(R(Q,!1),Q.strm.avail_out===0)?1:2}(M,ee):M.strategy===3?function(Q,fe){for(var le,ne,ue,he,ke=Q.window;;){if(Q.lookahead<=V){if(A(Q),Q.lookahead<=V&&fe===0)return 1;if(Q.lookahead===0)break}if(Q.match_length=0,Q.lookahead>=3&&0<Q.strstart&&(ne=ke[ue=Q.strstart-1])===ke[++ue]&&ne===ke[++ue]&&ne===ke[++ue]){he=Q.strstart+V;do;while(ne===ke[++ue]&&ne===ke[++ue]&&ne===ke[++ue]&&ne===ke[++ue]&&ne===ke[++ue]&&ne===ke[++ue]&&ne===ke[++ue]&&ne===ke[++ue]&&ue<he);Q.match_length=V-(he-ue),Q.match_length>Q.lookahead&&(Q.match_length=Q.lookahead)}if(Q.match_length>=3?(le=y._tr_tally(Q,1,Q.match_length-3),Q.lookahead-=Q.match_length,Q.strstart+=Q.match_length,Q.match_length=0):(le=y._tr_tally(Q,0,Q.window[Q.strstart]),Q.lookahead--,Q.strstart++),le&&(R(Q,!1),Q.strm.avail_out===0))return 1}return Q.insert=0,fe===4?(R(Q,!0),Q.strm.avail_out===0?3:4):Q.last_lit&&(R(Q,!1),Q.strm.avail_out===0)?1:2}(M,ee):g[M.level].func(M,ee);if(ae!==3&&ae!==4||(M.status=666),ae===1||ae===3)return z.avail_out===0&&(M.last_flush=-1),0;if(ae===2&&(ee===1?y._tr_align(M):ee!==5&&(y._tr_stored_block(M,0,0,!1),ee===3&&(W(M.head),M.lookahead===0&&(M.strstart=0,M.block_start=0,M.insert=0))),O(z),z.avail_out===0))return M.last_flush=-1,0}return ee!==4?0:M.wrap<=0?1:(M.wrap===2?(C(M,255&z.adler),C(M,z.adler>>8&255),C(M,z.adler>>16&255),C(M,z.adler>>24&255),C(M,255&z.total_in),C(M,z.total_in>>8&255),C(M,z.total_in>>16&255),C(M,z.total_in>>24&255)):(_(M,z.adler>>>16),_(M,65535&z.adler)),O(z),0<M.wrap&&(M.wrap=-M.wrap),M.pending!==0?0:1)},b.deflateEnd=function(z){var ee;return z&&z.state?(ee=z.state.status)!==42&&ee!==69&&ee!==73&&ee!==91&&ee!==103&&ee!==H&&ee!==666?G(z,P):(z.state=null,ee===H?G(z,-3):0):P},b.deflateSetDictionary=function(z,ee){var L,M,K,se,te,ae,Q,fe,le=ee.length;if(!z||!z.state||(se=(L=z.state).wrap)===2||se===1&&L.status!==42||L.lookahead)return P;for(se===1&&(z.adler=E(z.adler,ee,le,0)),L.wrap=0,le>=L.w_size&&(se===0&&(W(L.head),L.strstart=0,L.block_start=0,L.insert=0),fe=new x.Buf8(L.w_size),x.arraySet(fe,ee,le-L.w_size,L.w_size,0),ee=fe,le=L.w_size),te=z.avail_in,ae=z.next_in,Q=z.input,z.avail_in=le,z.next_in=0,z.input=ee,A(L);L.lookahead>=3;){for(M=L.strstart,K=L.lookahead-2;L.ins_h=(L.ins_h<<L.hash_shift^L.window[M+3-1])&L.hash_mask,L.prev[M&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=M,M++,--K;);L.strstart=M,L.lookahead=2,A(L)}return L.strstart+=L.lookahead,L.block_start=L.strstart,L.insert=L.lookahead,L.lookahead=0,L.match_length=L.prev_length=2,L.match_available=0,z.next_in=ae,z.input=Q,z.avail_in=te,L.wrap=se,0},b.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(h,v,b){v.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(h,v,b){v.exports=function(g,x){var y,E,N,I,P,V,U,H,G,Z,W,O,R,C,_,k,A,T,D,B,F,Y,X,re,z;y=g.state,E=g.next_in,re=g.input,N=E+(g.avail_in-5),I=g.next_out,z=g.output,P=I-(x-g.avail_out),V=I+(g.avail_out-257),U=y.dmax,H=y.wsize,G=y.whave,Z=y.wnext,W=y.window,O=y.hold,R=y.bits,C=y.lencode,_=y.distcode,k=(1<<y.lenbits)-1,A=(1<<y.distbits)-1;e:do{R<15&&(O+=re[E++]<<R,R+=8,O+=re[E++]<<R,R+=8),T=C[O&k];t:for(;;){if(O>>>=D=T>>>24,R-=D,(D=T>>>16&255)==0)z[I++]=65535&T;else{if(!(16&D)){if((64&D)==0){T=C[(65535&T)+(O&(1<<D)-1)];continue t}if(32&D){y.mode=12;break e}g.msg="invalid literal/length code",y.mode=30;break e}B=65535&T,(D&=15)&&(R<D&&(O+=re[E++]<<R,R+=8),B+=O&(1<<D)-1,O>>>=D,R-=D),R<15&&(O+=re[E++]<<R,R+=8,O+=re[E++]<<R,R+=8),T=_[O&A];r:for(;;){if(O>>>=D=T>>>24,R-=D,!(16&(D=T>>>16&255))){if((64&D)==0){T=_[(65535&T)+(O&(1<<D)-1)];continue r}g.msg="invalid distance code",y.mode=30;break e}if(F=65535&T,R<(D&=15)&&(O+=re[E++]<<R,(R+=8)<D&&(O+=re[E++]<<R,R+=8)),U<(F+=O&(1<<D)-1)){g.msg="invalid distance too far back",y.mode=30;break e}if(O>>>=D,R-=D,(D=I-P)<F){if(G<(D=F-D)&&y.sane){g.msg="invalid distance too far back",y.mode=30;break e}if(X=W,(Y=0)===Z){if(Y+=H-D,D<B){for(B-=D;z[I++]=W[Y++],--D;);Y=I-F,X=z}}else if(Z<D){if(Y+=H+Z-D,(D-=Z)<B){for(B-=D;z[I++]=W[Y++],--D;);if(Y=0,Z<B){for(B-=D=Z;z[I++]=W[Y++],--D;);Y=I-F,X=z}}}else if(Y+=Z-D,D<B){for(B-=D;z[I++]=W[Y++],--D;);Y=I-F,X=z}for(;2<B;)z[I++]=X[Y++],z[I++]=X[Y++],z[I++]=X[Y++],B-=3;B&&(z[I++]=X[Y++],1<B&&(z[I++]=X[Y++]))}else{for(Y=I-F;z[I++]=z[Y++],z[I++]=z[Y++],z[I++]=z[Y++],2<(B-=3););B&&(z[I++]=z[Y++],1<B&&(z[I++]=z[Y++]))}break}}break}}while(E<N&&I<V);E-=B=R>>3,O&=(1<<(R-=B<<3))-1,g.next_in=E,g.next_out=I,g.avail_in=E<N?N-E+5:5-(E-N),g.avail_out=I<V?V-I+257:257-(I-V),y.hold=O,y.bits=R}},{}],49:[function(h,v,b){var g=h("../utils/common"),x=h("./adler32"),y=h("./crc32"),E=h("./inffast"),N=h("./inftrees"),I=-2;function P(k){return(k>>>24&255)+(k>>>8&65280)+((65280&k)<<8)+((255&k)<<24)}function V(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new g.Buf16(320),this.work=new g.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function U(k){var A;return k&&k.state?(A=k.state,k.total_in=k.total_out=A.total=0,k.msg="",A.wrap&&(k.adler=1&A.wrap),A.mode=1,A.last=0,A.havedict=0,A.dmax=32768,A.head=null,A.hold=0,A.bits=0,A.lencode=A.lendyn=new g.Buf32(852),A.distcode=A.distdyn=new g.Buf32(592),A.sane=1,A.back=-1,0):I}function H(k){var A;return k&&k.state?((A=k.state).wsize=0,A.whave=0,A.wnext=0,U(k)):I}function G(k,A){var T,D;return k&&k.state?(D=k.state,A<0?(T=0,A=-A):(T=1+(A>>4),A<48&&(A&=15)),A&&(A<8||15<A)?I:(D.window!==null&&D.wbits!==A&&(D.window=null),D.wrap=T,D.wbits=A,H(k))):I}function Z(k,A){var T,D;return k?(D=new V,(k.state=D).window=null,(T=G(k,A))!==0&&(k.state=null),T):I}var W,O,R=!0;function C(k){if(R){var A;for(W=new g.Buf32(512),O=new g.Buf32(32),A=0;A<144;)k.lens[A++]=8;for(;A<256;)k.lens[A++]=9;for(;A<280;)k.lens[A++]=7;for(;A<288;)k.lens[A++]=8;for(N(1,k.lens,0,288,W,0,k.work,{bits:9}),A=0;A<32;)k.lens[A++]=5;N(2,k.lens,0,32,O,0,k.work,{bits:5}),R=!1}k.lencode=W,k.lenbits=9,k.distcode=O,k.distbits=5}function _(k,A,T,D){var B,F=k.state;return F.window===null&&(F.wsize=1<<F.wbits,F.wnext=0,F.whave=0,F.window=new g.Buf8(F.wsize)),D>=F.wsize?(g.arraySet(F.window,A,T-F.wsize,F.wsize,0),F.wnext=0,F.whave=F.wsize):(D<(B=F.wsize-F.wnext)&&(B=D),g.arraySet(F.window,A,T-D,B,F.wnext),(D-=B)?(g.arraySet(F.window,A,T-D,D,0),F.wnext=D,F.whave=F.wsize):(F.wnext+=B,F.wnext===F.wsize&&(F.wnext=0),F.whave<F.wsize&&(F.whave+=B))),0}b.inflateReset=H,b.inflateReset2=G,b.inflateResetKeep=U,b.inflateInit=function(k){return Z(k,15)},b.inflateInit2=Z,b.inflate=function(k,A){var T,D,B,F,Y,X,re,z,ee,L,M,K,se,te,ae,Q,fe,le,ne,ue,he,ke,pe,Ce,Me=0,Ie=new g.Buf8(4),Ye=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!k||!k.state||!k.output||!k.input&&k.avail_in!==0)return I;(T=k.state).mode===12&&(T.mode=13),Y=k.next_out,B=k.output,re=k.avail_out,F=k.next_in,D=k.input,X=k.avail_in,z=T.hold,ee=T.bits,L=X,M=re,ke=0;e:for(;;)switch(T.mode){case 1:if(T.wrap===0){T.mode=13;break}for(;ee<16;){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}if(2&T.wrap&&z===35615){Ie[T.check=0]=255&z,Ie[1]=z>>>8&255,T.check=y(T.check,Ie,2,0),ee=z=0,T.mode=2;break}if(T.flags=0,T.head&&(T.head.done=!1),!(1&T.wrap)||(((255&z)<<8)+(z>>8))%31){k.msg="incorrect header check",T.mode=30;break}if((15&z)!=8){k.msg="unknown compression method",T.mode=30;break}if(ee-=4,he=8+(15&(z>>>=4)),T.wbits===0)T.wbits=he;else if(he>T.wbits){k.msg="invalid window size",T.mode=30;break}T.dmax=1<<he,k.adler=T.check=1,T.mode=512&z?10:12,ee=z=0;break;case 2:for(;ee<16;){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}if(T.flags=z,(255&T.flags)!=8){k.msg="unknown compression method",T.mode=30;break}if(57344&T.flags){k.msg="unknown header flags set",T.mode=30;break}T.head&&(T.head.text=z>>8&1),512&T.flags&&(Ie[0]=255&z,Ie[1]=z>>>8&255,T.check=y(T.check,Ie,2,0)),ee=z=0,T.mode=3;case 3:for(;ee<32;){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}T.head&&(T.head.time=z),512&T.flags&&(Ie[0]=255&z,Ie[1]=z>>>8&255,Ie[2]=z>>>16&255,Ie[3]=z>>>24&255,T.check=y(T.check,Ie,4,0)),ee=z=0,T.mode=4;case 4:for(;ee<16;){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}T.head&&(T.head.xflags=255&z,T.head.os=z>>8),512&T.flags&&(Ie[0]=255&z,Ie[1]=z>>>8&255,T.check=y(T.check,Ie,2,0)),ee=z=0,T.mode=5;case 5:if(1024&T.flags){for(;ee<16;){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}T.length=z,T.head&&(T.head.extra_len=z),512&T.flags&&(Ie[0]=255&z,Ie[1]=z>>>8&255,T.check=y(T.check,Ie,2,0)),ee=z=0}else T.head&&(T.head.extra=null);T.mode=6;case 6:if(1024&T.flags&&(X<(K=T.length)&&(K=X),K&&(T.head&&(he=T.head.extra_len-T.length,T.head.extra||(T.head.extra=new Array(T.head.extra_len)),g.arraySet(T.head.extra,D,F,K,he)),512&T.flags&&(T.check=y(T.check,D,K,F)),X-=K,F+=K,T.length-=K),T.length))break e;T.length=0,T.mode=7;case 7:if(2048&T.flags){if(X===0)break e;for(K=0;he=D[F+K++],T.head&&he&&T.length<65536&&(T.head.name+=String.fromCharCode(he)),he&&K<X;);if(512&T.flags&&(T.check=y(T.check,D,K,F)),X-=K,F+=K,he)break e}else T.head&&(T.head.name=null);T.length=0,T.mode=8;case 8:if(4096&T.flags){if(X===0)break e;for(K=0;he=D[F+K++],T.head&&he&&T.length<65536&&(T.head.comment+=String.fromCharCode(he)),he&&K<X;);if(512&T.flags&&(T.check=y(T.check,D,K,F)),X-=K,F+=K,he)break e}else T.head&&(T.head.comment=null);T.mode=9;case 9:if(512&T.flags){for(;ee<16;){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}if(z!==(65535&T.check)){k.msg="header crc mismatch",T.mode=30;break}ee=z=0}T.head&&(T.head.hcrc=T.flags>>9&1,T.head.done=!0),k.adler=T.check=0,T.mode=12;break;case 10:for(;ee<32;){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}k.adler=T.check=P(z),ee=z=0,T.mode=11;case 11:if(T.havedict===0)return k.next_out=Y,k.avail_out=re,k.next_in=F,k.avail_in=X,T.hold=z,T.bits=ee,2;k.adler=T.check=1,T.mode=12;case 12:if(A===5||A===6)break e;case 13:if(T.last){z>>>=7&ee,ee-=7&ee,T.mode=27;break}for(;ee<3;){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}switch(T.last=1&z,ee-=1,3&(z>>>=1)){case 0:T.mode=14;break;case 1:if(C(T),T.mode=20,A!==6)break;z>>>=2,ee-=2;break e;case 2:T.mode=17;break;case 3:k.msg="invalid block type",T.mode=30}z>>>=2,ee-=2;break;case 14:for(z>>>=7&ee,ee-=7&ee;ee<32;){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}if((65535&z)!=(z>>>16^65535)){k.msg="invalid stored block lengths",T.mode=30;break}if(T.length=65535&z,ee=z=0,T.mode=15,A===6)break e;case 15:T.mode=16;case 16:if(K=T.length){if(X<K&&(K=X),re<K&&(K=re),K===0)break e;g.arraySet(B,D,F,K,Y),X-=K,F+=K,re-=K,Y+=K,T.length-=K;break}T.mode=12;break;case 17:for(;ee<14;){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}if(T.nlen=257+(31&z),z>>>=5,ee-=5,T.ndist=1+(31&z),z>>>=5,ee-=5,T.ncode=4+(15&z),z>>>=4,ee-=4,286<T.nlen||30<T.ndist){k.msg="too many length or distance symbols",T.mode=30;break}T.have=0,T.mode=18;case 18:for(;T.have<T.ncode;){for(;ee<3;){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}T.lens[Ye[T.have++]]=7&z,z>>>=3,ee-=3}for(;T.have<19;)T.lens[Ye[T.have++]]=0;if(T.lencode=T.lendyn,T.lenbits=7,pe={bits:T.lenbits},ke=N(0,T.lens,0,19,T.lencode,0,T.work,pe),T.lenbits=pe.bits,ke){k.msg="invalid code lengths set",T.mode=30;break}T.have=0,T.mode=19;case 19:for(;T.have<T.nlen+T.ndist;){for(;Q=(Me=T.lencode[z&(1<<T.lenbits)-1])>>>16&255,fe=65535&Me,!((ae=Me>>>24)<=ee);){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}if(fe<16)z>>>=ae,ee-=ae,T.lens[T.have++]=fe;else{if(fe===16){for(Ce=ae+2;ee<Ce;){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}if(z>>>=ae,ee-=ae,T.have===0){k.msg="invalid bit length repeat",T.mode=30;break}he=T.lens[T.have-1],K=3+(3&z),z>>>=2,ee-=2}else if(fe===17){for(Ce=ae+3;ee<Ce;){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}ee-=ae,he=0,K=3+(7&(z>>>=ae)),z>>>=3,ee-=3}else{for(Ce=ae+7;ee<Ce;){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}ee-=ae,he=0,K=11+(127&(z>>>=ae)),z>>>=7,ee-=7}if(T.have+K>T.nlen+T.ndist){k.msg="invalid bit length repeat",T.mode=30;break}for(;K--;)T.lens[T.have++]=he}}if(T.mode===30)break;if(T.lens[256]===0){k.msg="invalid code -- missing end-of-block",T.mode=30;break}if(T.lenbits=9,pe={bits:T.lenbits},ke=N(1,T.lens,0,T.nlen,T.lencode,0,T.work,pe),T.lenbits=pe.bits,ke){k.msg="invalid literal/lengths set",T.mode=30;break}if(T.distbits=6,T.distcode=T.distdyn,pe={bits:T.distbits},ke=N(2,T.lens,T.nlen,T.ndist,T.distcode,0,T.work,pe),T.distbits=pe.bits,ke){k.msg="invalid distances set",T.mode=30;break}if(T.mode=20,A===6)break e;case 20:T.mode=21;case 21:if(6<=X&&258<=re){k.next_out=Y,k.avail_out=re,k.next_in=F,k.avail_in=X,T.hold=z,T.bits=ee,E(k,M),Y=k.next_out,B=k.output,re=k.avail_out,F=k.next_in,D=k.input,X=k.avail_in,z=T.hold,ee=T.bits,T.mode===12&&(T.back=-1);break}for(T.back=0;Q=(Me=T.lencode[z&(1<<T.lenbits)-1])>>>16&255,fe=65535&Me,!((ae=Me>>>24)<=ee);){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}if(Q&&(240&Q)==0){for(le=ae,ne=Q,ue=fe;Q=(Me=T.lencode[ue+((z&(1<<le+ne)-1)>>le)])>>>16&255,fe=65535&Me,!(le+(ae=Me>>>24)<=ee);){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}z>>>=le,ee-=le,T.back+=le}if(z>>>=ae,ee-=ae,T.back+=ae,T.length=fe,Q===0){T.mode=26;break}if(32&Q){T.back=-1,T.mode=12;break}if(64&Q){k.msg="invalid literal/length code",T.mode=30;break}T.extra=15&Q,T.mode=22;case 22:if(T.extra){for(Ce=T.extra;ee<Ce;){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}T.length+=z&(1<<T.extra)-1,z>>>=T.extra,ee-=T.extra,T.back+=T.extra}T.was=T.length,T.mode=23;case 23:for(;Q=(Me=T.distcode[z&(1<<T.distbits)-1])>>>16&255,fe=65535&Me,!((ae=Me>>>24)<=ee);){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}if((240&Q)==0){for(le=ae,ne=Q,ue=fe;Q=(Me=T.distcode[ue+((z&(1<<le+ne)-1)>>le)])>>>16&255,fe=65535&Me,!(le+(ae=Me>>>24)<=ee);){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}z>>>=le,ee-=le,T.back+=le}if(z>>>=ae,ee-=ae,T.back+=ae,64&Q){k.msg="invalid distance code",T.mode=30;break}T.offset=fe,T.extra=15&Q,T.mode=24;case 24:if(T.extra){for(Ce=T.extra;ee<Ce;){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}T.offset+=z&(1<<T.extra)-1,z>>>=T.extra,ee-=T.extra,T.back+=T.extra}if(T.offset>T.dmax){k.msg="invalid distance too far back",T.mode=30;break}T.mode=25;case 25:if(re===0)break e;if(K=M-re,T.offset>K){if((K=T.offset-K)>T.whave&&T.sane){k.msg="invalid distance too far back",T.mode=30;break}se=K>T.wnext?(K-=T.wnext,T.wsize-K):T.wnext-K,K>T.length&&(K=T.length),te=T.window}else te=B,se=Y-T.offset,K=T.length;for(re<K&&(K=re),re-=K,T.length-=K;B[Y++]=te[se++],--K;);T.length===0&&(T.mode=21);break;case 26:if(re===0)break e;B[Y++]=T.length,re--,T.mode=21;break;case 27:if(T.wrap){for(;ee<32;){if(X===0)break e;X--,z|=D[F++]<<ee,ee+=8}if(M-=re,k.total_out+=M,T.total+=M,M&&(k.adler=T.check=T.flags?y(T.check,B,M,Y-M):x(T.check,B,M,Y-M)),M=re,(T.flags?z:P(z))!==T.check){k.msg="incorrect data check",T.mode=30;break}ee=z=0}T.mode=28;case 28:if(T.wrap&&T.flags){for(;ee<32;){if(X===0)break e;X--,z+=D[F++]<<ee,ee+=8}if(z!==(4294967295&T.total)){k.msg="incorrect length check",T.mode=30;break}ee=z=0}T.mode=29;case 29:ke=1;break e;case 30:ke=-3;break e;case 31:return-4;case 32:default:return I}return k.next_out=Y,k.avail_out=re,k.next_in=F,k.avail_in=X,T.hold=z,T.bits=ee,(T.wsize||M!==k.avail_out&&T.mode<30&&(T.mode<27||A!==4))&&_(k,k.output,k.next_out,M-k.avail_out)?(T.mode=31,-4):(L-=k.avail_in,M-=k.avail_out,k.total_in+=L,k.total_out+=M,T.total+=M,T.wrap&&M&&(k.adler=T.check=T.flags?y(T.check,B,M,k.next_out-M):x(T.check,B,M,k.next_out-M)),k.data_type=T.bits+(T.last?64:0)+(T.mode===12?128:0)+(T.mode===20||T.mode===15?256:0),(L==0&&M===0||A===4)&&ke===0&&(ke=-5),ke)},b.inflateEnd=function(k){if(!k||!k.state)return I;var A=k.state;return A.window&&(A.window=null),k.state=null,0},b.inflateGetHeader=function(k,A){var T;return k&&k.state?(2&(T=k.state).wrap)==0?I:((T.head=A).done=!1,0):I},b.inflateSetDictionary=function(k,A){var T,D=A.length;return k&&k.state?(T=k.state).wrap!==0&&T.mode!==11?I:T.mode===11&&x(1,A,D,0)!==T.check?-3:_(k,A,D,D)?(T.mode=31,-4):(T.havedict=1,0):I},b.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(h,v,b){var g=h("../utils/common"),x=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],y=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],E=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],N=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];v.exports=function(I,P,V,U,H,G,Z,W){var O,R,C,_,k,A,T,D,B,F=W.bits,Y=0,X=0,re=0,z=0,ee=0,L=0,M=0,K=0,se=0,te=0,ae=null,Q=0,fe=new g.Buf16(16),le=new g.Buf16(16),ne=null,ue=0;for(Y=0;Y<=15;Y++)fe[Y]=0;for(X=0;X<U;X++)fe[P[V+X]]++;for(ee=F,z=15;1<=z&&fe[z]===0;z--);if(z<ee&&(ee=z),z===0)return H[G++]=20971520,H[G++]=20971520,W.bits=1,0;for(re=1;re<z&&fe[re]===0;re++);for(ee<re&&(ee=re),Y=K=1;Y<=15;Y++)if(K<<=1,(K-=fe[Y])<0)return-1;if(0<K&&(I===0||z!==1))return-1;for(le[1]=0,Y=1;Y<15;Y++)le[Y+1]=le[Y]+fe[Y];for(X=0;X<U;X++)P[V+X]!==0&&(Z[le[P[V+X]]++]=X);if(A=I===0?(ae=ne=Z,19):I===1?(ae=x,Q-=257,ne=y,ue-=257,256):(ae=E,ne=N,-1),Y=re,k=G,M=X=te=0,C=-1,_=(se=1<<(L=ee))-1,I===1&&852<se||I===2&&592<se)return 1;for(;;){for(T=Y-M,B=Z[X]<A?(D=0,Z[X]):Z[X]>A?(D=ne[ue+Z[X]],ae[Q+Z[X]]):(D=96,0),O=1<<Y-M,re=R=1<<L;H[k+(te>>M)+(R-=O)]=T<<24|D<<16|B|0,R!==0;);for(O=1<<Y-1;te&O;)O>>=1;if(O!==0?(te&=O-1,te+=O):te=0,X++,--fe[Y]==0){if(Y===z)break;Y=P[V+Z[X]]}if(ee<Y&&(te&_)!==C){for(M===0&&(M=ee),k+=re,K=1<<(L=Y-M);L+M<z&&!((K-=fe[L+M])<=0);)L++,K<<=1;if(se+=1<<L,I===1&&852<se||I===2&&592<se)return 1;H[C=te&_]=ee<<24|L<<16|k-G|0}}return te!==0&&(H[k+te]=Y-M<<24|64<<16|0),W.bits=ee,0}},{"../utils/common":41}],51:[function(h,v,b){v.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(h,v,b){var g=h("../utils/common");function x(ne){for(var ue=ne.length;0<=--ue;)ne[ue]=0}var y=256,E=286,N=30,I=15,P=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],V=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],U=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=new Array(576);x(G);var Z=new Array(60);x(Z);var W=new Array(512);x(W);var O=new Array(256);x(O);var R=new Array(29);x(R);var C,_,k,A=new Array(N);function T(ne,ue,he,ke,pe){this.static_tree=ne,this.extra_bits=ue,this.extra_base=he,this.elems=ke,this.max_length=pe,this.has_stree=ne&&ne.length}function D(ne,ue){this.dyn_tree=ne,this.max_code=0,this.stat_desc=ue}function B(ne){return ne<256?W[ne]:W[256+(ne>>>7)]}function F(ne,ue){ne.pending_buf[ne.pending++]=255&ue,ne.pending_buf[ne.pending++]=ue>>>8&255}function Y(ne,ue,he){ne.bi_valid>16-he?(ne.bi_buf|=ue<<ne.bi_valid&65535,F(ne,ne.bi_buf),ne.bi_buf=ue>>16-ne.bi_valid,ne.bi_valid+=he-16):(ne.bi_buf|=ue<<ne.bi_valid&65535,ne.bi_valid+=he)}function X(ne,ue,he){Y(ne,he[2*ue],he[2*ue+1])}function re(ne,ue){for(var he=0;he|=1&ne,ne>>>=1,he<<=1,0<--ue;);return he>>>1}function z(ne,ue,he){var ke,pe,Ce=new Array(16),Me=0;for(ke=1;ke<=I;ke++)Ce[ke]=Me=Me+he[ke-1]<<1;for(pe=0;pe<=ue;pe++){var Ie=ne[2*pe+1];Ie!==0&&(ne[2*pe]=re(Ce[Ie]++,Ie))}}function ee(ne){var ue;for(ue=0;ue<E;ue++)ne.dyn_ltree[2*ue]=0;for(ue=0;ue<N;ue++)ne.dyn_dtree[2*ue]=0;for(ue=0;ue<19;ue++)ne.bl_tree[2*ue]=0;ne.dyn_ltree[512]=1,ne.opt_len=ne.static_len=0,ne.last_lit=ne.matches=0}function L(ne){8<ne.bi_valid?F(ne,ne.bi_buf):0<ne.bi_valid&&(ne.pending_buf[ne.pending++]=ne.bi_buf),ne.bi_buf=0,ne.bi_valid=0}function M(ne,ue,he,ke){var pe=2*ue,Ce=2*he;return ne[pe]<ne[Ce]||ne[pe]===ne[Ce]&&ke[ue]<=ke[he]}function K(ne,ue,he){for(var ke=ne.heap[he],pe=he<<1;pe<=ne.heap_len&&(pe<ne.heap_len&&M(ue,ne.heap[pe+1],ne.heap[pe],ne.depth)&&pe++,!M(ue,ke,ne.heap[pe],ne.depth));)ne.heap[he]=ne.heap[pe],he=pe,pe<<=1;ne.heap[he]=ke}function se(ne,ue,he){var ke,pe,Ce,Me,Ie=0;if(ne.last_lit!==0)for(;ke=ne.pending_buf[ne.d_buf+2*Ie]<<8|ne.pending_buf[ne.d_buf+2*Ie+1],pe=ne.pending_buf[ne.l_buf+Ie],Ie++,ke===0?X(ne,pe,ue):(X(ne,(Ce=O[pe])+y+1,ue),(Me=P[Ce])!==0&&Y(ne,pe-=R[Ce],Me),X(ne,Ce=B(--ke),he),(Me=V[Ce])!==0&&Y(ne,ke-=A[Ce],Me)),Ie<ne.last_lit;);X(ne,256,ue)}function te(ne,ue){var he,ke,pe,Ce=ue.dyn_tree,Me=ue.stat_desc.static_tree,Ie=ue.stat_desc.has_stree,Ye=ue.stat_desc.elems,at=-1;for(ne.heap_len=0,ne.heap_max=573,he=0;he<Ye;he++)Ce[2*he]!==0?(ne.heap[++ne.heap_len]=at=he,ne.depth[he]=0):Ce[2*he+1]=0;for(;ne.heap_len<2;)Ce[2*(pe=ne.heap[++ne.heap_len]=at<2?++at:0)]=1,ne.depth[pe]=0,ne.opt_len--,Ie&&(ne.static_len-=Me[2*pe+1]);for(ue.max_code=at,he=ne.heap_len>>1;1<=he;he--)K(ne,Ce,he);for(pe=Ye;he=ne.heap[1],ne.heap[1]=ne.heap[ne.heap_len--],K(ne,Ce,1),ke=ne.heap[1],ne.heap[--ne.heap_max]=he,ne.heap[--ne.heap_max]=ke,Ce[2*pe]=Ce[2*he]+Ce[2*ke],ne.depth[pe]=(ne.depth[he]>=ne.depth[ke]?ne.depth[he]:ne.depth[ke])+1,Ce[2*he+1]=Ce[2*ke+1]=pe,ne.heap[1]=pe++,K(ne,Ce,1),2<=ne.heap_len;);ne.heap[--ne.heap_max]=ne.heap[1],function(rt,it){var et,st,je,ht,Je,nt,ct=it.dyn_tree,_t=it.max_code,mt=it.stat_desc.static_tree,gt=it.stat_desc.has_stree,He=it.stat_desc.extra_bits,Ue=it.stat_desc.extra_base,bt=it.stat_desc.max_length,tt=0;for(ht=0;ht<=I;ht++)rt.bl_count[ht]=0;for(ct[2*rt.heap[rt.heap_max]+1]=0,et=rt.heap_max+1;et<573;et++)bt<(ht=ct[2*ct[2*(st=rt.heap[et])+1]+1]+1)&&(ht=bt,tt++),ct[2*st+1]=ht,_t<st||(rt.bl_count[ht]++,Je=0,Ue<=st&&(Je=He[st-Ue]),nt=ct[2*st],rt.opt_len+=nt*(ht+Je),gt&&(rt.static_len+=nt*(mt[2*st+1]+Je)));if(tt!==0){do{for(ht=bt-1;rt.bl_count[ht]===0;)ht--;rt.bl_count[ht]--,rt.bl_count[ht+1]+=2,rt.bl_count[bt]--,tt-=2}while(0<tt);for(ht=bt;ht!==0;ht--)for(st=rt.bl_count[ht];st!==0;)_t<(je=rt.heap[--et])||(ct[2*je+1]!==ht&&(rt.opt_len+=(ht-ct[2*je+1])*ct[2*je],ct[2*je+1]=ht),st--)}}(ne,ue),z(Ce,at,ne.bl_count)}function ae(ne,ue,he){var ke,pe,Ce=-1,Me=ue[1],Ie=0,Ye=7,at=4;for(Me===0&&(Ye=138,at=3),ue[2*(he+1)+1]=65535,ke=0;ke<=he;ke++)pe=Me,Me=ue[2*(ke+1)+1],++Ie<Ye&&pe===Me||(Ie<at?ne.bl_tree[2*pe]+=Ie:pe!==0?(pe!==Ce&&ne.bl_tree[2*pe]++,ne.bl_tree[32]++):Ie<=10?ne.bl_tree[34]++:ne.bl_tree[36]++,Ce=pe,at=(Ie=0)===Me?(Ye=138,3):pe===Me?(Ye=6,3):(Ye=7,4))}function Q(ne,ue,he){var ke,pe,Ce=-1,Me=ue[1],Ie=0,Ye=7,at=4;for(Me===0&&(Ye=138,at=3),ke=0;ke<=he;ke++)if(pe=Me,Me=ue[2*(ke+1)+1],!(++Ie<Ye&&pe===Me)){if(Ie<at)for(;X(ne,pe,ne.bl_tree),--Ie!=0;);else pe!==0?(pe!==Ce&&(X(ne,pe,ne.bl_tree),Ie--),X(ne,16,ne.bl_tree),Y(ne,Ie-3,2)):Ie<=10?(X(ne,17,ne.bl_tree),Y(ne,Ie-3,3)):(X(ne,18,ne.bl_tree),Y(ne,Ie-11,7));Ce=pe,at=(Ie=0)===Me?(Ye=138,3):pe===Me?(Ye=6,3):(Ye=7,4)}}x(A);var fe=!1;function le(ne,ue,he,ke){Y(ne,0+(ke?1:0),3),function(pe,Ce,Me,Ie){L(pe),F(pe,Me),F(pe,~Me),g.arraySet(pe.pending_buf,pe.window,Ce,Me,pe.pending),pe.pending+=Me}(ne,ue,he)}b._tr_init=function(ne){fe||(function(){var ue,he,ke,pe,Ce,Me=new Array(16);for(pe=ke=0;pe<28;pe++)for(R[pe]=ke,ue=0;ue<1<<P[pe];ue++)O[ke++]=pe;for(O[ke-1]=pe,pe=Ce=0;pe<16;pe++)for(A[pe]=Ce,ue=0;ue<1<<V[pe];ue++)W[Ce++]=pe;for(Ce>>=7;pe<N;pe++)for(A[pe]=Ce<<7,ue=0;ue<1<<V[pe]-7;ue++)W[256+Ce++]=pe;for(he=0;he<=I;he++)Me[he]=0;for(ue=0;ue<=143;)G[2*ue+1]=8,ue++,Me[8]++;for(;ue<=255;)G[2*ue+1]=9,ue++,Me[9]++;for(;ue<=279;)G[2*ue+1]=7,ue++,Me[7]++;for(;ue<=287;)G[2*ue+1]=8,ue++,Me[8]++;for(z(G,287,Me),ue=0;ue<N;ue++)Z[2*ue+1]=5,Z[2*ue]=re(ue,5);C=new T(G,P,257,E,I),_=new T(Z,V,0,N,I),k=new T(new Array(0),U,0,19,7)}(),fe=!0),ne.l_desc=new D(ne.dyn_ltree,C),ne.d_desc=new D(ne.dyn_dtree,_),ne.bl_desc=new D(ne.bl_tree,k),ne.bi_buf=0,ne.bi_valid=0,ee(ne)},b._tr_stored_block=le,b._tr_flush_block=function(ne,ue,he,ke){var pe,Ce,Me=0;0<ne.level?(ne.strm.data_type===2&&(ne.strm.data_type=function(Ie){var Ye,at=4093624447;for(Ye=0;Ye<=31;Ye++,at>>>=1)if(1&at&&Ie.dyn_ltree[2*Ye]!==0)return 0;if(Ie.dyn_ltree[18]!==0||Ie.dyn_ltree[20]!==0||Ie.dyn_ltree[26]!==0)return 1;for(Ye=32;Ye<y;Ye++)if(Ie.dyn_ltree[2*Ye]!==0)return 1;return 0}(ne)),te(ne,ne.l_desc),te(ne,ne.d_desc),Me=function(Ie){var Ye;for(ae(Ie,Ie.dyn_ltree,Ie.l_desc.max_code),ae(Ie,Ie.dyn_dtree,Ie.d_desc.max_code),te(Ie,Ie.bl_desc),Ye=18;3<=Ye&&Ie.bl_tree[2*H[Ye]+1]===0;Ye--);return Ie.opt_len+=3*(Ye+1)+5+5+4,Ye}(ne),pe=ne.opt_len+3+7>>>3,(Ce=ne.static_len+3+7>>>3)<=pe&&(pe=Ce)):pe=Ce=he+5,he+4<=pe&&ue!==-1?le(ne,ue,he,ke):ne.strategy===4||Ce===pe?(Y(ne,2+(ke?1:0),3),se(ne,G,Z)):(Y(ne,4+(ke?1:0),3),function(Ie,Ye,at,rt){var it;for(Y(Ie,Ye-257,5),Y(Ie,at-1,5),Y(Ie,rt-4,4),it=0;it<rt;it++)Y(Ie,Ie.bl_tree[2*H[it]+1],3);Q(Ie,Ie.dyn_ltree,Ye-1),Q(Ie,Ie.dyn_dtree,at-1)}(ne,ne.l_desc.max_code+1,ne.d_desc.max_code+1,Me+1),se(ne,ne.dyn_ltree,ne.dyn_dtree)),ee(ne),ke&&L(ne)},b._tr_tally=function(ne,ue,he){return ne.pending_buf[ne.d_buf+2*ne.last_lit]=ue>>>8&255,ne.pending_buf[ne.d_buf+2*ne.last_lit+1]=255&ue,ne.pending_buf[ne.l_buf+ne.last_lit]=255&he,ne.last_lit++,ue===0?ne.dyn_ltree[2*he]++:(ne.matches++,ue--,ne.dyn_ltree[2*(O[he]+y+1)]++,ne.dyn_dtree[2*B(ue)]++),ne.last_lit===ne.lit_bufsize-1},b._tr_align=function(ne){Y(ne,2,3),X(ne,256,G),function(ue){ue.bi_valid===16?(F(ue,ue.bi_buf),ue.bi_buf=0,ue.bi_valid=0):8<=ue.bi_valid&&(ue.pending_buf[ue.pending++]=255&ue.bi_buf,ue.bi_buf>>=8,ue.bi_valid-=8)}(ne)}},{"../utils/common":41}],53:[function(h,v,b){v.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(h,v,b){(function(g){(function(x,y){if(!x.setImmediate){var E,N,I,P,V=1,U={},H=!1,G=x.document,Z=Object.getPrototypeOf&&Object.getPrototypeOf(x);Z=Z&&Z.setTimeout?Z:x,E={}.toString.call(x.process)==="[object process]"?function(C){o.nextTick(function(){O(C)})}:function(){if(x.postMessage&&!x.importScripts){var C=!0,_=x.onmessage;return x.onmessage=function(){C=!1},x.postMessage("","*"),x.onmessage=_,C}}()?(P="setImmediate$"+Math.random()+"$",x.addEventListener?x.addEventListener("message",R,!1):x.attachEvent("onmessage",R),function(C){x.postMessage(P+C,"*")}):x.MessageChannel?((I=new MessageChannel).port1.onmessage=function(C){O(C.data)},function(C){I.port2.postMessage(C)}):G&&"onreadystatechange"in G.createElement("script")?(N=G.documentElement,function(C){var _=G.createElement("script");_.onreadystatechange=function(){O(C),_.onreadystatechange=null,N.removeChild(_),_=null},N.appendChild(_)}):function(C){setTimeout(O,0,C)},Z.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var _=new Array(arguments.length-1),k=0;k<_.length;k++)_[k]=arguments[k+1];var A={callback:C,args:_};return U[V]=A,E(V),V++},Z.clearImmediate=W}function W(C){delete U[C]}function O(C){if(H)setTimeout(O,0,C);else{var _=U[C];if(_){H=!0;try{(function(k){var A=k.callback,T=k.args;switch(T.length){case 0:A();break;case 1:A(T[0]);break;case 2:A(T[0],T[1]);break;case 3:A(T[0],T[1],T[2]);break;default:A.apply(void 0,T)}})(_)}finally{W(C),H=!1}}}}function R(C){C.source===x&&typeof C.data=="string"&&C.data.indexOf(P)===0&&O(+C.data.slice(P.length))}})(typeof self>"u"?g===void 0?this:g:self)}).call(this,s!==void 0?s:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],e("timers").setImmediate)},{_process:467,buffer:220,timers:523}],442:[function(e,a,n){(function(o){(function(){var s=/[\\^$.*+?()[\]{}|]/g,l=RegExp(s.source),c=typeof o=="object"&&o&&o.Object===Object&&o,i=typeof self=="object"&&self&&self.Object===Object&&self,u=c||i||Function("return this")(),p=Object.prototype.toString,f=u.Symbol,h=f?f.prototype:void 0,v=h?h.toString:void 0;function b(g){if(typeof g=="string")return g;if(function(y){return typeof y=="symbol"||function(E){return!!E&&typeof E=="object"}(y)&&p.call(y)=="[object Symbol]"}(g))return v?v.call(g):"";var x=g+"";return x=="0"&&1/g==-1/0?"-0":x}a.exports=function(g){var x;return(g=(x=g)==null?"":b(x))&&l.test(g)?g.replace(s,"\\$&"):g}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],443:[function(e,a,n){(function(o){(function(){var s="[object Arguments]",l="[object Map]",c="[object Object]",i="[object Set]",u=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,p=/^\w*$/,f=/^\./,h=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,v=/\\(\\)?/g,b=/^\[object .+?Constructor\]$/,g=/^(?:0|[1-9]\d*)$/,x={};x["[object Float32Array]"]=x["[object Float64Array]"]=x["[object Int8Array]"]=x["[object Int16Array]"]=x["[object Int32Array]"]=x["[object Uint8Array]"]=x["[object Uint8ClampedArray]"]=x["[object Uint16Array]"]=x["[object Uint32Array]"]=!0,x[s]=x["[object Array]"]=x["[object ArrayBuffer]"]=x["[object Boolean]"]=x["[object DataView]"]=x["[object Date]"]=x["[object Error]"]=x["[object Function]"]=x[l]=x["[object Number]"]=x[c]=x["[object RegExp]"]=x[i]=x["[object String]"]=x["[object WeakMap]"]=!1;var y=typeof o=="object"&&o&&o.Object===Object&&o,E=typeof self=="object"&&self&&self.Object===Object&&self,N=y||E||Function("return this")(),I=typeof n=="object"&&n&&!n.nodeType&&n,P=I&&typeof a=="object"&&a&&!a.nodeType&&a,V=P&&P.exports===I&&y.process,U=function(){try{return V&&V.binding("util")}catch{}}(),H=U&&U.isTypedArray;function G(ce,Te,me,ye){for(var Ve=-1,$e=ce?ce.length:0;++Ve<$e;){var ot=ce[Ve];Te(ye,ot,me(ot),ce)}return ye}function Z(ce,Te){for(var me=-1,ye=ce?ce.length:0;++me<ye;)if(Te(ce[me],me,ce))return!0;return!1}function W(ce){var Te=!1;if(ce!=null&&typeof ce.toString!="function")try{Te=!!(ce+"")}catch{}return Te}function O(ce){var Te=-1,me=Array(ce.size);return ce.forEach(function(ye,Ve){me[++Te]=[Ve,ye]}),me}function R(ce){var Te=-1,me=Array(ce.size);return ce.forEach(function(ye){me[++Te]=ye}),me}var C,_,k,A=Array.prototype,T=Function.prototype,D=Object.prototype,B=N["__core-js_shared__"],F=(C=/[^.]+$/.exec(B&&B.keys&&B.keys.IE_PROTO||""))?"Symbol(src)_1."+C:"",Y=T.toString,X=D.hasOwnProperty,re=D.toString,z=RegExp("^"+Y.call(X).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ee=N.Symbol,L=N.Uint8Array,M=D.propertyIsEnumerable,K=A.splice,se=(_=Object.keys,k=Object,function(ce){return _(k(ce))}),te=xt(N,"DataView"),ae=xt(N,"Map"),Q=xt(N,"Promise"),fe=xt(N,"Set"),le=xt(N,"WeakMap"),ne=xt(Object,"create"),ue=Fe(te),he=Fe(ae),ke=Fe(Q),pe=Fe(fe),Ce=Fe(le),Me=ee?ee.prototype:void 0,Ie=Me?Me.valueOf:void 0,Ye=Me?Me.toString:void 0;function at(ce){var Te=-1,me=ce?ce.length:0;for(this.clear();++Te<me;){var ye=ce[Te];this.set(ye[0],ye[1])}}function rt(ce){var Te=-1,me=ce?ce.length:0;for(this.clear();++Te<me;){var ye=ce[Te];this.set(ye[0],ye[1])}}function it(ce){var Te=-1,me=ce?ce.length:0;for(this.clear();++Te<me;){var ye=ce[Te];this.set(ye[0],ye[1])}}function et(ce){var Te=-1,me=ce?ce.length:0;for(this.__data__=new it;++Te<me;)this.add(ce[Te])}function st(ce){this.__data__=new rt(ce)}function je(ce,Te){var me=be(ce)||ve(ce)?function(ot,Rt){for(var Bt=-1,Vt=Array(ot);++Bt<ot;)Vt[Bt]=Rt(Bt);return Vt}(ce.length,String):[],ye=me.length,Ve=!!ye;for(var $e in ce)!X.call(ce,$e)||Ve&&($e=="length"||Kt($e,ye))||me.push($e);return me}function ht(ce,Te){for(var me=ce.length;me--;)if(de(ce[me][0],Te))return me;return-1}function Je(ce,Te,me,ye){return ct(ce,function(Ve,$e,ot){Te(ye,Ve,me(Ve),ot)}),ye}at.prototype.clear=function(){this.__data__=ne?ne(null):{}},at.prototype.delete=function(ce){return this.has(ce)&&delete this.__data__[ce]},at.prototype.get=function(ce){var Te=this.__data__;if(ne){var me=Te[ce];return me==="__lodash_hash_undefined__"?void 0:me}return X.call(Te,ce)?Te[ce]:void 0},at.prototype.has=function(ce){var Te=this.__data__;return ne?Te[ce]!==void 0:X.call(Te,ce)},at.prototype.set=function(ce,Te){return this.__data__[ce]=ne&&Te===void 0?"__lodash_hash_undefined__":Te,this},rt.prototype.clear=function(){this.__data__=[]},rt.prototype.delete=function(ce){var Te=this.__data__,me=ht(Te,ce);return!(me<0)&&(me==Te.length-1?Te.pop():K.call(Te,me,1),!0)},rt.prototype.get=function(ce){var Te=this.__data__,me=ht(Te,ce);return me<0?void 0:Te[me][1]},rt.prototype.has=function(ce){return ht(this.__data__,ce)>-1},rt.prototype.set=function(ce,Te){var me=this.__data__,ye=ht(me,ce);return ye<0?me.push([ce,Te]):me[ye][1]=Te,this},it.prototype.clear=function(){this.__data__={hash:new at,map:new(ae||rt),string:new at}},it.prototype.delete=function(ce){return vt(this,ce).delete(ce)},it.prototype.get=function(ce){return vt(this,ce).get(ce)},it.prototype.has=function(ce){return vt(this,ce).has(ce)},it.prototype.set=function(ce,Te){return vt(this,ce).set(ce,Te),this},et.prototype.add=et.prototype.push=function(ce){return this.__data__.set(ce,"__lodash_hash_undefined__"),this},et.prototype.has=function(ce){return this.__data__.has(ce)},st.prototype.clear=function(){this.__data__=new rt},st.prototype.delete=function(ce){return this.__data__.delete(ce)},st.prototype.get=function(ce){return this.__data__.get(ce)},st.prototype.has=function(ce){return this.__data__.has(ce)},st.prototype.set=function(ce,Te){var me=this.__data__;if(me instanceof rt){var ye=me.__data__;if(!ae||ye.length<199)return ye.push([ce,Te]),this;me=this.__data__=new it(ye)}return me.set(ce,Te),this};var nt,ct=(nt=function(ce,Te){return ce&&_t(ce,Te,Ee)},function(ce,Te){if(ce==null)return ce;if(!we(ce))return nt(ce,Te);for(var me=ce.length,ye=-1,Ve=Object(ce);++ye<me&&Te(Ve[ye],ye,Ve)!==!1;);return ce}),_t=function(ce){return function(Te,me,ye){for(var Ve=-1,$e=Object(Te),ot=ye(Te),Rt=ot.length;Rt--;){var Bt=ot[++Ve];if(me($e[Bt],Bt,$e)===!1)break}return Te}}();function mt(ce,Te){for(var me=0,ye=(Te=yt(Te,ce)?[Te]:dt(Te)).length;ce!=null&&me<ye;)ce=ce[Ae(Te[me++])];return me&&me==ye?ce:void 0}function gt(ce,Te){return ce!=null&&Te in Object(ce)}function He(ce,Te,me,ye,Ve){return ce===Te||(ce==null||Te==null||!Oe(ce)&&!Pe(Te)?ce!=ce&&Te!=Te:function($e,ot,Rt,Bt,Vt,Lt){var er=be($e),gr=be(ot),tr="[object Array]",Mr="[object Array]";er||(tr=(tr=At($e))==s?c:tr),gr||(Mr=(Mr=At(ot))==s?c:Mr);var ea=tr==c&&!W($e),ta=Mr==c&&!W(ot),tn=tr==Mr;if(tn&&!ea)return Lt||(Lt=new st),er||xe($e)?ut($e,ot,Rt,Bt,Vt,Lt):function(vr,ir,Wa,fs,no,ra,Wn){switch(Wa){case"[object DataView]":if(vr.byteLength!=ir.byteLength||vr.byteOffset!=ir.byteOffset)return!1;vr=vr.buffer,ir=ir.buffer;case"[object ArrayBuffer]":return!(vr.byteLength!=ir.byteLength||!fs(new L(vr),new L(ir)));case"[object Boolean]":case"[object Date]":case"[object Number]":return de(+vr,+ir);case"[object Error]":return vr.name==ir.name&&vr.message==ir.message;case"[object RegExp]":case"[object String]":return vr==ir+"";case l:var Gn=O;case i:var di=2&ra;if(Gn||(Gn=R),vr.size!=ir.size&&!di)return!1;var fi=Wn.get(vr);if(fi)return fi==ir;ra|=1,Wn.set(vr,ir);var hi=ut(Gn(vr),Gn(ir),fs,no,ra,Wn);return Wn.delete(vr),hi;case"[object Symbol]":if(Ie)return Ie.call(vr)==Ie.call(ir)}return!1}($e,ot,tr,Rt,Bt,Vt,Lt);if(!(2&Vt)){var An=ea&&X.call($e,"__wrapped__"),ui=ta&&X.call(ot,"__wrapped__");if(An||ui){var fa=An?$e.value():$e,ds=ui?ot.value():ot;return Lt||(Lt=new st),Rt(fa,ds,Bt,Vt,Lt)}}return tn?(Lt||(Lt=new st),function(vr,ir,Wa,fs,no,ra){var Wn=2&no,Gn=Ee(vr),di=Gn.length,fi=Ee(ir).length;if(di!=fi&&!Wn)return!1;for(var hi=di;hi--;){var hs=Gn[hi];if(!(Wn?hs in ir:X.call(ir,hs)))return!1}var so=ra.get(vr);if(so&&ra.get(ir))return so==ir;var pi=!0;ra.set(vr,ir),ra.set(ir,vr);for(var io=Wn;++hi<di;){hs=Gn[hi];var Yn=vr[hs],Xn=ir[hs];if(fs)var sc=Wn?fs(Xn,Yn,hs,ir,vr,ra):fs(Yn,Xn,hs,vr,ir,ra);if(!(sc===void 0?Yn===Xn||Wa(Yn,Xn,fs,no,ra):sc)){pi=!1;break}io||(io=hs=="constructor")}if(pi&&!io){var mi=vr.constructor,oo=ir.constructor;mi==oo||!("constructor"in vr)||!("constructor"in ir)||typeof mi=="function"&&mi instanceof mi&&typeof oo=="function"&&oo instanceof oo||(pi=!1)}return ra.delete(vr),ra.delete(ir),pi}($e,ot,Rt,Bt,Vt,Lt)):!1}(ce,Te,He,me,ye,Ve))}function Ue(ce){return!(!Oe(ce)||function(Te){return!!F&&F in Te}(ce))&&(De(ce)||W(ce)?z:b).test(Fe(ce))}function bt(ce){return typeof ce=="function"?ce:ce==null?qe:typeof ce=="object"?be(ce)?function(ye,Ve){return yt(ye)&&Ct(Ve)?Ft(Ae(ye),Ve):function($e){var ot=function(Rt,Bt,Vt){var Lt=Rt==null?void 0:mt(Rt,Bt);return Lt===void 0?Vt:Lt}($e,ye);return ot===void 0&&ot===Ve?function(Rt,Bt){return Rt!=null&&function(Vt,Lt,er){Lt=yt(Lt,Vt)?[Lt]:dt(Lt);for(var gr,tr=-1,Mr=Lt.length;++tr<Mr;){var ea=Ae(Lt[tr]);if(!(gr=Vt!=null&&er(Vt,ea)))break;Vt=Vt[ea]}return gr||!!(Mr=Vt?Vt.length:0)&&Le(Mr)&&Kt(ea,Mr)&&(be(Vt)||ve(Vt))}(Rt,Bt,gt)}($e,ye):He(Ve,ot,void 0,3)}}(ce[0],ce[1]):function(ye){var Ve=function($e){for(var ot=Ee($e),Rt=ot.length;Rt--;){var Bt=ot[Rt],Vt=$e[Bt];ot[Rt]=[Bt,Vt,Ct(Vt)]}return ot}(ye);return Ve.length==1&&Ve[0][2]?Ft(Ve[0][0],Ve[0][1]):function($e){return $e===ye||function(ot,Rt,Bt,Vt){var Lt=Bt.length,er=Lt;if(ot==null)return!er;for(ot=Object(ot);Lt--;){var gr=Bt[Lt];if(gr[2]?gr[1]!==ot[gr[0]]:!(gr[0]in ot))return!1}for(;++Lt<er;){var tr=(gr=Bt[Lt])[0],Mr=ot[tr],ea=gr[1];if(gr[2]){if(Mr===void 0&&!(tr in ot))return!1}else{var ta=new st,tn;if(!(tn===void 0?He(ea,Mr,Vt,3,ta):tn))return!1}}return!0}($e,ye,Ve)}}(ce):yt(Te=ce)?(me=Ae(Te),function(ye){return ye==null?void 0:ye[me]}):function(ye){return function(Ve){return mt(Ve,ye)}}(Te);var Te,me}function tt(ce){if(me=(Te=ce)&&Te.constructor,ye=typeof me=="function"&&me.prototype||D,Te!==ye)return se(ce);var Te,me,ye,Ve=[];for(var $e in Object(ce))X.call(ce,$e)&&$e!="constructor"&&Ve.push($e);return Ve}function dt(ce){return be(ce)?ce:kt(ce)}function ut(ce,Te,me,ye,Ve,$e){var ot=2&Ve,Rt=ce.length,Bt=Te.length;if(Rt!=Bt&&!(ot&&Bt>Rt))return!1;var Vt=$e.get(ce);if(Vt&&$e.get(Te))return Vt==Te;var Lt=-1,er=!0,gr=1&Ve?new et:void 0;for($e.set(ce,Te),$e.set(Te,ce);++Lt<Rt;){var tr=ce[Lt],Mr=Te[Lt];if(ye)var ea=ot?ye(Mr,tr,Lt,Te,ce,$e):ye(tr,Mr,Lt,ce,Te,$e);if(ea!==void 0){if(ea)continue;er=!1;break}if(gr){if(!Z(Te,function(ta,tn){if(!gr.has(tn)&&(tr===ta||me(tr,ta,ye,Ve,$e)))return gr.add(tn)})){er=!1;break}}else if(tr!==Mr&&!me(tr,Mr,ye,Ve,$e)){er=!1;break}}return $e.delete(ce),$e.delete(Te),er}function vt(ce,Te){var me,ye,Ve=ce.__data__;return((ye=typeof(me=Te))=="string"||ye=="number"||ye=="symbol"||ye=="boolean"?me!=="__proto__":me===null)?Ve[typeof Te=="string"?"string":"hash"]:Ve.map}function xt(ce,Te){var me=function(ye,Ve){return ye==null?void 0:ye[Ve]}(ce,Te);return Ue(me)?me:void 0}var At=function(ce){return re.call(ce)};function Kt(ce,Te){return!!(Te=Te??9007199254740991)&&(typeof ce=="number"||g.test(ce))&&ce>-1&&ce%1==0&&ce<Te}function yt(ce,Te){if(be(ce))return!1;var me=typeof ce;return!(me!="number"&&me!="symbol"&&me!="boolean"&&ce!=null&&!Be(ce))||p.test(ce)||!u.test(ce)||Te!=null&&ce in Object(Te)}function Ct(ce){return ce==ce&&!Oe(ce)}function Ft(ce,Te){return function(me){return me!=null&&me[ce]===Te&&(Te!==void 0||ce in Object(me))}}(te&&At(new te(new ArrayBuffer(1)))!="[object DataView]"||ae&&At(new ae)!=l||Q&&At(Q.resolve())!="[object Promise]"||fe&&At(new fe)!=i||le&&At(new le)!="[object WeakMap]")&&(At=function(ce){var Te=re.call(ce),me=Te==c?ce.constructor:void 0,ye=me?Fe(me):void 0;if(ye)switch(ye){case ue:return"[object DataView]";case he:return l;case ke:return"[object Promise]";case pe:return i;case Ce:return"[object WeakMap]"}return Te});var kt=_e(function(ce){var Te;ce=(Te=ce)==null?"":function(ye){if(typeof ye=="string")return ye;if(Be(ye))return Ye?Ye.call(ye):"";var Ve=ye+"";return Ve=="0"&&1/ye==-1/0?"-0":Ve}(Te);var me=[];return f.test(ce)&&me.push(""),ce.replace(h,function(ye,Ve,$e,ot){me.push($e?ot.replace(v,"$1"):Ve||ye)}),me});function Ae(ce){if(typeof ce=="string"||Be(ce))return ce;var Te=ce+"";return Te=="0"&&1/ce==-1/0?"-0":Te}function Fe(ce){if(ce!=null){try{return Y.call(ce)}catch{}try{return ce+""}catch{}}return""}var Qe,ie=(Qe=function(ce,Te,me){X.call(ce,me)?ce[me].push(Te):ce[me]=[Te]},function(ce,Te){var me=be(ce)?G:Je,ye={};return me(ce,Qe,bt(Te),ye)});function _e(ce,Te){if(typeof ce!="function"||Te&&typeof Te!="function")throw new TypeError("Expected a function");var me=function(){var ye=arguments,Ve=Te?Te.apply(this,ye):ye[0],$e=me.cache;if($e.has(Ve))return $e.get(Ve);var ot=ce.apply(this,ye);return me.cache=$e.set(Ve,ot),ot};return me.cache=new(_e.Cache||it),me}function de(ce,Te){return ce===Te||ce!=ce&&Te!=Te}function ve(ce){return function(Te){return Pe(Te)&&we(Te)}(ce)&&X.call(ce,"callee")&&(!M.call(ce,"callee")||re.call(ce)==s)}_e.Cache=it;var be=Array.isArray;function we(ce){return ce!=null&&Le(ce.length)&&!De(ce)}function De(ce){var Te=Oe(ce)?re.call(ce):"";return Te=="[object Function]"||Te=="[object GeneratorFunction]"}function Le(ce){return typeof ce=="number"&&ce>-1&&ce%1==0&&ce<=9007199254740991}function Oe(ce){var Te=typeof ce;return!!ce&&(Te=="object"||Te=="function")}function Pe(ce){return!!ce&&typeof ce=="object"}function Be(ce){return typeof ce=="symbol"||Pe(ce)&&re.call(ce)=="[object Symbol]"}var xe=H?function(ce){return function(Te){return ce(Te)}}(H):function(ce){return Pe(ce)&&Le(ce.length)&&!!x[re.call(ce)]};function Ee(ce){return we(ce)?je(ce):tt(ce)}function qe(ce){return ce}a.exports=ie}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],444:[function(e,a,n){var o=Object.prototype.toString;a.exports=function(s){return s===!0||s===!1||function(l){return!!l&&typeof l=="object"}(s)&&o.call(s)=="[object Boolean]"}},{}],445:[function(e,a,n){(function(o){(function(){var s="[object Arguments]",l="[object Map]",c="[object Object]",i="[object Set]",u=/^\[object .+?Constructor\]$/,p=/^(?:0|[1-9]\d*)$/,f={};f["[object Float32Array]"]=f["[object Float64Array]"]=f["[object Int8Array]"]=f["[object Int16Array]"]=f["[object Int32Array]"]=f["[object Uint8Array]"]=f["[object Uint8ClampedArray]"]=f["[object Uint16Array]"]=f["[object Uint32Array]"]=!0,f[s]=f["[object Array]"]=f["[object ArrayBuffer]"]=f["[object Boolean]"]=f["[object DataView]"]=f["[object Date]"]=f["[object Error]"]=f["[object Function]"]=f[l]=f["[object Number]"]=f[c]=f["[object RegExp]"]=f[i]=f["[object String]"]=f["[object WeakMap]"]=!1;var h=typeof o=="object"&&o&&o.Object===Object&&o,v=typeof self=="object"&&self&&self.Object===Object&&self,b=h||v||Function("return this")(),g=typeof n=="object"&&n&&!n.nodeType&&n,x=g&&typeof a=="object"&&a&&!a.nodeType&&a,y=x&&x.exports===g,E=y&&h.process,N=function(){try{return E&&E.binding&&E.binding("util")}catch{}}(),I=N&&N.isTypedArray;function P(Ae,Fe){for(var Qe=-1,ie=Ae==null?0:Ae.length;++Qe<ie;)if(Fe(Ae[Qe],Qe,Ae))return!0;return!1}function V(Ae){var Fe=-1,Qe=Array(Ae.size);return Ae.forEach(function(ie,_e){Qe[++Fe]=[_e,ie]}),Qe}function U(Ae){var Fe=-1,Qe=Array(Ae.size);return Ae.forEach(function(ie){Qe[++Fe]=ie}),Qe}var H,G,Z,W=Array.prototype,O=Function.prototype,R=Object.prototype,C=b["__core-js_shared__"],_=O.toString,k=R.hasOwnProperty,A=(H=/[^.]+$/.exec(C&&C.keys&&C.keys.IE_PROTO||""))?"Symbol(src)_1."+H:"",T=R.toString,D=RegExp("^"+_.call(k).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),B=y?b.Buffer:void 0,F=b.Symbol,Y=b.Uint8Array,X=R.propertyIsEnumerable,re=W.splice,z=F?F.toStringTag:void 0,ee=Object.getOwnPropertySymbols,L=B?B.isBuffer:void 0,M=(G=Object.keys,Z=Object,function(Ae){return G(Z(Ae))}),K=gt(b,"DataView"),se=gt(b,"Map"),te=gt(b,"Promise"),ae=gt(b,"Set"),Q=gt(b,"WeakMap"),fe=gt(Object,"create"),le=tt(K),ne=tt(se),ue=tt(te),he=tt(ae),ke=tt(Q),pe=F?F.prototype:void 0,Ce=pe?pe.valueOf:void 0;function Me(Ae){var Fe=-1,Qe=Ae==null?0:Ae.length;for(this.clear();++Fe<Qe;){var ie=Ae[Fe];this.set(ie[0],ie[1])}}function Ie(Ae){var Fe=-1,Qe=Ae==null?0:Ae.length;for(this.clear();++Fe<Qe;){var ie=Ae[Fe];this.set(ie[0],ie[1])}}function Ye(Ae){var Fe=-1,Qe=Ae==null?0:Ae.length;for(this.clear();++Fe<Qe;){var ie=Ae[Fe];this.set(ie[0],ie[1])}}function at(Ae){var Fe=-1,Qe=Ae==null?0:Ae.length;for(this.__data__=new Ye;++Fe<Qe;)this.add(Ae[Fe])}function rt(Ae){var Fe=this.__data__=new Ie(Ae);this.size=Fe.size}function it(Ae,Fe){var Qe=vt(Ae),ie=!Qe&&ut(Ae),_e=!Qe&&!ie&&xt(Ae),de=!Qe&&!ie&&!_e&&Ft(Ae),ve=Qe||ie||_e||de,be=ve?function(Le,Oe){for(var Pe=-1,Be=Array(Le);++Pe<Le;)Be[Pe]=Oe(Pe);return Be}(Ae.length,String):[],we=be.length;for(var De in Ae)!k.call(Ae,De)||ve&&(De=="length"||_e&&(De=="offset"||De=="parent")||de&&(De=="buffer"||De=="byteLength"||De=="byteOffset")||bt(De,we))||be.push(De);return be}function et(Ae,Fe){for(var Qe=Ae.length;Qe--;)if(dt(Ae[Qe][0],Fe))return Qe;return-1}function st(Ae){return Ae==null?Ae===void 0?"[object Undefined]":"[object Null]":z&&z in Object(Ae)?function(Fe){var Qe=k.call(Fe,z),ie=Fe[z];try{Fe[z]=void 0;var _e=!0}catch{}var de=T.call(Fe);return _e&&(Qe?Fe[z]=ie:delete Fe[z]),de}(Ae):function(Fe){return T.call(Fe)}(Ae)}function je(Ae){return Ct(Ae)&&st(Ae)==s}function ht(Ae,Fe,Qe,ie,_e){return Ae===Fe||(Ae==null||Fe==null||!Ct(Ae)&&!Ct(Fe)?Ae!=Ae&&Fe!=Fe:function(de,ve,be,we,De,Le){var Oe=vt(de),Pe=vt(ve),Be=Oe?"[object Array]":Ue(de),xe=Pe?"[object Array]":Ue(ve),Ee=(Be=Be==s?c:Be)==c,qe=(xe=xe==s?c:xe)==c,ce=Be==xe;if(ce&&xt(de)){if(!xt(ve))return!1;Oe=!0,Ee=!1}if(ce&&!Ee)return Le||(Le=new rt),Oe||Ft(de)?ct(de,ve,be,we,De,Le):function($e,ot,Rt,Bt,Vt,Lt,er){switch(Rt){case"[object DataView]":if($e.byteLength!=ot.byteLength||$e.byteOffset!=ot.byteOffset)return!1;$e=$e.buffer,ot=ot.buffer;case"[object ArrayBuffer]":return!($e.byteLength!=ot.byteLength||!Lt(new Y($e),new Y(ot)));case"[object Boolean]":case"[object Date]":case"[object Number]":return dt(+$e,+ot);case"[object Error]":return $e.name==ot.name&&$e.message==ot.message;case"[object RegExp]":case"[object String]":return $e==ot+"";case l:var gr=V;case i:var tr=1&Bt;if(gr||(gr=U),$e.size!=ot.size&&!tr)return!1;var Mr=er.get($e);if(Mr)return Mr==ot;Bt|=2,er.set($e,ot);var ea=ct(gr($e),gr(ot),Bt,Vt,Lt,er);return er.delete($e),ea;case"[object Symbol]":if(Ce)return Ce.call($e)==Ce.call(ot)}return!1}(de,ve,Be,be,we,De,Le);if(!(1&be)){var Te=Ee&&k.call(de,"__wrapped__"),me=qe&&k.call(ve,"__wrapped__");if(Te||me){var ye=Te?de.value():de,Ve=me?ve.value():ve;return Le||(Le=new rt),De(ye,Ve,be,we,Le)}}return ce?(Le||(Le=new rt),function($e,ot,Rt,Bt,Vt,Lt){var er=1&Rt,gr=_t($e),tr=gr.length,Mr=_t(ot).length;if(tr!=Mr&&!er)return!1;for(var ea=tr;ea--;){var ta=gr[ea];if(!(er?ta in ot:k.call(ot,ta)))return!1}var tn=Lt.get($e);if(tn&&Lt.get(ot))return tn==ot;var An=!0;Lt.set($e,ot),Lt.set(ot,$e);for(var ui=er;++ea<tr;){ta=gr[ea];var fa=$e[ta],ds=ot[ta];if(Bt)var vr=er?Bt(ds,fa,ta,ot,$e,Lt):Bt(fa,ds,ta,$e,ot,Lt);if(!(vr===void 0?fa===ds||Vt(fa,ds,Rt,Bt,Lt):vr)){An=!1;break}ui||(ui=ta=="constructor")}if(An&&!ui){var ir=$e.constructor,Wa=ot.constructor;ir==Wa||!("constructor"in $e)||!("constructor"in ot)||typeof ir=="function"&&ir instanceof ir&&typeof Wa=="function"&&Wa instanceof Wa||(An=!1)}return Lt.delete($e),Lt.delete(ot),An}(de,ve,be,we,De,Le)):!1}(Ae,Fe,Qe,ie,ht,_e))}function Je(Ae){return!(!yt(Ae)||function(Fe){return!!A&&A in Fe}(Ae))&&(At(Ae)?D:u).test(tt(Ae))}function nt(Ae){if(Qe=(Fe=Ae)&&Fe.constructor,ie=typeof Qe=="function"&&Qe.prototype||R,Fe!==ie)return M(Ae);var Fe,Qe,ie,_e=[];for(var de in Object(Ae))k.call(Ae,de)&&de!="constructor"&&_e.push(de);return _e}function ct(Ae,Fe,Qe,ie,_e,de){var ve=1&Qe,be=Ae.length,we=Fe.length;if(be!=we&&!(ve&&we>be))return!1;var De=de.get(Ae);if(De&&de.get(Fe))return De==Fe;var Le=-1,Oe=!0,Pe=2&Qe?new at:void 0;for(de.set(Ae,Fe),de.set(Fe,Ae);++Le<be;){var Be=Ae[Le],xe=Fe[Le];if(ie)var Ee=ve?ie(xe,Be,Le,Fe,Ae,de):ie(Be,xe,Le,Ae,Fe,de);if(Ee!==void 0){if(Ee)continue;Oe=!1;break}if(Pe){if(!P(Fe,function(qe,ce){if(Te=ce,!Pe.has(Te)&&(Be===qe||_e(Be,qe,Qe,ie,de)))return Pe.push(ce);var Te})){Oe=!1;break}}else if(Be!==xe&&!_e(Be,xe,Qe,ie,de)){Oe=!1;break}}return de.delete(Ae),de.delete(Fe),Oe}function _t(Ae){return function(Fe,Qe,ie){var _e=Qe(Fe);return vt(Fe)?_e:function(de,ve){for(var be=-1,we=ve.length,De=de.length;++be<we;)de[De+be]=ve[be];return de}(_e,ie(Fe))}(Ae,kt,He)}function mt(Ae,Fe){var Qe,ie,_e=Ae.__data__;return((ie=typeof(Qe=Fe))=="string"||ie=="number"||ie=="symbol"||ie=="boolean"?Qe!=="__proto__":Qe===null)?_e[typeof Fe=="string"?"string":"hash"]:_e.map}function gt(Ae,Fe){var Qe=function(ie,_e){return ie==null?void 0:ie[_e]}(Ae,Fe);return Je(Qe)?Qe:void 0}Me.prototype.clear=function(){this.__data__=fe?fe(null):{},this.size=0},Me.prototype.delete=function(Ae){var Fe=this.has(Ae)&&delete this.__data__[Ae];return this.size-=Fe?1:0,Fe},Me.prototype.get=function(Ae){var Fe=this.__data__;if(fe){var Qe=Fe[Ae];return Qe==="__lodash_hash_undefined__"?void 0:Qe}return k.call(Fe,Ae)?Fe[Ae]:void 0},Me.prototype.has=function(Ae){var Fe=this.__data__;return fe?Fe[Ae]!==void 0:k.call(Fe,Ae)},Me.prototype.set=function(Ae,Fe){var Qe=this.__data__;return this.size+=this.has(Ae)?0:1,Qe[Ae]=fe&&Fe===void 0?"__lodash_hash_undefined__":Fe,this},Ie.prototype.clear=function(){this.__data__=[],this.size=0},Ie.prototype.delete=function(Ae){var Fe=this.__data__,Qe=et(Fe,Ae);return!(Qe<0)&&(Qe==Fe.length-1?Fe.pop():re.call(Fe,Qe,1),--this.size,!0)},Ie.prototype.get=function(Ae){var Fe=this.__data__,Qe=et(Fe,Ae);return Qe<0?void 0:Fe[Qe][1]},Ie.prototype.has=function(Ae){return et(this.__data__,Ae)>-1},Ie.prototype.set=function(Ae,Fe){var Qe=this.__data__,ie=et(Qe,Ae);return ie<0?(++this.size,Qe.push([Ae,Fe])):Qe[ie][1]=Fe,this},Ye.prototype.clear=function(){this.size=0,this.__data__={hash:new Me,map:new(se||Ie),string:new Me}},Ye.prototype.delete=function(Ae){var Fe=mt(this,Ae).delete(Ae);return this.size-=Fe?1:0,Fe},Ye.prototype.get=function(Ae){return mt(this,Ae).get(Ae)},Ye.prototype.has=function(Ae){return mt(this,Ae).has(Ae)},Ye.prototype.set=function(Ae,Fe){var Qe=mt(this,Ae),ie=Qe.size;return Qe.set(Ae,Fe),this.size+=Qe.size==ie?0:1,this},at.prototype.add=at.prototype.push=function(Ae){return this.__data__.set(Ae,"__lodash_hash_undefined__"),this},at.prototype.has=function(Ae){return this.__data__.has(Ae)},rt.prototype.clear=function(){this.__data__=new Ie,this.size=0},rt.prototype.delete=function(Ae){var Fe=this.__data__,Qe=Fe.delete(Ae);return this.size=Fe.size,Qe},rt.prototype.get=function(Ae){return this.__data__.get(Ae)},rt.prototype.has=function(Ae){return this.__data__.has(Ae)},rt.prototype.set=function(Ae,Fe){var Qe=this.__data__;if(Qe instanceof Ie){var ie=Qe.__data__;if(!se||ie.length<199)return ie.push([Ae,Fe]),this.size=++Qe.size,this;Qe=this.__data__=new Ye(ie)}return Qe.set(Ae,Fe),this.size=Qe.size,this};var He=ee?function(Ae){return Ae==null?[]:(Ae=Object(Ae),function(Fe,Qe){for(var ie=-1,_e=Fe==null?0:Fe.length,de=0,ve=[];++ie<_e;){var be=Fe[ie];Qe(be,ie,Fe)&&(ve[de++]=be)}return ve}(ee(Ae),function(Fe){return X.call(Ae,Fe)}))}:function(){return[]},Ue=st;function bt(Ae,Fe){return!!(Fe=Fe??9007199254740991)&&(typeof Ae=="number"||p.test(Ae))&&Ae>-1&&Ae%1==0&&Ae<Fe}function tt(Ae){if(Ae!=null){try{return _.call(Ae)}catch{}try{return Ae+""}catch{}}return""}function dt(Ae,Fe){return Ae===Fe||Ae!=Ae&&Fe!=Fe}(K&&Ue(new K(new ArrayBuffer(1)))!="[object DataView]"||se&&Ue(new se)!=l||te&&Ue(te.resolve())!="[object Promise]"||ae&&Ue(new ae)!=i||Q&&Ue(new Q)!="[object WeakMap]")&&(Ue=function(Ae){var Fe=st(Ae),Qe=Fe==c?Ae.constructor:void 0,ie=Qe?tt(Qe):"";if(ie)switch(ie){case le:return"[object DataView]";case ne:return l;case ue:return"[object Promise]";case he:return i;case ke:return"[object WeakMap]"}return Fe});var ut=je(function(){return arguments}())?je:function(Ae){return Ct(Ae)&&k.call(Ae,"callee")&&!X.call(Ae,"callee")},vt=Array.isArray,xt=L||function(){return!1};function At(Ae){if(!yt(Ae))return!1;var Fe=st(Ae);return Fe=="[object Function]"||Fe=="[object GeneratorFunction]"||Fe=="[object AsyncFunction]"||Fe=="[object Proxy]"}function Kt(Ae){return typeof Ae=="number"&&Ae>-1&&Ae%1==0&&Ae<=9007199254740991}function yt(Ae){var Fe=typeof Ae;return Ae!=null&&(Fe=="object"||Fe=="function")}function Ct(Ae){return Ae!=null&&typeof Ae=="object"}var Ft=I?function(Ae){return function(Fe){return Ae(Fe)}}(I):function(Ae){return Ct(Ae)&&Kt(Ae.length)&&!!f[st(Ae)]};function kt(Ae){return(Fe=Ae)!=null&&Kt(Fe.length)&&!At(Fe)?it(Ae):nt(Ae);var Fe}a.exports=function(Ae,Fe){return ht(Ae,Fe)}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],446:[function(e,a,n){(function(o){(function(){var s=typeof o=="object"&&o&&o.Object===Object&&o,l=typeof self=="object"&&self&&self.Object===Object&&self,c=s||l||Function("return this")(),i=Object.prototype,u=i.hasOwnProperty,p=i.toString,f=c.Symbol,h=f?f.toStringTag:void 0;function v(b){return b==null?b===void 0?"[object Undefined]":"[object Null]":h&&h in Object(b)?function(g){var x=u.call(g,h),y=g[h];try{g[h]=void 0;var E=!0}catch{}var N=p.call(g);return E&&(x?g[h]=y:delete g[h]),N}(b):function(g){return p.call(g)}(b)}a.exports=function(b){if(!function(x){var y=typeof x;return x!=null&&(y=="object"||y=="function")}(b))return!1;var g=v(b);return g=="[object Function]"||g=="[object GeneratorFunction]"||g=="[object AsyncFunction]"||g=="[object Proxy]"}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],447:[function(e,a,n){a.exports=function(o){return o==null}},{}],448:[function(e,a,n){a.exports=function(o){return o===void 0}},{}],449:[function(e,a,n){(function(o){(function(){var s=/^\[object .+?Constructor\]$/,l=typeof o=="object"&&o&&o.Object===Object&&o,c=typeof self=="object"&&self&&self.Object===Object&&self,i=l||c||Function("return this")();function u(F,Y){return!!(F&&F.length)&&function(X,re,z){if(re!=re)return function(M,K,se,te){for(var ae=M.length,Q=se+-1;++Q<ae;)if(K(M[Q],Q,M))return Q;return-1}(X,p,z);for(var ee=z-1,L=X.length;++ee<L;)if(X[ee]===re)return ee;return-1}(F,Y,0)>-1}function p(F){return F!=F}function f(F,Y){return F.has(Y)}function h(F){var Y=-1,X=Array(F.size);return F.forEach(function(re){X[++Y]=re}),X}var v,b=Array.prototype,g=Function.prototype,x=Object.prototype,y=i["__core-js_shared__"],E=(v=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+v:"",N=g.toString,I=x.hasOwnProperty,P=x.toString,V=RegExp("^"+N.call(I).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),U=b.splice,H=D(i,"Map"),G=D(i,"Set"),Z=D(Object,"create");function W(F){var Y=-1,X=F?F.length:0;for(this.clear();++Y<X;){var re=F[Y];this.set(re[0],re[1])}}function O(F){var Y=-1,X=F?F.length:0;for(this.clear();++Y<X;){var re=F[Y];this.set(re[0],re[1])}}function R(F){var Y=-1,X=F?F.length:0;for(this.clear();++Y<X;){var re=F[Y];this.set(re[0],re[1])}}function C(F){var Y=-1,X=F?F.length:0;for(this.__data__=new R;++Y<X;)this.add(F[Y])}function _(F,Y){for(var X,re,z=F.length;z--;)if((X=F[z][0])===(re=Y)||X!=X&&re!=re)return z;return-1}function k(F){return!(!B(F)||(Y=F,E&&E in Y))&&(function(X){var re=B(X)?P.call(X):"";return re=="[object Function]"||re=="[object GeneratorFunction]"}(F)||function(X){var re=!1;if(X!=null&&typeof X.toString!="function")try{re=!!(X+"")}catch{}return re}(F)?V:s).test(function(X){if(X!=null){try{return N.call(X)}catch{}try{return X+""}catch{}}return""}(F));var Y}W.prototype.clear=function(){this.__data__=Z?Z(null):{}},W.prototype.delete=function(F){return this.has(F)&&delete this.__data__[F]},W.prototype.get=function(F){var Y=this.__data__;if(Z){var X=Y[F];return X==="__lodash_hash_undefined__"?void 0:X}return I.call(Y,F)?Y[F]:void 0},W.prototype.has=function(F){var Y=this.__data__;return Z?Y[F]!==void 0:I.call(Y,F)},W.prototype.set=function(F,Y){return this.__data__[F]=Z&&Y===void 0?"__lodash_hash_undefined__":Y,this},O.prototype.clear=function(){this.__data__=[]},O.prototype.delete=function(F){var Y=this.__data__,X=_(Y,F);return!(X<0)&&(X==Y.length-1?Y.pop():U.call(Y,X,1),!0)},O.prototype.get=function(F){var Y=this.__data__,X=_(Y,F);return X<0?void 0:Y[X][1]},O.prototype.has=function(F){return _(this.__data__,F)>-1},O.prototype.set=function(F,Y){var X=this.__data__,re=_(X,F);return re<0?X.push([F,Y]):X[re][1]=Y,this},R.prototype.clear=function(){this.__data__={hash:new W,map:new(H||O),string:new W}},R.prototype.delete=function(F){return T(this,F).delete(F)},R.prototype.get=function(F){return T(this,F).get(F)},R.prototype.has=function(F){return T(this,F).has(F)},R.prototype.set=function(F,Y){return T(this,F).set(F,Y),this},C.prototype.add=C.prototype.push=function(F){return this.__data__.set(F,"__lodash_hash_undefined__"),this},C.prototype.has=function(F){return this.__data__.has(F)};var A=G&&1/h(new G([,-0]))[1]==1/0?function(F){return new G(F)}:function(){};function T(F,Y){var X,re,z=F.__data__;return((re=typeof(X=Y))=="string"||re=="number"||re=="symbol"||re=="boolean"?X!=="__proto__":X===null)?z[typeof Y=="string"?"string":"hash"]:z.map}function D(F,Y){var X=function(re,z){return re==null?void 0:re[z]}(F,Y);return k(X)?X:void 0}function B(F){var Y=typeof F;return!!F&&(Y=="object"||Y=="function")}a.exports=function(F){return F&&F.length?function(Y,X,re){var z=-1,ee=u,L=Y.length,M=!0,K=[],se=K;if(L>=200){var te=A(Y);if(te)return h(te);M=!1,ee=f,se=new C}else se=K;e:for(;++z<L;){var ae=Y[z],Q=ae;if(ae=ae!==0?ae:0,M&&Q==Q){for(var fe=se.length;fe--;)if(se[fe]===Q)continue e;K.push(ae)}else ee(se,Q,re)||(se!==K&&se.push(Q),K.push(ae))}return K}(F):[]}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],450:[function(e,a,n){var o=e("inherits"),s=e("hash-base"),l=e("safe-buffer").Buffer,c=new Array(16);function i(){s.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function u(b,g){return b<<g|b>>>32-g}function p(b,g,x,y,E,N,I){return u(b+(g&x|~g&y)+E+N|0,I)+g|0}function f(b,g,x,y,E,N,I){return u(b+(g&y|x&~y)+E+N|0,I)+g|0}function h(b,g,x,y,E,N,I){return u(b+(g^x^y)+E+N|0,I)+g|0}function v(b,g,x,y,E,N,I){return u(b+(x^(g|~y))+E+N|0,I)+g|0}o(i,s),i.prototype._update=function(){for(var b=c,g=0;g<16;++g)b[g]=this._block.readInt32LE(4*g);var x=this._a,y=this._b,E=this._c,N=this._d;x=p(x,y,E,N,b[0],3614090360,7),N=p(N,x,y,E,b[1],3905402710,12),E=p(E,N,x,y,b[2],606105819,17),y=p(y,E,N,x,b[3],3250441966,22),x=p(x,y,E,N,b[4],4118548399,7),N=p(N,x,y,E,b[5],1200080426,12),E=p(E,N,x,y,b[6],2821735955,17),y=p(y,E,N,x,b[7],4249261313,22),x=p(x,y,E,N,b[8],1770035416,7),N=p(N,x,y,E,b[9],2336552879,12),E=p(E,N,x,y,b[10],4294925233,17),y=p(y,E,N,x,b[11],2304563134,22),x=p(x,y,E,N,b[12],1804603682,7),N=p(N,x,y,E,b[13],4254626195,12),E=p(E,N,x,y,b[14],2792965006,17),x=f(x,y=p(y,E,N,x,b[15],1236535329,22),E,N,b[1],4129170786,5),N=f(N,x,y,E,b[6],3225465664,9),E=f(E,N,x,y,b[11],643717713,14),y=f(y,E,N,x,b[0],3921069994,20),x=f(x,y,E,N,b[5],3593408605,5),N=f(N,x,y,E,b[10],38016083,9),E=f(E,N,x,y,b[15],3634488961,14),y=f(y,E,N,x,b[4],3889429448,20),x=f(x,y,E,N,b[9],568446438,5),N=f(N,x,y,E,b[14],3275163606,9),E=f(E,N,x,y,b[3],4107603335,14),y=f(y,E,N,x,b[8],1163531501,20),x=f(x,y,E,N,b[13],2850285829,5),N=f(N,x,y,E,b[2],4243563512,9),E=f(E,N,x,y,b[7],1735328473,14),x=h(x,y=f(y,E,N,x,b[12],2368359562,20),E,N,b[5],4294588738,4),N=h(N,x,y,E,b[8],2272392833,11),E=h(E,N,x,y,b[11],1839030562,16),y=h(y,E,N,x,b[14],4259657740,23),x=h(x,y,E,N,b[1],2763975236,4),N=h(N,x,y,E,b[4],1272893353,11),E=h(E,N,x,y,b[7],4139469664,16),y=h(y,E,N,x,b[10],3200236656,23),x=h(x,y,E,N,b[13],681279174,4),N=h(N,x,y,E,b[0],3936430074,11),E=h(E,N,x,y,b[3],3572445317,16),y=h(y,E,N,x,b[6],76029189,23),x=h(x,y,E,N,b[9],3654602809,4),N=h(N,x,y,E,b[12],3873151461,11),E=h(E,N,x,y,b[15],530742520,16),x=v(x,y=h(y,E,N,x,b[2],3299628645,23),E,N,b[0],4096336452,6),N=v(N,x,y,E,b[7],1126891415,10),E=v(E,N,x,y,b[14],2878612391,15),y=v(y,E,N,x,b[5],4237533241,21),x=v(x,y,E,N,b[12],1700485571,6),N=v(N,x,y,E,b[3],2399980690,10),E=v(E,N,x,y,b[10],4293915773,15),y=v(y,E,N,x,b[1],2240044497,21),x=v(x,y,E,N,b[8],1873313359,6),N=v(N,x,y,E,b[15],4264355552,10),E=v(E,N,x,y,b[6],2734768916,15),y=v(y,E,N,x,b[13],1309151649,21),x=v(x,y,E,N,b[4],4149444226,6),N=v(N,x,y,E,b[11],3174756917,10),E=v(E,N,x,y,b[2],718787259,15),y=v(y,E,N,x,b[9],3951481745,21),this._a=this._a+x|0,this._b=this._b+y|0,this._c=this._c+E|0,this._d=this._d+N|0},i.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var b=l.allocUnsafe(16);return b.writeInt32LE(this._a,0),b.writeInt32LE(this._b,4),b.writeInt32LE(this._c,8),b.writeInt32LE(this._d,12),b},a.exports=i},{"hash-base":425,inherits:440,"safe-buffer":494}],451:[function(e,a,n){var o=e("bn.js"),s=e("brorand");function l(c){this.rand=c||new s.Rand}a.exports=l,l.create=function(c){return new l(c)},l.prototype._randbelow=function(c){var i=c.bitLength(),u=Math.ceil(i/8);do var p=new o(this.rand.generate(u));while(p.cmp(c)>=0);return p},l.prototype._randrange=function(c,i){var u=i.sub(c);return c.add(this._randbelow(u))},l.prototype.test=function(c,i,u){var p=c.bitLength(),f=o.mont(c),h=new o(1).toRed(f);i||(i=Math.max(1,p/48|0));for(var v=c.subn(1),b=0;!v.testn(b);b++);for(var g=c.shrn(b),x=v.toRed(f);i>0;i--){var y=this._randrange(new o(2),v);u&&u(y);var E=y.toRed(f).redPow(g);if(E.cmp(h)!==0&&E.cmp(x)!==0){for(var N=1;N<b;N++){if((E=E.redSqr()).cmp(h)===0)return!1;if(E.cmp(x)===0)break}if(N===b)return!1}}return!0},l.prototype.getDivisor=function(c,i){var u=c.bitLength(),p=o.mont(c),f=new o(1).toRed(p);i||(i=Math.max(1,u/48|0));for(var h=c.subn(1),v=0;!h.testn(v);v++);for(var b=c.shrn(v),g=h.toRed(p);i>0;i--){var x=this._randrange(new o(2),h),y=c.gcd(x);if(y.cmpn(1)!==0)return y;var E=x.toRed(p).redPow(b);if(E.cmp(f)!==0&&E.cmp(g)!==0){for(var N=1;N<v;N++){if((E=E.redSqr()).cmp(f)===0)return E.fromRed().subn(1).gcd(c);if(E.cmp(g)===0)break}if(N===v)return(E=E.redSqr()).fromRed().subn(1).gcd(c)}}return!1}},{"bn.js":452,brorand:187}],452:[function(e,a,n){arguments[4][184][0].apply(n,arguments)},{buffer:188,dup:184}],453:[function(e,a,n){function o(s,l){if(!s)throw new Error(l||"Assertion failed")}a.exports=o,o.equal=function(s,l,c){if(s!=l)throw new Error(c||"Assertion failed: "+s+" != "+l)}},{}],454:[function(e,a,n){var o=n;function s(c){return c.length===1?"0"+c:c}function l(c){for(var i="",u=0;u<c.length;u++)i+=s(c[u].toString(16));return i}o.toArray=function(c,i){if(Array.isArray(c))return c.slice();if(!c)return[];var u=[];if(typeof c!="string"){for(var p=0;p<c.length;p++)u[p]=0|c[p];return u}if(i==="hex")for((c=c.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(c="0"+c),p=0;p<c.length;p+=2)u.push(parseInt(c[p]+c[p+1],16));else for(p=0;p<c.length;p++){var f=c.charCodeAt(p),h=f>>8,v=255&f;h?u.push(h,v):u.push(v)}return u},o.zero2=s,o.toHex=l,o.encode=function(c,i){return i==="hex"?l(c):c}},{}],455:[function(e,a,n){a.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],456:[function(e,a,n){var o=e("asn1.js");n.certificate=e("./certificate");var s=o.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});n.RSAPrivateKey=s;var l=o.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});n.RSAPublicKey=l;var c=o.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(i),this.key("subjectPublicKey").bitstr())});n.PublicKey=c;var i=o.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),u=o.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(i),this.key("subjectPrivateKey").octstr())});n.PrivateKey=u;var p=o.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});n.EncryptedPrivateKey=p;var f=o.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});n.DSAPrivateKey=f,n.DSAparam=o.define("DSAparam",function(){this.int()});var h=o.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(v),this.key("publicKey").optional().explicit(1).bitstr())});n.ECPrivateKey=h;var v=o.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});n.signature=o.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},{"./certificate":457,"asn1.js":170}],457:[function(e,a,n){var o=e("asn1.js"),s=o.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),l=o.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),c=o.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),i=o.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(c),this.key("subjectPublicKey").bitstr())}),u=o.define("RelativeDistinguishedName",function(){this.setof(l)}),p=o.define("RDNSequence",function(){this.seqof(u)}),f=o.define("Name",function(){this.choice({rdnSequence:this.use(p)})}),h=o.define("Validity",function(){this.seq().obj(this.key("notBefore").use(s),this.key("notAfter").use(s))}),v=o.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),b=o.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(c),this.key("issuer").use(f),this.key("validity").use(h),this.key("subject").use(f),this.key("subjectPublicKeyInfo").use(i),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(v).optional())}),g=o.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(b),this.key("signatureAlgorithm").use(c),this.key("signatureValue").bitstr())});a.exports=g},{"asn1.js":170}],458:[function(e,a,n){var o=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,s=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,l=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,c=e("evp_bytestokey"),i=e("browserify-aes"),u=e("safe-buffer").Buffer;a.exports=function(p,f){var h,v=p.toString(),b=v.match(o);if(b){var g="aes"+b[1],x=u.from(b[2],"hex"),y=u.from(b[3].replace(/[\r\n]/g,""),"base64"),E=c(f,x.slice(0,8),parseInt(b[1],10)).key,N=[],I=i.createDecipheriv(g,E,x);N.push(I.update(y)),N.push(I.final()),h=u.concat(N)}else{var P=v.match(l);h=u.from(P[2].replace(/[\r\n]/g,""),"base64")}return{tag:v.match(s)[1],data:h}}},{"browserify-aes":191,evp_bytestokey:423,"safe-buffer":494}],459:[function(e,a,n){var o=e("./asn1"),s=e("./aesid.json"),l=e("./fixProc"),c=e("browserify-aes"),i=e("pbkdf2"),u=e("safe-buffer").Buffer;function p(f){var h;typeof f!="object"||u.isBuffer(f)||(h=f.passphrase,f=f.key),typeof f=="string"&&(f=u.from(f));var v,b,g=l(f,h),x=g.tag,y=g.data;switch(x){case"CERTIFICATE":b=o.certificate.decode(y,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(b||(b=o.PublicKey.decode(y,"der")),v=b.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return o.RSAPublicKey.decode(b.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return b.subjectPrivateKey=b.subjectPublicKey,{type:"ec",data:b};case"1.2.840.10040.4.1":return b.algorithm.params.pub_key=o.DSAparam.decode(b.subjectPublicKey.data,"der"),{type:"dsa",data:b.algorithm.params};default:throw new Error("unknown key id "+v)}case"ENCRYPTED PRIVATE KEY":y=function(E,N){var I=E.algorithm.decrypt.kde.kdeparams.salt,P=parseInt(E.algorithm.decrypt.kde.kdeparams.iters.toString(),10),V=s[E.algorithm.decrypt.cipher.algo.join(".")],U=E.algorithm.decrypt.cipher.iv,H=E.subjectPrivateKey,G=parseInt(V.split("-")[1],10)/8,Z=i.pbkdf2Sync(N,I,P,G,"sha1"),W=c.createDecipheriv(V,Z,U),O=[];return O.push(W.update(H)),O.push(W.final()),u.concat(O)}(y=o.EncryptedPrivateKey.decode(y,"der"),h);case"PRIVATE KEY":switch(v=(b=o.PrivateKey.decode(y,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return o.RSAPrivateKey.decode(b.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:b.algorithm.curve,privateKey:o.ECPrivateKey.decode(b.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return b.algorithm.params.priv_key=o.DSAparam.decode(b.subjectPrivateKey,"der"),{type:"dsa",params:b.algorithm.params};default:throw new Error("unknown key id "+v)}case"RSA PUBLIC KEY":return o.RSAPublicKey.decode(y,"der");case"RSA PRIVATE KEY":return o.RSAPrivateKey.decode(y,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:o.DSAPrivateKey.decode(y,"der")};case"EC PRIVATE KEY":return{curve:(y=o.ECPrivateKey.decode(y,"der")).parameters.value,privateKey:y.privateKey};default:throw new Error("unknown key type "+x)}}a.exports=p,p.signature=o.signature},{"./aesid.json":455,"./asn1":456,"./fixProc":458,"browserify-aes":191,pbkdf2:460,"safe-buffer":494}],460:[function(e,a,n){n.pbkdf2=e("./lib/async"),n.pbkdf2Sync=e("./lib/sync")},{"./lib/async":461,"./lib/sync":464}],461:[function(e,a,n){(function(o){(function(){var s,l,c=e("safe-buffer").Buffer,i=e("./precondition"),u=e("./default-encoding"),p=e("./sync"),f=e("./to-buffer"),h=o.crypto&&o.crypto.subtle,v={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},b=[];function g(){return l||(l=o.process&&o.process.nextTick?o.process.nextTick:o.queueMicrotask?o.queueMicrotask:o.setImmediate?o.setImmediate:o.setTimeout)}function x(y,E,N,I,P){return h.importKey("raw",y,{name:"PBKDF2"},!1,["deriveBits"]).then(function(V){return h.deriveBits({name:"PBKDF2",salt:E,iterations:N,hash:{name:P}},V,I<<3)}).then(function(V){return c.from(V)})}a.exports=function(y,E,N,I,P,V){typeof P=="function"&&(V=P,P=void 0);var U=v[(P=P||"sha1").toLowerCase()];if(U&&typeof o.Promise=="function"){if(i(N,I),y=f(y,u,"Password"),E=f(E,u,"Salt"),typeof V!="function")throw new Error("No callback provided to pbkdf2");(function(H,G){H.then(function(Z){g()(function(){G(null,Z)})},function(Z){g()(function(){G(Z)})})})(function(H){if(o.process&&!o.process.browser||!h||!h.importKey||!h.deriveBits)return Promise.resolve(!1);if(b[H]!==void 0)return b[H];var G=x(s=s||c.alloc(8),s,10,128,H).then(function(){return!0}).catch(function(){return!1});return b[H]=G,G}(U).then(function(H){return H?x(y,E,N,I,U):p(y,E,N,I,P)}),V)}else g()(function(){var H;try{H=p(y,E,N,I,P)}catch(G){return V(G)}V(null,H)})}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"./default-encoding":462,"./precondition":463,"./sync":464,"./to-buffer":465,"safe-buffer":494}],462:[function(e,a,n){(function(o,s){(function(){var l;s.process&&s.process.browser?l="utf-8":s.process&&s.process.version?l=parseInt(o.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":l="utf-8",a.exports=l}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467}],463:[function(e,a,n){var o=Math.pow(2,30)-1;a.exports=function(s,l){if(typeof s!="number")throw new TypeError("Iterations not a number");if(s<0)throw new TypeError("Bad iterations");if(typeof l!="number")throw new TypeError("Key length not a number");if(l<0||l>o||l!=l)throw new TypeError("Bad key length")}},{}],464:[function(e,a,n){var o=e("create-hash/md5"),s=e("ripemd160"),l=e("sha.js"),c=e("safe-buffer").Buffer,i=e("./precondition"),u=e("./default-encoding"),p=e("./to-buffer"),f=c.alloc(128),h={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function v(b,g,x){var y=function(U){function H(G){return l(U).update(G).digest()}return U==="rmd160"||U==="ripemd160"?function(G){return new s().update(G).digest()}:U==="md5"?o:H}(b),E=b==="sha512"||b==="sha384"?128:64;g.length>E?g=y(g):g.length<E&&(g=c.concat([g,f],E));for(var N=c.allocUnsafe(E+h[b]),I=c.allocUnsafe(E+h[b]),P=0;P<E;P++)N[P]=54^g[P],I[P]=92^g[P];var V=c.allocUnsafe(E+x+4);N.copy(V,0,0,E),this.ipad1=V,this.ipad2=N,this.opad=I,this.alg=b,this.blocksize=E,this.hash=y,this.size=h[b]}v.prototype.run=function(b,g){return b.copy(g,this.blocksize),this.hash(g).copy(this.opad,this.blocksize),this.hash(this.opad)},a.exports=function(b,g,x,y,E){i(x,y);var N=new v(E=E||"sha1",b=p(b,u,"Password"),(g=p(g,u,"Salt")).length),I=c.allocUnsafe(y),P=c.allocUnsafe(g.length+4);g.copy(P,0,0,g.length);for(var V=0,U=h[E],H=Math.ceil(y/U),G=1;G<=H;G++){P.writeUInt32BE(G,g.length);for(var Z=N.run(P,N.ipad1),W=Z,O=1;O<x;O++){W=N.run(W,N.ipad2);for(var R=0;R<U;R++)Z[R]^=W[R]}Z.copy(I,V),V+=U}return I}},{"./default-encoding":462,"./precondition":463,"./to-buffer":465,"create-hash/md5":387,ripemd160:493,"safe-buffer":494,"sha.js":498}],465:[function(e,a,n){var o=e("safe-buffer").Buffer;a.exports=function(s,l,c){if(o.isBuffer(s))return s;if(typeof s=="string")return o.from(s,l);if(ArrayBuffer.isView(s))return o.from(s.buffer);throw new TypeError(c+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":494}],466:[function(e,a,n){(function(o){(function(){o===void 0||!o.version||o.version.indexOf("v0.")===0||o.version.indexOf("v1.")===0&&o.version.indexOf("v1.8.")!==0?a.exports={nextTick:function(s,l,c,i){if(typeof s!="function")throw new TypeError('"callback" argument must be a function');var u,p,f=arguments.length;switch(f){case 0:case 1:return o.nextTick(s);case 2:return o.nextTick(function(){s.call(null,l)});case 3:return o.nextTick(function(){s.call(null,l,c)});case 4:return o.nextTick(function(){s.call(null,l,c,i)});default:for(u=new Array(f-1),p=0;p<u.length;)u[p++]=arguments[p];return o.nextTick(function(){s.apply(null,u)})}}}:a.exports=o}).call(this)}).call(this,e("_process"))},{_process:467}],467:[function(e,a,n){var o,s,l=a.exports={};function c(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function u(E){if(o===setTimeout)return setTimeout(E,0);if((o===c||!o)&&setTimeout)return o=setTimeout,setTimeout(E,0);try{return o(E,0)}catch{try{return o.call(null,E,0)}catch{return o.call(this,E,0)}}}(function(){try{o=typeof setTimeout=="function"?setTimeout:c}catch{o=c}try{s=typeof clearTimeout=="function"?clearTimeout:i}catch{s=i}})();var p,f=[],h=!1,v=-1;function b(){h&&p&&(h=!1,p.length?f=p.concat(f):v=-1,f.length&&g())}function g(){if(!h){var E=u(b);h=!0;for(var N=f.length;N;){for(p=f,f=[];++v<N;)p&&p[v].run();v=-1,N=f.length}p=null,h=!1,function(I){if(s===clearTimeout)return clearTimeout(I);if((s===i||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(I);try{s(I)}catch{try{return s.call(null,I)}catch{return s.call(this,I)}}}(E)}}function x(E,N){this.fun=E,this.array=N}function y(){}l.nextTick=function(E){var N=new Array(arguments.length-1);if(arguments.length>1)for(var I=1;I<arguments.length;I++)N[I-1]=arguments[I];f.push(new x(E,N)),f.length!==1||h||u(g)},x.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=y,l.addListener=y,l.once=y,l.off=y,l.removeListener=y,l.removeAllListeners=y,l.emit=y,l.prependListener=y,l.prependOnceListener=y,l.listeners=function(E){return[]},l.binding=function(E){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(E){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],468:[function(e,a,n){n.publicEncrypt=e("./publicEncrypt"),n.privateDecrypt=e("./privateDecrypt"),n.privateEncrypt=function(o,s){return n.publicEncrypt(o,s,!0)},n.publicDecrypt=function(o,s){return n.privateDecrypt(o,s,!0)}},{"./privateDecrypt":471,"./publicEncrypt":472}],469:[function(e,a,n){var o=e("create-hash"),s=e("safe-buffer").Buffer;function l(c){var i=s.allocUnsafe(4);return i.writeUInt32BE(c,0),i}a.exports=function(c,i){for(var u,p=s.alloc(0),f=0;p.length<i;)u=l(f++),p=s.concat([p,o("sha1").update(c).update(u).digest()]);return p.slice(0,i)}},{"create-hash":386,"safe-buffer":494}],470:[function(e,a,n){arguments[4][184][0].apply(n,arguments)},{buffer:188,dup:184}],471:[function(e,a,n){var o=e("parse-asn1"),s=e("./mgf"),l=e("./xor"),c=e("bn.js"),i=e("browserify-rsa"),u=e("create-hash"),p=e("./withPublic"),f=e("safe-buffer").Buffer;a.exports=function(h,v,b){var g;g=h.padding?h.padding:b?1:4;var x,y=o(h),E=y.modulus.byteLength();if(v.length>E||new c(v).cmp(y.modulus)>=0)throw new Error("decryption error");x=b?p(new c(v),y):i(v,y);var N=f.alloc(E-x.length);if(x=f.concat([N,x],E),g===4)return function(I,P){var V=I.modulus.byteLength(),U=u("sha1").update(f.alloc(0)).digest(),H=U.length;if(P[0]!==0)throw new Error("decryption error");var G=P.slice(1,H+1),Z=P.slice(H+1),W=l(G,s(Z,H)),O=l(Z,s(W,V-H-1));if(function(C,_){C=f.from(C),_=f.from(_);var k=0,A=C.length;C.length!==_.length&&(k++,A=Math.min(C.length,_.length));for(var T=-1;++T<A;)k+=C[T]^_[T];return k}(U,O.slice(0,H)))throw new Error("decryption error");for(var R=H;O[R]===0;)R++;if(O[R++]!==1)throw new Error("decryption error");return O.slice(R)}(y,x);if(g===1)return function(I,P,V){for(var U=P.slice(0,2),H=2,G=0;P[H++]!==0;)if(H>=P.length){G++;break}var Z=P.slice(2,H-1);if((U.toString("hex")!=="0002"&&!V||U.toString("hex")!=="0001"&&V)&&G++,Z.length<8&&G++,G)throw new Error("decryption error");return P.slice(H)}(0,x,b);if(g===3)return x;throw new Error("unknown padding")}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,"safe-buffer":494}],472:[function(e,a,n){var o=e("parse-asn1"),s=e("randombytes"),l=e("create-hash"),c=e("./mgf"),i=e("./xor"),u=e("bn.js"),p=e("./withPublic"),f=e("browserify-rsa"),h=e("safe-buffer").Buffer;a.exports=function(v,b,g){var x;x=v.padding?v.padding:g?1:4;var y,E=o(v);if(x===4)y=function(N,I){var P=N.modulus.byteLength(),V=I.length,U=l("sha1").update(h.alloc(0)).digest(),H=U.length,G=2*H;if(V>P-G-2)throw new Error("message too long");var Z=h.alloc(P-V-G-2),W=P-H-1,O=s(H),R=i(h.concat([U,Z,h.alloc(1,1),I],W),c(O,W)),C=i(O,c(R,H));return new u(h.concat([h.alloc(1),C,R],P))}(E,b);else if(x===1)y=function(N,I,P){var V,U=I.length,H=N.modulus.byteLength();if(U>H-11)throw new Error("message too long");return V=P?h.alloc(H-U-3,255):function(G){for(var Z,W=h.allocUnsafe(G),O=0,R=s(2*G),C=0;O<G;)C===R.length&&(R=s(2*G),C=0),(Z=R[C++])&&(W[O++]=Z);return W}(H-U-3),new u(h.concat([h.from([0,P?1:2]),V,h.alloc(1),I],H))}(E,b,g);else{if(x!==3)throw new Error("unknown padding");if((y=new u(b)).cmp(E.modulus)>=0)throw new Error("data too long for modulus")}return g?f(y,E):p(y,E)}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,randombytes:475,"safe-buffer":494}],473:[function(e,a,n){var o=e("bn.js"),s=e("safe-buffer").Buffer;a.exports=function(l,c){return s.from(l.toRed(o.mont(c.modulus)).redPow(new o(c.publicExponent)).fromRed().toArray())}},{"bn.js":470,"safe-buffer":494}],474:[function(e,a,n){a.exports=function(o,s){for(var l=o.length,c=-1;++c<l;)o[c]^=s[c];return o}},{}],475:[function(e,a,n){(function(o,s){(function(){var l=e("safe-buffer").Buffer,c=s.crypto||s.msCrypto;c&&c.getRandomValues?a.exports=function(i,u){if(i>4294967295)throw new RangeError("requested too many random bytes");var p=l.allocUnsafe(i);if(i>0)if(i>65536)for(var f=0;f<i;f+=65536)c.getRandomValues(p.slice(f,f+65536));else c.getRandomValues(p);return typeof u=="function"?o.nextTick(function(){u(null,p)}):p}:a.exports=function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,"safe-buffer":494}],476:[function(e,a,n){(function(o,s){(function(){function l(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var c=e("safe-buffer"),i=e("randombytes"),u=c.Buffer,p=c.kMaxLength,f=s.crypto||s.msCrypto,h=Math.pow(2,32)-1;function v(x,y){if(typeof x!="number"||x!=x)throw new TypeError("offset must be a number");if(x>h||x<0)throw new TypeError("offset must be a uint32");if(x>p||x>y)throw new RangeError("offset out of range")}function b(x,y,E){if(typeof x!="number"||x!=x)throw new TypeError("size must be a number");if(x>h||x<0)throw new TypeError("size must be a uint32");if(x+y>E||x>p)throw new RangeError("buffer too small")}function g(x,y,E,N){if(o.browser){var I=x.buffer,P=new Uint8Array(I,y,E);return f.getRandomValues(P),N?void o.nextTick(function(){N(null,x)}):x}if(!N)return i(E).copy(x,y),x;i(E,function(V,U){if(V)return N(V);U.copy(x,y),N(null,x)})}f&&f.getRandomValues||!o.browser?(n.randomFill=function(x,y,E,N){if(!(u.isBuffer(x)||x instanceof s.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof y=="function")N=y,y=0,E=x.length;else if(typeof E=="function")N=E,E=x.length-y;else if(typeof N!="function")throw new TypeError('"cb" argument must be a function');return v(y,x.length),b(E,y,x.length),g(x,y,E,N)},n.randomFillSync=function(x,y,E){if(y===void 0&&(y=0),!(u.isBuffer(x)||x instanceof s.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return v(y,x.length),E===void 0&&(E=x.length-y),b(E,y,x.length),g(x,y,E)}):(n.randomFill=l,n.randomFillSync=l)}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,randombytes:475,"safe-buffer":494}],477:[function(e,a,n){var o={};function s(c,i,u){u||(u=Error);var p=function(f){var h,v;function b(g,x,y){return f.call(this,function(E,N,I){return typeof i=="string"?i:i(E,N,I)}(g,x,y))||this}return v=f,(h=b).prototype=Object.create(v.prototype),h.prototype.constructor=h,h.__proto__=v,b}(u);p.prototype.name=u.name,p.prototype.code=c,o[c]=p}function l(c,i){if(Array.isArray(c)){var u=c.length;return c=c.map(function(p){return String(p)}),u>2?"one of ".concat(i," ").concat(c.slice(0,u-1).join(", "),", or ")+c[u-1]:u===2?"one of ".concat(i," ").concat(c[0]," or ").concat(c[1]):"of ".concat(i," ").concat(c[0])}return"of ".concat(i," ").concat(String(c))}s("ERR_INVALID_OPT_VALUE",function(c,i){return'The value "'+i+'" is invalid for option "'+c+'"'},TypeError),s("ERR_INVALID_ARG_TYPE",function(c,i,u){var p,f,h;if(typeof i=="string"&&(f="not ",i.substr(0,f.length)===f)?(p="must not be",i=i.replace(/^not /,"")):p="must be",function(b,g,x){return(x===void 0||x>b.length)&&(x=b.length),b.substring(x-g.length,x)===g}(c," argument"))h="The ".concat(c," ").concat(p," ").concat(l(i,"type"));else{var v=function(b,g,x){return typeof x!="number"&&(x=0),!(x+g.length>b.length)&&b.indexOf(g,x)!==-1}(c,".")?"property":"argument";h='The "'.concat(c,'" ').concat(v," ").concat(p," ").concat(l(i,"type"))}return h+=". Received type ".concat(typeof u)},TypeError),s("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),s("ERR_METHOD_NOT_IMPLEMENTED",function(c){return"The "+c+" method is not implemented"}),s("ERR_STREAM_PREMATURE_CLOSE","Premature close"),s("ERR_STREAM_DESTROYED",function(c){return"Cannot call "+c+" after a stream was destroyed"}),s("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),s("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),s("ERR_STREAM_WRITE_AFTER_END","write after end"),s("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),s("ERR_UNKNOWN_ENCODING",function(c){return"Unknown encoding: "+c},TypeError),s("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),a.exports.codes=o},{}],478:[function(e,a,n){(function(o){(function(){var s=Object.keys||function(b){var g=[];for(var x in b)g.push(x);return g};a.exports=f;var l=e("./_stream_readable"),c=e("./_stream_writable");e("inherits")(f,l);for(var i=s(c.prototype),u=0;u<i.length;u++){var p=i[u];f.prototype[p]||(f.prototype[p]=c.prototype[p])}function f(b){if(!(this instanceof f))return new f(b);l.call(this,b),c.call(this,b),this.allowHalfOpen=!0,b&&(b.readable===!1&&(this.readable=!1),b.writable===!1&&(this.writable=!1),b.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||o.nextTick(v,this)}function v(b){b.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(f.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(f.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(b){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=b,this._writableState.destroyed=b)}})}).call(this)}).call(this,e("_process"))},{"./_stream_readable":480,"./_stream_writable":482,_process:467,inherits:440}],479:[function(e,a,n){a.exports=s;var o=e("./_stream_transform");function s(l){if(!(this instanceof s))return new s(l);o.call(this,l)}e("inherits")(s,o),s.prototype._transform=function(l,c,i){i(null,l)}},{"./_stream_transform":481,inherits:440}],480:[function(e,a,n){(function(o,s){(function(){var l;a.exports=W,W.ReadableState=Z,e("events").EventEmitter;var c=function(L,M){return L.listeners(M).length},i=e("./internal/streams/stream"),u=e("buffer").Buffer,p=(s!==void 0?s:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},f,h=e("util");f=h&&h.debuglog?h.debuglog("stream"):function(){};var v,b,g,x=e("./internal/streams/buffer_list"),y=e("./internal/streams/destroy"),E=e("./internal/streams/state").getHighWaterMark,N=e("../errors").codes,I=N.ERR_INVALID_ARG_TYPE,P=N.ERR_STREAM_PUSH_AFTER_EOF,V=N.ERR_METHOD_NOT_IMPLEMENTED,U=N.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(W,i);var H=y.errorOrDestroy,G=["error","close","destroy","pause","resume"];function Z(L,M,K){l=l||e("./_stream_duplex"),L=L||{},typeof K!="boolean"&&(K=M instanceof l),this.objectMode=!!L.objectMode,K&&(this.objectMode=this.objectMode||!!L.readableObjectMode),this.highWaterMark=E(this,L,"readableHighWaterMark",K),this.buffer=new x,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=L.emitClose!==!1,this.autoDestroy=!!L.autoDestroy,this.destroyed=!1,this.defaultEncoding=L.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,L.encoding&&(v||(v=e("string_decoder/").StringDecoder),this.decoder=new v(L.encoding),this.encoding=L.encoding)}function W(L){if(l=l||e("./_stream_duplex"),!(this instanceof W))return new W(L);var M=this instanceof l;this._readableState=new Z(L,this,M),this.readable=!0,L&&(typeof L.read=="function"&&(this._read=L.read),typeof L.destroy=="function"&&(this._destroy=L.destroy)),i.call(this)}function O(L,M,K,se,te){f("readableAddChunk",M);var ae,Q=L._readableState;if(M===null)Q.reading=!1,function(fe,le){if(f("onEofChunk"),!le.ended){if(le.decoder){var ne=le.decoder.end();ne&&ne.length&&(le.buffer.push(ne),le.length+=le.objectMode?1:ne.length)}le.ended=!0,le.sync?_(fe):(le.needReadable=!1,le.emittedReadable||(le.emittedReadable=!0,k(fe)))}}(L,Q);else if(te||(ae=function(fe,le){var ne;ue=le,u.isBuffer(ue)||ue instanceof p||typeof le=="string"||le===void 0||fe.objectMode||(ne=new I("chunk",["string","Buffer","Uint8Array"],le));var ue;return ne}(Q,M)),ae)H(L,ae);else if(Q.objectMode||M&&M.length>0)if(typeof M=="string"||Q.objectMode||Object.getPrototypeOf(M)===u.prototype||(M=function(fe){return u.from(fe)}(M)),se)Q.endEmitted?H(L,new U):R(L,Q,M,!0);else if(Q.ended)H(L,new P);else{if(Q.destroyed)return!1;Q.reading=!1,Q.decoder&&!K?(M=Q.decoder.write(M),Q.objectMode||M.length!==0?R(L,Q,M,!1):A(L,Q)):R(L,Q,M,!1)}else se||(Q.reading=!1,A(L,Q));return!Q.ended&&(Q.length<Q.highWaterMark||Q.length===0)}function R(L,M,K,se){M.flowing&&M.length===0&&!M.sync?(M.awaitDrain=0,L.emit("data",K)):(M.length+=M.objectMode?1:K.length,se?M.buffer.unshift(K):M.buffer.push(K),M.needReadable&&_(L)),A(L,M)}Object.defineProperty(W.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(L){this._readableState&&(this._readableState.destroyed=L)}}),W.prototype.destroy=y.destroy,W.prototype._undestroy=y.undestroy,W.prototype._destroy=function(L,M){M(L)},W.prototype.push=function(L,M){var K,se=this._readableState;return se.objectMode?K=!0:typeof L=="string"&&((M=M||se.defaultEncoding)!==se.encoding&&(L=u.from(L,M),M=""),K=!0),O(this,L,M,!1,K)},W.prototype.unshift=function(L){return O(this,L,null,!0,!1)},W.prototype.isPaused=function(){return this._readableState.flowing===!1},W.prototype.setEncoding=function(L){v||(v=e("string_decoder/").StringDecoder);var M=new v(L);this._readableState.decoder=M,this._readableState.encoding=this._readableState.decoder.encoding;for(var K=this._readableState.buffer.head,se="";K!==null;)se+=M.write(K.data),K=K.next;return this._readableState.buffer.clear(),se!==""&&this._readableState.buffer.push(se),this._readableState.length=se.length,this};function C(L,M){return L<=0||M.length===0&&M.ended?0:M.objectMode?1:L!=L?M.flowing&&M.length?M.buffer.head.data.length:M.length:(L>M.highWaterMark&&(M.highWaterMark=function(K){return K>=1073741824?K=1073741824:(K--,K|=K>>>1,K|=K>>>2,K|=K>>>4,K|=K>>>8,K|=K>>>16,K++),K}(L)),L<=M.length?L:M.ended?M.length:(M.needReadable=!0,0))}function _(L){var M=L._readableState;f("emitReadable",M.needReadable,M.emittedReadable),M.needReadable=!1,M.emittedReadable||(f("emitReadable",M.flowing),M.emittedReadable=!0,o.nextTick(k,L))}function k(L){var M=L._readableState;f("emitReadable_",M.destroyed,M.length,M.ended),M.destroyed||!M.length&&!M.ended||(L.emit("readable"),M.emittedReadable=!1),M.needReadable=!M.flowing&&!M.ended&&M.length<=M.highWaterMark,Y(L)}function A(L,M){M.readingMore||(M.readingMore=!0,o.nextTick(T,L,M))}function T(L,M){for(;!M.reading&&!M.ended&&(M.length<M.highWaterMark||M.flowing&&M.length===0);){var K=M.length;if(f("maybeReadMore read 0"),L.read(0),K===M.length)break}M.readingMore=!1}function D(L){var M=L._readableState;M.readableListening=L.listenerCount("readable")>0,M.resumeScheduled&&!M.paused?M.flowing=!0:L.listenerCount("data")>0&&L.resume()}function B(L){f("readable nexttick read 0"),L.read(0)}function F(L,M){f("resume",M.reading),M.reading||L.read(0),M.resumeScheduled=!1,L.emit("resume"),Y(L),M.flowing&&!M.reading&&L.read(0)}function Y(L){var M=L._readableState;for(f("flow",M.flowing);M.flowing&&L.read()!==null;);}function X(L,M){return M.length===0?null:(M.objectMode?K=M.buffer.shift():!L||L>=M.length?(K=M.decoder?M.buffer.join(""):M.buffer.length===1?M.buffer.first():M.buffer.concat(M.length),M.buffer.clear()):K=M.buffer.consume(L,M.decoder),K);var K}function re(L){var M=L._readableState;f("endReadable",M.endEmitted),M.endEmitted||(M.ended=!0,o.nextTick(z,M,L))}function z(L,M){if(f("endReadableNT",L.endEmitted,L.length),!L.endEmitted&&L.length===0&&(L.endEmitted=!0,M.readable=!1,M.emit("end"),L.autoDestroy)){var K=M._writableState;(!K||K.autoDestroy&&K.finished)&&M.destroy()}}function ee(L,M){for(var K=0,se=L.length;K<se;K++)if(L[K]===M)return K;return-1}W.prototype.read=function(L){f("read",L),L=parseInt(L,10);var M=this._readableState,K=L;if(L!==0&&(M.emittedReadable=!1),L===0&&M.needReadable&&((M.highWaterMark!==0?M.length>=M.highWaterMark:M.length>0)||M.ended))return f("read: emitReadable",M.length,M.ended),M.length===0&&M.ended?re(this):_(this),null;if((L=C(L,M))===0&&M.ended)return M.length===0&&re(this),null;var se,te=M.needReadable;return f("need readable",te),(M.length===0||M.length-L<M.highWaterMark)&&f("length less than watermark",te=!0),M.ended||M.reading?f("reading or ended",te=!1):te&&(f("do read"),M.reading=!0,M.sync=!0,M.length===0&&(M.needReadable=!0),this._read(M.highWaterMark),M.sync=!1,M.reading||(L=C(K,M))),(se=L>0?X(L,M):null)===null?(M.needReadable=M.length<=M.highWaterMark,L=0):(M.length-=L,M.awaitDrain=0),M.length===0&&(M.ended||(M.needReadable=!0),K!==L&&M.ended&&re(this)),se!==null&&this.emit("data",se),se},W.prototype._read=function(L){H(this,new V("_read()"))},W.prototype.pipe=function(L,M){var K=this,se=this._readableState;switch(se.pipesCount){case 0:se.pipes=L;break;case 1:se.pipes=[se.pipes,L];break;default:se.pipes.push(L)}se.pipesCount+=1,f("pipe count=%d opts=%j",se.pipesCount,M);var te=(!M||M.end!==!1)&&L!==o.stdout&&L!==o.stderr?Q:pe;function ae(Ce,Me){f("onunpipe"),Ce===K&&Me&&Me.hasUnpiped===!1&&(Me.hasUnpiped=!0,f("cleanup"),L.removeListener("close",he),L.removeListener("finish",ke),L.removeListener("drain",fe),L.removeListener("error",ue),L.removeListener("unpipe",ae),K.removeListener("end",Q),K.removeListener("end",pe),K.removeListener("data",ne),le=!0,!se.awaitDrain||L._writableState&&!L._writableState.needDrain||fe())}function Q(){f("onend"),L.end()}se.endEmitted?o.nextTick(te):K.once("end",te),L.on("unpipe",ae);var fe=function(Ce){return function(){var Me=Ce._readableState;f("pipeOnDrain",Me.awaitDrain),Me.awaitDrain&&Me.awaitDrain--,Me.awaitDrain===0&&c(Ce,"data")&&(Me.flowing=!0,Y(Ce))}}(K);L.on("drain",fe);var le=!1;function ne(Ce){f("ondata");var Me=L.write(Ce);f("dest.write",Me),Me===!1&&((se.pipesCount===1&&se.pipes===L||se.pipesCount>1&&ee(se.pipes,L)!==-1)&&!le&&(f("false write response, pause",se.awaitDrain),se.awaitDrain++),K.pause())}function ue(Ce){f("onerror",Ce),pe(),L.removeListener("error",ue),c(L,"error")===0&&H(L,Ce)}function he(){L.removeListener("finish",ke),pe()}function ke(){f("onfinish"),L.removeListener("close",he),pe()}function pe(){f("unpipe"),K.unpipe(L)}return K.on("data",ne),function(Ce,Me,Ie){if(typeof Ce.prependListener=="function")return Ce.prependListener(Me,Ie);Ce._events&&Ce._events[Me]?Array.isArray(Ce._events[Me])?Ce._events[Me].unshift(Ie):Ce._events[Me]=[Ie,Ce._events[Me]]:Ce.on(Me,Ie)}(L,"error",ue),L.once("close",he),L.once("finish",ke),L.emit("pipe",K),se.flowing||(f("pipe resume"),K.resume()),L},W.prototype.unpipe=function(L){var M=this._readableState,K={hasUnpiped:!1};if(M.pipesCount===0)return this;if(M.pipesCount===1)return L&&L!==M.pipes||(L||(L=M.pipes),M.pipes=null,M.pipesCount=0,M.flowing=!1,L&&L.emit("unpipe",this,K)),this;if(!L){var se=M.pipes,te=M.pipesCount;M.pipes=null,M.pipesCount=0,M.flowing=!1;for(var ae=0;ae<te;ae++)se[ae].emit("unpipe",this,{hasUnpiped:!1});return this}var Q=ee(M.pipes,L);return Q===-1||(M.pipes.splice(Q,1),M.pipesCount-=1,M.pipesCount===1&&(M.pipes=M.pipes[0]),L.emit("unpipe",this,K)),this},W.prototype.on=function(L,M){var K=i.prototype.on.call(this,L,M),se=this._readableState;return L==="data"?(se.readableListening=this.listenerCount("readable")>0,se.flowing!==!1&&this.resume()):L==="readable"&&(se.endEmitted||se.readableListening||(se.readableListening=se.needReadable=!0,se.flowing=!1,se.emittedReadable=!1,f("on readable",se.length,se.reading),se.length?_(this):se.reading||o.nextTick(B,this))),K},W.prototype.addListener=W.prototype.on,W.prototype.removeListener=function(L,M){var K=i.prototype.removeListener.call(this,L,M);return L==="readable"&&o.nextTick(D,this),K},W.prototype.removeAllListeners=function(L){var M=i.prototype.removeAllListeners.apply(this,arguments);return L!=="readable"&&L!==void 0||o.nextTick(D,this),M},W.prototype.resume=function(){var L=this._readableState;return L.flowing||(f("resume"),L.flowing=!L.readableListening,function(M,K){K.resumeScheduled||(K.resumeScheduled=!0,o.nextTick(F,M,K))}(this,L)),L.paused=!1,this},W.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},W.prototype.wrap=function(L){var M=this,K=this._readableState,se=!1;for(var te in L.on("end",function(){if(f("wrapped end"),K.decoder&&!K.ended){var Q=K.decoder.end();Q&&Q.length&&M.push(Q)}M.push(null)}),L.on("data",function(Q){f("wrapped data"),K.decoder&&(Q=K.decoder.write(Q)),K.objectMode&&Q==null||(K.objectMode||Q&&Q.length)&&(M.push(Q)||(se=!0,L.pause()))}),L)this[te]===void 0&&typeof L[te]=="function"&&(this[te]=function(Q){return function(){return L[Q].apply(L,arguments)}}(te));for(var ae=0;ae<G.length;ae++)L.on(G[ae],this.emit.bind(this,G[ae]));return this._read=function(Q){f("wrapped _read",Q),se&&(se=!1,L.resume())},this},typeof Symbol=="function"&&(W.prototype[Symbol.asyncIterator]=function(){return b===void 0&&(b=e("./internal/streams/async_iterator")),b(this)}),Object.defineProperty(W.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(W.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(W.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(L){this._readableState&&(this._readableState.flowing=L)}}),W._fromList=X,Object.defineProperty(W.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(W.from=function(L,M){return g===void 0&&(g=e("./internal/streams/from")),g(W,L,M)})}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/async_iterator":483,"./internal/streams/buffer_list":484,"./internal/streams/destroy":485,"./internal/streams/from":487,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,events:422,inherits:440,"string_decoder/":522,util:188}],481:[function(e,a,n){a.exports=f;var o=e("../errors").codes,s=o.ERR_METHOD_NOT_IMPLEMENTED,l=o.ERR_MULTIPLE_CALLBACK,c=o.ERR_TRANSFORM_ALREADY_TRANSFORMING,i=o.ERR_TRANSFORM_WITH_LENGTH_0,u=e("./_stream_duplex");function p(b,g){var x=this._transformState;x.transforming=!1;var y=x.writecb;if(y===null)return this.emit("error",new l);x.writechunk=null,x.writecb=null,g!=null&&this.push(g),y(b);var E=this._readableState;E.reading=!1,(E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}function f(b){if(!(this instanceof f))return new f(b);u.call(this,b),this._transformState={afterTransform:p.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,b&&(typeof b.transform=="function"&&(this._transform=b.transform),typeof b.flush=="function"&&(this._flush=b.flush)),this.on("prefinish",h)}function h(){var b=this;typeof this._flush!="function"||this._readableState.destroyed?v(this,null,null):this._flush(function(g,x){v(b,g,x)})}function v(b,g,x){if(g)return b.emit("error",g);if(x!=null&&b.push(x),b._writableState.length)throw new i;if(b._transformState.transforming)throw new c;return b.push(null)}e("inherits")(f,u),f.prototype.push=function(b,g){return this._transformState.needTransform=!1,u.prototype.push.call(this,b,g)},f.prototype._transform=function(b,g,x){x(new s("_transform()"))},f.prototype._write=function(b,g,x){var y=this._transformState;if(y.writecb=x,y.writechunk=b,y.writeencoding=g,!y.transforming){var E=this._readableState;(y.needTransform||E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}},f.prototype._read=function(b){var g=this._transformState;g.writechunk===null||g.transforming?g.needTransform=!0:(g.transforming=!0,this._transform(g.writechunk,g.writeencoding,g.afterTransform))},f.prototype._destroy=function(b,g){u.prototype._destroy.call(this,b,function(x){g(x)})}},{"../errors":477,"./_stream_duplex":478,inherits:440}],482:[function(e,a,n){(function(o,s){(function(){function l(T){var D=this;this.next=null,this.entry=null,this.finish=function(){(function(B,F,Y){var X=B.entry;for(B.entry=null;X;){var re=X.callback;F.pendingcb--,re(Y),X=X.next}F.corkedRequestsFree.next=B})(D,T)}}var c;a.exports=W,W.WritableState=Z;var i={deprecate:e("util-deprecate")},u=e("./internal/streams/stream"),p=e("buffer").Buffer,f=(s!==void 0?s:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},h,v=e("./internal/streams/destroy"),b=e("./internal/streams/state").getHighWaterMark,g=e("../errors").codes,x=g.ERR_INVALID_ARG_TYPE,y=g.ERR_METHOD_NOT_IMPLEMENTED,E=g.ERR_MULTIPLE_CALLBACK,N=g.ERR_STREAM_CANNOT_PIPE,I=g.ERR_STREAM_DESTROYED,P=g.ERR_STREAM_NULL_VALUES,V=g.ERR_STREAM_WRITE_AFTER_END,U=g.ERR_UNKNOWN_ENCODING,H=v.errorOrDestroy;function G(){}function Z(T,D,B){c=c||e("./_stream_duplex"),T=T||{},typeof B!="boolean"&&(B=D instanceof c),this.objectMode=!!T.objectMode,B&&(this.objectMode=this.objectMode||!!T.writableObjectMode),this.highWaterMark=b(this,T,"writableHighWaterMark",B),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var F=T.decodeStrings===!1;this.decodeStrings=!F,this.defaultEncoding=T.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Y){(function(X,re){var z=X._writableState,ee=z.sync,L=z.writecb;if(typeof L!="function")throw new E;if(function(K){K.writing=!1,K.writecb=null,K.length-=K.writelen,K.writelen=0}(z),re)(function(K,se,te,ae,Q){--se.pendingcb,te?(o.nextTick(Q,ae),o.nextTick(A,K,se),K._writableState.errorEmitted=!0,H(K,ae)):(Q(ae),K._writableState.errorEmitted=!0,H(K,ae),A(K,se))})(X,z,ee,re,L);else{var M=_(z)||X.destroyed;M||z.corked||z.bufferProcessing||!z.bufferedRequest||C(X,z),ee?o.nextTick(R,X,z,M,L):R(X,z,M,L)}})(D,Y)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=T.emitClose!==!1,this.autoDestroy=!!T.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new l(this)}function W(T){var D=this instanceof(c=c||e("./_stream_duplex"));if(!D&&!h.call(W,this))return new W(T);this._writableState=new Z(T,this,D),this.writable=!0,T&&(typeof T.write=="function"&&(this._write=T.write),typeof T.writev=="function"&&(this._writev=T.writev),typeof T.destroy=="function"&&(this._destroy=T.destroy),typeof T.final=="function"&&(this._final=T.final)),u.call(this)}function O(T,D,B,F,Y,X,re){D.writelen=F,D.writecb=re,D.writing=!0,D.sync=!0,D.destroyed?D.onwrite(new I("write")):B?T._writev(Y,D.onwrite):T._write(Y,X,D.onwrite),D.sync=!1}function R(T,D,B,F){B||function(Y,X){X.length===0&&X.needDrain&&(X.needDrain=!1,Y.emit("drain"))}(T,D),D.pendingcb--,F(),A(T,D)}function C(T,D){D.bufferProcessing=!0;var B=D.bufferedRequest;if(T._writev&&B&&B.next){var F=D.bufferedRequestCount,Y=new Array(F),X=D.corkedRequestsFree;X.entry=B;for(var re=0,z=!0;B;)Y[re]=B,B.isBuf||(z=!1),B=B.next,re+=1;Y.allBuffers=z,O(T,D,!0,D.length,Y,"",X.finish),D.pendingcb++,D.lastBufferedRequest=null,X.next?(D.corkedRequestsFree=X.next,X.next=null):D.corkedRequestsFree=new l(D),D.bufferedRequestCount=0}else{for(;B;){var ee=B.chunk,L=B.encoding,M=B.callback;if(O(T,D,!1,D.objectMode?1:ee.length,ee,L,M),B=B.next,D.bufferedRequestCount--,D.writing)break}B===null&&(D.lastBufferedRequest=null)}D.bufferedRequest=B,D.bufferProcessing=!1}function _(T){return T.ending&&T.length===0&&T.bufferedRequest===null&&!T.finished&&!T.writing}function k(T,D){T._final(function(B){D.pendingcb--,B&&H(T,B),D.prefinished=!0,T.emit("prefinish"),A(T,D)})}function A(T,D){var B=_(D);if(B&&(function(Y,X){X.prefinished||X.finalCalled||(typeof Y._final!="function"||X.destroyed?(X.prefinished=!0,Y.emit("prefinish")):(X.pendingcb++,X.finalCalled=!0,o.nextTick(k,Y,X)))}(T,D),D.pendingcb===0&&(D.finished=!0,T.emit("finish"),D.autoDestroy))){var F=T._readableState;(!F||F.autoDestroy&&F.endEmitted)&&T.destroy()}return B}e("inherits")(W,u),Z.prototype.getBuffer=function(){for(var T=this.bufferedRequest,D=[];T;)D.push(T),T=T.next;return D},function(){try{Object.defineProperty(Z.prototype,"buffer",{get:i.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(h=Function.prototype[Symbol.hasInstance],Object.defineProperty(W,Symbol.hasInstance,{value:function(T){return!!h.call(this,T)||this===W&&T&&T._writableState instanceof Z}})):h=function(T){return T instanceof this},W.prototype.pipe=function(){H(this,new N)},W.prototype.write=function(T,D,B){var F,Y=this._writableState,X=!1,re=!Y.objectMode&&(F=T,p.isBuffer(F)||F instanceof f);return re&&!p.isBuffer(T)&&(T=function(z){return p.from(z)}(T)),typeof D=="function"&&(B=D,D=null),re?D="buffer":D||(D=Y.defaultEncoding),typeof B!="function"&&(B=G),Y.ending?function(z,ee){var L=new V;H(z,L),o.nextTick(ee,L)}(this,B):(re||function(z,ee,L,M){var K;return L===null?K=new P:typeof L=="string"||ee.objectMode||(K=new x("chunk",["string","Buffer"],L)),!K||(H(z,K),o.nextTick(M,K),!1)}(this,Y,T,B))&&(Y.pendingcb++,X=function(z,ee,L,M,K,se){if(!L){var te=function(le,ne,ue){return le.objectMode||le.decodeStrings===!1||typeof ne!="string"||(ne=p.from(ne,ue)),ne}(ee,M,K);M!==te&&(L=!0,K="buffer",M=te)}var ae=ee.objectMode?1:M.length;ee.length+=ae;var Q=ee.length<ee.highWaterMark;if(Q||(ee.needDrain=!0),ee.writing||ee.corked){var fe=ee.lastBufferedRequest;ee.lastBufferedRequest={chunk:M,encoding:K,isBuf:L,callback:se,next:null},fe?fe.next=ee.lastBufferedRequest:ee.bufferedRequest=ee.lastBufferedRequest,ee.bufferedRequestCount+=1}else O(z,ee,!1,ae,M,K,se);return Q}(this,Y,re,T,D,B)),X},W.prototype.cork=function(){this._writableState.corked++},W.prototype.uncork=function(){var T=this._writableState;T.corked&&(T.corked--,T.writing||T.corked||T.bufferProcessing||!T.bufferedRequest||C(this,T))},W.prototype.setDefaultEncoding=function(T){if(typeof T=="string"&&(T=T.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((T+"").toLowerCase())>-1))throw new U(T);return this._writableState.defaultEncoding=T,this},Object.defineProperty(W.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(W.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),W.prototype._write=function(T,D,B){B(new y("_write()"))},W.prototype._writev=null,W.prototype.end=function(T,D,B){var F=this._writableState;return typeof T=="function"?(B=T,T=null,D=null):typeof D=="function"&&(B=D,D=null),T!=null&&this.write(T,D),F.corked&&(F.corked=1,this.uncork()),F.ending||function(Y,X,re){X.ending=!0,A(Y,X),re&&(X.finished?o.nextTick(re):Y.once("finish",re)),X.ended=!0,Y.writable=!1}(this,F,B),this},Object.defineProperty(W.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(W.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(T){this._writableState&&(this._writableState.destroyed=T)}}),W.prototype.destroy=v.destroy,W.prototype._undestroy=v.undestroy,W.prototype._destroy=function(T,D){D(T)}}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/destroy":485,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,inherits:440,"util-deprecate":524}],483:[function(e,a,n){(function(o){(function(){var s;function l(I,P,V){return(P=function(U){var H=function(G,Z){if(typeof G!="object"||G===null)return G;var W=G[Symbol.toPrimitive];if(W!==void 0){var O=W.call(G,Z);if(typeof O!="object")return O;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Z==="string"?String:Number)(G)}(U,"string");return typeof H=="symbol"?H:String(H)}(P))in I?Object.defineProperty(I,P,{value:V,enumerable:!0,configurable:!0,writable:!0}):I[P]=V,I}var c=e("./end-of-stream"),i=Symbol("lastResolve"),u=Symbol("lastReject"),p=Symbol("error"),f=Symbol("ended"),h=Symbol("lastPromise"),v=Symbol("handlePromise"),b=Symbol("stream");function g(I,P){return{value:I,done:P}}function x(I){var P=I[i];if(P!==null){var V=I[b].read();V!==null&&(I[h]=null,I[i]=null,I[u]=null,P(g(V,!1)))}}function y(I){o.nextTick(x,I)}var E=Object.getPrototypeOf(function(){}),N=Object.setPrototypeOf((l(s={get stream(){return this[b]},next:function(){var I=this,P=this[p];if(P!==null)return Promise.reject(P);if(this[f])return Promise.resolve(g(void 0,!0));if(this[b].destroyed)return new Promise(function(G,Z){o.nextTick(function(){I[p]?Z(I[p]):G(g(void 0,!0))})});var V,U=this[h];if(U)V=new Promise(function(G,Z){return function(W,O){G.then(function(){Z[f]?W(g(void 0,!0)):Z[v](W,O)},O)}}(U,this));else{var H=this[b].read();if(H!==null)return Promise.resolve(g(H,!1));V=new Promise(this[v])}return this[h]=V,V}},Symbol.asyncIterator,function(){return this}),l(s,"return",function(){var I=this;return new Promise(function(P,V){I[b].destroy(null,function(U){U?V(U):P(g(void 0,!0))})})}),s),E);a.exports=function(I){var P,V=Object.create(N,(l(P={},b,{value:I,writable:!0}),l(P,i,{value:null,writable:!0}),l(P,u,{value:null,writable:!0}),l(P,p,{value:null,writable:!0}),l(P,f,{value:I._readableState.endEmitted,writable:!0}),l(P,v,{value:function(U,H){var G=V[b].read();G?(V[h]=null,V[i]=null,V[u]=null,U(g(G,!1))):(V[i]=U,V[u]=H)},writable:!0}),P));return V[h]=null,c(I,function(U){if(U&&U.code!=="ERR_STREAM_PREMATURE_CLOSE"){var H=V[u];return H!==null&&(V[h]=null,V[i]=null,V[u]=null,H(U)),void(V[p]=U)}var G=V[i];G!==null&&(V[h]=null,V[i]=null,V[u]=null,G(g(void 0,!0))),V[f]=!0}),I.on("readable",y.bind(null,V)),V}}).call(this)}).call(this,e("_process"))},{"./end-of-stream":486,_process:467}],484:[function(e,a,n){function o(h,v){var b=Object.keys(h);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(h);v&&(g=g.filter(function(x){return Object.getOwnPropertyDescriptor(h,x).enumerable})),b.push.apply(b,g)}return b}function s(h){for(var v=1;v<arguments.length;v++){var b=arguments[v]!=null?arguments[v]:{};v%2?o(Object(b),!0).forEach(function(g){l(h,g,b[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(b)):o(Object(b)).forEach(function(g){Object.defineProperty(h,g,Object.getOwnPropertyDescriptor(b,g))})}return h}function l(h,v,b){return(v=i(v))in h?Object.defineProperty(h,v,{value:b,enumerable:!0,configurable:!0,writable:!0}):h[v]=b,h}function c(h,v){for(var b=0;b<v.length;b++){var g=v[b];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(h,i(g.key),g)}}function i(h){var v=function(b,g){if(typeof b!="object"||b===null)return b;var x=b[Symbol.toPrimitive];if(x!==void 0){var y=x.call(b,g);if(typeof y!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return(g==="string"?String:Number)(b)}(h,"string");return typeof v=="symbol"?v:String(v)}var u=e("buffer").Buffer,p=e("util").inspect,f=p&&p.custom||"inspect";a.exports=function(){function h(){(function(g,x){if(!(g instanceof x))throw new TypeError("Cannot call a class as a function")})(this,h),this.head=null,this.tail=null,this.length=0}var v,b;return v=h,(b=[{key:"push",value:function(g){var x={data:g,next:null};this.length>0?this.tail.next=x:this.head=x,this.tail=x,++this.length}},{key:"unshift",value:function(g){var x={data:g,next:this.head};this.length===0&&(this.tail=x),this.head=x,++this.length}},{key:"shift",value:function(){if(this.length!==0){var g=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,g}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(g){if(this.length===0)return"";for(var x=this.head,y=""+x.data;x=x.next;)y+=g+x.data;return y}},{key:"concat",value:function(g){if(this.length===0)return u.alloc(0);for(var x,y,E,N=u.allocUnsafe(g>>>0),I=this.head,P=0;I;)x=I.data,y=N,E=P,u.prototype.copy.call(x,y,E),P+=I.data.length,I=I.next;return N}},{key:"consume",value:function(g,x){var y;return g<this.head.data.length?(y=this.head.data.slice(0,g),this.head.data=this.head.data.slice(g)):y=g===this.head.data.length?this.shift():x?this._getString(g):this._getBuffer(g),y}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(g){var x=this.head,y=1,E=x.data;for(g-=E.length;x=x.next;){var N=x.data,I=g>N.length?N.length:g;if(I===N.length?E+=N:E+=N.slice(0,g),(g-=I)==0){I===N.length?(++y,x.next?this.head=x.next:this.head=this.tail=null):(this.head=x,x.data=N.slice(I));break}++y}return this.length-=y,E}},{key:"_getBuffer",value:function(g){var x=u.allocUnsafe(g),y=this.head,E=1;for(y.data.copy(x),g-=y.data.length;y=y.next;){var N=y.data,I=g>N.length?N.length:g;if(N.copy(x,x.length-g,0,I),(g-=I)==0){I===N.length?(++E,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=N.slice(I));break}++E}return this.length-=E,x}},{key:f,value:function(g,x){return p(this,s(s({},x),{},{depth:0,customInspect:!1}))}}])&&c(v.prototype,b),Object.defineProperty(v,"prototype",{writable:!1}),h}()},{buffer:220,util:188}],485:[function(e,a,n){(function(o){(function(){function s(i,u){c(i,u),l(i)}function l(i){i._writableState&&!i._writableState.emitClose||i._readableState&&!i._readableState.emitClose||i.emit("close")}function c(i,u){i.emit("error",u)}a.exports={destroy:function(i,u){var p=this,f=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return f||h?(u?u(i):i&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,o.nextTick(c,this,i)):o.nextTick(c,this,i)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(i||null,function(v){!u&&v?p._writableState?p._writableState.errorEmitted?o.nextTick(l,p):(p._writableState.errorEmitted=!0,o.nextTick(s,p,v)):o.nextTick(s,p,v):u?(o.nextTick(l,p),u(v)):o.nextTick(l,p)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(i,u){var p=i._readableState,f=i._writableState;p&&p.autoDestroy||f&&f.autoDestroy?i.destroy(u):i.emit("error",u)}}}).call(this)}).call(this,e("_process"))},{_process:467}],486:[function(e,a,n){var o=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function s(){}a.exports=function l(c,i,u){if(typeof i=="function")return l(c,null,i);i||(i={}),u=function(I){var P=!1;return function(){if(!P){P=!0;for(var V=arguments.length,U=new Array(V),H=0;H<V;H++)U[H]=arguments[H];I.apply(this,U)}}}(u||s);var p=i.readable||i.readable!==!1&&c.readable,f=i.writable||i.writable!==!1&&c.writable,h=function(){c.writable||b()},v=c._writableState&&c._writableState.finished,b=function(){f=!1,v=!0,p||u.call(c)},g=c._readableState&&c._readableState.endEmitted,x=function(){p=!1,g=!0,f||u.call(c)},y=function(I){u.call(c,I)},E=function(){var I;return p&&!g?(c._readableState&&c._readableState.ended||(I=new o),u.call(c,I)):f&&!v?(c._writableState&&c._writableState.ended||(I=new o),u.call(c,I)):void 0},N=function(){c.req.on("finish",b)};return function(I){return I.setHeader&&typeof I.abort=="function"}(c)?(c.on("complete",b),c.on("abort",E),c.req?N():c.on("request",N)):f&&!c._writableState&&(c.on("end",h),c.on("close",h)),c.on("end",x),c.on("finish",b),i.error!==!1&&c.on("error",y),c.on("close",E),function(){c.removeListener("complete",b),c.removeListener("abort",E),c.removeListener("request",N),c.req&&c.req.removeListener("finish",b),c.removeListener("end",h),c.removeListener("close",h),c.removeListener("finish",b),c.removeListener("end",x),c.removeListener("error",y),c.removeListener("close",E)}}},{"../../../errors":477}],487:[function(e,a,n){a.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],488:[function(e,a,n){var o,s=e("../../../errors").codes,l=s.ERR_MISSING_ARGS,c=s.ERR_STREAM_DESTROYED;function i(v){if(v)throw v}function u(v,b,g,x){x=function(N){var I=!1;return function(){I||(I=!0,N.apply(void 0,arguments))}}(x);var y=!1;v.on("close",function(){y=!0}),o===void 0&&(o=e("./end-of-stream")),o(v,{readable:b,writable:g},function(N){if(N)return x(N);y=!0,x()});var E=!1;return function(N){if(!y&&!E)return E=!0,function(I){return I.setHeader&&typeof I.abort=="function"}(v)?v.abort():typeof v.destroy=="function"?v.destroy():void x(N||new c("pipe"))}}function p(v){v()}function f(v,b){return v.pipe(b)}function h(v){return v.length?typeof v[v.length-1]!="function"?i:v.pop():i}a.exports=function(){for(var v=arguments.length,b=new Array(v),g=0;g<v;g++)b[g]=arguments[g];var x,y=h(b);if(Array.isArray(b[0])&&(b=b[0]),b.length<2)throw new l("streams");var E=b.map(function(N,I){var P=I<b.length-1;return u(N,P,I>0,function(V){x||(x=V),V&&E.forEach(p),P||(E.forEach(p),y(x))})});return b.reduce(f)}},{"../../../errors":477,"./end-of-stream":486}],489:[function(e,a,n){var o=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;a.exports={getHighWaterMark:function(s,l,c,i){var u=function(p,f,h){return p.highWaterMark!=null?p.highWaterMark:f?p[h]:null}(l,i,c);if(u!=null){if(!isFinite(u)||Math.floor(u)!==u||u<0)throw new o(i?c:"highWaterMark",u);return Math.floor(u)}return s.objectMode?16:16384}}},{"../../../errors":477}],490:[function(e,a,n){a.exports=e("events").EventEmitter},{events:422}],491:[function(e,a,n){(n=a.exports=e("./lib/_stream_readable.js")).Stream=n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js"),n.finished=e("./lib/internal/streams/end-of-stream.js"),n.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":478,"./lib/_stream_passthrough.js":479,"./lib/_stream_readable.js":480,"./lib/_stream_transform.js":481,"./lib/_stream_writable.js":482,"./lib/internal/streams/end-of-stream.js":486,"./lib/internal/streams/pipeline.js":488}],492:[function(e,a,n){var o=function(s){var l=Object.prototype,c=l.hasOwnProperty,i=Object.defineProperty||function(A,T,D){A[T]=D.value},u=typeof Symbol=="function"?Symbol:{},p=u.iterator||"@@iterator",f=u.asyncIterator||"@@asyncIterator",h=u.toStringTag||"@@toStringTag";function v(A,T,D){return Object.defineProperty(A,T,{value:D,enumerable:!0,configurable:!0,writable:!0}),A[T]}try{v({},"")}catch{v=function(T,D,B){return T[D]=B}}function b(A,T,D,B){var F=T&&T.prototype instanceof y?T:y,Y=Object.create(F.prototype),X=new C(B||[]);return i(Y,"_invoke",{value:Z(A,D,X)}),Y}function g(A,T,D){try{return{type:"normal",arg:A.call(T,D)}}catch(B){return{type:"throw",arg:B}}}s.wrap=b;var x={};function y(){}function E(){}function N(){}var I={};v(I,p,function(){return this});var P=Object.getPrototypeOf,V=P&&P(P(_([])));V&&V!==l&&c.call(V,p)&&(I=V);var U=N.prototype=y.prototype=Object.create(I);function H(A){["next","throw","return"].forEach(function(T){v(A,T,function(D){return this._invoke(T,D)})})}function G(A,T){var D;i(this,"_invoke",{value:function(B,F){function Y(){return new T(function(X,re){(function z(ee,L,M,K){var se=g(A[ee],A,L);if(se.type!=="throw"){var te=se.arg,ae=te.value;return ae&&typeof ae=="object"&&c.call(ae,"__await")?T.resolve(ae.__await).then(function(Q){z("next",Q,M,K)},function(Q){z("throw",Q,M,K)}):T.resolve(ae).then(function(Q){te.value=Q,M(te)},function(Q){return z("throw",Q,M,K)})}K(se.arg)})(B,F,X,re)})}return D=D?D.then(Y,Y):Y()}})}function Z(A,T,D){var B="suspendedStart";return function(F,Y){if(B==="executing")throw new Error("Generator is already running");if(B==="completed"){if(F==="throw")throw Y;return k()}for(D.method=F,D.arg=Y;;){var X=D.delegate;if(X){var re=W(X,D);if(re){if(re===x)continue;return re}}if(D.method==="next")D.sent=D._sent=D.arg;else if(D.method==="throw"){if(B==="suspendedStart")throw B="completed",D.arg;D.dispatchException(D.arg)}else D.method==="return"&&D.abrupt("return",D.arg);B="executing";var z=g(A,T,D);if(z.type==="normal"){if(B=D.done?"completed":"suspendedYield",z.arg===x)continue;return{value:z.arg,done:D.done}}z.type==="throw"&&(B="completed",D.method="throw",D.arg=z.arg)}}}function W(A,T){var D=T.method,B=A.iterator[D];if(B===void 0)return T.delegate=null,D==="throw"&&A.iterator.return&&(T.method="return",T.arg=void 0,W(A,T),T.method==="throw")||D!=="return"&&(T.method="throw",T.arg=new TypeError("The iterator does not provide a '"+D+"' method")),x;var F=g(B,A.iterator,T.arg);if(F.type==="throw")return T.method="throw",T.arg=F.arg,T.delegate=null,x;var Y=F.arg;return Y?Y.done?(T[A.resultName]=Y.value,T.next=A.nextLoc,T.method!=="return"&&(T.method="next",T.arg=void 0),T.delegate=null,x):Y:(T.method="throw",T.arg=new TypeError("iterator result is not an object"),T.delegate=null,x)}function O(A){var T={tryLoc:A[0]};1 in A&&(T.catchLoc=A[1]),2 in A&&(T.finallyLoc=A[2],T.afterLoc=A[3]),this.tryEntries.push(T)}function R(A){var T=A.completion||{};T.type="normal",delete T.arg,A.completion=T}function C(A){this.tryEntries=[{tryLoc:"root"}],A.forEach(O,this),this.reset(!0)}function _(A){if(A){var T=A[p];if(T)return T.call(A);if(typeof A.next=="function")return A;if(!isNaN(A.length)){var D=-1,B=function F(){for(;++D<A.length;)if(c.call(A,D))return F.value=A[D],F.done=!1,F;return F.value=void 0,F.done=!0,F};return B.next=B}}return{next:k}}function k(){return{value:void 0,done:!0}}return E.prototype=N,i(U,"constructor",{value:N,configurable:!0}),i(N,"constructor",{value:E,configurable:!0}),E.displayName=v(N,h,"GeneratorFunction"),s.isGeneratorFunction=function(A){var T=typeof A=="function"&&A.constructor;return!!T&&(T===E||(T.displayName||T.name)==="GeneratorFunction")},s.mark=function(A){return Object.setPrototypeOf?Object.setPrototypeOf(A,N):(A.__proto__=N,v(A,h,"GeneratorFunction")),A.prototype=Object.create(U),A},s.awrap=function(A){return{__await:A}},H(G.prototype),v(G.prototype,f,function(){return this}),s.AsyncIterator=G,s.async=function(A,T,D,B,F){F===void 0&&(F=Promise);var Y=new G(b(A,T,D,B),F);return s.isGeneratorFunction(T)?Y:Y.next().then(function(X){return X.done?X.value:Y.next()})},H(U),v(U,h,"Generator"),v(U,p,function(){return this}),v(U,"toString",function(){return"[object Generator]"}),s.keys=function(A){var T=Object(A),D=[];for(var B in T)D.push(B);return D.reverse(),function F(){for(;D.length;){var Y=D.pop();if(Y in T)return F.value=Y,F.done=!1,F}return F.done=!0,F}},s.values=_,C.prototype={constructor:C,reset:function(A){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(R),!A)for(var T in this)T.charAt(0)==="t"&&c.call(this,T)&&!isNaN(+T.slice(1))&&(this[T]=void 0)},stop:function(){this.done=!0;var A=this.tryEntries[0].completion;if(A.type==="throw")throw A.arg;return this.rval},dispatchException:function(A){if(this.done)throw A;var T=this;function D(z,ee){return Y.type="throw",Y.arg=A,T.next=z,ee&&(T.method="next",T.arg=void 0),!!ee}for(var B=this.tryEntries.length-1;B>=0;--B){var F=this.tryEntries[B],Y=F.completion;if(F.tryLoc==="root")return D("end");if(F.tryLoc<=this.prev){var X=c.call(F,"catchLoc"),re=c.call(F,"finallyLoc");if(X&&re){if(this.prev<F.catchLoc)return D(F.catchLoc,!0);if(this.prev<F.finallyLoc)return D(F.finallyLoc)}else if(X){if(this.prev<F.catchLoc)return D(F.catchLoc,!0)}else{if(!re)throw new Error("try statement without catch or finally");if(this.prev<F.finallyLoc)return D(F.finallyLoc)}}}},abrupt:function(A,T){for(var D=this.tryEntries.length-1;D>=0;--D){var B=this.tryEntries[D];if(B.tryLoc<=this.prev&&c.call(B,"finallyLoc")&&this.prev<B.finallyLoc){var F=B;break}}F&&(A==="break"||A==="continue")&&F.tryLoc<=T&&T<=F.finallyLoc&&(F=null);var Y=F?F.completion:{};return Y.type=A,Y.arg=T,F?(this.method="next",this.next=F.finallyLoc,x):this.complete(Y)},complete:function(A,T){if(A.type==="throw")throw A.arg;return A.type==="break"||A.type==="continue"?this.next=A.arg:A.type==="return"?(this.rval=this.arg=A.arg,this.method="return",this.next="end"):A.type==="normal"&&T&&(this.next=T),x},finish:function(A){for(var T=this.tryEntries.length-1;T>=0;--T){var D=this.tryEntries[T];if(D.finallyLoc===A)return this.complete(D.completion,D.afterLoc),R(D),x}},catch:function(A){for(var T=this.tryEntries.length-1;T>=0;--T){var D=this.tryEntries[T];if(D.tryLoc===A){var B=D.completion;if(B.type==="throw"){var F=B.arg;R(D)}return F}}throw new Error("illegal catch attempt")},delegateYield:function(A,T,D){return this.delegate={iterator:_(A),resultName:T,nextLoc:D},this.method==="next"&&(this.arg=void 0),x}},s}(typeof a=="object"?a.exports:{});try{regeneratorRuntime=o}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}},{}],493:[function(e,a,n){var o=e("buffer").Buffer,s=e("inherits"),l=e("hash-base"),c=new Array(16),i=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],u=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],p=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],f=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],h=[0,1518500249,1859775393,2400959708,2840853838],v=[1352829926,1548603684,1836072691,2053994217,0];function b(){l.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function g(P,V){return P<<V|P>>>32-V}function x(P,V,U,H,G,Z,W,O){return g(P+(V^U^H)+Z+W|0,O)+G|0}function y(P,V,U,H,G,Z,W,O){return g(P+(V&U|~V&H)+Z+W|0,O)+G|0}function E(P,V,U,H,G,Z,W,O){return g(P+((V|~U)^H)+Z+W|0,O)+G|0}function N(P,V,U,H,G,Z,W,O){return g(P+(V&H|U&~H)+Z+W|0,O)+G|0}function I(P,V,U,H,G,Z,W,O){return g(P+(V^(U|~H))+Z+W|0,O)+G|0}s(b,l),b.prototype._update=function(){for(var P=c,V=0;V<16;++V)P[V]=this._block.readInt32LE(4*V);for(var U=0|this._a,H=0|this._b,G=0|this._c,Z=0|this._d,W=0|this._e,O=0|this._a,R=0|this._b,C=0|this._c,_=0|this._d,k=0|this._e,A=0;A<80;A+=1){var T,D;A<16?(T=x(U,H,G,Z,W,P[i[A]],h[0],p[A]),D=I(O,R,C,_,k,P[u[A]],v[0],f[A])):A<32?(T=y(U,H,G,Z,W,P[i[A]],h[1],p[A]),D=N(O,R,C,_,k,P[u[A]],v[1],f[A])):A<48?(T=E(U,H,G,Z,W,P[i[A]],h[2],p[A]),D=E(O,R,C,_,k,P[u[A]],v[2],f[A])):A<64?(T=N(U,H,G,Z,W,P[i[A]],h[3],p[A]),D=y(O,R,C,_,k,P[u[A]],v[3],f[A])):(T=I(U,H,G,Z,W,P[i[A]],h[4],p[A]),D=x(O,R,C,_,k,P[u[A]],v[4],f[A])),U=W,W=Z,Z=g(G,10),G=H,H=T,O=k,k=_,_=g(C,10),C=R,R=D}var B=this._b+G+_|0;this._b=this._c+Z+k|0,this._c=this._d+W+O|0,this._d=this._e+U+R|0,this._e=this._a+H+C|0,this._a=B},b.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var P=o.alloc?o.alloc(20):new o(20);return P.writeInt32LE(this._a,0),P.writeInt32LE(this._b,4),P.writeInt32LE(this._c,8),P.writeInt32LE(this._d,12),P.writeInt32LE(this._e,16),P},a.exports=b},{buffer:220,"hash-base":425,inherits:440}],494:[function(e,a,n){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var o=e("buffer"),s=o.Buffer;function l(i,u){for(var p in i)u[p]=i[p]}function c(i,u,p){return s(i,u,p)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?a.exports=o:(l(o,n),n.Buffer=c),c.prototype=Object.create(s.prototype),l(s,c),c.from=function(i,u,p){if(typeof i=="number")throw new TypeError("Argument must not be a number");return s(i,u,p)},c.alloc=function(i,u,p){if(typeof i!="number")throw new TypeError("Argument must be a number");var f=s(i);return u!==void 0?typeof p=="string"?f.fill(u,p):f.fill(u):f.fill(0),f},c.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return s(i)},c.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return o.SlowBuffer(i)}},{buffer:220}],495:[function(e,a,n){(function(o){(function(){var s,l=e("buffer"),c=l.Buffer,i={};for(s in l)l.hasOwnProperty(s)&&s!=="SlowBuffer"&&s!=="Buffer"&&(i[s]=l[s]);var u=i.Buffer={};for(s in c)c.hasOwnProperty(s)&&s!=="allocUnsafe"&&s!=="allocUnsafeSlow"&&(u[s]=c[s]);if(i.Buffer.prototype=c.prototype,u.from&&u.from!==Uint8Array.from||(u.from=function(p,f,h){if(typeof p=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof p);if(p&&p.length===void 0)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p);return c(p,f,h)}),u.alloc||(u.alloc=function(p,f,h){if(typeof p!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof p);if(p<0||p>=2*(1<<30))throw new RangeError('The value "'+p+'" is invalid for option "size"');var v=c(p);return f&&f.length!==0?typeof h=="string"?v.fill(f,h):v.fill(f):v.fill(0),v}),!i.kStringMaxLength)try{i.kStringMaxLength=o.binding("buffer").kStringMaxLength}catch{}i.constants||(i.constants={MAX_LENGTH:i.kMaxLength},i.kStringMaxLength&&(i.constants.MAX_STRING_LENGTH=i.kStringMaxLength)),a.exports=i}).call(this)}).call(this,e("_process"))},{_process:467,buffer:220}],496:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0});const o=e("xmlchars/xml/1.0/ed5"),s=e("xmlchars/xml/1.1/ed2"),l=e("xmlchars/xmlns/1.0/ed3");var c=o.isS,i=o.isChar,u=o.isNameStartChar,p=o.isNameChar,f=o.S_LIST,h=o.NAME_RE,v=s.isChar,b=l.isNCNameStartChar,g=l.isNCNameChar,x=l.NC_NAME_RE;const y="http://www.w3.org/XML/1998/namespace",E="http://www.w3.org/2000/xmlns/",N={__proto__:null,xml:y,xmlns:E},I={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},P=_=>_===34||_===39,V=[34,39],U=[...V,91,62],H=[...V,60,93],G=[61,63,...f],Z=[...f,62,38,60];function W(_,k,A){switch(k){case"xml":A!==y&&_.fail(`xml prefix must be bound to ${y}.`);break;case"xmlns":A!==E&&_.fail(`xmlns prefix must be bound to ${E}.`)}switch(A){case E:_.fail(k===""?`the default namespace may not be set to ${A}.`:`may not assign a prefix (even "xmlns") to the URI ${E}.`);break;case y:switch(k){case"xml":break;case"":_.fail(`the default namespace may not be set to ${A}.`);break;default:_.fail("may not assign the xml namespace to another prefix.")}}}const O=_=>x.test(_),R=_=>h.test(_);n.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const C={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};n.SaxesParser=class{constructor(_){this.opt=_??{},this.fragmentOpt=!!this.opt.fragment;const k=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,k){this.nameStartCheck=b,this.nameCheck=g,this.isName=O,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},N);const A=this.opt.additionalNamespaces;A!=null&&(function(T,D){for(const B of Object.keys(D))W(T,B,D[B])}(this,A),Object.assign(this.ns,A))}else this.nameStartCheck=u,this.nameCheck=p,this.isName=R,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var _;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:k}=this;this.state=k?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=k,this.xmlDeclPossible=!k,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:A}=this.opt;if(A===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");A="1.0"}this.setXMLVersion(A),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(I),(_=this.readyHandler)===null||_===void 0||_.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(_,k){this[C[_]]=k}off(_){this[C[_]]=void 0}makeError(_){var k;let A=(k=this.fileName)!==null&&k!==void 0?k:"";return this.trackPosition&&(A.length>0&&(A+=":"),A+=`${this.line}:${this.column}`),A.length>0&&(A+=": "),new Error(A+_)}fail(_){const k=this.makeError(_),A=this.errorHandler;if(A===void 0)throw k;return A(k),this}write(_){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let k=!1;_===null?(k=!0,_=""):typeof _=="object"&&(_=_.toString()),this.carriedFromPrevious!==void 0&&(_=`${this.carriedFromPrevious}${_}`,this.carriedFromPrevious=void 0);let A=_.length;const T=_.charCodeAt(A-1);!k&&(T===13||T>=55296&&T<=56319)&&(this.carriedFromPrevious=_[A-1],A--,_=_.slice(0,A));const{stateTable:D}=this;for(this.chunk=_,this.i=0;this.i<A;)D[this.state].call(this);return this.chunkPosition+=A,k?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:_,i:k}=this;if(this.prevI=k,this.i=k+1,k>=_.length)return-1;const A=_.charCodeAt(k);if(this.column++,A<55296){if(A>=32||A===9)return A;switch(A){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return _.charCodeAt(k+1)===10&&(this.i=k+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),A}}if(A>56319)return A>=57344&&A<=65533||this.fail("disallowed character."),A;const T=65536+1024*(A-55296)+(_.charCodeAt(k+1)-56320);return this.i=k+2,T>1114111&&this.fail("disallowed character."),T}getCode11(){const{chunk:_,i:k}=this;if(this.prevI=k,this.i=k+1,k>=_.length)return-1;const A=_.charCodeAt(k);if(this.column++,A<55296){if(A>31&&A<127||A>159&&A!==8232||A===9)return A;switch(A){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{const D=_.charCodeAt(k+1);D!==10&&D!==133||(this.i=k+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),A}}if(A>56319)return A>=57344&&A<=65533||this.fail("disallowed character."),A;const T=65536+1024*(A-55296)+(_.charCodeAt(k+1)-56320);return this.i=k+2,T>1114111&&this.fail("disallowed character."),T}getCodeNorm(){const _=this.getCode();return _===-2?10:_}unget(){this.i=this.prevI,this.column--}captureTo(_){let{i:k}=this;const{chunk:A}=this;for(;;){const T=this.getCode(),D=T===-2,B=D?10:T;if(B===-1||_.includes(B))return this.text+=A.slice(k,this.prevI),B;D&&(this.text+=A.slice(k,this.prevI)+`
`,k=this.i)}}captureToChar(_){let{i:k}=this;const{chunk:A}=this;for(;;){let T=this.getCode();switch(T){case-2:this.text+=A.slice(k,this.prevI)+`
`,k=this.i,T=10;break;case-1:return this.text+=A.slice(k),!1}if(T===_)return this.text+=A.slice(k,this.prevI),!0}}captureNameChars(){const{chunk:_,i:k}=this;for(;;){const A=this.getCode();if(A===-1)return this.name+=_.slice(k),-1;if(!p(A))return this.name+=_.slice(k,this.prevI),A===-2?10:A}}skipSpaces(){for(;;){const _=this.getCodeNorm();if(_===-1||!c(_))return _}}setXMLVersion(_){this.currentXMLVersion=_,_==="1.0"?(this.isChar=i,this.getCode=this.getCode10):(this.isChar=v,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const _=this.i,k=this.skipSpaces();switch(this.prevI!==_&&(this.xmlDeclPossible=!1),k){case 60:if(this.state=15,this.text.length!==0)throw new Error("no-empty text at start");break;case-1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var _;const k=this.captureTo(U);switch(k){case 62:(_=this.doctypeHandler)===null||_===void 0||_.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case-1:break;default:this.text+=String.fromCodePoint(k),k===91?this.state=4:P(k)&&(this.state=3,this.q=k)}}sDoctypeQuote(){const _=this.q;this.captureToChar(_)&&(this.text+=String.fromCodePoint(_),this.q=null,this.state=2)}sDTD(){const _=this.captureTo(H);_!==-1&&(this.text+=String.fromCodePoint(_),_===93?this.state=2:_===60?this.state=6:P(_)&&(this.state=5,this.q=_))}sDTDQuoted(){const _=this.q;this.captureToChar(_)&&(this.text+=String.fromCodePoint(_),this.state=4,this.q=null)}sDTDOpenWaka(){const _=this.getCodeNorm();switch(this.text+=String.fromCodePoint(_),_){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const _=String.fromCodePoint(this.getCodeNorm()),k=this.openWakaBang+=_;this.text+=_,k!=="-"&&(this.state=k==="--"?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const _=this.getCodeNorm();this.text+=String.fromCodePoint(_),this.state=_===45?10:8}sDTDCommentEnded(){const _=this.getCodeNorm();this.text+=String.fromCodePoint(_),_===62?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const _=this.getCodeNorm();this.text+=String.fromCodePoint(_),_===62&&(this.state=4)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:_}=this;const{chunk:k}=this;e:for(;;)switch(this.getCode()){case-2:this.entity+=k.slice(_,this.prevI)+`
`,_=this.i;break;case 59:{const{entityReturnState:A}=this,T=this.entity+k.slice(_,this.prevI);let D;this.state=A,T===""?(this.fail("empty entity name."),D="&;"):(D=this.parseEntity(T),this.entity=""),A===13&&this.textHandler===void 0||(this.text+=D);break e}case-1:this.entity+=k.slice(_);break e}}sOpenWaka(){const _=this.getCode();if(u(_))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(_){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var _;const k=this.getCodeNorm();k===45?(this.state=19,(_=this.commentHandler)===null||_===void 0||_.call(this,this.text),this.text=""):(this.text+="-"+String.fromCodePoint(k),this.state=17)}sCommentEnded(){const _=this.getCodeNorm();_!==62?(this.fail("malformed comment."),this.text+="--"+String.fromCodePoint(_),this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){const _=this.getCodeNorm();_===93?this.state=22:(this.text+="]"+String.fromCodePoint(_),this.state=20)}sCDataEnding2(){var _;const k=this.getCodeNorm();switch(k){case 62:(_=this.cdataHandler)===null||_===void 0||_.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+="]]"+String.fromCodePoint(k),this.state=20}}sPIFirstChar(){const _=this.getCodeNorm();this.nameStartCheck(_)?(this.piTarget+=String.fromCodePoint(_),this.state=24):_===63||c(_)?(this.fail("processing instruction without a target."),this.state=_===63?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(_),this.state=24)}sPIRest(){const{chunk:_,i:k}=this;for(;;){const A=this.getCodeNorm();if(A===-1)return void(this.piTarget+=_.slice(k));if(!this.nameCheck(A)){this.piTarget+=_.slice(k,this.prevI);const T=A===63;T||c(A)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=T?33:27):this.state=T?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(A));break}}}sPIBody(){if(this.text.length===0){const _=this.getCodeNorm();_===63?this.state=26:c(_)||(this.text=String.fromCodePoint(_))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var _;const k=this.getCodeNorm();if(k===62){const{piTarget:A}=this;A.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(_=this.piHandler)===null||_===void 0||_.call(this,{target:A,body:this.text}),this.piTarget=this.text="",this.state=13}else k===63?this.text+="?":(this.text+="?"+String.fromCodePoint(k),this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const _=this.skipSpaces();_!==63?_!==-1&&(this.state=28,this.name=String.fromCodePoint(_)):this.state=33}sXMLDeclName(){const _=this.captureTo(G);if(_===63)return this.state=33,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(c(_)||_===61){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail("expected one of "+this.xmlDeclExpects.join(", "))}this.state=_===61?30:29}}sXMLDeclEq(){const _=this.getCodeNorm();if(_===63)return this.state=33,void this.fail("XML declaration is incomplete.");c(_)||(_!==61&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const _=this.getCodeNorm();if(_===63)return this.state=33,void this.fail("XML declaration is incomplete.");c(_)||(P(_)?this.q=_:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const _=this.captureTo([this.q,63]);if(_===63)return this.state=33,this.text="",void this.fail("XML declaration is incomplete.");if(_===-1)return;const k=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const A=k;this.xmlDecl.version=A,/^1\.[0-9]+$/.test(A)?this.opt.forceXMLVersion||this.setXMLVersion(A):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(k)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=k;break;case"standalone":k!=="yes"&&k!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=k}this.name="",this.state=32}sXMLDeclSeparator(){const _=this.getCodeNorm();_!==63?(c(_)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=33}sXMLDeclEnding(){var _;this.getCodeNorm()===62?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(_=this.xmldeclHandler)===null||_===void 0||_.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var _;const k=this.captureNameChars();if(k===-1)return;const A=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=A.ns=Object.create(null)),(_=this.openTagStartHandler)===null||_===void 0||_.call(this,A),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),k){case 62:this.openTag();break;case 47:this.state=35;break;default:c(k)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){this.getCode()===62?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const _=this.skipSpaces();_!==-1&&(u(_)?(this.unget(),this.state=37):_===62?this.openTag():_===47?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const _=this.captureNameChars();_===61?this.state=39:c(_)?this.state=38:_===62?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):_!==-1&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const _=this.skipSpaces();switch(_){case-1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",_===62?this.openTag():u(_)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const _=this.getCodeNorm();P(_)?(this.q=_,this.state=40):c(_)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){const{q:_,chunk:k}=this;let{i:A}=this;for(;;)switch(this.getCode()){case _:return this.pushAttrib(this.name,this.text+k.slice(A,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=k.slice(A,this.prevI),this.state=14,void(this.entityReturnState=40);case 10:case-2:case 9:this.text+=k.slice(A,this.prevI)+" ",A=this.i;break;case 60:return this.text+=k.slice(A,this.prevI),void this.fail("disallowed character.");case-1:return void(this.text+=k.slice(A))}}sAttribValueClosed(){const _=this.getCodeNorm();c(_)?this.state=36:_===62?this.openTag():_===47?this.state=35:u(_)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const _=this.captureTo(Z);switch(_){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case-1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",_===62?this.openTag():this.state=36}}sCloseTag(){const _=this.captureNameChars();_===62?this.closeTag():c(_)?this.state=44:_!==-1&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case-1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:_,forbiddenState:k}=this;const{chunk:A,textHandler:T}=this;e:for(;;)switch(this.getCode()){case 60:if(this.state=15,T!==void 0){const{text:D}=this,B=A.slice(_,this.prevI);D.length!==0?(T(D+B),this.text=""):B.length!==0&&T(B)}k=0;break e;case 38:this.state=14,this.entityReturnState=13,T!==void 0&&(this.text+=A.slice(_,this.prevI)),k=0;break e;case 93:switch(k){case 0:k=1;break;case 1:k=2;break;case 2:break;default:throw new Error("impossible state")}break;case 62:k===2&&this.fail('the string "]]>" is disallowed in char data.'),k=0;break;case-2:T!==void 0&&(this.text+=A.slice(_,this.prevI)+`
`),_=this.i,k=0;break;case-1:T!==void 0&&(this.text+=A.slice(_));break e;default:k=0}this.forbiddenState=k}handleTextOutsideRoot(){let{i:_}=this;const{chunk:k,textHandler:A}=this;let T=!1;e:for(;;){const D=this.getCode();switch(D){case 60:if(this.state=15,A!==void 0){const{text:B}=this,F=k.slice(_,this.prevI);B.length!==0?(A(B+F),this.text=""):F.length!==0&&A(F)}break e;case 38:this.state=14,this.entityReturnState=13,A!==void 0&&(this.text+=k.slice(_,this.prevI)),T=!0;break e;case-2:A!==void 0&&(this.text+=k.slice(_,this.prevI)+`
`),_=this.i;break;case-1:A!==void 0&&(this.text+=k.slice(_));break e;default:c(D)||(T=!0)}}T&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(_,k){var A;const{prefix:T,local:D}=this.qname(_),B={name:_,prefix:T,local:D,value:k};if(this.attribList.push(B),(A=this.attributeHandler)===null||A===void 0||A.call(this,B),T==="xmlns"){const F=k.trim();this.currentXMLVersion==="1.0"&&F===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[D]=F,W(this,D,F)}else if(_==="xmlns"){const F=k.trim();this.topNS[""]=F,W(this,"",F)}}pushAttribPlain(_,k){var A;const T={name:_,value:k};this.attribList.push(T),(A=this.attributeHandler)===null||A===void 0||A.call(this,T)}end(){var _,k;this.sawRoot||this.fail("document must contain a root element.");const{tags:A}=this;for(;A.length>0;){const D=A.pop();this.fail("unclosed tag: "+D.name)}this.state!==0&&this.state!==13&&this.fail("unexpected end.");const{text:T}=this;return T.length!==0&&((_=this.textHandler)===null||_===void 0||_.call(this,T),this.text=""),this._closed=!0,(k=this.endHandler)===null||k===void 0||k.call(this),this._init(),this}resolve(_){var k,A;let T=this.topNS[_];if(T!==void 0)return T;const{tags:D}=this;for(let B=D.length-1;B>=0;B--)if(T=D[B].ns[_],T!==void 0)return T;return T=this.ns[_],T!==void 0?T:(A=(k=this.opt).resolvePrefix)===null||A===void 0?void 0:A.call(k,_)}qname(_){const k=_.indexOf(":");if(k===-1)return{prefix:"",local:_};const A=_.slice(k+1),T=_.slice(0,k);return(T===""||A===""||A.includes(":"))&&this.fail(`malformed name: ${_}.`),{prefix:T,local:A}}processAttribsNS(){var _;const{attribList:k}=this,A=this.tag;{const{prefix:B,local:F}=this.qname(A.name);A.prefix=B,A.local=F;const Y=A.uri=(_=this.resolve(B))!==null&&_!==void 0?_:"";B!==""&&(B==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),Y===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(B)}.`),A.uri=B))}if(k.length===0)return;const{attributes:T}=A,D=new Set;for(const B of k){const{name:F,prefix:Y,local:X}=B;let re,z;Y===""?(re=F==="xmlns"?E:"",z=F):(re=this.resolve(Y),re===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(Y)}.`),re=Y),z=`{${re}}${X}`),D.has(z)&&this.fail(`duplicate attribute: ${z}.`),D.add(z),B.uri=re,T[F]=B}this.attribList=[]}processAttribsPlain(){const{attribList:_}=this,k=this.tag.attributes;for(const{name:A,value:T}of _)k[A]!==void 0&&this.fail(`duplicate attribute: ${A}.`),k[A]=T;this.attribList=[]}openTag(){var _;this.processAttribs();const{tags:k}=this,A=this.tag;A.isSelfClosing=!1,(_=this.openTagHandler)===null||_===void 0||_.call(this,A),k.push(A),this.state=13,this.name=""}openSelfClosingTag(){var _,k,A;this.processAttribs();const{tags:T}=this,D=this.tag;D.isSelfClosing=!0,(_=this.openTagHandler)===null||_===void 0||_.call(this,D),(k=this.closeTagHandler)===null||k===void 0||k.call(this,D),(this.tag=(A=T[T.length-1])!==null&&A!==void 0?A:null)===null&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){const{tags:_,name:k}=this;if(this.state=13,this.name="",k==="")return this.fail("weird empty close tag."),void(this.text+="</>");const A=this.closeTagHandler;let T=_.length;for(;T-- >0;){const D=this.tag=_.pop();if(this.topNS=D.ns,A==null||A(D),D.name===k)break;this.fail("unexpected close tag.")}T===0?this.closedRoot=!0:T<0&&(this.fail(`unmatched closing tag: ${k}.`),this.text+=`</${k}>`)}parseEntity(_){if(_[0]!=="#"){const A=this.ENTITIES[_];return A!==void 0?A:(this.fail(this.isName(_)?"undefined entity.":"disallowed character in entity name."),`&${_};`)}let k=NaN;return _[1]==="x"&&/^#x[0-9a-f]+$/i.test(_)?k=parseInt(_.slice(2),16):/^#[0-9]+$/.test(_)&&(k=parseInt(_.slice(1),10)),this.isChar(k)?String.fromCodePoint(k):(this.fail("malformed character entity."),`&${_};`)}}},{"xmlchars/xml/1.0/ed5":543,"xmlchars/xml/1.1/ed2":544,"xmlchars/xmlns/1.0/ed3":545}],497:[function(e,a,n){var o=e("safe-buffer").Buffer;function s(l,c){this._block=o.alloc(l),this._finalSize=c,this._blockSize=l,this._len=0}s.prototype.update=function(l,c){typeof l=="string"&&(c=c||"utf8",l=o.from(l,c));for(var i=this._block,u=this._blockSize,p=l.length,f=this._len,h=0;h<p;){for(var v=f%u,b=Math.min(p-h,u-v),g=0;g<b;g++)i[v+g]=l[h+g];h+=b,(f+=b)%u==0&&this._update(i)}return this._len+=p,this},s.prototype.digest=function(l){var c=this._len%this._blockSize;this._block[c]=128,this._block.fill(0,c+1),c>=this._finalSize&&(this._update(this._block),this._block.fill(0));var i=8*this._len;if(i<=4294967295)this._block.writeUInt32BE(i,this._blockSize-4);else{var u=(4294967295&i)>>>0,p=(i-u)/4294967296;this._block.writeUInt32BE(p,this._blockSize-8),this._block.writeUInt32BE(u,this._blockSize-4)}this._update(this._block);var f=this._hash();return l?f.toString(l):f},s.prototype._update=function(){throw new Error("_update must be implemented by subclass")},a.exports=s},{"safe-buffer":494}],498:[function(e,a,n){var o=a.exports=function(s){s=s.toLowerCase();var l=o[s];if(!l)throw new Error(s+" is not supported (we accept pull requests)");return new l};o.sha=e("./sha"),o.sha1=e("./sha1"),o.sha224=e("./sha224"),o.sha256=e("./sha256"),o.sha384=e("./sha384"),o.sha512=e("./sha512")},{"./sha":499,"./sha1":500,"./sha224":501,"./sha256":502,"./sha384":503,"./sha512":504}],499:[function(e,a,n){var o=e("inherits"),s=e("./hash"),l=e("safe-buffer").Buffer,c=[1518500249,1859775393,-1894007588,-899497514],i=new Array(80);function u(){this.init(),this._w=i,s.call(this,64,56)}function p(h){return h<<30|h>>>2}function f(h,v,b,g){return h===0?v&b|~v&g:h===2?v&b|v&g|b&g:v^b^g}o(u,s),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(h){for(var v,b=this._w,g=0|this._a,x=0|this._b,y=0|this._c,E=0|this._d,N=0|this._e,I=0;I<16;++I)b[I]=h.readInt32BE(4*I);for(;I<80;++I)b[I]=b[I-3]^b[I-8]^b[I-14]^b[I-16];for(var P=0;P<80;++P){var V=~~(P/20),U=0|((v=g)<<5|v>>>27)+f(V,x,y,E)+N+b[P]+c[V];N=E,E=y,y=p(x),x=g,g=U}this._a=g+this._a|0,this._b=x+this._b|0,this._c=y+this._c|0,this._d=E+this._d|0,this._e=N+this._e|0},u.prototype._hash=function(){var h=l.allocUnsafe(20);return h.writeInt32BE(0|this._a,0),h.writeInt32BE(0|this._b,4),h.writeInt32BE(0|this._c,8),h.writeInt32BE(0|this._d,12),h.writeInt32BE(0|this._e,16),h},a.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],500:[function(e,a,n){var o=e("inherits"),s=e("./hash"),l=e("safe-buffer").Buffer,c=[1518500249,1859775393,-1894007588,-899497514],i=new Array(80);function u(){this.init(),this._w=i,s.call(this,64,56)}function p(v){return v<<5|v>>>27}function f(v){return v<<30|v>>>2}function h(v,b,g,x){return v===0?b&g|~b&x:v===2?b&g|b&x|g&x:b^g^x}o(u,s),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(v){for(var b,g=this._w,x=0|this._a,y=0|this._b,E=0|this._c,N=0|this._d,I=0|this._e,P=0;P<16;++P)g[P]=v.readInt32BE(4*P);for(;P<80;++P)g[P]=(b=g[P-3]^g[P-8]^g[P-14]^g[P-16])<<1|b>>>31;for(var V=0;V<80;++V){var U=~~(V/20),H=p(x)+h(U,y,E,N)+I+g[V]+c[U]|0;I=N,N=E,E=f(y),y=x,x=H}this._a=x+this._a|0,this._b=y+this._b|0,this._c=E+this._c|0,this._d=N+this._d|0,this._e=I+this._e|0},u.prototype._hash=function(){var v=l.allocUnsafe(20);return v.writeInt32BE(0|this._a,0),v.writeInt32BE(0|this._b,4),v.writeInt32BE(0|this._c,8),v.writeInt32BE(0|this._d,12),v.writeInt32BE(0|this._e,16),v},a.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],501:[function(e,a,n){var o=e("inherits"),s=e("./sha256"),l=e("./hash"),c=e("safe-buffer").Buffer,i=new Array(64);function u(){this.init(),this._w=i,l.call(this,64,56)}o(u,s),u.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},u.prototype._hash=function(){var p=c.allocUnsafe(28);return p.writeInt32BE(this._a,0),p.writeInt32BE(this._b,4),p.writeInt32BE(this._c,8),p.writeInt32BE(this._d,12),p.writeInt32BE(this._e,16),p.writeInt32BE(this._f,20),p.writeInt32BE(this._g,24),p},a.exports=u},{"./hash":497,"./sha256":502,inherits:440,"safe-buffer":494}],502:[function(e,a,n){var o=e("inherits"),s=e("./hash"),l=e("safe-buffer").Buffer,c=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],i=new Array(64);function u(){this.init(),this._w=i,s.call(this,64,56)}function p(g,x,y){return y^g&(x^y)}function f(g,x,y){return g&x|y&(g|x)}function h(g){return(g>>>2|g<<30)^(g>>>13|g<<19)^(g>>>22|g<<10)}function v(g){return(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7)}function b(g){return(g>>>7|g<<25)^(g>>>18|g<<14)^g>>>3}o(u,s),u.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},u.prototype._update=function(g){for(var x,y=this._w,E=0|this._a,N=0|this._b,I=0|this._c,P=0|this._d,V=0|this._e,U=0|this._f,H=0|this._g,G=0|this._h,Z=0;Z<16;++Z)y[Z]=g.readInt32BE(4*Z);for(;Z<64;++Z)y[Z]=0|(((x=y[Z-2])>>>17|x<<15)^(x>>>19|x<<13)^x>>>10)+y[Z-7]+b(y[Z-15])+y[Z-16];for(var W=0;W<64;++W){var O=G+v(V)+p(V,U,H)+c[W]+y[W]|0,R=h(E)+f(E,N,I)|0;G=H,H=U,U=V,V=P+O|0,P=I,I=N,N=E,E=O+R|0}this._a=E+this._a|0,this._b=N+this._b|0,this._c=I+this._c|0,this._d=P+this._d|0,this._e=V+this._e|0,this._f=U+this._f|0,this._g=H+this._g|0,this._h=G+this._h|0},u.prototype._hash=function(){var g=l.allocUnsafe(32);return g.writeInt32BE(this._a,0),g.writeInt32BE(this._b,4),g.writeInt32BE(this._c,8),g.writeInt32BE(this._d,12),g.writeInt32BE(this._e,16),g.writeInt32BE(this._f,20),g.writeInt32BE(this._g,24),g.writeInt32BE(this._h,28),g},a.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],503:[function(e,a,n){var o=e("inherits"),s=e("./sha512"),l=e("./hash"),c=e("safe-buffer").Buffer,i=new Array(160);function u(){this.init(),this._w=i,l.call(this,128,112)}o(u,s),u.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},u.prototype._hash=function(){var p=c.allocUnsafe(48);function f(h,v,b){p.writeInt32BE(h,b),p.writeInt32BE(v,b+4)}return f(this._ah,this._al,0),f(this._bh,this._bl,8),f(this._ch,this._cl,16),f(this._dh,this._dl,24),f(this._eh,this._el,32),f(this._fh,this._fl,40),p},a.exports=u},{"./hash":497,"./sha512":504,inherits:440,"safe-buffer":494}],504:[function(e,a,n){var o=e("inherits"),s=e("./hash"),l=e("safe-buffer").Buffer,c=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],i=new Array(160);function u(){this.init(),this._w=i,s.call(this,128,112)}function p(N,I,P){return P^N&(I^P)}function f(N,I,P){return N&I|P&(N|I)}function h(N,I){return(N>>>28|I<<4)^(I>>>2|N<<30)^(I>>>7|N<<25)}function v(N,I){return(N>>>14|I<<18)^(N>>>18|I<<14)^(I>>>9|N<<23)}function b(N,I){return(N>>>1|I<<31)^(N>>>8|I<<24)^N>>>7}function g(N,I){return(N>>>1|I<<31)^(N>>>8|I<<24)^(N>>>7|I<<25)}function x(N,I){return(N>>>19|I<<13)^(I>>>29|N<<3)^N>>>6}function y(N,I){return(N>>>19|I<<13)^(I>>>29|N<<3)^(N>>>6|I<<26)}function E(N,I){return N>>>0<I>>>0?1:0}o(u,s),u.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},u.prototype._update=function(N){for(var I=this._w,P=0|this._ah,V=0|this._bh,U=0|this._ch,H=0|this._dh,G=0|this._eh,Z=0|this._fh,W=0|this._gh,O=0|this._hh,R=0|this._al,C=0|this._bl,_=0|this._cl,k=0|this._dl,A=0|this._el,T=0|this._fl,D=0|this._gl,B=0|this._hl,F=0;F<32;F+=2)I[F]=N.readInt32BE(4*F),I[F+1]=N.readInt32BE(4*F+4);for(;F<160;F+=2){var Y=I[F-30],X=I[F-30+1],re=b(Y,X),z=g(X,Y),ee=x(Y=I[F-4],X=I[F-4+1]),L=y(X,Y),M=I[F-14],K=I[F-14+1],se=I[F-32],te=I[F-32+1],ae=z+K|0,Q=re+M+E(ae,z)|0;Q=(Q=Q+ee+E(ae=ae+L|0,L)|0)+se+E(ae=ae+te|0,te)|0,I[F]=Q,I[F+1]=ae}for(var fe=0;fe<160;fe+=2){Q=I[fe],ae=I[fe+1];var le=f(P,V,U),ne=f(R,C,_),ue=h(P,R),he=h(R,P),ke=v(G,A),pe=v(A,G),Ce=c[fe],Me=c[fe+1],Ie=p(G,Z,W),Ye=p(A,T,D),at=B+pe|0,rt=O+ke+E(at,B)|0;rt=(rt=(rt=rt+Ie+E(at=at+Ye|0,Ye)|0)+Ce+E(at=at+Me|0,Me)|0)+Q+E(at=at+ae|0,ae)|0;var it=he+ne|0,et=ue+le+E(it,he)|0;O=W,B=D,W=Z,D=T,Z=G,T=A,G=H+rt+E(A=k+at|0,k)|0,H=U,k=_,U=V,_=C,V=P,C=R,P=rt+et+E(R=at+it|0,at)|0}this._al=this._al+R|0,this._bl=this._bl+C|0,this._cl=this._cl+_|0,this._dl=this._dl+k|0,this._el=this._el+A|0,this._fl=this._fl+T|0,this._gl=this._gl+D|0,this._hl=this._hl+B|0,this._ah=this._ah+P+E(this._al,R)|0,this._bh=this._bh+V+E(this._bl,C)|0,this._ch=this._ch+U+E(this._cl,_)|0,this._dh=this._dh+H+E(this._dl,k)|0,this._eh=this._eh+G+E(this._el,A)|0,this._fh=this._fh+Z+E(this._fl,T)|0,this._gh=this._gh+W+E(this._gl,D)|0,this._hh=this._hh+O+E(this._hl,B)|0},u.prototype._hash=function(){var N=l.allocUnsafe(64);function I(P,V,U){N.writeInt32BE(P,U),N.writeInt32BE(V,U+4)}return I(this._ah,this._al,0),I(this._bh,this._bl,8),I(this._ch,this._cl,16),I(this._dh,this._dl,24),I(this._eh,this._el,32),I(this._fh,this._fl,40),I(this._gh,this._gl,48),I(this._hh,this._hl,56),N},a.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],505:[function(e,a,n){a.exports=s;var o=e("events").EventEmitter;function s(){o.call(this)}e("inherits")(s,o),s.Readable=e("readable-stream/readable.js"),s.Writable=e("readable-stream/writable.js"),s.Duplex=e("readable-stream/duplex.js"),s.Transform=e("readable-stream/transform.js"),s.PassThrough=e("readable-stream/passthrough.js"),s.Stream=s,s.prototype.pipe=function(l,c){var i=this;function u(x){l.writable&&l.write(x)===!1&&i.pause&&i.pause()}function p(){i.readable&&i.resume&&i.resume()}i.on("data",u),l.on("drain",p),l._isStdio||c&&c.end===!1||(i.on("end",h),i.on("close",v));var f=!1;function h(){f||(f=!0,l.end())}function v(){f||(f=!0,typeof l.destroy=="function"&&l.destroy())}function b(x){if(g(),o.listenerCount(this,"error")===0)throw x}function g(){i.removeListener("data",u),l.removeListener("drain",p),i.removeListener("end",h),i.removeListener("close",v),i.removeListener("error",b),l.removeListener("error",b),i.removeListener("end",g),i.removeListener("close",g),l.removeListener("close",g)}return i.on("error",b),l.on("error",b),i.on("end",g),i.on("close",g),l.on("close",g),l.emit("pipe",i),l}},{events:422,inherits:440,"readable-stream/duplex.js":507,"readable-stream/passthrough.js":516,"readable-stream/readable.js":517,"readable-stream/transform.js":518,"readable-stream/writable.js":519}],506:[function(e,a,n){var o={}.toString;a.exports=Array.isArray||function(s){return o.call(s)=="[object Array]"}},{}],507:[function(e,a,n){a.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":508}],508:[function(e,a,n){var o=e("process-nextick-args"),s=Object.keys||function(g){var x=[];for(var y in g)x.push(y);return x};a.exports=h;var l=Object.create(e("core-util-is"));l.inherits=e("inherits");var c=e("./_stream_readable"),i=e("./_stream_writable");l.inherits(h,c);for(var u=s(i.prototype),p=0;p<u.length;p++){var f=u[p];h.prototype[f]||(h.prototype[f]=i.prototype[f])}function h(g){if(!(this instanceof h))return new h(g);c.call(this,g),i.call(this,g),g&&g.readable===!1&&(this.readable=!1),g&&g.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,g&&g.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",v)}function v(){this.allowHalfOpen||this._writableState.ended||o.nextTick(b,this)}function b(g){g.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(g){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=g,this._writableState.destroyed=g)}}),h.prototype._destroy=function(g,x){this.push(null),this.end(),o.nextTick(x,g)}},{"./_stream_readable":510,"./_stream_writable":512,"core-util-is":383,inherits:440,"process-nextick-args":466}],509:[function(e,a,n){a.exports=l;var o=e("./_stream_transform"),s=Object.create(e("core-util-is"));function l(c){if(!(this instanceof l))return new l(c);o.call(this,c)}s.inherits=e("inherits"),s.inherits(l,o),l.prototype._transform=function(c,i,u){u(null,c)}},{"./_stream_transform":511,"core-util-is":383,inherits:440}],510:[function(e,a,n){(function(o,s){(function(){var l=e("process-nextick-args");a.exports=P;var c,i=e("isarray");P.ReadableState=I,e("events").EventEmitter;var u=function(B,F){return B.listeners(F).length},p=e("./internal/streams/stream"),f=e("safe-buffer").Buffer,h=(s!==void 0?s:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},v=Object.create(e("core-util-is"));v.inherits=e("inherits");var b=e("util"),g=void 0;g=b&&b.debuglog?b.debuglog("stream"):function(){};var x,y=e("./internal/streams/BufferList"),E=e("./internal/streams/destroy");v.inherits(P,p);var N=["error","close","destroy","pause","resume"];function I(B,F){B=B||{};var Y=F instanceof(c=c||e("./_stream_duplex"));this.objectMode=!!B.objectMode,Y&&(this.objectMode=this.objectMode||!!B.readableObjectMode);var X=B.highWaterMark,re=B.readableHighWaterMark,z=this.objectMode?16:16384;this.highWaterMark=X||X===0?X:Y&&(re||re===0)?re:z,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=B.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,B.encoding&&(x||(x=e("string_decoder/").StringDecoder),this.decoder=new x(B.encoding),this.encoding=B.encoding)}function P(B){if(c=c||e("./_stream_duplex"),!(this instanceof P))return new P(B);this._readableState=new I(B,this),this.readable=!0,B&&(typeof B.read=="function"&&(this._read=B.read),typeof B.destroy=="function"&&(this._destroy=B.destroy)),p.call(this)}function V(B,F,Y,X,re){var z,ee=B._readableState;return F===null?(ee.reading=!1,function(L,M){if(!M.ended){if(M.decoder){var K=M.decoder.end();K&&K.length&&(M.buffer.push(K),M.length+=M.objectMode?1:K.length)}M.ended=!0,G(L)}}(B,ee)):(re||(z=function(L,M){var K;se=M,f.isBuffer(se)||se instanceof h||typeof M=="string"||M===void 0||L.objectMode||(K=new TypeError("Invalid non-string/buffer chunk"));var se;return K}(ee,F)),z?B.emit("error",z):ee.objectMode||F&&F.length>0?(typeof F=="string"||ee.objectMode||Object.getPrototypeOf(F)===f.prototype||(F=function(L){return f.from(L)}(F)),X?ee.endEmitted?B.emit("error",new Error("stream.unshift() after end event")):U(B,ee,F,!0):ee.ended?B.emit("error",new Error("stream.push() after EOF")):(ee.reading=!1,ee.decoder&&!Y?(F=ee.decoder.write(F),ee.objectMode||F.length!==0?U(B,ee,F,!1):W(B,ee)):U(B,ee,F,!1))):X||(ee.reading=!1)),function(L){return!L.ended&&(L.needReadable||L.length<L.highWaterMark||L.length===0)}(ee)}function U(B,F,Y,X){F.flowing&&F.length===0&&!F.sync?(B.emit("data",Y),B.read(0)):(F.length+=F.objectMode?1:Y.length,X?F.buffer.unshift(Y):F.buffer.push(Y),F.needReadable&&G(B)),W(B,F)}Object.defineProperty(P.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(B){this._readableState&&(this._readableState.destroyed=B)}}),P.prototype.destroy=E.destroy,P.prototype._undestroy=E.undestroy,P.prototype._destroy=function(B,F){this.push(null),F(B)},P.prototype.push=function(B,F){var Y,X=this._readableState;return X.objectMode?Y=!0:typeof B=="string"&&((F=F||X.defaultEncoding)!==X.encoding&&(B=f.from(B,F),F=""),Y=!0),V(this,B,F,!1,Y)},P.prototype.unshift=function(B){return V(this,B,null,!0,!1)},P.prototype.isPaused=function(){return this._readableState.flowing===!1},P.prototype.setEncoding=function(B){return x||(x=e("string_decoder/").StringDecoder),this._readableState.decoder=new x(B),this._readableState.encoding=B,this};function H(B,F){return B<=0||F.length===0&&F.ended?0:F.objectMode?1:B!=B?F.flowing&&F.length?F.buffer.head.data.length:F.length:(B>F.highWaterMark&&(F.highWaterMark=function(Y){return Y>=8388608?Y=8388608:(Y--,Y|=Y>>>1,Y|=Y>>>2,Y|=Y>>>4,Y|=Y>>>8,Y|=Y>>>16,Y++),Y}(B)),B<=F.length?B:F.ended?F.length:(F.needReadable=!0,0))}function G(B){var F=B._readableState;F.needReadable=!1,F.emittedReadable||(g("emitReadable",F.flowing),F.emittedReadable=!0,F.sync?l.nextTick(Z,B):Z(B))}function Z(B){g("emit readable"),B.emit("readable"),_(B)}function W(B,F){F.readingMore||(F.readingMore=!0,l.nextTick(O,B,F))}function O(B,F){for(var Y=F.length;!F.reading&&!F.flowing&&!F.ended&&F.length<F.highWaterMark&&(g("maybeReadMore read 0"),B.read(0),Y!==F.length);)Y=F.length;F.readingMore=!1}function R(B){g("readable nexttick read 0"),B.read(0)}function C(B,F){F.reading||(g("resume read 0"),B.read(0)),F.resumeScheduled=!1,F.awaitDrain=0,B.emit("resume"),_(B),F.flowing&&!F.reading&&B.read(0)}function _(B){var F=B._readableState;for(g("flow",F.flowing);F.flowing&&B.read()!==null;);}function k(B,F){return F.length===0?null:(F.objectMode?Y=F.buffer.shift():!B||B>=F.length?(Y=F.decoder?F.buffer.join(""):F.buffer.length===1?F.buffer.head.data:F.buffer.concat(F.length),F.buffer.clear()):Y=function(X,re,z){var ee;return X<re.head.data.length?(ee=re.head.data.slice(0,X),re.head.data=re.head.data.slice(X)):ee=X===re.head.data.length?re.shift():z?function(L,M){var K=M.head,se=1,te=K.data;for(L-=te.length;K=K.next;){var ae=K.data,Q=L>ae.length?ae.length:L;if(Q===ae.length?te+=ae:te+=ae.slice(0,L),(L-=Q)===0){Q===ae.length?(++se,K.next?M.head=K.next:M.head=M.tail=null):(M.head=K,K.data=ae.slice(Q));break}++se}return M.length-=se,te}(X,re):function(L,M){var K=f.allocUnsafe(L),se=M.head,te=1;for(se.data.copy(K),L-=se.data.length;se=se.next;){var ae=se.data,Q=L>ae.length?ae.length:L;if(ae.copy(K,K.length-L,0,Q),(L-=Q)===0){Q===ae.length?(++te,se.next?M.head=se.next:M.head=M.tail=null):(M.head=se,se.data=ae.slice(Q));break}++te}return M.length-=te,K}(X,re),ee}(B,F.buffer,F.decoder),Y);var Y}function A(B){var F=B._readableState;if(F.length>0)throw new Error('"endReadable()" called on non-empty stream');F.endEmitted||(F.ended=!0,l.nextTick(T,F,B))}function T(B,F){B.endEmitted||B.length!==0||(B.endEmitted=!0,F.readable=!1,F.emit("end"))}function D(B,F){for(var Y=0,X=B.length;Y<X;Y++)if(B[Y]===F)return Y;return-1}P.prototype.read=function(B){g("read",B),B=parseInt(B,10);var F=this._readableState,Y=B;if(B!==0&&(F.emittedReadable=!1),B===0&&F.needReadable&&(F.length>=F.highWaterMark||F.ended))return g("read: emitReadable",F.length,F.ended),F.length===0&&F.ended?A(this):G(this),null;if((B=H(B,F))===0&&F.ended)return F.length===0&&A(this),null;var X,re=F.needReadable;return g("need readable",re),(F.length===0||F.length-B<F.highWaterMark)&&g("length less than watermark",re=!0),F.ended||F.reading?g("reading or ended",re=!1):re&&(g("do read"),F.reading=!0,F.sync=!0,F.length===0&&(F.needReadable=!0),this._read(F.highWaterMark),F.sync=!1,F.reading||(B=H(Y,F))),(X=B>0?k(B,F):null)===null?(F.needReadable=!0,B=0):F.length-=B,F.length===0&&(F.ended||(F.needReadable=!0),Y!==B&&F.ended&&A(this)),X!==null&&this.emit("data",X),X},P.prototype._read=function(B){this.emit("error",new Error("_read() is not implemented"))},P.prototype.pipe=function(B,F){var Y=this,X=this._readableState;switch(X.pipesCount){case 0:X.pipes=B;break;case 1:X.pipes=[X.pipes,B];break;default:X.pipes.push(B)}X.pipesCount+=1,g("pipe count=%d opts=%j",X.pipesCount,F);var re=(!F||F.end!==!1)&&B!==o.stdout&&B!==o.stderr?ee:fe;function z(le,ne){g("onunpipe"),le===Y&&ne&&ne.hasUnpiped===!1&&(ne.hasUnpiped=!0,g("cleanup"),B.removeListener("close",ae),B.removeListener("finish",Q),B.removeListener("drain",L),B.removeListener("error",te),B.removeListener("unpipe",z),Y.removeListener("end",ee),Y.removeListener("end",fe),Y.removeListener("data",se),M=!0,!X.awaitDrain||B._writableState&&!B._writableState.needDrain||L())}function ee(){g("onend"),B.end()}X.endEmitted?l.nextTick(re):Y.once("end",re),B.on("unpipe",z);var L=function(le){return function(){var ne=le._readableState;g("pipeOnDrain",ne.awaitDrain),ne.awaitDrain&&ne.awaitDrain--,ne.awaitDrain===0&&u(le,"data")&&(ne.flowing=!0,_(le))}}(Y);B.on("drain",L);var M=!1,K=!1;function se(le){g("ondata"),K=!1,B.write(le)!==!1||K||((X.pipesCount===1&&X.pipes===B||X.pipesCount>1&&D(X.pipes,B)!==-1)&&!M&&(g("false write response, pause",X.awaitDrain),X.awaitDrain++,K=!0),Y.pause())}function te(le){g("onerror",le),fe(),B.removeListener("error",te),u(B,"error")===0&&B.emit("error",le)}function ae(){B.removeListener("finish",Q),fe()}function Q(){g("onfinish"),B.removeListener("close",ae),fe()}function fe(){g("unpipe"),Y.unpipe(B)}return Y.on("data",se),function(le,ne,ue){if(typeof le.prependListener=="function")return le.prependListener(ne,ue);le._events&&le._events[ne]?i(le._events[ne])?le._events[ne].unshift(ue):le._events[ne]=[ue,le._events[ne]]:le.on(ne,ue)}(B,"error",te),B.once("close",ae),B.once("finish",Q),B.emit("pipe",Y),X.flowing||(g("pipe resume"),Y.resume()),B},P.prototype.unpipe=function(B){var F=this._readableState,Y={hasUnpiped:!1};if(F.pipesCount===0)return this;if(F.pipesCount===1)return B&&B!==F.pipes||(B||(B=F.pipes),F.pipes=null,F.pipesCount=0,F.flowing=!1,B&&B.emit("unpipe",this,Y)),this;if(!B){var X=F.pipes,re=F.pipesCount;F.pipes=null,F.pipesCount=0,F.flowing=!1;for(var z=0;z<re;z++)X[z].emit("unpipe",this,{hasUnpiped:!1});return this}var ee=D(F.pipes,B);return ee===-1||(F.pipes.splice(ee,1),F.pipesCount-=1,F.pipesCount===1&&(F.pipes=F.pipes[0]),B.emit("unpipe",this,Y)),this},P.prototype.on=function(B,F){var Y=p.prototype.on.call(this,B,F);if(B==="data")this._readableState.flowing!==!1&&this.resume();else if(B==="readable"){var X=this._readableState;X.endEmitted||X.readableListening||(X.readableListening=X.needReadable=!0,X.emittedReadable=!1,X.reading?X.length&&G(this):l.nextTick(R,this))}return Y},P.prototype.addListener=P.prototype.on,P.prototype.resume=function(){var B=this._readableState;return B.flowing||(g("resume"),B.flowing=!0,function(F,Y){Y.resumeScheduled||(Y.resumeScheduled=!0,l.nextTick(C,F,Y))}(this,B)),this},P.prototype.pause=function(){return g("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(g("pause"),this._readableState.flowing=!1,this.emit("pause")),this},P.prototype.wrap=function(B){var F=this,Y=this._readableState,X=!1;for(var re in B.on("end",function(){if(g("wrapped end"),Y.decoder&&!Y.ended){var ee=Y.decoder.end();ee&&ee.length&&F.push(ee)}F.push(null)}),B.on("data",function(ee){g("wrapped data"),Y.decoder&&(ee=Y.decoder.write(ee)),Y.objectMode&&ee==null||(Y.objectMode||ee&&ee.length)&&(F.push(ee)||(X=!0,B.pause()))}),B)this[re]===void 0&&typeof B[re]=="function"&&(this[re]=function(ee){return function(){return B[ee].apply(B,arguments)}}(re));for(var z=0;z<N.length;z++)B.on(N[z],this.emit.bind(this,N[z]));return this._read=function(ee){g("wrapped _read",ee),X&&(X=!1,B.resume())},this},Object.defineProperty(P.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),P._fromList=k}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"./_stream_duplex":508,"./internal/streams/BufferList":513,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,events:422,inherits:440,isarray:506,"process-nextick-args":466,"safe-buffer":520,"string_decoder/":521,util:188}],511:[function(e,a,n){a.exports=c;var o=e("./_stream_duplex"),s=Object.create(e("core-util-is"));function l(p,f){var h=this._transformState;h.transforming=!1;var v=h.writecb;if(!v)return this.emit("error",new Error("write callback called multiple times"));h.writechunk=null,h.writecb=null,f!=null&&this.push(f),v(p);var b=this._readableState;b.reading=!1,(b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}function c(p){if(!(this instanceof c))return new c(p);o.call(this,p),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,p&&(typeof p.transform=="function"&&(this._transform=p.transform),typeof p.flush=="function"&&(this._flush=p.flush)),this.on("prefinish",i)}function i(){var p=this;typeof this._flush=="function"?this._flush(function(f,h){u(p,f,h)}):u(this,null,null)}function u(p,f,h){if(f)return p.emit("error",f);if(h!=null&&p.push(h),p._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(p._transformState.transforming)throw new Error("Calling transform done when still transforming");return p.push(null)}s.inherits=e("inherits"),s.inherits(c,o),c.prototype.push=function(p,f){return this._transformState.needTransform=!1,o.prototype.push.call(this,p,f)},c.prototype._transform=function(p,f,h){throw new Error("_transform() is not implemented")},c.prototype._write=function(p,f,h){var v=this._transformState;if(v.writecb=h,v.writechunk=p,v.writeencoding=f,!v.transforming){var b=this._readableState;(v.needTransform||b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}},c.prototype._read=function(p){var f=this._transformState;f.writechunk!==null&&f.writecb&&!f.transforming?(f.transforming=!0,this._transform(f.writechunk,f.writeencoding,f.afterTransform)):f.needTransform=!0},c.prototype._destroy=function(p,f){var h=this;o.prototype._destroy.call(this,p,function(v){f(v),h.emit("close")})}},{"./_stream_duplex":508,"core-util-is":383,inherits:440}],512:[function(e,a,n){(function(o,s,l){(function(){var c=e("process-nextick-args");function i(W){var O=this;this.next=null,this.entry=null,this.finish=function(){(function(R,C,_){var k=R.entry;for(R.entry=null;k;){var A=k.callback;C.pendingcb--,A(_),k=k.next}C.corkedRequestsFree.next=R})(O,W)}}a.exports=I;var u,p=!o.browser&&["v0.10","v0.9."].indexOf(o.version.slice(0,5))>-1?l:c.nextTick;I.WritableState=N;var f=Object.create(e("core-util-is"));f.inherits=e("inherits");var h={deprecate:e("util-deprecate")},v=e("./internal/streams/stream"),b=e("safe-buffer").Buffer,g=(s!==void 0?s:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},x,y=e("./internal/streams/destroy");function E(){}function N(W,O){u=u||e("./_stream_duplex"),W=W||{};var R=O instanceof u;this.objectMode=!!W.objectMode,R&&(this.objectMode=this.objectMode||!!W.writableObjectMode);var C=W.highWaterMark,_=W.writableHighWaterMark,k=this.objectMode?16:16384;this.highWaterMark=C||C===0?C:R&&(_||_===0)?_:k,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var A=W.decodeStrings===!1;this.decodeStrings=!A,this.defaultEncoding=W.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(T){(function(D,B){var F=D._writableState,Y=F.sync,X=F.writecb;if(function(z){z.writing=!1,z.writecb=null,z.length-=z.writelen,z.writelen=0}(F),B)(function(z,ee,L,M,K){--ee.pendingcb,L?(c.nextTick(K,M),c.nextTick(Z,z,ee),z._writableState.errorEmitted=!0,z.emit("error",M)):(K(M),z._writableState.errorEmitted=!0,z.emit("error",M),Z(z,ee))})(D,F,Y,B,X);else{var re=H(F);re||F.corked||F.bufferProcessing||!F.bufferedRequest||U(D,F),Y?p(V,D,F,re,X):V(D,F,re,X)}})(O,T)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function I(W){if(u=u||e("./_stream_duplex"),!(x.call(I,this)||this instanceof u))return new I(W);this._writableState=new N(W,this),this.writable=!0,W&&(typeof W.write=="function"&&(this._write=W.write),typeof W.writev=="function"&&(this._writev=W.writev),typeof W.destroy=="function"&&(this._destroy=W.destroy),typeof W.final=="function"&&(this._final=W.final)),v.call(this)}function P(W,O,R,C,_,k,A){O.writelen=C,O.writecb=A,O.writing=!0,O.sync=!0,R?W._writev(_,O.onwrite):W._write(_,k,O.onwrite),O.sync=!1}function V(W,O,R,C){R||function(_,k){k.length===0&&k.needDrain&&(k.needDrain=!1,_.emit("drain"))}(W,O),O.pendingcb--,C(),Z(W,O)}function U(W,O){O.bufferProcessing=!0;var R=O.bufferedRequest;if(W._writev&&R&&R.next){var C=O.bufferedRequestCount,_=new Array(C),k=O.corkedRequestsFree;k.entry=R;for(var A=0,T=!0;R;)_[A]=R,R.isBuf||(T=!1),R=R.next,A+=1;_.allBuffers=T,P(W,O,!0,O.length,_,"",k.finish),O.pendingcb++,O.lastBufferedRequest=null,k.next?(O.corkedRequestsFree=k.next,k.next=null):O.corkedRequestsFree=new i(O),O.bufferedRequestCount=0}else{for(;R;){var D=R.chunk,B=R.encoding,F=R.callback;if(P(W,O,!1,O.objectMode?1:D.length,D,B,F),R=R.next,O.bufferedRequestCount--,O.writing)break}R===null&&(O.lastBufferedRequest=null)}O.bufferedRequest=R,O.bufferProcessing=!1}function H(W){return W.ending&&W.length===0&&W.bufferedRequest===null&&!W.finished&&!W.writing}function G(W,O){W._final(function(R){O.pendingcb--,R&&W.emit("error",R),O.prefinished=!0,W.emit("prefinish"),Z(W,O)})}function Z(W,O){var R=H(O);return R&&(function(C,_){_.prefinished||_.finalCalled||(typeof C._final=="function"?(_.pendingcb++,_.finalCalled=!0,c.nextTick(G,C,_)):(_.prefinished=!0,C.emit("prefinish")))}(W,O),O.pendingcb===0&&(O.finished=!0,W.emit("finish"))),R}f.inherits(I,v),N.prototype.getBuffer=function(){for(var W=this.bufferedRequest,O=[];W;)O.push(W),W=W.next;return O},function(){try{Object.defineProperty(N.prototype,"buffer",{get:h.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(x=Function.prototype[Symbol.hasInstance],Object.defineProperty(I,Symbol.hasInstance,{value:function(W){return!!x.call(this,W)||this===I&&W&&W._writableState instanceof N}})):x=function(W){return W instanceof this},I.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},I.prototype.write=function(W,O,R){var C,_=this._writableState,k=!1,A=!_.objectMode&&(C=W,b.isBuffer(C)||C instanceof g);return A&&!b.isBuffer(W)&&(W=function(T){return b.from(T)}(W)),typeof O=="function"&&(R=O,O=null),A?O="buffer":O||(O=_.defaultEncoding),typeof R!="function"&&(R=E),_.ended?function(T,D){var B=new Error("write after end");T.emit("error",B),c.nextTick(D,B)}(this,R):(A||function(T,D,B,F){var Y=!0,X=!1;return B===null?X=new TypeError("May not write null values to stream"):typeof B=="string"||B===void 0||D.objectMode||(X=new TypeError("Invalid non-string/buffer chunk")),X&&(T.emit("error",X),c.nextTick(F,X),Y=!1),Y}(this,_,W,R))&&(_.pendingcb++,k=function(T,D,B,F,Y,X){if(!B){var re=function(M,K,se){return M.objectMode||M.decodeStrings===!1||typeof K!="string"||(K=b.from(K,se)),K}(D,F,Y);F!==re&&(B=!0,Y="buffer",F=re)}var z=D.objectMode?1:F.length;D.length+=z;var ee=D.length<D.highWaterMark;if(ee||(D.needDrain=!0),D.writing||D.corked){var L=D.lastBufferedRequest;D.lastBufferedRequest={chunk:F,encoding:Y,isBuf:B,callback:X,next:null},L?L.next=D.lastBufferedRequest:D.bufferedRequest=D.lastBufferedRequest,D.bufferedRequestCount+=1}else P(T,D,!1,z,F,Y,X);return ee}(this,_,A,W,O,R)),k},I.prototype.cork=function(){this._writableState.corked++},I.prototype.uncork=function(){var W=this._writableState;W.corked&&(W.corked--,W.writing||W.corked||W.bufferProcessing||!W.bufferedRequest||U(this,W))},I.prototype.setDefaultEncoding=function(W){if(typeof W=="string"&&(W=W.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((W+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+W);return this._writableState.defaultEncoding=W,this},Object.defineProperty(I.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),I.prototype._write=function(W,O,R){R(new Error("_write() is not implemented"))},I.prototype._writev=null,I.prototype.end=function(W,O,R){var C=this._writableState;typeof W=="function"?(R=W,W=null,O=null):typeof O=="function"&&(R=O,O=null),W!=null&&this.write(W,O),C.corked&&(C.corked=1,this.uncork()),C.ending||function(_,k,A){k.ending=!0,Z(_,k),A&&(k.finished?c.nextTick(A):_.once("finish",A)),k.ended=!0,_.writable=!1}(this,C,R)},Object.defineProperty(I.prototype,"destroyed",{get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(W){this._writableState&&(this._writableState.destroyed=W)}}),I.prototype.destroy=y.destroy,I.prototype._undestroy=y.undestroy,I.prototype._destroy=function(W,O){this.end(),O(W)}}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{},e("timers").setImmediate)},{"./_stream_duplex":508,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,inherits:440,"process-nextick-args":466,"safe-buffer":520,timers:523,"util-deprecate":524}],513:[function(e,a,n){var o=e("safe-buffer").Buffer,s=e("util");a.exports=function(){function l(){(function(c,i){if(!(c instanceof i))throw new TypeError("Cannot call a class as a function")})(this,l),this.head=null,this.tail=null,this.length=0}return l.prototype.push=function(c){var i={data:c,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length},l.prototype.unshift=function(c){var i={data:c,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length},l.prototype.shift=function(){if(this.length!==0){var c=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,c}},l.prototype.clear=function(){this.head=this.tail=null,this.length=0},l.prototype.join=function(c){if(this.length===0)return"";for(var i=this.head,u=""+i.data;i=i.next;)u+=c+i.data;return u},l.prototype.concat=function(c){if(this.length===0)return o.alloc(0);for(var i,u,p,f=o.allocUnsafe(c>>>0),h=this.head,v=0;h;)i=h.data,u=f,p=v,i.copy(u,p),v+=h.data.length,h=h.next;return f},l}(),s&&s.inspect&&s.inspect.custom&&(a.exports.prototype[s.inspect.custom]=function(){var l=s.inspect({length:this.length});return this.constructor.name+" "+l})},{"safe-buffer":520,util:188}],514:[function(e,a,n){var o=e("process-nextick-args");function s(l,c){l.emit("error",c)}a.exports={destroy:function(l,c){var i=this,u=this._readableState&&this._readableState.destroyed,p=this._writableState&&this._writableState.destroyed;return u||p?(c?c(l):l&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,o.nextTick(s,this,l)):o.nextTick(s,this,l)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(l||null,function(f){!c&&f?i._writableState?i._writableState.errorEmitted||(i._writableState.errorEmitted=!0,o.nextTick(s,i,f)):o.nextTick(s,i,f):c&&c(f)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":466}],515:[function(e,a,n){arguments[4][490][0].apply(n,arguments)},{dup:490,events:422}],516:[function(e,a,n){a.exports=e("./readable").PassThrough},{"./readable":517}],517:[function(e,a,n){(n=a.exports=e("./lib/_stream_readable.js")).Stream=n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":508,"./lib/_stream_passthrough.js":509,"./lib/_stream_readable.js":510,"./lib/_stream_transform.js":511,"./lib/_stream_writable.js":512}],518:[function(e,a,n){a.exports=e("./readable").Transform},{"./readable":517}],519:[function(e,a,n){a.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":512}],520:[function(e,a,n){arguments[4][217][0].apply(n,arguments)},{buffer:220,dup:217}],521:[function(e,a,n){arguments[4][218][0].apply(n,arguments)},{dup:218,"safe-buffer":520}],522:[function(e,a,n){arguments[4][218][0].apply(n,arguments)},{dup:218,"safe-buffer":494}],523:[function(e,a,n){(function(o,s){(function(){var l=e("process/browser.js").nextTick,c=Function.prototype.apply,i=Array.prototype.slice,u={},p=0;function f(h,v){this._id=h,this._clearFn=v}n.setTimeout=function(){return new f(c.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new f(c.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(h){h.close()},f.prototype.unref=f.prototype.ref=function(){},f.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(h,v){clearTimeout(h._idleTimeoutId),h._idleTimeout=v},n.unenroll=function(h){clearTimeout(h._idleTimeoutId),h._idleTimeout=-1},n._unrefActive=n.active=function(h){clearTimeout(h._idleTimeoutId);var v=h._idleTimeout;v>=0&&(h._idleTimeoutId=setTimeout(function(){h._onTimeout&&h._onTimeout()},v))},n.setImmediate=typeof o=="function"?o:function(h){var v=p++,b=!(arguments.length<2)&&i.call(arguments,1);return u[v]=!0,l(function(){u[v]&&(b?h.apply(null,b):h.call(null),n.clearImmediate(v))}),v},n.clearImmediate=typeof s=="function"?s:function(h){delete u[h]}}).call(this)}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":467,timers:523}],524:[function(e,a,n){(function(o){(function(){function s(l){try{if(!o.localStorage)return!1}catch{return!1}var c=o.localStorage[l];return c!=null&&String(c).toLowerCase()==="true"}a.exports=function(l,c){if(s("noDeprecation"))return l;var i=!1;return function(){if(!i){if(s("throwDeprecation"))throw new Error(c);s("traceDeprecation")?console.trace(c):console.warn(c),i=!0}return l.apply(this,arguments)}}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],525:[function(e,a,n){typeof Object.create=="function"?a.exports=function(o,s){o.super_=s,o.prototype=Object.create(s.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function(o,s){o.super_=s;var l=function(){};l.prototype=s.prototype,o.prototype=new l,o.prototype.constructor=o}},{}],526:[function(e,a,n){a.exports=function(o){return o&&typeof o=="object"&&typeof o.copy=="function"&&typeof o.fill=="function"&&typeof o.readUInt8=="function"}},{}],527:[function(e,a,n){(function(o,s){(function(){var l=/%[sdj%]/g;n.format=function(_){if(!N(_)){for(var k=[],A=0;A<arguments.length;A++)k.push(u(arguments[A]));return k.join(" ")}A=1;for(var T=arguments,D=T.length,B=String(_).replace(l,function(Y){if(Y==="%%")return"%";if(A>=D)return Y;switch(Y){case"%s":return String(T[A++]);case"%d":return Number(T[A++]);case"%j":try{return JSON.stringify(T[A++])}catch{return"[Circular]"}default:return Y}}),F=T[A];A<D;F=T[++A])y(F)||!V(F)?B+=" "+F:B+=" "+u(F);return B},n.deprecate=function(_,k){if(I(s.process))return function(){return n.deprecate(_,k).apply(this,arguments)};if(o.noDeprecation===!0)return _;var A=!1;return function(){if(!A){if(o.throwDeprecation)throw new Error(k);o.traceDeprecation?console.trace(k):console.error(k),A=!0}return _.apply(this,arguments)}};var c,i={};function u(_,k){var A={seen:[],stylize:f};return arguments.length>=3&&(A.depth=arguments[2]),arguments.length>=4&&(A.colors=arguments[3]),x(k)?A.showHidden=k:k&&n._extend(A,k),I(A.showHidden)&&(A.showHidden=!1),I(A.depth)&&(A.depth=2),I(A.colors)&&(A.colors=!1),I(A.customInspect)&&(A.customInspect=!0),A.colors&&(A.stylize=p),h(A,_,A.depth)}function p(_,k){var A=u.styles[k];return A?"\x1B["+u.colors[A][0]+"m"+_+"\x1B["+u.colors[A][1]+"m":_}function f(_,k){return _}function h(_,k,A){if(_.customInspect&&k&&G(k.inspect)&&k.inspect!==n.inspect&&(!k.constructor||k.constructor.prototype!==k)){var T=k.inspect(A,_);return N(T)||(T=h(_,T,A)),T}var D=function(L,M){if(I(M))return L.stylize("undefined","undefined");if(N(M)){var K="'"+JSON.stringify(M).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return L.stylize(K,"string")}if(E(M))return L.stylize(""+M,"number");if(x(M))return L.stylize(""+M,"boolean");if(y(M))return L.stylize("null","null")}(_,k);if(D)return D;var B=Object.keys(k),F=function(L){var M={};return L.forEach(function(K,se){M[K]=!0}),M}(B);if(_.showHidden&&(B=Object.getOwnPropertyNames(k)),H(k)&&(B.indexOf("message")>=0||B.indexOf("description")>=0))return v(k);if(B.length===0){if(G(k)){var Y=k.name?": "+k.name:"";return _.stylize("[Function"+Y+"]","special")}if(P(k))return _.stylize(RegExp.prototype.toString.call(k),"regexp");if(U(k))return _.stylize(Date.prototype.toString.call(k),"date");if(H(k))return v(k)}var X,re="",z=!1,ee=["{","}"];return g(k)&&(z=!0,ee=["[","]"]),G(k)&&(re=" [Function"+(k.name?": "+k.name:"")+"]"),P(k)&&(re=" "+RegExp.prototype.toString.call(k)),U(k)&&(re=" "+Date.prototype.toUTCString.call(k)),H(k)&&(re=" "+v(k)),B.length!==0||z&&k.length!=0?A<0?P(k)?_.stylize(RegExp.prototype.toString.call(k),"regexp"):_.stylize("[Object]","special"):(_.seen.push(k),X=z?function(L,M,K,se,te){for(var ae=[],Q=0,fe=M.length;Q<fe;++Q)C(M,String(Q))?ae.push(b(L,M,K,se,String(Q),!0)):ae.push("");return te.forEach(function(le){le.match(/^\d+$/)||ae.push(b(L,M,K,se,le,!0))}),ae}(_,k,A,F,B):B.map(function(L){return b(_,k,A,F,L,z)}),_.seen.pop(),function(L,M,K){return L.reduce(function(se,te){return te.indexOf(`
`)>=0,se+te.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?K[0]+(M===""?"":M+`
 `)+" "+L.join(`,
  `)+" "+K[1]:K[0]+M+" "+L.join(", ")+" "+K[1]}(X,re,ee)):ee[0]+re+ee[1]}function v(_){return"["+Error.prototype.toString.call(_)+"]"}function b(_,k,A,T,D,B){var F,Y,X;if((X=Object.getOwnPropertyDescriptor(k,D)||{value:k[D]}).get?Y=X.set?_.stylize("[Getter/Setter]","special"):_.stylize("[Getter]","special"):X.set&&(Y=_.stylize("[Setter]","special")),C(T,D)||(F="["+D+"]"),Y||(_.seen.indexOf(X.value)<0?(Y=y(A)?h(_,X.value,null):h(_,X.value,A-1)).indexOf(`
`)>-1&&(Y=B?Y.split(`
`).map(function(re){return"  "+re}).join(`
`).substr(2):`
`+Y.split(`
`).map(function(re){return"   "+re}).join(`
`)):Y=_.stylize("[Circular]","special")),I(F)){if(B&&D.match(/^\d+$/))return Y;(F=JSON.stringify(""+D)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(F=F.substr(1,F.length-2),F=_.stylize(F,"name")):(F=F.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),F=_.stylize(F,"string"))}return F+": "+Y}function g(_){return Array.isArray(_)}function x(_){return typeof _=="boolean"}function y(_){return _===null}function E(_){return typeof _=="number"}function N(_){return typeof _=="string"}function I(_){return _===void 0}function P(_){return V(_)&&Z(_)==="[object RegExp]"}function V(_){return typeof _=="object"&&_!==null}function U(_){return V(_)&&Z(_)==="[object Date]"}function H(_){return V(_)&&(Z(_)==="[object Error]"||_ instanceof Error)}function G(_){return typeof _=="function"}function Z(_){return Object.prototype.toString.call(_)}function W(_){return _<10?"0"+_.toString(10):_.toString(10)}n.debuglog=function(_){if(I(c)&&(c=o.env.NODE_DEBUG||""),_=_.toUpperCase(),!i[_])if(new RegExp("\\b"+_+"\\b","i").test(c)){var k=o.pid;i[_]=function(){var A=n.format.apply(n,arguments);console.error("%s %d: %s",_,k,A)}}else i[_]=function(){};return i[_]},n.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=g,n.isBoolean=x,n.isNull=y,n.isNullOrUndefined=function(_){return _==null},n.isNumber=E,n.isString=N,n.isSymbol=function(_){return typeof _=="symbol"},n.isUndefined=I,n.isRegExp=P,n.isObject=V,n.isDate=U,n.isError=H,n.isFunction=G,n.isPrimitive=function(_){return _===null||typeof _=="boolean"||typeof _=="number"||typeof _=="string"||typeof _=="symbol"||_===void 0},n.isBuffer=e("./support/isBuffer");var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(){var _=new Date,k=[W(_.getHours()),W(_.getMinutes()),W(_.getSeconds())].join(":");return[_.getDate(),O[_.getMonth()],k].join(" ")}function C(_,k){return Object.prototype.hasOwnProperty.call(_,k)}n.log=function(){console.log("%s - %s",R(),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(_,k){if(!k||!V(k))return _;for(var A=Object.keys(k),T=A.length;T--;)_[A[T]]=k[A[T]];return _}}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":526,_process:467,inherits:525}],528:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"v1",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(n,"v3",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"v4",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(n,"v5",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(n,"NIL",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"version",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(n,"validate",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(n,"stringify",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(n,"parse",{enumerable:!0,get:function(){return h.default}});var o=v(e("./v1.js")),s=v(e("./v3.js")),l=v(e("./v4.js")),c=v(e("./v5.js")),i=v(e("./nil.js")),u=v(e("./version.js")),p=v(e("./validate.js")),f=v(e("./stringify.js")),h=v(e("./parse.js"));function v(b){return b&&b.__esModule?b:{default:b}}},{"./nil.js":530,"./parse.js":531,"./stringify.js":535,"./v1.js":536,"./v3.js":537,"./v4.js":539,"./v5.js":540,"./validate.js":541,"./version.js":542}],529:[function(e,a,n){function o(h){return 14+(h+64>>>9<<4)+1}function s(h,v){const b=(65535&h)+(65535&v);return(h>>16)+(v>>16)+(b>>16)<<16|65535&b}function l(h,v,b,g,x,y){return s((E=s(s(v,h),s(g,y)))<<(N=x)|E>>>32-N,b);var E,N}function c(h,v,b,g,x,y,E){return l(v&b|~v&g,h,v,x,y,E)}function i(h,v,b,g,x,y,E){return l(v&g|b&~g,h,v,x,y,E)}function u(h,v,b,g,x,y,E){return l(v^b^g,h,v,x,y,E)}function p(h,v,b,g,x,y,E){return l(b^(v|~g),h,v,x,y,E)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var f=function(h){if(typeof h=="string"){const v=unescape(encodeURIComponent(h));h=new Uint8Array(v.length);for(let b=0;b<v.length;++b)h[b]=v.charCodeAt(b)}return function(v){const b=[],g=32*v.length;for(let x=0;x<g;x+=8){const y=v[x>>5]>>>x%32&255,E=parseInt("0123456789abcdef".charAt(y>>>4&15)+"0123456789abcdef".charAt(15&y),16);b.push(E)}return b}(function(v,b){v[b>>5]|=128<<b%32,v[o(b)-1]=b;let g=1732584193,x=-271733879,y=-1732584194,E=271733878;for(let N=0;N<v.length;N+=16){const I=g,P=x,V=y,U=E;g=c(g,x,y,E,v[N],7,-680876936),E=c(E,g,x,y,v[N+1],12,-389564586),y=c(y,E,g,x,v[N+2],17,606105819),x=c(x,y,E,g,v[N+3],22,-1044525330),g=c(g,x,y,E,v[N+4],7,-176418897),E=c(E,g,x,y,v[N+5],12,1200080426),y=c(y,E,g,x,v[N+6],17,-1473231341),x=c(x,y,E,g,v[N+7],22,-45705983),g=c(g,x,y,E,v[N+8],7,1770035416),E=c(E,g,x,y,v[N+9],12,-1958414417),y=c(y,E,g,x,v[N+10],17,-42063),x=c(x,y,E,g,v[N+11],22,-1990404162),g=c(g,x,y,E,v[N+12],7,1804603682),E=c(E,g,x,y,v[N+13],12,-40341101),y=c(y,E,g,x,v[N+14],17,-1502002290),x=c(x,y,E,g,v[N+15],22,1236535329),g=i(g,x,y,E,v[N+1],5,-165796510),E=i(E,g,x,y,v[N+6],9,-1069501632),y=i(y,E,g,x,v[N+11],14,643717713),x=i(x,y,E,g,v[N],20,-373897302),g=i(g,x,y,E,v[N+5],5,-701558691),E=i(E,g,x,y,v[N+10],9,38016083),y=i(y,E,g,x,v[N+15],14,-660478335),x=i(x,y,E,g,v[N+4],20,-405537848),g=i(g,x,y,E,v[N+9],5,568446438),E=i(E,g,x,y,v[N+14],9,-1019803690),y=i(y,E,g,x,v[N+3],14,-187363961),x=i(x,y,E,g,v[N+8],20,1163531501),g=i(g,x,y,E,v[N+13],5,-1444681467),E=i(E,g,x,y,v[N+2],9,-51403784),y=i(y,E,g,x,v[N+7],14,1735328473),x=i(x,y,E,g,v[N+12],20,-1926607734),g=u(g,x,y,E,v[N+5],4,-378558),E=u(E,g,x,y,v[N+8],11,-2022574463),y=u(y,E,g,x,v[N+11],16,1839030562),x=u(x,y,E,g,v[N+14],23,-35309556),g=u(g,x,y,E,v[N+1],4,-1530992060),E=u(E,g,x,y,v[N+4],11,1272893353),y=u(y,E,g,x,v[N+7],16,-155497632),x=u(x,y,E,g,v[N+10],23,-1094730640),g=u(g,x,y,E,v[N+13],4,681279174),E=u(E,g,x,y,v[N],11,-358537222),y=u(y,E,g,x,v[N+3],16,-722521979),x=u(x,y,E,g,v[N+6],23,76029189),g=u(g,x,y,E,v[N+9],4,-640364487),E=u(E,g,x,y,v[N+12],11,-421815835),y=u(y,E,g,x,v[N+15],16,530742520),x=u(x,y,E,g,v[N+2],23,-995338651),g=p(g,x,y,E,v[N],6,-198630844),E=p(E,g,x,y,v[N+7],10,1126891415),y=p(y,E,g,x,v[N+14],15,-1416354905),x=p(x,y,E,g,v[N+5],21,-57434055),g=p(g,x,y,E,v[N+12],6,1700485571),E=p(E,g,x,y,v[N+3],10,-1894986606),y=p(y,E,g,x,v[N+10],15,-1051523),x=p(x,y,E,g,v[N+1],21,-2054922799),g=p(g,x,y,E,v[N+8],6,1873313359),E=p(E,g,x,y,v[N+15],10,-30611744),y=p(y,E,g,x,v[N+6],15,-1560198380),x=p(x,y,E,g,v[N+13],21,1309151649),g=p(g,x,y,E,v[N+4],6,-145523070),E=p(E,g,x,y,v[N+11],10,-1120210379),y=p(y,E,g,x,v[N+2],15,718787259),x=p(x,y,E,g,v[N+9],21,-343485551),g=s(g,I),x=s(x,P),y=s(y,V),E=s(E,U)}return[g,x,y,E]}(function(v){if(v.length===0)return[];const b=8*v.length,g=new Uint32Array(o(b));for(let x=0;x<b;x+=8)g[x>>5]|=(255&v[x/8])<<x%32;return g}(h),8*h.length))};n.default=f},{}],530:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,n.default="00000000-0000-0000-0000-000000000000"},{}],531:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o,s=(o=e("./validate.js"))&&o.__esModule?o:{default:o},l=function(c){if(!(0,s.default)(c))throw TypeError("Invalid UUID");let i;const u=new Uint8Array(16);return u[0]=(i=parseInt(c.slice(0,8),16))>>>24,u[1]=i>>>16&255,u[2]=i>>>8&255,u[3]=255&i,u[4]=(i=parseInt(c.slice(9,13),16))>>>8,u[5]=255&i,u[6]=(i=parseInt(c.slice(14,18),16))>>>8,u[7]=255&i,u[8]=(i=parseInt(c.slice(19,23),16))>>>8,u[9]=255&i,u[10]=(i=parseInt(c.slice(24,36),16))/1099511627776&255,u[11]=i/4294967296&255,u[12]=i>>>24&255,u[13]=i>>>16&255,u[14]=i>>>8&255,u[15]=255&i,u};n.default=l},{"./validate.js":541}],532:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,n.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],533:[function(e,a,n){let o;Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){if(!o&&(o=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!o))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(s)};const s=new Uint8Array(16)},{}],534:[function(e,a,n){function o(c,i,u,p){switch(c){case 0:return i&u^~i&p;case 1:return i^u^p;case 2:return i&u^i&p^u&p;case 3:return i^u^p}}function s(c,i){return c<<i|c>>>32-i}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var l=function(c){const i=[1518500249,1859775393,2400959708,3395469782],u=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof c=="string"){const v=unescape(encodeURIComponent(c));c=[];for(let b=0;b<v.length;++b)c.push(v.charCodeAt(b))}else Array.isArray(c)||(c=Array.prototype.slice.call(c));c.push(128);const p=c.length/4+2,f=Math.ceil(p/16),h=new Array(f);for(let v=0;v<f;++v){const b=new Uint32Array(16);for(let g=0;g<16;++g)b[g]=c[64*v+4*g]<<24|c[64*v+4*g+1]<<16|c[64*v+4*g+2]<<8|c[64*v+4*g+3];h[v]=b}h[f-1][14]=8*(c.length-1)/Math.pow(2,32),h[f-1][14]=Math.floor(h[f-1][14]),h[f-1][15]=8*(c.length-1)&4294967295;for(let v=0;v<f;++v){const b=new Uint32Array(80);for(let I=0;I<16;++I)b[I]=h[v][I];for(let I=16;I<80;++I)b[I]=s(b[I-3]^b[I-8]^b[I-14]^b[I-16],1);let g=u[0],x=u[1],y=u[2],E=u[3],N=u[4];for(let I=0;I<80;++I){const P=Math.floor(I/20),V=s(g,5)+o(P,x,y,E)+N+i[P]+b[I]>>>0;N=E,E=y,y=s(x,30)>>>0,x=g,g=V}u[0]=u[0]+g>>>0,u[1]=u[1]+x>>>0,u[2]=u[2]+y>>>0,u[3]=u[3]+E>>>0,u[4]=u[4]+N>>>0}return[u[0]>>24&255,u[0]>>16&255,u[0]>>8&255,255&u[0],u[1]>>24&255,u[1]>>16&255,u[1]>>8&255,255&u[1],u[2]>>24&255,u[2]>>16&255,u[2]>>8&255,255&u[2],u[3]>>24&255,u[3]>>16&255,u[3]>>8&255,255&u[3],u[4]>>24&255,u[4]>>16&255,u[4]>>8&255,255&u[4]]};n.default=l},{}],535:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o,s=(o=e("./validate.js"))&&o.__esModule?o:{default:o};const l=[];for(let i=0;i<256;++i)l.push((i+256).toString(16).substr(1));var c=function(i){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const p=(l[i[u+0]]+l[i[u+1]]+l[i[u+2]]+l[i[u+3]]+"-"+l[i[u+4]]+l[i[u+5]]+"-"+l[i[u+6]]+l[i[u+7]]+"-"+l[i[u+8]]+l[i[u+9]]+"-"+l[i[u+10]]+l[i[u+11]]+l[i[u+12]]+l[i[u+13]]+l[i[u+14]]+l[i[u+15]]).toLowerCase();if(!(0,s.default)(p))throw TypeError("Stringified UUID is invalid");return p};n.default=c},{"./validate.js":541}],536:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=l(e("./rng.js")),s=l(e("./stringify.js"));function l(h){return h&&h.__esModule?h:{default:h}}let c,i,u=0,p=0;var f=function(h,v,b){let g=v&&b||0;const x=v||new Array(16);let y=(h=h||{}).node||c,E=h.clockseq!==void 0?h.clockseq:i;if(y==null||E==null){const H=h.random||(h.rng||o.default)();y==null&&(y=c=[1|H[0],H[1],H[2],H[3],H[4],H[5]]),E==null&&(E=i=16383&(H[6]<<8|H[7]))}let N=h.msecs!==void 0?h.msecs:Date.now(),I=h.nsecs!==void 0?h.nsecs:p+1;const P=N-u+(I-p)/1e4;if(P<0&&h.clockseq===void 0&&(E=E+1&16383),(P<0||N>u)&&h.nsecs===void 0&&(I=0),I>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=N,p=I,i=E,N+=122192928e5;const V=(1e4*(268435455&N)+I)%4294967296;x[g++]=V>>>24&255,x[g++]=V>>>16&255,x[g++]=V>>>8&255,x[g++]=255&V;const U=N/4294967296*1e4&268435455;x[g++]=U>>>8&255,x[g++]=255&U,x[g++]=U>>>24&15|16,x[g++]=U>>>16&255,x[g++]=E>>>8|128,x[g++]=255&E;for(let H=0;H<6;++H)x[g+H]=y[H];return v||(0,s.default)(x)};n.default=f},{"./rng.js":533,"./stringify.js":535}],537:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=l(e("./v35.js")),s=l(e("./md5.js"));function l(i){return i&&i.__esModule?i:{default:i}}var c=(0,o.default)("v3",48,s.default);n.default=c},{"./md5.js":529,"./v35.js":538}],538:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(u,p,f){function h(v,b,g,x){if(typeof v=="string"&&(v=function(E){E=unescape(encodeURIComponent(E));const N=[];for(let I=0;I<E.length;++I)N.push(E.charCodeAt(I));return N}(v)),typeof b=="string"&&(b=(0,s.default)(b)),b.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let y=new Uint8Array(16+v.length);if(y.set(b),y.set(v,b.length),y=f(y),y[6]=15&y[6]|p,y[8]=63&y[8]|128,g){x=x||0;for(let E=0;E<16;++E)g[x+E]=y[E];return g}return(0,o.default)(y)}try{h.name=u}catch{}return h.DNS=c,h.URL=i,h},n.URL=n.DNS=void 0;var o=l(e("./stringify.js")),s=l(e("./parse.js"));function l(u){return u&&u.__esModule?u:{default:u}}const c="6ba7b810-9dad-11d1-80b4-00c04fd430c8";n.DNS=c;const i="6ba7b811-9dad-11d1-80b4-00c04fd430c8";n.URL=i},{"./parse.js":531,"./stringify.js":535}],539:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=l(e("./rng.js")),s=l(e("./stringify.js"));function l(i){return i&&i.__esModule?i:{default:i}}var c=function(i,u,p){const f=(i=i||{}).random||(i.rng||o.default)();if(f[6]=15&f[6]|64,f[8]=63&f[8]|128,u){p=p||0;for(let h=0;h<16;++h)u[p+h]=f[h];return u}return(0,s.default)(f)};n.default=c},{"./rng.js":533,"./stringify.js":535}],540:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=l(e("./v35.js")),s=l(e("./sha1.js"));function l(i){return i&&i.__esModule?i:{default:i}}var c=(0,o.default)("v5",80,s.default);n.default=c},{"./sha1.js":534,"./v35.js":538}],541:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o,s=(o=e("./regex.js"))&&o.__esModule?o:{default:o},l=function(c){return typeof c=="string"&&s.default.test(c)};n.default=l},{"./regex.js":532}],542:[function(e,a,n){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o,s=(o=e("./validate.js"))&&o.__esModule?o:{default:o},l=function(c){if(!(0,s.default)(c))throw TypeError("Invalid UUID");return parseInt(c.substr(14,1),16)};n.default=l},{"./validate.js":541}],543:[function(e,a,n){/**
* Character classes and associated utilities for the 5th edition of XML 1.0.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(n,"__esModule",{value:!0}),n.CHAR=`	
\r ---`,n.S=` 	\r
`,n.NAME_START_CHAR=":A-Z_a-z-----------",n.NAME_CHAR="-"+n.NAME_START_CHAR+".0-9--",n.CHAR_RE=new RegExp("^["+n.CHAR+"]$","u"),n.S_RE=new RegExp("^["+n.S+"]+$","u"),n.NAME_START_CHAR_RE=new RegExp("^["+n.NAME_START_CHAR+"]$","u"),n.NAME_CHAR_RE=new RegExp("^["+n.NAME_CHAR+"]$","u"),n.NAME_RE=new RegExp("^["+n.NAME_START_CHAR+"]["+n.NAME_CHAR+"]*$","u"),n.NMTOKEN_RE=new RegExp("^["+n.NAME_CHAR+"]+$","u");function o(s){return s>=65&&s<=90||s>=97&&s<=122||s===58||s===95||s===8204||s===8205||s>=192&&s<=214||s>=216&&s<=246||s>=248&&s<=767||s>=880&&s<=893||s>=895&&s<=8191||s>=8304&&s<=8591||s>=11264&&s<=12271||s>=12289&&s<=55295||s>=63744&&s<=64975||s>=65008&&s<=65533||s>=65536&&s<=983039}n.S_LIST=[32,10,13,9],n.isChar=function(s){return s>=32&&s<=55295||s===10||s===13||s===9||s>=57344&&s<=65533||s>=65536&&s<=1114111},n.isS=function(s){return s===32||s===10||s===13||s===9},n.isNameStartChar=o,n.isNameChar=function(s){return o(s)||s>=48&&s<=57||s===45||s===46||s===183||s>=768&&s<=879||s>=8255&&s<=8256}},{}],544:[function(e,a,n){/**
* Character classes and associated utilities for the 2nd edition of XML 1.1.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(n,"__esModule",{value:!0}),n.CHAR="---",n.RESTRICTED_CHAR="-\b\v\f---",n.S=` 	\r
`,n.NAME_START_CHAR=":A-Z_a-z-----------",n.NAME_CHAR="-"+n.NAME_START_CHAR+".0-9--",n.CHAR_RE=new RegExp("^["+n.CHAR+"]$","u"),n.RESTRICTED_CHAR_RE=new RegExp("^["+n.RESTRICTED_CHAR+"]$","u"),n.S_RE=new RegExp("^["+n.S+"]+$","u"),n.NAME_START_CHAR_RE=new RegExp("^["+n.NAME_START_CHAR+"]$","u"),n.NAME_CHAR_RE=new RegExp("^["+n.NAME_CHAR+"]$","u"),n.NAME_RE=new RegExp("^["+n.NAME_START_CHAR+"]["+n.NAME_CHAR+"]*$","u"),n.NMTOKEN_RE=new RegExp("^["+n.NAME_CHAR+"]+$","u");function o(s){return s>=65&&s<=90||s>=97&&s<=122||s===58||s===95||s===8204||s===8205||s>=192&&s<=214||s>=216&&s<=246||s>=248&&s<=767||s>=880&&s<=893||s>=895&&s<=8191||s>=8304&&s<=8591||s>=11264&&s<=12271||s>=12289&&s<=55295||s>=63744&&s<=64975||s>=65008&&s<=65533||s>=65536&&s<=983039}n.S_LIST=[32,10,13,9],n.isChar=function(s){return s>=1&&s<=55295||s>=57344&&s<=65533||s>=65536&&s<=1114111},n.isRestrictedChar=function(s){return s>=1&&s<=8||s===11||s===12||s>=14&&s<=31||s>=127&&s<=132||s>=134&&s<=159},n.isCharAndNotRestricted=function(s){return s===9||s===10||s===13||s>31&&s<127||s===133||s>159&&s<=55295||s>=57344&&s<=65533||s>=65536&&s<=1114111},n.isS=function(s){return s===32||s===10||s===13||s===9},n.isNameStartChar=o,n.isNameChar=function(s){return o(s)||s>=48&&s<=57||s===45||s===46||s===183||s>=768&&s<=879||s>=8255&&s<=8256}},{}],545:[function(e,a,n){/**
* Character class utilities for XML NS 1.0 edition 3.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/function o(s){return s>=65&&s<=90||s===95||s>=97&&s<=122||s>=192&&s<=214||s>=216&&s<=246||s>=248&&s<=767||s>=880&&s<=893||s>=895&&s<=8191||s>=8204&&s<=8205||s>=8304&&s<=8591||s>=11264&&s<=12271||s>=12289&&s<=55295||s>=63744&&s<=64975||s>=65008&&s<=65533||s>=65536&&s<=983039}Object.defineProperty(n,"__esModule",{value:!0}),n.NC_NAME_START_CHAR="A-Z_a-z------------",n.NC_NAME_CHAR="-"+n.NC_NAME_START_CHAR+".0-9--",n.NC_NAME_START_CHAR_RE=new RegExp("^["+n.NC_NAME_START_CHAR+"]$","u"),n.NC_NAME_CHAR_RE=new RegExp("^["+n.NC_NAME_CHAR+"]$","u"),n.NC_NAME_RE=new RegExp("^["+n.NC_NAME_START_CHAR+"]["+n.NC_NAME_CHAR+"]*$","u"),n.isNCNameStartChar=o,n.isNCNameChar=function(s){return o(s)||s===45||s===46||s>=48&&s<=57||s===183||s>=768&&s<=879||s>=8255&&s<=8256}},{}]},{},[15])(15)})}(vp)),vp.exports}var tj=ej();const rj=t8(tj);function aj({data:t,stats:r,filters:e,user:a}){const n=Xt(new Date,"dd/MM/yyyy",{locale:yr}),s=(a==null?void 0:a.role)==="VENDEDOR"&&(a!=null&&a.vendedor)?a.vendedor:"Geral",l=`Relatrio das Devolues - ${n} - ${s}`,c=t.reduce((k,A)=>{const T=A.nome_cliente||"Desconhecido",D=Number(A.valor_total_nota)||0;return k[T]=(k[T]||0)+D,k},{}),i=Object.entries(c).map(([k,A])=>({name:k,value:A})).sort((k,A)=>A.value-k.value).slice(0,10),u=t.reduce((k,A)=>{const T=A.vendedor||"Desconhecido",D=Number(A.valor_total_nota)||0;return k[T]=(k[T]||0)+D,k},{}),p=Object.entries(u).map(([k,A])=>({name:k,value:A})).sort((k,A)=>A.value-k.value).slice(0,5),f=t.reduce((k,A)=>{const T=A.rede||"Sem rede",D=Number(A.valor_total_nota)||0;return k[T]=(k[T]||0)+D,k},{}),h=Object.entries(f).map(([k,A])=>({name:k,value:A})).sort((k,A)=>A.value-k.value).slice(0,5),v=t.reduce((k,A)=>{const T=A.cidade_origem||"N/A";return k[T]=(k[T]||0)+(Number(A.valor_total_nota)||0),k},{}),b=Object.entries(v).map(([k,A])=>({name:k,value:A})).sort((k,A)=>A.value-k.value).slice(0,6),g=t.reduce((k,A)=>{const T=A.motivo_nome||"No informado";return k[T]=(k[T]||0)+1,k},{}),x=Object.entries(g).map(([k,A])=>({name:k,value:A})).sort((k,A)=>A.value-k.value).slice(0,5),y={};t.forEach(k=>{(k.itens||[]).forEach(T=>{const F=(T.descricao||"Desconhecido").split(" ").slice(0,2).join(" "),Y=Number(T.quantidade)||0;y[F]=(y[F]||0)+Y})});const E=Object.entries(y).map(([k,A])=>({name:k,quantidade:A})).sort((k,A)=>A.quantidade-k.quantidade).slice(0,10),N=t.reduce((k,A)=>k+(Number(A.valor_total_nota)||0),0),I=t.length,P=I>0?N/I:0,V=[];if(I>0&&V.push(` Total de ${I} devoluo(es) no perodo selecionado, totalizando R$ ${N.toLocaleString("pt-BR",{minimumFractionDigits:2})}.`),i.length>0&&N>0){const k=i[0].value/N*100;k>20&&V.push(` Cliente "${i[0].name}" concentra ${k.toFixed(1)}% do valor total de devolues.`)}p.length>0&&V.push(` Vendedor "${p[0].name}" lidera em devolues com R$ ${p[0].value.toLocaleString("pt-BR")}.`),E.length>0&&V.push(` Produto "${E[0].name}"  o mais devolvido com ${E[0].quantidade.toFixed(2)} unidades.`);const U=e.startDate&&e.endDate?`${Xt(e.startDate,"dd/MM/yyyy",{locale:yr})} a ${Xt(e.endDate,"dd/MM/yyyy",{locale:yr})}`:e.period||"Perodo no especificado",H=[];e.motivo&&e.motivo.length>0&&H.push(`Motivos: ${e.motivo.length} selecionado(s)`),e.cliente&&e.cliente.length>0&&H.push(`Clientes: ${e.cliente.length} selecionado(s)`),e.vendedor&&e.vendedor.length>0&&H.push(`Vendedores: ${e.vendedor.length} selecionado(s)`),e.setor&&e.setor.length>0&&H.push(`Setores: ${e.setor.length} selecionado(s)`),e.search&&H.push(`Busca: "${e.search}"`);const G=t.filter(k=>k.resultado==="PENDENTE VALIDAO"),Z=t.filter(k=>k.resultado==="TRATATIVA DE ANULAO"),W=t.filter(k=>k.resultado==="VALIDADA"),O=t.filter(k=>k.resultado==="PENDENTE VALIDAO"||k.resultado==="VALIDADA"||k.resultado==="TRATATIVA DE ANULAO"),R=[];t.filter(k=>k.resultado==="PENDENTE VALIDAO").forEach(k=>{k.itens&&k.itens.length>0&&k.itens.forEach(A=>{R.push({nf:k.numero||"-",vendedor:k.vendedor||"-",cliente:(k.nome_cliente||"-").substring(0,25),produto:(A.descricao||"-").substring(0,30),unidade:A.unidade||"-",quantidade:A.quantidade?A.quantidade.toString():"-",valor:`R$ ${(Number(A.valor_total_bruto)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`})})});const C={};t.forEach(k=>{const A=new Date(k.data_emissao||k.created_at),T=Xt(A,"dd/MM",{locale:yr});C[T]||(C[T]={value:0,count:0}),C[T].value+=Number(k.valor_total_nota)||0,C[T].count+=1});const _=Object.keys(C).sort((k,A)=>{const T=new Date(k.split("/").reverse().join("-")),D=new Date(A.split("/").reverse().join("-"));return T.getTime()-D.getTime()}).map(k=>({name:k,value:C[k].value,count:C[k].count}));return`
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>${l}</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"><\/script>
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
  
  @page {
    size: A4 portrait;
    margin: 15mm;
  }
  
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: white;
    padding: 10px;
    color: #333;
    font-size: 9px;
  }
  
  .page {
    page-break-after: auto;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }
  
  .header {
    background: linear-gradient(135deg, #073e29 0%, #0a4d33 100%);
    color: white;
    padding: 12px;
    border-radius: 6px;
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    gap: 15px;
  }
  
  .header-logo {
    width: 50px;
    height: 50px;
    background: white;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }
  
  .header-logo img {
    width: 100%;
    height: 100%;
    object-fit: contain;
  }
  
  .header-content {
    flex: 1;
  }
  
  .header h1 {
    font-size: 18px;
    margin-bottom: 4px;
  }
  
  .header-info {
    font-size: 9px;
    opacity: 0.95;
    margin-bottom: 3px;
  }
  
  .header-filters {
    font-size: 8px;
    opacity: 0.85;
    margin-top: 4px;
  }
  
  .kpi-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 6px;
    margin-bottom: 12px;
  }
  
  .kpi-card {
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 8px;
    background: #f9fafb;
  }
  
  .kpi-title {
    font-size: 7px;
    color: #666;
    margin-bottom: 3px;
  }
  
  .kpi-value {
    font-size: 13px;
    font-weight: bold;
    color: #073e29;
  }
  
  .kpi-desc {
    font-size: 6px;
    color: #999;
    margin-top: 2px;
  }
  
  .chart-section {
    margin-bottom: 10px;
    page-break-inside: avoid;
    break-inside: avoid;
  }
  
  .chart-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-bottom: 10px;
  }
  
  .chart-title {
    font-size: 11px;
    font-weight: bold;
    margin-bottom: 6px;
    color: #073e29;
    border-bottom: 2px solid #073e29;
    padding-bottom: 3px;
  }

  .chart-container {
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 6px;
    background: white;
    height: 140px;
    position: relative;
    width: 100%;
  }
  
  .insights-container {
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 6px;
    background: white;
    height: 140px;
    position: relative;
    width: 100%;
    overflow-y: auto;
  }
  
  .insight-item {
    font-size: 8px;
    margin-bottom: 4px;
    padding-left: 6px;
    line-height: 1.4;
    color: #333;
  }
  
  .data-table-section {
    margin-top: 12px;
    margin-bottom: 12px;
  }
  
  .data-table-title {
    font-size: 12px;
    font-weight: bold;
    color: #073e29;
    margin-bottom: 8px;
    border-bottom: 2px solid #073e29;
    padding-bottom: 4px;
  }
  
  .data-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 7px;
    margin-bottom: 15px;
    page-break-inside: avoid;
  }
  
  .data-table thead {
    background: #073e29;
    color: white;
  }
  
  .data-table th {
    padding: 6px 4px;
    text-align: left;
    font-weight: bold;
    font-size: 7px;
  }
  
  .data-table td {
    padding: 4px;
    border: 1px solid #ddd;
    color: #333;
  }
  
  .data-table tbody tr:nth-child(even) {
    background: #f9fafb;
  }
  
  .footer {
    margin-top: auto;
    padding-top: 12px;
    border-top: 2px solid #073e29;
    text-align: center;
    font-size: 7px;
    color: #666;
  }
  
  @media print {
    body {
      padding: 0;
    }
    .no-print {
      display: none !important;
    }
    .chart-container, .data-table {
      page-break-inside: avoid;
    }
  }
</style>
</head>
<body>
<button class="no-print" onclick="window.print()" style="position: fixed; top: 10px; right: 10px; z-index: 1000; background: #073e29; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold;">
   Imprimir
</button>

<div class="page">
  <div class="header">
    <div class="header-logo">
      <img src="/logo.png" alt="Logo" onerror="this.style.display='none'" style="background-color: #073e29;">
    </div>
    <div class="header-content">
      <h1>${l}</h1>
      <div class="header-info">Relatrio Gerado em ${Xt(new Date,"dd/MM/yyyy 's' HH:mm",{locale:yr})}</div>
      <div class="header-info">Perodo: ${U}</div>
      ${H.length>0?`<div class="header-filters">Filtros: ${H.join(" | ")}</div>`:""}
    </div>
  </div>
  
  <div class="kpi-grid">
    <div class="kpi-card">
      <div class="kpi-title">NF Pendentes</div>
      <div class="kpi-value">${r.nfPendentes}</div>
      <div class="kpi-desc">R$ ${r.totalPendente.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">NF Cancelamento</div>
      <div class="kpi-value">${r.nfCancelamento}</div>
      <div class="kpi-desc">R$ ${r.totalCancelamento.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">NF em Atraso</div>
      <div class="kpi-value">${r.nfAtraso}</div>
      <div class="kpi-desc">R$ ${r.totalAtraso.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">NF Validadas</div>
      <div class="kpi-value">${r.nfValidadas}</div>
      <div class="kpi-desc">R$ ${r.totalValidadas.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">Total Geral</div>
      <div class="kpi-value">${t.length}</div>
      <div class="kpi-desc">R$ ${r.totalGeral.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">Ticket Mdio</div>
      <div class="kpi-value">R$ ${P.toLocaleString("pt-BR",{maximumFractionDigits:0})}</div>
      <div class="kpi-desc">Por devoluo</div>
    </div>
  </div>
  
  <!-- Seo 1: Evoluo no Tempo | Top Clientes -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Evoluo no Tempo</div>
      <div class="chart-container">
        <canvas id="chartEvolucao"></canvas>
      </div>
    </div>
    <div class="chart-section">
      <div class="chart-title">Top Clientes (Valor)</div>
      <div class="chart-container">
        <canvas id="chartTopClientes"></canvas>
      </div>
    </div>
  </div>
  
  <!-- Seo 2: Top Vendedores | Top Redes -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Top Vendedores (Valor)</div>
      <div class="chart-container">
        <canvas id="chartVendedores"></canvas>
      </div>
    </div>
    <div class="chart-section">
      <div class="chart-title">Top Redes (Valor)</div>
      <div class="chart-container">
        <canvas id="chartRedes"></canvas>
      </div>
    </div>
  </div>
  
  <!-- Seo 3: Distribuio por Municpio | Principais Motivos -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Distribuio por Municpio</div>
      <div class="chart-container">
        <canvas id="chartMunicipios"></canvas>
      </div>
    </div>
    <div class="chart-section">
      <div class="chart-title">Principais Motivos</div>
      <div class="chart-container">
        <canvas id="chartMotivos"></canvas>
      </div>
    </div>
  </div>
  
  <!-- Seo 4: Produtos Crticos | Insights Automticos -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Produtos Crticos (Top 10)</div>
      <div class="chart-container">
        <canvas id="chartProdutos"></canvas>
      </div>
    </div>
    ${V.length>0?`
    <div class="chart-section">
      <div class="chart-title">Insights Automticos</div>
      <div class="insights-container">
        ${V.map(k=>`
          <div class="insight-item">${k}</div>
        `).join("")}
      </div>
    </div>
    `:'<div class="chart-section"></div>'}
  </div>
  
  <!-- Tabelas de Dados -->
  <div class="data-table-section">
    ${Z.length>0?`
      <div class="data-table-title">Notas em Tratativa de Anulao (${Z.length})</div>
      <table class="data-table">
        <thead>
          <tr>
            <th>Data Emisso</th>
            <th>NF</th>
            <th>Cliente</th>
            <th>Vendedor</th>
            <th>Valor</th>
            <th>Dias</th>
            <th>Prazo</th>
          </tr>
        </thead>
        <tbody>
          ${Z.slice(0,50).map(k=>`
            <tr>
              <td>${k.data_emissao?Xt(new Date(k.data_emissao),"dd/MM/yyyy",{locale:yr}):"-"}</td>
              <td><strong>${k.numero||"-"}</strong></td>
              <td>${(k.nome_cliente||"-").substring(0,20)}</td>
              <td>${(k.vendedor||"-").substring(0,15)}</td>
              <td><strong>R$ ${(Number(k.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}</strong></td>
              <td>${k.dias!==null&&k.dias!==void 0?k.dias:"-"}</td>
              <td>${k.prazo||"-"}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>
    `:""}

    ${G.length>0?`
      <div class="data-table-title">Notas Pendentes (${G.length})</div>
      <table class="data-table">
        <thead>
          <tr>
            <th>Data Emisso</th>
            <th>NF</th>
            <th>Cliente</th>
            <th>Vendedor</th>
            <th>Valor</th>
            <th>Dias</th>
            <th>Prazo</th>
          </tr>
        </thead>
        <tbody>
          ${G.slice(0,50).map(k=>`
            <tr>
              <td>${k.data_emissao?Xt(new Date(k.data_emissao),"dd/MM/yyyy",{locale:yr}):"-"}</td>
              <td><strong>${k.numero||"-"}</strong></td>
              <td>${(k.nome_cliente||"-").substring(0,20)}</td>
              <td>${(k.vendedor||"-").substring(0,15)}</td>
              <td><strong>R$ ${(Number(k.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}</strong></td>
              <td>${k.dias!==null&&k.dias!==void 0?k.dias:"-"}</td>
              <td>${k.prazo||"-"}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>
    `:""}


    ${R.length>0?`
      <div class="data-table-title">Lista Completa com Produtos (${R.length})</div>
      <table class="data-table">
        <thead>
          <tr>
            <th>NF</th>
            <th>Vendedor</th>
            <th>Cliente</th>
            <th>Produto</th>
            <th>Unidade</th>
            <th>Quantidade</th>
            <th>Valor</th>
          </tr>
        </thead>
        <tbody>
          ${R.slice(0,100).map(k=>`
            <tr>
              <td><strong>${k.nf}</strong></td>
              <td>${k.vendedor}</td>
              <td>${k.cliente}</td>
              <td>${k.produto}</td>
              <td>${k.unidade}</td>
              <td>${k.quantidade}</td>
              <td><strong>${k.valor}</strong></td>
            </tr>
          `).join("")}
        </tbody>
      </table>
    `:""}

    <!-- Tabela 1: Validaes Realizadas (resultado = VALIDADA) -->
    ${W.length>0?`
      <div class="data-table-title">Validaes Realizadas (${W.length})</div>
      <table class="data-table">
        <thead>
          <tr>
            <th>Data Emisso</th>
            <th>NF</th>
            <th>Cliente</th>
            <th>Valor</th>
            <th>Motivo</th>
            <th>Setor</th>
            <th>Data Validao</th>
          </tr>
        </thead>
        <tbody>
          ${W.map(k=>`
            <tr>
              <td>${k.data_emissao?Xt(new Date(k.data_emissao),"dd/MM/yyyy",{locale:yr}):"-"}</td>
              <td><strong>${k.numero||"-"}</strong></td>
              <td>${(k.nome_cliente||"-").substring(0,20)}</td>
              <td><strong>R$ ${(Number(k.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}</strong></td>
              <td>${(k.motivo_nome||"-").substring(0,20)}</td>
              <td>${(k.setor_nome||"-").substring(0,15)}</td>
              <td>${k.data_validacao?Xt(new Date(k.data_validacao),"dd/MM/yyyy",{locale:yr}):"-"}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>
    `:""}

    <!-- Tabela 2: Em Tratativa (resultado = TRATATIVA DE ANULAO) -->
    ${Z.length>0?`
      <div class="data-table-title">Em Tratativa (${Z.length})</div>
      <table class="data-table">
        <thead>
          <tr>
            <th>Data Emisso</th>
            <th>NF</th>
            <th>Cliente</th>
            <th>Valor</th>
            <th>Observao</th>
            <th>Data Validao</th>
          </tr>
        </thead>
        <tbody>
          ${Z.map(k=>`
            <tr>
              <td>${k.data_emissao?Xt(new Date(k.data_emissao),"dd/MM/yyyy",{locale:yr}):"-"}</td>
              <td><strong>${k.numero||"-"}</strong></td>
              <td>${(k.nome_cliente||"-").substring(0,20)}</td>
              <td><strong>R$ ${(Number(k.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}</strong></td>
              <td>${(k.justificativa||"-").substring(0,30)}</td>
              <td>${k.data_validacao?Xt(new Date(k.data_validacao),"dd/MM/yyyy",{locale:yr}):"-"}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>
    `:""}

    <!-- Tabela 3: Pendncias (resultado = PENDENTE VALIDAO) -->
    ${G.length>0?`
      <div class="data-table-title">Pendncias (${G.length})</div>
      <table class="data-table">
        <thead>
          <tr>
            <th>Data Emisso</th>
            <th>NF</th>
            <th>Cliente</th>
            <th>Valor</th>
            <th>Dias</th>
            <th>Prazo</th>
          </tr>
        </thead>
        <tbody>
          ${G.map(k=>`
            <tr>
              <td>${k.data_emissao?Xt(new Date(k.data_emissao),"dd/MM/yyyy",{locale:yr}):"-"}</td>
              <td><strong>${k.numero||"-"}</strong></td>
              <td>${(k.nome_cliente||"-").substring(0,20)}</td>
              <td><strong>R$ ${(Number(k.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}</strong></td>
              <td>${k.dias!==null&&k.dias!==void 0?k.dias:"-"}</td>
              <td>${k.prazo||"-"}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>
    `:""}

    <!-- Tabela: Informaes da nota fiscal -->
    ${O.length>0?`
      <div class="data-table-title">Informaes da nota fiscal (${O.length})</div>
      <table class="data-table">
        <thead>
          <tr>
            <th>NF</th>
            <th>Cliente</th>
            <th>Dados adicionais</th>
          </tr>
        </thead>
        <tbody>
          ${O.map(k=>{let A=k.dados_adicionais||"-";if(A!=="-"){const T=A.indexOf("Representante");T!==-1&&(A=A.substring(0,T).trim())}return`
            <tr>
              <td><strong>${k.numero||"-"}</strong></td>
              <td>${(k.nome_cliente||"-").substring(0,30)}</td>
              <td>${A}</td>
            </tr>
          `}).join("")}
        </tbody>
      </table>
    `:""}
  </div>
  
  <div class="footer">
    <p>Relatrio gerado automaticamente pelo Sistema de Devolues - Grupo Doce Mel</p>
    <p>Data de gerao: ${Xt(new Date,"dd/MM/yyyy 's' HH:mm:ss",{locale:yr})}</p>
  </div>
</div>

<script>
  Chart.defaults.font.size = 8;
  Chart.defaults.color = '#1f2937';
  Chart.defaults.borderColor = '#e5e7eb';
  
  const commonChartOptions = {
    responsive: false,
    maintainAspectRatio: false,
    plugins: {
      legend: { display: false },
      tooltip: {
        backgroundColor: 'rgba(0, 0, 0, 0.8)',
        titleColor: '#fff',
        bodyColor: '#fff',
        borderColor: '#17432a',
        borderWidth: 1
      }
    },
    scales: {
      x: {
        grid: { color: '#e5e7eb' },
        ticks: { color: '#1f2937', font: { size: 8 } }
      },
      y: {
        grid: { color: '#e5e7eb' },
        ticks: { color: '#1f2937', font: { size: 8 } }
      }
    }
  };
  
  // Grfico de Evoluo no Tempo
  new Chart(document.getElementById('chartEvolucao'), {
    type: 'line',
    data: {
      labels: ${JSON.stringify(_.map(k=>k.name))},
      datasets: [{
        label: 'Valor Total (R$)',
        data: ${JSON.stringify(_.map(k=>k.value))},
        borderColor: '#17432a',
        backgroundColor: 'rgba(23, 67, 42, 0.15)',
        borderWidth: 2,
        fill: true,
        tension: 0.4
      }]
    },
    options: {
      ...commonChartOptions,
      plugins: {
        ...commonChartOptions.plugins,
        legend: { display: true, position: 'bottom', labels: { color: '#1f2937' } },
        tooltip: {
          ...commonChartOptions.plugins.tooltip,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      },
      scales: {
        ...commonChartOptions.scales,
        y: {
          ...commonChartOptions.scales.y,
          beginAtZero: true,
          ticks: {
            ...commonChartOptions.scales.y.ticks,
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR', { maximumFractionDigits: 0 })
          }
        },
        x: {
          ...commonChartOptions.scales.x,
          ticks: {
            ...commonChartOptions.scales.x.ticks,
            maxRotation: 45,
            minRotation: 45
          }
        }
      }
    }
  });
  
  // Grfico Top Clientes
  new Chart(document.getElementById('chartTopClientes'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(i.map(k=>k.name.length>12?k.name.substring(0,12)+"...":k.name))},
      datasets: [{
        label: 'Valor (R$)',
        data: ${JSON.stringify(i.map(k=>k.value))},
        backgroundColor: '#17432a',
        borderColor: '#0a4d33',
        borderWidth: 1
      }]
    },
    options: {
      ...commonChartOptions,
      indexAxis: 'y',
      scales: {
        ...commonChartOptions.scales,
        x: {
          ...commonChartOptions.scales.x,
          ticks: {
            ...commonChartOptions.scales.x.ticks,
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR', { maximumFractionDigits: 0 })
          }
        }
      },
      plugins: {
        ...commonChartOptions.plugins,
        tooltip: {
          ...commonChartOptions.plugins.tooltip,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.x.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      }
    }
  });
  
  // Grfico Top Vendedores
  new Chart(document.getElementById('chartVendedores'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(p.map(k=>k.name.length>12?k.name.substring(0,12)+"...":k.name))},
      datasets: [{
        label: 'Valor (R$)',
        data: ${JSON.stringify(p.map(k=>k.value))},
        backgroundColor: '#0a4d33',
        borderColor: '#17432a',
        borderWidth: 1
      }]
    },
    options: {
      ...commonChartOptions,
      scales: {
        ...commonChartOptions.scales,
        y: {
          ...commonChartOptions.scales.y,
          beginAtZero: true,
          ticks: {
            ...commonChartOptions.scales.y.ticks,
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR', { maximumFractionDigits: 0 })
          }
        },
        x: {
          ...commonChartOptions.scales.x,
          ticks: {
            ...commonChartOptions.scales.x.ticks,
            maxRotation: 45,
            minRotation: 45
          }
        }
      },
      plugins: {
        ...commonChartOptions.plugins,
        tooltip: {
          ...commonChartOptions.plugins.tooltip,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      }
    }
  });
  
  // Grfico Top Redes
  new Chart(document.getElementById('chartRedes'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(h.map(k=>k.name.length>12?k.name.substring(0,12)+"...":k.name))},
      datasets: [{
        label: 'Valor (R$)',
        data: ${JSON.stringify(h.map(k=>k.value))},
        backgroundColor: '#065f46',
        borderColor: '#0a4d33',
        borderWidth: 1
      }]
    },
    options: {
      ...commonChartOptions,
      scales: {
        ...commonChartOptions.scales,
        y: {
          ...commonChartOptions.scales.y,
          beginAtZero: true,
          ticks: {
            ...commonChartOptions.scales.y.ticks,
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR', { maximumFractionDigits: 0 })
          }
        },
        x: {
          ...commonChartOptions.scales.x,
          ticks: {
            ...commonChartOptions.scales.x.ticks,
            maxRotation: 45,
            minRotation: 45
          }
        }
      },
      plugins: {
        ...commonChartOptions.plugins,
        tooltip: {
          ...commonChartOptions.plugins.tooltip,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      }
    }
  });
  
  // Grfico Municpios
  new Chart(document.getElementById('chartMunicipios'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(b.map(k=>k.name.length>12?k.name.substring(0,12)+"...":k.name))},
      datasets: [{
        label: 'Valor (R$)',
        data: ${JSON.stringify(b.map(k=>k.value))},
        backgroundColor: '#17432a',
        borderColor: '#0a4d33',
        borderWidth: 1
      }]
    },
    options: {
      ...commonChartOptions,
      indexAxis: 'y',
      scales: {
        ...commonChartOptions.scales,
        x: {
          ...commonChartOptions.scales.x,
          ticks: {
            ...commonChartOptions.scales.x.ticks,
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR', { maximumFractionDigits: 0 })
          }
        }
      },
      plugins: {
        ...commonChartOptions.plugins,
        tooltip: {
          ...commonChartOptions.plugins.tooltip,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.x.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      }
    }
  });
  
  // Grfico Motivos
  new Chart(document.getElementById('chartMotivos'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(x.map(k=>k.name.length>15?k.name.substring(0,15)+"...":k.name))},
      datasets: [{
        label: 'Quantidade',
        data: ${JSON.stringify(x.map(k=>k.value))},
        backgroundColor: '#0a4d33',
        borderColor: '#17432a',
        borderWidth: 1
      }]
    },
    options: {
      ...commonChartOptions,
      scales: {
        ...commonChartOptions.scales,
        y: {
          ...commonChartOptions.scales.y,
          beginAtZero: true,
          ticks: {
            ...commonChartOptions.scales.y.ticks,
            stepSize: 1
          }
        },
        x: {
          ...commonChartOptions.scales.x,
          ticks: {
            ...commonChartOptions.scales.x.ticks,
            maxRotation: 45,
            minRotation: 45
          }
        }
      },
      plugins: {
        ...commonChartOptions.plugins,
        tooltip: {
          ...commonChartOptions.plugins.tooltip,
          callbacks: {
            label: (context) => context.parsed.y + ' ocorrncia(s)'
          }
        }
      }
    }
  });
  
  // Grfico Produtos
  new Chart(document.getElementById('chartProdutos'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(E.slice(0,10).map(k=>k.name.length>15?k.name.substring(0,15)+"...":k.name))},
      datasets: [{
        label: 'Quantidade',
        data: ${JSON.stringify(E.slice(0,10).map(k=>k.quantidade))},
        backgroundColor: '#065f46',
        borderColor: '#0a4d33',
        borderWidth: 1
      }]
    },
    options: {
      ...commonChartOptions,
      indexAxis: 'y',
      scales: {
        ...commonChartOptions.scales,
        x: {
          ...commonChartOptions.scales.x,
          beginAtZero: true
        }
      },
      plugins: {
        ...commonChartOptions.plugins,
        tooltip: {
          ...commonChartOptions.plugins.tooltip,
          callbacks: {
            label: (context) => context.parsed.x.toFixed(2) + ' unidades'
          }
        }
      }
    }
  });
<\/script>
</body>
</html>
  `}const zi={"PENDENTE VALIDAO":1,VALIDADA:2,LANADA:3,"TRATATIVA DE ANULAO":4,"ANULADA/CANCELADA":5};function nj(){const{filters:t}=ec(),{user:r}=Oa(),[e,a]=Se.useState([]),[n,o]=Se.useState([]),[s,l]=Se.useState([]),[c,i]=Se.useState(!0),[u,p]=Se.useState(1),[f,h]=Se.useState(null),[v,b]=Se.useState(null),[g,x]=Se.useState(null),[y,E]=Se.useState({valorTotalLancado:0,notasLancadas:0,valorTotalAnulado:0,notasAnuladas:0,momPercent:0,yoyPercent:0}),N=100;Se.useEffect(()=>{I(),b(null),x(null),p(1)},[t]);const I=async()=>{i(!0);const G=(r==null?void 0:r.role)==="VENDEDOR"?r.vendedor:null;let Z=St.from("devolucoes").select(`
        *,
        itens:itens_devolucao(*, motivo_item:motivos_devolucao(id, nome)),
        setores(nome),
        motivos_devolucao(nome, setores:setores(nome))
      `);r&&r.role==="VENDEDOR"&&G&&(Z=Z.eq("vendedor",G),console.log(" Reports - Filtrando por vendedor:",G));const W=t.period&&!t.startDate&&!t.endDate?ju(t.period):{},O=t.startDate||W.startDate,R=t.endDate||W.endDate;t.search&&(Z=Z.or(`nome_cliente.ilike.%${t.search}%,vendedor.ilike.%${t.search}%,numero.ilike.%${t.search}%`)),t.resultado&&t.resultado.length>0&&(Z=Z.in("resultado",t.resultado)),t.motivo&&t.motivo.length>0&&(Z=Z.in("motivo_id",t.motivo)),t.cliente&&t.cliente.length>0&&(Z=Z.in("nome_cliente",t.cliente)),t.vendedor&&t.vendedor.length>0&&(Z=Z.in("vendedor",t.vendedor));let C=[];if(t.setor&&t.setor.length>0){const{data:T}=await St.from("motivos_devolucao").select("id").in("sector_id",t.setor);C=(T==null?void 0:T.map(D=>D.id))||[],Z=Z.in("setor_id",t.setor)}const _=C;if(O){const T=new Date(O);T.setHours(0,0,0,0);const D=new Date(T.getTime()-3*60*60*1e3);Z=Z.gte("data_emissao",D.toISOString().split("T")[0])}if(R){const T=new Date(R);T.setHours(23,59,59,999);const D=new Date(T.getTime()-3*60*60*1e3);Z=Z.lte("data_emissao",D.toISOString().split("T")[0])}const{data:k,error:A}=await Z;if(A)console.error(A),wt.error("Erro ao carregar dados do relatrio");else if(k){let T=k;t.setor&&t.setor.length>0&&_.length>0&&(T=k.filter(te=>{const ae=te.setor_id&&t.setor.includes(te.setor_id),Q=te.motivo_id&&_.includes(te.motivo_id);return ae||Q}));const D=T.map(te=>te.cnpj_destinatario).filter(te=>te&&te.trim()!=="");let B=new Map;if(D.length>0){const{data:te}=await St.from("clientes").select("cnpj_cpf, nome, vendedor, rede, uf, municipio").in("cnpj_cpf",D);te&&te.forEach(ae=>{B.set(ae.cnpj_cpf,ae)})}const F=T.map(te=>{var Q,fe,le,ne,ue;const ae=B.get(te.cnpj_destinatario);return{...te,setor_nome:typeof te.motivos_devolucao=="object"&&((fe=(Q=te.motivos_devolucao)==null?void 0:Q.setores)!=null&&fe.nome)?te.motivos_devolucao.setores.nome:typeof te.setores=="object"&&((le=te.setores)!=null&&le.nome)?te.setores.nome:typeof te.setores=="string"?te.setores:"-",motivo_nome:typeof te.motivos_devolucao=="object"&&((ne=te.motivos_devolucao)!=null&&ne.nome)?te.motivos_devolucao.nome:typeof te.motivos_devolucao=="string"?te.motivos_devolucao:"-",itens_count:((ue=te.itens)==null?void 0:ue.length)||0,nome_cliente:(ae==null?void 0:ae.nome)||te.nome_cliente||"Cliente no encontrado",vendedor:(ae==null?void 0:ae.vendedor)||te.vendedor||"-",rede:(ae==null?void 0:ae.rede)||te.rede||"-",uf_destino:(ae==null?void 0:ae.uf)||te.uf_destino||"-",cidade_destino:(ae==null?void 0:ae.municipio)||te.cidade_destino||"-",prazo:te.prazo||(te.resultado==="LANADA"||te.resultado==="ANULADA/CANCELADA"?"FINALIZADO":te.prazo),nome_validador:te.nome_validador||"-",finalizada_por:te.finalizada_por||"-",justificativa:te.justificativa||""}}),Y=F.sort((te,ae)=>{const Q=zi[te.resultado]||999,fe=zi[ae.resultado]||999;if(Q!==fe)return Q-fe;const le=te.data_emissao?new Date(te.data_emissao).getTime():0;return(ae.data_emissao?new Date(ae.data_emissao).getTime():0)-le});o(Y);const re=F.filter(te=>te.resultado==="LANADA"||te.resultado==="ANULADA/CANCELADA").sort((te,ae)=>{const Q=zi[te.resultado]||999,fe=zi[ae.resultado]||999;if(Q!==fe)return Q-fe;const le=te.data_emissao?new Date(te.data_emissao).getTime():0;return(ae.data_emissao?new Date(ae.data_emissao).getTime():0)-le});l(re);const z=Y.filter(te=>te.resultado==="LANADA"),ee=Y.filter(te=>te.resultado==="ANULADA/CANCELADA"),L=z.reduce((te,ae)=>te+(Number(ae.valor_total_nota)||0),0),M=ee.reduce((te,ae)=>te+(Number(ae.valor_total_nota)||0),0);let K=0,se=0;if(O&&R){const te=Math.ceil((R.getTime()-O.getTime())/864e5),ae=new Date(O);ae.setMonth(ae.getMonth()-1);const Q=new Date(ae);Q.setDate(Q.getDate()+te);const{data:fe}=await St.from("devolucoes").select("valor_total_nota, resultado").gte("data_emissao",ae.toISOString().split("T")[0]).lte("data_emissao",Q.toISOString().split("T")[0]).eq("resultado","LANADA"),le=(fe==null?void 0:fe.reduce((pe,Ce)=>pe+(Number(Ce.valor_total_nota)||0),0))||0;K=le>0?(L-le)/le*100:0;const ne=new Date(O);ne.setFullYear(ne.getFullYear()-1);const ue=new Date(R);ue.setFullYear(ue.getFullYear()-1);const{data:he}=await St.from("devolucoes").select("valor_total_nota, resultado").gte("data_emissao",ne.toISOString().split("T")[0]).lte("data_emissao",ue.toISOString().split("T")[0]).eq("resultado","LANADA"),ke=(he==null?void 0:he.reduce((pe,Ce)=>pe+(Number(Ce.valor_total_nota)||0),0))||0;se=ke>0?(L-ke)/ke*100:0}E({valorTotalLancado:L,notasLancadas:z.length,valorTotalAnulado:M,notasAnuladas:ee.length,momPercent:K,yoyPercent:se})}i(!1)};Se.useEffect(()=>{if(s.length===0)return;let G=[...s];v&&g?G=[...n].sort((O,R)=>{let C,_;switch(v){case"data_emissao":C=O.data_emissao?new Date(O.data_emissao).getTime():0,_=R.data_emissao?new Date(R.data_emissao).getTime():0;break;case"numero":C=O.numero||"",_=R.numero||"";break;case"nome_cliente":C=(O.nome_cliente||"").toLowerCase(),_=(R.nome_cliente||"").toLowerCase();break;case"cidade_origem":C=(O.cidade_origem||"").toLowerCase(),_=(R.cidade_origem||"").toLowerCase();break;case"vendedor":C=(O.vendedor||"").toLowerCase(),_=(R.vendedor||"").toLowerCase();break;case"motivo_nome":C=(O.motivo_nome||"").toLowerCase(),_=(R.motivo_nome||"").toLowerCase();break;case"valor_total_nota":C=parseFloat(O.valor_total_nota||0),_=parseFloat(R.valor_total_nota||0);break;case"dias":C=O.dias!==null&&O.dias!==void 0?O.dias:-1,_=R.dias!==null&&R.dias!==void 0?R.dias:-1;break;case"prazo":C=(O.prazo||"").toLowerCase(),_=(R.prazo||"").toLowerCase();break;case"resultado":C=zi[O.resultado]||999,_=zi[R.resultado]||999;break;default:return 0}return C<_?g==="asc"?-1:1:C>_?g==="asc"?1:-1:0}):G=[...s].sort((O,R)=>{const C=zi[O.resultado]||999,_=zi[R.resultado]||999;if(C!==_)return C-_;const k=O.data_emissao?new Date(O.data_emissao).getTime():0;return(R.data_emissao?new Date(R.data_emissao).getTime():0)-k});const Z=(u-1)*N,W=Z+N;a(G.slice(Z,W))},[v,g,s,u]);const P=G=>{v===G?g==="asc"?x("desc"):g==="desc"&&(b(null),x(null)):(b(G),x("asc")),p(1)},V=({field:G})=>v!==G?w.jsx(O2,{className:"ml-1 h-4 w-4 opacity-50"}):g==="asc"?w.jsx(D2,{className:"ml-1 h-4 w-4"}):w.jsx(j2,{className:"ml-1 h-4 w-4"}),U=async()=>{if(!(!f||!r))try{const{error:G}=await St.from("devolucoes").update({resultado:"PENDENTE VALIDAO",nome_validador:null,finalizada_por:null,data_validacao:null,data_finalizacao:null,prazo:null}).eq("id",f);if(G)throw G;wt.success("Nota fiscal retornada para validao com sucesso!"),h(null),I()}catch(G){wt.error("Erro ao retornar nota para validao: "+G.message)}},H=async()=>{if(n.length===0){wt.warning("Sem dados para exportar");return}try{const G=n.map(Y=>Y.id);let Z=new Map;if(G.length>0){const{data:Y}=await St.from("logs_validacao").select(`
            devolucao_id,
            status_novo,
            usuario_id
          `).in("devolucao_id",G).order("created_at",{ascending:!1});if(Y){const X=[...new Set(Y.map(z=>z.usuario_id).filter(Boolean))],re=new Map;if(X.length>0){const{data:z}=await St.from("profiles").select("id, name").in("id",X);z&&z.forEach(ee=>{re.set(ee.id,ee.name)})}Y.forEach(z=>{const ee=`${z.devolucao_id}_${z.status_novo}`;if(!Z.has(ee)){const L=re.get(z.usuario_id);L&&Z.set(ee,L)}})}}const W=[];n.forEach(Y=>{const X=Y.resultado||"PENDENTE VALIDAO",re=X!=="PENDENTE VALIDAO"&&Z.get(`${Y.id}_${X}`)||"-";!Y.itens||Y.itens.length===0?W.push({"Data Emisso":Y.data_emissao?Xt(new Date(Y.data_emissao),"dd/MM/yyyy"):"","Data Criao":Y.created_at?Xt(new Date(Y.created_at),"dd/MM/yyyy HH:mm"):"","Nota Fiscal":Y.numero||"",Srie:Y.serie||"","Chave de Acesso":Y.chave_acesso||"",Cliente:Y.nome_cliente||"","CNPJ Cliente":Y.cnpj_destinatario||"","CNPJ Emitente":Y.cnpj_emitente||"","Razo Social Emitente":Y.razao_social_emitente||"",Vendedor:Y.vendedor||"",Rede:Y.rede||"","Cidade Origem":Y.cidade_origem||"","UF Origem":Y.uf_origem||"","Cidade Destino":Y.cidade_destino||"","UF Destino":Y.uf_destino||"",Setor:Y.setor_nome||"",Motivo:Y.motivo_nome||"",Status:X,"Validado Por":re,Comentrio:Y.justificativa||"",Dias:Y.dias!==null&&Y.dias!==void 0?Y.dias:"",Prazo:Y.prazo||"","Valor Total Nota":Y.valor_total_nota?Number(Y.valor_total_nota).toFixed(2):"0.00","Peso Lquido":Y.peso_liquido||"","Sincronizao ERP":Y.sincronizacao_erp||"","Finalidade NFe":Y.finalidade_nfe||"","Natureza Operao":Y.natureza_operacao||"",CFOP:Y.cfop||"","Nmero Item":"","Descrio Produto":"",Unidade:"",Quantidade:"","Valor Unitrio":"","Valor Total Item":""}):Y.itens.forEach((z,ee)=>{W.push({"Data Emisso":ee===0&&Y.data_emissao?Xt(new Date(Y.data_emissao),"dd/MM/yyyy"):"","Data Criao":ee===0&&Y.created_at?Xt(new Date(Y.created_at),"dd/MM/yyyy HH:mm"):"","Nota Fiscal":ee===0&&Y.numero||"",Srie:ee===0&&Y.serie||"","Chave de Acesso":ee===0&&Y.chave_acesso||"",Cliente:ee===0&&Y.nome_cliente||"","CNPJ Cliente":ee===0&&Y.cnpj_destinatario||"","CNPJ Emitente":ee===0&&Y.cnpj_emitente||"","Razo Social Emitente":ee===0&&Y.razao_social_emitente||"",Vendedor:ee===0&&Y.vendedor||"",Rede:ee===0&&Y.rede||"","Cidade Origem":ee===0&&Y.cidade_origem||"","UF Origem":ee===0&&Y.uf_origem||"","Cidade Destino":ee===0&&Y.cidade_destino||"","UF Destino":ee===0&&Y.uf_destino||"",Setor:ee===0&&Y.setor_nome||"",Motivo:ee===0&&Y.motivo_nome||"",Status:ee===0?X:"","Validado Por":ee===0?re:"",Comentrio:ee===0&&Y.justificativa||"",Dias:ee===0&&Y.dias!==null&&Y.dias!==void 0?Y.dias:"",Prazo:ee===0&&Y.prazo||"","Valor Total Nota":ee===0?Y.valor_total_nota?Number(Y.valor_total_nota).toFixed(2):"0.00":"","Peso Lquido":ee===0&&Y.peso_liquido||"","Sincronizao ERP":ee===0&&Y.sincronizacao_erp||"","Finalidade NFe":ee===0&&Y.finalidade_nfe||"","Natureza Operao":ee===0&&Y.natureza_operacao||"",CFOP:ee===0&&Y.cfop||"","Nmero Item":z.numero_item||"","Descrio Produto":z.descricao||"",Unidade:z.unidade||"",Quantidade:z.quantidade?Number(z.quantidade).toFixed(2):"","Valor Unitrio":z.valor_unitario?Number(z.valor_unitario).toFixed(2):"","Valor Total Item":z.valor_total_bruto?Number(z.valor_total_bruto).toFixed(2):""})})});const O=new rj.Workbook,R=O.addWorksheet("Devolues"),C=["Data Emisso","Data Criao","Nota Fiscal","Srie","Chave de Acesso","Cliente","CNPJ Cliente","CNPJ Emitente","Razo Social Emitente","Vendedor","Rede","Cidade Origem","UF Origem","Cidade Destino","UF Destino","Setor","Motivo","Status","Validado Por","Comentrio","Dias","Prazo","Valor Total Nota","Peso Lquido","Sincronizao ERP","Finalidade NFe","Natureza Operao","CFOP","Nmero Item","Descrio Produto","Unidade","Quantidade","Valor Unitrio","Valor Total Item"],_=[12,18,12,8,45,30,18,18,30,20,20,20,5,20,5,15,30,20,20,40,8,12,15,12,18,15,20,8,12,40,8,12,15,15],k=R.addRow(C);k.eachCell(Y=>{Y.font={bold:!0,color:{argb:"FFFFFFFF"},size:11},Y.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF073E29"}},Y.alignment={vertical:"middle",horizontal:"center",wrapText:!0},Y.border={top:{style:"thin",color:{argb:"FF000000"}},left:{style:"thin",color:{argb:"FF000000"}},bottom:{style:"thin",color:{argb:"FF000000"}},right:{style:"thin",color:{argb:"FF000000"}}}}),k.height=25,_.forEach((Y,X)=>{R.getColumn(X+1).width=Y}),W.forEach(Y=>{R.addRow(C.map(re=>Y[re]||"")).eachCell(re=>{re.border={top:{style:"thin",color:{argb:"FFCCCCCC"}},left:{style:"thin",color:{argb:"FFCCCCCC"}},bottom:{style:"thin",color:{argb:"FFCCCCCC"}},right:{style:"thin",color:{argb:"FFCCCCCC"}}}})});const A=C.indexOf("Chave de Acesso")+1;R.getColumn(A).numFmt="@",R.autoFilter={from:{row:1,column:1},to:{row:W.length+1,column:C.length}},R.views=[{state:"frozen",ySplit:1}];const T=await O.xlsx.writeBuffer(),D=new Blob([T],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),B=window.URL.createObjectURL(D),F=document.createElement("a");F.href=B,F.download=`Relatorio_Devolucoes_${Xt(new Date,"yyyy-MM-dd_HHmm")}.xlsx`,F.click(),window.URL.revokeObjectURL(B),wt.success("Relatrio Excel gerado com sucesso!")}catch(G){console.error("Erro ao gerar Excel:",G),wt.error("Erro ao gerar relatrio Excel: "+G.message)}};return w.jsxs("div",{className:"space-y-6",children:[w.jsx(Qi,{title:"Relatrios",description:"Visualize e exporte relatrios detalhados das devolues. Gere PDFs e planilhas Excel com todos os dados filtrados."}),w.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[w.jsx(Xf,{}),w.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full md:w-auto shrink-0",children:[w.jsxs(Ot,{variant:"outline",onClick:H,className:"w-full sm:w-auto",children:[w.jsx(OS,{className:"mr-2 h-4 w-4 text-green-600"}),"Exportar Excel"]}),w.jsxs(Ot,{variant:"outline",onClick:()=>{const G=aj({data:n,stats:{nfPendentes:n.filter(W=>W.resultado==="PENDENTE VALIDAO").length,totalPendente:n.filter(W=>W.resultado==="PENDENTE VALIDAO").reduce((W,O)=>W+(Number(O.valor_total_nota)||0),0),nfCancelamento:n.filter(W=>W.resultado==="TRATATIVA DE ANULAO").length,totalCancelamento:n.filter(W=>W.resultado==="TRATATIVA DE ANULAO").reduce((W,O)=>W+(Number(O.valor_total_nota)||0),0),nfAtraso:n.filter(W=>W.prazo==="EM ATRASO").length,totalAtraso:n.filter(W=>W.prazo==="EM ATRASO").reduce((W,O)=>W+(Number(O.valor_total_nota)||0),0),nfValidadas:n.filter(W=>W.resultado==="VALIDADA").length,totalValidadas:n.filter(W=>W.resultado==="VALIDADA").reduce((W,O)=>W+(Number(O.valor_total_nota)||0),0),nfLancadas:n.filter(W=>W.resultado==="LANADA").length,totalLancadas:n.filter(W=>W.resultado==="LANADA").reduce((W,O)=>W+(Number(O.valor_total_nota)||0),0),totalGeral:n.reduce((W,O)=>W+(Number(O.valor_total_nota)||0),0)},filters:t,user:r?{role:r.role||void 0,vendedor:r.vendedor||void 0,name:r.name||void 0}:void 0}),Z=window.open("","_blank");Z&&(Z.document.write(G),Z.document.close())},className:"w-full sm:w-auto",children:[w.jsx(MS,{className:"mr-2 h-4 w-4"}),"Gerar Relatrio HTML"]})]})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-6",children:[w.jsxs(Nt,{children:[w.jsx(Dt,{className:"pb-3",children:w.jsx(Mt,{className:"text-sm font-semibold",children:"Valor Total Lanado"})}),w.jsxs(jt,{children:[w.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",y.valorTotalLancado.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),w.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[y.notasLancadas," nota(s) lanada(s)"]})]})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{className:"pb-3",children:w.jsx(Mt,{className:"text-sm font-semibold",children:"Notas Lanadas"})}),w.jsxs(jt,{children:[w.jsx("div",{className:"text-2xl font-bold",children:y.notasLancadas}),w.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Total de notas com resultado LANADA"})]})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{className:"pb-3",children:w.jsx(Mt,{className:"text-sm font-semibold",children:"Valor Total Anulado"})}),w.jsxs(jt,{children:[w.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",y.valorTotalAnulado.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),w.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[y.notasAnuladas," nota(s) anulada(s)"]})]})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{className:"pb-3",children:w.jsx(Mt,{className:"text-sm font-semibold",children:"Notas Anuladas"})}),w.jsxs(jt,{children:[w.jsx("div",{className:"text-2xl font-bold",children:y.notasAnuladas}),w.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Total de notas com resultado ANULADA/CANCELADA"})]})]})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2 mb-6",children:[w.jsxs(Nt,{children:[w.jsx(Dt,{className:"pb-3",children:w.jsx(Mt,{className:"text-sm font-semibold",children:"Comparativo MoM"})}),w.jsxs(jt,{children:[w.jsxs("div",{className:"flex items-center gap-2",children:[y.momPercent>=0?w.jsx(_u,{className:"h-6 w-6 text-red-600"}):w.jsx(sx,{className:"h-6 w-6 text-green-600"}),w.jsxs("div",{className:"text-2xl font-bold",style:{color:y.momPercent>=0?"#dc2626":"#16a34a"},children:[Math.abs(y.momPercent).toFixed(2),"%"]})]}),w.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Variao ms sobre ms (valor total)"})]})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{className:"pb-3",children:w.jsx(Mt,{className:"text-sm font-semibold",children:"Comparativo YoY"})}),w.jsxs(jt,{children:[w.jsxs("div",{className:"flex items-center gap-2",children:[y.yoyPercent>=0?w.jsx(_u,{className:"h-6 w-6 text-red-600"}):w.jsx(sx,{className:"h-6 w-6 text-green-600"}),w.jsxs("div",{className:"text-2xl font-bold",style:{color:y.yoyPercent>=0?"#dc2626":"#16a34a"},children:[Math.abs(y.yoyPercent).toFixed(2),"%"]})]}),w.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Variao ano sobre ano (valor total)"})]})]})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{children:w.jsx(Mt,{children:"Detalhamento de Devolues"})}),w.jsx(jt,{children:c?w.jsx("div",{className:"flex justify-center py-10",children:w.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"})}):w.jsx("div",{className:"rounded-md border overflow-x-auto",children:w.jsxs(Ba,{children:[w.jsx(Za,{children:w.jsxs(dr,{children:[w.jsx(Tt,{className:"w-[50px]"}),w.jsx(Tt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>P("data_emissao"),children:w.jsxs("div",{className:"flex items-center",children:["Data Emisso",w.jsx(V,{field:"data_emissao"})]})}),w.jsx(Tt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>P("numero"),children:w.jsxs("div",{className:"flex items-center",children:["Nota Fiscal",w.jsx(V,{field:"numero"})]})}),w.jsx(Tt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>P("nome_cliente"),children:w.jsxs("div",{className:"flex items-center",children:["Cliente",w.jsx(V,{field:"nome_cliente"})]})}),w.jsx(Tt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>P("vendedor"),children:w.jsxs("div",{className:"flex items-center",children:["Vendedor",w.jsx(V,{field:"vendedor"})]})}),w.jsx(Tt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>P("motivo"),children:w.jsxs("div",{className:"flex items-center",children:["Motivo",w.jsx(V,{field:"motivo"})]})}),w.jsx(Tt,{className:"text-[10px] px-2",children:"Setor"}),w.jsx(Tt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>P("valor_total_nota"),children:w.jsxs("div",{className:"flex items-center",children:["Valor Total",w.jsx(V,{field:"valor_total_nota"})]})}),w.jsx(Tt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>P("prazo"),children:w.jsxs("div",{className:"flex items-center",children:["Prazo",w.jsx(V,{field:"prazo"})]})}),w.jsx(Tt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>P("resultado"),children:w.jsxs("div",{className:"flex items-center",children:["Resultado",w.jsx(V,{field:"resultado"})]})}),w.jsx(Tt,{className:"text-[10px] px-2",children:"Validado Por"}),w.jsx(Tt,{className:"text-[10px] px-2",children:"Finalizada Por"}),w.jsx(Tt,{className:"text-[10px] px-2",children:"Comentrio"}),w.jsx(Tt,{className:"text-[10px] px-2",children:"Aes"})]})}),w.jsxs(Ua,{children:[e.map(G=>w.jsx(dr,{className:"group",children:w.jsx(Pt,{colSpan:14,className:"p-0 border-b",children:w.jsx(a_,{type:"single",collapsible:!0,className:"w-full",children:w.jsxs(Pm,{value:G.id,className:"border-b-0",children:[w.jsx("div",{className:"flex items-center w-full py-2 px-4 hover:bg-muted/50",children:w.jsxs("div",{className:"flex gap-2 w-full items-center text-[10px]",children:[w.jsx(Lm,{className:"w-[50px] py-0 pr-4 hover:no-underline flex-shrink-0"}),w.jsx("div",{className:"w-20",children:G.data_emissao?Xt(new Date(G.data_emissao),"dd/MM/yyyy"):"-"}),w.jsx("div",{className:"w-20 font-medium",children:G.numero}),w.jsx("div",{className:"w-32 truncate",title:G.nome_cliente,children:G.nome_cliente}),w.jsx("div",{className:"w-24 truncate",title:G.vendedor,children:G.vendedor}),w.jsx("div",{className:"w-40 truncate",title:G.motivo_nome,children:G.motivo_nome||"-"}),w.jsx("div",{className:"w-32 truncate",title:G.setor_nome,children:G.setor_nome||"-"}),w.jsxs("div",{className:"w-28 text-right",children:["R$ ",Number(G.valor_total_nota||0).toLocaleString("pt-BR",{minimumFractionDigits:2})]}),w.jsx("div",{className:"w-20",children:w.jsx("span",{className:`text-[9px] px-1 py-0.5 rounded ${G.prazo==="EM ATRASO"?"bg-red-500 text-white":G.prazo==="NO PRAZO"?"bg-green-500 text-white":G.prazo==="FINALIZADO"?"bg-green-200 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-500 text-white"}`,children:G.prazo||"-"})}),w.jsx("div",{className:"w-32",children:w.jsx("span",{className:`text-[9px] px-1 py-0.5 rounded ${G.resultado==="VALIDADA"||G.resultado==="LANADA"?"bg-blue-500 text-white":G.resultado==="ANULADA/CANCELADA"?"bg-red-500 text-white":"bg-gray-500 text-white"}`,children:G.resultado||"-"})}),w.jsx("div",{className:"w-28 truncate text-[9px]",title:G.nome_validador||"-",children:G.nome_validador||"-"}),w.jsx("div",{className:"w-28 truncate text-[9px]",title:G.finalizada_por||"-",children:G.finalizada_por||"-"}),w.jsx("div",{className:"w-48 truncate text-[9px]",title:G.justificativa||"-",children:G.justificativa||"-"}),w.jsx("div",{className:"w-28 flex gap-1",children:((r==null?void 0:r.role)==="ADMIN"||(r==null?void 0:r.role)==="LOGISTICA")&&w.jsx(w.Fragment,{children:w.jsx(Ot,{size:"sm",variant:"destructive",className:"h-7 px-1",onClick:Z=>{Z.stopPropagation(),h(G.id)},title:"Excluir",children:w.jsx(zn,{className:"h-3 w-3"})})})})]})}),w.jsx(Bm,{children:w.jsx("div",{className:"px-4 pb-4",children:w.jsxs("div",{className:"rounded-md border bg-muted/50 p-4",children:[w.jsx("h4",{className:"font-semibold mb-2 text-sm",children:"Itens da Devoluo"}),w.jsxs(Ba,{children:[w.jsx(Za,{children:w.jsxs(dr,{children:[w.jsx(Tt,{className:"h-8 text-xs",children:"Nmero"}),w.jsx(Tt,{className:"h-8 text-xs",children:"Descrio"}),w.jsx(Tt,{className:"h-8 text-xs",children:"Unidade"}),w.jsx(Tt,{className:"h-8 text-xs",children:"Quantidade"}),w.jsx(Tt,{className:"h-8 text-xs",children:"Valor Unitrio"}),w.jsx(Tt,{className:"h-8 text-xs",children:"Valor Total Bruto"}),w.jsx(Tt,{className:"h-8 text-xs",children:"Motivo"})]})}),w.jsx(Ua,{children:G.itens&&G.itens.length>0?G.itens.map((Z,W)=>{var O;return w.jsxs(dr,{children:[w.jsx(Pt,{className:"text-xs",children:Z.numero_item||"-"}),w.jsx(Pt,{className:"text-xs",children:Z.descricao||"-"}),w.jsx(Pt,{className:"text-xs",children:Z.unidade||"-"}),w.jsx(Pt,{className:"text-xs",children:Z.quantidade||"-"}),w.jsxs(Pt,{className:"text-xs",children:["R$ ",Number(Z.valor_unitario||0).toFixed(2)]}),w.jsxs(Pt,{className:"text-xs",children:["R$ ",Number(Z.valor_total_bruto||0).toFixed(2)]}),w.jsx(Pt,{className:"text-xs",children:((O=Z.motivo_item)==null?void 0:O.nome)||"-"})]},W)}):w.jsx(dr,{children:w.jsx(Pt,{colSpan:7,className:"text-center text-xs text-muted-foreground",children:"Nenhum item cadastrado"})})})]})]})})})]})})})},G.id)),e.length===0&&w.jsx(dr,{children:w.jsx(Pt,{colSpan:14,className:"text-center py-8 text-muted-foreground",children:"Nenhum dado encontrado com os filtros atuais."})})]})]})})})]}),!c&&s.length>0&&w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsxs("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",(u-1)*N+1," a ",Math.min(u*N,s.length)," de ",s.length," registros"]}),w.jsxs("div",{className:"flex gap-2",children:[w.jsxs(Ot,{variant:"outline",size:"sm",onClick:()=>p(G=>Math.max(1,G-1)),disabled:u===1,children:[w.jsx(yu,{className:"h-4 w-4 mr-1"}),"Anterior"]}),w.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.ceil(s.length/N)},(G,Z)=>Z+1).filter(G=>{const Z=Math.ceil(s.length/N);return G===1||G===Z||G>=u-2&&G<=u+2}).map((G,Z,W)=>{const O=W[Z-1],R=O&&G-O>1;return w.jsxs("div",{className:"flex items-center gap-1",children:[R&&w.jsx("span",{className:"px-2",children:"..."}),w.jsx(Ot,{variant:u===G?"default":"outline",size:"sm",onClick:()=>p(G),className:"w-10",children:G})]},G)})}),w.jsxs(Ot,{variant:"outline",size:"sm",onClick:()=>p(G=>Math.min(Math.ceil(s.length/N),G+1)),disabled:u>=Math.ceil(s.length/N),children:["Prxima",w.jsx(wu,{className:"h-4 w-4 ml-1"})]})]})]}),w.jsx(ri,{open:!!f,onOpenChange:G=>!G&&h(null),children:w.jsxs(As,{className:"sm:max-w-[425px]",children:[w.jsxs(Cs,{children:[w.jsxs(js,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[w.jsx(zn,{className:"h-5 w-5"}),"Retornar para Validao"]}),w.jsx(Os,{className:"pt-2",children:"Tem certeza que deseja retornar esta nota fiscal para validao?"}),w.jsx("div",{className:"bg-warning/10 border border-warning/20 rounded-lg p-4 mt-4",children:w.jsx("p",{className:"text-sm text-warning font-medium",children:' A nota fiscal voltar para a tela de validao com status "PENDENTE VALIDAO" e os campos de validao sero limpos.'})})]}),w.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[w.jsx(Ot,{variant:"outline",onClick:()=>h(null),className:"flex-1 sm:flex-initial",children:"No"}),w.jsx(Ot,{variant:"destructive",onClick:U,className:"flex-1 sm:flex-initial",children:"Sim, Retornar para Validao"})]})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var s_=1252,sj=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Um={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},zm=function(t){sj.indexOf(t)!=-1&&(s_=Um[0]=t)};function ij(){zm(1252)}var ls=function(t){zm(t)};function i_(){ls(1200),ij()}function qx(t){for(var r=[],e=0,a=t.length;e<a;++e)r[e]=t.charCodeAt(e);return r}function oj(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e)+(t.charCodeAt(2*e+1)<<8));return r.join("")}function o_(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e+1)+(t.charCodeAt(2*e)<<8));return r.join("")}var nu=function(t){var r=t.charCodeAt(0),e=t.charCodeAt(1);return r==255&&e==254?oj(t.slice(2)):r==254&&e==255?o_(t.slice(2)):r==65279?t.slice(1):t},hf=function(r){return String.fromCharCode(r)},Wx=function(r){return String.fromCharCode(r)},Ou,Wi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Gx(t){for(var r="",e=0,a=0,n=0,o=0,s=0,l=0,c=0,i=0;i<t.length;)e=t.charCodeAt(i++),o=e>>2,a=t.charCodeAt(i++),s=(e&3)<<4|a>>4,n=t.charCodeAt(i++),l=(a&15)<<2|n>>6,c=n&63,isNaN(a)?l=c=64:isNaN(n)&&(c=64),r+=Wi.charAt(o)+Wi.charAt(s)+Wi.charAt(l)+Wi.charAt(c);return r}function Tn(t){var r="",e=0,a=0,n=0,o=0,s=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var i=0;i<t.length;)o=Wi.indexOf(t.charAt(i++)),s=Wi.indexOf(t.charAt(i++)),e=o<<2|s>>4,r+=String.fromCharCode(e),l=Wi.indexOf(t.charAt(i++)),a=(s&15)<<4|l>>2,l!==64&&(r+=String.fromCharCode(a)),c=Wi.indexOf(t.charAt(i++)),n=(l&3)<<6|c,c!==64&&(r+=String.fromCharCode(n));return r}var fr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),$o=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(r,e){return e?new Buffer(r,e):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function eo(t){return fr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Yx(t){return fr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var is=function(r){return fr?$o(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)&255})};function Vo(t){if(Array.isArray(t))return t.map(function(a){return String.fromCharCode(a)}).join("");for(var r=[],e=0;e<t.length;++e)r[e]=String.fromCharCode(t[e]);return r.join("")}function $m(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return $m(new Uint8Array(t));for(var r=new Array(t.length),e=0;e<t.length;++e)r[e]=t[e];return r}var qi=fr?function(t){return Buffer.concat(t.map(function(r){return Buffer.isBuffer(r)?r:$o(r)}))}:function(t){if(typeof Uint8Array<"u"){var r=0,e=0;for(r=0;r<t.length;++r)e+=t[r].length;var a=new Uint8Array(e),n=0;for(r=0,e=0;r<t.length;e+=n,++r)if(n=t[r].length,t[r]instanceof Uint8Array)a.set(t[r],e);else{if(typeof t[r]=="string")throw"wtf";a.set(new Uint8Array(t[r]),e)}return a}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function lj(t){for(var r=[],e=0,a=t.length+250,n=eo(t.length+255),o=0;o<t.length;++o){var s=t.charCodeAt(o);if(s<128)n[e++]=s;else if(s<2048)n[e++]=192|s>>6&31,n[e++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var l=t.charCodeAt(++o)&1023;n[e++]=240|s>>8&7,n[e++]=128|s>>2&63,n[e++]=128|l>>6&15|(s&3)<<4,n[e++]=128|l&63}else n[e++]=224|s>>12&15,n[e++]=128|s>>6&63,n[e++]=128|s&63;e>a&&(r.push(n.slice(0,e)),e=0,n=eo(65535),a=65530)}return r.push(n.slice(0,e)),qi(r)}var Qa=/\u0000/g,su=/[\u0001-\u0006]/g;function Wl(t){for(var r="",e=t.length-1;e>=0;)r+=t.charAt(e--);return r}function cs(t,r){var e=""+t;return e.length>=r?e:Gr("0",r-e.length)+e}function Vm(t,r){var e=""+t;return e.length>=r?e:Gr(" ",r-e.length)+e}function Cf(t,r){var e=""+t;return e.length>=r?e:e+Gr(" ",r-e.length)}function cj(t,r){var e=""+Math.round(t);return e.length>=r?e:Gr("0",r-e.length)+e}function uj(t,r){var e=""+t;return e.length>=r?e:Gr("0",r-e.length)+e}var Xx=Math.pow(2,32);function Ol(t,r){if(t>Xx||t<-Xx)return cj(t,r);var e=Math.round(t);return uj(e,r)}function Nf(t,r){return r=r||0,t.length>=7+r&&(t.charCodeAt(r)|32)===103&&(t.charCodeAt(r+1)|32)===101&&(t.charCodeAt(r+2)|32)===110&&(t.charCodeAt(r+3)|32)===101&&(t.charCodeAt(r+4)|32)===114&&(t.charCodeAt(r+5)|32)===97&&(t.charCodeAt(r+6)|32)===108}var Kx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],bp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function dj(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var rr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Zx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},fj={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function jf(t,r,e){for(var a=t<0?-1:1,n=t*a,o=0,s=1,l=0,c=1,i=0,u=0,p=Math.floor(n);i<r&&(p=Math.floor(n),l=p*s+o,u=p*i+c,!(n-p<5e-8));)n=1/(n-p),o=s,s=l,c=i,i=u;if(u>r&&(i>r?(u=c,l=o):(u=i,l=s)),!e)return[0,a*l,u];var f=Math.floor(a*l/u);return[f,a*l-f*u,u]}function Io(t,r,e){if(t>2958465||t<0)return null;var a=t|0,n=Math.floor(86400*(t-a)),o=0,s=[],l={D:a,T:n,u:86400*(t-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),r&&r.date1904&&(a+=1462),l.u>.9999&&(l.u=0,++n==86400&&(l.T=n=0,++a,++l.D)),a===60)s=e?[1317,10,29]:[1900,2,29],o=3;else if(a===0)s=e?[1317,8,29]:[1900,1,0],o=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],o=c.getDay(),a<60&&(o=(o+6)%7),e&&(o=bj(c,s))}return l.y=s[0],l.m=s[1],l.d=s[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=o,l}var l_=new Date(1899,11,31,0,0,0),hj=l_.getTime(),pj=new Date(1900,2,1,0,0,0);function c_(t,r){var e=t.getTime();return r?e-=1461*24*60*60*1e3:t>=pj&&(e+=24*60*60*1e3),(e-(hj+(t.getTimezoneOffset()-l_.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Hm(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function mj(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function gj(t){var r=t<0?12:11,e=Hm(t.toFixed(12));return e.length<=r||(e=t.toPrecision(10),e.length<=r)?e:t.toExponential(5)}function vj(t){var r=Hm(t.toFixed(11));return r.length>(t<0?12:11)||r==="0"||r==="-0"?t.toPrecision(6):r}function Du(t){var r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),e;return r>=-4&&r<=-1?e=t.toPrecision(10+r):Math.abs(r)<=9?e=gj(t):r===10?e=t.toFixed(10).substr(0,12):e=vj(t),Hm(mj(e.toUpperCase()))}function Bo(t,r){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Du(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Hn(14,c_(t,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+t)}function bj(t,r){r[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}function xj(t,r,e,a){var n="",o=0,s=0,l=e.y,c,i=0;switch(t){case 98:l=e.y+543;case 121:switch(r.length){case 1:case 2:c=l%100,i=2;break;default:c=l%1e4,i=4;break}break;case 109:switch(r.length){case 1:case 2:c=e.m,i=r.length;break;case 3:return bp[e.m-1][1];case 5:return bp[e.m-1][0];default:return bp[e.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=e.d,i=r.length;break;case 3:return Kx[e.q][0];default:return Kx[e.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(e.H+11)%12,i=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=e.H,i=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=e.M,i=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return e.u===0&&(r=="s"||r=="ss")?cs(e.S,r.length):(a>=2?s=a===3?1e3:100:s=a===1?10:1,o=Math.round(s*(e.S+e.u)),o>=60*s&&(o=0),r==="s"?o===0?"0":""+o/s:(n=cs(o,2+a),r==="ss"?n.substr(0,2):"."+n.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=e.D*24+e.H;break;case"[m]":case"[mm]":c=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":c=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+r}i=r.length===3?1:2;break;case 101:c=l,i=1;break}var u=i>0?cs(c,i):"";return u}function Gi(t){var r=3;if(t.length<=r)return t;for(var e=t.length%r,a=t.substr(0,e);e!=t.length;e+=r)a+=(a.length>0?",":"")+t.substr(e,r);return a}var u_=/%/g;function yj(t,r,e){var a=r.replace(u_,""),n=r.length-a.length;return ni(t,a,e*Math.pow(10,2*n))+Gr("%",n)}function wj(t,r,e){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return ni(t,r.substr(0,a),e/Math.pow(10,3*(r.length-a)))}function d_(t,r){var e,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+d_(t,-r);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%n;if(o<0&&(o+=n),e=(r/Math.pow(10,o)).toPrecision(a+1+(n+o)%n),e.indexOf("e")===-1){var s=Math.floor(Math.log(r)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+o):e+="E+"+(s-o);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,n)+"."+e.substr(2+n),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,i,u){return c+i+u.substr(0,(n+o)%n)+"."+u.substr(o)+"E"})}else e=r.toExponential(a);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var f_=/# (\?+)( ?)\/( ?)(\d+)/;function _j(t,r,e){var a=parseInt(t[4],10),n=Math.round(r*a),o=Math.floor(n/a),s=n-o*a,l=a;return e+(o===0?"":""+o)+" "+(s===0?Gr(" ",t[1].length+1+t[4].length):Vm(s,t[1].length)+t[2]+"/"+t[3]+cs(l,t[4].length))}function Sj(t,r,e){return e+(r===0?"":""+r)+Gr(" ",t[1].length+2+t[4].length)}var h_=/^#*0*\.([0#]+)/,p_=/\).*[0#]/,m_=/\(###\) ###\\?-####/;function Xa(t){for(var r="",e,a=0;a!=t.length;++a)switch(e=t.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(e)}return r}function Jx(t,r){var e=Math.pow(10,r);return""+Math.round(t*e)/e}function Qx(t,r){var e=t-Math.floor(t),a=Math.pow(10,r);return r<(""+Math.round(e*a)).length?0:Math.round(e*a)}function kj(t,r){return r<(""+Math.round((t-Math.floor(t))*Math.pow(10,r))).length?1:0}function Ej(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Fn(t,r,e){if(t.charCodeAt(0)===40&&!r.match(p_)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Fn("n",a,e):"("+Fn("n",a,-e)+")"}if(r.charCodeAt(r.length-1)===44)return wj(t,r,e);if(r.indexOf("%")!==-1)return yj(t,r,e);if(r.indexOf("E")!==-1)return d_(r,e);if(r.charCodeAt(0)===36)return"$"+Fn(t,r.substr(r.charAt(1)==" "?2:1),e);var n,o,s,l,c=Math.abs(e),i=e<0?"-":"";if(r.match(/^00+$/))return i+Ol(c,r.length);if(r.match(/^[#?]+$/))return n=Ol(e,0),n==="0"&&(n=""),n.length>r.length?n:Xa(r.substr(0,r.length-n.length))+n;if(o=r.match(f_))return _j(o,c,i);if(r.match(/^#+0+$/))return i+Ol(c,r.length-r.indexOf("0"));if(o=r.match(h_))return n=Jx(e,o[1].length).replace(/^([^\.]+)$/,"$1."+Xa(o[1])).replace(/\.$/,"."+Xa(o[1])).replace(/\.(\d*)$/,function(v,b){return"."+b+Gr("0",Xa(o[1]).length-b.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return i+Jx(c,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return i+Gi(Ol(c,0));if(o=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Fn(t,r,-e):Gi(""+(Math.floor(e)+kj(e,o[1].length)))+"."+cs(Qx(e,o[1].length),o[1].length);if(o=r.match(/^#,#*,#0/))return Fn(t,r.replace(/^#,#*,/,""),e);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Wl(Fn(t,r.replace(/[\\-]/g,""),e)),s=0,Wl(Wl(r.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<n.length?n.charAt(s++):v==="0"?"0":""}));if(r.match(m_))return n=Fn(t,"##########",e),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),l=jf(c,Math.pow(10,s)-1,!1),n=""+i,u=ni("n",o[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+o[2]+"/"+o[3],u=Cf(l[2],s),u.length<o[4].length&&(u=Xa(o[4].substr(o[4].length-u.length))+u),n+=u,n;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),l=jf(c,Math.pow(10,s)-1,!0),i+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Vm(l[1],s)+o[2]+"/"+o[3]+Cf(l[2],s):Gr(" ",2*s+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return n=Ol(e,0),r.length<=n.length?n:Xa(r.substr(0,r.length-n.length))+n;if(o=r.match(/^([#0?]+)\.([#0]+)$/)){n=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=n.indexOf(".");var p=r.indexOf(".")-s,f=r.length-n.length-p;return Xa(r.substr(0,p)+n+r.substr(r.length-f))}if(o=r.match(/^00,000\.([#0]*0)$/))return s=Qx(e,o[1].length),e<0?"-"+Fn(t,r,-e):Gi(Ej(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?cs(0,3-v.length):"")+v})+"."+cs(s,o[1].length);switch(r){case"###,##0.00":return Fn(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var h=Gi(Ol(c,0));return h!=="0"?i+h:"";case"###,###.00":return Fn(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Fn(t,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function Tj(t,r,e){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return ni(t,r.substr(0,a),e/Math.pow(10,3*(r.length-a)))}function Aj(t,r,e){var a=r.replace(u_,""),n=r.length-a.length;return ni(t,a,e*Math.pow(10,2*n))+Gr("%",n)}function g_(t,r){var e,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+g_(t,-r);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%n;if(o<0&&(o+=n),e=(r/Math.pow(10,o)).toPrecision(a+1+(n+o)%n),!e.match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+o):e+="E+"+(s-o),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,i,u){return c+i+u.substr(0,(n+o)%n)+"."+u.substr(o)+"E"})}else e=r.toExponential(a);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function _s(t,r,e){if(t.charCodeAt(0)===40&&!r.match(p_)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?_s("n",a,e):"("+_s("n",a,-e)+")"}if(r.charCodeAt(r.length-1)===44)return Tj(t,r,e);if(r.indexOf("%")!==-1)return Aj(t,r,e);if(r.indexOf("E")!==-1)return g_(r,e);if(r.charCodeAt(0)===36)return"$"+_s(t,r.substr(r.charAt(1)==" "?2:1),e);var n,o,s,l,c=Math.abs(e),i=e<0?"-":"";if(r.match(/^00+$/))return i+cs(c,r.length);if(r.match(/^[#?]+$/))return n=""+e,e===0&&(n=""),n.length>r.length?n:Xa(r.substr(0,r.length-n.length))+n;if(o=r.match(f_))return Sj(o,c,i);if(r.match(/^#+0+$/))return i+cs(c,r.length-r.indexOf("0"));if(o=r.match(h_))return n=(""+e).replace(/^([^\.]+)$/,"$1."+Xa(o[1])).replace(/\.$/,"."+Xa(o[1])),n=n.replace(/\.(\d*)$/,function(v,b){return"."+b+Gr("0",Xa(o[1]).length-b.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return i+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return i+Gi(""+c);if(o=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+_s(t,r,-e):Gi(""+e)+"."+Gr("0",o[1].length);if(o=r.match(/^#,#*,#0/))return _s(t,r.replace(/^#,#*,/,""),e);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Wl(_s(t,r.replace(/[\\-]/g,""),e)),s=0,Wl(Wl(r.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<n.length?n.charAt(s++):v==="0"?"0":""}));if(r.match(m_))return n=_s(t,"##########",e),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),l=jf(c,Math.pow(10,s)-1,!1),n=""+i,u=ni("n",o[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+o[2]+"/"+o[3],u=Cf(l[2],s),u.length<o[4].length&&(u=Xa(o[4].substr(o[4].length-u.length))+u),n+=u,n;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),l=jf(c,Math.pow(10,s)-1,!0),i+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Vm(l[1],s)+o[2]+"/"+o[3]+Cf(l[2],s):Gr(" ",2*s+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return n=""+e,r.length<=n.length?n:Xa(r.substr(0,r.length-n.length))+n;if(o=r.match(/^([#0]+)\.([#0]+)$/)){n=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=n.indexOf(".");var p=r.indexOf(".")-s,f=r.length-n.length-p;return Xa(r.substr(0,p)+n+r.substr(r.length-f))}if(o=r.match(/^00,000\.([#0]*0)$/))return e<0?"-"+_s(t,r,-e):Gi(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?cs(0,3-v.length):"")+v})+"."+cs(0,o[1].length);switch(r){case"###,###":case"##,###":case"#,###":var h=Gi(""+c);return h!=="0"?i+h:"";default:if(r.match(/\.[0#?]*$/))return _s(t,r.slice(0,r.lastIndexOf(".")),e)+Xa(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function ni(t,r,e){return(e|0)===e?_s(t,r,e):Fn(t,r,e)}function Cj(t){for(var r=[],e=!1,a=0,n=0;a<t.length;++a)switch(t.charCodeAt(a)){case 34:e=!e;break;case 95:case 42:case 92:++a;break;case 59:r[r.length]=t.substr(n,a-n),n=a+1}if(r[r.length]=t.substr(n),e===!0)throw new Error("Format |"+t+"| unterminated string ");return r}var v_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function rc(t){for(var r=0,e="",a="";r<t.length;)switch(e=t.charAt(r)){case"G":Nf(t,r)&&(r+=6),r++;break;case'"':for(;t.charCodeAt(++r)!==34&&r<t.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(t.charAt(r+1)==="1"||t.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(r,3).toUpperCase()==="A/P"||t.substr(r,5).toUpperCase()==="AM/PM"||t.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(a=e;t.charAt(r++)!=="]"&&r<t.length;)a+=t.charAt(r);if(a.match(v_))return!0;break;case".":case"0":case"#":for(;r<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++r))>-1||e=="\\"&&t.charAt(r+1)=="-"&&"0#".indexOf(t.charAt(r+2))>-1););break;case"?":for(;t.charAt(++r)===e;);break;case"*":++r,(t.charAt(r)==" "||t.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<t.length&&"0123456789".indexOf(t.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function Nj(t,r,e,a){for(var n=[],o="",s=0,l="",c="t",i,u,p,f="H";s<t.length;)switch(l=t.charAt(s)){case"G":if(!Nf(t,s))throw new Error("unrecognized character "+l+" in "+t);n[n.length]={t:"G",v:"General"},s+=7;break;case'"':for(o="";(p=t.charCodeAt(++s))!==34&&s<t.length;)o+=String.fromCharCode(p);n[n.length]={t:"t",v:o},++s;break;case"\\":var h=t.charAt(++s),v=h==="("||h===")"?h:"t";n[n.length]={t:v,v:h},++s;break;case"_":n[n.length]={t:"t",v:" "},s+=2;break;case"@":n[n.length]={t:"T",v:r},++s;break;case"B":case"b":if(t.charAt(s+1)==="1"||t.charAt(s+1)==="2"){if(i==null&&(i=Io(r,e,t.charAt(s+1)==="2"),i==null))return"";n[n.length]={t:"X",v:t.substr(s,2)},c=l,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||i==null&&(i=Io(r,e),i==null))return"";for(o=l;++s<t.length&&t.charAt(s).toLowerCase()===l;)o+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=f),n[n.length]={t:l,v:o},c=l;break;case"A":case"a":case"":var b={t:l,v:l};if(i==null&&(i=Io(r,e)),t.substr(s,3).toUpperCase()==="A/P"?(i!=null&&(b.v=i.H>=12?"P":"A"),b.t="T",f="h",s+=3):t.substr(s,5).toUpperCase()==="AM/PM"?(i!=null&&(b.v=i.H>=12?"PM":"AM"),b.t="T",s+=5,f="h"):t.substr(s,5).toUpperCase()==="/"?(i!=null&&(b.v=i.H>=12?"":""),b.t="T",s+=5,f="h"):(b.t="t",++s),i==null&&b.t==="T")return"";n[n.length]=b,c=l;break;case"[":for(o=l;t.charAt(s++)!=="]"&&s<t.length;)o+=t.charAt(s);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(v_)){if(i==null&&(i=Io(r,e),i==null))return"";n[n.length]={t:"Z",v:o.toLowerCase()},c=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",rc(t)||(n[n.length]={t:"t",v:o}));break;case".":if(i!=null){for(o=l;++s<t.length&&(l=t.charAt(s))==="0";)o+=l;n[n.length]={t:"s",v:o};break}case"0":case"#":for(o=l;++s<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(s))>-1;)o+=l;n[n.length]={t:"n",v:o};break;case"?":for(o=l;t.charAt(++s)===l;)o+=l;n[n.length]={t:l,v:o},c=l;break;case"*":++s,(t.charAt(s)==" "||t.charAt(s)=="*")&&++s;break;case"(":case")":n[n.length]={t:a===1?"t":l,v:l},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=l;s<t.length&&"0123456789".indexOf(t.charAt(++s))>-1;)o+=t.charAt(s);n[n.length]={t:"D",v:o};break;case" ":n[n.length]={t:l,v:l},++s;break;case"$":n[n.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);n[n.length]={t:"t",v:l},++s;break}var g=0,x=0,y;for(s=n.length-1,c="t";s>=0;--s)switch(n[s].t){case"h":case"H":n[s].t=f,c="h",g<1&&(g=1);break;case"s":(y=n[s].v.match(/\.0+$/))&&(x=Math.max(x,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=n[s].t;break;case"m":c==="s"&&(n[s].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[s].v.match(/[Hh]/)&&(g=1),g<2&&n[s].v.match(/[Mm]/)&&(g=2),g<3&&n[s].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M),i.M>=60&&(i.M=0,++i.H);break;case 2:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M);break}var E="",N;for(s=0;s<n.length;++s)switch(n[s].t){case"t":case"T":case" ":case"D":break;case"X":n[s].v="",n[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[s].v=xj(n[s].t.charCodeAt(0),n[s].v,i,x),n[s].t="t";break;case"n":case"?":for(N=s+1;n[N]!=null&&((l=n[N].t)==="?"||l==="D"||(l===" "||l==="t")&&n[N+1]!=null&&(n[N+1].t==="?"||n[N+1].t==="t"&&n[N+1].v==="/")||n[s].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(n[N].v==="/"||n[N].v===" "&&n[N+1]!=null&&n[N+1].t=="?"));)n[s].v+=n[N].v,n[N]={v:"",t:";"},++N;E+=n[s].v,s=N-1;break;case"G":n[s].t="t",n[s].v=Bo(r,e);break}var I="",P,V;if(E.length>0){E.charCodeAt(0)==40?(P=r<0&&E.charCodeAt(0)===45?-r:r,V=ni("n",E,P)):(P=r<0&&a>1?-r:r,V=ni("n",E,P),P<0&&n[0]&&n[0].t=="t"&&(V=V.substr(1),n[0].v="-"+n[0].v)),N=V.length-1;var U=n.length;for(s=0;s<n.length;++s)if(n[s]!=null&&n[s].t!="t"&&n[s].v.indexOf(".")>-1){U=s;break}var H=n.length;if(U===n.length&&V.indexOf("E")===-1){for(s=n.length-1;s>=0;--s)n[s]==null||"n?".indexOf(n[s].t)===-1||(N>=n[s].v.length-1?(N-=n[s].v.length,n[s].v=V.substr(N+1,n[s].v.length)):N<0?n[s].v="":(n[s].v=V.substr(0,N+1),N=-1),n[s].t="t",H=s);N>=0&&H<n.length&&(n[H].v=V.substr(0,N+1)+n[H].v)}else if(U!==n.length&&V.indexOf("E")===-1){for(N=V.indexOf(".")-1,s=U;s>=0;--s)if(!(n[s]==null||"n?".indexOf(n[s].t)===-1)){for(u=n[s].v.indexOf(".")>-1&&s===U?n[s].v.indexOf(".")-1:n[s].v.length-1,I=n[s].v.substr(u+1);u>=0;--u)N>=0&&(n[s].v.charAt(u)==="0"||n[s].v.charAt(u)==="#")&&(I=V.charAt(N--)+I);n[s].v=I,n[s].t="t",H=s}for(N>=0&&H<n.length&&(n[H].v=V.substr(0,N+1)+n[H].v),N=V.indexOf(".")+1,s=U;s<n.length;++s)if(!(n[s]==null||"n?(".indexOf(n[s].t)===-1&&s!==U)){for(u=n[s].v.indexOf(".")>-1&&s===U?n[s].v.indexOf(".")+1:0,I=n[s].v.substr(0,u);u<n[s].v.length;++u)N<V.length&&(I+=V.charAt(N++));n[s].v=I,n[s].t="t",H=s}}}for(s=0;s<n.length;++s)n[s]!=null&&"n?".indexOf(n[s].t)>-1&&(P=a>1&&r<0&&s>0&&n[s-1].v==="-"?-r:r,n[s].v=ni(n[s].t,n[s].v,P),n[s].t="t");var G="";for(s=0;s!==n.length;++s)n[s]!=null&&(G+=n[s].v);return G}var ey=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ty(t,r){if(r==null)return!1;var e=parseFloat(r[2]);switch(r[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0;break}return!1}function jj(t,r){var e=Cj(t),a=e.length,n=e[a-1].indexOf("@");if(a<4&&n>-1&&--a,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof r!="number")return[4,e.length===4||n>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=n>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=n>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=n>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var o=r>0?e[0]:r<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[a,o];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var s=e[0].match(ey),l=e[1].match(ey);return ty(r,s)?[a,e[0]]:ty(r,l)?[a,e[1]]:[a,e[s!=null&&l!=null?2:1]]}return[a,o]}function Hn(t,r,e){e==null&&(e={});var a="";switch(typeof t){case"string":t=="m/d/yy"&&e.dateNF?a=e.dateNF:a=t;break;case"number":t==14&&e.dateNF?a=e.dateNF:a=(e.table!=null?e.table:rr)[t],a==null&&(a=e.table&&e.table[Zx[t]]||rr[Zx[t]]),a==null&&(a=fj[t]||"General");break}if(Nf(a,0))return Bo(r,e);r instanceof Date&&(r=c_(r,e.date1904));var n=jj(a,r);if(Nf(n[1]))return Bo(r,e);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return Nj(n[1],r,e,n[0])}function Po(t,r){if(typeof r!="number"){r=+r||-1;for(var e=0;e<392;++e){if(rr[e]==null){r<0&&(r=e);continue}if(rr[e]==t){r=e;break}}r<0&&(r=391)}return rr[r]=t,r}function b_(){rr=dj()}var Oj={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},x_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Dj(t){var r=typeof t=="number"?rr[t]:t;return r=r.replace(x_,"(\\d+)"),new RegExp("^"+r+"$")}function Mj(t,r,e){var a=-1,n=-1,o=-1,s=-1,l=-1,c=-1;(r.match(x_)||[]).forEach(function(p,f){var h=parseInt(e[f+1],10);switch(p.toLowerCase().charAt(0)){case"y":a=h;break;case"d":o=h;break;case"h":s=h;break;case"s":c=h;break;case"m":s>=0?l=h:n=h;break}}),c>=0&&l==-1&&n>=0&&(l=n,n=-1);var i=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);i.length==7&&(i="0"+i),i.length==8&&(i="20"+i);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&l==-1&&c==-1?i:a==-1&&n==-1&&o==-1?u:i+"T"+u}var Rj=function(){var t={};t.version="1.2.0";function r(){for(var V=0,U=new Array(256),H=0;H!=256;++H)V=H,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,U[H]=V;return typeof Int32Array<"u"?new Int32Array(U):U}var e=r();function a(V){var U=0,H=0,G=0,Z=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(G=0;G!=256;++G)Z[G]=V[G];for(G=0;G!=256;++G)for(H=V[G],U=256+G;U<4096;U+=256)H=Z[U]=H>>>8^V[H&255];var W=[];for(G=1;G!=16;++G)W[G-1]=typeof Int32Array<"u"?Z.subarray(G*256,G*256+256):Z.slice(G*256,G*256+256);return W}var n=a(e),o=n[0],s=n[1],l=n[2],c=n[3],i=n[4],u=n[5],p=n[6],f=n[7],h=n[8],v=n[9],b=n[10],g=n[11],x=n[12],y=n[13],E=n[14];function N(V,U){for(var H=U^-1,G=0,Z=V.length;G<Z;)H=H>>>8^e[(H^V.charCodeAt(G++))&255];return~H}function I(V,U){for(var H=U^-1,G=V.length-15,Z=0;Z<G;)H=E[V[Z++]^H&255]^y[V[Z++]^H>>8&255]^x[V[Z++]^H>>16&255]^g[V[Z++]^H>>>24]^b[V[Z++]]^v[V[Z++]]^h[V[Z++]]^f[V[Z++]]^p[V[Z++]]^u[V[Z++]]^i[V[Z++]]^c[V[Z++]]^l[V[Z++]]^s[V[Z++]]^o[V[Z++]]^e[V[Z++]];for(G+=15;Z<G;)H=H>>>8^e[(H^V[Z++])&255];return~H}function P(V,U){for(var H=U^-1,G=0,Z=V.length,W=0,O=0;G<Z;)W=V.charCodeAt(G++),W<128?H=H>>>8^e[(H^W)&255]:W<2048?(H=H>>>8^e[(H^(192|W>>6&31))&255],H=H>>>8^e[(H^(128|W&63))&255]):W>=55296&&W<57344?(W=(W&1023)+64,O=V.charCodeAt(G++)&1023,H=H>>>8^e[(H^(240|W>>8&7))&255],H=H>>>8^e[(H^(128|W>>2&63))&255],H=H>>>8^e[(H^(128|O>>6&15|(W&3)<<4))&255],H=H>>>8^e[(H^(128|O&63))&255]):(H=H>>>8^e[(H^(224|W>>12&15))&255],H=H>>>8^e[(H^(128|W>>6&63))&255],H=H>>>8^e[(H^(128|W&63))&255]);return~H}return t.table=e,t.bstr=N,t.buf=I,t.str=P,t}(),pr=function(){var r={};r.version="1.2.1";function e(ie,_e){for(var de=ie.split("/"),ve=_e.split("/"),be=0,we=0,De=Math.min(de.length,ve.length);be<De;++be){if(we=de[be].length-ve[be].length)return we;if(de[be]!=ve[be])return de[be]<ve[be]?-1:1}return de.length-ve.length}function a(ie){if(ie.charAt(ie.length-1)=="/")return ie.slice(0,-1).indexOf("/")===-1?ie:a(ie.slice(0,-1));var _e=ie.lastIndexOf("/");return _e===-1?ie:ie.slice(0,_e+1)}function n(ie){if(ie.charAt(ie.length-1)=="/")return n(ie.slice(0,-1));var _e=ie.lastIndexOf("/");return _e===-1?ie:ie.slice(_e+1)}function o(ie,_e){typeof _e=="string"&&(_e=new Date(_e));var de=_e.getHours();de=de<<6|_e.getMinutes(),de=de<<5|_e.getSeconds()>>>1,ie.write_shift(2,de);var ve=_e.getFullYear()-1980;ve=ve<<4|_e.getMonth()+1,ve=ve<<5|_e.getDate(),ie.write_shift(2,ve)}function s(ie){var _e=ie.read_shift(2)&65535,de=ie.read_shift(2)&65535,ve=new Date,be=de&31;de>>>=5;var we=de&15;de>>>=4,ve.setMilliseconds(0),ve.setFullYear(de+1980),ve.setMonth(we-1),ve.setDate(be);var De=_e&31;_e>>>=5;var Le=_e&63;return _e>>>=6,ve.setHours(_e),ve.setMinutes(Le),ve.setSeconds(De<<1),ve}function l(ie){ja(ie,0);for(var _e={},de=0;ie.l<=ie.length-4;){var ve=ie.read_shift(2),be=ie.read_shift(2),we=ie.l+be,De={};switch(ve){case 21589:de=ie.read_shift(1),de&1&&(De.mtime=ie.read_shift(4)),be>5&&(de&2&&(De.atime=ie.read_shift(4)),de&4&&(De.ctime=ie.read_shift(4))),De.mtime&&(De.mt=new Date(De.mtime*1e3));break}ie.l=we,_e[ve]=De}return _e}var c;function i(){return c||(c={})}function u(ie,_e){if(ie[0]==80&&ie[1]==75)return Ue(ie,_e);if((ie[0]|32)==109&&(ie[1]|32)==105)return yt(ie,_e);if(ie.length<512)throw new Error("CFB file size "+ie.length+" < 512");var de=3,ve=512,be=0,we=0,De=0,Le=0,Oe=0,Pe=[],Be=ie.slice(0,512);ja(Be,0);var xe=p(Be);switch(de=xe[0],de){case 3:ve=512;break;case 4:ve=4096;break;case 0:if(xe[1]==0)return Ue(ie,_e);default:throw new Error("Major Version: Expected 3 or 4 saw "+de)}ve!==512&&(Be=ie.slice(0,ve),ja(Be,28));var Ee=ie.slice(0,ve);f(Be,de);var qe=Be.read_shift(4,"i");if(de===3&&qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qe);Be.l+=4,De=Be.read_shift(4,"i"),Be.l+=4,Be.chk("00100000","Mini Stream Cutoff Size: "),Le=Be.read_shift(4,"i"),be=Be.read_shift(4,"i"),Oe=Be.read_shift(4,"i"),we=Be.read_shift(4,"i");for(var ce=-1,Te=0;Te<109&&(ce=Be.read_shift(4,"i"),!(ce<0));++Te)Pe[Te]=ce;var me=h(ie,ve);g(Oe,we,me,ve,Pe);var ye=y(me,De,Pe,ve);ye[De].name="!Directory",be>0&&Le!==O&&(ye[Le].name="!MiniFAT"),ye[Pe[0]].name="!FAT",ye.fat_addrs=Pe,ye.ssz=ve;var Ve={},$e=[],ot=[],Rt=[];E(De,ye,me,$e,be,Ve,ot,Le),v(ot,Rt,$e),$e.shift();var Bt={FileIndex:ot,FullPaths:Rt};return _e&&_e.raw&&(Bt.raw={header:Ee,sectors:me}),Bt}function p(ie){if(ie[ie.l]==80&&ie[ie.l+1]==75)return[0,0];ie.chk(R,"Header Signature: "),ie.l+=16;var _e=ie.read_shift(2,"u");return[ie.read_shift(2,"u"),_e]}function f(ie,_e){var de=9;switch(ie.l+=2,de=ie.read_shift(2)){case 9:if(_e!=3)throw new Error("Sector Shift: Expected 9 saw "+de);break;case 12:if(_e!=4)throw new Error("Sector Shift: Expected 12 saw "+de);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+de)}ie.chk("0600","Mini Sector Shift: "),ie.chk("000000000000","Reserved: ")}function h(ie,_e){for(var de=Math.ceil(ie.length/_e)-1,ve=[],be=1;be<de;++be)ve[be-1]=ie.slice(be*_e,(be+1)*_e);return ve[de-1]=ie.slice(de*_e),ve}function v(ie,_e,de){for(var ve=0,be=0,we=0,De=0,Le=0,Oe=de.length,Pe=[],Be=[];ve<Oe;++ve)Pe[ve]=Be[ve]=ve,_e[ve]=de[ve];for(;Le<Be.length;++Le)ve=Be[Le],be=ie[ve].L,we=ie[ve].R,De=ie[ve].C,Pe[ve]===ve&&(be!==-1&&Pe[be]!==be&&(Pe[ve]=Pe[be]),we!==-1&&Pe[we]!==we&&(Pe[ve]=Pe[we])),De!==-1&&(Pe[De]=ve),be!==-1&&ve!=Pe[ve]&&(Pe[be]=Pe[ve],Be.lastIndexOf(be)<Le&&Be.push(be)),we!==-1&&ve!=Pe[ve]&&(Pe[we]=Pe[ve],Be.lastIndexOf(we)<Le&&Be.push(we));for(ve=1;ve<Oe;++ve)Pe[ve]===ve&&(we!==-1&&Pe[we]!==we?Pe[ve]=Pe[we]:be!==-1&&Pe[be]!==be&&(Pe[ve]=Pe[be]));for(ve=1;ve<Oe;++ve)if(ie[ve].type!==0){if(Le=ve,Le!=Pe[Le])do Le=Pe[Le],_e[ve]=_e[Le]+"/"+_e[ve];while(Le!==0&&Pe[Le]!==-1&&Le!=Pe[Le]);Pe[ve]=-1}for(_e[0]+="/",ve=1;ve<Oe;++ve)ie[ve].type!==2&&(_e[ve]+="/")}function b(ie,_e,de){for(var ve=ie.start,be=ie.size,we=[],De=ve;de&&be>0&&De>=0;)we.push(_e.slice(De*W,De*W+W)),be-=W,De=Do(de,De*4);return we.length===0?ga(0):qi(we).slice(0,ie.size)}function g(ie,_e,de,ve,be){var we=O;if(ie===O){if(_e!==0)throw new Error("DIFAT chain shorter than expected")}else if(ie!==-1){var De=de[ie],Le=(ve>>>2)-1;if(!De)return;for(var Oe=0;Oe<Le&&(we=Do(De,Oe*4))!==O;++Oe)be.push(we);g(Do(De,ve-4),_e-1,de,ve,be)}}function x(ie,_e,de,ve,be){var we=[],De=[];be||(be=[]);var Le=ve-1,Oe=0,Pe=0;for(Oe=_e;Oe>=0;){be[Oe]=!0,we[we.length]=Oe,De.push(ie[Oe]);var Be=de[Math.floor(Oe*4/ve)];if(Pe=Oe*4&Le,ve<4+Pe)throw new Error("FAT boundary crossed: "+Oe+" 4 "+ve);if(!ie[Be])break;Oe=Do(ie[Be],Pe)}return{nodes:we,data:dy([De])}}function y(ie,_e,de,ve){var be=ie.length,we=[],De=[],Le=[],Oe=[],Pe=ve-1,Be=0,xe=0,Ee=0,qe=0;for(Be=0;Be<be;++Be)if(Le=[],Ee=Be+_e,Ee>=be&&(Ee-=be),!De[Ee]){Oe=[];var ce=[];for(xe=Ee;xe>=0;){ce[xe]=!0,De[xe]=!0,Le[Le.length]=xe,Oe.push(ie[xe]);var Te=de[Math.floor(xe*4/ve)];if(qe=xe*4&Pe,ve<4+qe)throw new Error("FAT boundary crossed: "+xe+" 4 "+ve);if(!ie[Te]||(xe=Do(ie[Te],qe),ce[xe]))break}we[Ee]={nodes:Le,data:dy([Oe])}}return we}function E(ie,_e,de,ve,be,we,De,Le){for(var Oe=0,Pe=ve.length?2:0,Be=_e[ie].data,xe=0,Ee=0,qe;xe<Be.length;xe+=128){var ce=Be.slice(xe,xe+128);ja(ce,64),Ee=ce.read_shift(2),qe=Xm(ce,0,Ee-Pe),ve.push(qe);var Te={name:qe,type:ce.read_shift(1),color:ce.read_shift(1),L:ce.read_shift(4,"i"),R:ce.read_shift(4,"i"),C:ce.read_shift(4,"i"),clsid:ce.read_shift(16),state:ce.read_shift(4,"i"),start:0,size:0},me=ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2);me!==0&&(Te.ct=N(ce,ce.l-8));var ye=ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2);ye!==0&&(Te.mt=N(ce,ce.l-8)),Te.start=ce.read_shift(4,"i"),Te.size=ce.read_shift(4,"i"),Te.size<0&&Te.start<0&&(Te.size=Te.type=0,Te.start=O,Te.name=""),Te.type===5?(Oe=Te.start,be>0&&Oe!==O&&(_e[Oe].name="!StreamData")):Te.size>=4096?(Te.storage="fat",_e[Te.start]===void 0&&(_e[Te.start]=x(de,Te.start,_e.fat_addrs,_e.ssz)),_e[Te.start].name=Te.name,Te.content=_e[Te.start].data.slice(0,Te.size)):(Te.storage="minifat",Te.size<0?Te.size=0:Oe!==O&&Te.start!==O&&_e[Oe]&&(Te.content=b(Te,_e[Oe].data,(_e[Le]||{}).data))),Te.content&&ja(Te.content,0),we[qe]=Te,De.push(Te)}}function N(ie,_e){return new Date((wn(ie,_e+4)/1e7*Math.pow(2,32)+wn(ie,_e)/1e7-11644473600)*1e3)}function I(ie,_e){return i(),u(c.readFileSync(ie),_e)}function P(ie,_e){var de=_e&&_e.type;switch(de||fr&&Buffer.isBuffer(ie)&&(de="buffer"),de||"base64"){case"file":return I(ie,_e);case"base64":return u(is(Tn(ie)),_e);case"binary":return u(is(ie),_e)}return u(ie,_e)}function V(ie,_e){var de=_e||{},ve=de.root||"Root Entry";if(ie.FullPaths||(ie.FullPaths=[]),ie.FileIndex||(ie.FileIndex=[]),ie.FullPaths.length!==ie.FileIndex.length)throw new Error("inconsistent CFB structure");ie.FullPaths.length===0&&(ie.FullPaths[0]=ve+"/",ie.FileIndex[0]={name:ve,type:5}),de.CLSID&&(ie.FileIndex[0].clsid=de.CLSID),U(ie)}function U(ie){var _e="Sh33tJ5";if(!pr.find(ie,"/"+_e)){var de=ga(4);de[0]=55,de[1]=de[3]=50,de[2]=54,ie.FileIndex.push({name:_e,type:2,content:de,size:4,L:69,R:69,C:69}),ie.FullPaths.push(ie.FullPaths[0]+_e),H(ie)}}function H(ie,_e){V(ie);for(var de=!1,ve=!1,be=ie.FullPaths.length-1;be>=0;--be){var we=ie.FileIndex[be];switch(we.type){case 0:ve?de=!0:(ie.FileIndex.pop(),ie.FullPaths.pop());break;case 1:case 2:case 5:ve=!0,isNaN(we.R*we.L*we.C)&&(de=!0),we.R>-1&&we.L>-1&&we.R==we.L&&(de=!0);break;default:de=!0;break}}if(!(!de&&!_e)){var De=new Date(1987,1,19),Le=0,Oe=Object.create?Object.create(null):{},Pe=[];for(be=0;be<ie.FullPaths.length;++be)Oe[ie.FullPaths[be]]=!0,ie.FileIndex[be].type!==0&&Pe.push([ie.FullPaths[be],ie.FileIndex[be]]);for(be=0;be<Pe.length;++be){var Be=a(Pe[be][0]);ve=Oe[Be],ve||(Pe.push([Be,{name:n(Be).replace("/",""),type:1,clsid:_,ct:De,mt:De,content:null}]),Oe[Be]=!0)}for(Pe.sort(function(qe,ce){return e(qe[0],ce[0])}),ie.FullPaths=[],ie.FileIndex=[],be=0;be<Pe.length;++be)ie.FullPaths[be]=Pe[be][0],ie.FileIndex[be]=Pe[be][1];for(be=0;be<Pe.length;++be){var xe=ie.FileIndex[be],Ee=ie.FullPaths[be];if(xe.name=n(Ee).replace("/",""),xe.L=xe.R=xe.C=-(xe.color=1),xe.size=xe.content?xe.content.length:0,xe.start=0,xe.clsid=xe.clsid||_,be===0)xe.C=Pe.length>1?1:-1,xe.size=0,xe.type=5;else if(Ee.slice(-1)=="/"){for(Le=be+1;Le<Pe.length&&a(ie.FullPaths[Le])!=Ee;++Le);for(xe.C=Le>=Pe.length?-1:Le,Le=be+1;Le<Pe.length&&a(ie.FullPaths[Le])!=a(Ee);++Le);xe.R=Le>=Pe.length?-1:Le,xe.type=1}else a(ie.FullPaths[be+1]||"")==a(Ee)&&(xe.R=be+1),xe.type=2}}}function G(ie,_e){var de=_e||{};if(de.fileType=="mad")return Ct(ie,de);switch(H(ie),de.fileType){case"zip":return tt(ie,de)}var ve=function(qe){for(var ce=0,Te=0,me=0;me<qe.FileIndex.length;++me){var ye=qe.FileIndex[me];if(ye.content){var Ve=ye.content.length;Ve>0&&(Ve<4096?ce+=Ve+63>>6:Te+=Ve+511>>9)}}for(var $e=qe.FullPaths.length+3>>2,ot=ce+7>>3,Rt=ce+127>>7,Bt=ot+Te+$e+Rt,Vt=Bt+127>>7,Lt=Vt<=109?0:Math.ceil((Vt-109)/127);Bt+Vt+Lt+127>>7>Vt;)Lt=++Vt<=109?0:Math.ceil((Vt-109)/127);var er=[1,Lt,Vt,Rt,$e,Te,ce,0];return qe.FileIndex[0].size=ce<<6,er[7]=(qe.FileIndex[0].start=er[0]+er[1]+er[2]+er[3]+er[4]+er[5])+(er[6]+7>>3),er}(ie),be=ga(ve[7]<<9),we=0,De=0;{for(we=0;we<8;++we)be.write_shift(1,C[we]);for(we=0;we<8;++we)be.write_shift(2,0);for(be.write_shift(2,62),be.write_shift(2,3),be.write_shift(2,65534),be.write_shift(2,9),be.write_shift(2,6),we=0;we<3;++we)be.write_shift(2,0);for(be.write_shift(4,0),be.write_shift(4,ve[2]),be.write_shift(4,ve[0]+ve[1]+ve[2]+ve[3]-1),be.write_shift(4,0),be.write_shift(4,4096),be.write_shift(4,ve[3]?ve[0]+ve[1]+ve[2]-1:O),be.write_shift(4,ve[3]),be.write_shift(-4,ve[1]?ve[0]-1:O),be.write_shift(4,ve[1]),we=0;we<109;++we)be.write_shift(-4,we<ve[2]?ve[1]+we:-1)}if(ve[1])for(De=0;De<ve[1];++De){for(;we<236+De*127;++we)be.write_shift(-4,we<ve[2]?ve[1]+we:-1);be.write_shift(-4,De===ve[1]-1?O:De+1)}var Le=function(qe){for(De+=qe;we<De-1;++we)be.write_shift(-4,we+1);qe&&(++we,be.write_shift(-4,O))};for(De=we=0,De+=ve[1];we<De;++we)be.write_shift(-4,k.DIFSECT);for(De+=ve[2];we<De;++we)be.write_shift(-4,k.FATSECT);Le(ve[3]),Le(ve[4]);for(var Oe=0,Pe=0,Be=ie.FileIndex[0];Oe<ie.FileIndex.length;++Oe)Be=ie.FileIndex[Oe],Be.content&&(Pe=Be.content.length,!(Pe<4096)&&(Be.start=De,Le(Pe+511>>9)));for(Le(ve[6]+7>>3);be.l&511;)be.write_shift(-4,k.ENDOFCHAIN);for(De=we=0,Oe=0;Oe<ie.FileIndex.length;++Oe)Be=ie.FileIndex[Oe],Be.content&&(Pe=Be.content.length,!(!Pe||Pe>=4096)&&(Be.start=De,Le(Pe+63>>6)));for(;be.l&511;)be.write_shift(-4,k.ENDOFCHAIN);for(we=0;we<ve[4]<<2;++we){var xe=ie.FullPaths[we];if(!xe||xe.length===0){for(Oe=0;Oe<17;++Oe)be.write_shift(4,0);for(Oe=0;Oe<3;++Oe)be.write_shift(4,-1);for(Oe=0;Oe<12;++Oe)be.write_shift(4,0);continue}Be=ie.FileIndex[we],we===0&&(Be.start=Be.size?Be.start-1:O);var Ee=we===0&&de.root||Be.name;if(Pe=2*(Ee.length+1),be.write_shift(64,Ee,"utf16le"),be.write_shift(2,Pe),be.write_shift(1,Be.type),be.write_shift(1,Be.color),be.write_shift(-4,Be.L),be.write_shift(-4,Be.R),be.write_shift(-4,Be.C),Be.clsid)be.write_shift(16,Be.clsid,"hex");else for(Oe=0;Oe<4;++Oe)be.write_shift(4,0);be.write_shift(4,Be.state||0),be.write_shift(4,0),be.write_shift(4,0),be.write_shift(4,0),be.write_shift(4,0),be.write_shift(4,Be.start),be.write_shift(4,Be.size),be.write_shift(4,0)}for(we=1;we<ie.FileIndex.length;++we)if(Be=ie.FileIndex[we],Be.size>=4096)if(be.l=Be.start+1<<9,fr&&Buffer.isBuffer(Be.content))Be.content.copy(be,be.l,0,Be.size),be.l+=Be.size+511&-512;else{for(Oe=0;Oe<Be.size;++Oe)be.write_shift(1,Be.content[Oe]);for(;Oe&511;++Oe)be.write_shift(1,0)}for(we=1;we<ie.FileIndex.length;++we)if(Be=ie.FileIndex[we],Be.size>0&&Be.size<4096)if(fr&&Buffer.isBuffer(Be.content))Be.content.copy(be,be.l,0,Be.size),be.l+=Be.size+63&-64;else{for(Oe=0;Oe<Be.size;++Oe)be.write_shift(1,Be.content[Oe]);for(;Oe&63;++Oe)be.write_shift(1,0)}if(fr)be.l=be.length;else for(;be.l<be.length;)be.write_shift(1,0);return be}function Z(ie,_e){var de=ie.FullPaths.map(function(Oe){return Oe.toUpperCase()}),ve=de.map(function(Oe){var Pe=Oe.split("/");return Pe[Pe.length-(Oe.slice(-1)=="/"?2:1)]}),be=!1;_e.charCodeAt(0)===47?(be=!0,_e=de[0].slice(0,-1)+_e):be=_e.indexOf("/")!==-1;var we=_e.toUpperCase(),De=be===!0?de.indexOf(we):ve.indexOf(we);if(De!==-1)return ie.FileIndex[De];var Le=!we.match(su);for(we=we.replace(Qa,""),Le&&(we=we.replace(su,"!")),De=0;De<de.length;++De)if((Le?de[De].replace(su,"!"):de[De]).replace(Qa,"")==we||(Le?ve[De].replace(su,"!"):ve[De]).replace(Qa,"")==we)return ie.FileIndex[De];return null}var W=64,O=-2,R="d0cf11e0a1b11ae1",C=[208,207,17,224,161,177,26,225],_="00000000000000000000000000000000",k={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:O,FREESECT:-1,HEADER_SIGNATURE:R,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:_,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function A(ie,_e,de){i();var ve=G(ie,de);c.writeFileSync(_e,ve)}function T(ie){for(var _e=new Array(ie.length),de=0;de<ie.length;++de)_e[de]=String.fromCharCode(ie[de]);return _e.join("")}function D(ie,_e){var de=G(ie,_e);switch(_e&&_e.type||"buffer"){case"file":return i(),c.writeFileSync(_e.filename,de),de;case"binary":return typeof de=="string"?de:T(de);case"base64":return Gx(typeof de=="string"?de:T(de));case"buffer":if(fr)return Buffer.isBuffer(de)?de:$o(de);case"array":return typeof de=="string"?is(de):de}return de}var B;function F(ie){try{var _e=ie.InflateRaw,de=new _e;if(de._processChunk(new Uint8Array([3,0]),de._finishFlushFlag),de.bytesRead)B=ie;else throw new Error("zlib does not expose bytesRead")}catch(ve){console.error("cannot use native zlib: "+(ve.message||ve))}}function Y(ie,_e){if(!B)return gt(ie,_e);var de=B.InflateRaw,ve=new de,be=ve._processChunk(ie.slice(ie.l),ve._finishFlushFlag);return ie.l+=ve.bytesRead,be}function X(ie){return B?B.deflateRawSync(ie):st(ie)}var re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function L(ie){var _e=(ie<<1|ie<<11)&139536|(ie<<5|ie<<15)&558144;return(_e>>16|_e>>8|_e)&255}for(var M=typeof Uint8Array<"u",K=M?new Uint8Array(256):[],se=0;se<256;++se)K[se]=L(se);function te(ie,_e){var de=K[ie&255];return _e<=8?de>>>8-_e:(de=de<<8|K[ie>>8&255],_e<=16?de>>>16-_e:(de=de<<8|K[ie>>16&255],de>>>24-_e))}function ae(ie,_e){var de=_e&7,ve=_e>>>3;return(ie[ve]|(de<=6?0:ie[ve+1]<<8))>>>de&3}function Q(ie,_e){var de=_e&7,ve=_e>>>3;return(ie[ve]|(de<=5?0:ie[ve+1]<<8))>>>de&7}function fe(ie,_e){var de=_e&7,ve=_e>>>3;return(ie[ve]|(de<=4?0:ie[ve+1]<<8))>>>de&15}function le(ie,_e){var de=_e&7,ve=_e>>>3;return(ie[ve]|(de<=3?0:ie[ve+1]<<8))>>>de&31}function ne(ie,_e){var de=_e&7,ve=_e>>>3;return(ie[ve]|(de<=1?0:ie[ve+1]<<8))>>>de&127}function ue(ie,_e,de){var ve=_e&7,be=_e>>>3,we=(1<<de)-1,De=ie[be]>>>ve;return de<8-ve||(De|=ie[be+1]<<8-ve,de<16-ve)||(De|=ie[be+2]<<16-ve,de<24-ve)||(De|=ie[be+3]<<24-ve),De&we}function he(ie,_e,de){var ve=_e&7,be=_e>>>3;return ve<=5?ie[be]|=(de&7)<<ve:(ie[be]|=de<<ve&255,ie[be+1]=(de&7)>>8-ve),_e+3}function ke(ie,_e,de){var ve=_e&7,be=_e>>>3;return de=(de&1)<<ve,ie[be]|=de,_e+1}function pe(ie,_e,de){var ve=_e&7,be=_e>>>3;return de<<=ve,ie[be]|=de&255,de>>>=8,ie[be+1]=de,_e+8}function Ce(ie,_e,de){var ve=_e&7,be=_e>>>3;return de<<=ve,ie[be]|=de&255,de>>>=8,ie[be+1]=de&255,ie[be+2]=de>>>8,_e+16}function Me(ie,_e){var de=ie.length,ve=2*de>_e?2*de:_e+5,be=0;if(de>=_e)return ie;if(fr){var we=Yx(ve);if(ie.copy)ie.copy(we);else for(;be<ie.length;++be)we[be]=ie[be];return we}else if(M){var De=new Uint8Array(ve);if(De.set)De.set(ie);else for(;be<de;++be)De[be]=ie[be];return De}return ie.length=ve,ie}function Ie(ie){for(var _e=new Array(ie),de=0;de<ie;++de)_e[de]=0;return _e}function Ye(ie,_e,de){var ve=1,be=0,we=0,De=0,Le=0,Oe=ie.length,Pe=M?new Uint16Array(32):Ie(32);for(we=0;we<32;++we)Pe[we]=0;for(we=Oe;we<de;++we)ie[we]=0;Oe=ie.length;var Be=M?new Uint16Array(Oe):Ie(Oe);for(we=0;we<Oe;++we)Pe[be=ie[we]]++,ve<be&&(ve=be),Be[we]=0;for(Pe[0]=0,we=1;we<=ve;++we)Pe[we+16]=Le=Le+Pe[we-1]<<1;for(we=0;we<Oe;++we)Le=ie[we],Le!=0&&(Be[we]=Pe[Le+16]++);var xe=0;for(we=0;we<Oe;++we)if(xe=ie[we],xe!=0)for(Le=te(Be[we],ve)>>ve-xe,De=(1<<ve+4-xe)-1;De>=0;--De)_e[Le|De<<xe]=xe&15|we<<4;return ve}var at=M?new Uint16Array(512):Ie(512),rt=M?new Uint16Array(32):Ie(32);if(!M){for(var it=0;it<512;++it)at[it]=0;for(it=0;it<32;++it)rt[it]=0}(function(){for(var ie=[],_e=0;_e<32;_e++)ie.push(5);Ye(ie,rt,32);var de=[];for(_e=0;_e<=143;_e++)de.push(8);for(;_e<=255;_e++)de.push(9);for(;_e<=279;_e++)de.push(7);for(;_e<=287;_e++)de.push(8);Ye(de,at,288)})();var et=function(){for(var _e=M?new Uint8Array(32768):[],de=0,ve=0;de<ee.length-1;++de)for(;ve<ee[de+1];++ve)_e[ve]=de;for(;ve<32768;++ve)_e[ve]=29;var be=M?new Uint8Array(259):[];for(de=0,ve=0;de<z.length-1;++de)for(;ve<z[de+1];++ve)be[ve]=de;function we(Le,Oe){for(var Pe=0;Pe<Le.length;){var Be=Math.min(65535,Le.length-Pe),xe=Pe+Be==Le.length;for(Oe.write_shift(1,+xe),Oe.write_shift(2,Be),Oe.write_shift(2,~Be&65535);Be-- >0;)Oe[Oe.l++]=Le[Pe++]}return Oe.l}function De(Le,Oe){for(var Pe=0,Be=0,xe=M?new Uint16Array(32768):[];Be<Le.length;){var Ee=Math.min(65535,Le.length-Be);if(Ee<10){for(Pe=he(Oe,Pe,+(Be+Ee==Le.length)),Pe&7&&(Pe+=8-(Pe&7)),Oe.l=Pe/8|0,Oe.write_shift(2,Ee),Oe.write_shift(2,~Ee&65535);Ee-- >0;)Oe[Oe.l++]=Le[Be++];Pe=Oe.l*8;continue}Pe=he(Oe,Pe,+(Be+Ee==Le.length)+2);for(var qe=0;Ee-- >0;){var ce=Le[Be];qe=(qe<<5^ce)&32767;var Te=-1,me=0;if((Te=xe[qe])&&(Te|=Be&-32768,Te>Be&&(Te-=32768),Te<Be))for(;Le[Te+me]==Le[Be+me]&&me<250;)++me;if(me>2){ce=be[me],ce<=22?Pe=pe(Oe,Pe,K[ce+1]>>1)-1:(pe(Oe,Pe,3),Pe+=5,pe(Oe,Pe,K[ce-23]>>5),Pe+=3);var ye=ce<8?0:ce-4>>2;ye>0&&(Ce(Oe,Pe,me-z[ce]),Pe+=ye),ce=_e[Be-Te],Pe=pe(Oe,Pe,K[ce]>>3),Pe-=3;var Ve=ce<4?0:ce-2>>1;Ve>0&&(Ce(Oe,Pe,Be-Te-ee[ce]),Pe+=Ve);for(var $e=0;$e<me;++$e)xe[qe]=Be&32767,qe=(qe<<5^Le[Be])&32767,++Be;Ee-=me-1}else ce<=143?ce=ce+48:Pe=ke(Oe,Pe,1),Pe=pe(Oe,Pe,K[ce]),xe[qe]=Be&32767,++Be}Pe=pe(Oe,Pe,0)-1}return Oe.l=(Pe+7)/8|0,Oe.l}return function(Oe,Pe){return Oe.length<8?we(Oe,Pe):De(Oe,Pe)}}();function st(ie){var _e=ga(50+Math.floor(ie.length*1.1)),de=et(ie,_e);return _e.slice(0,de)}var je=M?new Uint16Array(32768):Ie(32768),ht=M?new Uint16Array(32768):Ie(32768),Je=M?new Uint16Array(128):Ie(128),nt=1,ct=1;function _t(ie,_e){var de=le(ie,_e)+257;_e+=5;var ve=le(ie,_e)+1;_e+=5;var be=fe(ie,_e)+4;_e+=4;for(var we=0,De=M?new Uint8Array(19):Ie(19),Le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Oe=1,Pe=M?new Uint8Array(8):Ie(8),Be=M?new Uint8Array(8):Ie(8),xe=De.length,Ee=0;Ee<be;++Ee)De[re[Ee]]=we=Q(ie,_e),Oe<we&&(Oe=we),Pe[we]++,_e+=3;var qe=0;for(Pe[0]=0,Ee=1;Ee<=Oe;++Ee)Be[Ee]=qe=qe+Pe[Ee-1]<<1;for(Ee=0;Ee<xe;++Ee)(qe=De[Ee])!=0&&(Le[Ee]=Be[qe]++);var ce=0;for(Ee=0;Ee<xe;++Ee)if(ce=De[Ee],ce!=0){qe=K[Le[Ee]]>>8-ce;for(var Te=(1<<7-ce)-1;Te>=0;--Te)Je[qe|Te<<ce]=ce&7|Ee<<3}var me=[];for(Oe=1;me.length<de+ve;)switch(qe=Je[ne(ie,_e)],_e+=qe&7,qe>>>=3){case 16:for(we=3+ae(ie,_e),_e+=2,qe=me[me.length-1];we-- >0;)me.push(qe);break;case 17:for(we=3+Q(ie,_e),_e+=3;we-- >0;)me.push(0);break;case 18:for(we=11+ne(ie,_e),_e+=7;we-- >0;)me.push(0);break;default:me.push(qe),Oe<qe&&(Oe=qe);break}var ye=me.slice(0,de),Ve=me.slice(de);for(Ee=de;Ee<286;++Ee)ye[Ee]=0;for(Ee=ve;Ee<30;++Ee)Ve[Ee]=0;return nt=Ye(ye,je,286),ct=Ye(Ve,ht,30),_e}function mt(ie,_e){if(ie[0]==3&&!(ie[1]&3))return[eo(_e),2];for(var de=0,ve=0,be=Yx(_e||1<<18),we=0,De=be.length>>>0,Le=0,Oe=0;(ve&1)==0;){if(ve=Q(ie,de),de+=3,ve>>>1)ve>>1==1?(Le=9,Oe=5):(de=_t(ie,de),Le=nt,Oe=ct);else{de&7&&(de+=8-(de&7));var Pe=ie[de>>>3]|ie[(de>>>3)+1]<<8;if(de+=32,Pe>0)for(!_e&&De<we+Pe&&(be=Me(be,we+Pe),De=be.length);Pe-- >0;)be[we++]=ie[de>>>3],de+=8;continue}for(;;){!_e&&De<we+32767&&(be=Me(be,we+32767),De=be.length);var Be=ue(ie,de,Le),xe=ve>>>1==1?at[Be]:je[Be];if(de+=xe&15,xe>>>=4,(xe>>>8&255)===0)be[we++]=xe;else{if(xe==256)break;xe-=257;var Ee=xe<8?0:xe-4>>2;Ee>5&&(Ee=0);var qe=we+z[xe];Ee>0&&(qe+=ue(ie,de,Ee),de+=Ee),Be=ue(ie,de,Oe),xe=ve>>>1==1?rt[Be]:ht[Be],de+=xe&15,xe>>>=4;var ce=xe<4?0:xe-2>>1,Te=ee[xe];for(ce>0&&(Te+=ue(ie,de,ce),de+=ce),!_e&&De<qe&&(be=Me(be,qe+100),De=be.length);we<qe;)be[we]=be[we-Te],++we}}}return _e?[be,de+7>>>3]:[be.slice(0,we),de+7>>>3]}function gt(ie,_e){var de=ie.slice(ie.l||0),ve=mt(de,_e);return ie.l+=ve[1],ve[0]}function He(ie,_e){if(ie)typeof console<"u"&&console.error(_e);else throw new Error(_e)}function Ue(ie,_e){var de=ie;ja(de,0);var ve=[],be=[],we={FileIndex:ve,FullPaths:be};V(we,{root:_e.root});for(var De=de.length-4;(de[De]!=80||de[De+1]!=75||de[De+2]!=5||de[De+3]!=6)&&De>=0;)--De;de.l=De+4,de.l+=4;var Le=de.read_shift(2);de.l+=6;var Oe=de.read_shift(4);for(de.l=Oe,De=0;De<Le;++De){de.l+=20;var Pe=de.read_shift(4),Be=de.read_shift(4),xe=de.read_shift(2),Ee=de.read_shift(2),qe=de.read_shift(2);de.l+=8;var ce=de.read_shift(4),Te=l(de.slice(de.l+xe,de.l+xe+Ee));de.l+=xe+Ee+qe;var me=de.l;de.l=ce+4,bt(de,Pe,Be,we,Te),de.l=me}return we}function bt(ie,_e,de,ve,be){ie.l+=2;var we=ie.read_shift(2),De=ie.read_shift(2),Le=s(ie);if(we&8257)throw new Error("Unsupported ZIP encryption");for(var Oe=ie.read_shift(4),Pe=ie.read_shift(4),Be=ie.read_shift(4),xe=ie.read_shift(2),Ee=ie.read_shift(2),qe="",ce=0;ce<xe;++ce)qe+=String.fromCharCode(ie[ie.l++]);if(Ee){var Te=l(ie.slice(ie.l,ie.l+Ee));(Te[21589]||{}).mt&&(Le=Te[21589].mt),((be||{})[21589]||{}).mt&&(Le=be[21589].mt)}ie.l+=Ee;var me=ie.slice(ie.l,ie.l+Pe);switch(De){case 8:me=Y(ie,Be);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+De)}var ye=!1;we&8&&(Oe=ie.read_shift(4),Oe==134695760&&(Oe=ie.read_shift(4),ye=!0),Pe=ie.read_shift(4),Be=ie.read_shift(4)),Pe!=_e&&He(ye,"Bad compressed size: "+_e+" != "+Pe),Be!=de&&He(ye,"Bad uncompressed size: "+de+" != "+Be),kt(ve,qe,me,{unsafe:!0,mt:Le})}function tt(ie,_e){var de=_e||{},ve=[],be=[],we=ga(1),De=de.compression?8:0,Le=0,Oe=0,Pe=0,Be=0,xe=0,Ee=ie.FullPaths[0],qe=Ee,ce=ie.FileIndex[0],Te=[],me=0;for(Oe=1;Oe<ie.FullPaths.length;++Oe)if(qe=ie.FullPaths[Oe].slice(Ee.length),ce=ie.FileIndex[Oe],!(!ce.size||!ce.content||qe=="Sh33tJ5")){var ye=Be,Ve=ga(qe.length);for(Pe=0;Pe<qe.length;++Pe)Ve.write_shift(1,qe.charCodeAt(Pe)&127);Ve=Ve.slice(0,Ve.l),Te[xe]=Rj.buf(ce.content,0);var $e=ce.content;De==8&&($e=X($e)),we=ga(30),we.write_shift(4,67324752),we.write_shift(2,20),we.write_shift(2,Le),we.write_shift(2,De),ce.mt?o(we,ce.mt):we.write_shift(4,0),we.write_shift(-4,Te[xe]),we.write_shift(4,$e.length),we.write_shift(4,ce.content.length),we.write_shift(2,Ve.length),we.write_shift(2,0),Be+=we.length,ve.push(we),Be+=Ve.length,ve.push(Ve),Be+=$e.length,ve.push($e),we=ga(46),we.write_shift(4,33639248),we.write_shift(2,0),we.write_shift(2,20),we.write_shift(2,Le),we.write_shift(2,De),we.write_shift(4,0),we.write_shift(-4,Te[xe]),we.write_shift(4,$e.length),we.write_shift(4,ce.content.length),we.write_shift(2,Ve.length),we.write_shift(2,0),we.write_shift(2,0),we.write_shift(2,0),we.write_shift(2,0),we.write_shift(4,0),we.write_shift(4,ye),me+=we.l,be.push(we),me+=Ve.length,be.push(Ve),++xe}return we=ga(22),we.write_shift(4,101010256),we.write_shift(2,0),we.write_shift(2,0),we.write_shift(2,xe),we.write_shift(2,xe),we.write_shift(4,me),we.write_shift(4,Be),we.write_shift(2,0),qi([qi(ve),qi(be),we])}var dt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ut(ie,_e){if(ie.ctype)return ie.ctype;var de=ie.name||"",ve=de.match(/\.([^\.]+)$/);return ve&&dt[ve[1]]||_e&&(ve=(de=_e).match(/[\.\\]([^\.\\])+$/),ve&&dt[ve[1]])?dt[ve[1]]:"application/octet-stream"}function vt(ie){for(var _e=Gx(ie),de=[],ve=0;ve<_e.length;ve+=76)de.push(_e.slice(ve,ve+76));return de.join(`\r
`)+`\r
`}function xt(ie){var _e=ie.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Pe){var Be=Pe.charCodeAt(0).toString(16).toUpperCase();return"="+(Be.length==1?"0"+Be:Be)});_e=_e.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),_e.charAt(0)==`
`&&(_e="=0D"+_e.slice(1)),_e=_e.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var de=[],ve=_e.split(`\r
`),be=0;be<ve.length;++be){var we=ve[be];if(we.length==0){de.push("");continue}for(var De=0;De<we.length;){var Le=76,Oe=we.slice(De,De+Le);Oe.charAt(Le-1)=="="?Le--:Oe.charAt(Le-2)=="="?Le-=2:Oe.charAt(Le-3)=="="&&(Le-=3),Oe=we.slice(De,De+Le),De+=Le,De<we.length&&(Oe+="="),de.push(Oe)}}return de.join(`\r
`)}function At(ie){for(var _e=[],de=0;de<ie.length;++de){for(var ve=ie[de];de<=ie.length&&ve.charAt(ve.length-1)=="=";)ve=ve.slice(0,ve.length-1)+ie[++de];_e.push(ve)}for(var be=0;be<_e.length;++be)_e[be]=_e[be].replace(/[=][0-9A-Fa-f]{2}/g,function(we){return String.fromCharCode(parseInt(we.slice(1),16))});return is(_e.join(`\r
`))}function Kt(ie,_e,de){for(var ve="",be="",we="",De,Le=0;Le<10;++Le){var Oe=_e[Le];if(!Oe||Oe.match(/^\s*$/))break;var Pe=Oe.match(/^(.*?):\s*([^\s].*)$/);if(Pe)switch(Pe[1].toLowerCase()){case"content-location":ve=Pe[2].trim();break;case"content-type":we=Pe[2].trim();break;case"content-transfer-encoding":be=Pe[2].trim();break}}switch(++Le,be.toLowerCase()){case"base64":De=is(Tn(_e.slice(Le).join("")));break;case"quoted-printable":De=At(_e.slice(Le));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+be)}var Be=kt(ie,ve.slice(de.length),De,{unsafe:!0});we&&(Be.ctype=we)}function yt(ie,_e){if(T(ie.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var de=_e&&_e.root||"",ve=(fr&&Buffer.isBuffer(ie)?ie.toString("binary"):T(ie)).split(`\r
`),be=0,we="";for(be=0;be<ve.length;++be)if(we=ve[be],!!/^Content-Location:/i.test(we)&&(we=we.slice(we.indexOf("file")),de||(de=we.slice(0,we.lastIndexOf("/")+1)),we.slice(0,de.length)!=de))for(;de.length>0&&(de=de.slice(0,de.length-1),de=de.slice(0,de.lastIndexOf("/")+1),we.slice(0,de.length)!=de););var De=(ve[1]||"").match(/boundary="(.*?)"/);if(!De)throw new Error("MAD cannot find boundary");var Le="--"+(De[1]||""),Oe=[],Pe=[],Be={FileIndex:Oe,FullPaths:Pe};V(Be);var xe,Ee=0;for(be=0;be<ve.length;++be){var qe=ve[be];qe!==Le&&qe!==Le+"--"||(Ee++&&Kt(Be,ve.slice(xe,be),de),xe=be)}return Be}function Ct(ie,_e){var de=_e||{},ve=de.boundary||"SheetJS";ve="------="+ve;for(var be=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ve.slice(2)+'"',"","",""],we=ie.FullPaths[0],De=we,Le=ie.FileIndex[0],Oe=1;Oe<ie.FullPaths.length;++Oe)if(De=ie.FullPaths[Oe].slice(we.length),Le=ie.FileIndex[Oe],!(!Le.size||!Le.content||De=="Sh33tJ5")){De=De.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(me){return"_x"+me.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(me){return"_u"+me.charCodeAt(0).toString(16)+"_"});for(var Pe=Le.content,Be=fr&&Buffer.isBuffer(Pe)?Pe.toString("binary"):T(Pe),xe=0,Ee=Math.min(1024,Be.length),qe=0,ce=0;ce<=Ee;++ce)(qe=Be.charCodeAt(ce))>=32&&qe<128&&++xe;var Te=xe>=Ee*4/5;be.push(ve),be.push("Content-Location: "+(de.root||"file:///C:/SheetJS/")+De),be.push("Content-Transfer-Encoding: "+(Te?"quoted-printable":"base64")),be.push("Content-Type: "+ut(Le,De)),be.push(""),be.push(Te?xt(Be):vt(Be))}return be.push(ve+`--\r
`),be.join(`\r
`)}function Ft(ie){var _e={};return V(_e,ie),_e}function kt(ie,_e,de,ve){var be=ve&&ve.unsafe;be||V(ie);var we=!be&&pr.find(ie,_e);if(!we){var De=ie.FullPaths[0];_e.slice(0,De.length)==De?De=_e:(De.slice(-1)!="/"&&(De+="/"),De=(De+_e).replace("//","/")),we={name:n(_e),type:2},ie.FileIndex.push(we),ie.FullPaths.push(De),be||pr.utils.cfb_gc(ie)}return we.content=de,we.size=de?de.length:0,ve&&(ve.CLSID&&(we.clsid=ve.CLSID),ve.mt&&(we.mt=ve.mt),ve.ct&&(we.ct=ve.ct)),we}function Ae(ie,_e){V(ie);var de=pr.find(ie,_e);if(de){for(var ve=0;ve<ie.FileIndex.length;++ve)if(ie.FileIndex[ve]==de)return ie.FileIndex.splice(ve,1),ie.FullPaths.splice(ve,1),!0}return!1}function Fe(ie,_e,de){V(ie);var ve=pr.find(ie,_e);if(ve){for(var be=0;be<ie.FileIndex.length;++be)if(ie.FileIndex[be]==ve)return ie.FileIndex[be].name=n(de),ie.FullPaths[be]=de,!0}return!1}function Qe(ie){H(ie,!0)}return r.find=Z,r.read=P,r.parse=u,r.write=D,r.writeFile=A,r.utils={cfb_new:Ft,cfb_add:kt,cfb_del:Ae,cfb_mov:Fe,cfb_gc:Qe,ReadShift:uu,CheckField:z_,prep_blob:ja,bconcat:qi,use_zlib:F,_deflateRaw:st,_inflateRaw:gt,consts:k},r}();function Ij(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(t);r.open("r"),r.encoding="binary";var e=r.read();return r.close(),e}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+t)}function Ds(t){for(var r=Object.keys(t),e=[],a=0;a<r.length;++a)Object.prototype.hasOwnProperty.call(t,r[a])&&e.push(r[a]);return e}function qm(t){for(var r=[],e=Ds(t),a=0;a!==e.length;++a)r[t[e[a]]]=e[a];return r}var Of=new Date(1899,11,30,0,0,0);function en(t,r){var e=t.getTime(),a=Of.getTime()+(t.getTimezoneOffset()-Of.getTimezoneOffset())*6e4;return(e-a)/(24*60*60*1e3)}var y_=new Date,Fj=Of.getTime()+(y_.getTimezoneOffset()-Of.getTimezoneOffset())*6e4,ry=y_.getTimezoneOffset();function Kf(t){var r=new Date;return r.setTime(t*24*60*60*1e3+Fj),r.getTimezoneOffset()!==ry&&r.setTime(r.getTime()+(r.getTimezoneOffset()-ry)*6e4),r}function Pj(t){var r=0,e=0,a=!1,n=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=n.length;++o)if(n[o]){switch(e=1,o>3&&(a=!0),n[o].slice(n[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[o].slice(n[o].length-1));case"D":e*=24;case"H":e*=60;case"M":if(a)e*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=e*parseInt(n[o],10)}return r}var ay=new Date("2017-02-19T19:06:09.000Z"),w_=isNaN(ay.getFullYear())?new Date("2/19/17"):ay,Lj=w_.getFullYear()==2017;function Sa(t,r){var e=new Date(t);if(Lj)return r>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):r<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(t instanceof Date)return t;if(w_.getFullYear()==1917&&!isNaN(e.getFullYear())){var a=e.getFullYear();return t.indexOf(""+a)>-1||e.setFullYear(e.getFullYear()+100),e}var n=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function Uo(t,r){if(fr&&Buffer.isBuffer(t)){if(r){if(t[0]==255&&t[1]==254)return ou(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ou(o_(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(t[0]==255&&t[1]==254)return ou(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ou(new TextDecoder("utf-16be").decode(t.slice(2)))}var e={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(o){return e[o]||o})}catch{}for(var a=[],n=0;n!=t.length;++n)a.push(String.fromCharCode(t[n]));return a.join("")}function Da(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var r={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=Da(t[e]));return r}function Gr(t,r){for(var e="";e.length<r;)e+=t;return e}function us(t){var r=Number(t);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(t))return r;var e=1,a=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(r=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,o){return e=-e,o}),!isNaN(r=Number(a)))?r/e:r}var Bj=["january","february","march","april","may","june","july","august","september","october","november","december"];function Zl(t){var r=new Date(t),e=new Date(NaN),a=r.getYear(),n=r.getMonth(),o=r.getDate();if(isNaN(o))return e;var s=t.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&Bj.indexOf(s)==-1)return e}else if(s.match(/[a-z]/))return e;return a<0||a>8099?e:(n>0||o>1)&&a!=101?r:t.match(/[^-0-9:,\/\\]/)?e:r}var Uj=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(e,a,n){if(t||typeof a=="string")return e.split(a);for(var o=e.split(a),s=[o[0]],l=1;l<o.length;++l)s.push(n),s.push(o[l]);return s}}();function __(t){return t?t.content&&t.type?Uo(t.content,!0):t.data?nu(t.data):t.asNodeBuffer&&fr?nu(t.asNodeBuffer().toString("binary")):t.asBinary?nu(t.asBinary()):t._data&&t._data.getContent?nu(Uo(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function S_(t){if(!t)return null;if(t.data)return qx(t.data);if(t.asNodeBuffer&&fr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var r=t._data.getContent();return typeof r=="string"?qx(r):Array.prototype.slice.call(r)}return t.content&&t.type?t.content:null}function zj(t){return t&&t.name.slice(-4)===".bin"?S_(t):__(t)}function Ln(t,r){for(var e=t.FullPaths||Ds(t.files),a=r.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),o=0;o<e.length;++o){var s=e[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==s||n==s)return t.files?t.files[e[o]]:t.FileIndex[o]}return null}function Wm(t,r){var e=Ln(t,r);if(e==null)throw new Error("Cannot find file "+r+" in zip");return e}function ia(t,r,e){if(!e)return zj(Wm(t,r));if(!r)return null;try{return ia(t,r)}catch{return null}}function kn(t,r,e){if(!e)return __(Wm(t,r));if(!r)return null;try{return kn(t,r)}catch{return null}}function $j(t,r,e){return S_(Wm(t,r))}function ny(t){for(var r=t.FullPaths||Ds(t.files),e=[],a=0;a<r.length;++a)r[a].slice(-1)!="/"&&e.push(r[a].replace(/^Root Entry[\/]/,""));return e.sort()}function Vj(t,r,e){if(t.FullPaths){if(typeof e=="string"){var a;return fr?a=$o(e):a=lj(e),pr.utils.cfb_add(t,r,a)}pr.utils.cfb_add(t,r,e)}else t.file(r,e)}function k_(t,r){switch(r.type){case"base64":return pr.read(t,{type:"base64"});case"binary":return pr.read(t,{type:"binary"});case"buffer":case"array":return pr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function iu(t,r){if(t.charAt(0)=="/")return t.slice(1);var e=r.split("/");r.slice(-1)!="/"&&e.pop();for(var a=t.split("/");a.length!==0;){var n=a.shift();n===".."?e.pop():n!=="."&&e.push(n)}return e.join("/")}var E_=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Hj=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,sy=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,qj=/<[^>]*>/g,qa=E_.match(sy)?sy:qj,Wj=/<\w*:/,Gj=/<(\/?)\w+:/;function Jt(t,r,e){for(var a={},n=0,o=0;n!==t.length&&!((o=t.charCodeAt(n))===32||o===10||o===13);++n);if(r||(a[0]=t.slice(0,n)),n===t.length)return a;var s=t.match(Hj),l=0,c="",i=0,u="",p="",f=1;if(s)for(i=0;i!=s.length;++i){for(p=s[i],o=0;o!=p.length&&p.charCodeAt(o)!==61;++o);for(u=p.slice(0,o).trim();p.charCodeAt(o+1)==32;)++o;for(f=(n=p.charCodeAt(o+1))==34||n==39?1:0,c=p.slice(o+1+f,p.length-f),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),a[u]=c,a[u.toLowerCase()]=c;else{var h=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(a[h]&&u.slice(l-3,l)=="ext")continue;a[h]=c,a[h.toLowerCase()]=c}}return a}function Is(t){return t.replace(Gj,"<$1")}var T_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Yj=qm(T_),br=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function e(a){var n=a+"",o=n.indexOf("<![CDATA[");if(o==-1)return n.replace(t,function(l,c){return T_[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(r,function(l,c){return String.fromCharCode(parseInt(c,16))});var s=n.indexOf("]]>");return e(n.slice(0,o))+n.slice(o+9,s)+e(n.slice(s+3))}}(),Xj=/[&<>'"]/g,Kj=/[\u0000-\u001f]/g;function Gm(t){var r=t+"";return r.replace(Xj,function(e){return Yj[e]}).replace(/\n/g,"<br/>").replace(Kj,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var iy=function(){var t=/&#(\d+);/g;function r(e,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(t,r)}}();function Br(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function xp(t){for(var r="",e=0,a=0,n=0,o=0,s=0,l=0;e<t.length;){if(a=t.charCodeAt(e++),a<128){r+=String.fromCharCode(a);continue}if(n=t.charCodeAt(e++),a>191&&a<224){s=(a&31)<<6,s|=n&63,r+=String.fromCharCode(s);continue}if(o=t.charCodeAt(e++),a<240){r+=String.fromCharCode((a&15)<<12|(n&63)<<6|o&63);continue}s=t.charCodeAt(e++),l=((a&7)<<18|(n&63)<<12|(o&63)<<6|s&63)-65536,r+=String.fromCharCode(55296+(l>>>10&1023)),r+=String.fromCharCode(56320+(l&1023))}return r}function oy(t){var r=eo(2*t.length),e,a,n=1,o=0,s=0,l;for(a=0;a<t.length;a+=n)n=1,(l=t.charCodeAt(a))<128?e=l:l<224?(e=(l&31)*64+(t.charCodeAt(a+1)&63),n=2):l<240?(e=(l&15)*4096+(t.charCodeAt(a+1)&63)*64+(t.charCodeAt(a+2)&63),n=3):(n=4,e=(l&7)*262144+(t.charCodeAt(a+1)&63)*4096+(t.charCodeAt(a+2)&63)*64+(t.charCodeAt(a+3)&63),e-=65536,s=55296+(e>>>10&1023),e=56320+(e&1023)),s!==0&&(r[o++]=s&255,r[o++]=s>>>8,s=0),r[o++]=e%256,r[o++]=e>>>8;return r.slice(0,o).toString("ucs2")}function ly(t){return $o(t,"binary").toString("utf8")}var pf="foo bar baz",Fr=fr&&(ly(pf)==xp(pf)&&ly||oy(pf)==xp(pf)&&oy)||xp,ou=fr?function(t){return $o(t,"utf8").toString("binary")}:function(t){for(var r=[],e=0,a=0,n=0;e<t.length;)switch(a=t.charCodeAt(e++),!0){case a<128:r.push(String.fromCharCode(a));break;case a<2048:r.push(String.fromCharCode(192+(a>>6))),r.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=t.charCodeAt(e++)-56320+(a<<10),r.push(String.fromCharCode(240+(n>>18&7))),r.push(String.fromCharCode(144+(n>>12&63))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)));break;default:r.push(String.fromCharCode(224+(a>>12))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)))}return r.join("")},Mu=function(){var t={};return function(e,a){var n=e+"|"+(a||"");return t[n]?t[n]:t[n]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",a||"")}}(),A_=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(e){for(var a=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<t.length;++n)a=a.replace(t[n][0],t[n][1]);return a}}(),Zj=function(){var t={};return function(e){return t[e]!==void 0?t[e]:t[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}}(),Jj=/<\/?(?:vt:)?variant>/g,Qj=/<(?:vt:)([^>]*)>([\s\S]*)</;function cy(t,r){var e=Jt(t),a=t.match(Zj(e.baseType))||[],n=[];if(a.length!=e.size){if(r.WTF)throw new Error("unexpected vector length "+a.length+" != "+e.size);return n}return a.forEach(function(o){var s=o.replace(Jj,"").match(Qj);s&&n.push({v:Fr(s[2]),t:s[1]})}),n}var eO=/(^\s|\s$|\n)/;function tO(t){return Ds(t).map(function(r){return" "+r+'="'+t[r]+'"'}).join("")}function rO(t,r,e){return"<"+t+(e!=null?tO(e):"")+(r!=null?(r.match(eO)?' xml:space="preserve"':"")+">"+r+"</"+t:"/")+">"}function Ym(t){if(fr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Fr(Vo($m(t)));throw new Error("Bad input format: expected Buffer or string")}var Ru=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,aO={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},nO=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function sO(t,r){for(var e=1-2*(t[r+7]>>>7),a=((t[r+7]&127)<<4)+(t[r+6]>>>4&15),n=t[r+6]&15,o=5;o>=0;--o)n=n*256+t[r+o];return a==2047?n==0?e*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),e*Math.pow(2,a-52)*n)}function iO(t,r,e){var a=(r<0||1/r==-1/0?1:0)<<7,n=0,o=0,s=a?-r:r;isFinite(s)?s==0?n=o=0:(n=Math.floor(Math.log(s)/Math.LN2),o=s*Math.pow(2,52-n),n<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?n=-1022:(o-=Math.pow(2,52),n+=1023)):(n=2047,o=isNaN(r)?26985:0);for(var l=0;l<=5;++l,o/=256)t[e+l]=o&255;t[e+6]=(n&15)<<4|o&15,t[e+7]=n>>4|a}var uy=function(t){for(var r=[],e=10240,a=0;a<t[0].length;++a)if(t[0][a])for(var n=0,o=t[0][a].length;n<o;n+=e)r.push.apply(r,t[0][a].slice(n,n+e));return r},dy=fr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(r){return Buffer.isBuffer(r)?r:$o(r)})):uy(t)}:uy,fy=function(t,r,e){for(var a=[],n=r;n<e;n+=2)a.push(String.fromCharCode(ai(t,n)));return a.join("").replace(Qa,"")},Xm=fr?function(t,r,e){return Buffer.isBuffer(t)?t.toString("utf16le",r,e).replace(Qa,""):fy(t,r,e)}:fy,hy=function(t,r,e){for(var a=[],n=r;n<r+e;++n)a.push(("0"+t[n].toString(16)).slice(-2));return a.join("")},C_=fr?function(t,r,e){return Buffer.isBuffer(t)?t.toString("hex",r,r+e):hy(t,r,e)}:hy,py=function(t,r,e){for(var a=[],n=r;n<e;n++)a.push(String.fromCharCode(Bl(t,n)));return a.join("")},Gu=fr?function(r,e,a){return Buffer.isBuffer(r)?r.toString("utf8",e,a):py(r,e,a)}:py,N_=function(t,r){var e=wn(t,r);return e>0?Gu(t,r+4,r+4+e-1):""},j_=N_,O_=function(t,r){var e=wn(t,r);return e>0?Gu(t,r+4,r+4+e-1):""},D_=O_,M_=function(t,r){var e=2*wn(t,r);return e>0?Gu(t,r+4,r+4+e-1):""},R_=M_,I_=function(r,e){var a=wn(r,e);return a>0?Xm(r,e+4,e+4+a):""},F_=I_,P_=function(t,r){var e=wn(t,r);return e>0?Gu(t,r+4,r+4+e):""},L_=P_,B_=function(t,r){return sO(t,r)},Df=B_,U_=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};fr&&(j_=function(r,e){if(!Buffer.isBuffer(r))return N_(r,e);var a=r.readUInt32LE(e);return a>0?r.toString("utf8",e+4,e+4+a-1):""},D_=function(r,e){if(!Buffer.isBuffer(r))return O_(r,e);var a=r.readUInt32LE(e);return a>0?r.toString("utf8",e+4,e+4+a-1):""},R_=function(r,e){if(!Buffer.isBuffer(r))return M_(r,e);var a=2*r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+a-1)},F_=function(r,e){if(!Buffer.isBuffer(r))return I_(r,e);var a=r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+a)},L_=function(r,e){if(!Buffer.isBuffer(r))return P_(r,e);var a=r.readUInt32LE(e);return r.toString("utf8",e+4,e+4+a)},Df=function(r,e){return Buffer.isBuffer(r)?r.readDoubleLE(e):B_(r,e)},U_=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Bl=function(t,r){return t[r]},ai=function(t,r){return t[r+1]*256+t[r]},oO=function(t,r){var e=t[r+1]*256+t[r];return e<32768?e:(65535-e+1)*-1},wn=function(t,r){return t[r+3]*(1<<24)+(t[r+2]<<16)+(t[r+1]<<8)+t[r]},Do=function(t,r){return t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]},lO=function(t,r){return t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]};function uu(t,r){var e="",a,n,o=[],s,l,c,i;switch(r){case"dbcs":if(i=this.l,fr&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)e+=String.fromCharCode(ai(this,i)),i+=2;t*=2;break;case"utf8":e=Gu(this,this.l,this.l+t);break;case"utf16le":t*=2,e=Xm(this,this.l,this.l+t);break;case"wstr":return uu.call(this,t,"dbcs");case"lpstr-ansi":e=j_(this,this.l),t=4+wn(this,this.l);break;case"lpstr-cp":e=D_(this,this.l),t=4+wn(this,this.l);break;case"lpwstr":e=R_(this,this.l),t=4+2*wn(this,this.l);break;case"lpp4":t=4+wn(this,this.l),e=F_(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+wn(this,this.l),e=L_(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,e="";(s=Bl(this,this.l+t++))!==0;)o.push(hf(s));e=o.join("");break;case"_wstr":for(t=0,e="";(s=ai(this,this.l+t))!==0;)o.push(hf(s)),t+=2;t+=2,e=o.join("");break;case"dbcs-cont":for(e="",i=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(i)!==-1)return s=Bl(this,i),this.l=i+1,l=uu.call(this,t-c,s?"dbcs-cont":"sbcs-cont"),o.join("")+l;o.push(hf(ai(this,i))),i+=2}e=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(e="",i=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(i)!==-1)return s=Bl(this,i),this.l=i+1,l=uu.call(this,t-c,s?"dbcs-cont":"sbcs-cont"),o.join("")+l;o.push(hf(Bl(this,i))),i+=1}e=o.join("");break;default:switch(t){case 1:return a=Bl(this,this.l),this.l++,a;case 2:return a=(r==="i"?oO:ai)(this,this.l),this.l+=2,a;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(a=(t>0?Do:lO)(this,this.l),this.l+=4,a):(n=wn(this,this.l),this.l+=4,n);case 8:case-8:if(r==="f")return t==8?n=Df(this,this.l):n=Df([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;t=8;case 16:e=C_(this,this.l,t);break}}return this.l+=t,e}var cO=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24&255},uO=function(t,r,e){t[e]=r&255,t[e+1]=r>>8&255,t[e+2]=r>>16&255,t[e+3]=r>>24&255},dO=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255};function fO(t,r,e){var a=0,n=0;if(e==="dbcs"){for(n=0;n!=r.length;++n)dO(this,r.charCodeAt(n),this.l+2*n);a=2*r.length}else if(e==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=r.length;++n)this[this.l+n]=r.charCodeAt(n)&255;a=r.length}else if(e==="hex"){for(;n<t;++n)this[this.l++]=parseInt(r.slice(2*n,2*n+2),16)||0;return this}else if(e==="utf16le"){var o=Math.min(this.l+t,this.length);for(n=0;n<Math.min(r.length,t);++n){var s=r.charCodeAt(n);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:a=1,this[this.l]=r&255;break;case 2:a=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:a=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:a=4,cO(this,r,this.l);break;case 8:if(a=8,e==="f"){iO(this,r,this.l);break}case 16:break;case-4:a=4,uO(this,r,this.l);break}return this.l+=a,this}function z_(t,r){var e=C_(this,this.l,t.length>>1);if(e!==t)throw new Error(r+"Expected "+t+" saw "+e);this.l+=t.length>>1}function ja(t,r){t.l=r,t.read_shift=uu,t.chk=z_,t.write_shift=fO}function Ha(t,r){t.l+=r}function ga(t){var r=eo(t);return ja(r,0),r}function ci(t,r,e){if(t){var a,n,o;ja(t,t.l||0);for(var s=t.length,l=0,c=0;t.l<s;){l=t.read_shift(1),l&128&&(l=(l&127)+((t.read_shift(1)&127)<<7));var i=Lf[l]||Lf[65535];for(a=t.read_shift(1),o=a&127,n=1;n<4&&a&128;++n)o+=((a=t.read_shift(1))&127)<<7*n;c=t.l+o;var u=i.f&&i.f(t,o,e);if(t.l=c,r(u,i,l))return}}}function Jp(){var t=[],r=fr?256:2048,e=function(i){var u=ga(i);return ja(u,0),u},a=e(r),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&t.push(a),a=null)},o=function(i){return a&&i<a.length-a.l?a:(n(),a=e(Math.max(i+1,r)))},s=function(){return n(),qi(t)},l=function(i){n(),a=i,a.l==null&&(a.l=a.length),o(r)};return{next:o,push:l,end:s,_bufs:t}}function du(t,r,e){var a=Da(t);if(r.s?(a.cRel&&(a.c+=r.s.c),a.rRel&&(a.r+=r.s.r)):(a.cRel&&(a.c+=r.c),a.rRel&&(a.r+=r.r)),!e||e.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function my(t,r,e){var a=Da(t);return a.s=du(a.s,r.s,e),a.e=du(a.e,r.s,e),a}function fu(t,r){if(t.cRel&&t.c<0)for(t=Da(t);t.c<0;)t.c+=r>8?16384:256;if(t.rRel&&t.r<0)for(t=Da(t);t.r<0;)t.r+=r>8?1048576:r>5?65536:16384;var e=Qt(t);return!t.cRel&&t.cRel!=null&&(e=mO(e)),!t.rRel&&t.rRel!=null&&(e=hO(e)),e}function yp(t,r){return t.s.r==0&&!t.s.rRel&&t.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+va(t.s.c)+":"+(t.e.cRel?"":"$")+va(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(r.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Ma(t.s.r)+":"+(t.e.rRel?"":"$")+Ma(t.e.r):fu(t.s,r.biff)+":"+fu(t.e,r.biff)}function Km(t){return parseInt(pO(t),10)-1}function Ma(t){return""+(t+1)}function hO(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function pO(t){return t.replace(/\$(\d+)$/,"$1")}function Zm(t){for(var r=gO(t),e=0,a=0;a!==r.length;++a)e=26*e+r.charCodeAt(a)-64;return e-1}function va(t){if(t<0)throw new Error("invalid column "+t);var r="";for(++t;t;t=Math.floor((t-1)/26))r=String.fromCharCode((t-1)%26+65)+r;return r}function mO(t){return t.replace(/^([A-Z])/,"$$$1")}function gO(t){return t.replace(/^\$([A-Z])/,"$1")}function vO(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ja(t){for(var r=0,e=0,a=0;a<t.length;++a){var n=t.charCodeAt(a);n>=48&&n<=57?r=10*r+(n-48):n>=65&&n<=90&&(e=26*e+(n-64))}return{c:e-1,r:r-1}}function Qt(t){for(var r=t.c+1,e="";r;r=(r-1)/26|0)e=String.fromCharCode((r-1)%26+65)+e;return e+(t.r+1)}function ac(t){var r=t.indexOf(":");return r==-1?{s:Ja(t),e:Ja(t)}:{s:Ja(t.slice(0,r)),e:Ja(t.slice(r+1))}}function mr(t,r){return typeof r>"u"||typeof r=="number"?mr(t.s,t.e):(typeof t!="string"&&(t=Qt(t)),typeof r!="string"&&(r=Qt(r)),t==r?t:t+":"+r)}function Yr(t){var r={s:{c:0,r:0},e:{c:0,r:0}},e=0,a=0,n=0,o=t.length;for(e=0;a<o&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)e=26*e+n;for(r.s.c=--e,e=0;a<o&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)e=10*e+n;if(r.s.r=--e,a===o||n!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++a,e=0;a!=o&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)e=26*e+n;for(r.e.c=--e,e=0;a!=o&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)e=10*e+n;return r.e.r=--e,r}function gy(t,r){var e=t.t=="d"&&r instanceof Date;if(t.z!=null)try{return t.w=Hn(t.z,e?en(r):r)}catch{}try{return t.w=Hn((t.XF||{}).numFmtId||(e?14:0),e?en(r):r)}catch{return""+r}}function ii(t,r,e){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),t.t=="e"?Wo[t.v]||t.v:r==null?gy(t,t.v):gy(t,r))}function ao(t,r){var e=r&&r.sheet?r.sheet:"Sheet1",a={};return a[e]=t,{SheetNames:[e],Sheets:a}}function $_(t,r,e){var a=e||{},n=t?Array.isArray(t):a.dense,o=t||(n?[]:{}),s=0,l=0;if(o&&a.origin!=null){if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?Ja(a.origin):a.origin;s=c.r,l=c.c}o["!ref"]||(o["!ref"]="A1:A1")}var i={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var u=Yr(o["!ref"]);i.s.c=u.s.c,i.s.r=u.s.r,i.e.c=Math.max(i.e.c,u.e.c),i.e.r=Math.max(i.e.r,u.e.r),s==-1&&(i.e.r=s=u.e.r+1)}for(var p=0;p!=r.length;++p)if(r[p]){if(!Array.isArray(r[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=r[p].length;++f)if(!(typeof r[p][f]>"u")){var h={v:r[p][f]},v=s+p,b=l+f;if(i.s.r>v&&(i.s.r=v),i.s.c>b&&(i.s.c=b),i.e.r<v&&(i.e.r=v),i.e.c<b&&(i.e.c=b),r[p][f]&&typeof r[p][f]=="object"&&!Array.isArray(r[p][f])&&!(r[p][f]instanceof Date))h=r[p][f];else if(Array.isArray(h.v)&&(h.f=r[p][f][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(a.nullError)h.t="e",h.v=0;else if(a.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=a.dateNF||rr[14],a.cellDates?(h.t="d",h.w=Hn(h.z,en(h.v))):(h.t="n",h.v=en(h.v),h.w=Hn(h.z,h.v))):h.t="s";if(n)o[v]||(o[v]=[]),o[v][b]&&o[v][b].z&&(h.z=o[v][b].z),o[v][b]=h;else{var g=Qt({c:b,r:v});o[g]&&o[g].z&&(h.z=o[g].z),o[g]=h}}}return i.s.c<1e7&&(o["!ref"]=mr(i)),o}function nc(t,r){return $_(null,t,r)}function bO(t){return t.read_shift(4,"i")}function Va(t){var r=t.read_shift(4);return r===0?"":t.read_shift(r,"dbcs")}function xO(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Jm(t,r){var e=t.l,a=t.read_shift(1),n=Va(t),o=[],s={t:n,h:n};if((a&1)!==0){for(var l=t.read_shift(4),c=0;c!=l;++c)o.push(xO(t));s.r=o}else s.r=[{ich:0,ifnt:0}];return t.l=e+r,s}var yO=Jm;function qn(t){var r=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:r,iStyleRef:e}}function Ho(t){var r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:r}}var wO=Va;function Qm(t){var r=t.read_shift(4);return r===0||r===4294967295?"":t.read_shift(r,"dbcs")}var _O=Va,Qp=Qm;function e1(t){var r=t.slice(t.l,t.l+4),e=r[0]&1,a=r[0]&2;t.l+=4;var n=a===0?Df([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Do(r,0)>>2;return e?n/100:n}function V_(t){var r={s:{},e:{}};return r.s.r=t.read_shift(4),r.e.r=t.read_shift(4),r.s.c=t.read_shift(4),r.e.c=t.read_shift(4),r}var qo=V_;function za(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function SO(t){var r={},e=t.read_shift(1),a=e>>>1,n=t.read_shift(1),o=t.read_shift(2,"i"),s=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,a){case 0:r.auto=1;break;case 1:r.index=n;var i=Lo[n];i&&(r.rgb=Fu(i));break;case 2:r.rgb=Fu([s,l,c]);break;case 3:r.theme=n;break}return o!=0&&(r.tint=o>0?o/32767:o/32768),r}function kO(t){var r=t.read_shift(1);t.l++;var e={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return e}function H_(t,r){var e={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=t.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return e[t.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return t.l-=4,t.read_shift(0,r==1?"lpstr":"lpwstr")}function EO(t){return H_(t,1)}function TO(t){return H_(t,2)}var t1=2,ln=3,mf=11,vy=12,Mf=19,gf=64,AO=65,CO=71,NO=4108,jO=4126,_a=80,q_=81,OO=[_a,q_],DO={1:{n:"CodePage",t:t1},2:{n:"Category",t:_a},3:{n:"PresentationFormat",t:_a},4:{n:"ByteCount",t:ln},5:{n:"LineCount",t:ln},6:{n:"ParagraphCount",t:ln},7:{n:"SlideCount",t:ln},8:{n:"NoteCount",t:ln},9:{n:"HiddenCount",t:ln},10:{n:"MultimediaClipCount",t:ln},11:{n:"ScaleCrop",t:mf},12:{n:"HeadingPairs",t:NO},13:{n:"TitlesOfParts",t:jO},14:{n:"Manager",t:_a},15:{n:"Company",t:_a},16:{n:"LinksUpToDate",t:mf},17:{n:"CharacterCount",t:ln},19:{n:"SharedDoc",t:mf},22:{n:"HyperlinksChanged",t:mf},23:{n:"AppVersion",t:ln,p:"version"},24:{n:"DigSig",t:AO},26:{n:"ContentType",t:_a},27:{n:"ContentStatus",t:_a},28:{n:"Language",t:_a},29:{n:"Version",t:_a},255:{},2147483648:{n:"Locale",t:Mf},2147483651:{n:"Behavior",t:Mf},1919054434:{}},MO={1:{n:"CodePage",t:t1},2:{n:"Title",t:_a},3:{n:"Subject",t:_a},4:{n:"Author",t:_a},5:{n:"Keywords",t:_a},6:{n:"Comments",t:_a},7:{n:"Template",t:_a},8:{n:"LastAuthor",t:_a},9:{n:"RevNumber",t:_a},10:{n:"EditTime",t:gf},11:{n:"LastPrinted",t:gf},12:{n:"CreatedDate",t:gf},13:{n:"ModifiedDate",t:gf},14:{n:"PageCount",t:ln},15:{n:"WordCount",t:ln},16:{n:"CharCount",t:ln},17:{n:"Thumbnail",t:CO},18:{n:"Application",t:_a},19:{n:"DocSecurity",t:ln},255:{},2147483648:{n:"Locale",t:Mf},2147483651:{n:"Behavior",t:Mf},1919054434:{}},by={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},RO=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function IO(t){return t.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var FO=IO([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Lo=Da(FO),Wo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},W_={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},xy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function PO(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function LO(t){var r=PO();if(!t||!t.match)return r;var e={};if((t.match(qa)||[]).forEach(function(a){var n=Jt(a);switch(n[0].replace(Wj,"<")){case"<?xml":break;case"<Types":r.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[n.Extension]=n.ContentType;break;case"<Override":r[xy[n.ContentType]]!==void 0&&r[xy[n.ContentType]].push(n.PartName);break}}),r.xmlns!==aO.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=e,delete r.calcchains,r}var $l={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function em(t){var r=t.lastIndexOf("/");return t.slice(0,r+1)+"_rels/"+t.slice(r+1)+".rels"}function hu(t,r){var e={"!id":{}};if(!t)return e;r.charAt(0)!=="/"&&(r="/"+r);var a={};return(t.match(qa)||[]).forEach(function(n){var o=Jt(n);if(o[0]==="<Relationship"){var s={};s.Type=o.Type,s.Target=o.Target,s.Id=o.Id,o.TargetMode&&(s.TargetMode=o.TargetMode);var l=o.TargetMode==="External"?o.Target:iu(o.Target,r);e[l]=s,a[o.Id]=s}}),e["!id"]=a,e}var BO="application/vnd.oasis.opendocument.spreadsheet";function UO(t,r){for(var e=Ym(t),a,n;a=Ru.exec(e);)switch(a[3]){case"manifest":break;case"file-entry":if(n=Jt(a[0],!1),n.path=="/"&&n.type!==BO)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw a}}var pu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],zO=function(){for(var t=new Array(pu.length),r=0;r<pu.length;++r){var e=pu[r],a="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);t[r]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return t}();function G_(t){var r={};t=Fr(t);for(var e=0;e<pu.length;++e){var a=pu[e],n=t.match(zO[e]);n!=null&&n.length>0&&(r[a[1]]=br(n[1])),a[2]==="date"&&r[a[1]]&&(r[a[1]]=Sa(r[a[1]]))}return r}var $O=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Y_(t,r,e,a){var n=[];if(typeof t=="string")n=cy(t,a);else for(var o=0;o<t.length;++o)n=n.concat(t[o].map(function(u){return{v:u}}));var s=typeof r=="string"?cy(r,a).map(function(u){return u.v}):r,l=0,c=0;if(s.length>0)for(var i=0;i!==n.length;i+=2){switch(c=+n[i+1].v,n[i].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":e.Worksheets=c,e.SheetNames=s.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":e.NamedRanges=c,e.DefinedNames=s.slice(l,l+c);break;case"Charts":case"Diagramme":e.Chartsheets=c,e.ChartNames=s.slice(l,l+c);break}l+=c}}function VO(t,r,e){var a={};return r||(r={}),t=Fr(t),$O.forEach(function(n){var o=(t.match(Mu(n[0]))||[])[1];switch(n[2]){case"string":o&&(r[n[1]]=br(o));break;case"bool":r[n[1]]=o==="true";break;case"raw":var s=t.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));s&&s.length>0&&(a[n[1]]=s[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&Y_(a.HeadingPairs,a.TitlesOfParts,r,e),r}var HO=/<[^>]+>[^<]*/g;function qO(t,r){var e={},a="",n=t.match(HO);if(n)for(var o=0;o!=n.length;++o){var s=n[o],l=Jt(s);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":a=br(l.name);break;case"</property>":a=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),i=c[0].slice(4),u=c[1];switch(i){case"lpstr":case"bstr":case"lpwstr":e[a]=br(u);break;case"bool":e[a]=Br(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[a]=parseInt(u,10);break;case"r4":case"r8":case"decimal":e[a]=parseFloat(u);break;case"filetime":case"date":e[a]=Sa(u);break;case"cy":case"error":e[a]=br(u);break;default:if(i.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",s,i,c)}}else if(s.slice(0,2)!=="</"){if(r.WTF)throw new Error(s)}}}return e}var WO={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},wp;function GO(t,r,e){wp||(wp=qm(WO)),r=wp[r]||r,t[r]=e}function r1(t){var r=t.read_shift(4),e=t.read_shift(4);return new Date((e/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function X_(t,r,e){var a=t.l,n=t.read_shift(0,"lpstr-cp");if(e)for(;t.l-a&3;)++t.l;return n}function K_(t,r,e){var a=t.read_shift(0,"lpwstr");return a}function Z_(t,r,e){return r===31?K_(t):X_(t,r,e)}function tm(t,r,e){return Z_(t,r,e===!1?0:4)}function YO(t,r){if(!r)throw new Error("VtUnalignedString must have positive length");return Z_(t,r,0)}function XO(t){for(var r=t.read_shift(4),e=[],a=0;a!=r;++a){var n=t.l;e[a]=t.read_shift(0,"lpwstr").replace(Qa,""),t.l-n&2&&(t.l+=2)}return e}function KO(t){for(var r=t.read_shift(4),e=[],a=0;a!=r;++a)e[a]=t.read_shift(0,"lpstr-cp").replace(Qa,"");return e}function ZO(t){var r=t.l,e=Rf(t,q_);t[t.l]==0&&t[t.l+1]==0&&t.l-r&2&&(t.l+=2);var a=Rf(t,ln);return[e,a]}function JO(t){for(var r=t.read_shift(4),e=[],a=0;a<r/2;++a)e.push(ZO(t));return e}function yy(t,r){for(var e=t.read_shift(4),a={},n=0;n!=e;++n){var o=t.read_shift(4),s=t.read_shift(4);a[o]=t.read_shift(s,r===1200?"utf16le":"utf8").replace(Qa,"").replace(su,"!"),r===1200&&s%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),a}function J_(t){var r=t.read_shift(4),e=t.slice(t.l,t.l+r);return t.l+=r,(r&3)>0&&(t.l+=4-(r&3)&3),e}function QO(t){var r={};return r.Size=t.read_shift(4),t.l+=r.Size+3-(r.Size-1)%4,r}function Rf(t,r,e){var a=t.read_shift(2),n,o=e||{};if(t.l+=2,r!==vy&&a!==r&&OO.indexOf(r)===-1&&!((r&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+r+" saw "+a);switch(r===vy?a:r){case 2:return n=t.read_shift(2,"i"),o.raw||(t.l+=2),n;case 3:return n=t.read_shift(4,"i"),n;case 11:return t.read_shift(4)!==0;case 19:return n=t.read_shift(4),n;case 30:return X_(t,a,4).replace(Qa,"");case 31:return K_(t);case 64:return r1(t);case 65:return J_(t);case 71:return QO(t);case 80:return tm(t,a,!o.raw).replace(Qa,"");case 81:return YO(t,a).replace(Qa,"");case 4108:return JO(t);case 4126:case 4127:return a==4127?XO(t):KO(t);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+a)}}function wy(t,r){var e=t.l,a=t.read_shift(4),n=t.read_shift(4),o=[],s=0,l=0,c=-1,i={};for(s=0;s!=n;++s){var u=t.read_shift(4),p=t.read_shift(4);o[s]=[u,p+e]}o.sort(function(y,E){return y[1]-E[1]});var f={};for(s=0;s!=n;++s){if(t.l!==o[s][1]){var h=!0;if(s>0&&r)switch(r[o[s-1][0]].t){case 2:t.l+2===o[s][1]&&(t.l+=2,h=!1);break;case 80:t.l<=o[s][1]&&(t.l=o[s][1],h=!1);break;case 4108:t.l<=o[s][1]&&(t.l=o[s][1],h=!1);break}if((!r||s==0)&&t.l<=o[s][1]&&(h=!1,t.l=o[s][1]),h)throw new Error("Read Error: Expected address "+o[s][1]+" at "+t.l+" :"+s)}if(r){var v=r[o[s][0]];if(f[v.n]=Rf(t,v.t,{raw:!0}),v.p==="version"&&(f[v.n]=String(f[v.n]>>16)+"."+("0000"+String(f[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(f[v.n]){case 0:f[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ls(l=f[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[v.n])}}else if(o[s][0]===1){if(l=f.CodePage=Rf(t,t1),ls(l),c!==-1){var b=t.l;t.l=o[c][1],i=yy(t,l),t.l=b}}else if(o[s][0]===0){if(l===0){c=s,t.l=o[s+1][1];continue}i=yy(t,l)}else{var g=i[o[s][0]],x;switch(t[t.l]){case 65:t.l+=4,x=J_(t);break;case 30:t.l+=4,x=tm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,x=tm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,x=t.read_shift(4,"i");break;case 19:t.l+=4,x=t.read_shift(4);break;case 5:t.l+=4,x=t.read_shift(8,"f");break;case 11:t.l+=4,x=Zr(t,4);break;case 64:t.l+=4,x=Sa(r1(t));break;default:throw new Error("unparsed value: "+t[t.l])}f[g]=x}}return t.l=e+a,f}function _y(t,r,e){var a=t.content;if(!a)return{};ja(a,0);var n,o,s,l,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var i=a.read_shift(4),u=a.read_shift(16);if(u!==pr.utils.consts.HEADER_CLSID&&u!==e)throw new Error("Bad PropertySet CLSID "+u);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(o=a.read_shift(16),l=a.read_shift(4),n===1&&l!==a.l)throw new Error("Length mismatch: "+l+" !== "+a.l);n===2&&(s=a.read_shift(16),c=a.read_shift(4));var p=wy(a,r),f={SystemIdentifier:i};for(var h in p)f[h]=p[h];if(f.FMTID=o,n===1)return f;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var v;try{v=wy(a,null)}catch{}for(h in v)f[h]=v[h];return f.FMTID=[o,s],f}function $i(t,r){return t.read_shift(r),null}function eD(t,r,e){for(var a=[],n=t.l+r;t.l<n;)a.push(e(t,n-t.l));if(n!==t.l)throw new Error("Slurp error");return a}function Zr(t,r){return t.read_shift(r)===1}function oa(t){return t.read_shift(2,"u")}function Q_(t,r){return eD(t,r,oa)}function tD(t){var r=t.read_shift(1),e=t.read_shift(1);return e===1?r:r===1}function Yu(t,r,e){var a=t.read_shift(e&&e.biff>=12?2:1),n="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var o=t.read_shift(1);o&&(n="dbcs-cont")}else e.biff==12&&(n="wstr");e.biff>=2&&e.biff<=5&&(n="cpstr");var s=a?t.read_shift(a,n):"";return s}function rD(t){var r=t.read_shift(2),e=t.read_shift(1),a=e&4,n=e&8,o=1+(e&1),s=0,l,c={};n&&(s=t.read_shift(2)),a&&(l=t.read_shift(4));var i=o==2?"dbcs-cont":"sbcs-cont",u=r===0?"":t.read_shift(r,i);return n&&(t.l+=4*s),a&&(t.l+=l),c.t=u,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function zo(t,r,e){var a;if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(r,"cpstr");if(e.biff>=12)return t.read_shift(r,"dbcs-cont")}var n=t.read_shift(1);return n===0?a=t.read_shift(r,"sbcs-cont"):a=t.read_shift(r,"dbcs-cont"),a}function Xu(t,r,e){var a=t.read_shift(e&&e.biff==2?1:2);return a===0?(t.l++,""):zo(t,a,e)}function Go(t,r,e){if(e.biff>5)return Xu(t,r,e);var a=t.read_shift(1);return a===0?(t.l++,""):t.read_shift(a,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function aD(t){var r=t.read_shift(1);t.l++;var e=t.read_shift(2);return t.l+=2,[r,e]}function nD(t){var r=t.read_shift(4),e=t.l,a=!1;r>24&&(t.l+=r-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),t.l=e);var n=t.read_shift((a?r-24:r)>>1,"utf16le").replace(Qa,"");return a&&(t.l+=24),n}function sD(t){for(var r=t.read_shift(2),e="";r-- >0;)e+="../";var a=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=t.read_shift(4);if(n===0)return e+a.replace(/\\/g,"/");var o=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=t.read_shift(o>>1,"utf16le").replace(Qa,"");return e+s}function iD(t,r){var e=t.read_shift(16);switch(e){case"e0c9ea79f9bace118c8200aa004ba90b":return nD(t);case"0303000000000000c000000000000046":return sD(t);default:throw new Error("Unsupported Moniker "+e)}}function vf(t){var r=t.read_shift(4),e=r>0?t.read_shift(r,"utf16le").replace(Qa,""):"";return e}function oD(t,r){var e=t.l+r,a=t.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=t.read_shift(2);t.l+=2;var o,s,l,c,i="",u,p;n&16&&(o=vf(t,e-t.l)),n&128&&(s=vf(t,e-t.l)),(n&257)===257&&(l=vf(t,e-t.l)),(n&257)===1&&(c=iD(t,e-t.l)),n&8&&(i=vf(t,e-t.l)),n&32&&(u=t.read_shift(16)),n&64&&(p=r1(t)),t.l=e;var f=s||l||c||"";f&&i&&(f+="#"+i),f||(f="#"+i),n&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var h={Target:f};return u&&(h.guid=u),p&&(h.time=p),o&&(h.Tooltip=o),h}function e4(t){var r=t.read_shift(1),e=t.read_shift(1),a=t.read_shift(1),n=t.read_shift(1);return[r,e,a,n]}function t4(t,r){var e=e4(t);return e[3]=0,e}function Fs(t){var r=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(2);return{r,c:e,ixfe:a}}function lD(t){var r=t.read_shift(2),e=t.read_shift(2);return t.l+=8,{type:r,flags:e}}function cD(t,r,e){return r===0?"":Go(t,r,e)}function uD(t,r,e){var a=e.biff>8?4:2,n=t.read_shift(a),o=t.read_shift(a,"i"),s=t.read_shift(a,"i");return[n,o,s]}function r4(t){var r=t.read_shift(2),e=e1(t);return[r,e]}function dD(t,r,e){t.l+=4,r-=4;var a=t.l+r,n=Yu(t,r,e),o=t.read_shift(2);if(a-=t.l,o!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+o);return t.l+=o,n}function Zf(t){var r=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2);return{s:{c:a,r},e:{c:n,r:e}}}function a4(t){var r=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(1),n=t.read_shift(1);return{s:{c:a,r},e:{c:n,r:e}}}var fD=a4;function n4(t){t.l+=4;var r=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(2);return t.l+=12,[e,r,a]}function hD(t){var r={};return t.l+=4,t.l+=16,r.fSharedNote=t.read_shift(2),t.l+=4,r}function pD(t){var r={};return t.l+=4,t.cf=t.read_shift(2),r}function Ia(t){t.l+=2,t.l+=t.read_shift(2)}var mD={0:Ia,4:Ia,5:Ia,6:Ia,7:pD,8:Ia,9:Ia,10:Ia,11:Ia,12:Ia,13:hD,14:Ia,15:Ia,16:Ia,17:Ia,18:Ia,19:Ia,20:Ia,21:n4};function gD(t,r){for(var e=t.l+r,a=[];t.l<e;){var n=t.read_shift(2);t.l-=2;try{a.push(mD[n](t,e-t.l))}catch{return t.l=e,a}}return t.l!=e&&(t.l=e),a}function bf(t,r){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=t.read_shift(2),r-=2,r>=2&&(e.dt=t.read_shift(2),t.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return t.read_shift(r),e}function vD(t,r){return r===0||t.read_shift(2),1200}function bD(t,r,e){if(e.enc)return t.l+=r,"";var a=t.l,n=Go(t,0,e);return t.read_shift(r+a-t.l),n}function xD(t,r,e){var a=e&&e.biff==8||r==2?t.read_shift(2):(t.l+=r,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function yD(t,r,e){var a=t.read_shift(4),n=t.read_shift(1)&3,o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var s=Yu(t,0,e);return s.length===0&&(s="Sheet1"),{pos:a,hs:n,dt:o,name:s}}function wD(t,r){for(var e=t.l+r,a=t.read_shift(4),n=t.read_shift(4),o=[],s=0;s!=n&&t.l<e;++s)o.push(rD(t));return o.Count=a,o.Unique=n,o}function _D(t,r){var e={};return e.dsst=t.read_shift(2),t.l+=r-2,e}function SD(t){var r={};r.r=t.read_shift(2),r.c=t.read_shift(2),r.cnt=t.read_shift(2)-r.c;var e=t.read_shift(2);t.l+=4;var a=t.read_shift(1);return t.l+=3,a&7&&(r.level=a&7),a&32&&(r.hidden=!0),a&64&&(r.hpt=e/20),r}function kD(t){var r=lD(t);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var e=t.read_shift(4);return e!==0}function ED(t){return t.read_shift(2),t.read_shift(4)}function Sy(t,r,e){var a=0;e&&e.biff==2||(a=t.read_shift(2));var n=t.read_shift(2);e&&e.biff==2&&(a=1-(n>>15),n&=32767);var o={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[o,n]}function TD(t){var r=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2),o=t.read_shift(2),s=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),i=t.read_shift(2);return{Pos:[r,e],Dim:[a,n],Flags:o,CurTab:s,FirstTab:l,Selected:c,TabRatio:i}}function AD(t,r,e){if(e&&e.biff>=2&&e.biff<5)return{};var a=t.read_shift(2);return{RTL:a&64}}function CD(){}function ND(t,r,e){var a={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return a.name=Yu(t,0,e),a}function jD(t){var r=Fs(t);return r.isst=t.read_shift(4),r}function OD(t,r,e){e.biffguess&&e.biff==2&&(e.biff=5);var a=t.l+r,n=Fs(t);e.biff==2&&t.l++;var o=Xu(t,a-t.l,e);return n.val=o,n}function DD(t,r,e){var a=t.read_shift(2),n=Go(t,0,e);return[a,n]}var MD=Go;function ky(t,r,e){var a=t.l+r,n=e.biff==8||!e.biff?4:2,o=t.read_shift(n),s=t.read_shift(n),l=t.read_shift(2),c=t.read_shift(2);return t.l=a,{s:{r:o,c:l},e:{r:s,c}}}function RD(t){var r=t.read_shift(2),e=t.read_shift(2),a=r4(t);return{r,c:e,ixfe:a[0],rknum:a[1]}}function ID(t,r){for(var e=t.l+r-2,a=t.read_shift(2),n=t.read_shift(2),o=[];t.l<e;)o.push(r4(t));if(t.l!==e)throw new Error("MulRK read error");var s=t.read_shift(2);if(o.length!=s-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:s,rkrec:o}}function FD(t,r){for(var e=t.l+r-2,a=t.read_shift(2),n=t.read_shift(2),o=[];t.l<e;)o.push(t.read_shift(2));if(t.l!==e)throw new Error("MulBlank read error");var s=t.read_shift(2);if(o.length!=s-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:s,ixfe:o}}function PD(t,r,e,a){var n={},o=t.read_shift(4),s=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(2);return n.patternType=RO[l>>26],a.cellStyles&&(n.alc=o&7,n.fWrap=o>>3&1,n.alcV=o>>4&7,n.fJustLast=o>>7&1,n.trot=o>>8&255,n.cIndent=o>>16&15,n.fShrinkToFit=o>>20&1,n.iReadOrder=o>>22&2,n.fAtrNum=o>>26&1,n.fAtrFnt=o>>27&1,n.fAtrAlc=o>>28&1,n.fAtrBdr=o>>29&1,n.fAtrPat=o>>30&1,n.fAtrProt=o>>31&1,n.dgLeft=s&15,n.dgRight=s>>4&15,n.dgTop=s>>8&15,n.dgBottom=s>>12&15,n.icvLeft=s>>16&127,n.icvRight=s>>23&127,n.grbitDiag=s>>30&3,n.icvTop=l&127,n.icvBottom=l>>7&127,n.icvDiag=l>>14&127,n.dgDiag=l>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function LD(t,r,e){var a={};return a.ifnt=t.read_shift(2),a.numFmtId=t.read_shift(2),a.flags=t.read_shift(2),a.fStyle=a.flags>>2&1,r-=6,a.data=PD(t,r,a.fStyle,e),a}function BD(t){t.l+=4;var r=[t.read_shift(2),t.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function Ey(t,r,e){var a=Fs(t);(e.biff==2||r==9)&&++t.l;var n=tD(t);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function UD(t,r,e){e.biffguess&&e.biff==2&&(e.biff=5);var a=Fs(t),n=za(t);return a.val=n,a}var Ty=cD;function zD(t,r,e){var a=t.l+r,n=t.read_shift(2),o=t.read_shift(2);if(e.sbcch=o,o==1025||o==14849)return[o,n];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var s=zo(t,o),l=[];a>t.l;)l.push(Xu(t));return[o,n,s,l]}function Ay(t,r,e){var a=t.read_shift(2),n,o={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return e.sbcch===14849&&(n=dD(t,r-2,e)),o.body=n||t.read_shift(r-2),typeof n=="string"&&(o.Name=n),o}var $D=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Cy(t,r,e){var a=t.l+r,n=t.read_shift(2),o=t.read_shift(1),s=t.read_shift(1),l=t.read_shift(e&&e.biff==2?1:2),c=0;(!e||e.biff>=5)&&(e.biff!=5&&(t.l+=2),c=t.read_shift(2),e.biff==5&&(t.l+=2),t.l+=4);var i=zo(t,s,e);n&32&&(i=$D[i.charCodeAt(0)]);var u=a-t.l;e&&e.biff==2&&--u;var p=a==t.l||l===0||!(u>0)?[]:SF(t,u,e,l);return{chKey:o,Name:i,itab:c,rgce:p}}function s4(t,r,e){if(e.biff<8)return VD(t,r,e);for(var a=[],n=t.l+r,o=t.read_shift(e.biff>8?4:2);o--!==0;)a.push(uD(t,e.biff>8?12:6,e));if(t.l!=n)throw new Error("Bad ExternSheet: "+t.l+" != "+n);return a}function VD(t,r,e){t[t.l+1]==3&&t[t.l]++;var a=Yu(t,r,e);return a.charCodeAt(0)==3?a.slice(1):a}function HD(t,r,e){if(e.biff<8){t.l+=r;return}var a=t.read_shift(2),n=t.read_shift(2),o=zo(t,a,e),s=zo(t,n,e);return[o,s]}function qD(t,r,e){var a=a4(t);t.l++;var n=t.read_shift(1);return r-=8,[kF(t,r,e),n,a]}function Ny(t,r,e){var a=fD(t);switch(e.biff){case 2:t.l++,r-=7;break;case 3:case 4:t.l+=2,r-=8;break;default:t.l+=6,r-=12}return[a,wF(t,r,e)]}function WD(t){var r=t.read_shift(4)!==0,e=t.read_shift(4)!==0,a=t.read_shift(4);return[r,e,a]}function GD(t,r,e){if(!(e.biff<8)){var a=t.read_shift(2),n=t.read_shift(2),o=t.read_shift(2),s=t.read_shift(2),l=Go(t,0,e);return e.biff<8&&t.read_shift(1),[{r:a,c:n},l,s,o]}}function YD(t,r,e){return GD(t,r,e)}function XD(t,r){for(var e=[],a=t.read_shift(2);a--;)e.push(Zf(t));return e}function KD(t,r,e){if(e&&e.biff<8)return JD(t,r,e);var a=n4(t),n=gD(t,r-22,a[1]);return{cmo:a,ft:n}}var ZD={8:function(t,r){var e=t.l+r;t.l+=10;var a=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var n=t.read_shift(1);return t.l+=n,t.l=e,{fmt:a}}};function JD(t,r,e){t.l+=4;var a=t.read_shift(2),n=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,r-=36;var s=[];return s.push((ZD[a]||Ha)(t,r,e)),{cmo:[n,a,o],ft:s}}function QD(t,r,e){var a=t.l,n="";try{t.l+=4;var o=(e.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(o)==-1?t.l+=6:s=aD(t,6,e);var l=t.read_shift(2);t.read_shift(2),oa(t,2);var c=t.read_shift(2);t.l+=c;for(var i=1;i<t.lens.length-1;++i){if(t.l-a!=t.lens[i])throw new Error("TxO: bad continue record");var u=t[t.l],p=zo(t,t.lens[i+1]-t.lens[i]-1);if(n+=p,n.length>=(u?l:2*l))break}if(n.length!==l&&n.length!==l*2)throw new Error("cchText: "+l+" != "+n.length);return t.l=a+r,{t:n}}catch{return t.l=a+r,{t:n}}}function eM(t,r){var e=Zf(t);t.l+=16;var a=oD(t,r-24);return[e,a]}function tM(t,r){t.read_shift(2);var e=Zf(t),a=t.read_shift((r-10)/2,"dbcs-cont");return a=a.replace(Qa,""),[e,a]}function rM(t){var r=[0,0],e;return e=t.read_shift(2),r[0]=by[e]||e,e=t.read_shift(2),r[1]=by[e]||e,r}function aM(t){for(var r=t.read_shift(2),e=[];r-- >0;)e.push(t4(t));return e}function nM(t){for(var r=t.read_shift(2),e=[];r-- >0;)e.push(t4(t));return e}function sM(t){t.l+=2;var r={cxfs:0,crc:0};return r.cxfs=t.read_shift(2),r.crc=t.read_shift(4),r}function i4(t,r,e){if(!e.cellStyles)return Ha(t,r);var a=e&&e.biff>=12?4:2,n=t.read_shift(a),o=t.read_shift(a),s=t.read_shift(a),l=t.read_shift(a),c=t.read_shift(2);a==2&&(t.l+=2);var i={s:n,e:o,w:s,ixfe:l,flags:c};return(e.biff>=5||!e.biff)&&(i.level=c>>8&7),i}function iM(t,r){var e={};return r<32||(t.l+=16,e.header=za(t),e.footer=za(t),t.l+=2),e}function oM(t,r,e){var a={area:!1};if(e.biff!=5)return t.l+=r,a;var n=t.read_shift(1);return t.l+=3,n&16&&(a.area=!0),a}var lM=Fs,cM=Q_,uM=Xu;function dM(t){var r=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(4),n={fmt:r,env:e,len:a,data:t.slice(t.l,t.l+a)};return t.l+=a,n}function fM(t,r,e){e.biffguess&&e.biff==5&&(e.biff=2);var a=Fs(t);++t.l;var n=Go(t,r-7,e);return a.t="str",a.val=n,a}function hM(t){var r=Fs(t);++t.l;var e=za(t);return r.t="n",r.val=e,r}function pM(t){var r=Fs(t);++t.l;var e=t.read_shift(2);return r.t="n",r.val=e,r}function mM(t){var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,"sbcs-cont")}function gM(t,r){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=r-13}function vM(t,r,e){var a=t.l+r,n=Fs(t),o=t.read_shift(2),s=zo(t,o,e);return t.l=a,n.t="str",n.val=s,n}var bM=[2,3,48,49,131,139,140,245],jy=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=qm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(l,c){var i=[],u=eo(1);switch(c.type){case"base64":u=is(Tn(l));break;case"binary":u=is(l);break;case"buffer":case"array":u=l;break}ja(u,0);var p=u.read_shift(1),f=!!(p&136),h=!1,v=!1;switch(p){case 2:break;case 3:break;case 48:h=!0,f=!0;break;case 49:h=!0,f=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var b=0,g=521;p==2&&(b=u.read_shift(2)),u.l+=3,p!=2&&(b=u.read_shift(4)),b>1048576&&(b=1e6),p!=2&&(g=u.read_shift(2));var x=u.read_shift(2),y=c.codepage||1252;p!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(y=t[u[u.l]]),u.l+=1,u.l+=2),v&&(u.l+=36);for(var E=[],N={},I=Math.min(u.length,p==2?521:g-10-(h?264:0)),P=v?32:11;u.l<I&&u[u.l]!=13;)switch(N={},N.name=Ou.utils.decode(y,u.slice(u.l,u.l+P)).replace(/[\u0000\r\n].*$/g,""),u.l+=P,N.type=String.fromCharCode(u.read_shift(1)),p!=2&&!v&&(N.offset=u.read_shift(4)),N.len=u.read_shift(1),p==2&&(N.offset=u.read_shift(2)),N.dec=u.read_shift(1),N.name.length&&E.push(N),p!=2&&(u.l+=v?13:14),N.type){case"B":(!h||N.len!=8)&&c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var V=0,U=0;for(i[0]=[],U=0;U!=E.length;++U)i[0][U]=E[U].name;for(;b-- >0;){if(u[u.l]===42){u.l+=x;continue}for(++u.l,i[++V]=[],U=0,U=0;U!=E.length;++U){var H=u.slice(u.l,u.l+E[U].len);u.l+=E[U].len,ja(H,0);var G=Ou.utils.decode(y,H);switch(E[U].type){case"C":G.trim().length&&(i[V][U]=G.replace(/\s+$/,""));break;case"D":G.length===8?i[V][U]=new Date(+G.slice(0,4),+G.slice(4,6)-1,+G.slice(6,8)):i[V][U]=G;break;case"F":i[V][U]=parseFloat(G.trim());break;case"+":case"I":i[V][U]=v?H.read_shift(-4,"i")^2147483648:H.read_shift(4,"i");break;case"L":switch(G.trim().toUpperCase()){case"Y":case"T":i[V][U]=!0;break;case"N":case"F":i[V][U]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+G+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));i[V][U]="##MEMO##"+(v?parseInt(G.trim(),10):H.read_shift(4));break;case"N":G=G.replace(/\u0000/g,"").trim(),G&&G!="."&&(i[V][U]=+G||0);break;case"@":i[V][U]=new Date(H.read_shift(-8,"f")-621356832e5);break;case"T":i[V][U]=new Date((H.read_shift(4)-2440588)*864e5+H.read_shift(4));break;case"Y":i[V][U]=H.read_shift(4,"i")/1e4+H.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":i[V][U]=-H.read_shift(-8,"f");break;case"B":if(h&&E[U].len==8){i[V][U]=H.read_shift(8,"f");break}case"G":case"P":H.l+=E[U].len;break;case"0":if(E[U].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[U].type)}}}if(p!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(i=i.slice(0,c.sheetRows)),c.DBF=E,i}function a(l,c){var i=c||{};i.dateNF||(i.dateNF="yyyymmdd");var u=nc(e(l,i),i);return u["!cols"]=i.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete i.DBF,u}function n(l,c){try{return ao(a(l,c),c)}catch(i){if(c&&c.WTF)throw i}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function s(l,c){var i=c||{};if(+i.codepage>=0&&ls(+i.codepage),i.type=="string")throw new Error("Cannot write DBF to JS string");var u=Jp(),p=om(l,{header:1,raw:!0,cellDates:!0}),f=p[0],h=p.slice(1),v=l["!cols"]||[],b=0,g=0,x=0,y=1;for(b=0;b<f.length;++b){if(((v[b]||{}).DBF||{}).name){f[b]=v[b].DBF.name,++x;continue}if(f[b]!=null){if(++x,typeof f[b]=="number"&&(f[b]=f[b].toString(10)),typeof f[b]!="string")throw new Error("DBF Invalid column name "+f[b]+" |"+typeof f[b]+"|");if(f.indexOf(f[b])!==b){for(g=0;g<1024;++g)if(f.indexOf(f[b]+"_"+g)==-1){f[b]+="_"+g;break}}}}var E=Yr(l["!ref"]),N=[],I=[],P=[];for(b=0;b<=E.e.c-E.s.c;++b){var V="",U="",H=0,G=[];for(g=0;g<h.length;++g)h[g][b]!=null&&G.push(h[g][b]);if(G.length==0||f[b]==null){N[b]="?";continue}for(g=0;g<G.length;++g){switch(typeof G[g]){case"number":U="B";break;case"string":U="C";break;case"boolean":U="L";break;case"object":U=G[g]instanceof Date?"D":"C";break;default:U="C"}H=Math.max(H,String(G[g]).length),V=V&&V!=U?"C":U}H>250&&(H=250),U=((v[b]||{}).DBF||{}).type,U=="C"&&v[b].DBF.len>H&&(H=v[b].DBF.len),V=="B"&&U=="N"&&(V="N",P[b]=v[b].DBF.dec,H=v[b].DBF.len),I[b]=V=="C"||U=="N"?H:o[V]||0,y+=I[b],N[b]=V}var Z=u.next(32);for(Z.write_shift(4,318902576),Z.write_shift(4,h.length),Z.write_shift(2,296+32*x),Z.write_shift(2,y),b=0;b<4;++b)Z.write_shift(4,0);for(Z.write_shift(4,0|(+r[s_]||3)<<8),b=0,g=0;b<f.length;++b)if(f[b]!=null){var W=u.next(32),O=(f[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);W.write_shift(1,O,"sbcs"),W.write_shift(1,N[b]=="?"?"C":N[b],"sbcs"),W.write_shift(4,g),W.write_shift(1,I[b]||o[N[b]]||0),W.write_shift(1,P[b]||0),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(1,0),W.write_shift(4,0),W.write_shift(4,0),g+=I[b]||o[N[b]]||0}var R=u.next(264);for(R.write_shift(4,13),b=0;b<65;++b)R.write_shift(4,0);for(b=0;b<h.length;++b){var C=u.next(y);for(C.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(N[g]){case"L":C.write_shift(1,h[b][g]==null?63:h[b][g]?84:70);break;case"B":C.write_shift(8,h[b][g]||0,"f");break;case"N":var _="0";for(typeof h[b][g]=="number"&&(_=h[b][g].toFixed(P[g]||0)),x=0;x<I[g]-_.length;++x)C.write_shift(1,32);C.write_shift(1,_,"sbcs");break;case"D":h[b][g]?(C.write_shift(4,("0000"+h[b][g].getFullYear()).slice(-4),"sbcs"),C.write_shift(2,("00"+(h[b][g].getMonth()+1)).slice(-2),"sbcs"),C.write_shift(2,("00"+h[b][g].getDate()).slice(-2),"sbcs")):C.write_shift(8,"00000000","sbcs");break;case"C":var k=String(h[b][g]!=null?h[b][g]:"").slice(0,I[g]);for(C.write_shift(1,k,"sbcs"),x=0;x<I[g]-k.length;++x)C.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:n,to_sheet:a,from_sheet:s}}(),xM=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Ds(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(f,h){var v=t[h];return typeof v=="number"?Wx(v):v},a=function(f,h,v){var b=h.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return b==59?f:Wx(b)};t["|"]=254;function n(f,h){switch(h.type){case"base64":return o(Tn(f),h);case"binary":return o(f,h);case"buffer":return o(fr&&Buffer.isBuffer(f)?f.toString("binary"):Vo(f),h);case"array":return o(Uo(f),h)}throw new Error("Unrecognized type "+h.type)}function o(f,h){var v=f.split(/[\n\r]+/),b=-1,g=-1,x=0,y=0,E=[],N=[],I=null,P={},V=[],U=[],H=[],G=0,Z;for(+h.codepage>=0&&ls(+h.codepage);x!==v.length;++x){G=0;var W=v[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(r,e),O=W.replace(/;;/g,"\0").split(";").map(function(re){return re.replace(/\u0000/g,";")}),R=O[0],C;if(W.length>0)switch(R){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":O[1].charAt(0)=="P"&&N.push(W.slice(3).replace(/;;/g,";"));break;case"C":var _=!1,k=!1,A=!1,T=!1,D=-1,B=-1;for(y=1;y<O.length;++y)switch(O[y].charAt(0)){case"A":break;case"X":g=parseInt(O[y].slice(1))-1,k=!0;break;case"Y":for(b=parseInt(O[y].slice(1))-1,k||(g=0),Z=E.length;Z<=b;++Z)E[Z]=[];break;case"K":C=O[y].slice(1),C.charAt(0)==='"'?C=C.slice(1,C.length-1):C==="TRUE"?C=!0:C==="FALSE"?C=!1:isNaN(us(C))?isNaN(Zl(C).getDate())||(C=Sa(C)):(C=us(C),I!==null&&rc(I)&&(C=Kf(C))),_=!0;break;case"E":T=!0;var F=Gl(O[y].slice(1),{r:b,c:g});E[b][g]=[E[b][g],F];break;case"S":A=!0,E[b][g]=[E[b][g],"S5S"];break;case"G":break;case"R":D=parseInt(O[y].slice(1))-1;break;case"C":B=parseInt(O[y].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+W)}if(_&&(E[b][g]&&E[b][g].length==2?E[b][g][0]=C:E[b][g]=C,I=null),A){if(T)throw new Error("SYLK shared formula cannot have own formula");var Y=D>-1&&E[D][B];if(!Y||!Y[1])throw new Error("SYLK shared formula cannot find base");E[b][g][1]=g4(Y[1],{r:b-D,c:g-B})}break;case"F":var X=0;for(y=1;y<O.length;++y)switch(O[y].charAt(0)){case"X":g=parseInt(O[y].slice(1))-1,++X;break;case"Y":for(b=parseInt(O[y].slice(1))-1,Z=E.length;Z<=b;++Z)E[Z]=[];break;case"M":G=parseInt(O[y].slice(1))/20;break;case"F":break;case"G":break;case"P":I=N[parseInt(O[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(H=O[y].slice(1).split(" "),Z=parseInt(H[0],10);Z<=parseInt(H[1],10);++Z)G=parseInt(H[2],10),U[Z-1]=G===0?{hidden:!0}:{wch:G},Jl(U[Z-1]);break;case"C":g=parseInt(O[y].slice(1))-1,U[g]||(U[g]={});break;case"R":b=parseInt(O[y].slice(1))-1,V[b]||(V[b]={}),G>0?(V[b].hpt=G,V[b].hpx=Pu(G)):G===0&&(V[b].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+W)}X<1&&(I=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+W)}}return V.length>0&&(P["!rows"]=V),U.length>0&&(P["!cols"]=U),h&&h.sheetRows&&(E=E.slice(0,h.sheetRows)),[E,P]}function s(f,h){var v=n(f,h),b=v[0],g=v[1],x=nc(b,h);return Ds(g).forEach(function(y){x[y]=g[y]}),x}function l(f,h){return ao(s(f,h),h)}function c(f,h,v,b){var g="C;Y"+(v+1)+";X"+(b+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+sI(f.f,{r:v,c:b}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function i(f,h){h.forEach(function(v,b){var g="F;W"+(b+1)+" "+(b+1)+" ";v.hidden?g+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Ff(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Pf(v.wpx)),typeof v.wch=="number"&&(g+=Math.round(v.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function u(f,h){h.forEach(function(v,b){var g="F;";v.hidden?g+="M0;":v.hpt?g+="M"+20*v.hpt+";":v.hpx&&(g+="M"+20*h4(v.hpx)+";"),g.length>2&&f.push(g+"R"+(b+1))})}function p(f,h){var v=["ID;PWXL;N;E"],b=[],g=Yr(f["!ref"]),x,y=Array.isArray(f),E=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),f["!cols"]&&i(v,f["!cols"]),f["!rows"]&&u(v,f["!rows"]),v.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var N=g.s.r;N<=g.e.r;++N)for(var I=g.s.c;I<=g.e.c;++I){var P=Qt({r:N,c:I});x=y?(f[N]||[])[I]:f[P],!(!x||x.v==null&&(!x.f||x.F))&&b.push(c(x,f,N,I))}return v.join(E)+E+b.join(E)+E+"E"+E}return{to_workbook:l,to_sheet:s,from_sheet:p}}(),yM=function(){function t(o,s){switch(s.type){case"base64":return r(Tn(o),s);case"binary":return r(o,s);case"buffer":return r(fr&&Buffer.isBuffer(o)?o.toString("binary"):Vo(o),s);case"array":return r(Uo(o),s)}throw new Error("Unrecognized type "+s.type)}function r(o,s){for(var l=o.split(`
`),c=-1,i=-1,u=0,p=[];u!==l.length;++u){if(l[u].trim()==="BOT"){p[++c]=[],i=0;continue}if(!(c<0)){var f=l[u].trim().split(","),h=f[0],v=f[1];++u;for(var b=l[u]||"";(b.match(/["]/g)||[]).length&1&&u<l.length-1;)b+=`
`+l[++u];switch(b=b.trim(),+h){case-1:if(b==="BOT"){p[++c]=[],i=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?p[c][i]=!0:b==="FALSE"?p[c][i]=!1:isNaN(us(v))?isNaN(Zl(v).getDate())?p[c][i]=v:p[c][i]=Sa(v):p[c][i]=us(v),++i;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),p[c][i++]=b!==""?b:null;break}if(b==="EOD")break}}return s&&s.sheetRows&&(p=p.slice(0,s.sheetRows)),p}function e(o,s){return nc(t(o,s),s)}function a(o,s){return ao(e(o,s),s)}var n=function(){var o=function(c,i,u,p,f){c.push(i),c.push(u+","+p),c.push('"'+f.replace(/"/g,'""')+'"')},s=function(c,i,u,p){c.push(i+","+u),c.push(i==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(c){var i=[],u=Yr(c["!ref"]),p,f=Array.isArray(c);o(i,"TABLE",0,1,"sheetjs"),o(i,"VECTORS",0,u.e.r-u.s.r+1,""),o(i,"TUPLES",0,u.e.c-u.s.c+1,""),o(i,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){s(i,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var b=Qt({r:h,c:v});if(p=f?(c[h]||[])[v]:c[b],!p){s(i,1,0,"");continue}switch(p.t){case"n":var g=p.w;!g&&p.v!=null&&(g=p.v),g==null?p.f&&!p.F?s(i,1,0,"="+p.f):s(i,1,0,""):s(i,0,g,"V");break;case"b":s(i,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":s(i,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Hn(p.z||rr[14],en(Sa(p.v)))),s(i,0,p.w,"V");break;default:s(i,1,0,"")}}}s(i,-1,0,"EOD");var x=`\r
`,y=i.join(x);return y}}();return{to_workbook:a,to_sheet:e,from_sheet:n}}(),wM=function(){function t(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(p,f){for(var h=p.split(`
`),v=-1,b=-1,g=0,x=[];g!==h.length;++g){var y=h[g].trim().split(":");if(y[0]==="cell"){var E=Ja(y[1]);if(x.length<=E.r)for(v=x.length;v<=E.r;++v)x[v]||(x[v]=[]);switch(v=E.r,b=E.c,y[2]){case"t":x[v][b]=t(y[3]);break;case"v":x[v][b]=+y[3];break;case"vtf":var N=y[y.length-1];case"vtc":switch(y[3]){case"nl":x[v][b]=!!+y[4];break;default:x[v][b]=+y[4];break}y[2]=="vtf"&&(x[v][b]=[x[v][b],N])}}}return f&&f.sheetRows&&(x=x.slice(0,f.sheetRows)),x}function a(p,f){return nc(e(p,f),f)}function n(p,f){return ao(a(p,f),f)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function i(p){if(!p||!p["!ref"])return"";for(var f=[],h=[],v,b="",g=ac(p["!ref"]),x=Array.isArray(p),y=g.s.r;y<=g.e.r;++y)for(var E=g.s.c;E<=g.e.c;++E)if(b=Qt({r:y,c:E}),v=x?(p[y]||[])[E]:p[b],!(!v||v.v==null||v.t==="z")){switch(h=["cell",b,"t"],v.t){case"s":case"str":h.push(r(v.v));break;case"n":v.f?(h[2]="vtf",h[3]="n",h[4]=v.v,h[5]=r(v.f)):(h[2]="v",h[3]=v.v);break;case"b":h[2]="vt"+(v.f?"f":"c"),h[3]="nl",h[4]=v.v?"1":"0",h[5]=r(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var N=en(Sa(v.v));h[2]="vtc",h[3]="nd",h[4]=""+N,h[5]=v.w||Hn(v.z||rr[14],N);break;case"e":continue}f.push(h.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(p){return[o,s,l,s,i(p),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:u}}(),Iu=function(){function t(u,p,f,h,v){v.raw?p[f][h]=u:u===""||(u==="TRUE"?p[f][h]=!0:u==="FALSE"?p[f][h]=!1:isNaN(us(u))?isNaN(Zl(u).getDate())?p[f][h]=u:p[f][h]=Sa(u):p[f][h]=us(u))}function r(u,p){var f=p||{},h=[];if(!u||u.length===0)return h;for(var v=u.split(/[\r\n]/),b=v.length-1;b>=0&&v[b].length===0;)--b;for(var g=10,x=0,y=0;y<=b;++y)x=v[y].indexOf(" "),x==-1?x=v[y].length:x++,g=Math.max(g,x);for(y=0;y<=b;++y){h[y]=[];var E=0;for(t(v[y].slice(0,g).trim(),h,y,E,f),E=1;E<=(v[y].length-g)/10+1;++E)t(v[y].slice(g+(E-1)*10,g+E*10).trim(),h,y,E,f)}return f.sheetRows&&(h=h.slice(0,f.sheetRows)),h}var e={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(u){for(var p={},f=!1,h=0,v=0;h<u.length;++h)(v=u.charCodeAt(h))==34?f=!f:!f&&v in e&&(p[v]=(p[v]||0)+1);v=[];for(h in p)Object.prototype.hasOwnProperty.call(p,h)&&v.push([p[h],h]);if(!v.length){p=a;for(h in p)Object.prototype.hasOwnProperty.call(p,h)&&v.push([p[h],h])}return v.sort(function(b,g){return b[0]-g[0]||a[b[1]]-a[g[1]]}),e[v.pop()[1]]||44}function o(u,p){var f=p||{},h="",v=f.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=n(u.slice(0,1024)):f&&f.FS?h=f.FS:h=n(u.slice(0,1024));var g=0,x=0,y=0,E=0,N=0,I=h.charCodeAt(0),P=!1,V=0,U=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var H=f.dateNF!=null?Dj(f.dateNF):null;function G(){var Z=u.slice(E,N),W={};if(Z.charAt(0)=='"'&&Z.charAt(Z.length-1)=='"'&&(Z=Z.slice(1,-1).replace(/""/g,'"')),Z.length===0)W.t="z";else if(f.raw)W.t="s",W.v=Z;else if(Z.trim().length===0)W.t="s",W.v=Z;else if(Z.charCodeAt(0)==61)Z.charCodeAt(1)==34&&Z.charCodeAt(Z.length-1)==34?(W.t="s",W.v=Z.slice(2,-1).replace(/""/g,'"')):oI(Z)?(W.t="n",W.f=Z.slice(1)):(W.t="s",W.v=Z);else if(Z=="TRUE")W.t="b",W.v=!0;else if(Z=="FALSE")W.t="b",W.v=!1;else if(!isNaN(y=us(Z)))W.t="n",f.cellText!==!1&&(W.w=Z),W.v=y;else if(!isNaN(Zl(Z).getDate())||H&&Z.match(H)){W.z=f.dateNF||rr[14];var O=0;H&&Z.match(H)&&(Z=Mj(Z,f.dateNF,Z.match(H)||[]),O=1),f.cellDates?(W.t="d",W.v=Sa(Z,O)):(W.t="n",W.v=en(Sa(Z,O))),f.cellText!==!1&&(W.w=Hn(W.z,W.v instanceof Date?en(W.v):W.v)),f.cellNF||delete W.z}else W.t="s",W.v=Z;if(W.t=="z"||(f.dense?(v[g]||(v[g]=[]),v[g][x]=W):v[Qt({c:x,r:g})]=W),E=N+1,U=u.charCodeAt(E),b.e.c<x&&(b.e.c=x),b.e.r<g&&(b.e.r=g),V==I)++x;else if(x=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;N<u.length;++N)switch(V=u.charCodeAt(N)){case 34:U===34&&(P=!P);break;case I:case 10:case 13:if(!P&&G())break e;break}return N-E>0&&G(),v["!ref"]=mr(b),v}function s(u,p){return!(p&&p.PRN)||p.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?o(u,p):nc(r(u,p),p)}function l(u,p){var f="",h=p.type=="string"?[0,0,0,0]:u1(u,p);switch(p.type){case"base64":f=Tn(u);break;case"binary":f=u;break;case"buffer":p.codepage==65001?f=u.toString("utf8"):p.codepage&&typeof Ou<"u"||(f=fr&&Buffer.isBuffer(u)?u.toString("binary"):Vo(u));break;case"array":f=Uo(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+p.type)}return h[0]==239&&h[1]==187&&h[2]==191?f=Fr(f.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?f=Fr(f):p.type=="binary"&&typeof Ou<"u",f.slice(0,19)=="socialcalc:version:"?wM.to_sheet(p.type=="string"?f:Fr(f),p):s(f,p)}function c(u,p){return ao(l(u,p),p)}function i(u){for(var p=[],f=Yr(u["!ref"]),h,v=Array.isArray(u),b=f.s.r;b<=f.e.r;++b){for(var g=[],x=f.s.c;x<=f.e.c;++x){var y=Qt({r:b,c:x});if(h=v?(u[b]||[])[x]:u[y],!h||h.v==null){g.push("          ");continue}for(var E=(h.w||(ii(h),h.w)||"").slice(0,10);E.length<10;)E+=" ";g.push(E+(x===0?" ":""))}p.push(g.join(""))}return p.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:i}}();function _M(t,r){var e=r||{},a=!!e.WTF;e.WTF=!0;try{var n=xM.to_workbook(t,e);return e.WTF=a,n}catch(o){if(e.WTF=a,!o.message.match(/SYLK bad record ID/)&&a)throw o;return Iu.to_workbook(t,r)}}var mu=function(){function t(F,Y,X){if(F){ja(F,F.l||0);for(var re=X.Enum||D;F.l<F.length;){var z=F.read_shift(2),ee=re[z]||re[65535],L=F.read_shift(2),M=F.l+L,K=ee.f&&ee.f(F,L,X);if(F.l=M,Y(K,ee,z))return}}}function r(F,Y){switch(Y.type){case"base64":return e(is(Tn(F)),Y);case"binary":return e(is(F),Y);case"buffer":case"array":return e(F,Y)}throw"Unsupported type "+Y.type}function e(F,Y){if(!F)return F;var X=Y||{},re=X.dense?[]:{},z="Sheet1",ee="",L=0,M={},K=[],se=[],te={s:{r:0,c:0},e:{r:0,c:0}},ae=X.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)X.Enum=D,t(F,function(ne,ue,he){switch(he){case 0:X.vers=ne,ne>=4096&&(X.qpro=!0);break;case 6:te=ne;break;case 204:ne&&(ee=ne);break;case 222:ee=ne;break;case 15:case 51:X.qpro||(ne[1].v=ne[1].v.slice(1));case 13:case 14:case 16:he==14&&(ne[2]&112)==112&&(ne[2]&15)>1&&(ne[2]&15)<15&&(ne[1].z=X.dateNF||rr[14],X.cellDates&&(ne[1].t="d",ne[1].v=Kf(ne[1].v))),X.qpro&&ne[3]>L&&(re["!ref"]=mr(te),M[z]=re,K.push(z),re=X.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},L=ne[3],z=ee||"Sheet"+(L+1),ee="");var ke=X.dense?(re[ne[0].r]||[])[ne[0].c]:re[Qt(ne[0])];if(ke){ke.t=ne[1].t,ke.v=ne[1].v,ne[1].z!=null&&(ke.z=ne[1].z),ne[1].f!=null&&(ke.f=ne[1].f);break}X.dense?(re[ne[0].r]||(re[ne[0].r]=[]),re[ne[0].r][ne[0].c]=ne[1]):re[Qt(ne[0])]=ne[1];break}},X);else if(F[2]==26||F[2]==14)X.Enum=B,F[2]==14&&(X.qpro=!0,F.l=0),t(F,function(ne,ue,he){switch(he){case 204:z=ne;break;case 22:ne[1].v=ne[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ne[3]>L&&(re["!ref"]=mr(te),M[z]=re,K.push(z),re=X.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},L=ne[3],z="Sheet"+(L+1)),ae>0&&ne[0].r>=ae)break;X.dense?(re[ne[0].r]||(re[ne[0].r]=[]),re[ne[0].r][ne[0].c]=ne[1]):re[Qt(ne[0])]=ne[1],te.e.c<ne[0].c&&(te.e.c=ne[0].c),te.e.r<ne[0].r&&(te.e.r=ne[0].r);break;case 27:ne[14e3]&&(se[ne[14e3][0]]=ne[14e3][1]);break;case 1537:se[ne[0]]=ne[1],ne[0]==L&&(z=ne[1]);break}},X);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(re["!ref"]=mr(te),M[ee||z]=re,K.push(ee||z),!se.length)return{SheetNames:K,Sheets:M};for(var Q={},fe=[],le=0;le<se.length;++le)M[K[le]]?(fe.push(se[le]||K[le]),Q[se[le]]=M[se[le]]||M[K[le]]):(fe.push(se[le]),Q[se[le]]={"!ref":"A1"});return{SheetNames:fe,Sheets:Q}}function a(F,Y){var X=Y||{};if(+X.codepage>=0&&ls(+X.codepage),X.type=="string")throw new Error("Cannot write WK1 to JS string");var re=Jp(),z=Yr(F["!ref"]),ee=Array.isArray(F),L=[];rs(re,0,o(1030)),rs(re,6,c(z));for(var M=Math.min(z.e.r,8191),K=z.s.r;K<=M;++K)for(var se=Ma(K),te=z.s.c;te<=z.e.c;++te){K===z.s.r&&(L[te]=va(te));var ae=L[te]+se,Q=ee?(F[K]||[])[te]:F[ae];if(!(!Q||Q.t=="z"))if(Q.t=="n")(Q.v|0)==Q.v&&Q.v>=-32768&&Q.v<=32767?rs(re,13,h(K,te,Q.v)):rs(re,14,b(K,te,Q.v));else{var fe=ii(Q);rs(re,15,p(K,te,fe.slice(0,239)))}}return rs(re,1),re.end()}function n(F,Y){var X=Y||{};if(+X.codepage>=0&&ls(+X.codepage),X.type=="string")throw new Error("Cannot write WK3 to JS string");var re=Jp();rs(re,0,s(F));for(var z=0,ee=0;z<F.SheetNames.length;++z)(F.Sheets[F.SheetNames[z]]||{})["!ref"]&&rs(re,27,T(F.SheetNames[z],ee++));var L=0;for(z=0;z<F.SheetNames.length;++z){var M=F.Sheets[F.SheetNames[z]];if(!(!M||!M["!ref"])){for(var K=Yr(M["!ref"]),se=Array.isArray(M),te=[],ae=Math.min(K.e.r,8191),Q=K.s.r;Q<=ae;++Q)for(var fe=Ma(Q),le=K.s.c;le<=K.e.c;++le){Q===K.s.r&&(te[le]=va(le));var ne=te[le]+fe,ue=se?(M[Q]||[])[le]:M[ne];if(!(!ue||ue.t=="z"))if(ue.t=="n")rs(re,23,G(Q,le,L,ue.v));else{var he=ii(ue);rs(re,22,V(Q,le,L,he.slice(0,239)))}}++L}}return rs(re,1),re.end()}function o(F){var Y=ga(2);return Y.write_shift(2,F),Y}function s(F){var Y=ga(26);Y.write_shift(2,4096),Y.write_shift(2,4),Y.write_shift(4,0);for(var X=0,re=0,z=0,ee=0;ee<F.SheetNames.length;++ee){var L=F.SheetNames[ee],M=F.Sheets[L];if(!(!M||!M["!ref"])){++z;var K=ac(M["!ref"]);X<K.e.r&&(X=K.e.r),re<K.e.c&&(re=K.e.c)}}return X>8191&&(X=8191),Y.write_shift(2,X),Y.write_shift(1,z),Y.write_shift(1,re),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(1,1),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(4,0),Y}function l(F,Y,X){var re={s:{c:0,r:0},e:{c:0,r:0}};return Y==8&&X.qpro?(re.s.c=F.read_shift(1),F.l++,re.s.r=F.read_shift(2),re.e.c=F.read_shift(1),F.l++,re.e.r=F.read_shift(2),re):(re.s.c=F.read_shift(2),re.s.r=F.read_shift(2),Y==12&&X.qpro&&(F.l+=2),re.e.c=F.read_shift(2),re.e.r=F.read_shift(2),Y==12&&X.qpro&&(F.l+=2),re.s.c==65535&&(re.s.c=re.e.c=re.s.r=re.e.r=0),re)}function c(F){var Y=ga(8);return Y.write_shift(2,F.s.c),Y.write_shift(2,F.s.r),Y.write_shift(2,F.e.c),Y.write_shift(2,F.e.r),Y}function i(F,Y,X){var re=[{c:0,r:0},{t:"n",v:0},0,0];return X.qpro&&X.vers!=20768?(re[0].c=F.read_shift(1),re[3]=F.read_shift(1),re[0].r=F.read_shift(2),F.l+=2):(re[2]=F.read_shift(1),re[0].c=F.read_shift(2),re[0].r=F.read_shift(2)),re}function u(F,Y,X){var re=F.l+Y,z=i(F,Y,X);if(z[1].t="s",X.vers==20768){F.l++;var ee=F.read_shift(1);return z[1].v=F.read_shift(ee,"utf8"),z}return X.qpro&&F.l++,z[1].v=F.read_shift(re-F.l,"cstr"),z}function p(F,Y,X){var re=ga(7+X.length);re.write_shift(1,255),re.write_shift(2,Y),re.write_shift(2,F),re.write_shift(1,39);for(var z=0;z<re.length;++z){var ee=X.charCodeAt(z);re.write_shift(1,ee>=128?95:ee)}return re.write_shift(1,0),re}function f(F,Y,X){var re=i(F,Y,X);return re[1].v=F.read_shift(2,"i"),re}function h(F,Y,X){var re=ga(7);return re.write_shift(1,255),re.write_shift(2,Y),re.write_shift(2,F),re.write_shift(2,X,"i"),re}function v(F,Y,X){var re=i(F,Y,X);return re[1].v=F.read_shift(8,"f"),re}function b(F,Y,X){var re=ga(13);return re.write_shift(1,255),re.write_shift(2,Y),re.write_shift(2,F),re.write_shift(8,X,"f"),re}function g(F,Y,X){var re=F.l+Y,z=i(F,Y,X);if(z[1].v=F.read_shift(8,"f"),X.qpro)F.l=re;else{var ee=F.read_shift(2);N(F.slice(F.l,F.l+ee),z),F.l+=ee}return z}function x(F,Y,X){var re=Y&32768;return Y&=-32769,Y=(re?F:0)+(Y>=8192?Y-16384:Y),(re?"":"$")+(X?va(Y):Ma(Y))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(F,Y){ja(F,0);for(var X=[],re=0,z="",ee="",L="",M="";F.l<F.length;){var K=F[F.l++];switch(K){case 0:X.push(F.read_shift(8,"f"));break;case 1:ee=x(Y[0].c,F.read_shift(2),!0),z=x(Y[0].r,F.read_shift(2),!1),X.push(ee+z);break;case 2:{var se=x(Y[0].c,F.read_shift(2),!0),te=x(Y[0].r,F.read_shift(2),!1);ee=x(Y[0].c,F.read_shift(2),!0),z=x(Y[0].r,F.read_shift(2),!1),X.push(se+te+":"+ee+z)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:X.push("("+X.pop()+")");break;case 5:X.push(F.read_shift(2));break;case 6:{for(var ae="";K=F[F.l++];)ae+=String.fromCharCode(K);X.push('"'+ae.replace(/"/g,'""')+'"')}break;case 8:X.push("-"+X.pop());break;case 23:X.push("+"+X.pop());break;case 22:X.push("NOT("+X.pop()+")");break;case 20:case 21:M=X.pop(),L=X.pop(),X.push(["AND","OR"][K-20]+"("+L+","+M+")");break;default:if(K<32&&E[K])M=X.pop(),L=X.pop(),X.push(L+E[K]+M);else if(y[K]){if(re=y[K][1],re==69&&(re=F[F.l++]),re>X.length){console.error("WK1 bad formula parse 0x"+K.toString(16)+":|"+X.join("|")+"|");return}var Q=X.slice(-re);X.length-=re,X.push(y[K][0]+"("+Q.join(",")+")")}else return K<=7?console.error("WK1 invalid opcode "+K.toString(16)):K<=24?console.error("WK1 unsupported op "+K.toString(16)):K<=30?console.error("WK1 invalid opcode "+K.toString(16)):K<=115?console.error("WK1 unsupported function opcode "+K.toString(16)):console.error("WK1 unrecognized opcode "+K.toString(16))}}X.length==1?Y[1].f=""+X[0]:console.error("WK1 bad formula parse |"+X.join("|")+"|")}function I(F){var Y=[{c:0,r:0},{t:"n",v:0},0];return Y[0].r=F.read_shift(2),Y[3]=F[F.l++],Y[0].c=F[F.l++],Y}function P(F,Y){var X=I(F);return X[1].t="s",X[1].v=F.read_shift(Y-4,"cstr"),X}function V(F,Y,X,re){var z=ga(6+re.length);z.write_shift(2,F),z.write_shift(1,X),z.write_shift(1,Y),z.write_shift(1,39);for(var ee=0;ee<re.length;++ee){var L=re.charCodeAt(ee);z.write_shift(1,L>=128?95:L)}return z.write_shift(1,0),z}function U(F,Y){var X=I(F);X[1].v=F.read_shift(2);var re=X[1].v>>1;if(X[1].v&1)switch(re&7){case 0:re=(re>>3)*5e3;break;case 1:re=(re>>3)*500;break;case 2:re=(re>>3)/20;break;case 3:re=(re>>3)/200;break;case 4:re=(re>>3)/2e3;break;case 5:re=(re>>3)/2e4;break;case 6:re=(re>>3)/16;break;case 7:re=(re>>3)/64;break}return X[1].v=re,X}function H(F,Y){var X=I(F),re=F.read_shift(4),z=F.read_shift(4),ee=F.read_shift(2);if(ee==65535)return re===0&&z===3221225472?(X[1].t="e",X[1].v=15):re===0&&z===3489660928?(X[1].t="e",X[1].v=42):X[1].v=0,X;var L=ee&32768;return ee=(ee&32767)-16446,X[1].v=(1-L*2)*(z*Math.pow(2,ee+32)+re*Math.pow(2,ee)),X}function G(F,Y,X,re){var z=ga(14);if(z.write_shift(2,F),z.write_shift(1,X),z.write_shift(1,Y),re==0)return z.write_shift(4,0),z.write_shift(4,0),z.write_shift(2,65535),z;var ee=0,L=0,M=0,K=0;return re<0&&(ee=1,re=-re),L=Math.log2(re)|0,re/=Math.pow(2,L-31),K=re>>>0,(K&2147483648)==0&&(re/=2,++L,K=re>>>0),re-=K,K|=2147483648,K>>>=0,re*=Math.pow(2,32),M=re>>>0,z.write_shift(4,M),z.write_shift(4,K),L+=16383+(ee?32768:0),z.write_shift(2,L),z}function Z(F,Y){var X=H(F);return F.l+=Y-14,X}function W(F,Y){var X=I(F),re=F.read_shift(4);return X[1].v=re>>6,X}function O(F,Y){var X=I(F),re=F.read_shift(8,"f");return X[1].v=re,X}function R(F,Y){var X=O(F);return F.l+=Y-10,X}function C(F,Y){return F[F.l+Y-1]==0?F.read_shift(Y,"cstr"):""}function _(F,Y){var X=F[F.l++];X>Y-1&&(X=Y-1);for(var re="";re.length<X;)re+=String.fromCharCode(F[F.l++]);return re}function k(F,Y,X){if(!(!X.qpro||Y<21)){var re=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var z=F.read_shift(Y-21,"cstr");return[re,z]}}function A(F,Y){for(var X={},re=F.l+Y;F.l<re;){var z=F.read_shift(2);if(z==14e3){for(X[z]=[0,""],X[z][0]=F.read_shift(2);F[F.l];)X[z][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return X}function T(F,Y){var X=ga(5+F.length);X.write_shift(2,14e3),X.write_shift(2,Y);for(var re=0;re<F.length;++re){var z=F.charCodeAt(re);X[X.l++]=z>127?95:z}return X[X.l++]=0,X}var D={0:{n:"BOF",f:oa},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:C},222:{n:"SHEETNAMELP",f:_},65535:{n:""}},B={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:H},24:{n:"NUMBER18",f:U},25:{n:"FORMULA19",f:Z},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:A},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:W},38:{n:"??"},39:{n:"NUMBER27",f:O},40:{n:"FORMULA28",f:R},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:C},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:k},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:r}}();function SM(t){var r={},e=t.match(qa),a=0,n=!1;if(e)for(;a!=e.length;++a){var o=Jt(e[a]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;r.cp=Um[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=o.val;break;case"<sz":r.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":o.rgb&&(r.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(o[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+o[0])}}return r}var kM=function(){var t=Mu("t"),r=Mu("rPr");function e(o){var s=o.match(t);if(!s)return{t:"s",v:""};var l={t:"s",v:br(s[1])},c=o.match(r);return c&&(l.s=SM(c[1])),l}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(s){return s.replace(a,"").split(n).map(e).filter(function(l){return l.v})}}(),EM=function(){var r=/(\r\n|\n)/g;function e(n,o,s){var l=[];n.u&&l.push("text-decoration: underline;"),n.uval&&l.push("text-underline-style:"+n.uval+";"),n.sz&&l.push("font-size:"+n.sz+"pt;"),n.outline&&l.push("text-effect: outline;"),n.shadow&&l.push("text-shadow: auto;"),o.push('<span style="'+l.join("")+'">'),n.b&&(o.push("<b>"),s.push("</b>")),n.i&&(o.push("<i>"),s.push("</i>")),n.strike&&(o.push("<s>"),s.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(o.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),n}function a(n){var o=[[],n.v,[]];return n.v?(n.s&&e(n.s,o[0],o[2]),o[0].join("")+o[1].replace(r,"<br/>")+o[2].join("")):""}return function(o){return o.map(a).join("")}}(),TM=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,AM=/<(?:\w+:)?r>/,CM=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function a1(t,r){var e=r?r.cellHTML:!0,a={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=br(Fr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Fr(t),e&&(a.h=Gm(a.t))):t.match(AM)&&(a.r=Fr(t),a.t=br(Fr((t.replace(CM,"").match(TM)||[]).join("").replace(qa,""))),e&&(a.h=EM(kM(a.r)))),a):{t:""}}var NM=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,jM=/<(?:\w+:)?(?:si|sstItem)>/g,OM=/<\/(?:\w+:)?(?:si|sstItem)>/;function DM(t,r){var e=[],a="";if(!t)return e;var n=t.match(NM);if(n){a=n[2].replace(jM,"").split(OM);for(var o=0;o!=a.length;++o){var s=a1(a[o].trim(),r);s!=null&&(e[e.length]=s)}n=Jt(n[1]),e.Count=n.count,e.Unique=n.uniqueCount}return e}function MM(t){return[t.read_shift(4),t.read_shift(4)]}function RM(t,r){var e=[],a=!1;return ci(t,function(o,s,l){switch(l){case 159:e.Count=o[0],e.Unique=o[1];break;case 19:e.push(o);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(s.T,!a||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),e}function o4(t){for(var r=[],e=t.split(""),a=0;a<e.length;++a)r[a]=e[a].charCodeAt(0);return r}function si(t,r){var e={};return e.Major=t.read_shift(2),e.Minor=t.read_shift(2),r>=4&&(t.l+=r-4),e}function IM(t){var r={};return r.id=t.read_shift(0,"lpp4"),r.R=si(t,4),r.U=si(t,4),r.W=si(t,4),r}function FM(t){for(var r=t.read_shift(4),e=t.l+r-4,a={},n=t.read_shift(4),o=[];n-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(a.name=t.read_shift(0,"lpp4"),a.comps=o,t.l!=e)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+e);return a}function PM(t){var r=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)r.push(FM(t));return r}function LM(t){var r=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)r.push(t.read_shift(0,"lpp4"));return r}function BM(t){var r={};return t.read_shift(4),t.l+=4,r.id=t.read_shift(0,"lpp4"),r.name=t.read_shift(0,"lpp4"),r.R=si(t,4),r.U=si(t,4),r.W=si(t,4),r}function UM(t){var r=BM(t);if(r.ename=t.read_shift(0,"8lpp4"),r.blksz=t.read_shift(4),r.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function l4(t,r){var e=t.l+r,a={};a.Flags=t.read_shift(4)&63,t.l+=4,a.AlgID=t.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=t.read_shift(4),a.KeySize=t.read_shift(4),a.ProviderType=t.read_shift(4),t.l+=8,a.CSPName=t.read_shift(e-t.l>>1,"utf16le"),t.l=e,a}function c4(t,r){var e={},a=t.l+r;return t.l+=4,e.Salt=t.slice(t.l,t.l+16),t.l+=16,e.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),e.VerifierHash=t.slice(t.l,a),t.l=a,e}function zM(t){var r=si(t);switch(r.Minor){case 2:return[r.Minor,$M(t)];case 3:return[r.Minor,VM()];case 4:return[r.Minor,HM(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function $M(t){var r=t.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var e=t.read_shift(4),a=l4(t,e),n=c4(t,t.length-t.l);return{t:"Std",h:a,v:n}}function VM(){throw new Error("File is password-protected: ECMA-376 Extensible")}function HM(t){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var e=t.read_shift(t.length-t.l,"utf8"),a={};return e.replace(qa,function(o){var s=Jt(o);switch(Is(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(l){a[l]=s[l]});break;case"<dataIntegrity":a.encryptedHmacKey=s.encryptedHmacKey,a.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(s);break;default:throw s[0]}}),a}function qM(t,r){var e={},a=e.EncryptionVersionInfo=si(t,4);if(r-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);e.Flags=t.read_shift(4),r-=4;var n=t.read_shift(4);return r-=4,e.EncryptionHeader=l4(t,n),r-=n,e.EncryptionVerifier=c4(t,r),e}function WM(t){var r={},e=r.EncryptionVersionInfo=si(t,4);if(e.Major!=1||e.Minor!=1)throw"unrecognized version code "+e.Major+" : "+e.Minor;return r.Salt=t.read_shift(16),r.EncryptedVerifier=t.read_shift(16),r.EncryptedVerifierHash=t.read_shift(16),r}function GM(t){var r=0,e,a=o4(t),n=a.length+1,o,s,l,c,i;for(e=eo(n),e[0]=a.length,o=1;o!=n;++o)e[o]=a[o-1];for(o=n-1;o>=0;--o)s=e[o],l=(r&16384)===0?0:1,c=r<<1&32767,i=l|c,r=i^s;return r^52811}var u4=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(s){return(s/2|s*128)&255},n=function(s,l){return a(s^l)},o=function(s){for(var l=r[s.length-1],c=104,i=s.length-1;i>=0;--i)for(var u=s[i],p=0;p!=7;++p)u&64&&(l^=e[c]),u*=2,--c;return l};return function(s){for(var l=o4(s),c=o(l),i=l.length,u=eo(16),p=0;p!=16;++p)u[p]=0;var f,h,v;for((i&1)===1&&(f=c>>8,u[i]=n(t[0],f),--i,f=c&255,h=l[l.length-1],u[i]=n(h,f));i>0;)--i,f=c>>8,u[i]=n(l[i],f),--i,f=c&255,u[i]=n(l[i],f);for(i=15,v=15-l.length;v>0;)f=c>>8,u[i]=n(t[v],f),--i,--v,f=c&255,u[i]=n(l[i],f),--i,--v;return u}}(),YM=function(t,r,e,a,n){n||(n=r),a||(a=u4(t));var o,s;for(o=0;o!=r.length;++o)s=r[o],s^=a[e],s=(s>>5|s<<3)&255,n[o]=s,++e;return[n,e,a]},XM=function(t){var r=0,e=u4(t);return function(a){var n=YM("",a,r,e);return r=n[1],n[0]}};function KM(t,r,e,a){var n={key:oa(t),verificationBytes:oa(t)};return e.password&&(n.verifier=GM(e.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=XM(e.password)),n}function ZM(t,r,e){var a=e||{};return a.Info=t.read_shift(2),t.l-=2,a.Info===1?a.Data=WM(t):a.Data=qM(t,r),a}function JM(t,r,e){var a={Type:e.biff>=8?t.read_shift(2):0};return a.Type?ZM(t,r-2,a):KM(t,e.biff>=8?r:r-2,e,a),a}var QM=function(){function t(n,o){switch(o.type){case"base64":return r(Tn(n),o);case"binary":return r(n,o);case"buffer":return r(fr&&Buffer.isBuffer(n)?n.toString("binary"):Vo(n),o);case"array":return r(Uo(n),o)}throw new Error("Unrecognized type "+o.type)}function r(n,o){var s=o||{},l=s.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var i={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,p){Array.isArray(l)&&(l[p]=[]);for(var f=/\\\w+\b/g,h=0,v,b=-1;v=f.exec(u);){switch(v[0]){case"\\cell":var g=u.slice(h,f.lastIndex-v[0].length);if(g[0]==" "&&(g=g.slice(1)),++b,g.length){var x={v:g,t:"s"};Array.isArray(l)?l[p][b]=x:l[Qt({r:p,c:b})]=x}break}h=f.lastIndex}b>i.e.c&&(i.e.c=b)}),l["!ref"]=mr(i),l}function e(n,o){return ao(t(n,o),o)}function a(n){for(var o=["{\\rtf1\\ansi"],s=Yr(n["!ref"]),l,c=Array.isArray(n),i=s.s.r;i<=s.e.r;++i){o.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)o.push("\\cellx"+(u+1));for(o.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var p=Qt({r:i,c:u});l=c?(n[i]||[])[u]:n[p],!(!l||l.v==null&&(!l.f||l.F))&&(o.push(" "+(l.w||(ii(l),l.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:e,to_sheet:t,from_sheet:a}}();function eR(t){var r=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Fu(t){for(var r=0,e=1;r!=3;++r)e=e*256+(t[r]>255?255:t[r]<0?0:t[r]);return e.toString(16).toUpperCase().slice(1)}function tR(t){var r=t[0]/255,e=t[1]/255,a=t[2]/255,n=Math.max(r,e,a),o=Math.min(r,e,a),s=n-o;if(s===0)return[0,0,r];var l=0,c=0,i=n+o;switch(c=s/(i>1?2-i:i),n){case r:l=((e-a)/s+6)%6;break;case e:l=(a-r)/s+2;break;case a:l=(r-e)/s+4;break}return[l/6,c,i/2]}function rR(t){var r=t[0],e=t[1],a=t[2],n=e*2*(a<.5?a:1-a),o=a-n/2,s=[o,o,o],l=6*r,c;if(e!==0)switch(l|0){case 0:case 6:c=n*l,s[0]+=n,s[1]+=c;break;case 1:c=n*(2-l),s[0]+=c,s[1]+=n;break;case 2:c=n*(l-2),s[1]+=n,s[2]+=c;break;case 3:c=n*(4-l),s[1]+=c,s[2]+=n;break;case 4:c=n*(l-4),s[2]+=n,s[0]+=c;break;case 5:c=n*(6-l),s[2]+=c,s[0]+=n;break}for(var i=0;i!=3;++i)s[i]=Math.round(s[i]*255);return s}function If(t,r){if(r===0)return t;var e=tR(eR(t));return r<0?e[2]=e[2]*(1+r):e[2]=1-(1-e[2])*(1-r),Fu(rR(e))}var d4=6,aR=15,nR=1,Ka=d4;function Ff(t){return Math.floor((t+Math.round(128/Ka)/256)*Ka)}function Pf(t){return Math.floor((t-5)/Ka*100+.5)/100}function rm(t){return Math.round((t*Ka+5)/Ka*256)/256}function _p(t){return rm(Pf(Ff(t)))}function n1(t){var r=Math.abs(t-_p(t)),e=Ka;if(r>.005)for(Ka=nR;Ka<aR;++Ka)Math.abs(t-_p(t))<=r&&(r=Math.abs(t-_p(t)),e=Ka);Ka=e}function Jl(t){t.width?(t.wpx=Ff(t.width),t.wch=Pf(t.wpx),t.MDW=Ka):t.wpx?(t.wch=Pf(t.wpx),t.width=rm(t.wch),t.MDW=Ka):typeof t.wch=="number"&&(t.width=rm(t.wch),t.wpx=Ff(t.width),t.MDW=Ka),t.customWidth&&delete t.customWidth}var sR=96,f4=sR;function h4(t){return t*96/f4}function Pu(t){return t*f4/96}var iR={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function oR(t,r,e,a){r.Borders=[];var n={},o=!1;(t[0].match(qa)||[]).forEach(function(s){var l=Jt(s);switch(Is(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},l.diagonalUp&&(n.diagonalUp=Br(l.diagonalUp)),l.diagonalDown&&(n.diagonalDown=Br(l.diagonalDown)),r.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(a&&a.WTF&&!o)throw new Error("unrecognized "+l[0]+" in borders")}})}function lR(t,r,e,a){r.Fills=[];var n={},o=!1;(t[0].match(qa)||[]).forEach(function(s){var l=Jt(s);switch(Is(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},r.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":l.patternType&&(n.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),l.indexed&&(n.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(n.bgColor.theme=parseInt(l.theme,10)),l.tint&&(n.bgColor.tint=parseFloat(l.tint)),l.rgb&&(n.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),l.theme&&(n.fgColor.theme=parseInt(l.theme,10)),l.tint&&(n.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(n.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(a&&a.WTF&&!o)throw new Error("unrecognized "+l[0]+" in fills")}})}function cR(t,r,e,a){r.Fonts=[];var n={},o=!1;(t[0].match(qa)||[]).forEach(function(s){var l=Jt(s);switch(Is(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(n),n={};break;case"<name":l.val&&(n.name=Fr(l.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=l.val?Br(l.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=l.val?Br(l.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(l.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=l.val?Br(l.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=l.val?Br(l.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=l.val?Br(l.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=l.val?Br(l.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=l.val?Br(l.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":l.val&&(n.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(n.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(n.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(n.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Um[parseInt(l.val,10)];break;case"<color":if(n.color||(n.color={}),l.auto&&(n.color.auto=Br(l.auto)),l.rgb)n.color.rgb=l.rgb.slice(-6);else if(l.indexed){n.color.index=parseInt(l.indexed,10);var c=Lo[n.color.index];n.color.index==81&&(c=Lo[1]),c||(c=Lo[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(n.color.theme=parseInt(l.theme,10),l.tint&&(n.color.tint=parseFloat(l.tint)),l.theme&&e.themeElements&&e.themeElements.clrScheme&&(n.color.rgb=If(e.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(a&&a.WTF&&!o)throw new Error("unrecognized "+l[0]+" in fonts")}})}function uR(t,r,e){r.NumberFmt=[];for(var a=Ds(rr),n=0;n<a.length;++n)r.NumberFmt[a[n]]=rr[a[n]];var o=t[0].match(qa);if(o)for(n=0;n<o.length;++n){var s=Jt(o[n]);switch(Is(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=br(Fr(s.formatCode)),c=parseInt(s.numFmtId,10);if(r.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&r.NumberFmt[c]!=null;--c);r.NumberFmt[c]=l}Po(l,c)}}break;case"</numFmt>":break;default:if(e.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var xf=["numFmtId","fillId","fontId","borderId","xfId"],yf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function dR(t,r,e){r.CellXf=[];var a,n=!1;(t[0].match(qa)||[]).forEach(function(o){var s=Jt(o),l=0;switch(Is(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=s,delete a[0],l=0;l<xf.length;++l)a[xf[l]]&&(a[xf[l]]=parseInt(a[xf[l]],10));for(l=0;l<yf.length;++l)a[yf[l]]&&(a[yf[l]]=Br(a[yf[l]]));if(r.NumberFmt&&a.numFmtId>392){for(l=392;l>60;--l)if(r.NumberFmt[a.numFmtId]==r.NumberFmt[l]){a.numFmtId=l;break}}r.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=Br(s.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(e&&e.WTF&&!n)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var fR=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,i){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=l.match(r))&&uR(p,u,i),(p=l.match(n))&&cR(p,u,c,i),(p=l.match(a))&&lR(p,u,c,i),(p=l.match(o))&&oR(p,u,c,i),(p=l.match(e))&&dR(p,u,i),u}}();function hR(t,r){var e=t.read_shift(2),a=Va(t);return[e,a]}function pR(t,r,e){var a={};a.sz=t.read_shift(2)/20;var n=kO(t);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var o=t.read_shift(2);switch(o===700&&(a.bold=1),t.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var s=t.read_shift(1);s!=0&&(a.underline=s);var l=t.read_shift(1);l>0&&(a.family=l);var c=t.read_shift(1);switch(c>0&&(a.charset=c),t.l++,a.color=SO(t),t.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Va(t),a}var mR=Ha;function gR(t,r){var e=t.l+r,a=t.read_shift(2),n=t.read_shift(2);return t.l=e,{ixfe:a,numFmtId:n}}var vR=Ha;function bR(t,r,e){var a={};a.NumberFmt=[];for(var n in rr)a.NumberFmt[n]=rr[n];a.CellXf=[],a.Fonts=[];var o=[],s=!1;return ci(t,function(c,i,u){switch(u){case 44:a.NumberFmt[c[0]]=c[1],Po(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(c.color.rgb=If(r.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:o.push(u),s=!0;break;case 38:o.pop(),s=!1;break;default:if(i.T>0)o.push(u);else if(i.T<0)o.pop();else if(!s||e.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}var xR=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function yR(t,r,e){r.themeElements.clrScheme=[];var a={};(t[0].match(qa)||[]).forEach(function(n){var o=Jt(n);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=o.val;break;case"<a:sysClr":a.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(r.themeElements.clrScheme[xR.indexOf(o[0])]=a,a={}):a.name=o[0].slice(3,o[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function wR(){}function _R(){}var SR=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,kR=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,ER=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function TR(t,r,e){r.themeElements={};var a;[["clrScheme",SR,yR],["fontScheme",kR,wR],["fmtScheme",ER,_R]].forEach(function(n){if(!(a=t.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,r,e)})}var AR=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function p4(t,r){(!t||t.length===0)&&(t=CR());var e,a={};if(!(e=t.match(AR)))throw new Error("themeElements not found in theme");return TR(e[0],a,r),a.raw=t,a}function CR(t,r){var e=[E_];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function NR(t,r,e){var a=t.l+r,n=t.read_shift(4);if(n!==124226){if(!e.cellStyles){t.l=a;return}var o=t.slice(t.l);t.l=a;var s;try{s=k_(o,{type:"array"})}catch{return}var l=kn(s,"theme/theme/theme1.xml",!0);if(l)return p4(l,e)}}function jR(t){return t.read_shift(4)}function OR(t){var r={};switch(r.xclrType=t.read_shift(2),r.nTintShade=t.read_shift(2),r.xclrType){case 0:t.l+=4;break;case 1:r.xclrValue=DR(t,4);break;case 2:r.xclrValue=e4(t);break;case 3:r.xclrValue=jR(t);break;case 4:t.l+=4;break}return t.l+=8,r}function DR(t,r){return Ha(t,r)}function MR(t,r){return Ha(t,r)}function RR(t){var r=t.read_shift(2),e=t.read_shift(2)-4,a=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=OR(t);break;case 6:a[1]=MR(t,e);break;case 14:case 15:a[1]=t.read_shift(e===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+e)}return a}function IR(t,r){var e=t.l+r;t.l+=2;var a=t.read_shift(2);t.l+=2;for(var n=t.read_shift(2),o=[];n-- >0;)o.push(RR(t,e-t.l));return{ixfe:a,ext:o}}function FR(t,r){r.forEach(function(e){e[0]})}function PR(t,r){return{flags:t.read_shift(4),version:t.read_shift(4),name:Va(t)}}function LR(t){for(var r=[],e=t.read_shift(4);e-- >0;)r.push([t.read_shift(4),t.read_shift(4)]);return r}function BR(t){return t.l+=4,t.read_shift(4)!=0}function UR(t,r,e){var a={Types:[],Cell:[],Value:[]},n=e||{},o=[],s=!1,l=2;return ci(t,function(c,i,u){switch(u){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(p){l==1?a.Cell.push({type:a.Types[p[0]-1].name,index:p[1]}):l==0&&a.Value.push({type:a.Types[p[0]-1].name,index:p[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:o.push(u),s=!0;break;case 36:o.pop(),s=!1;break;default:if(!i.T){if(!s||n.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),a}function zR(t,r,e){var a={Types:[],Cell:[],Value:[]};if(!t)return a;var n=!1,o=2,s;return t.replace(qa,function(l){var c=Jt(l);switch(Is(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var i=0;i<a.Types.length;++i)a.Types[i].name==c.name&&(s=a.Types[i]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):o==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),a}function $R(t){var r=[];if(!t)return r;var e=1;return(t.match(qa)||[]).forEach(function(a){var n=Jt(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?e=n.i:n.i=e,r.push(n);break}}),r}function VR(t){var r={};r.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),r.r=Qt(e);var a=t.read_shift(1);return a&2&&(r.l="1"),a&8&&(r.a="1"),r}function HR(t,r,e){var a=[];return ci(t,function(o,s,l){switch(l){case 63:a.push(o);break;default:if(!s.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),a}function qR(t,r,e,a){if(!t)return t;var n=a||{},o=!1;ci(t,function(l,c,i){switch(i){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!c.T){if(!o||n.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}}},n)}function WR(t,r){if(!t)return"??";var e=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][e].Target}function Oy(t,r,e,a){var n=Array.isArray(t),o;r.forEach(function(s){var l=Ja(s.ref);if(n?(t[l.r]||(t[l.r]=[]),o=t[l.r][l.c]):o=t[s.ref],!o){o={t:"z"},n?t[l.r][l.c]=o:t[s.ref]=o;var c=Yr(t["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var i=mr(c);i!==t["!ref"]&&(t["!ref"]=i)}o.c||(o.c=[]);var u={a:s.author,t:s.t,r:s.r,T:e};s.h&&(u.h=s.h);for(var p=o.c.length-1;p>=0;--p){if(!e&&o.c[p].T)return;e&&!o.c[p].T&&o.c.splice(p,1)}if(e&&a){for(p=0;p<a.length;++p)if(u.a==a[p].id){u.a=a[p].name||u.a;break}}o.c.push(u)})}function GR(t,r){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],a=[],n=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var l=s.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&e.push(l[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var l=s.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Jt(l[0]),i={author:c.authorId&&e[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=Ja(c.ref);if(!(r.sheetRows&&r.sheetRows<=u.r)){var p=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!p&&!!p[1]&&a1(p[1])||{r:"",t:"",h:""};i.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),i.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(i.h=f.h),a.push(i)}}}}),a}function YR(t,r){var e=[],a=!1,n={},o=0;return t.replace(qa,function(l,c){var i=Jt(l);switch(Is(i[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:i.personId,guid:i.id,ref:i.ref,T:1};break;case"</threadedComment>":n.t!=null&&e.push(n);break;case"<text>":case"<text":o=c+l.length;break;case"</text>":n.t=t.slice(o,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return l}),e}function XR(t,r){var e=[],a=!1;return t.replace(qa,function(o){var s=Jt(o);switch(Is(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":e.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return o}),e}function KR(t){var r={};r.iauthor=t.read_shift(4);var e=qo(t);return r.rfx=e.s,r.ref=Qt(e.s),t.l+=16,r}var ZR=Va;function JR(t,r){var e=[],a=[],n={},o=!1;return ci(t,function(l,c,i){switch(i){case 632:a.push(l);break;case 635:n=l;break;case 637:n.t=l.t,n.h=l.h,n.r=l.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,r.sheetRows&&n.rfx&&r.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,e.push(n);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!o||r.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}}}),e}var QR="application/vnd.ms-office.vbaProject";function eI(t){var r=pr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(e,a){if(!(e.slice(-1)==="/"||!e.match(/_VBA_PROJECT_CUR/))){var n=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");pr.utils.cfb_add(r,n,t.FileIndex[a].content)}}),pr.write(r)}function tI(){return{"!type":"dialog"}}function rI(){return{"!type":"dialog"}}function aI(){return{"!type":"macro"}}function nI(){return{"!type":"macro"}}var Gl=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function e(a,n,o,s){var l=!1,c=!1;o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1)),s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1));var i=o.length>0?parseInt(o,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return l?u+=r.c:--u,c?i+=r.r:--i,n+(l?"":"$")+va(u)+(c?"":"$")+Ma(i)}return function(n,o){return r=o,n.replace(t,e)}}(),m4=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,sI=function(){return function(r,e){return r.replace(m4,function(a,n,o,s,l,c){var i=Zm(s)-(o?0:e.c),u=Km(c)-(l?0:e.r),p=u==0?"":l?u+1:"["+u+"]",f=i==0?"":o?i+1:"["+i+"]";return n+"R"+p+"C"+f})}}();function g4(t,r){return t.replace(m4,function(e,a,n,o,s,l){return a+(n=="$"?n+o:va(Zm(o)+r.c))+(s=="$"?s+l:Ma(Km(l)+r.r))})}function iI(t,r,e){var a=ac(r),n=a.s,o=Ja(e),s={r:o.r-n.r,c:o.c-n.c};return g4(t,s)}function oI(t){return t.length!=1}function Dy(t){return t.replace(/_xlfn\./g,"")}function sa(t){t.l+=1}function to(t,r){var e=t.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function v4(t,r,e){var a=2;if(e){if(e.biff>=2&&e.biff<=5)return b4(t);e.biff==12&&(a=4)}var n=t.read_shift(a),o=t.read_shift(a),s=to(t),l=to(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:o,c:l[0],cRel:l[1],rRel:l[2]}}}function b4(t){var r=to(t),e=to(t),a=t.read_shift(1),n=t.read_shift(1);return{s:{r:r[0],c:a,cRel:r[1],rRel:r[2]},e:{r:e[0],c:n,cRel:e[1],rRel:e[2]}}}function lI(t,r,e){if(e.biff<8)return b4(t);var a=t.read_shift(e.biff==12?4:2),n=t.read_shift(e.biff==12?4:2),o=to(t),s=to(t);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:n,c:s[0],cRel:s[1],rRel:s[2]}}}function x4(t,r,e){if(e&&e.biff>=2&&e.biff<=5)return cI(t);var a=t.read_shift(e&&e.biff==12?4:2),n=to(t);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function cI(t){var r=to(t),e=t.read_shift(1);return{r:r[0],c:e,cRel:r[1],rRel:r[2]}}function uI(t){var r=t.read_shift(2),e=t.read_shift(2);return{r,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function dI(t,r,e){var a=e&&e.biff?e.biff:8;if(a>=2&&a<=5)return fI(t);var n=t.read_shift(a>=12?4:2),o=t.read_shift(2),s=(o&16384)>>14,l=(o&32768)>>15;if(o&=16383,l==1)for(;n>524287;)n-=1048576;if(s==1)for(;o>8191;)o=o-16384;return{r:n,c:o,cRel:s,rRel:l}}function fI(t){var r=t.read_shift(2),e=t.read_shift(1),a=(r&32768)>>15,n=(r&16384)>>14;return r&=16383,a==1&&r>=8192&&(r=r-16384),n==1&&e>=128&&(e=e-256),{r,c:e,cRel:n,rRel:a}}function hI(t,r,e){var a=(t[t.l++]&96)>>5,n=v4(t,e.biff>=2&&e.biff<=5?6:8,e);return[a,n]}function pI(t,r,e){var a=(t[t.l++]&96)>>5,n=t.read_shift(2,"i"),o=8;if(e)switch(e.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var s=v4(t,o,e);return[a,n,s]}function mI(t,r,e){var a=(t[t.l++]&96)>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[a]}function gI(t,r,e){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),o=8;if(e)switch(e.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[a,n]}function vI(t,r,e){var a=(t[t.l++]&96)>>5,n=lI(t,r-1,e);return[a,n]}function bI(t,r,e){var a=(t[t.l++]&96)>>5;return t.l+=e.biff==2?6:e.biff==12?14:7,[a]}function My(t){var r=t[t.l+1]&1,e=1;return t.l+=4,[r,e]}function xI(t,r,e){t.l+=2;for(var a=t.read_shift(e&&e.biff==2?1:2),n=[],o=0;o<=a;++o)n.push(t.read_shift(e&&e.biff==2?1:2));return n}function yI(t,r,e){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(e&&e.biff==2?1:2)]}function wI(t,r,e){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(e&&e.biff==2?1:2)]}function _I(t){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(2)]}function SI(t,r,e){var a=t[t.l+1]&255?1:0;return t.l+=e&&e.biff==2?3:4,[a]}function y4(t){var r=t.read_shift(1),e=t.read_shift(1);return[r,e]}function kI(t){return t.read_shift(2),y4(t)}function EI(t){return t.read_shift(2),y4(t)}function TI(t,r,e){var a=(t[t.l]&96)>>5;t.l+=1;var n=x4(t,0,e);return[a,n]}function AI(t,r,e){var a=(t[t.l]&96)>>5;t.l+=1;var n=dI(t,0,e);return[a,n]}function CI(t,r,e){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(2);e&&e.biff==5&&(t.l+=12);var o=x4(t,0,e);return[a,n,o]}function NI(t,r,e){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(e&&e.biff<=3?1:2);return[jF[n],S4[n],a]}function jI(t,r,e){var a=t[t.l++],n=t.read_shift(1),o=e&&e.biff<=3?[a==88?-1:0,t.read_shift(1)]:OI(t);return[n,(o[0]===0?S4:NF)[o[1]]]}function OI(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function DI(t,r,e){t.l+=e&&e.biff==2?3:4}function MI(t,r,e){if(t.l++,e&&e.biff==12)return[t.read_shift(4,"i"),0];var a=t.read_shift(2),n=t.read_shift(e&&e.biff==2?1:2);return[a,n]}function RI(t){return t.l++,Wo[t.read_shift(1)]}function II(t){return t.l++,t.read_shift(2)}function FI(t){return t.l++,t.read_shift(1)!==0}function PI(t){return t.l++,za(t)}function LI(t,r,e){return t.l++,Yu(t,r-1,e)}function BI(t,r){var e=[t.read_shift(1)];if(r==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=Zr(t,1)?"TRUE":"FALSE",r!=12&&(t.l+=7);break;case 37:case 16:e[1]=Wo[t[t.l]],t.l+=r==12?4:8;break;case 0:t.l+=8;break;case 1:e[1]=za(t);break;case 2:e[1]=Go(t,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function UI(t,r,e){for(var a=t.read_shift(e.biff==12?4:2),n=[],o=0;o!=a;++o)n.push((e.biff==12?qo:Zf)(t));return n}function zI(t,r,e){var a=0,n=0;e.biff==12?(a=t.read_shift(4),n=t.read_shift(4)):(n=1+t.read_shift(1),a=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--a,--n==0&&(n=256));for(var o=0,s=[];o!=a&&(s[o]=[]);++o)for(var l=0;l!=n;++l)s[o][l]=BI(t,e.biff);return s}function $I(t,r,e){var a=t.read_shift(1)>>>5&3,n=!e||e.biff>=8?4:2,o=t.read_shift(n);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[a,0,o]}function VI(t,r,e){if(e.biff==5)return HI(t);var a=t.read_shift(1)>>>5&3,n=t.read_shift(2),o=t.read_shift(4);return[a,n,o]}function HI(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var a=t.read_shift(2);return t.l+=12,[r,e,a]}function qI(t,r,e){var a=t.read_shift(1)>>>5&3;t.l+=e&&e.biff==2?3:4;var n=t.read_shift(e&&e.biff==2?1:2);return[a,n]}function WI(t,r,e){var a=t.read_shift(1)>>>5&3,n=t.read_shift(e&&e.biff==2?1:2);return[a,n]}function GI(t,r,e){var a=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,e.biff==12&&(t.l+=2),[a]}function YI(t,r,e){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),o=4;if(e)switch(e.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[a,n]}var XI=Ha,KI=Ha,ZI=Ha;function Ku(t,r,e){return t.l+=2,[uI(t)]}function s1(t){return t.l+=6,[]}var JI=Ku,QI=s1,eF=s1,tF=Ku;function w4(t){return t.l+=2,[oa(t),t.read_shift(2)&1]}var rF=Ku,aF=w4,nF=s1,sF=Ku,iF=Ku,oF=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function lF(t){t.l+=2;var r=t.read_shift(2),e=t.read_shift(2),a=t.read_shift(4),n=t.read_shift(2),o=t.read_shift(2),s=oF[e>>2&31];return{ixti:r,coltype:e&3,rt:s,idx:a,c:n,C:o}}function cF(t){return t.l+=2,[t.read_shift(4)]}function uF(t,r,e){return t.l+=5,t.l+=2,t.l+=e.biff==2?1:4,["PTGSHEET"]}function dF(t,r,e){return t.l+=e.biff==2?4:5,["PTGENDSHEET"]}function fF(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function hF(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function pF(t){return t.l+=4,[0,0]}var Ry={1:{n:"PtgExp",f:MI},2:{n:"PtgTbl",f:ZI},3:{n:"PtgAdd",f:sa},4:{n:"PtgSub",f:sa},5:{n:"PtgMul",f:sa},6:{n:"PtgDiv",f:sa},7:{n:"PtgPower",f:sa},8:{n:"PtgConcat",f:sa},9:{n:"PtgLt",f:sa},10:{n:"PtgLe",f:sa},11:{n:"PtgEq",f:sa},12:{n:"PtgGe",f:sa},13:{n:"PtgGt",f:sa},14:{n:"PtgNe",f:sa},15:{n:"PtgIsect",f:sa},16:{n:"PtgUnion",f:sa},17:{n:"PtgRange",f:sa},18:{n:"PtgUplus",f:sa},19:{n:"PtgUminus",f:sa},20:{n:"PtgPercent",f:sa},21:{n:"PtgParen",f:sa},22:{n:"PtgMissArg",f:sa},23:{n:"PtgStr",f:LI},26:{n:"PtgSheet",f:uF},27:{n:"PtgEndSheet",f:dF},28:{n:"PtgErr",f:RI},29:{n:"PtgBool",f:FI},30:{n:"PtgInt",f:II},31:{n:"PtgNum",f:PI},32:{n:"PtgArray",f:bI},33:{n:"PtgFunc",f:NI},34:{n:"PtgFuncVar",f:jI},35:{n:"PtgName",f:$I},36:{n:"PtgRef",f:TI},37:{n:"PtgArea",f:hI},38:{n:"PtgMemArea",f:qI},39:{n:"PtgMemErr",f:XI},40:{n:"PtgMemNoMem",f:KI},41:{n:"PtgMemFunc",f:WI},42:{n:"PtgRefErr",f:GI},43:{n:"PtgAreaErr",f:mI},44:{n:"PtgRefN",f:AI},45:{n:"PtgAreaN",f:vI},46:{n:"PtgMemAreaN",f:fF},47:{n:"PtgMemNoMemN",f:hF},57:{n:"PtgNameX",f:VI},58:{n:"PtgRef3d",f:CI},59:{n:"PtgArea3d",f:pI},60:{n:"PtgRefErr3d",f:YI},61:{n:"PtgAreaErr3d",f:gI},255:{}},mF={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},gF={1:{n:"PtgElfLel",f:w4},2:{n:"PtgElfRw",f:sF},3:{n:"PtgElfCol",f:JI},6:{n:"PtgElfRwV",f:iF},7:{n:"PtgElfColV",f:tF},10:{n:"PtgElfRadical",f:rF},11:{n:"PtgElfRadicalS",f:nF},13:{n:"PtgElfColS",f:QI},15:{n:"PtgElfColSV",f:eF},16:{n:"PtgElfRadicalLel",f:aF},25:{n:"PtgList",f:lF},29:{n:"PtgSxName",f:cF},255:{}},vF={0:{n:"PtgAttrNoop",f:pF},1:{n:"PtgAttrSemi",f:SI},2:{n:"PtgAttrIf",f:wI},4:{n:"PtgAttrChoose",f:xI},8:{n:"PtgAttrGoto",f:yI},16:{n:"PtgAttrSum",f:DI},32:{n:"PtgAttrBaxcel",f:My},33:{n:"PtgAttrBaxcel",f:My},64:{n:"PtgAttrSpace",f:kI},65:{n:"PtgAttrSpaceSemi",f:EI},128:{n:"PtgAttrIfError",f:_I},255:{}};function Zu(t,r,e,a){if(a.biff<8)return Ha(t,r);for(var n=t.l+r,o=[],s=0;s!==e.length;++s)switch(e[s][0]){case"PtgArray":e[s][1]=zI(t,0,a),o.push(e[s][1]);break;case"PtgMemArea":e[s][2]=UI(t,e[s][1],a),o.push(e[s][2]);break;case"PtgExp":a&&a.biff==12&&(e[s][1][1]=t.read_shift(4),o.push(e[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[s][0]}return r=n-t.l,r!==0&&o.push(Ha(t,r)),o}function Ju(t,r,e){for(var a=t.l+r,n,o,s=[];a!=t.l;)r=a-t.l,o=t[t.l],n=Ry[o]||Ry[mF[o]],(o===24||o===25)&&(n=(o===24?gF:vF)[t[t.l+1]]),!n||!n.f?Ha(t,r):s.push([n.n,n.f(t,r,e)]);return s}function bF(t){for(var r=[],e=0;e<t.length;++e){for(var a=t[e],n=[],o=0;o<a.length;++o){var s=a[o];if(s)switch(s[0]){case 2:n.push('"'+s[1].replace(/"/g,'""')+'"');break;default:n.push(s[1])}else n.push("")}r.push(n.join(","))}return r.join(";")}var xF={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function yF(t,r){if(!t&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function _4(t,r,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[r]))return t.SheetNames[r];if(!t.XTI)return"SH33TJSERR6";var a=t.XTI[r];if(e.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":t.XTI[r-1];if(!a)return"SH33TJSERR1";var n="";if(e.biff>8)switch(t[a[0]][0]){case 357:return n=a[1]==-1?"#REF":t.SheetNames[a[1]],a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 358:return e.SID!=null?t.SheetNames[e.SID]:"SH33TJSSAME"+t[a[0]][0];case 355:default:return"SH33TJSSRC"+t[a[0]][0]}switch(t[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":t.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 14849:return t[a[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[a[0]][0][3]?(n=a[1]==-1?"#REF":t[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+t[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Iy(t,r,e){var a=_4(t,r,e);return a=="#REF"?a:yF(a,e)}function La(t,r,e,a,n){var o=n&&n.biff||8,s={s:{c:0,r:0}},l=[],c,i,u,p=0,f=0,h,v="";if(!t[0]||!t[0][0])return"";for(var b=-1,g="",x=0,y=t[0].length;x<y;++x){var E=t[0][x];switch(E[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),i=l.pop(),b>=0){switch(t[0][b][1][0]){case 0:g=Gr(" ",t[0][b][1][1]);break;case 1:g=Gr("\r",t[0][b][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][b][1][0])}i=i+g,b=-1}l.push(i+xF[E[0]]+c);break;case"PtgIsect":c=l.pop(),i=l.pop(),l.push(i+" "+c);break;case"PtgUnion":c=l.pop(),i=l.pop(),l.push(i+","+c);break;case"PtgRange":c=l.pop(),i=l.pop(),l.push(i+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=du(E[1][1],s,n),l.push(fu(u,o));break;case"PtgRefN":u=e?du(E[1][1],e,n):E[1][1],l.push(fu(u,o));break;case"PtgRef3d":p=E[1][1],u=du(E[1][2],s,n),v=Iy(a,p,n),l.push(v+"!"+fu(u,o));break;case"PtgFunc":case"PtgFuncVar":var N=E[1][0],I=E[1][1];N||(N=0),N&=127;var P=N==0?[]:l.slice(-N);l.length-=N,I==="User"&&(I=P.shift()),l.push(I+"("+P.join(",")+")");break;case"PtgBool":l.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(E[1]);break;case"PtgNum":l.push(String(E[1]));break;case"PtgStr":l.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(E[1]);break;case"PtgAreaN":h=my(E[1][1],e?{s:e}:s,n),l.push(yp(h,n));break;case"PtgArea":h=my(E[1][1],s,n),l.push(yp(h,n));break;case"PtgArea3d":p=E[1][1],h=E[1][2],v=Iy(a,p,n),l.push(v+"!"+yp(h,n));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=E[1][2];var V=(a.names||[])[f-1]||(a[0]||[])[f],U=V?V.Name:"SH33TJSNAME"+String(f);U&&U.slice(0,6)=="_xlfn."&&!n.xlfn&&(U=U.slice(6)),l.push(U);break;case"PtgNameX":var H=E[1][1];f=E[1][2];var G;if(n.biff<=5)H<0&&(H=-H),a[H]&&(G=a[H][f]);else{var Z="";if(((a[H]||[])[0]||[])[0]==14849||(((a[H]||[])[0]||[])[0]==1025?a[H][f]&&a[H][f].itab>0&&(Z=a.SheetNames[a[H][f].itab-1]+"!"):Z=a.SheetNames[f-1]+"!"),a[H]&&a[H][f])Z+=a[H][f].Name;else if(a[0]&&a[0][f])Z+=a[0][f].Name;else{var W=(_4(a,H,n)||"").split(";;");W[f-1]?Z=W[f-1]:Z+="SH33TJSERRX"}l.push(Z);break}G||(G={Name:"SH33TJSERRY"}),l.push(G.Name);break;case"PtgParen":var O="(",R=")";if(b>=0){switch(g="",t[0][b][1][0]){case 2:O=Gr(" ",t[0][b][1][1])+O;break;case 3:O=Gr("\r",t[0][b][1][1])+O;break;case 4:R=Gr(" ",t[0][b][1][1])+R;break;case 5:R=Gr("\r",t[0][b][1][1])+R;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][b][1][0])}b=-1}l.push(O+l.pop()+R);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:E[1][1],r:E[1][0]};var C={c:e.c,r:e.r};if(a.sharedf[Qt(u)]){var _=a.sharedf[Qt(u)];l.push(La(_,s,C,a,n))}else{var k=!1;for(c=0;c!=a.arrayf.length;++c)if(i=a.arrayf[c],!(u.c<i[0].s.c||u.c>i[0].e.c)&&!(u.r<i[0].s.r||u.r>i[0].e.r)){l.push(La(i[1],s,C,a,n)),k=!0;break}k||l.push(E[1])}break;case"PtgArray":l.push("{"+bF(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var A=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&b>=0&&A.indexOf(t[0][x][0])==-1){E=t[0][b];var T=!0;switch(E[1][0]){case 4:T=!1;case 0:g=Gr(" ",E[1][1]);break;case 5:T=!1;case 1:g=Gr("\r",E[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}l.push((T?g:"")+l.pop()+(T?"":g)),b=-1}}if(l.length>1&&n.WTF)throw new Error("bad formula stack");return l[0]}function wF(t,r,e){var a=t.l+r,n=e.biff==2?1:2,o,s=t.read_shift(n);if(s==65535)return[[],Ha(t,r-2)];var l=Ju(t,s,e);return r!==s+n&&(o=Zu(t,r-s-n,l,e)),t.l=a,[l,o]}function _F(t,r,e){var a=t.l+r,n=e.biff==2?1:2,o,s=t.read_shift(n);if(s==65535)return[[],Ha(t,r-2)];var l=Ju(t,s,e);return r!==s+n&&(o=Zu(t,r-s-n,l,e)),t.l=a,[l,o]}function SF(t,r,e,a){var n=t.l+r,o=Ju(t,a,e),s;return n!==t.l&&(s=Zu(t,n-t.l,o,e)),[o,s]}function kF(t,r,e){var a=t.l+r,n,o=t.read_shift(2),s=Ju(t,o,e);return o==65535?[[],Ha(t,r-2)]:(r!==o+2&&(n=Zu(t,a-o-2,s,e)),[s,n])}function EF(t){var r;if(ai(t,t.l+6)!==65535)return[za(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return r=t[t.l+2]===1,t.l+=8,[r,"b"];case 2:return r=t[t.l+2],t.l+=8,[r,"e"];case 3:return t.l+=8,["","s"]}return[]}function Sp(t,r,e){var a=t.l+r,n=Fs(t);e.biff==2&&++t.l;var o=EF(t),s=t.read_shift(1);e.biff!=2&&(t.read_shift(1),e.biff>=5&&t.read_shift(4));var l=_F(t,a-t.l,e);return{cell:n,val:o[0],formula:l,shared:s>>3&1,tt:o[1]}}function Jf(t,r,e){var a=t.read_shift(4),n=Ju(t,a,e),o=t.read_shift(4),s=o>0?Zu(t,o,n,e):null;return[n,s]}var TF=Jf,Qf=Jf,AF=Jf,CF=Jf,NF={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},S4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},jF={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Fy(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,e){return e.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function kp(t){var r=t.split(":"),e=r[0].split(".")[0];return[e,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var gu={},Yl={};function vu(t,r){if(t){var e=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(e=[1,1,1,1,.5,.5]),t.left==null&&(t.left=e[0]),t.right==null&&(t.right=e[1]),t.top==null&&(t.top=e[2]),t.bottom==null&&(t.bottom=e[3]),t.header==null&&(t.header=e[4]),t.footer==null&&(t.footer=e[5])}}function k4(t,r,e,a,n,o){try{a.cellNF&&(t.z=rr[r])}catch(l){if(a.WTF)throw l}if(!(t.t==="z"&&!a.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Sa(t.v)),(!a||a.cellText!==!1)&&t.t!=="z")try{if(rr[r]==null&&Po(Oj[r]||"General",r),t.t==="e")t.w=t.w||Wo[t.v];else if(r===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Du(t.v);else if(t.t==="d"){var s=en(t.v);(s|0)===s?t.w=s.toString(10):t.w=Du(s)}else{if(t.v===void 0)return"";t.w=Bo(t.v,Yl)}else t.t==="d"?t.w=Hn(r,en(t.v),Yl):t.w=Hn(r,t.v,Yl)}catch(l){if(a.WTF)throw l}if(a.cellStyles&&e!=null)try{t.s=o.Fills[e],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=If(n.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),a.WTF&&(t.s.fgColor.raw_rgb=n.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=If(n.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),a.WTF&&(t.s.bgColor.raw_rgb=n.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(a.WTF&&o.Fills)throw l}}}function OF(t,r){var e=Yr(r);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(t["!ref"]=mr(e))}var DF=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,MF=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,RF=/<(?:\w:)?hyperlink [^>]*>/mg,IF=/"(\w*:\w*)"/,FF=/<(?:\w:)?col\b[^>]*[\/]?>/g,PF=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,LF=/<(?:\w:)?pageMargins[^>]*\/>/g,E4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,BF=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,UF=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function zF(t,r,e,a,n,o,s){if(!t)return t;a||(a={"!id":{}});var l=r.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},i="",u="",p=t.match(MF);p?(i=t.slice(0,p.index),u=t.slice(p.index+p[0].length)):i=u=t;var f=i.match(E4);f?i1(f[0],l,n,e):(f=i.match(BF))&&$F(f[0],f[1]||"",l,n,e);var h=(i.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var v=i.slice(h,h+50).match(IF);v&&OF(l,v[1])}var b=i.match(UF);b&&b[1]&&YF(b[1],n);var g=[];if(r.cellStyles){var x=i.match(FF);x&&qF(g,x)}p&&XF(p[1],l,r,c,o,s);var y=u.match(PF);y&&(l["!autofilter"]=WF(y[0]));var E=[],N=u.match(DF);if(N)for(h=0;h!=N.length;++h)E[h]=Yr(N[h].slice(N[h].indexOf('"')+1));var I=u.match(RF);I&&VF(l,I,a);var P=u.match(LF);if(P&&(l["!margins"]=HF(Jt(P[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=mr(c)),r.sheetRows>0&&l["!ref"]){var V=Yr(l["!ref"]);r.sheetRows<=+V.e.r&&(V.e.r=r.sheetRows-1,V.e.r>c.e.r&&(V.e.r=c.e.r),V.e.r<V.s.r&&(V.s.r=V.e.r),V.e.c>c.e.c&&(V.e.c=c.e.c),V.e.c<V.s.c&&(V.s.c=V.e.c),l["!fullref"]=l["!ref"],l["!ref"]=mr(V))}return g.length>0&&(l["!cols"]=g),E.length>0&&(l["!merges"]=E),l}function i1(t,r,e,a){var n=Jt(t);e.Sheets[a]||(e.Sheets[a]={}),n.codeName&&(e.Sheets[a].CodeName=br(Fr(n.codeName)))}function $F(t,r,e,a,n){i1(t.slice(0,t.indexOf(">")),e,a,n)}function VF(t,r,e){for(var a=Array.isArray(t),n=0;n!=r.length;++n){var o=Jt(Fr(r[n]),!0);if(!o.ref)return;var s=((e||{})["!id"]||[])[o.id];s?(o.Target=s.Target,o.location&&(o.Target+="#"+br(o.location))):(o.Target="#"+br(o.location),s={Target:o.Target,TargetMode:"Internal"}),o.Rel=s,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var l=Yr(o.ref),c=l.s.r;c<=l.e.r;++c)for(var i=l.s.c;i<=l.e.c;++i){var u=Qt({c:i,r:c});a?(t[c]||(t[c]=[]),t[c][i]||(t[c][i]={t:"z",v:void 0}),t[c][i].l=o):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=o)}}}function HF(t){var r={};return["left","right","top","bottom","header","footer"].forEach(function(e){t[e]&&(r[e]=parseFloat(t[e]))}),r}function qF(t,r){for(var e=!1,a=0;a!=r.length;++a){var n=Jt(r[a],!0);n.hidden&&(n.hidden=Br(n.hidden));var o=parseInt(n.min,10)-1,s=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!e&&n.width&&(e=!0,n1(n.width)),Jl(n);o<=s;)t[o++]=Da(n)}}function WF(t){var r={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return r}var GF=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function YF(t,r){r.Views||(r.Views=[{}]),(t.match(GF)||[]).forEach(function(e,a){var n=Jt(e);r.Views[a]||(r.Views[a]={}),+n.zoomScale&&(r.Views[a].zoom=+n.zoomScale),Br(n.rightToLeft)&&(r.Views[a].RTL=!0)})}var XF=function(){var t=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,o=Mu("v"),s=Mu("f");return function(c,i,u,p,f,h){for(var v=0,b="",g=[],x=[],y=0,E=0,N=0,I="",P,V,U=0,H=0,G,Z,W=0,O=0,R=Array.isArray(h.CellXf),C,_=[],k=[],A=Array.isArray(i),T=[],D={},B=!1,F=!!u.sheetStubs,Y=c.split(r),X=0,re=Y.length;X!=re;++X){b=Y[X].trim();var z=b.length;if(z!==0){var ee=0;e:for(v=0;v<z;++v)switch(b[v]){case">":if(b[v-1]!="/"){++v;break e}if(u&&u.cellStyles){if(V=Jt(b.slice(ee,v),!0),U=V.r!=null?parseInt(V.r,10):U+1,H=-1,u.sheetRows&&u.sheetRows<U)continue;D={},B=!1,V.ht&&(B=!0,D.hpt=parseFloat(V.ht),D.hpx=Pu(D.hpt)),V.hidden=="1"&&(B=!0,D.hidden=!0),V.outlineLevel!=null&&(B=!0,D.level=+V.outlineLevel),B&&(T[U-1]=D)}break;case"<":ee=v;break}if(ee>=v)break;if(V=Jt(b.slice(ee,v),!0),U=V.r!=null?parseInt(V.r,10):U+1,H=-1,!(u.sheetRows&&u.sheetRows<U)){p.s.r>U-1&&(p.s.r=U-1),p.e.r<U-1&&(p.e.r=U-1),u&&u.cellStyles&&(D={},B=!1,V.ht&&(B=!0,D.hpt=parseFloat(V.ht),D.hpx=Pu(D.hpt)),V.hidden=="1"&&(B=!0,D.hidden=!0),V.outlineLevel!=null&&(B=!0,D.level=+V.outlineLevel),B&&(T[U-1]=D)),g=b.slice(v).split(t);for(var L=0;L!=g.length&&g[L].trim().charAt(0)=="<";++L);for(g=g.slice(L),v=0;v!=g.length;++v)if(b=g[v].trim(),b.length!==0){if(x=b.match(e),y=v,E=0,N=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,x!=null&&x.length===2){for(y=0,I=x[1],E=0;E!=I.length&&!((N=I.charCodeAt(E)-64)<1||N>26);++E)y=26*y+N;--y,H=y}else++H;for(E=0;E!=b.length&&b.charCodeAt(E)!==62;++E);if(++E,V=Jt(b.slice(0,E),!0),V.r||(V.r=Qt({r:U-1,c:H})),I=b.slice(E),P={t:""},(x=I.match(o))!=null&&x[1]!==""&&(P.v=br(x[1])),u.cellFormula){if((x=I.match(s))!=null&&x[1]!==""){if(P.f=br(Fr(x[1])).replace(/\r\n/g,`
`),u.xlfn||(P.f=Dy(P.f)),x[0].indexOf('t="array"')>-1)P.F=(I.match(n)||[])[1],P.F.indexOf(":")>-1&&_.push([Yr(P.F),P.F]);else if(x[0].indexOf('t="shared"')>-1){Z=Jt(x[0]);var M=br(Fr(x[1]));u.xlfn||(M=Dy(M)),k[parseInt(Z.si,10)]=[Z,M,V.r]}}else(x=I.match(/<f[^>]*\/>/))&&(Z=Jt(x[0]),k[Z.si]&&(P.f=iI(k[Z.si][1],k[Z.si][2],V.r)));var K=Ja(V.r);for(E=0;E<_.length;++E)K.r>=_[E][0].s.r&&K.r<=_[E][0].e.r&&K.c>=_[E][0].s.c&&K.c<=_[E][0].e.c&&(P.F=_[E][1])}if(V.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(F)P.t="z";else continue;else P.t=V.t||"n";switch(p.s.c>H&&(p.s.c=H),p.e.c<H&&(p.e.c=H),P.t){case"n":if(P.v==""||P.v==null){if(!F)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!F)continue;P.t="z"}else G=gu[parseInt(P.v,10)],P.v=G.t,P.r=G.r,u.cellHTML&&(P.h=G.h);break;case"str":P.t="s",P.v=P.v!=null?Fr(P.v):"",u.cellHTML&&(P.h=Gm(P.v));break;case"inlineStr":x=I.match(a),P.t="s",x!=null&&(G=a1(x[1]))?(P.v=G.t,u.cellHTML&&(P.h=G.h)):P.v="";break;case"b":P.v=Br(P.v);break;case"d":u.cellDates?P.v=Sa(P.v,1):(P.v=en(Sa(P.v,1)),P.t="n");break;case"e":(!u||u.cellText!==!1)&&(P.w=P.v),P.v=W_[P.v];break}if(W=O=0,C=null,R&&V.s!==void 0&&(C=h.CellXf[V.s],C!=null&&(C.numFmtId!=null&&(W=C.numFmtId),u.cellStyles&&C.fillId!=null&&(O=C.fillId))),k4(P,W,O,u,f,h),u.cellDates&&R&&P.t=="n"&&rc(rr[W])&&(P.t="d",P.v=Kf(P.v)),V.cm&&u.xlmeta){var se=(u.xlmeta.Cell||[])[+V.cm-1];se&&se.type=="XLDAPR"&&(P.D=!0)}if(A){var te=Ja(V.r);i[te.r]||(i[te.r]=[]),i[te.r][te.c]=P}else i[V.r]=P}}}}T.length>0&&(i["!rows"]=T)}}();function KF(t,r){var e={},a=t.l+r;e.r=t.read_shift(4),t.l+=4;var n=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=a,o&7&&(e.level=o&7),o&16&&(e.hidden=!0),o&32&&(e.hpt=n/20),e}var ZF=qo;function JF(){}function QF(t,r){var e={},a=t[t.l];return++t.l,e.above=!(a&64),e.left=!(a&128),t.l+=18,e.name=wO(t),e}function eP(t){var r=qn(t);return[r]}function tP(t){var r=Ho(t);return[r]}function rP(t){var r=qn(t),e=t.read_shift(1);return[r,e,"b"]}function aP(t){var r=Ho(t),e=t.read_shift(1);return[r,e,"b"]}function nP(t){var r=qn(t),e=t.read_shift(1);return[r,e,"e"]}function sP(t){var r=Ho(t),e=t.read_shift(1);return[r,e,"e"]}function iP(t){var r=qn(t),e=t.read_shift(4);return[r,e,"s"]}function oP(t){var r=Ho(t),e=t.read_shift(4);return[r,e,"s"]}function lP(t){var r=qn(t),e=za(t);return[r,e,"n"]}function T4(t){var r=Ho(t),e=za(t);return[r,e,"n"]}function cP(t){var r=qn(t),e=e1(t);return[r,e,"n"]}function uP(t){var r=Ho(t),e=e1(t);return[r,e,"n"]}function dP(t){var r=qn(t),e=Jm(t);return[r,e,"is"]}function fP(t){var r=qn(t),e=Va(t);return[r,e,"str"]}function hP(t){var r=Ho(t),e=Va(t);return[r,e,"str"]}function pP(t,r,e){var a=t.l+r,n=qn(t);n.r=e["!row"];var o=t.read_shift(1),s=[n,o,"b"];if(e.cellFormula){t.l+=2;var l=Qf(t,a-t.l,e);s[3]=La(l,null,n,e.supbooks,e)}else t.l=a;return s}function mP(t,r,e){var a=t.l+r,n=qn(t);n.r=e["!row"];var o=t.read_shift(1),s=[n,o,"e"];if(e.cellFormula){t.l+=2;var l=Qf(t,a-t.l,e);s[3]=La(l,null,n,e.supbooks,e)}else t.l=a;return s}function gP(t,r,e){var a=t.l+r,n=qn(t);n.r=e["!row"];var o=za(t),s=[n,o,"n"];if(e.cellFormula){t.l+=2;var l=Qf(t,a-t.l,e);s[3]=La(l,null,n,e.supbooks,e)}else t.l=a;return s}function vP(t,r,e){var a=t.l+r,n=qn(t);n.r=e["!row"];var o=Va(t),s=[n,o,"str"];if(e.cellFormula){t.l+=2;var l=Qf(t,a-t.l,e);s[3]=La(l,null,n,e.supbooks,e)}else t.l=a;return s}var bP=qo;function xP(t,r){var e=t.l+r,a=qo(t),n=Qm(t),o=Va(t),s=Va(t),l=Va(t);t.l=e;var c={rfx:a,relId:n,loc:o,display:l};return s&&(c.Tooltip=s),c}function yP(){}function wP(t,r,e){var a=t.l+r,n=V_(t),o=t.read_shift(1),s=[n];if(s[2]=o,e.cellFormula){var l=TF(t,a-t.l,e);s[1]=l}else t.l=a;return s}function _P(t,r,e){var a=t.l+r,n=qo(t),o=[n];if(e.cellFormula){var s=CF(t,a-t.l,e);o[1]=s,t.l=a}else t.l=a;return o}var SP=["left","right","top","bottom","header","footer"];function kP(t){var r={};return SP.forEach(function(e){r[e]=za(t)}),r}function EP(t){var r=t.read_shift(2);return t.l+=28,{RTL:r&32}}function TP(){}function AP(){}function CP(t,r,e,a,n,o,s){if(!t)return t;var l=r||{};a||(a={"!id":{}});var c=l.dense?[]:{},i,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,f=!1,h,v,b,g,x,y,E,N,I,P=[];l.biff=12,l["!row"]=0;var V=0,U=!1,H=[],G={},Z=l.supbooks||n.supbooks||[[]];if(Z.sharedf=G,Z.arrayf=H,Z.SheetNames=n.SheetNames||n.Sheets.map(function(A){return A.name}),!l.supbooks&&(l.supbooks=Z,n.Names))for(var W=0;W<n.Names.length;++W)Z[0][W+1]=n.Names[W];var O=[],R=[],C=!1;Lf[16]={n:"BrtShortReal",f:T4};var _;if(ci(t,function(T,D,B){if(!f)switch(B){case 148:i=T;break;case 0:h=T,l.sheetRows&&l.sheetRows<=h.r&&(f=!0),N=Ma(g=h.r),l["!row"]=h.r,(T.hidden||T.hpt||T.level!=null)&&(T.hpt&&(T.hpx=Pu(T.hpt)),R[T.r]=T);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:T[2]},T[2]){case"n":v.v=T[1];break;case"s":E=gu[T[1]],v.v=E.t,v.r=E.r;break;case"b":v.v=!!T[1];break;case"e":v.v=T[1],l.cellText!==!1&&(v.w=Wo[v.v]);break;case"str":v.t="s",v.v=T[1];break;case"is":v.t="s",v.v=T[1].t;break}if((b=s.CellXf[T[0].iStyleRef])&&k4(v,b.numFmtId,null,l,o,s),x=T[0].c==-1?x+1:T[0].c,l.dense?(c[g]||(c[g]=[]),c[g][x]=v):c[va(x)+N]=v,l.cellFormula){for(U=!1,V=0;V<H.length;++V){var F=H[V];h.r>=F[0].s.r&&h.r<=F[0].e.r&&x>=F[0].s.c&&x<=F[0].e.c&&(v.F=mr(F[0]),U=!0)}!U&&T.length>3&&(v.f=T[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>x&&(u.s.c=x),u.e.r<h.r&&(u.e.r=h.r),u.e.c<x&&(u.e.c=x),l.cellDates&&b&&v.t=="n"&&rc(rr[b.numFmtId])){var Y=Io(v.v);Y&&(v.t="d",v.v=new Date(Y.y,Y.m-1,Y.d,Y.H,Y.M,Y.S,Y.u))}_&&(_.type=="XLDAPR"&&(v.D=!0),_=void 0);break;case 1:case 12:if(!l.sheetStubs||p)break;v={t:"z",v:void 0},x=T[0].c==-1?x+1:T[0].c,l.dense?(c[g]||(c[g]=[]),c[g][x]=v):c[va(x)+N]=v,u.s.r>h.r&&(u.s.r=h.r),u.s.c>x&&(u.s.c=x),u.e.r<h.r&&(u.e.r=h.r),u.e.c<x&&(u.e.c=x),_&&(_.type=="XLDAPR"&&(v.D=!0),_=void 0);break;case 176:P.push(T);break;case 49:_=((l.xlmeta||{}).Cell||[])[T-1];break;case 494:var X=a["!id"][T.relId];for(X?(T.Target=X.Target,T.loc&&(T.Target+="#"+T.loc),T.Rel=X):T.relId==""&&(T.Target="#"+T.loc),g=T.rfx.s.r;g<=T.rfx.e.r;++g)for(x=T.rfx.s.c;x<=T.rfx.e.c;++x)l.dense?(c[g]||(c[g]=[]),c[g][x]||(c[g][x]={t:"z",v:void 0}),c[g][x].l=T):(y=Qt({c:x,r:g}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=T);break;case 426:if(!l.cellFormula)break;H.push(T),I=l.dense?c[g][x]:c[va(x)+N],I.f=La(T[1],u,{r:h.r,c:x},Z,l),I.F=mr(T[0]);break;case 427:if(!l.cellFormula)break;G[Qt(T[0].s)]=T[1],I=l.dense?c[g][x]:c[va(x)+N],I.f=La(T[1],u,{r:h.r,c:x},Z,l);break;case 60:if(!l.cellStyles)break;for(;T.e>=T.s;)O[T.e--]={width:T.w/256,hidden:!!(T.flags&1),level:T.level},C||(C=!0,n1(T.w/256)),Jl(O[T.e+1]);break;case 161:c["!autofilter"]={ref:mr(T)};break;case 476:c["!margins"]=T;break;case 147:n.Sheets[e]||(n.Sheets[e]={}),T.name&&(n.Sheets[e].CodeName=T.name),(T.above||T.left)&&(c["!outline"]={above:T.above,left:T.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),T.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!D.T){if(!p||l.WTF)throw new Error("Unexpected record 0x"+B.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(u.s.r<2e6||i&&(i.e.r>0||i.e.c>0||i.s.r>0||i.s.c>0))&&(c["!ref"]=mr(i||u)),l.sheetRows&&c["!ref"]){var k=Yr(c["!ref"]);l.sheetRows<=+k.e.r&&(k.e.r=l.sheetRows-1,k.e.r>u.e.r&&(k.e.r=u.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>u.e.c&&(k.e.c=u.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),c["!fullref"]=c["!ref"],c["!ref"]=mr(k))}return P.length>0&&(c["!merges"]=P),O.length>0&&(c["!cols"]=O),R.length>0&&(c["!rows"]=R),c}function NP(t){var r=[],e=t.match(/^<c:numCache>/),a;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var s=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(r[+s[1]]=e?+s[2]:s[2])});var n=br((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){a=o.replace(/<.*?>/g,"")}),[r,n,a]}function jP(t,r,e,a,n,o){var s=o||{"!type":"chart"};if(!t)return o;var l=0,c=0,i="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var f=NP(p);u.s.r=u.s.c=0,u.e.c=l,i=va(l),f[0].forEach(function(h,v){s[i+Ma(v)]={t:"n",v:h,z:f[1]},c=v}),u.e.r<c&&(u.e.r=c),++l}),l>0&&(s["!ref"]=mr(u)),s}function OP(t,r,e,a,n){if(!t)return t;a||(a={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},s,l=t.match(E4);return l&&i1(l[0],o,n,e),(s=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=s[1]),a["!id"][o["!rel"]]&&(o["!drawel"]=a["!id"][o["!rel"]]),o}function DP(t,r){t.l+=10;var e=Va(t);return{name:e}}function MP(t,r,e,a,n){if(!t)return t;a||(a={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},s=!1;return ci(t,function(c,i,u){switch(u){case 550:o["!rel"]=c;break;case 651:n.Sheets[e]||(n.Sheets[e]={}),c.name&&(n.Sheets[e].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(i.T>0)){if(!(i.T<0)){if(!s||r.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},r),a["!id"][o["!rel"]]&&(o["!drawel"]=a["!id"][o["!rel"]]),o}var A4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],RP=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],IP=[],FP=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Py(t,r){for(var e=0;e!=t.length;++e)for(var a=t[e],n=0;n!=r.length;++n){var o=r[n];if(a[o[0]]==null)a[o[0]]=o[1];else switch(o[2]){case"bool":typeof a[o[0]]=="string"&&(a[o[0]]=Br(a[o[0]]));break;case"int":typeof a[o[0]]=="string"&&(a[o[0]]=parseInt(a[o[0]],10));break}}}function Ly(t,r){for(var e=0;e!=r.length;++e){var a=r[e];if(t[a[0]]==null)t[a[0]]=a[1];else switch(a[2]){case"bool":typeof t[a[0]]=="string"&&(t[a[0]]=Br(t[a[0]]));break;case"int":typeof t[a[0]]=="string"&&(t[a[0]]=parseInt(t[a[0]],10));break}}}function C4(t){Ly(t.WBProps,A4),Ly(t.CalcPr,FP),Py(t.WBView,RP),Py(t.Sheets,IP),Yl.date1904=Br(t.WBProps.date1904)}var PP="][*?/\\".split("");function LP(t,r){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return PP.forEach(function(a){if(t.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}var BP=/<\w+:workbook/;function UP(t,r){if(!t)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",o={},s=0;if(t.replace(qa,function(c,i){var u=Jt(c);switch(Is(u[0])){case"<?xml":break;case"<workbook":c.match(BP)&&(n="xmlns"+c.match(/<(\w+):/)[1]),e.xmlns=u[n];break;case"</workbook>":break;case"<fileVersion":delete u[0],e.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":A4.forEach(function(p){if(u[p[0]]!=null)switch(p[2]){case"bool":e.WBProps[p[0]]=Br(u[p[0]]);break;case"int":e.WBProps[p[0]]=parseInt(u[p[0]],10);break;default:e.WBProps[p[0]]=u[p[0]]}}),u.codeName&&(e.WBProps.CodeName=Fr(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],e.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=br(Fr(u.name)),delete u[0],e.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":o={},o.Name=Fr(u.name),u.comment&&(o.Comment=u.comment),u.localSheetId&&(o.Sheet=+u.localSheetId),Br(u.hidden||"0")&&(o.Hidden=!0),s=i+c.length;break;case"</definedName>":o.Ref=br(Fr(t.slice(s,i))),e.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete u[0],e.CalcPr=u;break;case"<calcPr/>":delete u[0],e.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&r.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),nO.indexOf(e.xmlns)===-1)throw new Error("Unknown Namespace: "+e.xmlns);return C4(e),e}function zP(t,r){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=Qp(t),e.name=Va(t),e}function $P(t,r){var e={},a=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var n=r>8?Va(t):"";return n.length>0&&(e.CodeName=n),e.autoCompressPictures=!!(a&65536),e.backupFile=!!(a&64),e.checkCompatibility=!!(a&4096),e.date1904=!!(a&1),e.filterPrivacy=!!(a&8),e.hidePivotFieldList=!!(a&1024),e.promptedSolutions=!!(a&16),e.publishItems=!!(a&2048),e.refreshAllConnections=!!(a&262144),e.saveExternalLinkValues=!!(a&128),e.showBorderUnselectedTables=!!(a&4),e.showInkAnnotation=!!(a&32),e.showObjects=["all","placeholders","none"][a>>13&3],e.showPivotChartFilter=!!(a&32768),e.updateLinks=["userSet","never","always"][a>>8&3],e}function VP(t,r){var e={};return t.read_shift(4),e.ArchID=t.read_shift(4),t.l+=r-8,e}function HP(t,r,e){var a=t.l+r;t.l+=4,t.l+=1;var n=t.read_shift(4),o=_O(t),s=AF(t,0,e),l=Qm(t);t.l=a;var c={Name:o,Ptg:s};return n<268435455&&(c.Sheet=n),l&&(c.Comment=l),c}function qP(t,r){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;r||(r={}),r.biff=12;var o=[],s=[[]];return s.SheetNames=[],s.XTI=[],Lf[16]={n:"BrtFRTArchID$",f:VP},ci(t,function(c,i,u){switch(u){case 156:s.SheetNames.push(c.name),e.Sheets.push(c);break;case 153:e.WBProps=c;break;case 39:c.Sheet!=null&&(r.SID=c.Sheet),c.Ref=La(c.Ptg,null,null,s,r),delete r.SID,delete c.Ptg,o.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([u,c]):s[0]=[u,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(u),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(u),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!i.T){if(!n||r.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},r),C4(e),e.Names=o,e.supbooks=s,e}function WP(t,r,e){return r.slice(-4)===".bin"?qP(t,e):UP(t,e)}function GP(t,r,e,a,n,o,s,l){return r.slice(-4)===".bin"?CP(t,a,e,n,o,s,l):zF(t,a,e,n,o,s,l)}function YP(t,r,e,a,n,o,s,l){return r.slice(-4)===".bin"?MP(t,a,e,n,o):OP(t,a,e,n,o)}function XP(t,r,e,a,n,o,s,l){return r.slice(-4)===".bin"?aI():nI()}function KP(t,r,e,a,n,o,s,l){return r.slice(-4)===".bin"?tI():rI()}function ZP(t,r,e,a){return r.slice(-4)===".bin"?bR(t,e,a):fR(t,e,a)}function JP(t,r,e){return p4(t,e)}function QP(t,r,e){return r.slice(-4)===".bin"?RM(t,e):DM(t,e)}function eL(t,r,e){return r.slice(-4)===".bin"?JR(t,e):GR(t,e)}function tL(t,r,e){return r.slice(-4)===".bin"?HR(t):$R(t)}function rL(t,r,e,a){return e.slice(-4)===".bin"?qR(t,r,e,a):void 0}function aL(t,r,e){return r.slice(-4)===".bin"?UR(t,r,e):zR(t,r,e)}var N4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,j4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ts(t,r){var e=t.split(/\s+/),a=[];if(a[0]=e[0],e.length===1)return a;var n=t.match(N4),o,s,l,c;if(n)for(c=0;c!=n.length;++c)o=n[c].match(j4),(s=o[1].indexOf(":"))===-1?a[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?l="xmlns"+o[1].slice(6):l=o[1].slice(s+1),a[l]=o[2].slice(1,o[2].length-1));return a}function nL(t){var r=t.split(/\s+/),e={};if(r.length===1)return e;var a=t.match(N4),n,o,s,l;if(a)for(l=0;l!=a.length;++l)n=a[l].match(j4),(o=n[1].indexOf(":"))===-1?e[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?s="xmlns"+n[1].slice(6):s=n[1].slice(o+1),e[s]=n[2].slice(1,n[2].length-1));return e}var bu;function sL(t,r){var e=bu[t]||br(t);return e==="General"?Bo(r):Hn(e,r)}function iL(t,r,e,a){var n=a;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=Br(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Sa(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}t[br(r)]=n}function oL(t,r,e){if(t.t!=="z"){if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Wo[t.v]:r==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Du(t.v):t.w=Bo(t.v):t.w=sL(r||"General",t.v)}catch(o){if(e.WTF)throw o}try{var a=bu[r]||r||"General";if(e.cellNF&&(t.z=a),e.cellDates&&t.t=="n"&&rc(a)){var n=Io(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(o){if(e.WTF)throw o}}}function lL(t,r,e){if(e.cellStyles&&r.Interior){var a=r.Interior;a.Pattern&&(a.patternType=iR[a.Pattern]||a.Pattern)}t[r.ID]=r}function cL(t,r,e,a,n,o,s,l,c,i){var u="General",p=a.StyleID,f={};i=i||{};var h=[],v=0;for(p===void 0&&l&&(p=l.StyleID),p===void 0&&s&&(p=s.StyleID);o[p]!==void 0&&(o[p].nf&&(u=o[p].nf),o[p].Interior&&h.push(o[p].Interior),!!o[p].Parent);)p=o[p].Parent;switch(e.Type){case"Boolean":a.t="b",a.v=Br(t);break;case"String":a.t="s",a.r=iy(br(t)),a.v=t.indexOf("<")>-1?br(r||t).replace(/<.*?>/g,""):a.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),a.v=(Sa(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=br(t):a.v<60&&(a.v=a.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+t),a.t||(a.t="n");break;case"Error":a.t="e",a.v=W_[t],i.cellText!==!1&&(a.w=t);break;default:t==""&&r==""?a.t="z":(a.t="s",a.v=iy(r||t));break}if(oL(a,u,i),i.cellFormula!==!1)if(a.Formula){var b=br(a.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),a.f=Gl(b,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Gl("RC:RC",n):a.ArrayRange&&(a.F=Gl(a.ArrayRange,n),c.push([Yr(a.F),a.F]))}else for(v=0;v<c.length;++v)n.r>=c[v][0].s.r&&n.r<=c[v][0].e.r&&n.c>=c[v][0].s.c&&n.c<=c[v][0].e.c&&(a.F=c[v][1]);i.cellStyles&&(h.forEach(function(g){!f.patternType&&g.patternType&&(f.patternType=g.patternType)}),a.s=f),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function uL(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Ep(t,r){var e=r||{};b_();var a=nu(Ym(t));(e.type=="binary"||e.type=="array"||e.type=="base64")&&(a=Fr(a));var n=a.slice(0,1024).toLowerCase(),o=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var s=Da(e);return s.type="string",Iu.to_workbook(a,s)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ue){n.indexOf("<"+ue)>=0&&(o=!0)}),o)return xL(a,e);bu={"General Number":"General","General Date":rr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":rr[15],"Short Date":rr[14],"Long Time":rr[19],"Medium Time":rr[18],"Short Time":rr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:rr[2],Standard:rr[4],Percent:rr[10],Scientific:rr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],i,u={},p=[],f=e.dense?[]:{},h="",v={},b={},g=ts('<Data ss:Type="String">'),x=0,y=0,E=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},I={},P={},V="",U=0,H=[],G={},Z={},W=0,O=[],R=[],C={},_=[],k,A=!1,T=[],D=[],B={},F=0,Y=0,X={Sheets:[],WBProps:{date1904:!1}},re={};Ru.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var z="";l=Ru.exec(a);)switch(l[3]=(z=l[3]).toLowerCase()){case"data":if(z=="data"){if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?cL(a.slice(x,l.index),V,g,c[c.length-1][0]=="comment"?C:v,{c:y,r:E},I,_[y],b,T,e):(V="",g=ts(l[0]),x=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(R.length>0&&(v.c=R),(!e.sheetRows||e.sheetRows>E)&&v.v!==void 0&&(e.dense?(f[E]||(f[E]=[]),f[E][y]=v):f[va(y)+Ma(E)]=v),v.HRef&&(v.l={Target:br(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(F=y+(parseInt(v.MergeAcross,10)|0),Y=E+(parseInt(v.MergeDown,10)|0),H.push({s:{c:y,r:E},e:{c:F,r:Y}})),!e.sheetStubs)v.MergeAcross?y=F+1:++y;else if(v.MergeAcross||v.MergeDown){for(var ee=y;ee<=F;++ee)for(var L=E;L<=Y;++L)(ee>y||L>E)&&(e.dense?(f[L]||(f[L]=[]),f[L][ee]={t:"z"}):f[va(ee)+Ma(L)]={t:"z"});y=F+1}else++y;else v=nL(l[0]),v.Index&&(y=+v.Index-1),y<N.s.c&&(N.s.c=y),y>N.e.c&&(N.e.c=y),l[0].slice(-2)==="/>"&&++y,R=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(E<N.s.r&&(N.s.r=E),E>N.e.r&&(N.e.r=E),l[0].slice(-2)==="/>"&&(b=ts(l[0]),b.Index&&(E=+b.Index-1)),y=0,++E):(b=ts(l[0]),b.Index&&(E=+b.Index-1),B={},(b.AutoFitHeight=="0"||b.Height)&&(B.hpx=parseInt(b.Height,10),B.hpt=h4(B.hpx),D[E]=B),b.Hidden=="1"&&(B.hidden=!0,D[E]=B));break;case"worksheet":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"));p.push(h),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(f["!ref"]=mr(N),e.sheetRows&&e.sheetRows<=N.e.r&&(f["!fullref"]=f["!ref"],N.e.r=e.sheetRows-1,f["!ref"]=mr(N))),H.length&&(f["!merges"]=H),_.length>0&&(f["!cols"]=_),D.length>0&&(f["!rows"]=D),u[h]=f}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=y=0,c.push([l[3],!1]),i=ts(l[0]),h=br(i.Name),f=e.dense?[]:{},H=[],T=[],D=[],re={name:h,Hidden:0},X.Sheets.push(re);break;case"table":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),_=[],A=!1}break;case"style":l[1]==="/"?lL(I,P,e):P=ts(l[0]);break;case"numberformat":P.nf=br(ts(l[0]).Format||"General"),bu[P.nf]&&(P.nf=bu[P.nf]);for(var M=0;M!=392&&rr[M]!=P.nf;++M);if(M==392){for(M=57;M!=392;++M)if(rr[M]==null){Po(P.nf,M);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(k=ts(l[0]),k.Hidden&&(k.hidden=!0,delete k.Hidden),k.Width&&(k.wpx=parseInt(k.Width,10)),!A&&k.wpx>10){A=!0,Ka=d4;for(var K=0;K<_.length;++K)_[K]&&Jl(_[K])}A&&Jl(k),_[k.Index-1||_.length]=k;for(var se=0;se<+k.Span;++se)_[_.length]=Da(k);break;case"namedrange":if(l[1]==="/")break;X.Names||(X.Names=[]);var te=Jt(l[0]),ae={Name:te.Name,Ref:Gl(te.RefersTo.slice(1),{r:0,c:0})};X.Sheets.length>0&&(ae.Sheet=X.Sheets.length-1),X.Names.push(ae);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?V+=a.slice(U,l.index):U=l.index+l[0].length;break;case"interior":if(!e.cellStyles)break;P.Interior=ts(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?GO(G,z,a.slice(W,l.index)):W=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"));uL(C),R.push(C)}else c.push([l[3],!1]),i=ts(l[0]),C={a:i.Author};break;case"autofilter":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var Q=ts(l[0]);f["!autofilter"]={ref:Gl(Q.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return Hy(a,e);var fe=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:fe=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:fe=!1}break;case"excelworkbook":switch(l[3]){case"date1904":X.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:fe=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:fe=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(a.slice(W,l.index)){case"SheetHidden":re.Hidden=1;break;case"SheetVeryHidden":re.Hidden=2;break}else W=l.index+l[0].length;break;case"header":f["!margins"]||vu(f["!margins"]={},"xlml"),isNaN(+Jt(l[0]).Margin)||(f["!margins"].header=+Jt(l[0]).Margin);break;case"footer":f["!margins"]||vu(f["!margins"]={},"xlml"),isNaN(+Jt(l[0]).Margin)||(f["!margins"].footer=+Jt(l[0]).Margin);break;case"pagemargins":var le=Jt(l[0]);f["!margins"]||vu(f["!margins"]={},"xlml"),isNaN(+le.Top)||(f["!margins"].top=+le.Top),isNaN(+le.Left)||(f["!margins"].left=+le.Left),isNaN(+le.Right)||(f["!margins"].right=+le.Right),isNaN(+le.Bottom)||(f["!margins"].bottom=+le.Bottom);break;case"displayrighttoleft":X.Views||(X.Views=[]),X.Views[0]||(X.Views[0]={}),X.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:fe=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:fe=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:fe=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:fe=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:fe=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:fe=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:fe=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:fe=!1}break;case"smarttags":break;default:fe=!1;break}if(fe||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?iL(Z,z,O,a.slice(W,l.index)):(O=l,W=l.index+l[0].length);break}if(e.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var ne={};return!e.bookSheets&&!e.bookProps&&(ne.Sheets=u),ne.SheetNames=p,ne.Workbook=X,ne.SSF=Da(rr),ne.Props=G,ne.Custprops=Z,ne}function am(t,r){switch(c1(r=r||{}),r.type||"base64"){case"base64":return Ep(Tn(t),r);case"binary":case"buffer":case"file":return Ep(t,r);case"array":return Ep(Vo(t),r)}}function dL(t){var r={},e=t.content;if(e.l=28,r.AnsiUserType=e.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=EO(e),e.length-e.l<=4)return r;var a=e.read_shift(4);if(a==0||a>40||(e.l-=4,r.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||(a=e.read_shift(4),a!==1907505652)||(r.UnicodeClipboardFormat=TO(e),a=e.read_shift(4),a==0||a>40))return r;e.l-=4,r.Reserved2=e.read_shift(0,"lpwstr")}var fL=[60,1084,2066,2165,2175];function hL(t,r,e,a,n){var o=a,s=[],l=e.slice(e.l,e.l+o);if(n&&n.enc&&n.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(l)}s.push(l),e.l+=o;for(var c=ai(e,e.l),i=nm[c],u=0;i!=null&&fL.indexOf(c)>-1;)o=ai(e,e.l+2),u=e.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),l=e.slice(u,e.l+4+o),s.push(l),e.l+=4+o,i=nm[c=ai(e,e.l)];var p=qi(s);ja(p,0);var f=0;p.lens=[];for(var h=0;h<s.length;++h)p.lens.push(f),f+=s[h].length;if(p.length<a)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+p.length+" < "+a;return r.f(p,p.length,n)}function ws(t,r,e){if(t.t!=="z"&&t.XF){var a=0;try{a=t.z||t.XF.numFmtId||0,r.cellNF&&(t.z=rr[a])}catch(o){if(r.WTF)throw o}if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Wo[t.v]:a===0||a=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Du(t.v):t.w=Bo(t.v):t.w=Hn(a,t.v,{date1904:!!e,dateNF:r&&r.dateNF})}catch(o){if(r.WTF)throw o}if(r.cellDates&&a&&t.t=="n"&&rc(rr[a]||String(a))){var n=Io(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function wf(t,r,e){return{v:t,ixfe:r,t:e}}function pL(t,r){var e={opts:{}},a={},n=r.dense?[]:{},o={},s={},l=null,c=[],i="",u={},p,f="",h,v,b,g,x={},y=[],E,N,I=[],P=[],V={Sheets:[],WBProps:{date1904:!1},Views:[{}]},U={},H=function(st){return st<8?Lo[st]:st<64&&P[st-8]||Lo[st]},G=function(st,je,ht){var Je=je.XF.data;if(!(!Je||!Je.patternType||!ht||!ht.cellStyles)){je.s={},je.s.patternType=Je.patternType;var nt;(nt=Fu(H(Je.icvFore)))&&(je.s.fgColor={rgb:nt}),(nt=Fu(H(Je.icvBack)))&&(je.s.bgColor={rgb:nt})}},Z=function(st,je,ht){if(!(B>1)&&!(ht.sheetRows&&st.r>=ht.sheetRows)){if(ht.cellStyles&&je.XF&&je.XF.data&&G(st,je,ht),delete je.ixfe,delete je.XF,p=st,f=Qt(st),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),st.r<s.s.r&&(s.s.r=st.r),st.c<s.s.c&&(s.s.c=st.c),st.r+1>s.e.r&&(s.e.r=st.r+1),st.c+1>s.e.c&&(s.e.c=st.c+1),ht.cellFormula&&je.f){for(var Je=0;Je<y.length;++Je)if(!(y[Je][0].s.c>st.c||y[Je][0].s.r>st.r)&&!(y[Je][0].e.c<st.c||y[Je][0].e.r<st.r)){je.F=mr(y[Je][0]),(y[Je][0].s.c!=st.c||y[Je][0].s.r!=st.r)&&delete je.f,je.f&&(je.f=""+La(y[Je][1],s,st,T,W));break}}ht.dense?(n[st.r]||(n[st.r]=[]),n[st.r][st.c]=je):n[f]=je}},W={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(W.password=r.password);var O,R=[],C=[],_=[],k=[],A=!1,T=[];T.SheetNames=W.snames,T.sharedf=W.sharedf,T.arrayf=W.arrayf,T.names=[],T.XTI=[];var D=0,B=0,F=0,Y=[],X=[],re;W.codepage=1200,ls(1200);for(var z=!1;t.l<t.length-1;){var ee=t.l,L=t.read_shift(2);if(L===0&&D===10)break;var M=t.l===t.length?0:t.read_shift(2),K=nm[L];if(K&&K.f){if(r.bookSheets&&D===133&&L!==133)break;if(D=L,K.r===2||K.r==12){var se=t.read_shift(2);if(M-=2,!W.enc&&se!==L&&((se&255)<<8|se>>8)!==L)throw new Error("rt mismatch: "+se+"!="+L);K.r==12&&(t.l+=10,M-=10)}var te={};if(L===10?te=K.f(t,M,W):te=hL(L,K,t,M,W),B==0&&[9,521,1033,2057].indexOf(D)===-1)continue;switch(L){case 34:e.opts.Date1904=V.WBProps.date1904=te;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(W.enc||(t.l=0),W.enc=te,!r.password)throw new Error("File is password-protected");if(te.valid==null)throw new Error("Encryption scheme unsupported");if(!te.valid)throw new Error("Password is incorrect");break;case 92:W.lastuser=te;break;case 66:var ae=Number(te);switch(ae){case 21010:ae=1200;break;case 32768:ae=1e4;break;case 32769:ae=1252;break}ls(W.codepage=ae),z=!0;break;case 317:W.rrtabid=te;break;case 25:W.winlocked=te;break;case 439:e.opts.RefreshAll=te;break;case 12:e.opts.CalcCount=te;break;case 16:e.opts.CalcDelta=te;break;case 17:e.opts.CalcIter=te;break;case 13:e.opts.CalcMode=te;break;case 14:e.opts.CalcPrecision=te;break;case 95:e.opts.CalcSaveRecalc=te;break;case 15:W.CalcRefMode=te;break;case 2211:e.opts.FullCalc=te;break;case 129:te.fDialog&&(n["!type"]="dialog"),te.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),te.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:I.push(te);break;case 430:T.push([te]),T[T.length-1].XTI=[];break;case 35:case 547:T[T.length-1].push(te);break;case 24:case 536:re={Name:te.Name,Ref:La(te.rgce,s,null,T,W)},te.itab>0&&(re.Sheet=te.itab-1),T.names.push(re),T[0]||(T[0]=[],T[0].XTI=[]),T[T.length-1].push(te),te.Name=="_xlnm._FilterDatabase"&&te.itab>0&&te.rgce&&te.rgce[0]&&te.rgce[0][0]&&te.rgce[0][0][0]=="PtgArea3d"&&(X[te.itab-1]={ref:mr(te.rgce[0][0][1][2])});break;case 22:W.ExternCount=te;break;case 23:T.length==0&&(T[0]=[],T[0].XTI=[]),T[T.length-1].XTI=T[T.length-1].XTI.concat(te),T.XTI=T.XTI.concat(te);break;case 2196:if(W.biff<8)break;re!=null&&(re.Comment=te[1]);break;case 18:n["!protect"]=te;break;case 19:te!==0&&W.WTF&&console.error("Password verifier: "+te);break;case 133:o[te.pos]=te,W.snames.push(te.name);break;case 10:{if(--B)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,n["!ref"]=mr(s),r.sheetRows&&r.sheetRows<=s.e.r){var Q=s.e.r;s.e.r=r.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=mr(s),s.e.r=Q}s.e.r++,s.e.c++}R.length>0&&(n["!merges"]=R),C.length>0&&(n["!objects"]=C),_.length>0&&(n["!cols"]=_),k.length>0&&(n["!rows"]=k),V.Sheets.push(U)}i===""?u=n:a[i]=n,n=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(W.biff===8&&(W.biff={9:2,521:3,1033:4}[L]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[te.BIFFVer]||8),W.biffguess=te.BIFFVer==0,te.BIFFVer==0&&te.dt==4096&&(W.biff=5,z=!0,ls(W.codepage=28591)),W.biff==8&&te.BIFFVer==0&&te.dt==16&&(W.biff=2),B++)break;if(n=r.dense?[]:{},W.biff<8&&!z&&(z=!0,ls(W.codepage=r.codepage||1252)),W.biff<5||te.BIFFVer==0&&te.dt==4096){i===""&&(i="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var fe={pos:t.l-M,name:i};o[fe.pos]=fe,W.snames.push(i)}else i=(o[ee]||{name:""}).name;te.dt==32&&(n["!type"]="chart"),te.dt==64&&(n["!type"]="macro"),R=[],C=[],W.arrayf=y=[],_=[],k=[],A=!1,U={Hidden:(o[ee]||{hs:0}).hs,name:i}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(r.dense?(n[te.r]||[])[te.c]:n[Qt({c:te.c,r:te.r})])&&++te.c,E={ixfe:te.ixfe,XF:I[te.ixfe]||{},v:te.val,t:"n"},F>0&&(E.z=Y[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),Z({c:te.c,r:te.r},E,r);break;case 5:case 517:E={ixfe:te.ixfe,XF:I[te.ixfe],v:te.val,t:te.t},F>0&&(E.z=Y[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),Z({c:te.c,r:te.r},E,r);break;case 638:E={ixfe:te.ixfe,XF:I[te.ixfe],v:te.rknum,t:"n"},F>0&&(E.z=Y[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),Z({c:te.c,r:te.r},E,r);break;case 189:for(var le=te.c;le<=te.C;++le){var ne=te.rkrec[le-te.c][0];E={ixfe:ne,XF:I[ne],v:te.rkrec[le-te.c][1],t:"n"},F>0&&(E.z=Y[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),Z({c:le,r:te.r},E,r)}break;case 6:case 518:case 1030:{if(te.val=="String"){l=te;break}if(E=wf(te.val,te.cell.ixfe,te.tt),E.XF=I[E.ixfe],r.cellFormula){var ue=te.formula;if(ue&&ue[0]&&ue[0][0]&&ue[0][0][0]=="PtgExp"){var he=ue[0][0][1][0],ke=ue[0][0][1][1],pe=Qt({r:he,c:ke});x[pe]?E.f=""+La(te.formula,s,te.cell,T,W):E.F=((r.dense?(n[he]||[])[ke]:n[pe])||{}).F}else E.f=""+La(te.formula,s,te.cell,T,W)}F>0&&(E.z=Y[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),Z(te.cell,E,r),l=te}break;case 7:case 519:if(l)l.val=te,E=wf(te,l.cell.ixfe,"s"),E.XF=I[E.ixfe],r.cellFormula&&(E.f=""+La(l.formula,s,l.cell,T,W)),F>0&&(E.z=Y[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),Z(l.cell,E,r),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(te);var Ce=Qt(te[0].s);if(h=r.dense?(n[te[0].s.r]||[])[te[0].s.c]:n[Ce],r.cellFormula&&h){if(!l||!Ce||!h)break;h.f=""+La(te[1],s,te[0],T,W),h.F=mr(te[0])}}break;case 1212:{if(!r.cellFormula)break;if(f){if(!l)break;x[Qt(l.cell)]=te[0],h=r.dense?(n[l.cell.r]||[])[l.cell.c]:n[Qt(l.cell)],(h||{}).f=""+La(te[0],s,p,T,W)}}break;case 253:E=wf(c[te.isst].t,te.ixfe,"s"),c[te.isst].h&&(E.h=c[te.isst].h),E.XF=I[E.ixfe],F>0&&(E.z=Y[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),Z({c:te.c,r:te.r},E,r);break;case 513:r.sheetStubs&&(E={ixfe:te.ixfe,XF:I[te.ixfe],t:"z"},F>0&&(E.z=Y[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),Z({c:te.c,r:te.r},E,r));break;case 190:if(r.sheetStubs)for(var Me=te.c;Me<=te.C;++Me){var Ie=te.ixfe[Me-te.c];E={ixfe:Ie,XF:I[Ie],t:"z"},F>0&&(E.z=Y[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),Z({c:Me,r:te.r},E,r)}break;case 214:case 516:case 4:E=wf(te.val,te.ixfe,"s"),E.XF=I[E.ixfe],F>0&&(E.z=Y[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),Z({c:te.c,r:te.r},E,r);break;case 0:case 512:B===1&&(s=te);break;case 252:c=te;break;case 1054:if(W.biff==4){Y[F++]=te[1];for(var Ye=0;Ye<F+163&&rr[Ye]!=te[1];++Ye);Ye>=163&&Po(te[1],F+163)}else Po(te[1],te[0]);break;case 30:{Y[F++]=te;for(var at=0;at<F+163&&rr[at]!=te;++at);at>=163&&Po(te,F+163)}break;case 229:R=R.concat(te);break;case 93:C[te.cmo[0]]=W.lastobj=te;break;case 438:W.lastobj.TxO=te;break;case 127:W.lastobj.ImData=te;break;case 440:for(g=te[0].s.r;g<=te[0].e.r;++g)for(b=te[0].s.c;b<=te[0].e.c;++b)h=r.dense?(n[g]||[])[b]:n[Qt({c:b,r:g})],h&&(h.l=te[1]);break;case 2048:for(g=te[0].s.r;g<=te[0].e.r;++g)for(b=te[0].s.c;b<=te[0].e.c;++b)h=r.dense?(n[g]||[])[b]:n[Qt({c:b,r:g})],h&&h.l&&(h.l.Tooltip=te[1]);break;case 28:{if(W.biff<=5&&W.biff>=2)break;h=r.dense?(n[te[0].r]||[])[te[0].c]:n[Qt(te[0])];var rt=C[te[2]];h||(r.dense?(n[te[0].r]||(n[te[0].r]=[]),h=n[te[0].r][te[0].c]={t:"z"}):h=n[Qt(te[0])]={t:"z"},s.e.r=Math.max(s.e.r,te[0].r),s.s.r=Math.min(s.s.r,te[0].r),s.e.c=Math.max(s.e.c,te[0].c),s.s.c=Math.min(s.s.c,te[0].c)),h.c||(h.c=[]),v={a:te[1],t:rt.TxO.t},h.c.push(v)}break;case 2173:FR(I[te.ixfe],te.ext);break;case 125:{if(!W.cellStyles)break;for(;te.e>=te.s;)_[te.e--]={width:te.w/256,level:te.level||0,hidden:!!(te.flags&1)},A||(A=!0,n1(te.w/256)),Jl(_[te.e+1])}break;case 520:{var it={};te.level!=null&&(k[te.r]=it,it.level=te.level),te.hidden&&(k[te.r]=it,it.hidden=!0),te.hpt&&(k[te.r]=it,it.hpt=te.hpt,it.hpx=Pu(te.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||vu(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[L]]=te;break;case 161:n["!margins"]||vu(n["!margins"]={}),n["!margins"].header=te.header,n["!margins"].footer=te.footer;break;case 574:te.RTL&&(V.Views[0].RTL=!0);break;case 146:P=te;break;case 2198:O=te;break;case 140:N=te;break;case 442:i?U.CodeName=te||U.name:V.WBProps.CodeName=te||"ThisWorkbook";break}}else K||console.error("Missing Info for XLS Record 0x"+L.toString(16)),t.l+=M}return e.SheetNames=Ds(o).sort(function(et,st){return Number(et)-Number(st)}).map(function(et){return o[et].name}),r.bookSheets||(e.Sheets=a),!e.SheetNames.length&&u["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=u)):e.Preamble=u,e.Sheets&&X.forEach(function(et,st){e.Sheets[e.SheetNames[st]]["!autofilter"]=et}),e.Strings=c,e.SSF=Da(rr),W.enc&&(e.Encryption=W.enc),O&&(e.Themes=O),e.Metadata={},N!==void 0&&(e.Metadata.Country=N),T.names.length>0&&(V.Names=T.names),e.Workbook=V,e}var By={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function mL(t,r,e){var a=pr.find(t,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=_y(a,DO,By.DSI);for(var o in n)r[o]=n[o]}catch(i){if(e.WTF)throw i}var s=pr.find(t,"/!SummaryInformation");if(s&&s.size>0)try{var l=_y(s,MO,By.SI);for(var c in l)r[c]==null&&(r[c]=l[c])}catch(i){if(e.WTF)throw i}r.HeadingPairs&&r.TitlesOfParts&&(Y_(r.HeadingPairs,r.TitlesOfParts,r,e),delete r.HeadingPairs,delete r.TitlesOfParts)}function O4(t,r){r||(r={}),c1(r),i_(),r.codepage&&zm(r.codepage);var e,a;if(t.FullPaths){if(pr.find(t,"/encryption"))throw new Error("File is password-protected");e=pr.find(t,"!CompObj"),a=pr.find(t,"/Workbook")||pr.find(t,"/Book")}else{switch(r.type){case"base64":t=is(Tn(t));break;case"binary":t=is(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}ja(t,0),a={content:t}}var n,o;if(e&&dL(e),r.bookProps&&!r.bookSheets)n={};else{var s=fr?"buffer":"array";if(a&&a.content)n=pL(a.content,r);else if((o=pr.find(t,"PerfectOffice_MAIN"))&&o.content)n=mu.to_workbook(o.content,(r.type=s,r));else if((o=pr.find(t,"NativeContent_MAIN"))&&o.content)n=mu.to_workbook(o.content,(r.type=s,r));else throw(o=pr.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&t.FullPaths&&pr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=eI(t))}var l={};return t.FullPaths&&mL(t,l,r),n.Props=n.Custprops=l,r.bookFiles&&(n.cfb=t),n}var Lf={0:{f:KF},1:{f:eP},2:{f:cP},3:{f:nP},4:{f:rP},5:{f:lP},6:{f:fP},7:{f:iP},8:{f:vP},9:{f:gP},10:{f:pP},11:{f:mP},12:{f:tP},13:{f:uP},14:{f:sP},15:{f:aP},16:{f:T4},17:{f:hP},18:{f:oP},19:{f:Jm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:HP},40:{},42:{},43:{f:pR},44:{f:hR},45:{f:mR},46:{f:vR},47:{f:gR},48:{},49:{f:bO},50:{},51:{f:LR},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:i4},62:{f:dP},63:{f:VR},64:{f:TP},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ha,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:EP},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:QF},148:{f:ZF,p:16},151:{f:yP},152:{},153:{f:$P},154:{},155:{},156:{f:zP},157:{},158:{},159:{T:1,f:MM},160:{T:-1},161:{T:1,f:qo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:bP},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:PR},336:{T:-1},337:{f:BR,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Qp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:s4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:wP},427:{f:_P},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:kP},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:JF},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:xP},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Qp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ZR},633:{T:1},634:{T:-1},635:{T:1,f:KR},636:{T:-1},637:{f:yO},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:DP},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:AP},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},nm={6:{f:Sp},10:{f:$i},12:{f:oa},13:{f:oa},14:{f:Zr},15:{f:Zr},16:{f:za},17:{f:Zr},18:{f:Zr},19:{f:oa},20:{f:Ty},21:{f:Ty},23:{f:s4},24:{f:Cy},25:{f:Zr},26:{},27:{},28:{f:YD},29:{},34:{f:Zr},35:{f:Ay},38:{f:za},39:{f:za},40:{f:za},41:{f:za},42:{f:Zr},43:{f:Zr},47:{f:JM},49:{f:ND},51:{f:oa},60:{},61:{f:TD},64:{f:Zr},65:{f:CD},66:{f:oa},77:{},80:{},81:{},82:{},85:{f:oa},89:{},90:{},91:{},92:{f:bD},93:{f:KD},94:{},95:{f:Zr},96:{},97:{},99:{f:Zr},125:{f:i4},128:{f:BD},129:{f:xD},130:{f:oa},131:{f:Zr},132:{f:Zr},133:{f:yD},134:{},140:{f:rM},141:{f:oa},144:{},146:{f:nM},151:{},152:{},153:{},154:{},155:{},156:{f:oa},157:{},158:{},160:{f:cM},161:{f:iM},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:ID},190:{f:FD},193:{f:$i},197:{},198:{},199:{},200:{},201:{},202:{f:Zr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:oa},220:{},221:{f:Zr},222:{},224:{f:LD},225:{f:vD},226:{f:$i},227:{},229:{f:XD},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:wD},253:{f:jD},255:{f:_D},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Q_},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Zr},353:{f:$i},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:zD},431:{f:Zr},432:{},433:{},434:{},437:{},438:{f:QD},439:{f:Zr},440:{f:eM},441:{},442:{f:Xu},443:{},444:{f:oa},445:{},446:{},448:{f:$i},449:{f:ED,r:2},450:{f:$i},512:{f:ky},513:{f:lM},515:{f:UD},516:{f:OD},517:{f:Ey},519:{f:uM},520:{f:SD},523:{},545:{f:Ny},549:{f:Sy},566:{},574:{f:AD},638:{f:RD},659:{},1048:{},1054:{f:DD},1084:{},1212:{f:qD},2048:{f:tM},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:bf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:$i},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:sM,r:12},2173:{f:IR,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Zr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:HD,r:12},2197:{},2198:{f:NR,r:12},2199:{},2200:{},2201:{},2202:{f:WD,r:12},2203:{f:$i},2204:{},2205:{},2206:{},2207:{},2211:{f:kD},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:oa},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:oM},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:aM},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ky},1:{},2:{f:pM},3:{f:hM},4:{f:fM},5:{f:Ey},7:{f:mM},8:{},9:{f:bf},11:{},22:{f:oa},30:{f:MD},31:{},32:{},33:{f:Ny},36:{},37:{f:Sy},50:{f:gM},62:{},52:{},67:{},68:{f:oa},69:{},86:{},126:{},127:{f:dM},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:vM},223:{},234:{},354:{},421:{},518:{f:Sp},521:{f:bf},536:{f:Cy},547:{f:Ay},561:{},579:{},1030:{f:Sp},1033:{f:bf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function rs(t,r,e,a){var n=r;if(!isNaN(n)){var o=(e||[]).length||0,s=t.next(4);s.write_shift(2,n),s.write_shift(2,o),o>0&&U_(e)&&t.push(e)}}function Uy(t,r){var e=r||{},a=e.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var n=t.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),s=n.index,l=o&&o.index||t.length,c=Uj(t.slice(s,l),/(:?<tr[^>]*>)/i,"<tr>"),i=-1,u=0,p=0,f=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(s=0;s<c.length;++s){var b=c[s].trim(),g=b.slice(0,3).toLowerCase();if(g=="<tr"){if(++i,e.sheetRows&&e.sheetRows<=i){--i;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var x=b.split(/<\/t[dh]>/i);for(l=0;l<x.length;++l){var y=x[l].trim();if(y.match(/<t[dh]/i)){for(var E=y,N=0;E.charAt(0)=="<"&&(N=E.indexOf(">"))>-1;)E=E.slice(N+1);for(var I=0;I<v.length;++I){var P=v[I];P.s.c==u&&P.s.r<i&&i<=P.e.r&&(u=P.e.c+1,I=-1)}var V=Jt(y.slice(0,y.indexOf(">")));f=V.colspan?+V.colspan:1,((p=+V.rowspan)>1||f>1)&&v.push({s:{r:i,c:u},e:{r:i+(p||1)-1,c:u+f-1}});var U=V.t||V["data-t"]||"";if(!E.length){u+=f;continue}if(E=A_(E),h.s.r>i&&(h.s.r=i),h.e.r<i&&(h.e.r=i),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!E.length){u+=f;continue}var H={t:"s",v:E};e.raw||!E.trim().length||U=="s"||(E==="TRUE"?H={t:"b",v:!0}:E==="FALSE"?H={t:"b",v:!1}:isNaN(us(E))?isNaN(Zl(E).getDate())||(H={t:"d",v:Sa(E)},e.cellDates||(H={t:"n",v:en(H.v)}),H.z=e.dateNF||rr[14]):H={t:"n",v:us(E)}),e.dense?(a[i]||(a[i]=[]),a[i][u]=H):a[Qt({r:i,c:u})]=H,u+=f}}}}return a["!ref"]=mr(h),v.length&&(a["!merges"]=v),a}function gL(t,r,e,a){for(var n=t["!merges"]||[],o=[],s=r.s.c;s<=r.e.c;++s){for(var l=0,c=0,i=0;i<n.length;++i)if(!(n[i].s.r>e||n[i].s.c>s)&&!(n[i].e.r<e||n[i].e.c<s)){if(n[i].s.r<e||n[i].s.c<s){l=-1;break}l=n[i].e.r-n[i].s.r+1,c=n[i].e.c-n[i].s.c+1;break}if(!(l<0)){var u=Qt({r:e,c:s}),p=a.dense?(t[e]||[])[s]:t[u],f=p&&p.v!=null&&(p.h||Gm(p.w||(ii(p),p.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),a.editable?f='<span contenteditable="true">'+f+"</span>":p&&(h["data-t"]=p&&p.t||"z",p.v!=null&&(h["data-v"]=p.v),p.z!=null&&(h["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+p.l.Target+'">'+f+"</a>")),h.id=(a.id||"sjs")+"-"+u,o.push(rO("td",f,h))}}var v="<tr>";return v+o.join("")+"</tr>"}var vL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',bL="</body></html>";function xL(t,r){var e=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||e.length==0)throw new Error("Invalid HTML: could not find <table>");if(e.length==1)return ao(Uy(e[0],r),r);var a=d1();return e.forEach(function(n,o){f1(a,Uy(n,r),"Sheet"+(o+1))}),a}function yL(t,r,e){var a=[];return a.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function wL(t,r){var e=r||{},a=e.header!=null?e.header:vL,n=e.footer!=null?e.footer:bL,o=[a],s=ac(t["!ref"]);e.dense=Array.isArray(t),o.push(yL(t,s,e));for(var l=s.s.r;l<=s.e.r;++l)o.push(gL(t,s,l,e));return o.push("</table>"+n),o.join("")}function D4(t,r,e){var a=e||{},n=0,o=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var s=typeof a.origin=="string"?Ja(a.origin):a.origin;n=s.r,o=s.c}var l=r.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,l.length),i={s:{r:0,c:0},e:{r:n,c:o}};if(t["!ref"]){var u=ac(t["!ref"]);i.s.r=Math.min(i.s.r,u.s.r),i.s.c=Math.min(i.s.c,u.s.c),i.e.r=Math.max(i.e.r,u.e.r),i.e.c=Math.max(i.e.c,u.e.c),n==-1&&(i.e.r=n=u.e.r+1)}var p=[],f=0,h=t["!rows"]||(t["!rows"]=[]),v=0,b=0,g=0,x=0,y=0,E=0;for(t["!cols"]||(t["!cols"]=[]);v<l.length&&b<c;++v){var N=l[v];if(zy(N)){if(a.display)continue;h[b]={hidden:!0}}var I=N.children;for(g=x=0;g<I.length;++g){var P=I[g];if(!(a.display&&zy(P))){var V=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):A_(P.innerHTML),U=P.getAttribute("data-z")||P.getAttribute("z");for(f=0;f<p.length;++f){var H=p[f];H.s.c==x+o&&H.s.r<b+n&&b+n<=H.e.r&&(x=H.e.c+1-o,f=-1)}E=+P.getAttribute("colspan")||1,((y=+P.getAttribute("rowspan")||1)>1||E>1)&&p.push({s:{r:b+n,c:x+o},e:{r:b+n+(y||1)-1,c:x+o+(E||1)-1}});var G={t:"s",v:V},Z=P.getAttribute("data-t")||P.getAttribute("t")||"";V!=null&&(V.length==0?G.t=Z||"z":a.raw||V.trim().length==0||Z=="s"||(V==="TRUE"?G={t:"b",v:!0}:V==="FALSE"?G={t:"b",v:!1}:isNaN(us(V))?isNaN(Zl(V).getDate())||(G={t:"d",v:Sa(V)},a.cellDates||(G={t:"n",v:en(G.v)}),G.z=a.dateNF||rr[14]):G={t:"n",v:us(V)})),G.z===void 0&&U!=null&&(G.z=U);var W="",O=P.getElementsByTagName("A");if(O&&O.length)for(var R=0;R<O.length&&!(O[R].hasAttribute("href")&&(W=O[R].getAttribute("href"),W.charAt(0)!="#"));++R);W&&W.charAt(0)!="#"&&(G.l={Target:W}),a.dense?(t[b+n]||(t[b+n]=[]),t[b+n][x+o]=G):t[Qt({c:x+o,r:b+n})]=G,i.e.c<x+o&&(i.e.c=x+o),x+=E}}++b}return p.length&&(t["!merges"]=(t["!merges"]||[]).concat(p)),i.e.r=Math.max(i.e.r,b-1+n),t["!ref"]=mr(i),b>=c&&(t["!fullref"]=mr((i.e.r=l.length-v+b-1+n,i))),t}function M4(t,r){var e=r||{},a=e.dense?[]:{};return D4(a,t,r)}function _L(t,r){return ao(M4(t,r),r)}function zy(t){var r="",e=SL(t);return e&&(r=e(t).getPropertyValue("display")),r||(r=t.style&&t.style.display),r==="none"}function SL(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function kL(t){var r=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),e=br(r.replace(/<[^>]*>/g,""));return[e]}var $y={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function R4(t,r){var e=r||{},a=Ym(t),n=[],o,s,l={name:""},c="",i=0,u,p,f={},h=[],v=e.dense?[]:{},b,g,x={value:""},y="",E=0,N=[],I=-1,P=-1,V={s:{r:1e6,c:1e7},e:{r:0,c:0}},U=0,H={},G=[],Z={},W=0,O=0,R=[],C=1,_=1,k=[],A={Names:[]},T={},D=["",""],B=[],F={},Y="",X=0,re=!1,z=!1,ee=0;for(Ru.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=Ru.exec(a);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(V.e.c>=V.s.c&&V.e.r>=V.s.r?v["!ref"]=mr(V):v["!ref"]="A1:A1",e.sheetRows>0&&e.sheetRows<=V.e.r&&(v["!fullref"]=v["!ref"],V.e.r=e.sheetRows-1,v["!ref"]=mr(V)),G.length&&(v["!merges"]=G),R.length&&(v["!rows"]=R),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),f[u.name]=v,z=!1):b[0].charAt(b[0].length-2)!=="/"&&(u=Jt(b[0],!1),I=P=-1,V.s.r=V.s.c=1e7,V.e.r=V.e.c=0,v=e.dense?[]:{},G=[],R=[],z=!0);break;case"table-row-group":b[1]==="/"?--U:++U;break;case"table-row":case"":if(b[1]==="/"){I+=C,C=1;break}if(p=Jt(b[0],!1),p.?I=p.-1:I==-1&&(I=0),C=+p["number-rows-repeated"]||1,C<10)for(ee=0;ee<C;++ee)U>0&&(R[I+ee]={level:U});P=-1;break;case"covered-table-cell":b[1]!=="/"&&++P,e.sheetStubs&&(e.dense?(v[I]||(v[I]=[]),v[I][P]={t:"z"}):v[Qt({r:I,c:P})]={t:"z"}),y="",N=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++P,x=Jt(b[0],!1),_=parseInt(x["number-columns-repeated"]||"1",10),g={t:"z",v:null},x.formula&&e.cellFormula!=!1&&(g.f=Fy(br(x.formula))),(x.||x["value-type"])=="string"&&(g.t="s",g.v=br(x["string-value"]||""),e.dense?(v[I]||(v[I]=[]),v[I][P]=g):v[Qt({r:I,c:P})]=g),P+=_-1;else if(b[1]!=="/"){++P,y="",E=0,N=[],_=1;var L=C?I+C-1:I;if(P>V.e.c&&(V.e.c=P),P<V.s.c&&(V.s.c=P),I<V.s.r&&(V.s.r=I),L>V.e.r&&(V.e.r=L),x=Jt(b[0],!1),B=[],F={},g={t:x.||x["value-type"],v:null},e.cellFormula)if(x.formula&&(x.formula=br(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(W=parseInt(x["number-matrix-rows-spanned"],10)||0,O=parseInt(x["number-matrix-columns-spanned"],10)||0,Z={s:{r:I,c:P},e:{r:I+W-1,c:P+O-1}},g.F=mr(Z),k.push([Z,g.F])),x.formula)g.f=Fy(x.formula);else for(ee=0;ee<k.length;++ee)I>=k[ee][0].s.r&&I<=k[ee][0].e.r&&P>=k[ee][0].s.c&&P<=k[ee][0].e.c&&(g.F=k[ee][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(W=parseInt(x["number-rows-spanned"],10)||0,O=parseInt(x["number-columns-spanned"],10)||0,Z={s:{r:I,c:P},e:{r:I+W-1,c:P+O-1}},G.push(Z)),x["number-columns-repeated"]&&(_=parseInt(x["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Br(x["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(x.value);break;case"percentage":g.t="n",g.v=parseFloat(x.value);break;case"currency":g.t="n",g.v=parseFloat(x.value);break;case"date":g.t="d",g.v=Sa(x["date-value"]),e.cellDates||(g.t="n",g.v=en(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=Pj(x["time-value"])/86400,e.cellDates&&(g.t="d",g.v=Kf(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(x.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",x["string-value"]!=null&&(y=br(x["string-value"]),N=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(re=!1,g.t==="s"&&(g.v=y||"",N.length&&(g.R=N),re=E==0),T.Target&&(g.l=T),B.length>0&&(g.c=B,B=[]),y&&e.cellText!==!1&&(g.w=y),re&&(g.t="z",delete g.v),(!re||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=I))for(var M=0;M<C;++M){if(_=parseInt(x["number-columns-repeated"]||"1",10),e.dense)for(v[I+M]||(v[I+M]=[]),v[I+M][P]=M==0?g:Da(g);--_>0;)v[I+M][P+_]=Da(g);else for(v[Qt({r:I+M,c:P})]=g;--_>0;)v[Qt({r:I+M,c:P+_})]=Da(g);V.e.c<=P&&(V.e.c=P)}_=parseInt(x["number-columns-repeated"]||"1",10),P+=_-1,_=0,g={},y="",N=[]}T={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((o=n.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&n.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((o=n.pop())[0]!==b[3])throw"Bad state: "+o;F.t=y,N.length&&(F.R=N),F.a=Y,B.push(F)}else b[0].charAt(b[0].length-2)!=="/"&&n.push([b[3],!1]);Y="",X=0,y="",E=0,N=[];break;case"creator":b[1]==="/"?Y=a.slice(X,b.index):X=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((o=n.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&n.push([b[3],!1]);y="",E=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(H[l.name]=c,(o=n.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&(c="",l=Jt(b[0],!1),n.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":s=Jt(b[0],!1),c+=$y[b[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":s=Jt(b[0],!1),c+=$y[b[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(i,b.index);break}else i=b.index+b[0].length;break;case"named-range":s=Jt(b[0],!1),D=kp(s["cell-range-address"]);var K={Name:s.name,Ref:D[0]+"!"+D[1]};z&&(K.Sheet=h.length),A.Names.push(K);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(b[1]==="/"&&(!x||!x["string-value"])){var se=kL(a.slice(E,b.index));y=(y.length>0?y+`
`:"")+se[0]}else Jt(b[0],!1),E=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{D=kp(Jt(b[0])["target-range-address"]),f[D[0]]["!autofilter"]={ref:D[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(T=Jt(b[0],!1),!T.href)break;T.Target=br(T.href),delete T.href,T.Target.charAt(0)=="#"&&T.Target.indexOf(".")>-1?(D=kp(T.Target.slice(1)),T.Target="#"+D[0]+"!"+D[1]):T.Target.match(/^\.\.[\\\/]/)&&(T.Target=T.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(e.WTF)throw new Error(b)}}var te={Sheets:f,SheetNames:h,Workbook:A};return e.bookSheets&&delete te.Sheets,te}function Vy(t,r){r=r||{},Ln(t,"META-INF/manifest.xml")&&UO(ia(t,"META-INF/manifest.xml"),r);var e=kn(t,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var a=R4(Fr(e),r);return Ln(t,"meta.xml")&&(a.Props=G_(ia(t,"meta.xml"))),a}function Hy(t,r){return R4(t,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function o1(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function sm(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Fr(Vo(t))}function im(t){var r=t.reduce(function(n,o){return n+o.length},0),e=new Uint8Array(r),a=0;return t.forEach(function(n){e.set(n,a),a+=n.length}),e}function qy(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function EL(t,r){for(var e=(t[r+15]&127)<<7|t[r+14]>>1,a=t[r+14]&1,n=r+13;n>=r;--n)a=a*256+t[n];return(t[r+15]&128?-a:a)*Math.pow(10,e-6176)}function Lu(t,r){var e=r?r[0]:0,a=t[e]&127;e:if(t[e++]>=128&&(a|=(t[e]&127)<<7,t[e++]<128||(a|=(t[e]&127)<<14,t[e++]<128)||(a|=(t[e]&127)<<21,t[e++]<128)||(a+=(t[e]&127)*Math.pow(2,28),++e,t[e++]<128)||(a+=(t[e]&127)*Math.pow(2,35),++e,t[e++]<128)||(a+=(t[e]&127)*Math.pow(2,42),++e,t[e++]<128)))break e;return r&&(r[0]=e),a}function ba(t){var r=0,e=t[r]&127;e:if(t[r++]>=128){if(e|=(t[r]&127)<<7,t[r++]<128||(e|=(t[r]&127)<<14,t[r++]<128)||(e|=(t[r]&127)<<21,t[r++]<128))break e;e|=(t[r]&127)<<28}return e}function $a(t){for(var r=[],e=[0];e[0]<t.length;){var a=e[0],n=Lu(t,e),o=n&7;n=Math.floor(n/8);var s=0,l;if(n==0)break;switch(o){case 0:{for(var c=e[0];t[e[0]++]>=128;);l=t.slice(c,e[0])}break;case 5:s=4,l=t.slice(e[0],e[0]+s),e[0]+=s;break;case 1:s=8,l=t.slice(e[0],e[0]+s),e[0]+=s;break;case 2:s=Lu(t,e),l=t.slice(e[0],e[0]+s),e[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(n," at offset ").concat(a))}var i={data:l,type:o};r[n]==null?r[n]=[i]:r[n].push(i)}return r}function l1(t,r){return(t==null?void 0:t.map(function(e){return r(e.data)}))||[]}function TL(t){for(var r,e=[],a=[0];a[0]<t.length;){var n=Lu(t,a),o=$a(t.slice(a[0],a[0]+n));a[0]+=n;var s={id:ba(o[1][0].data),messages:[]};o[2].forEach(function(l){var c=$a(l.data),i=ba(c[3][0].data);s.messages.push({meta:c,data:t.slice(a[0],a[0]+i)}),a[0]+=i}),(r=o[3])!=null&&r[0]&&(s.merge=ba(o[3][0].data)>>>0>0),e.push(s)}return e}function AL(t,r){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],a=Lu(r,e),n=[];e[0]<r.length;){var o=r[e[0]]&3;if(o==0){var s=r[e[0]++]>>2;if(s<60)++s;else{var l=s-59;s=r[e[0]],l>1&&(s|=r[e[0]+1]<<8),l>2&&(s|=r[e[0]+2]<<16),l>3&&(s|=r[e[0]+3]<<24),s>>>=0,s++,e[0]+=l}n.push(r.slice(e[0],e[0]+s)),e[0]+=s;continue}else{var c=0,i=0;if(o==1?(i=(r[e[0]]>>2&7)+4,c=(r[e[0]++]&224)<<3,c|=r[e[0]++]):(i=(r[e[0]++]>>2)+1,o==2?(c=r[e[0]]|r[e[0]+1]<<8,e[0]+=2):(c=(r[e[0]]|r[e[0]+1]<<8|r[e[0]+2]<<16|r[e[0]+3]<<24)>>>0,e[0]+=4)),n=[im(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(i>=c)for(n.push(n[0].slice(-c)),i-=c;i>=n[n.length-1].length;)n.push(n[n.length-1]),i-=n[n.length-1].length;n.push(n[0].slice(-c,-c+i))}}var u=im(n);if(u.length!=a)throw new Error("Unexpected length: ".concat(u.length," != ").concat(a));return u}function CL(t){for(var r=[],e=0;e<t.length;){var a=t[e++],n=t[e]|t[e+1]<<8|t[e+2]<<16;e+=3,r.push(AL(a,t.slice(e,e+n))),e+=n}if(e!==t.length)throw new Error("data is not a valid framed stream!");return im(r)}function NL(t,r,e,a){var n=o1(t),o=n.getUint32(4,!0),s=(a>1?12:8)+qy(o&(a>1?3470:398))*4,l=-1,c=-1,i=NaN,u=new Date(2001,0,1);o&512&&(l=n.getUint32(s,!0),s+=4),s+=qy(o&(a>1?12288:4096))*4,o&16&&(c=n.getUint32(s,!0),s+=4),o&32&&(i=n.getFloat64(s,!0),s+=8),o&64&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8);var p;switch(t[2]){case 0:break;case 2:p={t:"n",v:i};break;case 3:p={t:"s",v:r[c]};break;case 5:p={t:"d",v:u};break;case 6:p={t:"b",v:i>0};break;case 7:p={t:"n",v:i/86400};break;case 8:p={t:"e",v:0};break;case 9:if(l>-1)p={t:"s",v:e[l]};else if(c>-1)p={t:"s",v:r[c]};else if(!isNaN(i))p={t:"n",v:i};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return p}function jL(t,r,e){var a=o1(t),n=a.getUint32(8,!0),o=12,s=-1,l=-1,c=NaN,i=NaN,u=new Date(2001,0,1);n&1&&(c=EL(t,o),o+=16),n&2&&(i=a.getFloat64(o,!0),o+=8),n&4&&(u.setTime(u.getTime()+a.getFloat64(o,!0)*1e3),o+=8),n&8&&(l=a.getUint32(o,!0),o+=4),n&16&&(s=a.getUint32(o,!0),o+=4);var p;switch(t[1]){case 0:break;case 2:p={t:"n",v:c};break;case 3:p={t:"s",v:r[l]};break;case 5:p={t:"d",v:u};break;case 6:p={t:"b",v:i>0};break;case 7:p={t:"n",v:i/86400};break;case 8:p={t:"e",v:0};break;case 9:if(s>-1)p={t:"s",v:e[s]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)));break;case 10:p={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)))}return p}function OL(t,r,e){switch(t[0]){case 0:case 1:case 2:case 3:return NL(t,r,e,t[0]);case 5:return jL(t,r,e);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Zi(t){var r=$a(t);return Lu(r[1][0].data)}function Wy(t,r){var e=$a(r.data),a=ba(e[1][0].data),n=e[3],o=[];return(n||[]).forEach(function(s){var l=$a(s.data),c=ba(l[1][0].data)>>>0;switch(a){case 1:o[c]=sm(l[3][0].data);break;case 8:{var i=t[Zi(l[9][0].data)][0],u=$a(i.data),p=t[Zi(u[1][0].data)][0],f=ba(p.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var h=$a(p.data);o[c]=h[3].map(function(v){return sm(v.data)}).join("")}break}}),o}function DL(t,r){var e,a,n,o,s,l,c,i,u,p,f,h,v,b,g=$a(t),x=ba(g[1][0].data)>>>0,y=ba(g[2][0].data)>>>0,E=((a=(e=g[8])==null?void 0:e[0])==null?void 0:a.data)&&ba(g[8][0].data)>0||!1,N,I;if((o=(n=g[7])==null?void 0:n[0])!=null&&o.data&&r!=0)N=(l=(s=g[7])==null?void 0:s[0])==null?void 0:l.data,I=(i=(c=g[6])==null?void 0:c[0])==null?void 0:i.data;else if((p=(u=g[4])==null?void 0:u[0])!=null&&p.data&&r!=1)N=(h=(f=g[4])==null?void 0:f[0])==null?void 0:h.data,I=(b=(v=g[3])==null?void 0:v[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var P=E?4:1,V=o1(N),U=[],H=0;H<N.length/2;++H){var G=V.getUint16(H*2,!0);G<65535&&U.push([H,G])}if(U.length!=y)throw"Expected ".concat(y," cells, found ").concat(U.length);var Z=[];for(H=0;H<U.length-1;++H)Z[U[H][0]]=I.subarray(U[H][1]*P,U[H+1][1]*P);return U.length>=1&&(Z[U[U.length-1][0]]=I.subarray(U[U.length-1][1]*P)),{R:x,cells:Z}}function ML(t,r){var e,a=$a(r.data),n=(e=a==null?void 0:a[7])!=null&&e[0]?ba(a[7][0].data)>>>0>0?1:0:-1,o=l1(a[5],function(s){return DL(s,n)});return{nrows:ba(a[4][0].data)>>>0,data:o.reduce(function(s,l){return s[l.R]||(s[l.R]=[]),l.cells.forEach(function(c,i){if(s[l.R][i])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(i));s[l.R][i]=c}),s},[])}}function RL(t,r,e){var a,n=$a(r.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(ba(n[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(o.e.c=(ba(n[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));e["!ref"]=mr(o);var s=$a(n[4][0].data),l=Wy(t,t[Zi(s[4][0].data)][0]),c=(a=s[17])!=null&&a[0]?Wy(t,t[Zi(s[17][0].data)][0]):[],i=$a(s[3][0].data),u=0;i[1].forEach(function(p){var f=$a(p.data),h=t[Zi(f[2][0].data)][0],v=ba(h.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var b=ML(t,h);b.data.forEach(function(g,x){g.forEach(function(y,E){var N=Qt({r:u+x,c:E}),I=OL(y,l,c);I&&(e[N]=I)})}),u+=b.nrows})}function IL(t,r){var e=$a(r.data),a={"!ref":"A1"},n=t[Zi(e[2][0].data)],o=ba(n[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return RL(t,n[0],a),a}function FL(t,r){var e,a=$a(r.data),n={name:(e=a[1])!=null&&e[0]?sm(a[1][0].data):"",sheets:[]},o=l1(a[2],Zi);return o.forEach(function(s){t[s].forEach(function(l){var c=ba(l.meta[1][0].data);c==6e3&&n.sheets.push(IL(t,l))})}),n}function PL(t,r){var e=d1(),a=$a(r.data),n=l1(a[1],Zi);if(n.forEach(function(o){t[o].forEach(function(s){var l=ba(s.meta[1][0].data);if(l==2){var c=FL(t,s);c.sheets.forEach(function(i,u){f1(e,i,u==0?c.name:c.name+"_"+u,!0)})}})}),e.SheetNames.length==0)throw new Error("Empty NUMBERS file");return e}function Tp(t){var r,e,a,n,o={},s=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var i;try{i=CL(c.content)}catch(p){return console.log("?? "+c.content.length+" "+(p.message||p))}var u;try{u=TL(i)}catch(p){return console.log("## "+(p.message||p))}u.forEach(function(p){o[p.id]=p.messages,s.push(p.id)})}}),!s.length)throw new Error("File has no messages");var l=((n=(a=(e=(r=o==null?void 0:o[1])==null?void 0:r[0])==null?void 0:e.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&ba(o[1][0].meta[1][0].data)==1&&o[1][0];if(l||s.forEach(function(c){o[c].forEach(function(i){var u=ba(i.meta[1][0].data)>>>0;if(u==1)if(!l)l=i;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return PL(o,l)}function LL(t){return function(e){for(var a=0;a!=t.length;++a){var n=t[a];e[n[0]]===void 0&&(e[n[0]]=n[1]),n[2]==="n"&&(e[n[0]]=Number(e[n[0]]))}}}function c1(t){LL([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function BL(t){return $l.WS.indexOf(t)>-1?"sheet":t==$l.CS?"chart":t==$l.DS?"dialog":t==$l.MS?"macro":t&&t.length?t:"sheet"}function UL(t,r){if(!t)return 0;try{t=r.map(function(a){return a.id||(a.id=a.strRelID),[a.name,t["!id"][a.id].Target,BL(t["!id"][a.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function zL(t,r,e,a,n,o,s,l,c,i,u,p){try{o[a]=hu(kn(t,e,!0),r);var f=ia(t,r),h;switch(l){case"sheet":h=GP(f,r,n,c,o[a],i,u,p);break;case"chart":if(h=YP(f,r,n,c,o[a],i,u,p),!h||!h["!drawel"])break;var v=iu(h["!drawel"].Target,r),b=em(v),g=WR(kn(t,v,!0),hu(kn(t,b,!0),v)),x=iu(g,v),y=em(x);h=jP(kn(t,x,!0),x,c,hu(kn(t,y,!0),x),i,h);break;case"macro":h=XP(f,r,n,c,o[a],i,u,p);break;case"dialog":h=KP(f,r,n,c,o[a],i,u,p);break;default:throw new Error("Unrecognized sheet type "+l)}s[a]=h;var E=[];o&&o[a]&&Ds(o[a]).forEach(function(N){var I="";if(o[a][N].Type==$l.CMNT){I=iu(o[a][N].Target,r);var P=eL(ia(t,I,!0),I,c);if(!P||!P.length)return;Oy(h,P,!1)}o[a][N].Type==$l.TCMNT&&(I=iu(o[a][N].Target,r),E=E.concat(YR(ia(t,I,!0),c)))}),E&&E.length&&Oy(h,E,!0,c.people||[])}catch(N){if(c.WTF)throw N}}function In(t){return t.charAt(0)=="/"?t.slice(1):t}function $L(t,r){if(b_(),r=r||{},c1(r),Ln(t,"META-INF/manifest.xml")||Ln(t,"objectdata.xml"))return Vy(t,r);if(Ln(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Tp<"u"){if(t.FileIndex)return Tp(t);var e=pr.utils.cfb_new();return ny(t).forEach(function(R){Vj(e,R,$j(t,R))}),Tp(e)}throw new Error("Unsupported NUMBERS file")}if(!Ln(t,"[Content_Types].xml"))throw Ln(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ln(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=ny(t),n=LO(kn(t,"[Content_Types].xml")),o=!1,s,l;if(n.workbooks.length===0&&(l="xl/workbook.xml",ia(t,l,!0)&&n.workbooks.push(l)),n.workbooks.length===0){if(l="xl/workbook.bin",!ia(t,l,!0))throw new Error("Could not find workbook");n.workbooks.push(l),o=!0}n.workbooks[0].slice(-3)=="bin"&&(o=!0);var c={},i={};if(!r.bookSheets&&!r.bookProps){if(gu=[],n.sst)try{gu=QP(ia(t,In(n.sst)),n.sst,r)}catch(R){if(r.WTF)throw R}r.cellStyles&&n.themes.length&&(c=JP(kn(t,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],r)),n.style&&(i=ZP(ia(t,In(n.style)),n.style,c,r))}n.links.map(function(R){try{var C=hu(kn(t,em(In(R))),R);return rL(ia(t,In(R)),C,R,r)}catch{}});var u=WP(ia(t,In(n.workbooks[0])),n.workbooks[0],r),p={},f="";n.coreprops.length&&(f=ia(t,In(n.coreprops[0]),!0),f&&(p=G_(f)),n.extprops.length!==0&&(f=ia(t,In(n.extprops[0]),!0),f&&VO(f,p,r)));var h={};(!r.bookSheets||r.bookProps)&&n.custprops.length!==0&&(f=kn(t,In(n.custprops[0]),!0),f&&(h=qO(f,r)));var v={};if((r.bookSheets||r.bookProps)&&(u.Sheets?s=u.Sheets.map(function(C){return C.name}):p.Worksheets&&p.SheetNames.length>0&&(s=p.SheetNames),r.bookProps&&(v.Props=p,v.Custprops=h),r.bookSheets&&typeof s<"u"&&(v.SheetNames=s),r.bookSheets?v.SheetNames:r.bookProps))return v;s={};var b={};r.bookDeps&&n.calcchain&&(b=tL(ia(t,In(n.calcchain)),n.calcchain));var g=0,x={},y,E;{var N=u.Sheets;p.Worksheets=N.length,p.SheetNames=[];for(var I=0;I!=N.length;++I)p.SheetNames[I]=N[I].name}var P=o?"bin":"xml",V=n.workbooks[0].lastIndexOf("/"),U=(n.workbooks[0].slice(0,V+1)+"_rels/"+n.workbooks[0].slice(V+1)+".rels").replace(/^\//,"");Ln(t,U)||(U="xl/_rels/workbook."+P+".rels");var H=hu(kn(t,U,!0),U.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(r.xlmeta=aL(ia(t,In(n.metadata[0])),n.metadata[0],r)),(n.people||[]).length>=1&&(r.people=XR(ia(t,In(n.people[0])),r)),H&&(H=UL(H,u.Sheets));var G=ia(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=p.Worksheets;++g){var Z="sheet";if(H&&H[g]?(y="xl/"+H[g][1].replace(/[\/]?xl\//,""),Ln(t,y)||(y=H[g][1]),Ln(t,y)||(y=U.replace(/_rels\/.*$/,"")+H[g][1]),Z=H[g][2]):(y="xl/worksheets/sheet"+(g+1-G)+"."+P,y=y.replace(/sheet0\./,"sheet.")),E=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(g!=r.sheets)continue e;break;case"string":if(p.SheetNames[g].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var W=!1,O=0;O!=r.sheets.length;++O)typeof r.sheets[O]=="number"&&r.sheets[O]==g&&(W=1),typeof r.sheets[O]=="string"&&r.sheets[O].toLowerCase()==p.SheetNames[g].toLowerCase()&&(W=1);if(!W)continue e}}zL(t,y,E,p.SheetNames[g],g,x,s,Z,r,u,c,i)}return v={Directory:n,Workbook:u,Props:p,Custprops:h,Deps:b,Sheets:s,SheetNames:p.SheetNames,Strings:gu,Styles:i,Themes:c,SSF:Da(rr)},r&&r.bookFiles&&(t.files?(v.keys=a,v.files=t.files):(v.keys=[],v.files={},t.FullPaths.forEach(function(R,C){R=R.replace(/^Root Entry[\/]/,""),v.keys.push(R),v.files[R]=t.FileIndex[C]}))),r&&r.bookVBA&&(n.vba.length>0?v.vbaraw=ia(t,In(n.vba[0]),!0):n.defaults&&n.defaults.bin===QR&&(v.vbaraw=ia(t,"xl/vbaProject.bin",!0))),v}function VL(t,r){var e=r||{},a="Workbook",n=pr.find(t,a);try{if(a="/!DataSpaces/Version",n=pr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(IM(n.content),a="/!DataSpaces/DataSpaceMap",n=pr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=PM(n.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=pr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=LM(n.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=pr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);UM(n.content)}catch{}if(a="/EncryptionInfo",n=pr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=zM(n.content);if(a="/EncryptedPackage",n=pr.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],n.content,e.password||"",e);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],n.content,e.password||"",e);throw new Error("File is password-protected")}function u1(t,r){var e="";switch((r||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=Tn(t.slice(0,12));break;case"binary":e=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function HL(t,r){return pr.find(t,"EncryptedPackage")?VL(t,r):O4(t,r)}function qL(t,r){var e,a=t,n=r||{};return n.type||(n.type=fr&&Buffer.isBuffer(t)?"buffer":"base64"),e=k_(a,n),$L(e,n)}function I4(t,r){var e=0;e:for(;e<t.length;)switch(t.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return am(t.slice(e),r);default:break e}return Iu.to_workbook(t,r)}function WL(t,r){var e="",a=u1(t,r);switch(r.type){case"base64":e=Tn(t);break;case"binary":e=t;break;case"buffer":e=t.toString("binary");break;case"array":e=Uo(t);break;default:throw new Error("Unrecognized type "+r.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(e=Fr(e)),r.type="binary",I4(e,r)}function GL(t,r){var e=t;return r.type=="base64"&&(e=Tn(e)),e=Ou.utils.decode(1200,e.slice(2),"str"),r.type="binary",I4(e,r)}function YL(t){return t.match(/[^\x00-\x7F]/)?ou(t):t}function Ap(t,r,e,a){return a?(e.type="string",Iu.to_workbook(t,e)):Iu.to_workbook(r,e)}function Bf(t,r){i_();var e=r||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Bf(new Uint8Array(t),(e=Da(e),e.type="array",e));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!e.type&&(e.type=typeof Deno<"u"?"buffer":"array");var a=t,n=[0,0,0,0],o=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),Yl={},e.dateNF&&(Yl.dateNF=e.dateNF),e.type||(e.type=fr&&Buffer.isBuffer(t)?"buffer":"base64"),e.type=="file"&&(e.type=fr?"buffer":"binary",a=Ij(t),typeof Uint8Array<"u"&&!fr&&(e.type="array")),e.type=="string"&&(o=!0,e.type="binary",e.codepage=65001,a=YL(t)),e.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),l=new Uint8Array(s);if(l.foo="bar",!l.foo)return e=Da(e),e.type="array",Bf($m(a),e)}switch((n=u1(a,e))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return HL(pr.read(a,e),e);break;case 9:if(n[1]<=8)return O4(a,e);break;case 60:return am(a,e);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return _M(a,e);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return yM.to_workbook(a,e);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?qL(a,e):Ap(t,a,e,o);case 239:return n[3]===60?am(a,e):Ap(t,a,e,o);case 255:if(n[1]===254)return GL(a,e);if(n[1]===0&&n[2]===2&&n[3]===0)return mu.to_workbook(a,e);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return mu.to_workbook(a,e);break;case 3:case 131:case 139:case 140:return jy.to_workbook(a,e);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return QM.to_workbook(a,e);break;case 10:case 13:case 32:return WL(a,e);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return bM.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?jy.to_workbook(a,e):Ap(t,a,e,o)}function XL(t,r,e,a,n,o,s,l){var c=Ma(e),i=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),p=!0,f=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:e,enumerable:!1})}catch{f.__rowNum__=e}else f.__rowNum__=e;if(!s||t[e])for(var h=r.s.c;h<=r.e.c;++h){var v=s?t[e][h]:t[a[h]+c];if(v===void 0||v.t===void 0){if(i===void 0)continue;o[h]!=null&&(f[o[h]]=i);continue}var b=v.v;switch(v.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(o[h]!=null){if(b==null)if(v.t=="e"&&b===null)f[o[h]]=null;else if(i!==void 0)f[o[h]]=i;else if(u&&b===null)f[o[h]]=null;else continue;else f[o[h]]=u&&(v.t!=="n"||v.t==="n"&&l.rawNumbers!==!1)?b:ii(v,b,l);b!=null&&(p=!1)}}return{row:f,isempty:p}}function om(t,r){if(t==null||t["!ref"]==null)return[];var e={t:"n",v:0},a=0,n=1,o=[],s=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},i=r||{},u=i.range!=null?i.range:t["!ref"];switch(i.header===1?a=1:i.header==="A"?a=2:Array.isArray(i.header)?a=3:i.header==null&&(a=0),typeof u){case"string":c=Yr(u);break;case"number":c=Yr(t["!ref"]),c.s.r=u;break;default:c=u}a>0&&(n=0);var p=Ma(c.s.r),f=[],h=[],v=0,b=0,g=Array.isArray(t),x=c.s.r,y=0,E={};g&&!t[x]&&(t[x]=[]);var N=i.skipHidden&&t["!cols"]||[],I=i.skipHidden&&t["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(N[y]||{}).hidden)switch(f[y]=va(y),e=g?t[x][y]:t[f[y]+p],a){case 1:o[y]=y-c.s.c;break;case 2:o[y]=f[y];break;case 3:o[y]=i.header[y-c.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),l=s=ii(e,null,i),b=E[s]||0,!b)E[s]=1;else{do l=s+"_"+b++;while(E[l]);E[s]=b,E[l]=1}o[y]=l}for(x=c.s.r+n;x<=c.e.r;++x)if(!(I[x]||{}).hidden){var P=XL(t,c,x,f,a,o,g,i);(P.isempty===!1||(a===1?i.blankrows!==!1:i.blankrows))&&(h[v++]=P.row)}return h.length=v,h}var Gy=/"/g;function KL(t,r,e,a,n,o,s,l){for(var c=!0,i=[],u="",p=Ma(e),f=r.s.c;f<=r.e.c;++f)if(a[f]){var h=l.dense?(t[e]||[])[f]:t[a[f]+p];if(h==null)u="";else if(h.v!=null){c=!1,u=""+(l.rawNumbers&&h.t=="n"?h.v:ii(h,null,l));for(var v=0,b=0;v!==u.length;++v)if((b=u.charCodeAt(v))===n||b===o||b===34||l.forceQuotes){u='"'+u.replace(Gy,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(c=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(Gy,'""')+'"')):u="";i.push(u)}return l.blankrows===!1&&c?null:i.join(s)}function F4(t,r){var e=[],a=r??{};if(t==null||t["!ref"]==null)return"";var n=Yr(t["!ref"]),o=a.FS!==void 0?a.FS:",",s=o.charCodeAt(0),l=a.RS!==void 0?a.RS:`
`,c=l.charCodeAt(0),i=new RegExp((o=="|"?"\\|":o)+"+$"),u="",p=[];a.dense=Array.isArray(t);for(var f=a.skipHidden&&t["!cols"]||[],h=a.skipHidden&&t["!rows"]||[],v=n.s.c;v<=n.e.c;++v)(f[v]||{}).hidden||(p[v]=va(v));for(var b=0,g=n.s.r;g<=n.e.r;++g)(h[g]||{}).hidden||(u=KL(t,n,g,p,s,c,o,a),u!=null&&(a.strip&&(u=u.replace(i,"")),(u||a.blankrows!==!1)&&e.push((b++?l:"")+u)));return delete a.dense,e.join("")}function ZL(t,r){r||(r={}),r.FS="	",r.RS=`
`;var e=F4(t,r);return e}function JL(t){var r="",e,a="";if(t==null||t["!ref"]==null)return[];var n=Yr(t["!ref"]),o="",s=[],l,c=[],i=Array.isArray(t);for(l=n.s.c;l<=n.e.c;++l)s[l]=va(l);for(var u=n.s.r;u<=n.e.r;++u)for(o=Ma(u),l=n.s.c;l<=n.e.c;++l)if(r=s[l]+o,e=i?(t[u]||[])[l]:t[r],a="",e!==void 0){if(e.F!=null){if(r=e.F,!e.f)continue;a=e.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(e.f!=null)a=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)a=""+e.v;else if(e.t=="b")a=e.v?"TRUE":"FALSE";else if(e.w!==void 0)a="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?a="'"+e.v:a=""+e.v}}c[c.length]=r+"="+a}return c}function P4(t,r,e){var a=e||{},n=+!a.skipHeader,o=t||{},s=0,l=0;if(o&&a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?Ja(a.origin):a.origin;s=c.r,l=c.c}var i,u={s:{c:0,r:0},e:{c:l,r:s+r.length-1+n}};if(o["!ref"]){var p=Yr(o["!ref"]);u.e.c=Math.max(u.e.c,p.e.c),u.e.r=Math.max(u.e.r,p.e.r),s==-1&&(s=p.e.r+1,u.e.r=s+r.length-1+n)}else s==-1&&(s=0,u.e.r=r.length-1+n);var f=a.header||[],h=0;r.forEach(function(b,g){Ds(b).forEach(function(x){(h=f.indexOf(x))==-1&&(f[h=f.length]=x);var y=b[x],E="z",N="",I=Qt({c:l+h,r:s+g+n});i=Bu(o,I),y&&typeof y=="object"&&!(y instanceof Date)?o[I]=y:(typeof y=="number"?E="n":typeof y=="boolean"?E="b":typeof y=="string"?E="s":y instanceof Date?(E="d",a.cellDates||(E="n",y=en(y)),N=a.dateNF||rr[14]):y===null&&a.nullError&&(E="e",y=0),i?(i.t=E,i.v=y,delete i.w,delete i.R,N&&(i.z=N)):o[I]=i={t:E,v:y},N&&(i.z=N))})}),u.e.c=Math.max(u.e.c,l+f.length-1);var v=Ma(s);if(n)for(h=0;h<f.length;++h)o[va(h+l)+v]={t:"s",v:f[h]};return o["!ref"]=mr(u),o}function QL(t,r){return P4(null,t,r)}function Bu(t,r,e){if(typeof r=="string"){if(Array.isArray(t)){var a=Ja(r);return t[a.r]||(t[a.r]=[]),t[a.r][a.c]||(t[a.r][a.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return typeof r!="number"?Bu(t,Qt(r)):Bu(t,Qt({r,c:e||0}))}function eB(t,r){if(typeof r=="number"){if(r>=0&&t.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var e=t.SheetNames.indexOf(r);if(e>-1)return e;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function d1(){return{SheetNames:[],Sheets:{}}}function f1(t,r,e,a){var n=1;if(!e)for(;n<=65535&&t.SheetNames.indexOf(e="Sheet"+n)!=-1;++n,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&t.SheetNames.indexOf(e)>=0){var o=e.match(/(^.*?)(\d+)$/);n=o&&+o[2]||0;var s=o&&o[1]||e;for(++n;n<=65535&&t.SheetNames.indexOf(e=s+n)!=-1;++n);}if(LP(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=r,e}function tB(t,r,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var a=eB(t,r);switch(t.Workbook.Sheets[a]||(t.Workbook.Sheets[a]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[a].Hidden=e}function rB(t,r){return t.z=r,t}function L4(t,r,e){return r?(t.l={Target:r},e&&(t.l.Tooltip=e)):delete t.l,t}function aB(t,r,e){return L4(t,"#"+r,e)}function nB(t,r,e){t.c||(t.c=[]),t.c.push({t:r,a:e||"SheetJS"})}function sB(t,r,e,a){for(var n=typeof r!="string"?r:Yr(r),o=typeof r=="string"?r:mr(r),s=n.s.r;s<=n.e.r;++s)for(var l=n.s.c;l<=n.e.c;++l){var c=Bu(t,s,l);c.t="n",c.F=o,delete c.v,s==n.s.r&&l==n.s.c&&(c.f=e,a&&(c.D=!0))}return t}var Yy={encode_col:va,encode_row:Ma,encode_cell:Qt,encode_range:mr,decode_col:Zm,decode_row:Km,split_cell:vO,decode_cell:Ja,decode_range:ac,format_cell:ii,sheet_add_aoa:$_,sheet_add_json:P4,sheet_add_dom:D4,aoa_to_sheet:nc,json_to_sheet:QL,table_to_sheet:M4,table_to_book:_L,sheet_to_csv:F4,sheet_to_txt:ZL,sheet_to_json:om,sheet_to_html:wL,sheet_to_formulae:JL,sheet_to_row_object_array:om,sheet_get_cell:Bu,book_new:d1,book_append_sheet:f1,book_set_sheet_visibility:tB,cell_set_number_format:rB,cell_set_hyperlink:L4,cell_set_internal_link:aB,cell_add_comment:nB,sheet_set_array_formula:sB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Xy={"CNPJ Destinatrio":{dbField:"cnpj_destinatario",visible:!1,type:"string"},Destinatrio:{dbField:"destinatario",visible:!1,type:"string"},"Cidade Destino":{dbField:"cidade_destino",visible:!1,type:"string"},"UF Destino":{dbField:"uf_destino",visible:!1,type:"string"},"CNPJ Emitente":{dbField:"cnpj_emitente",visible:!1,type:"string"},"Nome PJ Emitente":{dbField:"nome_pj_emitente",visible:!1,type:"string"},"Chave de Acesso":{dbField:"chave_acesso",visible:!1,type:"string"},Srie:{dbField:"serie",visible:!1,type:"string"},Tipo:{dbField:"tipo",visible:!1,type:"string"},Status:{dbField:"status_nfe",visible:!1,type:"string"},"Nome ou e-mail do usurio que fez a sincronizao":{dbField:"nome_usuario_sync",visible:!1,type:"string"},"Data da sincronizao":{dbField:"data_sync",visible:!1,type:"date"},"Natureza Operao":{dbField:"natureza_operacao",visible:!1,type:"string"},"CFOPs da Nota":{dbField:"cfops",visible:!1,type:"string"},Etiquetas:{dbField:"etiquetas",visible:!1,type:"string"},"Nome Filial":{dbField:"nome_filial",visible:!0,type:"string"},FILIAL:{dbField:"nome_filial",visible:!0,type:"string"},"Nome Cliente":{dbField:"nome_cliente",visible:!0,type:"string"},"Cidade Origem":{dbField:"cidade_origem",visible:!0,type:"string"},"UF Origem":{dbField:"uf_origem",visible:!0,type:"string"},"Data Emisso":{dbField:"data_emissao",visible:!0,type:"date"},Nmero:{dbField:"numero",visible:!0,type:"string"},"Valor Total da Nota":{dbField:"valor_total_nota",visible:!0,type:"number"},"Peso lquido":{dbField:"peso_liquido",visible:!0,type:"number"},"Sincronizao ERP":{dbField:"sincronizacao_erp",visible:!0,type:"string"},"Finalidade NFe":{dbField:"finalidade_nfe",visible:!0,type:"string"},"Dados Adicionais":{dbField:"dados_adicionais",visible:!0,type:"string"},Vendedor:{dbField:"vendedor",visible:!0,type:"string"},Motivo:{dbField:"motivo",visible:!0,type:"string"},Resultado:{dbField:"resultado",visible:!0,type:"string"},"[Item] Descrio":{dbField:"item_description",visible:!0,type:"string"},"[Item] Unidade":{dbField:"item_unit",visible:!0,type:"string"},"[Item] Quantidade":{dbField:"item_quantity",visible:!0,type:"number"},"[Item] Valor Unitrio":{dbField:"item_unit_value",visible:!0,type:"number"},"[Item] Valor Total Bruto":{dbField:"item_total_value",visible:!0,type:"number"},"[Item] Nmero do Item.":{dbField:"item_number",visible:!0,type:"string"}};function iB(){const[t,r]=Se.useState(null),[e,a]=Se.useState([]),[n,o]=Se.useState(!1),s=h=>{if(h.target.files&&h.target.files[0]){const v=h.target.files[0];r(v),l(v)}},l=async h=>{const v=new FileReader;v.onload=async b=>{var x;const g=(x=b.target)==null?void 0:x.result;if(g){const y=Bf(g,{type:"binary",cellDates:!0}),E=y.SheetNames[0],N=y.Sheets[E],I=Yy.sheet_to_json(N),P=I.map(W=>String(W["CNPJ Emitente"]||"")).filter(W=>W&&W.trim()!=="");let V=new Map,U=new Map;const H=W=>W?W.replace(/[^\d]/g,""):"";if(P.length>0){const{data:W}=await St.from("clientes").select("cnpj_cpf, nome, vendedor, rede, uf, municipio");W&&W.forEach(O=>{const R=H(O.cnpj_cpf||"");R&&R.length>=11&&V.set(R,O)})}const{data:G}=await St.from("emitentes").select("cnpj, nome_fantasia");G&&G.forEach(W=>{const O=H(W.cnpj||"");if(O&&O.length>=11){const R=W.nome_fantasia||"";U.set(O,R)}});const Z=I.slice(0,10).map(W=>{const O={...W};O["Data Emisso"]instanceof Date&&(O["Data Emisso"]=O["Data Emisso"].toLocaleDateString("pt-BR"));const R=String(W["CNPJ Emitente"]||""),C=H(R),_=C.length>=11?V.get(C):null;_?(O["Nome Cliente"]=_.nome||"",O.Vendedor=_.vendedor||""):(O["Nome Cliente"]="",O.Vendedor="");const k=String(W["CNPJ Destinatrio"]||""),A=H(k);if(A&&A.length>=11){const T=U.get(A);T&&T.trim()!==""?(O["Nome Filial"]=T,O.FILIAL=T):(O["Nome Filial"]="",O.FILIAL="")}else O["Nome Filial"]="",O.FILIAL="";return O});a(Z)}},v.readAsBinaryString(h)},c=h=>h?String(h).replace(/[.\-\/\s]/g,"").trim():"",i=h=>{if(typeof h=="number"&&!isNaN(h))return h;if(h==null||h==="")return null;let v=String(h).trim();if(v==="")return null;v=v.replace(/\s/g,""),v.includes(",")&&(v=v.replace(/\./g,""),v=v.replace(",","."));const b=parseFloat(v);return isNaN(b)?null:b},u=async()=>{const h=new Map;try{const{data:v,error:b}=await St.from("clientes").select("nome, razao_social, cnpj_cpf, vendedor, rede").not("cnpj_cpf","is",null);if(b)return console.error("Erro ao buscar clientes:",b),h;v&&v.length>0&&v.forEach(g=>{if(g.cnpj_cpf){const x=c(g.cnpj_cpf);if(x&&x.length>=11){const y=g.nome||g.razao_social||"";h.set(x,{nome:y,vendedor:g.vendedor||"",rede:g.rede||""})}}})}catch(v){console.error("Erro ao carregar clientes:",v)}return h},p=async()=>{if(t){o(!0);try{const h=new FileReader;h.onload=async v=>{var Z,W,O;const b=(Z=v.target)==null?void 0:Z.result,g=Bf(b,{type:"binary",cellDates:!0}),x=g.Sheets[g.SheetNames[0]],y=Yy.sheet_to_json(x),E=new Map;for(const R of y){const C=R.Nmero;if(!C)continue;if(!E.has(C)){let A=new Date().toISOString();if(R["Data Emisso"])if(R["Data Emisso"]instanceof Date)A=R["Data Emisso"].toISOString();else{const T=new Date(R["Data Emisso"]);isNaN(T.getTime())||(A=T.toISOString())}E.set(C,{invoice_number:String(C),customer_cnpj:String(R["CNPJ Destinatrio"]||""),destinatario:String(R.Destinatrio||""),cidade_origem:String(R["Cidade Origem"]||""),uf_origem:String(R["UF Origem"]||""),cidade_destino:String(R["Cidade Destino"]||""),uf_destino:String(R["UF Destino"]||""),cnpj_emitente:String(R["CNPJ Emitente"]||""),nome_pj_emitente:String(R["Nome PJ Emitente"]||""),chave_acesso:String(R["Chave de Acesso"]||""),serie:String(R.Srie||""),peso_liquido:i(R["Peso lquido"])||0,tipo:String(R.Tipo||""),status_nfe:String(R.Status||""),sincronizacao_erp:String(R["Sincronizao ERP"]||""),finalidade_nfe:String(R["Finalidade NFe"]||""),natureza_operacao:String(R["Natureza Operao"]||""),cfops:String(R["CFOPs da Nota"]||""),dados_adicionais:String(R["Dados Adicionais"]||""),nfe_referenciada:String(R["NFe Referenciada"]||""),etiquetas:String(R.Etiquetas||""),invoice_date:A,total_value:0,motivo_id:null,sector_id:null,items:[]})}const _=E.get(C),k=i(R["[Item] Valor Total Bruto"])||0;_.total_value+=k,_.items.push({description:R["[Item] Descrio"],quantity:i(R["[Item] Quantidade"])||0,unit:R["[Item] Unidade"],unit_value:i(R["[Item] Valor Unitrio"])||0,total_value:i(k)||0,item_number:String(R["[Item] Nmero do Item."]||"")})}let N=0,I=0;const P=Array.from(E.values()),V=await u(),U=new Map;try{const{data:R}=await St.from("emitentes").select("cnpj, nome_fantasia").not("cnpj","is",null);R&&R.forEach(C=>{if(C.cnpj){const _=c(C.cnpj);if(_&&_.length>=11){const k=C.nome_fantasia||"";U.set(_,k)}}})}catch(R){console.error("Erro ao carregar emitentes:",R)}const{data:H}=await St.from("devolucoes").select("chave_acesso").not("chave_acesso","is",null),G=new Set((H||[]).map(R=>R.chave_acesso).filter(R=>R&&R.trim()!==""));for(const R of P){if(R.chave_acesso&&R.chave_acesso.trim()!==""&&G.has(R.chave_acesso)){console.log(`Chave de acesso duplicada ignorada: ${R.chave_acesso}`),I++;continue}const C=String(R.sincronizacao_erp||"").trim().toUpperCase();if(C==="SINCRONIZADO"||C==="SIM"||C==="S"){console.log(`Registro descartado - j sincronizado: ${R.invoice_number} (Chave: ${R.chave_acesso})`),I++;continue}let _="",k="",A="";if(R.cnpj_emitente){const F=c(R.cnpj_emitente);if(F&&F.length>=11){const Y=V.get(F);Y&&(_=Y.nome||"",k=Y.vendedor||"",A=Y.rede||"")}}let T="";if(R.customer_cnpj){const F=c(R.customer_cnpj);if(F&&F.length>=11){const Y=U.get(F);Y&&Y.trim()!==""&&(T=Y)}}const{data:D,error:B}=await St.from("devolucoes").insert({numero:R.invoice_number,nome_cliente:_,cnpj_destinatario:R.customer_cnpj,destinatario:R.destinatario,cidade_origem:R.cidade_origem,uf_origem:R.uf_origem,cidade_destino:R.cidade_destino,uf_destino:R.uf_destino,cnpj_emitente:R.cnpj_emitente,nome_pj_emitente:R.nome_pj_emitente,chave_acesso:R.chave_acesso||null,serie:R.serie,peso_liquido:i(R.peso_liquido),tipo:R.tipo,status_nfe:R.status_nfe,sincronizacao_erp:R.sincronizacao_erp,finalidade_nfe:R.finalidade_nfe,natureza_operacao:R.natureza_operacao,cfops:R.cfops,dados_adicionais:R.dados_adicionais,nfe_referenciada:R.nfe_referenciada,etiquetas:R.etiquetas,nome_filial:T,data_emissao:R.invoice_date,valor_total_nota:i(R.total_value)||0,vendedor:k,rede:A,resultado:"PENDENTE VALIDAO",motivo_id:R.reason_id,setor_id:R.sector_id}).select().single();if(B){if(B.code==="23505"||(W=B.message)!=null&&W.includes("unique")||(O=B.message)!=null&&O.includes("duplicate")){console.log(`Chave de acesso duplicada ignorada (constraint): ${R.chave_acesso}`),I++;continue}console.error("Erro ao inserir devoluo:",B);continue}if(D){R.chave_acesso&&R.chave_acesso.trim()!==""&&G.add(R.chave_acesso);const F=R.items.map(X=>({devolucao_id:D.id,descricao:X.description,quantidade:i(X.quantity)||0,unidade:X.unit,valor_unitario:i(X.unit_value)||0,valor_total_bruto:i(X.total_value)||0,numero_item:X.item_number})),{error:Y}=await St.from("itens_devolucao").insert(F);Y||N++}}if(N>0){let R=`${N} devoluo(es) importada(s) com sucesso!`;I>0&&(R+=` ${I} registro(s) ignorado(s) (duplicados ou j sincronizados).`),wt.success(R)}else I>0?wt.warning(`${I} registro(s) ignorado(s) (duplicados ou j sincronizados). Nenhuma devoluo nova foi importada.`):wt.warning("Nenhuma devoluo importada. Verifique o arquivo.");o(!1),r(null),a([])},h.readAsBinaryString(t)}catch(h){console.error(h),wt.error("Erro crtico ao processar arquivo"),o(!1)}}},f=Object.keys(Xy).filter(h=>Xy[h].visible);return w.jsxs("div",{className:"space-y-6",children:[w.jsx(Qi,{title:"Sincronizao",description:"Importe arquivos CSV ou XLSX para sincronizar devolues. O sistema busca automaticamente dados de clientes e filiais."}),w.jsx("div",{className:"grid gap-6 md:grid-cols-1",children:w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Importar Arquivo"}),w.jsx(Cr,{children:"Faa upload de arquivos CSV ou XLSX. O sistema identificar automaticamente os Motivos, Setores e buscar o nome do cliente na base de dados usando o CNPJ."})]}),w.jsxs(jt,{children:[w.jsxs("div",{className:"flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-10 hover:bg-muted/50 transition-colors relative",children:[w.jsx(_r,{type:"file",accept:".csv, .xlsx, .xls",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:s}),w.jsx(TS,{className:"h-10 w-10 text-muted-foreground mb-4"}),w.jsx("p",{className:"text-sm font-medium mb-1",children:t?t.name:"Arraste e solte ou clique para selecionar"}),w.jsx("p",{className:"text-xs text-muted-foreground",children:"Suporta .csv e .xlsx"})]}),e.length>0&&w.jsxs("div",{className:"mt-6 space-y-4",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("h3",{className:"text-sm font-semibold",children:"Pr-visualizao"}),w.jsxs(Ot,{onClick:p,disabled:n,children:[n&&w.jsx(oi,{className:"mr-2 h-4 w-4 animate-spin"}),"Confirmar e Processar"]})]}),w.jsx("div",{className:"overflow-x-auto rounded-md border",children:w.jsxs(Ba,{children:[w.jsx(Za,{children:w.jsx(dr,{children:f.map(h=>w.jsx(Tt,{className:"whitespace-nowrap",children:h},h))})}),w.jsx(Ua,{children:e.map((h,v)=>w.jsx(dr,{children:f.map(b=>w.jsx(Pt,{className:"whitespace-nowrap",children:h[b]},`${v}-${b}`))},v))})]})}),w.jsxs("div",{className:"flex items-center gap-2 text-xs text-amber-600 bg-amber-50 p-2 rounded border border-amber-200",children:[w.jsx(Rl,{className:"h-4 w-4"}),w.jsx("span",{children:'Certifique-se de que os nomes dos "Motivos" no Excel correspondam exatamente aos cadastrados em Configuraes para que os grficos funcionem.'})]})]})]})]})})]})}const lm=Se.forwardRef(({className:t,...r},e)=>w.jsx("textarea",{className:Et("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:e,...r}));lm.displayName="Textarea";const Ky=["PENDENTE VALIDAO","VALIDADA","LANADA","TRATATIVA DE ANULAO","ANULADA/CANCELADA"],Zy={"PENDENTE VALIDAO":"bg-red-500 hover:bg-red-600 text-white",VALIDADA:"bg-blue-500 hover:bg-blue-600 text-white",LANADA:"bg-green-500 hover:bg-green-600 text-white","TRATATIVA DE ANULAO":"bg-orange-500 hover:bg-orange-600 text-white","ANULADA/CANCELADA":"bg-black hover:bg-gray-900 text-white"},Dl={"PENDENTE VALIDAO":1,VALIDADA:2,LANADA:3,"TRATATIVA DE ANULAO":4,"ANULADA/CANCELADA":5};function oB(t){return t.trim().split(/\s+/).filter(r=>r.length>0).length}function lB(){const[t,r]=Se.useState([]),[e,a]=Se.useState([]),[n,o]=Se.useState(!0),[s,l]=Se.useState([]),[c,i]=Se.useState({}),[u,p]=Se.useState({}),[f,h]=Se.useState(1),[v,b]=Se.useState(null),[g,x]=Se.useState(null),[y,E]=Se.useState(new Set),[N,I]=Se.useState(null),[P,V]=Se.useState(null),[U,H]=Se.useState(!1),[G,Z]=Se.useState(!1),[W,O]=Se.useState({nfPendentes:0,totalPendente:0,nfValidadas:0,totalValidadas:0,nfCancelamento:0,totalCancelamento:0,nfAtraso:0,totalAtraso:0}),{user:R}=Oa(),{filters:C}=ec(),_=100;Se.useEffect(()=>{k(),A(),b(null),x(null),h(1)},[C]);const k=async()=>{try{const{data:Q,error:fe}=await St.from("motivos_devolucao").select("id, nome, sector_id").order("nome");if(fe){console.error("Erro ao buscar motivos:",fe),wt.error("Erro ao carregar motivos");return}if(!Q||Q.length===0){console.warn("Nenhum motivo encontrado"),l([]);return}const le=Q.map(he=>he.sector_id).filter(he=>he!==null);let ne={};if(le.length>0){const{data:he}=await St.from("setores").select("id, nome").in("id",le);he&&(ne=he.reduce((ke,pe)=>(ke[pe.id]=pe.nome,ke),{}))}const ue=Q.map(he=>({...he,setores:he.sector_id?{nome:ne[he.sector_id]||""}:null}));console.log("Motivos carregados:",ue.length),l(ue)}catch(Q){console.error("Erro ao buscar motivos:",Q),wt.error("Erro ao carregar motivos")}},A=async()=>{o(!0);const Q=(R==null?void 0:R.role)==="VENDEDOR"?R.vendedor:null;let fe=St.from("devolucoes").select(`
            *,
            itens:itens_devolucao(*, motivo_item:motivos_devolucao(id, nome)),
            setores:setores(nome),
            motivos_devolucao:motivos_devolucao(id, nome, setores:setores(nome))
        `);R&&R.role==="VENDEDOR"&&Q&&(fe=fe.eq("vendedor",Q),console.log(" Validao - Filtrando por vendedor:",Q));const le=C.period&&!C.startDate&&!C.endDate?ju(C.period):{},ne=C.startDate||le.startDate,ue=C.endDate||le.endDate;C.search&&(fe=fe.or(`nome_cliente.ilike.%${C.search}%,vendedor.ilike.%${C.search}%,numero.ilike.%${C.search}%`)),C.resultado&&C.resultado.length>0&&(fe=fe.in("resultado",C.resultado)),C.motivo&&C.motivo.length>0&&(fe=fe.in("motivo_id",C.motivo)),C.cliente&&C.cliente.length>0&&(fe=fe.in("nome_cliente",C.cliente)),C.vendedor&&C.vendedor.length>0&&(fe=fe.in("vendedor",C.vendedor));let he=[];if(C.setor&&C.setor.length>0){const{data:Ce}=await St.from("motivos_devolucao").select("id").in("sector_id",C.setor);he=(Ce==null?void 0:Ce.map(Me=>Me.id))||[],fe=fe.in("setor_id",C.setor)}if(ne){const Ce=new Date(ne);Ce.setHours(0,0,0,0);const Me=new Date(Ce.getTime()-3*60*60*1e3);fe=fe.gte("data_emissao",Me.toISOString().split("T")[0])}if(ue){const Ce=new Date(ue);Ce.setHours(23,59,59,999);const Me=new Date(Ce.getTime()-3*60*60*1e3);fe=fe.lte("data_emissao",Me.toISOString().split("T")[0])}const{data:ke,error:pe}=await fe.order("created_at",{ascending:!1});if(pe)wt.error("Erro ao carregar devolues"),console.error(pe);else if(ke){let Ce=ke;C.setor&&C.setor.length>0&&he.length>0&&(Ce=ke.filter(He=>{const Ue=He.setor_id&&C.setor.includes(He.setor_id),bt=He.motivo_id&&he.includes(He.motivo_id);return Ue||bt}));const Me=Ce.filter(He=>He.resultado==="PENDENTE VALIDAO"||He.resultado==="VALIDADA"||He.resultado==="TRATATIVA DE ANULAO"),Ie=Me.map(He=>He.cnpj_destinatario).filter(He=>He&&He.trim()!=="");let Ye=new Map;if(Ie.length>0){const{data:He}=await St.from("clientes").select("cnpj_cpf, nome, vendedor, rede, uf, municipio").in("cnpj_cpf",Ie);He&&He.forEach(Ue=>{Ye.set(Ue.cnpj_cpf,Ue)})}const at=Me.map(He=>He.id);let rt=new Map;if(at.length>0){const{data:He}=await St.from("logs_validacao").select(`
              devolucao_id,
              status_novo,
              usuario_id
            `).in("devolucao_id",at).order("created_at",{ascending:!1});if(He){const Ue=[...new Set(He.map(tt=>tt.usuario_id).filter(Boolean))],bt=new Map;if(Ue.length>0){const{data:tt}=await St.from("profiles").select("id, name").in("id",Ue);tt&&tt.forEach(dt=>{bt.set(dt.id,dt.name)})}He.forEach(tt=>{const dt=`${tt.devolucao_id}_${tt.status_novo}`;if(!rt.has(dt)){const ut=bt.get(tt.usuario_id);ut&&rt.set(dt,ut)}})}}const et=Me.map(He=>{var xt,At,Kt;const Ue=Ye.get(He.cnpj_destinatario),bt=(xt=He.itens)==null?void 0:xt.map(yt=>{var Ct;return yt.id||console.warn("Item sem ID:",yt),{...yt,id:yt.id,motivo_id:yt.motivo_id||null,motivo_nome:((Ct=yt.motivo_item)==null?void 0:Ct.nome)||"-"}}),tt=He.resultado||"PENDENTE VALIDAO";let dt="-";if(tt!=="PENDENTE VALIDAO"){const yt=`${He.id}_${tt}`;dt=rt.get(yt)||"-"}let ut=null;if(He.data_emissao)try{const yt=new Date,Ct=-3*60,Ft=yt.getTime()+yt.getTimezoneOffset()*6e4,kt=new Date(Ft+Ct*6e4);kt.setHours(0,0,0,0);const Ae=new Date(He.data_emissao);Ae.setHours(0,0,0,0),ut=cN(Ae,kt)}catch(yt){console.warn("Erro ao calcular dias:",yt),ut=He.dias}let vt=He.prazo;if(tt==="LANADA"||tt==="ANULADA/CANCELADA")vt="FINALIZADO";else if(tt==="TRATATIVA DE ANULAO")vt="TRATANDO";else if(tt==="VALIDADA")vt="CONCLUIDO";else if(tt==="PENDENTE VALIDAO"){const yt=ut!==null?ut:He.dias;yt!=null&&(yt>=3?vt="EM ATRASO":vt="NO PRAZO")}return{...He,setor:(At=He.setores)==null?void 0:At.nome,motivo:typeof He.motivos_devolucao=="object"&&((Kt=He.motivos_devolucao)!=null&&Kt.nome)?He.motivos_devolucao.nome:typeof He.motivos_devolucao=="string"?He.motivos_devolucao:"-",motivo_id:He.motivo_id,resultado:tt,itens:bt,nome_validador:dt,prazo:vt,dias:ut!==null?ut:He.dias,nome_cliente:(Ue==null?void 0:Ue.nome)||He.nome_cliente||"Cliente no encontrado",vendedor:(Ue==null?void 0:Ue.vendedor)||He.vendedor||"-",rede:(Ue==null?void 0:Ue.rede)||He.rede||"-",uf_destino:(Ue==null?void 0:Ue.uf)||He.uf_destino||"-",cidade_destino:(Ue==null?void 0:Ue.municipio)||He.cidade_destino||"-"}}).sort((He,Ue)=>{const bt=Dl[He.resultado]||999,tt=Dl[Ue.resultado]||999;if(bt!==tt)return bt-tt;const dt=He.data_emissao?new Date(He.data_emissao).getTime():0;return(Ue.data_emissao?new Date(Ue.data_emissao).getTime():0)-dt});a(et);const st=et.filter(He=>He.resultado==="PENDENTE VALIDAO").length,je=et.filter(He=>He.resultado==="PENDENTE VALIDAO").reduce((He,Ue)=>He+(Number(Ue.valor_total_nota)||0),0),ht=et.filter(He=>He.resultado==="VALIDADA").length,Je=et.filter(He=>He.resultado==="VALIDADA").reduce((He,Ue)=>He+(Number(Ue.valor_total_nota)||0),0),nt=et.filter(He=>He.resultado==="TRATATIVA DE ANULAO").length,ct=et.filter(He=>He.resultado==="TRATATIVA DE ANULAO").reduce((He,Ue)=>He+(Number(Ue.valor_total_nota)||0),0),_t=et.filter(He=>He.prazo==="EM ATRASO").length,mt=et.filter(He=>He.prazo==="EM ATRASO").reduce((He,Ue)=>He+(Number(Ue.valor_total_nota)||0),0);O({nfPendentes:st,totalPendente:je,nfValidadas:ht,totalValidadas:Je,nfCancelamento:nt,totalCancelamento:ct,nfAtraso:_t,totalAtraso:mt});const gt={};et.forEach(He=>{gt[He.id]=He.justificativa||""}),i(gt)}o(!1)};Se.useEffect(()=>{if(e.length===0)return;let Q=[...e];v&&g?Q=[...e].sort((ne,ue)=>{let he,ke;switch(v){case"data_emissao":he=ne.data_emissao?new Date(ne.data_emissao).getTime():0,ke=ue.data_emissao?new Date(ue.data_emissao).getTime():0;break;case"numero":const pe=parseInt(ne.numero||"0",10)||0,Ce=parseInt(ue.numero||"0",10)||0;pe!==0||Ce!==0?(he=pe,ke=Ce):(he=(ne.numero||"").toLowerCase(),ke=(ue.numero||"").toLowerCase());break;case"nome_cliente":he=(ne.nome_cliente||"").toLowerCase(),ke=(ue.nome_cliente||"").toLowerCase();break;case"vendedor":he=(ne.vendedor||"").toLowerCase(),ke=(ue.vendedor||"").toLowerCase();break;case"motivo":he=(ne.motivo||"").toLowerCase(),ke=(ue.motivo||"").toLowerCase();break;case"valor_total_nota":he=parseFloat(ne.valor_total_nota||0),ke=parseFloat(ue.valor_total_nota||0);break;case"dias":he=ne.dias!==null&&ne.dias!==void 0?ne.dias:-1,ke=ue.dias!==null&&ue.dias!==void 0?ue.dias:-1;break;case"prazo":he=(ne.prazo||"").toLowerCase(),ke=(ue.prazo||"").toLowerCase();break;case"resultado":he=Dl[ne.resultado]||999,ke=Dl[ue.resultado]||999;break;default:return 0}return he<ke?g==="asc"?-1:1:he>ke?g==="asc"?1:-1:0}):Q=[...e].sort((ne,ue)=>{const he=Dl[ne.resultado]||999,ke=Dl[ue.resultado]||999;if(he!==ke)return he-ke;const pe=ne.data_emissao?new Date(ne.data_emissao).getTime():0;return(ue.data_emissao?new Date(ue.data_emissao).getTime():0)-pe});const fe=(f-1)*_,le=fe+_;r(Q.slice(fe,le))},[v,g,e,f]);const T=Q=>{v===Q?g==="asc"?x("desc"):g==="desc"&&(b(null),x(null)):(b(Q),x("asc")),h(1)},D=({field:Q})=>v!==Q?w.jsx(O2,{className:"ml-1 h-4 w-4 opacity-50"}):g==="asc"?w.jsx(D2,{className:"ml-1 h-4 w-4"}):w.jsx(j2,{className:"ml-1 h-4 w-4"}),B=async(Q,fe)=>{if(!R)return;const le=fe;if(!Ky.includes(le)){console.error("Resultado invlido:",fe),wt.error("Resultado invlido");return}try{if(le==="LANADA"){const{data:at,error:rt}=await St.from("devolucoes").select(`
              *,
              itens:itens_devolucao(id, motivo_id)
            `).eq("id",Q).single();if(rt)throw console.error("Erro ao buscar devoluo:",rt),rt;if(!at.motivo_id){wt.error("No  possvel lanar a nota sem o motivo principal preenchido.");return}if(at.itens&&at.itens.length>0){const it=at.itens.filter(et=>!et.motivo_id);if(it.length>0){wt.error(`No  possvel lanar a nota. ${it.length} item(ns) ainda no possui(m) motivo preenchido.`);return}}}const{data:ne,error:ue}=await St.from("devolucoes").select("resultado").eq("id",Q).single();if(ue)throw console.error("Erro ao buscar resultado atual:",ue),ue;const he=(ne==null?void 0:ne.resultado)||"PENDENTE VALIDAO";if(he===le)return;let ke=null;le==="LANADA"||le==="ANULADA/CANCELADA"?ke="FINALIZADO":le==="TRATATIVA DE ANULAO"?ke="TRATANDO":le==="VALIDADA"?ke="CONCLUIDO":le==="PENDENTE VALIDAO"&&(ke=null);const pe={resultado:le};ke&&(pe.prazo=ke);const Ce=R.name||R.email||"-";(le==="VALIDADA"||le==="TRATATIVA DE ANULAO")&&he==="PENDENTE VALIDAO"&&(pe.nome_validador=Ce,pe.data_validacao=new Date().toISOString()),(le==="LANADA"||le==="ANULADA/CANCELADA")&&(pe.finalizada_por=Ce,pe.data_finalizacao=new Date().toISOString());const{error:Me}=await St.from("devolucoes").update(pe).eq("id",Q);if(Me)throw Me;const{error:Ie}=await St.from("logs_validacao").insert({devolucao_id:Q,usuario_id:R.id,acao:"ALTERAR_RESULTADO",status_anterior:he,status_novo:le});Ie&&console.error("Erro ao salvar log:",Ie),wt.success(`Resultado alterado para: ${le}`);let Ye=null;if(le==="LANADA"||le==="ANULADA/CANCELADA"?Ye="FINALIZADO":le==="TRATATIVA DE ANULAO"?Ye="TRATANDO":le==="VALIDADA"&&(Ye="CONCLUIDO"),le==="LANADA"||le==="ANULADA/CANCELADA")r(at=>at.filter(rt=>rt.id!==Q)),a(at=>at.filter(rt=>rt.id!==Q));else{const at=rt=>rt.id===Q?{...rt,resultado:le,nome_validador:le!=="PENDENTE VALIDAO"&&(R.name||R.email)||"-",prazo:Ye||rt.prazo}:rt;r(rt=>rt.map(at)),a(rt=>rt.map(at))}}catch(ne){wt.error("Erro ao processar: "+ne.message)}},F=async(Q,fe)=>{if(R)try{const{data:le}=await St.from("devolucoes").select("resultado").eq("id",Q).single(),ne=(le==null?void 0:le.resultado)||"PENDENTE VALIDAO",{data:ue}=await St.from("itens_devolucao").select("id").eq("devolucao_id",Q);if(ue&&ue.length>0)for(const Me of ue){const{error:Ie}=await St.from("itens_devolucao").update({motivo_id:fe}).eq("id",Me.id);if(Ie)throw console.error("Erro ao atualizar item:",Ie),Ie}const he={motivo_id:fe,resultado:"VALIDADA",prazo:"CONCLUIDO",nome_validador:R.name||R.email||"-"};ne==="PENDENTE VALIDAO"&&(he.data_validacao=new Date().toISOString());const{error:ke}=await St.from("devolucoes").update(he).eq("id",Q);if(ke)throw ke;const{error:pe}=await St.from("logs_validacao").insert({devolucao_id:Q,usuario_id:R.id,acao:"SELECIONAR_MOTIVO",status_anterior:ne,status_novo:"VALIDADA"});pe&&console.error("Erro ao salvar log:",pe),wt.success("Motivo aplicado a todos os produtos e resultado alterado para VALIDADA!");const Ce=Me=>{var Ie,Ye;return Me.id===Q?{...Me,motivo_id:fe,resultado:"VALIDADA",nome_validador:R.name||R.email||"-",prazo:"CONCLUIDO",motivo:((Ie=s.find(at=>at.id===fe))==null?void 0:Ie.nome)||Me.motivo,itens:(Ye=Me.itens)==null?void 0:Ye.map(at=>({...at,motivo_id:fe}))}:Me};r(Me=>Me.map(Ce)),a(Me=>Me.map(Ce))}catch(le){wt.error("Erro ao processar: "+le.message)}},Y=(Q,fe)=>{i(le=>({...le,[Q]:fe}))},X=Q=>oB(Q)>100?(wt.warning("Mximo de 100 palavras permitido"),!1):!0,re=async Q=>{if(R&&X(c[Q]||"")){p(fe=>({...fe,[Q]:!0}));try{const{error:fe}=await St.from("devolucoes").update({justificativa:c[Q]||null}).eq("id",Q);if(fe)throw fe;wt.success("Comentrio salvo com sucesso!"),await St.from("logs_validacao").insert({devolucao_id:Q,usuario_id:R.id,acao:"ADICIONAR_COMENTARIO",status_anterior:null,status_novo:null})}catch(fe){wt.error("Erro ao salvar comentrio: "+fe.message)}finally{p(fe=>({...fe,[Q]:!1}))}}},z=async(Q,fe,le)=>{var he;if(!R){console.error("Usurio no autenticado");return}if(!fe||fe.trim()===""){console.log("Motivo vazio, ignorando...");return}if(!Q||!le){console.error("IDs invlidos:",{itemId:Q,devolucaoId:le,tipoItemId:typeof Q,tipoDevolucaoId:typeof le}),wt.error("Erro: IDs invlidos. Verifique o console para mais detalhes.");return}const ne=String(Q).trim(),ue=String(le).trim();if(!ne||ne==="undefined"||ne==="null"){console.error("itemId invlido aps converso:",{itemId:Q,itemIdString:ne}),wt.error("Erro: ID do produto invlido");return}try{const ke=R.name||R.email||"-";console.log("Salvando motivo:",{itemId:ne,motivoId:fe,devolucaoId:ue});const{data:pe,error:Ce}=await St.from("itens_devolucao").select("id, motivo_id, devolucao_id").eq("id",ne).single();if(Ce)throw console.error("Erro ao verificar item:",Ce),wt.error("Erro: Item no encontrado no banco de dados. Verifique o console."),Ce;if(!pe){console.error("Item no encontrado:",ne),wt.error("Erro: Item no encontrado");return}if(console.log("Item encontrado:",pe),pe.devolucao_id!==ue){console.error("Item no pertence  devoluo:",{itemDevolucaoId:pe.devolucao_id,devolucaoIdEsperado:ue}),wt.error("Erro: Item no pertence  devoluo correta");return}console.log("Tentando atualizar item:",{itemIdString:ne,motivoId:fe});const{data:Me,error:Ie}=await St.from("itens_devolucao").update({motivo_id:fe}).eq("id",ne).select("id, motivo_id");if(console.log("Resultado do update:",{updatedItem:Me,error:Ie}),Ie)throw console.error("Erro ao salvar motivo no Supabase:",Ie),wt.error("Erro ao salvar motivo: "+Ie.message),Ie;Me&&Me.length>0&&Me[0].motivo_id===fe?console.log(" Motivo salvo com sucesso! Item atualizado:",Me[0]):console.warn(" Update pode no ter funcionado completamente, verificando..."),await new Promise(gt=>setTimeout(gt,500));let Ye=null,at=0;const rt=5;for(;at<rt;){const{data:gt,error:He}=await St.from("itens_devolucao").select("id, motivo_id, devolucao_id").eq("id",ne).single();if(He){if(console.error(`Erro ao verificar item (tentativa ${at+1}):`,He),at===rt-1){console.warn("No foi possvel verificar o item aps todas as tentativas");break}}else if(gt&&(Ye=gt,console.log(`Item verificado (tentativa ${at+1}):`,Ye),Ye.motivo_id===fe)){console.log(" Motivo confirmado no banco de dados!");break}at<rt-1&&await new Promise(Ue=>setTimeout(Ue,300)),at++}if(!Ye||Ye.motivo_id!==fe){console.error(" Update no funcionou aps todas as tentativas!",{esperado:fe,atual:(Ye==null?void 0:Ye.motivo_id)||"null",itemVerificado:Ye}),wt.error("Erro: No foi possvel salvar o motivo. Pode ser um problema de permisses no banco de dados.");return}const it=gt=>{var Ue;return{itensAtualizados:(Ue=gt.itens)==null?void 0:Ue.map(bt=>String(bt.id)===ne?{...bt,motivo_id:fe}:bt)}};r(gt=>gt.map(He=>{if(String(He.id)!==ue)return He;const Ue=it(He);return{...He,itens:Ue.itensAtualizados}})),a(gt=>gt.map(He=>{if(String(He.id)!==ue)return He;const Ue=it(He);return{...He,itens:Ue.itensAtualizados}})),await new Promise(gt=>setTimeout(gt,500));let et=null,st=null,je=0;const ht=5;for(;je<ht;){const{data:gt,error:He}=await St.from("devolucoes").select(`
            itens:itens_devolucao(id, motivo_id)
          `).eq("id",ue).single();if(He){console.error(`Erro ao buscar devoluo (tentativa ${je+1}):`,He);const{data:Ue,error:bt}=await St.from("itens_devolucao").select("id, motivo_id").eq("devolucao_id",ue);et=Ue,st=bt}else gt&&gt.itens&&(et=gt.itens,st=null);if(st){if(console.error(`Erro ao buscar itens (tentativa ${je+1}):`,st),je===ht-1)break}else if(et){const Ue=et.find(bt=>String(bt.id)===ne);if(console.log(`Tentativa ${je+1} - Item encontrado:`,Ue),Ue&&Ue.motivo_id===fe){console.log(` Item confirmado com motivo na tentativa ${je+1}`);break}else Ue&&console.log(`Item ainda no tem o motivo correto. Esperado: ${fe}, Atual: ${Ue.motivo_id}`)}je<ht-1&&(console.log(`Aguardando e tentando novamente... (tentativa ${je+1}/${ht})`),await new Promise(Ue=>setTimeout(Ue,400))),je++}if(st)throw console.error("Erro ao buscar itens aps todas as tentativas:",st),st;if(!et){console.error("No foi possvel buscar os itens"),wt.error("Erro: No foi possvel buscar os itens da devoluo");return}console.log("Itens encontrados:",et);const nt=et&&et.length>0&&et.every(gt=>{const He=!!gt.motivo_id&&gt.motivo_id!==null&&gt.motivo_id!=="";return console.log("Item:",gt.id,"tem motivo?",He,"motivo_id:",gt.motivo_id),He});console.log("Todos tm motivo?",nt,"Total de itens:",et.length,"Itens com motivos:",et.filter(gt=>!!gt.motivo_id).length);const ct={};let _t=null,mt=0;if(et&&et.forEach(gt=>{if(!gt.motivo_id||gt.motivo_id===null||gt.motivo_id==="")return;const He=String(gt.motivo_id),Ue=(ct[He]||0)+1;ct[He]=Ue,Ue>mt&&(mt=Ue,_t=He)}),console.log("Motivo mais repetido:",_t,"Contagem:",ct),nt){const gt=_t||(et&&et.length>0&&((he=et[0])!=null&&he.motivo_id)?String(et[0].motivo_id):null);if(!gt){console.error("Erro: Todos tm motivos mas no foi possvel determinar o motivo principal"),wt.error("Erro ao validar: no foi possvel determinar o motivo principal");return}console.log("Validando nota...",{motivoParaSalvar:gt});const{data:He,error:Ue}=await St.from("devolucoes").select("resultado, motivo_id").eq("id",ue).single();if(Ue)throw console.error("Erro ao buscar devoluo:",Ue),Ue;const bt=s.find(xt=>xt.id===gt),tt=(bt==null?void 0:bt.nome)||"",dt={resultado:"VALIDADA",prazo:"CONCLUIDO",nome_validador:ke,motivo_id:gt};((He==null?void 0:He.resultado)||"PENDENTE VALIDAO")==="PENDENTE VALIDAO"&&(dt.data_validacao=new Date().toISOString()),console.log("Atualizando devoluo com:",dt);const{error:vt}=await St.from("devolucoes").update(dt).eq("id",ue);if(vt)throw console.error("Erro ao atualizar devoluo:",vt),vt;console.log("Devoluo atualizada com sucesso!"),await St.from("logs_validacao").insert({devolucao_id:ue,usuario_id:R.id,acao:"SELECIONAR_MOTIVO_PRODUTO",status_anterior:(He==null?void 0:He.resultado)||"PENDENTE VALIDAO",status_novo:"VALIDADA"}),r(xt=>xt.map(At=>String(At.id)!==ue?At:{...At,resultado:"VALIDADA",prazo:"CONCLUIDO",nome_validador:ke,motivo_id:gt,motivo:tt||At.motivo})),a(xt=>xt.map(At=>String(At.id)!==ue?At:{...At,resultado:"VALIDADA",prazo:"CONCLUIDO",nome_validador:ke,motivo_id:gt,motivo:tt||At.motivo})),wt.success("Motivo salvo! Todos os produtos tm motivos. Resultado alterado para VALIDADA!")}else{const gt=(et==null?void 0:et.filter(Ue=>!!Ue.motivo_id).length)||0,He=(et==null?void 0:et.length)||0;wt.success(`Motivo salvo para o produto! (${gt}/${He} produtos com motivos)`)}}catch(ke){console.error("Erro completo:",ke),wt.error("Erro ao atualizar motivo: "+ke.message)}},ee=async()=>{if(!(!P||!R))try{const{error:Q}=await St.from("itens_devolucao").delete().eq("devolucao_id",P);if(Q)throw Q;const{error:fe}=await St.from("devolucoes").delete().eq("id",P);if(fe)throw fe;wt.success("Registro excludo com sucesso!"),V(null),A(),E(new Set)}catch(Q){wt.error("Erro ao excluir registro: "+Q.message)}},L=async()=>{if(y.size===0){wt.warning("Selecione pelo menos um registro para excluir");return}if(!U){H(!0);return}try{const Q=Array.from(y);for(const le of Q)await St.from("itens_devolucao").delete().eq("devolucao_id",le);const{error:fe}=await St.from("devolucoes").delete().in("id",Q);if(fe)throw fe;wt.success(`${Q.length} registro(s) excludo(s) com sucesso!`),H(!1),A(),E(new Set),Z(!1)}catch(Q){wt.error("Erro ao excluir registros: "+Q.message),H(!1)}},M=Q=>{I(Q)},K=async()=>{if(!(!N||!R))try{const{error:Q}=await St.from("devolucoes").update({numero:N.numero,nome_cliente:N.nome_cliente,vendedor:N.vendedor,cidade_origem:N.cidade_origem,uf_origem:N.uf_origem,data_emissao:N.data_emissao,valor_total_nota:N.valor_total_nota,peso_liquido:N.peso_liquido,motivo_id:N.motivo_id,setor_id:N.setor_id,resultado:N.resultado,justificativa:N.justificativa,updated_at:new Date().toISOString()}).eq("id",N.id);if(Q)throw Q;wt.success("Registro atualizado com sucesso!"),I(null),A()}catch(Q){wt.error("Erro ao atualizar registro: "+Q.message)}},se=Q=>{var ue;const fe=((ue=Q.itens)==null?void 0:ue.map((he,ke)=>`${ke+1}. ${he.descricao||"-"}
   Quantidade: ${he.quantidade||"-"} ${he.unidade||""}
   Valor Unitrio: R$ ${(Number(he.valor_unitario)||0).toFixed(2)}
   Valor Total: R$ ${(Number(he.valor_total_bruto)||0).toFixed(2)}`).join(`

`))||"Nenhum produto cadastrado",le=` *Devoluo - Nota Fiscal ${Q.numero||"-"}*

*Cliente:* ${Q.nome_cliente||"-"}
*Vendedor:* ${Q.vendedor||"-"}
*Data de Emisso:* ${Q.data_emissao?Xt(new Date(Q.data_emissao),"dd/MM/yyyy",{locale:yr}):"-"}
*Origem:* ${Q.cidade_origem||"-"}/${Q.uf_origem||"-"}

*Valor Total:* R$ ${(Number(Q.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}
*Peso Lquido:* ${Q.peso_liquido||"-"} kg
*Dias:* ${Q.dias!==null&&Q.dias!==void 0?Q.dias:"-"}
*Prazo:* ${Q.prazo||"-"}
*Resultado:* ${Q.resultado||"-"}
*Motivo:* ${Q.motivo||"-"}
*Setor:* ${Q.setor||"-"}

*Produtos:*
${fe}

${Q.justificativa?`*Comentrio:*
${Q.justificativa}`:""}`,ne=`https://wa.me/?text=${encodeURIComponent(le)}`;window.open(ne,"_blank")},te=Q=>{const fe=new Set(y);fe.has(Q)?fe.delete(Q):fe.add(Q),E(fe)},ae=()=>{y.size===t.length?E(new Set):E(new Set(t.map(Q=>Q.id)))};return w.jsxs("div",{className:"space-y-6",children:[w.jsx(Qi,{title:"Validao",description:"Valide e gerencie devolues pendentes. Selecione motivos, altere resultados e adicione comentrios para cada devoluo."}),w.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[w.jsx(Xf,{}),w.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full md:w-auto shrink-0",children:[G&&y.size>0&&w.jsxs(Ot,{variant:"destructive",onClick:()=>H(!0),className:"w-full sm:w-auto",disabled:y.size===0,children:[w.jsx(zn,{className:"mr-2 h-4 w-4"}),"Excluir (",y.size,")"]}),w.jsx(Ot,{variant:G?"default":"outline",onClick:()=>{Z(!G),E(new Set)},className:"w-full sm:w-auto",children:G?w.jsxs(w.Fragment,{children:[w.jsx(Vf,{className:"mr-2 h-4 w-4"}),"Cancelar Seleo"]}):w.jsxs(w.Fragment,{children:[w.jsx(_f,{className:"mr-2 h-4 w-4"}),"Selecionar"]})})]})]}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[w.jsxs(Nt,{children:[w.jsx(Dt,{className:"pb-2",children:w.jsx(Mt,{className:"text-sm font-medium",children:"NF Pendentes"})}),w.jsx(jt,{children:w.jsx("div",{className:"text-2xl font-bold",children:W.nfPendentes})})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{className:"pb-2",children:w.jsx(Mt,{className:"text-sm font-medium",children:"Total Pendente"})}),w.jsx(jt,{children:w.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",W.totalPendente.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{className:"pb-2",children:w.jsx(Mt,{className:"text-sm font-medium",children:"NF Validadas"})}),w.jsx(jt,{children:w.jsx("div",{className:"text-2xl font-bold text-blue-600",children:W.nfValidadas})})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{className:"pb-2",children:w.jsx(Mt,{className:"text-sm font-medium",children:"Total Validadas"})}),w.jsx(jt,{children:w.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["R$ ",W.totalValidadas.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{className:"pb-2",children:w.jsx(Mt,{className:"text-sm font-medium",children:"NF em Cancelamento"})}),w.jsx(jt,{children:w.jsx("div",{className:"text-2xl font-bold",children:W.nfCancelamento})})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{className:"pb-2",children:w.jsx(Mt,{className:"text-sm font-medium",children:"Total Cancelamento"})}),w.jsx(jt,{children:w.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",W.totalCancelamento.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{className:"pb-2",children:w.jsx(Mt,{className:"text-sm font-medium",children:"NF em Atraso"})}),w.jsx(jt,{children:w.jsx("div",{className:"text-2xl font-bold text-red-600",children:W.nfAtraso})})]}),w.jsxs(Nt,{children:[w.jsx(Dt,{className:"pb-2",children:w.jsx(Mt,{className:"text-sm font-medium",children:"Total em Atraso"})}),w.jsx(jt,{children:w.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["R$ ",W.totalAtraso.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]})]}),w.jsx("div",{className:"rounded-md border bg-card min-h-[400px]",children:n?w.jsx("div",{className:"flex items-center justify-center h-full py-20",children:w.jsx(oi,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):t.length===0?w.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-20 text-muted-foreground",children:[w.jsx(R2,{className:"h-10 w-10 mb-2"}),w.jsx("p",{children:"Nenhuma devoluo encontrada."})]}):w.jsxs("div",{children:[e.length>_&&w.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[w.jsxs("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",(f-1)*_+1," a ",Math.min(f*_,e.length)," de ",e.length," registros"]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsxs(Ot,{variant:"outline",size:"sm",onClick:()=>h(Q=>Math.max(1,Q-1)),disabled:f===1,children:[w.jsx(yu,{className:"h-4 w-4 mr-1"}),"Anterior"]}),w.jsxs("div",{className:"text-sm text-muted-foreground",children:["Pgina ",f," de ",Math.ceil(e.length/_)]}),w.jsxs(Ot,{variant:"outline",size:"sm",onClick:()=>h(Q=>Math.min(Math.ceil(e.length/_),Q+1)),disabled:f>=Math.ceil(e.length/_),children:["Prxima",w.jsx(wu,{className:"h-4 w-4 ml-1"})]})]})]}),w.jsx("div",{className:"overflow-x-auto border rounded-lg",children:w.jsxs(Ba,{children:[w.jsx(Za,{className:"bg-muted/50",children:w.jsxs(dr,{children:[G&&w.jsx(Tt,{className:"w-[50px] sticky left-0 bg-muted/50 z-10",children:w.jsx("button",{onClick:ae,className:"p-1 hover:bg-muted rounded",children:y.size===t.length&&t.length>0?w.jsx(_f,{className:"h-4 w-4"}):w.jsx(ax,{className:"h-4 w-4"})})}),w.jsx(Tt,{className:"w-[50px] sticky left-0 bg-muted/50 z-10"}),w.jsx(Tt,{className:"min-w-[100px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("data_emissao"),children:w.jsxs("div",{className:"flex items-center gap-1",children:["Data Emisso",w.jsx(D,{field:"data_emissao"})]})}),w.jsx(Tt,{className:"min-w-[120px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("numero"),children:w.jsxs("div",{className:"flex items-center gap-1",children:["Nota Fiscal",w.jsx(D,{field:"numero"})]})}),w.jsx(Tt,{className:"min-w-[200px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("nome_cliente"),children:w.jsxs("div",{className:"flex items-center gap-1",children:["Cliente",w.jsx(D,{field:"nome_cliente"})]})}),w.jsx(Tt,{className:"min-w-[150px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("vendedor"),children:w.jsxs("div",{className:"flex items-center gap-1",children:["Vendedor",w.jsx(D,{field:"vendedor"})]})}),w.jsx(Tt,{className:"min-w-[150px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("motivo"),children:w.jsxs("div",{className:"flex items-center gap-1",children:["Motivo",w.jsx(D,{field:"motivo"})]})}),w.jsx(Tt,{className:"min-w-[100px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("valor_total_nota"),children:w.jsxs("div",{className:"flex items-center gap-1",children:["Valor Total",w.jsx(D,{field:"valor_total_nota"})]})}),w.jsx(Tt,{className:"min-w-[60px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("dias"),children:w.jsxs("div",{className:"flex items-center gap-1",children:["Dias",w.jsx(D,{field:"dias"})]})}),w.jsx(Tt,{className:"min-w-[100px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("prazo"),children:w.jsxs("div",{className:"flex items-center gap-1",children:["Prazo",w.jsx(D,{field:"prazo"})]})}),w.jsx(Tt,{className:"min-w-[120px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("resultado"),children:w.jsxs("div",{className:"flex items-center gap-1",children:["Resultado",w.jsx(D,{field:"resultado"})]})}),w.jsx(Tt,{className:"min-w-[150px] text-xs font-semibold px-3 py-3",children:"Validado Por"}),w.jsx(Tt,{className:"min-w-[200px] text-xs font-semibold px-3 py-3",children:"Comentrio"}),w.jsx(Tt,{className:"min-w-[120px] text-xs font-semibold px-3 py-3",children:"Aes"})]})}),w.jsx(Ua,{children:t.map(Q=>{const fe=Q.resultado||"PENDENTE VALIDAO";return w.jsx(dr,{className:"group hover:bg-muted/30",children:w.jsx(Pt,{colSpan:G?15:14,className:"p-0",children:w.jsx(a_,{type:"single",collapsible:!0,className:"w-full",children:w.jsxs(Pm,{value:Q.id,className:"border-0",children:[w.jsxs("div",{className:"flex items-center w-full py-3 px-3 hover:bg-muted/50 transition-colors",children:[G&&w.jsx("button",{onClick:()=>te(Q.id),className:"w-[50px] flex items-center justify-center flex-shrink-0",children:y.has(Q.id)?w.jsx(_f,{className:"h-4 w-4 text-primary"}):w.jsx(ax,{className:"h-4 w-4"})}),w.jsxs("div",{className:"flex items-center gap-3 w-full text-xs",children:[w.jsx(Lm,{className:"w-[50px] py-0 pr-2 hover:no-underline flex-shrink-0"}),w.jsx("div",{className:"min-w-[100px] text-xs",children:Q.data_emissao?Xt(new Date(Q.data_emissao),"dd/MM/yyyy",{locale:yr}):"-"}),w.jsx("div",{className:"min-w-[120px] font-medium text-xs",children:Q.numero}),w.jsx("div",{className:"min-w-[200px] truncate text-xs",title:Q.nome_cliente,children:Q.nome_cliente}),w.jsx("div",{className:"min-w-[150px] truncate text-xs",title:Q.vendedor,children:Q.vendedor}),w.jsx("div",{className:"w-40",style:{position:"relative",zIndex:1e4},onMouseDown:le=>{le.stopPropagation(),le.preventDefault()},onPointerDown:le=>{le.stopPropagation(),le.preventDefault()},onClick:le=>{le.stopPropagation()},children:w.jsxs("select",{value:Q.motivo_id||"",onChange:le=>{le.stopPropagation(),F(Q.id,le.target.value)},onMouseDown:le=>{le.stopPropagation()},onPointerDown:le=>{le.stopPropagation()},onClick:le=>{le.stopPropagation()},onFocus:le=>{le.stopPropagation()},onKeyDown:le=>{le.stopPropagation()},className:"h-7 w-full px-2 text-[10px] border rounded-md bg-background cursor-pointer",style:{position:"relative",zIndex:10001},children:[w.jsxs("option",{value:"",children:["Selecione... (",s.length," motivos)"]}),s&&s.length>0?s.map(le=>{var ue;const ne=((ue=le.setores)==null?void 0:ue.nome)||"";return w.jsxs("option",{value:le.id,children:[le.nome," ",ne?`(${ne})`:""]},le.id)}):w.jsx("option",{value:"",disabled:!0,children:"Carregando motivos..."})]})}),w.jsx("div",{className:"w-24 text-[9px] text-muted-foreground",children:Q.motivo_id&&(()=>{var ue;const le=s.find(he=>he.id===Q.motivo_id),ne=le?(ue=le.setores)==null?void 0:ue.nome:null;return ne?`Setor: ${ne}`:""})()}),w.jsxs("div",{className:"w-20 font-bold",children:["R$ ",Number(Q.valor_total_nota||0).toFixed(2)]}),w.jsx("div",{className:"w-12 text-center",children:Q.dias!==null&&Q.dias!==void 0?Q.dias:"-"}),w.jsx("div",{className:"w-20",children:w.jsx("span",{className:`text-[9px] px-1 py-0.5 rounded ${Q.prazo==="EM ATRASO"?"bg-red-500 text-white":Q.prazo==="NO PRAZO"?"bg-green-500 text-white":Q.prazo==="FINALIZADO"?"bg-green-200 text-green-800 dark:bg-green-900 dark:text-green-200":Q.prazo==="TRATANDO"?"bg-purple-200 text-purple-800 dark:bg-purple-900 dark:text-purple-200":Q.prazo==="CONCLUIDO"?"bg-blue-200 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-gray-500 text-white"}`,children:Q.prazo||"-"})}),w.jsx("div",{className:"w-32",children:w.jsxs($n,{value:fe,onValueChange:le=>{B(Q.id,le)},children:[w.jsx(xn,{className:`h-6 w-full text-[8px] px-1 py-0.5 ${Zy[fe]} border-0 cursor-pointer hover:opacity-90`,onClick:le=>le.stopPropagation(),onMouseDown:le=>le.stopPropagation(),children:w.jsx(Vn,{className:"text-white",children:fe})}),w.jsx(yn,{onClick:le=>le.stopPropagation(),onMouseDown:le=>le.stopPropagation(),className:"z-[10000]",children:Ky.map(le=>w.jsx(sr,{value:le,className:`${Zy[le]} text-white cursor-pointer hover:opacity-90`,children:le},le))})]})}),w.jsx("div",{className:"w-28 truncate text-[9px]",title:Q.nome_validador||"-",children:Q.nome_validador||"-"}),w.jsxs("div",{className:"w-48 flex gap-1",children:[w.jsx(lm,{className:`h-7 text-[9px] min-h-[28px] max-h-[28px] resize-none flex-1 ${c[Q.id]||Q.justificativa?"bg-red-100/50 dark:bg-red-900/20 border-red-300 dark:border-red-700":""}`,placeholder:"Comentrio...",value:c[Q.id]||"",onChange:le=>Y(Q.id,le.target.value),onClick:le=>le.stopPropagation(),maxLength:500}),w.jsx(Ot,{size:"sm",variant:"outline",className:"h-7 px-1",onClick:le=>{le.stopPropagation(),re(Q.id)},disabled:u[Q.id],children:w.jsx(lk,{className:"h-3 w-3"})})]}),w.jsxs("div",{className:"w-28 flex gap-1",children:[w.jsx(Ot,{size:"sm",variant:"outline",className:"h-7 px-1",onClick:le=>{le.stopPropagation(),se(Q)},title:"Compartilhar via WhatsApp",children:w.jsx(Rp,{className:"h-3 w-3"})}),((R==null?void 0:R.role)==="ADMIN"||(R==null?void 0:R.role)==="LOGISTICA")&&w.jsxs(w.Fragment,{children:[w.jsx(Ot,{size:"sm",variant:"outline",className:"h-7 px-1",onClick:le=>{le.stopPropagation(),M(Q)},title:"Editar",children:w.jsx(rx,{className:"h-3 w-3"})}),w.jsx(Ot,{size:"sm",variant:"destructive",className:"h-7 px-1",onClick:le=>{le.stopPropagation(),V(Q.id)},title:"Excluir",children:w.jsx(zn,{className:"h-3 w-3"})})]})]})]})]}),w.jsx(Bm,{children:w.jsx("div",{className:"px-4 pb-4",children:w.jsxs("div",{className:"rounded-md border bg-muted/50 p-4",children:[w.jsx("div",{className:"mb-3 pb-2 border-b",children:w.jsxs("p",{className:"text-sm font-medium text-muted-foreground",children:[w.jsx("span",{className:"font-semibold",children:"Origem:"})," ",Q.cidade_origem||"-","/",Q.uf_origem||"-"]})}),w.jsx("h4",{className:"font-semibold mb-2 text-sm",children:"Itens da Devoluo"}),w.jsxs(Ba,{children:[w.jsx(Za,{children:w.jsxs(dr,{children:[w.jsx(Tt,{className:"h-8 text-xs",children:"Nmero"}),w.jsx(Tt,{className:"h-8 text-xs",children:"Descrio"}),w.jsx(Tt,{className:"h-8 text-xs",children:"Unidade"}),w.jsx(Tt,{className:"h-8 text-xs",children:"Quantidade"}),w.jsx(Tt,{className:"h-8 text-xs",children:"Valor Unitrio"}),w.jsx(Tt,{className:"h-8 text-xs",children:"Valor Total Bruto"}),w.jsx(Tt,{className:"h-8 text-xs",children:"Motivo"})]})}),w.jsx(Ua,{children:Q.itens&&Q.itens.length>0?Q.itens.map((le,ne)=>w.jsxs(dr,{children:[w.jsx(Pt,{className:"text-xs",children:le.numero_item||"-"}),w.jsx(Pt,{className:"text-xs",children:le.descricao||"-"}),w.jsx(Pt,{className:"text-xs",children:le.unidade||"-"}),w.jsx(Pt,{className:"text-xs",children:le.quantidade||"-"}),w.jsxs(Pt,{className:"text-xs",children:["R$ ",Number(le.valor_unitario||0).toFixed(2)]}),w.jsxs(Pt,{className:"text-xs",children:["R$ ",Number(le.valor_total_bruto||0).toFixed(2)]}),w.jsxs(Pt,{className:"text-xs relative",style:{position:"relative",zIndex:9999},onMouseDown:ue=>ue.stopPropagation(),onPointerDown:ue=>ue.stopPropagation(),onClick:ue=>ue.stopPropagation(),children:[w.jsxs("select",{value:le.motivo_id||"",onChange:ue=>{ue.stopPropagation();const he=ue.target.value;console.log("Select onChange:",{motivoSelecionado:he,prodId:le.id,itemId:Q.id,produto:le}),he&&le.id&&Q.id?z(le.id,he,Q.id):(console.error("Valores invlidos:",{motivoSelecionado:he,prodId:le.id,itemId:Q.id}),wt.error("Erro: Dados invlidos para salvar motivo"))},onMouseDown:ue=>{ue.stopPropagation()},onPointerDown:ue=>{ue.stopPropagation()},onClick:ue=>{ue.stopPropagation()},onFocus:ue=>{ue.stopPropagation()},className:"h-7 w-full px-2 text-xs border rounded-md bg-background cursor-pointer",style:{position:"relative",zIndex:9999},children:[w.jsx("option",{value:"",children:"Selecione..."}),s&&s.length>0?s.map(ue=>{var ke;const he=((ke=ue.setores)==null?void 0:ke.nome)||"";return w.jsxs("option",{value:ue.id,children:[ue.nome," ",he?`(${he})`:""]},ue.id)}):w.jsx("option",{value:"",disabled:!0,children:"Carregando motivos..."})]}),le.motivo_id&&(()=>{var ke;const ue=s.find(pe=>pe.id===le.motivo_id),he=ue?(ke=ue.setores)==null?void 0:ke.nome:null;return he?w.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Setor: ",he]}):null})()]})]},ne)):w.jsx(dr,{children:w.jsx(Pt,{colSpan:7,className:"text-center text-xs text-muted-foreground",children:"Nenhum item cadastrado"})})})]}),Q.dados_adicionais&&w.jsx("div",{className:"mt-4 pt-4 border-t",children:w.jsx("p",{className:"text-[10px] font-bold italic text-muted-foreground whitespace-pre-wrap break-words",children:Q.dados_adicionais})})]})})})]})})})},Q.id)})})]})}),e.length>_&&w.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t",children:[w.jsxs("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",(f-1)*_+1," a ",Math.min(f*_,e.length)," de ",e.length," registros"]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsxs(Ot,{variant:"outline",size:"sm",onClick:()=>h(Q=>Math.max(1,Q-1)),disabled:f===1,children:[w.jsx(yu,{className:"h-4 w-4 mr-1"}),"Anterior"]}),w.jsxs("div",{className:"text-sm text-muted-foreground",children:["Pgina ",f," de ",Math.ceil(e.length/_)]}),w.jsxs(Ot,{variant:"outline",size:"sm",onClick:()=>h(Q=>Math.min(Math.ceil(e.length/_),Q+1)),disabled:f>=Math.ceil(e.length/_),children:["Prxima",w.jsx(wu,{className:"h-4 w-4 ml-1"})]})]})]})]})}),w.jsx(ri,{open:!!P,onOpenChange:Q=>!Q&&V(null),children:w.jsxs(As,{className:"sm:max-w-[425px]",children:[w.jsxs(Cs,{children:[w.jsxs(js,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[w.jsx(zn,{className:"h-5 w-5"}),"Confirmar Excluso"]}),w.jsx(Os,{className:"pt-2",children:"Tem certeza que deseja excluir este registro?"}),w.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mt-4",children:w.jsx("p",{className:"text-sm text-destructive font-medium",children:" Esta ao no pode ser desfeita."})})]}),w.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[w.jsx(Ot,{variant:"outline",onClick:()=>V(null),className:"flex-1 sm:flex-initial",children:"No"}),w.jsx(Ot,{variant:"destructive",onClick:ee,className:"flex-1 sm:flex-initial",children:"Sim, Excluir"})]})]})}),w.jsx(ri,{open:U,onOpenChange:Q=>!Q&&H(!1),children:w.jsxs(As,{className:"sm:max-w-[425px]",children:[w.jsxs(Cs,{children:[w.jsxs(js,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[w.jsx(zn,{className:"h-5 w-5"}),"Confirmar Excluso"]}),w.jsxs(Os,{className:"pt-2",children:["Tem certeza que deseja excluir ",w.jsxs("span",{className:"font-semibold text-foreground",children:[y.size," registro(s)"]}),"?"]}),w.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mt-4",children:w.jsx("p",{className:"text-sm text-destructive font-medium",children:" Esta ao no pode ser desfeita."})})]}),w.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[w.jsx(Ot,{variant:"outline",onClick:()=>H(!1),className:"flex-1 sm:flex-initial",children:"No"}),w.jsx(Ot,{variant:"destructive",onClick:L,className:"flex-1 sm:flex-initial",children:"Sim, Excluir"})]})]})}),w.jsx(ri,{open:!!N,onOpenChange:Q=>!Q&&I(null),children:w.jsxs(As,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[w.jsxs(Cs,{children:[w.jsxs(js,{className:"text-xl font-bold flex items-center gap-2",children:[w.jsx(rx,{className:"h-5 w-5 text-primary"}),"Editar Registro"]}),w.jsx(Os,{className:"pt-2",children:"Alterar informaes da nota fiscal"})]}),N&&w.jsxs("div",{className:"space-y-4 py-4",children:[w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"Nmero da Nota"}),w.jsx(_r,{value:N.numero||"",onChange:Q=>I({...N,numero:Q.target.value})})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"Cliente"}),w.jsx(_r,{value:N.nome_cliente||"",onChange:Q=>I({...N,nome_cliente:Q.target.value})})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"Vendedor"}),w.jsx(_r,{value:N.vendedor||"",onChange:Q=>I({...N,vendedor:Q.target.value})})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"Cidade Origem"}),w.jsx(_r,{value:N.cidade_origem||"",onChange:Q=>I({...N,cidade_origem:Q.target.value})})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"UF Origem"}),w.jsx(_r,{value:N.uf_origem||"",onChange:Q=>I({...N,uf_origem:Q.target.value})})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"Data de Emisso"}),w.jsx(_r,{type:"date",value:N.data_emissao?new Date(N.data_emissao).toISOString().split("T")[0]:"",onChange:Q=>I({...N,data_emissao:Q.target.value})})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"Valor Total"}),w.jsx(_r,{type:"number",step:"0.01",value:N.valor_total_nota||"",onChange:Q=>I({...N,valor_total_nota:Q.target.value})})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"Peso Lquido"}),w.jsx(_r,{type:"number",step:"0.01",value:N.peso_liquido||"",onChange:Q=>I({...N,peso_liquido:Q.target.value})})]})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"Motivo Principal"}),w.jsxs($n,{value:N.motivo_id||"",onValueChange:Q=>I({...N,motivo_id:Q}),children:[w.jsx(xn,{children:w.jsx(Vn,{placeholder:"Selecione um motivo"})}),w.jsx(yn,{children:s.map(Q=>w.jsx(sr,{value:Q.id,children:Q.nome},Q.id))})]})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"Justificativa"}),w.jsx(lm,{value:N.justificativa||"",onChange:Q=>I({...N,justificativa:Q.target.value})})]})]}),w.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[w.jsx(Ot,{variant:"outline",onClick:()=>I(null),className:"flex-1 sm:flex-initial",children:"Cancelar"}),w.jsx(Ot,{onClick:K,className:"flex-1 sm:flex-initial bg-primary hover:bg-primary/90",children:"Salvar Alteraes"})]})]})})]})}var Cp="rovingFocusGroup.onEntryFocus",cB={bubbles:!1,cancelable:!0},Qu="RovingFocusGroup",[cm,B4,uB]=X5(Qu),[dB,U4]=Uf(Qu,[uB]),[fB,hB]=dB(Qu),z4=Se.forwardRef((t,r)=>w.jsx(cm.Provider,{scope:t.__scopeRovingFocusGroup,children:w.jsx(cm.Slot,{scope:t.__scopeRovingFocusGroup,children:w.jsx(pB,{...t,ref:r})})}));z4.displayName=Qu;var pB=Se.forwardRef((t,r)=>{const{__scopeRovingFocusGroup:e,orientation:a,loop:n=!1,dir:o,currentTabStopId:s,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:i,preventScrollOnEntryFocus:u=!1,...p}=t,f=Se.useRef(null),h=Uu(r,f),v=p2(o),[b,g]=fm({prop:s,defaultProp:l??null,onChange:c,caller:Qu}),[x,y]=Se.useState(!1),E=um(i),N=B4(e),I=Se.useRef(!1),[P,V]=Se.useState(0);return Se.useEffect(()=>{const U=f.current;if(U)return U.addEventListener(Cp,E),()=>U.removeEventListener(Cp,E)},[E]),w.jsx(fB,{scope:e,orientation:a,dir:v,loop:n,currentTabStopId:b,onItemFocus:Se.useCallback(U=>g(U),[g]),onItemShiftTab:Se.useCallback(()=>y(!0),[]),onFocusableItemAdd:Se.useCallback(()=>V(U=>U+1),[]),onFocusableItemRemove:Se.useCallback(()=>V(U=>U-1),[]),children:w.jsx(Ms.div,{tabIndex:x||P===0?-1:0,"data-orientation":a,...p,ref:h,style:{outline:"none",...t.style},onMouseDown:cn(t.onMouseDown,()=>{I.current=!0}),onFocus:cn(t.onFocus,U=>{const H=!I.current;if(U.target===U.currentTarget&&H&&!x){const G=new CustomEvent(Cp,cB);if(U.currentTarget.dispatchEvent(G),!G.defaultPrevented){const Z=N().filter(_=>_.focusable),W=Z.find(_=>_.active),O=Z.find(_=>_.id===b),C=[W,O,...Z].filter(Boolean).map(_=>_.ref.current);H4(C,u)}}I.current=!1}),onBlur:cn(t.onBlur,()=>y(!1))})})}),$4="RovingFocusGroupItem",V4=Se.forwardRef((t,r)=>{const{__scopeRovingFocusGroup:e,focusable:a=!0,active:n=!1,tabStopId:o,children:s,...l}=t,c=hm(),i=o||c,u=hB($4,e),p=u.currentTabStopId===i,f=B4(e),{onFocusableItemAdd:h,onFocusableItemRemove:v,currentTabStopId:b}=u;return Se.useEffect(()=>{if(a)return h(),()=>v()},[a,h,v]),w.jsx(cm.ItemSlot,{scope:e,id:i,focusable:a,active:n,children:w.jsx(Ms.span,{tabIndex:p?0:-1,"data-orientation":u.orientation,...l,ref:r,onMouseDown:cn(t.onMouseDown,g=>{a?u.onItemFocus(i):g.preventDefault()}),onFocus:cn(t.onFocus,()=>u.onItemFocus(i)),onKeyDown:cn(t.onKeyDown,g=>{if(g.key==="Tab"&&g.shiftKey){u.onItemShiftTab();return}if(g.target!==g.currentTarget)return;const x=vB(g,u.orientation,u.dir);if(x!==void 0){if(g.metaKey||g.ctrlKey||g.altKey||g.shiftKey)return;g.preventDefault();let E=f().filter(N=>N.focusable).map(N=>N.ref.current);if(x==="last")E.reverse();else if(x==="prev"||x==="next"){x==="prev"&&E.reverse();const N=E.indexOf(g.currentTarget);E=u.loop?bB(E,N+1):E.slice(N+1)}setTimeout(()=>H4(E))}}),children:typeof s=="function"?s({isCurrentTabStop:p,hasTabStop:b!=null}):s})})});V4.displayName=$4;var mB={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function gB(t,r){return r!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function vB(t,r,e){const a=gB(t.key,e);if(!(r==="vertical"&&["ArrowLeft","ArrowRight"].includes(a))&&!(r==="horizontal"&&["ArrowUp","ArrowDown"].includes(a)))return mB[a]}function H4(t,r=!1){const e=document.activeElement;for(const a of t)if(a===e||(a.focus({preventScroll:r}),document.activeElement!==e))return}function bB(t,r){return t.map((e,a)=>t[(r+a)%t.length])}var xB=z4,yB=V4,eh="Tabs",[wB,ZB]=Uf(eh,[U4]),q4=U4(),[_B,h1]=wB(eh),W4=Se.forwardRef((t,r)=>{const{__scopeTabs:e,value:a,onValueChange:n,defaultValue:o,orientation:s="horizontal",dir:l,activationMode:c="automatic",...i}=t,u=p2(l),[p,f]=fm({prop:a,onChange:n,defaultProp:o??"",caller:eh});return w.jsx(_B,{scope:e,baseId:hm(),value:p,onValueChange:f,orientation:s,dir:u,activationMode:c,children:w.jsx(Ms.div,{dir:u,"data-orientation":s,...i,ref:r})})});W4.displayName=eh;var G4="TabsList",Y4=Se.forwardRef((t,r)=>{const{__scopeTabs:e,loop:a=!0,...n}=t,o=h1(G4,e),s=q4(e);return w.jsx(xB,{asChild:!0,...s,orientation:o.orientation,dir:o.dir,loop:a,children:w.jsx(Ms.div,{role:"tablist","aria-orientation":o.orientation,...n,ref:r})})});Y4.displayName=G4;var X4="TabsTrigger",K4=Se.forwardRef((t,r)=>{const{__scopeTabs:e,value:a,disabled:n=!1,...o}=t,s=h1(X4,e),l=q4(e),c=Q4(s.baseId,a),i=e3(s.baseId,a),u=a===s.value;return w.jsx(yB,{asChild:!0,...l,focusable:!n,active:u,children:w.jsx(Ms.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":i,"data-state":u?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:c,...o,ref:r,onMouseDown:cn(t.onMouseDown,p=>{!n&&p.button===0&&p.ctrlKey===!1?s.onValueChange(a):p.preventDefault()}),onKeyDown:cn(t.onKeyDown,p=>{[" ","Enter"].includes(p.key)&&s.onValueChange(a)}),onFocus:cn(t.onFocus,()=>{const p=s.activationMode!=="manual";!u&&!n&&p&&s.onValueChange(a)})})})});K4.displayName=X4;var Z4="TabsContent",J4=Se.forwardRef((t,r)=>{const{__scopeTabs:e,value:a,forceMount:n,children:o,...s}=t,l=h1(Z4,e),c=Q4(l.baseId,a),i=e3(l.baseId,a),u=a===l.value,p=Se.useRef(u);return Se.useEffect(()=>{const f=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(f)},[]),w.jsx(dm,{present:n||u,children:({present:f})=>w.jsx(Ms.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:i,tabIndex:0,...s,ref:r,style:{...t.style,animationDuration:p.current?"0s":void 0},children:f&&o})})});J4.displayName=Z4;function Q4(t,r){return`${t}-trigger-${r}`}function e3(t,r){return`${t}-content-${r}`}var SB=W4,t3=Y4,r3=K4,a3=J4;const n3=SB,p1=Se.forwardRef(({className:t,...r},e)=>w.jsx(t3,{ref:e,className:Et("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...r}));p1.displayName=t3.displayName;const Yi=Se.forwardRef(({className:t,...r},e)=>w.jsx(r3,{ref:e,className:Et("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...r}));Yi.displayName=r3.displayName;const Xi=Se.forwardRef(({className:t,...r},e)=>w.jsx(a3,{ref:e,className:Et("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r}));Xi.displayName=a3.displayName;function kB(){const{user:t}=Oa(),[r,e]=Se.useState([]),[a,n]=Se.useState([]),[o,s]=Se.useState([]),[l,c]=Se.useState([]),[i,u]=Se.useState([]),[p,f]=Se.useState(""),[h,v]=Se.useState(""),[b,g]=Se.useState(""),[x,y]=Se.useState(""),[E,N]=Se.useState(""),[I,P]=Se.useState(""),[V,U]=Se.useState(""),[H,G]=Se.useState(""),[Z,W]=Se.useState(""),[O,R]=Se.useState(""),[C,_]=Se.useState(null),[k,A]=Se.useState(""),[T,D]=Se.useState("COMERCIAL"),[B,F]=Se.useState(""),[Y,X]=Se.useState(""),[re,z]=Se.useState(null),[ee,L]=Se.useState(null),[M,K]=Se.useState(null),[se,te]=Se.useState(""),[ae,Q]=Se.useState(""),[fe,le]=Se.useState(""),[ne,ue]=Se.useState("NOVO"),[he,ke]=Se.useState("");Se.useEffect(()=>{pe()},[]);const pe=async()=>{var _t;const[je,ht,Je,nt,ct]=await Promise.all([St.from("setores").select("*").order("nome"),St.from("motivos_devolucao").select("*, setor:setores(nome)").order("nome"),St.from("profiles").select("*").order("name"),St.from("clientes").select("*").order("nome"),St.from("devolucoes").select("vendedor").not("vendedor","is",null)]);if(je.data&&e(je.data.map(mt=>({id:mt.id,name:mt.nome}))),ht.data&&n(ht.data.map(mt=>({id:mt.id,name:mt.nome,sector_id:mt.sector_id,sector:mt.setor}))),Je.data&&s(Je.data),nt.data&&c(nt.data),ct.data){const mt=new Set;ct.data.forEach(gt=>{gt.vendedor&&gt.vendedor.trim()&&mt.add(gt.vendedor.trim().toUpperCase())}),(_t=nt.data)==null||_t.forEach(gt=>{gt.vendedor&&gt.vendedor.trim()&&mt.add(gt.vendedor.trim().toUpperCase())}),u(Array.from(mt).sort())}},Ce=async()=>{if(!h)return;const{error:je}=await St.from("setores").insert({nome:h});je?wt.error("Erro ao adicionar setor: "+je.message):(wt.success("Setor adicionado!"),v(""),pe())},Me=async()=>{if(!b||!b.trim()){wt.error("Nome do motivo  obrigatrio");return}if(!x){wt.error("Selecione um setor para o motivo");return}try{const{error:je}=await St.from("motivos_devolucao").insert({nome:b.trim(),sector_id:x});je?(console.error("Erro ao adicionar motivo:",je),wt.error("Erro ao adicionar motivo: "+je.message)):(wt.success("Motivo adicionado!"),g(""),y(""),pe())}catch(je){console.error("Erro ao adicionar motivo:",je),wt.error("Erro ao adicionar motivo: "+(je.message||"Erro desconhecido"))}},Ie=async()=>{var je,ht;if(!E||!E.trim()){wt.error("Nome do cliente  obrigatrio");return}if(!I||!I.trim()){wt.error("CNPJ/CPF  obrigatrio");return}if(Z&&Z.length!==2){wt.error("UF deve ter 2 caracteres");return}try{const{error:Je}=await St.from("clientes").insert({nome:E.trim(),cnpj_cpf:I.trim(),vendedor:(V==null?void 0:V.trim())||null,rede:(H==null?void 0:H.trim())||null,uf:(Z==null?void 0:Z.trim().toUpperCase())||null,municipio:(O==null?void 0:O.trim())||null});Je?(console.error("Erro ao adicionar cliente:",Je),Je.code==="23505"||(je=Je.message)!=null&&je.includes("duplicate")||(ht=Je.message)!=null&&ht.includes("unique")?wt.error("Cliente com este CNPJ/CPF j est cadastrado"):wt.error("Erro ao adicionar cliente: "+Je.message)):(wt.success("Cliente adicionado!"),N(""),P(""),U(""),G(""),W(""),R(""),pe())}catch(Je){console.error("Erro ao adicionar cliente:",Je),wt.error("Erro ao adicionar cliente: "+(Je.message||"Erro desconhecido"))}},Ye=async()=>{var ht,Je,nt,ct;if(!se||!ae||!fe){wt.error("Nome, email e senha so obrigatrios");return}if(fe.length<6){wt.error("A senha deve ter pelo menos 6 caracteres");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(ae)){wt.error("Email invlido");return}try{const _t={name:se},{data:mt,error:gt}=await St.auth.signUp({email:ae.trim().toLowerCase(),password:fe,options:{data:_t,emailRedirectTo:void 0}});if(gt){console.error("Erro no auth.signUp:",gt),(ht=gt.message)!=null&&ht.includes("already registered")||(Je=gt.message)!=null&&Je.includes("already exists")?wt.error("Este email j est cadastrado no sistema"):(nt=gt.message)!=null&&nt.includes("password")?wt.error("Senha invlida. Verifique os requisitos de senha."):(ct=gt.message)!=null&&ct.includes("email")?wt.error("Email invlido ou j cadastrado"):wt.error(`Erro ao criar usurio: ${gt.message||"Erro desconhecido"}`);return}if(mt.user){console.log(" Usurio criado no Auth:",mt.user.id,mt.user.email),await new Promise(tt=>setTimeout(tt,1500));let He=null,Ue=0;const bt=3;for(;Ue<bt&&!He;){Ue++,console.log(` Tentativa ${Ue}/${bt} de verificar perfil...`);const{data:tt,error:dt}=await St.from("profiles").select("*").eq("id",mt.user.id).single();if(dt&&dt.code!=="PGRST116"&&console.warn("Erro ao verificar perfil:",dt),tt){He=tt,console.log(" Perfil encontrado:",He);break}Ue<bt&&await new Promise(ut=>setTimeout(ut,1500))}if(He){const{error:tt}=await St.from("profiles").update({name:se,role:"NOVO",vendedor:null}).eq("id",mt.user.id);tt?console.warn(" Aviso ao atualizar perfil:",tt):console.log(" Perfil atualizado com sucesso")}else{console.log(" Perfil no encontrado aps tentativas, criando manualmente...");const{data:tt,error:dt}=await St.from("profiles").insert({id:mt.user.id,name:se,email:ae.trim().toLowerCase(),role:"NOVO",vendedor:null}).select().single();if(dt){console.error(" Erro ao inserir perfil:",dt),wt.error(`Usurio criado no Auth, mas erro ao criar perfil: ${dt.message}. Verifique o perfil manualmente no Supabase.`);return}He=tt,console.log(" Perfil criado manualmente:",He)}wt.success("Usurio criado com sucesso! O usurio foi criado como tipo NOVO. Atribua a funo apropriada na gesto de usurios."),te(""),Q(""),le(""),ue("NOVO"),ke(""),pe()}else wt.warning("Usurio criado, mas no foi possvel obter os dados. Recarregue a pgina.")}catch(_t){console.error("Erro ao criar usurio:",_t),wt.error(`Erro ao criar usurio: ${_t.message||"Erro desconhecido"}`)}},at=async()=>{var je,ht;if(C){if(T==="VENDEDOR"&&!B){wt.error("Usurios do tipo VENDEDOR devem ter um vendedor selecionado");return}if(!T||T==="NOVO"){wt.error("Selecione um role vlido para o usurio");return}try{const Je={name:k.trim()};T&&(Je.role=T),T==="VENDEDOR"?Je.vendedor=B||null:Je.vendedor=null,console.log(" Atualizando usurio:",C.id,"com dados:",Je),console.log(" Usurio atual (ADMIN):",t==null?void 0:t.email,"role:",t==null?void 0:t.role),Je.updated_at=new Date().toISOString();const{error:nt,data:ct}=await St.from("profiles").update(Je).eq("id",C.id).select();if(nt){console.error(" Erro ao atualizar perfil:",nt),console.error(" Detalhes do erro:",JSON.stringify(nt,null,2)),console.error(" Cdigo do erro:",nt.code),console.error(" Mensagem:",nt.message),console.error(" Detalhes:",nt.details),console.error(" Hint:",nt.hint),nt.code==="42501"||(je=nt.message)!=null&&je.includes("permission")||(ht=nt.message)!=null&&ht.includes("policy")?wt.error("Erro de permisso: Verifique se voc tem permisso para atualizar este usurio. Apenas ADMINs podem atualizar outros perfis."):wt.error("Erro ao atualizar usurio: "+(nt.message||"Erro desconhecido"));return}if(console.log(" Resposta do update:",ct),!ct||ct.length===0){console.error(" Update retornou array vazio - possvel problema de RLS"),wt.error("Usurio no foi atualizado. Verifique se voc tem permisso ADMIN para atualizar outros perfis.");return}console.log(" Usurio atualizado com sucesso:",ct[0]),Y&&Y.length>=6&&(wt.warning("Alterao de senha de outros usurios requer configurao de Edge Function ou uso da API Admin do Supabase. Por favor, use o Supabase Dashboard para alterar senhas."),X("")),wt.success("Usurio atualizado com sucesso!"),_(null),X(""),pe()}catch(Je){console.error("Erro ao atualizar usurio:",Je),wt.error("Erro ao atualizar usurio: "+Je.message)}}},rt=async()=>{if(re)try{const{error:je}=await St.from("profiles").delete().eq("id",re.id);if(je){wt.error("Erro ao excluir usurio: "+je.message);return}wt.success("Usurio excludo com sucesso! (Nota: O registro no Auth pode precisar ser removido manualmente no Supabase Dashboard)"),z(null),pe()}catch(je){wt.error("Erro ao excluir usurio: "+je.message)}},it=async()=>{if(ee)try{const{error:je}=await St.from("motivos_devolucao").delete().eq("id",ee);je?wt.error("Erro ao excluir: "+je.message):(wt.success("Excludo com sucesso"),L(null),pe())}catch(je){wt.error("Erro ao excluir: "+je.message)}},et=()=>{M&&(u(i.filter(je=>je!==M)),wt.success("Vendedor removido da lista!"),K(null))},st=async()=>{if(!p||!p.trim()){wt.error("Nome do vendedor  obrigatrio");return}const je=p.trim().toUpperCase();if(i.includes(je)){wt.warning("Este vendedor j est cadastrado");return}u([...i,je].sort()),f(""),wt.success("Vendedor adicionado  lista!")};return(t==null?void 0:t.role)!=="ADMIN"&&(t==null?void 0:t.role)!=="LOGISTICA"?w.jsx("div",{className:"p-8 text-center",children:"Acesso restrito a administradores e logstica."}):w.jsxs("div",{className:"space-y-6",children:[w.jsx(Qi,{title:"Configuraes",description:"Gerencie setores, motivos de devoluo, vendedores, clientes e usurios do sistema. Acesso restrito a administradores."}),w.jsxs(n3,{defaultValue:"master-data",children:[w.jsx("div",{className:"overflow-x-auto",children:w.jsxs(p1,{className:"w-full md:w-auto min-w-full md:min-w-0",children:[w.jsx(Yi,{value:"master-data",className:"text-xs sm:text-sm whitespace-nowrap",children:"Master Data (Setores/Motivos)"}),w.jsx(Yi,{value:"vendedores",className:"text-xs sm:text-sm whitespace-nowrap",children:"Vendedores"}),w.jsx(Yi,{value:"clientes",className:"text-xs sm:text-sm whitespace-nowrap",children:"Clientes"}),(t==null?void 0:t.role)==="ADMIN"&&w.jsx(Yi,{value:"users",className:"text-xs sm:text-sm whitespace-nowrap",children:"Usurios"})]})}),w.jsx(Xi,{value:"master-data",className:"space-y-6 mt-6",children:w.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Setores"}),w.jsx(Cr,{children:"Gerencie as reas responsveis."})]}),w.jsxs(jt,{children:[w.jsxs("div",{className:"flex gap-2 mb-4",children:[w.jsx(_r,{placeholder:"Novo Setor",value:h,onChange:je=>v(je.target.value)}),w.jsx(Ot,{onClick:Ce,size:"icon",children:w.jsx(tu,{className:"h-4 w-4"})})]}),w.jsx("div",{className:"rounded-md border max-h-[300px] overflow-y-auto",children:w.jsx(Ba,{children:w.jsx(Ua,{children:r.map(je=>w.jsx(dr,{children:w.jsx(Pt,{children:je.name})},je.id))})})})]})]}),w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Motivos de Devoluo"}),w.jsx(Cr,{children:"Associe motivos aos setores."})]}),w.jsxs(jt,{children:[w.jsxs("div",{className:"flex flex-col gap-2 mb-4",children:[w.jsxs($n,{value:x,onValueChange:y,children:[w.jsx(xn,{children:w.jsx(Vn,{placeholder:"Selecione o Setor"})}),w.jsx(yn,{children:r.map(je=>w.jsx(sr,{value:je.id,children:je.name},je.id))})]}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx(_r,{placeholder:"Novo Motivo",value:b,onChange:je=>g(je.target.value)}),w.jsx(Ot,{onClick:Me,size:"icon",children:w.jsx(tu,{className:"h-4 w-4"})})]})]}),w.jsx("div",{className:"rounded-md border max-h-[300px] overflow-y-auto",children:w.jsxs(Ba,{children:[w.jsx(Za,{children:w.jsxs(dr,{children:[w.jsx(Tt,{children:"Motivo"}),w.jsx(Tt,{children:"Setor"}),w.jsx(Tt,{className:"w-[50px]"})]})}),w.jsx(Ua,{children:a.length===0?w.jsx(dr,{children:w.jsx(Pt,{colSpan:3,className:"text-center text-muted-foreground",children:"Nenhum motivo cadastrado"})}):a.map(je=>{var ht;return w.jsxs(dr,{children:[w.jsx(Pt,{children:je.name}),w.jsx(Pt,{className:"text-xs text-muted-foreground",children:((ht=je.sector)==null?void 0:ht.name)||"-"}),w.jsx(Pt,{children:w.jsx(Ot,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:bg-destructive/10",onClick:()=>L(je.id),children:w.jsx(zn,{className:"h-3 w-3"})})})]},je.id)})})]})})]})]})]})}),w.jsx(Xi,{value:"vendedores",className:"space-y-6 mt-6",children:w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Cadastro de Vendedores"}),w.jsx(Cr,{children:"Gerencie a lista de vendedores disponveis no sistema."})]}),w.jsxs(jt,{children:[w.jsxs("div",{className:"flex gap-2 mb-4",children:[w.jsx(_r,{placeholder:"Nome do Vendedor",value:p,onChange:je=>f(je.target.value),onKeyPress:je=>je.key==="Enter"&&st()}),w.jsx(Ot,{onClick:st,size:"icon",children:w.jsx(tu,{className:"h-4 w-4"})})]}),w.jsx("div",{className:"rounded-md border max-h-[400px] overflow-y-auto",children:w.jsxs(Ba,{children:[w.jsx(Za,{children:w.jsxs(dr,{children:[w.jsx(Tt,{children:"Nome"}),w.jsx(Tt,{className:"text-right",children:"Aes"})]})}),w.jsxs(Ua,{children:[i.map((je,ht)=>w.jsxs(dr,{children:[w.jsx(Pt,{className:"font-medium",children:je}),w.jsx(Pt,{className:"text-right",children:w.jsx(Ot,{variant:"ghost",size:"icon",className:"hover:bg-destructive/10",onClick:()=>K(je),children:w.jsx(zn,{className:"h-4 w-4 text-destructive"})})})]},ht)),i.length===0&&w.jsx(dr,{children:w.jsx(Pt,{colSpan:2,className:"text-center text-muted-foreground",children:"Nenhum vendedor cadastrado. Adicione um acima."})})]})]})})]})]})}),w.jsx(Xi,{value:"clientes",className:"space-y-6 mt-6",children:w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Cadastro de Clientes"}),w.jsx(Cr,{children:"Adicione novos clientes ao sistema."})]}),w.jsxs(jt,{children:[w.jsxs("div",{className:"space-y-4 mb-6",children:[w.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"Nome *"}),w.jsx(_r,{value:E,onChange:je=>N(je.target.value),placeholder:"Nome do cliente"})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"CNPJ/CPF *"}),w.jsx(_r,{value:I,onChange:je=>P(je.target.value),placeholder:"00.000.000/0000-00"})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"Vendedor"}),w.jsx(_r,{value:V,onChange:je=>U(je.target.value),placeholder:"Nome do vendedor"})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"Rede"}),w.jsx(_r,{value:H,onChange:je=>G(je.target.value),placeholder:"Nome da rede"})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"UF"}),w.jsx(_r,{value:Z,onChange:je=>W(je.target.value.toUpperCase()),placeholder:"UF",maxLength:2})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"Municpio"}),w.jsx(_r,{value:O,onChange:je=>R(je.target.value),placeholder:"Nome do municpio"})]})]}),w.jsxs(Ot,{onClick:Ie,children:[w.jsx(tu,{className:"mr-2 h-4 w-4"}),"Adicionar Cliente"]})]}),w.jsx("div",{className:"rounded-md border max-h-[400px] overflow-y-auto",children:w.jsxs(Ba,{children:[w.jsx(Za,{children:w.jsxs(dr,{children:[w.jsx(Tt,{children:"Nome"}),w.jsx(Tt,{children:"CNPJ/CPF"}),w.jsx(Tt,{children:"Vendedor"}),w.jsx(Tt,{children:"Rede"}),w.jsx(Tt,{children:"UF"}),w.jsx(Tt,{children:"Municpio"})]})}),w.jsx(Ua,{children:l.map(je=>w.jsxs(dr,{children:[w.jsx(Pt,{className:"font-medium",children:je.nome}),w.jsx(Pt,{children:je.cnpj_cpf}),w.jsx(Pt,{children:je.vendedor||"-"}),w.jsx(Pt,{children:je.rede||"-"}),w.jsx(Pt,{children:je.uf||"-"}),w.jsx(Pt,{children:je.municipio||"-"})]},je.id))})]})})]})]})}),w.jsxs(Xi,{value:"users",className:"space-y-6 mt-6",children:[w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Cadastro de Usurios"}),w.jsx(Cr,{children:"Adicione novos usurios ao sistema."})]}),w.jsx(jt,{children:w.jsxs("div",{className:"space-y-4 mb-6 p-4 border rounded-lg",children:[w.jsx("h3",{className:"font-semibold mb-4",children:"Novo Usurio"}),w.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"Nome *"}),w.jsx(_r,{value:se,onChange:je=>te(je.target.value),placeholder:"Nome completo"})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"Email *"}),w.jsx(_r,{type:"email",value:ae,onChange:je=>Q(je.target.value),placeholder:"email@exemplo.com"})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"Senha *"}),w.jsx(_r,{type:"password",value:fe,onChange:je=>le(je.target.value),placeholder:"Senha"})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{children:"Funo"}),w.jsx(_r,{value:"NOVO (Ser atribudo pelo Admin)",disabled:!0,className:"bg-muted"}),w.jsx("p",{className:"text-xs text-muted-foreground",children:"Novos usurios so criados como tipo NOVO. O administrador deve atribuir a funo apropriada aps o cadastro."})]}),!1]}),w.jsxs(Ot,{onClick:Ye,children:[w.jsx(tu,{className:"mr-2 h-4 w-4"}),"Criar Usurio"]})]})})]}),w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Gesto de Usurios"}),w.jsx(Cr,{children:"Visualize e gerencie os usurios do sistema."})]}),w.jsx(jt,{children:w.jsx("div",{className:"rounded-md border",children:w.jsxs(Ba,{children:[w.jsx(Za,{children:w.jsxs(dr,{children:[w.jsx(Tt,{children:"Nome"}),w.jsx(Tt,{children:"Email"}),w.jsx(Tt,{children:"Funo"}),w.jsx(Tt,{children:"Vendedor"}),w.jsx(Tt,{className:"text-right",children:"Aes"})]})}),w.jsx(Ua,{children:o.map(je=>w.jsxs(dr,{children:[w.jsx(Pt,{className:"font-medium",children:je.name}),w.jsx(Pt,{children:je.email}),w.jsx(Pt,{children:w.jsx(Un,{variant:je.role==="ADMIN"?"default":je.role==="NOVO"?"destructive":"secondary",children:je.role||"NOVO"})}),w.jsx(Pt,{children:w.jsx(Un,{variant:"outline",children:je.vendedor||"GERAL"})}),w.jsx(Pt,{className:"text-right",children:w.jsxs("div",{className:"flex justify-end gap-2",children:[w.jsx(Ot,{variant:"ghost",size:"icon",className:"hover:bg-primary/10",onClick:()=>{_(je),A(je.name),D(je.role),F(je.vendedor||""),X("")},children:w.jsx(ex,{className:"h-4 w-4 text-primary"})}),w.jsx(Ot,{variant:"ghost",size:"icon",className:"hover:bg-destructive/10",onClick:()=>z({id:je.id,name:je.name}),disabled:je.id===(t==null?void 0:t.id),children:w.jsx(zn,{className:"h-4 w-4 text-destructive"})})]})})]},je.id))})]})})})]})]})]}),w.jsx(ri,{open:!!re,onOpenChange:je=>!je&&z(null),children:w.jsxs(As,{className:"sm:max-w-[425px]",children:[w.jsxs(Cs,{children:[w.jsxs(js,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[w.jsx(zn,{className:"h-5 w-5"}),"Confirmar Excluso"]}),w.jsxs(Os,{className:"pt-2",children:["Tem certeza que deseja excluir o usurio ",w.jsxs("span",{className:"font-semibold text-foreground",children:['"',re==null?void 0:re.name,'"']}),"?"]}),w.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mt-4",children:w.jsx("p",{className:"text-sm text-destructive font-medium",children:" Esta ao no pode ser desfeita. O usurio perder acesso ao sistema."})})]}),w.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[w.jsx(Ot,{variant:"outline",onClick:()=>z(null),className:"flex-1 sm:flex-initial",children:"No"}),w.jsx(Ot,{variant:"destructive",onClick:rt,className:"flex-1 sm:flex-initial",children:"Sim, Excluir"})]})]})}),w.jsx(ri,{open:!!ee,onOpenChange:je=>!je&&L(null),children:w.jsxs(As,{className:"sm:max-w-[425px]",children:[w.jsxs(Cs,{children:[w.jsxs(js,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[w.jsx(zn,{className:"h-5 w-5"}),"Confirmar Excluso"]}),w.jsx(Os,{className:"pt-2",children:"Tem certeza que deseja excluir este motivo de devoluo?"}),w.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mt-4",children:w.jsx("p",{className:"text-sm text-destructive font-medium",children:" Esta ao no pode ser desfeita."})})]}),w.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[w.jsx(Ot,{variant:"outline",onClick:()=>L(null),className:"flex-1 sm:flex-initial",children:"No"}),w.jsx(Ot,{variant:"destructive",onClick:it,className:"flex-1 sm:flex-initial",children:"Sim, Excluir"})]})]})}),w.jsx(ri,{open:!!M,onOpenChange:je=>!je&&K(null),children:w.jsxs(As,{className:"sm:max-w-[425px]",children:[w.jsxs(Cs,{children:[w.jsxs(js,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[w.jsx(zn,{className:"h-5 w-5"}),"Confirmar Excluso"]}),w.jsxs(Os,{className:"pt-2",children:["Tem certeza que deseja remover o vendedor ",w.jsxs("span",{className:"font-semibold text-foreground",children:['"',M,'"']})," da lista?"]}),w.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mt-4",children:w.jsx("p",{className:"text-sm text-destructive font-medium",children:" Esta ao no pode ser desfeita."})})]}),w.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[w.jsx(Ot,{variant:"outline",onClick:()=>K(null),className:"flex-1 sm:flex-initial",children:"No"}),w.jsx(Ot,{variant:"destructive",onClick:et,className:"flex-1 sm:flex-initial",children:"Sim, Remover"})]})]})}),w.jsx(ri,{open:!!C,onOpenChange:je=>{je||(_(null),X(""))},children:w.jsxs(As,{className:"sm:max-w-[500px]",children:[w.jsxs(Cs,{children:[w.jsxs(js,{className:"text-xl font-bold flex items-center gap-2",children:[w.jsx(ex,{className:"h-5 w-5 text-primary"}),"Editar Usurio"]}),w.jsxs(Os,{className:"pt-2",children:["Alterar permisses e dados de ",w.jsx("span",{className:"font-semibold text-foreground",children:C==null?void 0:C.name})]})]}),w.jsxs("div",{className:"space-y-4 py-4",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{className:"text-sm font-medium",children:"Nome"}),w.jsx(_r,{value:k,onChange:je=>A(je.target.value),className:"h-10"})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{className:"text-sm font-medium",children:"Funo (Role)"}),w.jsxs($n,{value:T||"",onValueChange:je=>{D(je),je!=="VENDEDOR"&&F("")},children:[w.jsx(xn,{className:"h-10",children:w.jsx(Vn,{})}),w.jsxs(yn,{children:[w.jsx(sr,{value:"ADMIN",children:"ADMIN"}),w.jsx(sr,{value:"GESTOR",children:"GESTOR"}),w.jsx(sr,{value:"COMERCIAL",children:"COMERCIAL"}),w.jsx(sr,{value:"LOGISTICA",children:"LOGISTICA"}),w.jsx(sr,{value:"VENDEDOR",children:"VENDEDOR"}),w.jsx(sr,{value:"NOVO",children:"NOVO (Sem Acesso)"})]})]})]}),T==="VENDEDOR"&&w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{className:"text-sm font-medium",children:"Vendedor *"}),w.jsxs($n,{value:B,onValueChange:F,children:[w.jsx(xn,{className:"h-10",children:w.jsx(Vn,{placeholder:"Selecione o vendedor"})}),w.jsxs(yn,{children:[i.map(je=>w.jsx(sr,{value:je,children:je},je)),i.length===0&&w.jsx(sr,{value:"",disabled:!0,children:"Nenhum vendedor cadastrado"})]})]})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{className:"text-sm font-medium",children:"Nova Senha (opcional)"}),w.jsx(_r,{type:"password",value:Y,onChange:je=>X(je.target.value),placeholder:"Deixe em branco para manter a senha atual",minLength:6,className:"h-10"}),w.jsx("p",{className:"text-xs text-muted-foreground",children:"Mnimo de 6 caracteres. Deixe em branco para no alterar."})]})]}),w.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[w.jsx(Ot,{variant:"outline",onClick:()=>{_(null),X("")},className:"flex-1 sm:flex-initial",children:"Cancelar"}),w.jsx(Ot,{onClick:at,className:"flex-1 sm:flex-initial bg-primary hover:bg-primary/90",children:"Salvar Alteraes"})]})]})})]})}function EB(t,r=[]){let e=[];function a(o,s){const l=Se.createContext(s);l.displayName=o+"Context";const c=e.length;e=[...e,s];const i=p=>{var x;const{scope:f,children:h,...v}=p,b=((x=f==null?void 0:f[t])==null?void 0:x[c])||l,g=Se.useMemo(()=>v,Object.values(v));return w.jsx(b.Provider,{value:g,children:h})};i.displayName=o+"Provider";function u(p,f){var b;const h=((b=f==null?void 0:f[t])==null?void 0:b[c])||l,v=Se.useContext(h);if(v)return v;if(s!==void 0)return s;throw new Error(`\`${p}\` must be used within \`${o}\``)}return[i,u]}const n=()=>{const o=e.map(s=>Se.createContext(s));return function(l){const c=(l==null?void 0:l[t])||o;return Se.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return n.scopeName=t,[a,TB(n,...r)]}function TB(...t){const r=t[0];if(t.length===1)return r;const e=()=>{const a=t.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(o){const s=a.reduce((l,{useScope:c,scopeName:i})=>{const p=c(o)[`__scope${i}`];return{...l,...p}},{});return Se.useMemo(()=>({[`__scope${r.scopeName}`]:s}),[s])}};return e.scopeName=r.scopeName,e}var AB=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],m1=AB.reduce((t,r)=>{const e=mm(`Primitive.${r}`),a=Se.forwardRef((n,o)=>{const{asChild:s,...l}=n,c=s?e:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),w.jsx(c,{...l,ref:o})});return a.displayName=`Primitive.${r}`,{...t,[r]:a}},{}),CB=l8();function NB(){return CB.useSyncExternalStore(jB,()=>!0,()=>!1)}function jB(){return()=>{}}var g1="Avatar",[OB,JB]=EB(g1),[DB,s3]=OB(g1),i3=Se.forwardRef((t,r)=>{const{__scopeAvatar:e,...a}=t,[n,o]=Se.useState("idle");return w.jsx(DB,{scope:e,imageLoadingStatus:n,onImageLoadingStatusChange:o,children:w.jsx(m1.span,{...a,ref:r})})});i3.displayName=g1;var o3="AvatarImage",l3=Se.forwardRef((t,r)=>{const{__scopeAvatar:e,src:a,onLoadingStatusChange:n=()=>{},...o}=t,s=s3(o3,e),l=MB(a,o),c=um(i=>{n(i),s.onImageLoadingStatusChange(i)});return xu(()=>{l!=="idle"&&c(l)},[l,c]),l==="loaded"?w.jsx(m1.img,{...o,ref:r,src:a}):null});l3.displayName=o3;var c3="AvatarFallback",u3=Se.forwardRef((t,r)=>{const{__scopeAvatar:e,delayMs:a,...n}=t,o=s3(c3,e),[s,l]=Se.useState(a===void 0);return Se.useEffect(()=>{if(a!==void 0){const c=window.setTimeout(()=>l(!0),a);return()=>window.clearTimeout(c)}},[a]),s&&o.imageLoadingStatus!=="loaded"?w.jsx(m1.span,{...n,ref:r}):null});u3.displayName=c3;function Jy(t,r){return t?r?(t.src!==r&&(t.src=r),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function MB(t,{referrerPolicy:r,crossOrigin:e}){const a=NB(),n=Se.useRef(null),o=a?(n.current||(n.current=new window.Image),n.current):null,[s,l]=Se.useState(()=>Jy(o,t));return xu(()=>{l(Jy(o,t))},[o,t]),xu(()=>{const c=p=>()=>{l(p)};if(!o)return;const i=c("loaded"),u=c("error");return o.addEventListener("load",i),o.addEventListener("error",u),r&&(o.referrerPolicy=r),typeof e=="string"&&(o.crossOrigin=e),()=>{o.removeEventListener("load",i),o.removeEventListener("error",u)}},[o,e,r]),s}var d3=i3,f3=l3,h3=u3;const p3=Se.forwardRef(({className:t,...r},e)=>w.jsx(d3,{ref:e,className:Et("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...r}));p3.displayName=d3.displayName;const m3=Se.forwardRef(({className:t,...r},e)=>w.jsx(f3,{ref:e,className:Et("aspect-square h-full w-full",t),...r}));m3.displayName=f3.displayName;const g3=Se.forwardRef(({className:t,...r},e)=>w.jsx(h3,{ref:e,className:Et("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...r}));g3.displayName=h3.displayName;function RB(){const{user:t}=Oa(),{filters:r}=ec(),[e,a]=Se.useState(""),[n,o]=Se.useState(!1),[s,l]=Se.useState([]),[c,i]=Se.useState(1),[u,p]=Se.useState(0),f=100,[h,v]=Se.useState({myReturnsCount:0,approvalRate:0,totalValue:0,avgCompanyTicket:0,avgCompanyReturns:0}),[b,g]=Se.useState([]),[x,y]=Se.useState(""),[E,N]=Se.useState(null),[I,P]=Se.useState(!1),[V,U]=Se.useState(new Date);Se.useEffect(()=>{t&&(H(),(t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA")&&A(),(t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA")&&G())},[t,r,c]);const H=async()=>{if(!t)return;let B=St.from("devolucoes").select("*");t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"||(t.role==="VENDEDOR"&&t.vendedor?B=B.eq("vendedor",t.vendedor):B=B.ilike("vendedor",`%${t.name}%`)),r.startDate&&(B=B.gte("data_emissao",r.startDate.toISOString())),r.endDate&&(B=B.lte("data_emissao",r.endDate.toISOString()));const{data:F}=await B;let Y=St.from("devolucoes").select("*");r.startDate&&(Y=Y.gte("data_emissao",r.startDate.toISOString())),r.endDate&&(Y=Y.lte("data_emissao",r.endDate.toISOString()));const{data:X}=await Y;if(F){const re=F.length,z=F.reduce((he,ke)=>he+(Number(ke.valor_total_nota)||0),0),ee=F.filter(he=>he.resultado&&he.resultado!=="PENDENTE VALIDAO"),L=F.filter(he=>he.resultado==="VALIDADA"||he.resultado==="LANADA").length,M=ee.length>0?L/ee.length*100:0,K=(X==null?void 0:X.length)||0,se=(X==null?void 0:X.reduce((he,ke)=>he+(Number(ke.valor_total_nota)||0),0))||0,te=K>0?se/K:0,ae=re>0?z/re:0;v({myReturnsCount:re,totalValue:z,approvalRate:Math.round(M),avgCompanyTicket:te,avgCompanyReturns:K});const Q=F.reduce((he,ke)=>{const pe=new Date(ke.data_emissao||ke.created_at),Ce=Xt(pe,"MMM yyyy",{locale:yr});return he[Ce]||(he[Ce]={count:0,value:0}),he[Ce].count+=1,he[Ce].value+=Number(ke.valor_total_nota)||0,he},{}),fe=Object.entries(Q).map(([he,ke])=>({name:he,quantidade:ke.count,valor:ke.value})).sort((he,ke)=>{var st,je;const pe={jan:1,fev:2,mar:3,abr:4,mai:5,jun:6,jul:7,ago:8,set:9,out:10,nov:11,dez:12},Ce=he.name.toLowerCase().split(" "),Me=ke.name.toLowerCase().split(" "),Ie=pe[((st=Ce[0])==null?void 0:st.substring(0,3))||""]||0,Ye=pe[((je=Me[0])==null?void 0:je.substring(0,3))||""]||0,at=parseInt(Ce[1]||"0"),rt=parseInt(Me[1]||"0"),it=new Date(at,Ie-1),et=new Date(rt,Ye-1);return it.getTime()-et.getTime()});g(fe);const le=ae>te?"acima":ae<te?"abaixo":"igual",ne=te>0?Math.abs((ae-te)/te*100).toFixed(1):"0";let ue=`Voc registrou ${re} devolues neste perodo, totalizando R$ ${z.toLocaleString("pt-BR")}. `;ue+=`Sua taxa de aprovao  de ${Math.round(M)}%. `,re>0&&K>0&&(ue+=`Seu ticket mdio (R$ ${ae.toLocaleString("pt-BR",{maximumFractionDigits:0})}) est ${le} da mdia da empresa (R$ ${te.toLocaleString("pt-BR",{maximumFractionDigits:0})}). `,le!=="igual"&&(ue+=`Diferena de ${ne}%. `)),ue+=`A empresa registrou ${K} devolues no total neste perodo.`,y(ue)}},G=async()=>{if(!(!t||t.role!=="ADMIN"&&t.role!=="COMERCIAL"&&t.role!=="LOGISTICA"))try{const{data:B}=await St.from("profiles").select("id, name, role, vendedor").eq("role","VENDEDOR");if(!B)return;const{data:F}=await St.from("devolucoes").select(`
            *,
            logs_validacao(
              usuario_id,
              created_at,
              status_novo,
              status_anterior
            )
          `);if(!F)return;const Y={};B.forEach(re=>{re.vendedor&&(Y[re.vendedor]={id:re.id,name:re.name,role:re.role,vendedor:re.vendedor,tempoMedioValidacao:0,diasAtraso:0,totalValidacoes:0,notasPendentes:0,notasCancelamento:0,devolucoesValidadas:[],ultimaValidacao:null})}),new Date().setHours(0,0,0,0),F.forEach(re=>{const z=re.vendedor;if(!z||!Y[z])return;const ee=Y[z],L=re.logs_validacao||[];re.resultado==="PENDENTE VALIDAO"&&ee.notasPendentes++,re.resultado==="TRATATIVA DE ANULAO"&&ee.notasCancelamento++;const M=L.find(K=>K.status_novo==="VALIDADA");if(M){const K=new Date(M.created_at),se=new Date(re.data_emissao||re.created_at),te=Math.floor((K.getTime()-se.getTime())/(1e3*60*60*24));ee.totalValidacoes++,ee.tempoMedioValidacao+=te,(!ee.ultimaValidacao||K>ee.ultimaValidacao)&&(ee.ultimaValidacao=K),ee.devolucoesValidadas.push({dias:te,prazo:re.prazo})}}),Object.keys(Y).forEach(re=>{const z=Y[re];z.totalValidacoes>0&&(z.tempoMedioValidacao=Math.round(z.tempoMedioValidacao/z.totalValidacoes));const ee=F.filter(L=>L.vendedor===re&&L.resultado==="PENDENTE VALIDAO"&&L.prazo==="EM ATRASO"&&L.dias!=null&&L.dias>0);if(ee.length>0){const L=ee.reduce((M,K)=>M+(Number(K.dias)||0),0);z.diasAtraso=Math.round(L/ee.length)}else z.diasAtraso=0}),N({usuarios:Object.values(Y),totalUsuarios:Object.keys(Y).length})}catch(B){console.error("Erro ao buscar KPIs de usurios:",B)}},Z=async B=>{if(!t||t.role!=="VENDEDOR"||!t.vendedor)return[];const F=Xt(B,"yyyy-MM-dd");console.log("Buscando validaes para a data:",F),console.log("Vendedor do usurio:",t.vendedor);const{data:Y,error:X}=await St.from("devolucoes").select(`
        *,
        itens:itens_devolucao(*, motivo_item:motivos_devolucao(nome)),
        logs_validacao!inner(
          created_at,
          status_novo,
          acao
        )
      `).eq("vendedor",t.vendedor).eq("resultado","VALIDADA").eq("logs_validacao.status_novo","VALIDADA");if(X){console.error("Erro ao buscar devolues com logs:",X),console.log("Tentando fallback: buscar devolues sem join...");const{data:ee,error:L}=await St.from("devolucoes").select(`
          *,
          itens:itens_devolucao(*, motivo_item:motivos_devolucao(nome))
        `).eq("vendedor",t.vendedor).eq("resultado","VALIDADA");if(L)return console.error("Erro ao buscar devolues simples:",L),[];if(console.log("Devolues encontradas (sem filtro de data):",(ee==null?void 0:ee.length)||0),ee&&ee.length>0){const M=ee.map(Q=>Q.id),{data:K,error:se}=await St.from("logs_validacao").select("devolucao_id, created_at, status_novo").in("devolucao_id",M).eq("status_novo","VALIDADA").order("created_at",{ascending:!1});if(se)return console.error("Erro ao buscar logs:",se),console.log("Retornando todas as devolues sem filtro de data"),ee;console.log("Logs encontrados:",(K==null?void 0:K.length)||0),K&&K.length>0?console.log("Primeiros 3 logs:",K.slice(0,3).map(Q=>({devolucao_id:Q.devolucao_id,created_at:Q.created_at,data_formatada:Xt(new Date(Q.created_at),"yyyy-MM-dd"),status:Q.status_novo}))):console.log(" Nenhum log encontrado para as devolues!");const te=new Map;if(K==null||K.forEach(Q=>{const fe=te.get(Q.devolucao_id),le=new Date(Q.created_at);(!fe||le>fe)&&te.set(Q.devolucao_id,le)}),console.log("Mapa de validaes criado:",te.size,"devolues com data de validao"),console.log("Data buscada:",F),te.size>0){const Q=Array.from(te.entries()).slice(0,5);console.log("Primeiras datas de validao:",Q.map(([fe,le])=>({devolucao_id:fe.substring(0,8)+"...",data:Xt(le,"yyyy-MM-dd")})))}const ae=ee.filter(Q=>{const fe=te.get(Q.id);if(!fe)return console.log("Devoluo",Q.numero,"no tem data de validao nos logs"),!1;const le=Xt(fe,"yyyy-MM-dd"),ne=le===F;return ne||console.log("Devoluo",Q.numero,"validada em",le,"no corresponde a",F),ne});return console.log("Devolues filtradas pela data:",ae.length),ae.length>0&&console.log("Primeiras devolues filtradas:",ae.slice(0,3).map(Q=>({numero:Q.numero,vendedor:Q.vendedor}))),ae}return[]}if(!Y||Y.length===0)return console.log("Nenhuma devoluo encontrada"),[];console.log("Devolues encontradas (com join):",Y.length);const re=Y.filter(ee=>{const L=ee.logs_validacao||[];if(L.length===0)return!1;const M=L.filter(te=>te.status_novo==="VALIDADA").sort((te,ae)=>new Date(ae.created_at).getTime()-new Date(te.created_at).getTime())[0];if(!M)return!1;const K=new Date(M.created_at);return Xt(K,"yyyy-MM-dd")===F});return console.log("Devolues filtradas pela data:",re.length),re.map(ee=>{const{logs_validacao:L,...M}=ee;return M})},W=async()=>{if(!t||t.role!=="VENDEDOR"||!t.vendedor)return[];const{data:B}=await St.from("devolucoes").select(`
        *,
        itens:itens_devolucao(*)
      `).eq("vendedor",t.vendedor).eq("resultado","TRATATIVA DE ANULAO").order("data_emissao",{ascending:!1});return B||[]},O=(B,F)=>{if(!t||!t.vendedor)return"";const Y=Xt(F,"dd/MM/yyyy",{locale:yr});let X=` *RESUMO: NOTAS VALIDADAS - ${t.vendedor}*

`;return X+=` *DATA DA VALIDAO* ${Y}
`,X+=` *USURIO* ${t.name}

`,X+=` *DETALHAMENTO*

`,B.forEach((re,z)=>{var se,te;X+=`============= ${z+1} NOTA FISCAL =============
`,X+=` *DEVOLUO N* ${re.numero||"-"}
`,X+=` *Cliente:* ${re.nome_cliente||"-"}
`,X+=` *Vendedor:* ${re.vendedor||"-"}
`,X+=` *Data de Emisso:* ${Xt(new Date(re.data_emissao),"dd/MM/yyyy",{locale:yr})}
`,X+=` *Observao:* ${re.justificativa||"-"}
`;const ee=((se=re.itens)==null?void 0:se.reduce((ae,Q)=>ae+(Number(Q.valor_total_bruto)||0),0))||Number(re.valor_total_nota)||0;X+=` *Valor Total da NFD:* R$ ${ee.toFixed(2)}
`;const L=new Date(re.data_emissao),M=new Date(F),K=Math.floor((M.getTime()-L.getTime())/(1e3*60*60*24));X+=` *Mdia de Dias p/ Validao:* ${K} dias
`,X+=` *Prazo:* ${K>=3?"VALIDADA COM ATRASO":"DENTRO DO PRAZO"}
`,X+=`-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
`,(te=re.itens)==null||te.forEach(ae=>{var le;const fe=(ae.descricao||"-").split(" ").slice(0,3).join(" ");X+=` *Produto:* ${fe}
`,X+=` *Quantidade:* ${ae.quantidade||0} ${ae.unidade||"UN"}
`,X+=` *Valor Total:* R$ ${Number(ae.valor_total_bruto||0).toFixed(2)}
`,X+=` *Motivo:* ${((le=ae.motivo_item)==null?void 0:le.nome)||"-"}
`,X+=`-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
`})}),X},R=B=>{if(!t||!t.vendedor)return"";let F=` *RESUMO: NOTAS EM TRATATIVAS - ${t.vendedor}*

`;return F+=` *DATA DA SINALIZAO* ${Xt(new Date,"dd/MM/yyyy",{locale:yr})}
`,F+=` *USURIO* ${t.name}

`,F+=` *DETALHAMENTO*

`,B.forEach((Y,X)=>{var z,ee;F+=`============= ${X+1} NOTA FISCAL =============
`,F+=` *DEVOLUO N* ${Y.numero||"-"}
`,F+=` *Cliente:* ${Y.nome_cliente||"-"}
`,F+=` *Vendedor:* ${Y.vendedor||"-"}
`,F+=` *Data de Emisso:* ${Xt(new Date(Y.data_emissao),"dd/MM/yyyy",{locale:yr})}
`;const re=((z=Y.itens)==null?void 0:z.reduce((L,M)=>L+(Number(M.valor_total_bruto)||0),0))||Number(Y.valor_total_nota)||0;F+=` *Valor Total da NFD:* R$ ${re.toFixed(2)}
`,F+=` *Observao:* ${Y.justificativa||"-"}
`,F+=`-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
`,(ee=Y.itens)==null||ee.forEach(L=>{const K=(L.descricao||"-").split(" ").slice(0,3).join(" ");F+=` *Produto:* ${K}
`})}),F},C=B=>{const F=encodeURIComponent(B);window.open(`https://api.whatsapp.com/send?text=${F}`,"_blank")},_=async()=>{if(!V){wt.error("Selecione uma data");return}const B=await Z(V);if(B.length===0){wt.error("Nenhuma validao encontrada para esta data");return}const F=O(B,V);C(F),P(!1)},k=async()=>{const B=await W();if(B.length===0){wt.error("Nenhuma tratativa encontrada");return}const F=R(B);C(F)},A=async()=>{console.log(" fetchAuditLogs - Iniciando busca de logs para role:",t==null?void 0:t.role);let B=St.from("logs_validacao").select("*",{count:"exact",head:!0});r.startDate&&(B=B.gte("created_at",r.startDate.toISOString())),r.endDate&&(B=B.lte("created_at",r.endDate.toISOString()));const{count:F,error:Y}=await B;Y&&console.error(" Erro ao contar logs:",Y),console.log(" Total de logs encontrados:",F),p(F||0);const X=(c-1)*f,re=X+f-1;let z=St.from("logs_validacao").select(`
            *,
            user:profiles(name, email),
            devolucao:devolucoes(numero, nome_cliente)
        `).order("created_at",{ascending:!1}).range(X,re);r.startDate&&(z=z.gte("created_at",r.startDate.toISOString())),r.endDate&&(z=z.lte("created_at",r.endDate.toISOString()));const{data:ee,error:L}=await z;L?console.error(" Erro ao buscar logs:",L):console.log(" Logs carregados:",(ee==null?void 0:ee.length)||0),l(ee||[])},T=async B=>{B.preventDefault(),o(!0);try{const{error:F}=await St.auth.updateUser({password:e});if(F)throw F;wt.success("Senha atualizada com sucesso!"),a("")}catch(F){wt.error(F.message)}finally{o(!1)}},D=async()=>{if(!t||t.role!=="VENDEDOR"){wt.error("Apenas vendedores podem enviar validao por email");return}o(!0);try{const{data:{session:B},error:F}=await St.auth.getSession();if(F||!B)throw new Error("Usurio no autenticado. Por favor, faa login novamente.");const Y=new Date;Y.setHours(0,0,0,0);const{data:X,error:re}=await St.functions.invoke("send-validation-email",{body:{userId:t.id,email:t.email,vendedorNome:t.vendedor||t.name,data:Y.toISOString()}});if(re)throw console.error("Erro detalhado:",re),re;console.log("Resposta da funo:",X),wt.success("Email de validao enviado com sucesso!")}catch(B){console.error("Erro ao enviar email:",B);const F=B.message||B.error||"Erro desconhecido";wt.error("Erro ao enviar email: "+F)}finally{o(!1)}};return t?!t.role||t.role==="NOVO"?w.jsxs("div",{className:"space-y-6",children:[w.jsx(Qi,{title:"Meu Perfil",description:"Aguarde a atribuio de permisses por um administrador para acessar os recursos do sistema."}),w.jsx(Nt,{children:w.jsx(jt,{className:"pt-6",children:w.jsxs("div",{className:"text-center py-12",children:[w.jsx(tx,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground opacity-50"}),w.jsx("p",{className:"text-muted-foreground",children:"Seu perfil est aguardando a atribuio de permisses por um administrador."}),w.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Entre em contato com o administrador do sistema para obter acesso."})]})})})]}):w.jsxs("div",{className:"space-y-6",children:[w.jsx(Qi,{title:t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"?"Painel Administrativo":"Meu Perfil",description:t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"?"Viso geral de todos os dados do sistema, mtricas gerais e KPIs de usurios.":"Visualize suas mtricas pessoais, histrico de validaes e gerencie suas configuraes de segurana."}),w.jsxs("div",{className:"grid gap-6 md:grid-cols-7",children:[w.jsxs(Nt,{className:"md:col-span-2 h-fit",children:[w.jsxs(Dt,{className:"text-center",children:[w.jsx("div",{className:"flex justify-center mb-4",children:w.jsxs(p3,{className:"h-24 w-24 border-4 border-primary/10",children:[w.jsx(m3,{src:t.avatar_url}),w.jsx(g3,{className:"text-2xl font-bold text-primary bg-primary/10",children:t.name.charAt(0).toUpperCase()})]})}),w.jsx(Mt,{children:t.name}),w.jsx(Cr,{children:t.email}),w.jsxs("div",{className:"mt-2 space-y-1",children:[w.jsx(Un,{variant:"outline",className:"border-primary text-primary",children:t.role||"Sem permisses"}),t.role==="VENDEDOR"&&t.vendedor&&w.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:[w.jsx("div",{className:"font-medium",children:"VENDEDOR"}),w.jsx("div",{className:"text-primary font-semibold",children:t.vendedor})]})]})]}),w.jsx(jt,{children:w.jsxs("div",{className:"space-y-4 text-sm bg-muted/30 p-4 rounded-lg",children:[w.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[w.jsx(Ip,{className:"h-4 w-4 text-primary"}),w.jsxs("span",{className:"truncate",title:t.id,children:["ID: ",t.id.slice(0,8),"..."]})]}),w.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[w.jsx(qS,{className:"h-4 w-4 text-primary"}),w.jsx("span",{className:"truncate",title:t.email,children:t.email})]}),w.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[w.jsx(tx,{className:"h-4 w-4 text-primary"}),w.jsxs("span",{children:["Acesso: ",t.role]})]})]})})]}),w.jsxs(Nt,{className:"md:col-span-5",children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Painel do Usurio"}),w.jsx(Cr,{children:"Suas mtricas e configuraes pessoais"})]}),w.jsx(jt,{children:w.jsxs(n3,{defaultValue:t.role==="GESTOR"?"security":"overview",children:[w.jsxs(p1,{className:"w-full justify-start",children:[t.role!=="GESTOR"&&w.jsx(Yi,{value:"overview",children:"Viso Geral"}),(t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA")&&w.jsx(Yi,{value:"audit",children:"Histrico de Validaes"}),w.jsx(Yi,{value:"security",children:"Segurana"})]}),w.jsxs(Xi,{value:"overview",className:"space-y-6 mt-6",children:[w.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[w.jsxs(Nt,{className:"bg-primary/5 border-primary/20",children:[w.jsxs(Dt,{className:"pb-2 flex flex-row items-center justify-between",children:[w.jsx(Mt,{className:"text-sm font-medium text-muted-foreground",children:t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"?"Total de Devolues":"Minhas Devolues"}),w.jsx(JS,{className:"h-4 w-4 text-primary"})]}),w.jsxs(jt,{children:[w.jsx("div",{className:"text-2xl font-bold text-foreground",children:h.myReturnsCount}),w.jsx("p",{className:"text-xs text-muted-foreground",children:"No perodo selecionado"})]})]}),w.jsxs(Nt,{children:[w.jsxs(Dt,{className:"pb-2 flex flex-row items-center justify-between",children:[w.jsx(Mt,{className:"text-sm font-medium text-muted-foreground",children:"Valor Envolvido"}),w.jsx(_u,{className:"h-4 w-4 text-muted-foreground"})]}),w.jsxs(jt,{children:[w.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",h.totalValue.toLocaleString("pt-BR",{maximumFractionDigits:0})]}),w.jsx("p",{className:"text-xs text-muted-foreground",children:"Total devolvido"})]})]}),w.jsxs(Nt,{children:[w.jsxs(Dt,{className:"pb-2 flex flex-row items-center justify-between",children:[w.jsx(Mt,{className:"text-sm font-medium text-muted-foreground",children:"Taxa de Aprovao"}),w.jsx(Kb,{className:"h-4 w-4 text-muted-foreground"})]}),w.jsxs(jt,{children:[w.jsxs("div",{className:"text-2xl font-bold",children:[h.approvalRate,"%"]}),w.jsx("p",{className:"text-xs text-muted-foreground",children:"Das devolues finalizadas"})]})]})]}),b.length>0&&w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"?"Devolues no Tempo":"Minhas Devolues no Tempo"}),w.jsx(Cr,{children:t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"?"Evoluo mensal de todas as devolues":"Evoluo mensal das suas devolues"})]}),w.jsx(jt,{children:w.jsx(Jr,{width:"100%",height:300,children:w.jsxs(c8,{data:b,children:[w.jsx(ca,{strokeDasharray:"3 3",className:"stroke-muted/30"}),w.jsx(ua,{dataKey:"name",className:"text-xs"}),w.jsx($r,{yAxisId:"left",className:"text-xs"}),w.jsx($r,{yAxisId:"right",orientation:"right",className:"text-xs",tickFormatter:B=>`R$${B}`}),w.jsx(Qr,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)",color:"var(--foreground)"},formatter:(B,F)=>F==="quantidade"?[B,"Quantidade"]:F==="valor"?[`R$ ${(B||0).toLocaleString("pt-BR")}`,"Valor"]:[B,F||""]}),w.jsx(y2,{}),w.jsx(Xl,{yAxisId:"left",type:"monotone",dataKey:"quantidade",stroke:"#073e29",strokeWidth:2,name:"Quantidade"}),w.jsx(Xl,{yAxisId:"right",type:"monotone",dataKey:"valor",stroke:"#4a9170",strokeWidth:2,name:"Valor (R$)"})]})})})]}),h.myReturnsCount>0&&h.avgCompanyReturns>0&&w.jsxs(Nt,{children:[w.jsx(Dt,{children:w.jsx(Mt,{children:"Comparao com Mdia da Empresa"})}),w.jsxs(jt,{children:[w.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx("div",{className:"text-sm text-muted-foreground",children:"Seu Ticket Mdio"}),w.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",h.myReturnsCount>0?(h.totalValue/h.myReturnsCount).toLocaleString("pt-BR",{maximumFractionDigits:0}):"0"]})]}),w.jsxs("div",{className:"space-y-2",children:[w.jsx("div",{className:"text-sm text-muted-foreground",children:"Ticket Mdio da Empresa"}),w.jsxs("div",{className:"text-2xl font-bold text-muted-foreground",children:["R$ ",h.avgCompanyTicket.toLocaleString("pt-BR",{maximumFractionDigits:0})]})]})]}),h.myReturnsCount>0&&w.jsx("div",{className:"mt-4 p-3 bg-muted/50 rounded-lg",children:w.jsx("div",{className:"text-sm",children:h.totalValue/h.myReturnsCount>h.avgCompanyTicket?w.jsxs("span",{className:"text-orange-600 dark:text-orange-400",children:[" Seu ticket mdio est ",(h.totalValue/h.myReturnsCount/h.avgCompanyTicket*100-100).toFixed(1),"% acima da mdia da empresa."]}):h.totalValue/h.myReturnsCount<h.avgCompanyTicket?w.jsxs("span",{className:"text-green-600 dark:text-green-400",children:[" Seu ticket mdio est ",(100-h.totalValue/h.myReturnsCount/h.avgCompanyTicket*100).toFixed(1),"% abaixo da mdia da empresa."]}):w.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:" Seu ticket mdio est igual  mdia da empresa."})})})]})]}),w.jsxs("div",{className:"rounded-lg border p-6 bg-card flex items-start gap-4 shadow-sm",children:[w.jsx("div",{className:"p-3 bg-primary/10 rounded-full",children:w.jsx(Kb,{className:"h-6 w-6 text-primary"})}),w.jsxs("div",{children:[w.jsx("h3",{className:"font-semibold text-lg mb-1",children:"Resumo Automtico"}),w.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:x||(h.myReturnsCount>0?`Voc registrou ${h.myReturnsCount} devolues neste perodo, totalizando R$ ${h.totalValue.toLocaleString("pt-BR")}. Sua taxa de aprovao atual  de ${h.approvalRate}%.`:"Nenhuma atividade registrada para o perodo selecionado. Ajuste os filtros acima para ver seu histrico.")})]})]}),t.role==="VENDEDOR"&&t.vendedor&&w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Compartilhar Resumos"}),w.jsx(Cr,{children:"Compartilhe seus resumos via WhatsApp"})]}),w.jsx(jt,{children:w.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[w.jsxs(ri,{open:I,onOpenChange:P,children:[w.jsx(JN,{asChild:!0,children:w.jsxs(Ot,{className:"flex-1",variant:"outline",children:[w.jsx(Rp,{className:"mr-2 h-4 w-4"}),"COMPARTILHAR VALIDAO"]})}),w.jsxs(As,{children:[w.jsxs(Cs,{children:[w.jsx(js,{children:"Selecione a Data da Validao"}),w.jsx(Os,{children:"Escolha a data para gerar o resumo de validaes"})]}),w.jsx("div",{className:"py-4",children:w.jsx(Iw,{mode:"single",selected:V,onSelect:U,className:"rounded-md border"})}),w.jsxs(Ns,{children:[w.jsx(Ot,{variant:"outline",onClick:()=>P(!1),children:"Cancelar"}),w.jsx(Ot,{onClick:_,children:"OK"})]})]})]}),w.jsxs(Ot,{className:"flex-1",variant:"outline",onClick:k,children:[w.jsx(Rp,{className:"mr-2 h-4 w-4"}),"COMPARTILHAR TRATATIVAS"]})]})})]}),(t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA")&&E&&w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"KPIs de Usurios"}),w.jsx(Cr,{children:"Mtricas de desempenho por usurio"})]}),w.jsx(jt,{children:w.jsxs("div",{className:"space-y-4",children:[E.usuarios.map((B,F)=>w.jsxs("div",{className:"border rounded-lg p-4",children:[w.jsxs("div",{className:"flex items-center justify-between mb-2",children:[w.jsxs("div",{children:[w.jsx("h4",{className:"font-semibold",children:B.name}),B.role==="VENDEDOR"&&B.vendedor&&w.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[w.jsx("span",{className:"font-medium",children:"VENDEDOR:"})," ",w.jsx("span",{className:"text-primary font-semibold",children:B.vendedor})]})]}),w.jsx(Un,{variant:"outline",children:B.role})]}),w.jsxs("div",{className:"grid gap-2 md:grid-cols-3 text-sm",children:[B.role==="VENDEDOR"&&w.jsxs(w.Fragment,{children:[w.jsxs("div",{children:[w.jsx("span",{className:"text-muted-foreground",children:"Mdia Tempo Validao:"}),w.jsxs("span",{className:"ml-2 font-semibold",children:[B.tempoMedioValidacao," dias"]})]}),w.jsxs("div",{children:[w.jsx("span",{className:"text-muted-foreground",children:"Total Validaes:"}),w.jsx("span",{className:"ml-2 font-semibold",children:B.totalValidacoes})]}),w.jsxs("div",{children:[w.jsx("span",{className:"text-muted-foreground",children:"Dias em Atraso:"}),w.jsxs("span",{className:`ml-2 font-semibold ${B.diasAtraso>=3?"text-red-600":"text-green-600"}`,children:[B.diasAtraso," dias"]})]}),w.jsxs("div",{children:[w.jsx("span",{className:"text-muted-foreground",children:"Notas Pendentes:"}),w.jsx("span",{className:"ml-2 font-semibold",children:B.notasPendentes||0})]}),w.jsxs("div",{children:[w.jsx("span",{className:"text-muted-foreground",children:"Notas em Cancelamento:"}),w.jsx("span",{className:"ml-2 font-semibold",children:B.notasCancelamento||0})]})]}),B.role==="LOGISTICA"&&w.jsxs(w.Fragment,{children:[w.jsxs("div",{children:[w.jsx("span",{className:"text-muted-foreground",children:"Mdia Tempo Lanamento:"}),w.jsxs("span",{className:"ml-2 font-semibold",children:[B.tempoMedioLancamento," dias"]})]}),w.jsxs("div",{children:[w.jsx("span",{className:"text-muted-foreground",children:"Total Lanamentos:"}),w.jsx("span",{className:"ml-2 font-semibold",children:B.totalLancamentos})]})]})]})]},F)),E.usuarios.length===0&&w.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhum usurio VENDEDOR ou LOGISTICA encontrado."})]})})]})]}),w.jsxs(Xi,{value:"audit",className:"mt-6",children:[w.jsx("div",{className:"rounded-md border",children:w.jsxs(Ba,{children:[w.jsx(Za,{children:w.jsxs(dr,{children:[w.jsx(Tt,{children:"Data"}),w.jsx(Tt,{children:"Usurio"}),w.jsx(Tt,{children:"Nota Fiscal"}),w.jsx(Tt,{children:"Ao"}),w.jsx(Tt,{children:"Status Anterior"})]})}),w.jsx(Ua,{children:s&&s.length>0?s.map(B=>{var F,Y,X;return w.jsxs(dr,{children:[w.jsx(Pt,{className:"text-xs",children:Xt(new Date(B.created_at),"dd/MM/yyyy HH:mm")}),w.jsx(Pt,{className:"font-medium",children:((F=B.user)==null?void 0:F.name)||"Sistema"}),w.jsx(Pt,{children:((Y=B.devolucao)==null?void 0:Y.numero)||((X=B.devolucao_id)==null?void 0:X.slice(0,8))||"-"}),w.jsx(Pt,{children:w.jsx(Un,{variant:B.acao==="SELECIONAR_MOTIVO"||B.status_novo==="VALIDADA"?"default":B.status_novo==="TRATATIVA DE ANULAO"?"destructive":"secondary",children:B.acao==="SELECIONAR_MOTIVO"?"Validou":B.acao==="ALTERAR_RESULTADO"?"Alterou Resultado":B.acao||"Ao"})}),w.jsxs(Pt,{className:"text-muted-foreground text-xs",children:[B.status_anterior,"  ",B.status_novo]})]},B.id)}):w.jsx(dr,{children:w.jsxs(Pt,{colSpan:5,className:"text-center py-12 text-muted-foreground",children:[w.jsx(PS,{className:"h-10 w-10 mx-auto mb-3 opacity-20"}),w.jsx("p",{children:"Nenhum registro de validao encontrado."}),(t==null?void 0:t.role)==="COMERCIAL"||(t==null?void 0:t.role)==="LOGISTICA"?w.jsx("p",{className:"text-xs mt-2",children:"Carregando dados..."}):null]})})})]})}),u>0&&w.jsxs("div",{className:"flex items-center justify-between px-2 py-4 border-t",children:[w.jsx("div",{className:"text-sm text-muted-foreground",children:u>f?w.jsxs(w.Fragment,{children:["Mostrando ",(c-1)*f+1," a ",Math.min(c*f,u)," de ",u," registros"]}):w.jsxs(w.Fragment,{children:["Total de ",u," registro(s)"]})}),u>f&&w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsxs(Ot,{variant:"outline",size:"sm",onClick:()=>{i(B=>Math.max(1,B-1))},disabled:c===1,children:[w.jsx(yu,{className:"h-4 w-4"}),"Anterior"]}),w.jsxs("div",{className:"text-sm text-muted-foreground",children:["Pgina ",c," de ",Math.ceil(u/f)]}),w.jsxs(Ot,{variant:"outline",size:"sm",onClick:()=>{i(B=>{const F=Math.ceil(u/f);return Math.min(F,B+1)})},disabled:c>=Math.ceil(u/f),children:["Prxima",w.jsx(wu,{className:"h-4 w-4"})]})]})]})]}),w.jsxs(Xi,{value:"security",className:"mt-6",children:[w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Alterar Senha"}),w.jsx(Cr,{children:"Escolha uma senha forte para proteger sua conta."})]}),w.jsx(jt,{children:w.jsxs("form",{onSubmit:T,className:"space-y-4 max-w-md",children:[w.jsxs("div",{className:"space-y-2",children:[w.jsx(kr,{htmlFor:"new-password",children:"Nova Senha"}),w.jsx(_r,{id:"new-password",type:"password",value:e,onChange:B=>a(B.target.value),placeholder:"Mnimo de 6 caracteres",minLength:6})]}),w.jsx(Ot,{type:"submit",disabled:n||!e,children:n?"Atualizando...":"Atualizar Senha"})]})})]}),t.role==="VENDEDOR"&&w.jsxs(Nt,{children:[w.jsxs(Dt,{children:[w.jsx(Mt,{children:"Enviar Validao do Dia por E-mail"}),w.jsx(Cr,{children:"Envie um resumo da validao do dia atual por email com todas as informaes importantes."})]}),w.jsx(jt,{children:w.jsxs(Ot,{onClick:D,disabled:n,className:"w-full md:w-auto",children:[w.jsx(fk,{className:"mr-2 h-4 w-4"}),n?"Enviando...":"Enviar validao do dia por e-mail"]})})]})]})]})})]})]})]}):null}function IB(){const{user:t,logout:r}=Oa();return console.log("EmptyPage - Renderizando para usurio:",t==null?void 0:t.email,"role:",t==null?void 0:t.role),t?w.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background",children:w.jsxs(Nt,{className:"w-full max-w-md",children:[w.jsxs(Dt,{className:"text-center",children:[w.jsx(Mt,{className:"text-2xl",children:"Acesso Pendente"}),w.jsx(Cr,{children:"Seu cadastro est aguardando aprovao. Entre em contato com o administrador para obter acesso ao sistema."})]}),w.jsxs(jt,{className:"space-y-4",children:[w.jsxs("div",{className:"text-center space-y-2",children:[w.jsxs("p",{className:"text-sm text-muted-foreground",children:["Usurio: ",w.jsx("span",{className:"font-semibold",children:t==null?void 0:t.email})]}),w.jsxs("p",{className:"text-sm text-muted-foreground",children:["Status: ",w.jsx("span",{className:"font-semibold text-orange-600",children:"NOVO"})]})]}),w.jsxs(Ot,{variant:"destructive",className:"w-full",onClick:r,children:[w.jsx(Dp,{className:"mr-2 h-4 w-4"}),"Sair"]})]})]})}):w.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background",children:w.jsx("div",{className:"text-center",children:w.jsx("p",{className:"text-muted-foreground",children:"Carregando..."})})})}function FB({className:t,isOpen:r=!1,onClose:e}){const{user:a,logout:n}=Oa(),o=m2(),s=()=>{const p=document.querySelector("html");p&&(p.classList.contains("dark")?p.classList.remove("dark"):p.classList.add("dark"))};if(!a)return null;console.log("Sidebar - User role:",a.role,"Tipo:",typeof a.role);const l=[{label:"Dashboard Pendncias",icon:Jb,href:"/dashboard",roles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"]},{label:"Dashboard Lanadas",icon:Jb,href:"/dashboard-lancadas",roles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"]},{label:"Validao",icon:_f,href:"/validation",roles:["COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"]},{label:"Relatrios",icon:NS,href:"/reports",roles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"]},{label:"Sincronizao",icon:gm,href:"/sync",roles:["LOGISTICA","ADMIN"]},{label:"Configuraes",icon:pk,href:"/settings",roles:["ADMIN"]}],c=!a.role||a.role==="NOVO",i=typeof a.role=="string"?a.role.toUpperCase():a.role;console.log("Sidebar - Filtrando rotas com role:",i);const u=c?[]:l.filter(p=>p.roles.includes(i));return console.log("Sidebar - Rotas filtradas:",u.map(p=>p.label)),w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:Et("hidden lg:flex pb-12 w-64 border-r bg-card h-screen fixed left-0 top-0 z-30 shadow-lg flex-col dark:border-r-zinc-800 transition-transform duration-300 ease-in-out",r?"translate-x-0":"-translate-x-full",t),onClick:p=>p.stopPropagation(),children:[w.jsxs("div",{className:"px-6 py-8 flex flex-col items-center border-b border-border/50",children:[w.jsx("div",{className:"h-24 w-24 relative mb-3 flex items-center justify-center overflow-hidden",children:w.jsx("img",{src:"https://i.ibb.co/b095hpJ/Chat-GPT-Image-25-de-dez-de-2025-15-24-45.png",alt:"Logo Doce Mel",className:"object-contain rounded"})}),w.jsx("h2",{className:"text-xl font-bold tracking-tight text-primary font-serif",children:"TRIELO CD BA"}),w.jsx("p",{className:"text-[10px] text-muted-foreground uppercase tracking-widest mt-1",children:"Gesto de Devolues"})]}),!c&&w.jsx("div",{className:"flex-1 overflow-y-auto py-4 px-3",children:w.jsx("div",{className:"space-y-1",children:u.map(p=>w.jsx(sf,{to:p.href,children:w.jsxs(Ot,{variant:o.pathname===p.href?"secondary":"ghost",className:Et("w-full justify-start transition-all duration-200 mb-1",o.pathname===p.href?"bg-primary/10 text-primary font-bold border-r-4 border-primary rounded-r-none dark:text-primary dark:bg-primary/20":"hover:bg-muted text-muted-foreground hover:text-foreground"),children:[w.jsx(p.icon,{className:Et("mr-3 h-4 w-4",o.pathname===p.href?"text-primary":"text-muted-foreground")}),p.label]})},p.href))})}),w.jsxs("div",{className:"p-4 border-t border-border/50 bg-muted/10",children:[!c&&w.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[w.jsx("span",{className:"text-xs font-semibold text-muted-foreground",children:"Tema"}),w.jsxs(Ot,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:s,children:[w.jsx(nx,{className:"h-4 w-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),w.jsx(Qb,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"})]})]}),w.jsxs("div",{className:"space-y-1 mb-4",children:[!c&&w.jsx(sf,{to:"/profile",children:w.jsxs(Ot,{variant:o.pathname==="/profile"?"secondary":"ghost",className:"w-full justify-start h-9",children:[w.jsx(Ip,{className:"mr-2 h-4 w-4"}),"Perfil"]})}),w.jsxs(Ot,{variant:"ghost",className:"w-full justify-start text-destructive hover:text-destructive hover:bg-destructive/10 h-9",onClick:n,children:[w.jsx(Dp,{className:"mr-2 h-4 w-4"}),"Sair"]})]}),w.jsxs("div",{className:"flex items-center gap-3 px-2 py-2 rounded-lg bg-card border shadow-sm",children:[w.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/20 flex items-center justify-center text-primary font-bold text-xs",children:a.name.charAt(0).toUpperCase()}),w.jsxs("div",{className:"flex-1 overflow-hidden",children:[w.jsx("p",{className:"text-sm font-bold truncate text-foreground leading-none",children:a.name}),w.jsx("p",{className:"text-[10px] text-muted-foreground mt-1 truncate",children:a.role})]})]})]})]}),w.jsxs("div",{className:Et("lg:hidden pb-12 w-64 border-r bg-card h-screen fixed left-0 top-0 z-40 shadow-lg flex flex-col dark:border-r-zinc-800 transition-transform duration-300 ease-in-out",r?"translate-x-0":"-translate-x-full",t),onClick:p=>p.stopPropagation(),children:[w.jsxs("div",{className:"px-6 py-8 flex flex-col items-center border-b border-border/50 relative",children:[w.jsx(Ot,{variant:"ghost",size:"icon",className:"absolute top-4 right-4",onClick:e,children:w.jsx(Vf,{className:"h-5 w-5"})}),w.jsx("div",{className:"h-24 w-24 relative mb-3 flex items-center justify-center overflow-hidden",children:w.jsx("img",{src:"https://i.ibb.co/b095hpJ/Chat-GPT-Image-25-de-dez-de-2025-15-24-45.png",alt:"Logo Doce Mel",className:"object-contain rounded"})}),w.jsx("h2",{className:"text-xl font-bold tracking-tight text-foreground font-serif",children:"TRIELO CD BA"}),w.jsx("p",{className:"text-[10px] text-muted-foreground uppercase tracking-widest mt-1",children:"Gesto de Devolues"})]}),!c&&w.jsx("div",{className:"flex-1 overflow-y-auto py-4 px-3",children:w.jsx("div",{className:"space-y-1",children:u.map(p=>w.jsx(sf,{to:p.href,onClick:e,children:w.jsxs(Ot,{variant:o.pathname===p.href?"secondary":"ghost",className:Et("w-full justify-start transition-all duration-200 mb-1",o.pathname===p.href?"bg-primary/10 text-primary font-bold border-r-4 border-primary rounded-r-none dark:text-primary dark:bg-primary/20":"hover:bg-muted text-muted-foreground hover:text-foreground"),children:[w.jsx(p.icon,{className:Et("mr-3 h-4 w-4",o.pathname===p.href?"text-primary":"text-muted-foreground")}),p.label]})},p.href))})}),w.jsxs("div",{className:"p-4 border-t border-border/50 bg-muted/10",children:[!c&&w.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[w.jsx("span",{className:"text-xs font-semibold text-muted-foreground",children:"Tema"}),w.jsxs(Ot,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:s,children:[w.jsx(nx,{className:"h-4 w-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),w.jsx(Qb,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"})]})]}),w.jsxs("div",{className:"space-y-1 mb-4",children:[!c&&w.jsx(sf,{to:"/profile",onClick:e,children:w.jsxs(Ot,{variant:o.pathname==="/profile"?"secondary":"ghost",className:"w-full justify-start h-9",children:[w.jsx(Ip,{className:"mr-2 h-4 w-4"}),"Perfil"]})}),w.jsxs(Ot,{variant:"ghost",className:"w-full justify-start text-destructive hover:text-destructive hover:bg-destructive/10 h-9",onClick:n,children:[w.jsx(Dp,{className:"mr-2 h-4 w-4"}),"Sair"]})]}),w.jsxs("div",{className:"flex items-center gap-3 px-2 py-2 rounded-lg bg-card border shadow-sm",children:[w.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/20 flex items-center justify-center text-primary font-bold text-xs",children:a.name.charAt(0).toUpperCase()}),w.jsxs("div",{className:"flex-1 overflow-hidden",children:[w.jsx("p",{className:"text-sm font-bold truncate text-foreground leading-none",children:a.name}),w.jsx("p",{className:"text-[10px] text-muted-foreground mt-1 truncate",children:a.role})]})]})]})]})]})}function PB(){const{user:t}=Oa(),r=!(t!=null&&t.role)||t.role==="NOVO",[e,a]=Se.useState(!r),n=()=>{a(!e)},o=()=>{a(!1)};return w.jsxs("div",{className:"flex h-screen bg-background relative",children:[e&&!r&&w.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:o}),!r&&w.jsx(Ot,{variant:"ghost",size:"icon",className:"fixed top-4 left-4 z-50",onClick:n,children:e?w.jsx(Vf,{className:"h-6 w-6"}):w.jsx(YS,{className:"h-6 w-6"})}),w.jsx(FB,{isOpen:e,onClose:o}),w.jsx("main",{className:`flex-1 overflow-y-auto transition-all duration-300 ${!r&&e?"lg:ml-64":"lg:ml-0"} ${r?"":"pt-16 lg:pt-0"}`,onClick:()=>{e&&!r&&o()},children:w.jsx("div",{className:r?"":"p-4 lg:p-6",children:w.jsx(r8,{})})})]})}var LB=(t,r,e,a,n,o,s,l)=>{let c=document.documentElement,i=["light","dark"];function u(h){(Array.isArray(t)?t:[t]).forEach(v=>{let b=v==="class",g=b&&o?n.map(x=>o[x]||x):n;b?(c.classList.remove(...g),c.classList.add(o&&o[h]?o[h]:h)):c.setAttribute(v,h)}),p(h)}function p(h){l&&i.includes(h)&&(c.style.colorScheme=h)}function f(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(a)u(a);else try{let h=localStorage.getItem(r)||e,v=s&&h==="system"?f():h;u(v)}catch{}},BB=Se.createContext(void 0),UB={setTheme:t=>{},themes:[]},zB=()=>{var t;return(t=Se.useContext(BB))!=null?t:UB};Se.memo(({forcedTheme:t,storageKey:r,attribute:e,enableSystem:a,enableColorScheme:n,defaultTheme:o,value:s,themes:l,nonce:c,scriptProps:i})=>{let u=JSON.stringify([e,r,o,t,l,s,a,n]).slice(1,-1);return Se.createElement("script",{...i,suppressHydrationWarning:!0,nonce:typeof window>"u"?c:"",dangerouslySetInnerHTML:{__html:`(${LB.toString()})(${u})`}})});const $B=({...t})=>{const{theme:r="system"}=zB();return w.jsx(FN,{theme:r,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};function VB(){return w.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background",children:w.jsxs("div",{className:"max-w-md p-8 space-y-4 text-center",children:[w.jsx("div",{className:"text-destructive",children:w.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),w.jsx("h1",{className:"text-2xl font-bold",children:"Erro de Configurao"}),w.jsx("p",{className:"text-muted-foreground",children:"As variveis de ambiente do Supabase no esto configuradas."}),w.jsxs("p",{className:"text-sm text-muted-foreground",children:["Crie um arquivo ",w.jsx("code",{className:"px-2 py-1 bg-muted rounded",children:".env"})," na raiz do projeto com:"]}),w.jsx("pre",{className:"p-4 text-left bg-muted rounded-lg text-sm",children:`VITE_SUPABASE_URL=sua_url_aqui
VITE_SUPABASE_ANON_KEY=sua_chave_aqui`}),w.jsx("p",{className:"text-sm text-muted-foreground",children:"Aps configurar, reinicie o servidor de desenvolvimento."})]})})}function Qy({children:t,allowNovo:r=!1}){const{user:e,isLoading:a}=Oa(),n=m2();return console.log("ProtectedRoute - isLoading:",a,"user:",e==null?void 0:e.email,"location:",n.pathname),a?w.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[w.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"}),w.jsx("p",{className:"ml-4 text-sm text-muted-foreground",children:"Carregando..."})]}):e?r?w.jsx(w.Fragment,{children:t}):(!e.role||e.role==="NOVO")&&n.pathname!=="/empty"?(console.log("ProtectedRoute - Redirecionando usurio NOVO para /empty"),w.jsx(Fo,{to:"/empty",replace:!0})):w.jsx(w.Fragment,{children:t}):(console.log("ProtectedRoute - Redirecionando para /login"),w.jsx(Fo,{to:"/login",replace:!0}))}function HB(){const{user:t,isLoading:r}=Oa();return r?w.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[w.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"}),w.jsx("p",{className:"ml-4 text-sm text-muted-foreground",children:"Carregando..."})]}):!(t!=null&&t.role)||t.role==="NOVO"?w.jsx(Fo,{to:"/empty",replace:!0}):w.jsx(Fo,{to:"/dashboard",replace:!0})}function Ml({children:t,allowedRoles:r}){const{user:e,isLoading:a}=Oa();if(a)return w.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[w.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"}),w.jsx("p",{className:"ml-4 text-sm text-muted-foreground",children:"Carregando..."})]});if(!e)return w.jsx(Fo,{to:"/login",replace:!0});if(!e.role||e.role==="NOVO")return console.warn(` Acesso negado: usurio ${e.email} (${e.role||"sem role"}) tentou acessar rota protegida`),w.jsx(Fo,{to:"/empty",replace:!0});const n=typeof e.role=="string"?e.role.toUpperCase():e.role;return r.includes(n)?w.jsx(w.Fragment,{children:t}):(console.warn(` Acesso negado: usurio ${e.email} (${n}) tentou acessar rota permitida apenas para:`,r),w.jsx(Fo,{to:"/profile",replace:!0}))}function qB(){const{setUser:t,setIsLoading:r}=Oa(),[e,a]=Se.useState(!1);return Se.useEffect(()=>{let n=!0;console.log(" App - Inicializando autenticao...");const o=setTimeout(()=>{n&&(console.warn(" Timeout de segurana - forando setIsLoading(false)"),r(!1))},15e3),s=async(c,i)=>{var h,v,b;console.log(" Carregando perfil para:",i,"userId:",c);const p=Oa.getState().user;if(p&&p.id===c&&p.role&&p.role!=="NOVO")return console.log(" Usando perfil em cache:",p.role),p;try{const g=Date.now(),x=St.from("profiles").select("id, email, name, role, vendedor").eq("id",c).maybeSingle(),y=new Promise((V,U)=>{setTimeout(()=>U(new Error("Query timeout aps 8 segundos")),8e3)});let E;try{E=await Promise.race([x,y])}catch(V){throw console.warn(" Query timeout, continuando com fallback..."),V}const{data:N,error:I}=E,P=Date.now()-g;if(console.log(` Query executada em ${P}ms`,{hasData:!!N,error:I==null?void 0:I.message}),N&&!I){let V="NOVO";if(N.role){const H=String(N.role).trim().toUpperCase();console.log(" Role processado:",H),["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR","NOVO"].includes(H)?V=H:(console.warn(" Role invlido no banco:",H,"- usando NOVO"),V="NOVO")}else console.warn(" Role est vazio no banco - usando NOVO"),V="NOVO";const U={id:N.id,email:i,name:N.name||i.split("@")[0],role:V,vendedor:N.vendedor||null};console.log(" Perfil carregado do banco:",U);try{const H={...U,_cacheTime:Date.now()};localStorage.setItem(`profile_${c}`,JSON.stringify(H))}catch(H){console.warn(" Erro ao salvar perfil no localStorage:",H)}return U}else console.warn(" Sem dados do perfil no banco. Erro:",I)}catch(g){console.warn(" Erro na query do banco, tentando fallback...",(g==null?void 0:g.message)||g)}try{console.log(" Tentando fallback 1: metadata do auth...");const{data:g,error:x}=await St.auth.getUser();if(!x&&(g!=null&&g.user)){const y=(h=g.user.user_metadata)==null?void 0:h.role,E=y&&["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR","NOVO"].includes(String(y).toUpperCase())?String(y).toUpperCase():"NOVO",N={id:c,email:i,name:((v=g.user.user_metadata)==null?void 0:v.name)||i.split("@")[0],role:E,vendedor:((b=g.user.user_metadata)==null?void 0:b.vendedor)||null};return console.log(" Usando fallback (metadata):",N),N}else console.warn(" Metadata retornou erro ou sem dados:",x)}catch(g){console.warn(" Erro ao buscar metadata:",g)}const f={id:c,email:i,name:i.split("@")[0],role:"NOVO",vendedor:null};return console.log(" Usando fallback final (NOVO) - query do banco falhou:",f),f},{data:{subscription:l}}=St.auth.onAuthStateChange(async(c,i)=>{var u;if(console.log(" Auth mudou:",c,(u=i==null?void 0:i.user)==null?void 0:u.email),!!n){if(c==="TOKEN_REFRESHED"){console.log(" Token renovado - mantendo perfil atual");return}if(c!=="SIGNED_IN"&&c!=="SIGNED_OUT"&&c!=="USER_UPDATED"){console.log(" Evento ignorado:",c);return}try{if(i!=null&&i.user){const f=Oa.getState().user;if(f&&f.id===i.user.id&&c!=="USER_UPDATED"){console.log(" Usurio j carregado, mantendo perfil atual:",f.role),n&&r(!1);return}const h=s(i.user.id,i.user.email),v=new Promise(g=>{setTimeout(()=>{const x={id:i.user.id,email:i.user.email,name:i.user.email.split("@")[0],role:"NOVO",vendedor:null};console.log(" Timeout no loadProfile - usando perfil mnimo:",x),g(x)},1e4)}),b=await Promise.race([h,v]);n&&b&&(console.log(" Usurio setado:",{email:b.email,role:b.role,name:b.name,id:b.id,vendedor:b.vendedor}),t(b))}else n&&(console.log(" Sem sesso"),t(null))}catch(p){if(console.error(" Erro no listener de auth:",p),n&&(i!=null&&i.user)){const f={id:i.user.id,email:i.user.email,name:i.user.email.split("@")[0],role:"NOVO",vendedor:null};console.log(" Usando perfil mnimo devido a erro:",f),t(f)}else t(null)}finally{n&&r(!1)}}});return St.auth.getSession().then(async({data:{session:c}})=>{if(n)try{if(c!=null&&c.user){console.log(" Sesso encontrada:",c.user.email);const u=Oa.getState().user;if(u&&u.id===c.user.id&&u.role&&u.role!=="NOVO"){console.log(" Usando perfil do store (cache):",u.role),r(!1),clearTimeout(o),s(c.user.id,c.user.email).then(f=>{f&&n&&t(f)}).catch(f=>{console.warn(" Erro ao atualizar perfil em background:",f)});return}try{const f=localStorage.getItem(`profile_${c.user.id}`);if(f){const h=JSON.parse(f),v=h._cacheTime||0,g=Date.now()-v,x=24*60*60*1e3;if(g<x&&h.role&&h.role!=="NOVO"){const{_cacheTime:y,...E}=h;console.log(" Usando perfil do localStorage:",E.role),t(E),r(!1),clearTimeout(o),s(c.user.id,c.user.email).then(N=>{N&&n&&t(N)}).catch(N=>{console.warn(" Erro ao atualizar perfil em background:",N)});return}else console.log(" Cache expirado ou invlido, buscando do banco..."),localStorage.removeItem(`profile_${c.user.id}`)}}catch(f){console.warn(" Erro ao ler cache do localStorage:",f)}const p=await s(c.user.id,c.user.email);if(n&&p){console.log(" Setando usurio inicial:",{email:p.email,role:p.role,name:p.name,vendedor:p.vendedor});try{const f={...p,_cacheTime:Date.now()};localStorage.setItem(`profile_${c.user.id}`,JSON.stringify(f))}catch(f){console.warn(" Erro ao salvar no localStorage:",f)}t(p),r(!1),clearTimeout(o)}}else console.log(" Sem sesso inicial"),n&&(t(null),r(!1),clearTimeout(o))}catch(i){if(console.error(" Erro ao carregar sesso inicial:",i),n&&(c!=null&&c.user)){const p=Oa.getState().user;if(p&&p.id===c.user.id&&p.role&&p.role!=="NOVO"){console.log(" Usando perfil do store devido a erro:",p.role),r(!1),clearTimeout(o);return}try{const h=localStorage.getItem(`profile_${c.user.id}`);if(h){const v=JSON.parse(h),{_cacheTime:b,...g}=v;if(g.role&&g.role!=="NOVO"){console.log(" Usando perfil do cache devido a erro:",g.role),t(g),r(!1),clearTimeout(o);return}}}catch(h){console.warn(" Erro ao ler cache em fallback:",h)}const f={id:c.user.id,email:c.user.email,name:c.user.email.split("@")[0],role:"NOVO",vendedor:null};console.log(" Usando perfil mnimo devido a erro (sem cache vlido):",f),t(f),r(!1),clearTimeout(o)}else t(null),r(!1),clearTimeout(o)}}).catch(c=>{console.error(" Erro ao verificar sesso:",c),n&&(t(null),r(!1),clearTimeout(o))}),()=>{console.log(" Cleanup"),n=!1,clearTimeout(o),l.unsubscribe()}},[t,r]),e?w.jsx(VB,{}):w.jsxs(a8,{children:[w.jsxs(n8,{children:[w.jsx(Qn,{path:"/login",element:w.jsx(ZN,{})}),w.jsx(Qn,{path:"/empty",element:w.jsx(Qy,{allowNovo:!0,children:w.jsx(IB,{})})}),w.jsxs(Qn,{path:"/",element:w.jsx(Qy,{children:w.jsx(PB,{})}),children:[w.jsx(Qn,{index:!0,element:w.jsx(HB,{})}),w.jsx(Qn,{path:"dashboard",element:w.jsx(Ml,{allowedRoles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"],children:w.jsx(BN,{})})}),w.jsx(Qn,{path:"dashboard-lancadas",element:w.jsx(Ml,{allowedRoles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"],children:w.jsx(YN,{})})}),w.jsx(Qn,{path:"validation",element:w.jsx(Ml,{allowedRoles:["COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"],children:w.jsx(lB,{})})}),w.jsx(Qn,{path:"reports",element:w.jsx(Ml,{allowedRoles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"],children:w.jsx(nj,{})})}),w.jsx(Qn,{path:"sync",element:w.jsx(Ml,{allowedRoles:["LOGISTICA","ADMIN"],children:w.jsx(iB,{})})}),w.jsx(Qn,{path:"settings",element:w.jsx(Ml,{allowedRoles:["ADMIN","LOGISTICA"],children:w.jsx(kB,{})})}),w.jsx(Qn,{path:"profile",element:w.jsx(RB,{})})]})]}),w.jsx($B,{})]})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log(" Service Worker registrado com sucesso:",t.scope)}).catch(t=>{console.warn(" Falha ao registrar Service Worker:",t)})});m8.createRoot(document.getElementById("root")).render(w.jsx(qB,{}));
