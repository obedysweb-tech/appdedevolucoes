import{j as k,c as ry,T as ny,I as x5,S as ay,a as sy,P as y5,C as iy,V as w5,L as oy,b as ly,d as _5,e as S5,f as cy,R as k5,g as E5,h as Uf,u as Bu,i as T5,k as A5,o as C5,s as N5,l as O5,m as j5,n as D5,p as M5,q as R5,r as F5,t as dm,v as xu,w as Ms,x as I5,y as fm,z as P5,A as L5,B as B5,D as ia,E as U5,F as z5,G as $5,H as hm,J as pm,_ as V5,K as zf,M as H5,N as q5,O as uy,Q as dy,U as W5,W as fy,X as G5,Y as hy,Z as Y5,$ as py,a0 as my,a1 as X5,a2 as K5,a3 as Z5,a4 as gy}from"./ui-vendor-C68SU9xL.js";import{d as J5,e as Q5,r as ye,R as Ke,b as e8,c as t8,u as r8,f as ur,g as n8,h as vy,L as af,O as a8,B as s8,i as i8,j as Za,N as Io}from"./react-vendor-D3tagoQh.js";import{c as by,R as Jr,A as xy,C as un,X as dn,Y as zr,T as Qr,a as yy,L as Xl,B as Gn,b as On,d as Pn,e as wy,P as o8,f as l8,g as c8,h as _y,r as u8,i as d8}from"./chart-vendor-9iNHXFEB.js";import{_ as f8,E as h8,a as sf}from"./pdf-vendor-CXTw4Jop.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function e(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=e(a);fetch(a.href,o)}})();var Q0={exports:{}},Jc={},ep={exports:{}},tp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ub;function p8(){return Ub||(Ub=1,function(t){function r(w,T){var A=w.length;w.push(T);e:for(;0<A;){var S=A-1>>>1,j=w[S];if(0<a(j,T))w[S]=T,w[A]=j,A=S;else break e}}function e(w){return w.length===0?null:w[0]}function n(w){if(w.length===0)return null;var T=w[0],A=w.pop();if(A!==T){w[0]=A;e:for(var S=0,j=w.length,B=j>>>1;S<B;){var R=2*(S+1)-1,X=w[R],Y=R+1,ee=w[Y];if(0>a(X,A))Y<j&&0>a(ee,X)?(w[S]=ee,w[Y]=A,S=Y):(w[S]=X,w[R]=A,S=R);else if(Y<j&&0>a(ee,A))w[S]=ee,w[Y]=A,S=Y;else break e}}return T}function a(w,T){var A=w.sortIndex-T.sortIndex;return A!==0?A:w.id-T.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],i=[],u=1,p=null,f=3,h=!1,v=!1,b=!1,g=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function N(w){for(var T=e(i);T!==null;){if(T.callback===null)n(i);else if(T.startTime<=w)n(i),T.sortIndex=T.expirationTime,r(c,T);else break;T=e(i)}}function I(w){if(b=!1,N(w),!v)if(e(c)!==null)v=!0,L||(L=!0,W());else{var T=e(i);T!==null&&C(I,T.startTime-w)}}var L=!1,H=-1,V=5,q=-1;function K(){return g?!0:!(t.unstable_now()-q<V)}function z(){if(g=!1,L){var w=t.unstable_now();q=w;var T=!0;try{e:{v=!1,b&&(b=!1,y(H),H=-1),h=!0;var A=f;try{t:{for(N(w),p=e(c);p!==null&&!(p.expirationTime>w&&K());){var S=p.callback;if(typeof S=="function"){p.callback=null,f=p.priorityLevel;var j=S(p.expirationTime<=w);if(w=t.unstable_now(),typeof j=="function"){p.callback=j,N(w),T=!0;break t}p===e(c)&&n(c),N(w)}else n(c);p=e(c)}if(p!==null)T=!0;else{var B=e(i);B!==null&&C(I,B.startTime-w),T=!1}}break e}finally{p=null,f=A,h=!1}T=void 0}}finally{T?W():L=!1}}}var W;if(typeof E=="function")W=function(){E(z)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,M=D.port2;D.port1.onmessage=z,W=function(){M.postMessage(null)}}else W=function(){x(z,0)};function C(w,T){H=x(function(){w(t.unstable_now())},T)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(w){w.callback=null},t.unstable_forceFrameRate=function(w){0>w||125<w?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<w?Math.floor(1e3/w):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(w){switch(f){case 1:case 2:case 3:var T=3;break;default:T=f}var A=f;f=T;try{return w()}finally{f=A}},t.unstable_requestPaint=function(){g=!0},t.unstable_runWithPriority=function(w,T){switch(w){case 1:case 2:case 3:case 4:case 5:break;default:w=3}var A=f;f=w;try{return T()}finally{f=A}},t.unstable_scheduleCallback=function(w,T,A){var S=t.unstable_now();switch(typeof A=="object"&&A!==null?(A=A.delay,A=typeof A=="number"&&0<A?S+A:S):A=S,w){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=A+j,w={id:u++,callback:T,priorityLevel:w,startTime:A,expirationTime:j,sortIndex:-1},A>S?(w.sortIndex=A,r(i,w),e(c)===null&&w===e(i)&&(b?(y(H),H=-1):b=!0,C(I,A-S))):(w.sortIndex=j,r(c,w),v||h||(v=!0,L||(L=!0,W()))),w},t.unstable_shouldYield=K,t.unstable_wrapCallback=function(w){var T=f;return function(){var A=f;f=T;try{return w.apply(this,arguments)}finally{f=A}}}}(tp)),tp}var zb;function m8(){return zb||(zb=1,ep.exports=p8()),ep.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $b;function g8(){if($b)return Jc;$b=1;var t=m8(),r=J5(),e=Q5();function n(d){var m="https://react.dev/errors/"+d;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)m+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+d+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function o(d){var m=d,_=d;if(d.alternate)for(;m.return;)m=m.return;else{d=m;do m=d,(m.flags&4098)!==0&&(_=m.return),d=m.return;while(d)}return m.tag===3?_:null}function s(d){if(d.tag===13){var m=d.memoizedState;if(m===null&&(d=d.alternate,d!==null&&(m=d.memoizedState)),m!==null)return m.dehydrated}return null}function l(d){if(o(d)!==d)throw Error(n(188))}function c(d){var m=d.alternate;if(!m){if(m=o(d),m===null)throw Error(n(188));return m!==d?null:d}for(var _=d,O=m;;){var G=_.return;if(G===null)break;var J=G.alternate;if(J===null){if(O=G.return,O!==null){_=O;continue}break}if(G.child===J.child){for(J=G.child;J;){if(J===_)return l(G),d;if(J===O)return l(G),m;J=J.sibling}throw Error(n(188))}if(_.return!==O.return)_=G,O=J;else{for(var oe=!1,pe=G.child;pe;){if(pe===_){oe=!0,_=G,O=J;break}if(pe===O){oe=!0,O=G,_=J;break}pe=pe.sibling}if(!oe){for(pe=J.child;pe;){if(pe===_){oe=!0,_=J,O=G;break}if(pe===O){oe=!0,O=J,_=G;break}pe=pe.sibling}if(!oe)throw Error(n(189))}}if(_.alternate!==O)throw Error(n(190))}if(_.tag!==3)throw Error(n(188));return _.stateNode.current===_?d:m}function i(d){var m=d.tag;if(m===5||m===26||m===27||m===6)return d;for(d=d.child;d!==null;){if(m=i(d),m!==null)return m;d=d.sibling}return null}var u=Object.assign,p=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),h=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),y=Symbol.for("react.consumer"),E=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),q=Symbol.for("react.activity"),K=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function W(d){return d===null||typeof d!="object"?null:(d=z&&d[z]||d["@@iterator"],typeof d=="function"?d:null)}var D=Symbol.for("react.client.reference");function M(d){if(d==null)return null;if(typeof d=="function")return d.$$typeof===D?null:d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case v:return"Fragment";case g:return"Profiler";case b:return"StrictMode";case I:return"Suspense";case L:return"SuspenseList";case q:return"Activity"}if(typeof d=="object")switch(d.$$typeof){case h:return"Portal";case E:return(d.displayName||"Context")+".Provider";case y:return(d._context.displayName||"Context")+".Consumer";case N:var m=d.render;return d=d.displayName,d||(d=m.displayName||m.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case H:return m=d.displayName||null,m!==null?m:M(d.type)||"Memo";case V:m=d._payload,d=d._init;try{return M(d(m))}catch{}}return null}var C=Array.isArray,w=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,T=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,A={pending:!1,data:null,method:null,action:null},S=[],j=-1;function B(d){return{current:d}}function R(d){0>j||(d.current=S[j],S[j]=null,j--)}function X(d,m){j++,S[j]=d.current,d.current=m}var Y=B(null),ee=B(null),U=B(null),Q=B(null);function P(d,m){switch(X(U,m),X(ee,d),X(Y,null),m.nodeType){case 9:case 11:d=(d=m.documentElement)&&(d=d.namespaceURI)?pb(d):0;break;default:if(d=m.tagName,m=m.namespaceURI)m=pb(m),d=mb(m,d);else switch(d){case"svg":d=1;break;case"math":d=2;break;default:d=0}}R(Y),X(Y,d)}function F(){R(Y),R(ee),R(U)}function Z(d){d.memoizedState!==null&&X(Q,d);var m=Y.current,_=mb(m,d.type);m!==_&&(X(ee,d),X(Y,_))}function se(d){ee.current===d&&(R(Y),R(ee)),Q.current===d&&(R(Q),Gc._currentValue=A)}var re=Object.prototype.hasOwnProperty,ae=t.unstable_scheduleCallback,te=t.unstable_cancelCallback,he=t.unstable_shouldYield,le=t.unstable_requestPaint,ne=t.unstable_now,de=t.unstable_getCurrentPriorityLevel,fe=t.unstable_ImmediatePriority,Se=t.unstable_UserBlockingPriority,_e=t.unstable_NormalPriority,Ce=t.unstable_LowPriority,Re=t.unstable_IdlePriority,Pe=t.log,Ye=t.unstable_setDisableYieldValue,at=null,tt=null;function it(d){if(typeof Pe=="function"&&Ye(d),tt&&typeof tt.setStrictMode=="function")try{tt.setStrictMode(at,d)}catch{}}var rt=Math.clz32?Math.clz32:pt,ct=Math.log,Oe=Math.LN2;function pt(d){return d>>>=0,d===0?32:31-(ct(d)/Oe|0)|0}var Je=256,ot=4194304;function ut(d){var m=d&42;if(m!==0)return m;switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return d&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return d}}function _t(d,m,_){var O=d.pendingLanes;if(O===0)return 0;var G=0,J=d.suspendedLanes,oe=d.pingedLanes;d=d.warmLanes;var pe=O&134217727;return pe!==0?(O=pe&~J,O!==0?G=ut(O):(oe&=pe,oe!==0?G=ut(oe):_||(_=pe&~d,_!==0&&(G=ut(_))))):(pe=O&~J,pe!==0?G=ut(pe):oe!==0?G=ut(oe):_||(_=O&~d,_!==0&&(G=ut(_)))),G===0?0:m!==0&&m!==G&&(m&J)===0&&(J=G&-G,_=m&-m,J>=_||J===32&&(_&4194048)!==0)?m:G}function vt(d,m){return(d.pendingLanes&~(d.suspendedLanes&~d.pingedLanes)&m)===0}function ht(d,m){switch(d){case 1:case 2:case 4:case 8:case 64:return m+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $e(){var d=Je;return Je<<=1,(Je&4194048)===0&&(Je=256),d}function Be(){var d=ot;return ot<<=1,(ot&62914560)===0&&(ot=4194304),d}function wt(d){for(var m=[],_=0;31>_;_++)m.push(d);return m}function et(d,m){d.pendingLanes|=m,m!==268435456&&(d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0)}function dt(d,m,_,O,G,J){var oe=d.pendingLanes;d.pendingLanes=_,d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0,d.expiredLanes&=_,d.entangledLanes&=_,d.errorRecoveryDisabledLanes&=_,d.shellSuspendCounter=0;var pe=d.entanglements,je=d.expirationTimes,Xe=d.hiddenUpdates;for(_=oe&~_;0<_;){var ft=31-rt(_),yt=1<<ft;pe[ft]=0,je[ft]=-1;var Ze=Xe[ft];if(Ze!==null)for(Xe[ft]=null,ft=0;ft<Ze.length;ft++){var Qe=Ze[ft];Qe!==null&&(Qe.lane&=-536870913)}_&=~yt}O!==0&&we(d,O,0),J!==0&&G===0&&d.tag!==0&&(d.suspendedLanes|=J&~(oe&~m))}function we(d,m,_){d.pendingLanes|=m,d.suspendedLanes&=~m;var O=31-rt(m);d.entangledLanes|=m,d.entanglements[O]=d.entanglements[O]|1073741824|_&4194090}function Ne(d,m){var _=d.entangledLanes|=m;for(d=d.entanglements;_;){var O=31-rt(_),G=1<<O;G&m|d[O]&m&&(d[O]|=m),_&=~G}}function lt(d){switch(d){case 2:d=1;break;case 8:d=4;break;case 32:d=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:d=128;break;case 268435456:d=134217728;break;default:d=0}return d}function Ct(d){return d&=-d,2<d?8<d?(d&134217727)!==0?32:268435456:8:2}function $t(){var d=T.p;return d!==0?d:(d=window.event,d===void 0?32:Rb(d.type))}function ke(d,m){var _=T.p;try{return T.p=d,m()}finally{T.p=_}}var De=Math.random().toString(36).slice(2),bt="__reactFiber$"+De,xt="__reactProps$"+De,Ae="__reactContainer$"+De,Le="__reactEvents$"+De,nt="__reactListeners$"+De,ie="__reactHandles$"+De,be="__reactResources$"+De,ue="__reactMarker$"+De;function me(d){delete d[bt],delete d[xt],delete d[Le],delete d[nt],delete d[ie]}function ve(d){var m=d[bt];if(m)return m;for(var _=d.parentNode;_;){if(m=_[Ae]||_[bt]){if(_=m.alternate,m.child!==null||_!==null&&_.child!==null)for(d=xb(d);d!==null;){if(_=d[bt])return _;d=xb(d)}return m}d=_,_=d.parentNode}return null}function ge(d){if(d=d[bt]||d[Ae]){var m=d.tag;if(m===5||m===6||m===13||m===26||m===27||m===3)return d}return null}function Fe(d){var m=d.tag;if(m===5||m===26||m===27||m===6)return d.stateNode;throw Error(n(33))}function Ue(d){var m=d[be];return m||(m=d[be]={hoistableStyles:new Map,hoistableScripts:new Map}),m}function Me(d){d[ue]=!0}var Ve=new Set,ze={};function xe(d,m){Ee(d,m),Ee(d+"Capture",m)}function Ee(d,m){for(ze[d]=m,d=0;d<m.length;d++)Ve.add(m[d])}var We=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ce={},Te={};function qe(d){return re.call(Te,d)?!0:re.call(ce,d)?!1:We.test(d)?Te[d]=!0:(ce[d]=!0,!1)}function st(d,m,_){if(qe(m))if(_===null)d.removeAttribute(m);else{switch(typeof _){case"undefined":case"function":case"symbol":d.removeAttribute(m);return;case"boolean":var O=m.toLowerCase().slice(0,5);if(O!=="data-"&&O!=="aria-"){d.removeAttribute(m);return}}d.setAttribute(m,""+_)}}function Et(d,m,_){if(_===null)d.removeAttribute(m);else{switch(typeof _){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(m);return}d.setAttribute(m,""+_)}}function gt(d,m,_,O){if(O===null)d.removeAttribute(_);else{switch(typeof O){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(_);return}d.setAttributeNS(m,_,""+O)}}var kt,Zt;function Ut(d){if(kt===void 0)try{throw Error()}catch(_){var m=_.stack.trim().match(/\n( *(at )?)/);kt=m&&m[1]||"",Zt=-1<_.stack.indexOf(`
    at`)?" (<anonymous>)":-1<_.stack.indexOf("@")?"@unknown:0:0":""}return`
`+kt+d+Zt}var zt=!1;function It(d,m){if(!d||zt)return"";zt=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var O={DetermineComponentFrameRoot:function(){try{if(m){var yt=function(){throw Error()};if(Object.defineProperty(yt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(yt,[])}catch(Qe){var Ze=Qe}Reflect.construct(d,[],yt)}else{try{yt.call()}catch(Qe){Ze=Qe}d.call(yt.prototype)}}else{try{throw Error()}catch(Qe){Ze=Qe}(yt=d())&&typeof yt.catch=="function"&&yt.catch(function(){})}}catch(Qe){if(Qe&&Ze&&typeof Qe.stack=="string")return[Qe.stack,Ze.stack]}return[null,null]}};O.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var G=Object.getOwnPropertyDescriptor(O.DetermineComponentFrameRoot,"name");G&&G.configurable&&Object.defineProperty(O.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var J=O.DetermineComponentFrameRoot(),oe=J[0],pe=J[1];if(oe&&pe){var je=oe.split(`
`),Xe=pe.split(`
`);for(G=O=0;O<je.length&&!je[O].includes("DetermineComponentFrameRoot");)O++;for(;G<Xe.length&&!Xe[G].includes("DetermineComponentFrameRoot");)G++;if(O===je.length||G===Xe.length)for(O=je.length-1,G=Xe.length-1;1<=O&&0<=G&&je[O]!==Xe[G];)G--;for(;1<=O&&0<=G;O--,G--)if(je[O]!==Xe[G]){if(O!==1||G!==1)do if(O--,G--,0>G||je[O]!==Xe[G]){var ft=`
`+je[O].replace(" at new "," at ");return d.displayName&&ft.includes("<anonymous>")&&(ft=ft.replace("<anonymous>",d.displayName)),ft}while(1<=O&&0<=G);break}}}finally{zt=!1,Error.prepareStackTrace=_}return(_=d?d.displayName||d.name:"")?Ut(_):""}function er(d){switch(d.tag){case 26:case 27:case 5:return Ut(d.type);case 16:return Ut("Lazy");case 13:return Ut("Suspense");case 19:return Ut("SuspenseList");case 0:case 15:return It(d.type,!1);case 11:return It(d.type.render,!1);case 1:return It(d.type,!0);case 31:return Ut("Activity");default:return""}}function mr(d){try{var m="";do m+=er(d),d=d.return;while(d);return m}catch(_){return`
Error generating stack: `+_.message+`
`+_.stack}}function tr(d){switch(typeof d){case"bigint":case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Dr(d){var m=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function en(d){var m=Dr(d)?"checked":"value",_=Object.getOwnPropertyDescriptor(d.constructor.prototype,m),O=""+d[m];if(!d.hasOwnProperty(m)&&typeof _<"u"&&typeof _.get=="function"&&typeof _.set=="function"){var G=_.get,J=_.set;return Object.defineProperty(d,m,{configurable:!0,get:function(){return G.call(this)},set:function(oe){O=""+oe,J.call(this,oe)}}),Object.defineProperty(d,m,{enumerable:_.enumerable}),{getValue:function(){return O},setValue:function(oe){O=""+oe},stopTracking:function(){d._valueTracker=null,delete d[m]}}}}function tn(d){d._valueTracker||(d._valueTracker=en(d))}function Qn(d){if(!d)return!1;var m=d._valueTracker;if(!m)return!0;var _=m.getValue(),O="";return d&&(O=Dr(d)?d.checked?"true":"false":d.value),d=O,d!==_?(m.setValue(d),!0):!1}function ka(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}var ui=/[\n"\\]/g;function hn(d){return d.replace(ui,function(m){return"\\"+m.charCodeAt(0).toString(16)+" "})}function ds(d,m,_,O,G,J,oe,pe){d.name="",oe!=null&&typeof oe!="function"&&typeof oe!="symbol"&&typeof oe!="boolean"?d.type=oe:d.removeAttribute("type"),m!=null?oe==="number"?(m===0&&d.value===""||d.value!=m)&&(d.value=""+tr(m)):d.value!==""+tr(m)&&(d.value=""+tr(m)):oe!=="submit"&&oe!=="reset"||d.removeAttribute("value"),m!=null?ir(d,oe,tr(m)):_!=null?ir(d,oe,tr(_)):O!=null&&d.removeAttribute("value"),G==null&&J!=null&&(d.defaultChecked=!!J),G!=null&&(d.checked=G&&typeof G!="function"&&typeof G!="symbol"),pe!=null&&typeof pe!="function"&&typeof pe!="symbol"&&typeof pe!="boolean"?d.name=""+tr(pe):d.removeAttribute("name")}function gr(d,m,_,O,G,J,oe,pe){if(J!=null&&typeof J!="function"&&typeof J!="symbol"&&typeof J!="boolean"&&(d.type=J),m!=null||_!=null){if(!(J!=="submit"&&J!=="reset"||m!=null))return;_=_!=null?""+tr(_):"",m=m!=null?""+tr(m):_,pe||m===d.value||(d.value=m),d.defaultValue=m}O=O??G,O=typeof O!="function"&&typeof O!="symbol"&&!!O,d.checked=pe?d.checked:!!O,d.defaultChecked=!!O,oe!=null&&typeof oe!="function"&&typeof oe!="symbol"&&typeof oe!="boolean"&&(d.name=oe)}function ir(d,m,_){m==="number"&&ka(d.ownerDocument)===d||d.defaultValue===""+_||(d.defaultValue=""+_)}function qn(d,m,_,O){if(d=d.options,m){m={};for(var G=0;G<_.length;G++)m["$"+_[G]]=!0;for(_=0;_<d.length;_++)G=m.hasOwnProperty("$"+d[_].value),d[_].selected!==G&&(d[_].selected=G),G&&O&&(d[_].defaultSelected=!0)}else{for(_=""+tr(_),m=null,G=0;G<d.length;G++){if(d[G].value===_){d[G].selected=!0,O&&(d[G].defaultSelected=!0);return}m!==null||d[G].disabled||(m=d[G])}m!==null&&(m.selected=!0)}}function fs(d,m,_){if(m!=null&&(m=""+tr(m),m!==d.value&&(d.value=m),_==null)){d.defaultValue!==m&&(d.defaultValue=m);return}d.defaultValue=_!=null?""+tr(_):""}function ao(d,m,_,O){if(m==null){if(O!=null){if(_!=null)throw Error(n(92));if(C(O)){if(1<O.length)throw Error(n(93));O=O[0]}_=O}_==null&&(_=""),m=_}_=tr(m),d.defaultValue=_,O=d.textContent,O===_&&O!==""&&O!==null&&(d.value=O)}function rn(d,m){if(m){var _=d.firstChild;if(_&&_===d.lastChild&&_.nodeType===3){_.nodeValue=m;return}}d.textContent=m}var Ha=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function qa(d,m,_){var O=m.indexOf("--")===0;_==null||typeof _=="boolean"||_===""?O?d.setProperty(m,""):m==="float"?d.cssFloat="":d[m]="":O?d.setProperty(m,_):typeof _!="number"||_===0||Ha.has(m)?m==="float"?d.cssFloat=_:d[m]=(""+_).trim():d[m]=_+"px"}function di(d,m,_){if(m!=null&&typeof m!="object")throw Error(n(62));if(d=d.style,_!=null){for(var O in _)!_.hasOwnProperty(O)||m!=null&&m.hasOwnProperty(O)||(O.indexOf("--")===0?d.setProperty(O,""):O==="float"?d.cssFloat="":d[O]="");for(var G in m)O=m[G],m.hasOwnProperty(G)&&_[G]!==O&&qa(d,G,O)}else for(var J in m)m.hasOwnProperty(J)&&qa(d,J,m[J])}function fi(d){if(d.indexOf("-")===-1)return!1;switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hi=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function so(d){return hs.test(""+d)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":d}var pi=null;function io(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var Wa=null,Ga=null;function sc(d){var m=ge(d);if(m&&(d=m.stateNode)){var _=d[xt]||null;e:switch(d=m.stateNode,m.type){case"input":if(ds(d,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name),m=_.name,_.type==="radio"&&m!=null){for(_=d;_.parentNode;)_=_.parentNode;for(_=_.querySelectorAll('input[name="'+hn(""+m)+'"][type="radio"]'),m=0;m<_.length;m++){var O=_[m];if(O!==d&&O.form===d.form){var G=O[xt]||null;if(!G)throw Error(n(90));ds(O,G.value,G.defaultValue,G.defaultValue,G.checked,G.defaultChecked,G.type,G.name)}}for(m=0;m<_.length;m++)O=_[m],O.form===d.form&&Qn(O)}break e;case"textarea":fs(d,_.value,_.defaultValue);break e;case"select":m=_.value,m!=null&&qn(d,!!_.multiple,m,!1)}}}var mi=!1;function oo(d,m,_){if(mi)return d(m,_);mi=!0;try{var O=d(m);return O}finally{if(mi=!1,(Wa!==null||Ga!==null)&&(Pd(),Wa&&(m=Wa,d=Ga,Ga=Wa=null,sc(m),d)))for(m=0;m<d.length;m++)sc(d[m])}}function ic(d,m){var _=d.stateNode;if(_===null)return null;var O=_[xt]||null;if(O===null)return null;_=O[m];e:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(O=!O.disabled)||(d=d.type,O=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!O;break e;default:d=!1}if(d)return null;if(_&&typeof _!="function")throw Error(n(231,m,typeof _));return _}var Ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rh=!1;if(Ps)try{var oc={};Object.defineProperty(oc,"passive",{get:function(){rh=!0}}),window.addEventListener("test",oc,oc),window.removeEventListener("test",oc,oc)}catch{rh=!1}var gi=null,nh=null,Qu=null;function b1(){if(Qu)return Qu;var d,m=nh,_=m.length,O,G="value"in gi?gi.value:gi.textContent,J=G.length;for(d=0;d<_&&m[d]===G[d];d++);var oe=_-d;for(O=1;O<=oe&&m[_-O]===G[J-O];O++);return Qu=G.slice(d,1<O?1-O:void 0)}function ed(d){var m=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&m===13&&(d=13)):d=m,d===10&&(d=13),32<=d||d===13?d:0}function td(){return!0}function x1(){return!1}function ea(d){function m(_,O,G,J,oe){this._reactName=_,this._targetInst=G,this.type=O,this.nativeEvent=J,this.target=oe,this.currentTarget=null;for(var pe in d)d.hasOwnProperty(pe)&&(_=d[pe],this[pe]=_?_(J):J[pe]);return this.isDefaultPrevented=(J.defaultPrevented!=null?J.defaultPrevented:J.returnValue===!1)?td:x1,this.isPropagationStopped=x1,this}return u(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _=this.nativeEvent;_&&(_.preventDefault?_.preventDefault():typeof _.returnValue!="unknown"&&(_.returnValue=!1),this.isDefaultPrevented=td)},stopPropagation:function(){var _=this.nativeEvent;_&&(_.stopPropagation?_.stopPropagation():typeof _.cancelBubble!="unknown"&&(_.cancelBubble=!0),this.isPropagationStopped=td)},persist:function(){},isPersistent:td}),m}var lo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rd=ea(lo),lc=u({},lo,{view:0,detail:0}),x3=ea(lc),ah,sh,cc,nd=u({},lc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oh,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==cc&&(cc&&d.type==="mousemove"?(ah=d.screenX-cc.screenX,sh=d.screenY-cc.screenY):sh=ah=0,cc=d),ah)},movementY:function(d){return"movementY"in d?d.movementY:sh}}),y1=ea(nd),y3=u({},nd,{dataTransfer:0}),w3=ea(y3),_3=u({},lc,{relatedTarget:0}),ih=ea(_3),S3=u({},lo,{animationName:0,elapsedTime:0,pseudoElement:0}),k3=ea(S3),E3=u({},lo,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),T3=ea(E3),A3=u({},lo,{data:0}),w1=ea(A3),C3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},N3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},O3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function j3(d){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(d):(d=O3[d])?!!m[d]:!1}function oh(){return j3}var D3=u({},lc,{key:function(d){if(d.key){var m=C3[d.key]||d.key;if(m!=="Unidentified")return m}return d.type==="keypress"?(d=ed(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?N3[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oh,charCode:function(d){return d.type==="keypress"?ed(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?ed(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),M3=ea(D3),R3=u({},nd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_1=ea(R3),F3=u({},lc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oh}),I3=ea(F3),P3=u({},lo,{propertyName:0,elapsedTime:0,pseudoElement:0}),L3=ea(P3),B3=u({},nd,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),U3=ea(B3),z3=u({},lo,{newState:0,oldState:0}),$3=ea(z3),V3=[9,13,27,32],lh=Ps&&"CompositionEvent"in window,uc=null;Ps&&"documentMode"in document&&(uc=document.documentMode);var H3=Ps&&"TextEvent"in window&&!uc,S1=Ps&&(!lh||uc&&8<uc&&11>=uc),k1=" ",E1=!1;function T1(d,m){switch(d){case"keyup":return V3.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function A1(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var Yo=!1;function q3(d,m){switch(d){case"compositionend":return A1(m);case"keypress":return m.which!==32?null:(E1=!0,k1);case"textInput":return d=m.data,d===k1&&E1?null:d;default:return null}}function W3(d,m){if(Yo)return d==="compositionend"||!lh&&T1(d,m)?(d=b1(),Qu=nh=gi=null,Yo=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return S1&&m.locale!=="ko"?null:m.data;default:return null}}var G3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function C1(d){var m=d&&d.nodeName&&d.nodeName.toLowerCase();return m==="input"?!!G3[d.type]:m==="textarea"}function N1(d,m,_,O){Wa?Ga?Ga.push(O):Ga=[O]:Wa=O,m=Vd(m,"onChange"),0<m.length&&(_=new rd("onChange","change",null,_,O),d.push({event:_,listeners:m}))}var dc=null,fc=null;function Y3(d){cb(d,0)}function ad(d){var m=Fe(d);if(Qn(m))return d}function O1(d,m){if(d==="change")return m}var j1=!1;if(Ps){var ch;if(Ps){var uh="oninput"in document;if(!uh){var D1=document.createElement("div");D1.setAttribute("oninput","return;"),uh=typeof D1.oninput=="function"}ch=uh}else ch=!1;j1=ch&&(!document.documentMode||9<document.documentMode)}function M1(){dc&&(dc.detachEvent("onpropertychange",R1),fc=dc=null)}function R1(d){if(d.propertyName==="value"&&ad(fc)){var m=[];N1(m,fc,d,io(d)),oo(Y3,m)}}function X3(d,m,_){d==="focusin"?(M1(),dc=m,fc=_,dc.attachEvent("onpropertychange",R1)):d==="focusout"&&M1()}function K3(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return ad(fc)}function Z3(d,m){if(d==="click")return ad(m)}function J3(d,m){if(d==="input"||d==="change")return ad(m)}function Q3(d,m){return d===m&&(d!==0||1/d===1/m)||d!==d&&m!==m}var oa=typeof Object.is=="function"?Object.is:Q3;function hc(d,m){if(oa(d,m))return!0;if(typeof d!="object"||d===null||typeof m!="object"||m===null)return!1;var _=Object.keys(d),O=Object.keys(m);if(_.length!==O.length)return!1;for(O=0;O<_.length;O++){var G=_[O];if(!re.call(m,G)||!oa(d[G],m[G]))return!1}return!0}function F1(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function I1(d,m){var _=F1(d);d=0;for(var O;_;){if(_.nodeType===3){if(O=d+_.textContent.length,d<=m&&O>=m)return{node:_,offset:m-d};d=O}e:{for(;_;){if(_.nextSibling){_=_.nextSibling;break e}_=_.parentNode}_=void 0}_=F1(_)}}function P1(d,m){return d&&m?d===m?!0:d&&d.nodeType===3?!1:m&&m.nodeType===3?P1(d,m.parentNode):"contains"in d?d.contains(m):d.compareDocumentPosition?!!(d.compareDocumentPosition(m)&16):!1:!1}function L1(d){d=d!=null&&d.ownerDocument!=null&&d.ownerDocument.defaultView!=null?d.ownerDocument.defaultView:window;for(var m=ka(d.document);m instanceof d.HTMLIFrameElement;){try{var _=typeof m.contentWindow.location.href=="string"}catch{_=!1}if(_)d=m.contentWindow;else break;m=ka(d.document)}return m}function dh(d){var m=d&&d.nodeName&&d.nodeName.toLowerCase();return m&&(m==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||m==="textarea"||d.contentEditable==="true")}var e6=Ps&&"documentMode"in document&&11>=document.documentMode,Xo=null,fh=null,pc=null,hh=!1;function B1(d,m,_){var O=_.window===_?_.document:_.nodeType===9?_:_.ownerDocument;hh||Xo==null||Xo!==ka(O)||(O=Xo,"selectionStart"in O&&dh(O)?O={start:O.selectionStart,end:O.selectionEnd}:(O=(O.ownerDocument&&O.ownerDocument.defaultView||window).getSelection(),O={anchorNode:O.anchorNode,anchorOffset:O.anchorOffset,focusNode:O.focusNode,focusOffset:O.focusOffset}),pc&&hc(pc,O)||(pc=O,O=Vd(fh,"onSelect"),0<O.length&&(m=new rd("onSelect","select",null,m,_),d.push({event:m,listeners:O}),m.target=Xo)))}function co(d,m){var _={};return _[d.toLowerCase()]=m.toLowerCase(),_["Webkit"+d]="webkit"+m,_["Moz"+d]="moz"+m,_}var Ko={animationend:co("Animation","AnimationEnd"),animationiteration:co("Animation","AnimationIteration"),animationstart:co("Animation","AnimationStart"),transitionrun:co("Transition","TransitionRun"),transitionstart:co("Transition","TransitionStart"),transitioncancel:co("Transition","TransitionCancel"),transitionend:co("Transition","TransitionEnd")},ph={},U1={};Ps&&(U1=document.createElement("div").style,"AnimationEvent"in window||(delete Ko.animationend.animation,delete Ko.animationiteration.animation,delete Ko.animationstart.animation),"TransitionEvent"in window||delete Ko.transitionend.transition);function uo(d){if(ph[d])return ph[d];if(!Ko[d])return d;var m=Ko[d],_;for(_ in m)if(m.hasOwnProperty(_)&&_ in U1)return ph[d]=m[_];return d}var z1=uo("animationend"),$1=uo("animationiteration"),V1=uo("animationstart"),t6=uo("transitionrun"),r6=uo("transitionstart"),n6=uo("transitioncancel"),H1=uo("transitionend"),q1=new Map,mh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");mh.push("scrollEnd");function Ya(d,m){q1.set(d,m),xe(m,[d])}var W1=new WeakMap;function Ea(d,m){if(typeof d=="object"&&d!==null){var _=W1.get(d);return _!==void 0?_:(m={value:d,source:m,stack:mr(m)},W1.set(d,m),m)}return{value:d,source:m,stack:mr(m)}}var Ta=[],Zo=0,gh=0;function sd(){for(var d=Zo,m=gh=Zo=0;m<d;){var _=Ta[m];Ta[m++]=null;var O=Ta[m];Ta[m++]=null;var G=Ta[m];Ta[m++]=null;var J=Ta[m];if(Ta[m++]=null,O!==null&&G!==null){var oe=O.pending;oe===null?G.next=G:(G.next=oe.next,oe.next=G),O.pending=G}J!==0&&G1(_,G,J)}}function id(d,m,_,O){Ta[Zo++]=d,Ta[Zo++]=m,Ta[Zo++]=_,Ta[Zo++]=O,gh|=O,d.lanes|=O,d=d.alternate,d!==null&&(d.lanes|=O)}function vh(d,m,_,O){return id(d,m,_,O),od(d)}function Jo(d,m){return id(d,null,null,m),od(d)}function G1(d,m,_){d.lanes|=_;var O=d.alternate;O!==null&&(O.lanes|=_);for(var G=!1,J=d.return;J!==null;)J.childLanes|=_,O=J.alternate,O!==null&&(O.childLanes|=_),J.tag===22&&(d=J.stateNode,d===null||d._visibility&1||(G=!0)),d=J,J=J.return;return d.tag===3?(J=d.stateNode,G&&m!==null&&(G=31-rt(_),d=J.hiddenUpdates,O=d[G],O===null?d[G]=[m]:O.push(m),m.lane=_|536870912),J):null}function od(d){if(50<Bc)throw Bc=0,S0=null,Error(n(185));for(var m=d.return;m!==null;)d=m,m=d.return;return d.tag===3?d.stateNode:null}var Qo={};function a6(d,m,_,O){this.tag=d,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=O,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function la(d,m,_,O){return new a6(d,m,_,O)}function bh(d){return d=d.prototype,!(!d||!d.isReactComponent)}function Ls(d,m){var _=d.alternate;return _===null?(_=la(d.tag,m,d.key,d.mode),_.elementType=d.elementType,_.type=d.type,_.stateNode=d.stateNode,_.alternate=d,d.alternate=_):(_.pendingProps=m,_.type=d.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=d.flags&65011712,_.childLanes=d.childLanes,_.lanes=d.lanes,_.child=d.child,_.memoizedProps=d.memoizedProps,_.memoizedState=d.memoizedState,_.updateQueue=d.updateQueue,m=d.dependencies,_.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},_.sibling=d.sibling,_.index=d.index,_.ref=d.ref,_.refCleanup=d.refCleanup,_}function Y1(d,m){d.flags&=65011714;var _=d.alternate;return _===null?(d.childLanes=0,d.lanes=m,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=_.childLanes,d.lanes=_.lanes,d.child=_.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=_.memoizedProps,d.memoizedState=_.memoizedState,d.updateQueue=_.updateQueue,d.type=_.type,m=_.dependencies,d.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext}),d}function ld(d,m,_,O,G,J){var oe=0;if(O=d,typeof d=="function")bh(d)&&(oe=1);else if(typeof d=="string")oe=i5(d,_,Y.current)?26:d==="html"||d==="head"||d==="body"?27:5;else e:switch(d){case q:return d=la(31,_,m,G),d.elementType=q,d.lanes=J,d;case v:return fo(_.children,G,J,m);case b:oe=8,G|=24;break;case g:return d=la(12,_,m,G|2),d.elementType=g,d.lanes=J,d;case I:return d=la(13,_,m,G),d.elementType=I,d.lanes=J,d;case L:return d=la(19,_,m,G),d.elementType=L,d.lanes=J,d;default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case x:case E:oe=10;break e;case y:oe=9;break e;case N:oe=11;break e;case H:oe=14;break e;case V:oe=16,O=null;break e}oe=29,_=Error(n(130,d===null?"null":typeof d,"")),O=null}return m=la(oe,_,m,G),m.elementType=d,m.type=O,m.lanes=J,m}function fo(d,m,_,O){return d=la(7,d,O,m),d.lanes=_,d}function xh(d,m,_){return d=la(6,d,null,m),d.lanes=_,d}function yh(d,m,_){return m=la(4,d.children!==null?d.children:[],d.key,m),m.lanes=_,m.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},m}var el=[],tl=0,cd=null,ud=0,Aa=[],Ca=0,ho=null,Bs=1,Us="";function po(d,m){el[tl++]=ud,el[tl++]=cd,cd=d,ud=m}function X1(d,m,_){Aa[Ca++]=Bs,Aa[Ca++]=Us,Aa[Ca++]=ho,ho=d;var O=Bs;d=Us;var G=32-rt(O)-1;O&=~(1<<G),_+=1;var J=32-rt(m)+G;if(30<J){var oe=G-G%5;J=(O&(1<<oe)-1).toString(32),O>>=oe,G-=oe,Bs=1<<32-rt(m)+G|_<<G|O,Us=J+d}else Bs=1<<J|_<<G|O,Us=d}function wh(d){d.return!==null&&(po(d,1),X1(d,1,0))}function _h(d){for(;d===cd;)cd=el[--tl],el[tl]=null,ud=el[--tl],el[tl]=null;for(;d===ho;)ho=Aa[--Ca],Aa[Ca]=null,Us=Aa[--Ca],Aa[Ca]=null,Bs=Aa[--Ca],Aa[Ca]=null}var Wn=null,Hr=null,xr=!1,mo=null,ps=!1,Sh=Error(n(519));function go(d){var m=Error(n(418,""));throw vc(Ea(m,d)),Sh}function K1(d){var m=d.stateNode,_=d.type,O=d.memoizedProps;switch(m[bt]=d,m[xt]=O,_){case"dialog":cr("cancel",m),cr("close",m);break;case"iframe":case"object":case"embed":cr("load",m);break;case"video":case"audio":for(_=0;_<zc.length;_++)cr(zc[_],m);break;case"source":cr("error",m);break;case"img":case"image":case"link":cr("error",m),cr("load",m);break;case"details":cr("toggle",m);break;case"input":cr("invalid",m),gr(m,O.value,O.defaultValue,O.checked,O.defaultChecked,O.type,O.name,!0),tn(m);break;case"select":cr("invalid",m);break;case"textarea":cr("invalid",m),ao(m,O.value,O.defaultValue,O.children),tn(m)}_=O.children,typeof _!="string"&&typeof _!="number"&&typeof _!="bigint"||m.textContent===""+_||O.suppressHydrationWarning===!0||hb(m.textContent,_)?(O.popover!=null&&(cr("beforetoggle",m),cr("toggle",m)),O.onScroll!=null&&cr("scroll",m),O.onScrollEnd!=null&&cr("scrollend",m),O.onClick!=null&&(m.onclick=Hd),m=!0):m=!1,m||go(d)}function Z1(d){for(Wn=d.return;Wn;)switch(Wn.tag){case 5:case 13:ps=!1;return;case 27:case 3:ps=!0;return;default:Wn=Wn.return}}function mc(d){if(d!==Wn)return!1;if(!xr)return Z1(d),xr=!0,!1;var m=d.tag,_;if((_=m!==3&&m!==27)&&((_=m===5)&&(_=d.type,_=!(_!=="form"&&_!=="button")||B0(d.type,d.memoizedProps)),_=!_),_&&Hr&&go(d),Z1(d),m===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(n(317));e:{for(d=d.nextSibling,m=0;d;){if(d.nodeType===8)if(_=d.data,_==="/$"){if(m===0){Hr=Ka(d.nextSibling);break e}m--}else _!=="$"&&_!=="$!"&&_!=="$?"||m++;d=d.nextSibling}Hr=null}}else m===27?(m=Hr,Di(d.type)?(d=V0,V0=null,Hr=d):Hr=m):Hr=Wn?Ka(d.stateNode.nextSibling):null;return!0}function gc(){Hr=Wn=null,xr=!1}function J1(){var d=mo;return d!==null&&(na===null?na=d:na.push.apply(na,d),mo=null),d}function vc(d){mo===null?mo=[d]:mo.push(d)}var kh=B(null),vo=null,zs=null;function vi(d,m,_){X(kh,m._currentValue),m._currentValue=_}function $s(d){d._currentValue=kh.current,R(kh)}function Eh(d,m,_){for(;d!==null;){var O=d.alternate;if((d.childLanes&m)!==m?(d.childLanes|=m,O!==null&&(O.childLanes|=m)):O!==null&&(O.childLanes&m)!==m&&(O.childLanes|=m),d===_)break;d=d.return}}function Th(d,m,_,O){var G=d.child;for(G!==null&&(G.return=d);G!==null;){var J=G.dependencies;if(J!==null){var oe=G.child;J=J.firstContext;e:for(;J!==null;){var pe=J;J=G;for(var je=0;je<m.length;je++)if(pe.context===m[je]){J.lanes|=_,pe=J.alternate,pe!==null&&(pe.lanes|=_),Eh(J.return,_,d),O||(oe=null);break e}J=pe.next}}else if(G.tag===18){if(oe=G.return,oe===null)throw Error(n(341));oe.lanes|=_,J=oe.alternate,J!==null&&(J.lanes|=_),Eh(oe,_,d),oe=null}else oe=G.child;if(oe!==null)oe.return=G;else for(oe=G;oe!==null;){if(oe===d){oe=null;break}if(G=oe.sibling,G!==null){G.return=oe.return,oe=G;break}oe=oe.return}G=oe}}function bc(d,m,_,O){d=null;for(var G=m,J=!1;G!==null;){if(!J){if((G.flags&524288)!==0)J=!0;else if((G.flags&262144)!==0)break}if(G.tag===10){var oe=G.alternate;if(oe===null)throw Error(n(387));if(oe=oe.memoizedProps,oe!==null){var pe=G.type;oa(G.pendingProps.value,oe.value)||(d!==null?d.push(pe):d=[pe])}}else if(G===Q.current){if(oe=G.alternate,oe===null)throw Error(n(387));oe.memoizedState.memoizedState!==G.memoizedState.memoizedState&&(d!==null?d.push(Gc):d=[Gc])}G=G.return}d!==null&&Th(m,d,_,O),m.flags|=262144}function dd(d){for(d=d.firstContext;d!==null;){if(!oa(d.context._currentValue,d.memoizedValue))return!0;d=d.next}return!1}function bo(d){vo=d,zs=null,d=d.dependencies,d!==null&&(d.firstContext=null)}function Fn(d){return Q1(vo,d)}function fd(d,m){return vo===null&&bo(d),Q1(d,m)}function Q1(d,m){var _=m._currentValue;if(m={context:m,memoizedValue:_,next:null},zs===null){if(d===null)throw Error(n(308));zs=m,d.dependencies={lanes:0,firstContext:m},d.flags|=524288}else zs=zs.next=m;return _}var s6=typeof AbortController<"u"?AbortController:function(){var d=[],m=this.signal={aborted:!1,addEventListener:function(_,O){d.push(O)}};this.abort=function(){m.aborted=!0,d.forEach(function(_){return _()})}},i6=t.unstable_scheduleCallback,o6=t.unstable_NormalPriority,pn={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ah(){return{controller:new s6,data:new Map,refCount:0}}function xc(d){d.refCount--,d.refCount===0&&i6(o6,function(){d.controller.abort()})}var yc=null,Ch=0,rl=0,nl=null;function l6(d,m){if(yc===null){var _=yc=[];Ch=0,rl=O0(),nl={status:"pending",value:void 0,then:function(O){_.push(O)}}}return Ch++,m.then(eg,eg),m}function eg(){if(--Ch===0&&yc!==null){nl!==null&&(nl.status="fulfilled");var d=yc;yc=null,rl=0,nl=null;for(var m=0;m<d.length;m++)(0,d[m])()}}function c6(d,m){var _=[],O={status:"pending",value:null,reason:null,then:function(G){_.push(G)}};return d.then(function(){O.status="fulfilled",O.value=m;for(var G=0;G<_.length;G++)(0,_[G])(m)},function(G){for(O.status="rejected",O.reason=G,G=0;G<_.length;G++)(0,_[G])(void 0)}),O}var tg=w.S;w.S=function(d,m){typeof m=="object"&&m!==null&&typeof m.then=="function"&&l6(d,m),tg!==null&&tg(d,m)};var xo=B(null);function Nh(){var d=xo.current;return d!==null?d:Mr.pooledCache}function hd(d,m){m===null?X(xo,xo.current):X(xo,m.pool)}function rg(){var d=Nh();return d===null?null:{parent:pn._currentValue,pool:d}}var wc=Error(n(460)),ng=Error(n(474)),pd=Error(n(542)),Oh={then:function(){}};function ag(d){return d=d.status,d==="fulfilled"||d==="rejected"}function md(){}function sg(d,m,_){switch(_=d[_],_===void 0?d.push(m):_!==m&&(m.then(md,md),m=_),m.status){case"fulfilled":return m.value;case"rejected":throw d=m.reason,og(d),d;default:if(typeof m.status=="string")m.then(md,md);else{if(d=Mr,d!==null&&100<d.shellSuspendCounter)throw Error(n(482));d=m,d.status="pending",d.then(function(O){if(m.status==="pending"){var G=m;G.status="fulfilled",G.value=O}},function(O){if(m.status==="pending"){var G=m;G.status="rejected",G.reason=O}})}switch(m.status){case"fulfilled":return m.value;case"rejected":throw d=m.reason,og(d),d}throw _c=m,wc}}var _c=null;function ig(){if(_c===null)throw Error(n(459));var d=_c;return _c=null,d}function og(d){if(d===wc||d===pd)throw Error(n(483))}var bi=!1;function jh(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Dh(d,m){d=d.updateQueue,m.updateQueue===d&&(m.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,callbacks:null})}function xi(d){return{lane:d,tag:0,payload:null,callback:null,next:null}}function yi(d,m,_){var O=d.updateQueue;if(O===null)return null;if(O=O.shared,(_r&2)!==0){var G=O.pending;return G===null?m.next=m:(m.next=G.next,G.next=m),O.pending=m,m=od(d),G1(d,null,_),m}return id(d,O,m,_),od(d)}function Sc(d,m,_){if(m=m.updateQueue,m!==null&&(m=m.shared,(_&4194048)!==0)){var O=m.lanes;O&=d.pendingLanes,_|=O,m.lanes=_,Ne(d,_)}}function Mh(d,m){var _=d.updateQueue,O=d.alternate;if(O!==null&&(O=O.updateQueue,_===O)){var G=null,J=null;if(_=_.firstBaseUpdate,_!==null){do{var oe={lane:_.lane,tag:_.tag,payload:_.payload,callback:null,next:null};J===null?G=J=oe:J=J.next=oe,_=_.next}while(_!==null);J===null?G=J=m:J=J.next=m}else G=J=m;_={baseState:O.baseState,firstBaseUpdate:G,lastBaseUpdate:J,shared:O.shared,callbacks:O.callbacks},d.updateQueue=_;return}d=_.lastBaseUpdate,d===null?_.firstBaseUpdate=m:d.next=m,_.lastBaseUpdate=m}var Rh=!1;function kc(){if(Rh){var d=nl;if(d!==null)throw d}}function Ec(d,m,_,O){Rh=!1;var G=d.updateQueue;bi=!1;var J=G.firstBaseUpdate,oe=G.lastBaseUpdate,pe=G.shared.pending;if(pe!==null){G.shared.pending=null;var je=pe,Xe=je.next;je.next=null,oe===null?J=Xe:oe.next=Xe,oe=je;var ft=d.alternate;ft!==null&&(ft=ft.updateQueue,pe=ft.lastBaseUpdate,pe!==oe&&(pe===null?ft.firstBaseUpdate=Xe:pe.next=Xe,ft.lastBaseUpdate=je))}if(J!==null){var yt=G.baseState;oe=0,ft=Xe=je=null,pe=J;do{var Ze=pe.lane&-536870913,Qe=Ze!==pe.lane;if(Qe?(fr&Ze)===Ze:(O&Ze)===Ze){Ze!==0&&Ze===rl&&(Rh=!0),ft!==null&&(ft=ft.next={lane:0,tag:pe.tag,payload:pe.payload,callback:null,next:null});e:{var Yt=d,Vt=pe;Ze=m;var Cr=_;switch(Vt.tag){case 1:if(Yt=Vt.payload,typeof Yt=="function"){yt=Yt.call(Cr,yt,Ze);break e}yt=Yt;break e;case 3:Yt.flags=Yt.flags&-65537|128;case 0:if(Yt=Vt.payload,Ze=typeof Yt=="function"?Yt.call(Cr,yt,Ze):Yt,Ze==null)break e;yt=u({},yt,Ze);break e;case 2:bi=!0}}Ze=pe.callback,Ze!==null&&(d.flags|=64,Qe&&(d.flags|=8192),Qe=G.callbacks,Qe===null?G.callbacks=[Ze]:Qe.push(Ze))}else Qe={lane:Ze,tag:pe.tag,payload:pe.payload,callback:pe.callback,next:null},ft===null?(Xe=ft=Qe,je=yt):ft=ft.next=Qe,oe|=Ze;if(pe=pe.next,pe===null){if(pe=G.shared.pending,pe===null)break;Qe=pe,pe=Qe.next,Qe.next=null,G.lastBaseUpdate=Qe,G.shared.pending=null}}while(!0);ft===null&&(je=yt),G.baseState=je,G.firstBaseUpdate=Xe,G.lastBaseUpdate=ft,J===null&&(G.shared.lanes=0),Ci|=oe,d.lanes=oe,d.memoizedState=yt}}function lg(d,m){if(typeof d!="function")throw Error(n(191,d));d.call(m)}function cg(d,m){var _=d.callbacks;if(_!==null)for(d.callbacks=null,d=0;d<_.length;d++)lg(_[d],m)}var al=B(null),gd=B(0);function ug(d,m){d=Xs,X(gd,d),X(al,m),Xs=d|m.baseLanes}function Fh(){X(gd,Xs),X(al,al.current)}function Ih(){Xs=gd.current,R(al),R(gd)}var wi=0,ar=null,Tr=null,nn=null,vd=!1,sl=!1,yo=!1,bd=0,Tc=0,il=null,u6=0;function Xr(){throw Error(n(321))}function Ph(d,m){if(m===null)return!1;for(var _=0;_<m.length&&_<d.length;_++)if(!oa(d[_],m[_]))return!1;return!0}function Lh(d,m,_,O,G,J){return wi=J,ar=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,w.H=d===null||d.memoizedState===null?Gg:Yg,yo=!1,J=_(O,G),yo=!1,sl&&(J=fg(m,_,O,G)),dg(d),J}function dg(d){w.H=kd;var m=Tr!==null&&Tr.next!==null;if(wi=0,nn=Tr=ar=null,vd=!1,Tc=0,il=null,m)throw Error(n(300));d===null||yn||(d=d.dependencies,d!==null&&dd(d)&&(yn=!0))}function fg(d,m,_,O){ar=d;var G=0;do{if(sl&&(il=null),Tc=0,sl=!1,25<=G)throw Error(n(301));if(G+=1,nn=Tr=null,d.updateQueue!=null){var J=d.updateQueue;J.lastEffect=null,J.events=null,J.stores=null,J.memoCache!=null&&(J.memoCache.index=0)}w.H=v6,J=m(_,O)}while(sl);return J}function d6(){var d=w.H,m=d.useState()[0];return m=typeof m.then=="function"?Ac(m):m,d=d.useState()[0],(Tr!==null?Tr.memoizedState:null)!==d&&(ar.flags|=1024),m}function Bh(){var d=bd!==0;return bd=0,d}function Uh(d,m,_){m.updateQueue=d.updateQueue,m.flags&=-2053,d.lanes&=~_}function zh(d){if(vd){for(d=d.memoizedState;d!==null;){var m=d.queue;m!==null&&(m.pending=null),d=d.next}vd=!1}wi=0,nn=Tr=ar=null,sl=!1,Tc=bd=0,il=null}function ta(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return nn===null?ar.memoizedState=nn=d:nn=nn.next=d,nn}function an(){if(Tr===null){var d=ar.alternate;d=d!==null?d.memoizedState:null}else d=Tr.next;var m=nn===null?ar.memoizedState:nn.next;if(m!==null)nn=m,Tr=d;else{if(d===null)throw ar.alternate===null?Error(n(467)):Error(n(310));Tr=d,d={memoizedState:Tr.memoizedState,baseState:Tr.baseState,baseQueue:Tr.baseQueue,queue:Tr.queue,next:null},nn===null?ar.memoizedState=nn=d:nn=nn.next=d}return nn}function $h(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ac(d){var m=Tc;return Tc+=1,il===null&&(il=[]),d=sg(il,d,m),m=ar,(nn===null?m.memoizedState:nn.next)===null&&(m=m.alternate,w.H=m===null||m.memoizedState===null?Gg:Yg),d}function xd(d){if(d!==null&&typeof d=="object"){if(typeof d.then=="function")return Ac(d);if(d.$$typeof===E)return Fn(d)}throw Error(n(438,String(d)))}function Vh(d){var m=null,_=ar.updateQueue;if(_!==null&&(m=_.memoCache),m==null){var O=ar.alternate;O!==null&&(O=O.updateQueue,O!==null&&(O=O.memoCache,O!=null&&(m={data:O.data.map(function(G){return G.slice()}),index:0})))}if(m==null&&(m={data:[],index:0}),_===null&&(_=$h(),ar.updateQueue=_),_.memoCache=m,_=m.data[m.index],_===void 0)for(_=m.data[m.index]=Array(d),O=0;O<d;O++)_[O]=K;return m.index++,_}function Vs(d,m){return typeof m=="function"?m(d):m}function yd(d){var m=an();return Hh(m,Tr,d)}function Hh(d,m,_){var O=d.queue;if(O===null)throw Error(n(311));O.lastRenderedReducer=_;var G=d.baseQueue,J=O.pending;if(J!==null){if(G!==null){var oe=G.next;G.next=J.next,J.next=oe}m.baseQueue=G=J,O.pending=null}if(J=d.baseState,G===null)d.memoizedState=J;else{m=G.next;var pe=oe=null,je=null,Xe=m,ft=!1;do{var yt=Xe.lane&-536870913;if(yt!==Xe.lane?(fr&yt)===yt:(wi&yt)===yt){var Ze=Xe.revertLane;if(Ze===0)je!==null&&(je=je.next={lane:0,revertLane:0,action:Xe.action,hasEagerState:Xe.hasEagerState,eagerState:Xe.eagerState,next:null}),yt===rl&&(ft=!0);else if((wi&Ze)===Ze){Xe=Xe.next,Ze===rl&&(ft=!0);continue}else yt={lane:0,revertLane:Xe.revertLane,action:Xe.action,hasEagerState:Xe.hasEagerState,eagerState:Xe.eagerState,next:null},je===null?(pe=je=yt,oe=J):je=je.next=yt,ar.lanes|=Ze,Ci|=Ze;yt=Xe.action,yo&&_(J,yt),J=Xe.hasEagerState?Xe.eagerState:_(J,yt)}else Ze={lane:yt,revertLane:Xe.revertLane,action:Xe.action,hasEagerState:Xe.hasEagerState,eagerState:Xe.eagerState,next:null},je===null?(pe=je=Ze,oe=J):je=je.next=Ze,ar.lanes|=yt,Ci|=yt;Xe=Xe.next}while(Xe!==null&&Xe!==m);if(je===null?oe=J:je.next=pe,!oa(J,d.memoizedState)&&(yn=!0,ft&&(_=nl,_!==null)))throw _;d.memoizedState=J,d.baseState=oe,d.baseQueue=je,O.lastRenderedState=J}return G===null&&(O.lanes=0),[d.memoizedState,O.dispatch]}function qh(d){var m=an(),_=m.queue;if(_===null)throw Error(n(311));_.lastRenderedReducer=d;var O=_.dispatch,G=_.pending,J=m.memoizedState;if(G!==null){_.pending=null;var oe=G=G.next;do J=d(J,oe.action),oe=oe.next;while(oe!==G);oa(J,m.memoizedState)||(yn=!0),m.memoizedState=J,m.baseQueue===null&&(m.baseState=J),_.lastRenderedState=J}return[J,O]}function hg(d,m,_){var O=ar,G=an(),J=xr;if(J){if(_===void 0)throw Error(n(407));_=_()}else _=m();var oe=!oa((Tr||G).memoizedState,_);oe&&(G.memoizedState=_,yn=!0),G=G.queue;var pe=gg.bind(null,O,G,d);if(Cc(2048,8,pe,[d]),G.getSnapshot!==m||oe||nn!==null&&nn.memoizedState.tag&1){if(O.flags|=2048,ol(9,wd(),mg.bind(null,O,G,_,m),null),Mr===null)throw Error(n(349));J||(wi&124)!==0||pg(O,m,_)}return _}function pg(d,m,_){d.flags|=16384,d={getSnapshot:m,value:_},m=ar.updateQueue,m===null?(m=$h(),ar.updateQueue=m,m.stores=[d]):(_=m.stores,_===null?m.stores=[d]:_.push(d))}function mg(d,m,_,O){m.value=_,m.getSnapshot=O,vg(m)&&bg(d)}function gg(d,m,_){return _(function(){vg(m)&&bg(d)})}function vg(d){var m=d.getSnapshot;d=d.value;try{var _=m();return!oa(d,_)}catch{return!0}}function bg(d){var m=Jo(d,2);m!==null&&ha(m,d,2)}function Wh(d){var m=ta();if(typeof d=="function"){var _=d;if(d=_(),yo){it(!0);try{_()}finally{it(!1)}}}return m.memoizedState=m.baseState=d,m.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:d},m}function xg(d,m,_,O){return d.baseState=_,Hh(d,Tr,typeof O=="function"?O:Vs)}function f6(d,m,_,O,G){if(Sd(d))throw Error(n(485));if(d=m.action,d!==null){var J={payload:G,action:d,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(oe){J.listeners.push(oe)}};w.T!==null?_(!0):J.isTransition=!1,O(J),_=m.pending,_===null?(J.next=m.pending=J,yg(m,J)):(J.next=_.next,m.pending=_.next=J)}}function yg(d,m){var _=m.action,O=m.payload,G=d.state;if(m.isTransition){var J=w.T,oe={};w.T=oe;try{var pe=_(G,O),je=w.S;je!==null&&je(oe,pe),wg(d,m,pe)}catch(Xe){Gh(d,m,Xe)}finally{w.T=J}}else try{J=_(G,O),wg(d,m,J)}catch(Xe){Gh(d,m,Xe)}}function wg(d,m,_){_!==null&&typeof _=="object"&&typeof _.then=="function"?_.then(function(O){_g(d,m,O)},function(O){return Gh(d,m,O)}):_g(d,m,_)}function _g(d,m,_){m.status="fulfilled",m.value=_,Sg(m),d.state=_,m=d.pending,m!==null&&(_=m.next,_===m?d.pending=null:(_=_.next,m.next=_,yg(d,_)))}function Gh(d,m,_){var O=d.pending;if(d.pending=null,O!==null){O=O.next;do m.status="rejected",m.reason=_,Sg(m),m=m.next;while(m!==O)}d.action=null}function Sg(d){d=d.listeners;for(var m=0;m<d.length;m++)(0,d[m])()}function kg(d,m){return m}function Eg(d,m){if(xr){var _=Mr.formState;if(_!==null){e:{var O=ar;if(xr){if(Hr){t:{for(var G=Hr,J=ps;G.nodeType!==8;){if(!J){G=null;break t}if(G=Ka(G.nextSibling),G===null){G=null;break t}}J=G.data,G=J==="F!"||J==="F"?G:null}if(G){Hr=Ka(G.nextSibling),O=G.data==="F!";break e}}go(O)}O=!1}O&&(m=_[0])}}return _=ta(),_.memoizedState=_.baseState=m,O={pending:null,lanes:0,dispatch:null,lastRenderedReducer:kg,lastRenderedState:m},_.queue=O,_=Hg.bind(null,ar,O),O.dispatch=_,O=Wh(!1),J=Jh.bind(null,ar,!1,O.queue),O=ta(),G={state:m,dispatch:null,action:d,pending:null},O.queue=G,_=f6.bind(null,ar,G,J,_),G.dispatch=_,O.memoizedState=d,[m,_,!1]}function Tg(d){var m=an();return Ag(m,Tr,d)}function Ag(d,m,_){if(m=Hh(d,m,kg)[0],d=yd(Vs)[0],typeof m=="object"&&m!==null&&typeof m.then=="function")try{var O=Ac(m)}catch(oe){throw oe===wc?pd:oe}else O=m;m=an();var G=m.queue,J=G.dispatch;return _!==m.memoizedState&&(ar.flags|=2048,ol(9,wd(),h6.bind(null,G,_),null)),[O,J,d]}function h6(d,m){d.action=m}function Cg(d){var m=an(),_=Tr;if(_!==null)return Ag(m,_,d);an(),m=m.memoizedState,_=an();var O=_.queue.dispatch;return _.memoizedState=d,[m,O,!1]}function ol(d,m,_,O){return d={tag:d,create:_,deps:O,inst:m,next:null},m=ar.updateQueue,m===null&&(m=$h(),ar.updateQueue=m),_=m.lastEffect,_===null?m.lastEffect=d.next=d:(O=_.next,_.next=d,d.next=O,m.lastEffect=d),d}function wd(){return{destroy:void 0,resource:void 0}}function Ng(){return an().memoizedState}function _d(d,m,_,O){var G=ta();O=O===void 0?null:O,ar.flags|=d,G.memoizedState=ol(1|m,wd(),_,O)}function Cc(d,m,_,O){var G=an();O=O===void 0?null:O;var J=G.memoizedState.inst;Tr!==null&&O!==null&&Ph(O,Tr.memoizedState.deps)?G.memoizedState=ol(m,J,_,O):(ar.flags|=d,G.memoizedState=ol(1|m,J,_,O))}function Og(d,m){_d(8390656,8,d,m)}function jg(d,m){Cc(2048,8,d,m)}function Dg(d,m){return Cc(4,2,d,m)}function Mg(d,m){return Cc(4,4,d,m)}function Rg(d,m){if(typeof m=="function"){d=d();var _=m(d);return function(){typeof _=="function"?_():m(null)}}if(m!=null)return d=d(),m.current=d,function(){m.current=null}}function Fg(d,m,_){_=_!=null?_.concat([d]):null,Cc(4,4,Rg.bind(null,m,d),_)}function Yh(){}function Ig(d,m){var _=an();m=m===void 0?null:m;var O=_.memoizedState;return m!==null&&Ph(m,O[1])?O[0]:(_.memoizedState=[d,m],d)}function Pg(d,m){var _=an();m=m===void 0?null:m;var O=_.memoizedState;if(m!==null&&Ph(m,O[1]))return O[0];if(O=d(),yo){it(!0);try{d()}finally{it(!1)}}return _.memoizedState=[O,m],O}function Xh(d,m,_){return _===void 0||(wi&1073741824)!==0?d.memoizedState=m:(d.memoizedState=_,d=Uv(),ar.lanes|=d,Ci|=d,_)}function Lg(d,m,_,O){return oa(_,m)?_:al.current!==null?(d=Xh(d,_,O),oa(d,m)||(yn=!0),d):(wi&42)===0?(yn=!0,d.memoizedState=_):(d=Uv(),ar.lanes|=d,Ci|=d,m)}function Bg(d,m,_,O,G){var J=T.p;T.p=J!==0&&8>J?J:8;var oe=w.T,pe={};w.T=pe,Jh(d,!1,m,_);try{var je=G(),Xe=w.S;if(Xe!==null&&Xe(pe,je),je!==null&&typeof je=="object"&&typeof je.then=="function"){var ft=c6(je,O);Nc(d,m,ft,fa(d))}else Nc(d,m,O,fa(d))}catch(yt){Nc(d,m,{then:function(){},status:"rejected",reason:yt},fa())}finally{T.p=J,w.T=oe}}function p6(){}function Kh(d,m,_,O){if(d.tag!==5)throw Error(n(476));var G=Ug(d).queue;Bg(d,G,m,A,_===null?p6:function(){return zg(d),_(O)})}function Ug(d){var m=d.memoizedState;if(m!==null)return m;m={memoizedState:A,baseState:A,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:A},next:null};var _={};return m.next={memoizedState:_,baseState:_,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:_},next:null},d.memoizedState=m,d=d.alternate,d!==null&&(d.memoizedState=m),m}function zg(d){var m=Ug(d).next.queue;Nc(d,m,{},fa())}function Zh(){return Fn(Gc)}function $g(){return an().memoizedState}function Vg(){return an().memoizedState}function m6(d){for(var m=d.return;m!==null;){switch(m.tag){case 24:case 3:var _=fa();d=xi(_);var O=yi(m,d,_);O!==null&&(ha(O,m,_),Sc(O,m,_)),m={cache:Ah()},d.payload=m;return}m=m.return}}function g6(d,m,_){var O=fa();_={lane:O,revertLane:0,action:_,hasEagerState:!1,eagerState:null,next:null},Sd(d)?qg(m,_):(_=vh(d,m,_,O),_!==null&&(ha(_,d,O),Wg(_,m,O)))}function Hg(d,m,_){var O=fa();Nc(d,m,_,O)}function Nc(d,m,_,O){var G={lane:O,revertLane:0,action:_,hasEagerState:!1,eagerState:null,next:null};if(Sd(d))qg(m,G);else{var J=d.alternate;if(d.lanes===0&&(J===null||J.lanes===0)&&(J=m.lastRenderedReducer,J!==null))try{var oe=m.lastRenderedState,pe=J(oe,_);if(G.hasEagerState=!0,G.eagerState=pe,oa(pe,oe))return id(d,m,G,0),Mr===null&&sd(),!1}catch{}finally{}if(_=vh(d,m,G,O),_!==null)return ha(_,d,O),Wg(_,m,O),!0}return!1}function Jh(d,m,_,O){if(O={lane:2,revertLane:O0(),action:O,hasEagerState:!1,eagerState:null,next:null},Sd(d)){if(m)throw Error(n(479))}else m=vh(d,_,O,2),m!==null&&ha(m,d,2)}function Sd(d){var m=d.alternate;return d===ar||m!==null&&m===ar}function qg(d,m){sl=vd=!0;var _=d.pending;_===null?m.next=m:(m.next=_.next,_.next=m),d.pending=m}function Wg(d,m,_){if((_&4194048)!==0){var O=m.lanes;O&=d.pendingLanes,_|=O,m.lanes=_,Ne(d,_)}}var kd={readContext:Fn,use:xd,useCallback:Xr,useContext:Xr,useEffect:Xr,useImperativeHandle:Xr,useLayoutEffect:Xr,useInsertionEffect:Xr,useMemo:Xr,useReducer:Xr,useRef:Xr,useState:Xr,useDebugValue:Xr,useDeferredValue:Xr,useTransition:Xr,useSyncExternalStore:Xr,useId:Xr,useHostTransitionStatus:Xr,useFormState:Xr,useActionState:Xr,useOptimistic:Xr,useMemoCache:Xr,useCacheRefresh:Xr},Gg={readContext:Fn,use:xd,useCallback:function(d,m){return ta().memoizedState=[d,m===void 0?null:m],d},useContext:Fn,useEffect:Og,useImperativeHandle:function(d,m,_){_=_!=null?_.concat([d]):null,_d(4194308,4,Rg.bind(null,m,d),_)},useLayoutEffect:function(d,m){return _d(4194308,4,d,m)},useInsertionEffect:function(d,m){_d(4,2,d,m)},useMemo:function(d,m){var _=ta();m=m===void 0?null:m;var O=d();if(yo){it(!0);try{d()}finally{it(!1)}}return _.memoizedState=[O,m],O},useReducer:function(d,m,_){var O=ta();if(_!==void 0){var G=_(m);if(yo){it(!0);try{_(m)}finally{it(!1)}}}else G=m;return O.memoizedState=O.baseState=G,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:G},O.queue=d,d=d.dispatch=g6.bind(null,ar,d),[O.memoizedState,d]},useRef:function(d){var m=ta();return d={current:d},m.memoizedState=d},useState:function(d){d=Wh(d);var m=d.queue,_=Hg.bind(null,ar,m);return m.dispatch=_,[d.memoizedState,_]},useDebugValue:Yh,useDeferredValue:function(d,m){var _=ta();return Xh(_,d,m)},useTransition:function(){var d=Wh(!1);return d=Bg.bind(null,ar,d.queue,!0,!1),ta().memoizedState=d,[!1,d]},useSyncExternalStore:function(d,m,_){var O=ar,G=ta();if(xr){if(_===void 0)throw Error(n(407));_=_()}else{if(_=m(),Mr===null)throw Error(n(349));(fr&124)!==0||pg(O,m,_)}G.memoizedState=_;var J={value:_,getSnapshot:m};return G.queue=J,Og(gg.bind(null,O,J,d),[d]),O.flags|=2048,ol(9,wd(),mg.bind(null,O,J,_,m),null),_},useId:function(){var d=ta(),m=Mr.identifierPrefix;if(xr){var _=Us,O=Bs;_=(O&~(1<<32-rt(O)-1)).toString(32)+_,m=""+m+"R"+_,_=bd++,0<_&&(m+="H"+_.toString(32)),m+=""}else _=u6++,m=""+m+"r"+_.toString(32)+"";return d.memoizedState=m},useHostTransitionStatus:Zh,useFormState:Eg,useActionState:Eg,useOptimistic:function(d){var m=ta();m.memoizedState=m.baseState=d;var _={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return m.queue=_,m=Jh.bind(null,ar,!0,_),_.dispatch=m,[d,m]},useMemoCache:Vh,useCacheRefresh:function(){return ta().memoizedState=m6.bind(null,ar)}},Yg={readContext:Fn,use:xd,useCallback:Ig,useContext:Fn,useEffect:jg,useImperativeHandle:Fg,useInsertionEffect:Dg,useLayoutEffect:Mg,useMemo:Pg,useReducer:yd,useRef:Ng,useState:function(){return yd(Vs)},useDebugValue:Yh,useDeferredValue:function(d,m){var _=an();return Lg(_,Tr.memoizedState,d,m)},useTransition:function(){var d=yd(Vs)[0],m=an().memoizedState;return[typeof d=="boolean"?d:Ac(d),m]},useSyncExternalStore:hg,useId:$g,useHostTransitionStatus:Zh,useFormState:Tg,useActionState:Tg,useOptimistic:function(d,m){var _=an();return xg(_,Tr,d,m)},useMemoCache:Vh,useCacheRefresh:Vg},v6={readContext:Fn,use:xd,useCallback:Ig,useContext:Fn,useEffect:jg,useImperativeHandle:Fg,useInsertionEffect:Dg,useLayoutEffect:Mg,useMemo:Pg,useReducer:qh,useRef:Ng,useState:function(){return qh(Vs)},useDebugValue:Yh,useDeferredValue:function(d,m){var _=an();return Tr===null?Xh(_,d,m):Lg(_,Tr.memoizedState,d,m)},useTransition:function(){var d=qh(Vs)[0],m=an().memoizedState;return[typeof d=="boolean"?d:Ac(d),m]},useSyncExternalStore:hg,useId:$g,useHostTransitionStatus:Zh,useFormState:Cg,useActionState:Cg,useOptimistic:function(d,m){var _=an();return Tr!==null?xg(_,Tr,d,m):(_.baseState=d,[d,_.queue.dispatch])},useMemoCache:Vh,useCacheRefresh:Vg},ll=null,Oc=0;function Ed(d){var m=Oc;return Oc+=1,ll===null&&(ll=[]),sg(ll,d,m)}function jc(d,m){m=m.props.ref,d.ref=m!==void 0?m:null}function Td(d,m){throw m.$$typeof===p?Error(n(525)):(d=Object.prototype.toString.call(m),Error(n(31,d==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":d)))}function Xg(d){var m=d._init;return m(d._payload)}function Kg(d){function m(He,Ie){if(d){var Ge=He.deletions;Ge===null?(He.deletions=[Ie],He.flags|=16):Ge.push(Ie)}}function _(He,Ie){if(!d)return null;for(;Ie!==null;)m(He,Ie),Ie=Ie.sibling;return null}function O(He){for(var Ie=new Map;He!==null;)He.key!==null?Ie.set(He.key,He):Ie.set(He.index,He),He=He.sibling;return Ie}function G(He,Ie){return He=Ls(He,Ie),He.index=0,He.sibling=null,He}function J(He,Ie,Ge){return He.index=Ge,d?(Ge=He.alternate,Ge!==null?(Ge=Ge.index,Ge<Ie?(He.flags|=67108866,Ie):Ge):(He.flags|=67108866,Ie)):(He.flags|=1048576,Ie)}function oe(He){return d&&He.alternate===null&&(He.flags|=67108866),He}function pe(He,Ie,Ge,mt){return Ie===null||Ie.tag!==6?(Ie=xh(Ge,He.mode,mt),Ie.return=He,Ie):(Ie=G(Ie,Ge),Ie.return=He,Ie)}function je(He,Ie,Ge,mt){var Ot=Ge.type;return Ot===v?ft(He,Ie,Ge.props.children,mt,Ge.key):Ie!==null&&(Ie.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===V&&Xg(Ot)===Ie.type)?(Ie=G(Ie,Ge.props),jc(Ie,Ge),Ie.return=He,Ie):(Ie=ld(Ge.type,Ge.key,Ge.props,null,He.mode,mt),jc(Ie,Ge),Ie.return=He,Ie)}function Xe(He,Ie,Ge,mt){return Ie===null||Ie.tag!==4||Ie.stateNode.containerInfo!==Ge.containerInfo||Ie.stateNode.implementation!==Ge.implementation?(Ie=yh(Ge,He.mode,mt),Ie.return=He,Ie):(Ie=G(Ie,Ge.children||[]),Ie.return=He,Ie)}function ft(He,Ie,Ge,mt,Ot){return Ie===null||Ie.tag!==7?(Ie=fo(Ge,He.mode,mt,Ot),Ie.return=He,Ie):(Ie=G(Ie,Ge),Ie.return=He,Ie)}function yt(He,Ie,Ge){if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint")return Ie=xh(""+Ie,He.mode,Ge),Ie.return=He,Ie;if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case f:return Ge=ld(Ie.type,Ie.key,Ie.props,null,He.mode,Ge),jc(Ge,Ie),Ge.return=He,Ge;case h:return Ie=yh(Ie,He.mode,Ge),Ie.return=He,Ie;case V:var mt=Ie._init;return Ie=mt(Ie._payload),yt(He,Ie,Ge)}if(C(Ie)||W(Ie))return Ie=fo(Ie,He.mode,Ge,null),Ie.return=He,Ie;if(typeof Ie.then=="function")return yt(He,Ed(Ie),Ge);if(Ie.$$typeof===E)return yt(He,fd(He,Ie),Ge);Td(He,Ie)}return null}function Ze(He,Ie,Ge,mt){var Ot=Ie!==null?Ie.key:null;if(typeof Ge=="string"&&Ge!==""||typeof Ge=="number"||typeof Ge=="bigint")return Ot!==null?null:pe(He,Ie,""+Ge,mt);if(typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case f:return Ge.key===Ot?je(He,Ie,Ge,mt):null;case h:return Ge.key===Ot?Xe(He,Ie,Ge,mt):null;case V:return Ot=Ge._init,Ge=Ot(Ge._payload),Ze(He,Ie,Ge,mt)}if(C(Ge)||W(Ge))return Ot!==null?null:ft(He,Ie,Ge,mt,null);if(typeof Ge.then=="function")return Ze(He,Ie,Ed(Ge),mt);if(Ge.$$typeof===E)return Ze(He,Ie,fd(He,Ge),mt);Td(He,Ge)}return null}function Qe(He,Ie,Ge,mt,Ot){if(typeof mt=="string"&&mt!==""||typeof mt=="number"||typeof mt=="bigint")return He=He.get(Ge)||null,pe(Ie,He,""+mt,Ot);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case f:return He=He.get(mt.key===null?Ge:mt.key)||null,je(Ie,He,mt,Ot);case h:return He=He.get(mt.key===null?Ge:mt.key)||null,Xe(Ie,He,mt,Ot);case V:var or=mt._init;return mt=or(mt._payload),Qe(He,Ie,Ge,mt,Ot)}if(C(mt)||W(mt))return He=He.get(Ge)||null,ft(Ie,He,mt,Ot,null);if(typeof mt.then=="function")return Qe(He,Ie,Ge,Ed(mt),Ot);if(mt.$$typeof===E)return Qe(He,Ie,Ge,fd(Ie,mt),Ot);Td(Ie,mt)}return null}function Yt(He,Ie,Ge,mt){for(var Ot=null,or=null,Lt=Ie,Ht=Ie=0,_n=null;Lt!==null&&Ht<Ge.length;Ht++){Lt.index>Ht?(_n=Lt,Lt=null):_n=Lt.sibling;var br=Ze(He,Lt,Ge[Ht],mt);if(br===null){Lt===null&&(Lt=_n);break}d&&Lt&&br.alternate===null&&m(He,Lt),Ie=J(br,Ie,Ht),or===null?Ot=br:or.sibling=br,or=br,Lt=_n}if(Ht===Ge.length)return _(He,Lt),xr&&po(He,Ht),Ot;if(Lt===null){for(;Ht<Ge.length;Ht++)Lt=yt(He,Ge[Ht],mt),Lt!==null&&(Ie=J(Lt,Ie,Ht),or===null?Ot=Lt:or.sibling=Lt,or=Lt);return xr&&po(He,Ht),Ot}for(Lt=O(Lt);Ht<Ge.length;Ht++)_n=Qe(Lt,He,Ht,Ge[Ht],mt),_n!==null&&(d&&_n.alternate!==null&&Lt.delete(_n.key===null?Ht:_n.key),Ie=J(_n,Ie,Ht),or===null?Ot=_n:or.sibling=_n,or=_n);return d&&Lt.forEach(function(Pi){return m(He,Pi)}),xr&&po(He,Ht),Ot}function Vt(He,Ie,Ge,mt){if(Ge==null)throw Error(n(151));for(var Ot=null,or=null,Lt=Ie,Ht=Ie=0,_n=null,br=Ge.next();Lt!==null&&!br.done;Ht++,br=Ge.next()){Lt.index>Ht?(_n=Lt,Lt=null):_n=Lt.sibling;var Pi=Ze(He,Lt,br.value,mt);if(Pi===null){Lt===null&&(Lt=_n);break}d&&Lt&&Pi.alternate===null&&m(He,Lt),Ie=J(Pi,Ie,Ht),or===null?Ot=Pi:or.sibling=Pi,or=Pi,Lt=_n}if(br.done)return _(He,Lt),xr&&po(He,Ht),Ot;if(Lt===null){for(;!br.done;Ht++,br=Ge.next())br=yt(He,br.value,mt),br!==null&&(Ie=J(br,Ie,Ht),or===null?Ot=br:or.sibling=br,or=br);return xr&&po(He,Ht),Ot}for(Lt=O(Lt);!br.done;Ht++,br=Ge.next())br=Qe(Lt,He,Ht,br.value,mt),br!==null&&(d&&br.alternate!==null&&Lt.delete(br.key===null?Ht:br.key),Ie=J(br,Ie,Ht),or===null?Ot=br:or.sibling=br,or=br);return d&&Lt.forEach(function(b5){return m(He,b5)}),xr&&po(He,Ht),Ot}function Cr(He,Ie,Ge,mt){if(typeof Ge=="object"&&Ge!==null&&Ge.type===v&&Ge.key===null&&(Ge=Ge.props.children),typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case f:e:{for(var Ot=Ge.key;Ie!==null;){if(Ie.key===Ot){if(Ot=Ge.type,Ot===v){if(Ie.tag===7){_(He,Ie.sibling),mt=G(Ie,Ge.props.children),mt.return=He,He=mt;break e}}else if(Ie.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===V&&Xg(Ot)===Ie.type){_(He,Ie.sibling),mt=G(Ie,Ge.props),jc(mt,Ge),mt.return=He,He=mt;break e}_(He,Ie);break}else m(He,Ie);Ie=Ie.sibling}Ge.type===v?(mt=fo(Ge.props.children,He.mode,mt,Ge.key),mt.return=He,He=mt):(mt=ld(Ge.type,Ge.key,Ge.props,null,He.mode,mt),jc(mt,Ge),mt.return=He,He=mt)}return oe(He);case h:e:{for(Ot=Ge.key;Ie!==null;){if(Ie.key===Ot)if(Ie.tag===4&&Ie.stateNode.containerInfo===Ge.containerInfo&&Ie.stateNode.implementation===Ge.implementation){_(He,Ie.sibling),mt=G(Ie,Ge.children||[]),mt.return=He,He=mt;break e}else{_(He,Ie);break}else m(He,Ie);Ie=Ie.sibling}mt=yh(Ge,He.mode,mt),mt.return=He,He=mt}return oe(He);case V:return Ot=Ge._init,Ge=Ot(Ge._payload),Cr(He,Ie,Ge,mt)}if(C(Ge))return Yt(He,Ie,Ge,mt);if(W(Ge)){if(Ot=W(Ge),typeof Ot!="function")throw Error(n(150));return Ge=Ot.call(Ge),Vt(He,Ie,Ge,mt)}if(typeof Ge.then=="function")return Cr(He,Ie,Ed(Ge),mt);if(Ge.$$typeof===E)return Cr(He,Ie,fd(He,Ge),mt);Td(He,Ge)}return typeof Ge=="string"&&Ge!==""||typeof Ge=="number"||typeof Ge=="bigint"?(Ge=""+Ge,Ie!==null&&Ie.tag===6?(_(He,Ie.sibling),mt=G(Ie,Ge),mt.return=He,He=mt):(_(He,Ie),mt=xh(Ge,He.mode,mt),mt.return=He,He=mt),oe(He)):_(He,Ie)}return function(He,Ie,Ge,mt){try{Oc=0;var Ot=Cr(He,Ie,Ge,mt);return ll=null,Ot}catch(Lt){if(Lt===wc||Lt===pd)throw Lt;var or=la(29,Lt,null,He.mode);return or.lanes=mt,or.return=He,or}finally{}}}var cl=Kg(!0),Zg=Kg(!1),Na=B(null),ms=null;function _i(d){var m=d.alternate;X(mn,mn.current&1),X(Na,d),ms===null&&(m===null||al.current!==null||m.memoizedState!==null)&&(ms=d)}function Jg(d){if(d.tag===22){if(X(mn,mn.current),X(Na,d),ms===null){var m=d.alternate;m!==null&&m.memoizedState!==null&&(ms=d)}}else Si()}function Si(){X(mn,mn.current),X(Na,Na.current)}function Hs(d){R(Na),ms===d&&(ms=null),R(mn)}var mn=B(0);function Ad(d){for(var m=d;m!==null;){if(m.tag===13){var _=m.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||_.data==="$?"||$0(_)))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}function Qh(d,m,_,O){m=d.memoizedState,_=_(O,m),_=_==null?m:u({},m,_),d.memoizedState=_,d.lanes===0&&(d.updateQueue.baseState=_)}var e0={enqueueSetState:function(d,m,_){d=d._reactInternals;var O=fa(),G=xi(O);G.payload=m,_!=null&&(G.callback=_),m=yi(d,G,O),m!==null&&(ha(m,d,O),Sc(m,d,O))},enqueueReplaceState:function(d,m,_){d=d._reactInternals;var O=fa(),G=xi(O);G.tag=1,G.payload=m,_!=null&&(G.callback=_),m=yi(d,G,O),m!==null&&(ha(m,d,O),Sc(m,d,O))},enqueueForceUpdate:function(d,m){d=d._reactInternals;var _=fa(),O=xi(_);O.tag=2,m!=null&&(O.callback=m),m=yi(d,O,_),m!==null&&(ha(m,d,_),Sc(m,d,_))}};function Qg(d,m,_,O,G,J,oe){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(O,J,oe):m.prototype&&m.prototype.isPureReactComponent?!hc(_,O)||!hc(G,J):!0}function ev(d,m,_,O){d=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(_,O),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(_,O),m.state!==d&&e0.enqueueReplaceState(m,m.state,null)}function wo(d,m){var _=m;if("ref"in m){_={};for(var O in m)O!=="ref"&&(_[O]=m[O])}if(d=d.defaultProps){_===m&&(_=u({},_));for(var G in d)_[G]===void 0&&(_[G]=d[G])}return _}var Cd=typeof reportError=="function"?reportError:function(d){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var m=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof d=="object"&&d!==null&&typeof d.message=="string"?String(d.message):String(d),error:d});if(!window.dispatchEvent(m))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",d);return}console.error(d)};function tv(d){Cd(d)}function rv(d){console.error(d)}function nv(d){Cd(d)}function Nd(d,m){try{var _=d.onUncaughtError;_(m.value,{componentStack:m.stack})}catch(O){setTimeout(function(){throw O})}}function av(d,m,_){try{var O=d.onCaughtError;O(_.value,{componentStack:_.stack,errorBoundary:m.tag===1?m.stateNode:null})}catch(G){setTimeout(function(){throw G})}}function t0(d,m,_){return _=xi(_),_.tag=3,_.payload={element:null},_.callback=function(){Nd(d,m)},_}function sv(d){return d=xi(d),d.tag=3,d}function iv(d,m,_,O){var G=_.type.getDerivedStateFromError;if(typeof G=="function"){var J=O.value;d.payload=function(){return G(J)},d.callback=function(){av(m,_,O)}}var oe=_.stateNode;oe!==null&&typeof oe.componentDidCatch=="function"&&(d.callback=function(){av(m,_,O),typeof G!="function"&&(Ni===null?Ni=new Set([this]):Ni.add(this));var pe=O.stack;this.componentDidCatch(O.value,{componentStack:pe!==null?pe:""})})}function b6(d,m,_,O,G){if(_.flags|=32768,O!==null&&typeof O=="object"&&typeof O.then=="function"){if(m=_.alternate,m!==null&&bc(m,_,G,!0),_=Na.current,_!==null){switch(_.tag){case 13:return ms===null?E0():_.alternate===null&&qr===0&&(qr=3),_.flags&=-257,_.flags|=65536,_.lanes=G,O===Oh?_.flags|=16384:(m=_.updateQueue,m===null?_.updateQueue=new Set([O]):m.add(O),A0(d,O,G)),!1;case 22:return _.flags|=65536,O===Oh?_.flags|=16384:(m=_.updateQueue,m===null?(m={transitions:null,markerInstances:null,retryQueue:new Set([O])},_.updateQueue=m):(_=m.retryQueue,_===null?m.retryQueue=new Set([O]):_.add(O)),A0(d,O,G)),!1}throw Error(n(435,_.tag))}return A0(d,O,G),E0(),!1}if(xr)return m=Na.current,m!==null?((m.flags&65536)===0&&(m.flags|=256),m.flags|=65536,m.lanes=G,O!==Sh&&(d=Error(n(422),{cause:O}),vc(Ea(d,_)))):(O!==Sh&&(m=Error(n(423),{cause:O}),vc(Ea(m,_))),d=d.current.alternate,d.flags|=65536,G&=-G,d.lanes|=G,O=Ea(O,_),G=t0(d.stateNode,O,G),Mh(d,G),qr!==4&&(qr=2)),!1;var J=Error(n(520),{cause:O});if(J=Ea(J,_),Lc===null?Lc=[J]:Lc.push(J),qr!==4&&(qr=2),m===null)return!0;O=Ea(O,_),_=m;do{switch(_.tag){case 3:return _.flags|=65536,d=G&-G,_.lanes|=d,d=t0(_.stateNode,O,d),Mh(_,d),!1;case 1:if(m=_.type,J=_.stateNode,(_.flags&128)===0&&(typeof m.getDerivedStateFromError=="function"||J!==null&&typeof J.componentDidCatch=="function"&&(Ni===null||!Ni.has(J))))return _.flags|=65536,G&=-G,_.lanes|=G,G=sv(G),iv(G,d,_,O),Mh(_,G),!1}_=_.return}while(_!==null);return!1}var ov=Error(n(461)),yn=!1;function En(d,m,_,O){m.child=d===null?Zg(m,null,_,O):cl(m,d.child,_,O)}function lv(d,m,_,O,G){_=_.render;var J=m.ref;if("ref"in O){var oe={};for(var pe in O)pe!=="ref"&&(oe[pe]=O[pe])}else oe=O;return bo(m),O=Lh(d,m,_,oe,J,G),pe=Bh(),d!==null&&!yn?(Uh(d,m,G),qs(d,m,G)):(xr&&pe&&wh(m),m.flags|=1,En(d,m,O,G),m.child)}function cv(d,m,_,O,G){if(d===null){var J=_.type;return typeof J=="function"&&!bh(J)&&J.defaultProps===void 0&&_.compare===null?(m.tag=15,m.type=J,uv(d,m,J,O,G)):(d=ld(_.type,null,O,m,m.mode,G),d.ref=m.ref,d.return=m,m.child=d)}if(J=d.child,!c0(d,G)){var oe=J.memoizedProps;if(_=_.compare,_=_!==null?_:hc,_(oe,O)&&d.ref===m.ref)return qs(d,m,G)}return m.flags|=1,d=Ls(J,O),d.ref=m.ref,d.return=m,m.child=d}function uv(d,m,_,O,G){if(d!==null){var J=d.memoizedProps;if(hc(J,O)&&d.ref===m.ref)if(yn=!1,m.pendingProps=O=J,c0(d,G))(d.flags&131072)!==0&&(yn=!0);else return m.lanes=d.lanes,qs(d,m,G)}return r0(d,m,_,O,G)}function dv(d,m,_){var O=m.pendingProps,G=O.children,J=d!==null?d.memoizedState:null;if(O.mode==="hidden"){if((m.flags&128)!==0){if(O=J!==null?J.baseLanes|_:_,d!==null){for(G=m.child=d.child,J=0;G!==null;)J=J|G.lanes|G.childLanes,G=G.sibling;m.childLanes=J&~O}else m.childLanes=0,m.child=null;return fv(d,m,O,_)}if((_&536870912)!==0)m.memoizedState={baseLanes:0,cachePool:null},d!==null&&hd(m,J!==null?J.cachePool:null),J!==null?ug(m,J):Fh(),Jg(m);else return m.lanes=m.childLanes=536870912,fv(d,m,J!==null?J.baseLanes|_:_,_)}else J!==null?(hd(m,J.cachePool),ug(m,J),Si(),m.memoizedState=null):(d!==null&&hd(m,null),Fh(),Si());return En(d,m,G,_),m.child}function fv(d,m,_,O){var G=Nh();return G=G===null?null:{parent:pn._currentValue,pool:G},m.memoizedState={baseLanes:_,cachePool:G},d!==null&&hd(m,null),Fh(),Jg(m),d!==null&&bc(d,m,O,!0),null}function Od(d,m){var _=m.ref;if(_===null)d!==null&&d.ref!==null&&(m.flags|=4194816);else{if(typeof _!="function"&&typeof _!="object")throw Error(n(284));(d===null||d.ref!==_)&&(m.flags|=4194816)}}function r0(d,m,_,O,G){return bo(m),_=Lh(d,m,_,O,void 0,G),O=Bh(),d!==null&&!yn?(Uh(d,m,G),qs(d,m,G)):(xr&&O&&wh(m),m.flags|=1,En(d,m,_,G),m.child)}function hv(d,m,_,O,G,J){return bo(m),m.updateQueue=null,_=fg(m,O,_,G),dg(d),O=Bh(),d!==null&&!yn?(Uh(d,m,J),qs(d,m,J)):(xr&&O&&wh(m),m.flags|=1,En(d,m,_,J),m.child)}function pv(d,m,_,O,G){if(bo(m),m.stateNode===null){var J=Qo,oe=_.contextType;typeof oe=="object"&&oe!==null&&(J=Fn(oe)),J=new _(O,J),m.memoizedState=J.state!==null&&J.state!==void 0?J.state:null,J.updater=e0,m.stateNode=J,J._reactInternals=m,J=m.stateNode,J.props=O,J.state=m.memoizedState,J.refs={},jh(m),oe=_.contextType,J.context=typeof oe=="object"&&oe!==null?Fn(oe):Qo,J.state=m.memoizedState,oe=_.getDerivedStateFromProps,typeof oe=="function"&&(Qh(m,_,oe,O),J.state=m.memoizedState),typeof _.getDerivedStateFromProps=="function"||typeof J.getSnapshotBeforeUpdate=="function"||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(oe=J.state,typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount(),oe!==J.state&&e0.enqueueReplaceState(J,J.state,null),Ec(m,O,J,G),kc(),J.state=m.memoizedState),typeof J.componentDidMount=="function"&&(m.flags|=4194308),O=!0}else if(d===null){J=m.stateNode;var pe=m.memoizedProps,je=wo(_,pe);J.props=je;var Xe=J.context,ft=_.contextType;oe=Qo,typeof ft=="object"&&ft!==null&&(oe=Fn(ft));var yt=_.getDerivedStateFromProps;ft=typeof yt=="function"||typeof J.getSnapshotBeforeUpdate=="function",pe=m.pendingProps!==pe,ft||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(pe||Xe!==oe)&&ev(m,J,O,oe),bi=!1;var Ze=m.memoizedState;J.state=Ze,Ec(m,O,J,G),kc(),Xe=m.memoizedState,pe||Ze!==Xe||bi?(typeof yt=="function"&&(Qh(m,_,yt,O),Xe=m.memoizedState),(je=bi||Qg(m,_,je,O,Ze,Xe,oe))?(ft||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount()),typeof J.componentDidMount=="function"&&(m.flags|=4194308)):(typeof J.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=O,m.memoizedState=Xe),J.props=O,J.state=Xe,J.context=oe,O=je):(typeof J.componentDidMount=="function"&&(m.flags|=4194308),O=!1)}else{J=m.stateNode,Dh(d,m),oe=m.memoizedProps,ft=wo(_,oe),J.props=ft,yt=m.pendingProps,Ze=J.context,Xe=_.contextType,je=Qo,typeof Xe=="object"&&Xe!==null&&(je=Fn(Xe)),pe=_.getDerivedStateFromProps,(Xe=typeof pe=="function"||typeof J.getSnapshotBeforeUpdate=="function")||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(oe!==yt||Ze!==je)&&ev(m,J,O,je),bi=!1,Ze=m.memoizedState,J.state=Ze,Ec(m,O,J,G),kc();var Qe=m.memoizedState;oe!==yt||Ze!==Qe||bi||d!==null&&d.dependencies!==null&&dd(d.dependencies)?(typeof pe=="function"&&(Qh(m,_,pe,O),Qe=m.memoizedState),(ft=bi||Qg(m,_,ft,O,Ze,Qe,je)||d!==null&&d.dependencies!==null&&dd(d.dependencies))?(Xe||typeof J.UNSAFE_componentWillUpdate!="function"&&typeof J.componentWillUpdate!="function"||(typeof J.componentWillUpdate=="function"&&J.componentWillUpdate(O,Qe,je),typeof J.UNSAFE_componentWillUpdate=="function"&&J.UNSAFE_componentWillUpdate(O,Qe,je)),typeof J.componentDidUpdate=="function"&&(m.flags|=4),typeof J.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof J.componentDidUpdate!="function"||oe===d.memoizedProps&&Ze===d.memoizedState||(m.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||oe===d.memoizedProps&&Ze===d.memoizedState||(m.flags|=1024),m.memoizedProps=O,m.memoizedState=Qe),J.props=O,J.state=Qe,J.context=je,O=ft):(typeof J.componentDidUpdate!="function"||oe===d.memoizedProps&&Ze===d.memoizedState||(m.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||oe===d.memoizedProps&&Ze===d.memoizedState||(m.flags|=1024),O=!1)}return J=O,Od(d,m),O=(m.flags&128)!==0,J||O?(J=m.stateNode,_=O&&typeof _.getDerivedStateFromError!="function"?null:J.render(),m.flags|=1,d!==null&&O?(m.child=cl(m,d.child,null,G),m.child=cl(m,null,_,G)):En(d,m,_,G),m.memoizedState=J.state,d=m.child):d=qs(d,m,G),d}function mv(d,m,_,O){return gc(),m.flags|=256,En(d,m,_,O),m.child}var n0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function a0(d){return{baseLanes:d,cachePool:rg()}}function s0(d,m,_){return d=d!==null?d.childLanes&~_:0,m&&(d|=Oa),d}function gv(d,m,_){var O=m.pendingProps,G=!1,J=(m.flags&128)!==0,oe;if((oe=J)||(oe=d!==null&&d.memoizedState===null?!1:(mn.current&2)!==0),oe&&(G=!0,m.flags&=-129),oe=(m.flags&32)!==0,m.flags&=-33,d===null){if(xr){if(G?_i(m):Si(),xr){var pe=Hr,je;if(je=pe){e:{for(je=pe,pe=ps;je.nodeType!==8;){if(!pe){pe=null;break e}if(je=Ka(je.nextSibling),je===null){pe=null;break e}}pe=je}pe!==null?(m.memoizedState={dehydrated:pe,treeContext:ho!==null?{id:Bs,overflow:Us}:null,retryLane:536870912,hydrationErrors:null},je=la(18,null,null,0),je.stateNode=pe,je.return=m,m.child=je,Wn=m,Hr=null,je=!0):je=!1}je||go(m)}if(pe=m.memoizedState,pe!==null&&(pe=pe.dehydrated,pe!==null))return $0(pe)?m.lanes=32:m.lanes=536870912,null;Hs(m)}return pe=O.children,O=O.fallback,G?(Si(),G=m.mode,pe=jd({mode:"hidden",children:pe},G),O=fo(O,G,_,null),pe.return=m,O.return=m,pe.sibling=O,m.child=pe,G=m.child,G.memoizedState=a0(_),G.childLanes=s0(d,oe,_),m.memoizedState=n0,O):(_i(m),i0(m,pe))}if(je=d.memoizedState,je!==null&&(pe=je.dehydrated,pe!==null)){if(J)m.flags&256?(_i(m),m.flags&=-257,m=o0(d,m,_)):m.memoizedState!==null?(Si(),m.child=d.child,m.flags|=128,m=null):(Si(),G=O.fallback,pe=m.mode,O=jd({mode:"visible",children:O.children},pe),G=fo(G,pe,_,null),G.flags|=2,O.return=m,G.return=m,O.sibling=G,m.child=O,cl(m,d.child,null,_),O=m.child,O.memoizedState=a0(_),O.childLanes=s0(d,oe,_),m.memoizedState=n0,m=G);else if(_i(m),$0(pe)){if(oe=pe.nextSibling&&pe.nextSibling.dataset,oe)var Xe=oe.dgst;oe=Xe,O=Error(n(419)),O.stack="",O.digest=oe,vc({value:O,source:null,stack:null}),m=o0(d,m,_)}else if(yn||bc(d,m,_,!1),oe=(_&d.childLanes)!==0,yn||oe){if(oe=Mr,oe!==null&&(O=_&-_,O=(O&42)!==0?1:lt(O),O=(O&(oe.suspendedLanes|_))!==0?0:O,O!==0&&O!==je.retryLane))throw je.retryLane=O,Jo(d,O),ha(oe,d,O),ov;pe.data==="$?"||E0(),m=o0(d,m,_)}else pe.data==="$?"?(m.flags|=192,m.child=d.child,m=null):(d=je.treeContext,Hr=Ka(pe.nextSibling),Wn=m,xr=!0,mo=null,ps=!1,d!==null&&(Aa[Ca++]=Bs,Aa[Ca++]=Us,Aa[Ca++]=ho,Bs=d.id,Us=d.overflow,ho=m),m=i0(m,O.children),m.flags|=4096);return m}return G?(Si(),G=O.fallback,pe=m.mode,je=d.child,Xe=je.sibling,O=Ls(je,{mode:"hidden",children:O.children}),O.subtreeFlags=je.subtreeFlags&65011712,Xe!==null?G=Ls(Xe,G):(G=fo(G,pe,_,null),G.flags|=2),G.return=m,O.return=m,O.sibling=G,m.child=O,O=G,G=m.child,pe=d.child.memoizedState,pe===null?pe=a0(_):(je=pe.cachePool,je!==null?(Xe=pn._currentValue,je=je.parent!==Xe?{parent:Xe,pool:Xe}:je):je=rg(),pe={baseLanes:pe.baseLanes|_,cachePool:je}),G.memoizedState=pe,G.childLanes=s0(d,oe,_),m.memoizedState=n0,O):(_i(m),_=d.child,d=_.sibling,_=Ls(_,{mode:"visible",children:O.children}),_.return=m,_.sibling=null,d!==null&&(oe=m.deletions,oe===null?(m.deletions=[d],m.flags|=16):oe.push(d)),m.child=_,m.memoizedState=null,_)}function i0(d,m){return m=jd({mode:"visible",children:m},d.mode),m.return=d,d.child=m}function jd(d,m){return d=la(22,d,null,m),d.lanes=0,d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},d}function o0(d,m,_){return cl(m,d.child,null,_),d=i0(m,m.pendingProps.children),d.flags|=2,m.memoizedState=null,d}function vv(d,m,_){d.lanes|=m;var O=d.alternate;O!==null&&(O.lanes|=m),Eh(d.return,m,_)}function l0(d,m,_,O,G){var J=d.memoizedState;J===null?d.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:O,tail:_,tailMode:G}:(J.isBackwards=m,J.rendering=null,J.renderingStartTime=0,J.last=O,J.tail=_,J.tailMode=G)}function bv(d,m,_){var O=m.pendingProps,G=O.revealOrder,J=O.tail;if(En(d,m,O.children,_),O=mn.current,(O&2)!==0)O=O&1|2,m.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=m.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&vv(d,_,m);else if(d.tag===19)vv(d,_,m);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===m)break e;for(;d.sibling===null;){if(d.return===null||d.return===m)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}O&=1}switch(X(mn,O),G){case"forwards":for(_=m.child,G=null;_!==null;)d=_.alternate,d!==null&&Ad(d)===null&&(G=_),_=_.sibling;_=G,_===null?(G=m.child,m.child=null):(G=_.sibling,_.sibling=null),l0(m,!1,G,_,J);break;case"backwards":for(_=null,G=m.child,m.child=null;G!==null;){if(d=G.alternate,d!==null&&Ad(d)===null){m.child=G;break}d=G.sibling,G.sibling=_,_=G,G=d}l0(m,!0,_,null,J);break;case"together":l0(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function qs(d,m,_){if(d!==null&&(m.dependencies=d.dependencies),Ci|=m.lanes,(_&m.childLanes)===0)if(d!==null){if(bc(d,m,_,!1),(_&m.childLanes)===0)return null}else return null;if(d!==null&&m.child!==d.child)throw Error(n(153));if(m.child!==null){for(d=m.child,_=Ls(d,d.pendingProps),m.child=_,_.return=m;d.sibling!==null;)d=d.sibling,_=_.sibling=Ls(d,d.pendingProps),_.return=m;_.sibling=null}return m.child}function c0(d,m){return(d.lanes&m)!==0?!0:(d=d.dependencies,!!(d!==null&&dd(d)))}function x6(d,m,_){switch(m.tag){case 3:P(m,m.stateNode.containerInfo),vi(m,pn,d.memoizedState.cache),gc();break;case 27:case 5:Z(m);break;case 4:P(m,m.stateNode.containerInfo);break;case 10:vi(m,m.type,m.memoizedProps.value);break;case 13:var O=m.memoizedState;if(O!==null)return O.dehydrated!==null?(_i(m),m.flags|=128,null):(_&m.child.childLanes)!==0?gv(d,m,_):(_i(m),d=qs(d,m,_),d!==null?d.sibling:null);_i(m);break;case 19:var G=(d.flags&128)!==0;if(O=(_&m.childLanes)!==0,O||(bc(d,m,_,!1),O=(_&m.childLanes)!==0),G){if(O)return bv(d,m,_);m.flags|=128}if(G=m.memoizedState,G!==null&&(G.rendering=null,G.tail=null,G.lastEffect=null),X(mn,mn.current),O)break;return null;case 22:case 23:return m.lanes=0,dv(d,m,_);case 24:vi(m,pn,d.memoizedState.cache)}return qs(d,m,_)}function xv(d,m,_){if(d!==null)if(d.memoizedProps!==m.pendingProps)yn=!0;else{if(!c0(d,_)&&(m.flags&128)===0)return yn=!1,x6(d,m,_);yn=(d.flags&131072)!==0}else yn=!1,xr&&(m.flags&1048576)!==0&&X1(m,ud,m.index);switch(m.lanes=0,m.tag){case 16:e:{d=m.pendingProps;var O=m.elementType,G=O._init;if(O=G(O._payload),m.type=O,typeof O=="function")bh(O)?(d=wo(O,d),m.tag=1,m=pv(null,m,O,d,_)):(m.tag=0,m=r0(null,m,O,d,_));else{if(O!=null){if(G=O.$$typeof,G===N){m.tag=11,m=lv(null,m,O,d,_);break e}else if(G===H){m.tag=14,m=cv(null,m,O,d,_);break e}}throw m=M(O)||O,Error(n(306,m,""))}}return m;case 0:return r0(d,m,m.type,m.pendingProps,_);case 1:return O=m.type,G=wo(O,m.pendingProps),pv(d,m,O,G,_);case 3:e:{if(P(m,m.stateNode.containerInfo),d===null)throw Error(n(387));O=m.pendingProps;var J=m.memoizedState;G=J.element,Dh(d,m),Ec(m,O,null,_);var oe=m.memoizedState;if(O=oe.cache,vi(m,pn,O),O!==J.cache&&Th(m,[pn],_,!0),kc(),O=oe.element,J.isDehydrated)if(J={element:O,isDehydrated:!1,cache:oe.cache},m.updateQueue.baseState=J,m.memoizedState=J,m.flags&256){m=mv(d,m,O,_);break e}else if(O!==G){G=Ea(Error(n(424)),m),vc(G),m=mv(d,m,O,_);break e}else{switch(d=m.stateNode.containerInfo,d.nodeType){case 9:d=d.body;break;default:d=d.nodeName==="HTML"?d.ownerDocument.body:d}for(Hr=Ka(d.firstChild),Wn=m,xr=!0,mo=null,ps=!0,_=Zg(m,null,O,_),m.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling}else{if(gc(),O===G){m=qs(d,m,_);break e}En(d,m,O,_)}m=m.child}return m;case 26:return Od(d,m),d===null?(_=Sb(m.type,null,m.pendingProps,null))?m.memoizedState=_:xr||(_=m.type,d=m.pendingProps,O=qd(U.current).createElement(_),O[bt]=m,O[xt]=d,An(O,_,d),Me(O),m.stateNode=O):m.memoizedState=Sb(m.type,d.memoizedProps,m.pendingProps,d.memoizedState),null;case 27:return Z(m),d===null&&xr&&(O=m.stateNode=yb(m.type,m.pendingProps,U.current),Wn=m,ps=!0,G=Hr,Di(m.type)?(V0=G,Hr=Ka(O.firstChild)):Hr=G),En(d,m,m.pendingProps.children,_),Od(d,m),d===null&&(m.flags|=4194304),m.child;case 5:return d===null&&xr&&((G=O=Hr)&&(O=G6(O,m.type,m.pendingProps,ps),O!==null?(m.stateNode=O,Wn=m,Hr=Ka(O.firstChild),ps=!1,G=!0):G=!1),G||go(m)),Z(m),G=m.type,J=m.pendingProps,oe=d!==null?d.memoizedProps:null,O=J.children,B0(G,J)?O=null:oe!==null&&B0(G,oe)&&(m.flags|=32),m.memoizedState!==null&&(G=Lh(d,m,d6,null,null,_),Gc._currentValue=G),Od(d,m),En(d,m,O,_),m.child;case 6:return d===null&&xr&&((d=_=Hr)&&(_=Y6(_,m.pendingProps,ps),_!==null?(m.stateNode=_,Wn=m,Hr=null,d=!0):d=!1),d||go(m)),null;case 13:return gv(d,m,_);case 4:return P(m,m.stateNode.containerInfo),O=m.pendingProps,d===null?m.child=cl(m,null,O,_):En(d,m,O,_),m.child;case 11:return lv(d,m,m.type,m.pendingProps,_);case 7:return En(d,m,m.pendingProps,_),m.child;case 8:return En(d,m,m.pendingProps.children,_),m.child;case 12:return En(d,m,m.pendingProps.children,_),m.child;case 10:return O=m.pendingProps,vi(m,m.type,O.value),En(d,m,O.children,_),m.child;case 9:return G=m.type._context,O=m.pendingProps.children,bo(m),G=Fn(G),O=O(G),m.flags|=1,En(d,m,O,_),m.child;case 14:return cv(d,m,m.type,m.pendingProps,_);case 15:return uv(d,m,m.type,m.pendingProps,_);case 19:return bv(d,m,_);case 31:return O=m.pendingProps,_=m.mode,O={mode:O.mode,children:O.children},d===null?(_=jd(O,_),_.ref=m.ref,m.child=_,_.return=m,m=_):(_=Ls(d.child,O),_.ref=m.ref,m.child=_,_.return=m,m=_),m;case 22:return dv(d,m,_);case 24:return bo(m),O=Fn(pn),d===null?(G=Nh(),G===null&&(G=Mr,J=Ah(),G.pooledCache=J,J.refCount++,J!==null&&(G.pooledCacheLanes|=_),G=J),m.memoizedState={parent:O,cache:G},jh(m),vi(m,pn,G)):((d.lanes&_)!==0&&(Dh(d,m),Ec(m,null,null,_),kc()),G=d.memoizedState,J=m.memoizedState,G.parent!==O?(G={parent:O,cache:O},m.memoizedState=G,m.lanes===0&&(m.memoizedState=m.updateQueue.baseState=G),vi(m,pn,O)):(O=J.cache,vi(m,pn,O),O!==G.cache&&Th(m,[pn],_,!0))),En(d,m,m.pendingProps.children,_),m.child;case 29:throw m.pendingProps}throw Error(n(156,m.tag))}function Ws(d){d.flags|=4}function yv(d,m){if(m.type!=="stylesheet"||(m.state.loading&4)!==0)d.flags&=-16777217;else if(d.flags|=16777216,!Cb(m)){if(m=Na.current,m!==null&&((fr&4194048)===fr?ms!==null:(fr&62914560)!==fr&&(fr&536870912)===0||m!==ms))throw _c=Oh,ng;d.flags|=8192}}function Dd(d,m){m!==null&&(d.flags|=4),d.flags&16384&&(m=d.tag!==22?Be():536870912,d.lanes|=m,hl|=m)}function Dc(d,m){if(!xr)switch(d.tailMode){case"hidden":m=d.tail;for(var _=null;m!==null;)m.alternate!==null&&(_=m),m=m.sibling;_===null?d.tail=null:_.sibling=null;break;case"collapsed":_=d.tail;for(var O=null;_!==null;)_.alternate!==null&&(O=_),_=_.sibling;O===null?m||d.tail===null?d.tail=null:d.tail.sibling=null:O.sibling=null}}function Br(d){var m=d.alternate!==null&&d.alternate.child===d.child,_=0,O=0;if(m)for(var G=d.child;G!==null;)_|=G.lanes|G.childLanes,O|=G.subtreeFlags&65011712,O|=G.flags&65011712,G.return=d,G=G.sibling;else for(G=d.child;G!==null;)_|=G.lanes|G.childLanes,O|=G.subtreeFlags,O|=G.flags,G.return=d,G=G.sibling;return d.subtreeFlags|=O,d.childLanes=_,m}function y6(d,m,_){var O=m.pendingProps;switch(_h(m),m.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Br(m),null;case 1:return Br(m),null;case 3:return _=m.stateNode,O=null,d!==null&&(O=d.memoizedState.cache),m.memoizedState.cache!==O&&(m.flags|=2048),$s(pn),F(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(d===null||d.child===null)&&(mc(m)?Ws(m):d===null||d.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,J1())),Br(m),null;case 26:return _=m.memoizedState,d===null?(Ws(m),_!==null?(Br(m),yv(m,_)):(Br(m),m.flags&=-16777217)):_?_!==d.memoizedState?(Ws(m),Br(m),yv(m,_)):(Br(m),m.flags&=-16777217):(d.memoizedProps!==O&&Ws(m),Br(m),m.flags&=-16777217),null;case 27:se(m),_=U.current;var G=m.type;if(d!==null&&m.stateNode!=null)d.memoizedProps!==O&&Ws(m);else{if(!O){if(m.stateNode===null)throw Error(n(166));return Br(m),null}d=Y.current,mc(m)?K1(m):(d=yb(G,O,_),m.stateNode=d,Ws(m))}return Br(m),null;case 5:if(se(m),_=m.type,d!==null&&m.stateNode!=null)d.memoizedProps!==O&&Ws(m);else{if(!O){if(m.stateNode===null)throw Error(n(166));return Br(m),null}if(d=Y.current,mc(m))K1(m);else{switch(G=qd(U.current),d){case 1:d=G.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:d=G.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":d=G.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":d=G.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":d=G.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild);break;case"select":d=typeof O.is=="string"?G.createElement("select",{is:O.is}):G.createElement("select"),O.multiple?d.multiple=!0:O.size&&(d.size=O.size);break;default:d=typeof O.is=="string"?G.createElement(_,{is:O.is}):G.createElement(_)}}d[bt]=m,d[xt]=O;e:for(G=m.child;G!==null;){if(G.tag===5||G.tag===6)d.appendChild(G.stateNode);else if(G.tag!==4&&G.tag!==27&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===m)break e;for(;G.sibling===null;){if(G.return===null||G.return===m)break e;G=G.return}G.sibling.return=G.return,G=G.sibling}m.stateNode=d;e:switch(An(d,_,O),_){case"button":case"input":case"select":case"textarea":d=!!O.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&Ws(m)}}return Br(m),m.flags&=-16777217,null;case 6:if(d&&m.stateNode!=null)d.memoizedProps!==O&&Ws(m);else{if(typeof O!="string"&&m.stateNode===null)throw Error(n(166));if(d=U.current,mc(m)){if(d=m.stateNode,_=m.memoizedProps,O=null,G=Wn,G!==null)switch(G.tag){case 27:case 5:O=G.memoizedProps}d[bt]=m,d=!!(d.nodeValue===_||O!==null&&O.suppressHydrationWarning===!0||hb(d.nodeValue,_)),d||go(m)}else d=qd(d).createTextNode(O),d[bt]=m,m.stateNode=d}return Br(m),null;case 13:if(O=m.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(G=mc(m),O!==null&&O.dehydrated!==null){if(d===null){if(!G)throw Error(n(318));if(G=m.memoizedState,G=G!==null?G.dehydrated:null,!G)throw Error(n(317));G[bt]=m}else gc(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;Br(m),G=!1}else G=J1(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=G),G=!0;if(!G)return m.flags&256?(Hs(m),m):(Hs(m),null)}if(Hs(m),(m.flags&128)!==0)return m.lanes=_,m;if(_=O!==null,d=d!==null&&d.memoizedState!==null,_){O=m.child,G=null,O.alternate!==null&&O.alternate.memoizedState!==null&&O.alternate.memoizedState.cachePool!==null&&(G=O.alternate.memoizedState.cachePool.pool);var J=null;O.memoizedState!==null&&O.memoizedState.cachePool!==null&&(J=O.memoizedState.cachePool.pool),J!==G&&(O.flags|=2048)}return _!==d&&_&&(m.child.flags|=8192),Dd(m,m.updateQueue),Br(m),null;case 4:return F(),d===null&&R0(m.stateNode.containerInfo),Br(m),null;case 10:return $s(m.type),Br(m),null;case 19:if(R(mn),G=m.memoizedState,G===null)return Br(m),null;if(O=(m.flags&128)!==0,J=G.rendering,J===null)if(O)Dc(G,!1);else{if(qr!==0||d!==null&&(d.flags&128)!==0)for(d=m.child;d!==null;){if(J=Ad(d),J!==null){for(m.flags|=128,Dc(G,!1),d=J.updateQueue,m.updateQueue=d,Dd(m,d),m.subtreeFlags=0,d=_,_=m.child;_!==null;)Y1(_,d),_=_.sibling;return X(mn,mn.current&1|2),m.child}d=d.sibling}G.tail!==null&&ne()>Fd&&(m.flags|=128,O=!0,Dc(G,!1),m.lanes=4194304)}else{if(!O)if(d=Ad(J),d!==null){if(m.flags|=128,O=!0,d=d.updateQueue,m.updateQueue=d,Dd(m,d),Dc(G,!0),G.tail===null&&G.tailMode==="hidden"&&!J.alternate&&!xr)return Br(m),null}else 2*ne()-G.renderingStartTime>Fd&&_!==536870912&&(m.flags|=128,O=!0,Dc(G,!1),m.lanes=4194304);G.isBackwards?(J.sibling=m.child,m.child=J):(d=G.last,d!==null?d.sibling=J:m.child=J,G.last=J)}return G.tail!==null?(m=G.tail,G.rendering=m,G.tail=m.sibling,G.renderingStartTime=ne(),m.sibling=null,d=mn.current,X(mn,O?d&1|2:d&1),m):(Br(m),null);case 22:case 23:return Hs(m),Ih(),O=m.memoizedState!==null,d!==null?d.memoizedState!==null!==O&&(m.flags|=8192):O&&(m.flags|=8192),O?(_&536870912)!==0&&(m.flags&128)===0&&(Br(m),m.subtreeFlags&6&&(m.flags|=8192)):Br(m),_=m.updateQueue,_!==null&&Dd(m,_.retryQueue),_=null,d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(_=d.memoizedState.cachePool.pool),O=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(O=m.memoizedState.cachePool.pool),O!==_&&(m.flags|=2048),d!==null&&R(xo),null;case 24:return _=null,d!==null&&(_=d.memoizedState.cache),m.memoizedState.cache!==_&&(m.flags|=2048),$s(pn),Br(m),null;case 25:return null;case 30:return null}throw Error(n(156,m.tag))}function w6(d,m){switch(_h(m),m.tag){case 1:return d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 3:return $s(pn),F(),d=m.flags,(d&65536)!==0&&(d&128)===0?(m.flags=d&-65537|128,m):null;case 26:case 27:case 5:return se(m),null;case 13:if(Hs(m),d=m.memoizedState,d!==null&&d.dehydrated!==null){if(m.alternate===null)throw Error(n(340));gc()}return d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 19:return R(mn),null;case 4:return F(),null;case 10:return $s(m.type),null;case 22:case 23:return Hs(m),Ih(),d!==null&&R(xo),d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 24:return $s(pn),null;case 25:return null;default:return null}}function wv(d,m){switch(_h(m),m.tag){case 3:$s(pn),F();break;case 26:case 27:case 5:se(m);break;case 4:F();break;case 13:Hs(m);break;case 19:R(mn);break;case 10:$s(m.type);break;case 22:case 23:Hs(m),Ih(),d!==null&&R(xo);break;case 24:$s(pn)}}function Mc(d,m){try{var _=m.updateQueue,O=_!==null?_.lastEffect:null;if(O!==null){var G=O.next;_=G;do{if((_.tag&d)===d){O=void 0;var J=_.create,oe=_.inst;O=J(),oe.destroy=O}_=_.next}while(_!==G)}}catch(pe){Or(m,m.return,pe)}}function ki(d,m,_){try{var O=m.updateQueue,G=O!==null?O.lastEffect:null;if(G!==null){var J=G.next;O=J;do{if((O.tag&d)===d){var oe=O.inst,pe=oe.destroy;if(pe!==void 0){oe.destroy=void 0,G=m;var je=_,Xe=pe;try{Xe()}catch(ft){Or(G,je,ft)}}}O=O.next}while(O!==J)}}catch(ft){Or(m,m.return,ft)}}function _v(d){var m=d.updateQueue;if(m!==null){var _=d.stateNode;try{cg(m,_)}catch(O){Or(d,d.return,O)}}}function Sv(d,m,_){_.props=wo(d.type,d.memoizedProps),_.state=d.memoizedState;try{_.componentWillUnmount()}catch(O){Or(d,m,O)}}function Rc(d,m){try{var _=d.ref;if(_!==null){switch(d.tag){case 26:case 27:case 5:var O=d.stateNode;break;case 30:O=d.stateNode;break;default:O=d.stateNode}typeof _=="function"?d.refCleanup=_(O):_.current=O}}catch(G){Or(d,m,G)}}function gs(d,m){var _=d.ref,O=d.refCleanup;if(_!==null)if(typeof O=="function")try{O()}catch(G){Or(d,m,G)}finally{d.refCleanup=null,d=d.alternate,d!=null&&(d.refCleanup=null)}else if(typeof _=="function")try{_(null)}catch(G){Or(d,m,G)}else _.current=null}function kv(d){var m=d.type,_=d.memoizedProps,O=d.stateNode;try{e:switch(m){case"button":case"input":case"select":case"textarea":_.autoFocus&&O.focus();break e;case"img":_.src?O.src=_.src:_.srcSet&&(O.srcset=_.srcSet)}}catch(G){Or(d,d.return,G)}}function u0(d,m,_){try{var O=d.stateNode;$6(O,d.type,_,m),O[xt]=m}catch(G){Or(d,d.return,G)}}function Ev(d){return d.tag===5||d.tag===3||d.tag===26||d.tag===27&&Di(d.type)||d.tag===4}function d0(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||Ev(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.tag===27&&Di(d.type)||d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function f0(d,m,_){var O=d.tag;if(O===5||O===6)d=d.stateNode,m?(_.nodeType===9?_.body:_.nodeName==="HTML"?_.ownerDocument.body:_).insertBefore(d,m):(m=_.nodeType===9?_.body:_.nodeName==="HTML"?_.ownerDocument.body:_,m.appendChild(d),_=_._reactRootContainer,_!=null||m.onclick!==null||(m.onclick=Hd));else if(O!==4&&(O===27&&Di(d.type)&&(_=d.stateNode,m=null),d=d.child,d!==null))for(f0(d,m,_),d=d.sibling;d!==null;)f0(d,m,_),d=d.sibling}function Md(d,m,_){var O=d.tag;if(O===5||O===6)d=d.stateNode,m?_.insertBefore(d,m):_.appendChild(d);else if(O!==4&&(O===27&&Di(d.type)&&(_=d.stateNode),d=d.child,d!==null))for(Md(d,m,_),d=d.sibling;d!==null;)Md(d,m,_),d=d.sibling}function Tv(d){var m=d.stateNode,_=d.memoizedProps;try{for(var O=d.type,G=m.attributes;G.length;)m.removeAttributeNode(G[0]);An(m,O,_),m[bt]=d,m[xt]=_}catch(J){Or(d,d.return,J)}}var Gs=!1,Kr=!1,h0=!1,Av=typeof WeakSet=="function"?WeakSet:Set,wn=null;function _6(d,m){if(d=d.containerInfo,P0=Zd,d=L1(d),dh(d)){if("selectionStart"in d)var _={start:d.selectionStart,end:d.selectionEnd};else e:{_=(_=d.ownerDocument)&&_.defaultView||window;var O=_.getSelection&&_.getSelection();if(O&&O.rangeCount!==0){_=O.anchorNode;var G=O.anchorOffset,J=O.focusNode;O=O.focusOffset;try{_.nodeType,J.nodeType}catch{_=null;break e}var oe=0,pe=-1,je=-1,Xe=0,ft=0,yt=d,Ze=null;t:for(;;){for(var Qe;yt!==_||G!==0&&yt.nodeType!==3||(pe=oe+G),yt!==J||O!==0&&yt.nodeType!==3||(je=oe+O),yt.nodeType===3&&(oe+=yt.nodeValue.length),(Qe=yt.firstChild)!==null;)Ze=yt,yt=Qe;for(;;){if(yt===d)break t;if(Ze===_&&++Xe===G&&(pe=oe),Ze===J&&++ft===O&&(je=oe),(Qe=yt.nextSibling)!==null)break;yt=Ze,Ze=yt.parentNode}yt=Qe}_=pe===-1||je===-1?null:{start:pe,end:je}}else _=null}_=_||{start:0,end:0}}else _=null;for(L0={focusedElem:d,selectionRange:_},Zd=!1,wn=m;wn!==null;)if(m=wn,d=m.child,(m.subtreeFlags&1024)!==0&&d!==null)d.return=m,wn=d;else for(;wn!==null;){switch(m=wn,J=m.alternate,d=m.flags,m.tag){case 0:break;case 11:case 15:break;case 1:if((d&1024)!==0&&J!==null){d=void 0,_=m,G=J.memoizedProps,J=J.memoizedState,O=_.stateNode;try{var Yt=wo(_.type,G,_.elementType===_.type);d=O.getSnapshotBeforeUpdate(Yt,J),O.__reactInternalSnapshotBeforeUpdate=d}catch(Vt){Or(_,_.return,Vt)}}break;case 3:if((d&1024)!==0){if(d=m.stateNode.containerInfo,_=d.nodeType,_===9)z0(d);else if(_===1)switch(d.nodeName){case"HEAD":case"HTML":case"BODY":z0(d);break;default:d.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(n(163))}if(d=m.sibling,d!==null){d.return=m.return,wn=d;break}wn=m.return}}function Cv(d,m,_){var O=_.flags;switch(_.tag){case 0:case 11:case 15:Ei(d,_),O&4&&Mc(5,_);break;case 1:if(Ei(d,_),O&4)if(d=_.stateNode,m===null)try{d.componentDidMount()}catch(oe){Or(_,_.return,oe)}else{var G=wo(_.type,m.memoizedProps);m=m.memoizedState;try{d.componentDidUpdate(G,m,d.__reactInternalSnapshotBeforeUpdate)}catch(oe){Or(_,_.return,oe)}}O&64&&_v(_),O&512&&Rc(_,_.return);break;case 3:if(Ei(d,_),O&64&&(d=_.updateQueue,d!==null)){if(m=null,_.child!==null)switch(_.child.tag){case 27:case 5:m=_.child.stateNode;break;case 1:m=_.child.stateNode}try{cg(d,m)}catch(oe){Or(_,_.return,oe)}}break;case 27:m===null&&O&4&&Tv(_);case 26:case 5:Ei(d,_),m===null&&O&4&&kv(_),O&512&&Rc(_,_.return);break;case 12:Ei(d,_);break;case 13:Ei(d,_),O&4&&jv(d,_),O&64&&(d=_.memoizedState,d!==null&&(d=d.dehydrated,d!==null&&(_=j6.bind(null,_),X6(d,_))));break;case 22:if(O=_.memoizedState!==null||Gs,!O){m=m!==null&&m.memoizedState!==null||Kr,G=Gs;var J=Kr;Gs=O,(Kr=m)&&!J?Ti(d,_,(_.subtreeFlags&8772)!==0):Ei(d,_),Gs=G,Kr=J}break;case 30:break;default:Ei(d,_)}}function Nv(d){var m=d.alternate;m!==null&&(d.alternate=null,Nv(m)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(m=d.stateNode,m!==null&&me(m)),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}var Pr=null,ra=!1;function Ys(d,m,_){for(_=_.child;_!==null;)Ov(d,m,_),_=_.sibling}function Ov(d,m,_){if(tt&&typeof tt.onCommitFiberUnmount=="function")try{tt.onCommitFiberUnmount(at,_)}catch{}switch(_.tag){case 26:Kr||gs(_,m),Ys(d,m,_),_.memoizedState?_.memoizedState.count--:_.stateNode&&(_=_.stateNode,_.parentNode.removeChild(_));break;case 27:Kr||gs(_,m);var O=Pr,G=ra;Di(_.type)&&(Pr=_.stateNode,ra=!1),Ys(d,m,_),Vc(_.stateNode),Pr=O,ra=G;break;case 5:Kr||gs(_,m);case 6:if(O=Pr,G=ra,Pr=null,Ys(d,m,_),Pr=O,ra=G,Pr!==null)if(ra)try{(Pr.nodeType===9?Pr.body:Pr.nodeName==="HTML"?Pr.ownerDocument.body:Pr).removeChild(_.stateNode)}catch(J){Or(_,m,J)}else try{Pr.removeChild(_.stateNode)}catch(J){Or(_,m,J)}break;case 18:Pr!==null&&(ra?(d=Pr,bb(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,_.stateNode),Zc(d)):bb(Pr,_.stateNode));break;case 4:O=Pr,G=ra,Pr=_.stateNode.containerInfo,ra=!0,Ys(d,m,_),Pr=O,ra=G;break;case 0:case 11:case 14:case 15:Kr||ki(2,_,m),Kr||ki(4,_,m),Ys(d,m,_);break;case 1:Kr||(gs(_,m),O=_.stateNode,typeof O.componentWillUnmount=="function"&&Sv(_,m,O)),Ys(d,m,_);break;case 21:Ys(d,m,_);break;case 22:Kr=(O=Kr)||_.memoizedState!==null,Ys(d,m,_),Kr=O;break;default:Ys(d,m,_)}}function jv(d,m){if(m.memoizedState===null&&(d=m.alternate,d!==null&&(d=d.memoizedState,d!==null&&(d=d.dehydrated,d!==null))))try{Zc(d)}catch(_){Or(m,m.return,_)}}function S6(d){switch(d.tag){case 13:case 19:var m=d.stateNode;return m===null&&(m=d.stateNode=new Av),m;case 22:return d=d.stateNode,m=d._retryCache,m===null&&(m=d._retryCache=new Av),m;default:throw Error(n(435,d.tag))}}function p0(d,m){var _=S6(d);m.forEach(function(O){var G=D6.bind(null,d,O);_.has(O)||(_.add(O),O.then(G,G))})}function ca(d,m){var _=m.deletions;if(_!==null)for(var O=0;O<_.length;O++){var G=_[O],J=d,oe=m,pe=oe;e:for(;pe!==null;){switch(pe.tag){case 27:if(Di(pe.type)){Pr=pe.stateNode,ra=!1;break e}break;case 5:Pr=pe.stateNode,ra=!1;break e;case 3:case 4:Pr=pe.stateNode.containerInfo,ra=!0;break e}pe=pe.return}if(Pr===null)throw Error(n(160));Ov(J,oe,G),Pr=null,ra=!1,J=G.alternate,J!==null&&(J.return=null),G.return=null}if(m.subtreeFlags&13878)for(m=m.child;m!==null;)Dv(m,d),m=m.sibling}var Xa=null;function Dv(d,m){var _=d.alternate,O=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:ca(m,d),ua(d),O&4&&(ki(3,d,d.return),Mc(3,d),ki(5,d,d.return));break;case 1:ca(m,d),ua(d),O&512&&(Kr||_===null||gs(_,_.return)),O&64&&Gs&&(d=d.updateQueue,d!==null&&(O=d.callbacks,O!==null&&(_=d.shared.hiddenCallbacks,d.shared.hiddenCallbacks=_===null?O:_.concat(O))));break;case 26:var G=Xa;if(ca(m,d),ua(d),O&512&&(Kr||_===null||gs(_,_.return)),O&4){var J=_!==null?_.memoizedState:null;if(O=d.memoizedState,_===null)if(O===null)if(d.stateNode===null){e:{O=d.type,_=d.memoizedProps,G=G.ownerDocument||G;t:switch(O){case"title":J=G.getElementsByTagName("title")[0],(!J||J[ue]||J[bt]||J.namespaceURI==="http://www.w3.org/2000/svg"||J.hasAttribute("itemprop"))&&(J=G.createElement(O),G.head.insertBefore(J,G.querySelector("head > title"))),An(J,O,_),J[bt]=d,Me(J),O=J;break e;case"link":var oe=Tb("link","href",G).get(O+(_.href||""));if(oe){for(var pe=0;pe<oe.length;pe++)if(J=oe[pe],J.getAttribute("href")===(_.href==null||_.href===""?null:_.href)&&J.getAttribute("rel")===(_.rel==null?null:_.rel)&&J.getAttribute("title")===(_.title==null?null:_.title)&&J.getAttribute("crossorigin")===(_.crossOrigin==null?null:_.crossOrigin)){oe.splice(pe,1);break t}}J=G.createElement(O),An(J,O,_),G.head.appendChild(J);break;case"meta":if(oe=Tb("meta","content",G).get(O+(_.content||""))){for(pe=0;pe<oe.length;pe++)if(J=oe[pe],J.getAttribute("content")===(_.content==null?null:""+_.content)&&J.getAttribute("name")===(_.name==null?null:_.name)&&J.getAttribute("property")===(_.property==null?null:_.property)&&J.getAttribute("http-equiv")===(_.httpEquiv==null?null:_.httpEquiv)&&J.getAttribute("charset")===(_.charSet==null?null:_.charSet)){oe.splice(pe,1);break t}}J=G.createElement(O),An(J,O,_),G.head.appendChild(J);break;default:throw Error(n(468,O))}J[bt]=d,Me(J),O=J}d.stateNode=O}else Ab(G,d.type,d.stateNode);else d.stateNode=Eb(G,O,d.memoizedProps);else J!==O?(J===null?_.stateNode!==null&&(_=_.stateNode,_.parentNode.removeChild(_)):J.count--,O===null?Ab(G,d.type,d.stateNode):Eb(G,O,d.memoizedProps)):O===null&&d.stateNode!==null&&u0(d,d.memoizedProps,_.memoizedProps)}break;case 27:ca(m,d),ua(d),O&512&&(Kr||_===null||gs(_,_.return)),_!==null&&O&4&&u0(d,d.memoizedProps,_.memoizedProps);break;case 5:if(ca(m,d),ua(d),O&512&&(Kr||_===null||gs(_,_.return)),d.flags&32){G=d.stateNode;try{rn(G,"")}catch(Qe){Or(d,d.return,Qe)}}O&4&&d.stateNode!=null&&(G=d.memoizedProps,u0(d,G,_!==null?_.memoizedProps:G)),O&1024&&(h0=!0);break;case 6:if(ca(m,d),ua(d),O&4){if(d.stateNode===null)throw Error(n(162));O=d.memoizedProps,_=d.stateNode;try{_.nodeValue=O}catch(Qe){Or(d,d.return,Qe)}}break;case 3:if(Yd=null,G=Xa,Xa=Wd(m.containerInfo),ca(m,d),Xa=G,ua(d),O&4&&_!==null&&_.memoizedState.isDehydrated)try{Zc(m.containerInfo)}catch(Qe){Or(d,d.return,Qe)}h0&&(h0=!1,Mv(d));break;case 4:O=Xa,Xa=Wd(d.stateNode.containerInfo),ca(m,d),ua(d),Xa=O;break;case 12:ca(m,d),ua(d);break;case 13:ca(m,d),ua(d),d.child.flags&8192&&d.memoizedState!==null!=(_!==null&&_.memoizedState!==null)&&(y0=ne()),O&4&&(O=d.updateQueue,O!==null&&(d.updateQueue=null,p0(d,O)));break;case 22:G=d.memoizedState!==null;var je=_!==null&&_.memoizedState!==null,Xe=Gs,ft=Kr;if(Gs=Xe||G,Kr=ft||je,ca(m,d),Kr=ft,Gs=Xe,ua(d),O&8192)e:for(m=d.stateNode,m._visibility=G?m._visibility&-2:m._visibility|1,G&&(_===null||je||Gs||Kr||_o(d)),_=null,m=d;;){if(m.tag===5||m.tag===26){if(_===null){je=_=m;try{if(J=je.stateNode,G)oe=J.style,typeof oe.setProperty=="function"?oe.setProperty("display","none","important"):oe.display="none";else{pe=je.stateNode;var yt=je.memoizedProps.style,Ze=yt!=null&&yt.hasOwnProperty("display")?yt.display:null;pe.style.display=Ze==null||typeof Ze=="boolean"?"":(""+Ze).trim()}}catch(Qe){Or(je,je.return,Qe)}}}else if(m.tag===6){if(_===null){je=m;try{je.stateNode.nodeValue=G?"":je.memoizedProps}catch(Qe){Or(je,je.return,Qe)}}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===d)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===d)break e;for(;m.sibling===null;){if(m.return===null||m.return===d)break e;_===m&&(_=null),m=m.return}_===m&&(_=null),m.sibling.return=m.return,m=m.sibling}O&4&&(O=d.updateQueue,O!==null&&(_=O.retryQueue,_!==null&&(O.retryQueue=null,p0(d,_))));break;case 19:ca(m,d),ua(d),O&4&&(O=d.updateQueue,O!==null&&(d.updateQueue=null,p0(d,O)));break;case 30:break;case 21:break;default:ca(m,d),ua(d)}}function ua(d){var m=d.flags;if(m&2){try{for(var _,O=d.return;O!==null;){if(Ev(O)){_=O;break}O=O.return}if(_==null)throw Error(n(160));switch(_.tag){case 27:var G=_.stateNode,J=d0(d);Md(d,J,G);break;case 5:var oe=_.stateNode;_.flags&32&&(rn(oe,""),_.flags&=-33);var pe=d0(d);Md(d,pe,oe);break;case 3:case 4:var je=_.stateNode.containerInfo,Xe=d0(d);f0(d,Xe,je);break;default:throw Error(n(161))}}catch(ft){Or(d,d.return,ft)}d.flags&=-3}m&4096&&(d.flags&=-4097)}function Mv(d){if(d.subtreeFlags&1024)for(d=d.child;d!==null;){var m=d;Mv(m),m.tag===5&&m.flags&1024&&m.stateNode.reset(),d=d.sibling}}function Ei(d,m){if(m.subtreeFlags&8772)for(m=m.child;m!==null;)Cv(d,m.alternate,m),m=m.sibling}function _o(d){for(d=d.child;d!==null;){var m=d;switch(m.tag){case 0:case 11:case 14:case 15:ki(4,m,m.return),_o(m);break;case 1:gs(m,m.return);var _=m.stateNode;typeof _.componentWillUnmount=="function"&&Sv(m,m.return,_),_o(m);break;case 27:Vc(m.stateNode);case 26:case 5:gs(m,m.return),_o(m);break;case 22:m.memoizedState===null&&_o(m);break;case 30:_o(m);break;default:_o(m)}d=d.sibling}}function Ti(d,m,_){for(_=_&&(m.subtreeFlags&8772)!==0,m=m.child;m!==null;){var O=m.alternate,G=d,J=m,oe=J.flags;switch(J.tag){case 0:case 11:case 15:Ti(G,J,_),Mc(4,J);break;case 1:if(Ti(G,J,_),O=J,G=O.stateNode,typeof G.componentDidMount=="function")try{G.componentDidMount()}catch(Xe){Or(O,O.return,Xe)}if(O=J,G=O.updateQueue,G!==null){var pe=O.stateNode;try{var je=G.shared.hiddenCallbacks;if(je!==null)for(G.shared.hiddenCallbacks=null,G=0;G<je.length;G++)lg(je[G],pe)}catch(Xe){Or(O,O.return,Xe)}}_&&oe&64&&_v(J),Rc(J,J.return);break;case 27:Tv(J);case 26:case 5:Ti(G,J,_),_&&O===null&&oe&4&&kv(J),Rc(J,J.return);break;case 12:Ti(G,J,_);break;case 13:Ti(G,J,_),_&&oe&4&&jv(G,J);break;case 22:J.memoizedState===null&&Ti(G,J,_),Rc(J,J.return);break;case 30:break;default:Ti(G,J,_)}m=m.sibling}}function m0(d,m){var _=null;d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(_=d.memoizedState.cachePool.pool),d=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(d=m.memoizedState.cachePool.pool),d!==_&&(d!=null&&d.refCount++,_!=null&&xc(_))}function g0(d,m){d=null,m.alternate!==null&&(d=m.alternate.memoizedState.cache),m=m.memoizedState.cache,m!==d&&(m.refCount++,d!=null&&xc(d))}function vs(d,m,_,O){if(m.subtreeFlags&10256)for(m=m.child;m!==null;)Rv(d,m,_,O),m=m.sibling}function Rv(d,m,_,O){var G=m.flags;switch(m.tag){case 0:case 11:case 15:vs(d,m,_,O),G&2048&&Mc(9,m);break;case 1:vs(d,m,_,O);break;case 3:vs(d,m,_,O),G&2048&&(d=null,m.alternate!==null&&(d=m.alternate.memoizedState.cache),m=m.memoizedState.cache,m!==d&&(m.refCount++,d!=null&&xc(d)));break;case 12:if(G&2048){vs(d,m,_,O),d=m.stateNode;try{var J=m.memoizedProps,oe=J.id,pe=J.onPostCommit;typeof pe=="function"&&pe(oe,m.alternate===null?"mount":"update",d.passiveEffectDuration,-0)}catch(je){Or(m,m.return,je)}}else vs(d,m,_,O);break;case 13:vs(d,m,_,O);break;case 23:break;case 22:J=m.stateNode,oe=m.alternate,m.memoizedState!==null?J._visibility&2?vs(d,m,_,O):Fc(d,m):J._visibility&2?vs(d,m,_,O):(J._visibility|=2,ul(d,m,_,O,(m.subtreeFlags&10256)!==0)),G&2048&&m0(oe,m);break;case 24:vs(d,m,_,O),G&2048&&g0(m.alternate,m);break;default:vs(d,m,_,O)}}function ul(d,m,_,O,G){for(G=G&&(m.subtreeFlags&10256)!==0,m=m.child;m!==null;){var J=d,oe=m,pe=_,je=O,Xe=oe.flags;switch(oe.tag){case 0:case 11:case 15:ul(J,oe,pe,je,G),Mc(8,oe);break;case 23:break;case 22:var ft=oe.stateNode;oe.memoizedState!==null?ft._visibility&2?ul(J,oe,pe,je,G):Fc(J,oe):(ft._visibility|=2,ul(J,oe,pe,je,G)),G&&Xe&2048&&m0(oe.alternate,oe);break;case 24:ul(J,oe,pe,je,G),G&&Xe&2048&&g0(oe.alternate,oe);break;default:ul(J,oe,pe,je,G)}m=m.sibling}}function Fc(d,m){if(m.subtreeFlags&10256)for(m=m.child;m!==null;){var _=d,O=m,G=O.flags;switch(O.tag){case 22:Fc(_,O),G&2048&&m0(O.alternate,O);break;case 24:Fc(_,O),G&2048&&g0(O.alternate,O);break;default:Fc(_,O)}m=m.sibling}}var Ic=8192;function dl(d){if(d.subtreeFlags&Ic)for(d=d.child;d!==null;)Fv(d),d=d.sibling}function Fv(d){switch(d.tag){case 26:dl(d),d.flags&Ic&&d.memoizedState!==null&&l5(Xa,d.memoizedState,d.memoizedProps);break;case 5:dl(d);break;case 3:case 4:var m=Xa;Xa=Wd(d.stateNode.containerInfo),dl(d),Xa=m;break;case 22:d.memoizedState===null&&(m=d.alternate,m!==null&&m.memoizedState!==null?(m=Ic,Ic=16777216,dl(d),Ic=m):dl(d));break;default:dl(d)}}function Iv(d){var m=d.alternate;if(m!==null&&(d=m.child,d!==null)){m.child=null;do m=d.sibling,d.sibling=null,d=m;while(d!==null)}}function Pc(d){var m=d.deletions;if((d.flags&16)!==0){if(m!==null)for(var _=0;_<m.length;_++){var O=m[_];wn=O,Lv(O,d)}Iv(d)}if(d.subtreeFlags&10256)for(d=d.child;d!==null;)Pv(d),d=d.sibling}function Pv(d){switch(d.tag){case 0:case 11:case 15:Pc(d),d.flags&2048&&ki(9,d,d.return);break;case 3:Pc(d);break;case 12:Pc(d);break;case 22:var m=d.stateNode;d.memoizedState!==null&&m._visibility&2&&(d.return===null||d.return.tag!==13)?(m._visibility&=-3,Rd(d)):Pc(d);break;default:Pc(d)}}function Rd(d){var m=d.deletions;if((d.flags&16)!==0){if(m!==null)for(var _=0;_<m.length;_++){var O=m[_];wn=O,Lv(O,d)}Iv(d)}for(d=d.child;d!==null;){switch(m=d,m.tag){case 0:case 11:case 15:ki(8,m,m.return),Rd(m);break;case 22:_=m.stateNode,_._visibility&2&&(_._visibility&=-3,Rd(m));break;default:Rd(m)}d=d.sibling}}function Lv(d,m){for(;wn!==null;){var _=wn;switch(_.tag){case 0:case 11:case 15:ki(8,_,m);break;case 23:case 22:if(_.memoizedState!==null&&_.memoizedState.cachePool!==null){var O=_.memoizedState.cachePool.pool;O!=null&&O.refCount++}break;case 24:xc(_.memoizedState.cache)}if(O=_.child,O!==null)O.return=_,wn=O;else e:for(_=d;wn!==null;){O=wn;var G=O.sibling,J=O.return;if(Nv(O),O===_){wn=null;break e}if(G!==null){G.return=J,wn=G;break e}wn=J}}}var k6={getCacheForType:function(d){var m=Fn(pn),_=m.data.get(d);return _===void 0&&(_=d(),m.data.set(d,_)),_}},E6=typeof WeakMap=="function"?WeakMap:Map,_r=0,Mr=null,lr=null,fr=0,Sr=0,da=null,Ai=!1,fl=!1,v0=!1,Xs=0,qr=0,Ci=0,So=0,b0=0,Oa=0,hl=0,Lc=null,na=null,x0=!1,y0=0,Fd=1/0,Id=null,Ni=null,Tn=0,Oi=null,pl=null,ml=0,w0=0,_0=null,Bv=null,Bc=0,S0=null;function fa(){if((_r&2)!==0&&fr!==0)return fr&-fr;if(w.T!==null){var d=rl;return d!==0?d:O0()}return $t()}function Uv(){Oa===0&&(Oa=(fr&536870912)===0||xr?$e():536870912);var d=Na.current;return d!==null&&(d.flags|=32),Oa}function ha(d,m,_){(d===Mr&&(Sr===2||Sr===9)||d.cancelPendingCommit!==null)&&(gl(d,0),ji(d,fr,Oa,!1)),et(d,_),((_r&2)===0||d!==Mr)&&(d===Mr&&((_r&2)===0&&(So|=_),qr===4&&ji(d,fr,Oa,!1)),bs(d))}function zv(d,m,_){if((_r&6)!==0)throw Error(n(327));var O=!_&&(m&124)===0&&(m&d.expiredLanes)===0||vt(d,m),G=O?C6(d,m):T0(d,m,!0),J=O;do{if(G===0){fl&&!O&&ji(d,m,0,!1);break}else{if(_=d.current.alternate,J&&!T6(_)){G=T0(d,m,!1),J=!1;continue}if(G===2){if(J=m,d.errorRecoveryDisabledLanes&J)var oe=0;else oe=d.pendingLanes&-536870913,oe=oe!==0?oe:oe&536870912?536870912:0;if(oe!==0){m=oe;e:{var pe=d;G=Lc;var je=pe.current.memoizedState.isDehydrated;if(je&&(gl(pe,oe).flags|=256),oe=T0(pe,oe,!1),oe!==2){if(v0&&!je){pe.errorRecoveryDisabledLanes|=J,So|=J,G=4;break e}J=na,na=G,J!==null&&(na===null?na=J:na.push.apply(na,J))}G=oe}if(J=!1,G!==2)continue}}if(G===1){gl(d,0),ji(d,m,0,!0);break}e:{switch(O=d,J=G,J){case 0:case 1:throw Error(n(345));case 4:if((m&4194048)!==m)break;case 6:ji(O,m,Oa,!Ai);break e;case 2:na=null;break;case 3:case 5:break;default:throw Error(n(329))}if((m&62914560)===m&&(G=y0+300-ne(),10<G)){if(ji(O,m,Oa,!Ai),_t(O,0,!0)!==0)break e;O.timeoutHandle=gb($v.bind(null,O,_,na,Id,x0,m,Oa,So,hl,Ai,J,2,-0,0),G);break e}$v(O,_,na,Id,x0,m,Oa,So,hl,Ai,J,0,-0,0)}}break}while(!0);bs(d)}function $v(d,m,_,O,G,J,oe,pe,je,Xe,ft,yt,Ze,Qe){if(d.timeoutHandle=-1,yt=m.subtreeFlags,(yt&8192||(yt&16785408)===16785408)&&(Wc={stylesheets:null,count:0,unsuspend:o5},Fv(m),yt=c5(),yt!==null)){d.cancelPendingCommit=yt(Xv.bind(null,d,m,J,_,O,G,oe,pe,je,ft,1,Ze,Qe)),ji(d,J,oe,!Xe);return}Xv(d,m,J,_,O,G,oe,pe,je)}function T6(d){for(var m=d;;){var _=m.tag;if((_===0||_===11||_===15)&&m.flags&16384&&(_=m.updateQueue,_!==null&&(_=_.stores,_!==null)))for(var O=0;O<_.length;O++){var G=_[O],J=G.getSnapshot;G=G.value;try{if(!oa(J(),G))return!1}catch{return!1}}if(_=m.child,m.subtreeFlags&16384&&_!==null)_.return=m,m=_;else{if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function ji(d,m,_,O){m&=~b0,m&=~So,d.suspendedLanes|=m,d.pingedLanes&=~m,O&&(d.warmLanes|=m),O=d.expirationTimes;for(var G=m;0<G;){var J=31-rt(G),oe=1<<J;O[J]=-1,G&=~oe}_!==0&&we(d,_,m)}function Pd(){return(_r&6)===0?(Uc(0),!1):!0}function k0(){if(lr!==null){if(Sr===0)var d=lr.return;else d=lr,zs=vo=null,zh(d),ll=null,Oc=0,d=lr;for(;d!==null;)wv(d.alternate,d),d=d.return;lr=null}}function gl(d,m){var _=d.timeoutHandle;_!==-1&&(d.timeoutHandle=-1,H6(_)),_=d.cancelPendingCommit,_!==null&&(d.cancelPendingCommit=null,_()),k0(),Mr=d,lr=_=Ls(d.current,null),fr=m,Sr=0,da=null,Ai=!1,fl=vt(d,m),v0=!1,hl=Oa=b0=So=Ci=qr=0,na=Lc=null,x0=!1,(m&8)!==0&&(m|=m&32);var O=d.entangledLanes;if(O!==0)for(d=d.entanglements,O&=m;0<O;){var G=31-rt(O),J=1<<G;m|=d[G],O&=~J}return Xs=m,sd(),_}function Vv(d,m){ar=null,w.H=kd,m===wc||m===pd?(m=ig(),Sr=3):m===ng?(m=ig(),Sr=4):Sr=m===ov?8:m!==null&&typeof m=="object"&&typeof m.then=="function"?6:1,da=m,lr===null&&(qr=1,Nd(d,Ea(m,d.current)))}function Hv(){var d=w.H;return w.H=kd,d===null?kd:d}function qv(){var d=w.A;return w.A=k6,d}function E0(){qr=4,Ai||(fr&4194048)!==fr&&Na.current!==null||(fl=!0),(Ci&134217727)===0&&(So&134217727)===0||Mr===null||ji(Mr,fr,Oa,!1)}function T0(d,m,_){var O=_r;_r|=2;var G=Hv(),J=qv();(Mr!==d||fr!==m)&&(Id=null,gl(d,m)),m=!1;var oe=qr;e:do try{if(Sr!==0&&lr!==null){var pe=lr,je=da;switch(Sr){case 8:k0(),oe=6;break e;case 3:case 2:case 9:case 6:Na.current===null&&(m=!0);var Xe=Sr;if(Sr=0,da=null,vl(d,pe,je,Xe),_&&fl){oe=0;break e}break;default:Xe=Sr,Sr=0,da=null,vl(d,pe,je,Xe)}}A6(),oe=qr;break}catch(ft){Vv(d,ft)}while(!0);return m&&d.shellSuspendCounter++,zs=vo=null,_r=O,w.H=G,w.A=J,lr===null&&(Mr=null,fr=0,sd()),oe}function A6(){for(;lr!==null;)Wv(lr)}function C6(d,m){var _=_r;_r|=2;var O=Hv(),G=qv();Mr!==d||fr!==m?(Id=null,Fd=ne()+500,gl(d,m)):fl=vt(d,m);e:do try{if(Sr!==0&&lr!==null){m=lr;var J=da;t:switch(Sr){case 1:Sr=0,da=null,vl(d,m,J,1);break;case 2:case 9:if(ag(J)){Sr=0,da=null,Gv(m);break}m=function(){Sr!==2&&Sr!==9||Mr!==d||(Sr=7),bs(d)},J.then(m,m);break e;case 3:Sr=7;break e;case 4:Sr=5;break e;case 7:ag(J)?(Sr=0,da=null,Gv(m)):(Sr=0,da=null,vl(d,m,J,7));break;case 5:var oe=null;switch(lr.tag){case 26:oe=lr.memoizedState;case 5:case 27:var pe=lr;if(!oe||Cb(oe)){Sr=0,da=null;var je=pe.sibling;if(je!==null)lr=je;else{var Xe=pe.return;Xe!==null?(lr=Xe,Ld(Xe)):lr=null}break t}}Sr=0,da=null,vl(d,m,J,5);break;case 6:Sr=0,da=null,vl(d,m,J,6);break;case 8:k0(),qr=6;break e;default:throw Error(n(462))}}N6();break}catch(ft){Vv(d,ft)}while(!0);return zs=vo=null,w.H=O,w.A=G,_r=_,lr!==null?0:(Mr=null,fr=0,sd(),qr)}function N6(){for(;lr!==null&&!he();)Wv(lr)}function Wv(d){var m=xv(d.alternate,d,Xs);d.memoizedProps=d.pendingProps,m===null?Ld(d):lr=m}function Gv(d){var m=d,_=m.alternate;switch(m.tag){case 15:case 0:m=hv(_,m,m.pendingProps,m.type,void 0,fr);break;case 11:m=hv(_,m,m.pendingProps,m.type.render,m.ref,fr);break;case 5:zh(m);default:wv(_,m),m=lr=Y1(m,Xs),m=xv(_,m,Xs)}d.memoizedProps=d.pendingProps,m===null?Ld(d):lr=m}function vl(d,m,_,O){zs=vo=null,zh(m),ll=null,Oc=0;var G=m.return;try{if(b6(d,G,m,_,fr)){qr=1,Nd(d,Ea(_,d.current)),lr=null;return}}catch(J){if(G!==null)throw lr=G,J;qr=1,Nd(d,Ea(_,d.current)),lr=null;return}m.flags&32768?(xr||O===1?d=!0:fl||(fr&536870912)!==0?d=!1:(Ai=d=!0,(O===2||O===9||O===3||O===6)&&(O=Na.current,O!==null&&O.tag===13&&(O.flags|=16384))),Yv(m,d)):Ld(m)}function Ld(d){var m=d;do{if((m.flags&32768)!==0){Yv(m,Ai);return}d=m.return;var _=y6(m.alternate,m,Xs);if(_!==null){lr=_;return}if(m=m.sibling,m!==null){lr=m;return}lr=m=d}while(m!==null);qr===0&&(qr=5)}function Yv(d,m){do{var _=w6(d.alternate,d);if(_!==null){_.flags&=32767,lr=_;return}if(_=d.return,_!==null&&(_.flags|=32768,_.subtreeFlags=0,_.deletions=null),!m&&(d=d.sibling,d!==null)){lr=d;return}lr=d=_}while(d!==null);qr=6,lr=null}function Xv(d,m,_,O,G,J,oe,pe,je){d.cancelPendingCommit=null;do Bd();while(Tn!==0);if((_r&6)!==0)throw Error(n(327));if(m!==null){if(m===d.current)throw Error(n(177));if(J=m.lanes|m.childLanes,J|=gh,dt(d,_,J,oe,pe,je),d===Mr&&(lr=Mr=null,fr=0),pl=m,Oi=d,ml=_,w0=J,_0=G,Bv=O,(m.subtreeFlags&10256)!==0||(m.flags&10256)!==0?(d.callbackNode=null,d.callbackPriority=0,M6(_e,function(){return eb(),null})):(d.callbackNode=null,d.callbackPriority=0),O=(m.flags&13878)!==0,(m.subtreeFlags&13878)!==0||O){O=w.T,w.T=null,G=T.p,T.p=2,oe=_r,_r|=4;try{_6(d,m,_)}finally{_r=oe,T.p=G,w.T=O}}Tn=1,Kv(),Zv(),Jv()}}function Kv(){if(Tn===1){Tn=0;var d=Oi,m=pl,_=(m.flags&13878)!==0;if((m.subtreeFlags&13878)!==0||_){_=w.T,w.T=null;var O=T.p;T.p=2;var G=_r;_r|=4;try{Dv(m,d);var J=L0,oe=L1(d.containerInfo),pe=J.focusedElem,je=J.selectionRange;if(oe!==pe&&pe&&pe.ownerDocument&&P1(pe.ownerDocument.documentElement,pe)){if(je!==null&&dh(pe)){var Xe=je.start,ft=je.end;if(ft===void 0&&(ft=Xe),"selectionStart"in pe)pe.selectionStart=Xe,pe.selectionEnd=Math.min(ft,pe.value.length);else{var yt=pe.ownerDocument||document,Ze=yt&&yt.defaultView||window;if(Ze.getSelection){var Qe=Ze.getSelection(),Yt=pe.textContent.length,Vt=Math.min(je.start,Yt),Cr=je.end===void 0?Vt:Math.min(je.end,Yt);!Qe.extend&&Vt>Cr&&(oe=Cr,Cr=Vt,Vt=oe);var He=I1(pe,Vt),Ie=I1(pe,Cr);if(He&&Ie&&(Qe.rangeCount!==1||Qe.anchorNode!==He.node||Qe.anchorOffset!==He.offset||Qe.focusNode!==Ie.node||Qe.focusOffset!==Ie.offset)){var Ge=yt.createRange();Ge.setStart(He.node,He.offset),Qe.removeAllRanges(),Vt>Cr?(Qe.addRange(Ge),Qe.extend(Ie.node,Ie.offset)):(Ge.setEnd(Ie.node,Ie.offset),Qe.addRange(Ge))}}}}for(yt=[],Qe=pe;Qe=Qe.parentNode;)Qe.nodeType===1&&yt.push({element:Qe,left:Qe.scrollLeft,top:Qe.scrollTop});for(typeof pe.focus=="function"&&pe.focus(),pe=0;pe<yt.length;pe++){var mt=yt[pe];mt.element.scrollLeft=mt.left,mt.element.scrollTop=mt.top}}Zd=!!P0,L0=P0=null}finally{_r=G,T.p=O,w.T=_}}d.current=m,Tn=2}}function Zv(){if(Tn===2){Tn=0;var d=Oi,m=pl,_=(m.flags&8772)!==0;if((m.subtreeFlags&8772)!==0||_){_=w.T,w.T=null;var O=T.p;T.p=2;var G=_r;_r|=4;try{Cv(d,m.alternate,m)}finally{_r=G,T.p=O,w.T=_}}Tn=3}}function Jv(){if(Tn===4||Tn===3){Tn=0,le();var d=Oi,m=pl,_=ml,O=Bv;(m.subtreeFlags&10256)!==0||(m.flags&10256)!==0?Tn=5:(Tn=0,pl=Oi=null,Qv(d,d.pendingLanes));var G=d.pendingLanes;if(G===0&&(Ni=null),Ct(_),m=m.stateNode,tt&&typeof tt.onCommitFiberRoot=="function")try{tt.onCommitFiberRoot(at,m,void 0,(m.current.flags&128)===128)}catch{}if(O!==null){m=w.T,G=T.p,T.p=2,w.T=null;try{for(var J=d.onRecoverableError,oe=0;oe<O.length;oe++){var pe=O[oe];J(pe.value,{componentStack:pe.stack})}}finally{w.T=m,T.p=G}}(ml&3)!==0&&Bd(),bs(d),G=d.pendingLanes,(_&4194090)!==0&&(G&42)!==0?d===S0?Bc++:(Bc=0,S0=d):Bc=0,Uc(0)}}function Qv(d,m){(d.pooledCacheLanes&=m)===0&&(m=d.pooledCache,m!=null&&(d.pooledCache=null,xc(m)))}function Bd(d){return Kv(),Zv(),Jv(),eb()}function eb(){if(Tn!==5)return!1;var d=Oi,m=w0;w0=0;var _=Ct(ml),O=w.T,G=T.p;try{T.p=32>_?32:_,w.T=null,_=_0,_0=null;var J=Oi,oe=ml;if(Tn=0,pl=Oi=null,ml=0,(_r&6)!==0)throw Error(n(331));var pe=_r;if(_r|=4,Pv(J.current),Rv(J,J.current,oe,_),_r=pe,Uc(0,!1),tt&&typeof tt.onPostCommitFiberRoot=="function")try{tt.onPostCommitFiberRoot(at,J)}catch{}return!0}finally{T.p=G,w.T=O,Qv(d,m)}}function tb(d,m,_){m=Ea(_,m),m=t0(d.stateNode,m,2),d=yi(d,m,2),d!==null&&(et(d,2),bs(d))}function Or(d,m,_){if(d.tag===3)tb(d,d,_);else for(;m!==null;){if(m.tag===3){tb(m,d,_);break}else if(m.tag===1){var O=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof O.componentDidCatch=="function"&&(Ni===null||!Ni.has(O))){d=Ea(_,d),_=sv(2),O=yi(m,_,2),O!==null&&(iv(_,O,m,d),et(O,2),bs(O));break}}m=m.return}}function A0(d,m,_){var O=d.pingCache;if(O===null){O=d.pingCache=new E6;var G=new Set;O.set(m,G)}else G=O.get(m),G===void 0&&(G=new Set,O.set(m,G));G.has(_)||(v0=!0,G.add(_),d=O6.bind(null,d,m,_),m.then(d,d))}function O6(d,m,_){var O=d.pingCache;O!==null&&O.delete(m),d.pingedLanes|=d.suspendedLanes&_,d.warmLanes&=~_,Mr===d&&(fr&_)===_&&(qr===4||qr===3&&(fr&62914560)===fr&&300>ne()-y0?(_r&2)===0&&gl(d,0):b0|=_,hl===fr&&(hl=0)),bs(d)}function rb(d,m){m===0&&(m=Be()),d=Jo(d,m),d!==null&&(et(d,m),bs(d))}function j6(d){var m=d.memoizedState,_=0;m!==null&&(_=m.retryLane),rb(d,_)}function D6(d,m){var _=0;switch(d.tag){case 13:var O=d.stateNode,G=d.memoizedState;G!==null&&(_=G.retryLane);break;case 19:O=d.stateNode;break;case 22:O=d.stateNode._retryCache;break;default:throw Error(n(314))}O!==null&&O.delete(m),rb(d,_)}function M6(d,m){return ae(d,m)}var Ud=null,bl=null,C0=!1,zd=!1,N0=!1,ko=0;function bs(d){d!==bl&&d.next===null&&(bl===null?Ud=bl=d:bl=bl.next=d),zd=!0,C0||(C0=!0,F6())}function Uc(d,m){if(!N0&&zd){N0=!0;do for(var _=!1,O=Ud;O!==null;){if(d!==0){var G=O.pendingLanes;if(G===0)var J=0;else{var oe=O.suspendedLanes,pe=O.pingedLanes;J=(1<<31-rt(42|d)+1)-1,J&=G&~(oe&~pe),J=J&201326741?J&201326741|1:J?J|2:0}J!==0&&(_=!0,ib(O,J))}else J=fr,J=_t(O,O===Mr?J:0,O.cancelPendingCommit!==null||O.timeoutHandle!==-1),(J&3)===0||vt(O,J)||(_=!0,ib(O,J));O=O.next}while(_);N0=!1}}function R6(){nb()}function nb(){zd=C0=!1;var d=0;ko!==0&&(V6()&&(d=ko),ko=0);for(var m=ne(),_=null,O=Ud;O!==null;){var G=O.next,J=ab(O,m);J===0?(O.next=null,_===null?Ud=G:_.next=G,G===null&&(bl=_)):(_=O,(d!==0||(J&3)!==0)&&(zd=!0)),O=G}Uc(d)}function ab(d,m){for(var _=d.suspendedLanes,O=d.pingedLanes,G=d.expirationTimes,J=d.pendingLanes&-62914561;0<J;){var oe=31-rt(J),pe=1<<oe,je=G[oe];je===-1?((pe&_)===0||(pe&O)!==0)&&(G[oe]=ht(pe,m)):je<=m&&(d.expiredLanes|=pe),J&=~pe}if(m=Mr,_=fr,_=_t(d,d===m?_:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),O=d.callbackNode,_===0||d===m&&(Sr===2||Sr===9)||d.cancelPendingCommit!==null)return O!==null&&O!==null&&te(O),d.callbackNode=null,d.callbackPriority=0;if((_&3)===0||vt(d,_)){if(m=_&-_,m===d.callbackPriority)return m;switch(O!==null&&te(O),Ct(_)){case 2:case 8:_=Se;break;case 32:_=_e;break;case 268435456:_=Re;break;default:_=_e}return O=sb.bind(null,d),_=ae(_,O),d.callbackPriority=m,d.callbackNode=_,m}return O!==null&&O!==null&&te(O),d.callbackPriority=2,d.callbackNode=null,2}function sb(d,m){if(Tn!==0&&Tn!==5)return d.callbackNode=null,d.callbackPriority=0,null;var _=d.callbackNode;if(Bd()&&d.callbackNode!==_)return null;var O=fr;return O=_t(d,d===Mr?O:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),O===0?null:(zv(d,O,m),ab(d,ne()),d.callbackNode!=null&&d.callbackNode===_?sb.bind(null,d):null)}function ib(d,m){if(Bd())return null;zv(d,m,!0)}function F6(){q6(function(){(_r&6)!==0?ae(fe,R6):nb()})}function O0(){return ko===0&&(ko=$e()),ko}function ob(d){return d==null||typeof d=="symbol"||typeof d=="boolean"?null:typeof d=="function"?d:so(""+d)}function lb(d,m){var _=m.ownerDocument.createElement("input");return _.name=m.name,_.value=m.value,d.id&&_.setAttribute("form",d.id),m.parentNode.insertBefore(_,m),d=new FormData(d),_.parentNode.removeChild(_),d}function I6(d,m,_,O,G){if(m==="submit"&&_&&_.stateNode===G){var J=ob((G[xt]||null).action),oe=O.submitter;oe&&(m=(m=oe[xt]||null)?ob(m.formAction):oe.getAttribute("formAction"),m!==null&&(J=m,oe=null));var pe=new rd("action","action",null,O,G);d.push({event:pe,listeners:[{instance:null,listener:function(){if(O.defaultPrevented){if(ko!==0){var je=oe?lb(G,oe):new FormData(G);Kh(_,{pending:!0,data:je,method:G.method,action:J},null,je)}}else typeof J=="function"&&(pe.preventDefault(),je=oe?lb(G,oe):new FormData(G),Kh(_,{pending:!0,data:je,method:G.method,action:J},J,je))},currentTarget:G}]})}}for(var j0=0;j0<mh.length;j0++){var D0=mh[j0],P6=D0.toLowerCase(),L6=D0[0].toUpperCase()+D0.slice(1);Ya(P6,"on"+L6)}Ya(z1,"onAnimationEnd"),Ya($1,"onAnimationIteration"),Ya(V1,"onAnimationStart"),Ya("dblclick","onDoubleClick"),Ya("focusin","onFocus"),Ya("focusout","onBlur"),Ya(t6,"onTransitionRun"),Ya(r6,"onTransitionStart"),Ya(n6,"onTransitionCancel"),Ya(H1,"onTransitionEnd"),Ee("onMouseEnter",["mouseout","mouseover"]),Ee("onMouseLeave",["mouseout","mouseover"]),Ee("onPointerEnter",["pointerout","pointerover"]),Ee("onPointerLeave",["pointerout","pointerover"]),xe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),xe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),xe("onBeforeInput",["compositionend","keypress","textInput","paste"]),xe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),xe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),xe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),B6=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(zc));function cb(d,m){m=(m&4)!==0;for(var _=0;_<d.length;_++){var O=d[_],G=O.event;O=O.listeners;e:{var J=void 0;if(m)for(var oe=O.length-1;0<=oe;oe--){var pe=O[oe],je=pe.instance,Xe=pe.currentTarget;if(pe=pe.listener,je!==J&&G.isPropagationStopped())break e;J=pe,G.currentTarget=Xe;try{J(G)}catch(ft){Cd(ft)}G.currentTarget=null,J=je}else for(oe=0;oe<O.length;oe++){if(pe=O[oe],je=pe.instance,Xe=pe.currentTarget,pe=pe.listener,je!==J&&G.isPropagationStopped())break e;J=pe,G.currentTarget=Xe;try{J(G)}catch(ft){Cd(ft)}G.currentTarget=null,J=je}}}}function cr(d,m){var _=m[Le];_===void 0&&(_=m[Le]=new Set);var O=d+"__bubble";_.has(O)||(ub(m,d,2,!1),_.add(O))}function M0(d,m,_){var O=0;m&&(O|=4),ub(_,d,O,m)}var $d="_reactListening"+Math.random().toString(36).slice(2);function R0(d){if(!d[$d]){d[$d]=!0,Ve.forEach(function(_){_!=="selectionchange"&&(B6.has(_)||M0(_,!1,d),M0(_,!0,d))});var m=d.nodeType===9?d:d.ownerDocument;m===null||m[$d]||(m[$d]=!0,M0("selectionchange",!1,m))}}function ub(d,m,_,O){switch(Rb(m)){case 2:var G=f5;break;case 8:G=h5;break;default:G=Y0}_=G.bind(null,m,_,d),G=void 0,!rh||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(G=!0),O?G!==void 0?d.addEventListener(m,_,{capture:!0,passive:G}):d.addEventListener(m,_,!0):G!==void 0?d.addEventListener(m,_,{passive:G}):d.addEventListener(m,_,!1)}function F0(d,m,_,O,G){var J=O;if((m&1)===0&&(m&2)===0&&O!==null)e:for(;;){if(O===null)return;var oe=O.tag;if(oe===3||oe===4){var pe=O.stateNode.containerInfo;if(pe===G)break;if(oe===4)for(oe=O.return;oe!==null;){var je=oe.tag;if((je===3||je===4)&&oe.stateNode.containerInfo===G)return;oe=oe.return}for(;pe!==null;){if(oe=ve(pe),oe===null)return;if(je=oe.tag,je===5||je===6||je===26||je===27){O=J=oe;continue e}pe=pe.parentNode}}O=O.return}oo(function(){var Xe=J,ft=io(_),yt=[];e:{var Ze=q1.get(d);if(Ze!==void 0){var Qe=rd,Yt=d;switch(d){case"keypress":if(ed(_)===0)break e;case"keydown":case"keyup":Qe=M3;break;case"focusin":Yt="focus",Qe=ih;break;case"focusout":Yt="blur",Qe=ih;break;case"beforeblur":case"afterblur":Qe=ih;break;case"click":if(_.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Qe=y1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Qe=w3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Qe=I3;break;case z1:case $1:case V1:Qe=k3;break;case H1:Qe=L3;break;case"scroll":case"scrollend":Qe=x3;break;case"wheel":Qe=U3;break;case"copy":case"cut":case"paste":Qe=T3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Qe=_1;break;case"toggle":case"beforetoggle":Qe=$3}var Vt=(m&4)!==0,Cr=!Vt&&(d==="scroll"||d==="scrollend"),He=Vt?Ze!==null?Ze+"Capture":null:Ze;Vt=[];for(var Ie=Xe,Ge;Ie!==null;){var mt=Ie;if(Ge=mt.stateNode,mt=mt.tag,mt!==5&&mt!==26&&mt!==27||Ge===null||He===null||(mt=ic(Ie,He),mt!=null&&Vt.push($c(Ie,mt,Ge))),Cr)break;Ie=Ie.return}0<Vt.length&&(Ze=new Qe(Ze,Yt,null,_,ft),yt.push({event:Ze,listeners:Vt}))}}if((m&7)===0){e:{if(Ze=d==="mouseover"||d==="pointerover",Qe=d==="mouseout"||d==="pointerout",Ze&&_!==pi&&(Yt=_.relatedTarget||_.fromElement)&&(ve(Yt)||Yt[Ae]))break e;if((Qe||Ze)&&(Ze=ft.window===ft?ft:(Ze=ft.ownerDocument)?Ze.defaultView||Ze.parentWindow:window,Qe?(Yt=_.relatedTarget||_.toElement,Qe=Xe,Yt=Yt?ve(Yt):null,Yt!==null&&(Cr=o(Yt),Vt=Yt.tag,Yt!==Cr||Vt!==5&&Vt!==27&&Vt!==6)&&(Yt=null)):(Qe=null,Yt=Xe),Qe!==Yt)){if(Vt=y1,mt="onMouseLeave",He="onMouseEnter",Ie="mouse",(d==="pointerout"||d==="pointerover")&&(Vt=_1,mt="onPointerLeave",He="onPointerEnter",Ie="pointer"),Cr=Qe==null?Ze:Fe(Qe),Ge=Yt==null?Ze:Fe(Yt),Ze=new Vt(mt,Ie+"leave",Qe,_,ft),Ze.target=Cr,Ze.relatedTarget=Ge,mt=null,ve(ft)===Xe&&(Vt=new Vt(He,Ie+"enter",Yt,_,ft),Vt.target=Ge,Vt.relatedTarget=Cr,mt=Vt),Cr=mt,Qe&&Yt)t:{for(Vt=Qe,He=Yt,Ie=0,Ge=Vt;Ge;Ge=xl(Ge))Ie++;for(Ge=0,mt=He;mt;mt=xl(mt))Ge++;for(;0<Ie-Ge;)Vt=xl(Vt),Ie--;for(;0<Ge-Ie;)He=xl(He),Ge--;for(;Ie--;){if(Vt===He||He!==null&&Vt===He.alternate)break t;Vt=xl(Vt),He=xl(He)}Vt=null}else Vt=null;Qe!==null&&db(yt,Ze,Qe,Vt,!1),Yt!==null&&Cr!==null&&db(yt,Cr,Yt,Vt,!0)}}e:{if(Ze=Xe?Fe(Xe):window,Qe=Ze.nodeName&&Ze.nodeName.toLowerCase(),Qe==="select"||Qe==="input"&&Ze.type==="file")var Ot=O1;else if(C1(Ze))if(j1)Ot=J3;else{Ot=K3;var or=X3}else Qe=Ze.nodeName,!Qe||Qe.toLowerCase()!=="input"||Ze.type!=="checkbox"&&Ze.type!=="radio"?Xe&&fi(Xe.elementType)&&(Ot=O1):Ot=Z3;if(Ot&&(Ot=Ot(d,Xe))){N1(yt,Ot,_,ft);break e}or&&or(d,Ze,Xe),d==="focusout"&&Xe&&Ze.type==="number"&&Xe.memoizedProps.value!=null&&ir(Ze,"number",Ze.value)}switch(or=Xe?Fe(Xe):window,d){case"focusin":(C1(or)||or.contentEditable==="true")&&(Xo=or,fh=Xe,pc=null);break;case"focusout":pc=fh=Xo=null;break;case"mousedown":hh=!0;break;case"contextmenu":case"mouseup":case"dragend":hh=!1,B1(yt,_,ft);break;case"selectionchange":if(e6)break;case"keydown":case"keyup":B1(yt,_,ft)}var Lt;if(lh)e:{switch(d){case"compositionstart":var Ht="onCompositionStart";break e;case"compositionend":Ht="onCompositionEnd";break e;case"compositionupdate":Ht="onCompositionUpdate";break e}Ht=void 0}else Yo?T1(d,_)&&(Ht="onCompositionEnd"):d==="keydown"&&_.keyCode===229&&(Ht="onCompositionStart");Ht&&(S1&&_.locale!=="ko"&&(Yo||Ht!=="onCompositionStart"?Ht==="onCompositionEnd"&&Yo&&(Lt=b1()):(gi=ft,nh="value"in gi?gi.value:gi.textContent,Yo=!0)),or=Vd(Xe,Ht),0<or.length&&(Ht=new w1(Ht,d,null,_,ft),yt.push({event:Ht,listeners:or}),Lt?Ht.data=Lt:(Lt=A1(_),Lt!==null&&(Ht.data=Lt)))),(Lt=H3?q3(d,_):W3(d,_))&&(Ht=Vd(Xe,"onBeforeInput"),0<Ht.length&&(or=new w1("onBeforeInput","beforeinput",null,_,ft),yt.push({event:or,listeners:Ht}),or.data=Lt)),I6(yt,d,Xe,_,ft)}cb(yt,m)})}function $c(d,m,_){return{instance:d,listener:m,currentTarget:_}}function Vd(d,m){for(var _=m+"Capture",O=[];d!==null;){var G=d,J=G.stateNode;if(G=G.tag,G!==5&&G!==26&&G!==27||J===null||(G=ic(d,_),G!=null&&O.unshift($c(d,G,J)),G=ic(d,m),G!=null&&O.push($c(d,G,J))),d.tag===3)return O;d=d.return}return[]}function xl(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5&&d.tag!==27);return d||null}function db(d,m,_,O,G){for(var J=m._reactName,oe=[];_!==null&&_!==O;){var pe=_,je=pe.alternate,Xe=pe.stateNode;if(pe=pe.tag,je!==null&&je===O)break;pe!==5&&pe!==26&&pe!==27||Xe===null||(je=Xe,G?(Xe=ic(_,J),Xe!=null&&oe.unshift($c(_,Xe,je))):G||(Xe=ic(_,J),Xe!=null&&oe.push($c(_,Xe,je)))),_=_.return}oe.length!==0&&d.push({event:m,listeners:oe})}var U6=/\r\n?/g,z6=/\u0000|\uFFFD/g;function fb(d){return(typeof d=="string"?d:""+d).replace(U6,`
`).replace(z6,"")}function hb(d,m){return m=fb(m),fb(d)===m}function Hd(){}function Ar(d,m,_,O,G,J){switch(_){case"children":typeof O=="string"?m==="body"||m==="textarea"&&O===""||rn(d,O):(typeof O=="number"||typeof O=="bigint")&&m!=="body"&&rn(d,""+O);break;case"className":Et(d,"class",O);break;case"tabIndex":Et(d,"tabindex",O);break;case"dir":case"role":case"viewBox":case"width":case"height":Et(d,_,O);break;case"style":di(d,O,J);break;case"data":if(m!=="object"){Et(d,"data",O);break}case"src":case"href":if(O===""&&(m!=="a"||_!=="href")){d.removeAttribute(_);break}if(O==null||typeof O=="function"||typeof O=="symbol"||typeof O=="boolean"){d.removeAttribute(_);break}O=so(""+O),d.setAttribute(_,O);break;case"action":case"formAction":if(typeof O=="function"){d.setAttribute(_,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof J=="function"&&(_==="formAction"?(m!=="input"&&Ar(d,m,"name",G.name,G,null),Ar(d,m,"formEncType",G.formEncType,G,null),Ar(d,m,"formMethod",G.formMethod,G,null),Ar(d,m,"formTarget",G.formTarget,G,null)):(Ar(d,m,"encType",G.encType,G,null),Ar(d,m,"method",G.method,G,null),Ar(d,m,"target",G.target,G,null)));if(O==null||typeof O=="symbol"||typeof O=="boolean"){d.removeAttribute(_);break}O=so(""+O),d.setAttribute(_,O);break;case"onClick":O!=null&&(d.onclick=Hd);break;case"onScroll":O!=null&&cr("scroll",d);break;case"onScrollEnd":O!=null&&cr("scrollend",d);break;case"dangerouslySetInnerHTML":if(O!=null){if(typeof O!="object"||!("__html"in O))throw Error(n(61));if(_=O.__html,_!=null){if(G.children!=null)throw Error(n(60));d.innerHTML=_}}break;case"multiple":d.multiple=O&&typeof O!="function"&&typeof O!="symbol";break;case"muted":d.muted=O&&typeof O!="function"&&typeof O!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(O==null||typeof O=="function"||typeof O=="boolean"||typeof O=="symbol"){d.removeAttribute("xlink:href");break}_=so(""+O),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",_);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":O!=null&&typeof O!="function"&&typeof O!="symbol"?d.setAttribute(_,""+O):d.removeAttribute(_);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":O&&typeof O!="function"&&typeof O!="symbol"?d.setAttribute(_,""):d.removeAttribute(_);break;case"capture":case"download":O===!0?d.setAttribute(_,""):O!==!1&&O!=null&&typeof O!="function"&&typeof O!="symbol"?d.setAttribute(_,O):d.removeAttribute(_);break;case"cols":case"rows":case"size":case"span":O!=null&&typeof O!="function"&&typeof O!="symbol"&&!isNaN(O)&&1<=O?d.setAttribute(_,O):d.removeAttribute(_);break;case"rowSpan":case"start":O==null||typeof O=="function"||typeof O=="symbol"||isNaN(O)?d.removeAttribute(_):d.setAttribute(_,O);break;case"popover":cr("beforetoggle",d),cr("toggle",d),st(d,"popover",O);break;case"xlinkActuate":gt(d,"http://www.w3.org/1999/xlink","xlink:actuate",O);break;case"xlinkArcrole":gt(d,"http://www.w3.org/1999/xlink","xlink:arcrole",O);break;case"xlinkRole":gt(d,"http://www.w3.org/1999/xlink","xlink:role",O);break;case"xlinkShow":gt(d,"http://www.w3.org/1999/xlink","xlink:show",O);break;case"xlinkTitle":gt(d,"http://www.w3.org/1999/xlink","xlink:title",O);break;case"xlinkType":gt(d,"http://www.w3.org/1999/xlink","xlink:type",O);break;case"xmlBase":gt(d,"http://www.w3.org/XML/1998/namespace","xml:base",O);break;case"xmlLang":gt(d,"http://www.w3.org/XML/1998/namespace","xml:lang",O);break;case"xmlSpace":gt(d,"http://www.w3.org/XML/1998/namespace","xml:space",O);break;case"is":st(d,"is",O);break;case"innerText":case"textContent":break;default:(!(2<_.length)||_[0]!=="o"&&_[0]!=="O"||_[1]!=="n"&&_[1]!=="N")&&(_=hi.get(_)||_,st(d,_,O))}}function I0(d,m,_,O,G,J){switch(_){case"style":di(d,O,J);break;case"dangerouslySetInnerHTML":if(O!=null){if(typeof O!="object"||!("__html"in O))throw Error(n(61));if(_=O.__html,_!=null){if(G.children!=null)throw Error(n(60));d.innerHTML=_}}break;case"children":typeof O=="string"?rn(d,O):(typeof O=="number"||typeof O=="bigint")&&rn(d,""+O);break;case"onScroll":O!=null&&cr("scroll",d);break;case"onScrollEnd":O!=null&&cr("scrollend",d);break;case"onClick":O!=null&&(d.onclick=Hd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ze.hasOwnProperty(_))e:{if(_[0]==="o"&&_[1]==="n"&&(G=_.endsWith("Capture"),m=_.slice(2,G?_.length-7:void 0),J=d[xt]||null,J=J!=null?J[_]:null,typeof J=="function"&&d.removeEventListener(m,J,G),typeof O=="function")){typeof J!="function"&&J!==null&&(_ in d?d[_]=null:d.hasAttribute(_)&&d.removeAttribute(_)),d.addEventListener(m,O,G);break e}_ in d?d[_]=O:O===!0?d.setAttribute(_,""):st(d,_,O)}}}function An(d,m,_){switch(m){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":cr("error",d),cr("load",d);var O=!1,G=!1,J;for(J in _)if(_.hasOwnProperty(J)){var oe=_[J];if(oe!=null)switch(J){case"src":O=!0;break;case"srcSet":G=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,m));default:Ar(d,m,J,oe,_,null)}}G&&Ar(d,m,"srcSet",_.srcSet,_,null),O&&Ar(d,m,"src",_.src,_,null);return;case"input":cr("invalid",d);var pe=J=oe=G=null,je=null,Xe=null;for(O in _)if(_.hasOwnProperty(O)){var ft=_[O];if(ft!=null)switch(O){case"name":G=ft;break;case"type":oe=ft;break;case"checked":je=ft;break;case"defaultChecked":Xe=ft;break;case"value":J=ft;break;case"defaultValue":pe=ft;break;case"children":case"dangerouslySetInnerHTML":if(ft!=null)throw Error(n(137,m));break;default:Ar(d,m,O,ft,_,null)}}gr(d,J,pe,je,Xe,oe,G,!1),tn(d);return;case"select":cr("invalid",d),O=oe=J=null;for(G in _)if(_.hasOwnProperty(G)&&(pe=_[G],pe!=null))switch(G){case"value":J=pe;break;case"defaultValue":oe=pe;break;case"multiple":O=pe;default:Ar(d,m,G,pe,_,null)}m=J,_=oe,d.multiple=!!O,m!=null?qn(d,!!O,m,!1):_!=null&&qn(d,!!O,_,!0);return;case"textarea":cr("invalid",d),J=G=O=null;for(oe in _)if(_.hasOwnProperty(oe)&&(pe=_[oe],pe!=null))switch(oe){case"value":O=pe;break;case"defaultValue":G=pe;break;case"children":J=pe;break;case"dangerouslySetInnerHTML":if(pe!=null)throw Error(n(91));break;default:Ar(d,m,oe,pe,_,null)}ao(d,O,G,J),tn(d);return;case"option":for(je in _)if(_.hasOwnProperty(je)&&(O=_[je],O!=null))switch(je){case"selected":d.selected=O&&typeof O!="function"&&typeof O!="symbol";break;default:Ar(d,m,je,O,_,null)}return;case"dialog":cr("beforetoggle",d),cr("toggle",d),cr("cancel",d),cr("close",d);break;case"iframe":case"object":cr("load",d);break;case"video":case"audio":for(O=0;O<zc.length;O++)cr(zc[O],d);break;case"image":cr("error",d),cr("load",d);break;case"details":cr("toggle",d);break;case"embed":case"source":case"link":cr("error",d),cr("load",d);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Xe in _)if(_.hasOwnProperty(Xe)&&(O=_[Xe],O!=null))switch(Xe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,m));default:Ar(d,m,Xe,O,_,null)}return;default:if(fi(m)){for(ft in _)_.hasOwnProperty(ft)&&(O=_[ft],O!==void 0&&I0(d,m,ft,O,_,void 0));return}}for(pe in _)_.hasOwnProperty(pe)&&(O=_[pe],O!=null&&Ar(d,m,pe,O,_,null))}function $6(d,m,_,O){switch(m){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var G=null,J=null,oe=null,pe=null,je=null,Xe=null,ft=null;for(Qe in _){var yt=_[Qe];if(_.hasOwnProperty(Qe)&&yt!=null)switch(Qe){case"checked":break;case"value":break;case"defaultValue":je=yt;default:O.hasOwnProperty(Qe)||Ar(d,m,Qe,null,O,yt)}}for(var Ze in O){var Qe=O[Ze];if(yt=_[Ze],O.hasOwnProperty(Ze)&&(Qe!=null||yt!=null))switch(Ze){case"type":J=Qe;break;case"name":G=Qe;break;case"checked":Xe=Qe;break;case"defaultChecked":ft=Qe;break;case"value":oe=Qe;break;case"defaultValue":pe=Qe;break;case"children":case"dangerouslySetInnerHTML":if(Qe!=null)throw Error(n(137,m));break;default:Qe!==yt&&Ar(d,m,Ze,Qe,O,yt)}}ds(d,oe,pe,je,Xe,ft,J,G);return;case"select":Qe=oe=pe=Ze=null;for(J in _)if(je=_[J],_.hasOwnProperty(J)&&je!=null)switch(J){case"value":break;case"multiple":Qe=je;default:O.hasOwnProperty(J)||Ar(d,m,J,null,O,je)}for(G in O)if(J=O[G],je=_[G],O.hasOwnProperty(G)&&(J!=null||je!=null))switch(G){case"value":Ze=J;break;case"defaultValue":pe=J;break;case"multiple":oe=J;default:J!==je&&Ar(d,m,G,J,O,je)}m=pe,_=oe,O=Qe,Ze!=null?qn(d,!!_,Ze,!1):!!O!=!!_&&(m!=null?qn(d,!!_,m,!0):qn(d,!!_,_?[]:"",!1));return;case"textarea":Qe=Ze=null;for(pe in _)if(G=_[pe],_.hasOwnProperty(pe)&&G!=null&&!O.hasOwnProperty(pe))switch(pe){case"value":break;case"children":break;default:Ar(d,m,pe,null,O,G)}for(oe in O)if(G=O[oe],J=_[oe],O.hasOwnProperty(oe)&&(G!=null||J!=null))switch(oe){case"value":Ze=G;break;case"defaultValue":Qe=G;break;case"children":break;case"dangerouslySetInnerHTML":if(G!=null)throw Error(n(91));break;default:G!==J&&Ar(d,m,oe,G,O,J)}fs(d,Ze,Qe);return;case"option":for(var Yt in _)if(Ze=_[Yt],_.hasOwnProperty(Yt)&&Ze!=null&&!O.hasOwnProperty(Yt))switch(Yt){case"selected":d.selected=!1;break;default:Ar(d,m,Yt,null,O,Ze)}for(je in O)if(Ze=O[je],Qe=_[je],O.hasOwnProperty(je)&&Ze!==Qe&&(Ze!=null||Qe!=null))switch(je){case"selected":d.selected=Ze&&typeof Ze!="function"&&typeof Ze!="symbol";break;default:Ar(d,m,je,Ze,O,Qe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Vt in _)Ze=_[Vt],_.hasOwnProperty(Vt)&&Ze!=null&&!O.hasOwnProperty(Vt)&&Ar(d,m,Vt,null,O,Ze);for(Xe in O)if(Ze=O[Xe],Qe=_[Xe],O.hasOwnProperty(Xe)&&Ze!==Qe&&(Ze!=null||Qe!=null))switch(Xe){case"children":case"dangerouslySetInnerHTML":if(Ze!=null)throw Error(n(137,m));break;default:Ar(d,m,Xe,Ze,O,Qe)}return;default:if(fi(m)){for(var Cr in _)Ze=_[Cr],_.hasOwnProperty(Cr)&&Ze!==void 0&&!O.hasOwnProperty(Cr)&&I0(d,m,Cr,void 0,O,Ze);for(ft in O)Ze=O[ft],Qe=_[ft],!O.hasOwnProperty(ft)||Ze===Qe||Ze===void 0&&Qe===void 0||I0(d,m,ft,Ze,O,Qe);return}}for(var He in _)Ze=_[He],_.hasOwnProperty(He)&&Ze!=null&&!O.hasOwnProperty(He)&&Ar(d,m,He,null,O,Ze);for(yt in O)Ze=O[yt],Qe=_[yt],!O.hasOwnProperty(yt)||Ze===Qe||Ze==null&&Qe==null||Ar(d,m,yt,Ze,O,Qe)}var P0=null,L0=null;function qd(d){return d.nodeType===9?d:d.ownerDocument}function pb(d){switch(d){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function mb(d,m){if(d===0)switch(m){case"svg":return 1;case"math":return 2;default:return 0}return d===1&&m==="foreignObject"?0:d}function B0(d,m){return d==="textarea"||d==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.children=="bigint"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var U0=null;function V6(){var d=window.event;return d&&d.type==="popstate"?d===U0?!1:(U0=d,!0):(U0=null,!1)}var gb=typeof setTimeout=="function"?setTimeout:void 0,H6=typeof clearTimeout=="function"?clearTimeout:void 0,vb=typeof Promise=="function"?Promise:void 0,q6=typeof queueMicrotask=="function"?queueMicrotask:typeof vb<"u"?function(d){return vb.resolve(null).then(d).catch(W6)}:gb;function W6(d){setTimeout(function(){throw d})}function Di(d){return d==="head"}function bb(d,m){var _=m,O=0,G=0;do{var J=_.nextSibling;if(d.removeChild(_),J&&J.nodeType===8)if(_=J.data,_==="/$"){if(0<O&&8>O){_=O;var oe=d.ownerDocument;if(_&1&&Vc(oe.documentElement),_&2&&Vc(oe.body),_&4)for(_=oe.head,Vc(_),oe=_.firstChild;oe;){var pe=oe.nextSibling,je=oe.nodeName;oe[ue]||je==="SCRIPT"||je==="STYLE"||je==="LINK"&&oe.rel.toLowerCase()==="stylesheet"||_.removeChild(oe),oe=pe}}if(G===0){d.removeChild(J),Zc(m);return}G--}else _==="$"||_==="$?"||_==="$!"?G++:O=_.charCodeAt(0)-48;else O=0;_=J}while(_);Zc(m)}function z0(d){var m=d.firstChild;for(m&&m.nodeType===10&&(m=m.nextSibling);m;){var _=m;switch(m=m.nextSibling,_.nodeName){case"HTML":case"HEAD":case"BODY":z0(_),me(_);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(_.rel.toLowerCase()==="stylesheet")continue}d.removeChild(_)}}function G6(d,m,_,O){for(;d.nodeType===1;){var G=_;if(d.nodeName.toLowerCase()!==m.toLowerCase()){if(!O&&(d.nodeName!=="INPUT"||d.type!=="hidden"))break}else if(O){if(!d[ue])switch(m){case"meta":if(!d.hasAttribute("itemprop"))break;return d;case"link":if(J=d.getAttribute("rel"),J==="stylesheet"&&d.hasAttribute("data-precedence"))break;if(J!==G.rel||d.getAttribute("href")!==(G.href==null||G.href===""?null:G.href)||d.getAttribute("crossorigin")!==(G.crossOrigin==null?null:G.crossOrigin)||d.getAttribute("title")!==(G.title==null?null:G.title))break;return d;case"style":if(d.hasAttribute("data-precedence"))break;return d;case"script":if(J=d.getAttribute("src"),(J!==(G.src==null?null:G.src)||d.getAttribute("type")!==(G.type==null?null:G.type)||d.getAttribute("crossorigin")!==(G.crossOrigin==null?null:G.crossOrigin))&&J&&d.hasAttribute("async")&&!d.hasAttribute("itemprop"))break;return d;default:return d}}else if(m==="input"&&d.type==="hidden"){var J=G.name==null?null:""+G.name;if(G.type==="hidden"&&d.getAttribute("name")===J)return d}else return d;if(d=Ka(d.nextSibling),d===null)break}return null}function Y6(d,m,_){if(m==="")return null;for(;d.nodeType!==3;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!_||(d=Ka(d.nextSibling),d===null))return null;return d}function $0(d){return d.data==="$!"||d.data==="$?"&&d.ownerDocument.readyState==="complete"}function X6(d,m){var _=d.ownerDocument;if(d.data!=="$?"||_.readyState==="complete")m();else{var O=function(){m(),_.removeEventListener("DOMContentLoaded",O)};_.addEventListener("DOMContentLoaded",O),d._reactRetry=O}}function Ka(d){for(;d!=null;d=d.nextSibling){var m=d.nodeType;if(m===1||m===3)break;if(m===8){if(m=d.data,m==="$"||m==="$!"||m==="$?"||m==="F!"||m==="F")break;if(m==="/$")return null}}return d}var V0=null;function xb(d){d=d.previousSibling;for(var m=0;d;){if(d.nodeType===8){var _=d.data;if(_==="$"||_==="$!"||_==="$?"){if(m===0)return d;m--}else _==="/$"&&m++}d=d.previousSibling}return null}function yb(d,m,_){switch(m=qd(_),d){case"html":if(d=m.documentElement,!d)throw Error(n(452));return d;case"head":if(d=m.head,!d)throw Error(n(453));return d;case"body":if(d=m.body,!d)throw Error(n(454));return d;default:throw Error(n(451))}}function Vc(d){for(var m=d.attributes;m.length;)d.removeAttributeNode(m[0]);me(d)}var ja=new Map,wb=new Set;function Wd(d){return typeof d.getRootNode=="function"?d.getRootNode():d.nodeType===9?d:d.ownerDocument}var Ks=T.d;T.d={f:K6,r:Z6,D:J6,C:Q6,L:e5,m:t5,X:n5,S:r5,M:a5};function K6(){var d=Ks.f(),m=Pd();return d||m}function Z6(d){var m=ge(d);m!==null&&m.tag===5&&m.type==="form"?zg(m):Ks.r(d)}var yl=typeof document>"u"?null:document;function _b(d,m,_){var O=yl;if(O&&typeof m=="string"&&m){var G=hn(m);G='link[rel="'+d+'"][href="'+G+'"]',typeof _=="string"&&(G+='[crossorigin="'+_+'"]'),wb.has(G)||(wb.add(G),d={rel:d,crossOrigin:_,href:m},O.querySelector(G)===null&&(m=O.createElement("link"),An(m,"link",d),Me(m),O.head.appendChild(m)))}}function J6(d){Ks.D(d),_b("dns-prefetch",d,null)}function Q6(d,m){Ks.C(d,m),_b("preconnect",d,m)}function e5(d,m,_){Ks.L(d,m,_);var O=yl;if(O&&d&&m){var G='link[rel="preload"][as="'+hn(m)+'"]';m==="image"&&_&&_.imageSrcSet?(G+='[imagesrcset="'+hn(_.imageSrcSet)+'"]',typeof _.imageSizes=="string"&&(G+='[imagesizes="'+hn(_.imageSizes)+'"]')):G+='[href="'+hn(d)+'"]';var J=G;switch(m){case"style":J=wl(d);break;case"script":J=_l(d)}ja.has(J)||(d=u({rel:"preload",href:m==="image"&&_&&_.imageSrcSet?void 0:d,as:m},_),ja.set(J,d),O.querySelector(G)!==null||m==="style"&&O.querySelector(Hc(J))||m==="script"&&O.querySelector(qc(J))||(m=O.createElement("link"),An(m,"link",d),Me(m),O.head.appendChild(m)))}}function t5(d,m){Ks.m(d,m);var _=yl;if(_&&d){var O=m&&typeof m.as=="string"?m.as:"script",G='link[rel="modulepreload"][as="'+hn(O)+'"][href="'+hn(d)+'"]',J=G;switch(O){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":J=_l(d)}if(!ja.has(J)&&(d=u({rel:"modulepreload",href:d},m),ja.set(J,d),_.querySelector(G)===null)){switch(O){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(_.querySelector(qc(J)))return}O=_.createElement("link"),An(O,"link",d),Me(O),_.head.appendChild(O)}}}function r5(d,m,_){Ks.S(d,m,_);var O=yl;if(O&&d){var G=Ue(O).hoistableStyles,J=wl(d);m=m||"default";var oe=G.get(J);if(!oe){var pe={loading:0,preload:null};if(oe=O.querySelector(Hc(J)))pe.loading=5;else{d=u({rel:"stylesheet",href:d,"data-precedence":m},_),(_=ja.get(J))&&H0(d,_);var je=oe=O.createElement("link");Me(je),An(je,"link",d),je._p=new Promise(function(Xe,ft){je.onload=Xe,je.onerror=ft}),je.addEventListener("load",function(){pe.loading|=1}),je.addEventListener("error",function(){pe.loading|=2}),pe.loading|=4,Gd(oe,m,O)}oe={type:"stylesheet",instance:oe,count:1,state:pe},G.set(J,oe)}}}function n5(d,m){Ks.X(d,m);var _=yl;if(_&&d){var O=Ue(_).hoistableScripts,G=_l(d),J=O.get(G);J||(J=_.querySelector(qc(G)),J||(d=u({src:d,async:!0},m),(m=ja.get(G))&&q0(d,m),J=_.createElement("script"),Me(J),An(J,"link",d),_.head.appendChild(J)),J={type:"script",instance:J,count:1,state:null},O.set(G,J))}}function a5(d,m){Ks.M(d,m);var _=yl;if(_&&d){var O=Ue(_).hoistableScripts,G=_l(d),J=O.get(G);J||(J=_.querySelector(qc(G)),J||(d=u({src:d,async:!0,type:"module"},m),(m=ja.get(G))&&q0(d,m),J=_.createElement("script"),Me(J),An(J,"link",d),_.head.appendChild(J)),J={type:"script",instance:J,count:1,state:null},O.set(G,J))}}function Sb(d,m,_,O){var G=(G=U.current)?Wd(G):null;if(!G)throw Error(n(446));switch(d){case"meta":case"title":return null;case"style":return typeof _.precedence=="string"&&typeof _.href=="string"?(m=wl(_.href),_=Ue(G).hoistableStyles,O=_.get(m),O||(O={type:"style",instance:null,count:0,state:null},_.set(m,O)),O):{type:"void",instance:null,count:0,state:null};case"link":if(_.rel==="stylesheet"&&typeof _.href=="string"&&typeof _.precedence=="string"){d=wl(_.href);var J=Ue(G).hoistableStyles,oe=J.get(d);if(oe||(G=G.ownerDocument||G,oe={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},J.set(d,oe),(J=G.querySelector(Hc(d)))&&!J._p&&(oe.instance=J,oe.state.loading=5),ja.has(d)||(_={rel:"preload",as:"style",href:_.href,crossOrigin:_.crossOrigin,integrity:_.integrity,media:_.media,hrefLang:_.hrefLang,referrerPolicy:_.referrerPolicy},ja.set(d,_),J||s5(G,d,_,oe.state))),m&&O===null)throw Error(n(528,""));return oe}if(m&&O!==null)throw Error(n(529,""));return null;case"script":return m=_.async,_=_.src,typeof _=="string"&&m&&typeof m!="function"&&typeof m!="symbol"?(m=_l(_),_=Ue(G).hoistableScripts,O=_.get(m),O||(O={type:"script",instance:null,count:0,state:null},_.set(m,O)),O):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,d))}}function wl(d){return'href="'+hn(d)+'"'}function Hc(d){return'link[rel="stylesheet"]['+d+"]"}function kb(d){return u({},d,{"data-precedence":d.precedence,precedence:null})}function s5(d,m,_,O){d.querySelector('link[rel="preload"][as="style"]['+m+"]")?O.loading=1:(m=d.createElement("link"),O.preload=m,m.addEventListener("load",function(){return O.loading|=1}),m.addEventListener("error",function(){return O.loading|=2}),An(m,"link",_),Me(m),d.head.appendChild(m))}function _l(d){return'[src="'+hn(d)+'"]'}function qc(d){return"script[async]"+d}function Eb(d,m,_){if(m.count++,m.instance===null)switch(m.type){case"style":var O=d.querySelector('style[data-href~="'+hn(_.href)+'"]');if(O)return m.instance=O,Me(O),O;var G=u({},_,{"data-href":_.href,"data-precedence":_.precedence,href:null,precedence:null});return O=(d.ownerDocument||d).createElement("style"),Me(O),An(O,"style",G),Gd(O,_.precedence,d),m.instance=O;case"stylesheet":G=wl(_.href);var J=d.querySelector(Hc(G));if(J)return m.state.loading|=4,m.instance=J,Me(J),J;O=kb(_),(G=ja.get(G))&&H0(O,G),J=(d.ownerDocument||d).createElement("link"),Me(J);var oe=J;return oe._p=new Promise(function(pe,je){oe.onload=pe,oe.onerror=je}),An(J,"link",O),m.state.loading|=4,Gd(J,_.precedence,d),m.instance=J;case"script":return J=_l(_.src),(G=d.querySelector(qc(J)))?(m.instance=G,Me(G),G):(O=_,(G=ja.get(J))&&(O=u({},_),q0(O,G)),d=d.ownerDocument||d,G=d.createElement("script"),Me(G),An(G,"link",O),d.head.appendChild(G),m.instance=G);case"void":return null;default:throw Error(n(443,m.type))}else m.type==="stylesheet"&&(m.state.loading&4)===0&&(O=m.instance,m.state.loading|=4,Gd(O,_.precedence,d));return m.instance}function Gd(d,m,_){for(var O=_.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),G=O.length?O[O.length-1]:null,J=G,oe=0;oe<O.length;oe++){var pe=O[oe];if(pe.dataset.precedence===m)J=pe;else if(J!==G)break}J?J.parentNode.insertBefore(d,J.nextSibling):(m=_.nodeType===9?_.head:_,m.insertBefore(d,m.firstChild))}function H0(d,m){d.crossOrigin==null&&(d.crossOrigin=m.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=m.referrerPolicy),d.title==null&&(d.title=m.title)}function q0(d,m){d.crossOrigin==null&&(d.crossOrigin=m.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=m.referrerPolicy),d.integrity==null&&(d.integrity=m.integrity)}var Yd=null;function Tb(d,m,_){if(Yd===null){var O=new Map,G=Yd=new Map;G.set(_,O)}else G=Yd,O=G.get(_),O||(O=new Map,G.set(_,O));if(O.has(d))return O;for(O.set(d,null),_=_.getElementsByTagName(d),G=0;G<_.length;G++){var J=_[G];if(!(J[ue]||J[bt]||d==="link"&&J.getAttribute("rel")==="stylesheet")&&J.namespaceURI!=="http://www.w3.org/2000/svg"){var oe=J.getAttribute(m)||"";oe=d+oe;var pe=O.get(oe);pe?pe.push(J):O.set(oe,[J])}}return O}function Ab(d,m,_){d=d.ownerDocument||d,d.head.insertBefore(_,m==="title"?d.querySelector("head > title"):null)}function i5(d,m,_){if(_===1||m.itemProp!=null)return!1;switch(d){case"meta":case"title":return!0;case"style":if(typeof m.precedence!="string"||typeof m.href!="string"||m.href==="")break;return!0;case"link":if(typeof m.rel!="string"||typeof m.href!="string"||m.href===""||m.onLoad||m.onError)break;switch(m.rel){case"stylesheet":return d=m.disabled,typeof m.precedence=="string"&&d==null;default:return!0}case"script":if(m.async&&typeof m.async!="function"&&typeof m.async!="symbol"&&!m.onLoad&&!m.onError&&m.src&&typeof m.src=="string")return!0}return!1}function Cb(d){return!(d.type==="stylesheet"&&(d.state.loading&3)===0)}var Wc=null;function o5(){}function l5(d,m,_){if(Wc===null)throw Error(n(475));var O=Wc;if(m.type==="stylesheet"&&(typeof _.media!="string"||matchMedia(_.media).matches!==!1)&&(m.state.loading&4)===0){if(m.instance===null){var G=wl(_.href),J=d.querySelector(Hc(G));if(J){d=J._p,d!==null&&typeof d=="object"&&typeof d.then=="function"&&(O.count++,O=Xd.bind(O),d.then(O,O)),m.state.loading|=4,m.instance=J,Me(J);return}J=d.ownerDocument||d,_=kb(_),(G=ja.get(G))&&H0(_,G),J=J.createElement("link"),Me(J);var oe=J;oe._p=new Promise(function(pe,je){oe.onload=pe,oe.onerror=je}),An(J,"link",_),m.instance=J}O.stylesheets===null&&(O.stylesheets=new Map),O.stylesheets.set(m,d),(d=m.state.preload)&&(m.state.loading&3)===0&&(O.count++,m=Xd.bind(O),d.addEventListener("load",m),d.addEventListener("error",m))}}function c5(){if(Wc===null)throw Error(n(475));var d=Wc;return d.stylesheets&&d.count===0&&W0(d,d.stylesheets),0<d.count?function(m){var _=setTimeout(function(){if(d.stylesheets&&W0(d,d.stylesheets),d.unsuspend){var O=d.unsuspend;d.unsuspend=null,O()}},6e4);return d.unsuspend=m,function(){d.unsuspend=null,clearTimeout(_)}}:null}function Xd(){if(this.count--,this.count===0){if(this.stylesheets)W0(this,this.stylesheets);else if(this.unsuspend){var d=this.unsuspend;this.unsuspend=null,d()}}}var Kd=null;function W0(d,m){d.stylesheets=null,d.unsuspend!==null&&(d.count++,Kd=new Map,m.forEach(u5,d),Kd=null,Xd.call(d))}function u5(d,m){if(!(m.state.loading&4)){var _=Kd.get(d);if(_)var O=_.get(null);else{_=new Map,Kd.set(d,_);for(var G=d.querySelectorAll("link[data-precedence],style[data-precedence]"),J=0;J<G.length;J++){var oe=G[J];(oe.nodeName==="LINK"||oe.getAttribute("media")!=="not all")&&(_.set(oe.dataset.precedence,oe),O=oe)}O&&_.set(null,O)}G=m.instance,oe=G.getAttribute("data-precedence"),J=_.get(oe)||O,J===O&&_.set(null,G),_.set(oe,G),this.count++,O=Xd.bind(this),G.addEventListener("load",O),G.addEventListener("error",O),J?J.parentNode.insertBefore(G,J.nextSibling):(d=d.nodeType===9?d.head:d,d.insertBefore(G,d.firstChild)),m.state.loading|=4}}var Gc={$$typeof:E,Provider:null,Consumer:null,_currentValue:A,_currentValue2:A,_threadCount:0};function d5(d,m,_,O,G,J,oe,pe){this.tag=1,this.containerInfo=d,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=wt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wt(0),this.hiddenUpdates=wt(null),this.identifierPrefix=O,this.onUncaughtError=G,this.onCaughtError=J,this.onRecoverableError=oe,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=pe,this.incompleteTransitions=new Map}function Nb(d,m,_,O,G,J,oe,pe,je,Xe,ft,yt){return d=new d5(d,m,_,oe,pe,je,Xe,yt),m=1,J===!0&&(m|=24),J=la(3,null,null,m),d.current=J,J.stateNode=d,m=Ah(),m.refCount++,d.pooledCache=m,m.refCount++,J.memoizedState={element:O,isDehydrated:_,cache:m},jh(J),d}function Ob(d){return d?(d=Qo,d):Qo}function jb(d,m,_,O,G,J){G=Ob(G),O.context===null?O.context=G:O.pendingContext=G,O=xi(m),O.payload={element:_},J=J===void 0?null:J,J!==null&&(O.callback=J),_=yi(d,O,m),_!==null&&(ha(_,d,m),Sc(_,d,m))}function Db(d,m){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var _=d.retryLane;d.retryLane=_!==0&&_<m?_:m}}function G0(d,m){Db(d,m),(d=d.alternate)&&Db(d,m)}function Mb(d){if(d.tag===13){var m=Jo(d,67108864);m!==null&&ha(m,d,67108864),G0(d,67108864)}}var Zd=!0;function f5(d,m,_,O){var G=w.T;w.T=null;var J=T.p;try{T.p=2,Y0(d,m,_,O)}finally{T.p=J,w.T=G}}function h5(d,m,_,O){var G=w.T;w.T=null;var J=T.p;try{T.p=8,Y0(d,m,_,O)}finally{T.p=J,w.T=G}}function Y0(d,m,_,O){if(Zd){var G=X0(O);if(G===null)F0(d,m,O,Jd,_),Fb(d,O);else if(m5(G,d,m,_,O))O.stopPropagation();else if(Fb(d,O),m&4&&-1<p5.indexOf(d)){for(;G!==null;){var J=ge(G);if(J!==null)switch(J.tag){case 3:if(J=J.stateNode,J.current.memoizedState.isDehydrated){var oe=ut(J.pendingLanes);if(oe!==0){var pe=J;for(pe.pendingLanes|=2,pe.entangledLanes|=2;oe;){var je=1<<31-rt(oe);pe.entanglements[1]|=je,oe&=~je}bs(J),(_r&6)===0&&(Fd=ne()+500,Uc(0))}}break;case 13:pe=Jo(J,2),pe!==null&&ha(pe,J,2),Pd(),G0(J,2)}if(J=X0(O),J===null&&F0(d,m,O,Jd,_),J===G)break;G=J}G!==null&&O.stopPropagation()}else F0(d,m,O,null,_)}}function X0(d){return d=io(d),K0(d)}var Jd=null;function K0(d){if(Jd=null,d=ve(d),d!==null){var m=o(d);if(m===null)d=null;else{var _=m.tag;if(_===13){if(d=s(m),d!==null)return d;d=null}else if(_===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;d=null}else m!==d&&(d=null)}}return Jd=d,null}function Rb(d){switch(d){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(de()){case fe:return 2;case Se:return 8;case _e:case Ce:return 32;case Re:return 268435456;default:return 32}default:return 32}}var Z0=!1,Mi=null,Ri=null,Fi=null,Yc=new Map,Xc=new Map,Ii=[],p5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Fb(d,m){switch(d){case"focusin":case"focusout":Mi=null;break;case"dragenter":case"dragleave":Ri=null;break;case"mouseover":case"mouseout":Fi=null;break;case"pointerover":case"pointerout":Yc.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xc.delete(m.pointerId)}}function Kc(d,m,_,O,G,J){return d===null||d.nativeEvent!==J?(d={blockedOn:m,domEventName:_,eventSystemFlags:O,nativeEvent:J,targetContainers:[G]},m!==null&&(m=ge(m),m!==null&&Mb(m)),d):(d.eventSystemFlags|=O,m=d.targetContainers,G!==null&&m.indexOf(G)===-1&&m.push(G),d)}function m5(d,m,_,O,G){switch(m){case"focusin":return Mi=Kc(Mi,d,m,_,O,G),!0;case"dragenter":return Ri=Kc(Ri,d,m,_,O,G),!0;case"mouseover":return Fi=Kc(Fi,d,m,_,O,G),!0;case"pointerover":var J=G.pointerId;return Yc.set(J,Kc(Yc.get(J)||null,d,m,_,O,G)),!0;case"gotpointercapture":return J=G.pointerId,Xc.set(J,Kc(Xc.get(J)||null,d,m,_,O,G)),!0}return!1}function Ib(d){var m=ve(d.target);if(m!==null){var _=o(m);if(_!==null){if(m=_.tag,m===13){if(m=s(_),m!==null){d.blockedOn=m,ke(d.priority,function(){if(_.tag===13){var O=fa();O=lt(O);var G=Jo(_,O);G!==null&&ha(G,_,O),G0(_,O)}});return}}else if(m===3&&_.stateNode.current.memoizedState.isDehydrated){d.blockedOn=_.tag===3?_.stateNode.containerInfo:null;return}}}d.blockedOn=null}function Qd(d){if(d.blockedOn!==null)return!1;for(var m=d.targetContainers;0<m.length;){var _=X0(d.nativeEvent);if(_===null){_=d.nativeEvent;var O=new _.constructor(_.type,_);pi=O,_.target.dispatchEvent(O),pi=null}else return m=ge(_),m!==null&&Mb(m),d.blockedOn=_,!1;m.shift()}return!0}function Pb(d,m,_){Qd(d)&&_.delete(m)}function g5(){Z0=!1,Mi!==null&&Qd(Mi)&&(Mi=null),Ri!==null&&Qd(Ri)&&(Ri=null),Fi!==null&&Qd(Fi)&&(Fi=null),Yc.forEach(Pb),Xc.forEach(Pb)}function ef(d,m){d.blockedOn===m&&(d.blockedOn=null,Z0||(Z0=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,g5)))}var tf=null;function Lb(d){tf!==d&&(tf=d,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){tf===d&&(tf=null);for(var m=0;m<d.length;m+=3){var _=d[m],O=d[m+1],G=d[m+2];if(typeof O!="function"){if(K0(O||_)===null)continue;break}var J=ge(_);J!==null&&(d.splice(m,3),m-=3,Kh(J,{pending:!0,data:G,method:_.method,action:O},O,G))}}))}function Zc(d){function m(je){return ef(je,d)}Mi!==null&&ef(Mi,d),Ri!==null&&ef(Ri,d),Fi!==null&&ef(Fi,d),Yc.forEach(m),Xc.forEach(m);for(var _=0;_<Ii.length;_++){var O=Ii[_];O.blockedOn===d&&(O.blockedOn=null)}for(;0<Ii.length&&(_=Ii[0],_.blockedOn===null);)Ib(_),_.blockedOn===null&&Ii.shift();if(_=(d.ownerDocument||d).$$reactFormReplay,_!=null)for(O=0;O<_.length;O+=3){var G=_[O],J=_[O+1],oe=G[xt]||null;if(typeof J=="function")oe||Lb(_);else if(oe){var pe=null;if(J&&J.hasAttribute("formAction")){if(G=J,oe=J[xt]||null)pe=oe.formAction;else if(K0(G)!==null)continue}else pe=oe.action;typeof pe=="function"?_[O+1]=pe:(_.splice(O,3),O-=3),Lb(_)}}}function J0(d){this._internalRoot=d}rf.prototype.render=J0.prototype.render=function(d){var m=this._internalRoot;if(m===null)throw Error(n(409));var _=m.current,O=fa();jb(_,O,d,m,null,null)},rf.prototype.unmount=J0.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var m=d.containerInfo;jb(d.current,2,null,d,null,null),Pd(),m[Ae]=null}};function rf(d){this._internalRoot=d}rf.prototype.unstable_scheduleHydration=function(d){if(d){var m=$t();d={blockedOn:null,target:d,priority:m};for(var _=0;_<Ii.length&&m!==0&&m<Ii[_].priority;_++);Ii.splice(_,0,d),_===0&&Ib(d)}};var Bb=r.version;if(Bb!=="19.1.0")throw Error(n(527,Bb,"19.1.0"));T.findDOMNode=function(d){var m=d._reactInternals;if(m===void 0)throw typeof d.render=="function"?Error(n(188)):(d=Object.keys(d).join(","),Error(n(268,d)));return d=c(m),d=d!==null?i(d):null,d=d===null?null:d.stateNode,d};var v5={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:w,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nf.isDisabled&&nf.supportsFiber)try{at=nf.inject(v5),tt=nf}catch{}}return Jc.createRoot=function(d,m){if(!a(d))throw Error(n(299));var _=!1,O="",G=tv,J=rv,oe=nv,pe=null;return m!=null&&(m.unstable_strictMode===!0&&(_=!0),m.identifierPrefix!==void 0&&(O=m.identifierPrefix),m.onUncaughtError!==void 0&&(G=m.onUncaughtError),m.onCaughtError!==void 0&&(J=m.onCaughtError),m.onRecoverableError!==void 0&&(oe=m.onRecoverableError),m.unstable_transitionCallbacks!==void 0&&(pe=m.unstable_transitionCallbacks)),m=Nb(d,1,!1,null,null,_,O,G,J,oe,pe,null),d[Ae]=m.current,R0(d),new J0(m)},Jc.hydrateRoot=function(d,m,_){if(!a(d))throw Error(n(299));var O=!1,G="",J=tv,oe=rv,pe=nv,je=null,Xe=null;return _!=null&&(_.unstable_strictMode===!0&&(O=!0),_.identifierPrefix!==void 0&&(G=_.identifierPrefix),_.onUncaughtError!==void 0&&(J=_.onUncaughtError),_.onCaughtError!==void 0&&(oe=_.onCaughtError),_.onRecoverableError!==void 0&&(pe=_.onRecoverableError),_.unstable_transitionCallbacks!==void 0&&(je=_.unstable_transitionCallbacks),_.formState!==void 0&&(Xe=_.formState)),m=Nb(d,1,!0,m,_??null,O,G,J,oe,pe,je,Xe),m.context=Ob(null),_=m.current,O=fa(),O=lt(O),G=xi(O),G.callback=null,yi(_,G,O),_=O,m.current.lanes=_,et(m,_),bs(m),d[Ae]=m.current,R0(d),new rf(m)},Jc.version="19.1.0",Jc}var Vb;function v8(){if(Vb)return Q0.exports;Vb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(r){console.error(r)}}return t(),Q0.exports=g8(),Q0.exports}var b8=v8();const mm="-",x8=t=>{const r=w8(t),{conflictingClassGroups:e,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:s=>{const l=s.split(mm);return l[0]===""&&l.length!==1&&l.shift(),Sy(l,r)||y8(s)},getConflictingClassGroupIds:(s,l)=>{const c=e[s]||[];return l&&n[s]?[...c,...n[s]]:c}}},Sy=(t,r)=>{var s;if(t.length===0)return r.classGroupId;const e=t[0],n=r.nextPart.get(e),a=n?Sy(t.slice(1),n):void 0;if(a)return a;if(r.validators.length===0)return;const o=t.join(mm);return(s=r.validators.find(({validator:l})=>l(o)))==null?void 0:s.classGroupId},Hb=/^\[(.+)\]$/,y8=t=>{if(Hb.test(t)){const r=Hb.exec(t)[1],e=r==null?void 0:r.substring(0,r.indexOf(":"));if(e)return"arbitrary.."+e}},w8=t=>{const{theme:r,prefix:e}=t,n={nextPart:new Map,validators:[]};return S8(Object.entries(t.classGroups),e).forEach(([o,s])=>{Op(s,n,o,r)}),n},Op=(t,r,e,n)=>{t.forEach(a=>{if(typeof a=="string"){const o=a===""?r:qb(r,a);o.classGroupId=e;return}if(typeof a=="function"){if(_8(a)){Op(a(n),r,e,n);return}r.validators.push({validator:a,classGroupId:e});return}Object.entries(a).forEach(([o,s])=>{Op(s,qb(r,o),e,n)})})},qb=(t,r)=>{let e=t;return r.split(mm).forEach(n=>{e.nextPart.has(n)||e.nextPart.set(n,{nextPart:new Map,validators:[]}),e=e.nextPart.get(n)}),e},_8=t=>t.isThemeGetter,S8=(t,r)=>r?t.map(([e,n])=>{const a=n.map(o=>typeof o=="string"?r+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([s,l])=>[r+s,l])):o);return[e,a]}):t,k8=t=>{if(t<1)return{get:()=>{},set:()=>{}};let r=0,e=new Map,n=new Map;const a=(o,s)=>{e.set(o,s),r++,r>t&&(r=0,n=e,e=new Map)};return{get(o){let s=e.get(o);if(s!==void 0)return s;if((s=n.get(o))!==void 0)return a(o,s),s},set(o,s){e.has(o)?e.set(o,s):a(o,s)}}},ky="!",E8=t=>{const{separator:r,experimentalParseClassName:e}=t,n=r.length===1,a=r[0],o=r.length,s=l=>{const c=[];let i=0,u=0,p;for(let g=0;g<l.length;g++){let x=l[g];if(i===0){if(x===a&&(n||l.slice(g,g+o)===r)){c.push(l.slice(u,g)),u=g+o;continue}if(x==="/"){p=g;continue}}x==="["?i++:x==="]"&&i--}const f=c.length===0?l:l.substring(u),h=f.startsWith(ky),v=h?f.substring(1):f,b=p&&p>u?p-u:void 0;return{modifiers:c,hasImportantModifier:h,baseClassName:v,maybePostfixModifierPosition:b}};return e?l=>e({className:l,parseClassName:s}):s},T8=t=>{if(t.length<=1)return t;const r=[];let e=[];return t.forEach(n=>{n[0]==="["?(r.push(...e.sort(),n),e=[]):e.push(n)}),r.push(...e.sort()),r},A8=t=>({cache:k8(t.cacheSize),parseClassName:E8(t),...x8(t)}),C8=/\s+/,N8=(t,r)=>{const{parseClassName:e,getClassGroupId:n,getConflictingClassGroupIds:a}=r,o=[],s=t.trim().split(C8);let l="";for(let c=s.length-1;c>=0;c-=1){const i=s[c],{modifiers:u,hasImportantModifier:p,baseClassName:f,maybePostfixModifierPosition:h}=e(i);let v=!!h,b=n(v?f.substring(0,h):f);if(!b){if(!v){l=i+(l.length>0?" "+l:l);continue}if(b=n(f),!b){l=i+(l.length>0?" "+l:l);continue}v=!1}const g=T8(u).join(":"),x=p?g+ky:g,y=x+b;if(o.includes(y))continue;o.push(y);const E=a(b,v);for(let N=0;N<E.length;++N){const I=E[N];o.push(x+I)}l=i+(l.length>0?" "+l:l)}return l};function O8(){let t=0,r,e,n="";for(;t<arguments.length;)(r=arguments[t++])&&(e=Ey(r))&&(n&&(n+=" "),n+=e);return n}const Ey=t=>{if(typeof t=="string")return t;let r,e="";for(let n=0;n<t.length;n++)t[n]&&(r=Ey(t[n]))&&(e&&(e+=" "),e+=r);return e};function j8(t,...r){let e,n,a,o=s;function s(c){const i=r.reduce((u,p)=>p(u),t());return e=A8(i),n=e.cache.get,a=e.cache.set,o=l,l(c)}function l(c){const i=n(c);if(i)return i;const u=N8(c,e);return a(c,u),u}return function(){return o(O8.apply(null,arguments))}}const Ir=t=>{const r=e=>e[t]||[];return r.isThemeGetter=!0,r},Ty=/^\[(?:([a-z-]+):)?(.+)\]$/i,D8=/^\d+\/\d+$/,M8=new Set(["px","full","screen"]),R8=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,F8=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,I8=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,P8=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,L8=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Zs=t=>Vl(t)||M8.has(t)||D8.test(t),Li=t=>Ql(t,"length",W8),Vl=t=>!!t&&!Number.isNaN(Number(t)),rp=t=>Ql(t,"number",Vl),Qc=t=>!!t&&Number.isInteger(Number(t)),B8=t=>t.endsWith("%")&&Vl(t.slice(0,-1)),nr=t=>Ty.test(t),Bi=t=>R8.test(t),U8=new Set(["length","size","percentage"]),z8=t=>Ql(t,U8,Ay),$8=t=>Ql(t,"position",Ay),V8=new Set(["image","url"]),H8=t=>Ql(t,V8,Y8),q8=t=>Ql(t,"",G8),eu=()=>!0,Ql=(t,r,e)=>{const n=Ty.exec(t);return n?n[1]?typeof r=="string"?n[1]===r:r.has(n[1]):e(n[2]):!1},W8=t=>F8.test(t)&&!I8.test(t),Ay=()=>!1,G8=t=>P8.test(t),Y8=t=>L8.test(t),X8=()=>{const t=Ir("colors"),r=Ir("spacing"),e=Ir("blur"),n=Ir("brightness"),a=Ir("borderColor"),o=Ir("borderRadius"),s=Ir("borderSpacing"),l=Ir("borderWidth"),c=Ir("contrast"),i=Ir("grayscale"),u=Ir("hueRotate"),p=Ir("invert"),f=Ir("gap"),h=Ir("gradientColorStops"),v=Ir("gradientColorStopPositions"),b=Ir("inset"),g=Ir("margin"),x=Ir("opacity"),y=Ir("padding"),E=Ir("saturate"),N=Ir("scale"),I=Ir("sepia"),L=Ir("skew"),H=Ir("space"),V=Ir("translate"),q=()=>["auto","contain","none"],K=()=>["auto","hidden","clip","visible","scroll"],z=()=>["auto",nr,r],W=()=>[nr,r],D=()=>["",Zs,Li],M=()=>["auto",Vl,nr],C=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],w=()=>["solid","dashed","dotted","double","none"],T=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],A=()=>["start","end","center","between","around","evenly","stretch"],S=()=>["","0",nr],j=()=>["auto","avoid","all","avoid-page","page","left","right","column"],B=()=>[Vl,nr];return{cacheSize:500,separator:":",theme:{colors:[eu],spacing:[Zs,Li],blur:["none","",Bi,nr],brightness:B(),borderColor:[t],borderRadius:["none","","full",Bi,nr],borderSpacing:W(),borderWidth:D(),contrast:B(),grayscale:S(),hueRotate:B(),invert:S(),gap:W(),gradientColorStops:[t],gradientColorStopPositions:[B8,Li],inset:z(),margin:z(),opacity:B(),padding:W(),saturate:B(),scale:B(),sepia:S(),skew:B(),space:W(),translate:W()},classGroups:{aspect:[{aspect:["auto","square","video",nr]}],container:["container"],columns:[{columns:[Bi]}],"break-after":[{"break-after":j()}],"break-before":[{"break-before":j()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...C(),nr]}],overflow:[{overflow:K()}],"overflow-x":[{"overflow-x":K()}],"overflow-y":[{"overflow-y":K()}],overscroll:[{overscroll:q()}],"overscroll-x":[{"overscroll-x":q()}],"overscroll-y":[{"overscroll-y":q()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Qc,nr]}],basis:[{basis:z()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",nr]}],grow:[{grow:S()}],shrink:[{shrink:S()}],order:[{order:["first","last","none",Qc,nr]}],"grid-cols":[{"grid-cols":[eu]}],"col-start-end":[{col:["auto",{span:["full",Qc,nr]},nr]}],"col-start":[{"col-start":M()}],"col-end":[{"col-end":M()}],"grid-rows":[{"grid-rows":[eu]}],"row-start-end":[{row:["auto",{span:[Qc,nr]},nr]}],"row-start":[{"row-start":M()}],"row-end":[{"row-end":M()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",nr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",nr]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...A()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...A(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...A(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[H]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[H]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",nr,r]}],"min-w":[{"min-w":[nr,r,"min","max","fit"]}],"max-w":[{"max-w":[nr,r,"none","full","min","max","fit","prose",{screen:[Bi]},Bi]}],h:[{h:[nr,r,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[nr,r,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[nr,r,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[nr,r,"auto","min","max","fit"]}],"font-size":[{text:["base",Bi,Li]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",rp]}],"font-family":[{font:[eu]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",nr]}],"line-clamp":[{"line-clamp":["none",Vl,rp]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Zs,nr]}],"list-image":[{"list-image":["none",nr]}],"list-style-type":[{list:["none","disc","decimal",nr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...w(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Zs,Li]}],"underline-offset":[{"underline-offset":["auto",Zs,nr]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:W()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",nr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",nr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...C(),$8]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",z8]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},H8]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...w(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:w()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...w()]}],"outline-offset":[{"outline-offset":[Zs,nr]}],"outline-w":[{outline:[Zs,Li]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:D()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Zs,Li]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Bi,q8]}],"shadow-color":[{shadow:[eu]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...T(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":T()}],filter:[{filter:["","none"]}],blur:[{blur:[e]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Bi,nr]}],grayscale:[{grayscale:[i]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[p]}],saturate:[{saturate:[E]}],sepia:[{sepia:[I]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[e]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[i]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[p]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[E]}],"backdrop-sepia":[{"backdrop-sepia":[I]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",nr]}],duration:[{duration:B()}],ease:[{ease:["linear","in","out","in-out",nr]}],delay:[{delay:B()}],animate:[{animate:["none","spin","ping","pulse","bounce",nr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[Qc,nr]}],"translate-x":[{"translate-x":[V]}],"translate-y":[{"translate-y":[V]}],"skew-x":[{"skew-x":[L]}],"skew-y":[{"skew-y":[L]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",nr]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",nr]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":W()}],"scroll-mx":[{"scroll-mx":W()}],"scroll-my":[{"scroll-my":W()}],"scroll-ms":[{"scroll-ms":W()}],"scroll-me":[{"scroll-me":W()}],"scroll-mt":[{"scroll-mt":W()}],"scroll-mr":[{"scroll-mr":W()}],"scroll-mb":[{"scroll-mb":W()}],"scroll-ml":[{"scroll-ml":W()}],"scroll-p":[{"scroll-p":W()}],"scroll-px":[{"scroll-px":W()}],"scroll-py":[{"scroll-py":W()}],"scroll-ps":[{"scroll-ps":W()}],"scroll-pe":[{"scroll-pe":W()}],"scroll-pt":[{"scroll-pt":W()}],"scroll-pr":[{"scroll-pr":W()}],"scroll-pb":[{"scroll-pb":W()}],"scroll-pl":[{"scroll-pl":W()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",nr]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Zs,Li,rp]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},K8=j8(X8);function At(...t){return K8(by(t))}const Dt=ye.forwardRef(({className:t,...r},e)=>k.jsx("div",{ref:e,className:At("rounded-xl border bg-card text-card-foreground shadow dark:shadow-[0_0_15px_-3px_rgba(255,255,255,0.05)]",t),...r}));Dt.displayName="Card";const Rt=ye.forwardRef(({className:t,...r},e)=>k.jsx("div",{ref:e,className:At("flex flex-col space-y-1.5 p-6",t),...r}));Rt.displayName="CardHeader";const Ft=ye.forwardRef(({className:t,...r},e)=>k.jsx("div",{ref:e,className:At("font-semibold leading-none tracking-tight",t),...r}));Ft.displayName="CardTitle";const Vr=ye.forwardRef(({className:t,...r},e)=>k.jsx("div",{ref:e,className:At("text-sm text-muted-foreground",t),...r}));Vr.displayName="CardDescription";const Mt=ye.forwardRef(({className:t,...r},e)=>k.jsx("div",{ref:e,className:At("p-6 pt-0",t),...r}));Mt.displayName="CardContent";const Cy=ye.forwardRef(({className:t,...r},e)=>k.jsx("div",{ref:e,className:At("flex items-center p-6 pt-0",t),...r}));Cy.displayName="CardFooter";function as({title:t,value:r,description:e,icon:n,trend:a,trendValue:o}){return k.jsxs(Dt,{children:[k.jsxs(Rt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[k.jsx(Ft,{className:"text-sm font-medium",children:t}),k.jsx(n,{className:"h-4 w-4 text-muted-foreground"})]}),k.jsxs(Mt,{children:[k.jsx("div",{className:"text-2xl font-bold",children:r}),(e||o)&&k.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[a==="up"&&k.jsxs("span",{className:"text-green-500 mr-1",children:[" ",o]}),a==="down"&&k.jsxs("span",{className:"text-red-500 mr-1",children:[" ",o]}),e]})]})]})}const Wb=t=>{let r;const e=new Set,n=(i,u)=>{const p=typeof i=="function"?i(r):i;if(!Object.is(p,r)){const f=r;r=u??(typeof p!="object"||p===null)?p:Object.assign({},r,p),e.forEach(h=>h(r,f))}},a=()=>r,l={setState:n,getState:a,getInitialState:()=>c,subscribe:i=>(e.add(i),()=>e.delete(i))},c=r=t(n,a,l);return l},Z8=t=>t?Wb(t):Wb,J8=t=>t;function Q8(t,r=J8){const e=Ke.useSyncExternalStore(t.subscribe,Ke.useCallback(()=>r(t.getState()),[t,r]),Ke.useCallback(()=>r(t.getInitialState()),[t,r]));return Ke.useDebugValue(e),e}const Gb=t=>{const r=Z8(t),e=n=>Q8(r,n);return Object.assign(e,r),e},Ny=t=>t?Gb(t):Gb,eS=()=>{try{const t=localStorage.getItem("auth_user");if(t){const r=JSON.parse(t),e=r._cacheTime||0,a=Date.now()-e,o=24*60*60*1e3;if(a<o){const{_cacheTime:s,...l}=r;return l}else localStorage.removeItem("auth_user")}}catch(t){console.warn(" Erro ao carregar usurio do localStorage:",t),localStorage.removeItem("auth_user")}return null},Dn=Ny(t=>({user:eS(),isLoading:!0,setUser:r=>{if(t({user:r}),r)try{const e={...r,_cacheTime:Date.now()};localStorage.setItem("auth_user",JSON.stringify(e))}catch(e){console.warn(" Erro ao salvar usurio no localStorage:",e)}else localStorage.removeItem("auth_user")},setIsLoading:r=>t({isLoading:r}),logout:async()=>{const{supabase:r}=await f8(async()=>{const{supabase:e}=await Promise.resolve().then(()=>aN);return{supabase:e}},void 0);await r.auth.signOut(),localStorage.removeItem("auth_user"),Object.keys(localStorage).forEach(e=>{e.startsWith("profile_")&&localStorage.removeItem(e)}),t({user:null,isLoading:!1})}})),ec=Ny(t=>({filters:{period:void 0},setFilters:r=>t(e=>({filters:{...e.filters,...r}})),resetFilters:()=>t({filters:{period:void 0}})}));var tS=Symbol.for("react.lazy"),Sf=e8[" use ".trim().toString()];function rS(t){return typeof t=="object"&&t!==null&&"then"in t}function Oy(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===tS&&"_payload"in t&&rS(t._payload)}function gm(t){const r=aS(t),e=ye.forwardRef((n,a)=>{let{children:o,...s}=n;Oy(o)&&typeof Sf=="function"&&(o=Sf(o._payload));const l=ye.Children.toArray(o),c=l.find(iS);if(c){const i=c.props.children,u=l.map(p=>p===c?ye.Children.count(i)>1?ye.Children.only(null):ye.isValidElement(i)?i.props.children:null:p);return k.jsx(r,{...s,ref:a,children:ye.isValidElement(i)?ye.cloneElement(i,void 0,u):null})}return k.jsx(r,{...s,ref:a,children:o})});return e.displayName=`${t}.Slot`,e}var nS=gm("Slot");function aS(t){const r=ye.forwardRef((e,n)=>{let{children:a,...o}=e;if(Oy(a)&&typeof Sf=="function"&&(a=Sf(a._payload)),ye.isValidElement(a)){const s=lS(a),l=oS(o,a.props);return a.type!==ye.Fragment&&(l.ref=n?ry(n,s):s),ye.cloneElement(a,l)}return ye.Children.count(a)>1?ye.Children.only(null):null});return r.displayName=`${t}.SlotClone`,r}var sS=Symbol("radix.slottable");function iS(t){return ye.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===sS}function oS(t,r){const e={...r};for(const n in r){const a=t[n],o=r[n];/^on[A-Z]/.test(n)?a&&o?e[n]=(...l)=>{const c=o(...l);return a(...l),c}:a&&(e[n]=a):n==="style"?e[n]={...a,...o}:n==="className"&&(e[n]=[a,o].filter(Boolean).join(" "))}return{...t,...e}}function lS(t){var n,a;let r=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,e=r&&"isReactWarning"in r&&r.isReactWarning;return e?t.ref:(r=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,e=r&&"isReactWarning"in r&&r.isReactWarning,e?t.props.ref:t.props.ref||t.ref)}const Yb=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Xb=by,$f=(t,r)=>e=>{var n;if((r==null?void 0:r.variants)==null)return Xb(t,e==null?void 0:e.class,e==null?void 0:e.className);const{variants:a,defaultVariants:o}=r,s=Object.keys(a).map(i=>{const u=e==null?void 0:e[i],p=o==null?void 0:o[i];if(u===null)return null;const f=Yb(u)||Yb(p);return a[i][f]}),l=e&&Object.entries(e).reduce((i,u)=>{let[p,f]=u;return f===void 0||(i[p]=f),i},{}),c=r==null||(n=r.compoundVariants)===null||n===void 0?void 0:n.reduce((i,u)=>{let{class:p,className:f,...h}=u;return Object.entries(h).every(v=>{let[b,g]=v;return Array.isArray(g)?g.includes({...o,...l}[b]):{...o,...l}[b]===g})?[...i,p,f]:i},[]);return Xb(t,s,c,e==null?void 0:e.class,e==null?void 0:e.className)},jp=$f("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Nt=ye.forwardRef(({className:t,variant:r,size:e,asChild:n=!1,...a},o)=>{const s=n?nS:"button";return k.jsx(s,{className:At(jp({variant:r,size:e,className:t})),ref:o,...a})});Nt.displayName="Button";const wr=ye.forwardRef(({className:t,type:r,...e},n)=>k.jsx("input",{type:r,className:At("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:n,...e}));wr.displayName="Input";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),uS=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(r,e,n)=>n?n.toUpperCase():e.toLowerCase()),Kb=t=>{const r=uS(t);return r.charAt(0).toUpperCase()+r.slice(1)},jy=(...t)=>t.filter((r,e,n)=>!!r&&r.trim()!==""&&n.indexOf(r)===e).join(" ").trim(),dS=t=>{for(const r in t)if(r.startsWith("aria-")||r==="role"||r==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var fS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hS=ye.forwardRef(({color:t="currentColor",size:r=24,strokeWidth:e=2,absoluteStrokeWidth:n,className:a="",children:o,iconNode:s,...l},c)=>ye.createElement("svg",{ref:c,...fS,width:r,height:r,stroke:t,strokeWidth:n?Number(e)*24/Number(r):e,className:jy("lucide",a),...!o&&!dS(l)&&{"aria-hidden":"true"},...l},[...s.map(([i,u])=>ye.createElement(i,u)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=(t,r)=>{const e=ye.forwardRef(({className:n,...a},o)=>ye.createElement(hS,{ref:o,iconNode:r,className:jy(`lucide-${cS(Kb(t))}`,`lucide-${t}`,n),...a}));return e.displayName=Kb(t),e};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],Dy=Gt("arrow-down",pS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mS=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],My=Gt("arrow-up-down",mS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gS=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],Ry=Gt("arrow-up",gS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],bS=Gt("calendar",vS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xS=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Zb=Gt("chart-column",xS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],wS=Gt("check",yS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _S=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Uu=Gt("chevron-down",_S);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SS=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],yu=Gt("chevron-left",SS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kS=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],wu=Gt("chevron-right",kS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ES=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Fy=Gt("chevron-up",ES);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Iy=Gt("circle-alert",TS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ao=Gt("circle-x",AS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CS=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],NS=Gt("cloud-upload",CS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OS=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Dp=Gt("dollar-sign",OS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]],DS=Gt("file-chart-column-increasing",jS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],RS=Gt("file-spreadsheet",MS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Jb=Gt("file-text",FS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IS=[["path",{d:"M12.531 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14v6a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341l.427-.473",key:"ol2ft2"}],["path",{d:"m16.5 3.5 5 5",key:"15e6fa"}],["path",{d:"m21.5 3.5-5 5",key:"m0lwru"}]],PS=Gt("funnel-x",IS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LS=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],BS=Gt("history",LS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const US=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Qb=Gt("info",US);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zS=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],$S=Gt("layers",zS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VS=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],ex=Gt("layout-dashboard",VS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HS=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],oi=Gt("loader-circle",HS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qS=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Mp=Gt("log-out",qS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WS=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],GS=Gt("mail",WS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YS=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Rp=Gt("map-pin",YS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XS=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],KS=Gt("menu",XS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZS=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],tx=Gt("moon",ZS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JS=[["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}],["path",{d:"m17 13 5 5m-5 0 5-5",key:"im3w4b"}]],Ul=Gt("package-x",JS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QS=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],ek=Gt("package",QS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tk=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],rx=Gt("pen",tk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rk=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],tu=Gt("plus",rk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nk=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],Py=Gt("refresh-ccw",nk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ak=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],vm=Gt("refresh-cw",ak);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sk=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ik=Gt("save",sk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ok=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],lk=Gt("search",ok);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ck=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],uk=Gt("settings",ck);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dk=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Fp=Gt("share-2",dk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fk=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],nx=Gt("shield",fk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hk=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],_f=Gt("square-check-big",hk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pk=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ax=Gt("square-pen",pk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mk=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],sx=Gt("square",mk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gk=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],ix=Gt("sun",gk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vk=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Pa=Gt("trash-2",vk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bk=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],ox=Gt("trending-down",bk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xk=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],_u=Gt("trending-up",xk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yk=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Rl=Gt("triangle-alert",yk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wk=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ip=Gt("user",wk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _k=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Vf=Gt("x",_k),La=k5,Ba=E5,ga=ye.forwardRef(({className:t,children:r,...e},n)=>k.jsxs(ny,{ref:n,className:At("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...e,children:[r,k.jsx(x5,{asChild:!0,children:k.jsx(Uu,{className:"h-4 w-4 opacity-50"})})]}));ga.displayName=ny.displayName;const Ly=ye.forwardRef(({className:t,...r},e)=>k.jsx(ay,{ref:e,className:At("flex cursor-default items-center justify-center py-1",t),...r,children:k.jsx(Fy,{className:"h-4 w-4"})}));Ly.displayName=ay.displayName;const By=ye.forwardRef(({className:t,...r},e)=>k.jsx(sy,{ref:e,className:At("flex cursor-default items-center justify-center py-1",t),...r,children:k.jsx(Uu,{className:"h-4 w-4"})}));By.displayName=sy.displayName;const va=ye.forwardRef(({className:t,children:r,position:e="popper",...n},a)=>k.jsx(y5,{children:k.jsxs(iy,{ref:a,className:At("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",e==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:e,...n,children:[k.jsx(Ly,{}),k.jsx(w5,{className:At("p-1",e==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),k.jsx(By,{})]})}));va.displayName=iy.displayName;const Sk=ye.forwardRef(({className:t,...r},e)=>k.jsx(oy,{ref:e,className:At("px-2 py-1.5 text-sm font-semibold",t),...r}));Sk.displayName=oy.displayName;const sr=ye.forwardRef(({className:t,children:r,...e},n)=>k.jsxs(ly,{ref:n,className:At("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...e,children:[k.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:k.jsx(_5,{children:k.jsx(wS,{className:"h-4 w-4"})})}),k.jsx(S5,{children:r})]}));sr.displayName=ly.displayName;const kk=ye.forwardRef(({className:t,...r},e)=>k.jsx(cy,{ref:e,className:At("-mx-1 my-1 h-px bg-muted",t),...r}));kk.displayName=cy.displayName;var bm="Popper",[Uy,zy]=Uf(bm),[Ek,$y]=Uy(bm),Vy=t=>{const{__scopePopper:r,children:e}=t,[n,a]=ye.useState(null);return k.jsx(Ek,{scope:r,anchor:n,onAnchorChange:a,children:e})};Vy.displayName=bm;var Hy="PopperAnchor",qy=ye.forwardRef((t,r)=>{const{__scopePopper:e,virtualRef:n,...a}=t,o=$y(Hy,e),s=ye.useRef(null),l=Bu(r,s),c=ye.useRef(null);return ye.useEffect(()=>{const i=c.current;c.current=(n==null?void 0:n.current)||s.current,i!==c.current&&o.onAnchorChange(c.current)}),n?null:k.jsx(Ms.div,{...a,ref:l})});qy.displayName=Hy;var xm="PopperContent",[Tk,Ak]=Uy(xm),Wy=ye.forwardRef((t,r)=>{var Q,P,F,Z,se,re;const{__scopePopper:e,side:n="bottom",sideOffset:a=0,align:o="center",alignOffset:s=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:i=[],collisionPadding:u=0,sticky:p="partial",hideWhenDetached:f=!1,updatePositionStrategy:h="optimized",onPlaced:v,...b}=t,g=$y(xm,e),[x,y]=ye.useState(null),E=Bu(r,ae=>y(ae)),[N,I]=ye.useState(null),L=T5(N),H=(L==null?void 0:L.width)??0,V=(L==null?void 0:L.height)??0,q=n+(o!=="center"?"-"+o:""),K=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},z=Array.isArray(i)?i:[i],W=z.length>0,D={padding:K,boundary:z.filter(Nk),altBoundary:W},{refs:M,floatingStyles:C,placement:w,isPositioned:T,middlewareData:A}=A5({strategy:"fixed",placement:q,whileElementsMounted:(...ae)=>F5(...ae,{animationFrame:h==="always"}),elements:{reference:g.anchor},middleware:[C5({mainAxis:a+V,alignmentAxis:s}),c&&N5({mainAxis:!0,crossAxis:!1,limiter:p==="partial"?R5():void 0,...D}),c&&O5({...D}),j5({...D,apply:({elements:ae,rects:te,availableWidth:he,availableHeight:le})=>{const{width:ne,height:de}=te.reference,fe=ae.floating.style;fe.setProperty("--radix-popper-available-width",`${he}px`),fe.setProperty("--radix-popper-available-height",`${le}px`),fe.setProperty("--radix-popper-anchor-width",`${ne}px`),fe.setProperty("--radix-popper-anchor-height",`${de}px`)}}),N&&D5({element:N,padding:l}),Ok({arrowWidth:H,arrowHeight:V}),f&&M5({strategy:"referenceHidden",...D})]}),[S,j]=Xy(w),B=dm(v);xu(()=>{T&&(B==null||B())},[T,B]);const R=(Q=A.arrow)==null?void 0:Q.x,X=(P=A.arrow)==null?void 0:P.y,Y=((F=A.arrow)==null?void 0:F.centerOffset)!==0,[ee,U]=ye.useState();return xu(()=>{x&&U(window.getComputedStyle(x).zIndex)},[x]),k.jsx("div",{ref:M.setFloating,"data-radix-popper-content-wrapper":"",style:{...C,transform:T?C.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ee,"--radix-popper-transform-origin":[(Z=A.transformOrigin)==null?void 0:Z.x,(se=A.transformOrigin)==null?void 0:se.y].join(" "),...((re=A.hide)==null?void 0:re.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:k.jsx(Tk,{scope:e,placedSide:S,onArrowChange:I,arrowX:R,arrowY:X,shouldHideArrow:Y,children:k.jsx(Ms.div,{"data-side":S,"data-align":j,...b,ref:E,style:{...b.style,animation:T?void 0:"none"}})})})});Wy.displayName=xm;var Gy="PopperArrow",Ck={top:"bottom",right:"left",bottom:"top",left:"right"},Yy=ye.forwardRef(function(r,e){const{__scopePopper:n,...a}=r,o=Ak(Gy,n),s=Ck[o.placedSide];return k.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:k.jsx(I5,{...a,ref:e,style:{...a.style,display:"block"}})})});Yy.displayName=Gy;function Nk(t){return t!==null}var Ok=t=>({name:"transformOrigin",options:t,fn(r){var g,x,y;const{placement:e,rects:n,middlewareData:a}=r,s=((g=a.arrow)==null?void 0:g.centerOffset)!==0,l=s?0:t.arrowWidth,c=s?0:t.arrowHeight,[i,u]=Xy(e),p={start:"0%",center:"50%",end:"100%"}[u],f=(((x=a.arrow)==null?void 0:x.x)??0)+l/2,h=(((y=a.arrow)==null?void 0:y.y)??0)+c/2;let v="",b="";return i==="bottom"?(v=s?p:`${f}px`,b=`${-c}px`):i==="top"?(v=s?p:`${f}px`,b=`${n.floating.height+c}px`):i==="right"?(v=`${-c}px`,b=s?p:`${h}px`):i==="left"&&(v=`${n.floating.width+c}px`,b=s?p:`${h}px`),{data:{x:v,y:b}}}});function Xy(t){const[r,e="center"]=t.split("-");return[r,e]}var jk=Vy,Ky=qy,Dk=Wy,Mk=Yy;function Rk(t){const r=Fk(t),e=ye.forwardRef((n,a)=>{const{children:o,...s}=n,l=ye.Children.toArray(o),c=l.find(Pk);if(c){const i=c.props.children,u=l.map(p=>p===c?ye.Children.count(i)>1?ye.Children.only(null):ye.isValidElement(i)?i.props.children:null:p);return k.jsx(r,{...s,ref:a,children:ye.isValidElement(i)?ye.cloneElement(i,void 0,u):null})}return k.jsx(r,{...s,ref:a,children:o})});return e.displayName=`${t}.Slot`,e}function Fk(t){const r=ye.forwardRef((e,n)=>{const{children:a,...o}=e;if(ye.isValidElement(a)){const s=Bk(a),l=Lk(o,a.props);return a.type!==ye.Fragment&&(l.ref=n?ry(n,s):s),ye.cloneElement(a,l)}return ye.Children.count(a)>1?ye.Children.only(null):null});return r.displayName=`${t}.SlotClone`,r}var Ik=Symbol("radix.slottable");function Pk(t){return ye.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Ik}function Lk(t,r){const e={...r};for(const n in r){const a=t[n],o=r[n];/^on[A-Z]/.test(n)?a&&o?e[n]=(...l)=>{const c=o(...l);return a(...l),c}:a&&(e[n]=a):n==="style"?e[n]={...a,...o}:n==="className"&&(e[n]=[a,o].filter(Boolean).join(" "))}return{...t,...e}}function Bk(t){var n,a;let r=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,e=r&&"isReactWarning"in r&&r.isReactWarning;return e?t.ref:(r=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,e=r&&"isReactWarning"in r&&r.isReactWarning,e?t.props.ref:t.props.ref||t.ref)}var Hf="Popover",[Zy,GB]=Uf(Hf,[zy]),zu=zy(),[Uk,ro]=Zy(Hf),Jy=t=>{const{__scopePopover:r,children:e,open:n,defaultOpen:a,onOpenChange:o,modal:s=!1}=t,l=zu(r),c=ye.useRef(null),[i,u]=ye.useState(!1),[p,f]=hm({prop:n,defaultProp:a??!1,onChange:o,caller:Hf});return k.jsx(jk,{...l,children:k.jsx(Uk,{scope:r,contentId:pm(),triggerRef:c,open:p,onOpenChange:f,onOpenToggle:ye.useCallback(()=>f(h=>!h),[f]),hasCustomAnchor:i,onCustomAnchorAdd:ye.useCallback(()=>u(!0),[]),onCustomAnchorRemove:ye.useCallback(()=>u(!1),[]),modal:s,children:e})})};Jy.displayName=Hf;var Qy="PopoverAnchor",zk=ye.forwardRef((t,r)=>{const{__scopePopover:e,...n}=t,a=ro(Qy,e),o=zu(e),{onCustomAnchorAdd:s,onCustomAnchorRemove:l}=a;return ye.useEffect(()=>(s(),()=>l()),[s,l]),k.jsx(Ky,{...o,...n,ref:r})});zk.displayName=Qy;var ew="PopoverTrigger",tw=ye.forwardRef((t,r)=>{const{__scopePopover:e,...n}=t,a=ro(ew,e),o=zu(e),s=Bu(r,a.triggerRef),l=k.jsx(Ms.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":iw(a.open),...n,ref:s,onClick:ia(t.onClick,a.onOpenToggle)});return a.hasCustomAnchor?l:k.jsx(Ky,{asChild:!0,...o,children:l})});tw.displayName=ew;var ym="PopoverPortal",[$k,Vk]=Zy(ym,{forceMount:void 0}),rw=t=>{const{__scopePopover:r,forceMount:e,children:n,container:a}=t,o=ro(ym,r);return k.jsx($k,{scope:r,forceMount:e,children:k.jsx(fm,{present:e||o.open,children:k.jsx(P5,{asChild:!0,container:a,children:n})})})};rw.displayName=ym;var Kl="PopoverContent",nw=ye.forwardRef((t,r)=>{const e=Vk(Kl,t.__scopePopover),{forceMount:n=e.forceMount,...a}=t,o=ro(Kl,t.__scopePopover);return k.jsx(fm,{present:n||o.open,children:o.modal?k.jsx(qk,{...a,ref:r}):k.jsx(Wk,{...a,ref:r})})});nw.displayName=Kl;var Hk=Rk("PopoverContent.RemoveScroll"),qk=ye.forwardRef((t,r)=>{const e=ro(Kl,t.__scopePopover),n=ye.useRef(null),a=Bu(r,n),o=ye.useRef(!1);return ye.useEffect(()=>{const s=n.current;if(s)return L5(s)},[]),k.jsx(B5,{as:Hk,allowPinchZoom:!0,children:k.jsx(aw,{...t,ref:a,trapFocus:e.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ia(t.onCloseAutoFocus,s=>{var l;s.preventDefault(),o.current||(l=e.triggerRef.current)==null||l.focus()}),onPointerDownOutside:ia(t.onPointerDownOutside,s=>{const l=s.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,i=l.button===2||c;o.current=i},{checkForDefaultPrevented:!1}),onFocusOutside:ia(t.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1})})})}),Wk=ye.forwardRef((t,r)=>{const e=ro(Kl,t.__scopePopover),n=ye.useRef(!1),a=ye.useRef(!1);return k.jsx(aw,{...t,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var s,l;(s=t.onCloseAutoFocus)==null||s.call(t,o),o.defaultPrevented||(n.current||(l=e.triggerRef.current)==null||l.focus(),o.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:o=>{var c,i;(c=t.onInteractOutside)==null||c.call(t,o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const s=o.target;((i=e.triggerRef.current)==null?void 0:i.contains(s))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),aw=ye.forwardRef((t,r)=>{const{__scopePopover:e,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:s,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:i,onInteractOutside:u,...p}=t,f=ro(Kl,e),h=zu(e);return U5(),k.jsx(z5,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:o,children:k.jsx($5,{asChild:!0,disableOutsidePointerEvents:s,onInteractOutside:u,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:i,onDismiss:()=>f.onOpenChange(!1),children:k.jsx(Dk,{"data-state":iw(f.open),role:"dialog",id:f.contentId,...h,...p,ref:r,style:{...p.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),sw="PopoverClose",Gk=ye.forwardRef((t,r)=>{const{__scopePopover:e,...n}=t,a=ro(sw,e);return k.jsx(Ms.button,{type:"button",...n,ref:r,onClick:ia(t.onClick,()=>a.onOpenChange(!1))})});Gk.displayName=sw;var Yk="PopoverArrow",Xk=ye.forwardRef((t,r)=>{const{__scopePopover:e,...n}=t,a=zu(e);return k.jsx(Mk,{...a,...n,ref:r})});Xk.displayName=Yk;function iw(t){return t?"open":"closed"}var Kk=Jy,Zk=tw,Jk=rw,ow=nw;const Qk=Kk,eE=Zk,lw=ye.forwardRef(({className:t,align:r="center",sideOffset:e=4,...n},a)=>k.jsx(Jk,{children:k.jsx(ow,{ref:a,align:r,sideOffset:e,className:At("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",t),...n})}));lw.displayName=ow.displayName;function tE(t,r,e="long"){return new Intl.DateTimeFormat("en-US",{hour:"numeric",timeZone:t,timeZoneName:e}).format(r).split(/\s/g).slice(2).join(" ")}const np={},ru={};function Mo(t,r){try{const n=(np[t]||(np[t]=new Intl.DateTimeFormat("en-US",{timeZone:t,timeZoneName:"longOffset"}).format))(r).split("GMT")[1];return n in ru?ru[n]:lx(n,n.split(":"))}catch{if(t in ru)return ru[t];const e=t==null?void 0:t.match(rE);return e?lx(t,e.slice(1)):NaN}}const rE=/([+-]\d\d):?(\d\d)?/;function lx(t,r){const e=+(r[0]||0),n=+(r[1]||0),a=+(r[2]||0)/60;return ru[t]=e*60+n>0?e*60+n+a:e*60-n-a}class Ts extends Date{constructor(...r){super(),r.length>1&&typeof r[r.length-1]=="string"&&(this.timeZone=r.pop()),this.internal=new Date,isNaN(Mo(this.timeZone,this))?this.setTime(NaN):r.length?typeof r[0]=="number"&&(r.length===1||r.length===2&&typeof r[1]!="number")?this.setTime(r[0]):typeof r[0]=="string"?this.setTime(+new Date(r[0])):r[0]instanceof Date?this.setTime(+r[0]):(this.setTime(+new Date(...r)),cw(this),Pp(this)):this.setTime(Date.now())}static tz(r,...e){return e.length?new Ts(...e,r):new Ts(Date.now(),r)}withTimeZone(r){return new Ts(+this,r)}getTimezoneOffset(){const r=-Mo(this.timeZone,this);return r>0?Math.floor(r):Math.ceil(r)}setTime(r){return Date.prototype.setTime.apply(this,arguments),Pp(this),+this}[Symbol.for("constructDateFrom")](r){return new Ts(+new Date(r),this.timeZone)}}const cx=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(t=>{if(!cx.test(t))return;const r=t.replace(cx,"$1UTC");Ts.prototype[r]&&(t.startsWith("get")?Ts.prototype[t]=function(){return this.internal[r]()}:(Ts.prototype[t]=function(){return Date.prototype[r].apply(this.internal,arguments),nE(this),+this},Ts.prototype[r]=function(){return Date.prototype[r].apply(this,arguments),Pp(this),+this}))});function Pp(t){t.internal.setTime(+t),t.internal.setUTCSeconds(t.internal.getUTCSeconds()-Math.round(-Mo(t.timeZone,t)*60))}function nE(t){Date.prototype.setFullYear.call(t,t.internal.getUTCFullYear(),t.internal.getUTCMonth(),t.internal.getUTCDate()),Date.prototype.setHours.call(t,t.internal.getUTCHours(),t.internal.getUTCMinutes(),t.internal.getUTCSeconds(),t.internal.getUTCMilliseconds()),cw(t)}function cw(t){const r=Mo(t.timeZone,t),e=r>0?Math.floor(r):Math.ceil(r),n=new Date(+t);n.setUTCHours(n.getUTCHours()-1);const a=-new Date(+t).getTimezoneOffset(),o=-new Date(+n).getTimezoneOffset(),s=a-o,l=Date.prototype.getHours.apply(t)!==t.internal.getUTCHours();s&&l&&t.internal.setUTCMinutes(t.internal.getUTCMinutes()+s);const c=a-e;c&&Date.prototype.setUTCMinutes.call(t,Date.prototype.getUTCMinutes.call(t)+c);const i=new Date(+t);i.setUTCSeconds(0);const u=a>0?i.getSeconds():(i.getSeconds()-60)%60,p=Math.round(-(Mo(t.timeZone,t)*60))%60;(p||u)&&(t.internal.setUTCSeconds(t.internal.getUTCSeconds()+p),Date.prototype.setUTCSeconds.call(t,Date.prototype.getUTCSeconds.call(t)+p+u));const f=Mo(t.timeZone,t),h=f>0?Math.floor(f):Math.ceil(f),b=-new Date(+t).getTimezoneOffset()-h,g=h!==e,x=b-c;if(g&&x){Date.prototype.setUTCMinutes.call(t,Date.prototype.getUTCMinutes.call(t)+x);const y=Mo(t.timeZone,t),E=y>0?Math.floor(y):Math.ceil(y),N=h-E;N&&(t.internal.setUTCMinutes(t.internal.getUTCMinutes()+N),Date.prototype.setUTCMinutes.call(t,Date.prototype.getUTCMinutes.call(t)+N))}}class Ln extends Ts{static tz(r,...e){return e.length?new Ln(...e,r):new Ln(Date.now(),r)}toISOString(){const[r,e,n]=this.tzComponents(),a=`${r}${e}:${n}`;return this.internal.toISOString().slice(0,-1)+a}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[r,e,n,a]=this.internal.toUTCString().split(" ");return`${r==null?void 0:r.slice(0,-1)} ${n} ${e} ${a}`}toTimeString(){const r=this.internal.toUTCString().split(" ")[4],[e,n,a]=this.tzComponents();return`${r} GMT${e}${n}${a} (${tE(this.timeZone,this)})`}toLocaleString(r,e){return Date.prototype.toLocaleString.call(this,r,{...e,timeZone:(e==null?void 0:e.timeZone)||this.timeZone})}toLocaleDateString(r,e){return Date.prototype.toLocaleDateString.call(this,r,{...e,timeZone:(e==null?void 0:e.timeZone)||this.timeZone})}toLocaleTimeString(r,e){return Date.prototype.toLocaleTimeString.call(this,r,{...e,timeZone:(e==null?void 0:e.timeZone)||this.timeZone})}tzComponents(){const r=this.getTimezoneOffset(),e=r>0?"-":"+",n=String(Math.floor(Math.abs(r)/60)).padStart(2,"0"),a=String(Math.abs(r)%60).padStart(2,"0");return[e,n,a]}withTimeZone(r){return new Ln(+this,r)}[Symbol.for("constructDateFrom")](r){return new Ln(+new Date(r),this.timeZone)}}const uw=6048e5,aE=864e5,ux=Symbol.for("constructDateFrom");function fn(t,r){return typeof t=="function"?t(r):t&&typeof t=="object"&&ux in t?t[ux](r):t instanceof Date?new t.constructor(r):new Date(r)}function yr(t,r){return fn(r||t,t)}function wm(t,r,e){const n=yr(t,e==null?void 0:e.in);return isNaN(r)?fn(t,NaN):(r&&n.setDate(n.getDate()+r),n)}function _m(t,r,e){const n=yr(t,e==null?void 0:e.in);if(isNaN(r))return fn(t,NaN);if(!r)return n;const a=n.getDate(),o=fn(t,n.getTime());o.setMonth(n.getMonth()+r+1,0);const s=o.getDate();return a>=s?o:(n.setFullYear(o.getFullYear(),o.getMonth(),a),n)}let sE={};function $u(){return sE}function Ji(t,r){var l,c,i,u;const e=$u(),n=(r==null?void 0:r.weekStartsOn)??((c=(l=r==null?void 0:r.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??e.weekStartsOn??((u=(i=e.locale)==null?void 0:i.options)==null?void 0:u.weekStartsOn)??0,a=yr(t,r==null?void 0:r.in),o=a.getDay(),s=(o<n?7:0)+o-n;return a.setDate(a.getDate()-s),a.setHours(0,0,0,0),a}function Su(t,r){return Ji(t,{...r,weekStartsOn:1})}function dw(t,r){const e=yr(t,r==null?void 0:r.in),n=e.getFullYear(),a=fn(e,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const o=Su(a),s=fn(e,0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);const l=Su(s);return e.getTime()>=o.getTime()?n+1:e.getTime()>=l.getTime()?n:n-1}function dx(t){const r=yr(t),e=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return e.setUTCFullYear(r.getFullYear()),+t-+e}function tc(t,...r){const e=fn.bind(null,r.find(n=>typeof n=="object"));return r.map(e)}function Ki(t,r){const e=yr(t,r==null?void 0:r.in);return e.setHours(0,0,0,0),e}function Sm(t,r,e){const[n,a]=tc(e==null?void 0:e.in,t,r),o=Ki(n),s=Ki(a),l=+o-dx(o),c=+s-dx(s);return Math.round((l-c)/aE)}function iE(t,r){const e=dw(t,r),n=fn(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),Su(n)}function fw(t,r,e){return wm(t,r*7,e)}function oE(t,r,e){return _m(t,r*12,e)}function lE(t,r){let e,n=r==null?void 0:r.in;return t.forEach(a=>{!n&&typeof a=="object"&&(n=fn.bind(null,a));const o=yr(a,n);(!e||e<o||isNaN(+o))&&(e=o)}),fn(n,e||NaN)}function cE(t,r){let e,n=r==null?void 0:r.in;return t.forEach(a=>{!n&&typeof a=="object"&&(n=fn.bind(null,a));const o=yr(a,n);(!e||e>o||isNaN(+o))&&(e=o)}),fn(n,e||NaN)}function uE(t,r,e){const[n,a]=tc(e==null?void 0:e.in,t,r);return+Ki(n)==+Ki(a)}function hw(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function dE(t){return!(!hw(t)&&typeof t!="number"||isNaN(+yr(t)))}function pw(t,r,e){const[n,a]=tc(e==null?void 0:e.in,t,r),o=n.getFullYear()-a.getFullYear(),s=n.getMonth()-a.getMonth();return o*12+s}function ap(t,r){const e=yr(t,r==null?void 0:r.in);return e.setHours(23,59,59,999),e}function Lp(t,r){const e=yr(t,r==null?void 0:r.in),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function mw(t,r){const[e,n]=tc(t,r.start,r.end);return{start:e,end:n}}function fE(t,r){const{start:e,end:n}=mw(r==null?void 0:r.in,t);let a=+e>+n;const o=a?+e:+n,s=a?n:e;s.setHours(0,0,0,0),s.setDate(1);let l=1;const c=[];for(;+s<=o;)c.push(fn(e,s)),s.setMonth(s.getMonth()+l);return a?c.reverse():c}function hE(t,r){const e=yr(t,r==null?void 0:r.in),n=e.getMonth(),a=n-n%3;return e.setMonth(a,1),e.setHours(0,0,0,0),e}function Bp(t,r){const e=yr(t,r==null?void 0:r.in);return e.setDate(1),e.setHours(0,0,0,0),e}function Up(t,r){const e=yr(t,r==null?void 0:r.in),n=e.getFullYear();return e.setFullYear(n+1,0,0),e.setHours(23,59,59,999),e}function km(t,r){const e=yr(t,r==null?void 0:r.in);return e.setFullYear(e.getFullYear(),0,1),e.setHours(0,0,0,0),e}function pE(t,r){const{start:e,end:n}=mw(r==null?void 0:r.in,t);let a=+e>+n;const o=a?+e:+n,s=a?n:e;s.setHours(0,0,0,0),s.setMonth(0,1);let l=1;const c=[];for(;+s<=o;)c.push(fn(e,s)),s.setFullYear(s.getFullYear()+l);return a?c.reverse():c}function kf(t,r){var l,c,i,u;const e=$u(),n=(r==null?void 0:r.weekStartsOn)??((c=(l=r==null?void 0:r.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??e.weekStartsOn??((u=(i=e.locale)==null?void 0:i.options)==null?void 0:u.weekStartsOn)??0,a=yr(t,r==null?void 0:r.in),o=a.getDay(),s=(o<n?-7:0)+6-(o-n);return a.setDate(a.getDate()+s),a.setHours(23,59,59,999),a}function mE(t,r){return kf(t,{...r,weekStartsOn:1})}function gE(t,r){const e=yr(t,r==null?void 0:r.in),n=e.getMonth(),a=n-n%3+3;return e.setMonth(a,0),e.setHours(23,59,59,999),e}const vE={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},bE=(t,r,e)=>{let n;const a=vE[t];return typeof a=="string"?n=a:r===1?n=a.one:n=a.other.replace("{{count}}",r.toString()),e!=null&&e.addSuffix?e.comparison&&e.comparison>0?"in "+n:n+" ago":n};function Hl(t){return(r={})=>{const e=r.width?String(r.width):t.defaultWidth;return t.formats[e]||t.formats[t.defaultWidth]}}const xE={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},yE={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},wE={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},_E={date:Hl({formats:xE,defaultWidth:"full"}),time:Hl({formats:yE,defaultWidth:"full"}),dateTime:Hl({formats:wE,defaultWidth:"full"})},SE={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},kE=(t,r,e,n)=>SE[t];function ks(t){return(r,e)=>{const n=e!=null&&e.context?String(e.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const s=t.defaultFormattingWidth||t.defaultWidth,l=e!=null&&e.width?String(e.width):s;a=t.formattingValues[l]||t.formattingValues[s]}else{const s=t.defaultWidth,l=e!=null&&e.width?String(e.width):t.defaultWidth;a=t.values[l]||t.values[s]}const o=t.argumentCallback?t.argumentCallback(r):r;return a[o]}}const EE={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},TE={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},AE={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},CE={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},NE={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},OE={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},jE=(t,r)=>{const e=Number(t),n=e%100;if(n>20||n<10)switch(n%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"},DE={ordinalNumber:jE,era:ks({values:EE,defaultWidth:"wide"}),quarter:ks({values:TE,defaultWidth:"wide",argumentCallback:t=>t-1}),month:ks({values:AE,defaultWidth:"wide"}),day:ks({values:CE,defaultWidth:"wide"}),dayPeriod:ks({values:NE,defaultWidth:"wide",formattingValues:OE,defaultFormattingWidth:"wide"})};function Es(t){return(r,e={})=>{const n=e.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],o=r.match(a);if(!o)return null;const s=o[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?RE(l,p=>p.test(s)):ME(l,p=>p.test(s));let i;i=t.valueCallback?t.valueCallback(c):c,i=e.valueCallback?e.valueCallback(i):i;const u=r.slice(s.length);return{value:i,rest:u}}}function ME(t,r){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&r(t[e]))return e}function RE(t,r){for(let e=0;e<t.length;e++)if(r(t[e]))return e}function gw(t){return(r,e={})=>{const n=r.match(t.matchPattern);if(!n)return null;const a=n[0],o=r.match(t.parsePattern);if(!o)return null;let s=t.valueCallback?t.valueCallback(o[0]):o[0];s=e.valueCallback?e.valueCallback(s):s;const l=r.slice(a.length);return{value:s,rest:l}}}const FE=/^(\d+)(th|st|nd|rd)?/i,IE=/\d+/i,PE={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},LE={any:[/^b/i,/^(a|c)/i]},BE={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},UE={any:[/1/i,/2/i,/3/i,/4/i]},zE={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},$E={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},VE={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},HE={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},qE={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},WE={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},GE={ordinalNumber:gw({matchPattern:FE,parsePattern:IE,valueCallback:t=>parseInt(t,10)}),era:Es({matchPatterns:PE,defaultMatchWidth:"wide",parsePatterns:LE,defaultParseWidth:"any"}),quarter:Es({matchPatterns:BE,defaultMatchWidth:"wide",parsePatterns:UE,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Es({matchPatterns:zE,defaultMatchWidth:"wide",parsePatterns:$E,defaultParseWidth:"any"}),day:Es({matchPatterns:VE,defaultMatchWidth:"wide",parsePatterns:HE,defaultParseWidth:"any"}),dayPeriod:Es({matchPatterns:qE,defaultMatchWidth:"any",parsePatterns:WE,defaultParseWidth:"any"})},Fl={code:"en-US",formatDistance:bE,formatLong:_E,formatRelative:kE,localize:DE,match:GE,options:{weekStartsOn:0,firstWeekContainsDate:1}};function YE(t,r){const e=yr(t,r==null?void 0:r.in);return Sm(e,km(e))+1}function Em(t,r){const e=yr(t,r==null?void 0:r.in),n=+Su(e)-+iE(e);return Math.round(n/uw)+1}function vw(t,r){var u,p,f,h;const e=yr(t,r==null?void 0:r.in),n=e.getFullYear(),a=$u(),o=(r==null?void 0:r.firstWeekContainsDate)??((p=(u=r==null?void 0:r.locale)==null?void 0:u.options)==null?void 0:p.firstWeekContainsDate)??a.firstWeekContainsDate??((h=(f=a.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,s=fn((r==null?void 0:r.in)||t,0);s.setFullYear(n+1,0,o),s.setHours(0,0,0,0);const l=Ji(s,r),c=fn((r==null?void 0:r.in)||t,0);c.setFullYear(n,0,o),c.setHours(0,0,0,0);const i=Ji(c,r);return+e>=+l?n+1:+e>=+i?n:n-1}function XE(t,r){var l,c,i,u;const e=$u(),n=(r==null?void 0:r.firstWeekContainsDate)??((c=(l=r==null?void 0:r.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??e.firstWeekContainsDate??((u=(i=e.locale)==null?void 0:i.options)==null?void 0:u.firstWeekContainsDate)??1,a=vw(t,r),o=fn((r==null?void 0:r.in)||t,0);return o.setFullYear(a,0,n),o.setHours(0,0,0,0),Ji(o,r)}function Tm(t,r){const e=yr(t,r==null?void 0:r.in),n=+Ji(e,r)-+XE(e,r);return Math.round(n/uw)+1}function kr(t,r){const e=t<0?"-":"",n=Math.abs(t).toString().padStart(r,"0");return e+n}const Ui={y(t,r){const e=t.getFullYear(),n=e>0?e:1-e;return kr(r==="yy"?n%100:n,r.length)},M(t,r){const e=t.getMonth();return r==="M"?String(e+1):kr(e+1,2)},d(t,r){return kr(t.getDate(),r.length)},a(t,r){const e=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return e.toUpperCase();case"aaa":return e;case"aaaaa":return e[0];case"aaaa":default:return e==="am"?"a.m.":"p.m."}},h(t,r){return kr(t.getHours()%12||12,r.length)},H(t,r){return kr(t.getHours(),r.length)},m(t,r){return kr(t.getMinutes(),r.length)},s(t,r){return kr(t.getSeconds(),r.length)},S(t,r){const e=r.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,e-3));return kr(a,r.length)}},Sl={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},fx={G:function(t,r,e){const n=t.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return e.era(n,{width:"abbreviated"});case"GGGGG":return e.era(n,{width:"narrow"});case"GGGG":default:return e.era(n,{width:"wide"})}},y:function(t,r,e){if(r==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return e.ordinalNumber(a,{unit:"year"})}return Ui.y(t,r)},Y:function(t,r,e,n){const a=vw(t,n),o=a>0?a:1-a;if(r==="YY"){const s=o%100;return kr(s,2)}return r==="Yo"?e.ordinalNumber(o,{unit:"year"}):kr(o,r.length)},R:function(t,r){const e=dw(t);return kr(e,r.length)},u:function(t,r){const e=t.getFullYear();return kr(e,r.length)},Q:function(t,r,e){const n=Math.ceil((t.getMonth()+1)/3);switch(r){case"Q":return String(n);case"QQ":return kr(n,2);case"Qo":return e.ordinalNumber(n,{unit:"quarter"});case"QQQ":return e.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return e.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return e.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,r,e){const n=Math.ceil((t.getMonth()+1)/3);switch(r){case"q":return String(n);case"qq":return kr(n,2);case"qo":return e.ordinalNumber(n,{unit:"quarter"});case"qqq":return e.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return e.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return e.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,r,e){const n=t.getMonth();switch(r){case"M":case"MM":return Ui.M(t,r);case"Mo":return e.ordinalNumber(n+1,{unit:"month"});case"MMM":return e.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return e.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return e.month(n,{width:"wide",context:"formatting"})}},L:function(t,r,e){const n=t.getMonth();switch(r){case"L":return String(n+1);case"LL":return kr(n+1,2);case"Lo":return e.ordinalNumber(n+1,{unit:"month"});case"LLL":return e.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return e.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return e.month(n,{width:"wide",context:"standalone"})}},w:function(t,r,e,n){const a=Tm(t,n);return r==="wo"?e.ordinalNumber(a,{unit:"week"}):kr(a,r.length)},I:function(t,r,e){const n=Em(t);return r==="Io"?e.ordinalNumber(n,{unit:"week"}):kr(n,r.length)},d:function(t,r,e){return r==="do"?e.ordinalNumber(t.getDate(),{unit:"date"}):Ui.d(t,r)},D:function(t,r,e){const n=YE(t);return r==="Do"?e.ordinalNumber(n,{unit:"dayOfYear"}):kr(n,r.length)},E:function(t,r,e){const n=t.getDay();switch(r){case"E":case"EE":case"EEE":return e.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return e.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return e.day(n,{width:"short",context:"formatting"});case"EEEE":default:return e.day(n,{width:"wide",context:"formatting"})}},e:function(t,r,e,n){const a=t.getDay(),o=(a-n.weekStartsOn+8)%7||7;switch(r){case"e":return String(o);case"ee":return kr(o,2);case"eo":return e.ordinalNumber(o,{unit:"day"});case"eee":return e.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return e.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return e.day(a,{width:"short",context:"formatting"});case"eeee":default:return e.day(a,{width:"wide",context:"formatting"})}},c:function(t,r,e,n){const a=t.getDay(),o=(a-n.weekStartsOn+8)%7||7;switch(r){case"c":return String(o);case"cc":return kr(o,r.length);case"co":return e.ordinalNumber(o,{unit:"day"});case"ccc":return e.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return e.day(a,{width:"narrow",context:"standalone"});case"cccccc":return e.day(a,{width:"short",context:"standalone"});case"cccc":default:return e.day(a,{width:"wide",context:"standalone"})}},i:function(t,r,e){const n=t.getDay(),a=n===0?7:n;switch(r){case"i":return String(a);case"ii":return kr(a,r.length);case"io":return e.ordinalNumber(a,{unit:"day"});case"iii":return e.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return e.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return e.day(n,{width:"short",context:"formatting"});case"iiii":default:return e.day(n,{width:"wide",context:"formatting"})}},a:function(t,r,e){const a=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return e.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return e.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,r,e){const n=t.getHours();let a;switch(n===12?a=Sl.noon:n===0?a=Sl.midnight:a=n/12>=1?"pm":"am",r){case"b":case"bb":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return e.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return e.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,r,e){const n=t.getHours();let a;switch(n>=17?a=Sl.evening:n>=12?a=Sl.afternoon:n>=4?a=Sl.morning:a=Sl.night,r){case"B":case"BB":case"BBB":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return e.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return e.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,r,e){if(r==="ho"){let n=t.getHours()%12;return n===0&&(n=12),e.ordinalNumber(n,{unit:"hour"})}return Ui.h(t,r)},H:function(t,r,e){return r==="Ho"?e.ordinalNumber(t.getHours(),{unit:"hour"}):Ui.H(t,r)},K:function(t,r,e){const n=t.getHours()%12;return r==="Ko"?e.ordinalNumber(n,{unit:"hour"}):kr(n,r.length)},k:function(t,r,e){let n=t.getHours();return n===0&&(n=24),r==="ko"?e.ordinalNumber(n,{unit:"hour"}):kr(n,r.length)},m:function(t,r,e){return r==="mo"?e.ordinalNumber(t.getMinutes(),{unit:"minute"}):Ui.m(t,r)},s:function(t,r,e){return r==="so"?e.ordinalNumber(t.getSeconds(),{unit:"second"}):Ui.s(t,r)},S:function(t,r){return Ui.S(t,r)},X:function(t,r,e){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(r){case"X":return px(n);case"XXXX":case"XX":return Co(n);case"XXXXX":case"XXX":default:return Co(n,":")}},x:function(t,r,e){const n=t.getTimezoneOffset();switch(r){case"x":return px(n);case"xxxx":case"xx":return Co(n);case"xxxxx":case"xxx":default:return Co(n,":")}},O:function(t,r,e){const n=t.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+hx(n,":");case"OOOO":default:return"GMT"+Co(n,":")}},z:function(t,r,e){const n=t.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+hx(n,":");case"zzzz":default:return"GMT"+Co(n,":")}},t:function(t,r,e){const n=Math.trunc(+t/1e3);return kr(n,r.length)},T:function(t,r,e){return kr(+t,r.length)}};function hx(t,r=""){const e=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),o=n%60;return o===0?e+String(a):e+String(a)+r+kr(o,2)}function px(t,r){return t%60===0?(t>0?"-":"+")+kr(Math.abs(t)/60,2):Co(t,r)}function Co(t,r=""){const e=t>0?"-":"+",n=Math.abs(t),a=kr(Math.trunc(n/60),2),o=kr(n%60,2);return e+a+r+o}const mx=(t,r)=>{switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},bw=(t,r)=>{switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},KE=(t,r)=>{const e=t.match(/(P+)(p+)?/)||[],n=e[1],a=e[2];if(!a)return mx(t,r);let o;switch(n){case"P":o=r.dateTime({width:"short"});break;case"PP":o=r.dateTime({width:"medium"});break;case"PPP":o=r.dateTime({width:"long"});break;case"PPPP":default:o=r.dateTime({width:"full"});break}return o.replace("{{date}}",mx(n,r)).replace("{{time}}",bw(a,r))},ZE={p:bw,P:KE},JE=/^D+$/,QE=/^Y+$/,eT=["D","DD","YY","YYYY"];function tT(t){return JE.test(t)}function rT(t){return QE.test(t)}function nT(t,r,e){const n=aT(t,r,e);if(console.warn(n),eT.includes(t))throw new RangeError(n)}function aT(t,r,e){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${r}\`) for formatting ${n} to the input \`${e}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const sT=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,iT=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,oT=/^'([^]*?)'?$/,lT=/''/g,cT=/[a-zA-Z]/;function Jt(t,r,e){var u,p,f,h,v,b,g,x;const n=$u(),a=(e==null?void 0:e.locale)??n.locale??Fl,o=(e==null?void 0:e.firstWeekContainsDate)??((p=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:p.firstWeekContainsDate)??n.firstWeekContainsDate??((h=(f=n.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,s=(e==null?void 0:e.weekStartsOn)??((b=(v=e==null?void 0:e.locale)==null?void 0:v.options)==null?void 0:b.weekStartsOn)??n.weekStartsOn??((x=(g=n.locale)==null?void 0:g.options)==null?void 0:x.weekStartsOn)??0,l=yr(t,e==null?void 0:e.in);if(!dE(l))throw new RangeError("Invalid time value");let c=r.match(iT).map(y=>{const E=y[0];if(E==="p"||E==="P"){const N=ZE[E];return N(y,a.formatLong)}return y}).join("").match(sT).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const E=y[0];if(E==="'")return{isToken:!1,value:uT(y)};if(fx[E])return{isToken:!0,value:y};if(E.match(cT))throw new RangeError("Format string contains an unescaped latin alphabet character `"+E+"`");return{isToken:!1,value:y}});a.localize.preprocessor&&(c=a.localize.preprocessor(l,c));const i={firstWeekContainsDate:o,weekStartsOn:s,locale:a};return c.map(y=>{if(!y.isToken)return y.value;const E=y.value;(!(e!=null&&e.useAdditionalWeekYearTokens)&&rT(E)||!(e!=null&&e.useAdditionalDayOfYearTokens)&&tT(E))&&nT(E,r,String(t));const N=fx[E[0]];return N(l,E,a.localize,i)}).join("")}function uT(t){const r=t.match(oT);return r?r[1].replace(lT,"'"):t}function dT(t,r){const e=yr(t,r==null?void 0:r.in),n=e.getFullYear(),a=e.getMonth(),o=fn(e,0);return o.setFullYear(n,a+1,0),o.setHours(0,0,0,0),o.getDate()}function fT(t,r){return yr(t,r==null?void 0:r.in).getMonth()}function hT(t,r){return yr(t,r==null?void 0:r.in).getFullYear()}function pT(t,r){return+yr(t)>+yr(r)}function mT(t,r){return+yr(t)<+yr(r)}function gT(t,r,e){const[n,a]=tc(e==null?void 0:e.in,t,r);return n.getFullYear()===a.getFullYear()&&n.getMonth()===a.getMonth()}function vT(t,r,e){const[n,a]=tc(e==null?void 0:e.in,t,r);return n.getFullYear()===a.getFullYear()}function bT(t,r,e){return wm(t,-1,e)}function xT(t,r,e){const n=yr(t,e==null?void 0:e.in),a=n.getFullYear(),o=n.getDate(),s=fn(t,0);s.setFullYear(a,r,15),s.setHours(0,0,0,0);const l=dT(s);return n.setMonth(r,Math.min(o,l)),n}function yT(t,r,e){const n=yr(t,e==null?void 0:e.in);return isNaN(+n)?fn(t,NaN):(n.setFullYear(r),n)}function wT(t,r,e){return _m(t,-1,e)}function _T(t,r,e){return fw(t,-1,e)}const gx=5,ST=4;function kT(t,r){const e=r.startOfMonth(t),n=e.getDay()>0?e.getDay():7,a=r.addDays(t,-n+1),o=r.addDays(a,gx*7-1);return r.getMonth(t)===r.getMonth(o)?gx:ST}function xw(t,r){const e=r.startOfMonth(t),n=e.getDay();return n===1?e:n===0?r.addDays(e,-1*6):r.addDays(e,-1*(n-1))}function ET(t,r){const e=xw(t,r),n=kT(t,r);return r.addDays(e,n*7-1)}const TT={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 ms",other:"cerca de {{count}} meses"},xMonths:{one:"1 ms",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},AT=(t,r,e)=>{let n;const a=TT[t];return typeof a=="string"?n=a:r===1?n=a.one:n=a.other.replace("{{count}}",String(r)),e!=null&&e.addSuffix?e.comparison&&e.comparison>0?"em "+n:"h "+n:n},CT={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},NT={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},OT={full:"{{date}} 's' {{time}}",long:"{{date}} 's' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},jT={date:Hl({formats:CT,defaultWidth:"full"}),time:Hl({formats:NT,defaultWidth:"full"}),dateTime:Hl({formats:OT,defaultWidth:"full"})},DT={lastWeek:t=>{const r=t.getDay();return"'"+(r===0||r===6?"ltimo":"ltima")+"' eeee 's' p"},yesterday:"'ontem s' p",today:"'hoje s' p",tomorrow:"'amanh s' p",nextWeek:"eeee 's' p",other:"P"},MT=(t,r,e,n)=>{const a=DT[t];return typeof a=="function"?a(r):a},RT={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},FT={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},IT={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},PT={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","tera","quarta","quinta","sexta","sbado"],wide:["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"]},LT={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"}},BT={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},UT=(t,r)=>{const e=Number(t);return(r==null?void 0:r.unit)==="week"?e+"":e+""},zT={ordinalNumber:UT,era:ks({values:RT,defaultWidth:"wide"}),quarter:ks({values:FT,defaultWidth:"wide",argumentCallback:t=>t-1}),month:ks({values:IT,defaultWidth:"wide"}),day:ks({values:PT,defaultWidth:"wide"}),dayPeriod:ks({values:LT,defaultWidth:"wide",formattingValues:BT,defaultFormattingWidth:"wide"})},$T=/^(\d+)[o]?/i,VT=/\d+/i,HT={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},qT={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},WT={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},GT={any:[/1/i,/2/i,/3/i,/4/i]},YT={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|maro|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},XT={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},KT={narrow:/^(dom|[23456]?|s[a]b)/i,short:/^(dom|[23456]?|s[a]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a]b)/i,wide:/^(domingo|(segunda|ter[c]a|quarta|quinta|sexta)([- ]feira)?|s[a]bado)/i},ZT={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a]b/i]},JT={narrow:/^(a|p|mn|md|(da) (manh|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh|tarde|noite))/i},QT={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},e9={ordinalNumber:gw({matchPattern:$T,parsePattern:VT,valueCallback:t=>parseInt(t,10)}),era:Es({matchPatterns:HT,defaultMatchWidth:"wide",parsePatterns:qT,defaultParseWidth:"any"}),quarter:Es({matchPatterns:WT,defaultMatchWidth:"wide",parsePatterns:GT,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Es({matchPatterns:YT,defaultMatchWidth:"wide",parsePatterns:XT,defaultParseWidth:"any"}),day:Es({matchPatterns:KT,defaultMatchWidth:"wide",parsePatterns:ZT,defaultParseWidth:"any"}),dayPeriod:Es({matchPatterns:JT,defaultMatchWidth:"any",parsePatterns:QT,defaultParseWidth:"any"})},jr={code:"pt-BR",formatDistance:AT,formatLong:jT,formatRelative:MT,localize:zT,match:e9,options:{weekStartsOn:0,firstWeekContainsDate:1}},yw={...Fl,labels:{labelDayButton:(t,r,e,n)=>{let a;n&&typeof n.format=="function"?a=n.format.bind(n):a=(s,l)=>Jt(s,l,{locale:Fl,...e});let o=a(t,"PPPP");return r.today&&(o=`Today, ${o}`),r.selected&&(o=`${o}, selected`),o},labelMonthDropdown:"Choose the Month",labelNext:"Go to the Next Month",labelPrevious:"Go to the Previous Month",labelWeekNumber:t=>`Week ${t}`,labelYearDropdown:"Choose the Year",labelGrid:(t,r,e)=>{let n;return e&&typeof e.format=="function"?n=e.format.bind(e):n=(a,o)=>Jt(a,o,{locale:Fl,...r}),n(t,"LLLL yyyy")},labelGridcell:(t,r,e,n)=>{let a;n&&typeof n.format=="function"?a=n.format.bind(n):a=(s,l)=>Jt(s,l,{locale:Fl,...e});let o=a(t,"PPPP");return r!=null&&r.today&&(o=`Today, ${o}`),o},labelNav:"Navigation bar",labelWeekNumberHeader:"Week Number",labelWeekday:(t,r,e)=>{let n;return e&&typeof e.format=="function"?n=e.format.bind(e):n=(a,o)=>Jt(a,o,{locale:Fl,...r}),n(t,"cccc")}}};class _a{constructor(r,e){this.Date=Date,this.today=()=>{var n;return(n=this.overrides)!=null&&n.today?this.overrides.today():this.options.timeZone?Ln.tz(this.options.timeZone):new this.Date},this.newDate=(n,a,o)=>{var s;return(s=this.overrides)!=null&&s.newDate?this.overrides.newDate(n,a,o):this.options.timeZone?new Ln(n,a,o,this.options.timeZone):new Date(n,a,o)},this.addDays=(n,a)=>{var o;return(o=this.overrides)!=null&&o.addDays?this.overrides.addDays(n,a):wm(n,a)},this.addMonths=(n,a)=>{var o;return(o=this.overrides)!=null&&o.addMonths?this.overrides.addMonths(n,a):_m(n,a)},this.addWeeks=(n,a)=>{var o;return(o=this.overrides)!=null&&o.addWeeks?this.overrides.addWeeks(n,a):fw(n,a)},this.addYears=(n,a)=>{var o;return(o=this.overrides)!=null&&o.addYears?this.overrides.addYears(n,a):oE(n,a)},this.differenceInCalendarDays=(n,a)=>{var o;return(o=this.overrides)!=null&&o.differenceInCalendarDays?this.overrides.differenceInCalendarDays(n,a):Sm(n,a)},this.differenceInCalendarMonths=(n,a)=>{var o;return(o=this.overrides)!=null&&o.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(n,a):pw(n,a)},this.eachMonthOfInterval=n=>{var a;return(a=this.overrides)!=null&&a.eachMonthOfInterval?this.overrides.eachMonthOfInterval(n):fE(n)},this.eachYearOfInterval=n=>{var l;const a=(l=this.overrides)!=null&&l.eachYearOfInterval?this.overrides.eachYearOfInterval(n):pE(n),o=new Set(a.map(c=>this.getYear(c)));if(o.size===a.length)return a;const s=[];return o.forEach(c=>{s.push(new Date(c,0,1))}),s},this.endOfBroadcastWeek=n=>{var a;return(a=this.overrides)!=null&&a.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(n):ET(n,this)},this.endOfISOWeek=n=>{var a;return(a=this.overrides)!=null&&a.endOfISOWeek?this.overrides.endOfISOWeek(n):mE(n)},this.endOfMonth=n=>{var a;return(a=this.overrides)!=null&&a.endOfMonth?this.overrides.endOfMonth(n):Lp(n)},this.endOfWeek=(n,a)=>{var o;return(o=this.overrides)!=null&&o.endOfWeek?this.overrides.endOfWeek(n,a):kf(n,this.options)},this.endOfYear=n=>{var a;return(a=this.overrides)!=null&&a.endOfYear?this.overrides.endOfYear(n):Up(n)},this.format=(n,a,o)=>{var l;const s=(l=this.overrides)!=null&&l.format?this.overrides.format(n,a,this.options):Jt(n,a,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(s):s},this.getISOWeek=n=>{var a;return(a=this.overrides)!=null&&a.getISOWeek?this.overrides.getISOWeek(n):Em(n)},this.getMonth=(n,a)=>{var o;return(o=this.overrides)!=null&&o.getMonth?this.overrides.getMonth(n,this.options):fT(n,this.options)},this.getYear=(n,a)=>{var o;return(o=this.overrides)!=null&&o.getYear?this.overrides.getYear(n,this.options):hT(n,this.options)},this.getWeek=(n,a)=>{var o;return(o=this.overrides)!=null&&o.getWeek?this.overrides.getWeek(n,this.options):Tm(n,this.options)},this.isAfter=(n,a)=>{var o;return(o=this.overrides)!=null&&o.isAfter?this.overrides.isAfter(n,a):pT(n,a)},this.isBefore=(n,a)=>{var o;return(o=this.overrides)!=null&&o.isBefore?this.overrides.isBefore(n,a):mT(n,a)},this.isDate=n=>{var a;return(a=this.overrides)!=null&&a.isDate?this.overrides.isDate(n):hw(n)},this.isSameDay=(n,a)=>{var o;return(o=this.overrides)!=null&&o.isSameDay?this.overrides.isSameDay(n,a):uE(n,a)},this.isSameMonth=(n,a)=>{var o;return(o=this.overrides)!=null&&o.isSameMonth?this.overrides.isSameMonth(n,a):gT(n,a)},this.isSameYear=(n,a)=>{var o;return(o=this.overrides)!=null&&o.isSameYear?this.overrides.isSameYear(n,a):vT(n,a)},this.max=n=>{var a;return(a=this.overrides)!=null&&a.max?this.overrides.max(n):lE(n)},this.min=n=>{var a;return(a=this.overrides)!=null&&a.min?this.overrides.min(n):cE(n)},this.setMonth=(n,a)=>{var o;return(o=this.overrides)!=null&&o.setMonth?this.overrides.setMonth(n,a):xT(n,a)},this.setYear=(n,a)=>{var o;return(o=this.overrides)!=null&&o.setYear?this.overrides.setYear(n,a):yT(n,a)},this.startOfBroadcastWeek=(n,a)=>{var o;return(o=this.overrides)!=null&&o.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(n,this):xw(n,this)},this.startOfDay=n=>{var a;return(a=this.overrides)!=null&&a.startOfDay?this.overrides.startOfDay(n):Ki(n)},this.startOfISOWeek=n=>{var a;return(a=this.overrides)!=null&&a.startOfISOWeek?this.overrides.startOfISOWeek(n):Su(n)},this.startOfMonth=n=>{var a;return(a=this.overrides)!=null&&a.startOfMonth?this.overrides.startOfMonth(n):Bp(n)},this.startOfWeek=(n,a)=>{var o;return(o=this.overrides)!=null&&o.startOfWeek?this.overrides.startOfWeek(n,this.options):Ji(n,this.options)},this.startOfYear=n=>{var a;return(a=this.overrides)!=null&&a.startOfYear?this.overrides.startOfYear(n):km(n)},this.options={locale:yw,...r},this.overrides=e}getDigitMap(){const{numerals:r="latn"}=this.options,e=new Intl.NumberFormat("en-US",{numberingSystem:r}),n={};for(let a=0;a<10;a++)n[a.toString()]=e.format(a);return n}replaceDigits(r){const e=this.getDigitMap();return r.replace(/\d/g,n=>e[n]||n)}formatNumber(r){return this.replaceDigits(r.toString())}getMonthYearOrder(){var e;const r=(e=this.options.locale)==null?void 0:e.code;return r&&_a.yearFirstLocales.has(r)?"year-first":"month-first"}formatMonthYear(r){const{locale:e,timeZone:n,numerals:a}=this.options,o=e==null?void 0:e.code;if(o&&_a.yearFirstLocales.has(o))try{return new Intl.DateTimeFormat(o,{month:"long",year:"numeric",timeZone:n,numberingSystem:a}).format(r)}catch{}const s=this.getMonthYearOrder()==="year-first"?"y LLLL":"LLLL y";return this.format(r,s)}}_a.yearFirstLocales=new Set(["eu","hu","ja","ja-Hira","ja-JP","ko","ko-KR","lt","lt-LT","lv","lv-LV","mn","mn-MN","zh","zh-CN","zh-HK","zh-TW"]);const Rs=new _a;class ww{constructor(r,e,n=Rs){this.date=r,this.displayMonth=e,this.outside=!!(e&&!n.isSameMonth(r,e)),this.dateLib=n,this.isoDate=n.format(r,"yyyy-MM-dd"),this.displayMonthId=n.format(e,"yyyy-MM"),this.dateMonthId=n.format(r,"yyyy-MM")}isEqualTo(r){return this.dateLib.isSameDay(r.date,this.date)&&this.dateLib.isSameMonth(r.displayMonth,this.displayMonth)}}class t9{constructor(r,e){this.date=r,this.weeks=e}}class r9{constructor(r,e){this.days=e,this.weekNumber=r}}function n9(t){return Ke.createElement("button",{...t})}function a9(t){return Ke.createElement("span",{...t})}function s9(t){const{size:r=24,orientation:e="left",className:n}=t;return Ke.createElement("svg",{className:n,width:r,height:r,viewBox:"0 0 24 24"},e==="up"&&Ke.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),e==="down"&&Ke.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),e==="left"&&Ke.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),e==="right"&&Ke.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function i9(t){const{day:r,modifiers:e,...n}=t;return Ke.createElement("td",{...n})}function o9(t){const{day:r,modifiers:e,...n}=t,a=Ke.useRef(null);return Ke.useEffect(()=>{var o;e.focused&&((o=a.current)==null||o.focus())},[e.focused]),Ke.createElement("button",{ref:a,...n})}var Bt;(function(t){t.Root="root",t.Chevron="chevron",t.Day="day",t.DayButton="day_button",t.CaptionLabel="caption_label",t.Dropdowns="dropdowns",t.Dropdown="dropdown",t.DropdownRoot="dropdown_root",t.Footer="footer",t.MonthGrid="month_grid",t.MonthCaption="month_caption",t.MonthsDropdown="months_dropdown",t.Month="month",t.Months="months",t.Nav="nav",t.NextMonthButton="button_next",t.PreviousMonthButton="button_previous",t.Week="week",t.Weeks="weeks",t.Weekday="weekday",t.Weekdays="weekdays",t.WeekNumber="week_number",t.WeekNumberHeader="week_number_header",t.YearsDropdown="years_dropdown"})(Bt||(Bt={}));var $r;(function(t){t.disabled="disabled",t.hidden="hidden",t.outside="outside",t.focused="focused",t.today="today"})($r||($r={}));var is;(function(t){t.range_end="range_end",t.range_middle="range_middle",t.range_start="range_start",t.selected="selected"})(is||(is={}));var ma;(function(t){t.weeks_before_enter="weeks_before_enter",t.weeks_before_exit="weeks_before_exit",t.weeks_after_enter="weeks_after_enter",t.weeks_after_exit="weeks_after_exit",t.caption_after_enter="caption_after_enter",t.caption_after_exit="caption_after_exit",t.caption_before_enter="caption_before_enter",t.caption_before_exit="caption_before_exit"})(ma||(ma={}));function l9(t){const{options:r,className:e,components:n,classNames:a,...o}=t,s=[a[Bt.Dropdown],e].join(" "),l=r==null?void 0:r.find(({value:c})=>c===o.value);return Ke.createElement("span",{"data-disabled":o.disabled,className:a[Bt.DropdownRoot]},Ke.createElement(n.Select,{className:s,...o},r==null?void 0:r.map(({value:c,label:i,disabled:u})=>Ke.createElement(n.Option,{key:c,value:c,disabled:u},i))),Ke.createElement("span",{className:a[Bt.CaptionLabel],"aria-hidden":!0},l==null?void 0:l.label,Ke.createElement(n.Chevron,{orientation:"down",size:18,className:a[Bt.Chevron]})))}function c9(t){return Ke.createElement("div",{...t})}function u9(t){return Ke.createElement("div",{...t})}function d9(t){const{calendarMonth:r,displayIndex:e,...n}=t;return Ke.createElement("div",{...n},t.children)}function f9(t){const{calendarMonth:r,displayIndex:e,...n}=t;return Ke.createElement("div",{...n})}function h9(t){return Ke.createElement("table",{...t})}function p9(t){return Ke.createElement("div",{...t})}const _w=ye.createContext(void 0);function Vu(){const t=ye.useContext(_w);if(t===void 0)throw new Error("useDayPicker() must be used within a custom component.");return t}function m9(t){const{components:r}=Vu();return Ke.createElement(r.Dropdown,{...t})}function g9(t){const{onPreviousClick:r,onNextClick:e,previousMonth:n,nextMonth:a,...o}=t,{components:s,classNames:l,labels:{labelPrevious:c,labelNext:i}}=Vu(),u=ye.useCallback(f=>{a&&(e==null||e(f))},[a,e]),p=ye.useCallback(f=>{n&&(r==null||r(f))},[n,r]);return Ke.createElement("nav",{...o},Ke.createElement(s.PreviousMonthButton,{type:"button",className:l[Bt.PreviousMonthButton],tabIndex:n?void 0:-1,"aria-disabled":n?void 0:!0,"aria-label":c(n),onClick:p},Ke.createElement(s.Chevron,{disabled:n?void 0:!0,className:l[Bt.Chevron],orientation:"left"})),Ke.createElement(s.NextMonthButton,{type:"button",className:l[Bt.NextMonthButton],tabIndex:a?void 0:-1,"aria-disabled":a?void 0:!0,"aria-label":i(a),onClick:u},Ke.createElement(s.Chevron,{disabled:a?void 0:!0,orientation:"right",className:l[Bt.Chevron]})))}function v9(t){const{components:r}=Vu();return Ke.createElement(r.Button,{...t})}function b9(t){return Ke.createElement("option",{...t})}function x9(t){const{components:r}=Vu();return Ke.createElement(r.Button,{...t})}function y9(t){const{rootRef:r,...e}=t;return Ke.createElement("div",{...e,ref:r})}function w9(t){return Ke.createElement("select",{...t})}function _9(t){const{week:r,...e}=t;return Ke.createElement("tr",{...e})}function S9(t){return Ke.createElement("th",{...t})}function k9(t){return Ke.createElement("thead",{"aria-hidden":!0},Ke.createElement("tr",{...t}))}function E9(t){const{week:r,...e}=t;return Ke.createElement("th",{...e})}function T9(t){return Ke.createElement("th",{...t})}function A9(t){return Ke.createElement("tbody",{...t})}function C9(t){const{components:r}=Vu();return Ke.createElement(r.Dropdown,{...t})}const N9=Object.freeze(Object.defineProperty({__proto__:null,Button:n9,CaptionLabel:a9,Chevron:s9,Day:i9,DayButton:o9,Dropdown:l9,DropdownNav:c9,Footer:u9,Month:d9,MonthCaption:f9,MonthGrid:h9,Months:p9,MonthsDropdown:m9,Nav:g9,NextMonthButton:v9,Option:b9,PreviousMonthButton:x9,Root:y9,Select:w9,Week:_9,WeekNumber:E9,WeekNumberHeader:T9,Weekday:S9,Weekdays:k9,Weeks:A9,YearsDropdown:C9},Symbol.toStringTag,{value:"Module"}));function ei(t,r,e=!1,n=Rs){let{from:a,to:o}=t;const{differenceInCalendarDays:s,isSameDay:l}=n;return a&&o?(s(o,a)<0&&([a,o]=[o,a]),s(r,a)>=(e?1:0)&&s(o,r)>=(e?1:0)):!e&&o?l(o,r):!e&&a?l(a,r):!1}function Am(t){return!!(t&&typeof t=="object"&&"before"in t&&"after"in t)}function qf(t){return!!(t&&typeof t=="object"&&"from"in t)}function Cm(t){return!!(t&&typeof t=="object"&&"after"in t)}function Nm(t){return!!(t&&typeof t=="object"&&"before"in t)}function Sw(t){return!!(t&&typeof t=="object"&&"dayOfWeek"in t)}function kw(t,r){return Array.isArray(t)&&t.every(r.isDate)}function ti(t,r,e=Rs){const n=Array.isArray(r)?r:[r],{isSameDay:a,differenceInCalendarDays:o,isAfter:s}=e;return n.some(l=>{if(typeof l=="boolean")return l;if(e.isDate(l))return a(t,l);if(kw(l,e))return l.some(c=>a(t,c));if(qf(l))return ei(l,t,!1,e);if(Sw(l))return Array.isArray(l.dayOfWeek)?l.dayOfWeek.includes(t.getDay()):l.dayOfWeek===t.getDay();if(Am(l)){const c=o(l.before,t),i=o(l.after,t),u=c>0,p=i<0;return s(l.before,l.after)?p&&u:u||p}return Cm(l)?o(t,l.after)>0:Nm(l)?o(l.before,t)>0:typeof l=="function"?l(t):!1})}function O9(t,r,e,n,a){const{disabled:o,hidden:s,modifiers:l,showOutsideDays:c,broadcastCalendar:i,today:u=a.today()}=r,{isSameDay:p,isSameMonth:f,startOfMonth:h,isBefore:v,endOfMonth:b,isAfter:g}=a,x=e&&h(e),y=n&&b(n),E={[$r.focused]:[],[$r.outside]:[],[$r.disabled]:[],[$r.hidden]:[],[$r.today]:[]},N={};for(const I of t){const{date:L,displayMonth:H}=I,V=!!(H&&!f(L,H)),q=!!(x&&v(L,x)),K=!!(y&&g(L,y)),z=!!(o&&ti(L,o,a)),W=!!(s&&ti(L,s,a))||q||K||!i&&!c&&V||i&&c===!1&&V,D=p(L,u);V&&E.outside.push(I),z&&E.disabled.push(I),W&&E.hidden.push(I),D&&E.today.push(I),l&&Object.keys(l).forEach(M=>{const C=l==null?void 0:l[M];C&&ti(L,C,a)&&(N[M]?N[M].push(I):N[M]=[I])})}return I=>{const L={[$r.focused]:!1,[$r.disabled]:!1,[$r.hidden]:!1,[$r.outside]:!1,[$r.today]:!1},H={};for(const V in E){const q=E[V];L[V]=q.some(K=>K===I)}for(const V in N)H[V]=N[V].some(q=>q===I);return{...L,...H}}}function j9(t,r,e={}){return Object.entries(t).filter(([,a])=>a===!0).reduce((a,[o])=>(e[o]?a.push(e[o]):r[$r[o]]?a.push(r[$r[o]]):r[is[o]]&&a.push(r[is[o]]),a),[r[Bt.Day]])}function D9(t){return{...N9,...t}}function M9(t){const r={"data-mode":t.mode??void 0,"data-required":"required"in t?t.required:void 0,"data-multiple-months":t.numberOfMonths&&t.numberOfMonths>1||void 0,"data-week-numbers":t.showWeekNumber||void 0,"data-broadcast-calendar":t.broadcastCalendar||void 0,"data-nav-layout":t.navLayout||void 0};return Object.entries(t).forEach(([e,n])=>{e.startsWith("data-")&&(r[e]=n)}),r}function Om(){const t={};for(const r in Bt)t[Bt[r]]=`rdp-${Bt[r]}`;for(const r in $r)t[$r[r]]=`rdp-${$r[r]}`;for(const r in is)t[is[r]]=`rdp-${is[r]}`;for(const r in ma)t[ma[r]]=`rdp-${ma[r]}`;return t}function Ew(t,r,e){return(e??new _a(r)).formatMonthYear(t)}const R9=Ew;function F9(t,r,e){return(e??new _a(r)).format(t,"d")}function I9(t,r=Rs){return r.format(t,"LLLL")}function P9(t,r,e){return(e??new _a(r)).format(t,"cccccc")}function L9(t,r=Rs){return t<10?r.formatNumber(`0${t.toLocaleString()}`):r.formatNumber(`${t.toLocaleString()}`)}function B9(){return""}function Tw(t,r=Rs){return r.format(t,"yyyy")}const U9=Tw,z9=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:Ew,formatDay:F9,formatMonthCaption:R9,formatMonthDropdown:I9,formatWeekNumber:L9,formatWeekNumberHeader:B9,formatWeekdayName:P9,formatYearCaption:U9,formatYearDropdown:Tw},Symbol.toStringTag,{value:"Module"}));function $9(t){return t!=null&&t.formatMonthCaption&&!t.formatCaption&&(t.formatCaption=t.formatMonthCaption),t!=null&&t.formatYearCaption&&!t.formatYearDropdown&&(t.formatYearDropdown=t.formatYearCaption),{...z9,...t}}function jm(t,r,e,n){let a=(n??new _a(e)).format(t,"PPPP");return r.today&&(a=`Today, ${a}`),r.selected&&(a=`${a}, selected`),a}const V9=jm;function Dm(t,r,e){return(e??new _a(r)).formatMonthYear(t)}const H9=Dm;function Aw(t,r,e,n){let a=(n??new _a(e)).format(t,"PPPP");return r!=null&&r.today&&(a=`Today, ${a}`),a}function Cw(t){return"Choose the Month"}function Nw(){return""}const q9="Go to the Next Month";function Ow(t,r){return q9}function jw(t){return"Go to the Previous Month"}function Dw(t,r,e){return(e??new _a(r)).format(t,"cccc")}function Mw(t,r){return`Week ${t}`}function Rw(t){return"Week Number"}function Fw(t){return"Choose the Year"}const W9=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:H9,labelDay:V9,labelDayButton:jm,labelGrid:Dm,labelGridcell:Aw,labelMonthDropdown:Cw,labelNav:Nw,labelNext:Ow,labelPrevious:jw,labelWeekNumber:Mw,labelWeekNumberHeader:Rw,labelWeekday:Dw,labelYearDropdown:Fw},Symbol.toStringTag,{value:"Module"})),Ja=(t,r,e)=>r||(e?typeof e=="function"?e:(...n)=>e:t);function G9(t,r){var n;const e=((n=r.locale)==null?void 0:n.labels)??{};return{...W9,...t??{},labelDayButton:Ja(jm,t==null?void 0:t.labelDayButton,e.labelDayButton),labelMonthDropdown:Ja(Cw,t==null?void 0:t.labelMonthDropdown,e.labelMonthDropdown),labelNext:Ja(Ow,t==null?void 0:t.labelNext,e.labelNext),labelPrevious:Ja(jw,t==null?void 0:t.labelPrevious,e.labelPrevious),labelWeekNumber:Ja(Mw,t==null?void 0:t.labelWeekNumber,e.labelWeekNumber),labelYearDropdown:Ja(Fw,t==null?void 0:t.labelYearDropdown,e.labelYearDropdown),labelGrid:Ja(Dm,t==null?void 0:t.labelGrid,e.labelGrid),labelGridcell:Ja(Aw,t==null?void 0:t.labelGridcell,e.labelGridcell),labelNav:Ja(Nw,t==null?void 0:t.labelNav,e.labelNav),labelWeekNumberHeader:Ja(Rw,t==null?void 0:t.labelWeekNumberHeader,e.labelWeekNumberHeader),labelWeekday:Ja(Dw,t==null?void 0:t.labelWeekday,e.labelWeekday)}}function Y9(t,r,e,n,a){const{startOfMonth:o,startOfYear:s,endOfYear:l,eachMonthOfInterval:c,getMonth:i}=a;return c({start:s(t),end:l(t)}).map(f=>{const h=n.formatMonthDropdown(f,a),v=i(f),b=r&&f<o(r)||e&&f>o(e)||!1;return{value:v,label:h,disabled:b}})}function X9(t,r={},e={}){let n={...r==null?void 0:r[Bt.Day]};return Object.entries(t).filter(([,a])=>a===!0).forEach(([a])=>{n={...n,...e==null?void 0:e[a]}}),n}function K9(t,r,e,n){const a=n??t.today(),o=e?t.startOfBroadcastWeek(a,t):r?t.startOfISOWeek(a):t.startOfWeek(a),s=[];for(let l=0;l<7;l++){const c=t.addDays(o,l);s.push(c)}return s}function Z9(t,r,e,n,a=!1){if(!t||!r)return;const{startOfYear:o,endOfYear:s,eachYearOfInterval:l,getYear:c}=n,i=o(t),u=s(r),p=l({start:i,end:u});return a&&p.reverse(),p.map(f=>{const h=e.formatYearDropdown(f,n);return{value:c(f),label:h,disabled:!1}})}function J9(t,r={}){var l;const{weekStartsOn:e,locale:n}=r,a=e??((l=n==null?void 0:n.options)==null?void 0:l.weekStartsOn)??0,o=c=>{const i=typeof c=="number"||typeof c=="string"?new Date(c):c;return new Ln(i.getFullYear(),i.getMonth(),i.getDate(),12,0,0,t)},s=c=>{const i=o(c);return new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0,0)};return{today:()=>o(Ln.tz(t)),newDate:(c,i,u)=>new Ln(c,i,u,12,0,0,t),startOfDay:c=>o(c),startOfWeek:(c,i)=>{const u=o(c),p=(i==null?void 0:i.weekStartsOn)??a,f=(u.getDay()-p+7)%7;return u.setDate(u.getDate()-f),u},startOfISOWeek:c=>{const i=o(c),u=(i.getDay()-1+7)%7;return i.setDate(i.getDate()-u),i},startOfMonth:c=>{const i=o(c);return i.setDate(1),i},startOfYear:c=>{const i=o(c);return i.setMonth(0,1),i},endOfWeek:(c,i)=>{const u=o(c),h=((((i==null?void 0:i.weekStartsOn)??a)+6)%7-u.getDay()+7)%7;return u.setDate(u.getDate()+h),u},endOfISOWeek:c=>{const i=o(c),u=(7-i.getDay())%7;return i.setDate(i.getDate()+u),i},endOfMonth:c=>{const i=o(c);return i.setMonth(i.getMonth()+1,0),i},endOfYear:c=>{const i=o(c);return i.setMonth(11,31),i},eachMonthOfInterval:c=>{const i=o(c.start),u=o(c.end),p=[],f=new Ln(i.getFullYear(),i.getMonth(),1,12,0,0,t),h=u.getFullYear()*12+u.getMonth();for(;f.getFullYear()*12+f.getMonth()<=h;)p.push(new Ln(f,t)),f.setMonth(f.getMonth()+1,1);return p},addDays:(c,i)=>{const u=o(c);return u.setDate(u.getDate()+i),u},addWeeks:(c,i)=>{const u=o(c);return u.setDate(u.getDate()+i*7),u},addMonths:(c,i)=>{const u=o(c);return u.setMonth(u.getMonth()+i),u},addYears:(c,i)=>{const u=o(c);return u.setFullYear(u.getFullYear()+i),u},eachYearOfInterval:c=>{const i=o(c.start),u=o(c.end),p=[],f=new Ln(i.getFullYear(),0,1,12,0,0,t);for(;f.getFullYear()<=u.getFullYear();)p.push(new Ln(f,t)),f.setFullYear(f.getFullYear()+1,0,1);return p},getWeek:(c,i)=>{var p;const u=s(c);return Tm(u,{weekStartsOn:(i==null?void 0:i.weekStartsOn)??a,firstWeekContainsDate:(i==null?void 0:i.firstWeekContainsDate)??((p=n==null?void 0:n.options)==null?void 0:p.firstWeekContainsDate)??1})},getISOWeek:c=>{const i=s(c);return Em(i)},differenceInCalendarDays:(c,i)=>{const u=s(c),p=s(i);return Sm(u,p)},differenceInCalendarMonths:(c,i)=>{const u=s(c),p=s(i);return pw(u,p)}}}const Hu=t=>t instanceof HTMLElement?t:null,sp=t=>[...t.querySelectorAll("[data-animated-month]")??[]],Q9=t=>Hu(t.querySelector("[data-animated-month]")),ip=t=>Hu(t.querySelector("[data-animated-caption]")),op=t=>Hu(t.querySelector("[data-animated-weeks]")),eA=t=>Hu(t.querySelector("[data-animated-nav]")),tA=t=>Hu(t.querySelector("[data-animated-weekdays]"));function rA(t,r,{classNames:e,months:n,focused:a,dateLib:o}){const s=ye.useRef(null),l=ye.useRef(n),c=ye.useRef(!1);ye.useLayoutEffect(()=>{const i=l.current;if(l.current=n,!r||!t.current||!(t.current instanceof HTMLElement)||n.length===0||i.length===0||n.length!==i.length)return;const u=o.isSameMonth(n[0].date,i[0].date),p=o.isAfter(n[0].date,i[0].date),f=p?e[ma.caption_after_enter]:e[ma.caption_before_enter],h=p?e[ma.weeks_after_enter]:e[ma.weeks_before_enter],v=s.current,b=t.current.cloneNode(!0);if(b instanceof HTMLElement?(sp(b).forEach(E=>{if(!(E instanceof HTMLElement))return;const N=Q9(E);N&&E.contains(N)&&E.removeChild(N);const I=ip(E);I&&I.classList.remove(f);const L=op(E);L&&L.classList.remove(h)}),s.current=b):s.current=null,c.current||u||a)return;const g=v instanceof HTMLElement?sp(v):[],x=sp(t.current);if(x!=null&&x.every(y=>y instanceof HTMLElement)&&g&&g.every(y=>y instanceof HTMLElement)){c.current=!0,t.current.style.isolation="isolate";const y=eA(t.current);y&&(y.style.zIndex="1"),x.forEach((E,N)=>{const I=g[N];if(!I)return;E.style.position="relative",E.style.overflow="hidden";const L=ip(E);L&&L.classList.add(f);const H=op(E);H&&H.classList.add(h);const V=()=>{c.current=!1,t.current&&(t.current.style.isolation=""),y&&(y.style.zIndex=""),L&&L.classList.remove(f),H&&H.classList.remove(h),E.style.position="",E.style.overflow="",E.contains(I)&&E.removeChild(I)};I.style.pointerEvents="none",I.style.position="absolute",I.style.overflow="hidden",I.setAttribute("aria-hidden","true");const q=tA(I);q&&(q.style.opacity="0");const K=ip(I);K&&(K.classList.add(p?e[ma.caption_before_exit]:e[ma.caption_after_exit]),K.addEventListener("animationend",V));const z=op(I);z&&z.classList.add(p?e[ma.weeks_before_exit]:e[ma.weeks_after_exit]),E.insertBefore(I,E.firstChild)})}})}function nA(t,r,e,n){const a=t[0],o=t[t.length-1],{ISOWeek:s,fixedWeeks:l,broadcastCalendar:c}=e??{},{addDays:i,differenceInCalendarDays:u,differenceInCalendarMonths:p,endOfBroadcastWeek:f,endOfISOWeek:h,endOfMonth:v,endOfWeek:b,isAfter:g,startOfBroadcastWeek:x,startOfISOWeek:y,startOfWeek:E}=n,N=c?x(a,n):s?y(a):E(a),I=c?f(o):s?h(v(o)):b(v(o)),L=r&&(c?f(r):s?h(r):b(r)),H=L&&g(I,L)?L:I,V=u(H,N),q=p(o,a)+1,K=[];for(let D=0;D<=V;D++){const M=i(N,D);K.push(M)}const W=(c?35:42)*q;if(l&&K.length<W){const D=W-K.length;for(let M=0;M<D;M++){const C=i(K[K.length-1],1);K.push(C)}}return K}function aA(t){const r=[];return t.reduce((e,n)=>{const a=n.weeks.reduce((o,s)=>o.concat(s.days.slice()),r.slice());return e.concat(a.slice())},r.slice())}function sA(t,r,e,n){const{numberOfMonths:a=1}=e,o=[];for(let s=0;s<a;s++){const l=n.addMonths(t,s);if(r&&l>r)break;o.push(l)}return o}function vx(t,r,e,n){const{month:a,defaultMonth:o,today:s=n.today(),numberOfMonths:l=1}=t;let c=a||o||s;const{differenceInCalendarMonths:i,addMonths:u,startOfMonth:p}=n;if(e&&i(e,c)<l-1){const f=-1*(l-1);c=u(e,f)}return r&&i(c,r)<0&&(c=r),p(c)}function iA(t,r,e,n){const{addDays:a,endOfBroadcastWeek:o,endOfISOWeek:s,endOfMonth:l,endOfWeek:c,getISOWeek:i,getWeek:u,startOfBroadcastWeek:p,startOfISOWeek:f,startOfWeek:h}=n,v=t.reduce((b,g)=>{const x=e.broadcastCalendar?p(g,n):e.ISOWeek?f(g):h(g),y=e.broadcastCalendar?o(g):e.ISOWeek?s(l(g)):c(l(g)),E=r.filter(H=>H>=x&&H<=y),N=e.broadcastCalendar?35:42;if(e.fixedWeeks&&E.length<N){const H=r.filter(V=>{const q=N-E.length;return V>y&&V<=a(y,q)});E.push(...H)}const I=E.reduce((H,V)=>{const q=e.ISOWeek?i(V):u(V),K=H.find(W=>W.weekNumber===q),z=new ww(V,g,n);return K?K.days.push(z):H.push(new r9(q,[z])),H},[]),L=new t9(g,I);return b.push(L),b},[]);return e.reverseMonths?v.reverse():v}function oA(t,r){let{startMonth:e,endMonth:n}=t;const{startOfYear:a,startOfDay:o,startOfMonth:s,endOfMonth:l,addYears:c,endOfYear:i,newDate:u,today:p}=r,{fromYear:f,toYear:h,fromMonth:v,toMonth:b}=t;!e&&v&&(e=v),!e&&f&&(e=r.newDate(f,0,1)),!n&&b&&(n=b),!n&&h&&(n=u(h,11,31));const g=t.captionLayout==="dropdown"||t.captionLayout==="dropdown-years";return e?e=s(e):f?e=u(f,0,1):!e&&g&&(e=a(c(t.today??p(),-100))),n?n=l(n):h?n=u(h,11,31):!n&&g&&(n=i(t.today??p())),[e&&o(e),n&&o(n)]}function lA(t,r,e,n){if(e.disableNavigation)return;const{pagedNavigation:a,numberOfMonths:o=1}=e,{startOfMonth:s,addMonths:l,differenceInCalendarMonths:c}=n,i=a?o:1,u=s(t);if(!r)return l(u,i);if(!(c(r,t)<o))return l(u,i)}function cA(t,r,e,n){if(e.disableNavigation)return;const{pagedNavigation:a,numberOfMonths:o}=e,{startOfMonth:s,addMonths:l,differenceInCalendarMonths:c}=n,i=a?o??1:1,u=s(t);if(!r)return l(u,-i);if(!(c(u,r)<=0))return l(u,-i)}function uA(t){const r=[];return t.reduce((e,n)=>e.concat(n.weeks.slice()),r.slice())}function Wf(t,r){const[e,n]=ye.useState(t);return[r===void 0?e:r,n]}function dA(t,r){var N;const[e,n]=oA(t,r),{startOfMonth:a,endOfMonth:o}=r,s=vx(t,e,n,r),[l,c]=Wf(s,t.month?s:void 0);ye.useEffect(()=>{const I=vx(t,e,n,r);c(I)},[t.timeZone]);const{months:i,weeks:u,days:p,previousMonth:f,nextMonth:h}=ye.useMemo(()=>{const I=sA(l,n,{numberOfMonths:t.numberOfMonths},r),L=nA(I,t.endMonth?o(t.endMonth):void 0,{ISOWeek:t.ISOWeek,fixedWeeks:t.fixedWeeks,broadcastCalendar:t.broadcastCalendar},r),H=iA(I,L,{broadcastCalendar:t.broadcastCalendar,fixedWeeks:t.fixedWeeks,ISOWeek:t.ISOWeek,reverseMonths:t.reverseMonths},r),V=uA(H),q=aA(H),K=cA(l,e,t,r),z=lA(l,n,t,r);return{months:H,weeks:V,days:q,previousMonth:K,nextMonth:z}},[r,l.getTime(),n==null?void 0:n.getTime(),e==null?void 0:e.getTime(),t.disableNavigation,t.broadcastCalendar,(N=t.endMonth)==null?void 0:N.getTime(),t.fixedWeeks,t.ISOWeek,t.numberOfMonths,t.pagedNavigation,t.reverseMonths]),{disableNavigation:v,onMonthChange:b}=t,g=I=>u.some(L=>L.days.some(H=>H.isEqualTo(I))),x=I=>{if(v)return;let L=a(I);e&&L<a(e)&&(L=a(e)),n&&L>a(n)&&(L=a(n)),c(L),b==null||b(L)};return{months:i,weeks:u,days:p,navStart:e,navEnd:n,previousMonth:f,nextMonth:h,goToMonth:x,goToDay:I=>{g(I)||x(I.date)}}}var Ss;(function(t){t[t.Today=0]="Today",t[t.Selected=1]="Selected",t[t.LastFocused=2]="LastFocused",t[t.FocusedModifier=3]="FocusedModifier"})(Ss||(Ss={}));function bx(t){return!t[$r.disabled]&&!t[$r.hidden]&&!t[$r.outside]}function fA(t,r,e,n){let a,o=-1;for(const s of t){const l=r(s);bx(l)&&(l[$r.focused]&&o<Ss.FocusedModifier?(a=s,o=Ss.FocusedModifier):n!=null&&n.isEqualTo(s)&&o<Ss.LastFocused?(a=s,o=Ss.LastFocused):e(s.date)&&o<Ss.Selected?(a=s,o=Ss.Selected):l[$r.today]&&o<Ss.Today&&(a=s,o=Ss.Today))}return a||(a=t.find(s=>bx(r(s)))),a}function hA(t,r,e,n,a,o,s){const{ISOWeek:l,broadcastCalendar:c}=o,{addDays:i,addMonths:u,addWeeks:p,addYears:f,endOfBroadcastWeek:h,endOfISOWeek:v,endOfWeek:b,max:g,min:x,startOfBroadcastWeek:y,startOfISOWeek:E,startOfWeek:N}=s;let L={day:i,week:p,month:u,year:f,startOfWeek:H=>c?y(H,s):l?E(H):N(H),endOfWeek:H=>c?h(H):l?v(H):b(H)}[t](e,r==="after"?1:-1);return r==="before"&&n?L=g([n,L]):r==="after"&&a&&(L=x([a,L])),L}function Iw(t,r,e,n,a,o,s,l=0){if(l>365)return;const c=hA(t,r,e.date,n,a,o,s),i=!!(o.disabled&&ti(c,o.disabled,s)),u=!!(o.hidden&&ti(c,o.hidden,s)),p=c,f=new ww(c,p,s);return!i&&!u?f:Iw(t,r,f,n,a,o,s,l+1)}function pA(t,r,e,n,a){const{autoFocus:o}=t,[s,l]=ye.useState(),c=fA(r.days,e,n||(()=>!1),s),[i,u]=ye.useState(o?c:void 0);return{isFocusTarget:b=>!!(c!=null&&c.isEqualTo(b)),setFocused:u,focused:i,blur:()=>{l(i),u(void 0)},moveFocus:(b,g)=>{if(!i)return;const x=Iw(b,g,i,r.navStart,r.navEnd,t,a);x&&(t.disableNavigation&&!r.days.some(E=>E.isEqualTo(x))||(r.goToDay(x),u(x)))}}}function mA(t,r){const{selected:e,required:n,onSelect:a}=t,[o,s]=Wf(e,a?e:void 0),l=a?e:o,{isSameDay:c}=r,i=h=>(l==null?void 0:l.some(v=>c(v,h)))??!1,{min:u,max:p}=t;return{selected:l,select:(h,v,b)=>{let g=[...l??[]];if(i(h)){if((l==null?void 0:l.length)===u||n&&(l==null?void 0:l.length)===1)return;g=l==null?void 0:l.filter(x=>!c(x,h))}else(l==null?void 0:l.length)===p?g=[h]:g=[...g,h];return a||s(g),a==null||a(g,h,v,b),g},isSelected:i}}function gA(t,r,e=0,n=0,a=!1,o=Rs){const{from:s,to:l}=r||{},{isSameDay:c,isAfter:i,isBefore:u}=o;let p;if(!s&&!l)p={from:t,to:e>0?void 0:t};else if(s&&!l)c(s,t)?e===0?p={from:s,to:t}:a?p={from:s,to:void 0}:p=void 0:u(t,s)?p={from:t,to:s}:p={from:s,to:t};else if(s&&l)if(c(s,t)&&c(l,t))a?p={from:s,to:l}:p=void 0;else if(c(s,t))p={from:s,to:e>0?void 0:t};else if(c(l,t))p={from:t,to:e>0?void 0:t};else if(u(t,s))p={from:t,to:l};else if(i(t,s))p={from:s,to:t};else if(i(t,l))p={from:s,to:t};else throw new Error("Invalid range");if(p!=null&&p.from&&(p!=null&&p.to)){const f=o.differenceInCalendarDays(p.to,p.from);n>0&&f>n?p={from:t,to:void 0}:e>1&&f<e&&(p={from:t,to:void 0})}return p}function vA(t,r,e=Rs){const n=Array.isArray(r)?r:[r];let a=t.from;const o=e.differenceInCalendarDays(t.to,t.from),s=Math.min(o,6);for(let l=0;l<=s;l++){if(n.includes(a.getDay()))return!0;a=e.addDays(a,1)}return!1}function xx(t,r,e=Rs){return ei(t,r.from,!1,e)||ei(t,r.to,!1,e)||ei(r,t.from,!1,e)||ei(r,t.to,!1,e)}function bA(t,r,e=Rs){const n=Array.isArray(r)?r:[r];if(n.filter(l=>typeof l!="function").some(l=>typeof l=="boolean"?l:e.isDate(l)?ei(t,l,!1,e):kw(l,e)?l.some(c=>ei(t,c,!1,e)):qf(l)?l.from&&l.to?xx(t,{from:l.from,to:l.to},e):!1:Sw(l)?vA(t,l.dayOfWeek,e):Am(l)?e.isAfter(l.before,l.after)?xx(t,{from:e.addDays(l.after,1),to:e.addDays(l.before,-1)},e):ti(t.from,l,e)||ti(t.to,l,e):Cm(l)||Nm(l)?ti(t.from,l,e)||ti(t.to,l,e):!1))return!0;const s=n.filter(l=>typeof l=="function");if(s.length){let l=t.from;const c=e.differenceInCalendarDays(t.to,t.from);for(let i=0;i<=c;i++){if(s.some(u=>u(l)))return!0;l=e.addDays(l,1)}}return!1}function xA(t,r){const{disabled:e,excludeDisabled:n,selected:a,required:o,onSelect:s}=t,[l,c]=Wf(a,s?a:void 0),i=s?a:l;return{selected:i,select:(f,h,v)=>{const{min:b,max:g}=t,x=f?gA(f,i,b,g,o,r):void 0;return n&&e&&(x!=null&&x.from)&&x.to&&bA({from:x.from,to:x.to},e,r)&&(x.from=f,x.to=void 0),s||c(x),s==null||s(x,f,h,v),x},isSelected:f=>i&&ei(i,f,!1,r)}}function yA(t,r){const{selected:e,required:n,onSelect:a}=t,[o,s]=Wf(e,a?e:void 0),l=a?e:o,{isSameDay:c}=r;return{selected:l,select:(p,f,h)=>{let v=p;return!n&&l&&l&&c(p,l)&&(v=void 0),a||s(v),a==null||a(v,p,f,h),v},isSelected:p=>l?c(l,p):!1}}function wA(t,r){const e=yA(t,r),n=mA(t,r),a=xA(t,r);switch(t.mode){case"single":return e;case"multiple":return n;case"range":return a;default:return}}function Ra(t,r){return t instanceof Ln&&t.timeZone===r?t:new Ln(t,r)}function kl(t,r,e){return Ra(t,r)}function yx(t,r,e){return typeof t=="boolean"||typeof t=="function"?t:t instanceof Date?kl(t,r):Array.isArray(t)?t.map(n=>n instanceof Date?kl(n,r):n):qf(t)?{...t,from:t.from?Ra(t.from,r):t.from,to:t.to?Ra(t.to,r):t.to}:Am(t)?{before:kl(t.before,r),after:kl(t.after,r)}:Cm(t)?{after:kl(t.after,r)}:Nm(t)?{before:kl(t.before,r)}:t}function lp(t,r,e){return t&&(Array.isArray(t)?t.map(n=>yx(n,r)):yx(t,r))}function _A(t){var $e;let r=t;const e=r.timeZone;if(e&&(r={...t,timeZone:e},r.today&&(r.today=Ra(r.today,e)),r.month&&(r.month=Ra(r.month,e)),r.defaultMonth&&(r.defaultMonth=Ra(r.defaultMonth,e)),r.startMonth&&(r.startMonth=Ra(r.startMonth,e)),r.endMonth&&(r.endMonth=Ra(r.endMonth,e)),r.mode==="single"&&r.selected?r.selected=Ra(r.selected,e):r.mode==="multiple"&&r.selected?r.selected=($e=r.selected)==null?void 0:$e.map(Be=>Ra(Be,e)):r.mode==="range"&&r.selected&&(r.selected={from:r.selected.from?Ra(r.selected.from,e):r.selected.from,to:r.selected.to?Ra(r.selected.to,e):r.selected.to}),r.disabled!==void 0&&(r.disabled=lp(r.disabled,e)),r.hidden!==void 0&&(r.hidden=lp(r.hidden,e)),r.modifiers)){const Be={};Object.keys(r.modifiers).forEach(wt=>{var et;Be[wt]=lp((et=r.modifiers)==null?void 0:et[wt],e)}),r.modifiers=Be}const{components:n,formatters:a,labels:o,dateLib:s,locale:l,classNames:c}=ye.useMemo(()=>{const Be={...yw,...r.locale},wt=r.broadcastCalendar?1:r.weekStartsOn,et=r.noonSafe&&r.timeZone?J9(r.timeZone,{weekStartsOn:wt,locale:Be}):void 0,dt=r.dateLib&&et?{...et,...r.dateLib}:r.dateLib??et,we=new _a({locale:Be,weekStartsOn:wt,firstWeekContainsDate:r.firstWeekContainsDate,useAdditionalWeekYearTokens:r.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:r.useAdditionalDayOfYearTokens,timeZone:r.timeZone,numerals:r.numerals},dt);return{dateLib:we,components:D9(r.components),formatters:$9(r.formatters),labels:G9(r.labels,we.options),locale:Be,classNames:{...Om(),...r.classNames}}},[r.locale,r.broadcastCalendar,r.weekStartsOn,r.firstWeekContainsDate,r.useAdditionalWeekYearTokens,r.useAdditionalDayOfYearTokens,r.timeZone,r.numerals,r.dateLib,r.noonSafe,r.components,r.formatters,r.labels,r.classNames]);r.today||(r={...r,today:s.today()});const{captionLayout:i,mode:u,navLayout:p,numberOfMonths:f=1,onDayBlur:h,onDayClick:v,onDayFocus:b,onDayKeyDown:g,onDayMouseEnter:x,onDayMouseLeave:y,onNextClick:E,onPrevClick:N,showWeekNumber:I,styles:L}=r,{formatCaption:H,formatDay:V,formatMonthDropdown:q,formatWeekNumber:K,formatWeekNumberHeader:z,formatWeekdayName:W,formatYearDropdown:D}=a,M=dA(r,s),{days:C,months:w,navStart:T,navEnd:A,previousMonth:S,nextMonth:j,goToMonth:B}=M,R=O9(C,r,T,A,s),{isSelected:X,select:Y,selected:ee}=wA(r,s)??{},{blur:U,focused:Q,isFocusTarget:P,moveFocus:F,setFocused:Z}=pA(r,M,R,X??(()=>!1),s),{labelDayButton:se,labelGridcell:re,labelGrid:ae,labelMonthDropdown:te,labelNav:he,labelPrevious:le,labelNext:ne,labelWeekday:de,labelWeekNumber:fe,labelWeekNumberHeader:Se,labelYearDropdown:_e}=o,Ce=ye.useMemo(()=>K9(s,r.ISOWeek,r.broadcastCalendar,r.today),[s,r.ISOWeek,r.broadcastCalendar,r.today]),Re=u!==void 0||v!==void 0,Pe=ye.useCallback(()=>{S&&(B(S),N==null||N(S))},[S,B,N]),Ye=ye.useCallback(()=>{j&&(B(j),E==null||E(j))},[B,j,E]),at=ye.useCallback((Be,wt)=>et=>{et.preventDefault(),et.stopPropagation(),Z(Be),!wt.disabled&&(Y==null||Y(Be.date,wt,et),v==null||v(Be.date,wt,et))},[Y,v,Z]),tt=ye.useCallback((Be,wt)=>et=>{Z(Be),b==null||b(Be.date,wt,et)},[b,Z]),it=ye.useCallback((Be,wt)=>et=>{U(),h==null||h(Be.date,wt,et)},[U,h]),rt=ye.useCallback((Be,wt)=>et=>{const dt={ArrowLeft:[et.shiftKey?"month":"day",r.dir==="rtl"?"after":"before"],ArrowRight:[et.shiftKey?"month":"day",r.dir==="rtl"?"before":"after"],ArrowDown:[et.shiftKey?"year":"week","after"],ArrowUp:[et.shiftKey?"year":"week","before"],PageUp:[et.shiftKey?"year":"month","before"],PageDown:[et.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(dt[et.key]){et.preventDefault(),et.stopPropagation();const[we,Ne]=dt[et.key];F(we,Ne)}g==null||g(Be.date,wt,et)},[F,g,r.dir]),ct=ye.useCallback((Be,wt)=>et=>{x==null||x(Be.date,wt,et)},[x]),Oe=ye.useCallback((Be,wt)=>et=>{y==null||y(Be.date,wt,et)},[y]),pt=ye.useCallback(Be=>wt=>{const et=Number(wt.target.value),dt=s.setMonth(s.startOfMonth(Be),et);B(dt)},[s,B]),Je=ye.useCallback(Be=>wt=>{const et=Number(wt.target.value),dt=s.setYear(s.startOfMonth(Be),et);B(dt)},[s,B]),{className:ot,style:ut}=ye.useMemo(()=>({className:[c[Bt.Root],r.className].filter(Boolean).join(" "),style:{...L==null?void 0:L[Bt.Root],...r.style}}),[c,r.className,r.style,L]),_t=M9(r),vt=ye.useRef(null);rA(vt,!!r.animate,{classNames:c,months:w,focused:Q,dateLib:s});const ht={dayPickerProps:r,selected:ee,select:Y,isSelected:X,months:w,nextMonth:j,previousMonth:S,goToMonth:B,getModifiers:R,components:n,classNames:c,styles:L,labels:o,formatters:a};return Ke.createElement(_w.Provider,{value:ht},Ke.createElement(n.Root,{rootRef:r.animate?vt:void 0,className:ot,style:ut,dir:r.dir,id:r.id,lang:r.lang,nonce:r.nonce,title:r.title,role:r.role,"aria-label":r["aria-label"],"aria-labelledby":r["aria-labelledby"],..._t},Ke.createElement(n.Months,{className:c[Bt.Months],style:L==null?void 0:L[Bt.Months]},!r.hideNavigation&&!p&&Ke.createElement(n.Nav,{"data-animated-nav":r.animate?"true":void 0,className:c[Bt.Nav],style:L==null?void 0:L[Bt.Nav],"aria-label":he(),onPreviousClick:Pe,onNextClick:Ye,previousMonth:S,nextMonth:j}),w.map((Be,wt)=>Ke.createElement(n.Month,{"data-animated-month":r.animate?"true":void 0,className:c[Bt.Month],style:L==null?void 0:L[Bt.Month],key:wt,displayIndex:wt,calendarMonth:Be},p==="around"&&!r.hideNavigation&&wt===0&&Ke.createElement(n.PreviousMonthButton,{type:"button",className:c[Bt.PreviousMonthButton],tabIndex:S?void 0:-1,"aria-disabled":S?void 0:!0,"aria-label":le(S),onClick:Pe,"data-animated-button":r.animate?"true":void 0},Ke.createElement(n.Chevron,{disabled:S?void 0:!0,className:c[Bt.Chevron],orientation:r.dir==="rtl"?"right":"left"})),Ke.createElement(n.MonthCaption,{"data-animated-caption":r.animate?"true":void 0,className:c[Bt.MonthCaption],style:L==null?void 0:L[Bt.MonthCaption],calendarMonth:Be,displayIndex:wt},i!=null&&i.startsWith("dropdown")?Ke.createElement(n.DropdownNav,{className:c[Bt.Dropdowns],style:L==null?void 0:L[Bt.Dropdowns]},(()=>{const et=i==="dropdown"||i==="dropdown-months"?Ke.createElement(n.MonthsDropdown,{key:"month",className:c[Bt.MonthsDropdown],"aria-label":te(),classNames:c,components:n,disabled:!!r.disableNavigation,onChange:pt(Be.date),options:Y9(Be.date,T,A,a,s),style:L==null?void 0:L[Bt.Dropdown],value:s.getMonth(Be.date)}):Ke.createElement("span",{key:"month"},q(Be.date,s)),dt=i==="dropdown"||i==="dropdown-years"?Ke.createElement(n.YearsDropdown,{key:"year",className:c[Bt.YearsDropdown],"aria-label":_e(s.options),classNames:c,components:n,disabled:!!r.disableNavigation,onChange:Je(Be.date),options:Z9(T,A,a,s,!!r.reverseYears),style:L==null?void 0:L[Bt.Dropdown],value:s.getYear(Be.date)}):Ke.createElement("span",{key:"year"},D(Be.date,s));return s.getMonthYearOrder()==="year-first"?[dt,et]:[et,dt]})(),Ke.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},H(Be.date,s.options,s))):Ke.createElement(n.CaptionLabel,{className:c[Bt.CaptionLabel],role:"status","aria-live":"polite"},H(Be.date,s.options,s))),p==="around"&&!r.hideNavigation&&wt===f-1&&Ke.createElement(n.NextMonthButton,{type:"button",className:c[Bt.NextMonthButton],tabIndex:j?void 0:-1,"aria-disabled":j?void 0:!0,"aria-label":ne(j),onClick:Ye,"data-animated-button":r.animate?"true":void 0},Ke.createElement(n.Chevron,{disabled:j?void 0:!0,className:c[Bt.Chevron],orientation:r.dir==="rtl"?"left":"right"})),wt===f-1&&p==="after"&&!r.hideNavigation&&Ke.createElement(n.Nav,{"data-animated-nav":r.animate?"true":void 0,className:c[Bt.Nav],style:L==null?void 0:L[Bt.Nav],"aria-label":he(),onPreviousClick:Pe,onNextClick:Ye,previousMonth:S,nextMonth:j}),Ke.createElement(n.MonthGrid,{role:"grid","aria-multiselectable":u==="multiple"||u==="range","aria-label":ae(Be.date,s.options,s)||void 0,className:c[Bt.MonthGrid],style:L==null?void 0:L[Bt.MonthGrid]},!r.hideWeekdays&&Ke.createElement(n.Weekdays,{"data-animated-weekdays":r.animate?"true":void 0,className:c[Bt.Weekdays],style:L==null?void 0:L[Bt.Weekdays]},I&&Ke.createElement(n.WeekNumberHeader,{"aria-label":Se(s.options),className:c[Bt.WeekNumberHeader],style:L==null?void 0:L[Bt.WeekNumberHeader],scope:"col"},z()),Ce.map(et=>Ke.createElement(n.Weekday,{"aria-label":de(et,s.options,s),className:c[Bt.Weekday],key:String(et),style:L==null?void 0:L[Bt.Weekday],scope:"col"},W(et,s.options,s)))),Ke.createElement(n.Weeks,{"data-animated-weeks":r.animate?"true":void 0,className:c[Bt.Weeks],style:L==null?void 0:L[Bt.Weeks]},Be.weeks.map(et=>Ke.createElement(n.Week,{className:c[Bt.Week],key:et.weekNumber,style:L==null?void 0:L[Bt.Week],week:et},I&&Ke.createElement(n.WeekNumber,{week:et,style:L==null?void 0:L[Bt.WeekNumber],"aria-label":fe(et.weekNumber,{locale:l}),className:c[Bt.WeekNumber],scope:"row",role:"rowheader"},K(et.weekNumber,s)),et.days.map(dt=>{const{date:we}=dt,Ne=R(dt);if(Ne[$r.focused]=!Ne.hidden&&!!(Q!=null&&Q.isEqualTo(dt)),Ne[is.selected]=(X==null?void 0:X(we))||Ne.selected,qf(ee)){const{from:ke,to:De}=ee;Ne[is.range_start]=!!(ke&&De&&s.isSameDay(we,ke)),Ne[is.range_end]=!!(ke&&De&&s.isSameDay(we,De)),Ne[is.range_middle]=ei(ee,we,!0,s)}const lt=X9(Ne,L,r.modifiersStyles),Ct=j9(Ne,c,r.modifiersClassNames),$t=!Re&&!Ne.hidden?re(we,Ne,s.options,s):void 0;return Ke.createElement(n.Day,{key:`${dt.isoDate}_${dt.displayMonthId}`,day:dt,modifiers:Ne,className:Ct.join(" "),style:lt,role:"gridcell","aria-selected":Ne.selected||void 0,"aria-label":$t,"data-day":dt.isoDate,"data-month":dt.outside?dt.dateMonthId:void 0,"data-selected":Ne.selected||void 0,"data-disabled":Ne.disabled||void 0,"data-hidden":Ne.hidden||void 0,"data-outside":dt.outside||void 0,"data-focused":Ne.focused||void 0,"data-today":Ne.today||void 0},!Ne.hidden&&Re?Ke.createElement(n.DayButton,{className:c[Bt.DayButton],style:L==null?void 0:L[Bt.DayButton],type:"button",day:dt,modifiers:Ne,disabled:!Ne.focused&&Ne.disabled||void 0,"aria-disabled":Ne.focused&&Ne.disabled||void 0,tabIndex:P(dt)?0:-1,"aria-label":se(we,Ne,s.options,s),onClick:at(dt,Ne),onBlur:it(dt,Ne),onFocus:tt(dt,Ne),onKeyDown:rt(dt,Ne),onMouseEnter:ct(dt,Ne),onMouseLeave:Oe(dt,Ne)},V(we,s.options,s)):!Ne.hidden&&V(dt.date,s.options,s))})))))))),r.footer&&Ke.createElement(n.Footer,{className:c[Bt.Footer],style:L==null?void 0:L[Bt.Footer],role:"status","aria-live":"polite"},r.footer)))}function Pw({className:t,classNames:r,showOutsideDays:e=!0,captionLayout:n="label",buttonVariant:a="ghost",formatters:o,components:s,...l}){const c=Om();return k.jsx(_A,{showOutsideDays:e,className:At("bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,t),captionLayout:n,formatters:{formatMonthDropdown:i=>i.toLocaleString("default",{month:"short"}),...o},classNames:{root:At("w-fit",c.root),months:At("relative flex flex-col gap-4 md:flex-row",c.months),month:At("flex w-full flex-col gap-4",c.month),nav:At("absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1",c.nav),button_previous:At(jp({variant:a}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",c.button_previous),button_next:At(jp({variant:a}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",c.button_next),month_caption:At("flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]",c.month_caption),dropdowns:At("flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium",c.dropdowns),dropdown_root:At("has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border",c.dropdown_root),dropdown:At("bg-popover absolute inset-0 opacity-0",c.dropdown),caption_label:At("select-none font-medium",n==="label"?"text-sm":"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5",c.caption_label),table:"w-full border-collapse",weekdays:At("flex",c.weekdays),weekday:At("text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal",c.weekday),week:At("mt-2 flex w-full",c.week),week_number_header:At("w-[--cell-size] select-none",c.week_number_header),week_number:At("text-muted-foreground select-none text-[0.8rem]",c.week_number),day:At("group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md",c.day),range_start:At("bg-accent rounded-l-md",c.range_start),range_middle:At("rounded-none",c.range_middle),range_end:At("bg-accent rounded-r-md",c.range_end),today:At("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",c.today),outside:At("text-muted-foreground aria-selected:text-muted-foreground",c.outside),disabled:At("text-muted-foreground opacity-50",c.disabled),hidden:At("invisible",c.hidden),...r},components:{Root:({className:i,rootRef:u,...p})=>k.jsx("div",{"data-slot":"calendar",ref:u,className:At(i),...p}),Chevron:({className:i,orientation:u,...p})=>u==="left"?k.jsx(yu,{className:At("size-4",i),...p}):u==="right"?k.jsx(wu,{className:At("size-4",i),...p}):k.jsx(Uu,{className:At("size-4",i),...p}),DayButton:SA,WeekNumber:({children:i,...u})=>k.jsx("td",{...u,children:k.jsx("div",{className:"flex size-[--cell-size] items-center justify-center text-center",children:i})}),...s},...l})}function SA({className:t,day:r,modifiers:e,...n}){const a=Om(),o=ye.useRef(null);return ye.useEffect(()=>{var s;e.focused&&((s=o.current)==null||s.focus())},[e.focused]),k.jsx(Nt,{ref:o,variant:"ghost",size:"icon","data-day":r.date.toLocaleDateString(),"data-selected-single":e.selected&&!e.range_start&&!e.range_end&&!e.range_middle,"data-range-start":e.range_start,"data-range-end":e.range_end,"data-range-middle":e.range_middle,className:At("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70",a.day,t),...n})}const kA=$f("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ia({className:t,variant:r,...e}){return k.jsx("div",{className:At(kA({variant:r}),t),...e})}const EA=t=>t?(...r)=>t(...r):(...r)=>fetch(...r);class Mm extends Error{constructor(r,e="FunctionsError",n){super(r),this.name=e,this.context=n}}class TA extends Mm{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class wx extends Mm{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class _x extends Mm{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var zp;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(zp||(zp={}));class AA{constructor(r,{headers:e={},customFetch:n,region:a=zp.Any}={}){this.url=r,this.headers=e,this.region=a,this.fetch=EA(n)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r){return V5(this,arguments,void 0,function*(e,n={}){var a;let o,s;try{const{headers:l,method:c,body:i,signal:u,timeout:p}=n;let f={},{region:h}=n;h||(h=this.region);const v=new URL(`${this.url}/${e}`);h&&h!=="any"&&(f["x-region"]=h,v.searchParams.set("forceFunctionRegion",h));let b;i&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",b=i):typeof i=="string"?(f["Content-Type"]="text/plain",b=i):typeof FormData<"u"&&i instanceof FormData?b=i:(f["Content-Type"]="application/json",b=JSON.stringify(i)):b=i;let g=u;p&&(s=new AbortController,o=setTimeout(()=>s.abort(),p),u?(g=s.signal,u.addEventListener("abort",()=>s.abort())):g=s.signal);const x=yield this.fetch(v.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),l),body:b,signal:g}).catch(I=>{throw new TA(I)}),y=x.headers.get("x-relay-error");if(y&&y==="true")throw new wx(x);if(!x.ok)throw new _x(x);let E=((a=x.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),N;return E==="application/json"?N=yield x.json():E==="application/octet-stream"||E==="application/pdf"?N=yield x.blob():E==="text/event-stream"?N=x:E==="multipart/form-data"?N=yield x.formData():N=yield x.text(),{data:N,error:null,response:x}}catch(l){return{data:null,error:l,response:l instanceof _x||l instanceof wx?l.context:void 0}}finally{o&&clearTimeout(o)}})}}var CA=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},NA=class{constructor(t){var r,e;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(e=t.isMaybeSingle)!==null&&e!==void 0?e:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){var e=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{let s=null,l=null,c=null,i=o.status,u=o.statusText;if(o.ok){var p,f;if(e.method!=="HEAD"){var h;const x=await o.text();x===""||(e.headers.get("Accept")==="text/csv"||e.headers.get("Accept")&&(!((h=e.headers.get("Accept"))===null||h===void 0)&&h.includes("application/vnd.pgrst.plan+text"))?l=x:l=JSON.parse(x))}const b=(p=e.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),g=(f=o.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");b&&g&&g.length>1&&(c=parseInt(g[1])),e.isMaybeSingle&&e.method==="GET"&&Array.isArray(l)&&(l.length>1?(s={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,c=null,i=406,u="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var v;const b=await o.text();try{s=JSON.parse(b),Array.isArray(s)&&o.status===404&&(l=[],s=null,i=200,u="OK")}catch{o.status===404&&b===""?(i=204,u="No Content"):s={message:b}}if(s&&e.isMaybeSingle&&(!(s==null||(v=s.details)===null||v===void 0)&&v.includes("0 rows"))&&(s=null,i=200,u="OK"),s&&e.shouldThrowOnError)throw new CA(s)}return{error:s,data:l,count:c,status:i,statusText:u}});return this.shouldThrowOnError||(a=a.catch(o=>{var s;let l="";const c=o==null?void 0:o.cause;if(c){var i,u,p,f;const v=(i=c==null?void 0:c.message)!==null&&i!==void 0?i:"",b=(u=c==null?void 0:c.code)!==null&&u!==void 0?u:"";l=`${(p=o==null?void 0:o.name)!==null&&p!==void 0?p:"FetchError"}: ${o==null?void 0:o.message}`,l+=`

Caused by: ${(f=c==null?void 0:c.name)!==null&&f!==void 0?f:"Error"}: ${v}`,b&&(l+=` (${b})`),c!=null&&c.stack&&(l+=`
${c.stack}`)}else{var h;l=(h=o==null?void 0:o.stack)!==null&&h!==void 0?h:""}return{error:{message:`${(s=o==null?void 0:o.name)!==null&&s!==void 0?s:"FetchError"}: ${o==null?void 0:o.message}`,details:l,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}},OA=class extends NA{select(t){let r=!1;const e=(t??"*").split("").map(n=>/\s/.test(n)&&!r?"":(n==='"'&&(r=!r),n)).join("");return this.url.searchParams.set("select",e),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:e,foreignTable:n,referencedTable:a=n}={}){const o=a?`${a}.order`:"order",s=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${s?`${s},`:""}${t}.${r?"asc":"desc"}${e===void 0?"":e?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:e=r}={}){const n=typeof e>"u"?"limit":`${e}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,r,{foreignTable:e,referencedTable:n=e}={}){const a=typeof n>"u"?"offset":`${n}.offset`,o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this.url.searchParams.set(o,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:e=!1,buffers:n=!1,wal:a=!1,format:o="text"}={}){var s;const l=[t?"analyze":null,r?"verbose":null,e?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),c=(s=this.headers.get("Accept"))!==null&&s!==void 0?s:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${c}"; options=${l};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const Sx=new RegExp("[,()]");var Il=class extends OA{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}regexMatch(t,r){return this.url.searchParams.append(t,`match.${r}`),this}regexIMatch(t,r){return this.url.searchParams.append(t,`imatch.${r}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}isDistinct(t,r){return this.url.searchParams.append(t,`isdistinct.${r}`),this}in(t,r){const e=Array.from(new Set(r)).map(n=>typeof n=="string"&&Sx.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`in.(${e})`),this}notIn(t,r){const e=Array.from(new Set(r)).map(n=>typeof n=="string"&&Sx.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`not.in.(${e})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:e,type:n}={}){let a="";n==="plain"?a="pl":n==="phrase"?a="ph":n==="websearch"&&(a="w");const o=e===void 0?"":`(${e})`;return this.url.searchParams.append(t,`${a}fts${o}.${r}`),this}match(t){return Object.entries(t).forEach(([r,e])=>{this.url.searchParams.append(r,`eq.${e}`)}),this}not(t,r,e){return this.url.searchParams.append(t,`not.${r}.${e}`),this}or(t,{foreignTable:r,referencedTable:e=r}={}){const n=e?`${e}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,r,e){return this.url.searchParams.append(t,`${r}.${e}`),this}},jA=class{constructor(t,{headers:r={},schema:e,fetch:n}){this.url=t,this.headers=new Headers(r),this.schema=e,this.fetch=n}select(t,r){const{head:e=!1,count:n}=r??{},a=e?"HEAD":"GET";let o=!1;const s=(t??"*").split("").map(l=>/\s/.test(l)&&!o?"":(l==='"'&&(o=!o),l)).join("");return this.url.searchParams.set("select",s),n&&this.headers.append("Prefer",`count=${n}`),new Il({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:e=!0}={}){var n;const a="POST";if(r&&this.headers.append("Prefer",`count=${r}`),e||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const o=t.reduce((s,l)=>s.concat(Object.keys(l)),[]);if(o.length>0){const s=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",s.join(","))}}return new Il({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:e=!1,count:n,defaultToNull:a=!0}={}){var o;const s="POST";if(this.headers.append("Prefer",`resolution=${e?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),n&&this.headers.append("Prefer",`count=${n}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,i)=>c.concat(Object.keys(i)),[]);if(l.length>0){const c=[...new Set(l)].map(i=>`"${i}"`);this.url.searchParams.set("columns",c.join(","))}}return new Il({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(t,{count:r}={}){var e;const n="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Il({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}delete({count:t}={}){var r;const e="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Il({method:e,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}},DA=class Lw{constructor(r,{headers:e={},schema:n,fetch:a}={}){this.url=r,this.headers=new Headers(e),this.schemaName=n,this.fetch=a}from(r){if(!r||typeof r!="string"||r.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new jA(new URL(`${this.url}/${r}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(r){return new Lw(this.url,{headers:this.headers,schema:r,fetch:this.fetch})}rpc(r,e={},{head:n=!1,get:a=!1,count:o}={}){var s;let l;const c=new URL(`${this.url}/rpc/${r}`);let i;n||a?(l=n?"HEAD":"GET",Object.entries(e).filter(([p,f])=>f!==void 0).map(([p,f])=>[p,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([p,f])=>{c.searchParams.append(p,f)})):(l="POST",i=e);const u=new Headers(this.headers);return o&&u.set("Prefer",`count=${o}`),new Il({method:l,url:c,headers:u,schema:this.schemaName,body:i,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}};class MA{constructor(){}static detectEnvironment(){var r;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((r=navigator.userAgent)===null||r===void 0)&&r.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const e=process.versions;if(e&&e.node){const n=e.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const r=this.detectEnvironment();if(r.constructor)return r.constructor;let e=r.error||"WebSocket not supported in this environment.";throw r.workaround&&(e+=`

Suggested solution: ${r.workaround}`),new Error(e)}static createWebSocket(r,e){const n=this.getWebSocketConstructor();return new n(r,e)}static isWebSocketSupported(){try{const r=this.detectEnvironment();return r.type==="native"||r.type==="ws"}catch{return!1}}}const RA="2.89.0",FA=`realtime-js/${RA}`,Bw="1.0.0",IA="2.0.0",kx=Bw,$p=1e4,PA=1e3,LA=100;var Vi;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Vi||(Vi={}));var gn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(gn||(gn={}));var ns;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ns||(ns={}));var Vp;(function(t){t.websocket="websocket"})(Vp||(Vp={}));var Oo;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Oo||(Oo={}));class BA{constructor(r){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=r??[]}encode(r,e){if(r.event===this.BROADCAST_EVENT&&!(r.payload instanceof ArrayBuffer)&&typeof r.payload.event=="string")return e(this._binaryEncodeUserBroadcastPush(r));let n=[r.join_ref,r.ref,r.topic,r.event,r.payload];return e(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(r){var e;return this._isArrayBuffer((e=r.payload)===null||e===void 0?void 0:e.payload)?this._encodeBinaryUserBroadcastPush(r):this._encodeJsonUserBroadcastPush(r)}_encodeBinaryUserBroadcastPush(r){var e,n;const a=(n=(e=r.payload)===null||e===void 0?void 0:e.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(r,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(r){var e,n;const a=(n=(e=r.payload)===null||e===void 0?void 0:e.payload)!==null&&n!==void 0?n:{},s=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(r,this.JSON_ENCODING,s)}_encodeUserBroadcastPush(r,e,n){var a,o;const s=r.topic,l=(a=r.ref)!==null&&a!==void 0?a:"",c=(o=r.join_ref)!==null&&o!==void 0?o:"",i=r.payload.event,u=this.allowedMetadataKeys?this._pick(r.payload,this.allowedMetadataKeys):{},p=Object.keys(u).length===0?"":JSON.stringify(u);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(s.length>255)throw new Error(`topic length ${s.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`userEvent length ${i.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`metadata length ${p.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+s.length+i.length+p.length,h=new ArrayBuffer(this.HEADER_LENGTH+f);let v=new DataView(h),b=0;v.setUint8(b++,this.KINDS.userBroadcastPush),v.setUint8(b++,c.length),v.setUint8(b++,l.length),v.setUint8(b++,s.length),v.setUint8(b++,i.length),v.setUint8(b++,p.length),v.setUint8(b++,e),Array.from(c,x=>v.setUint8(b++,x.charCodeAt(0))),Array.from(l,x=>v.setUint8(b++,x.charCodeAt(0))),Array.from(s,x=>v.setUint8(b++,x.charCodeAt(0))),Array.from(i,x=>v.setUint8(b++,x.charCodeAt(0))),Array.from(p,x=>v.setUint8(b++,x.charCodeAt(0)));var g=new Uint8Array(h.byteLength+n.byteLength);return g.set(new Uint8Array(h),0),g.set(new Uint8Array(n),h.byteLength),g.buffer}decode(r,e){if(this._isArrayBuffer(r)){let n=this._binaryDecode(r);return e(n)}if(typeof r=="string"){const n=JSON.parse(r),[a,o,s,l,c]=n;return e({join_ref:a,ref:o,topic:s,event:l,payload:c})}return e({})}_binaryDecode(r){const e=new DataView(r),n=e.getUint8(0),a=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(r,e,a)}}_decodeUserBroadcast(r,e,n){const a=e.getUint8(1),o=e.getUint8(2),s=e.getUint8(3),l=e.getUint8(4);let c=this.HEADER_LENGTH+4;const i=n.decode(r.slice(c,c+a));c=c+a;const u=n.decode(r.slice(c,c+o));c=c+o;const p=n.decode(r.slice(c,c+s));c=c+s;const f=r.slice(c,r.byteLength),h=l===this.JSON_ENCODING?JSON.parse(n.decode(f)):f,v={type:this.BROADCAST_EVENT,event:u,payload:h};return s>0&&(v.meta=JSON.parse(p)),{join_ref:null,ref:null,topic:i,event:this.BROADCAST_EVENT,payload:v}}_isArrayBuffer(r){var e;return r instanceof ArrayBuffer||((e=r==null?void 0:r.constructor)===null||e===void 0?void 0:e.name)==="ArrayBuffer"}_pick(r,e){return!r||typeof r!="object"?{}:Object.fromEntries(Object.entries(r).filter(([n])=>e.includes(n)))}}class Uw{constructor(r,e){this.callback=r,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Rr;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Rr||(Rr={}));const Ex=(t,r,e={})=>{var n;const a=(n=e.skipTypes)!==null&&n!==void 0?n:[];return r?Object.keys(r).reduce((o,s)=>(o[s]=UA(s,t,r,a),o),{}):{}},UA=(t,r,e,n)=>{const a=r.find(l=>l.name===t),o=a==null?void 0:a.type,s=e[t];return o&&!n.includes(o)?zw(o,s):Hp(s)},zw=(t,r)=>{if(t.charAt(0)==="_"){const e=t.slice(1,t.length);return HA(r,e)}switch(t){case Rr.bool:return zA(r);case Rr.float4:case Rr.float8:case Rr.int2:case Rr.int4:case Rr.int8:case Rr.numeric:case Rr.oid:return $A(r);case Rr.json:case Rr.jsonb:return VA(r);case Rr.timestamp:return qA(r);case Rr.abstime:case Rr.date:case Rr.daterange:case Rr.int4range:case Rr.int8range:case Rr.money:case Rr.reltime:case Rr.text:case Rr.time:case Rr.timestamptz:case Rr.timetz:case Rr.tsrange:case Rr.tstzrange:return Hp(r);default:return Hp(r)}},Hp=t=>t,zA=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},$A=t=>{if(typeof t=="string"){const r=parseFloat(t);if(!Number.isNaN(r))return r}return t},VA=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},HA=(t,r)=>{if(typeof t!="string")return t;const e=t.length-1,n=t[e];if(t[0]==="{"&&n==="}"){let o;const s=t.slice(1,e);try{o=JSON.parse("["+s+"]")}catch{o=s?s.split(","):[]}return o.map(l=>zw(r,l))}return t},qA=t=>typeof t=="string"?t.replace(" ","T"):t,$w=t=>{const r=new URL(t);return r.protocol=r.protocol.replace(/^ws/i,"http"),r.pathname=r.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),r.pathname===""||r.pathname==="/"?r.pathname="/api/broadcast":r.pathname=r.pathname+"/api/broadcast",r.href};class cp{constructor(r,e,n={},a=$p){this.channel=r,this.event=e,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,e){var n;return this._hasReceived(r)&&e((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:r,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:e}){this.recHooks.filter(n=>n.status===r).forEach(n=>n.callback(e))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var Tx;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Tx||(Tx={}));class lu{constructor(r,e){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(e==null?void 0:e.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:o,onLeave:s,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=lu.syncState(this.state,a,o,s),this.pendingDiffs.forEach(c=>{this.state=lu.syncDiff(this.state,c,o,s)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},a=>{const{onJoin:o,onLeave:s,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=lu.syncDiff(this.state,a,o,s),l())}),this.onJoin((a,o,s)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:o,newPresences:s})}),this.onLeave((a,o,s)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:o,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,e,n,a){const o=this.cloneDeep(r),s=this.transformState(e),l={},c={};return this.map(o,(i,u)=>{s[i]||(c[i]=u)}),this.map(s,(i,u)=>{const p=o[i];if(p){const f=u.map(g=>g.presence_ref),h=p.map(g=>g.presence_ref),v=u.filter(g=>h.indexOf(g.presence_ref)<0),b=p.filter(g=>f.indexOf(g.presence_ref)<0);v.length>0&&(l[i]=v),b.length>0&&(c[i]=b)}else l[i]=u}),this.syncDiff(o,{joins:l,leaves:c},n,a)}static syncDiff(r,e,n,a){const{joins:o,leaves:s}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(o,(l,c)=>{var i;const u=(i=r[l])!==null&&i!==void 0?i:[];if(r[l]=this.cloneDeep(c),u.length>0){const p=r[l].map(h=>h.presence_ref),f=u.filter(h=>p.indexOf(h.presence_ref)<0);r[l].unshift(...f)}n(l,u,c)}),this.map(s,(l,c)=>{let i=r[l];if(!i)return;const u=c.map(p=>p.presence_ref);i=i.filter(p=>u.indexOf(p.presence_ref)<0),r[l]=i,a(l,i,c),i.length===0&&delete r[l]}),r}static map(r,e){return Object.getOwnPropertyNames(r).map(n=>e(n,r[n]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((e,n)=>{const a=r[n];return"metas"in a?e[n]=a.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):e[n]=a,e},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ax;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Ax||(Ax={}));var cu;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(cu||(cu={}));var Qs;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Qs||(Qs={}));class zl{constructor(r,e={config:{}},n){var a,o;if(this.topic=r,this.params=e,this.socket=n,this.bindings={},this.state=gn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new cp(this,ns.join,this.params,this.timeout),this.rejoinTimer=new Uw(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=gn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=gn.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=gn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=gn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=gn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ns.reply,{},(s,l)=>{this._trigger(this._replyEventName(l),s)}),this.presence=new lu(this),this.broadcastEndpointURL=$w(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(r,e=this.timeout){var n,a,o;if(this.socket.isConnected()||this.socket.connect(),this.state==gn.closed){const{config:{broadcast:s,presence:l,private:c}}=this.params,i=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(h=>h.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[cu.PRESENCE]&&this.bindings[cu.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,p={},f={broadcast:s,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:i,private:c};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(h=>r==null?void 0:r(Qs.CHANNEL_ERROR,h)),this._onClose(()=>r==null?void 0:r(Qs.CLOSED)),this.updateJoinPayload(Object.assign({config:f},p)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",async({postgres_changes:h})=>{var v;if(this.socket._isManualToken()||this.socket.setAuth(),h===void 0){r==null||r(Qs.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,g=(v=b==null?void 0:b.length)!==null&&v!==void 0?v:0,x=[];for(let y=0;y<g;y++){const E=b[y],{filter:{event:N,schema:I,table:L,filter:H}}=E,V=h&&h[y];if(V&&V.event===N&&zl.isFilterValueEqual(V.schema,I)&&zl.isFilterValueEqual(V.table,L)&&zl.isFilterValueEqual(V.filter,H))x.push(Object.assign(Object.assign({},E),{id:V.id}));else{this.unsubscribe(),this.state=gn.errored,r==null||r(Qs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,r&&r(Qs.SUBSCRIBED);return}}).receive("error",h=>{this.state=gn.errored,r==null||r(Qs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{r==null||r(Qs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,e={}){return await this.send({type:"presence",event:"track",payload:r},e.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,e,n){return this.state===gn.joined&&r===cu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(r,e,n)}async httpSend(r,e,n={}){var a;if(e==null)return Promise.reject("Payload is required for httpSend()");const o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const s={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:e,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,s,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const i=await l.json();c=i.error||i.message||c}catch{}return Promise.reject(new Error(c))}async send(r,e={}){var n,a;if(!this._canPush()&&r.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:s}=r,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:s,private:this.private}]})};try{const i=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=e.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=i.body)===null||a===void 0?void 0:a.cancel()),i.ok?"ok":"error"}catch(i){return i.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var s,l,c;const i=this._push(r.type,r,e.timeout||this.timeout);r.type==="broadcast"&&!(!((c=(l=(s=this.params)===null||s===void 0?void 0:s.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),i.receive("ok",()=>o("ok")),i.receive("error",()=>o("error")),i.receive("timeout",()=>o("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=gn.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ns.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new cp(this,ns.leave,{},r),n.receive("ok",()=>{e(),a("ok")}).receive("timeout",()=>{e(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(r=>r.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=gn.closed,this.bindings={}}async _fetchWithTimeout(r,e,n){const a=new AbortController,o=setTimeout(()=>a.abort(),n),s=await this.socket.fetch(r,Object.assign(Object.assign({},e),{signal:a.signal}));return clearTimeout(o),s}_push(r,e,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new cp(this,r,e,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(r){if(r.startTimeout(),this.pushBuffer.push(r),this.pushBuffer.length>LA){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(r,e,n){return e}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,e,n){var a,o;const s=r.toLocaleLowerCase(),{close:l,error:c,leave:i,join:u}=ns;if(n&&[l,c,i,u].indexOf(s)>=0&&n!==this._joinRef())return;let f=this._onMessage(s,e,n);if(e&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(h=>{var v,b,g;return((v=h.filter)===null||v===void 0?void 0:v.event)==="*"||((g=(b=h.filter)===null||b===void 0?void 0:b.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===s}).map(h=>h.callback(f,n)):(o=this.bindings[s])===null||o===void 0||o.filter(h=>{var v,b,g,x,y,E;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in h){const N=h.id,I=(v=h.filter)===null||v===void 0?void 0:v.event;return N&&((b=e.ids)===null||b===void 0?void 0:b.includes(N))&&(I==="*"||(I==null?void 0:I.toLocaleLowerCase())===((g=e.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const N=(y=(x=h==null?void 0:h.filter)===null||x===void 0?void 0:x.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return N==="*"||N===((E=e==null?void 0:e.event)===null||E===void 0?void 0:E.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===s}).map(h=>{if(typeof f=="object"&&"ids"in f){const v=f.data,{schema:b,table:g,commit_timestamp:x,type:y,errors:E}=v;f=Object.assign(Object.assign({},{schema:b,table:g,commit_timestamp:x,eventType:y,new:{},old:{},errors:E}),this._getPayloadRecords(v))}h.callback(f,n)})}_isClosed(){return this.state===gn.closed}_isJoined(){return this.state===gn.joined}_isJoining(){return this.state===gn.joining}_isLeaving(){return this.state===gn.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,e,n){const a=r.toLocaleLowerCase(),o={type:a,filter:e,callback:n};return this.bindings[a]?this.bindings[a].push(o):this.bindings[a]=[o],this}_off(r,e){const n=r.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var o;return!(((o=a.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===n&&zl.isEqual(a.filter,e))})),this}static isEqual(r,e){if(Object.keys(r).length!==Object.keys(e).length)return!1;for(const n in r)if(r[n]!==e[n])return!1;return!0}static isFilterValueEqual(r,e){return(r??void 0)===(e??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(ns.close,{},r)}_onError(r){this._on(ns.error,{},e=>r(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=gn.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const e={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(e.new=Ex(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(e.old=Ex(r.columns,r.old_record)),e}}const up=()=>{},of={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},WA=[1e3,2e3,5e3,1e4],GA=1e4,YA=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class XA{constructor(r,e){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=$p,this.transport=null,this.heartbeatIntervalMs=of.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=up,this.ref=0,this.reconnectTimer=null,this.vsn=kx,this.logger=up,this.conn=null,this.sendBuffer=[],this.serializer=new BA,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...o)=>a(...o):(...o)=>fetch(...o),!(!((n=e==null?void 0:e.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=e.params.apikey,this.endPoint=`${r}/${Vp.websocket}`,this.httpEndpoint=$w(r),this._initializeOptions(e),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(e==null?void 0:e.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=MA.createWebSocket(this.endpointURL())}catch(r){this._setConnectionState("disconnected");const e=r.message;throw e.includes("Node.js")?new Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(r,e){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(r?this.conn.close(r,e??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(r){const e=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),e}async removeAllChannels(){const r=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),r}log(r,e,n){this.logger(r,e,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Vi.connecting:return Oo.Connecting;case Vi.open:return Oo.Open;case Vi.closing:return Oo.Closing;default:return Oo.Closed}}isConnected(){return this.connectionState()===Oo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(r,e={config:{}}){const n=`realtime:${r}`,a=this.getChannels().find(o=>o.topic===n);if(a)return a;{const o=new zl(`realtime:${r}`,e,this);return this.channels.push(o),o}}push(r){const{topic:e,event:n,payload:a,ref:o}=r,s=()=>{this.encode(r,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${e} ${n} (${o})`,a),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(r=null){this._authPromise=this._performAuth(r);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var r;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,(r=this.conn)===null||r===void 0||r.close(PA,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout()},of.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")}onHeartbeat(r){this.heartbeatCallback=r}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let e=this.channels.find(n=>n.topic===r&&(n._isJoined()||n._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${r}"`),e.unsubscribe())}_remove(r){this.channels=this.channels.filter(e=>e.topic!==r.topic)}_onConnMessage(r){this.decode(r.data,e=>{if(e.topic==="phoenix"&&e.event==="phx_reply")try{this.heartbeatCallback(e.payload.status==="ok"?"ok":"error")}catch(i){this.log("error","error in heartbeat callback",i)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:o,ref:s}=e,l=s?`(${s})`:"",c=o.status||"";this.log("receive",`${c} ${n} ${a} ${l}`.trim(),o),this.channels.filter(i=>i._isMember(n)).forEach(i=>i._trigger(a,o,s)),this._triggerStateCallbacks("message",e)})}_clearTimer(r){var e;r==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):r==="reconnect"&&((e=this.reconnectTimer)===null||e===void 0||e.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r),this.conn.readyState===Vi.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Vi.open||this.conn.readyState===Vi.connecting)try{this.conn.close()}catch(r){this.log("error","Error closing connection",r)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(r=>r.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this._terminateWorker()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(r){var e;this._setConnectionState("disconnected"),this.log("transport","close",r),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout(),this._triggerStateCallbacks("close",r)}_onConnError(r){this._setConnectionState("disconnected"),this.log("transport",`${r}`),this._triggerChanError(),this._triggerStateCallbacks("error",r)}_triggerChanError(){this.channels.forEach(r=>r._trigger(ns.error))}_appendParams(r,e){if(Object.keys(e).length===0)return r;const n=r.match(/\?/)?"&":"?",a=new URLSearchParams(e);return`${r}${n}${a}`}_workerObjectUrl(r){let e;if(r)e=r;else{const n=new Blob([YA],{type:"application/javascript"});e=URL.createObjectURL(n)}return e}_setConnectionState(r,e=!1){this._connectionState=r,r==="connecting"?this._wasManualDisconnect=!1:r==="disconnecting"&&(this._wasManualDisconnect=e)}async _performAuth(r=null){let e,n=!1;if(r)e=r,n=!0;else if(this.accessToken)try{e=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),e=this.accessTokenValue}else e=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(a=>{const o={access_token:e,version:FA};e&&a.updateJoinPayload(o),a.joinedOnce&&a._isJoined()&&a._push(ns.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(r="general"){this._isManualToken()||this.setAuth().catch(e=>{this.log("error",`Error setting auth in ${r}`,e)})}_triggerStateCallbacks(r,e){try{this.stateChangeCallbacks[r].forEach(n=>{try{n(e)}catch(a){this.log("error",`error in ${r} callback`,a)}})}catch(n){this.log("error",`error triggering ${r} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Uw(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},of.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(r){var e,n,a,o,s,l,c,i,u,p,f,h;switch(this.transport=(e=r==null?void 0:r.transport)!==null&&e!==void 0?e:null,this.timeout=(n=r==null?void 0:r.timeout)!==null&&n!==void 0?n:$p,this.heartbeatIntervalMs=(a=r==null?void 0:r.heartbeatIntervalMs)!==null&&a!==void 0?a:of.HEARTBEAT_INTERVAL,this.worker=(o=r==null?void 0:r.worker)!==null&&o!==void 0?o:!1,this.accessToken=(s=r==null?void 0:r.accessToken)!==null&&s!==void 0?s:null,this.heartbeatCallback=(l=r==null?void 0:r.heartbeatCallback)!==null&&l!==void 0?l:up,this.vsn=(c=r==null?void 0:r.vsn)!==null&&c!==void 0?c:kx,r!=null&&r.params&&(this.params=r.params),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(i=r==null?void 0:r.reconnectAfterMs)!==null&&i!==void 0?i:v=>WA[v-1]||GA,this.vsn){case Bw:this.encode=(u=r==null?void 0:r.encode)!==null&&u!==void 0?u:(v,b)=>b(JSON.stringify(v)),this.decode=(p=r==null?void 0:r.decode)!==null&&p!==void 0?p:(v,b)=>b(JSON.parse(v));break;case IA:this.encode=(f=r==null?void 0:r.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(h=r==null?void 0:r.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=r==null?void 0:r.workerUrl}}}var ku=class extends Error{constructor(t,r){var e;super(t),this.name="IcebergError",this.status=r.status,this.icebergType=r.icebergType,this.icebergCode=r.icebergCode,this.details=r.details,this.isCommitStateUnknown=r.icebergType==="CommitStateUnknownException"||[500,502,504].includes(r.status)&&((e=r.icebergType)==null?void 0:e.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function KA(t,r,e){const n=new URL(r,t);if(e)for(const[a,o]of Object.entries(e))o!==void 0&&n.searchParams.set(a,o);return n.toString()}async function ZA(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function JA(t){const r=t.fetchImpl??globalThis.fetch;return{async request({method:e,path:n,query:a,body:o,headers:s}){const l=KA(t.baseUrl,n,a),c=await ZA(t.auth),i=await r(l,{method:e,headers:{...o?{"Content-Type":"application/json"}:{},...c,...s},body:o?JSON.stringify(o):void 0}),u=await i.text(),p=(i.headers.get("content-type")||"").includes("application/json"),f=p&&u?JSON.parse(u):u;if(!i.ok){const h=p?f:void 0,v=h==null?void 0:h.error;throw new ku((v==null?void 0:v.message)??`Request failed with status ${i.status}`,{status:i.status,icebergType:v==null?void 0:v.type,icebergCode:v==null?void 0:v.code,details:h})}return{status:i.status,headers:i.headers,data:f}}}}function lf(t){return t.join("")}var QA=class{constructor(t,r=""){this.client=t,this.prefix=r}async listNamespaces(t){const r=t?{parent:lf(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:r})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(t,r){const e={namespace:t.namespace,properties:r==null?void 0:r.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:e})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${lf(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${lf(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${lf(t.namespace)}`}),!0}catch(r){if(r instanceof ku&&r.status===404)return!1;throw r}}async createNamespaceIfNotExists(t,r){try{return await this.createNamespace(t,r)}catch(e){if(e instanceof ku&&e.status===409)return;throw e}}};function El(t){return t.join("")}var e7=class{constructor(t,r="",e){this.client=t,this.prefix=r,this.accessDelegation=e}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables`})).data.identifiers}async createTable(t,r){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables`,body:r,headers:e})).data.metadata}async updateTable(t,r){const e=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables/${t.name}`,body:r});return{"metadata-location":e.data["metadata-location"],metadata:e.data.metadata}}async dropTable(t,r){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((r==null?void 0:r.purge)??!1)}})}async loadTable(t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables/${t.name}`,headers:r})).data.metadata}async tableExists(t){const r={};this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables/${t.name}`,headers:r}),!0}catch(e){if(e instanceof ku&&e.status===404)return!1;throw e}}async createTableIfNotExists(t,r){try{return await this.createTable(t,r)}catch(e){if(e instanceof ku&&e.status===409)return await this.loadTable({namespace:t.namespace,name:r.name});throw e}}},t7=class{constructor(t){var n;let r="v1";t.catalogName&&(r+=`/${t.catalogName}`);const e=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=JA({baseUrl:e,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(n=t.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new QA(this.client,r),this.tableOps=new e7(this.client,r,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,r){return this.namespaceOps.createNamespace(t,r)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,r){return this.tableOps.createTable(t,r)}async updateTable(t,r){return this.tableOps.updateTable(t,r)}async dropTable(t,r){await this.tableOps.dropTable(t,r)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,r){return this.namespaceOps.createNamespaceIfNotExists(t,r)}async createTableIfNotExists(t,r){return this.tableOps.createTableIfNotExists(t,r)}},Gf=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function Ur(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var r7=class extends Gf{constructor(t,r,e){super(t),this.name="StorageApiError",this.status=r,this.statusCode=e}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},qp=class extends Gf{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}};const Rm=t=>t?(...r)=>t(...r):(...r)=>fetch(...r),n7=()=>Response,Wp=t=>{if(Array.isArray(t))return t.map(e=>Wp(e));if(typeof t=="function"||t!==Object(t))return t;const r={};return Object.entries(t).forEach(([e,n])=>{const a=e.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));r[a]=Wp(n)}),r},a7=t=>{if(typeof t!="object"||t===null)return!1;const r=Object.getPrototypeOf(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},s7=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Eu(t){"@babel/helpers - typeof";return Eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Eu(t)}function i7(t,r){if(Eu(t)!="object"||!t)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var n=e.call(t,r);if(Eu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function o7(t){var r=i7(t,"string");return Eu(r)=="symbol"?r:r+""}function l7(t,r,e){return(r=o7(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function Cx(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function Wt(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?Cx(Object(e),!0).forEach(function(n){l7(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Cx(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}const dp=t=>{var r;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(r=t.error)===null||r===void 0?void 0:r.message)||JSON.stringify(t)},c7=async(t,r,e)=>{t instanceof await n7()&&!(e!=null&&e.noResolveJson)?t.json().then(n=>{const a=t.status||500,o=(n==null?void 0:n.statusCode)||a+"";r(new r7(dp(n),a,o))}).catch(n=>{r(new qp(dp(n),n))}):r(new qp(dp(t),t))},u7=(t,r,e,n)=>{const a={method:t,headers:(r==null?void 0:r.headers)||{}};return t==="GET"||!n?a:(a7(n)?(a.headers=Wt({"Content-Type":"application/json"},r==null?void 0:r.headers),a.body=JSON.stringify(n)):a.body=n,r!=null&&r.duplex&&(a.duplex=r.duplex),Wt(Wt({},a),e))};async function qu(t,r,e,n,a,o){return new Promise((s,l)=>{t(e,u7(r,n,a,o)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>s(c)).catch(c=>c7(c,l,n))})}async function Tu(t,r,e,n){return qu(t,"GET",r,e,n)}async function rs(t,r,e,n,a){return qu(t,"POST",r,n,a,e)}async function Gp(t,r,e,n,a){return qu(t,"PUT",r,n,a,e)}async function d7(t,r,e,n){return qu(t,"HEAD",r,Wt(Wt({},e),{},{noResolveJson:!0}),n)}async function Fm(t,r,e,n,a){return qu(t,"DELETE",r,n,a,e)}var f7=class{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ur(r))return{data:null,error:r};throw r}}};let Vw;Vw=Symbol.toStringTag;var h7=class{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[Vw]="BlobDownloadBuilder",this.promise=null}asStream(){return new f7(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ur(r))return{data:null,error:r};throw r}}};const p7={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Nx={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var m7=class{constructor(t,r={},e,n){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=e,this.fetch=Rm(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,r,e,n){var a=this;try{let o;const s=Wt(Wt({},Nx),n);let l=Wt(Wt({},a.headers),t==="POST"&&{"x-upsert":String(s.upsert)});const c=s.metadata;typeof Blob<"u"&&e instanceof Blob?(o=new FormData,o.append("cacheControl",s.cacheControl),c&&o.append("metadata",a.encodeMetadata(c)),o.append("",e)):typeof FormData<"u"&&e instanceof FormData?(o=e,o.has("cacheControl")||o.append("cacheControl",s.cacheControl),c&&!o.has("metadata")&&o.append("metadata",a.encodeMetadata(c))):(o=e,l["cache-control"]=`max-age=${s.cacheControl}`,l["content-type"]=s.contentType,c&&(l["x-metadata"]=a.toBase64(a.encodeMetadata(c))),(typeof ReadableStream<"u"&&o instanceof ReadableStream||o&&typeof o=="object"&&"pipe"in o&&typeof o.pipe=="function")&&!s.duplex&&(s.duplex="half")),n!=null&&n.headers&&(l=Wt(Wt({},l),n.headers));const i=a._removeEmptyFolders(r),u=a._getFinalPath(i),p=await(t=="PUT"?Gp:rs)(a.fetch,`${a.url}/object/${u}`,o,Wt({headers:l},s!=null&&s.duplex?{duplex:s.duplex}:{}));return{data:{path:i,id:p.Id,fullPath:p.Key},error:null}}catch(o){if(a.shouldThrowOnError)throw o;if(Ur(o))return{data:null,error:o};throw o}}async upload(t,r,e){return this.uploadOrUpdate("POST",t,r,e)}async uploadToSignedUrl(t,r,e,n){var a=this;const o=a._removeEmptyFolders(t),s=a._getFinalPath(o),l=new URL(a.url+`/object/upload/sign/${s}`);l.searchParams.set("token",r);try{let c;const i=Wt({upsert:Nx.upsert},n),u=Wt(Wt({},a.headers),{"x-upsert":String(i.upsert)});return typeof Blob<"u"&&e instanceof Blob?(c=new FormData,c.append("cacheControl",i.cacheControl),c.append("",e)):typeof FormData<"u"&&e instanceof FormData?(c=e,c.append("cacheControl",i.cacheControl)):(c=e,u["cache-control"]=`max-age=${i.cacheControl}`,u["content-type"]=i.contentType),{data:{path:o,fullPath:(await Gp(a.fetch,l.toString(),c,{headers:u})).Key},error:null}}catch(c){if(a.shouldThrowOnError)throw c;if(Ur(c))return{data:null,error:c};throw c}}async createSignedUploadUrl(t,r){var e=this;try{let n=e._getFinalPath(t);const a=Wt({},e.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const o=await rs(e.fetch,`${e.url}/object/upload/sign/${n}`,{},{headers:a}),s=new URL(e.url+o.url),l=s.searchParams.get("token");if(!l)throw new Gf("No token returned by API");return{data:{signedUrl:s.toString(),path:t,token:l},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ur(n))return{data:null,error:n};throw n}}async update(t,r,e){return this.uploadOrUpdate("PUT",t,r,e)}async move(t,r,e){var n=this;try{return{data:await rs(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:t,destinationKey:r,destinationBucket:e==null?void 0:e.destinationBucket},{headers:n.headers}),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Ur(a))return{data:null,error:a};throw a}}async copy(t,r,e){var n=this;try{return{data:{path:(await rs(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:t,destinationKey:r,destinationBucket:e==null?void 0:e.destinationBucket},{headers:n.headers})).Key},error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Ur(a))return{data:null,error:a};throw a}}async createSignedUrl(t,r,e){var n=this;try{let a=n._getFinalPath(t),o=await rs(n.fetch,`${n.url}/object/sign/${a}`,Wt({expiresIn:r},e!=null&&e.transform?{transform:e.transform}:{}),{headers:n.headers});const s=e!=null&&e.download?`&download=${e.download===!0?"":e.download}`:"";return o={signedUrl:encodeURI(`${n.url}${o.signedURL}${s}`)},{data:o,error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Ur(a))return{data:null,error:a};throw a}}async createSignedUrls(t,r,e){var n=this;try{const a=await rs(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:r,paths:t},{headers:n.headers}),o=e!=null&&e.download?`&download=${e.download===!0?"":e.download}`:"";return{data:a.map(s=>Wt(Wt({},s),{},{signedUrl:s.signedURL?encodeURI(`${n.url}${s.signedURL}${o}`):null})),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Ur(a))return{data:null,error:a};throw a}}download(t,r){const e=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=n?`?${n}`:"",o=this._getFinalPath(t),s=()=>Tu(this.fetch,`${this.url}/${e}/${o}${a}`,{headers:this.headers,noResolveJson:!0});return new h7(s,this.shouldThrowOnError)}async info(t){var r=this;const e=r._getFinalPath(t);try{return{data:Wp(await Tu(r.fetch,`${r.url}/object/info/${e}`,{headers:r.headers})),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Ur(n))return{data:null,error:n};throw n}}async exists(t){var r=this;const e=r._getFinalPath(t);try{return await d7(r.fetch,`${r.url}/object/${e}`,{headers:r.headers}),{data:!0,error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Ur(n)&&n instanceof qp){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}}getPublicUrl(t,r){const e=this._getFinalPath(t),n=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&n.push(a);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});s!==""&&n.push(s);let l=n.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${e}${l}`)}}}async remove(t){var r=this;try{return{data:await Fm(r.fetch,`${r.url}/object/${r.bucketId}`,{prefixes:t},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(Ur(e))return{data:null,error:e};throw e}}async list(t,r,e){var n=this;try{const a=Wt(Wt(Wt({},p7),r),{},{prefix:t||""});return{data:await rs(n.fetch,`${n.url}/object/list/${n.bucketId}`,a,{headers:n.headers},e),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Ur(a))return{data:null,error:a};throw a}}async listV2(t,r){var e=this;try{const n=Wt({},t);return{data:await rs(e.fetch,`${e.url}/object/list-v2/${e.bucketId}`,n,{headers:e.headers},r),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ur(n))return{data:null,error:n};throw n}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}};const Hw="2.89.0",qw={"X-Client-Info":`storage-js/${Hw}`};var g7=class{constructor(t,r={},e,n){this.shouldThrowOnError=!1;const a=new URL(t);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Wt(Wt({},qw),r),this.fetch=Rm(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var r=this;try{const e=r.listBucketOptionsToQueryString(t);return{data:await Tu(r.fetch,`${r.url}/bucket${e}`,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(Ur(e))return{data:null,error:e};throw e}}async getBucket(t){var r=this;try{return{data:await Tu(r.fetch,`${r.url}/bucket/${t}`,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(Ur(e))return{data:null,error:e};throw e}}async createBucket(t,r={public:!1}){var e=this;try{return{data:await rs(e.fetch,`${e.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ur(n))return{data:null,error:n};throw n}}async updateBucket(t,r){var e=this;try{return{data:await Gp(e.fetch,`${e.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(Ur(n))return{data:null,error:n};throw n}}async emptyBucket(t){var r=this;try{return{data:await rs(r.fetch,`${r.url}/bucket/${t}/empty`,{},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(Ur(e))return{data:null,error:e};throw e}}async deleteBucket(t){var r=this;try{return{data:await Fm(r.fetch,`${r.url}/bucket/${t}`,{},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(Ur(e))return{data:null,error:e};throw e}}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}},v7=class{constructor(t,r={},e){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Wt(Wt({},qw),r),this.fetch=Rm(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var r=this;try{return{data:await rs(r.fetch,`${r.url}/bucket`,{name:t},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(Ur(e))return{data:null,error:e};throw e}}async listBuckets(t){var r=this;try{const e=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&e.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&e.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&e.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&e.set("sortOrder",t.sortOrder),t!=null&&t.search&&e.set("search",t.search);const n=e.toString(),a=n?`${r.url}/bucket?${n}`:`${r.url}/bucket`;return{data:await Tu(r.fetch,a,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(Ur(e))return{data:null,error:e};throw e}}async deleteBucket(t){var r=this;try{return{data:await Fm(r.fetch,`${r.url}/bucket/${t}`,{},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(Ur(e))return{data:null,error:e};throw e}}from(t){var r=this;if(!s7(t))throw new Gf("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const e=new t7({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>r.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(e,{get(a,o){const s=a[o];return typeof s!="function"?s:async(...l)=>{try{return{data:await s.apply(a,l),error:null}}catch(c){if(n)throw c;return{data:null,error:c}}}}})}};const Im={"X-Client-Info":`storage-js/${Hw}`,"Content-Type":"application/json"};var Ww=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function xa(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var fp=class extends Ww{constructor(t,r,e){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=e}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},b7=class extends Ww{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}};const Pm=t=>t?(...r)=>t(...r):(...r)=>fetch(...r),x7=t=>{if(typeof t!="object"||t===null)return!1;const r=Object.getPrototypeOf(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Ox=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),y7=async(t,r,e)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(e!=null&&e.noResolveJson)){const n=t.status||500,a=t;if(typeof a.json=="function")a.json().then(o=>{const s=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||n+"";r(new fp(Ox(o),n,s))}).catch(()=>{const o=n+"";r(new fp(a.statusText||`HTTP ${n} error`,n,o))});else{const o=n+"";r(new fp(a.statusText||`HTTP ${n} error`,n,o))}}else r(new b7(Ox(t),t))},w7=(t,r,e,n)=>{const a={method:t,headers:(r==null?void 0:r.headers)||{}};return n?(x7(n)?(a.headers=Wt({"Content-Type":"application/json"},r==null?void 0:r.headers),a.body=JSON.stringify(n)):a.body=n,Wt(Wt({},a),e)):a};async function _7(t,r,e,n,a,o){return new Promise((s,l)=>{t(e,w7(r,n,a,o)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;const i=c.headers.get("content-type");return!i||!i.includes("application/json")?{}:c.json()}).then(c=>s(c)).catch(c=>y7(c,l,n))})}async function ya(t,r,e,n,a){return _7(t,"POST",r,n,a,e)}var S7=class{constructor(t,r={},e){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Wt(Wt({},Im),r),this.fetch=Pm(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var r=this;try{return{data:await ya(r.fetch,`${r.url}/CreateIndex`,t,{headers:r.headers})||{},error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(xa(e))return{data:null,error:e};throw e}}async getIndex(t,r){var e=this;try{return{data:await ya(e.fetch,`${e.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(xa(n))return{data:null,error:n};throw n}}async listIndexes(t){var r=this;try{return{data:await ya(r.fetch,`${r.url}/ListIndexes`,t,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(xa(e))return{data:null,error:e};throw e}}async deleteIndex(t,r){var e=this;try{return{data:await ya(e.fetch,`${e.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(xa(n))return{data:null,error:n};throw n}}},k7=class{constructor(t,r={},e){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Wt(Wt({},Im),r),this.fetch=Pm(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var r=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await ya(r.fetch,`${r.url}/PutVectors`,t,{headers:r.headers})||{},error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(xa(e))return{data:null,error:e};throw e}}async getVectors(t){var r=this;try{return{data:await ya(r.fetch,`${r.url}/GetVectors`,t,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(xa(e))return{data:null,error:e};throw e}}async listVectors(t){var r=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await ya(r.fetch,`${r.url}/ListVectors`,t,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(xa(e))return{data:null,error:e};throw e}}async queryVectors(t){var r=this;try{return{data:await ya(r.fetch,`${r.url}/QueryVectors`,t,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(xa(e))return{data:null,error:e};throw e}}async deleteVectors(t){var r=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await ya(r.fetch,`${r.url}/DeleteVectors`,t,{headers:r.headers})||{},error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(xa(e))return{data:null,error:e};throw e}}},E7=class{constructor(t,r={},e){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Wt(Wt({},Im),r),this.fetch=Pm(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var r=this;try{return{data:await ya(r.fetch,`${r.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:r.headers})||{},error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(xa(e))return{data:null,error:e};throw e}}async getBucket(t){var r=this;try{return{data:await ya(r.fetch,`${r.url}/GetVectorBucket`,{vectorBucketName:t},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(xa(e))return{data:null,error:e};throw e}}async listBuckets(t={}){var r=this;try{return{data:await ya(r.fetch,`${r.url}/ListVectorBuckets`,t,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(xa(e))return{data:null,error:e};throw e}}async deleteBucket(t){var r=this;try{return{data:await ya(r.fetch,`${r.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:r.headers})||{},error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(xa(e))return{data:null,error:e};throw e}}},T7=class extends E7{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new A7(this.url,this.headers,t,this.fetch)}async createBucket(t){var r=()=>super.createBucket,e=this;return r().call(e,t)}async getBucket(t){var r=()=>super.getBucket,e=this;return r().call(e,t)}async listBuckets(t={}){var r=()=>super.listBuckets,e=this;return r().call(e,t)}async deleteBucket(t){var r=()=>super.deleteBucket,e=this;return r().call(e,t)}},A7=class extends S7{constructor(t,r,e,n){super(t,r,n),this.vectorBucketName=e}async createIndex(t){var r=()=>super.createIndex,e=this;return r().call(e,Wt(Wt({},t),{},{vectorBucketName:e.vectorBucketName}))}async listIndexes(t={}){var r=()=>super.listIndexes,e=this;return r().call(e,Wt(Wt({},t),{},{vectorBucketName:e.vectorBucketName}))}async getIndex(t){var r=()=>super.getIndex,e=this;return r().call(e,e.vectorBucketName,t)}async deleteIndex(t){var r=()=>super.deleteIndex,e=this;return r().call(e,e.vectorBucketName,t)}index(t){return new C7(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},C7=class extends k7{constructor(t,r,e,n,a){super(t,r,a),this.vectorBucketName=e,this.indexName=n}async putVectors(t){var r=()=>super.putVectors,e=this;return r().call(e,Wt(Wt({},t),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}async getVectors(t){var r=()=>super.getVectors,e=this;return r().call(e,Wt(Wt({},t),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}async listVectors(t={}){var r=()=>super.listVectors,e=this;return r().call(e,Wt(Wt({},t),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}async queryVectors(t){var r=()=>super.queryVectors,e=this;return r().call(e,Wt(Wt({},t),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}async deleteVectors(t){var r=()=>super.deleteVectors,e=this;return r().call(e,Wt(Wt({},t),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}},N7=class extends g7{constructor(t,r={},e,n){super(t,r,e,n)}from(t){return new m7(this.url,this.headers,t,this.fetch)}get vectors(){return new T7(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new v7(this.url+"/iceberg",this.headers,this.fetch)}};const Gw="2.89.0",Pl=30*1e3,Yp=3,hp=Yp*Pl,O7="http://localhost:9999",j7="supabase.auth.token",D7={"X-Client-Info":`gotrue-js/${Gw}`},Xp="X-Supabase-Api-Version",Yw={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},M7=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,R7=10*60*1e3;class Au extends Error{constructor(r,e,n){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=n}}function Pt(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class F7 extends Au{constructor(r,e,n){super(r,e,n),this.name="AuthApiError",this.status=e,this.code=n}}function I7(t){return Pt(t)&&t.name==="AuthApiError"}class jo extends Au{constructor(r,e){super(r),this.name="AuthUnknownError",this.originalError=e}}class li extends Au{constructor(r,e,n,a){super(r,n,a),this.name=e,this.status=n}}class pa extends li{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function P7(t){return Pt(t)&&t.name==="AuthSessionMissingError"}class Tl extends li{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class cf extends li{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class uf extends li{constructor(r,e=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function L7(t){return Pt(t)&&t.name==="AuthImplicitGrantRedirectError"}class jx extends li{constructor(r,e=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class B7 extends li{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Kp extends li{constructor(r,e){super(r,"AuthRetryableFetchError",e,void 0)}}function pp(t){return Pt(t)&&t.name==="AuthRetryableFetchError"}class Dx extends li{constructor(r,e,n){super(r,"AuthWeakPasswordError",e,"weak_password"),this.reasons=n}}class Zp extends li{constructor(r){super(r,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ef="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Mx=` 	
\r=`.split(""),U7=(()=>{const t=new Array(128);for(let r=0;r<t.length;r+=1)t[r]=-1;for(let r=0;r<Mx.length;r+=1)t[Mx[r].charCodeAt(0)]=-2;for(let r=0;r<Ef.length;r+=1)t[Ef[r].charCodeAt(0)]=r;return t})();function Rx(t,r,e){if(t!==null)for(r.queue=r.queue<<8|t,r.queuedBits+=8;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;e(Ef[n]),r.queuedBits-=6}else if(r.queuedBits>0)for(r.queue=r.queue<<6-r.queuedBits,r.queuedBits=6;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;e(Ef[n]),r.queuedBits-=6}}function Xw(t,r,e){const n=U7[t];if(n>-1)for(r.queue=r.queue<<6|n,r.queuedBits+=6;r.queuedBits>=8;)e(r.queue>>r.queuedBits-8&255),r.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Fx(t){const r=[],e=s=>{r.push(String.fromCodePoint(s))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},o=s=>{V7(s,n,e)};for(let s=0;s<t.length;s+=1)Xw(t.charCodeAt(s),a,o);return r.join("")}function z7(t,r){if(t<=127){r(t);return}else if(t<=2047){r(192|t>>6),r(128|t&63);return}else if(t<=65535){r(224|t>>12),r(128|t>>6&63),r(128|t&63);return}else if(t<=1114111){r(240|t>>18),r(128|t>>12&63),r(128|t>>6&63),r(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function $7(t,r){for(let e=0;e<t.length;e+=1){let n=t.charCodeAt(e);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(t.charCodeAt(e+1)-56320&65535|a)+65536,e+=1}z7(n,r)}}function V7(t,r,e){if(r.utf8seq===0){if(t<=127){e(t);return}for(let n=1;n<6;n+=1)if((t>>7-n&1)===0){r.utf8seq=n;break}if(r.utf8seq===2)r.codepoint=t&31;else if(r.utf8seq===3)r.codepoint=t&15;else if(r.utf8seq===4)r.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");r.utf8seq-=1}else if(r.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");r.codepoint=r.codepoint<<6|t&63,r.utf8seq-=1,r.utf8seq===0&&e(r.codepoint)}}function ql(t){const r=[],e={queue:0,queuedBits:0},n=a=>{r.push(a)};for(let a=0;a<t.length;a+=1)Xw(t.charCodeAt(a),e,n);return new Uint8Array(r)}function H7(t){const r=[];return $7(t,e=>r.push(e)),new Uint8Array(r)}function Ro(t){const r=[],e={queue:0,queuedBits:0},n=a=>{r.push(a)};return t.forEach(a=>Rx(a,e,n)),Rx(null,e,n),r.join("")}function q7(t){return Math.round(Date.now()/1e3)+t}function W7(){return Symbol("auth-callback")}const Nn=()=>typeof window<"u"&&typeof document<"u",Eo={tested:!1,writable:!1},Kw=()=>{if(!Nn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Eo.tested)return Eo.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Eo.tested=!0,Eo.writable=!0}catch{Eo.tested=!0,Eo.writable=!1}return Eo.writable};function G7(t){const r={},e=new URL(t);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((a,o)=>{r[o]=a})}catch{}return e.searchParams.forEach((n,a)=>{r[a]=n}),r}const Zw=t=>t?(...r)=>t(...r):(...r)=>fetch(...r),Y7=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Ll=async(t,r,e)=>{await t.setItem(r,JSON.stringify(e))},To=async(t,r)=>{const e=await t.getItem(r);if(!e)return null;try{return JSON.parse(e)}catch{return e}},Cn=async(t,r)=>{await t.removeItem(r)};class Yf{constructor(){this.promise=new Yf.promiseConstructor((r,e)=>{this.resolve=r,this.reject=e})}}Yf.promiseConstructor=Promise;function mp(t){const r=t.split(".");if(r.length!==3)throw new Zp("Invalid JWT structure");for(let n=0;n<r.length;n++)if(!M7.test(r[n]))throw new Zp("JWT not in base64url format");return{header:JSON.parse(Fx(r[0])),payload:JSON.parse(Fx(r[1])),signature:ql(r[2]),raw:{header:r[0],payload:r[1]}}}async function X7(t){return await new Promise(r=>{setTimeout(()=>r(null),t)})}function K7(t,r){return new Promise((n,a)=>{(async()=>{for(let o=0;o<1/0;o++)try{const s=await t(o);if(!r(o,null,s)){n(s);return}}catch(s){if(!r(o,s)){a(s);return}}})()})}function Z7(t){return("0"+t.toString(16)).substr(-2)}function J7(){const r=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=e.length;let a="";for(let o=0;o<56;o++)a+=e.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(r),Array.from(r,Z7).join("")}async function Q7(t){const e=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",e),a=new Uint8Array(n);return Array.from(a).map(o=>String.fromCharCode(o)).join("")}async function eC(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const e=await Q7(t);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Al(t,r,e=!1){const n=J7();let a=n;e&&(a+="/PASSWORD_RECOVERY"),await Ll(t,`${r}-code-verifier`,a);const o=await eC(n);return[o,n===o?"plain":"s256"]}const tC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function rC(t){const r=t.headers.get(Xp);if(!r||!r.match(tC))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}function nC(t){if(!t)throw new Error("Missing exp claim");const r=Math.floor(Date.now()/1e3);if(t<=r)throw new Error("JWT has expired")}function aC(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const sC=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Cl(t){if(!sC.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function gp(){const t={};return new Proxy(t,{get:(r,e)=>{if(e==="__isUserNotAvailableProxy")return!0;if(typeof e=="symbol"){const n=e.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${e}" property of the session object is not supported. Please use getUser() instead.`)},set:(r,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(r,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function iC(t,r){return new Proxy(t,{get:(e,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const o=n.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)"||o==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(e,n,a)}return!r.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),r.value=!0),Reflect.get(e,n,a)}})}function Ix(t){return JSON.parse(JSON.stringify(t))}const No=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),oC=[502,503,504];async function Px(t){var r;if(!Y7(t))throw new Kp(No(t),0);if(oC.includes(t.status))throw new Kp(No(t),t.status);let e;try{e=await t.json()}catch(o){throw new jo(No(o),o)}let n;const a=rC(t);if(a&&a.getTime()>=Yw["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?n=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(n=e.error_code),n){if(n==="weak_password")throw new Dx(No(e),t.status,((r=e.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(n==="session_not_found")throw new pa}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((o,s)=>o&&typeof s=="string",!0))throw new Dx(No(e),t.status,e.weak_password.reasons);throw new F7(No(e),t.status||500,n)}const lC=(t,r,e,n)=>{const a={method:t,headers:(r==null?void 0:r.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r==null?void 0:r.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),e))};async function qt(t,r,e,n){var a;const o=Object.assign({},n==null?void 0:n.headers);o[Xp]||(o[Xp]=Yw["2024-01-01"].name),n!=null&&n.jwt&&(o.Authorization=`Bearer ${n.jwt}`);const s=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(s.redirect_to=n.redirectTo);const l=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",c=await cC(t,r,e+l,{headers:o,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function cC(t,r,e,n,a,o){const s=lC(r,n,a,o);let l;try{l=await t(e,Object.assign({},s))}catch(c){throw console.error(c),new Kp(No(c),0)}if(l.ok||await Px(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await Px(c)}}function ts(t){var r;let e=null;fC(t)&&(e=Object.assign({},t),t.expires_at||(e.expires_at=q7(t.expires_in)));const n=(r=t.user)!==null&&r!==void 0?r:t;return{data:{session:e,user:n},error:null}}function Lx(t){const r=ts(t);return!r.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((e,n)=>e&&typeof n=="string",!0)&&(r.data.weak_password=t.weak_password),r}function Hi(t){var r;return{data:{user:(r=t.user)!==null&&r!==void 0?r:t},error:null}}function uC(t){return{data:t,error:null}}function dC(t){const{action_link:r,email_otp:e,hashed_token:n,redirect_to:a,verification_type:o}=t,s=zf(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:r,email_otp:e,hashed_token:n,redirect_to:a,verification_type:o},c=Object.assign({},s);return{data:{properties:l,user:c},error:null}}function Bx(t){return t}function fC(t){return t.access_token&&t.refresh_token&&t.expires_in}const vp=["global","local","others"];class hC{constructor({url:r="",headers:e={},fetch:n}){this.url=r,this.headers=e,this.fetch=Zw(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(r,e=vp[0]){if(vp.indexOf(e)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${vp.join(", ")}`);try{return await qt(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Pt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(r,e={}){try{return await qt(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:Hi})}catch(n){if(Pt(n))return{data:{user:null},error:n};throw n}}async generateLink(r){try{const{options:e}=r,n=zf(r,["options"]),a=Object.assign(Object.assign({},n),e);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await qt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:dC,redirectTo:e==null?void 0:e.redirectTo})}catch(e){if(Pt(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(r){try{return await qt(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:Hi})}catch(e){if(Pt(e))return{data:{user:null},error:e};throw e}}async listUsers(r){var e,n,a,o,s,l,c;try{const i={nextPage:null,lastPage:0,total:0},u=await qt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(e=r==null?void 0:r.page)===null||e===void 0?void 0:e.toString())!==null&&n!==void 0?n:"",per_page:(o=(a=r==null?void 0:r.perPage)===null||a===void 0?void 0:a.toString())!==null&&o!==void 0?o:""},xform:Bx});if(u.error)throw u.error;const p=await u.json(),f=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(v=>{const b=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(v.split(";")[1].split("=")[1]);i[`${g}Page`]=b}),i.total=parseInt(f)),{data:Object.assign(Object.assign({},p),i),error:null}}catch(i){if(Pt(i))return{data:{users:[]},error:i};throw i}}async getUserById(r){Cl(r);try{return await qt(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:Hi})}catch(e){if(Pt(e))return{data:{user:null},error:e};throw e}}async updateUserById(r,e){Cl(r);try{return await qt(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:e,headers:this.headers,xform:Hi})}catch(n){if(Pt(n))return{data:{user:null},error:n};throw n}}async deleteUser(r,e=!1){Cl(r);try{return await qt(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:e},xform:Hi})}catch(n){if(Pt(n))return{data:{user:null},error:n};throw n}}async _listFactors(r){Cl(r.userId);try{const{data:e,error:n}=await qt(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:e,error:n}}catch(e){if(Pt(e))return{data:null,error:e};throw e}}async _deleteFactor(r){Cl(r.userId),Cl(r.id);try{return{data:await qt(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(e){if(Pt(e))return{data:null,error:e};throw e}}async _listOAuthClients(r){var e,n,a,o,s,l,c;try{const i={nextPage:null,lastPage:0,total:0},u=await qt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(e=r==null?void 0:r.page)===null||e===void 0?void 0:e.toString())!==null&&n!==void 0?n:"",per_page:(o=(a=r==null?void 0:r.perPage)===null||a===void 0?void 0:a.toString())!==null&&o!==void 0?o:""},xform:Bx});if(u.error)throw u.error;const p=await u.json(),f=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(v=>{const b=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(v.split(";")[1].split("=")[1]);i[`${g}Page`]=b}),i.total=parseInt(f)),{data:Object.assign(Object.assign({},p),i),error:null}}catch(i){if(Pt(i))return{data:{clients:[]},error:i};throw i}}async _createOAuthClient(r){try{return await qt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:r,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(Pt(e))return{data:null,error:e};throw e}}async _getOAuthClient(r){try{return await qt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${r}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(Pt(e))return{data:null,error:e};throw e}}async _updateOAuthClient(r,e){try{return await qt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${r}`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Pt(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(r){try{return await qt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${r}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(e){if(Pt(e))return{data:null,error:e};throw e}}async _regenerateOAuthClientSecret(r){try{return await qt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${r}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(Pt(e))return{data:null,error:e};throw e}}}function Ux(t={}){return{getItem:r=>t[r]||null,setItem:(r,e)=>{t[r]=e},removeItem:r=>{delete t[r]}}}const Nl={debug:!!(globalThis&&Kw()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Jw extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class pC extends Jw{}async function mC(t,r,e){Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,r);const n=new globalThis.AbortController;return r>0&&setTimeout(()=>{n.abort(),Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await e()}finally{Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(r===0)throw Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new pC(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Nl.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await e()}}))}function gC(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Qw(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function vC(t){return parseInt(t,16)}function bC(t){const r=new TextEncoder().encode(t);return"0x"+Array.from(r,n=>n.toString(16).padStart(2,"0")).join("")}function xC(t){var r;const{chainId:e,domain:n,expirationTime:a,issuedAt:o=new Date,nonce:s,notBefore:l,requestId:c,resources:i,scheme:u,uri:p,version:f}=t;{if(!Number.isInteger(e))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${e}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(s&&s.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${s}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((r=t.statement)===null||r===void 0)&&r.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const h=Qw(t.address),v=u?`${u}://${n}`:n,b=t.statement?`${t.statement}
`:"",g=`${v} wants you to sign in with your Ethereum account:
${h}

${b}`;let x=`URI: ${p}
Version: ${f}
Chain ID: ${e}${s?`
Nonce: ${s}`:""}
Issued At: ${o.toISOString()}`;if(a&&(x+=`
Expiration Time: ${a.toISOString()}`),l&&(x+=`
Not Before: ${l.toISOString()}`),c&&(x+=`
Request ID: ${c}`),i){let y=`
Resources:`;for(const E of i){if(!E||typeof E!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${E}`);y+=`
- ${E}`}x+=y}return`${g}
${x}`}class cn extends Error{constructor({message:r,code:e,cause:n,name:a}){var o;super(r,{cause:n}),this.__isWebAuthnError=!0,this.name=(o=a??(n instanceof Error?n.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=e}}class Tf extends cn{constructor(r,e){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e,message:r}),this.name="WebAuthnUnknownError",this.originalError=e}}function yC({error:t,options:r}){var e,n,a;const{publicKey:o}=r;if(!o)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(r.signal instanceof AbortSignal)return new cn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((e=o.authenticatorSelection)===null||e===void 0?void 0:e.requireResidentKey)===!0)return new cn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(r.mediation==="conditional"&&((n=o.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new cn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((a=o.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new cn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new cn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new cn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return o.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new cn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new cn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(e_(s)){if(o.rp.id!==s)return new cn({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new cn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new cn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new cn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new cn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function wC({error:t,options:r}){const{publicKey:e}=r;if(!e)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(r.signal instanceof AbortSignal)return new cn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new cn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const n=window.location.hostname;if(e_(n)){if(e.rpId!==n)return new cn({message:`The RP ID "${e.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new cn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new cn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new cn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class _C{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const r=new AbortController;return this.controller=r,r.signal}cancelCeremony(){if(this.controller){const r=new Error("Manually cancelling existing WebAuthn API call");r.name="AbortError",this.controller.abort(r),this.controller=void 0}}}const SC=new _C;function kC(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:r,user:e,excludeCredentials:n}=t,a=zf(t,["challenge","user","excludeCredentials"]),o=ql(r).buffer,s=Object.assign(Object.assign({},e),{id:ql(e.id).buffer}),l=Object.assign(Object.assign({},a),{challenge:o,user:s});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const i=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},i),{id:ql(i.id).buffer,type:i.type||"public-key",transports:i.transports})}}return l}function EC(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:r,allowCredentials:e}=t,n=zf(t,["challenge","allowCredentials"]),a=ql(r).buffer,o=Object.assign(Object.assign({},n),{challenge:a});if(e&&e.length>0){o.allowCredentials=new Array(e.length);for(let s=0;s<e.length;s++){const l=e[s];o.allowCredentials[s]=Object.assign(Object.assign({},l),{id:ql(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return o}function TC(t){var r;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const e=t;return{id:t.id,rawId:t.id,response:{attestationObject:Ro(new Uint8Array(t.response.attestationObject)),clientDataJSON:Ro(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(r=e.authenticatorAttachment)!==null&&r!==void 0?r:void 0}}function AC(t){var r;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const e=t,n=t.getClientExtensionResults(),a=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Ro(new Uint8Array(a.authenticatorData)),clientDataJSON:Ro(new Uint8Array(a.clientDataJSON)),signature:Ro(new Uint8Array(a.signature)),userHandle:a.userHandle?Ro(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(r=e.authenticatorAttachment)!==null&&r!==void 0?r:void 0}}function e_(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function zx(){var t,r;return!!(Nn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((r=navigator==null?void 0:navigator.credentials)===null||r===void 0?void 0:r.get)=="function")}async function CC(t){try{const r=await navigator.credentials.create(t);return r?r instanceof PublicKeyCredential?{data:r,error:null}:{data:null,error:new Tf("Browser returned unexpected credential type",r)}:{data:null,error:new Tf("Empty credential response",r)}}catch(r){return{data:null,error:yC({error:r,options:t})}}}async function NC(t){try{const r=await navigator.credentials.get(t);return r?r instanceof PublicKeyCredential?{data:r,error:null}:{data:null,error:new Tf("Browser returned unexpected credential type",r)}:{data:null,error:new Tf("Empty credential response",r)}}catch(r){return{data:null,error:wC({error:r,options:t})}}}const OC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},jC={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Af(...t){const r=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),e=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of t)if(a)for(const o in a){const s=a[o];if(s!==void 0)if(Array.isArray(s))n[o]=s;else if(e(s))n[o]=s;else if(r(s)){const l=n[o];r(l)?n[o]=Af(l,s):n[o]=Af(s)}else n[o]=s}return n}function DC(t,r){return Af(OC,t,r||{})}function MC(t,r){return Af(jC,t,r||{})}class RC{constructor(r){this.client=r,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(r){return this.client.mfa.enroll(Object.assign(Object.assign({},r),{factorType:"webauthn"}))}async _challenge({factorId:r,webauthn:e,friendlyName:n,signal:a},o){try{const{data:s,error:l}=await this.client.mfa.challenge({factorId:r,webauthn:e});if(!s)return{data:null,error:l};const c=a??SC.createNewAbortSignal();if(s.webauthn.type==="create"){const{user:i}=s.webauthn.credential_options.publicKey;i.name||(i.name=`${i.id}:${n}`),i.displayName||(i.displayName=i.name)}switch(s.webauthn.type){case"create":{const i=DC(s.webauthn.credential_options.publicKey,o==null?void 0:o.create),{data:u,error:p}=await CC({publicKey:i,signal:c});return u?{data:{factorId:r,challengeId:s.id,webauthn:{type:s.webauthn.type,credential_response:u}},error:null}:{data:null,error:p}}case"request":{const i=MC(s.webauthn.credential_options.publicKey,o==null?void 0:o.request),{data:u,error:p}=await NC(Object.assign(Object.assign({},s.webauthn.credential_options),{publicKey:i,signal:c}));return u?{data:{factorId:r,challengeId:s.id,webauthn:{type:s.webauthn.type,credential_response:u}},error:null}:{data:null,error:p}}}}catch(s){return Pt(s)?{data:null,error:s}:{data:null,error:new jo("Unexpected error in challenge",s)}}}async _verify({challengeId:r,factorId:e,webauthn:n}){return this.client.mfa.verify({factorId:e,challengeId:r,webauthn:n})}async _authenticate({factorId:r,webauthn:{rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},o){if(!e)return{data:null,error:new Au("rpId is required for WebAuthn authentication")};try{if(!zx())return{data:null,error:new jo("Browser does not support WebAuthn",null)};const{data:s,error:l}=await this.challenge({factorId:r,webauthn:{rpId:e,rpOrigins:n},signal:a},{request:o});if(!s)return{data:null,error:l};const{webauthn:c}=s;return this._verify({factorId:r,challengeId:s.challengeId,webauthn:{type:c.type,rpId:e,rpOrigins:n,credential_response:c.credential_response}})}catch(s){return Pt(s)?{data:null,error:s}:{data:null,error:new jo("Unexpected error in authenticate",s)}}}async _register({friendlyName:r,webauthn:{rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},o){if(!e)return{data:null,error:new Au("rpId is required for WebAuthn registration")};try{if(!zx())return{data:null,error:new jo("Browser does not support WebAuthn",null)};const{data:s,error:l}=await this._enroll({friendlyName:r});if(!s)return await this.client.mfa.listFactors().then(u=>{var p;return(p=u.data)===null||p===void 0?void 0:p.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===r&&f.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:l};const{data:c,error:i}=await this._challenge({factorId:s.id,friendlyName:s.friendly_name,webauthn:{rpId:e,rpOrigins:n},signal:a},{create:o});return c?this._verify({factorId:s.id,challengeId:c.challengeId,webauthn:{rpId:e,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:i}}catch(s){return Pt(s)?{data:null,error:s}:{data:null,error:new jo("Unexpected error in register",s)}}}}gC();const FC={url:O7,storageKey:j7,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:D7,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function $x(t,r,e){return await e()}const Ol={};class Cu{get jwks(){var r,e;return(e=(r=Ol[this.storageKey])===null||r===void 0?void 0:r.jwks)!==null&&e!==void 0?e:{keys:[]}}set jwks(r){Ol[this.storageKey]=Object.assign(Object.assign({},Ol[this.storageKey]),{jwks:r})}get jwks_cached_at(){var r,e;return(e=(r=Ol[this.storageKey])===null||r===void 0?void 0:r.cachedAt)!==null&&e!==void 0?e:Number.MIN_SAFE_INTEGER}set jwks_cached_at(r){Ol[this.storageKey]=Object.assign(Object.assign({},Ol[this.storageKey]),{cachedAt:r})}constructor(r){var e,n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const o=Object.assign(Object.assign({},FC),r);if(this.storageKey=o.storageKey,this.instanceID=(e=Cu.nextInstanceID[this.storageKey])!==null&&e!==void 0?e:0,Cu.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.instanceID>0&&Nn()){const s=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(s),this.logDebugMessages&&console.trace(s)}if(this.persistSession=o.persistSession,this.autoRefreshToken=o.autoRefreshToken,this.admin=new hC({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=Zw(o.fetch),this.lock=o.lock||$x,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,this.throwOnError=o.throwOnError,o.lock?this.lock=o.lock:this.persistSession&&Nn()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=mC:this.lock=$x,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new RC(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:Kw()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ux(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=Ux(this.memoryStorage)),Nn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(r){if(this.throwOnError&&r&&r.error)throw r.error;return r}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Gw}) ${new Date().toISOString()}`}_debug(...r){return this.logDebugMessages&&this.logger(this._logPrefix(),...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{let e={},n="none";if(Nn()&&(e=G7(window.location.href),this._isImplicitGrantCallback(e)?n="implicit":await this._isPKCECallback(e)&&(n="pkce")),Nn()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:o}=await this._getSessionFromURL(e,n);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),L7(o)){const c=(r=o.details)===null||r===void 0?void 0:r.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:s,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",s,"redirect type",l),await this._saveSession(s),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return Pt(e)?this._returnResult({error:e}):this._returnResult({error:new jo("Unexpected error during initialization",e)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var e,n,a;try{const o=await qt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(e=r==null?void 0:r.options)===null||e===void 0?void 0:e.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=r==null?void 0:r.options)===null||a===void 0?void 0:a.captchaToken}},xform:ts}),{data:s,error:l}=o;if(l||!s)return this._returnResult({data:{user:null,session:null},error:l});const c=s.session,i=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:i,session:c},error:null})}catch(o){if(Pt(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signUp(r){var e,n,a;try{let o;if("email"in r){const{email:u,password:p,options:f}=r;let h=null,v=null;this.flowType==="pkce"&&([h,v]=await Al(this.storage,this.storageKey)),o=await qt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:p,data:(e=f==null?void 0:f.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:h,code_challenge_method:v},xform:ts})}else if("phone"in r){const{phone:u,password:p,options:f}=r;o=await qt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:p,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(a=f==null?void 0:f.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:ts})}else throw new cf("You must provide either an email or phone number and a password");const{data:s,error:l}=o;if(l||!s)return await Cn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=s.session,i=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:i,session:c},error:null})}catch(o){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),Pt(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithPassword(r){try{let e;if("email"in r){const{email:o,password:s,options:l}=r;e=await qt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:s,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Lx})}else if("phone"in r){const{phone:o,password:s,options:l}=r;e=await qt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:s,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Lx})}else throw new cf("You must provide either an email or phone number and a password");const{data:n,error:a}=e;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const o=new Tl;return this._returnResult({data:{user:null,session:null},error:o})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(e){if(Pt(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOAuth(r){var e,n,a,o;return await this._handleProviderSignIn(r.provider,{redirectTo:(e=r.options)===null||e===void 0?void 0:e.redirectTo,scopes:(n=r.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=r.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(o=r.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(r))}async signInWithWeb3(r){const{chain:e}=r;switch(e){case"ethereum":return await this.signInWithEthereum(r);case"solana":return await this.signInWithSolana(r);default:throw new Error(`@supabase/auth-js: Unsupported chain "${e}"`)}}async signInWithEthereum(r){var e,n,a,o,s,l,c,i,u,p,f;let h,v;if("message"in r)h=r.message,v=r.signature;else{const{chain:b,wallet:g,statement:x,options:y}=r;let E;if(Nn())if(typeof g=="object")E=g;else{const q=window;if("ethereum"in q&&typeof q.ethereum=="object"&&"request"in q.ethereum&&typeof q.ethereum.request=="function")E=q.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=g}const N=new URL((e=y==null?void 0:y.url)!==null&&e!==void 0?e:window.location.href),I=await E.request({method:"eth_requestAccounts"}).then(q=>q).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!I||I.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const L=Qw(I[0]);let H=(n=y==null?void 0:y.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!H){const q=await E.request({method:"eth_chainId"});H=vC(q)}const V={domain:N.host,address:L,statement:x,uri:N.href,version:"1",chainId:H,nonce:(a=y==null?void 0:y.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(s=(o=y==null?void 0:y.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&s!==void 0?s:new Date,expirationTime:(l=y==null?void 0:y.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=y==null?void 0:y.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(i=y==null?void 0:y.signInWithEthereum)===null||i===void 0?void 0:i.requestId,resources:(u=y==null?void 0:y.signInWithEthereum)===null||u===void 0?void 0:u.resources};h=xC(V),v=await E.request({method:"personal_sign",params:[bC(h),L]})}try{const{data:b,error:g}=await qt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:v},!((p=r.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(f=r.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:ts});if(g)throw g;if(!b||!b.session||!b.user){const x=new Tl;return this._returnResult({data:{user:null,session:null},error:x})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:g})}catch(b){if(Pt(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async signInWithSolana(r){var e,n,a,o,s,l,c,i,u,p,f,h;let v,b;if("message"in r)v=r.message,b=r.signature;else{const{chain:g,wallet:x,statement:y,options:E}=r;let N;if(Nn())if(typeof x=="object")N=x;else{const L=window;if("solana"in L&&typeof L.solana=="object"&&("signIn"in L.solana&&typeof L.solana.signIn=="function"||"signMessage"in L.solana&&typeof L.solana.signMessage=="function"))N=L.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(E!=null&&E.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=x}const I=new URL((e=E==null?void 0:E.url)!==null&&e!==void 0?e:window.location.href);if("signIn"in N&&N.signIn){const L=await N.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},E==null?void 0:E.signInWithSolana),{version:"1",domain:I.host,uri:I.href}),y?{statement:y}:null));let H;if(Array.isArray(L)&&L[0]&&typeof L[0]=="object")H=L[0];else if(L&&typeof L=="object"&&"signedMessage"in L&&"signature"in L)H=L;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in H&&"signature"in H&&(typeof H.signedMessage=="string"||H.signedMessage instanceof Uint8Array)&&H.signature instanceof Uint8Array)v=typeof H.signedMessage=="string"?H.signedMessage:new TextDecoder().decode(H.signedMessage),b=H.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in N)||typeof N.signMessage!="function"||!("publicKey"in N)||typeof N!="object"||!N.publicKey||!("toBase58"in N.publicKey)||typeof N.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${I.host} wants you to sign in with your Solana account:`,N.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${I.href}`,`Issued At: ${(a=(n=E==null?void 0:E.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((o=E==null?void 0:E.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${E.signInWithSolana.notBefore}`]:[],...!((s=E==null?void 0:E.signInWithSolana)===null||s===void 0)&&s.expirationTime?[`Expiration Time: ${E.signInWithSolana.expirationTime}`]:[],...!((l=E==null?void 0:E.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${E.signInWithSolana.chainId}`]:[],...!((c=E==null?void 0:E.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${E.signInWithSolana.nonce}`]:[],...!((i=E==null?void 0:E.signInWithSolana)===null||i===void 0)&&i.requestId?[`Request ID: ${E.signInWithSolana.requestId}`]:[],...!((p=(u=E==null?void 0:E.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||p===void 0)&&p.length?["Resources",...E.signInWithSolana.resources.map(H=>`- ${H}`)]:[]].join(`
`);const L=await N.signMessage(new TextEncoder().encode(v),"utf8");if(!L||!(L instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=L}}try{const{data:g,error:x}=await qt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Ro(b)},!((f=r.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=r.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:ts});if(x)throw x;if(!g||!g.session||!g.user){const y=new Tl;return this._returnResult({data:{user:null,session:null},error:y})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:x})}catch(g){if(Pt(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(r){const e=await To(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(e??"").split("/");try{if(!n&&this.flowType==="pkce")throw new B7;const{data:o,error:s}=await qt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:n},xform:ts});if(await Cn(this.storage,`${this.storageKey}-code-verifier`),s)throw s;if(!o||!o.session||!o.user){const l=new Tl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign(Object.assign({},o),{redirectType:a??null}),error:s})}catch(o){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),Pt(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}}async signInWithIdToken(r){try{const{options:e,provider:n,token:a,access_token:o,nonce:s}=r,l=await qt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:o,nonce:s,gotrue_meta_security:{captcha_token:e==null?void 0:e.captchaToken}},xform:ts}),{data:c,error:i}=l;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!c||!c.session||!c.user){const u=new Tl;return this._returnResult({data:{user:null,session:null},error:u})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:i})}catch(e){if(Pt(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOtp(r){var e,n,a,o,s;try{if("email"in r){const{email:l,options:c}=r;let i=null,u=null;this.flowType==="pkce"&&([i,u]=await Al(this.storage,this.storageKey));const{error:p}=await qt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(e=c==null?void 0:c.data)!==null&&e!==void 0?e:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:i,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in r){const{phone:l,options:c}=r,{data:i,error:u}=await qt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(o=c==null?void 0:c.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(s=c==null?void 0:c.channel)!==null&&s!==void 0?s:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:u})}throw new cf("You must provide either an email or phone number.")}catch(l){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),Pt(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(r){var e,n;try{let a,o;"options"in r&&(a=(e=r.options)===null||e===void 0?void 0:e.redirectTo,o=(n=r.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:l}=await qt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:o}}),redirectTo:a,xform:ts});if(l)throw l;if(!s)throw new Error("An error occurred on token verification.");const c=s.session,i=s.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:i,session:c},error:null})}catch(a){if(Pt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(r){var e,n,a,o,s;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Al(this.storage,this.storageKey));const i=await qt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(n=(e=r.options)===null||e===void 0?void 0:e.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=r==null?void 0:r.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:uC});return!((o=i.data)===null||o===void 0)&&o.url&&Nn()&&!(!((s=r.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(i.data.url),this._returnResult(i)}catch(l){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),Pt(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:e},error:n}=r;if(n)throw n;if(!e)throw new pa;const{error:a}=await qt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(r){if(Pt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async resend(r){try{const e=`${this.url}/resend`;if("email"in r){const{email:n,type:a,options:o}=r,{error:s}=await qt(this.fetch,"POST",e,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:s})}else if("phone"in r){const{phone:n,type:a,options:o}=r,{data:s,error:l}=await qt(this.fetch,"POST",e,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:l})}throw new cf("You must provide either an email or phone number and a type")}catch(e){if(Pt(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(r,e){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await e()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=e();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const e=await this.__loadSession();return await r(e)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const e=await To(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",e),e!==null&&(this._isValidSession(e)?r=e:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const n=r.expires_at?r.expires_at*1e3-Date.now()<hp:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",r.expires_at),!n){if(this.userStorage){const s=await To(this.userStorage,this.storageKey+"-user");s!=null&&s.user?r.user=s.user:r.user=gp()}if(this.storage.isServer&&r.user&&!r.user.__isUserNotAvailableProxy){const s={value:this.suppressGetSessionWarning};r.user=iC(r.user,s),s.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:r},error:null}}const{data:a,error:o}=await this._callRefreshToken(r.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(r){if(r)return await this._getUser(r);await this.initializePromise;const e=await this._acquireLock(-1,async()=>await this._getUser());return e.data.user&&(this.suppressGetSessionWarning=!0),e}async _getUser(r){try{return r?await qt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:Hi}):await this._useSession(async e=>{var n,a,o;const{data:s,error:l}=e;if(l)throw l;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new pa}:await qt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&o!==void 0?o:void 0,xform:Hi})})}catch(e){if(Pt(e))return P7(e)&&(await this._removeSession(),await Cn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:e});throw e}}async updateUser(r,e={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,e))}async _updateUser(r,e={}){try{return await this._useSession(async n=>{const{data:a,error:o}=n;if(o)throw o;if(!a.session)throw new pa;const s=a.session;let l=null,c=null;this.flowType==="pkce"&&r.email!=null&&([l,c]=await Al(this.storage,this.storageKey));const{data:i,error:u}=await qt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e==null?void 0:e.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:l,code_challenge_method:c}),jwt:s.access_token,xform:Hi});if(u)throw u;return s.user=i.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),this._returnResult({data:{user:s.user},error:null})})}catch(n){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),Pt(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new pa;const e=Date.now()/1e3;let n=e,a=!0,o=null;const{payload:s}=mp(r.access_token);if(s.exp&&(n=s.exp,a=n<=e),a){const{data:l,error:c}=await this._callRefreshToken(r.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};o=l}else{const{data:l,error:c}=await this._getUser(r.access_token);if(c)throw c;o={access_token:r.access_token,refresh_token:r.refresh_token,user:l.user,token_type:"bearer",expires_in:n-e,expires_at:n},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(e){if(Pt(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async e=>{var n;if(!r){const{data:s,error:l}=e;if(l)throw l;r=(n=s.session)!==null&&n!==void 0?n:void 0}if(!(r!=null&&r.refresh_token))throw new pa;const{data:a,error:o}=await this._callRefreshToken(r.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(e){if(Pt(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _getSessionFromURL(r,e){try{if(!Nn())throw new uf("No browser detected.");if(r.error||r.error_description||r.error_code)throw new uf(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(e){case"implicit":if(this.flowType==="pkce")throw new jx("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new uf("Not a valid implicit grant flow url.");break;default:}if(e==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new jx("No code detected.");const{data:y,error:E}=await this._exchangeCodeForSession(r.code);if(E)throw E;const N=new URL(window.location.href);return N.searchParams.delete("code"),window.history.replaceState(window.history.state,"",N.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:o,refresh_token:s,expires_in:l,expires_at:c,token_type:i}=r;if(!o||!l||!s||!i)throw new uf("No session defined in URL");const u=Math.round(Date.now()/1e3),p=parseInt(l);let f=u+p;c&&(f=parseInt(c));const h=f-u;h*1e3<=Pl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${p}s`);const v=f-p;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,f,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,f,u);const{data:b,error:g}=await this._getUser(o);if(g)throw g;const x={provider_token:n,provider_refresh_token:a,access_token:o,expires_in:p,expires_at:f,refresh_token:s,token_type:i,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:r.type},error:null})}catch(n){if(Pt(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(r){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),r):!!(r.access_token||r.error_description)}async _isPKCECallback(r){const e=await To(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&e)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async e=>{var n;const{data:a,error:o}=e;if(o)return this._returnResult({error:o});const s=(n=a.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:l}=await this.admin.signOut(s,r);if(l&&!(I7(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return r!=="others"&&(await this._removeSession(),await Cn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(r){const e=W7(),n={id:e,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",e),this.stateChangeEmitters.delete(e)}};return this._debug("#onAuthStateChange()","registered callback with id",e),this.stateChangeEmitters.set(e,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(e)})))(),{data:{subscription:n}}}async _emitInitialSession(r){return await this._useSession(async e=>{var n,a;try{const{data:{session:o},error:s}=e;if(s)throw s;await((n=this.stateChangeEmitters.get(r))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",r,"session",o)}catch(o){await((a=this.stateChangeEmitters.get(r))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",o),console.error(o)}})}async resetPasswordForEmail(r,e={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Al(this.storage,this.storageKey,!0));try{return await qt(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(o){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),Pt(o))return this._returnResult({data:null,error:o});throw o}}async getUserIdentities(){var r;try{const{data:e,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(r=e.user.identities)!==null&&r!==void 0?r:[]},error:null})}catch(e){if(Pt(e))return this._returnResult({data:null,error:e});throw e}}async linkIdentity(r){return"token"in r?this.linkIdentityIdToken(r):this.linkIdentityOAuth(r)}async linkIdentityOAuth(r){var e;try{const{data:n,error:a}=await this._useSession(async o=>{var s,l,c,i,u;const{data:p,error:f}=o;if(f)throw f;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(s=r.options)===null||s===void 0?void 0:s.redirectTo,scopes:(l=r.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=r.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await qt(this.fetch,"GET",h,{headers:this.headers,jwt:(u=(i=p.session)===null||i===void 0?void 0:i.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return Nn()&&!(!((e=r.options)===null||e===void 0)&&e.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:r.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Pt(n))return this._returnResult({data:{provider:r.provider,url:null},error:n});throw n}}async linkIdentityIdToken(r){return await this._useSession(async e=>{var n;try{const{error:a,data:{session:o}}=e;if(a)throw a;const{options:s,provider:l,token:c,access_token:i,nonce:u}=r,p=await qt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=o==null?void 0:o.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:i,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:ts}),{data:f,error:h}=p;return h?this._returnResult({data:{user:null,session:null},error:h}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Tl}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:h}))}catch(a){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),Pt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(r){try{return await this._useSession(async e=>{var n,a;const{data:o,error:s}=e;if(s)throw s;return await qt(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(a=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(e){if(Pt(e))return this._returnResult({data:null,error:e});throw e}}async _refreshAccessToken(r){const e=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(e,"begin");try{const n=Date.now();return await K7(async a=>(a>0&&await X7(200*Math.pow(2,a-1)),this._debug(e,"refreshing attempt",a),await qt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:ts})),(a,o)=>{const s=200*Math.pow(2,a);return o&&pp(o)&&Date.now()+s-n<Pl})}catch(n){if(this._debug(e,"error",n),Pt(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(e,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,e){const n=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",e,"url",n),Nn()&&!e.skipBrowserRedirect&&window.location.assign(n),{data:{provider:r,url:n},error:null}}async _recoverAndRefresh(){var r,e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await To(this.storage,this.storageKey);if(a&&this.userStorage){let s=await To(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!s&&(s={user:a.user},await Ll(this.userStorage,this.storageKey+"-user",s)),a.user=(r=s==null?void 0:s.user)!==null&&r!==void 0?r:gp()}else if(a&&!a.user&&!a.user){const s=await To(this.storage,this.storageKey+"-user");s&&(s!=null&&s.user)?(a.user=s.user,await Cn(this.storage,this.storageKey+"-user"),await Ll(this.storage,this.storageKey,a)):a.user=gp()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const o=((e=a.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<hp;if(this._debug(n,`session has${o?"":" not"} expired with margin of ${hp}s`),o){if(this.autoRefreshToken&&a.refresh_token){const{error:s}=await this._callRefreshToken(a.refresh_token);s&&(console.error(s),pp(s)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:s,error:l}=await this._getUser(a.access_token);!l&&(s!=null&&s.user)?(a.user=s.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(s){console.error("Error getting user data:",s),this._debug(n,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(r){var e,n;if(!r)throw new pa;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Yf;const{data:o,error:s}=await this._refreshAccessToken(r);if(s)throw s;if(!o.session)throw new pa;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const l={data:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(a,"error",o),Pt(o)){const s={data:null,error:o};return pp(o)||await this._removeSession(),(e=this.refreshingDeferred)===null||e===void 0||e.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(o),o}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(r,e,n=!0){const a=`#_notifyAllSubscribers(${r})`;this._debug(a,"begin",e,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:r,session:e});const o=[],s=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(r,e)}catch(c){o.push(c)}});if(await Promise.all(s),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(a,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0,await Cn(this.storage,`${this.storageKey}-code-verifier`);const e=Object.assign({},r),n=e.user&&e.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&e.user&&await Ll(this.userStorage,this.storageKey+"-user",{user:e.user});const a=Object.assign({},e);delete a.user;const o=Ix(a);await Ll(this.storage,this.storageKey,o)}else{const a=Ix(e);await Ll(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Cn(this.storage,this.storageKey),await Cn(this.storage,this.storageKey+"-code-verifier"),await Cn(this.storage,this.storageKey+"-user"),this.userStorage&&await Cn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&Nn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",r)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),Pl);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async e=>{const{data:{session:n}}=e;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-r)/Pl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Pl}ms, refresh threshold is ${Yp} ticks`),a<=Yp&&await this._callRefreshToken(n.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof Jw)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Nn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const e=`#_onVisibilityChanged(${r})`;this._debug(e,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(e,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,e,n){const a=[`provider=${encodeURIComponent(e)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[o,s]=await Al(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(s)}`});a.push(l.toString())}if(n!=null&&n.queryParams){const o=new URLSearchParams(n.queryParams);a.push(o.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${r}?${a.join("&")}`}async _unenroll(r){try{return await this._useSession(async e=>{var n;const{data:a,error:o}=e;return o?this._returnResult({data:null,error:o}):await qt(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(e){if(Pt(e))return this._returnResult({data:null,error:e});throw e}}async _enroll(r){try{return await this._useSession(async e=>{var n,a;const{data:o,error:s}=e;if(s)return this._returnResult({data:null,error:s});const l=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:r.factorType==="totp"?{issuer:r.issuer}:{}),{data:c,error:i}=await qt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=o==null?void 0:o.session)===null||n===void 0?void 0:n.access_token});return i?this._returnResult({data:null,error:i}):(r.factorType==="totp"&&c.type==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(e){if(Pt(e))return this._returnResult({data:null,error:e});throw e}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var n;const{data:a,error:o}=e;if(o)return this._returnResult({data:null,error:o});const s=Object.assign({challenge_id:r.challengeId},"webauthn"in r?{webauthn:Object.assign(Object.assign({},r.webauthn),{credential_response:r.webauthn.type==="create"?TC(r.webauthn.credential_response):AC(r.webauthn.credential_response)})}:{code:r.code}),{data:l,error:c}=await qt(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:s,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(e){if(Pt(e))return this._returnResult({data:null,error:e});throw e}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var n;const{data:a,error:o}=e;if(o)return this._returnResult({data:null,error:o});const s=await qt(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:r,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});if(s.error)return s;const{data:l}=s;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:kC(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:EC(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(e){if(Pt(e))return this._returnResult({data:null,error:e});throw e}})}async _challengeAndVerify(r){const{data:e,error:n}=await this._challenge({factorId:r.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:r.factorId,challengeId:e.id,code:r.code})}async _listFactors(){var r;const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const o of(r=e==null?void 0:e.factors)!==null&&r!==void 0?r:[])a.all.push(o),o.status==="verified"&&a[o.factor_type].push(o);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var r,e;const{data:{session:n},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=mp(n.access_token);let s=null;o.aal&&(s=o.aal);let l=s;((e=(r=n.user.factors)===null||r===void 0?void 0:r.filter(u=>u.status==="verified"))!==null&&e!==void 0?e:[]).length>0&&(l="aal2");const i=o.amr||[];return{data:{currentLevel:s,nextLevel:l,currentAuthenticationMethods:i},error:null}}async _getAuthorizationDetails(r){try{return await this._useSession(async e=>{const{data:{session:n},error:a}=e;return a?this._returnResult({data:null,error:a}):n?await qt(this.fetch,"GET",`${this.url}/oauth/authorizations/${r}`,{headers:this.headers,jwt:n.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new pa})})}catch(e){if(Pt(e))return this._returnResult({data:null,error:e});throw e}}async _approveAuthorization(r,e){try{return await this._useSession(async n=>{const{data:{session:a},error:o}=n;if(o)return this._returnResult({data:null,error:o});if(!a)return this._returnResult({data:null,error:new pa});const s=await qt(this.fetch,"POST",`${this.url}/oauth/authorizations/${r}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return s.data&&s.data.redirect_url&&Nn()&&!(e!=null&&e.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(n){if(Pt(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(r,e){try{return await this._useSession(async n=>{const{data:{session:a},error:o}=n;if(o)return this._returnResult({data:null,error:o});if(!a)return this._returnResult({data:null,error:new pa});const s=await qt(this.fetch,"POST",`${this.url}/oauth/authorizations/${r}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return s.data&&s.data.redirect_url&&Nn()&&!(e!=null&&e.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(n){if(Pt(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async r=>{const{data:{session:e},error:n}=r;return n?this._returnResult({data:null,error:n}):e?await qt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:e.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new pa})})}catch(r){if(Pt(r))return this._returnResult({data:null,error:r});throw r}}async _revokeOAuthGrant(r){try{return await this._useSession(async e=>{const{data:{session:n},error:a}=e;return a?this._returnResult({data:null,error:a}):n?(await qt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:r.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new pa})})}catch(e){if(Pt(e))return this._returnResult({data:null,error:e});throw e}}async fetchJwk(r,e={keys:[]}){let n=e.keys.find(l=>l.kid===r);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(l=>l.kid===r),n&&this.jwks_cached_at+R7>a)return n;const{data:o,error:s}=await qt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=a,n=o.keys.find(l=>l.kid===r),!n)?null:n}async getClaims(r,e={}){try{let n=r;if(!n){const{data:h,error:v}=await this.getSession();if(v||!h.session)return this._returnResult({data:null,error:v});n=h.session.access_token}const{header:a,payload:o,signature:s,raw:{header:l,payload:c}}=mp(n);e!=null&&e.allowExpired||nC(o.exp);const i=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,e!=null&&e.keys?{keys:e.keys}:e==null?void 0:e.jwks);if(!i){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:o,header:a,signature:s},error:null}}const u=aC(a.alg),p=await crypto.subtle.importKey("jwk",i,u,!0,["verify"]);if(!await crypto.subtle.verify(u,p,s,H7(`${l}.${c}`)))throw new Zp("Invalid JWT signature");return{data:{claims:o,header:a,signature:s},error:null}}catch(n){if(Pt(n))return this._returnResult({data:null,error:n});throw n}}}Cu.nextInstanceID={};const IC=Cu,PC="2.89.0";let nu="";typeof Deno<"u"?nu="deno":typeof document<"u"?nu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?nu="react-native":nu="node";const LC={"X-Client-Info":`supabase-js-${nu}/${PC}`},BC={headers:LC},UC={schema:"public"},zC={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},$C={};function Nu(t){"@babel/helpers - typeof";return Nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Nu(t)}function VC(t,r){if(Nu(t)!="object"||!t)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var n=e.call(t,r);if(Nu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function HC(t){var r=VC(t,"string");return Nu(r)=="symbol"?r:r+""}function qC(t,r,e){return(r=HC(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function Vx(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function Wr(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?Vx(Object(e),!0).forEach(function(n){qC(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Vx(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}const WC=t=>t?(...r)=>t(...r):(...r)=>fetch(...r),GC=()=>Headers,YC=(t,r,e)=>{const n=WC(e),a=GC();return async(o,s)=>{var l;const c=(l=await r())!==null&&l!==void 0?l:t;let i=new a(s==null?void 0:s.headers);return i.has("apikey")||i.set("apikey",t),i.has("Authorization")||i.set("Authorization",`Bearer ${c}`),n(o,Wr(Wr({},s),{},{headers:i}))}};function XC(t){return t.endsWith("/")?t:t+"/"}function KC(t,r){var e,n;const{db:a,auth:o,realtime:s,global:l}=t,{db:c,auth:i,realtime:u,global:p}=r,f={db:Wr(Wr({},c),a),auth:Wr(Wr({},i),o),realtime:Wr(Wr({},u),s),storage:{},global:Wr(Wr(Wr({},p),l),{},{headers:Wr(Wr({},(e=p==null?void 0:p.headers)!==null&&e!==void 0?e:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function ZC(t){const r=t==null?void 0:t.trim();if(!r)throw new Error("supabaseUrl is required.");if(!r.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(XC(r))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var JC=class extends IC{constructor(t){super(t)}},QC=class{constructor(t,r,e){var n,a;this.supabaseUrl=t,this.supabaseKey=r;const o=ZC(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const s=`sb-${o.hostname.split(".")[0]}-auth-token`,l={db:UC,realtime:$C,auth:Wr(Wr({},zC),{},{storageKey:s}),global:BC},c=KC(e??{},l);if(this.storageKey=(n=c.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=c.global.headers)!==null&&a!==void 0?a:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(u,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}});else{var i;this.auth=this._initSupabaseAuthClient((i=c.auth)!==null&&i!==void 0?i:{},this.headers,c.global.fetch)}this.fetch=YC(r,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Wr({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&this.accessToken().then(u=>this.realtime.setAuth(u)).catch(u=>console.warn("Failed to set initial Realtime auth token:",u)),this.rest=new DA(new URL("rest/v1",o).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new N7(this.storageUrl.href,this.headers,this.fetch,e==null?void 0:e.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new AA(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},e={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,e)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,r,e;if(t.accessToken)return await t.accessToken();const{data:n}=await t.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:e,storage:n,userStorage:a,storageKey:o,flowType:s,lock:l,debug:c,throwOnError:i},u,p){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new JC({url:this.authUrl.href,headers:Wr(Wr({},f),u),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:e,storage:n,userStorage:a,flowType:s,lock:l,debug:c,throwOnError:i,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new XA(this.realtimeUrl.href,Wr(Wr({},t),{},{params:Wr(Wr({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,r,e){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==e?(this.changedAccessToken=e,this.realtime.setAuth(e)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const eN=(t,r,e)=>new QC(t,r,e);function tN(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}tN()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const rN="https://tqelhhitxpahzllngamh.supabase.co",nN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRxZWxoaGl0eHBhaHpsbG5nYW1oIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY2NzMwMjksImV4cCI6MjA4MjI0OTAyOX0.fqtBXBNmMA1yGud_PXNqzXduEmW75kZ9b8CkttymFzI",Tt=eN(rN,nN),aN=Object.freeze(Object.defineProperty({__proto__:null,supabase:Tt},Symbol.toStringTag,{value:"Module"}));function Xf(){var h,v,b,g,x,y,E;const{filters:t,setFilters:r,resetFilters:e}=ec(),[n,a]=ye.useState(t.startDate),[o,s]=ye.useState([]),[l,c]=ye.useState([]),[i,u]=ye.useState([]),[p,f]=ye.useState([]);return ye.useEffect(()=>{(async()=>{const[I,L,H,V]=await Promise.all([Tt.from("setores").select("*").order("nome"),Tt.from("motivos_devolucao").select("id, nome").order("nome"),Tt.from("clientes").select("nome").order("nome"),Tt.from("devolucoes").select("vendedor").not("vendedor","is",null)]);if(I.data&&s(I.data.map(q=>({id:q.id,name:q.nome}))),L.data&&c(L.data),H.data){const q=Array.from(new Set(H.data.map(K=>K.nome))).filter(Boolean);u(q.map(K=>({nome:K})))}if(V.data){const q=Array.from(new Set(V.data.map(K=>K.vendedor))).filter(Boolean);f(q)}})()},[]),k.jsxs("div",{className:"w-full bg-card border-b p-4 space-y-4",children:[k.jsxs("div",{className:"relative w-full",children:[k.jsx(lk,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),k.jsx(wr,{placeholder:"Buscar por cliente, vendedor, cidade...",className:"pl-8",value:t.search||"",onChange:N=>r({search:N.target.value})})]}),k.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-2",children:[k.jsxs(La,{value:((h=t.resultado)==null?void 0:h[0])||"all",onValueChange:N=>r({resultado:N==="all"?void 0:[N]}),children:[k.jsx(ga,{className:"w-full",children:k.jsx(Ba,{placeholder:"Resultado"})}),k.jsxs(va,{children:[k.jsx(sr,{value:"all",children:"Todos os Resultados"}),k.jsx(sr,{value:"PENDENTE VALIDAO",children:"PENDENTE VALIDAO"}),k.jsx(sr,{value:"VALIDADA",children:"VALIDADA"}),k.jsx(sr,{value:"LANADA",children:"LANADA"}),k.jsx(sr,{value:"TRATATIVA DE ANULAO",children:"TRATATIVA DE ANULAO"}),k.jsx(sr,{value:"ANULADA/CANCELADA",children:"ANULADA/CANCELADA"})]})]}),k.jsxs(La,{value:((v=t.motivo)==null?void 0:v[0])||"all",onValueChange:N=>r({motivo:N==="all"?void 0:[N]}),children:[k.jsx(ga,{className:"w-full",children:k.jsx(Ba,{placeholder:"Motivo"})}),k.jsxs(va,{children:[k.jsx(sr,{value:"all",children:"Todos os Motivos"}),l.map(N=>k.jsx(sr,{value:N.id,children:N.nome},N.id))]})]}),k.jsxs(La,{value:((b=t.cliente)==null?void 0:b[0])||"all",onValueChange:N=>r({cliente:N==="all"?void 0:[N]}),children:[k.jsx(ga,{className:"w-full",children:k.jsx(Ba,{placeholder:"Cliente"})}),k.jsxs(va,{children:[k.jsx(sr,{value:"all",children:"Todos os Clientes"}),i.slice(0,100).map((N,I)=>k.jsx(sr,{value:N.nome,children:N.nome},I))]})]}),k.jsxs(La,{value:((g=t.vendedor)==null?void 0:g[0])||"all",onValueChange:N=>r({vendedor:N==="all"?void 0:[N]}),children:[k.jsx(ga,{className:"w-full",children:k.jsx(Ba,{placeholder:"Vendedor"})}),k.jsxs(va,{children:[k.jsx(sr,{value:"all",children:"Todos os Vendedores"}),p.map(N=>k.jsx(sr,{value:N,children:N},N))]})]}),k.jsxs(La,{value:((x=t.setor)==null?void 0:x[0])||"all",onValueChange:N=>r({setor:N==="all"?void 0:[N]}),children:[k.jsxs(ga,{className:"w-full",children:[k.jsx($S,{className:"mr-2 h-4 w-4 text-muted-foreground"}),k.jsx(Ba,{placeholder:"Setor"})]}),k.jsxs(va,{children:[k.jsx(sr,{value:"all",children:"Todos os Setores"}),o.map(N=>k.jsx(sr,{value:N.id,children:N.name},N.id))]})]}),k.jsxs(La,{value:t.period||"all",onValueChange:N=>r({period:N==="all"?void 0:N}),children:[k.jsx(ga,{className:"w-full",children:k.jsx(Ba,{placeholder:"Perodo"})}),k.jsxs(va,{children:[k.jsx(sr,{value:"all",children:"Todos os Perodos"}),k.jsx(sr,{value:"TODAY",children:"Hoje"}),k.jsx(sr,{value:"YESTERDAY",children:"Ontem"}),k.jsx(sr,{value:"THIS_WEEK",children:"Esta Semana"}),k.jsx(sr,{value:"LAST_WEEK",children:"Semana Passada"}),k.jsx(sr,{value:"THIS_MONTH",children:"Ms Atual"}),k.jsx(sr,{value:"LAST_MONTH",children:"Ms Anterior"}),k.jsx(sr,{value:"THIS_QUARTER",children:"Trimestre Atual"}),k.jsx(sr,{value:"THIS_SEMESTER",children:"Semestre Atual"}),k.jsx(sr,{value:"THIS_YEAR",children:"Ano Atual"}),k.jsx(sr,{value:"LAST_YEAR_AND_THIS_YEAR",children:"Ano Anterior + Ano Atual"})]})]})]}),k.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-start sm:items-center justify-between",children:[k.jsxs(Qk,{children:[k.jsx(eE,{asChild:!0,children:k.jsxs(Nt,{variant:"outline",className:At("w-full sm:w-[200px] justify-start text-left font-normal",!n&&"text-muted-foreground"),children:[k.jsx(bS,{className:"mr-2 h-4 w-4"}),n?Jt(n,"dd/MM/yyyy"):k.jsx("span",{children:"Data Especfica"})]})}),k.jsx(lw,{className:"w-auto p-0",align:"start",children:k.jsx(Pw,{mode:"single",selected:n,onSelect:N=>{a(N),r({startDate:N})},initialFocus:!0})})]}),k.jsxs(Nt,{variant:"ghost",size:"sm",onClick:()=>{e(),a(void 0)},className:"w-full sm:w-auto",children:[k.jsx(PS,{className:"mr-2 h-4 w-4"}),"Limpar Filtros"]})]}),k.jsxs("div",{className:"flex gap-2 flex-wrap",children:[t.period&&k.jsxs(Ia,{variant:"secondary",children:["Perodo: ",t.period]}),t.search&&k.jsxs(Ia,{variant:"secondary",children:["Busca: ",t.search]}),t.setor&&t.setor.length>0&&k.jsxs(Ia,{variant:"secondary",children:["Setor: ",((y=o.find(N=>{var I;return N.id===((I=t.setor)==null?void 0:I[0])}))==null?void 0:y.name)||"Selecionado"]}),t.resultado&&t.resultado.length>0&&k.jsxs(Ia,{variant:"secondary",children:["Resultado: ",t.resultado[0]]}),t.motivo&&t.motivo.length>0&&k.jsxs(Ia,{variant:"secondary",children:["Motivo: ",((E=l.find(N=>{var I;return N.id===((I=t.motivo)==null?void 0:I[0])}))==null?void 0:E.nome)||"Selecionado"]}),t.cliente&&t.cliente.length>0&&k.jsxs(Ia,{variant:"secondary",children:["Cliente: ",t.cliente[0]]}),t.vendedor&&t.vendedor.length>0&&k.jsxs(Ia,{variant:"secondary",children:["Vendedor: ",t.vendedor[0]]})]})]})}function Qi({title:t,description:r}){const[e,n]=ye.useState(!1),[a,o]=ye.useState(new Date);ye.useEffect(()=>{const c=()=>{n(document.documentElement.classList.contains("dark"))};c();const i=new MutationObserver(c);return i.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>i.disconnect()},[]),ye.useEffect(()=>{const c=setInterval(()=>{o(new Date)},1e3);return()=>clearInterval(c)},[]);const l=(c=>{const u=c.getTime()+c.getTimezoneOffset()*6e4;return new Date(u+-180*6e4)})(a);return k.jsx("div",{className:`w-full rounded-lg p-6 mb-6 ${e?"bg-gradient-to-r from-blue-600/20 to-blue-800/20 border border-blue-500/30":"bg-gradient-to-r from-green-600/10 to-green-700/10 border border-green-500/30"}`,children:k.jsxs("div",{className:"flex items-start justify-between",children:[k.jsxs("div",{className:"flex-1",children:[k.jsx("h1",{className:`text-3xl font-bold tracking-tight mb-2 ${e?"text-blue-100":"text-green-900"}`,children:t}),k.jsx("p",{className:`text-sm ${e?"text-blue-200/80":"text-green-800/80"}`,children:r})]}),k.jsxs("div",{className:`text-right ml-4 ${e?"text-blue-200":"text-green-800"}`,children:[k.jsx("div",{className:"text-sm font-medium",children:Jt(l,"dd/MM/yyyy",{locale:jr})}),k.jsxs("div",{className:"text-xs font-mono",children:[Jt(l,"HH:mm:ss",{locale:jr})," (BRT)"]})]})]})})}function sN(t,r){let e=0;const n=new Date(t);n.setHours(0,0,0,0);const a=new Date(r);for(a.setHours(0,0,0,0);n<=a;){const o=n.getDay();o!==0&&o!==6&&e++,n.setDate(n.getDate()+1)}return e}function Kf(t){if(!t)return{};const r=new Date;switch(t){case"TODAY":return{startDate:Ki(r),endDate:ap(r)};case"YESTERDAY":const e=bT(r);return{startDate:Ki(e),endDate:ap(e)};case"THIS_WEEK":return{startDate:Ji(r,{weekStartsOn:1}),endDate:kf(r,{weekStartsOn:1})};case"LAST_WEEK":const n=_T(r);return{startDate:Ji(n,{weekStartsOn:1}),endDate:kf(n,{weekStartsOn:1})};case"THIS_MONTH":return{startDate:Bp(r),endDate:Lp(r)};case"LAST_MONTH":const a=wT(r);return{startDate:Bp(a),endDate:Lp(a)};case"THIS_QUARTER":return{startDate:hE(r),endDate:gE(r)};case"THIS_SEMESTER":const o=r.getMonth()<6?new Date(r.getFullYear(),0,1):new Date(r.getFullYear(),6,1),s=r.getMonth()<6?new Date(r.getFullYear(),5,30):new Date(r.getFullYear(),11,31);return{startDate:Ki(o),endDate:ap(s)};case"THIS_YEAR":return{startDate:km(r),endDate:Up(r)};case"LAST_YEAR_AND_THIS_YEAR":const l=r.getFullYear()-1;return{startDate:new Date(l,0,1),endDate:Up(r)};default:return{}}}function iN(t){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style");e.type="text/css",r.appendChild(e),e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}const oN=t=>{switch(t){case"success":return uN;case"info":return fN;case"warning":return dN;case"error":return hN;default:return null}},lN=Array(12).fill(0),cN=({visible:t,className:r})=>Ke.createElement("div",{className:["sonner-loading-wrapper",r].filter(Boolean).join(" "),"data-visible":t},Ke.createElement("div",{className:"sonner-spinner"},lN.map((e,n)=>Ke.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),uN=Ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ke.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),dN=Ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Ke.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),fN=Ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ke.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),hN=Ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ke.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),pN=Ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Ke.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Ke.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),mN=()=>{const[t,r]=Ke.useState(document.hidden);return Ke.useEffect(()=>{const e=()=>{r(document.hidden)};return document.addEventListener("visibilitychange",e),()=>window.removeEventListener("visibilitychange",e)},[]),t};let Jp=1;class gN{constructor(){this.subscribe=r=>(this.subscribers.push(r),()=>{const e=this.subscribers.indexOf(r);this.subscribers.splice(e,1)}),this.publish=r=>{this.subscribers.forEach(e=>e(r))},this.addToast=r=>{this.publish(r),this.toasts=[...this.toasts,r]},this.create=r=>{var e;const{message:n,...a}=r,o=typeof(r==null?void 0:r.id)=="number"||((e=r.id)==null?void 0:e.length)>0?r.id:Jp++,s=this.toasts.find(c=>c.id===o),l=r.dismissible===void 0?!0:r.dismissible;return this.dismissedToasts.has(o)&&this.dismissedToasts.delete(o),s?this.toasts=this.toasts.map(c=>c.id===o?(this.publish({...c,...r,id:o,title:n}),{...c,...r,id:o,dismissible:l,title:n}):c):this.addToast({title:n,...a,dismissible:l,id:o}),o},this.dismiss=r=>(r?(this.dismissedToasts.add(r),requestAnimationFrame(()=>this.subscribers.forEach(e=>e({id:r,dismiss:!0})))):this.toasts.forEach(e=>{this.subscribers.forEach(n=>n({id:e.id,dismiss:!0}))}),r),this.message=(r,e)=>this.create({...e,message:r}),this.error=(r,e)=>this.create({...e,message:r,type:"error"}),this.success=(r,e)=>this.create({...e,type:"success",message:r}),this.info=(r,e)=>this.create({...e,type:"info",message:r}),this.warning=(r,e)=>this.create({...e,type:"warning",message:r}),this.loading=(r,e)=>this.create({...e,type:"loading",message:r}),this.promise=(r,e)=>{if(!e)return;let n;e.loading!==void 0&&(n=this.create({...e,promise:r,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));const a=Promise.resolve(r instanceof Function?r():r);let o=n!==void 0,s;const l=a.then(async i=>{if(s=["resolve",i],Ke.isValidElement(i))o=!1,this.create({id:n,type:"default",message:i});else if(bN(i)&&!i.ok){o=!1;const p=typeof e.error=="function"?await e.error(`HTTP error! status: ${i.status}`):e.error,f=typeof e.description=="function"?await e.description(`HTTP error! status: ${i.status}`):e.description,v=typeof p=="object"&&!Ke.isValidElement(p)?p:{message:p};this.create({id:n,type:"error",description:f,...v})}else if(i instanceof Error){o=!1;const p=typeof e.error=="function"?await e.error(i):e.error,f=typeof e.description=="function"?await e.description(i):e.description,v=typeof p=="object"&&!Ke.isValidElement(p)?p:{message:p};this.create({id:n,type:"error",description:f,...v})}else if(e.success!==void 0){o=!1;const p=typeof e.success=="function"?await e.success(i):e.success,f=typeof e.description=="function"?await e.description(i):e.description,v=typeof p=="object"&&!Ke.isValidElement(p)?p:{message:p};this.create({id:n,type:"success",description:f,...v})}}).catch(async i=>{if(s=["reject",i],e.error!==void 0){o=!1;const u=typeof e.error=="function"?await e.error(i):e.error,p=typeof e.description=="function"?await e.description(i):e.description,h=typeof u=="object"&&!Ke.isValidElement(u)?u:{message:u};this.create({id:n,type:"error",description:p,...h})}}).finally(()=>{o&&(this.dismiss(n),n=void 0),e.finally==null||e.finally.call(e)}),c=()=>new Promise((i,u)=>l.then(()=>s[0]==="reject"?u(s[1]):i(s[1])).catch(u));return typeof n!="string"&&typeof n!="number"?{unwrap:c}:Object.assign(n,{unwrap:c})},this.custom=(r,e)=>{const n=(e==null?void 0:e.id)||Jp++;return this.create({jsx:r(n),id:n,...e}),n},this.getActiveToasts=()=>this.toasts.filter(r=>!this.dismissedToasts.has(r.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const aa=new gN,vN=(t,r)=>{const e=(r==null?void 0:r.id)||Jp++;return aa.addToast({title:t,...r,id:e}),e},bN=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",xN=vN,yN=()=>aa.toasts,wN=()=>aa.getActiveToasts(),St=Object.assign(xN,{success:aa.success,info:aa.info,warning:aa.warning,error:aa.error,custom:aa.custom,message:aa.message,promise:aa.promise,dismiss:aa.dismiss,loading:aa.loading},{getHistory:yN,getToasts:wN});iN("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function df(t){return t.label!==void 0}const _N=3,SN="24px",kN="16px",Hx=4e3,EN=356,TN=14,AN=45,CN=200;function xs(...t){return t.filter(Boolean).join(" ")}function NN(t){const[r,e]=t.split("-"),n=[];return r&&n.push(r),e&&n.push(e),n}const ON=t=>{var r,e,n,a,o,s,l,c,i;const{invert:u,toast:p,unstyled:f,interacting:h,setHeights:v,visibleToasts:b,heights:g,index:x,toasts:y,expanded:E,removeToast:N,defaultRichColors:I,closeButton:L,style:H,cancelButtonStyle:V,actionButtonStyle:q,className:K="",descriptionClassName:z="",duration:W,position:D,gap:M,expandByDefault:C,classNames:w,icons:T,closeButtonAriaLabel:A="Close toast"}=t,[S,j]=Ke.useState(null),[B,R]=Ke.useState(null),[X,Y]=Ke.useState(!1),[ee,U]=Ke.useState(!1),[Q,P]=Ke.useState(!1),[F,Z]=Ke.useState(!1),[se,re]=Ke.useState(!1),[ae,te]=Ke.useState(0),[he,le]=Ke.useState(0),ne=Ke.useRef(p.duration||W||Hx),de=Ke.useRef(null),fe=Ke.useRef(null),Se=x===0,_e=x+1<=b,Ce=p.type,Re=p.dismissible!==!1,Pe=p.className||"",Ye=p.descriptionClassName||"",at=Ke.useMemo(()=>g.findIndex(we=>we.toastId===p.id)||0,[g,p.id]),tt=Ke.useMemo(()=>{var we;return(we=p.closeButton)!=null?we:L},[p.closeButton,L]),it=Ke.useMemo(()=>p.duration||W||Hx,[p.duration,W]),rt=Ke.useRef(0),ct=Ke.useRef(0),Oe=Ke.useRef(0),pt=Ke.useRef(null),[Je,ot]=D.split("-"),ut=Ke.useMemo(()=>g.reduce((we,Ne,lt)=>lt>=at?we:we+Ne.height,0),[g,at]),_t=mN(),vt=p.invert||u,ht=Ce==="loading";ct.current=Ke.useMemo(()=>at*M+ut,[at,ut]),Ke.useEffect(()=>{ne.current=it},[it]),Ke.useEffect(()=>{Y(!0)},[]),Ke.useEffect(()=>{const we=fe.current;if(we){const Ne=we.getBoundingClientRect().height;return le(Ne),v(lt=>[{toastId:p.id,height:Ne,position:p.position},...lt]),()=>v(lt=>lt.filter(Ct=>Ct.toastId!==p.id))}},[v,p.id]),Ke.useLayoutEffect(()=>{if(!X)return;const we=fe.current,Ne=we.style.height;we.style.height="auto";const lt=we.getBoundingClientRect().height;we.style.height=Ne,le(lt),v(Ct=>Ct.find(ke=>ke.toastId===p.id)?Ct.map(ke=>ke.toastId===p.id?{...ke,height:lt}:ke):[{toastId:p.id,height:lt,position:p.position},...Ct])},[X,p.title,p.description,v,p.id,p.jsx,p.action,p.cancel]);const $e=Ke.useCallback(()=>{U(!0),te(ct.current),v(we=>we.filter(Ne=>Ne.toastId!==p.id)),setTimeout(()=>{N(p)},CN)},[p,N,v,ct]);Ke.useEffect(()=>{if(p.promise&&Ce==="loading"||p.duration===1/0||p.type==="loading")return;let we;return E||h||_t?(()=>{if(Oe.current<rt.current){const Ct=new Date().getTime()-rt.current;ne.current=ne.current-Ct}Oe.current=new Date().getTime()})():(()=>{ne.current!==1/0&&(rt.current=new Date().getTime(),we=setTimeout(()=>{p.onAutoClose==null||p.onAutoClose.call(p,p),$e()},ne.current))})(),()=>clearTimeout(we)},[E,h,p,Ce,_t,$e]),Ke.useEffect(()=>{p.delete&&($e(),p.onDismiss==null||p.onDismiss.call(p,p))},[$e,p.delete]);function Be(){var we;if(T!=null&&T.loading){var Ne;return Ke.createElement("div",{className:xs(w==null?void 0:w.loader,p==null||(Ne=p.classNames)==null?void 0:Ne.loader,"sonner-loader"),"data-visible":Ce==="loading"},T.loading)}return Ke.createElement(cN,{className:xs(w==null?void 0:w.loader,p==null||(we=p.classNames)==null?void 0:we.loader),visible:Ce==="loading"})}const wt=p.icon||(T==null?void 0:T[Ce])||oN(Ce);var et,dt;return Ke.createElement("li",{tabIndex:0,ref:fe,className:xs(K,Pe,w==null?void 0:w.toast,p==null||(r=p.classNames)==null?void 0:r.toast,w==null?void 0:w.default,w==null?void 0:w[Ce],p==null||(e=p.classNames)==null?void 0:e[Ce]),"data-sonner-toast":"","data-rich-colors":(et=p.richColors)!=null?et:I,"data-styled":!(p.jsx||p.unstyled||f),"data-mounted":X,"data-promise":!!p.promise,"data-swiped":se,"data-removed":ee,"data-visible":_e,"data-y-position":Je,"data-x-position":ot,"data-index":x,"data-front":Se,"data-swiping":Q,"data-dismissible":Re,"data-type":Ce,"data-invert":vt,"data-swipe-out":F,"data-swipe-direction":B,"data-expanded":!!(E||C&&X),"data-testid":p.testId,style:{"--index":x,"--toasts-before":x,"--z-index":y.length-x,"--offset":`${ee?ae:ct.current}px`,"--initial-height":C?"auto":`${he}px`,...H,...p.style},onDragEnd:()=>{P(!1),j(null),pt.current=null},onPointerDown:we=>{we.button!==2&&(ht||!Re||(de.current=new Date,te(ct.current),we.target.setPointerCapture(we.pointerId),we.target.tagName!=="BUTTON"&&(P(!0),pt.current={x:we.clientX,y:we.clientY})))},onPointerUp:()=>{var we,Ne,lt;if(F||!Re)return;pt.current=null;const Ct=Number(((we=fe.current)==null?void 0:we.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),$t=Number(((Ne=fe.current)==null?void 0:Ne.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ke=new Date().getTime()-((lt=de.current)==null?void 0:lt.getTime()),De=S==="x"?Ct:$t,bt=Math.abs(De)/ke;if(Math.abs(De)>=AN||bt>.11){te(ct.current),p.onDismiss==null||p.onDismiss.call(p,p),R(S==="x"?Ct>0?"right":"left":$t>0?"down":"up"),$e(),Z(!0);return}else{var xt,Ae;(xt=fe.current)==null||xt.style.setProperty("--swipe-amount-x","0px"),(Ae=fe.current)==null||Ae.style.setProperty("--swipe-amount-y","0px")}re(!1),P(!1),j(null)},onPointerMove:we=>{var Ne,lt,Ct;if(!pt.current||!Re||((Ne=window.getSelection())==null?void 0:Ne.toString().length)>0)return;const ke=we.clientY-pt.current.y,De=we.clientX-pt.current.x;var bt;const xt=(bt=t.swipeDirections)!=null?bt:NN(D);!S&&(Math.abs(De)>1||Math.abs(ke)>1)&&j(Math.abs(De)>Math.abs(ke)?"x":"y");let Ae={x:0,y:0};const Le=nt=>1/(1.5+Math.abs(nt)/20);if(S==="y"){if(xt.includes("top")||xt.includes("bottom"))if(xt.includes("top")&&ke<0||xt.includes("bottom")&&ke>0)Ae.y=ke;else{const nt=ke*Le(ke);Ae.y=Math.abs(nt)<Math.abs(ke)?nt:ke}}else if(S==="x"&&(xt.includes("left")||xt.includes("right")))if(xt.includes("left")&&De<0||xt.includes("right")&&De>0)Ae.x=De;else{const nt=De*Le(De);Ae.x=Math.abs(nt)<Math.abs(De)?nt:De}(Math.abs(Ae.x)>0||Math.abs(Ae.y)>0)&&re(!0),(lt=fe.current)==null||lt.style.setProperty("--swipe-amount-x",`${Ae.x}px`),(Ct=fe.current)==null||Ct.style.setProperty("--swipe-amount-y",`${Ae.y}px`)}},tt&&!p.jsx&&Ce!=="loading"?Ke.createElement("button",{"aria-label":A,"data-disabled":ht,"data-close-button":!0,onClick:ht||!Re?()=>{}:()=>{$e(),p.onDismiss==null||p.onDismiss.call(p,p)},className:xs(w==null?void 0:w.closeButton,p==null||(n=p.classNames)==null?void 0:n.closeButton)},(dt=T==null?void 0:T.close)!=null?dt:pN):null,(Ce||p.icon||p.promise)&&p.icon!==null&&((T==null?void 0:T[Ce])!==null||p.icon)?Ke.createElement("div",{"data-icon":"",className:xs(w==null?void 0:w.icon,p==null||(a=p.classNames)==null?void 0:a.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||Be():null,p.type!=="loading"?wt:null):null,Ke.createElement("div",{"data-content":"",className:xs(w==null?void 0:w.content,p==null||(o=p.classNames)==null?void 0:o.content)},Ke.createElement("div",{"data-title":"",className:xs(w==null?void 0:w.title,p==null||(s=p.classNames)==null?void 0:s.title)},p.jsx?p.jsx:typeof p.title=="function"?p.title():p.title),p.description?Ke.createElement("div",{"data-description":"",className:xs(z,Ye,w==null?void 0:w.description,p==null||(l=p.classNames)==null?void 0:l.description)},typeof p.description=="function"?p.description():p.description):null),Ke.isValidElement(p.cancel)?p.cancel:p.cancel&&df(p.cancel)?Ke.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||V,onClick:we=>{df(p.cancel)&&Re&&(p.cancel.onClick==null||p.cancel.onClick.call(p.cancel,we),$e())},className:xs(w==null?void 0:w.cancelButton,p==null||(c=p.classNames)==null?void 0:c.cancelButton)},p.cancel.label):null,Ke.isValidElement(p.action)?p.action:p.action&&df(p.action)?Ke.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||q,onClick:we=>{df(p.action)&&(p.action.onClick==null||p.action.onClick.call(p.action,we),!we.defaultPrevented&&$e())},className:xs(w==null?void 0:w.actionButton,p==null||(i=p.classNames)==null?void 0:i.actionButton)},p.action.label):null)};function qx(){if(typeof window>"u"||typeof document>"u")return"ltr";const t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function jN(t,r){const e={};return[t,r].forEach((n,a)=>{const o=a===1,s=o?"--mobile-offset":"--offset",l=o?kN:SN;function c(i){["top","right","bottom","left"].forEach(u=>{e[`${s}-${u}`]=typeof i=="number"?`${i}px`:i})}typeof n=="number"||typeof n=="string"?c(n):typeof n=="object"?["top","right","bottom","left"].forEach(i=>{n[i]===void 0?e[`${s}-${i}`]=l:e[`${s}-${i}`]=typeof n[i]=="number"?`${n[i]}px`:n[i]}):c(l)}),e}const DN=Ke.forwardRef(function(r,e){const{id:n,invert:a,position:o="bottom-right",hotkey:s=["altKey","KeyT"],expand:l,closeButton:c,className:i,offset:u,mobileOffset:p,theme:f="light",richColors:h,duration:v,style:b,visibleToasts:g=_N,toastOptions:x,dir:y=qx(),gap:E=TN,icons:N,containerAriaLabel:I="Notifications"}=r,[L,H]=Ke.useState([]),V=Ke.useMemo(()=>n?L.filter(X=>X.toasterId===n):L.filter(X=>!X.toasterId),[L,n]),q=Ke.useMemo(()=>Array.from(new Set([o].concat(V.filter(X=>X.position).map(X=>X.position)))),[V,o]),[K,z]=Ke.useState([]),[W,D]=Ke.useState(!1),[M,C]=Ke.useState(!1),[w,T]=Ke.useState(f!=="system"?f:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),A=Ke.useRef(null),S=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),j=Ke.useRef(null),B=Ke.useRef(!1),R=Ke.useCallback(X=>{H(Y=>{var ee;return(ee=Y.find(U=>U.id===X.id))!=null&&ee.delete||aa.dismiss(X.id),Y.filter(({id:U})=>U!==X.id)})},[]);return Ke.useEffect(()=>aa.subscribe(X=>{if(X.dismiss){requestAnimationFrame(()=>{H(Y=>Y.map(ee=>ee.id===X.id?{...ee,delete:!0}:ee))});return}setTimeout(()=>{t8.flushSync(()=>{H(Y=>{const ee=Y.findIndex(U=>U.id===X.id);return ee!==-1?[...Y.slice(0,ee),{...Y[ee],...X},...Y.slice(ee+1)]:[X,...Y]})})})}),[L]),Ke.useEffect(()=>{if(f!=="system"){T(f);return}if(f==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?T("dark"):T("light")),typeof window>"u")return;const X=window.matchMedia("(prefers-color-scheme: dark)");try{X.addEventListener("change",({matches:Y})=>{T(Y?"dark":"light")})}catch{X.addListener(({matches:ee})=>{try{T(ee?"dark":"light")}catch(U){console.error(U)}})}},[f]),Ke.useEffect(()=>{L.length<=1&&D(!1)},[L]),Ke.useEffect(()=>{const X=Y=>{var ee;if(s.every(P=>Y[P]||Y.code===P)){var Q;D(!0),(Q=A.current)==null||Q.focus()}Y.code==="Escape"&&(document.activeElement===A.current||(ee=A.current)!=null&&ee.contains(document.activeElement))&&D(!1)};return document.addEventListener("keydown",X),()=>document.removeEventListener("keydown",X)},[s]),Ke.useEffect(()=>{if(A.current)return()=>{j.current&&(j.current.focus({preventScroll:!0}),j.current=null,B.current=!1)}},[A.current]),Ke.createElement("section",{ref:e,"aria-label":`${I} ${S}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},q.map((X,Y)=>{var ee;const[U,Q]=X.split("-");return V.length?Ke.createElement("ol",{key:X,dir:y==="auto"?qx():y,tabIndex:-1,ref:A,className:i,"data-sonner-toaster":!0,"data-sonner-theme":w,"data-y-position":U,"data-x-position":Q,style:{"--front-toast-height":`${((ee=K[0])==null?void 0:ee.height)||0}px`,"--width":`${EN}px`,"--gap":`${E}px`,...b,...jN(u,p)},onBlur:P=>{B.current&&!P.currentTarget.contains(P.relatedTarget)&&(B.current=!1,j.current&&(j.current.focus({preventScroll:!0}),j.current=null))},onFocus:P=>{P.target instanceof HTMLElement&&P.target.dataset.dismissible==="false"||B.current||(B.current=!0,j.current=P.relatedTarget)},onMouseEnter:()=>D(!0),onMouseMove:()=>D(!0),onMouseLeave:()=>{M||D(!1)},onDragEnd:()=>D(!1),onPointerDown:P=>{P.target instanceof HTMLElement&&P.target.dataset.dismissible==="false"||C(!0)},onPointerUp:()=>C(!1)},V.filter(P=>!P.position&&Y===0||P.position===X).map((P,F)=>{var Z,se;return Ke.createElement(ON,{key:P.id,icons:N,index:F,toast:P,defaultRichColors:h,duration:(Z=x==null?void 0:x.duration)!=null?Z:v,className:x==null?void 0:x.className,descriptionClassName:x==null?void 0:x.descriptionClassName,invert:a,visibleToasts:g,closeButton:(se=x==null?void 0:x.closeButton)!=null?se:c,interacting:M,position:X,style:x==null?void 0:x.style,unstyled:x==null?void 0:x.unstyled,classNames:x==null?void 0:x.classNames,cancelButtonStyle:x==null?void 0:x.cancelButtonStyle,actionButtonStyle:x==null?void 0:x.actionButtonStyle,closeButtonAriaLabel:x==null?void 0:x.closeButtonAriaLabel,removeToast:R,toasts:V.filter(re=>re.position==P.position),heights:K.filter(re=>re.position==P.position),setHeights:z,expandByDefault:l,gap:E,expanded:W,swipeDirections:r.swipeDirections})})):null}))}),MN=["#17432a","#17432a","#17432a","#17432a","#17432a","#17432a"],RN=["#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7"],Js=({x:t,y:r,payload:e})=>{const a=e.value.split(" ");let o=[],s="";return a.forEach(l=>{(s+l).length<=10?s+=`${l} `:(s.trim()&&o.push(s.trim()),s=`${l} `)}),s.trim()&&o.push(s.trim()),k.jsx("g",{transform:`translate(${t},${r})`,children:k.jsx("text",{x:0,y:0,dy:16,textAnchor:"middle",fill:"currentColor",fontSize:10,fontWeight:"bold",children:o.map((l,c)=>k.jsx("tspan",{x:"0",dy:c===0?0:14,children:l},c))})})};function FN(){const{filters:t}=ec(),{user:r}=Dn(),[e,n]=ye.useState(!0),[a,o]=ye.useState({totalValue:0,totalReturns:0,avgTicket:0,slaBreach:0,totalProducts:0}),[s,l]=ye.useState(0),[c,i]=ye.useState([]),[u,p]=ye.useState([]),[f,h]=ye.useState([]),[v,b]=ye.useState([]),[g,x]=ye.useState([]),[y,E]=ye.useState([]),[N,I]=ye.useState([]),[L,H]=ye.useState([]),[V,q]=ye.useState([]),[K,z]=ye.useState(!1),[W,D]=ye.useState([]),[M,C]=ye.useState([]),[w,T]=ye.useState([]),[A,S]=ye.useState([]),[j,B]=ye.useState([]),[R,X]=ye.useState([]);ye.useEffect(()=>{const F=()=>{z(document.documentElement.classList.contains("dark"))};F();const Z=new MutationObserver(F);return Z.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>Z.disconnect()},[]);const Y=K?RN:MN;ye.useEffect(()=>{ee()},[t,r]);const ee=async()=>{try{n(!0);const F=(r==null?void 0:r.role)==="VENDEDOR"?r.vendedor:null;let Z=Tt.from("devolucoes").select(`
          *,
          motivos_devolucao(nome),
          setores(nome),
          itens:itens_devolucao(quantidade, descricao, motivo_id, valor_total_bruto, unidade)
      `);r&&r.role==="VENDEDOR"&&F&&(Z=Z.eq("vendedor",F),console.log(" Dashboard - Filtrando por vendedor:",F));const se=t.period&&!t.startDate&&!t.endDate?Kf(t.period):{},re=t.startDate||se.startDate,ae=t.endDate||se.endDate;Z=Z.in("resultado",["PENDENTE VALIDAO","TRATATIVA DE ANULAO","VALIDADA"]),t.search&&(Z=Z.or(`nome_cliente.ilike.%${t.search}%,vendedor.ilike.%${t.search}%,numero.ilike.%${t.search}%`)),t.motivo&&t.motivo.length>0&&(Z=Z.in("motivo_id",t.motivo)),t.cliente&&t.cliente.length>0&&(Z=Z.in("nome_cliente",t.cliente)),t.vendedor&&t.vendedor.length>0&&(Z=Z.in("vendedor",t.vendedor)),t.setor&&t.setor.length>0&&(Z=Z.in("setor_id",t.setor)),re&&(Z=Z.gte("data_emissao",re.toISOString().split("T")[0])),ae&&(Z=Z.lte("data_emissao",ae.toISOString().split("T")[0]));const{data:te,error:he}=await Z;if(he){console.error(" Erro ao buscar dados do Dashboard:",he),St.error("Erro ao carregar dados do Dashboard: "+he.message),n(!1);return}if(!te||te.length===0){console.log(" Nenhuma devoluo encontrada para os filtros selecionados"),o({totalValue:0,totalReturns:0,avgTicket:0,slaBreach:0,totalProducts:0}),l(0),i([]),p([]),h([]),b([]),E([]),I([]),H([]),q([]),x([]),S([]),D([]),C([]),T([]),n(!1);return}if(te){console.log(` Dashboard: ${te.length} devolues carregadas`);const le=te.reduce((xe,Ee)=>xe+(Number(Ee.valor_total_nota)||0),0),ne=te.length,de=ne>0?le/ne:0,fe=te.reduce((xe,Ee)=>{const We=Ee.itens||[];return xe+We.reduce((ce,Te)=>ce+(Number(Te.quantidade)||0),0)},0),Se=te.filter(xe=>xe.prazo==="EM ATRASO").length,_e=te.filter(xe=>xe.resultado==="PENDENTE VALIDAO"||xe.resultado==="TRATATIVA DE ANULAO").reduce((xe,Ee)=>xe+(Number(Ee.valor_total_nota)||0),0);o({totalValue:le,totalReturns:ne,avgTicket:de,slaBreach:Se,totalProducts:fe}),l(_e);const Ce=te.reduce((xe,Ee)=>{const We=new Date(Ee.data_emissao||Ee.created_at),ce=Jt(We,"dd/MM",{locale:jr});return xe[ce]||(xe[ce]={value:0,count:0}),xe[ce].value+=Number(Ee.valor_total_nota)||0,xe[ce].count+=1,xe},{}),Re=Object.keys(Ce).sort((xe,Ee)=>{const We=new Date(xe.split("/").reverse().join("-")),ce=new Date(Ee.split("/").reverse().join("-"));return We.getTime()-ce.getTime()}).map(xe=>({name:xe,value:Ce[xe].value,count:Ce[xe].count}));i(Re);const Pe={};te.forEach(xe=>{const Ee=xe.nome_cliente||"Desconhecido",We=Number(xe.valor_total_nota)||0;Pe[Ee]||(Pe[Ee]={valor:0,detalhes:[]}),Pe[Ee].valor+=We,Pe[Ee].detalhes.push({cliente:Ee,nota:xe.numero||"-"})});const Ye=Object.entries(Pe).map(([xe,Ee])=>({name:xe,value:Ee.valor,quantidade:Ee.detalhes.length,detalhes:Ee.detalhes})).sort((xe,Ee)=>Ee.value-xe.value).slice(0,10);p(Ye);const at={};te.forEach(xe=>{const Ee=xe.vendedor||"Desconhecido",We=Number(xe.valor_total_nota)||0;at[Ee]||(at[Ee]={valor:0,detalhes:[]}),at[Ee].valor+=We,at[Ee].detalhes.push({cliente:xe.nome_cliente||"Desconhecido",nota:xe.numero||"-"})});const tt=Object.entries(at).map(([xe,Ee])=>({name:xe,value:Ee.valor,quantidade:Ee.detalhes.length,detalhes:Ee.detalhes})).sort((xe,Ee)=>Ee.value-xe.value).slice(0,5);h(tt);const it={};te.forEach(xe=>{let Ee=xe.rede||"Sem rede";Ee==="Sem rede"&&xe.cnpj_destinatario&&(Ee=xe.rede||"Sem rede");const We=Number(xe.valor_total_nota)||0;it[Ee]||(it[Ee]={valor:0,detalhes:[]}),it[Ee].valor+=We,it[Ee].detalhes.push({cliente:xe.nome_cliente||"Desconhecido",nota:xe.numero||"-"})});const rt=Object.entries(it).map(([xe,Ee])=>({name:xe,value:Ee.valor,quantidade:Ee.detalhes.length,detalhes:Ee.detalhes})).sort((xe,Ee)=>Ee.value-xe.value).slice(0,5);b(rt);const ct=Object.entries(Pe).map(([xe,Ee])=>({name:xe,value:Ee.valor,detalhes:Ee.detalhes})).sort((xe,Ee)=>Ee.value-xe.value);let Oe=0;const pt=ct.reduce((xe,Ee)=>xe+Ee.value,0),Je=ct.map((xe,Ee)=>(Oe+=xe.value,{name:xe.name.length>15?xe.name.substring(0,15)+"...":xe.name,value:xe.value,cumulative:Oe,percentage:Oe/pt*100,index:Ee+1,quantidade:xe.detalhes.length,detalhes:xe.detalhes})).slice(0,10);E(Je);const ot=te.filter(xe=>xe.resultado==="PENDENTE VALIDAO"),ut={};ot.forEach(xe=>{const Ee=xe.itens||[],We=xe.rede||"Sem rede";Ee.forEach(ce=>{const st=(ce.descricao||"Desconhecido").split(" ").slice(0,2).join(" ");ut[st]||(ut[st]={});const Et=Number(ce.quantidade)||0,gt=ce.unidade||"UN";ut[st][We]||(ut[st][We]={quantidade:0,unidade:gt}),ut[st][We].quantidade+=Et})});const _t=Object.keys(ut),vt=new Set;ot.forEach(xe=>{const Ee=xe.rede||"Sem rede";vt.add(Ee)});const ht=Array.from(vt).slice(0,8),$e=_t.map(xe=>{const Ee={produto:xe};return ht.forEach(We=>{var Te;const ce=(Te=ut[xe])==null?void 0:Te[We];Ee[We]=ce||{quantidade:0,unidade:"UN"}}),Ee});I($e);const Be=te.reduce((xe,Ee)=>{const We=Ee.motivos_devolucao,ce=typeof We=="object"&&(We!=null&&We.nome)?We.nome:typeof We=="string"?We:null;return ce&&ce!=="No informado"&&ce!=="no informado"&&ce!=="NO INFORMADO"&&(xe[ce]=(xe[ce]||0)+1),xe},{}),wt=Object.entries(Be).map(([xe,Ee])=>({name:xe,value:Ee})).sort((xe,Ee)=>Ee.value-xe.value).slice(0,5);console.log(" Reasons Chart:",wt),x(wt);const et=te.reduce((xe,Ee)=>{const We=Ee.cidade_origem||"N/A";return xe[We]=(xe[We]||0)+(Number(Ee.valor_total_nota)||0),xe},{}),dt=Object.entries(et).map(([xe,Ee])=>({name:xe,value:Ee})).sort((xe,Ee)=>Ee.value-xe.value).slice(0,6);console.log(" Municpio Chart:",dt),S(dt);const we={};te.filter(xe=>xe.resultado==="TRATATIVA DE ANULAO").forEach(xe=>{const Ee=new Date(xe.data_emissao||xe.created_at),We=Jt(Ee,"dd/MM",{locale:jr});we[We]||(we[We]=[]),we[We].push({cliente:xe.nome_cliente||"Desconhecido",nota:xe.numero||"-"})});const Ne=Object.keys(we).sort((xe,Ee)=>{const We=new Date(xe.split("/").reverse().join("-")),ce=new Date(Ee.split("/").reverse().join("-"));return We.getTime()-ce.getTime()}).map(xe=>({name:xe,quantidade:we[xe].length,detalhes:we[xe]}));D(Ne);const lt={};te.filter(xe=>xe.resultado==="ANULADA/CANCELADA").forEach(xe=>{const Ee=new Date(xe.data_emissao||xe.created_at),We=Jt(Ee,"dd/MM",{locale:jr});lt[We]||(lt[We]=[]),lt[We].push({cliente:xe.nome_cliente||"Desconhecido",nota:xe.numero||"-"})});const Ct=Object.keys(lt).sort((xe,Ee)=>{const We=new Date(xe.split("/").reverse().join("-")),ce=new Date(Ee.split("/").reverse().join("-"));return We.getTime()-ce.getTime()}).map(xe=>({name:xe,quantidade:lt[xe].length,detalhes:lt[xe]}));C(Ct);const $t=xe=>{if(!xe)return null;const Ee=xe.toUpperCase().trim();return["CX","CX1","CXI","CX10","CXS","FD"].includes(Ee)?"CX":["UN","UND","UN1","UNID","BD","BDJ","KG","KG1","KGS","PTC","PT","PT1","PC","PC1","SC","SC1"].includes(Ee)?"UN":null},ke={},De={};te.forEach(xe=>{(xe.itens||[]).forEach(We=>{const ce=We.descricao||"Desconhecido",Te=Number(We.quantidade)||0,qe=We.unidade||"",st=$t(qe);st==="CX"?(ke[ce]||(ke[ce]={quantidade:0,unidade:qe}),ke[ce].quantidade+=Te):st==="UN"&&(De[ce]||(De[ce]={quantidade:0,unidade:qe}),De[ce].quantidade+=Te)})});const bt=Object.entries(ke).map(([xe,Ee])=>({name:xe.split(" ").slice(0,2).join(" "),nameFull:xe,quantidade:Ee.quantidade,unidade:Ee.unidade,tipo:"CX"})).sort((xe,Ee)=>Ee.quantidade-xe.quantidade).slice(0,5),xt=Object.entries(De).map(([xe,Ee])=>({name:xe.split(" ").slice(0,2).join(" "),nameFull:xe,quantidade:Ee.quantidade,unidade:Ee.unidade,tipo:"UN"})).sort((xe,Ee)=>Ee.quantidade-xe.quantidade).slice(0,5),Ae=[...bt,...xt];console.log(" Top Produtos:",Ae),T(Ae);const Le={};te.filter(xe=>xe.resultado==="TRATATIVA DE ANULAO"||xe.resultado==="ANULADA/CANCELADA").forEach(xe=>{const Ee=xe.nome_cliente||"Desconhecido";Le[Ee]||(Le[Ee]={count:0,detalhes:[]}),Le[Ee].count+=1,Le[Ee].detalhes.push({cliente:Ee,nota:xe.numero||"-"})});const nt=Object.entries(Le).map(([xe,Ee])=>({name:xe,count:Ee.count,quantidade:Ee.detalhes.length,detalhes:Ee.detalhes})).sort((xe,Ee)=>Ee.count-xe.count).slice(0,5);B(nt);const ie={};te.forEach(xe=>{var ce;const Ee=xe.rede||"Sem rede",We=(ce=xe.motivos_devolucao)==null?void 0:ce.nome;!We||We==="No informado"||We==="no informado"||We==="NO INFORMADO"||(ie[Ee]||(ie[Ee]={}),ie[Ee][We]||(ie[Ee][We]={count:0,detalhes:[]}),ie[Ee][We].count+=1,ie[Ee][We].detalhes.push({cliente:xe.nome_cliente||"Desconhecido",nota:xe.numero||"-"}))});const be=[];Object.entries(ie).sort((xe,Ee)=>{const We=Object.values(xe[1]).reduce((Te,qe)=>Te+qe.count,0);return Object.values(Ee[1]).reduce((Te,qe)=>Te+qe.count,0)-We}).slice(0,5).forEach(([xe,Ee])=>{const We=Object.entries(Ee).sort((ce,Te)=>Te[1].count-ce[1].count)[0];We&&be.push({rede:xe.length>15?xe.substring(0,15)+"...":xe,motivo:We[0].length>20?We[0].substring(0,20)+"...":We[0],count:We[1].count,quantidade:We[1].detalhes.length,detalhes:We[1].detalhes})}),X(be);const ue=[];if(ne>0&&ue.push(` Total de ${ne} devoluo(es) no perodo selecionado, totalizando R$ ${le.toLocaleString("pt-BR",{minimumFractionDigits:2})}.`),Ye.length>0&&le>0){const xe=Ye[0].value/le*100;xe>20&&ue.push(` Cliente "${Ye[0].name}" concentra ${xe.toFixed(1)}% do valor total de devolues.`)}if(fe>0&&ne>0){const xe=fe/ne;ue.push(` Mdia de ${xe.toFixed(1)} produtos por devoluo.`)}if(tt.length>0&&ue.push(` Vendedor "${tt[0].name}" lidera em devolues com R$ ${tt[0].value.toLocaleString("pt-BR")}.`),Je.length>0){const xe=Je.findIndex(Ee=>Ee.percentage>=80);xe>=0&&xe<5&&ue.push(` Regra 80/20: ${xe+1} clientes concentram 80% do valor de devolues.`)}if(Ae.length>0){const xe=Ae[0];ue.push(` Produto "${xe.name}"  o mais devolvido com ${xe.quantidade} unidades.`)}const me=te.filter(xe=>xe.resultado==="TRATATIVA DE ANULAO"||xe.resultado==="ANULADA/CANCELADA").length,ve=ne>0?me/ne*100:0;if(ve>10?ue.push(` Taxa de cancelamento alta: ${ve.toFixed(1)}% das devolues esto em cancelamento.`):me>0&&ue.push(` ${me} devoluo(es) em processo de cancelamento.`),wt.length>0){const xe=wt[0];ue.push(` Motivo mais frequente: "${xe.name}" com ${xe.value} ocorrncia(s).`)}if(de>0){const xe=te.filter(Ee=>Number(Ee.valor_total_nota)>de*1.5).length;xe>0&&ue.push(` ${xe} devoluo(es) com valor acima de 150% do ticket mdio.`)}if(rt.length>0&&le>0){const xe=rt[0].value/le*100;xe>15&&ue.push(` Rede "${rt[0].name}" representa ${xe.toFixed(1)}% do valor devolvido.`)}if(Re.length>=2){const xe=Re[Re.length-1].value,Ee=Re[Re.length-2].value;if(Ee>0){const We=(xe-Ee)/Ee*100;if(Math.abs(We)>20){const ce=We>0?"aumento":"reduo";ue.push(` ${ce.charAt(0).toUpperCase()+ce.slice(1)} de ${Math.abs(We).toFixed(1)}% no valor devolvido comparado ao perodo anterior.`)}}}console.log(" Insights:",ue),H(ue);const ge=[],Fe=te.filter(xe=>xe.prazo==="EM ATRASO");if(Fe.length>0){const xe=Fe.reduce((Ee,We)=>Ee+(Number(We.valor_total_nota)||0),0);ge.push({type:"warning",message:`${Fe.length} nota(s) em atraso`,count:Fe.length,total:Fe.length,value:xe})}ne>50&&ge.push({type:"info",message:`Total de ${ne} notas no perodo (acima de 50)`,count:ne,total:ne});const Ue=te.filter(xe=>xe.resultado==="PENDENTE VALIDAO");if(Ue.length>20){const xe=Ue.reduce((Ee,We)=>Ee+(Number(We.valor_total_nota)||0),0);ge.push({type:"warning",message:`${Ue.length} nota(s) pendentes de validao (acima de 20)`,count:Ue.length,total:Ue.length,value:xe})}const Me=te.filter(xe=>Number(xe.valor_total_nota)>1e3);if(Me.length>0){const xe=Me.reduce((Ee,We)=>Ee+(Number(We.valor_total_nota)||0),0);ge.push({type:"warning",message:`${Me.length} nota(s) com valor acima de R$ 1.000,00`,count:Me.length,total:Me.length,value:xe})}const Ve={};Ue.forEach(xe=>{const Ee=xe.nome_cliente||"Desconhecido";Ve[Ee]||(Ve[Ee]=[]),Ve[Ee].push(xe)}),Object.entries(Ve).forEach(([xe,Ee])=>{if(Ee.length>5){const We=Ee.reduce((ce,Te)=>ce+(Number(Te.valor_total_nota)||0),0);ge.push({type:"error",message:`Cliente "${xe}" tem ${Ee.length} notas pendentes de validao`,cliente:xe,count:Ee.length,total:Ee.length,value:We})}});const ze=te.filter(xe=>xe.resultado==="TRATATIVA DE ANULAO");if(ze.length>0){const xe=ze.reduce((Ee,We)=>Ee+(Number(We.valor_total_nota)||0),0);ge.push({type:"error",message:`${ze.length} nota(s) em tratativa de anulao`,detalhes:ze.map(Ee=>`NF ${Ee.numero} - ${Ee.nome_cliente||"Sem cliente"} - R$ ${(Number(Ee.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`),count:ze.length,total:ze.length,value:xe})}q(ge)}}catch(F){console.error(" Erro ao processar dados do Dashboard:",F),St.error("Erro ao processar dados: "+(F.message||"Erro desconhecido"))}finally{n(!1)}},U=({value:F})=>{const te=-90+Math.min(F/4e4,1)*180,le=F<1e4?{color:"#10b981",label:"Normal",icon:"",bg:"bg-green-50"}:F<2e4?{color:"#f59e0b",label:"Ateno",icon:"",bg:"bg-yellow-50"}:{color:"#ef4444",label:"Crtico",icon:"",bg:"bg-red-50"};return k.jsxs("div",{className:"w-full max-w-sm mx-auto",children:[k.jsx("div",{className:"relative w-full",style:{paddingBottom:"50%"},children:k.jsxs("svg",{viewBox:"0 0 200 120",className:"absolute inset-0 w-full h-full",children:[k.jsx("path",{d:"M 20 100 A 80 80 0 0 1 65 35",fill:"none",stroke:"#10b981",strokeWidth:"20",strokeLinecap:"round"}),k.jsx("path",{d:"M 65 35 A 80 80 0 0 1 135 35",fill:"none",stroke:"#f59e0b",strokeWidth:"20",strokeLinecap:"round"}),k.jsx("path",{d:"M 135 35 A 80 80 0 0 1 180 100",fill:"none",stroke:"#ef4444",strokeWidth:"20",strokeLinecap:"round"}),[{val:0,angle:-90,label:"15k"},{val:1e4,angle:-45,label:"20k"},{val:15e3,angle:-22.5,label:"25k"},{val:2e4,angle:0,label:"35k"},{val:4e4,angle:90,label:"40k"}].map((ne,de)=>{const fe=ne.angle*Math.PI/180,Se=100+70*Math.cos(fe),_e=100+70*Math.sin(fe),Ce=100+85*Math.cos(fe),Re=100+85*Math.sin(fe),Pe=100+98*Math.cos(fe),Ye=100+98*Math.sin(fe);return k.jsxs("g",{children:[k.jsx("line",{x1:Se,y1:_e,x2:Ce,y2:Re,stroke:"#374151",strokeWidth:"3"}),k.jsx("text",{x:Pe,y:Ye,textAnchor:"middle",dominantBaseline:"middle",className:"text-[9px] fill-gray-700 font-bold",children:ne.label})]},de)}),[5e3,12500,17500,25e3,3e4,35e3].map((ne,de)=>{const _e=(-90+ne/4e4*180)*Math.PI/180,Ce=100+75*Math.cos(_e),Re=100+75*Math.sin(_e),Pe=100+85*Math.cos(_e),Ye=100+85*Math.sin(_e);return k.jsx("line",{x1:Ce,y1:Re,x2:Pe,y2:Ye,stroke:"#9ca3af",strokeWidth:"1.5"},`minor-${de}`)}),k.jsxs("g",{transform:`rotate(${te} 100 100)`,children:[k.jsx("path",{d:"M 100 100 L 96 94 L 98 25 L 100 20 L 102 25 L 104 94 Z",fill:"rgba(0,0,0,0.15)",transform:"translate(2, 2)"}),k.jsx("path",{d:"M 100 100 L 96 94 L 98 25 L 100 20 L 102 25 L 104 94 Z",fill:le.color,stroke:"#fff",strokeWidth:"1.5"}),k.jsx("path",{d:"M 100 20 L 99 25 L 99 70 L 100 70 Z",fill:"rgba(255,255,255,0.3)"})]}),k.jsx("circle",{cx:"101",cy:"101",r:"10",fill:"rgba(0,0,0,0.1)"}),k.jsx("circle",{cx:"100",cy:"100",r:"10",fill:"#fff",stroke:le.color,strokeWidth:"3"}),k.jsx("circle",{cx:"100",cy:"100",r:"5",fill:le.color}),k.jsx("circle",{cx:"98",cy:"98",r:"2",fill:"rgba(255,255,255,0.6)"})]})}),k.jsxs("div",{className:"mt-6 space-y-3",children:[k.jsx("div",{className:`${le.bg} rounded-xl p-5 border-2 shadow-lg`,style:{borderColor:le.color},children:k.jsxs("div",{className:"text-center",children:[k.jsx("div",{className:"text-xs text-gray-600 font-medium mb-1",children:"VALOR TOTAL"}),k.jsxs("div",{className:"text-4xl font-bold tracking-tight",style:{color:le.color},children:["R$ ",F.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),k.jsxs("div",{className:"flex items-center justify-center gap-2 mt-3",children:[k.jsx("span",{className:"text-2xl",children:le.icon}),k.jsx("span",{className:"text-xl font-bold uppercase tracking-wide",style:{color:le.color},children:le.label})]})]})}),k.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[k.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg border-2 border-green-200",children:[k.jsx("div",{className:"font-bold text-green-700 mb-1",children:" Normal"}),k.jsx("div",{className:"text-green-600 font-semibold",children:"0 - 10k"})]}),k.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg border-2 border-yellow-200",children:[k.jsx("div",{className:"font-bold text-yellow-700 mb-1",children:" Ateno"}),k.jsx("div",{className:"text-yellow-600 font-semibold",children:"10k - 20k"})]}),k.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg border-2 border-red-200",children:[k.jsx("div",{className:"font-bold text-red-700 mb-1",children:" Crtico"}),k.jsx("div",{className:"text-red-600 font-semibold",children:"20k - 40k"})]})]})]})]})},Q=({alert:F})=>{const[Z,se]=ye.useState(!1),ae={error:{bg:"bg-gradient-to-r from-red-50 to-red-100/50 dark:from-red-950/20 dark:to-red-900/10",border:"border-red-300 dark:border-red-800/50",iconBg:"bg-red-500",textColor:"text-red-800 dark:text-red-300",icon:Ao,badge:"bg-red-500 text-white"},warning:{bg:"bg-gradient-to-r from-amber-50 to-amber-100/50 dark:from-amber-950/20 dark:to-amber-900/10",border:"border-amber-300 dark:border-amber-800/50",iconBg:"bg-amber-500",textColor:"text-amber-800 dark:text-amber-300",icon:Rl,badge:"bg-amber-500 text-white"},info:{bg:"bg-gradient-to-r from-blue-50 to-blue-100/50 dark:from-blue-950/20 dark:to-blue-900/10",border:"border-blue-300 dark:border-blue-800/50",iconBg:"bg-blue-500",textColor:"text-blue-800 dark:text-blue-300",icon:Qb,badge:"bg-blue-500 text-white"}}[F.type],te=ae.icon,le=F.detalhes&&F.detalhes.length>0&&F.message.includes("tratativa de anulao");return k.jsx("div",{className:`${ae.bg} rounded-xl border-2 ${ae.border} shadow-sm hover:shadow-md transition-all duration-200`,children:k.jsx("div",{className:"p-4",children:k.jsxs("div",{className:"flex items-start gap-3",children:[k.jsx("div",{className:`${ae.iconBg} rounded-lg p-2 shadow-lg flex-shrink-0`,children:k.jsx(te,{className:"h-5 w-5 text-white"})}),k.jsxs("div",{className:"flex-1 min-w-0",children:[k.jsxs("div",{className:"flex items-start justify-between gap-2",children:[k.jsx("p",{className:`font-semibold text-sm leading-relaxed ${ae.textColor}`,children:F.message}),F.count&&k.jsx("span",{className:`${ae.badge} px-2.5 py-1 rounded-full text-xs font-bold flex-shrink-0 shadow-sm`,children:F.count})]}),F.value!==void 0&&k.jsx("div",{className:"mt-2 flex items-baseline gap-2",children:k.jsxs("span",{className:`text-2xl font-bold ${ae.textColor}`,children:["R$ ",F.value.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),le&&k.jsxs("div",{className:"mt-3",children:[k.jsx("button",{onClick:()=>se(!Z),className:`flex items-center gap-1 text-xs font-semibold ${ae.textColor} hover:underline`,children:Z?k.jsxs(k.Fragment,{children:[k.jsx(Fy,{className:"h-3 w-3"}),"Ocultar detalhes"]}):k.jsxs(k.Fragment,{children:[k.jsx(Uu,{className:"h-3 w-3"}),"Ver ",F.total," itens"]})}),Z&&k.jsxs("div",{className:"mt-2 space-y-1 pl-4 border-l-2 border-current/20",children:[F.detalhes.slice(0,5).map((ne,de)=>k.jsxs("div",{className:`text-xs ${ae.textColor} opacity-90 flex items-start gap-2`,children:[k.jsx("span",{className:"mt-1",children:""}),k.jsx("span",{children:ne})]},de)),F.total>5&&k.jsxs("div",{className:`text-xs font-semibold ${ae.textColor} mt-2`,children:["... e mais ",F.total-5," itens"]})]})]})]})]})})})},P=({active:F,payload:Z})=>{if(!F||!(Z!=null&&Z.length))return null;const se=Z[0].payload,re=se.quantidade||se.count||se.value||0,ae=se.detalhes||[],te=ae&&ae.length>0;return k.jsxs("div",{className:"bg-card border border-border rounded-md p-3 shadow-md",children:[k.jsx("p",{className:"text-sm font-bold text-foreground mb-1",children:"Detalhes"}),se.value&&typeof se.value=="number"&&se.value>1e3?k.jsxs("p",{className:"text-sm font-bold text-primary",children:["R$ ",se.value.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}):k.jsxs("p",{className:"text-sm font-bold text-primary",children:[re," ",se.count!==void 0?"nota(s)":se.value!==void 0?"ocorrncia(s)":"item(s)"]}),te&&k.jsx("div",{className:"mt-2 space-y-1 max-h-[200px] overflow-y-auto",children:ae.map((he,le)=>k.jsxs("p",{className:"text-xs text-muted-foreground",children:[k.jsx("span",{className:"font-medium text-foreground",children:he.cliente}),k.jsx("span",{className:"mx-1",children:""}),k.jsxs("span",{className:"text-primary",children:["NF: ",he.nota]})]},le))})]})};return e?k.jsx("div",{className:"flex items-center justify-center min-h-screen",children:k.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"})}):k.jsxs("div",{className:"space-y-6",children:[k.jsx(Qi,{title:"Dashboard Pendncias",description:"Viso geral das devolues pendentes (Pendente Validao, Tratativa de Anulao e Validadas) com KPIs, grficos e insights automticos para anlise estratgica."}),k.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[k.jsx(Xf,{}),k.jsxs(Nt,{variant:"outline",size:"sm",onClick:ee,className:"w-full md:w-auto shrink-0",children:[k.jsx(vm,{className:"mr-2 h-4 w-4"}),"Atualizar"]})]}),k.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[V.length>0&&k.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl border-2 border-gray-200 dark:border-gray-700 shadow-lg",children:[k.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-white dark:from-gray-800 dark:to-gray-900 p-6 border-b-2 border-gray-200 dark:border-gray-700",children:k.jsxs("div",{className:"flex items-center justify-between",children:[k.jsxs("div",{className:"flex items-center gap-3",children:[k.jsx("div",{className:"bg-gradient-to-br from-orange-500 to-red-500 rounded-xl p-3 shadow-lg",children:k.jsx(Rl,{className:"h-6 w-6 text-white"})}),k.jsxs("div",{children:[k.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-gray-200",children:"Central de Alertas"}),k.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Monitoramento de devolues e pendncias"})]})]}),k.jsxs("div",{className:"flex items-center gap-2",children:[V.filter(F=>F.type==="error").length>0&&k.jsxs("div",{className:"flex items-center gap-1.5 bg-red-100 dark:bg-red-900/30 px-3 py-1.5 rounded-full border border-red-300 dark:border-red-700",children:[k.jsx(Ao,{className:"h-4 w-4 text-red-600 dark:text-red-400"}),k.jsx("span",{className:"text-sm font-bold text-red-700 dark:text-red-300",children:V.filter(F=>F.type==="error").length})]}),V.filter(F=>F.type==="warning").length>0&&k.jsxs("div",{className:"flex items-center gap-1.5 bg-amber-100 dark:bg-amber-900/30 px-3 py-1.5 rounded-full border border-amber-300 dark:border-amber-700",children:[k.jsx(Rl,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}),k.jsx("span",{className:"text-sm font-bold text-amber-700 dark:text-amber-300",children:V.filter(F=>F.type==="warning").length})]}),V.filter(F=>F.type==="info").length>0&&k.jsxs("div",{className:"flex items-center gap-1.5 bg-blue-100 dark:bg-blue-900/30 px-3 py-1.5 rounded-full border border-blue-300 dark:border-blue-700",children:[k.jsx(Qb,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),k.jsx("span",{className:"text-sm font-bold text-blue-700 dark:text-blue-300",children:V.filter(F=>F.type==="info").length})]})]})]})}),k.jsx("div",{className:"p-6",children:k.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:V.map((F,Z)=>k.jsx(Q,{alert:F},Z))})}),k.jsx("style",{children:`
              .custom-scrollbar::-webkit-scrollbar {
                width: 8px;
              }
              .custom-scrollbar::-webkit-scrollbar-track {
                background: #f1f5f9;
                border-radius: 10px;
              }
              .custom-scrollbar::-webkit-scrollbar-thumb {
                background: #cbd5e1;
                border-radius: 10px;
              }
              .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                background: #94a3b8;
              }
            `})]}),k.jsxs(Dt,{className:"border-2",children:[k.jsxs(Rt,{className:"pb-3",children:[k.jsx(Ft,{className:"text-center text-sm font-semibold",children:"Status de Validao"}),k.jsx(Vr,{className:"text-center text-xs",children:"Valor total de notas pendentes e em tratativa de anulao"})]}),k.jsx(Mt,{className:"pt-0",children:k.jsx(U,{value:s})})]})]}),k.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[k.jsx(as,{title:"Valor Total Devolvido",value:`R$ ${a.totalValue.toLocaleString("pt-BR",{maximumFractionDigits:0})}`,icon:Dp,trend:"up",trendValue:"vs perodo anterior"}),k.jsx(as,{title:"Total de Devolues",value:a.totalReturns,icon:Py,description:"Neste perodo"}),k.jsx(as,{title:"Produtos Devolvidos",value:a.totalProducts.toFixed(2),icon:Ul,description:"Quantidade total"}),k.jsx(as,{title:"Ticket Mdio",value:`R$ ${a.avgTicket.toLocaleString("pt-BR",{maximumFractionDigits:0})}`,icon:_u}),k.jsx(as,{title:"Fora do SLA",value:a.slaBreach,icon:Rl,description:"Devolues atrasadas",trend:"down",trendValue:"0"})]}),k.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[k.jsxs(Dt,{className:"col-span-4",children:[k.jsx(Rt,{children:k.jsx(Ft,{children:"Evoluo no Tempo"})}),k.jsx(Mt,{className:"pl-2",children:k.jsx(Jr,{width:"100%",height:350,children:k.jsxs(xy,{data:c,children:[k.jsx("defs",{children:k.jsxs("linearGradient",{id:"colorValue",x1:"0",y1:"0",x2:"0",y2:"1",children:[k.jsx("stop",{offset:"5%",stopColor:Y[0],stopOpacity:.8}),k.jsx("stop",{offset:"95%",stopColor:Y[0],stopOpacity:0})]})}),k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",height:60,tick:k.jsx(Js,{})}),k.jsx(zr,{className:"text-[6px] font-size-6px font-bold",tickFormatter:F=>`R$${F}`}),k.jsx(Qr,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)",color:"var(--foreground)",fontSize:"11px",fontWeight:"bold"},formatter:(F,Z)=>Z==="value"?[`R$ ${(F||0).toFixed(2)}`,"Valor Total"]:Z==="count"?[`${F||0}`,"Qtd de Notas"]:[F,Z||""],labelFormatter:F=>`Data: ${F}`}),k.jsx(yy,{type:"monotone",dataKey:"value",stroke:Y[0],fillOpacity:1,fill:"url(#colorValue)"}),k.jsx(Xl,{type:"monotone",dataKey:"count",stroke:Y[1],strokeWidth:2,dot:{fill:Y[1],r:4}})]})})})]}),k.jsxs(Dt,{className:"col-span-4",children:[k.jsx(Rt,{children:k.jsx(Ft,{children:"Top Clientes (Valor)"})}),k.jsx(Mt,{children:k.jsx(Jr,{width:"100%",height:350,children:k.jsxs(Gn,{data:u,children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",height:60,tick:k.jsx(Js,{})}),k.jsx(zr,{className:"text-[6px] font-bold",tickFormatter:F=>`R$${F}`}),k.jsx(Qr,{content:k.jsx(P,{})}),k.jsx(On,{dataKey:"value",fill:Y[0],radius:[8,8,0,0],children:k.jsx(Pn,{dataKey:"value",position:"top",content:({value:F})=>k.jsx("text",{x:0,y:0,dy:-5,fill:K?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(F||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]})]}),k.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[k.jsxs(Dt,{children:[k.jsx(Rt,{children:k.jsx(Ft,{children:"Top Vendedores (Valor)"})}),k.jsx(Mt,{children:k.jsx(Jr,{width:"100%",height:300,children:k.jsxs(Gn,{data:f,children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",height:60,tick:k.jsx(Js,{})}),k.jsx(zr,{className:"text-[10px] font-bold",tickFormatter:F=>`R$${F}`}),k.jsx(Qr,{content:k.jsx(P,{})}),k.jsx(On,{dataKey:"value",fill:Y[1],radius:[8,8,0,0],children:k.jsx(Pn,{dataKey:"value",position:"top",content:({value:F})=>k.jsx("text",{x:0,y:0,dy:-5,fill:K?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(F||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{children:k.jsx(Ft,{children:"Top Redes (Valor)"})}),k.jsx(Mt,{children:k.jsx(Jr,{width:"100%",height:300,children:k.jsxs(Gn,{data:v,children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",height:60,tick:k.jsx(Js,{})}),k.jsx(zr,{className:"text-[10px] font-bold",tickFormatter:F=>`R$${F}`}),k.jsx(Qr,{content:k.jsx(P,{})}),k.jsx(On,{dataKey:"value",fill:Y[2],radius:[8,8,0,0],children:k.jsx(Pn,{dataKey:"value",position:"top",content:({value:F})=>k.jsx("text",{x:0,y:0,dy:-5,fill:K?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(F||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]})]}),k.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[k.jsxs(Dt,{children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:"Top 5 Clientes com Reincidncia"}),k.jsx(Vr,{children:"Clientes com mais notas em TRATATIVA DE ANULAO e ANULADA/CANCELADA"})]}),k.jsx(Mt,{children:k.jsx(Jr,{width:"100%",height:300,children:k.jsxs(Gn,{data:j,children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",height:60,tick:k.jsx(Js,{})}),k.jsx(zr,{className:"text-[10px] font-bold"}),k.jsx(Qr,{content:k.jsx(P,{})}),k.jsx(On,{dataKey:"count",fill:Y[3],radius:[8,8,0,0],children:k.jsx(Pn,{dataKey:"count",position:"top",content:({value:F})=>k.jsx("text",{x:0,y:0,dy:-5,fill:K?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`${F||0}`})})})]})})})]}),k.jsxs(Dt,{children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:"Motivos Mais Recorrentes por Rede"}),k.jsx(Vr,{children:"Principais motivos de devoluo por rede (Top 5 redes)"})]}),k.jsx(Mt,{children:k.jsx(Jr,{width:"100%",height:300,children:k.jsxs(Gn,{data:R,layout:"vertical",children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{type:"number",className:"text-[10px] font-bold"}),k.jsx(zr,{type:"category",dataKey:"rede",width:100,tick:k.jsx(Js,{})}),k.jsx(Qr,{content:k.jsx(P,{})}),k.jsx(On,{dataKey:"count",fill:Y[4],radius:[0,8,8,0],children:k.jsx(Pn,{dataKey:"count",position:"right",content:({value:F})=>k.jsx("text",{x:0,y:0,dx:5,fill:K?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"start",children:`${F||0}`})})})]})})})]})]}),k.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[k.jsxs(Dt,{children:[k.jsx(Rt,{children:k.jsx(Ft,{children:"Anlise de Pareto (80/20)"})}),k.jsxs(Mt,{children:[k.jsx(Jr,{width:"100%",height:350,children:k.jsxs(wy,{data:y,children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",height:60,tick:k.jsx(Js,{})}),k.jsx(zr,{yAxisId:"left",className:"text-[10px] font-bold",tickFormatter:F=>`R$${F}`}),k.jsx(zr,{yAxisId:"right",orientation:"right",className:"text-[10px] font-bold",tickFormatter:F=>`${F}%`}),k.jsx(Qr,{content:k.jsx(P,{})}),k.jsx(On,{yAxisId:"left",dataKey:"value",fill:Y[0],radius:[8,8,0,0],children:k.jsx(Pn,{dataKey:"value",position:"top",content:({value:F})=>k.jsx("text",{x:0,y:0,dy:-5,fill:K?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(F||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})}),k.jsx(Xl,{yAxisId:"right",type:"monotone",dataKey:"percentage",stroke:Y[3],strokeWidth:2})]})}),k.jsx("div",{className:"mt-4 text-xs text-muted-foreground",children:"Linha mostra o percentual acumulado. A regra 80/20 indica que poucos clientes concentram a maioria do valor."})]})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{children:k.jsx(Ft,{children:"Insights Automticos"})}),k.jsx(Mt,{children:k.jsx("div",{className:"space-y-3",children:L.length>0?L.map((F,Z)=>k.jsx("div",{className:"p-3 bg-muted/50 rounded-lg text-sm",children:F},Z)):k.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum insight disponvel no momento."})})})]})]}),N.length>0&&k.jsxs(Dt,{children:[k.jsx(Rt,{children:k.jsx(Ft,{children:"Heatmap: Produto  Rede"})}),k.jsx(Mt,{children:k.jsx("div",{className:"overflow-x-auto",children:k.jsxs("table",{className:"w-full text-xs border-collapse",children:[k.jsx("thead",{children:k.jsxs("tr",{children:[k.jsx("th",{className:"border p-2 text-left bg-muted text-xs",children:"Produto"}),N[0]&&Object.keys(N[0]).filter(F=>F!=="produto").map(F=>k.jsx("th",{className:"border p-2 bg-muted text-xs",children:F.length>15?F.substring(0,15)+"...":F},F))]})}),k.jsx("tbody",{children:N.map((F,Z)=>k.jsxs("tr",{children:[k.jsx("td",{className:"border p-2 font-medium text-xs",children:F.produto.length>20?F.produto.substring(0,20)+"...":F.produto}),Object.keys(F).filter(se=>se!=="produto").map(se=>{const re=F[se]||{quantidade:0,unidade:"UN"},ae=typeof re=="object"?re.quantidade:re,te=typeof re=="object"?re.unidade:"UN",he=Math.max(...N.map(ne=>Math.max(...Object.keys(ne).filter(de=>de!=="produto").map(de=>{const fe=ne[de];return typeof fe=="object"?fe.quantidade:fe||0})))),le=he>0?ae/he*100:0;return k.jsx("td",{className:"border p-2 text-center text-xs",style:{backgroundColor:le>0?K?`rgba(210, 248, 247, ${le/100})`:`rgba(23, 67, 42, ${le/100})`:"transparent",color:le>50?K?"#000":"#fff":"inherit"},title:`${ae.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})} ${te}`,children:ae>0?`${ae.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})} ${te}`:"-"},se)})]},Z))})]})})})]}),(W.length>0||M.length>0)&&k.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[k.jsxs(Dt,{children:[k.jsx(Rt,{children:k.jsxs(Ft,{className:"flex items-center gap-2",children:[k.jsx(Ao,{className:"h-5 w-5 text-orange-500"}),"Notas em Cancelamento"]})}),k.jsx(Mt,{children:W.length>0?k.jsx(Jr,{width:"100%",height:300,children:k.jsxs(Gn,{data:W,children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",height:60,tick:k.jsx(Js,{})}),k.jsx(zr,{className:"text-[10px] font-bold"}),k.jsx(Qr,{content:k.jsx(P,{})}),k.jsx(On,{dataKey:"quantidade",fill:Y[0],radius:[8,8,0,0],children:k.jsx(Pn,{dataKey:"quantidade",position:"inside",fill:"#f1f1e5",fontSize:13,fontWeight:"bold"})})]})}):k.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-muted-foreground text-center p-4",children:[k.jsx(Ao,{className:"h-10 w-10 mb-2 opacity-20"}),k.jsx("p",{className:"text-sm",children:"Nenhuma nota em cancelamento encontrada."})]})})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{children:k.jsxs(Ft,{className:"flex items-center gap-2",children:[k.jsx(Ao,{className:"h-5 w-5 text-red-500"}),"Notas Canceladas"]})}),k.jsx(Mt,{children:M.length>0?k.jsx(Jr,{width:"100%",height:300,children:k.jsxs(Gn,{data:M,children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",height:60,tick:k.jsx(Js,{})}),k.jsx(zr,{className:"text-[10px] font-bold"}),k.jsx(Qr,{content:k.jsx(P,{})}),k.jsx(On,{dataKey:"quantidade",fill:Y[1],radius:[8,8,0,0]})]})}):k.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-muted-foreground text-center p-4",children:[k.jsx(Ao,{className:"h-10 w-10 mb-2 opacity-20"}),k.jsx("p",{className:"text-sm",children:"Nenhuma nota cancelada encontrada."})]})})]})]}),k.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[k.jsxs(Dt,{className:"col-span-1",children:[k.jsx(Rt,{children:k.jsx(Ft,{className:"text-base",children:"Principais Motivos"})}),k.jsx(Mt,{children:g.length>0?k.jsx("div",{className:"h-[250px]",children:k.jsx(Jr,{width:"100%",height:"100%",children:k.jsxs(o8,{children:[k.jsx(l8,{data:g,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:g.map((F,Z)=>k.jsx(c8,{fill:Y[Z%Y.length]},`cell-${Z}`))}),k.jsx(Qr,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)"}}),k.jsx(_y,{verticalAlign:"bottom",height:60,iconType:"circle",wrapperStyle:{fontSize:"9px",paddingTop:"8px"},formatter:F=>{const se=F.length>20?F.substring(0,20)+"...":F;return k.jsx("span",{style:{fontSize:"9px"},children:se})}})]})})}):k.jsxs("div",{className:"flex flex-col items-center justify-center h-[250px] text-muted-foreground text-center p-4",children:[k.jsx(Rl,{className:"h-10 w-10 mb-2 opacity-20"}),k.jsx("p",{className:"text-sm",children:"Nenhum motivo encontrado para o perodo selecionado."})]})})]}),k.jsxs(Dt,{className:"col-span-1",children:[k.jsx(Rt,{children:k.jsx(Ft,{className:"text-base",children:"Distribuio por Municpio"})}),k.jsx(Mt,{children:k.jsx("div",{className:"space-y-4",children:A.length>0?A.map((F,Z)=>k.jsxs("div",{className:"flex items-center justify-between",children:[k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsx(Rp,{className:"h-4 w-4 text-muted-foreground"}),k.jsx("span",{className:"text-sm font-medium truncate max-w-[120px]",title:F.name,children:F.name})]}),k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsx("div",{className:"h-2 bg-muted rounded-full w-24 overflow-hidden",children:k.jsx("div",{className:"h-full bg-primary",style:{width:`${F.value/(a.totalValue||1)*100}%`}})}),k.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:[(F.value/(a.totalValue||1)*100).toFixed(0),"%"]})]})]},Z)):k.jsx("div",{className:"text-center text-sm text-muted-foreground py-8",children:"Nenhum dado disponvel"})})})]}),k.jsxs(Dt,{className:"col-span-1",children:[k.jsx(Rt,{children:k.jsx(Ft,{className:"text-base",children:"Produtos Crticos"})}),k.jsx(Mt,{children:w.length>0?k.jsxs("div",{className:"space-y-4 max-h-[400px] overflow-y-auto",children:[k.jsxs("div",{children:[k.jsx("h4",{className:"text-xs font-bold text-muted-foreground mb-2",children:"Top 5 em CX"}),k.jsx("div",{className:"space-y-2",children:w.filter(F=>F.tipo==="CX").length>0?w.filter(F=>F.tipo==="CX").map((F,Z)=>k.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-muted/50",children:[k.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[k.jsxs("span",{className:"text-xs font-bold text-muted-foreground w-6",children:[Z+1,""]}),k.jsx("span",{className:"text-sm font-medium truncate",title:F.nameFull||F.name,children:F.name})]}),k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsx("span",{className:"text-sm font-bold",children:F.quantidade.toFixed(2)}),k.jsx("span",{className:"text-xs text-muted-foreground",children:F.unidade||"CX"})]})]},`cx-${Z}`)):k.jsx("div",{className:"text-xs text-muted-foreground p-2",children:"Nenhum produto em CX encontrado"})})]}),k.jsxs("div",{children:[k.jsx("h4",{className:"text-xs font-bold text-muted-foreground mb-2",children:"Top 5 em UN"}),k.jsx("div",{className:"space-y-2",children:w.filter(F=>F.tipo==="UN").length>0?w.filter(F=>F.tipo==="UN").map((F,Z)=>k.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-muted/50",children:[k.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[k.jsxs("span",{className:"text-xs font-bold text-muted-foreground w-6",children:[Z+1,""]}),k.jsx("span",{className:"text-sm font-medium truncate",title:F.nameFull||F.name,children:F.name})]}),k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsx("span",{className:"text-sm font-bold",children:F.quantidade.toFixed(2)}),k.jsx("span",{className:"text-xs text-muted-foreground",children:F.unidade||"UN"})]})]},`un-${Z}`)):k.jsx("div",{className:"text-xs text-muted-foreground p-2",children:"Nenhum produto em UN encontrado"})})]})]}):k.jsxs("div",{className:"flex flex-col items-center justify-center h-[250px] text-muted-foreground text-center p-4",children:[k.jsx(Ul,{className:"h-10 w-10 mb-2 opacity-20"}),k.jsx("p",{className:"text-sm",children:"Nenhum produto encontrado para o perodo selecionado."})]})})]})]})]})}const IN=["#17432a","#17432a","#17432a","#17432a","#17432a","#17432a"],PN=["#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7"],ys=({x:t,y:r,payload:e})=>{const a=e.value.split(" ");let o=[],s="";return a.forEach(l=>{(s+l).length<=10?s+=`${l} `:(s.trim()&&o.push(s.trim()),s=`${l} `)}),s.trim()&&o.push(s.trim()),k.jsx("g",{transform:`translate(${t},${r})`,children:k.jsx("text",{x:0,y:0,dy:16,textAnchor:"middle",fill:"currentColor",fontSize:10,fontWeight:"bold",children:o.map((l,c)=>k.jsx("tspan",{x:"0",dy:c===0?0:14,children:l},c))})})};function LN(){const{filters:t}=ec(),{user:r}=Dn(),[e,n]=ye.useState(!0),[a,o]=ye.useState({totalValue:0,totalReturns:0,avgTicket:0,totalProducts:0,valorTotalLancado:0,notasLancadas:0,valorTotalCancelado:0,notasCanceladas:0}),[s,l]=ye.useState([]),[c,i]=ye.useState([]),[u,p]=ye.useState([]),[f,h]=ye.useState([]),[v,b]=ye.useState([]),[g,x]=ye.useState([]),[y,E]=ye.useState(!1),[N,I]=ye.useState([]),[L,H]=ye.useState([]),[V,q]=ye.useState([]),[K,z]=ye.useState([]),[W,D]=ye.useState([]),[M,C]=ye.useState([]),[w,T]=ye.useState("KG");ye.useEffect(()=>{const R=()=>{E(document.documentElement.classList.contains("dark"))};R();const X=new MutationObserver(R);return X.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>X.disconnect()},[]);const A=y?PN:IN;ye.useEffect(()=>{S()},[t,r,w]);const S=async()=>{try{n(!0);const R=(r==null?void 0:r.role)==="VENDEDOR"?r.vendedor:null;let X=Tt.from("devolucoes").select(`
          *,
          motivos_devolucao(nome),
          setores(nome),
          itens:itens_devolucao(quantidade, descricao, motivo_id, valor_total_bruto, unidade)
      `);r&&r.role==="VENDEDOR"&&R&&(X=X.eq("vendedor",R),console.log(" Dashboard Lanadas - Filtrando por vendedor:",R));const Y=t.period&&!t.startDate&&!t.endDate?Kf(t.period):{},ee=t.startDate||Y.startDate,U=t.endDate||Y.endDate;X=X.in("resultado",["LANADA","ANULADA/CANCELADA"]),t.search&&(X=X.or(`nome_cliente.ilike.%${t.search}%,vendedor.ilike.%${t.search}%,numero.ilike.%${t.search}%`)),t.motivo&&t.motivo.length>0&&(X=X.in("motivo_id",t.motivo)),t.cliente&&t.cliente.length>0&&(X=X.in("nome_cliente",t.cliente)),t.vendedor&&t.vendedor.length>0&&(X=X.in("vendedor",t.vendedor)),t.setor&&t.setor.length>0&&(X=X.in("setor_id",t.setor)),ee&&(X=X.gte("data_emissao",ee.toISOString().split("T")[0])),U&&(X=X.lte("data_emissao",U.toISOString().split("T")[0]));const{data:Q,error:P}=await X;if(P){console.error(" Erro ao buscar dados do Dashboard Lanadas:",P),St.error("Erro ao carregar dados do Dashboard Lanadas: "+P.message),n(!1);return}if(!Q||Q.length===0){console.log(" Nenhuma devoluo encontrada para os filtros selecionados"),o({totalValue:0,totalReturns:0,avgTicket:0,totalProducts:0,valorTotalLancado:0,notasLancadas:0,valorTotalCancelado:0,notasCanceladas:0}),l([]),i([]),p([]),h([]),b([]),x([]),I([]),z([]),D([]),C([]),n(!1);return}if(Q){console.log(` Dashboard Lanadas: ${Q.length} devolues carregadas`);const F=Q.reduce((ke,De)=>ke+(Number(De.valor_total_nota)||0),0),Z=Q.length,se=Z>0?F/Z:0,re=Q.reduce((ke,De)=>{const bt=De.itens||[];return ke+bt.reduce((xt,Ae)=>xt+(Number(Ae.quantidade)||0),0)},0),ae=Q.filter(ke=>ke.resultado==="LANADA"),te=Q.filter(ke=>ke.resultado==="ANULADA/CANCELADA"),he=ae.reduce((ke,De)=>ke+(Number(De.valor_total_nota)||0),0),le=te.reduce((ke,De)=>ke+(Number(De.valor_total_nota)||0),0);o({totalValue:F,totalReturns:Z,avgTicket:se,totalProducts:re,valorTotalLancado:he,notasLancadas:ae.length,valorTotalCancelado:le,notasCanceladas:te.length});const ne=Q.reduce((ke,De)=>{const bt=new Date(De.data_emissao||De.created_at),xt=Jt(bt,"dd/MM",{locale:jr});return ke[xt]||(ke[xt]={value:0,count:0}),ke[xt].value+=Number(De.valor_total_nota)||0,ke[xt].count+=1,ke},{}),de=Object.keys(ne).sort((ke,De)=>{const bt=new Date(ke.split("/").reverse().join("-")),xt=new Date(De.split("/").reverse().join("-"));return bt.getTime()-xt.getTime()}).map(ke=>({name:ke,value:ne[ke].value,count:ne[ke].count}));l(de);const fe={};Q.forEach(ke=>{const De=ke.nome_cliente||"Desconhecido",bt=Number(ke.valor_total_nota)||0;fe[De]||(fe[De]={valor:0,detalhes:[]}),fe[De].valor+=bt,fe[De].detalhes.push({cliente:De,nota:ke.numero||"-"})});const Se=Object.entries(fe).map(([ke,De])=>({name:ke,value:De.valor,quantidade:De.detalhes.length,detalhes:De.detalhes})).sort((ke,De)=>De.value-ke.value).slice(0,10);i(Se);const _e={};Q.forEach(ke=>{const De=ke.vendedor||"Desconhecido",bt=Number(ke.valor_total_nota)||0;_e[De]||(_e[De]={valor:0,detalhes:[]}),_e[De].valor+=bt,_e[De].detalhes.push({cliente:ke.nome_cliente||"Desconhecido",nota:ke.numero||"-"})});const Ce=Object.entries(_e).map(([ke,De])=>({name:ke,value:De.valor,quantidade:De.detalhes.length,detalhes:De.detalhes})).sort((ke,De)=>De.value-ke.value).slice(0,5);p(Ce);const Re={};Q.forEach(ke=>{let De=ke.rede||"Sem rede";De==="Sem rede"&&ke.cnpj_destinatario&&(De=ke.rede||"Sem rede");const bt=Number(ke.valor_total_nota)||0;Re[De]||(Re[De]={valor:0,detalhes:[]}),Re[De].valor+=bt,Re[De].detalhes.push({cliente:ke.nome_cliente||"Desconhecido",nota:ke.numero||"-"})});const Pe=Object.entries(Re).map(([ke,De])=>({name:ke,value:De.valor,quantidade:De.detalhes.length,detalhes:De.detalhes})).sort((ke,De)=>De.value-ke.value).slice(0,5);h(Pe);const Ye=Object.entries(fe).map(([ke,De])=>({name:ke,value:De.valor,detalhes:De.detalhes})).sort((ke,De)=>De.value-ke.value);let at=0;const tt=Ye.reduce((ke,De)=>ke+De.value,0),it=Ye.map((ke,De)=>(at+=ke.value,{name:ke.name.length>15?ke.name.substring(0,15)+"...":ke.name,value:ke.value,cumulative:at,percentage:at/tt*100,index:De+1,quantidade:ke.detalhes.length,detalhes:ke.detalhes})).slice(0,10);b(it);const rt=Q.reduce((ke,De)=>{const bt=De.cidade_origem||"N/A";return ke[bt]=(ke[bt]||0)+(Number(De.valor_total_nota)||0),ke},{}),ct=Object.entries(rt).map(([ke,De])=>({name:ke,value:De})).sort((ke,De)=>De.value-ke.value).slice(0,6);console.log(" Municpio Chart:",ct),I(ct);const Oe={};Q.filter(ke=>ke.resultado==="ANULADA/CANCELADA").forEach(ke=>{const De=ke.nome_cliente||"Desconhecido";Oe[De]||(Oe[De]={count:0,detalhes:[]}),Oe[De].count+=1,Oe[De].detalhes.push({cliente:De,nota:ke.numero||"-"})});const pt=Object.entries(Oe).map(([ke,De])=>({name:ke,count:De.count,quantidade:De.detalhes.length,detalhes:De.detalhes})).sort((ke,De)=>De.count-ke.count).slice(0,5);H(pt);const Je={};Q.forEach(ke=>{var xt;const De=ke.rede||"Sem rede",bt=(xt=ke.motivos_devolucao)==null?void 0:xt.nome;!bt||bt==="No informado"||bt==="no informado"||bt==="NO INFORMADO"||(Je[De]||(Je[De]={}),Je[De][bt]||(Je[De][bt]={count:0,detalhes:[]}),Je[De][bt].count+=1,Je[De][bt].detalhes.push({cliente:ke.nome_cliente||"Desconhecido",nota:ke.numero||"-"}))});const ot=[];Object.entries(Je).sort((ke,De)=>{const bt=Object.values(ke[1]).reduce((Ae,Le)=>Ae+Le.count,0);return Object.values(De[1]).reduce((Ae,Le)=>Ae+Le.count,0)-bt}).slice(0,5).forEach(([ke,De])=>{const bt=Object.entries(De).sort((xt,Ae)=>Ae[1].count-xt[1].count)[0];bt&&ot.push({rede:ke.length>15?ke.substring(0,15)+"...":ke,motivo:bt[0].length>20?bt[0].substring(0,20)+"...":bt[0],count:bt[1].count,quantidade:bt[1].detalhes.length,detalhes:bt[1].detalhes})}),q(ot);const ut=[];if(Z>0&&ut.push(` Total de ${Z} devoluo(es) no perodo selecionado, totalizando R$ ${F.toLocaleString("pt-BR",{minimumFractionDigits:2})}.`),Se.length>0&&F>0){const ke=Se[0].value/F*100;ke>20&&ut.push(` Cliente "${Se[0].name}" concentra ${ke.toFixed(1)}% do valor total de devolues.`)}if(re>0&&Z>0){const ke=re/Z;ut.push(` Mdia de ${ke.toFixed(1)} produtos por devoluo.`)}if(Ce.length>0&&ut.push(` Vendedor "${Ce[0].name}" lidera em devolues com R$ ${Ce[0].value.toLocaleString("pt-BR")}.`),it.length>0){const ke=it.findIndex(De=>De.percentage>=80);ke>=0&&ke<5&&ut.push(` Regra 80/20: ${ke+1} clientes concentram 80% do valor de devolues.`)}const _t=Q.filter(ke=>ke.resultado==="ANULADA/CANCELADA").length,vt=Z>0?_t/Z*100:0;if(vt>10?ut.push(` Taxa de cancelamento alta: ${vt.toFixed(1)}% das devolues esto em cancelamento.`):_t>0&&ut.push(` ${_t} devoluo(es) em processo de cancelamento.`),se>0){const ke=Q.filter(De=>Number(De.valor_total_nota)>se*1.5).length;ke>0&&ut.push(` ${ke} devoluo(es) com valor acima de 150% do ticket mdio.`)}if(Pe.length>0&&F>0){const ke=Pe[0].value/F*100;ke>15&&ut.push(` Rede "${Pe[0].name}" representa ${ke.toFixed(1)}% do valor devolvido.`)}if(de.length>=2){const ke=de[de.length-1].value,De=de[de.length-2].value;if(De>0){const bt=(ke-De)/De*100;if(Math.abs(bt)>20){const xt=bt>0?"aumento":"reduo";ut.push(` ${xt.charAt(0).toUpperCase()+xt.slice(1)} de ${Math.abs(bt).toFixed(1)}% no valor devolvido comparado ao perodo anterior.`)}}}console.log(" Insights:",ut),x(ut);const ht=[],$e=Q.filter(ke=>ke.prazo==="EM ATRASO");if($e.length>0){const ke=$e.reduce((De,bt)=>De+(Number(bt.valor_total_nota)||0),0);ht.push({type:"warning",message:`${$e.length} nota(s) em atraso`,count:$e.length,total:$e.length,value:ke})}if(Z>50&&ht.push({type:"info",message:`Total de ${Z} notas no perodo (acima de 50)`,count:Z,total:Z}),ae.length>20){const ke=ae.reduce((De,bt)=>De+(Number(bt.valor_total_nota)||0),0);ht.push({type:"info",message:`${ae.length} nota(s) lanadas (acima de 20)`,count:ae.length,total:ae.length,value:ke})}const Be=Q.filter(ke=>Number(ke.valor_total_nota)>1e3);if(Be.length>0){const ke=Be.reduce((De,bt)=>De+(Number(bt.valor_total_nota)||0),0);ht.push({type:"warning",message:`${Be.length} nota(s) com valor acima de R$ 1.000,00`,count:Be.length,total:Be.length,value:ke})}const wt={};ae.forEach(ke=>{const De=ke.nome_cliente||"Desconhecido";wt[De]||(wt[De]=[]),wt[De].push(ke)}),Object.entries(wt).forEach(([ke,De])=>{if(De.length>5){const bt=De.reduce((xt,Ae)=>xt+(Number(Ae.valor_total_nota)||0),0);ht.push({type:"info",message:`Cliente "${ke}" tem ${De.length} notas lanadas`,cliente:ke,count:De.length,total:De.length,value:bt})}});const et=Q.filter(ke=>ke.resultado==="ANULADA/CANCELADA");if(et.length>0){const ke=et.reduce((De,bt)=>De+(Number(bt.valor_total_nota)||0),0);ht.push({type:"warning",message:`${et.length} nota(s) anuladas/canceladas`,detalhes:et.map(De=>`NF ${De.numero} - ${De.nome_cliente||"Sem cliente"} - R$ ${(Number(De.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`),count:et.length,total:et.length,value:ke})}const dt={};Q.forEach(ke=>{var xt;const De=((xt=ke.motivos_devolucao)==null?void 0:xt.nome)||"Sem motivo",bt=Number(ke.valor_total_nota)||0;dt[De]||(dt[De]={valorTotal:0,quantidade:0}),dt[De].valorTotal+=bt,dt[De].quantidade+=1});const we=Object.entries(dt).map(([ke,De])=>({name:ke,valorTotal:De.valorTotal,quantidade:De.quantidade})).sort((ke,De)=>De.valorTotal-ke.valorTotal);z(we);const Ne={};Q.forEach(ke=>{var xt;const De=((xt=ke.setores)==null?void 0:xt.nome)||"Sem setor",bt=Number(ke.valor_total_nota)||0;Ne[De]||(Ne[De]={valorTotal:0,quantidade:0}),Ne[De].valorTotal+=bt,Ne[De].quantidade+=1});const lt=Object.entries(Ne).map(([ke,De])=>({name:ke,valorTotal:De.valorTotal,quantidade:De.quantidade})).sort((ke,De)=>De.valorTotal-ke.valorTotal);D(lt);const Ct={};Q.forEach(ke=>{(ke.itens||[]).forEach(bt=>{const xt=bt.descricao||"Desconhecido",Ae=Number(bt.quantidade)||0,Le=(bt.unidade||"").toUpperCase().trim();Ct[xt]||(Ct[xt]={quantidadeKG:0,quantidadeCX:0,descricao:xt}),["KG","KG1","KGS"].includes(Le)?Ct[xt].quantidadeKG+=Ae:["CX","CX1","CXI","CX10","CXS","FD"].includes(Le)&&(Ct[xt].quantidadeCX+=Ae)})});const $t=Object.entries(Ct).map(([ke,De])=>({name:ke.length>30?ke.substring(0,30)+"...":ke,nameFull:ke,quantidadeKG:De.quantidadeKG,quantidadeCX:De.quantidadeCX,quantidade:w==="KG"?De.quantidadeKG:De.quantidadeCX})).filter(ke=>ke.quantidade>0).sort((ke,De)=>De.quantidade-ke.quantidade).slice(0,20);C($t)}}catch(R){console.error(" Erro ao processar dados do Dashboard Lanadas:",R),St.error("Erro ao processar dados: "+(R.message||"Erro desconhecido"))}finally{n(!1)}},j=({active:R,payload:X})=>{if(!R||!(X!=null&&X.length))return null;const Y=X[0].payload,ee=Y.quantidade||Y.count||Y.value||0,U=Y.detalhes||[],Q=U&&U.length>0;return k.jsxs("div",{className:"bg-card border border-border rounded-md p-3 shadow-md",children:[k.jsx("p",{className:"text-sm font-bold text-foreground mb-1",children:"Detalhes"}),Y.value&&typeof Y.value=="number"&&Y.value>1e3?k.jsxs("p",{className:"text-sm font-bold text-primary",children:["R$ ",Y.value.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}):k.jsxs("p",{className:"text-sm font-bold text-primary",children:[ee," ",Y.count!==void 0?"nota(s)":Y.value!==void 0?"ocorrncia(s)":"item(s)"]}),Q&&k.jsx("div",{className:"mt-2 space-y-1 max-h-[200px] overflow-y-auto",children:U.map((P,F)=>k.jsxs("p",{className:"text-xs text-muted-foreground",children:[k.jsx("span",{className:"font-medium text-foreground",children:P.cliente}),k.jsx("span",{className:"mx-1",children:""}),k.jsxs("span",{className:"text-primary",children:["NF: ",P.nota]})]},F))})]})},B=({active:R,payload:X})=>{if(!R||!(X!=null&&X.length))return null;const Y=X[0].payload,ee=Y.valorTotal||0,U=Y.quantidade||Y.count||0,Q=Y.name||Y.nameFull||"",P=Y.nameFull||Q,F=Y.nameFull?w:Y.unidade||"nota(s)";return k.jsxs("div",{className:"bg-card border border-border rounded-md p-3 shadow-md",children:[k.jsx("p",{className:"text-sm font-bold text-foreground mb-2",children:P}),k.jsxs("div",{className:"space-y-1",children:[ee>0&&k.jsxs("p",{className:"text-sm font-bold text-primary",children:["Valor Total: R$ ",ee.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),U>0&&k.jsxs("p",{className:"text-sm text-muted-foreground",children:[ee>0?"Quantidade: ":"",U.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})," ",F]})]})]})};return e?k.jsx("div",{className:"flex items-center justify-center min-h-screen",children:k.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"})}):k.jsxs("div",{className:"space-y-6",children:[k.jsx(Qi,{title:"Dashboard Lanadas",description:"Viso geral das devolues lanadas (Lanadas e Anuladas/Canceladas) com KPIs, grficos e insights automticos para anlise estratgica."}),k.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[k.jsx(Xf,{}),k.jsxs(Nt,{variant:"outline",size:"sm",onClick:S,className:"w-full md:w-auto shrink-0",children:[k.jsx(vm,{className:"mr-2 h-4 w-4"}),"Atualizar"]})]}),k.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-6",children:[k.jsx(as,{title:"Valor Total Devolvido",value:`R$ ${a.valorTotalLancado.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:Dp,description:"Resultado: LANADA"}),k.jsx(as,{title:"Notas Lanadas",value:a.notasLancadas,icon:Py,description:"Resultado: LANADA"}),k.jsx(as,{title:"Valor Total Cancelado",value:`R$ ${a.valorTotalCancelado.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:Dp,description:"Resultado: ANULADA/CANCELADA"}),k.jsx(as,{title:"Notas Canceladas",value:a.notasCanceladas,icon:Ao,description:"Resultado: ANULADA/CANCELADA"}),k.jsx(as,{title:"Produtos Devolvidos",value:a.totalProducts.toFixed(2),icon:Ul,description:"Quantidade total"}),k.jsx(as,{title:"Ticket Mdio",value:`R$ ${a.avgTicket.toLocaleString("pt-BR",{maximumFractionDigits:0})}`,icon:_u})]}),k.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[k.jsxs(Dt,{className:"col-span-4",children:[k.jsx(Rt,{children:k.jsx(Ft,{children:"Evoluo no Tempo"})}),k.jsx(Mt,{className:"pl-2",children:k.jsx(Jr,{width:"100%",height:350,children:k.jsxs(xy,{data:s,children:[k.jsx("defs",{children:k.jsxs("linearGradient",{id:"colorValue",x1:"0",y1:"0",x2:"0",y2:"1",children:[k.jsx("stop",{offset:"5%",stopColor:A[0],stopOpacity:.8}),k.jsx("stop",{offset:"95%",stopColor:A[0],stopOpacity:0})]})}),k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",height:60,tick:k.jsx(ys,{})}),k.jsx(zr,{className:"text-[6px] font-size-6px font-bold",tickFormatter:R=>`R$${R}`}),k.jsx(Qr,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)",color:"var(--foreground)",fontSize:"11px",fontWeight:"bold"},formatter:(R,X)=>X==="value"?[`R$ ${(R||0).toFixed(2)}`,"Valor Total"]:X==="count"?[`${R||0}`,"Qtd de Notas"]:[R,X||""],labelFormatter:R=>`Data: ${R}`}),k.jsx(yy,{type:"monotone",dataKey:"value",stroke:A[0],fillOpacity:1,fill:"url(#colorValue)"}),k.jsx(Xl,{type:"monotone",dataKey:"count",stroke:A[1],strokeWidth:2,dot:{fill:A[1],r:4}})]})})})]}),k.jsxs(Dt,{className:"col-span-4",children:[k.jsx(Rt,{children:k.jsx(Ft,{children:"Top Clientes (Valor)"})}),k.jsx(Mt,{children:k.jsx(Jr,{width:"100%",height:350,children:k.jsxs(Gn,{data:c,children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",height:60,tick:k.jsx(ys,{})}),k.jsx(zr,{className:"text-[6px] font-bold",tickFormatter:R=>`R$${R}`}),k.jsx(Qr,{content:k.jsx(j,{})}),k.jsx(On,{dataKey:"value",fill:A[0],radius:[8,8,0,0],children:k.jsx(Pn,{dataKey:"value",position:"top",content:({value:R})=>k.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(R||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]})]}),k.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[k.jsxs(Dt,{children:[k.jsx(Rt,{children:k.jsx(Ft,{children:"Top Vendedores (Valor)"})}),k.jsx(Mt,{children:k.jsx(Jr,{width:"100%",height:300,children:k.jsxs(Gn,{data:u,children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",height:60,tick:k.jsx(ys,{})}),k.jsx(zr,{className:"text-[10px] font-bold",tickFormatter:R=>`R$${R}`}),k.jsx(Qr,{content:k.jsx(j,{})}),k.jsx(On,{dataKey:"value",fill:A[1],radius:[8,8,0,0],children:k.jsx(Pn,{dataKey:"value",position:"top",content:({value:R})=>k.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(R||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{children:k.jsx(Ft,{children:"Top Redes (Valor)"})}),k.jsx(Mt,{children:k.jsx(Jr,{width:"100%",height:300,children:k.jsxs(Gn,{data:f,children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",height:60,tick:k.jsx(ys,{})}),k.jsx(zr,{className:"text-[10px] font-bold",tickFormatter:R=>`R$${R}`}),k.jsx(Qr,{content:k.jsx(j,{})}),k.jsx(On,{dataKey:"value",fill:A[2],radius:[8,8,0,0],children:k.jsx(Pn,{dataKey:"value",position:"top",content:({value:R})=>k.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(R||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]})]}),k.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[k.jsxs(Dt,{children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:"Top 5 Clientes com Reincidncia"}),k.jsx(Vr,{children:"Clientes com mais notas ANULADAS/CANCELADAS"})]}),k.jsx(Mt,{children:k.jsx(Jr,{width:"100%",height:300,children:k.jsxs(Gn,{data:L,children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",height:60,tick:k.jsx(ys,{})}),k.jsx(zr,{className:"text-[10px] font-bold"}),k.jsx(Qr,{content:k.jsx(j,{})}),k.jsx(On,{dataKey:"count",fill:A[3],radius:[8,8,0,0],children:k.jsx(Pn,{dataKey:"count",position:"top",content:({value:R})=>k.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`${R||0}`})})})]})})})]}),k.jsxs(Dt,{children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:"Motivos Mais Recorrentes por Rede"}),k.jsx(Vr,{children:"Principais motivos de devoluo por rede (Top 5 redes)"})]}),k.jsx(Mt,{children:k.jsx(Jr,{width:"100%",height:300,children:k.jsxs(Gn,{data:V,layout:"vertical",children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{type:"number",className:"text-[10px] font-bold"}),k.jsx(zr,{type:"category",dataKey:"rede",width:100,tick:k.jsx(ys,{})}),k.jsx(Qr,{content:k.jsx(j,{})}),k.jsx(On,{dataKey:"count",fill:A[4],radius:[0,8,8,0],children:k.jsx(Pn,{dataKey:"count",position:"right",content:({value:R})=>k.jsx("text",{x:0,y:0,dx:5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"start",children:`${R||0}`})})})]})})})]})]}),k.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[k.jsxs(Dt,{children:[k.jsx(Rt,{children:k.jsx(Ft,{children:"Anlise de Pareto (80/20)"})}),k.jsxs(Mt,{children:[k.jsx(Jr,{width:"100%",height:350,children:k.jsxs(wy,{data:v,children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",height:60,tick:k.jsx(ys,{})}),k.jsx(zr,{yAxisId:"left",className:"text-[10px] font-bold",tickFormatter:R=>`R$${R}`}),k.jsx(zr,{yAxisId:"right",orientation:"right",className:"text-[10px] font-bold",tickFormatter:R=>`${R}%`}),k.jsx(Qr,{content:k.jsx(j,{})}),k.jsx(On,{yAxisId:"left",dataKey:"value",fill:A[0],radius:[8,8,0,0],children:k.jsx(Pn,{dataKey:"value",position:"top",content:({value:R})=>k.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(R||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})}),k.jsx(Xl,{yAxisId:"right",type:"monotone",dataKey:"percentage",stroke:A[3],strokeWidth:2})]})}),k.jsx("div",{className:"mt-4 text-xs text-muted-foreground",children:"Linha mostra o percentual acumulado. A regra 80/20 indica que poucos clientes concentram a maioria do valor."})]})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{children:k.jsx(Ft,{children:"Insights Automticos"})}),k.jsx(Mt,{children:k.jsx("div",{className:"space-y-3",children:g.length>0?g.map((R,X)=>k.jsx("div",{className:"p-3 bg-muted/50 rounded-lg text-sm",children:R},X)):k.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum insight disponvel no momento."})})})]})]}),k.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[k.jsxs(Dt,{children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:"Devolues Por Motivo"}),k.jsx(Vr,{children:"Valor total e quantidade de notas por motivo"})]}),k.jsx(Mt,{children:K.length>0?k.jsx(Jr,{width:"100%",height:300,children:k.jsxs(Gn,{data:K,children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",height:60,tick:k.jsx(ys,{})}),k.jsx(zr,{className:"text-[10px] font-bold",tickFormatter:R=>`R$${R}`}),k.jsx(Qr,{content:k.jsx(B,{})}),k.jsx(On,{dataKey:"valorTotal",fill:A[0],radius:[8,8,0,0],children:k.jsx(Pn,{dataKey:"valorTotal",position:"top",content:({value:R})=>k.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:9,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(R||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})}):k.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-muted-foreground text-center p-4",children:[k.jsx(Ul,{className:"h-10 w-10 mb-2 opacity-20"}),k.jsx("p",{className:"text-sm",children:"Nenhum dado disponvel."})]})})]}),k.jsxs(Dt,{children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:"Devolues Por Setores"}),k.jsx(Vr,{children:"Valor total e quantidade de notas por setor"})]}),k.jsx(Mt,{children:W.length>0?k.jsx(Jr,{width:"100%",height:300,children:k.jsxs(Gn,{data:W,children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",height:60,tick:k.jsx(ys,{})}),k.jsx(zr,{className:"text-[10px] font-bold",tickFormatter:R=>`R$${R}`}),k.jsx(Qr,{content:k.jsx(B,{})}),k.jsx(On,{dataKey:"valorTotal",fill:A[0],radius:[8,8,0,0],children:k.jsx(Pn,{dataKey:"valorTotal",position:"top",content:({value:R})=>k.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:9,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(R||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})}):k.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-muted-foreground text-center p-4",children:[k.jsx(Ul,{className:"h-10 w-10 mb-2 opacity-20"}),k.jsx("p",{className:"text-sm",children:"Nenhum dado disponvel."})]})})]})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{children:k.jsx(Ft,{className:"text-base",children:"Distribuio por Municpio"})}),k.jsx(Mt,{children:N.length>0?k.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[k.jsx("div",{className:"space-y-4",children:N.slice(0,10).map((R,X)=>k.jsxs("div",{className:"flex items-center justify-between",children:[k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsx(Rp,{className:"h-4 w-4 text-muted-foreground"}),k.jsx("span",{className:"text-sm font-medium truncate max-w-[120px]",title:R.name,children:R.name})]}),k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsx("div",{className:"h-2 bg-muted rounded-full w-24 overflow-hidden",children:k.jsx("div",{className:"h-full bg-primary",style:{width:`${R.value/(a.totalValue||1)*100}%`}})}),k.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:[(R.value/(a.totalValue||1)*100).toFixed(0),"%"]})]})]},X))}),k.jsx("div",{className:"space-y-4",children:N.slice(10,20).map((R,X)=>k.jsxs("div",{className:"flex items-center justify-between",children:[k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsx(Rp,{className:"h-4 w-4 text-muted-foreground"}),k.jsx("span",{className:"text-sm font-medium truncate max-w-[120px]",title:R.name,children:R.name})]}),k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsx("div",{className:"h-2 bg-muted rounded-full w-24 overflow-hidden",children:k.jsx("div",{className:"h-full bg-primary",style:{width:`${R.value/(a.totalValue||1)*100}%`}})}),k.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:[(R.value/(a.totalValue||1)*100).toFixed(0),"%"]})]})]},X+10))})]}):k.jsx("div",{className:"text-center text-sm text-muted-foreground py-8",children:"Nenhum dado disponvel"})})]}),k.jsxs(Dt,{className:"col-span-4",children:[k.jsx(Rt,{children:k.jsxs("div",{className:"flex items-center justify-between",children:[k.jsx(Ft,{children:"Top 20 Produtos mais devolvidos"}),k.jsxs(La,{value:w,onValueChange:R=>T(R),children:[k.jsx(ga,{className:"w-[120px]",children:k.jsx(Ba,{})}),k.jsxs(va,{children:[k.jsx(sr,{value:"KG",children:"KG"}),k.jsx(sr,{value:"CX",children:"CX"})]})]})]})}),k.jsx(Mt,{className:"pl-2",children:M.length>0?k.jsx(Jr,{width:"100%",height:350,children:k.jsxs(Gn,{data:M,children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",height:80,tick:k.jsx(ys,{})}),k.jsx(zr,{className:"text-[10px] font-bold"}),k.jsx(Qr,{content:k.jsx(B,{})}),k.jsx(On,{dataKey:"quantidade",fill:A[0],radius:[8,8,0,0],children:k.jsx(Pn,{dataKey:"quantidade",position:"top",content:({value:R})=>k.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`${(R||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})} ${w}`})})})]})}):k.jsxs("div",{className:"flex flex-col items-center justify-center h-[350px] text-muted-foreground text-center p-4",children:[k.jsx(Ul,{className:"h-10 w-10 mb-2 opacity-20"}),k.jsx("p",{className:"text-sm",children:"Nenhum produto encontrado para o perodo selecionado."})]})})]})]})}var BN=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],UN=BN.reduce((t,r)=>{const e=gm(`Primitive.${r}`),n=ye.forwardRef((a,o)=>{const{asChild:s,...l}=a,c=s?e:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),k.jsx(c,{...l,ref:o})});return n.displayName=`Primitive.${r}`,{...t,[r]:n}},{}),zN="Label",t_=ye.forwardRef((t,r)=>k.jsx(UN.label,{...t,ref:r,onMouseDown:e=>{var a;e.target.closest("button, input, select, textarea")||((a=t.onMouseDown)==null||a.call(t,e),!e.defaultPrevented&&e.detail>1&&e.preventDefault())}}));t_.displayName=zN;var r_=t_;const $N=$f("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Er=ye.forwardRef(({className:t,...r},e)=>k.jsx(r_,{ref:e,className:At($N(),t),...r}));Er.displayName=r_.displayName;const VN=$f("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),n_=ye.forwardRef(({className:t,variant:r,...e},n)=>k.jsx("div",{ref:n,role:"alert",className:At(VN({variant:r}),t),...e}));n_.displayName="Alert";const a_=ye.forwardRef(({className:t,...r},e)=>k.jsx("div",{ref:e,className:At("text-sm [&_p]:leading-relaxed",t),...r}));a_.displayName="AlertDescription";const HN=ye.forwardRef(({className:t,...r},e)=>k.jsx("h5",{ref:e,className:At("mb-1 font-medium leading-none tracking-tight",t),...r}));HN.displayName="AlertTitle";function qN(){const[t,r]=ye.useState(""),[e,n]=ye.useState(""),[a,o]=ye.useState(""),[s,l]=ye.useState(!0),[c,i]=ye.useState(!1),[u,p]=ye.useState(null),f=r8();ye.useEffect(()=>{(async()=>{const{data:{session:b}}=await Tt.auth.getSession();b!=null&&b.user&&f("/dashboard")})()},[f]);const h=async v=>{v.preventDefault(),i(!0),p(null);const b=t.trim();try{if(s){const{data:g,error:x}=await Tt.auth.signInWithPassword({email:b,password:e});if(x)throw x;g.user&&(console.log(" Login bem-sucedido!"),St.success("Login realizado com sucesso!"),i(!1),setTimeout(()=>{f("/dashboard")},300))}else{const{data:g,error:x}=await Tt.auth.signUp({email:b,password:e,options:{data:{name:a}}});if(x)throw x;g.user&&(St.success("Conta criada com sucesso! Voc j pode entrar."),g.session?f("/dashboard"):l(!0))}}catch(g){console.error(g);let x=g.message;x.includes("Invalid login credentials")?x="Usurio no encontrado ou senha incorreta.":x.includes("User already registered")&&(x="Este email j est cadastrado. Tente fazer login."),p(x),St.error("Erro de Autenticao")}finally{i(!1)}};return k.jsxs("div",{className:"flex items-center justify-center min-h-screen bg-background relative overflow-hidden",children:[k.jsx("div",{className:"absolute w-full h-1/2 bg-primary/10 -skew-y-3 origin-top-left z-0"}),k.jsxs(Dt,{className:"w-full max-w-md z-10 border-t-4 border-t-primary shadow-2xl bg-card",children:[k.jsxs(Rt,{className:"text-center pb-2",children:[k.jsx("div",{className:"mx-auto mb-6 flex items-center justify-center",children:k.jsx("div",{className:"h-32 w-32 relative flex items-center justify-center bg-white rounded-full shadow-md p-3",children:k.jsx("img",{src:"https://i.ibb.co/zTq5KR0s/Chat-GPT-Image-26-de-dez-de-2025-19-10-20-removebg-preview.png",alt:"Logo Doce Mel",className:"object-contain h-full w-full",style:{backgroundColor:"unset",borderColor:"transparent",background:"unset",borderStyle:"none",borderImage:"none"}})})}),k.jsx("h1",{className:"text-2xl font-bold text-primary font-serif tracking-wide",children:"GRUPO DOCE MEL"}),k.jsx(Ft,{className:"text-lg font-medium text-foreground/80",children:"Gesto de Devolues"}),k.jsx(Vr,{children:s?"Entre com suas credenciais.":"Crie sua conta de Administrador."})]}),k.jsxs("form",{onSubmit:h,children:[k.jsxs(Mt,{className:"space-y-4",children:[u&&k.jsxs(n_,{variant:"destructive",children:[k.jsx(Iy,{className:"h-4 w-4"}),k.jsx(a_,{children:u})]}),!s&&k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{htmlFor:"name",children:"Nome Completo"}),k.jsx(wr,{id:"name",placeholder:"Ex: Obedys",value:a,onChange:v=>o(v.target.value),required:!s})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{htmlFor:"email",children:"Email"}),k.jsx(wr,{id:"email",type:"email",placeholder:"email@exemplo.com",value:t,onChange:v=>r(v.target.value),required:!0})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{htmlFor:"password",children:"Senha"}),k.jsx(wr,{id:"password",type:"password",value:e,onChange:v=>n(v.target.value),required:!0})]})]}),k.jsxs(Cy,{className:"flex flex-col gap-4 bg-muted/20 pt-6",children:[k.jsxs(Nt,{type:"submit",className:"w-full font-bold text-md h-11",disabled:c,children:[c&&k.jsx(oi,{className:"mr-2 h-4 w-4 animate-spin"}),s?"ENTRAR":"CRIAR CONTA"]}),k.jsx(Nt,{type:"button",variant:"link",onClick:()=>{l(!s),p(null)},children:s?"No possui acesso? Solicite aqui":"J possui conta? Voltar ao login"})]})]})]}),k.jsx("div",{className:"absolute bottom-4 text-center text-xs text-muted-foreground opacity-50",children:" 2025 Grupo Doce Mel."})]})}const Ua=ye.forwardRef(({className:t,...r},e)=>k.jsx("div",{className:"relative w-full overflow-auto",children:k.jsx("table",{ref:e,className:At("w-full caption-bottom text-sm",t),...r})}));Ua.displayName="Table";const os=ye.forwardRef(({className:t,...r},e)=>k.jsx("thead",{ref:e,className:At("[&_tr]:border-b",t),...r}));os.displayName="TableHeader";const za=ye.forwardRef(({className:t,...r},e)=>k.jsx("tbody",{ref:e,className:At("[&_tr:last-child]:border-0",t),...r}));za.displayName="TableBody";const WN=ye.forwardRef(({className:t,...r},e)=>k.jsx("tfoot",{ref:e,className:At("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...r}));WN.displayName="TableFooter";const Nr=ye.forwardRef(({className:t,...r},e)=>k.jsx("tr",{ref:e,className:At("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...r}));Nr.displayName="TableRow";const jt=ye.forwardRef(({className:t,...r},e)=>k.jsx("th",{ref:e,className:At("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r}));jt.displayName="TableHead";const Kt=ye.forwardRef(({className:t,...r},e)=>k.jsx("td",{ref:e,className:At("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r}));Kt.displayName="TableCell";const GN=ye.forwardRef(({className:t,...r},e)=>k.jsx("caption",{ref:e,className:At("mt-4 text-sm text-muted-foreground",t),...r}));GN.displayName="TableCaption";const s_=W5,Lm=ye.forwardRef(({className:t,...r},e)=>k.jsx(H5,{ref:e,className:At("border-b",t),...r}));Lm.displayName="AccordionItem";const Bm=ye.forwardRef(({className:t,children:r,...e},n)=>k.jsx(q5,{className:"flex",children:k.jsxs(uy,{ref:n,className:At("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180",t),...e,children:[r,k.jsx(Uu,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})}));Bm.displayName=uy.displayName;const Um=ye.forwardRef(({className:t,children:r,...e},n)=>k.jsx(dy,{ref:n,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...e,children:k.jsx("div",{className:At("pb-4 pt-0",t),children:r})}));Um.displayName=dy.displayName;const ri=X5,YN=K5,XN=G5,i_=ye.forwardRef(({className:t,...r},e)=>k.jsx(fy,{ref:e,className:At("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r}));i_.displayName=fy.displayName;const As=ye.forwardRef(({className:t,children:r,...e},n)=>k.jsxs(XN,{children:[k.jsx(i_,{}),k.jsxs(hy,{ref:n,className:At("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e,children:[r,k.jsxs(Y5,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[k.jsx(Vf,{className:"h-4 w-4"}),k.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));As.displayName=hy.displayName;const Cs=({className:t,...r})=>k.jsx("div",{className:At("flex flex-col space-y-1.5 text-center sm:text-left",t),...r});Cs.displayName="DialogHeader";const Ns=({className:t,...r})=>k.jsx("div",{className:At("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r});Ns.displayName="DialogFooter";const Os=ye.forwardRef(({className:t,...r},e)=>k.jsx(py,{ref:e,className:At("text-lg font-semibold leading-none tracking-tight",t),...r}));Os.displayName=py.displayName;const js=ye.forwardRef(({className:t,...r},e)=>k.jsx(my,{ref:e,className:At("text-sm text-muted-foreground",t),...r}));js.displayName=my.displayName;function ff(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var bp={exports:{}};/*! ExcelJS 19-10-2023 */var Wx;function KN(){return Wx||(Wx=1,function(t,r){(function(e){t.exports=e()})(function(){return function e(n,a,o){function s(i,u){if(!a[i]){if(!n[i]){var p=typeof ff=="function"&&ff;if(!u&&p)return p(i,!0);if(l)return l(i,!0);var f=new Error("Cannot find module '"+i+"'");throw f.code="MODULE_NOT_FOUND",f}var h=a[i]={exports:{}};n[i][0].call(h.exports,function(v){return s(n[i][1][v]||v)},h,h.exports,e,n,a,o)}return a[i].exports}for(var l=typeof ff=="function"&&ff,c=0;c<o.length;c++)s(o[c]);return s}({1:[function(e,n,a){const o=e("fs"),s=e("fast-csv"),l=e("dayjs/plugin/customParseFormat"),c=e("dayjs/plugin/utc"),i=e("dayjs").extend(l).extend(c),u=e("../utils/stream-buf"),{fs:{exists:p}}=e("../utils/utils"),f={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}};n.exports=class{constructor(h){this.workbook=h,this.worksheet=null}async readFile(h,v){if(v=v||{},!await p(h))throw new Error("File not found: "+h);const b=o.createReadStream(h),g=await this.read(b,v);return b.close(),g}read(h,v){return v=v||{},new Promise((b,g)=>{const x=this.workbook.addWorksheet(v.sheetName),y=v.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],E=v.map||function(I){if(I==="")return null;const L=Number(I);if(!Number.isNaN(L)&&L!==1/0)return L;const H=y.reduce((q,K)=>{if(q)return q;const z=i(I,K,!0);return z.isValid()?z:null},null);if(H)return new Date(H.valueOf());const V=f[I];return V!==void 0?V:I},N=s.parse(v.parserOptions).on("data",I=>{x.addRow(I.map(E))}).on("end",()=>{N.emit("worksheet",x)});N.on("worksheet",b).on("error",g),h.pipe(N)})}createInputStream(){throw new Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(h,v){return new Promise((b,g)=>{v=v||{};const x=this.workbook.getWorksheet(v.sheetName||v.sheetId),y=s.format(v.formatterOptions);h.on("finish",()=>{b()}),y.on("error",g),y.pipe(h);const{dateFormat:E,dateUTC:N}=v,I=v.map||(V=>{if(V){if(V.text||V.hyperlink)return V.hyperlink||V.text||"";if(V.formula||V.result)return V.result||"";if(V instanceof Date)return E?N?i.utc(V).format(E):i(V).format(E):N?i.utc(V).format():i(V).format();if(V.error)return V.error;if(typeof V=="object")return JSON.stringify(V)}return V}),L=v.includeEmptyRows===void 0||v.includeEmptyRows;let H=1;x&&x.eachRow((V,q)=>{if(L)for(;H++<q-1;)y.write([]);const{values:K}=V;K.shift(),y.write(K.map(I)),H=q}),y.end()})}writeFile(h,v){const b={encoding:(v=v||{}).encoding||"utf8"},g=o.createWriteStream(h,b);return this.write(g,v)}async writeBuffer(h){const v=new u;return await this.write(v,h),v.read()}}},{"../utils/stream-buf":24,"../utils/utils":27,dayjs:391,"dayjs/plugin/customParseFormat":392,"dayjs/plugin/utc":393,"fast-csv":424,fs:216}],2:[function(e,n,a){const o=e("../utils/col-cache");class s{constructor(c,i){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(this.worksheet=c,i)if(typeof i=="string"){const p=o.decodeAddress(i);this.nativeCol=p.col+u,this.nativeColOff=0,this.nativeRow=p.row+u,this.nativeRowOff=0}else i.nativeCol!==void 0?(this.nativeCol=i.nativeCol||0,this.nativeColOff=i.nativeColOff||0,this.nativeRow=i.nativeRow||0,this.nativeRowOff=i.nativeRowOff||0):i.col!==void 0?(this.col=i.col+u,this.row=i.row+u):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0);else this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0}static asInstance(c){return c instanceof s||c==null?c:new s(c)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(c){this.nativeCol=Math.floor(c),this.nativeColOff=Math.floor((c-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(c){this.nativeRow=Math.floor(c),this.nativeRowOff=Math.floor((c-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(1e4*this.worksheet.getColumn(this.nativeCol+1).width):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(1e4*this.worksheet.getRow(this.nativeRow+1).height):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(c){this.nativeCol=c.nativeCol,this.nativeColOff=c.nativeColOff,this.nativeRow=c.nativeRow,this.nativeRowOff=c.nativeRowOff}}n.exports=s},{"../utils/col-cache":19}],3:[function(e,n,a){const o=e("../utils/col-cache"),s=e("../utils/under-dash"),l=e("./enums"),{slideFormula:c}=e("../utils/shared-formula"),i=e("./note");class u{constructor(h,v,b){if(!h||!v)throw new Error("A Cell needs a Row");this._row=h,this._column=v,o.validateAddress(b),this._address=b,this._value=p.create(u.Types.Null,this),this.style=this._mergeStyle(h.style,v.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(h){this.style.numFmt=h}get font(){return this.style.font}set font(h){this.style.font=h}get alignment(){return this.style.alignment}set alignment(h){this.style.alignment=h}get border(){return this.style.border}set border(h){this.style.border=h}get fill(){return this.style.fill}set fill(h){this.style.fill=h}get protection(){return this.style.protection}set protection(h){this.style.protection=h}_mergeStyle(h,v,b){const g=h&&h.numFmt||v&&v.numFmt;g&&(b.numFmt=g);const x=h&&h.font||v&&v.font;x&&(b.font=x);const y=h&&h.alignment||v&&v.alignment;y&&(b.alignment=y);const E=h&&h.border||v&&v.border;E&&(b.border=E);const N=h&&h.fill||v&&v.fill;N&&(b.fill=N);const I=h&&h.protection||v&&v.protection;return I&&(b.protection=I),b}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return`$${this._column.letter}$${this.row}`}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===u.Types.Merge}merge(h,v){this._value.release(),this._value=p.create(u.Types.Merge,this,h),v||(this.style=h.style)}unmerge(){this.type===u.Types.Merge&&(this._value.release(),this._value=p.create(u.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(h){return this._value.type===u.Types.Merge&&this._value.isMergedTo(h)}get master(){return this.type===u.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===u.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(h){this.type!==u.Types.Merge?(this._value.release(),this._value=p.create(p.getType(h),this,h)):this._value.master.value=h}get note(){return this._comment&&this._comment.note}set note(h){this._comment=new i(h)}get text(){return this._value.toString()}get html(){return s.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(h){this.type===u.Types.String&&(this._value=p.create(u.Types.Hyperlink,this,{text:this._value.value,hyperlink:h}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){const{worksheet:h}=this._row;return{sheetName:h.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(h){this.names=[h]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(h){const{definedNames:v}=this.workbook;v.removeAllNames(this.fullAddress),h.forEach(b=>{v.addEx(this.fullAddress,b)})}addName(h){this.workbook.definedNames.addEx(this.fullAddress,h)}removeName(h){this.workbook.definedNames.removeEx(this.fullAddress,h)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(h){this._dataValidations.add(this.address,h)}get model(){const{model:h}=this._value;return h.style=this.style,this._comment&&(h.comment=this._comment.model),h}set model(h){if(this._value.release(),this._value=p.create(h.type,this),this._value.model=h,h.comment)switch(h.comment.type){case"note":this._comment=i.fromModel(h.comment)}h.style?this.style=h.style:this.style={}}}u.Types=l.ValueType;const p={getType:f=>f==null?u.Types.Null:f instanceof String||typeof f=="string"?u.Types.String:typeof f=="number"?u.Types.Number:typeof f=="boolean"?u.Types.Boolean:f instanceof Date?u.Types.Date:f.text&&f.hyperlink?u.Types.Hyperlink:f.formula||f.sharedFormula?u.Types.Formula:f.richText?u.Types.RichText:f.sharedString?u.Types.SharedString:f.error?u.Types.Error:u.Types.JSON,types:[{t:u.Types.Null,f:class{constructor(f){this.model={address:f.address,type:u.Types.Null}}get value(){return null}set value(f){}get type(){return u.Types.Null}get effectiveType(){return u.Types.Null}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return""}release(){}toString(){return""}}},{t:u.Types.Number,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Number,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Number}get effectiveType(){return u.Types.Number}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.String,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.String,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.String}get effectiveType(){return u.Types.String}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return`"${this.model.value.replace(/"/g,'""')}"`}release(){}toString(){return this.model.value}}},{t:u.Types.Date,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Date,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Date}get effectiveType(){return u.Types.Date}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.Hyperlink,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Hyperlink,text:h?h.text:void 0,hyperlink:h?h.hyperlink:void 0},h&&h.tooltip&&(this.model.tooltip=h.tooltip)}get value(){const f={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(f.tooltip=this.model.tooltip),f}set value(f){this.model={text:f.text,hyperlink:f.hyperlink},f.tooltip&&(this.model.tooltip=f.tooltip)}get text(){return this.model.text}set text(f){this.model.text=f}get hyperlink(){return this.model.hyperlink}set hyperlink(f){this.model.hyperlink=f}get type(){return u.Types.Hyperlink}get effectiveType(){return u.Types.Hyperlink}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}}},{t:u.Types.Formula,f:class{constructor(f,h){this.cell=f,this.model={address:f.address,type:u.Types.Formula,shareType:h?h.shareType:void 0,ref:h?h.ref:void 0,formula:h?h.formula:void 0,sharedFormula:h?h.sharedFormula:void 0,result:h?h.result:void 0}}_copyModel(f){const h={},v=b=>{const g=f[b];g&&(h[b]=g)};return v("formula"),v("result"),v("ref"),v("shareType"),v("sharedFormula"),h}get value(){return this._copyModel(this.model)}set value(f){this.model=this._copyModel(f)}validate(f){switch(p.getType(f)){case u.Types.Null:case u.Types.String:case u.Types.Number:case u.Types.Date:break;case u.Types.Hyperlink:case u.Types.Formula:default:throw new Error("Cannot process that type of result value")}}get dependencies(){return{ranges:this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),cells:this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g)}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(f){this.model.formula=f}get formulaType(){return this.model.formula?l.FormulaType.Master:this.model.sharedFormula?l.FormulaType.Shared:l.FormulaType.None}get result(){return this.model.result}set result(f){this.model.result=f}get type(){return u.Types.Formula}get effectiveType(){const f=this.model.result;return f==null?l.ValueType.Null:f instanceof String||typeof f=="string"?l.ValueType.String:typeof f=="number"?l.ValueType.Number:f instanceof Date?l.ValueType.Date:f.text&&f.hyperlink?l.ValueType.Hyperlink:f.formula?l.ValueType.Formula:l.ValueType.Null}get address(){return this.model.address}set address(f){this.model.address=f}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){const{worksheet:f}=this.cell,h=f.findCell(this.model.sharedFormula);this._translatedFormula=h&&c(h.formula,h.address,this.model.address)}return this._translatedFormula}toCsvString(){return""+(this.model.result||"")}release(){}toString(){return this.model.result?this.model.result.toString():""}}},{t:u.Types.Merge,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Merge,master:h?h.address:void 0},this._master=h,h&&h.addMergeRef()}get value(){return this._master.value}set value(f){f instanceof u?(this._master&&this._master.releaseMergeRef(),f.addMergeRef(),this._master=f):this._master.value=f}isMergedTo(f){return f===this._master}get master(){return this._master}get type(){return u.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}}},{t:u.Types.JSON,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.String,value:JSON.stringify(h),rawValue:h}}get value(){return this.model.rawValue}set value(f){this.model.rawValue=f,this.model.value=JSON.stringify(f)}get type(){return u.Types.String}get effectiveType(){return u.Types.String}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}}},{t:u.Types.SharedString,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.SharedString,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.SharedString}get effectiveType(){return u.Types.SharedString}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.RichText,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.String,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}toString(){return this.model.value.richText.map(f=>f.text).join("")}get type(){return u.Types.RichText}get effectiveType(){return u.Types.RichText}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return`"${this.text.replace(/"/g,'""')}"`}release(){}}},{t:u.Types.Boolean,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Boolean,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Boolean}get effectiveType(){return u.Types.Boolean}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.Error,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Error,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Error}get effectiveType(){return u.Types.Error}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}}}].reduce((f,h)=>(f[h.t]=h.f,f),[]),create(f,h,v){const b=this.types[f];if(!b)throw new Error("Could not create Value of type "+f);return new b(h,v)}};n.exports=u},{"../utils/col-cache":19,"../utils/shared-formula":23,"../utils/under-dash":26,"./enums":7,"./note":9}],4:[function(e,n,a){const o=e("../utils/under-dash"),s=e("./enums"),l=e("../utils/col-cache");class c{constructor(u,p,f){this._worksheet=u,this._number=p,f!==!1&&(this.defn=f)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return l.n2l(this._number)}get isCustomWidth(){return this.width!==void 0&&this.width!==9}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(u){u?(this.key=u.key,this.width=u.width!==void 0?u.width:9,this.outlineLevel=u.outlineLevel,u.style?this.style=u.style:this.style={},this.header=u.header,this._hidden=!!u.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(u){u!==void 0?(this._header=u,this.headers.forEach((p,f)=>{this._worksheet.getCell(f+1,this.number).value=p})):this._header=void 0}get key(){return this._key}set key(u){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=u,u&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(u){this._hidden=u}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(u){this._outlineLevel=u}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(u){return this.width===u.width&&this.hidden===u.hidden&&this.outlineLevel===u.outlineLevel&&o.isEqual(this.style,u.style)}get isDefault(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;const u=this.style;return!u||!(u.font||u.numFmt||u.alignment||u.border||u.fill||u.protection)}get headerCount(){return this.headers.length}eachCell(u,p){const f=this.number;p||(p=u,u=null),this._worksheet.eachRow(u,(h,v)=>{p(h.getCell(f),v)})}get values(){const u=[];return this.eachCell((p,f)=>{p&&p.type!==s.ValueType.Null&&(u[f]=p.value)}),u}set values(u){if(!u)return;const p=this.number;let f=0;u.hasOwnProperty("0")&&(f=1),u.forEach((h,v)=>{this._worksheet.getCell(v+f,p).value=h})}_applyStyle(u,p){return this.style[u]=p,this.eachCell(f=>{f[u]=p}),p}get numFmt(){return this.style.numFmt}set numFmt(u){this._applyStyle("numFmt",u)}get font(){return this.style.font}set font(u){this._applyStyle("font",u)}get alignment(){return this.style.alignment}set alignment(u){this._applyStyle("alignment",u)}get protection(){return this.style.protection}set protection(u){this._applyStyle("protection",u)}get border(){return this.style.border}set border(u){this._applyStyle("border",u)}get fill(){return this.style.fill}set fill(u){this._applyStyle("fill",u)}static toModel(u){const p=[];let f=null;return u&&u.forEach((h,v)=>{h.isDefault?f&&(f=null):f&&h.equivalentTo(f)?f.max=v+1:(f={min:v+1,max:v+1,width:h.width!==void 0?h.width:9,style:h.style,isCustomWidth:h.isCustomWidth,hidden:h.hidden,outlineLevel:h.outlineLevel,collapsed:h.collapsed},p.push(f))}),p.length?p:void 0}static fromModel(u,p){const f=[];let h=1,v=0;for(p=(p=p||[]).sort(function(b,g){return b.min-g.min});v<p.length;){const b=p[v++];for(;h<b.min;)f.push(new c(u,h++));for(;h<=b.max;)f.push(new c(u,h++,b))}return f.length?f:null}}n.exports=c},{"../utils/col-cache":19,"../utils/under-dash":26,"./enums":7}],5:[function(e,n,a){n.exports=class{constructor(o){this.model=o||{}}add(o,s){return this.model[o]=s}find(o){return this.model[o]}remove(o){this.model[o]=void 0}}},{}],6:[function(e,n,a){const o=e("../utils/under-dash"),s=e("../utils/col-cache"),l=e("../utils/cell-matrix"),c=e("./range"),i=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/;n.exports=class{constructor(){this.matrixMap={}}getMatrix(u){return this.matrixMap[u]||(this.matrixMap[u]=new l)}add(u,p){const f=s.decodeEx(u);this.addEx(f,p)}addEx(u,p){const f=this.getMatrix(p);if(u.top)for(let h=u.left;h<=u.right;h++)for(let v=u.top;v<=u.bottom;v++){const b={sheetName:u.sheetName,address:s.n2l(h)+v,row:v,col:h};f.addCellEx(b)}else f.addCellEx(u)}remove(u,p){const f=s.decodeEx(u);this.removeEx(f,p)}removeEx(u,p){this.getMatrix(p).removeCellEx(u)}removeAllNames(u){o.each(this.matrixMap,p=>{p.removeCellEx(u)})}forEach(u){o.each(this.matrixMap,(p,f)=>{p.forEach(h=>{u(f,h)})})}getNames(u){return this.getNamesEx(s.decodeEx(u))}getNamesEx(u){return o.map(this.matrixMap,(p,f)=>p.findCellEx(u)&&f).filter(Boolean)}_explore(u,p){p.mark=!1;const{sheetName:f}=p,h=new c(p.row,p.col,p.row,p.col,f);let v,b;function g(y,E){const N=u.findCellAt(f,y,p.col);return!(!N||!N.mark)&&(h[E]=y,N.mark=!1,!0)}for(b=p.row-1;g(b,"top");b--);for(b=p.row+1;g(b,"bottom");b++);function x(y,E){const N=[];for(b=h.top;b<=h.bottom;b++){const I=u.findCellAt(f,b,y);if(!I||!I.mark)return!1;N.push(I)}h[E]=y;for(let I=0;I<N.length;I++)N[I].mark=!1;return!0}for(v=p.col-1;x(v,"left");v--);for(v=p.col+1;x(v,"right");v++);return h}getRanges(u,p){return(p=p||this.matrixMap[u])?(p.forEach(f=>{f.mark=!0}),{name:u,ranges:p.map(f=>f.mark&&this._explore(p,f)).filter(Boolean).map(f=>f.$shortRange)}):{name:u,ranges:[]}}normaliseMatrix(u,p){u.forEachInSheet(p,(f,h,v)=>{f&&(f.row===h&&f.col===v||(f.row=h,f.col=v,f.address=s.n2l(v)+h))})}spliceRows(u,p,f,h){o.each(this.matrixMap,v=>{v.spliceRows(u,p,f,h),this.normaliseMatrix(v,u)})}spliceColumns(u,p,f,h){o.each(this.matrixMap,v=>{v.spliceColumns(u,p,f,h),this.normaliseMatrix(v,u)})}get model(){return o.map(this.matrixMap,(u,p)=>this.getRanges(p,u)).filter(u=>u.ranges.length)}set model(u){const p=this.matrixMap={};u.forEach(f=>{const h=p[f.name]=new l;f.ranges.forEach(v=>{i.test(v.split("!").pop()||"")&&h.addCell(v)})})}}},{"../utils/cell-matrix":18,"../utils/col-cache":19,"../utils/under-dash":26,"./range":10}],7:[function(e,n,a){n.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}},{}],8:[function(e,n,a){const o=e("../utils/col-cache"),s=e("./anchor");n.exports=class{constructor(l,c){this.worksheet=l,this.model=c}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw new Error("Invalid Image Type")}}set model(l){let{type:c,imageId:i,range:u,hyperlinks:p}=l;if(this.type=c,this.imageId=i,c==="image")if(typeof u=="string"){const f=o.decode(u);this.range={tl:new s(this.worksheet,{col:f.left,row:f.top},-1),br:new s(this.worksheet,{col:f.right,row:f.bottom},0),editAs:"oneCell"}}else this.range={tl:new s(this.worksheet,u.tl,0),br:u.br&&new s(this.worksheet,u.br,0),ext:u.ext,editAs:u.editAs,hyperlinks:p||u.hyperlinks}}}},{"../utils/col-cache":19,"./anchor":2}],9:[function(e,n,a){const o=e("../utils/under-dash");class s{constructor(c){this.note=c}get model(){let c=null;switch(typeof this.note){case"string":c={type:"note",note:{texts:[{text:this.note}]}};break;default:c={type:"note",note:this.note}}return o.deepMerge({},s.DEFAULT_CONFIGS,c)}set model(c){const{note:i}=c,{texts:u}=i;u.length===1&&Object.keys(u[0]).length===1?this.note=u[0].text:this.note=i}static fromModel(c){const i=new s;return i.model=c,i}}s.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},n.exports=s},{"../utils/under-dash":26}],10:[function(e,n,a){const o=e("../utils/col-cache");class s{constructor(){this.decode(arguments)}setTLBR(c,i,u,p,f){if(arguments.length<4){const h=o.decodeAddress(c),v=o.decodeAddress(i);this.model={top:Math.min(h.row,v.row),left:Math.min(h.col,v.col),bottom:Math.max(h.row,v.row),right:Math.max(h.col,v.col),sheetName:u},this.setTLBR(h.row,h.col,v.row,v.col,f)}else this.model={top:Math.min(c,u),left:Math.min(i,p),bottom:Math.max(c,u),right:Math.max(i,p),sheetName:f}}decode(c){switch(c.length){case 5:this.setTLBR(c[0],c[1],c[2],c[3],c[4]);break;case 4:this.setTLBR(c[0],c[1],c[2],c[3]);break;case 3:this.setTLBR(c[0],c[1],c[2]);break;case 2:this.setTLBR(c[0],c[1]);break;case 1:{const i=c[0];if(i instanceof s)this.model={top:i.model.top,left:i.model.left,bottom:i.model.bottom,right:i.model.right,sheetName:i.sheetName};else if(i instanceof Array)this.decode(i);else if(i.top&&i.left&&i.bottom&&i.right)this.model={top:i.top,left:i.left,bottom:i.bottom,right:i.right,sheetName:i.sheetName};else{const u=o.decodeEx(i);u.top?this.model={top:u.top,left:u.left,bottom:u.bottom,right:u.right,sheetName:u.sheetName}:this.model={top:u.row,left:u.col,bottom:u.row,right:u.col,sheetName:u.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error("Invalid number of arguments to _getDimensions() - "+c.length)}}get top(){return this.model.top||1}set top(c){this.model.top=c}get left(){return this.model.left||1}set left(c){this.model.left=c}get bottom(){return this.model.bottom||1}set bottom(c){this.model.bottom=c}get right(){return this.model.right||1}set right(c){this.model.right=c}get sheetName(){return this.model.sheetName}set sheetName(c){this.model.sheetName=c}get _serialisedSheetName(){const{sheetName:c}=this.model;return c?/^[a-zA-Z0-9]*$/.test(c)?c+"!":`'${c}'!`:""}expand(c,i,u,p){(!this.model.top||c<this.top)&&(this.top=c),(!this.model.left||i<this.left)&&(this.left=i),(!this.model.bottom||u>this.bottom)&&(this.bottom=u),(!this.model.right||p>this.right)&&(this.right=p)}expandRow(c){if(c){const{dimensions:i,number:u}=c;i&&this.expand(u,i.min,u,i.max)}}expandToAddress(c){const i=o.decodeEx(c);this.expand(i.row,i.col,i.row,i.col)}get tl(){return o.n2l(this.left)+this.top}get $t$l(){return`$${o.n2l(this.left)}$${this.top}`}get br(){return o.n2l(this.right)+this.bottom}get $b$r(){return`$${o.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(c){return(!c.sheetName||!this.sheetName||c.sheetName===this.sheetName)&&!(c.bottom<this.top)&&!(c.top>this.bottom)&&!(c.right<this.left)&&!(c.left>this.right)}contains(c){const i=o.decodeEx(c);return this.containsEx(i)}containsEx(c){return(!c.sheetName||!this.sheetName||c.sheetName===this.sheetName)&&c.row>=this.top&&c.row<=this.bottom&&c.col>=this.left&&c.col<=this.right}forEachAddress(c){for(let i=this.left;i<=this.right;i++)for(let u=this.top;u<=this.bottom;u++)c(o.encodeAddress(u,i),u,i)}}n.exports=s},{"../utils/col-cache":19}],11:[function(e,n,a){const o=e("../utils/under-dash"),s=e("./enums"),l=e("../utils/col-cache"),c=e("./cell");n.exports=class{constructor(i,u){this._worksheet=i,this._number=u,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(i){return this._cells[i-1]}getCellEx(i){let u=this._cells[i.col-1];if(!u){const p=this._worksheet.getColumn(i.col);u=new c(this,p,i.address),this._cells[i.col-1]=u}return u}getCell(i){if(typeof i=="string"){const u=this._worksheet.getColumnKey(i);i=u?u.number:l.l2n(i)}return this._cells[i-1]||this.getCellEx({address:l.encodeAddress(this._number,i),row:this._number,col:i})}splice(i,u){const p=i+u;for(var f=arguments.length,h=new Array(f>2?f-2:0),v=2;v<f;v++)h[v-2]=arguments[v];const b=h.length-u,g=this._cells.length;let x,y,E;if(b<0)for(x=i+h.length;x<=g;x++)E=this._cells[x-1],y=this._cells[x-b-1],y?(E=this.getCell(x),E.value=y.value,E.style=y.style,E._comment=y._comment):E&&(E.value=null,E.style={},E._comment=void 0);else if(b>0)for(x=g;x>=p;x--)y=this._cells[x-1],y?(E=this.getCell(x+b),E.value=y.value,E.style=y.style,E._comment=y._comment):this._cells[x+b-1]=void 0;for(x=0;x<h.length;x++)E=this.getCell(i+x),E.value=h[x],E.style={},E._comment=void 0}eachCell(i,u){if(u||(u=i,i=null),i&&i.includeEmpty){const p=this._cells.length;for(let f=1;f<=p;f++)u(this.getCell(f),f)}else this._cells.forEach((p,f)=>{p&&p.type!==s.ValueType.Null&&u(p,f+1)})}addPageBreak(i,u){const p=this._worksheet,f=Math.max(0,i-1)||0,h=Math.max(0,u-1)||16838,v={id:this._number,max:h,man:1};f&&(v.min=f),p.rowBreaks.push(v)}get values(){const i=[];return this._cells.forEach(u=>{u&&u.type!==s.ValueType.Null&&(i[u.col]=u.value)}),i}set values(i){if(this._cells=[],i)if(i instanceof Array){let u=0;i.hasOwnProperty("0")&&(u=1),i.forEach((p,f)=>{p!==void 0&&(this.getCellEx({address:l.encodeAddress(this._number,f+u),row:this._number,col:f+u}).value=p)})}else this._worksheet.eachColumnKey((u,p)=>{i[p]!==void 0&&(this.getCellEx({address:l.encodeAddress(this._number,u.number),row:this._number,col:u.number}).value=i[p])})}get hasValues(){return o.some(this._cells,i=>i&&i.type!==s.ValueType.Null)}get cellCount(){return this._cells.length}get actualCellCount(){let i=0;return this.eachCell(()=>{i++}),i}get dimensions(){let i=0,u=0;return this._cells.forEach(p=>{p&&p.type!==s.ValueType.Null&&((!i||i>p.col)&&(i=p.col),u<p.col&&(u=p.col))}),i>0?{min:i,max:u}:null}_applyStyle(i,u){return this.style[i]=u,this._cells.forEach(p=>{p&&(p[i]=u)}),u}get numFmt(){return this.style.numFmt}set numFmt(i){this._applyStyle("numFmt",i)}get font(){return this.style.font}set font(i){this._applyStyle("font",i)}get alignment(){return this.style.alignment}set alignment(i){this._applyStyle("alignment",i)}get protection(){return this.style.protection}set protection(i){this._applyStyle("protection",i)}get border(){return this.style.border}set border(i){this._applyStyle("border",i)}get fill(){return this.style.fill}set fill(i){this._applyStyle("fill",i)}get hidden(){return!!this._hidden}set hidden(i){this._hidden=i}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(i){this._outlineLevel=i}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){const i=[];let u=0,p=0;return this._cells.forEach(f=>{if(f){const h=f.model;h&&((!u||u>f.col)&&(u=f.col),p<f.col&&(p=f.col),i.push(h))}}),this.height||i.length?{cells:i,number:this.number,min:u,max:p,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(i){if(i.number!==this._number)throw new Error("Invalid row number in model");let u;this._cells=[],i.cells.forEach(p=>{switch(p.type){case c.Types.Merge:break;default:{let f;if(p.address)f=l.decodeAddress(p.address);else if(u){const{row:h}=u,v=u.col+1;f={row:h,col:v,address:l.encodeAddress(h,v),$col$row:`$${l.n2l(v)}$${h}`}}u=f,this.getCellEx(f).model=p;break}}}),i.height?this.height=i.height:delete this.height,this.hidden=i.hidden,this.outlineLevel=i.outlineLevel||0,this.style=i.style&&JSON.parse(JSON.stringify(i.style))||{}}}},{"../utils/col-cache":19,"../utils/under-dash":26,"./cell":3,"./enums":7}],12:[function(e,n,a){const o=e("../utils/col-cache");class s{constructor(c,i,u){this.table=c,this.column=i,this.index=u}_set(c,i){this.table.cacheState(),this.column[c]=i}get name(){return this.column.name}set name(c){this._set("name",c)}get filterButton(){return this.column.filterButton}set filterButton(c){this.column.filterButton=c}get style(){return this.column.style}set style(c){this.column.style=c}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(c){this._set("totalsRowLabel",c)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(c){this._set("totalsRowFunction",c)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(c){this._set("totalsRowResult",c)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(c){this._set("totalsRowFormula",c)}}n.exports=class{constructor(l,c){this.worksheet=l,c&&(this.table=c,this.validate(),this.store())}getFormula(l){switch(l.totalsRowFunction){case"none":return null;case"average":return`SUBTOTAL(101,${this.table.name}[${l.name}])`;case"countNums":return`SUBTOTAL(102,${this.table.name}[${l.name}])`;case"count":return`SUBTOTAL(103,${this.table.name}[${l.name}])`;case"max":return`SUBTOTAL(104,${this.table.name}[${l.name}])`;case"min":return`SUBTOTAL(105,${this.table.name}[${l.name}])`;case"stdDev":return`SUBTOTAL(106,${this.table.name}[${l.name}])`;case"var":return`SUBTOTAL(107,${this.table.name}[${l.name}])`;case"sum":return`SUBTOTAL(109,${this.table.name}[${l.name}])`;case"custom":return l.totalsRowFormula;default:throw new Error("Invalid Totals Row Function: "+l.totalsRowFunction)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){const{table:l}=this,c=(b,g,x)=>{b[g]===void 0&&(b[g]=x)};c(l,"headerRow",!0),c(l,"totalsRow",!1),c(l,"style",{}),c(l.style,"theme","TableStyleMedium2"),c(l.style,"showFirstColumn",!1),c(l.style,"showLastColumn",!1),c(l.style,"showRowStripes",!1),c(l.style,"showColumnStripes",!1);const i=(b,g)=>{if(!b)throw new Error(g)};i(l.ref,"Table must have ref"),i(l.columns,"Table must have column definitions"),i(l.rows,"Table must have row definitions"),l.tl=o.decodeAddress(l.ref);const{row:u,col:p}=l.tl;i(u>0,"Table must be on valid row"),i(p>0,"Table must be on valid col");const{width:f,filterHeight:h,tableHeight:v}=this;l.autoFilterRef=o.encode(u,p,u+h-1,p+f-1),l.tableRef=o.encode(u,p,u+v-1,p+f-1),l.columns.forEach((b,g)=>{i(b.name,`Column ${g} must have a name`),g===0?c(b,"totalsRowLabel","Total"):(c(b,"totalsRowFunction","none"),b.totalsRowFormula=this.getFormula(b))})}store(){const l=(h,v)=>{v&&Object.keys(v).forEach(b=>{h[b]=v[b]})},{worksheet:c,table:i}=this,{row:u,col:p}=i.tl;let f=0;if(i.headerRow){const h=c.getRow(u+f++);i.columns.forEach((v,b)=>{const{style:g,name:x}=v,y=h.getCell(p+b);y.value=x,l(y,g)})}if(i.rows.forEach(h=>{const v=c.getRow(u+f++);h.forEach((b,g)=>{const x=v.getCell(p+g);x.value=b,l(x,i.columns[g].style)})}),i.totalsRow){const h=c.getRow(u+f++);i.columns.forEach((v,b)=>{const g=h.getCell(p+b);if(b===0)g.value=v.totalsRowLabel;else{const x=this.getFormula(v);g.value=x?{formula:v.totalsRowFormula,result:v.totalsRowResult}:null}l(g,v.style)})}}load(l){const{table:c}=this,{row:i,col:u}=c.tl;let p=0;if(c.headerRow){const f=l.getRow(i+p++);c.columns.forEach((h,v)=>{f.getCell(u+v).value=h.name})}if(c.rows.forEach(f=>{const h=l.getRow(i+p++);f.forEach((v,b)=>{h.getCell(u+b).value=v})}),c.totalsRow){const f=l.getRow(i+p++);c.columns.forEach((h,v)=>{const b=f.getCell(u+v);v===0?b.value=h.totalsRowLabel:this.getFormula(h)&&(b.value={formula:h.totalsRowFormula,result:h.totalsRowResult})})}}get model(){return this.table}set model(l){this.table=l}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();const l=o.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let c=0;c<this._cache.tableHeight;c++){const i=this.worksheet.getRow(l.row+c);for(let u=0;u<this._cache.width;u++)i.getCell(l.col+u).value=null}else{for(let c=this.tableHeight;c<this._cache.tableHeight;c++){const i=this.worksheet.getRow(l.row+c);for(let u=0;u<this._cache.width;u++)i.getCell(l.col+u).value=null}for(let c=0;c<this.tableHeight;c++){const i=this.worksheet.getRow(l.row+c);for(let u=this.width;u<this._cache.width;u++)i.getCell(l.col+u).value=null}}this.store()}addRow(l,c){this.cacheState(),c===void 0?this.table.rows.push(l):this.table.rows.splice(c,0,l)}removeRows(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.rows.splice(l,c)}getColumn(l){const c=this.table.columns[l];return new s(this,c,l)}addColumn(l,c,i){this.cacheState(),i===void 0?(this.table.columns.push(l),this.table.rows.forEach((u,p)=>{u.push(c[p])})):(this.table.columns.splice(i,0,l),this.table.rows.forEach((u,p)=>{u.splice(i,0,c[p])}))}removeColumns(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.columns.splice(l,c),this.table.rows.forEach(i=>{i.splice(l,c)})}_assign(l,c,i){this.cacheState(),l[c]=i}get ref(){return this.table.ref}set ref(l){this._assign(this.table,"ref",l)}get name(){return this.table.name}set name(l){this.table.name=l}get displayName(){return this.table.displyName||this.table.name}set displayNamename(l){this.table.displayName=l}get headerRow(){return this.table.headerRow}set headerRow(l){this._assign(this.table,"headerRow",l)}get totalsRow(){return this.table.totalsRow}set totalsRow(l){this._assign(this.table,"totalsRow",l)}get theme(){return this.table.style.name}set theme(l){this.table.style.name=l}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(l){this.table.style.showFirstColumn=l}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(l){this.table.style.showLastColumn=l}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(l){this.table.style.showRowStripes=l}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(l){this.table.style.showColumnStripes=l}}},{"../utils/col-cache":19}],13:[function(e,n,a){const o=e("./worksheet"),s=e("./defined-names"),l=e("../xlsx/xlsx"),c=e("../csv/csv");n.exports=class{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new s}get xlsx(){return this._xlsx||(this._xlsx=new l(this)),this._xlsx}get csv(){return this._csv||(this._csv=new c(this)),this._csv}get nextId(){for(let i=1;i<this._worksheets.length;i++)if(!this._worksheets[i])return i;return this._worksheets.length||1}addWorksheet(i,u){const p=this.nextId;u&&(typeof u=="string"?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),u={properties:{tabColor:{argb:u}}}):(u.argb||u.theme||u.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),u={properties:{tabColor:u}}));const f=this._worksheets.reduce((b,g)=>(g&&g.orderNo)>b?g.orderNo:b,0),h=Object.assign({},u,{id:p,name:i,orderNo:f+1,workbook:this}),v=new o(h);return this._worksheets[p]=v,v}removeWorksheetEx(i){delete this._worksheets[i.id]}removeWorksheet(i){const u=this.getWorksheet(i);u&&u.destroy()}getWorksheet(i){return i===void 0?this._worksheets.find(Boolean):typeof i=="number"?this._worksheets[i]:typeof i=="string"?this._worksheets.find(u=>u&&u.name===i):void 0}get worksheets(){return this._worksheets.slice(1).sort((i,u)=>i.orderNo-u.orderNo).filter(Boolean)}eachSheet(i){this.worksheets.forEach(u=>{i(u,u.id)})}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(i){const u=this.media.length;return this.media.push(Object.assign({},i,{type:"image"})),u}getImage(i){return this.media[i]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(i=>i.model),sheets:this.worksheets.map(i=>i.model).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(i){this.creator=i.creator,this.lastModifiedBy=i.lastModifiedBy,this.lastPrinted=i.lastPrinted,this.created=i.created,this.modified=i.modified,this.company=i.company,this.manager=i.manager,this.title=i.title,this.subject=i.subject,this.keywords=i.keywords,this.category=i.category,this.description=i.description,this.language=i.language,this.revision=i.revision,this.contentStatus=i.contentStatus,this.properties=i.properties,this.calcProperties=i.calcProperties,this._worksheets=[],i.worksheets.forEach(u=>{const{id:p,name:f,state:h}=u,v=i.sheets&&i.sheets.findIndex(b=>b.id===p);(this._worksheets[p]=new o({id:p,name:f,orderNo:v,state:h,workbook:this})).model=u}),this._definedNames.model=i.definedNames,this.views=i.views,this._themes=i.themes,this.media=i.media||[]}}},{"../csv/csv":1,"../xlsx/xlsx":144,"./defined-names":6,"./worksheet":14}],14:[function(e,n,a){const o=e("../utils/under-dash"),s=e("../utils/col-cache"),l=e("./range"),c=e("./row"),i=e("./column"),u=e("./enums"),p=e("./image"),f=e("./table"),h=e("./data-validations"),v=e("../utils/encryptor"),{copyStyle:b}=e("../utils/copy-style");n.exports=class{constructor(g){g=g||{},this._workbook=g.workbook,this.id=g.id,this.orderNo=g.orderNo,this.name=g.name,this.state=g.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},g.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!(!g.pageSetup||!g.pageSetup.fitToWidth&&!g.pageSetup.fitToHeight||g.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},g.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},g.headerFooter),this.dataValidations=new h,this.views=g.views||[],this.autoFilter=g.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get name(){return this._name}set name(g){if(g===void 0&&(g="sheet"+this.id),this._name!==g){if(typeof g!="string")throw new Error("The name has to be a string.");if(g==="")throw new Error("The name can't be empty.");if(g==="History")throw new Error('The name "History" is protected. Please use a different name.');if(/[*?:/\\[\]]/.test(g))throw new Error(`Worksheet name ${g} cannot include any of the following characters: * ? : \\ / [ ]`);if(/(^')|('$)/.test(g))throw new Error("The first or last character of worksheet name cannot be a single quotation mark: "+g);if(g&&g.length>31&&(console.warn(`Worksheet name ${g} exceeds 31 chars. This will be truncated`),g=g.substring(0,31)),this._workbook._worksheets.find(x=>x&&x.name.toLowerCase()===g.toLowerCase()))throw new Error("Worksheet name already exists: "+g);this._name=g}}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){const g=new l;return this._rows.forEach(x=>{if(x){const y=x.dimensions;y&&g.expand(x.number,y.min,x.number,y.max)}}),g}get columns(){return this._columns}set columns(g){this._headerRowCount=g.reduce((E,N)=>{const I=(N.header?1:N.headers&&N.headers.length)||0;return Math.max(E,I)},0);let x=1;const y=this._columns=[];g.forEach(E=>{const N=new i(this,x++,!1);y.push(N),N.defn=E})}getColumnKey(g){return this._keys[g]}setColumnKey(g,x){this._keys[g]=x}deleteColumnKey(g){delete this._keys[g]}eachColumnKey(g){o.each(this._keys,g)}getColumn(g){if(typeof g=="string"){const x=this._keys[g];if(x)return x;g=s.l2n(g)}if(this._columns||(this._columns=[]),g>this._columns.length){let x=this._columns.length+1;for(;x<=g;)this._columns.push(new i(this,x++))}return this._columns[g-1]}spliceColumns(g,x){const y=this._rows.length;for(var E=arguments.length,N=new Array(E>2?E-2:0),I=2;I<E;I++)N[I-2]=arguments[I];if(N.length>0)for(let q=0;q<y;q++){const K=[g,x];N.forEach(W=>{K.push(W[q]||null)});const z=this.getRow(q+1);z.splice.apply(z,K)}else this._rows.forEach(q=>{q&&q.splice(g,x)});const L=N.length-x,H=g+x,V=this._columns.length;if(L<0)for(let q=g+N.length;q<=V;q++)this.getColumn(q).defn=this.getColumn(q-L).defn;else if(L>0)for(let q=V;q>=H;q--)this.getColumn(q+L).defn=this.getColumn(q).defn;for(let q=g;q<g+N.length;q++)this.getColumn(q).defn=null;this.workbook.definedNames.spliceColumns(this.name,g,x,N.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let g=0;return this.eachRow(x=>{g=Math.max(g,x.cellCount)}),g}get actualColumnCount(){const g=[];let x=0;return this.eachRow(y=>{y.eachCell(E=>{let{col:N}=E;g[N]||(g[N]=!0,x++)})}),x}_commitRow(){}get _lastRowNumber(){const g=this._rows;let x=g.length;for(;x>0&&g[x-1]===void 0;)x--;return x}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(g){return this._rows[g-1]}findRows(g,x){return this._rows.slice(g-1,g-1+x)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let g=0;return this.eachRow(()=>{g++}),g}getRow(g){let x=this._rows[g-1];return x||(x=this._rows[g-1]=new c(this,g)),x}getRows(g,x){if(x<1)return;const y=[];for(let E=g;E<g+x;E++)y.push(this.getRow(E));return y}addRow(g){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const y=this._nextRow,E=this.getRow(y);return E.values=g,this._setStyleOption(y,x[0]==="i"?x:"n"),E}addRows(g){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const y=[];return g.forEach(E=>{y.push(this.addRow(E,x))}),y}insertRow(g,x){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";return this.spliceRows(g,0,x),this._setStyleOption(g,y),this.getRow(g)}insertRows(g,x){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";if(this.spliceRows(g,0,...x),y!=="n")for(let E=0;E<x.length;E++)y[0]==="o"&&this.findRow(x.length+g+E)!==void 0?this._copyStyle(x.length+g+E,g+E,y[1]==="+"):y[0]==="i"&&this.findRow(g-1)!==void 0&&this._copyStyle(g-1,g+E,y[1]==="+");return this.getRows(g,x.length)}_setStyleOption(g){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";x[0]==="o"&&this.findRow(g+1)!==void 0?this._copyStyle(g+1,g,x[1]==="+"):x[0]==="i"&&this.findRow(g-1)!==void 0&&this._copyStyle(g-1,g,x[1]==="+")}_copyStyle(g,x){let y=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const E=this.getRow(g),N=this.getRow(x);N.style=b(E.style),E.eachCell({includeEmpty:y},(I,L)=>{N.getCell(L).style=b(I.style)}),N.height=E.height}duplicateRow(g,x){let y=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const E=this._rows[g-1],N=new Array(x).fill(E.values);this.spliceRows(g+1,y?0:x,...N);for(let I=0;I<x;I++){const L=this._rows[g+I];L.style=E.style,L.height=E.height,E.eachCell({includeEmpty:!0},(H,V)=>{L.getCell(V).style=H.style})}}spliceRows(g,x){const y=g+x;for(var E=arguments.length,N=new Array(E>2?E-2:0),I=2;I<E;I++)N[I-2]=arguments[I];const L=N.length,H=L-x,V=this._rows.length;let q,K;if(H<0)for(g===V&&(this._rows[V-1]=void 0),q=y;q<=V;q++)if(K=this._rows[q-1],K){const z=this.getRow(q+H);z.values=K.values,z.style=K.style,z.height=K.height,K.eachCell({includeEmpty:!0},(W,D)=>{z.getCell(D).style=W.style}),this._rows[q-1]=void 0}else this._rows[q+H-1]=void 0;else if(H>0)for(q=V;q>=y;q--)if(K=this._rows[q-1],K){const z=this.getRow(q+H);z.values=K.values,z.style=K.style,z.height=K.height,K.eachCell({includeEmpty:!0},(W,D)=>{if(z.getCell(D).style=W.style,W._value.constructor.name==="MergeValue"){const M=this.getRow(W._row._number+L).getCell(D),C=W._value._master,w=this.getRow(C._row._number+L).getCell(C._column._number);M.merge(w)}})}else this._rows[q+H-1]=void 0;for(q=0;q<L;q++){const z=this.getRow(g+q);z.style={},z.values=N[q]}this.workbook.definedNames.spliceRows(this.name,g,x,L)}eachRow(g,x){if(x||(x=g,g=void 0),g&&g.includeEmpty){const y=this._rows.length;for(let E=1;E<=y;E++)x(this.getRow(E),E)}else this._rows.forEach(y=>{y&&y.hasValues&&x(y,y.number)})}getSheetValues(){const g=[];return this._rows.forEach(x=>{x&&(g[x.number]=x.values)}),g}findCell(g,x){const y=s.getAddress(g,x),E=this._rows[y.row-1];return E?E.findCell(y.col):void 0}getCell(g,x){const y=s.getAddress(g,x);return this.getRow(y.row).getCellEx(y)}mergeCells(){for(var g=arguments.length,x=new Array(g),y=0;y<g;y++)x[y]=arguments[y];const E=new l(x);this._mergeCellsInternal(E)}mergeCellsWithoutStyle(){for(var g=arguments.length,x=new Array(g),y=0;y<g;y++)x[y]=arguments[y];const E=new l(x);this._mergeCellsInternal(E,!0)}_mergeCellsInternal(g,x){o.each(this._merges,E=>{if(E.intersects(g))throw new Error("Cannot merge already merged cells")});const y=this.getCell(g.top,g.left);for(let E=g.top;E<=g.bottom;E++)for(let N=g.left;N<=g.right;N++)(E>g.top||N>g.left)&&this.getCell(E,N).merge(y,x);this._merges[y.address]=g}_unMergeMaster(g){const x=this._merges[g.address];if(x){for(let y=x.top;y<=x.bottom;y++)for(let E=x.left;E<=x.right;E++)this.getCell(y,E).unmerge();delete this._merges[g.address]}}get hasMerges(){return o.some(this._merges,Boolean)}unMergeCells(){for(var g=arguments.length,x=new Array(g),y=0;y<g;y++)x[y]=arguments[y];const E=new l(x);for(let N=E.top;N<=E.bottom;N++)for(let I=E.left;I<=E.right;I++){const L=this.findCell(N,I);L&&(L.type===u.ValueType.Merge?this._unMergeMaster(L.master):this._merges[L.address]&&this._unMergeMaster(L))}}fillFormula(g,x,y){let E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"shared";const N=s.decode(g),{top:I,left:L,bottom:H,right:V}=N,q=V-L+1,K=s.encodeAddress(I,L),z=E==="shared";let W;W=typeof y=="function"?y:Array.isArray(y)?Array.isArray(y[0])?(M,C)=>y[M-I][C-L]:(M,C)=>y[(M-I)*q+(C-L)]:()=>{};let D=!0;for(let M=I;M<=H;M++)for(let C=L;C<=V;C++)D?(this.getCell(M,C).value={shareType:E,formula:x,ref:g,result:W(M,C)},D=!1):this.getCell(M,C).value=z?{sharedFormula:K,result:W(M,C)}:W(M,C)}addImage(g,x){const y={type:"image",imageId:g,range:x};this._media.push(new p(this,y))}getImages(){return this._media.filter(g=>g.type==="image")}addBackgroundImage(g){const x={type:"background",imageId:g};this._media.push(new p(this,x))}getBackgroundImageId(){const g=this._media.find(x=>x.type==="background");return g&&g.imageId}protect(g,x){return new Promise(y=>{this.sheetProtection={sheet:!0},x&&"spinCount"in x&&(x.spinCount=Number.isFinite(x.spinCount)?Math.round(Math.max(0,x.spinCount)):1e5),g&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=v.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=x&&"spinCount"in x?x.spinCount:1e5,this.sheetProtection.hashValue=v.convertPasswordToHash(g,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),x&&(this.sheetProtection=Object.assign(this.sheetProtection,x),!g&&"spinCount"in x&&delete this.sheetProtection.spinCount),y()})}unprotect(){this.sheetProtection=null}addTable(g){const x=new f(this,g);return this.tables[g.name]=x,x}getTable(g){return this.tables[g]}removeTable(g){delete this.tables[g]}getTables(){return Object.values(this.tables)}addConditionalFormatting(g){this.conditionalFormattings.push(g)}removeConditionalFormatting(g){typeof g=="number"?this.conditionalFormattings.splice(g,1):this.conditionalFormattings=g instanceof Function?this.conditionalFormattings.filter(g):[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(g){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=g}get model(){const g={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(E=>E.model),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(E=>E.model),conditionalFormattings:this.conditionalFormattings};g.cols=i.toModel(this.columns);const x=g.rows=[],y=g.dimensions=new l;return this._rows.forEach(E=>{const N=E&&E.model;N&&(y.expand(N.number,N.min,N.number,N.max),x.push(N))}),g.merges=[],o.each(this._merges,E=>{g.merges.push(E.range)}),g}_parseRows(g){this._rows=[],g.rows.forEach(x=>{const y=new c(this,x.number);this._rows[y.number-1]=y,y.model=x})}_parseMergeCells(g){o.each(g.mergeCells,x=>{this.mergeCellsWithoutStyle(x)})}set model(g){this.name=g.name,this._columns=i.fromModel(this,g.cols),this._parseRows(g),this._parseMergeCells(g),this.dataValidations=new h(g.dataValidations),this.properties=g.properties,this.pageSetup=g.pageSetup,this.headerFooter=g.headerFooter,this.views=g.views,this.autoFilter=g.autoFilter,this._media=g.media.map(x=>new p(this,x)),this.sheetProtection=g.sheetProtection,this.tables=g.tables.reduce((x,y)=>{const E=new f;return E.model=y,x[y.name]=E,x},{}),this.conditionalFormattings=g.conditionalFormattings}}},{"../utils/col-cache":19,"../utils/copy-style":20,"../utils/encryptor":21,"../utils/under-dash":26,"./column":4,"./data-validations":5,"./enums":7,"./image":8,"./range":10,"./row":11,"./table":12}],15:[function(e,n,a){e("core-js/modules/es.promise"),e("core-js/modules/es.promise.finally"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.values"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.async-iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.find-index"),e("core-js/modules/es.array.find"),e("core-js/modules/es.string.from-code-point"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.number.is-nan"),e("regenerator-runtime/runtime");const o={Workbook:e("./doc/workbook")},s=e("./doc/enums");Object.keys(s).forEach(l=>{o[l]=s[l]}),n.exports=o},{"./doc/enums":7,"./doc/workbook":13,"core-js/modules/es.array.find":359,"core-js/modules/es.array.find-index":358,"core-js/modules/es.array.includes":360,"core-js/modules/es.array.iterator":361,"core-js/modules/es.number.is-nan":363,"core-js/modules/es.object.assign":364,"core-js/modules/es.object.keys":366,"core-js/modules/es.object.values":367,"core-js/modules/es.promise":372,"core-js/modules/es.promise.finally":371,"core-js/modules/es.string.from-code-point":376,"core-js/modules/es.string.includes":377,"core-js/modules/es.symbol":381,"core-js/modules/es.symbol.async-iterator":378,"regenerator-runtime/runtime":492}],16:[function(e,n,a){const o=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");a.bufferToString=function(s){return typeof s=="string"?s:o?o.decode(s):s.toString()}},{}],17:[function(e,n,a){const o=typeof TextEncoder>"u"?null:new TextEncoder("utf-8"),{Buffer:s}=e("buffer");a.stringToBuffer=function(l){return typeof l!="string"?l:o?s.from(o.encode(l).buffer):s.from(l)}},{buffer:220}],18:[function(e,n,a){const o=e("./under-dash"),s=e("./col-cache");n.exports=class{constructor(l){this.template=l,this.sheets={}}addCell(l){this.addCellEx(s.decodeEx(l))}getCell(l){return this.findCellEx(s.decodeEx(l),!0)}findCell(l){return this.findCellEx(s.decodeEx(l),!1)}findCellAt(l,c,i){const u=this.sheets[l],p=u&&u[c];return p&&p[i]}addCellEx(l){if(l.top)for(let c=l.top;c<=l.bottom;c++)for(let i=l.left;i<=l.right;i++)this.getCellAt(l.sheetName,c,i);else this.findCellEx(l,!0)}getCellEx(l){return this.findCellEx(l,!0)}findCellEx(l,c){const i=this.findSheet(l,c),u=this.findSheetRow(i,l,c);return this.findRowCell(u,l,c)}getCellAt(l,c,i){const u=this.sheets[l]||(this.sheets[l]=[]),p=u[c]||(u[c]=[]);return p[i]||(p[i]={sheetName:l,address:s.n2l(i)+c,row:c,col:i})}removeCellEx(l){const c=this.findSheet(l);if(!c)return;const i=this.findSheetRow(c,l);i&&delete i[l.col]}forEachInSheet(l,c){const i=this.sheets[l];i&&i.forEach((u,p)=>{u&&u.forEach((f,h)=>{f&&c(f,p,h)})})}forEach(l){o.each(this.sheets,(c,i)=>{this.forEachInSheet(i,l)})}map(l){const c=[];return this.forEach(i=>{c.push(l(i))}),c}findSheet(l,c){const i=l.sheetName;return this.sheets[i]?this.sheets[i]:c?this.sheets[i]=[]:void 0}findSheetRow(l,c,i){const{row:u}=c;return l&&l[u]?l[u]:i?l[u]=[]:void 0}findRowCell(l,c,i){const{col:u}=c;return l&&l[u]?l[u]:i?l[u]=this.template?Object.assign(c,JSON.parse(JSON.stringify(this.template))):c:void 0}spliceRows(l,c,i,u){const p=this.sheets[l];if(p){const f=[];for(let h=0;h<u;h++)f.push([]);p.splice(c,i,...f)}}spliceColumns(l,c,i,u){const p=this.sheets[l];if(p){const f=[];for(let h=0;h<u;h++)f.push(null);o.each(p,h=>{h.splice(c,i,...f)})}}}},{"./col-cache":19,"./under-dash":26}],19:[function(e,n,a){const o=/^[A-Z]+\d+$/,s={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:l=>l<=26?1:l<=676?2:3,_fill(l){let c,i,u,p,f,h=1;if(l>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&l>=1){for(;h<=26;)c=this._dictionary[h-1],this._n2l[h]=c,this._l2n[c]=h,h++;this._l2nFill=1}if(this._l2nFill<2&&l>=2){for(h=27;h<=702;)i=h-27,u=i%26,p=Math.floor(i/26),c=this._dictionary[p]+this._dictionary[u],this._n2l[h]=c,this._l2n[c]=h,h++;this._l2nFill=2}if(this._l2nFill<3&&l>=3){for(h=703;h<=16384;)i=h-703,u=i%26,p=Math.floor(i/26)%26,f=Math.floor(i/676),c=this._dictionary[f]+this._dictionary[p]+this._dictionary[u],this._n2l[h]=c,this._l2n[c]=h,h++;this._l2nFill=3}},l2n(l){if(this._l2n[l]||this._fill(l.length),!this._l2n[l])throw new Error("Out of bounds. Invalid column letter: "+l);return this._l2n[l]},n2l(l){if(l<1||l>16384)throw new Error(l+" is out of bounds. Excel supports columns from 1 to 16384");return this._n2l[l]||this._fill(this._level(l)),this._n2l[l]},_hash:{},validateAddress(l){if(!o.test(l))throw new Error("Invalid Address: "+l);return!0},decodeAddress(l){const c=l.length<5&&this._hash[l];if(c)return c;let i=!1,u="",p=0,f=!1,h="",v=0;for(let g,x=0;x<l.length;x++)if(g=l.charCodeAt(x),!f&&g>=65&&g<=90)i=!0,u+=l[x],p=26*p+g-64;else if(g>=48&&g<=57)f=!0,h+=l[x],v=10*v+g-48;else if(f&&i&&g!==36)break;if(i){if(p>16384)throw new Error("Out of bounds. Invalid column letter: "+u)}else p=void 0;f||(v=void 0);const b={address:l=u+h,col:p,row:v,$col$row:`$${u}$${h}`};return p<=100&&v<=100&&(this._hash[l]=b,this._hash[b.$col$row]=b),b},getAddress(l,c){if(c){const i=this.n2l(c)+l;return this.decodeAddress(i)}return this.decodeAddress(l)},decode(l){const c=l.split(":");if(c.length===2){const i=this.decodeAddress(c[0]),u=this.decodeAddress(c[1]),p={top:Math.min(i.row,u.row),left:Math.min(i.col,u.col),bottom:Math.max(i.row,u.row),right:Math.max(i.col,u.col)};return p.tl=this.n2l(p.left)+p.top,p.br=this.n2l(p.right)+p.bottom,p.dimensions=`${p.tl}:${p.br}`,p}return this.decodeAddress(l)},decodeEx(l){const c=l.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),i=c[1]||c[2],u=c[3],p=u.split(":");if(p.length>1){let h=this.decodeAddress(p[0]),v=this.decodeAddress(p[1]);const b=Math.min(h.row,v.row),g=Math.min(h.col,v.col),x=Math.max(h.row,v.row),y=Math.max(h.col,v.col);return h=this.n2l(g)+b,v=this.n2l(y)+x,{top:b,left:g,bottom:x,right:y,sheetName:i,tl:{address:h,col:g,row:b,$col$row:`$${this.n2l(g)}$${b}`,sheetName:i},br:{address:v,col:y,row:x,$col$row:`$${this.n2l(y)}$${x}`,sheetName:i},dimensions:`${h}:${v}`}}if(u.startsWith("#"))return i?{sheetName:i,error:u}:{error:u};const f=this.decodeAddress(u);return i?{sheetName:i,...f}:f},encodeAddress:(l,c)=>s.n2l(c)+l,encode(){switch(arguments.length){case 2:return s.encodeAddress(arguments[0],arguments[1]);case 4:return`${s.encodeAddress(arguments[0],arguments[1])}:${s.encodeAddress(arguments[2],arguments[3])}`;default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange(l,c){const[i,u,,p,f]=l,[h,v]=c;return h>=i&&h<=p&&v>=u&&v<=f}};n.exports=s},{}],20:[function(e,n,a){const o=(l,c)=>({...l,...c.reduce((i,u)=>(l[u]&&(i[u]={...l[u]}),i),{})}),s=function(l,c,i){let u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];l[i]&&(c[i]=o(l[i],u))};a.copyStyle=l=>{if(!l)return l;if(c=l,Object.keys(c).length===0)return{};var c;const i={...l};return s(l,i,"font",["color"]),s(l,i,"alignment"),s(l,i,"protection"),l.border&&(s(l,i,"border"),s(l.border,i.border,"top",["color"]),s(l.border,i.border,"left",["color"]),s(l.border,i.border,"bottom",["color"]),s(l.border,i.border,"right",["color"]),s(l.border,i.border,"diagonal",["color"])),l.fill&&(s(l,i,"fill",["fgColor","bgColor","center"]),l.fill.stops&&(i.fill.stops=l.fill.stops.map(u=>o(u,["color"])))),i}},{}],21:[function(e,n,a){(function(o){(function(){const s=e("crypto"),l={hash(c){const i=s.createHash(c);for(var u=arguments.length,p=new Array(u>1?u-1:0),f=1;f<u;f++)p[f-1]=arguments[f];return i.update(o.concat(p)),i.digest()},convertPasswordToHash(c,i,u,p){if(i=i.toLowerCase(),s.getHashes().indexOf(i)<0)throw new Error(`Hash algorithm '${i}' not supported!`);const f=o.from(c,"utf16le");let h=this.hash(i,o.from(u,"base64"),f);for(let v=0;v<p;v++){const b=o.alloc(4);b.writeUInt32LE(v,0),h=this.hash(i,h,b)}return h.toString("base64")},randomBytes:c=>s.randomBytes(c)};n.exports=l}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220,crypto:390}],22:[function(e,n,a){const{SaxesParser:o}=e("saxes"),{PassThrough:s}=e("readable-stream"),{bufferToString:l}=e("./browser-buffer-decode");n.exports=async function*(c){c.pipe&&!c[Symbol.asyncIterator]&&(c=c.pipe(new s));const i=new o;let u;i.on("error",f=>{u=f});let p=[];i.on("opentag",f=>p.push({eventType:"opentag",value:f})),i.on("text",f=>p.push({eventType:"text",value:f})),i.on("closetag",f=>p.push({eventType:"closetag",value:f}));for await(const f of c){if(i.write(l(f)),u)throw u;yield p,p=[]}}},{"./browser-buffer-decode":16,"readable-stream":491,saxes:496}],23:[function(e,n,a){const o=e("./col-cache"),s=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,l=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;n.exports={slideFormula:function(c,i,u){const p=o.decode(i),f=o.decode(u);return c.replace(s,(h,v,b,g,x)=>{if(x)return h;const y=l.exec(g);if(y){const E=y[1],N=y[2].toUpperCase(),I=y[3],L=y[4];if(N.length>3||N.length===3&&N>"XFD")return h;let H=o.l2n(N),V=parseInt(L,10);return E||(H+=f.col-p.col),I||(V+=f.row-p.row),(v||"")+(E||"")+o.n2l(H)+(I||"")+V}return h})}}},{"./col-cache":19}],24:[function(e,n,a){(function(o,s){(function(){const l=e("readable-stream"),c=e("./utils"),i=e("./string-buf");class u{constructor(g,x){this._data=g,this._encoding=x}get length(){return this.toBuffer().length}copy(g,x,y,E){return this.toBuffer().copy(g,x,y,E)}toBuffer(){return this._buffer||(this._buffer=s.from(this._data,this._encoding)),this._buffer}}class p{constructor(g){this._data=g}get length(){return this._data.length}copy(g,x,y,E){return this._data._buf.copy(g,x,y,E)}toBuffer(){return this._data.toBuffer()}}class f{constructor(g){this._data=g}get length(){return this._data.length}copy(g,x,y,E){this._data.copy(g,x,y,E)}toBuffer(){return this._data}}class h{constructor(g){this.size=g,this.buffer=s.alloc(g),this.iRead=0,this.iWrite=0}toBuffer(){if(this.iRead===0&&this.iWrite===this.size)return this.buffer;const g=s.alloc(this.iWrite-this.iRead);return this.buffer.copy(g,0,this.iRead,this.iWrite),g}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(g){let x;return g===0?null:g===void 0||g>=this.length?(x=this.toBuffer(),this.iRead=this.iWrite,x):(x=s.alloc(g),this.buffer.copy(x,0,this.iRead,g),this.iRead+=g,x)}write(g,x,y){const E=Math.min(y,this.size-this.iWrite);return g.copy(this.buffer,this.iWrite,x,x+E),this.iWrite+=E,E}}const v=function(b){b=b||{},this.bufSize=b.bufSize||1048576,this.buffers=[],this.batch=b.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};c.inherits(v,l.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return s.concat(this.buffers.map(b=>b.toBuffer()))}},_getWritableBuffer(){if(this.buffers.length){const g=this.buffers[this.buffers.length-1];if(!g.full)return g}const b=new h(this.bufSize);return this.buffers.push(b),b},async _pipe(b){await Promise.all(this.pipes.map(function(g){return new Promise(x=>{g.write(b.toBuffer(),()=>{x()})})}))},_writeToBuffers(b){let g=0;const x=b.length;for(;g<x;)g+=this._getWritableBuffer().write(b,g,x-g)},async write(b,g,x){let y;if(g instanceof Function&&(x=g,g="utf8"),x=x||c.nop,b instanceof i)y=new p(b);else if(b instanceof s)y=new f(b);else{if(!(typeof b=="string"||b instanceof String||b instanceof ArrayBuffer))throw new Error("Chunk must be one of type String, Buffer or StringBuf.");y=new u(b,g)}if(this.pipes.length)if(this.batch)for(this._writeToBuffers(y);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(y),o.nextTick(x)):(await this._pipe(y),x());else this.paused||this.emit("data",y.toBuffer()),this._writeToBuffers(y),this.emit("readable");return!0},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(b,g,x){const y=E=>{E?x(E):(this._flush(),this.pipes.forEach(N=>{N.end()}),this.emit("finish"))};b?this.write(b,g,y):y()},read(b){let g;if(b){for(g=[];b&&this.buffers.length&&!this.buffers[0].eod;){const x=this.buffers[0],y=x.read(b);b-=y.length,g.push(y),x.eod&&x.full&&this.buffers.shift()}return s.concat(g)}return g=this.buffers.map(x=>x.toBuffer()).filter(Boolean),this.buffers=[],s.concat(g)},setEncoding(b){this.encoding=b},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(b){this.pipes.push(b),!this.paused&&this.buffers.length&&this.end()},unpipe(b){this.pipes=this.pipes.filter(g=>g!==b)},unshift(){throw new Error("Not Implemented")},wrap(){throw new Error("Not Implemented")}}),n.exports=v}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"./string-buf":25,"./utils":27,_process:467,buffer:220,"readable-stream":491}],25:[function(e,n,a){(function(o){(function(){n.exports=class{constructor(s){this._buf=o.alloc(s&&s.size||16384),this._encoding=s&&s.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=o.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(s){s=s||0,this._buffer=void 0,this._inPos=s}_grow(s){let l=2*this._buf.length;for(;l<s;)l*=2;const c=o.alloc(l);this._buf.copy(c,0),this._buf=c}addText(s){this._buffer=void 0;let l=this._inPos+this._buf.write(s,this._inPos,this._encoding);for(;l>=this._buf.length-4;)this._grow(this._inPos+s.length),l=this._inPos+this._buf.write(s,this._inPos,this._encoding);this._inPos=l}addStringBuf(s){s.length&&(this._buffer=void 0,this.length+s.length>this.capacity&&this._grow(this.length+s.length),s._buf.copy(this._buf,this._inPos,0,s.length),this._inPos+=s.length)}}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220}],26:[function(e,n,a){const{toString:o}=Object.prototype,s=/["&<>]/,l={each:function(c,i){c&&(Array.isArray(c)?c.forEach(i):Object.keys(c).forEach(u=>{i(c[u],u)}))},some:function(c,i){return!!c&&(Array.isArray(c)?c.some(i):Object.keys(c).some(u=>i(c[u],u)))},every:function(c,i){return!c||(Array.isArray(c)?c.every(i):Object.keys(c).every(u=>i(c[u],u)))},map:function(c,i){return c?Array.isArray(c)?c.map(i):Object.keys(c).map(u=>i(c[u],u)):[]},keyBy:(c,i)=>c.reduce((u,p)=>(u[p[i]]=p,u),{}),isEqual:function(c,i){const u=typeof c,p=typeof i,f=Array.isArray(c),h=Array.isArray(i);let v;if(u!==p)return!1;switch(typeof c){case"object":if(f||h)return!(!f||!h)&&c.length===i.length&&c.every((b,g)=>{const x=i[g];return l.isEqual(b,x)});if(c===null||i===null)return c===i;if(v=Object.keys(c),Object.keys(i).length!==v.length)return!1;for(const b of v)if(!i.hasOwnProperty(b))return!1;return l.every(c,(b,g)=>{const x=i[g];return l.isEqual(b,x)});default:return c===i}},escapeHtml(c){const i=s.exec(c);if(!i)return c;let u="",p="",f=0,h=i.index;for(;h<c.length;h++){switch(c.charAt(h)){case'"':p="&quot;";break;case"&":p="&amp;";break;case"'":p="&apos;";break;case"<":p="&lt;";break;case">":p="&gt;";break;default:continue}f!==h&&(u+=c.substring(f,h)),f=h+1,u+=p}return f!==h?u+c.substring(f,h):u},strcmp:(c,i)=>c<i?-1:c>i?1:0,isUndefined:c=>o.call(c)==="[object Undefined]",isObject:c=>o.call(c)==="[object Object]",deepMerge(){const c=arguments[0]||{},{length:i}=arguments;let u,p,f;function h(v,b){u=c[b],f=Array.isArray(v),l.isObject(v)||f?(f?(f=!1,p=u&&Array.isArray(u)?u:[]):p=u&&l.isObject(u)?u:{},c[b]=l.deepMerge(p,v)):l.isUndefined(v)||(c[b]=v)}for(let v=0;v<i;v++)l.each(arguments[v],h);return c}};n.exports=l},{}],27:[function(e,n,a){(function(o,s){(function(){const l=e("fs"),c=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,i={nop(){},promiseImmediate:u=>new Promise(p=>{o.setImmediate?s(()=>{p(u)}):setTimeout(()=>{p(u)},1)}),inherits:function(u,p,f,h){u.super_=p,h||(h=f,f=null),f&&Object.keys(f).forEach(b=>{Object.defineProperty(u,b,Object.getOwnPropertyDescriptor(f,b))});const v={constructor:{value:u,enumerable:!1,writable:!1,configurable:!0}};h&&Object.keys(h).forEach(b=>{v[b]=Object.getOwnPropertyDescriptor(h,b)}),u.prototype=Object.create(p.prototype,v)},dateToExcel:(u,p)=>25569+u.getTime()/864e5-(p?1462:0),excelToDate(u,p){const f=Math.round(24*(u-25569+(p?1462:0))*3600*1e3);return new Date(f)},parsePath(u){const p=u.lastIndexOf("/");return{path:u.substring(0,p),name:u.substring(p+1)}},getRelsPath(u){const p=i.parsePath(u);return`${p.path}/_rels/${p.name}.rels`},xmlEncode(u){const p=c.exec(u);if(!p)return u;let f="",h="",v=0,b=p.index;for(;b<u.length;b++){const g=u.charCodeAt(b);switch(g){case 34:h="&quot;";break;case 38:h="&amp;";break;case 39:h="&apos;";break;case 60:h="&lt;";break;case 62:h="&gt;";break;case 127:h="";break;default:if(g<=31&&(g<=8||g>=11&&g!==13)){h="";break}continue}v!==b&&(f+=u.substring(v,b)),v=b+1,h&&(f+=h)}return v!==b?f+u.substring(v,b):f},xmlDecode:u=>u.replace(/&([a-z]*);/g,p=>{switch(p){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return p}}),validInt(u){const p=parseInt(u,10);return Number.isNaN(p)?0:p},isDateFmt(u){return u?(u=(u=u.replace(/\[[^\]]*]/g,"")).replace(/"[^"]*"/g,"")).match(/[ymdhMsb]+/)!==null:!1},fs:{exists:u=>new Promise(p=>{l.access(u,l.constants.F_OK,f=>{p(!f)})})},toIsoDateString:u=>u.toIsoString().subsstr(0,10),parseBoolean:u=>u===!0||u==="true"||u===1||u==="1"};n.exports=i}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{},e("timers").setImmediate)},{fs:216,timers:523}],28:[function(e,n,a){const o=e("./under-dash"),s=e("./utils");function l(u,p,f){u.push(` ${p}="${s.xmlEncode(f.toString())}"`)}function c(u,p){if(p){const f=[];o.each(p,(h,v)=>{h!==void 0&&l(f,v,h)}),u.push(f.join(""))}}class i{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(p){const f=this._xml;f.push("<?xml"),c(f,p),f.push(`?>
`)}openNode(p,f){const h=this.tos,v=this._xml;h&&this.open&&v.push(">"),this._stack.push(p),v.push("<"),v.push(p),c(v,f),this.leaf=!0,this.open=!0}addAttribute(p,f){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");f!==void 0&&l(this._xml,p,f)}addAttributes(p){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");c(this._xml,p)}writeText(p){const f=this._xml;this.open&&(f.push(">"),this.open=!1),this.leaf=!1,f.push(s.xmlEncode(p.toString()))}writeXml(p){this.open&&(this._xml.push(">"),this.open=!1),this.leaf=!1,this._xml.push(p)}closeNode(){const p=this._stack.pop(),f=this._xml;this.leaf?f.push("/>"):(f.push("</"),f.push(p),f.push(">")),this.open=!1,this.leaf=!1}leafNode(p,f,h){this.openNode(p,f),h!==void 0&&this.writeText(h),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){const p=this._rollbacks.pop();this._xml.length>p.xml&&this._xml.splice(p.xml,this._xml.length-p.xml),this._stack.length>p.stack&&this._stack.splice(p.stack,this._stack.length-p.stack),this.leaf=p.leaf,this.open=p.open}get xml(){return this.closeAll(),this._xml.join("")}}i.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},n.exports=i},{"./under-dash":26,"./utils":27}],29:[function(e,n,a){(function(o){(function(){const s=e("events"),l=e("jszip"),c=e("./stream-buf"),{stringToBuffer:i}=e("./browser-buffer-encode");class u extends s.EventEmitter{constructor(f){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},f),this.zip=new l,this.stream=new c}append(f,h){h.hasOwnProperty("base64")&&h.base64?this.zip.file(h.name,f,{base64:!0}):(o.browser&&typeof f=="string"&&(f=i(f)),this.zip.file(h.name,f))}async finalize(){const f=await this.zip.generateAsync(this.options);this.stream.end(f),this.emit("finish")}read(f){return this.stream.read(f)}setEncoding(f){return this.stream.setEncoding(f)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(f,h){return this.stream.pipe(f,h)}unpipe(f){return this.stream.unpipe(f)}unshift(f){return this.stream.unshift(f)}wrap(f){return this.stream.wrap(f)}}n.exports={ZipWriter:u}}).call(this)}).call(this,e("_process"))},{"./browser-buffer-encode":17,"./stream-buf":24,_process:467,events:422,jszip:441}],30:[function(e,n,a){n.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},28:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy""m""d""',"zh-cn":'yyyy""m""d""',"ja-jp":'yyyy""m""d""',"ko-kr":'yyyy"" mm"" dd""'},32:{"zh-tw":'hh""mm""',"zh-cn":'h""mm""',"ja-jp":'h""mm""',"ko-kr":'h"" mm""'},33:{"zh-tw":'hh""mm""ss""',"zh-cn":'h""mm""ss""',"ja-jp":'h""mm""ss""',"ko-kr":'h"" mm"" ss""'},34:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},51:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},52:{"zh-tw":'/ hh""mm""',"zh-cn":'yyyy""m""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'m""d""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},55:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},58:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}},{}],31:[function(e,n,a){n.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}},{}],32:[function(e,n,a){const o=e("../../utils/parse-sax"),s=e("../../utils/xml-stream");class l{prepare(){}render(){}parseOpen(i){}parseText(i){}parseClose(i){}reconcile(i,u){}reset(){this.model=null,this.map&&Object.values(this.map).forEach(i=>{i instanceof l?i.reset():i.xform&&i.xform.reset()})}mergeModel(i){this.model=Object.assign(this.model||{},i)}async parse(i){for await(const u of i)for(const{eventType:p,value:f}of u)if(p==="opentag")this.parseOpen(f);else if(p==="text")this.parseText(f);else if(p==="closetag"&&!this.parseClose(f.name))return this.model;return this.model}async parseStream(i){return this.parse(o(i))}get xml(){return this.toXml(this.model)}toXml(i){const u=new s;return this.render(u,i),u.xml}static toAttribute(i,u){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(i===void 0){if(p)return u}else if(p||i!==u)return i.toString()}static toStringAttribute(i,u){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return l.toAttribute(i,u,p)}static toStringValue(i,u){return i===void 0?u:i}static toBoolAttribute(i,u){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(i===void 0){if(p)return u}else if(p||i!==u)return i?"1":"0"}static toBoolValue(i,u){return i===void 0?u:i==="1"}static toIntAttribute(i,u){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return l.toAttribute(i,u,p)}static toIntValue(i,u){return i===void 0?u:parseInt(i,10)}static toFloatAttribute(i,u){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return l.toAttribute(i,u,p)}static toFloatValue(i,u){return i===void 0?u:parseFloat(i)}}n.exports=l},{"../../utils/parse-sax":22,"../../utils/xml-stream":28}],33:[function(e,n,a){const o=e("../base-xform"),s=e("../../../utils/col-cache");function l(i){try{return s.decodeEx(i),!0}catch{return!1}}function c(i){const u=[];let p=!1,f="";return i.split(",").forEach(h=>{if(!h)return;const v=(h.match(/'/g)||[]).length;if(!v)return void(p?f+=h+",":l(h)&&u.push(h));const b=v%2==0;!p&&b&&l(h)?u.push(h):p&&!b?(p=!1,l(f+h)&&u.push(f+h),f=""):(p=!0,f+=h+",")}),u}n.exports=class extends o{render(i,u){i.openNode("definedName",{name:u.name,localSheetId:u.localSheetId}),i.writeText(u.ranges.join(",")),i.closeNode()}parseOpen(i){switch(i.name){case"definedName":return this._parsedName=i.attributes.name,this._parsedLocalSheetId=i.attributes.localSheetId,this._parsedText=[],!0;default:return!1}}parseText(i){this._parsedText.push(i)}parseClose(){return this.model={name:this._parsedName,ranges:c(this._parsedText.join(""))},this._parsedLocalSheetId!==void 0&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}}},{"../../../utils/col-cache":19,"../base-xform":32}],34:[function(e,n,a){const o=e("../../../utils/utils"),s=e("../base-xform");n.exports=class extends s{render(l,c){l.leafNode("sheet",{sheetId:c.id,name:c.name,state:c.state,"r:id":c.rId})}parseOpen(l){return l.name==="sheet"&&(this.model={name:o.xmlDecode(l.attributes.name),id:parseInt(l.attributes.sheetId,10),state:l.attributes.state,rId:l.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/utils":27,"../base-xform":32}],35:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{render(s,l){s.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:l.fullCalcOnLoad?1:void 0})}parseOpen(s){return s.name==="calcPr"&&(this.model={},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],36:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{render(s,l){s.leafNode("workbookPr",{date1904:l.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(s){return s.name==="workbookPr"&&(this.model={date1904:s.attributes.date1904==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],37:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{render(s,l){const c={xWindow:l.x||0,yWindow:l.y||0,windowWidth:l.width||12e3,windowHeight:l.height||24e3,firstSheet:l.firstSheet,activeTab:l.activeTab};l.visibility&&l.visibility!=="visible"&&(c.visibility=l.visibility),s.leafNode("workbookView",c)}parseOpen(s){if(s.name==="workbookView"){const l=this.model={},c=function(u,p,f){const h=p!==void 0?l[u]=p:f;h!==void 0&&(l[u]=h)},i=function(u,p,f){const h=p!==void 0?l[u]=parseInt(p,10):f;h!==void 0&&(l[u]=h)};return i("x",s.attributes.xWindow,0),i("y",s.attributes.yWindow,0),i("width",s.attributes.windowWidth,25e3),i("height",s.attributes.windowHeight,1e4),c("visibility",s.attributes.visibility,"visible"),i("activeTab",s.attributes.activeTab,void 0),i("firstSheet",s.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],38:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../../../utils/col-cache"),l=e("../../../utils/xml-stream"),c=e("../base-xform"),i=e("../static-xform"),u=e("../list-xform"),p=e("./defined-name-xform"),f=e("./sheet-xform"),h=e("./workbook-view-xform"),v=e("./workbook-properties-xform"),b=e("./workbook-calc-properties-xform");class g extends c{constructor(){super(),this.map={fileVersion:g.STATIC_XFORMS.fileVersion,workbookPr:new v,bookViews:new u({tag:"bookViews",count:!1,childXform:new h}),sheets:new u({tag:"sheets",count:!1,childXform:new f}),definedNames:new u({tag:"definedNames",count:!1,childXform:new p}),calcPr:new b}}prepare(y){y.sheets=y.worksheets;const E=[];let N=0;y.sheets.forEach(I=>{if(I.pageSetup&&I.pageSetup.printArea&&I.pageSetup.printArea.split("&&").forEach(L=>{const H=L.split(":"),V={name:"_xlnm.Print_Area",ranges:[`'${I.name}'!$${H[0]}:$${H[1]}`],localSheetId:N};E.push(V)}),I.pageSetup&&(I.pageSetup.printTitlesRow||I.pageSetup.printTitlesColumn)){const L=[];if(I.pageSetup.printTitlesColumn){const V=I.pageSetup.printTitlesColumn.split(":");L.push(`'${I.name}'!$${V[0]}:$${V[1]}`)}if(I.pageSetup.printTitlesRow){const V=I.pageSetup.printTitlesRow.split(":");L.push(`'${I.name}'!$${V[0]}:$${V[1]}`)}const H={name:"_xlnm.Print_Titles",ranges:L,localSheetId:N};E.push(H)}N++}),E.length&&(y.definedNames=y.definedNames.concat(E)),(y.media||[]).forEach((I,L)=>{I.name=I.type+(L+1)})}render(y,E){y.openXml(l.StdDocAttributes),y.openNode("workbook",g.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(y),this.map.workbookPr.render(y,E.properties),this.map.bookViews.render(y,E.views),this.map.sheets.render(y,E.sheets),this.map.definedNames.render(y,E.definedNames),this.map.calcPr.render(y,E.calcProperties),y.closeNode()}parseOpen(y){if(this.parser)return this.parser.parseOpen(y),!0;switch(y.name){case"workbook":return!0;default:return this.parser=this.map[y.name],this.parser&&this.parser.parseOpen(y),!0}}parseText(y){this.parser&&this.parser.parseText(y)}parseClose(y){if(this.parser)return this.parser.parseClose(y)||(this.parser=void 0),!0;switch(y){case"workbook":return this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1;default:return!0}}reconcile(y){const E=(y.workbookRels||[]).reduce((V,q)=>(V[q.Id]=q,V),{}),N=[];let I,L=0;(y.sheets||[]).forEach(V=>{const q=E[V.rId];q&&(I=y.worksheetHash["xl/"+q.Target.replace(/^(\s|\/xl\/)+/,"")],I&&(I.name=V.name,I.id=V.id,I.state=V.state,N[L++]=I))});const H=[];o.each(y.definedNames,V=>{if(V.name==="_xlnm.Print_Area"){if(I=N[V.localSheetId],I){I.pageSetup||(I.pageSetup={});const q=s.decodeEx(V.ranges[0]);I.pageSetup.printArea=I.pageSetup.printArea?`${I.pageSetup.printArea}&&${q.dimensions}`:q.dimensions}}else if(V.name==="_xlnm.Print_Titles"){if(I=N[V.localSheetId],I){I.pageSetup||(I.pageSetup={});const q=V.ranges.join(","),K=/\$/g,z=/\$\d+:\$\d+/,W=q.match(z);if(W&&W.length){const C=W[0];I.pageSetup.printTitlesRow=C.replace(K,"")}const D=/\$[A-Z]+:\$[A-Z]+/,M=q.match(D);if(M&&M.length){const C=M[0];I.pageSetup.printTitlesColumn=C.replace(K,"")}}}else H.push(V)}),y.definedNames=H,y.media.forEach((V,q)=>{V.index=q})}}g.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},g.STATIC_XFORMS={fileVersion:new i({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})},n.exports=g},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./defined-name-xform":33,"./sheet-xform":34,"./workbook-calc-properties-xform":35,"./workbook-properties-xform":36,"./workbook-view-xform":37}],39:[function(e,n,a){const o=e("../strings/rich-text-xform"),s=e("../../../utils/utils"),l=e("../base-xform"),c=n.exports=function(i){this.model=i};s.inherits(c,l,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new o),this._richTextXform},render(i,u){u=u||this.model,i.openNode("comment",{ref:u.ref,authorId:0}),i.openNode("text"),u&&u.note&&u.note.texts&&u.note.texts.forEach(p=>{this.richTextXform.render(i,p)}),i.closeNode(),i.closeNode()},parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case"comment":return this.model={type:"note",note:{texts:[]},...i.attributes},!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(i),!0;default:return!1}},parseText(i){this.parser&&this.parser.parseText(i)},parseClose(i){switch(i){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(i),!0}}})},{"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],40:[function(e,n,a){const o=e("../../../utils/xml-stream"),s=e("../../../utils/utils"),l=e("../base-xform"),c=e("./comment-xform"),i=n.exports=function(){this.map={comment:new c}};s.inherits(i,l,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(u,p){p=p||this.model,u.openXml(o.StdDocAttributes),u.openNode("comments",i.COMMENTS_ATTRIBUTES),u.openNode("authors"),u.leafNode("author",null,"Author"),u.closeNode(),u.openNode("commentList"),p.comments.forEach(f=>{this.map.comment.render(u,f)}),u.closeNode(),u.closeNode()},parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(u),!0;default:return!1}},parseText(u){this.parser&&this.parser.parseText(u)},parseClose(u){switch(u){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(u),!0}}})},{"../../../utils/utils":27,"../../../utils/xml-stream":28,"../base-xform":32,"./comment-xform":39}],41:[function(e,n,a){const o=e("../../base-xform");n.exports=class extends o{constructor(s){super(),this._model=s}get tag(){return this._model&&this._model.tag}render(s,l,c){(l===c[2]||this.tag==="x:SizeWithCells"&&l===c[1])&&s.leafNode(this.tag)}parseOpen(s){switch(s.name){case this.tag:return this.model={},this.model[this.tag]=!0,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../base-xform":32}],42:[function(e,n,a){const o=e("../../base-xform");n.exports=class extends o{constructor(s){super(),this._model=s}get tag(){return this._model&&this._model.tag}render(s,l){s.leafNode(this.tag,null,l)}parseOpen(s){switch(s.name){case this.tag:return this.text="",!0;default:return!1}}parseText(s){this.text=s}parseClose(){return!1}}},{"../../base-xform":32}],43:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"x:Anchor"}getAnchorRect(s){const l=Math.floor(s.left),c=Math.floor(68*(s.left-l)),i=Math.floor(s.top),u=Math.floor(18*(s.top-i)),p=Math.floor(s.right),f=Math.floor(68*(s.right-p)),h=Math.floor(s.bottom);return[l,c,i,u,p,f,h,Math.floor(18*(s.bottom-h))]}getDefaultRect(s){const l=s.col,c=Math.max(s.row-2,0);return[l,6,c,14,l+2,2,c+4,16]}render(s,l){const c=l.anchor?this.getAnchorRect(l.anchor):this.getDefaultRect(l.refAddress);s.leafNode("x:Anchor",null,c.join(", "))}parseOpen(s){switch(s.name){case this.tag:return this.text="",!0;default:return!1}}parseText(s){this.text=s}parseClose(){return!1}}},{"../base-xform":32}],44:[function(e,n,a){const o=e("../base-xform"),s=e("./vml-anchor-xform"),l=e("./style/vml-protection-xform"),c=e("./style/vml-position-xform"),i=["twoCells","oneCells","absolute"];n.exports=class extends o{constructor(){super(),this.map={"x:Anchor":new s,"x:Locked":new l({tag:"x:Locked"}),"x:LockText":new l({tag:"x:LockText"}),"x:SizeWithCells":new c({tag:"x:SizeWithCells"}),"x:MoveWithCells":new c({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(u,p){const{protection:f,editAs:h}=p.note;u.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(u,h,i),this.map["x:SizeWithCells"].render(u,h,i),this.map["x:Anchor"].render(u,p),this.map["x:Locked"].render(u,f.locked),u.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(u,f.lockText),u.leafNode("x:Row",null,p.refAddress.row-1),u.leafNode("x:Column",null,p.refAddress.col-1),u.closeNode()}parseOpen(u){switch(u.name){case this.tag:this.reset(),this.model={anchor:[],protection:{},editAs:""};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.normalizeModel(),!1;default:return!0}}normalizeModel(){const u=Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model),p=Object.keys(u).length;this.model.editAs=i[p],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}}},{"../base-xform":32,"./style/vml-position-xform":41,"./style/vml-protection-xform":42,"./vml-anchor-xform":43}],45:[function(e,n,a){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("./vml-shape-xform");class c extends s{constructor(){super(),this.map={"v:shape":new l}}get tag(){return"xml"}render(u,p){u.openXml(o.StdDocAttributes),u.openNode(this.tag,c.DRAWING_ATTRIBUTES),u.openNode("o:shapelayout",{"v:ext":"edit"}),u.leafNode("o:idmap",{"v:ext":"edit",data:1}),u.closeNode(),u.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),u.leafNode("v:stroke",{joinstyle:"miter"}),u.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),u.closeNode(),p.comments.forEach((f,h)=>{this.map["v:shape"].render(u,f,h)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset(),this.model={comments:[]};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0;switch(u){case this.tag:return!1;default:return!0}}reconcile(u,p){u.anchors.forEach(f=>{f.br?this.map["xdr:twoCellAnchor"].reconcile(f,p):this.map["xdr:oneCellAnchor"].reconcile(f,p)})}}c.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},n.exports=c},{"../../../utils/xml-stream":28,"../base-xform":32,"./vml-shape-xform":46}],46:[function(e,n,a){const o=e("../base-xform"),s=e("./vml-textbox-xform"),l=e("./vml-client-data-xform");class c extends o{constructor(){super(),this.map={"v:textbox":new s,"x:ClientData":new l}}get tag(){return"v:shape"}render(u,p,f){u.openNode("v:shape",c.V_SHAPE_ATTRIBUTES(p,f)),u.leafNode("v:fill",{color2:"infoBackground [80]"}),u.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),u.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(u,p),this.map["x:ClientData"].render(u,p),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset(),this.model={margins:{insetmode:u.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1;default:return!0}}}c.V_SHAPE_ATTRIBUTES=(i,u)=>({id:"_x0000_s"+(1025+u),type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":i.note.margins&&i.note.margins.insetmode}),n.exports=c},{"../base-xform":32,"./vml-client-data-xform":44,"./vml-textbox-xform":47}],47:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"v:textbox"}conversionUnit(s,l,c){return`${parseFloat(s)*l.toFixed(2)}${c}`}reverseConversionUnit(s){return(s||"").split(",").map(l=>Number(parseFloat(this.conversionUnit(parseFloat(l),.1,"")).toFixed(2)))}render(s,l){const c={style:"mso-direction-alt:auto"};if(l&&l.note){let{inset:i}=l.note&&l.note.margins;Array.isArray(i)&&(i=i.map(u=>this.conversionUnit(u,10,"mm")).join(",")),i&&(c.inset=i)}s.openNode("v:textbox",c),s.leafNode("div",{style:"text-align:left"}),s.closeNode()}parseOpen(s){switch(s.name){case this.tag:return this.model={inset:this.reverseConversionUnit(s.attributes.inset)},!0;default:return!0}}parseText(){}parseClose(s){switch(s){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],48:[function(e,n,a){const o=e("./base-xform");n.exports=class extends o{createNewModel(s){return{}}parseOpen(s){return this.parser=this.parser||this.map[s.name],this.parser?(this.parser.parseOpen(s),!0):s.name===this.tag&&(this.model=this.createNewModel(s),!0)}parseText(s){this.parser&&this.parser.parseText(s)}onParserClose(s,l){this.model[s]=l.model}parseClose(s){return this.parser?(this.parser.parseClose(s)||(this.onParserClose(s,this.parser),this.parser=void 0),!0):s!==this.tag}}},{"./base-xform":32}],49:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{render(s,l){s.openNode("HeadingPairs"),s.openNode("vt:vector",{size:2,baseType:"variant"}),s.openNode("vt:variant"),s.leafNode("vt:lpstr",void 0,"Worksheets"),s.closeNode(),s.openNode("vt:variant"),s.leafNode("vt:i4",void 0,l.length),s.closeNode(),s.closeNode(),s.closeNode()}parseOpen(s){return s.name==="HeadingPairs"}parseText(){}parseClose(s){return s!=="HeadingPairs"}}},{"../base-xform":32}],50:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{render(s,l){s.openNode("TitlesOfParts"),s.openNode("vt:vector",{size:l.length,baseType:"lpstr"}),l.forEach(c=>{s.leafNode("vt:lpstr",void 0,c.name)}),s.closeNode(),s.closeNode()}parseOpen(s){return s.name==="TitlesOfParts"}parseText(){}parseClose(s){return s!=="TitlesOfParts"}}},{"../base-xform":32}],51:[function(e,n,a){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("../simple/string-xform"),c=e("./app-heading-pairs-xform"),i=e("./app-titles-of-parts-xform");class u extends s{constructor(){super(),this.map={Company:new l({tag:"Company"}),Manager:new l({tag:"Manager"}),HeadingPairs:new c,TitleOfParts:new i}}render(f,h){f.openXml(o.StdDocAttributes),f.openNode("Properties",u.PROPERTY_ATTRIBUTES),f.leafNode("Application",void 0,"Microsoft Excel"),f.leafNode("DocSecurity",void 0,"0"),f.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(f,h.worksheets),this.map.TitleOfParts.render(f,h.worksheets),this.map.Company.render(f,h.company||""),this.map.Manager.render(f,h.manager),f.leafNode("LinksUpToDate",void 0,"false"),f.leafNode("SharedDoc",void 0,"false"),f.leafNode("HyperlinksChanged",void 0,"false"),f.leafNode("AppVersion",void 0,"16.0300"),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"Properties":return!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.parser=void 0),!0;switch(f){case"Properties":return this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1;default:return!0}}}u.DateFormat=function(p){return p.toISOString().replace(/[.]\d{3,6}/,"")},u.DateAttrs={"xsi:type":"dcterms:W3CDTF"},u.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},n.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/string-xform":119,"./app-heading-pairs-xform":49,"./app-titles-of-parts-xform":50}],52:[function(e,n,a){const o=e("../../../utils/xml-stream"),s=e("../base-xform");class l extends s{render(i,u){i.openXml(o.StdDocAttributes),i.openNode("Types",l.PROPERTY_ATTRIBUTES);const p={};(u.media||[]).forEach(f=>{if(f.type==="image"){const h=f.extension;p[h]||(p[h]=!0,i.leafNode("Default",{Extension:h,ContentType:"image/"+h}))}}),i.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),i.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),i.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),u.worksheets.forEach(f=>{const h=`/xl/worksheets/sheet${f.id}.xml`;i.leafNode("Override",{PartName:h,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),i.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),i.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),u.sharedStrings&&u.sharedStrings.count&&i.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),u.tables&&u.tables.forEach(f=>{i.leafNode("Override",{PartName:"/xl/tables/"+f.target,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),u.drawings&&u.drawings.forEach(f=>{i.leafNode("Override",{PartName:`/xl/drawings/${f.name}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),u.commentRefs&&(i.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),u.commentRefs.forEach(f=>{let{commentName:h}=f;i.leafNode("Override",{PartName:`/xl/${h}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),i.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),i.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),i.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}}l.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},n.exports=l},{"../../../utils/xml-stream":28,"../base-xform":32}],53:[function(e,n,a){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("../simple/date-xform"),c=e("../simple/string-xform"),i=e("../simple/integer-xform");class u extends s{constructor(){super(),this.map={"dc:creator":new c({tag:"dc:creator"}),"dc:title":new c({tag:"dc:title"}),"dc:subject":new c({tag:"dc:subject"}),"dc:description":new c({tag:"dc:description"}),"dc:identifier":new c({tag:"dc:identifier"}),"dc:language":new c({tag:"dc:language"}),"cp:keywords":new c({tag:"cp:keywords"}),"cp:category":new c({tag:"cp:category"}),"cp:lastModifiedBy":new c({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new l({tag:"cp:lastPrinted",format:u.DateFormat}),"cp:revision":new i({tag:"cp:revision"}),"cp:version":new c({tag:"cp:version"}),"cp:contentStatus":new c({tag:"cp:contentStatus"}),"cp:contentType":new c({tag:"cp:contentType"}),"dcterms:created":new l({tag:"dcterms:created",attrs:u.DateAttrs,format:u.DateFormat}),"dcterms:modified":new l({tag:"dcterms:modified",attrs:u.DateAttrs,format:u.DateFormat})}}render(f,h){f.openXml(o.StdDocAttributes),f.openNode("cp:coreProperties",u.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(f,h.creator),this.map["dc:title"].render(f,h.title),this.map["dc:subject"].render(f,h.subject),this.map["dc:description"].render(f,h.description),this.map["dc:identifier"].render(f,h.identifier),this.map["dc:language"].render(f,h.language),this.map["cp:keywords"].render(f,h.keywords),this.map["cp:category"].render(f,h.category),this.map["cp:lastModifiedBy"].render(f,h.lastModifiedBy),this.map["cp:lastPrinted"].render(f,h.lastPrinted),this.map["cp:revision"].render(f,h.revision),this.map["cp:version"].render(f,h.version),this.map["cp:contentStatus"].render(f,h.contentStatus),this.map["cp:contentType"].render(f,h.contentType),this.map["dcterms:created"].render(f,h.created),this.map["dcterms:modified"].render(f,h.modified),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[f.name],this.parser)return this.parser.parseOpen(f),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(f))}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.parser=void 0),!0;switch(f){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error("Unexpected xml node in parseClose: "+f)}}}u.DateFormat=function(p){return p.toISOString().replace(/[.]\d{3}/,"")},u.DateAttrs={"xsi:type":"dcterms:W3CDTF"},u.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},n.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/date-xform":117,"../simple/integer-xform":118,"../simple/string-xform":119}],54:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{render(s,l){s.leafNode("Relationship",l)}parseOpen(s){switch(s.name){case"Relationship":return this.model=s.attributes,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],55:[function(e,n,a){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("./relationship-xform");class c extends s{constructor(){super(),this.map={Relationship:new l}}render(u,p){p=p||this._values,u.openXml(o.StdDocAttributes),u.openNode("Relationships",c.RELATIONSHIPS_ATTRIBUTES),p.forEach(f=>{this.map.Relationship.render(u,f)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"Relationships":return this.model=[],!0;default:if(this.parser=this.map[u.name],this.parser)return this.parser.parseOpen(u),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(u))}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.push(this.parser.model),this.parser=void 0),!0;switch(u){case"Relationships":return!1;default:throw new Error("Unexpected xml node in parseClose: "+u)}}}c.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},n.exports=c},{"../../../utils/xml-stream":28,"../base-xform":32,"./relationship-xform":54}],56:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{parseOpen(s){if(this.parser)return this.parser.parseOpen(s),!0;switch(s.name){case this.tag:this.reset(),this.model={range:{editAs:s.attributes.editAs||"oneCell"}};break;default:this.parser=this.map[s.name],this.parser&&this.parser.parseOpen(s)}return!0}parseText(s){this.parser&&this.parser.parseText(s)}reconcilePicture(s,l){if(s&&s.rId){const c=l.rels[s.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(c){const i=c[1],u=l.mediaIndex[i];return l.media[u]}}}}},{"../base-xform":32}],57:[function(e,n,a){const o=e("../base-xform"),s=e("./blip-xform");n.exports=class extends o{constructor(){super(),this.map={"a:blip":new s}}get tag(){return"xdr:blipFill"}render(l,c){l.openNode(this.tag),this.map["a:blip"].render(l,c),l.openNode("a:stretch"),l.leafNode("a:fillRect"),l.closeNode(),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:this.reset();break;default:this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)}return!0}parseText(){}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model=this.map["a:blip"].model,!1;default:return!0}}}},{"../base-xform":32,"./blip-xform":58}],58:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"a:blip"}render(s,l){s.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":l.rId,cstate:"print"})}parseOpen(s){switch(s.name){case this.tag:return this.model={rId:s.attributes["r:embed"]},!0;default:return!0}}parseText(){}parseClose(s){switch(s){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],59:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"xdr:cNvPicPr"}render(s){s.openNode(this.tag),s.leafNode("a:picLocks",{noChangeAspect:"1"}),s.closeNode()}parseOpen(s){switch(s.name){case this.tag:default:return!0}}parseText(){}parseClose(s){switch(s){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],60:[function(e,n,a){const o=e("../base-xform"),s=e("./hlink-click-xform"),l=e("./ext-lst-xform");n.exports=class extends o{constructor(){super(),this.map={"a:hlinkClick":new s,"a:extLst":new l}}get tag(){return"xdr:cNvPr"}render(c,i){c.openNode(this.tag,{id:i.index,name:"Picture "+i.index}),this.map["a:hlinkClick"].render(c,i),this.map["a:extLst"].render(c,i),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:this.reset();break;default:this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)}return!0}parseText(){}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;switch(c){case this.tag:return this.model=this.map["a:hlinkClick"].model,!1;default:return!0}}}},{"../base-xform":32,"./ext-lst-xform":63,"./hlink-click-xform":65}],61:[function(e,n,a){const o=e("../base-xform"),s=e("../simple/integer-xform");n.exports=class extends o{constructor(l){super(),this.tag=l.tag,this.map={"xdr:col":new s({tag:"xdr:col",zero:!0}),"xdr:colOff":new s({tag:"xdr:colOff",zero:!0}),"xdr:row":new s({tag:"xdr:row",zero:!0}),"xdr:rowOff":new s({tag:"xdr:rowOff",zero:!0})}}render(l,c){l.openNode(this.tag),this.map["xdr:col"].render(l,c.nativeCol),this.map["xdr:colOff"].render(l,c.nativeColOff),this.map["xdr:row"].render(l,c.nativeRow),this.map["xdr:rowOff"].render(l,c.nativeRowOff),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:this.reset();break;default:this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)}return!0}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1;default:return!0}}}},{"../base-xform":32,"../simple/integer-xform":118}],62:[function(e,n,a){const o=e("../../../utils/col-cache"),s=e("../../../utils/xml-stream"),l=e("../base-xform"),c=e("./two-cell-anchor-xform"),i=e("./one-cell-anchor-xform");class u extends l{constructor(){super(),this.map={"xdr:twoCellAnchor":new c,"xdr:oneCellAnchor":new i}}prepare(f){f.anchors.forEach((h,v)=>{h.anchorType=function(b){return(typeof b.range=="string"?o.decode(b.range):b.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor"}(h),this.map[h.anchorType].prepare(h,{index:v})})}get tag(){return"xdr:wsDr"}render(f,h){f.openXml(s.StdDocAttributes),f.openNode(this.tag,u.DRAWING_ATTRIBUTES),h.anchors.forEach(v=>{this.map[v.anchorType].render(f,v)}),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case this.tag:this.reset(),this.model={anchors:[]};break;default:this.parser=this.map[f.name],this.parser&&this.parser.parseOpen(f)}return!0}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0;switch(f){case this.tag:return!1;default:return!0}}reconcile(f,h){f.anchors.forEach(v=>{v.br?this.map["xdr:twoCellAnchor"].reconcile(v,h):this.map["xdr:oneCellAnchor"].reconcile(v,h)})}}u.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},n.exports=u},{"../../../utils/col-cache":19,"../../../utils/xml-stream":28,"../base-xform":32,"./one-cell-anchor-xform":67,"./two-cell-anchor-xform":70}],63:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"a:extLst"}render(s){s.openNode(this.tag),s.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),s.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),s.closeNode(),s.closeNode()}parseOpen(s){switch(s.name){case this.tag:default:return!0}}parseText(){}parseClose(s){switch(s){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],64:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.map={}}render(s,l){s.openNode(this.tag);const c=Math.floor(9525*l.width),i=Math.floor(9525*l.height);s.addAttribute("cx",c),s.addAttribute("cy",i),s.closeNode()}parseOpen(s){return s.name===this.tag&&(this.model={width:parseInt(s.attributes.cx||"0",10)/9525,height:parseInt(s.attributes.cy||"0",10)/9525},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],65:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"a:hlinkClick"}render(s,l){l.hyperlinks&&l.hyperlinks.rId&&s.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":l.hyperlinks.rId,tooltip:l.hyperlinks.tooltip})}parseOpen(s){switch(s.name){case this.tag:return this.model={hyperlinks:{rId:s.attributes["r:id"],tooltip:s.attributes.tooltip}},!0;default:return!0}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],66:[function(e,n,a){const o=e("../base-xform"),s=e("./c-nv-pr-xform"),l=e("./c-nv-pic-pr-xform");n.exports=class extends o{constructor(){super(),this.map={"xdr:cNvPr":new s,"xdr:cNvPicPr":new l}}get tag(){return"xdr:nvPicPr"}render(c,i){c.openNode(this.tag),this.map["xdr:cNvPr"].render(c,i),this.map["xdr:cNvPicPr"].render(c,i),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:this.reset();break;default:this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)}return!0}parseText(){}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;switch(c){case this.tag:return this.model=this.map["xdr:cNvPr"].model,!1;default:return!0}}}},{"../base-xform":32,"./c-nv-pic-pr-xform":59,"./c-nv-pr-xform":60}],67:[function(e,n,a){const o=e("./base-cell-anchor-xform"),s=e("../static-xform"),l=e("./cell-position-xform"),c=e("./ext-xform"),i=e("./pic-xform");n.exports=class extends o{constructor(){super(),this.map={"xdr:from":new l({tag:"xdr:from"}),"xdr:ext":new c({tag:"xdr:ext"}),"xdr:pic":new i,"xdr:clientData":new s({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(u,p){this.map["xdr:pic"].prepare(u.picture,p)}render(u,p){u.openNode(this.tag,{editAs:p.range.editAs||"oneCell"}),this.map["xdr:from"].render(u,p.range.tl),this.map["xdr:ext"].render(u,p.range.ext),this.map["xdr:pic"].render(u,p.picture),this.map["xdr:clientData"].render(u,{}),u.closeNode()}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(u,p){u.medium=this.reconcilePicture(u.picture,p)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./ext-xform":64,"./pic-xform":68}],68:[function(e,n,a){const o=e("../base-xform"),s=e("../static-xform"),l=e("./blip-fill-xform"),c=e("./nv-pic-pr-xform"),i=e("./sp-pr");n.exports=class extends o{constructor(){super(),this.map={"xdr:nvPicPr":new c,"xdr:blipFill":new l,"xdr:spPr":new s(i)}}get tag(){return"xdr:pic"}prepare(u,p){u.index=p.index+1}render(u,p){u.openNode(this.tag),this.map["xdr:nvPicPr"].render(u,p),this.map["xdr:blipFill"].render(u,p),this.map["xdr:spPr"].render(u,p),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset();break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(){}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.mergeModel(this.parser.model),this.parser=void 0),!0;switch(u){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"../static-xform":120,"./blip-fill-xform":57,"./nv-pic-pr-xform":66,"./sp-pr":69}],69:[function(e,n,a){n.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}},{}],70:[function(e,n,a){const o=e("./base-cell-anchor-xform"),s=e("../static-xform"),l=e("./cell-position-xform"),c=e("./pic-xform");n.exports=class extends o{constructor(){super(),this.map={"xdr:from":new l({tag:"xdr:from"}),"xdr:to":new l({tag:"xdr:to"}),"xdr:pic":new c,"xdr:clientData":new s({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(i,u){this.map["xdr:pic"].prepare(i.picture,u)}render(i,u){i.openNode(this.tag,{editAs:u.range.editAs||"oneCell"}),this.map["xdr:from"].render(i,u.range.tl),this.map["xdr:to"].render(i,u.range.br),this.map["xdr:pic"].render(i,u.picture),this.map["xdr:clientData"].render(i,{}),i.closeNode()}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.parser=void 0),!0;switch(i){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(i,u){i.medium=this.reconcilePicture(i.picture,u)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./pic-xform":68}],71:[function(e,n,a){const o=e("./base-xform");n.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.always=!!s.always,this.count=s.count,this.empty=s.empty,this.$count=s.$count||"count",this.$=s.$,this.childXform=s.childXform,this.maxItems=s.maxItems}prepare(s,l){const{childXform:c}=this;s&&s.forEach((i,u)=>{l.index=u,c.prepare(i,l)})}render(s,l){if(this.always||l&&l.length){s.openNode(this.tag,this.$),this.count&&s.addAttribute(this.$count,l&&l.length||0);const{childXform:c}=this;(l||[]).forEach((i,u)=>{c.render(s,i,u)}),s.closeNode()}else this.empty&&s.leafNode(this.tag)}parseOpen(s){if(this.parser)return this.parser.parseOpen(s),!0;switch(s.name){case this.tag:return this.model=[],!0;default:return!!this.childXform.parseOpen(s)&&(this.parser=this.childXform,!0)}}parseText(s){this.parser&&this.parser.parseText(s)}parseClose(s){if(this.parser){if(!this.parser.parseClose(s)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw new Error(`Max ${this.childXform.tag} count (${this.maxItems}) exceeded`);return!0}return!1}reconcile(s,l){if(s){const{childXform:c}=this;s.forEach(i=>{c.reconcile(i,l)})}}}},{"./base-xform":32}],72:[function(e,n,a){const o=e("../../../utils/col-cache"),s=e("../base-xform");n.exports=class extends s{get tag(){return"autoFilter"}render(l,c){if(c)if(typeof c=="string")l.leafNode("autoFilter",{ref:c});else{const i=function(f){return typeof f=="string"?f:o.getAddress(f.row,f.column).address},u=i(c.from),p=i(c.to);u&&p&&l.leafNode("autoFilter",{ref:`${u}:${p}`})}}parseOpen(l){l.name==="autoFilter"&&(this.model=l.attributes.ref)}}},{"../../../utils/col-cache":19,"../base-xform":32}],73:[function(e,n,a){const o=e("../../../utils/utils"),s=e("../base-xform"),l=e("../../../doc/range"),c=e("../../../doc/enums"),i=e("../strings/rich-text-xform");function u(p){if(p==null)return c.ValueType.Null;if(p instanceof String||typeof p=="string")return c.ValueType.String;if(typeof p=="number")return c.ValueType.Number;if(typeof p=="boolean")return c.ValueType.Boolean;if(p instanceof Date)return c.ValueType.Date;if(p.text&&p.hyperlink)return c.ValueType.Hyperlink;if(p.formula)return c.ValueType.Formula;if(p.error)return c.ValueType.Error;throw new Error("I could not understand type of value")}n.exports=class extends s{constructor(){super(),this.richTextXForm=new i}get tag(){return"c"}prepare(p,f){const h=f.styles.addStyleModel(p.style||{},function(v){switch(v.type){case c.ValueType.Formula:return u(v.result);default:return v.type}}(p));switch(h&&(p.styleId=h),p.comment&&f.comments.push({...p.comment,ref:p.address}),p.type){case c.ValueType.String:case c.ValueType.RichText:f.sharedStrings&&(p.ssId=f.sharedStrings.add(p.value));break;case c.ValueType.Date:f.date1904&&(p.date1904=!0);break;case c.ValueType.Hyperlink:f.sharedStrings&&p.text!==void 0&&p.text!==null&&(p.ssId=f.sharedStrings.add(p.text)),f.hyperlinks.push({address:p.address,target:p.hyperlink,tooltip:p.tooltip});break;case c.ValueType.Merge:f.merges.add(p);break;case c.ValueType.Formula:if(f.date1904&&(p.date1904=!0),p.shareType==="shared"&&(p.si=f.siFormulae++),p.formula)f.formulae[p.address]=p;else if(p.sharedFormula){const v=f.formulae[p.sharedFormula];if(!v)throw new Error("Shared Formula master must exist above and or left of clone for cell "+p.address);v.si===void 0?(v.shareType="shared",v.si=f.siFormulae++,v.range=new l(v.address,p.address)):v.range&&v.range.expandToAddress(p.address),p.si=v.si}}}renderFormula(p,f){let h=null;switch(f.shareType){case"shared":h={t:"shared",ref:f.ref||f.range.range,si:f.si};break;case"array":h={t:"array",ref:f.ref};break;default:f.si!==void 0&&(h={t:"shared",si:f.si})}switch(u(f.result)){case c.ValueType.Null:p.leafNode("f",h,f.formula);break;case c.ValueType.String:p.addAttribute("t","str"),p.leafNode("f",h,f.formula),p.leafNode("v",null,f.result);break;case c.ValueType.Number:p.leafNode("f",h,f.formula),p.leafNode("v",null,f.result);break;case c.ValueType.Boolean:p.addAttribute("t","b"),p.leafNode("f",h,f.formula),p.leafNode("v",null,f.result?1:0);break;case c.ValueType.Error:p.addAttribute("t","e"),p.leafNode("f",h,f.formula),p.leafNode("v",null,f.result.error);break;case c.ValueType.Date:p.leafNode("f",h,f.formula),p.leafNode("v",null,o.dateToExcel(f.result,f.date1904));break;default:throw new Error("I could not understand type of value")}}render(p,f){if(f.type!==c.ValueType.Null||f.styleId){switch(p.openNode("c"),p.addAttribute("r",f.address),f.styleId&&p.addAttribute("s",f.styleId),f.type){case c.ValueType.Null:break;case c.ValueType.Number:p.leafNode("v",null,f.value);break;case c.ValueType.Boolean:p.addAttribute("t","b"),p.leafNode("v",null,f.value?"1":"0");break;case c.ValueType.Error:p.addAttribute("t","e"),p.leafNode("v",null,f.value.error);break;case c.ValueType.String:case c.ValueType.RichText:f.ssId!==void 0?(p.addAttribute("t","s"),p.leafNode("v",null,f.ssId)):f.value&&f.value.richText?(p.addAttribute("t","inlineStr"),p.openNode("is"),f.value.richText.forEach(h=>{this.richTextXForm.render(p,h)}),p.closeNode("is")):(p.addAttribute("t","str"),p.leafNode("v",null,f.value));break;case c.ValueType.Date:p.leafNode("v",null,o.dateToExcel(f.value,f.date1904));break;case c.ValueType.Hyperlink:f.ssId!==void 0?(p.addAttribute("t","s"),p.leafNode("v",null,f.ssId)):(p.addAttribute("t","str"),p.leafNode("v",null,f.text));break;case c.ValueType.Formula:this.renderFormula(p,f);break;case c.ValueType.Merge:}p.closeNode()}}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;switch(p.name){case"c":return this.model={address:p.attributes.r},this.t=p.attributes.t,p.attributes.s&&(this.model.styleId=parseInt(p.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=p.attributes.si,this.model.shareType=p.attributes.t,this.model.ref=p.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(p),!0;default:return!1}}parseText(p){if(this.parser)this.parser.parseText(p);else switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+p:p;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+p:p:this.model.value=this.model.value?this.model.value+p:p}}parseClose(p){switch(p){case"c":{const{model:f}=this;if(f.formula||f.shareType)f.type=c.ValueType.Formula,f.value&&(this.t==="str"?f.result=o.xmlDecode(f.value):this.t==="b"?f.result=parseInt(f.value,10)!==0:this.t==="e"?f.result={error:f.value}:f.result=parseFloat(f.value),f.value=void 0);else if(f.value!==void 0)switch(this.t){case"s":f.type=c.ValueType.String,f.value=parseInt(f.value,10);break;case"str":f.type=c.ValueType.String,f.value=o.xmlDecode(f.value);break;case"inlineStr":f.type=c.ValueType.String;break;case"b":f.type=c.ValueType.Boolean,f.value=parseInt(f.value,10)!==0;break;case"e":f.type=c.ValueType.Error,f.value={error:f.value};break;default:f.type=c.ValueType.Number,f.value=parseFloat(f.value)}else f.styleId?f.type=c.ValueType.Null:f.type=c.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?(this.parser.parseClose(p),!0):(this.currentNode=void 0,!0);case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return!!this.parser&&(this.parser.parseClose(p),!0)}}reconcile(p,f){const h=p.styleId&&f.styles&&f.styles.getStyleModel(p.styleId);switch(h&&(p.style=h),p.styleId!==void 0&&(p.styleId=void 0),p.type){case c.ValueType.String:typeof p.value=="number"&&f.sharedStrings&&(p.value=f.sharedStrings.getString(p.value)),p.value.richText&&(p.type=c.ValueType.RichText);break;case c.ValueType.Number:h&&o.isDateFmt(h.numFmt)&&(p.type=c.ValueType.Date,p.value=o.excelToDate(p.value,f.date1904));break;case c.ValueType.Formula:p.result!==void 0&&h&&o.isDateFmt(h.numFmt)&&(p.result=o.excelToDate(p.result,f.date1904)),p.shareType==="shared"&&(p.ref?f.formulae[p.si]=p.address:(p.sharedFormula=f.formulae[p.si],delete p.shareType),delete p.si)}const v=f.hyperlinkMap[p.address];v&&(p.type===c.ValueType.Formula?(p.text=p.result,p.result=void 0):(p.text=p.value,p.value=void 0),p.type=c.ValueType.Hyperlink,p.hyperlink=v);const b=f.commentsMap&&f.commentsMap[p.address];b&&(p.comment=b)}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],74:[function(e,n,a){const o=e("../../base-xform");n.exports=class extends o{get tag(){return"x14:cfIcon"}render(s,l){s.leafNode(this.tag,{iconSet:l.iconSet,iconId:l.iconId})}parseOpen(s){let{attributes:l}=s;this.model={iconSet:l.iconSet,iconId:o.toIntValue(l.iconId)}}parseClose(s){return s!==this.tag}}},{"../../base-xform":32}],75:[function(e,n,a){const{v4:o}=e("uuid"),s=e("../../base-xform"),l=e("../../composite-xform"),c=e("./databar-ext-xform"),i=e("./icon-set-ext-xform"),u={"3Triangles":!0,"3Stars":!0,"5Boxes":!0};class p extends l{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new c,"x14:iconSet":this.iconSetXform=new i}}get tag(){return"x14:cfRule"}static isExt(h){return h.type==="dataBar"?c.isExt(h):!(h.type!=="iconSet"||!h.custom&&!u[h.iconSet])}prepare(h){p.isExt(h)&&(h.x14Id=`{${o()}}`.toUpperCase())}render(h,v){if(p.isExt(v))switch(v.type){case"dataBar":this.renderDataBar(h,v);break;case"iconSet":this.renderIconSet(h,v)}}renderDataBar(h,v){h.openNode(this.tag,{type:"dataBar",id:v.x14Id}),this.databarXform.render(h,v),h.closeNode()}renderIconSet(h,v){h.openNode(this.tag,{type:"iconSet",priority:v.priority,id:v.x14Id||`{${o()}}`}),this.iconSetXform.render(h,v),h.closeNode()}createNewModel(h){let{attributes:v}=h;return{type:v.type,x14Id:v.id,priority:s.toIntValue(v.priority)}}onParserClose(h,v){Object.assign(this.model,v.model)}}n.exports=p},{"../../base-xform":32,"../../composite-xform":48,"./databar-ext-xform":79,"./icon-set-ext-xform":81,uuid:528}],76:[function(e,n,a){const o=e("../../composite-xform"),s=e("./f-ext-xform");n.exports=class extends o{constructor(){super(),this.map={"xm:f":this.fExtXform=new s}}get tag(){return"x14:cfvo"}render(l,c){l.openNode(this.tag,{type:c.type}),c.value!==void 0&&this.fExtXform.render(l,c.value),l.closeNode()}createNewModel(l){return{type:l.attributes.type}}onParserClose(l,c){switch(l){case"xm:f":this.model.value=c.model?parseFloat(c.model):0}}}},{"../../composite-xform":48,"./f-ext-xform":80}],77:[function(e,n,a){const o=e("../../composite-xform"),s=e("./sqref-ext-xform"),l=e("./cf-rule-ext-xform");n.exports=class extends o{constructor(){super(),this.map={"xm:sqref":this.sqRef=new s,"x14:cfRule":this.cfRule=new l}}get tag(){return"x14:conditionalFormatting"}prepare(c,i){c.rules.forEach(u=>{this.cfRule.prepare(u,i)})}render(c,i){i.rules.some(l.isExt)&&(c.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),i.rules.filter(l.isExt).forEach(u=>this.cfRule.render(c,u)),this.sqRef.render(c,i.ref),c.closeNode())}createNewModel(){return{rules:[]}}onParserClose(c,i){switch(c){case"xm:sqref":this.model.ref=i.model;break;case"x14:cfRule":this.model.rules.push(i.model)}}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./sqref-ext-xform":82}],78:[function(e,n,a){const o=e("../../composite-xform"),s=e("./cf-rule-ext-xform"),l=e("./conditional-formatting-ext-xform");n.exports=class extends o{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new l}}get tag(){return"x14:conditionalFormattings"}hasContent(c){return c.hasExtContent===void 0&&(c.hasExtContent=c.some(i=>i.rules.some(s.isExt))),c.hasExtContent}prepare(c,i){c.forEach(u=>{this.cfXform.prepare(u,i)})}render(c,i){this.hasContent(i)&&(c.openNode(this.tag),i.forEach(u=>this.cfXform.render(c,u)),c.closeNode())}createNewModel(){return[]}onParserClose(c,i){this.model.push(i.model)}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./conditional-formatting-ext-xform":77}],79:[function(e,n,a){const o=e("../../base-xform"),s=e("../../composite-xform"),l=e("../../style/color-xform"),c=e("./cfvo-ext-xform");n.exports=class extends s{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new c,"x14:borderColor":this.borderColorXform=new l("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new l("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new l("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new l("x14:axisColor")}}static isExt(i){return!i.gradient}get tag(){return"x14:dataBar"}render(i,u){i.openNode(this.tag,{minLength:o.toIntAttribute(u.minLength,0,!0),maxLength:o.toIntAttribute(u.maxLength,100,!0),border:o.toBoolAttribute(u.border,!1),gradient:o.toBoolAttribute(u.gradient,!0),negativeBarColorSameAsPositive:o.toBoolAttribute(u.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:o.toBoolAttribute(u.negativeBarBorderColorSameAsPositive,!0),axisPosition:o.toAttribute(u.axisPosition,"auto"),direction:o.toAttribute(u.direction,"leftToRight")}),u.cfvo.forEach(p=>{this.cfvoXform.render(i,p)}),this.borderColorXform.render(i,u.borderColor),this.negativeBorderColorXform.render(i,u.negativeBorderColor),this.negativeFillColorXform.render(i,u.negativeFillColor),this.axisColorXform.render(i,u.axisColor),i.closeNode()}createNewModel(i){let{attributes:u}=i;return{cfvo:[],minLength:o.toIntValue(u.minLength,0),maxLength:o.toIntValue(u.maxLength,100),border:o.toBoolValue(u.border,!1),gradient:o.toBoolValue(u.gradient,!0),negativeBarColorSameAsPositive:o.toBoolValue(u.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:o.toBoolValue(u.negativeBarBorderColorSameAsPositive,!0),axisPosition:o.toStringValue(u.axisPosition,"auto"),direction:o.toStringValue(u.direction,"leftToRight")}}onParserClose(i,u){const[,p]=i.split(":");switch(p){case"cfvo":this.model.cfvo.push(u.model);break;default:this.model[p]=u.model}}}},{"../../base-xform":32,"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-ext-xform":76}],80:[function(e,n,a){const o=e("../../base-xform");n.exports=class extends o{get tag(){return"xm:f"}render(s,l){s.leafNode(this.tag,null,l)}parseOpen(){this.model=""}parseText(s){this.model+=s}parseClose(s){return s!==this.tag}}},{"../../base-xform":32}],81:[function(e,n,a){const o=e("../../base-xform"),s=e("../../composite-xform"),l=e("./cfvo-ext-xform"),c=e("./cf-icon-ext-xform");n.exports=class extends s{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new l,"x14:cfIcon":this.cfIconXform=new c}}get tag(){return"x14:iconSet"}render(i,u){i.openNode(this.tag,{iconSet:o.toStringAttribute(u.iconSet),reverse:o.toBoolAttribute(u.reverse,!1),showValue:o.toBoolAttribute(u.showValue,!0),custom:o.toBoolAttribute(u.icons,!1)}),u.cfvo.forEach(p=>{this.cfvoXform.render(i,p)}),u.icons&&u.icons.forEach((p,f)=>{p.iconId=f,this.cfIconXform.render(i,p)}),i.closeNode()}createNewModel(i){let{attributes:u}=i;return{cfvo:[],iconSet:o.toStringValue(u.iconSet,"3TrafficLights"),reverse:o.toBoolValue(u.reverse,!1),showValue:o.toBoolValue(u.showValue,!0)}}onParserClose(i,u){const[,p]=i.split(":");switch(p){case"cfvo":this.model.cfvo.push(u.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(u.model);break;default:this.model[p]=u.model}}}},{"../../base-xform":32,"../../composite-xform":48,"./cf-icon-ext-xform":74,"./cfvo-ext-xform":76}],82:[function(e,n,a){const o=e("../../base-xform");n.exports=class extends o{get tag(){return"xm:sqref"}render(s,l){s.leafNode(this.tag,null,l)}parseOpen(){this.model=""}parseText(s){this.model+=s}parseClose(s){return s!==this.tag}}},{"../../base-xform":32}],83:[function(e,n,a){const o=e("../../base-xform"),s=e("../../composite-xform"),l=e("../../../../doc/range"),c=e("./databar-xform"),i=e("./ext-lst-ref-xform"),u=e("./formula-xform"),p=e("./color-scale-xform"),f=e("./icon-set-xform"),h={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},v=g=>{const{type:x,operator:y}=g;switch(x){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:x};default:return{type:x,operator:y}}};class b extends s{constructor(){super(),this.map={dataBar:this.databarXform=new c,extLst:this.extLstRefXform=new i,formula:this.formulaXform=new u,colorScale:this.colorScaleXform=new p,iconSet:this.iconSetXform=new f}}get tag(){return"cfRule"}static isPrimitive(x){return x.type!=="iconSet"||!x.custom&&!h[x.iconSet]}render(x,y){switch(y.type){case"expression":this.renderExpression(x,y);break;case"cellIs":this.renderCellIs(x,y);break;case"top10":this.renderTop10(x,y);break;case"aboveAverage":this.renderAboveAverage(x,y);break;case"dataBar":this.renderDataBar(x,y);break;case"colorScale":this.renderColorScale(x,y);break;case"iconSet":this.renderIconSet(x,y);break;case"containsText":this.renderText(x,y);break;case"timePeriod":this.renderTimePeriod(x,y)}}renderExpression(x,y){x.openNode(this.tag,{type:"expression",dxfId:y.dxfId,priority:y.priority}),this.formulaXform.render(x,y.formulae[0]),x.closeNode()}renderCellIs(x,y){x.openNode(this.tag,{type:"cellIs",dxfId:y.dxfId,priority:y.priority,operator:y.operator}),y.formulae.forEach(E=>{this.formulaXform.render(x,E)}),x.closeNode()}renderTop10(x,y){x.leafNode(this.tag,{type:"top10",dxfId:y.dxfId,priority:y.priority,percent:o.toBoolAttribute(y.percent,!1),bottom:o.toBoolAttribute(y.bottom,!1),rank:o.toIntValue(y.rank,10,!0)})}renderAboveAverage(x,y){x.leafNode(this.tag,{type:"aboveAverage",dxfId:y.dxfId,priority:y.priority,aboveAverage:o.toBoolAttribute(y.aboveAverage,!0)})}renderDataBar(x,y){x.openNode(this.tag,{type:"dataBar",priority:y.priority}),this.databarXform.render(x,y),this.extLstRefXform.render(x,y),x.closeNode()}renderColorScale(x,y){x.openNode(this.tag,{type:"colorScale",priority:y.priority}),this.colorScaleXform.render(x,y),x.closeNode()}renderIconSet(x,y){b.isPrimitive(y)&&(x.openNode(this.tag,{type:"iconSet",priority:y.priority}),this.iconSetXform.render(x,y),x.closeNode())}renderText(x,y){x.openNode(this.tag,{type:y.operator,dxfId:y.dxfId,priority:y.priority,operator:o.toStringAttribute(y.operator,"containsText")});const E=(N=>{if(N.formulae&&N.formulae[0])return N.formulae[0];const I=new l(N.ref),{tl:L}=I;switch(N.operator){case"containsText":return`NOT(ISERROR(SEARCH("${N.text}",${L})))`;case"containsBlanks":return`LEN(TRIM(${L}))=0`;case"notContainsBlanks":return`LEN(TRIM(${L}))>0`;case"containsErrors":return`ISERROR(${L})`;case"notContainsErrors":return`NOT(ISERROR(${L}))`;default:return}})(y);E&&this.formulaXform.render(x,E),x.closeNode()}renderTimePeriod(x,y){x.openNode(this.tag,{type:"timePeriod",dxfId:y.dxfId,priority:y.priority,timePeriod:y.timePeriod});const E=(N=>{if(N.formulae&&N.formulae[0])return N.formulae[0];const I=new l(N.ref),{tl:L}=I;switch(N.timePeriod){case"thisWeek":return`AND(TODAY()-ROUNDDOWN(${L},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${L},0)-TODAY()<=7-WEEKDAY(TODAY()))`;case"lastWeek":return`AND(TODAY()-ROUNDDOWN(${L},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${L},0)<(WEEKDAY(TODAY())+7))`;case"nextWeek":return`AND(ROUNDDOWN(${L},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${L},0)-TODAY()<(15-WEEKDAY(TODAY())))`;case"yesterday":return`FLOOR(${L},1)=TODAY()-1`;case"today":return`FLOOR(${L},1)=TODAY()`;case"tomorrow":return`FLOOR(${L},1)=TODAY()+1`;case"last7Days":return`AND(TODAY()-FLOOR(${L},1)<=6,FLOOR(${L},1)<=TODAY())`;case"lastMonth":return`AND(MONTH(${L})=MONTH(EDATE(TODAY(),0-1)),YEAR(${L})=YEAR(EDATE(TODAY(),0-1)))`;case"thisMonth":return`AND(MONTH(${L})=MONTH(TODAY()),YEAR(${L})=YEAR(TODAY()))`;case"nextMonth":return`AND(MONTH(${L})=MONTH(EDATE(TODAY(),0+1)),YEAR(${L})=YEAR(EDATE(TODAY(),0+1)))`;default:return}})(y);E&&this.formulaXform.render(x,E),x.closeNode()}createNewModel(x){let{attributes:y}=x;return{...v(y),dxfId:o.toIntValue(y.dxfId),priority:o.toIntValue(y.priority),timePeriod:y.timePeriod,percent:o.toBoolValue(y.percent),bottom:o.toBoolValue(y.bottom),rank:o.toIntValue(y.rank),aboveAverage:o.toBoolValue(y.aboveAverage)}}onParserClose(x,y){switch(x){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,y.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(y.model)}}}n.exports=b},{"../../../../doc/range":10,"../../base-xform":32,"../../composite-xform":48,"./color-scale-xform":85,"./databar-xform":88,"./ext-lst-ref-xform":89,"./formula-xform":90,"./icon-set-xform":91}],84:[function(e,n,a){const o=e("../../base-xform");n.exports=class extends o{get tag(){return"cfvo"}render(s,l){s.leafNode(this.tag,{type:l.type,val:l.value})}parseOpen(s){this.model={type:s.attributes.type,value:o.toFloatValue(s.attributes.val)}}parseClose(s){return s!==this.tag}}},{"../../base-xform":32}],85:[function(e,n,a){const o=e("../../composite-xform"),s=e("../../style/color-xform"),l=e("./cfvo-xform");n.exports=class extends o{constructor(){super(),this.map={cfvo:this.cfvoXform=new l,color:this.colorXform=new s}}get tag(){return"colorScale"}render(c,i){c.openNode(this.tag),i.cfvo.forEach(u=>{this.cfvoXform.render(c,u)}),i.color.forEach(u=>{this.colorXform.render(c,u)}),c.closeNode()}createNewModel(c){return{cfvo:[],color:[]}}onParserClose(c,i){this.model[c].push(i.model)}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],86:[function(e,n,a){const o=e("../../composite-xform"),s=e("./cf-rule-xform");n.exports=class extends o{constructor(){super(),this.map={cfRule:new s}}get tag(){return"conditionalFormatting"}render(l,c){c.rules.some(s.isPrimitive)&&(l.openNode(this.tag,{sqref:c.ref}),c.rules.forEach(i=>{s.isPrimitive(i)&&(i.ref=c.ref,this.map.cfRule.render(l,i))}),l.closeNode())}createNewModel(l){let{attributes:c}=l;return{ref:c.sqref,rules:[]}}onParserClose(l,c){this.model.rules.push(c.model)}}},{"../../composite-xform":48,"./cf-rule-xform":83}],87:[function(e,n,a){const o=e("../../base-xform"),s=e("./conditional-formatting-xform");n.exports=class extends o{constructor(){super(),this.cfXform=new s}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(l,c){let i=l.reduce((u,p)=>Math.max(u,...p.rules.map(f=>f.priority||0)),1);l.forEach(u=>{u.rules.forEach(p=>{p.priority||(p.priority=i++),p.style&&(p.dxfId=c.styles.addDxfStyle(p.style))})})}render(l,c){c.forEach(i=>{this.cfXform.render(l,i)})}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"conditionalFormatting":return this.parser=this.cfXform,this.parser.parseOpen(l),!0;default:return!1}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){return!!this.parser&&(!!this.parser.parseClose(l)||(this.model.push(this.parser.model),this.parser=void 0,!1))}reconcile(l,c){l.forEach(i=>{i.rules.forEach(u=>{u.dxfId!==void 0&&(u.style=c.styles.getDxfStyle(u.dxfId),delete u.dxfId)})})}}},{"../../base-xform":32,"./conditional-formatting-xform":86}],88:[function(e,n,a){const o=e("../../composite-xform"),s=e("../../style/color-xform"),l=e("./cfvo-xform");n.exports=class extends o{constructor(){super(),this.map={cfvo:this.cfvoXform=new l,color:this.colorXform=new s}}get tag(){return"dataBar"}render(c,i){c.openNode(this.tag),i.cfvo.forEach(u=>{this.cfvoXform.render(c,u)}),this.colorXform.render(c,i.color),c.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(c,i){switch(c){case"cfvo":this.model.cfvo.push(i.model);break;case"color":this.model.color=i.model}}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],89:[function(e,n,a){const o=e("../../base-xform"),s=e("../../composite-xform");class l extends o{get tag(){return"x14:id"}render(u,p){u.leafNode(this.tag,null,p)}parseOpen(){this.model=""}parseText(u){this.model+=u}parseClose(u){return u!==this.tag}}class c extends s{constructor(){super(),this.map={"x14:id":this.idXform=new l}}get tag(){return"ext"}render(u,p){u.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(u,p.x14Id),u.closeNode()}createNewModel(){return{}}onParserClose(u,p){this.model.x14Id=p.model}}n.exports=class extends s{constructor(){super(),this.map={ext:new c}}get tag(){return"extLst"}render(i,u){i.openNode(this.tag),this.map.ext.render(i,u),i.closeNode()}createNewModel(){return{}}onParserClose(i,u){Object.assign(this.model,u.model)}}},{"../../base-xform":32,"../../composite-xform":48}],90:[function(e,n,a){const o=e("../../base-xform");n.exports=class extends o{get tag(){return"formula"}render(s,l){s.leafNode(this.tag,null,l)}parseOpen(){this.model=""}parseText(s){this.model+=s}parseClose(s){return s!==this.tag}}},{"../../base-xform":32}],91:[function(e,n,a){const o=e("../../base-xform"),s=e("../../composite-xform"),l=e("./cfvo-xform");n.exports=class extends s{constructor(){super(),this.map={cfvo:this.cfvoXform=new l}}get tag(){return"iconSet"}render(c,i){c.openNode(this.tag,{iconSet:o.toStringAttribute(i.iconSet,"3TrafficLights"),reverse:o.toBoolAttribute(i.reverse,!1),showValue:o.toBoolAttribute(i.showValue,!0)}),i.cfvo.forEach(u=>{this.cfvoXform.render(c,u)}),c.closeNode()}createNewModel(c){let{attributes:i}=c;return{iconSet:o.toStringValue(i.iconSet,"3TrafficLights"),reverse:o.toBoolValue(i.reverse),showValue:o.toBoolValue(i.showValue),cfvo:[]}}onParserClose(c,i){this.model[c].push(i.model)}}},{"../../base-xform":32,"../../composite-xform":48,"./cfvo-xform":84}],92:[function(e,n,a){const o=e("../../../utils/utils"),s=e("../base-xform");n.exports=class extends s{get tag(){return"col"}prepare(l,c){const i=c.styles.addStyleModel(l.style||{});i&&(l.styleId=i)}render(l,c){l.openNode("col"),l.addAttribute("min",c.min),l.addAttribute("max",c.max),c.width&&l.addAttribute("width",c.width),c.styleId&&l.addAttribute("style",c.styleId),c.hidden&&l.addAttribute("hidden","1"),c.bestFit&&l.addAttribute("bestFit","1"),c.outlineLevel&&l.addAttribute("outlineLevel",c.outlineLevel),c.collapsed&&l.addAttribute("collapsed","1"),l.addAttribute("customWidth","1"),l.closeNode()}parseOpen(l){if(l.name==="col"){const c=this.model={min:parseInt(l.attributes.min||"0",10),max:parseInt(l.attributes.max||"0",10),width:l.attributes.width===void 0?void 0:parseFloat(l.attributes.width||"0")};return l.attributes.style&&(c.styleId=parseInt(l.attributes.style,10)),o.parseBoolean(l.attributes.hidden)&&(c.hidden=!0),o.parseBoolean(l.attributes.bestFit)&&(c.bestFit=!0),l.attributes.outlineLevel&&(c.outlineLevel=parseInt(l.attributes.outlineLevel,10)),o.parseBoolean(l.attributes.collapsed)&&(c.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(l,c){l.styleId&&(l.style=c.styles.getStyleModel(l.styleId))}}},{"../../../utils/utils":27,"../base-xform":32}],93:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../../../utils/utils"),l=e("../../../utils/col-cache"),c=e("../base-xform"),i=e("../../../doc/range");function u(f,h,v,b){const g=h[v];g!==void 0?f[v]=g:b!==void 0&&(f[v]=b)}function p(f,h,v,b){const g=h[v];g!==void 0&&(f[v]=s.parseBoolean(g))}n.exports=class extends c{get tag(){return"dataValidations"}render(f,h){const v=function(b){const g=o.map(b,(E,N)=>({address:N,dataValidation:E,marked:!1})).sort((E,N)=>o.strcmp(E.address,N.address)),x=o.keyBy(g,"address"),y=(E,N,I)=>{for(let L=0;L<N;L++){const H=l.encodeAddress(E.row+L,I);if(!b[H]||!o.isEqual(b[E.address],b[H]))return!1}return!0};return g.map(E=>{if(!E.marked){const N=l.decodeEx(E.address);if(N.dimensions)return x[N.dimensions].marked=!0,{...E.dataValidation,sqref:E.address};let I=1,L=l.encodeAddress(N.row+I,N.col);for(;b[L]&&o.isEqual(E.dataValidation,b[L]);)I++,L=l.encodeAddress(N.row+I,N.col);let H=1;for(;y(N,I,N.col+H);)H++;for(let V=0;V<I;V++)for(let q=0;q<H;q++)L=l.encodeAddress(N.row+V,N.col+q),x[L].marked=!0;if(I>1||H>1){const V=N.row+(I-1),q=N.col+(H-1);return{...E.dataValidation,sqref:`${E.address}:${l.encodeAddress(V,q)}`}}return{...E.dataValidation,sqref:E.address}}return null}).filter(Boolean)}(h);v.length&&(f.openNode("dataValidations",{count:v.length}),v.forEach(b=>{f.openNode("dataValidation"),b.type!=="any"&&(f.addAttribute("type",b.type),b.operator&&b.type!=="list"&&b.operator!=="between"&&f.addAttribute("operator",b.operator),b.allowBlank&&f.addAttribute("allowBlank","1")),b.showInputMessage&&f.addAttribute("showInputMessage","1"),b.promptTitle&&f.addAttribute("promptTitle",b.promptTitle),b.prompt&&f.addAttribute("prompt",b.prompt),b.showErrorMessage&&f.addAttribute("showErrorMessage","1"),b.errorStyle&&f.addAttribute("errorStyle",b.errorStyle),b.errorTitle&&f.addAttribute("errorTitle",b.errorTitle),b.error&&f.addAttribute("error",b.error),f.addAttribute("sqref",b.sqref),(b.formulae||[]).forEach((g,x)=>{f.openNode("formula"+(x+1)),b.type==="date"?f.writeText(s.dateToExcel(new Date(g))):f.writeText(g),f.closeNode()}),f.closeNode()}),f.closeNode())}parseOpen(f){switch(f.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=f.attributes.sqref;const h={type:f.attributes.type||"any",formulae:[]};switch(f.attributes.type&&p(h,f.attributes,"allowBlank"),p(h,f.attributes,"showInputMessage"),p(h,f.attributes,"showErrorMessage"),h.type){case"any":case"list":case"custom":break;default:u(h,f.attributes,"operator","between")}return u(h,f.attributes,"promptTitle"),u(h,f.attributes,"prompt"),u(h,f.attributes,"errorStyle"),u(h,f.attributes,"errorTitle"),u(h,f.attributes,"error"),this._dataValidation=h,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(f){this._formula&&this._formula.push(f)}parseClose(f){switch(f){case"dataValidations":return!1;case"dataValidation":return this._dataValidation.formulae&&this._dataValidation.formulae.length||(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(h=>{h.includes(":")?new i(h).forEachAddress(v=>{this.model[v]=this._dataValidation}):this.model[h]=this._dataValidation}),!0;case"formula1":case"formula2":{let h=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":h=parseInt(h,10);break;case"decimal":h=parseFloat(h);break;case"date":h=s.excelToDate(parseFloat(h))}return this._dataValidation.formulae.push(h),this._formula=void 0,!0}default:return!0}}}},{"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/utils":27,"../base-xform":32}],94:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"dimension"}render(s,l){l&&s.leafNode("dimension",{ref:l})}parseOpen(s){return s.name==="dimension"&&(this.model=s.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],95:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"drawing"}render(s,l){l&&s.leafNode(this.tag,{"r:id":l.rId})}parseOpen(s){switch(s.name){case this.tag:return this.model={rId:s.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],96:[function(e,n,a){const o=e("../composite-xform"),s=e("./cf-ext/conditional-formattings-ext-xform");class l extends o{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new s}}get tag(){return"ext"}hasContent(i){return this.conditionalFormattings.hasContent(i.conditionalFormattings)}prepare(i,u){this.conditionalFormattings.prepare(i.conditionalFormattings,u)}render(i,u){i.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(i,u.conditionalFormattings),i.closeNode()}createNewModel(){return{}}onParserClose(i,u){this.model[i]=u.model}}n.exports=class extends o{constructor(){super(),this.map={ext:this.ext=new l}}get tag(){return"extLst"}prepare(c,i){this.ext.prepare(c,i)}hasContent(c){return this.ext.hasContent(c)}render(c,i){this.hasContent(i)&&(c.openNode("extLst"),this.ext.render(c,i),c.closeNode())}createNewModel(){return{}}onParserClose(c,i){Object.assign(this.model,i.model)}}},{"../composite-xform":48,"./cf-ext/conditional-formattings-ext-xform":78}],97:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"headerFooter"}render(s,l){if(l){s.addRollback();let c=!1;s.openNode("headerFooter"),l.differentFirst&&(s.addAttribute("differentFirst","1"),c=!0),l.differentOddEven&&(s.addAttribute("differentOddEven","1"),c=!0),l.oddHeader&&typeof l.oddHeader=="string"&&(s.leafNode("oddHeader",null,l.oddHeader),c=!0),l.oddFooter&&typeof l.oddFooter=="string"&&(s.leafNode("oddFooter",null,l.oddFooter),c=!0),l.evenHeader&&typeof l.evenHeader=="string"&&(s.leafNode("evenHeader",null,l.evenHeader),c=!0),l.evenFooter&&typeof l.evenFooter=="string"&&(s.leafNode("evenFooter",null,l.evenFooter),c=!0),l.firstHeader&&typeof l.firstHeader=="string"&&(s.leafNode("firstHeader",null,l.firstHeader),c=!0),l.firstFooter&&typeof l.firstFooter=="string"&&(s.leafNode("firstFooter",null,l.firstFooter),c=!0),c?(s.closeNode(),s.commit()):s.rollback()}}parseOpen(s){switch(s.name){case"headerFooter":return this.model={},s.attributes.differentFirst&&(this.model.differentFirst=parseInt(s.attributes.differentFirst,0)===1),s.attributes.differentOddEven&&(this.model.differentOddEven=parseInt(s.attributes.differentOddEven,0)===1),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(s){switch(this.currentNode){case"oddHeader":this.model.oddHeader=s;break;case"oddFooter":this.model.oddFooter=s;break;case"evenHeader":this.model.evenHeader=s;break;case"evenFooter":this.model.evenFooter=s;break;case"firstHeader":this.model.firstHeader=s;break;case"firstFooter":this.model.firstFooter=s}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}}},{"../base-xform":32}],98:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"hyperlink"}render(s,l){this.isInternalLink(l)?s.leafNode("hyperlink",{ref:l.address,"r:id":l.rId,tooltip:l.tooltip,location:l.target}):s.leafNode("hyperlink",{ref:l.address,"r:id":l.rId,tooltip:l.tooltip})}parseOpen(s){return s.name==="hyperlink"&&(this.model={address:s.attributes.ref,rId:s.attributes["r:id"],tooltip:s.attributes.tooltip},s.attributes.location&&(this.model.target=s.attributes.location),!0)}parseText(){}parseClose(){return!1}isInternalLink(s){return s.target&&/^[^!]+![a-zA-Z]+[\d]+$/.test(s.target)}}},{"../base-xform":32}],99:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"mergeCell"}render(s,l){s.leafNode("mergeCell",{ref:l})}parseOpen(s){return s.name==="mergeCell"&&(this.model=s.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],100:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../../../doc/range"),l=e("../../../utils/col-cache"),c=e("../../../doc/enums");n.exports=class{constructor(){this.merges={}}add(i){if(this.merges[i.master])this.merges[i.master].expandToAddress(i.address);else{const u=`${i.master}:${i.address}`;this.merges[i.master]=new s(u)}}get mergeCells(){return o.map(this.merges,i=>i.range)}reconcile(i,u){o.each(i,p=>{const f=l.decode(p);for(let h=f.top;h<=f.bottom;h++){const v=u[h-1];for(let b=f.left;b<=f.right;b++){const g=v.cells[b-1];g?g.type===c.ValueType.Merge&&(g.master=f.tl):v.cells[b]={type:c.ValueType.Null,address:l.encodeAddress(h,b)}}}})}getMasterAddress(i){const u=this.hash[i];return u&&u.tl}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26}],101:[function(e,n,a){const o=e("../base-xform"),s=l=>l!==void 0;n.exports=class extends o{get tag(){return"outlinePr"}render(l,c){return!(!c||!s(c.summaryBelow)&&!s(c.summaryRight))&&(l.leafNode(this.tag,{summaryBelow:s(c.summaryBelow)?Number(c.summaryBelow):void 0,summaryRight:s(c.summaryRight)?Number(c.summaryRight):void 0}),!0)}parseOpen(l){return l.name===this.tag&&(this.model={summaryBelow:s(l.attributes.summaryBelow)?!!Number(l.attributes.summaryBelow):void 0,summaryRight:s(l.attributes.summaryRight)?!!Number(l.attributes.summaryRight):void 0},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],102:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"brk"}render(s,l){s.leafNode("brk",l)}parseOpen(s){return s.name==="brk"&&(this.model=s.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],103:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../base-xform");n.exports=class extends s{get tag(){return"pageMargins"}render(l,c){if(c){const i={left:c.left,right:c.right,top:c.top,bottom:c.bottom,header:c.header,footer:c.footer};o.some(i,u=>u!==void 0)&&l.leafNode(this.tag,i)}}parseOpen(l){switch(l.name){case this.tag:return this.model={left:parseFloat(l.attributes.left||.7),right:parseFloat(l.attributes.right||.7),top:parseFloat(l.attributes.top||.75),bottom:parseFloat(l.attributes.bottom||.75),header:parseFloat(l.attributes.header||.3),footer:parseFloat(l.attributes.footer||.3)},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],104:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"pageSetUpPr"}render(s,l){return!(!l||!l.fitToPage)&&(s.leafNode(this.tag,{fitToPage:l.fitToPage?"1":void 0}),!0)}parseOpen(s){return s.name===this.tag&&(this.model={fitToPage:s.attributes.fitToPage==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],105:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../base-xform");function l(p){return p?"1":void 0}function c(p){switch(p){case"overThenDown":return p;default:return}}function i(p){switch(p){case"atEnd":case"asDisplyed":return p;default:return}}function u(p){switch(p){case"dash":case"blank":case"NA":return p;default:return}}n.exports=class extends s{get tag(){return"pageSetup"}render(p,f){if(f){const h={paperSize:f.paperSize,orientation:f.orientation,horizontalDpi:f.horizontalDpi,verticalDpi:f.verticalDpi,pageOrder:c(f.pageOrder),blackAndWhite:l(f.blackAndWhite),draft:l(f.draft),cellComments:i(f.cellComments),errors:u(f.errors),scale:f.scale,fitToWidth:f.fitToWidth,fitToHeight:f.fitToHeight,firstPageNumber:f.firstPageNumber,useFirstPageNumber:l(f.firstPageNumber),usePrinterDefaults:l(f.usePrinterDefaults),copies:f.copies};o.some(h,v=>v!==void 0)&&p.leafNode(this.tag,h)}}parseOpen(p){switch(p.name){case this.tag:return this.model={paperSize:(f=p.attributes.paperSize,f!==void 0?parseInt(f,10):void 0),orientation:p.attributes.orientation||"portrait",horizontalDpi:parseInt(p.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(p.attributes.verticalDpi||"4294967295",10),pageOrder:p.attributes.pageOrder||"downThenOver",blackAndWhite:p.attributes.blackAndWhite==="1",draft:p.attributes.draft==="1",cellComments:p.attributes.cellComments||"None",errors:p.attributes.errors||"displayed",scale:parseInt(p.attributes.scale||"100",10),fitToWidth:parseInt(p.attributes.fitToWidth||"1",10),fitToHeight:parseInt(p.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(p.attributes.firstPageNumber||"1",10),useFirstPageNumber:p.attributes.useFirstPageNumber==="1",usePrinterDefaults:p.attributes.usePrinterDefaults==="1",copies:parseInt(p.attributes.copies||"1",10)},!0;default:return!1}var f}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],106:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"picture"}render(s,l){l&&s.leafNode(this.tag,{"r:id":l.rId})}parseOpen(s){switch(s.name){case this.tag:return this.model={rId:s.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],107:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../base-xform");function l(c){return c?"1":void 0}n.exports=class extends s{get tag(){return"printOptions"}render(c,i){if(i){const u={headings:l(i.showRowColHeaders),gridLines:l(i.showGridLines),horizontalCentered:l(i.horizontalCentered),verticalCentered:l(i.verticalCentered)};o.some(u,p=>p!==void 0)&&c.leafNode(this.tag,u)}}parseOpen(c){switch(c.name){case this.tag:return this.model={showRowColHeaders:c.attributes.headings==="1",showGridLines:c.attributes.gridLines==="1",horizontalCentered:c.attributes.horizontalCentered==="1",verticalCentered:c.attributes.verticalCentered==="1"},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],108:[function(e,n,a){const o=e("./page-breaks-xform"),s=e("../list-xform");n.exports=class extends s{constructor(){super({tag:"rowBreaks",count:!0,childXform:new o})}render(l,c){if(c&&c.length){l.openNode(this.tag,this.$),this.count&&(l.addAttribute(this.$count,c.length),l.addAttribute("manualBreakCount",c.length));const{childXform:i}=this;c.forEach(u=>{i.render(l,u)}),l.closeNode()}else this.empty&&l.leafNode(this.tag)}}},{"../list-xform":71,"./page-breaks-xform":102}],109:[function(e,n,a){const o=e("../base-xform"),s=e("../../../utils/utils"),l=e("./cell-xform");n.exports=class extends o{constructor(c){super(),this.maxItems=c&&c.maxItems,this.map={c:new l}}get tag(){return"row"}prepare(c,i){const u=i.styles.addStyleModel(c.style);u&&(c.styleId=u);const p=this.map.c;c.cells.forEach(f=>{p.prepare(f,i)})}render(c,i,u){c.openNode("row"),c.addAttribute("r",i.number),i.height&&(c.addAttribute("ht",i.height),c.addAttribute("customHeight","1")),i.hidden&&c.addAttribute("hidden","1"),i.min>0&&i.max>0&&i.min<=i.max&&c.addAttribute("spans",`${i.min}:${i.max}`),i.styleId&&(c.addAttribute("s",i.styleId),c.addAttribute("customFormat","1")),c.addAttribute("x14ac:dyDescent","0.25"),i.outlineLevel&&c.addAttribute("outlineLevel",i.outlineLevel),i.collapsed&&c.addAttribute("collapsed","1");const p=this.map.c;i.cells.forEach(f=>{p.render(c,f,u)}),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;if(c.name==="row"){this.numRowsSeen+=1;const i=c.attributes.spans?c.attributes.spans.split(":").map(p=>parseInt(p,10)):[void 0,void 0],u=this.model={number:parseInt(c.attributes.r,10),min:i[0],max:i[1],cells:[]};return c.attributes.s&&(u.styleId=parseInt(c.attributes.s,10)),s.parseBoolean(c.attributes.hidden)&&(u.hidden=!0),s.parseBoolean(c.attributes.bestFit)&&(u.bestFit=!0),c.attributes.ht&&(u.height=parseFloat(c.attributes.ht)),c.attributes.outlineLevel&&(u.outlineLevel=parseInt(c.attributes.outlineLevel,10)),s.parseBoolean(c.attributes.collapsed)&&(u.collapsed=!0),!0}return this.parser=this.map[c.name],!!this.parser&&(this.parser.parseOpen(c),!0)}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser){if(!this.parser.parseClose(c)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw new Error(`Max column count (${this.maxItems}) exceeded`);this.parser=void 0}return!0}return!1}reconcile(c,i){c.style=c.styleId?i.styles.getStyleModel(c.styleId):{},c.styleId!==void 0&&(c.styleId=void 0);const u=this.map.c;c.cells.forEach(p=>{u.reconcile(p,i)})}}},{"../../../utils/utils":27,"../base-xform":32,"./cell-xform":73}],110:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../base-xform");n.exports=class extends s{get tag(){return"sheetFormatPr"}render(l,c){if(c){const i={defaultRowHeight:c.defaultRowHeight,outlineLevelRow:c.outlineLevelRow,outlineLevelCol:c.outlineLevelCol,"x14ac:dyDescent":c.dyDescent};c.defaultColWidth&&(i.defaultColWidth=c.defaultColWidth),c.defaultRowHeight&&c.defaultRowHeight===15||(i.customHeight="1"),o.some(i,u=>u!==void 0)&&l.leafNode("sheetFormatPr",i)}}parseOpen(l){return l.name==="sheetFormatPr"&&(this.model={defaultRowHeight:parseFloat(l.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(l.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(l.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(l.attributes.outlineLevelCol||"0",10)},l.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(l.attributes.defaultColWidth)),!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],111:[function(e,n,a){const o=e("../base-xform"),s=e("../style/color-xform"),l=e("./page-setup-properties-xform"),c=e("./outline-properties-xform");n.exports=class extends o{constructor(){super(),this.map={tabColor:new s("tabColor"),pageSetUpPr:new l,outlinePr:new c}}get tag(){return"sheetPr"}render(i,u){if(u){i.addRollback(),i.openNode("sheetPr");let p=!1;p=this.map.tabColor.render(i,u.tabColor)||p,p=this.map.pageSetUpPr.render(i,u.pageSetup)||p,p=this.map.outlinePr.render(i,u.outlineProperties)||p,p?(i.closeNode(),i.commit()):i.rollback()}}parseOpen(i){return this.parser?(this.parser.parseOpen(i),!0):i.name===this.tag?(this.reset(),!0):!!this.map[i.name]&&(this.parser=this.map[i.name],this.parser.parseOpen(i),!0)}parseText(i){return!!this.parser&&(this.parser.parseText(i),!0)}parseClose(i){return this.parser?(this.parser.parseClose(i)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}}},{"../base-xform":32,"../style/color-xform":128,"./outline-properties-xform":101,"./page-setup-properties-xform":104}],112:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../base-xform");function l(i,u){return i?u:void 0}function c(i,u){return i===u||void 0}n.exports=class extends s{get tag(){return"sheetProtection"}render(i,u){if(u){const p={sheet:l(u.sheet,"1"),selectLockedCells:u.selectLockedCells===!1?"1":void 0,selectUnlockedCells:u.selectUnlockedCells===!1?"1":void 0,formatCells:l(u.formatCells,"0"),formatColumns:l(u.formatColumns,"0"),formatRows:l(u.formatRows,"0"),insertColumns:l(u.insertColumns,"0"),insertRows:l(u.insertRows,"0"),insertHyperlinks:l(u.insertHyperlinks,"0"),deleteColumns:l(u.deleteColumns,"0"),deleteRows:l(u.deleteRows,"0"),sort:l(u.sort,"0"),autoFilter:l(u.autoFilter,"0"),pivotTables:l(u.pivotTables,"0")};u.sheet&&(p.algorithmName=u.algorithmName,p.hashValue=u.hashValue,p.saltValue=u.saltValue,p.spinCount=u.spinCount,p.objects=l(u.objects===!1,"1"),p.scenarios=l(u.scenarios===!1,"1")),o.some(p,f=>f!==void 0)&&i.leafNode(this.tag,p)}}parseOpen(i){switch(i.name){case this.tag:return this.model={sheet:c(i.attributes.sheet,"1"),objects:i.attributes.objects!=="1"&&void 0,scenarios:i.attributes.scenarios!=="1"&&void 0,selectLockedCells:i.attributes.selectLockedCells!=="1"&&void 0,selectUnlockedCells:i.attributes.selectUnlockedCells!=="1"&&void 0,formatCells:c(i.attributes.formatCells,"0"),formatColumns:c(i.attributes.formatColumns,"0"),formatRows:c(i.attributes.formatRows,"0"),insertColumns:c(i.attributes.insertColumns,"0"),insertRows:c(i.attributes.insertRows,"0"),insertHyperlinks:c(i.attributes.insertHyperlinks,"0"),deleteColumns:c(i.attributes.deleteColumns,"0"),deleteRows:c(i.attributes.deleteRows,"0"),sort:c(i.attributes.sort,"0"),autoFilter:c(i.attributes.autoFilter,"0"),pivotTables:c(i.attributes.pivotTables,"0")},i.attributes.algorithmName&&(this.model.algorithmName=i.attributes.algorithmName,this.model.hashValue=i.attributes.hashValue,this.model.saltValue=i.attributes.saltValue,this.model.spinCount=parseInt(i.attributes.spinCount,10)),!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],113:[function(e,n,a){const o=e("../../../utils/col-cache"),s=e("../base-xform"),l={frozen:"frozen",frozenSplit:"frozen",split:"split"};n.exports=class extends s{get tag(){return"sheetView"}prepare(c){switch(c.state){case"frozen":case"split":break;default:c.state="normal"}}render(c,i){c.openNode("sheetView",{workbookViewId:i.workbookViewId||0});const u=function(b,g,x){x&&c.addAttribute(b,g)};let p,f,h,v;switch(u("rightToLeft","1",i.rightToLeft===!0),u("tabSelected","1",i.tabSelected),u("showRuler","0",i.showRuler===!1),u("showRowColHeaders","0",i.showRowColHeaders===!1),u("showGridLines","0",i.showGridLines===!1),u("zoomScale",i.zoomScale,i.zoomScale),u("zoomScaleNormal",i.zoomScaleNormal,i.zoomScaleNormal),u("view",i.style,i.style),i.state){case"frozen":f=i.xSplit||0,h=i.ySplit||0,p=i.topLeftCell||o.getAddress(h+1,f+1).address,v=(i.xSplit&&i.ySplit?"bottomRight":i.xSplit&&"topRight")||"bottomLeft",c.leafNode("pane",{xSplit:i.xSplit||void 0,ySplit:i.ySplit||void 0,topLeftCell:p,activePane:v,state:"frozen"}),c.leafNode("selection",{pane:v,activeCell:i.activeCell,sqref:i.activeCell});break;case"split":i.activePane==="topLeft"&&(i.activePane=void 0),c.leafNode("pane",{xSplit:i.xSplit||void 0,ySplit:i.ySplit||void 0,topLeftCell:i.topLeftCell,activePane:i.activePane}),c.leafNode("selection",{pane:i.activePane,activeCell:i.activeCell,sqref:i.activeCell});break;case"normal":i.activeCell&&c.leafNode("selection",{activeCell:i.activeCell,sqref:i.activeCell})}c.closeNode()}parseOpen(c){switch(c.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(c.attributes.workbookViewId,10),rightToLeft:c.attributes.rightToLeft==="1",tabSelected:c.attributes.tabSelected==="1",showRuler:c.attributes.showRuler!=="0",showRowColHeaders:c.attributes.showRowColHeaders!=="0",showGridLines:c.attributes.showGridLines!=="0",zoomScale:parseInt(c.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(c.attributes.zoomScaleNormal||"100",10),style:c.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(c.attributes.xSplit||"0",10),ySplit:parseInt(c.attributes.ySplit||"0",10),topLeftCell:c.attributes.topLeftCell,activePane:c.attributes.activePane||"topLeft",state:c.attributes.state},!0;case"selection":{const i=c.attributes.pane||"topLeft";return this.selections[i]={pane:i,activeCell:c.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(c){let i,u;switch(c){case"sheetView":return this.sheetView&&this.pane?(i=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:l[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},this.model.state==="split"&&(i.activePane=this.pane.activePane),u=this.selections[this.pane.activePane],u&&u.activeCell&&(i.activeCell=u.activeCell),this.sheetView.style&&(i.style=this.sheetView.style)):(i=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},u=this.selections.topLeft,u&&u.activeCell&&(i.activeCell=u.activeCell),this.sheetView.style&&(i.style=this.sheetView.style)),!1;default:return!0}}reconcile(){}}},{"../../../utils/col-cache":19,"../base-xform":32}],114:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"tablePart"}render(s,l){l&&s.leafNode(this.tag,{"r:id":l.rId})}parseOpen(s){switch(s.name){case this.tag:return this.model={rId:s.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],115:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../../../utils/col-cache"),l=e("../../../utils/xml-stream"),c=e("../../rel-type"),i=e("./merges"),u=e("../base-xform"),p=e("../list-xform"),f=e("./row-xform"),h=e("./col-xform"),v=e("./dimension-xform"),b=e("./hyperlink-xform"),g=e("./merge-cell-xform"),x=e("./data-validations-xform"),y=e("./sheet-properties-xform"),E=e("./sheet-format-properties-xform"),N=e("./sheet-view-xform"),I=e("./sheet-protection-xform"),L=e("./page-margins-xform"),H=e("./page-setup-xform"),V=e("./print-options-xform"),q=e("./auto-filter-xform"),K=e("./picture-xform"),z=e("./drawing-xform"),W=e("./table-part-xform"),D=e("./row-breaks-xform"),M=e("./header-footer-xform"),C=e("./cf/conditional-formattings-xform"),w=e("./ext-lst-xform"),T=(S,j)=>{if(!j||!j.length)return S;if(!S||!S.length)return j;const B={},R={};return S.forEach(X=>{B[X.ref]=X,X.rules.forEach(Y=>{const{x14Id:ee}=Y;ee&&(R[ee]=Y)})}),j.forEach(X=>{X.rules.forEach(Y=>{const ee=R[Y.x14Id];ee?((U,Q)=>{Object.keys(Q).forEach(P=>{const F=U[P],Z=Q[P];F===void 0&&Z!==void 0&&(U[P]=Z)})})(ee,Y):B[X.ref]?B[X.ref].rules.push(Y):S.push({ref:X.ref,rules:[Y]})})}),S};class A extends u{constructor(j){super();const{maxRows:B,maxCols:R,ignoreNodes:X}=j||{};this.ignoreNodes=X||[],this.map={sheetPr:new y,dimension:new v,sheetViews:new p({tag:"sheetViews",count:!1,childXform:new N}),sheetFormatPr:new E,cols:new p({tag:"cols",count:!1,childXform:new h}),sheetData:new p({tag:"sheetData",count:!1,empty:!0,childXform:new f({maxItems:R}),maxItems:B}),autoFilter:new q,mergeCells:new p({tag:"mergeCells",count:!0,childXform:new g}),rowBreaks:new D,hyperlinks:new p({tag:"hyperlinks",count:!1,childXform:new b}),pageMargins:new L,dataValidations:new x,pageSetup:new H,headerFooter:new M,printOptions:new V,picture:new K,drawing:new z,sheetProtection:new I,tableParts:new p({tag:"tableParts",count:!0,childXform:new W}),conditionalFormatting:new C,extLst:new w}}prepare(j,B){B.merges=new i,j.hyperlinks=B.hyperlinks=[],j.comments=B.comments=[],B.formulae={},B.siFormulae=0,this.map.cols.prepare(j.cols,B),this.map.sheetData.prepare(j.rows,B),this.map.conditionalFormatting.prepare(j.conditionalFormattings,B),j.mergeCells=B.merges.mergeCells;const R=j.rels=[];function X(U){return"rId"+(U.length+1)}if(j.hyperlinks.forEach(U=>{const Q=X(R);U.rId=Q,R.push({Id:Q,Type:c.Hyperlink,Target:U.target,TargetMode:"External"})}),j.comments.length>0){const U={Id:X(R),Type:c.Comments,Target:`../comments${j.id}.xml`};R.push(U);const Q={Id:X(R),Type:c.VmlDrawing,Target:`../drawings/vmlDrawing${j.id}.vml`};R.push(Q),j.comments.forEach(P=>{P.refAddress=s.decodeAddress(P.ref)}),B.commentRefs.push({commentName:"comments"+j.id,vmlDrawing:"vmlDrawing"+j.id})}const Y=[];let ee;j.media.forEach(U=>{if(U.type==="background"){const Q=X(R);ee=B.media[U.imageId],R.push({Id:Q,Type:c.Image,Target:`../media/${ee.name}.${ee.extension}`}),j.background={rId:Q},j.image=B.media[U.imageId]}else if(U.type==="image"){let{drawing:Q}=j;ee=B.media[U.imageId],Q||(Q=j.drawing={rId:X(R),name:"drawing"+ ++B.drawingsCount,anchors:[],rels:[]},B.drawings.push(Q),R.push({Id:Q.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/${Q.name}.xml`}));let P=this.preImageId===U.imageId?Y[U.imageId]:Y[Q.rels.length];P||(P=X(Q.rels),Y[Q.rels.length]=P,Q.rels.push({Id:P,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/${ee.name}.${ee.extension}`}));const F={picture:{rId:P},range:U.range};if(U.hyperlinks&&U.hyperlinks.hyperlink){const Z=X(Q.rels);Y[Q.rels.length]=Z,F.picture.hyperlinks={tooltip:U.hyperlinks.tooltip,rId:Z},Q.rels.push({Id:Z,Type:c.Hyperlink,Target:U.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=U.imageId,Q.anchors.push(F)}}),j.tables.forEach(U=>{const Q=X(R);U.rId=Q,R.push({Id:Q,Type:c.Table,Target:"../tables/"+U.target}),U.columns.forEach(P=>{const{style:F}=P;F&&(P.dxfId=B.styles.addDxfStyle(F))})}),this.map.extLst.prepare(j,B)}render(j,B){j.openXml(l.StdDocAttributes),j.openNode("worksheet",A.WORKSHEET_ATTRIBUTES);const R=B.properties?{defaultRowHeight:B.properties.defaultRowHeight,dyDescent:B.properties.dyDescent,outlineLevelCol:B.properties.outlineLevelCol,outlineLevelRow:B.properties.outlineLevelRow}:void 0;B.properties&&B.properties.defaultColWidth&&(R.defaultColWidth=B.properties.defaultColWidth);const X={outlineProperties:B.properties&&B.properties.outlineProperties,tabColor:B.properties&&B.properties.tabColor,pageSetup:B.pageSetup&&B.pageSetup.fitToPage?{fitToPage:B.pageSetup.fitToPage}:void 0},Y=B.pageSetup&&B.pageSetup.margins,ee={showRowColHeaders:B.pageSetup&&B.pageSetup.showRowColHeaders,showGridLines:B.pageSetup&&B.pageSetup.showGridLines,horizontalCentered:B.pageSetup&&B.pageSetup.horizontalCentered,verticalCentered:B.pageSetup&&B.pageSetup.verticalCentered},U=B.sheetProtection;this.map.sheetPr.render(j,X),this.map.dimension.render(j,B.dimensions),this.map.sheetViews.render(j,B.views),this.map.sheetFormatPr.render(j,R),this.map.cols.render(j,B.cols),this.map.sheetData.render(j,B.rows),this.map.sheetProtection.render(j,U),this.map.autoFilter.render(j,B.autoFilter),this.map.mergeCells.render(j,B.mergeCells),this.map.conditionalFormatting.render(j,B.conditionalFormattings),this.map.dataValidations.render(j,B.dataValidations),this.map.hyperlinks.render(j,B.hyperlinks),this.map.printOptions.render(j,ee),this.map.pageMargins.render(j,Y),this.map.pageSetup.render(j,B.pageSetup),this.map.headerFooter.render(j,B.headerFooter),this.map.rowBreaks.render(j,B.rowBreaks),this.map.drawing.render(j,B.drawing),this.map.picture.render(j,B.background),this.map.tableParts.render(j,B.tables),this.map.extLst.render(j,B),B.rels&&B.rels.forEach(Q=>{Q.Type===c.VmlDrawing&&j.leafNode("legacyDrawing",{"r:id":Q.Id})}),j.closeNode()}parseOpen(j){return this.parser?(this.parser.parseOpen(j),!0):j.name==="worksheet"?(o.each(this.map,B=>{B.reset()}),!0):(this.map[j.name]&&!this.ignoreNodes.includes(j.name)&&(this.parser=this.map[j.name],this.parser.parseOpen(j)),!0)}parseText(j){this.parser&&this.parser.parseText(j)}parseClose(j){if(this.parser)return this.parser.parseClose(j)||(this.parser=void 0),!0;switch(j){case"worksheet":{const B=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(B.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(B.outlineProperties=this.map.sheetPr.model.outlineProperties);const R={fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},X=Object.assign(R,this.map.pageSetup.model,this.map.printOptions.model),Y=T(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:B,views:this.map.sheetViews.model,pageSetup:X,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:Y},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}default:return!0}}reconcile(j,B){const R=(j.relationships||[]).reduce((Y,ee)=>{if(Y[ee.Id]=ee,ee.Type===c.Comments&&(j.comments=B.comments[ee.Target].comments),ee.Type===c.VmlDrawing&&j.comments&&j.comments.length){const U=B.vmlDrawings[ee.Target].comments;j.comments.forEach((Q,P)=>{Q.note=Object.assign({},Q.note,U[P])})}return Y},{});if(B.commentsMap=(j.comments||[]).reduce((Y,ee)=>(ee.ref&&(Y[ee.ref]=ee),Y),{}),B.hyperlinkMap=(j.hyperlinks||[]).reduce((Y,ee)=>(ee.rId&&(Y[ee.address]=R[ee.rId].Target),Y),{}),B.formulae={},j.rows=j.rows&&j.rows.filter(Boolean)||[],j.rows.forEach(Y=>{Y.cells=Y.cells&&Y.cells.filter(Boolean)||[]}),this.map.cols.reconcile(j.cols,B),this.map.sheetData.reconcile(j.rows,B),this.map.conditionalFormatting.reconcile(j.conditionalFormattings,B),j.media=[],j.drawing){const Y=R[j.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(Y){const ee=Y[1];B.drawings[ee].anchors.forEach(U=>{if(U.medium){const Q={type:"image",imageId:U.medium.index,range:U.range,hyperlinks:U.picture.hyperlinks};j.media.push(Q)}})}}const X=j.background&&R[j.background.rId];if(X){const Y=X.Target.split("/media/")[1],ee=B.mediaIndex&&B.mediaIndex[Y];ee!==void 0&&j.media.push({type:"background",imageId:ee})}j.tables=(j.tables||[]).map(Y=>{const ee=R[Y.rId];return B.tables[ee.Target]}),delete j.relationships,delete j.hyperlinks,delete j.comments}}A.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},n.exports=A},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../../rel-type":31,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":72,"./cf/conditional-formattings-xform":87,"./col-xform":92,"./data-validations-xform":93,"./dimension-xform":94,"./drawing-xform":95,"./ext-lst-xform":96,"./header-footer-xform":97,"./hyperlink-xform":98,"./merge-cell-xform":99,"./merges":100,"./page-margins-xform":103,"./page-setup-xform":105,"./picture-xform":106,"./print-options-xform":107,"./row-breaks-xform":108,"./row-xform":109,"./sheet-format-properties-xform":110,"./sheet-properties-xform":111,"./sheet-protection-xform":112,"./sheet-view-xform":113,"./table-part-xform":114}],116:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.attr=s.attr}render(s,l){l&&(s.openNode(this.tag),s.closeNode())}parseOpen(s){s.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],117:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.attr=s.attr,this.attrs=s.attrs,this._format=s.format||function(l){try{return Number.isNaN(l.getTime())?"":l.toISOString()}catch{return""}},this._parse=s.parse||function(l){return new Date(l)}}render(s,l){l&&(s.openNode(this.tag),this.attrs&&s.addAttributes(this.attrs),this.attr?s.addAttribute(this.attr,this._format(l)):s.writeText(this._format(l)),s.closeNode())}parseOpen(s){s.name===this.tag&&(this.attr?this.model=this._parse(s.attributes[this.attr]):this.text=[])}parseText(s){this.attr||this.text.push(s)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}}},{"../base-xform":32}],118:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.attr=s.attr,this.attrs=s.attrs,this.zero=s.zero}render(s,l){(l||this.zero)&&(s.openNode(this.tag),this.attrs&&s.addAttributes(this.attrs),this.attr?s.addAttribute(this.attr,l):s.writeText(l),s.closeNode())}parseOpen(s){return s.name===this.tag&&(this.attr?this.model=parseInt(s.attributes[this.attr],10):this.text=[],!0)}parseText(s){this.attr||this.text.push(s)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}}},{"../base-xform":32}],119:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.attr=s.attr,this.attrs=s.attrs}render(s,l){l!==void 0&&(s.openNode(this.tag),this.attrs&&s.addAttributes(this.attrs),this.attr?s.addAttribute(this.attr,l):s.writeText(l),s.closeNode())}parseOpen(s){s.name===this.tag&&(this.attr?this.model=s.attributes[this.attr]:this.text=[])}parseText(s){this.attr||this.text.push(s)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}}},{"../base-xform":32}],120:[function(e,n,a){const o=e("./base-xform"),s=e("../../utils/xml-stream");n.exports=class extends o{constructor(l){super(),this._model=l}render(l){if(!this._xml){const c=new s;(function i(u,p){u.openNode(p.tag,p.$),p.c&&p.c.forEach(f=>{i(u,f)}),p.t&&u.writeText(p.t),u.closeNode()})(c,this._model),this._xml=c.xml}l.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(l){switch(l){case this._model.tag:return!1;default:return!0}}}},{"../../utils/xml-stream":28,"./base-xform":32}],121:[function(e,n,a){const o=e("./text-xform"),s=e("./rich-text-xform"),l=e("../base-xform");n.exports=class extends l{constructor(){super(),this.map={r:new s,t:new o}}get tag(){return"rPh"}render(c,i){if(c.openNode(this.tag,{sb:i.sb||0,eb:i.eb||0}),i&&i.hasOwnProperty("richText")&&i.richText){const{r:u}=this.map;i.richText.forEach(p=>{u.render(c,p)})}else i&&this.map.t.render(c,i.text);c.closeNode()}parseOpen(c){const{name:i}=c;return this.parser?(this.parser.parseOpen(c),!0):i===this.tag?(this.model={sb:parseInt(c.attributes.sb,10),eb:parseInt(c.attributes.eb,10)},!0):(this.parser=this.map[i],!!this.parser&&(this.parser.parseOpen(c),!0))}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser){if(!this.parser.parseClose(c)){switch(c){case"r":{let i=this.model.richText;i||(i=this.model.richText=[]),i.push(this.parser.model);break}case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}switch(c){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./rich-text-xform":122,"./text-xform":125}],122:[function(e,n,a){const o=e("./text-xform"),s=e("../style/font-xform"),l=e("../base-xform");class c extends l{constructor(u){super(),this.model=u}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new o)}get fontXform(){return this._fontXform||(this._fontXform=new s(c.FONT_OPTIONS))}render(u,p){p=p||this.model,u.openNode("r"),p.font&&this.fontXform.render(u,p.font),this.textXform.render(u,p.text),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(u),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){switch(u){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(u),!0}}}c.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},n.exports=c},{"../base-xform":32,"../style/font-xform":131,"./text-xform":125}],123:[function(e,n,a){const o=e("./text-xform"),s=e("./rich-text-xform"),l=e("./phonetic-text-xform"),c=e("../base-xform");n.exports=class extends c{constructor(i){super(),this.model=i,this.map={r:new s,t:new o,rPh:new l}}get tag(){return"si"}render(i,u){i.openNode(this.tag),u&&u.hasOwnProperty("richText")&&u.richText?u.richText.length?u.richText.forEach(p=>{this.map.r.render(i,p)}):this.map.t.render(i,""):u!=null&&this.map.t.render(i,u),i.closeNode()}parseOpen(i){const{name:u}=i;return this.parser?(this.parser.parseOpen(i),!0):u===this.tag?(this.model={},!0):(this.parser=this.map[u],!!this.parser&&(this.parser.parseOpen(i),!0))}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser){if(!this.parser.parseClose(i)){switch(i){case"r":{let u=this.model.richText;u||(u=this.model.richText=[]),u.push(this.parser.model);break}case"t":this.model=this.parser.model}this.parser=void 0}return!0}switch(i){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./phonetic-text-xform":121,"./rich-text-xform":122,"./text-xform":125}],124:[function(e,n,a){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("./shared-string-xform");n.exports=class extends s{constructor(c){super(),this.model=c||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new l)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(c){return this.model.values[c]}add(c){return c.richText?this.addRichText(c):this.addText(c)}addText(c){let i=this.hash[c];return i===void 0&&(i=this.hash[c]=this.model.values.length,this.model.values.push(c)),this.model.count++,i}addRichText(c){const i=this.sharedStringXform.toXml(c);let u=this.rich[i];return u===void 0&&(u=this.rich[i]=this.model.values.length,this.model.values.push(c)),this.model.count++,u}render(c,i){i=i||this._values,c.openXml(o.StdDocAttributes),c.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:i.count,uniqueCount:i.values.length});const u=this.sharedStringXform;i.values.forEach(p=>{u.render(c,p)}),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(c),!0;default:throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(c))}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;switch(c){case"sst":return!1;default:throw new Error("Unexpected xml node in parseClose: "+c)}}}},{"../../../utils/xml-stream":28,"../base-xform":32,"./shared-string-xform":123}],125:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"t"}render(s,l){s.openNode("t"),/^\s|\n|\s$/.test(l)&&s.addAttribute("xml:space","preserve"),s.writeText(l),s.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,(s,l)=>String.fromCharCode(parseInt(l,16)))}parseOpen(s){switch(s.name){case"t":return this._text=[],!0;default:return!1}}parseText(s){this._text.push(s)}parseClose(){return!1}}},{"../base-xform":32}],126:[function(e,n,a){const o=e("../../../doc/enums"),s=e("../../../utils/utils"),l=e("../base-xform"),c={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce((u,p)=>(u[p]=!0,u),{}),horizontal(u){return this.horizontalValues[u]?u:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce((u,p)=>(u[p]=!0,u),{}),vertical(u){return u==="middle"?"center":this.verticalValues[u]?u:void 0},wrapText:u=>!!u||void 0,shrinkToFit:u=>!!u||void 0,textRotation(u){switch(u){case"vertical":return u;default:return(u=s.validInt(u))>=-90&&u<=90?u:void 0}},indent:u=>(u=s.validInt(u),Math.max(0,u)),readingOrder(u){switch(u){case"ltr":return o.ReadingOrder.LeftToRight;case"rtl":return o.ReadingOrder.RightToLeft;default:return}}},i={toXml(u){if(u=c.textRotation(u)){if(u==="vertical")return 255;const p=Math.round(u);if(p>=0&&p<=90)return p;if(p<0&&p>=-90)return 90-p}},toModel(u){const p=s.validInt(u);if(p!==void 0){if(p===255)return"vertical";if(p>=0&&p<=90)return p;if(p>90&&p<=180)return 90-p}}};n.exports=class extends l{get tag(){return"alignment"}render(u,p){u.addRollback(),u.openNode("alignment");let f=!1;function h(v,b){b&&(u.addAttribute(v,b),f=!0)}h("horizontal",c.horizontal(p.horizontal)),h("vertical",c.vertical(p.vertical)),h("wrapText",!!c.wrapText(p.wrapText)&&"1"),h("shrinkToFit",!!c.shrinkToFit(p.shrinkToFit)&&"1"),h("indent",c.indent(p.indent)),h("textRotation",i.toXml(p.textRotation)),h("readingOrder",c.readingOrder(p.readingOrder)),u.closeNode(),f?u.commit():u.rollback()}parseOpen(u){const p={};let f=!1;function h(v,b,g){v&&(p[b]=g,f=!0)}h(u.attributes.horizontal,"horizontal",u.attributes.horizontal),h(u.attributes.vertical,"vertical",u.attributes.vertical==="center"?"middle":u.attributes.vertical),h(u.attributes.wrapText,"wrapText",s.parseBoolean(u.attributes.wrapText)),h(u.attributes.shrinkToFit,"shrinkToFit",s.parseBoolean(u.attributes.shrinkToFit)),h(u.attributes.indent,"indent",parseInt(u.attributes.indent,10)),h(u.attributes.textRotation,"textRotation",i.toModel(u.attributes.textRotation)),h(u.attributes.readingOrder,"readingOrder",u.attributes.readingOrder==="2"?"rtl":"ltr"),this.model=f?p:null}parseText(){}parseClose(){return!1}}},{"../../../doc/enums":7,"../../../utils/utils":27,"../base-xform":32}],127:[function(e,n,a){const o=e("../base-xform"),s=e("../../../utils/utils"),l=e("./color-xform");class c extends o{constructor(u){super(),this.name=u,this.map={color:new l}}get tag(){return this.name}render(u,p,f){const h=p&&p.color||f||this.defaultColor;u.openNode(this.name),p&&p.style&&(u.addAttribute("style",p.style),h&&this.map.color.render(u,h)),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.name:{const{style:p}=u.attributes;return this.model=p?{style:p}:void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.parser=void 0),!0):(u===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(u){return c.validStyleValues[u]}}c.validStyleValues=["thin","dashed","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce((i,u)=>(i[u]=!0,i),{}),n.exports=class extends o{constructor(){super(),this.map={top:new c("top"),left:new c("left"),bottom:new c("bottom"),right:new c("right"),diagonal:new c("diagonal")}}render(i,u){const{color:p}=u;function f(h,v){h&&!h.color&&u.color&&(h={...h,color:u.color}),v.render(i,h,p)}i.openNode("border"),u.diagonal&&u.diagonal.style&&(u.diagonal.up&&i.addAttribute("diagonalUp","1"),u.diagonal.down&&i.addAttribute("diagonalDown","1")),f(u.left,this.map.left),f(u.right,this.map.right),f(u.top,this.map.top),f(u.bottom,this.map.bottom),f(u.diagonal,this.map.diagonal),i.closeNode()}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case"border":return this.reset(),this.diagonalUp=s.parseBoolean(i.attributes.diagonalUp),this.diagonalDown=s.parseBoolean(i.attributes.diagonalDown),!0;default:return this.parser=this.map[i.name],!!this.parser&&(this.parser.parseOpen(i),!0)}}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.parser=void 0),!0;if(i==="border"){const u=this.model={},p=function(f,h,v){h&&(v&&Object.assign(h,v),u[f]=h)};p("left",this.map.left.model),p("right",this.map.right.model),p("top",this.map.top.model),p("bottom",this.map.bottom.model),p("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}}},{"../../../utils/utils":27,"../base-xform":32,"./color-xform":128}],128:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{constructor(s){super(),this.name=s||"color"}get tag(){return this.name}render(s,l){return!!l&&(s.openNode(this.name),l.argb?s.addAttribute("rgb",l.argb):l.theme!==void 0?(s.addAttribute("theme",l.theme),l.tint!==void 0&&s.addAttribute("tint",l.tint)):l.indexed!==void 0?s.addAttribute("indexed",l.indexed):s.addAttribute("auto","1"),s.closeNode(),!0)}parseOpen(s){return s.name===this.name&&(s.attributes.rgb?this.model={argb:s.attributes.rgb}:s.attributes.theme?(this.model={theme:parseInt(s.attributes.theme,10)},s.attributes.tint&&(this.model.tint=parseFloat(s.attributes.tint))):s.attributes.indexed?this.model={indexed:parseInt(s.attributes.indexed,10)}:this.model=void 0,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],129:[function(e,n,a){const o=e("../base-xform"),s=e("./alignment-xform"),l=e("./border-xform"),c=e("./fill-xform"),i=e("./font-xform"),u=e("./numfmt-xform"),p=e("./protection-xform");n.exports=class extends o{constructor(){super(),this.map={alignment:new s,border:new l,fill:new c,font:new i,numFmt:new u,protection:new p}}get tag(){return"dxf"}render(f,h){if(f.openNode(this.tag),h.font&&this.map.font.render(f,h.font),h.numFmt&&h.numFmtId){const v={id:h.numFmtId,formatCode:h.numFmt};this.map.numFmt.render(f,v)}h.fill&&this.map.fill.render(f,h.fill),h.alignment&&this.map.alignment.render(f,h.alignment),h.border&&this.map.border.render(f,h.border),h.protection&&this.map.protection.render(f,h.protection),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case this.tag:return this.reset(),!0;default:return this.parser=this.map[f.name],this.parser&&this.parser.parseOpen(f),!0}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return this.parser?(this.parser.parseClose(f)||(this.parser=void 0),!0):f!==this.tag||(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1)}}},{"../base-xform":32,"./alignment-xform":126,"./border-xform":127,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./protection-xform":133}],130:[function(e,n,a){const o=e("../base-xform"),s=e("./color-xform");class l extends o{constructor(){super(),this.map={color:new s}}get tag(){return"stop"}render(f,h){f.openNode("stop"),f.addAttribute("position",h.position),this.map.color.render(f,h.color),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"stop":return this.model={position:parseFloat(f.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(f),!0;default:return!1}}parseText(){}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model.color=this.parser.model,this.parser=void 0),!0)}}class c extends o{constructor(){super(),this.map={fgColor:new s("fgColor"),bgColor:new s("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(f,h){f.openNode("patternFill"),f.addAttribute("patternType",h.pattern),h.fgColor&&this.map.fgColor.render(f,h.fgColor),h.bgColor&&this.map.bgColor.render(f,h.bgColor),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"patternFill":return this.model={type:"pattern",pattern:f.attributes.patternType},!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.parser.model&&(this.model[f]=this.parser.model),this.parser=void 0),!0)}}class i extends o{constructor(){super(),this.map={stop:new l}}get name(){return"gradient"}get tag(){return"gradientFill"}render(f,h){switch(f.openNode("gradientFill"),h.gradient){case"angle":f.addAttribute("degree",h.degree);break;case"path":f.addAttribute("type","path"),h.center.left&&(f.addAttribute("left",h.center.left),h.center.right===void 0&&f.addAttribute("right",h.center.left)),h.center.right&&f.addAttribute("right",h.center.right),h.center.top&&(f.addAttribute("top",h.center.top),h.center.bottom===void 0&&f.addAttribute("bottom",h.center.top)),h.center.bottom&&f.addAttribute("bottom",h.center.bottom)}const v=this.map.stop;h.stops.forEach(b=>{v.render(f,b)}),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"gradientFill":{const h=this.model={stops:[]};return f.attributes.degree?(h.gradient="angle",h.degree=parseInt(f.attributes.degree,10)):f.attributes.type==="path"&&(h.gradient="path",h.center={left:f.attributes.left?parseFloat(f.attributes.left):0,top:f.attributes.top?parseFloat(f.attributes.top):0},f.attributes.right!==f.attributes.left&&(h.center.right=f.attributes.right?parseFloat(f.attributes.right):0),f.attributes.bottom!==f.attributes.top&&(h.center.bottom=f.attributes.bottom?parseFloat(f.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(f),!0;default:return!1}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0)}}class u extends o{constructor(){super(),this.map={patternFill:new c,gradientFill:new i}}get tag(){return"fill"}render(f,h){switch(f.addRollback(),f.openNode("fill"),h.type){case"pattern":this.map.patternFill.render(f,h);break;case"gradient":this.map.gradientFill.render(f,h);break;default:return void f.rollback()}f.closeNode(),f.commit()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"fill":return this.model={},!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0)}validStyle(f){return u.validPatternValues[f]}}u.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce((p,f)=>(p[f]=!0,p),{}),u.StopXform=l,u.PatternFillXform=c,u.GradientFillXform=i,n.exports=u},{"../base-xform":32,"./color-xform":128}],131:[function(e,n,a){const o=e("./color-xform"),s=e("../simple/boolean-xform"),l=e("../simple/integer-xform"),c=e("../simple/string-xform"),i=e("./underline-xform"),u=e("../../../utils/under-dash"),p=e("../base-xform");class f extends p{constructor(v){super(),this.options=v||f.OPTIONS,this.map={b:{prop:"bold",xform:new s({tag:"b",attr:"val"})},i:{prop:"italic",xform:new s({tag:"i",attr:"val"})},u:{prop:"underline",xform:new i},charset:{prop:"charset",xform:new l({tag:"charset",attr:"val"})},color:{prop:"color",xform:new o},condense:{prop:"condense",xform:new s({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new s({tag:"extend",attr:"val"})},family:{prop:"family",xform:new l({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new s({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new c({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new c({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new s({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new s({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new l({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new c({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(v,b){const{map:g}=this;v.openNode(this.options.tagName),u.each(this.map,(x,y)=>{g[y].xform.render(v,b[x.prop])}),v.closeNode()}parseOpen(v){if(this.parser)return this.parser.parseOpen(v),!0;if(this.map[v.name])return this.parser=this.map[v.name].xform,this.parser.parseOpen(v);switch(v.name){case this.options.tagName:return this.model={},!0;default:return!1}}parseText(v){this.parser&&this.parser.parseText(v)}parseClose(v){if(this.parser&&!this.parser.parseClose(v)){const b=this.map[v];return this.parser.model&&(this.model[b.prop]=this.parser.model),this.parser=void 0,!0}switch(v){case this.options.tagName:return!1;default:return!0}}}f.OPTIONS={tagName:"font",fontNameTag:"name"},n.exports=f},{"../../../utils/under-dash":26,"../base-xform":32,"../simple/boolean-xform":116,"../simple/integer-xform":118,"../simple/string-xform":119,"./color-xform":128,"./underline-xform":136}],132:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../../defaultnumformats"),l=e("../base-xform"),c=function(){const u={};return o.each(s,(p,f)=>{p.f&&(u[p.f]=parseInt(f,10))}),u}();class i extends l{constructor(p,f){super(),this.id=p,this.formatCode=f}get tag(){return"numFmt"}render(p,f){p.leafNode("numFmt",{numFmtId:f.id,formatCode:f.formatCode})}parseOpen(p){switch(p.name){case"numFmt":return this.model={id:parseInt(p.attributes.numFmtId,10),formatCode:p.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0;default:return!1}}parseText(){}parseClose(){return!1}}i.getDefaultFmtId=function(u){return c[u]},i.getDefaultFmtCode=function(u){return s[u]&&s[u].f},n.exports=i},{"../../../utils/under-dash":26,"../../defaultnumformats":30,"../base-xform":32}],133:[function(e,n,a){const o=e("../base-xform"),s={boolean:(l,c)=>l===void 0?c:l};n.exports=class extends o{get tag(){return"protection"}render(l,c){l.addRollback(),l.openNode("protection");let i=!1;function u(p,f){f!==void 0&&(l.addAttribute(p,f),i=!0)}u("locked",s.boolean(c.locked,!0)?void 0:"0"),u("hidden",s.boolean(c.hidden,!1)?"1":void 0),l.closeNode(),i?l.commit():l.rollback()}parseOpen(l){const c={locked:l.attributes.locked!=="0",hidden:l.attributes.hidden==="1"},i=!c.locked||c.hidden;this.model=i?c:null}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],134:[function(e,n,a){const o=e("../base-xform"),s=e("./alignment-xform"),l=e("./protection-xform");n.exports=class extends o{constructor(c){super(),this.xfId=!(!c||!c.xfId),this.map={alignment:new s,protection:new l}}get tag(){return"xf"}render(c,i){c.openNode("xf",{numFmtId:i.numFmtId||0,fontId:i.fontId||0,fillId:i.fillId||0,borderId:i.borderId||0}),this.xfId&&c.addAttribute("xfId",i.xfId||0),i.numFmtId&&c.addAttribute("applyNumberFormat","1"),i.fontId&&c.addAttribute("applyFont","1"),i.fillId&&c.addAttribute("applyFill","1"),i.borderId&&c.addAttribute("applyBorder","1"),i.alignment&&c.addAttribute("applyAlignment","1"),i.protection&&c.addAttribute("applyProtection","1"),i.alignment&&this.map.alignment.render(c,i.alignment),i.protection&&this.map.protection.render(c,i.protection),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"xf":return this.model={numFmtId:parseInt(c.attributes.numFmtId,10),fontId:parseInt(c.attributes.fontId,10),fillId:parseInt(c.attributes.fillId,10),borderId:parseInt(c.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(c.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(c),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(c),!0;default:return!1}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):c!=="xf"}}},{"../base-xform":32,"./alignment-xform":126,"./protection-xform":133}],135:[function(e,n,a){const o=e("../../../doc/enums"),s=e("../../../utils/xml-stream"),l=e("../base-xform"),c=e("../static-xform"),i=e("../list-xform"),u=e("./font-xform"),p=e("./fill-xform"),f=e("./border-xform"),h=e("./numfmt-xform"),v=e("./style-xform"),b=e("./dxf-xform");class g extends l{constructor(y){super(),this.map={numFmts:new i({tag:"numFmts",count:!0,childXform:new h}),fonts:new i({tag:"fonts",count:!0,childXform:new u,$:{"x14ac:knownFonts":1}}),fills:new i({tag:"fills",count:!0,childXform:new p}),borders:new i({tag:"borders",count:!0,childXform:new f}),cellStyleXfs:new i({tag:"cellStyleXfs",count:!0,childXform:new v}),cellXfs:new i({tag:"cellXfs",count:!0,childXform:new v({xfId:!0})}),dxfs:new i({tag:"dxfs",always:!0,count:!0,childXform:new b}),numFmt:new h,font:new u,fill:new p,border:new f,style:new v({xfId:!0}),cellStyles:g.STATIC_XFORMS.cellStyles,tableStyles:g.STATIC_XFORMS.tableStyles,extLst:g.STATIC_XFORMS.extLst},y&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(y,E){E=E||this.model,y.openXml(s.StdDocAttributes),y.openNode("styleSheet",g.STYLESHEET_ATTRIBUTES),this.index?(E.numFmts&&E.numFmts.length&&(y.openNode("numFmts",{count:E.numFmts.length}),E.numFmts.forEach(N=>{y.writeXml(N)}),y.closeNode()),E.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),y.openNode("fonts",{count:E.fonts.length,"x14ac:knownFonts":1}),E.fonts.forEach(N=>{y.writeXml(N)}),y.closeNode(),y.openNode("fills",{count:E.fills.length}),E.fills.forEach(N=>{y.writeXml(N)}),y.closeNode(),y.openNode("borders",{count:E.borders.length}),E.borders.forEach(N=>{y.writeXml(N)}),y.closeNode(),this.map.cellStyleXfs.render(y,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),y.openNode("cellXfs",{count:E.styles.length}),E.styles.forEach(N=>{y.writeXml(N)}),y.closeNode()):(this.map.numFmts.render(y,E.numFmts),this.map.fonts.render(y,E.fonts),this.map.fills.render(y,E.fills),this.map.borders.render(y,E.borders),this.map.cellStyleXfs.render(y,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(y,E.styles)),g.STATIC_XFORMS.cellStyles.render(y),this.map.dxfs.render(y,E.dxfs),g.STATIC_XFORMS.tableStyles.render(y),g.STATIC_XFORMS.extLst.render(y),y.closeNode()}parseOpen(y){if(this.parser)return this.parser.parseOpen(y),!0;switch(y.name){case"styleSheet":return this.initIndex(),!0;default:return this.parser=this.map[y.name],this.parser&&this.parser.parseOpen(y),!0}}parseText(y){this.parser&&this.parser.parseText(y)}parseClose(y){if(this.parser)return this.parser.parseClose(y)||(this.parser=void 0),!0;switch(y){case"styleSheet":{this.model={};const E=(N,I)=>{I.model&&I.model.length&&(this.model[N]=I.model)};if(E("numFmts",this.map.numFmts),E("fonts",this.map.fonts),E("fills",this.map.fills),E("borders",this.map.borders),E("styles",this.map.cellXfs),E("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){const N=this.index.numFmt;this.model.numFmts.forEach(I=>{N[I.id]=I.formatCode})}return!1}default:return!0}}addStyleModel(y,E){if(!y)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(y))return this.weakMap.get(y);const N={};if(E=E||o.ValueType.Number,y.numFmt)N.numFmtId=this._addNumFmtStr(y.numFmt);else switch(E){case o.ValueType.Number:N.numFmtId=this._addNumFmtStr("General");break;case o.ValueType.Date:N.numFmtId=this._addNumFmtStr("mm-dd-yy")}y.font&&(N.fontId=this._addFont(y.font)),y.border&&(N.borderId=this._addBorder(y.border)),y.fill&&(N.fillId=this._addFill(y.fill)),y.alignment&&(N.alignment=y.alignment),y.protection&&(N.protection=y.protection);const I=this._addStyle(N);return this.weakMap&&this.weakMap.set(y,I),I}getStyleModel(y){const E=this.model.styles[y];if(!E)return null;let N=this.index.model[y];if(N)return N;if(N=this.index.model[y]={},E.numFmtId){const L=this.index.numFmt[E.numFmtId]||h.getDefaultFmtCode(E.numFmtId);L&&(N.numFmt=L)}function I(L,H,V){if(V||V===0){const q=H[V];q&&(N[L]=q)}}return I("font",this.model.fonts,E.fontId),I("border",this.model.borders,E.borderId),I("fill",this.model.fills,E.fillId),E.alignment&&(N.alignment=E.alignment),E.protection&&(N.protection=E.protection),N}addDxfStyle(y){return y.numFmt&&(y.numFmtId=this._addNumFmtStr(y.numFmt)),this.model.dxfs.push(y),this.model.dxfs.length-1}getDxfStyle(y){return this.model.dxfs[y]}_addStyle(y){const E=this.map.style.toXml(y);let N=this.index.style[E];return N===void 0&&(N=this.index.style[E]=this.model.styles.length,this.model.styles.push(E)),N}_addNumFmtStr(y){let E=h.getDefaultFmtId(y);if(E!==void 0||(E=this.index.numFmt[y],E!==void 0))return E;E=this.index.numFmt[y]=164+this.model.numFmts.length;const N=this.map.numFmt.toXml({id:E,formatCode:y});return this.model.numFmts.push(N),E}_addFont(y){const E=this.map.font.toXml(y);let N=this.index.font[E];return N===void 0&&(N=this.index.font[E]=this.model.fonts.length,this.model.fonts.push(E)),N}_addBorder(y){const E=this.map.border.toXml(y);let N=this.index.border[E];return N===void 0&&(N=this.index.border[E]=this.model.borders.length,this.model.borders.push(E)),N}_addFill(y){const E=this.map.fill.toXml(y);let N=this.index.fill[E];return N===void 0&&(N=this.index.fill[E]=this.model.fills.length,this.model.fills.push(E)),N}}g.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"},g.STATIC_XFORMS={cellStyles:new c({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new c({tag:"dxfs",$:{count:0}}),tableStyles:new c({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new c({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})},g.Mock=class extends g{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(x){return x.autodrain(),Promise.resolve()}addStyleModel(x,y){switch(y){case o.ValueType.Date:return this.dateStyleId;default:return 0}}get dateStyleId(){if(!this._dateStyleId){const x={numFmtId:h.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(x)}return this._dateStyleId}getStyleModel(){return{}}},n.exports=g},{"../../../doc/enums":7,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./border-xform":127,"./dxf-xform":129,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./style-xform":134}],136:[function(e,n,a){const o=e("../base-xform");class s extends o{constructor(c){super(),this.model=c}get tag(){return"u"}render(c,i){if((i=i||this.model)===!0)c.leafNode("u");else{const u=s.Attributes[i];u&&c.leafNode("u",u)}}parseOpen(c){c.name==="u"&&(this.model=c.attributes.val||!0)}parseText(){}parseClose(){return!1}}s.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},n.exports=s},{"../base-xform":32}],137:[function(e,n,a){const o=e("../base-xform"),s=e("./filter-column-xform");n.exports=class extends o{constructor(){super(),this.map={filterColumn:new s}}get tag(){return"autoFilter"}prepare(l){l.columns.forEach((c,i)=>{this.map.filterColumn.prepare(c,{index:i})})}render(l,c){return l.openNode(this.tag,{ref:c.autoFilterRef}),c.columns.forEach(i=>{this.map.filterColumn.render(l,i)}),l.closeNode(),!0}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:return this.model={autoFilterRef:l.attributes.ref,columns:[]},!0;default:if(this.parser=this.map[l.name],this.parser)return this.parseOpen(l),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(l))}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;switch(l){case this.tag:return!1;default:throw new Error("Unexpected xml node in parseClose: "+l)}}}},{"../base-xform":32,"./filter-column-xform":139}],138:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"customFilter"}render(s,l){s.leafNode(this.tag,{val:l.val,operator:l.operator})}parseOpen(s){return s.name===this.tag&&(this.model={val:s.attributes.val,operator:s.attributes.operator},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],139:[function(e,n,a){const o=e("../base-xform"),s=e("../list-xform"),l=e("./custom-filter-xform"),c=e("./filter-xform");n.exports=class extends o{constructor(){super(),this.map={customFilters:new s({tag:"customFilters",count:!1,empty:!0,childXform:new l}),filters:new s({tag:"filters",count:!1,empty:!0,childXform:new c})}}get tag(){return"filterColumn"}prepare(i,u){i.colId=u.index.toString()}render(i,u){return u.customFilters?(i.openNode(this.tag,{colId:u.colId,hiddenButton:u.filterButton?"0":"1"}),this.map.customFilters.render(i,u.customFilters),i.closeNode(),!0):(i.leafNode(this.tag,{colId:u.colId,hiddenButton:u.filterButton?"0":"1"}),!0)}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;const{attributes:u}=i;switch(i.name){case this.tag:return this.model={filterButton:u.hiddenButton==="0"},!0;default:if(this.parser=this.map[i.name],this.parser)return this.parseOpen(i),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(i))}}parseText(){}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.parser=void 0),!0;switch(i){case this.tag:return this.model.customFilters=this.map.customFilters.model,!1;default:return!0}}}},{"../base-xform":32,"../list-xform":71,"./custom-filter-xform":138,"./filter-xform":140}],140:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"filter"}render(s,l){s.leafNode(this.tag,{val:l.val})}parseOpen(s){return s.name===this.tag&&(this.model={val:s.attributes.val},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],141:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"tableColumn"}prepare(s,l){s.id=l.index+1}render(s,l){return s.leafNode(this.tag,{id:l.id.toString(),name:l.name,totalsRowLabel:l.totalsRowLabel,totalsRowFunction:l.totalsRowFunction,dxfId:l.dxfId}),!0}parseOpen(s){if(s.name===this.tag){const{attributes:l}=s;return this.model={name:l.name,totalsRowLabel:l.totalsRowLabel,totalsRowFunction:l.totalsRowFunction,dxfId:l.dxfId},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],142:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"tableStyleInfo"}render(s,l){return s.leafNode(this.tag,{name:l.theme?l.theme:void 0,showFirstColumn:l.showFirstColumn?"1":"0",showLastColumn:l.showLastColumn?"1":"0",showRowStripes:l.showRowStripes?"1":"0",showColumnStripes:l.showColumnStripes?"1":"0"}),!0}parseOpen(s){if(s.name===this.tag){const{attributes:l}=s;return this.model={theme:l.name?l.name:null,showFirstColumn:l.showFirstColumn==="1",showLastColumn:l.showLastColumn==="1",showRowStripes:l.showRowStripes==="1",showColumnStripes:l.showColumnStripes==="1"},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],143:[function(e,n,a){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("../list-xform"),c=e("./auto-filter-xform"),i=e("./table-column-xform"),u=e("./table-style-info-xform");class p extends s{constructor(){super(),this.map={autoFilter:new c,tableColumns:new l({tag:"tableColumns",count:!0,empty:!0,childXform:new i}),tableStyleInfo:new u}}prepare(h,v){this.map.autoFilter.prepare(h),this.map.tableColumns.prepare(h.columns,v)}get tag(){return"table"}render(h,v){h.openXml(o.StdDocAttributes),h.openNode(this.tag,{...p.TABLE_ATTRIBUTES,id:v.id,name:v.name,displayName:v.displayName||v.name,ref:v.tableRef,totalsRowCount:v.totalsRow?"1":void 0,totalsRowShown:v.totalsRow?void 0:"1",headerRowCount:v.headerRow?"1":"0"}),this.map.autoFilter.render(h,v),this.map.tableColumns.render(h,v.columns),this.map.tableStyleInfo.render(h,v.style),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;const{name:v,attributes:b}=h;switch(v){case this.tag:this.reset(),this.model={name:b.name,displayName:b.displayName||b.name,tableRef:b.ref,totalsRow:b.totalsRowCount==="1",headerRow:b.headerRowCount==="1"};break;default:this.parser=this.map[h.name],this.parser&&this.parser.parseOpen(h)}return!0}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){if(this.parser)return this.parser.parseClose(h)||(this.parser=void 0),!0;switch(h){case this.tag:return this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach((v,b)=>{this.model.columns[b].filterButton=v.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1;default:return!0}}reconcile(h,v){h.columns.forEach(b=>{b.dxfId!==void 0&&(b.style=v.styles.getDxfStyle(b.dxfId))})}}p.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},n.exports=p},{"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":137,"./table-column-xform":141,"./table-style-info-xform":142}],144:[function(e,n,a){(function(o,s){(function(){const l=e("fs"),c=e("jszip"),{PassThrough:i}=e("readable-stream"),u=e("../utils/zip-stream"),p=e("../utils/stream-buf"),f=e("../utils/utils"),h=e("../utils/xml-stream"),{bufferToString:v}=e("../utils/browser-buffer-decode"),b=e("./xform/style/styles-xform"),g=e("./xform/core/core-xform"),x=e("./xform/strings/shared-strings-xform"),y=e("./xform/core/relationships-xform"),E=e("./xform/core/content-types-xform"),N=e("./xform/core/app-xform"),I=e("./xform/book/workbook-xform"),L=e("./xform/sheet/worksheet-xform"),H=e("./xform/drawing/drawing-xform"),V=e("./xform/table/table-xform"),q=e("./xform/comment/comments-xform"),K=e("./xform/comment/vml-notes-xform"),z=e("./xml/theme1");class W{constructor(M){this.workbook=M}async readFile(M,C){if(!await f.fs.exists(M))throw new Error("File not found: "+M);const w=l.createReadStream(M);try{const T=await this.read(w,C);return w.close(),T}catch(T){throw w.close(),T}}parseRels(M){return new y().parseStream(M)}parseWorkbook(M){return new I().parseStream(M)}parseSharedStrings(M){return new x().parseStream(M)}reconcile(M,C){const w=new I,T=new L(C),A=new H,S=new V;w.reconcile(M);const j={media:M.media,mediaIndex:M.mediaIndex};Object.keys(M.drawings).forEach(X=>{const Y=M.drawings[X],ee=M.drawingRels[X];ee&&(j.rels=ee.reduce((U,Q)=>(U[Q.Id]=Q,U),{}),(Y.anchors||[]).forEach(U=>{const Q=U.picture&&U.picture.hyperlinks;Q&&j.rels[Q.rId]&&(Q.hyperlink=j.rels[Q.rId].Target,delete Q.rId)}),A.reconcile(Y,j))});const B={styles:M.styles};Object.values(M.tables).forEach(X=>{S.reconcile(X,B)});const R={styles:M.styles,sharedStrings:M.sharedStrings,media:M.media,mediaIndex:M.mediaIndex,date1904:M.properties&&M.properties.date1904,drawings:M.drawings,comments:M.comments,tables:M.tables,vmlDrawings:M.vmlDrawings};M.worksheets.forEach(X=>{X.relationships=M.worksheetRels[X.sheetNo],T.reconcile(X,R)}),delete M.worksheetHash,delete M.worksheetRels,delete M.globalRels,delete M.sharedStrings,delete M.workbookRels,delete M.sheetDefs,delete M.styles,delete M.mediaIndex,delete M.drawings,delete M.drawingRels,delete M.vmlDrawings}async _processWorksheetEntry(M,C,w,T,A){const S=new L(T),j=await S.parseStream(M);j.sheetNo=w,C.worksheetHash[A]=j,C.worksheets.push(j)}async _processCommentEntry(M,C,w){const T=new q,A=await T.parseStream(M);C.comments[`../${w}.xml`]=A}async _processTableEntry(M,C,w){const T=new V,A=await T.parseStream(M);C.tables[`../tables/${w}.xml`]=A}async _processWorksheetRelsEntry(M,C,w){const T=new y,A=await T.parseStream(M);C.worksheetRels[w]=A}async _processMediaEntry(M,C,w){const T=w.lastIndexOf(".");if(T>=1){const A=w.substr(T+1),S=w.substr(0,T);await new Promise((j,B)=>{const R=new p;R.on("finish",()=>{C.mediaIndex[w]=C.media.length,C.mediaIndex[S]=C.media.length;const X={type:"image",name:S,extension:A,buffer:R.toBuffer()};C.media.push(X),j()}),M.on("error",X=>{B(X)}),M.pipe(R)})}}async _processDrawingEntry(M,C,w){const T=new H,A=await T.parseStream(M);C.drawings[w]=A}async _processDrawingRelsEntry(M,C,w){const T=new y,A=await T.parseStream(M);C.drawingRels[w]=A}async _processVmlDrawingEntry(M,C,w){const T=new K,A=await T.parseStream(M);C.vmlDrawings[`../drawings/${w}.vml`]=A}async _processThemeEntry(M,C,w){await new Promise((T,A)=>{const S=new p;M.on("error",A),S.on("error",A),S.on("finish",()=>{C.themes[w]=S.read().toString(),T()}),M.pipe(S)})}createInputStream(){throw new Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}async read(M,C){!M[Symbol.asyncIterator]&&M.pipe&&(M=M.pipe(new i));const w=[];for await(const T of M)w.push(T);return this.load(s.concat(w),C)}async load(M,C){let w;w=C&&C.base64?s.from(M.toString(),"base64"):M;const T={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}},A=await c.loadAsync(w);for(const S of Object.values(A.files))if(!S.dir){let j,B=S.name;if(B[0]==="/"&&(B=B.substr(1)),B.match(/xl\/media\//)||B.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))j=new i,j.write(await S.async("nodebuffer"));else{let R;j=new i({writableObjectMode:!0,readableObjectMode:!0}),R=o.browser?v(await S.async("nodebuffer")):await S.async("string");const X=16384;for(let Y=0;Y<R.length;Y+=X)j.write(R.substring(Y,Y+X))}switch(j.end(),B){case"_rels/.rels":T.globalRels=await this.parseRels(j);break;case"xl/workbook.xml":{const R=await this.parseWorkbook(j);T.sheets=R.sheets,T.definedNames=R.definedNames,T.views=R.views,T.properties=R.properties,T.calcProperties=R.calcProperties;break}case"xl/_rels/workbook.xml.rels":T.workbookRels=await this.parseRels(j);break;case"xl/sharedStrings.xml":T.sharedStrings=new x,await T.sharedStrings.parseStream(j);break;case"xl/styles.xml":T.styles=new b,await T.styles.parseStream(j);break;case"docProps/app.xml":{const R=new N,X=await R.parseStream(j);T.company=X.company,T.manager=X.manager;break}case"docProps/core.xml":{const R=new g,X=await R.parseStream(j);Object.assign(T,X);break}default:{let R=B.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if(R){await this._processWorksheetEntry(j,T,R[1],C,B);break}if(R=B.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),R){await this._processWorksheetRelsEntry(j,T,R[1]);break}if(R=B.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/),R){await this._processThemeEntry(j,T,R[1]);break}if(R=B.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/),R){await this._processMediaEntry(j,T,R[1]);break}if(R=B.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/),R){await this._processDrawingEntry(j,T,R[1]);break}if(R=B.match(/xl\/(comments\d+)[.]xml/),R){await this._processCommentEntry(j,T,R[1]);break}if(R=B.match(/xl\/tables\/(table\d+)[.]xml/),R){await this._processTableEntry(j,T,R[1]);break}if(R=B.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/),R){await this._processDrawingRelsEntry(j,T,R[1]);break}if(R=B.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/),R){await this._processVmlDrawingEntry(j,T,R[1]);break}}}}return this.reconcile(T,C),this.workbook.model=T,this.workbook}async addMedia(M,C){await Promise.all(C.media.map(async w=>{if(w.type==="image"){const T=`xl/media/${w.name}.${w.extension}`;if(w.filename){const A=await function(S,j){return new Promise((B,R)=>{l.readFile(S,j,(X,Y)=>{X?R(X):B(Y)})})}(w.filename);return M.append(A,{name:T})}if(w.buffer)return M.append(w.buffer,{name:T});if(w.base64){const A=w.base64,S=A.substring(A.indexOf(",")+1);return M.append(S,{name:T,base64:!0})}}throw new Error("Unsupported media")}))}addDrawings(M,C){const w=new H,T=new y;C.worksheets.forEach(A=>{const{drawing:S}=A;if(S){w.prepare(S,{});let j=w.toXml(S);M.append(j,{name:`xl/drawings/${S.name}.xml`}),j=T.toXml(S.rels),M.append(j,{name:`xl/drawings/_rels/${S.name}.xml.rels`})}})}addTables(M,C){const w=new V;C.worksheets.forEach(T=>{const{tables:A}=T;A.forEach(S=>{w.prepare(S,{});const j=w.toXml(S);M.append(j,{name:"xl/tables/"+S.target})})})}async addContentTypes(M,C){const w=new E().toXml(C);M.append(w,{name:"[Content_Types].xml"})}async addApp(M,C){const w=new N().toXml(C);M.append(w,{name:"docProps/app.xml"})}async addCore(M,C){const w=new g;M.append(w.toXml(C),{name:"docProps/core.xml"})}async addThemes(M,C){const w=C.themes||{theme1:z};Object.keys(w).forEach(T=>{const A=w[T],S=`xl/theme/${T}.xml`;M.append(A,{name:S})})}async addOfficeRels(M){const C=new y().toXml([{Id:"rId1",Type:W.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:W.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:W.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);M.append(C,{name:"_rels/.rels"})}async addWorkbookRels(M,C){let w=1;const T=[{Id:"rId"+w++,Type:W.RelType.Styles,Target:"styles.xml"},{Id:"rId"+w++,Type:W.RelType.Theme,Target:"theme/theme1.xml"}];C.sharedStrings.count&&T.push({Id:"rId"+w++,Type:W.RelType.SharedStrings,Target:"sharedStrings.xml"}),C.worksheets.forEach(S=>{S.rId="rId"+w++,T.push({Id:S.rId,Type:W.RelType.Worksheet,Target:`worksheets/sheet${S.id}.xml`})});const A=new y().toXml(T);M.append(A,{name:"xl/_rels/workbook.xml.rels"})}async addSharedStrings(M,C){C.sharedStrings&&C.sharedStrings.count&&M.append(C.sharedStrings.xml,{name:"xl/sharedStrings.xml"})}async addStyles(M,C){const{xml:w}=C.styles;w&&M.append(w,{name:"xl/styles.xml"})}async addWorkbook(M,C){const w=new I;M.append(w.toXml(C),{name:"xl/workbook.xml"})}async addWorksheets(M,C){const w=new L,T=new y,A=new q,S=new K;C.worksheets.forEach(j=>{let B=new h;w.render(B,j),M.append(B.xml,{name:`xl/worksheets/sheet${j.id}.xml`}),j.rels&&j.rels.length&&(B=new h,T.render(B,j.rels),M.append(B.xml,{name:`xl/worksheets/_rels/sheet${j.id}.xml.rels`})),j.comments.length>0&&(B=new h,A.render(B,j),M.append(B.xml,{name:`xl/comments${j.id}.xml`}),B=new h,S.render(B,j),M.append(B.xml,{name:`xl/drawings/vmlDrawing${j.id}.vml`}))})}_finalize(M){return new Promise((C,w)=>{M.on("finish",()=>{C(this)}),M.on("error",w),M.finalize()})}prepareModel(M,C){M.creator=M.creator||"ExcelJS",M.lastModifiedBy=M.lastModifiedBy||"ExcelJS",M.created=M.created||new Date,M.modified=M.modified||new Date,M.useSharedStrings=C.useSharedStrings===void 0||C.useSharedStrings,M.useStyles=C.useStyles===void 0||C.useStyles,M.sharedStrings=new x,M.styles=M.useStyles?new b(!0):new b.Mock;const w=new I,T=new L;w.prepare(M);const A={sharedStrings:M.sharedStrings,styles:M.styles,date1904:M.properties.date1904,drawingsCount:0,media:M.media};A.drawings=M.drawings=[],A.commentRefs=M.commentRefs=[];let S=0;M.tables=[],M.worksheets.forEach(j=>{j.tables.forEach(B=>{S++,B.target=`table${S}.xml`,B.id=S,M.tables.push(B)}),T.prepare(j,A)})}async write(M,C){C=C||{};const{model:w}=this.workbook,T=new u.ZipWriter(C.zip);return T.pipe(M),this.prepareModel(w,C),await this.addContentTypes(T,w),await this.addOfficeRels(T,w),await this.addWorkbookRels(T,w),await this.addWorksheets(T,w),await this.addSharedStrings(T,w),await this.addDrawings(T,w),await this.addTables(T,w),await Promise.all([this.addThemes(T,w),this.addStyles(T,w)]),await this.addMedia(T,w),await Promise.all([this.addApp(T,w),this.addCore(T,w)]),await this.addWorkbook(T,w),this._finalize(T)}writeFile(M,C){const w=l.createWriteStream(M);return new Promise((T,A)=>{w.on("finish",()=>{T()}),w.on("error",S=>{A(S)}),this.write(w,C).then(()=>{w.end()}).catch(S=>{A(S)})})}async writeBuffer(M){const C=new p;return await this.write(C,M),C.read()}}W.RelType=e("./rel-type"),n.exports=W}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"../utils/browser-buffer-decode":16,"../utils/stream-buf":24,"../utils/utils":27,"../utils/xml-stream":28,"../utils/zip-stream":29,"./rel-type":31,"./xform/book/workbook-xform":38,"./xform/comment/comments-xform":40,"./xform/comment/vml-notes-xform":45,"./xform/core/app-xform":51,"./xform/core/content-types-xform":52,"./xform/core/core-xform":53,"./xform/core/relationships-xform":55,"./xform/drawing/drawing-xform":62,"./xform/sheet/worksheet-xform":115,"./xform/strings/shared-strings-xform":124,"./xform/style/styles-xform":135,"./xform/table/table-xform":143,"./xml/theme1":145,_process:467,buffer:220,fs:216,jszip:441,"readable-stream":491}],145:[function(e,n,a){n.exports=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>`},{}],146:[function(e,n,a){(function(o){(function(){Object.defineProperty(a,"__esModule",{value:!0}),a.CsvFormatterStream=void 0;const s=e("stream"),l=e("./formatter");class c extends s.Transform{constructor(u){super({writableObjectMode:u.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=u,this.rowFormatter=new l.RowFormatter(u),this.hasWrittenBOM=!u.writeBOM}transform(u){return this.rowFormatter.rowTransform=u,this}_transform(u,p,f){let h=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(u,(v,b)=>v?(h=!0,f(v)):(b&&b.forEach(g=>{this.push(o.from(g,"utf8"))}),h=!0,f()))}catch(v){if(h)throw v;f(v)}}_flush(u){this.rowFormatter.finish((p,f)=>p?u(p):(f&&f.forEach(h=>{this.push(o.from(h,"utf8"))}),u()))}}a.CsvFormatterStream=c}).call(this)}).call(this,e("buffer").Buffer)},{"./formatter":150,buffer:220,stream:505}],147:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.FormatterOptions=void 0,a.FormatterOptions=class{constructor(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var s;this.objectMode=!0,this.delimiter=",",this.rowDelimiter=`
`,this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,o||{}),(o==null?void 0:o.quoteHeaders)===void 0&&(this.quoteHeaders=this.quoteColumns),(o==null?void 0:o.quote)===!0?this.quote='"':(o==null?void 0:o.quote)===!1&&(this.quote=""),typeof(o==null?void 0:o.escape)!="string"&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&((s=o.writeHeaders)===null||s===void 0||s),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote=`${this.escape}${this.quote}`}}},{}],148:[function(e,n,a){var o=function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(a,"__esModule",{value:!0}),a.FieldFormatter=void 0;const s=o(e("lodash.isboolean")),l=o(e("lodash.isnil")),c=o(e("lodash.escaperegexp"));a.FieldFormatter=class{constructor(i){this._headers=null,this.formatterOptions=i,i.headers!==null&&(this.headers=i.headers),this.REPLACE_REGEXP=new RegExp(i.quote,"g");const u=`[${i.delimiter}${c.default(i.rowDelimiter)}|\r|
]`;this.ESCAPE_REGEXP=new RegExp(u)}set headers(i){this._headers=i}shouldQuote(i,u){const p=u?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return s.default(p)?p:Array.isArray(p)?p[i]:this._headers!==null&&p[this._headers[i]]}format(i,u,p){const f=(""+(l.default(i)?"":i)).replace(/\0/g,""),{formatterOptions:h}=this;return h.quote!==""&&f.indexOf(h.quote)!==-1?this.quoteField(f.replace(this.REPLACE_REGEXP,h.escapedQuote)):f.search(this.ESCAPE_REGEXP)!==-1||this.shouldQuote(u,p)?this.quoteField(f):f}quoteField(i){const{quote:u}=this.formatterOptions;return`${u}${i}${u}`}}},{"lodash.escaperegexp":442,"lodash.isboolean":444,"lodash.isnil":447}],149:[function(e,n,a){var o=function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(a,"__esModule",{value:!0}),a.RowFormatter=void 0;const s=o(e("lodash.isfunction")),l=o(e("lodash.isequal")),c=e("./FieldFormatter"),i=e("../types");class u{constructor(f){this.rowCount=0,this.formatterOptions=f,this.fieldFormatter=new c.FieldFormatter(f),this.headers=f.headers,this.shouldWriteHeaders=f.shouldWriteHeaders,this.hasWrittenHeaders=!1,this.headers!==null&&(this.fieldFormatter.headers=this.headers),f.transform&&(this.rowTransform=f.transform)}static isRowHashArray(f){return!!Array.isArray(f)&&Array.isArray(f[0])&&f[0].length===2}static isRowArray(f){return Array.isArray(f)&&!this.isRowHashArray(f)}static gatherHeaders(f){return u.isRowHashArray(f)?f.map(h=>h[0]):Array.isArray(f)?f:Object.keys(f)}static createTransform(f){return i.isSyncTransform(f)?(h,v)=>{let b=null;try{b=f(h)}catch(g){return v(g)}return v(null,b)}:(h,v)=>{f(h,v)}}set rowTransform(f){if(!s.default(f))throw new TypeError("The transform should be a function");this._rowTransform=u.createTransform(f)}format(f,h){this.callTransformer(f,(v,b)=>{if(v)return h(v);if(!f)return h(null);const g=[];if(b){const{shouldFormatColumns:x,headers:y}=this.checkHeaders(b);if(this.shouldWriteHeaders&&y&&!this.hasWrittenHeaders&&(g.push(this.formatColumns(y,!0)),this.hasWrittenHeaders=!0),x){const E=this.gatherColumns(b);g.push(this.formatColumns(E,!1))}}return h(null,g)})}finish(f){const h=[];if(this.formatterOptions.alwaysWriteHeaders&&this.rowCount===0){if(!this.headers)return f(new Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));h.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&h.push(this.formatterOptions.rowDelimiter),f(null,h)}checkHeaders(f){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};const h=u.gatherHeaders(f);return this.headers=h,this.fieldFormatter.headers=h,this.shouldWriteHeaders?{shouldFormatColumns:!l.default(h,f),headers:h}:{shouldFormatColumns:!0,headers:null}}gatherColumns(f){if(this.headers===null)throw new Error("Headers is currently null");return Array.isArray(f)?u.isRowHashArray(f)?this.headers.map((h,v)=>{const b=f[v];return b?b[1]:""}):u.isRowArray(f)&&!this.shouldWriteHeaders?f:this.headers.map((h,v)=>f[v]):this.headers.map(h=>f[h])}callTransformer(f,h){return this._rowTransform?this._rowTransform(f,h):h(null,f)}formatColumns(f,h){const v=f.map((g,x)=>this.fieldFormatter.format(g,x,h)).join(this.formatterOptions.delimiter),{rowCount:b}=this;return this.rowCount+=1,b?[this.formatterOptions.rowDelimiter,v].join(""):v}}a.RowFormatter=u},{"../types":152,"./FieldFormatter":148,"lodash.isequal":445,"lodash.isfunction":446}],150:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.FieldFormatter=a.RowFormatter=void 0;var o=e("./RowFormatter");Object.defineProperty(a,"RowFormatter",{enumerable:!0,get:function(){return o.RowFormatter}});var s=e("./FieldFormatter");Object.defineProperty(a,"FieldFormatter",{enumerable:!0,get:function(){return s.FieldFormatter}})},{"./FieldFormatter":148,"./RowFormatter":149}],151:[function(e,n,a){(function(o){(function(){var s=Object.create?function(x,y,E,N){N===void 0&&(N=E),Object.defineProperty(x,N,{enumerable:!0,get:function(){return y[E]}})}:function(x,y,E,N){N===void 0&&(N=E),x[N]=y[E]},l=Object.create?function(x,y){Object.defineProperty(x,"default",{enumerable:!0,value:y})}:function(x,y){x.default=y},c=function(x){if(x&&x.__esModule)return x;var y={};if(x!=null)for(var E in x)E!=="default"&&Object.prototype.hasOwnProperty.call(x,E)&&s(y,x,E);return l(y,x),y},i=function(x,y){for(var E in x)E==="default"||Object.prototype.hasOwnProperty.call(y,E)||s(y,x,E)};Object.defineProperty(a,"__esModule",{value:!0}),a.writeToPath=a.writeToString=a.writeToBuffer=a.writeToStream=a.write=a.format=a.FormatterOptions=a.CsvFormatterStream=void 0;const u=e("util"),p=e("stream"),f=c(e("fs")),h=e("./FormatterOptions"),v=e("./CsvFormatterStream");i(e("./types"),a);var b=e("./CsvFormatterStream");Object.defineProperty(a,"CsvFormatterStream",{enumerable:!0,get:function(){return b.CsvFormatterStream}});var g=e("./FormatterOptions");Object.defineProperty(a,"FormatterOptions",{enumerable:!0,get:function(){return g.FormatterOptions}}),a.format=x=>new v.CsvFormatterStream(new h.FormatterOptions(x)),a.write=(x,y)=>{const E=a.format(y),N=u.promisify((I,L)=>{E.write(I,void 0,L)});return x.reduce((I,L)=>I.then(()=>N(L)),Promise.resolve()).then(()=>E.end()).catch(I=>{E.emit("error",I)}),E},a.writeToStream=(x,y,E)=>a.write(y,E).pipe(x),a.writeToBuffer=function(x){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const E=[],N=new p.Writable({write(I,L,H){E.push(I),H()}});return new Promise((I,L)=>{N.on("error",L).on("finish",()=>I(o.concat(E))),a.write(x,y).pipe(N)})},a.writeToString=(x,y)=>a.writeToBuffer(x,y).then(E=>E.toString()),a.writeToPath=(x,y,E)=>{const N=f.createWriteStream(x,{encoding:"utf8"});return a.write(y,E).pipe(N)}}).call(this)}).call(this,e("buffer").Buffer)},{"./CsvFormatterStream":146,"./FormatterOptions":147,"./types":152,buffer:220,fs:216,stream:505,util:527}],152:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.isSyncTransform=void 0,a.isSyncTransform=o=>o.length===1},{}],153:[function(e,n,a){(function(o){(function(){Object.defineProperty(a,"__esModule",{value:!0}),a.CsvParserStream=void 0;const s=e("string_decoder"),l=e("stream"),c=e("./transforms"),i=e("./parser");class u extends l.Transform{constructor(f){super({objectMode:f.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=f,this.parser=new i.Parser(f),this.headerTransformer=new c.HeaderTransformer(f),this.decoder=new s.StringDecoder(f.encoding),this.rowTransformerValidator=new c.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(f){return this.rowTransformerValidator.rowTransform=f,this}validate(f){return this.rowTransformerValidator.rowValidator=f,this}emit(f){if(f==="end")return this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1;for(var h=arguments.length,v=new Array(h>1?h-1:0),b=1;b<h;b++)v[b-1]=arguments[b];return super.emit(f,...v)}_transform(f,h,v){if(this.hasHitRowLimit)return v();const b=u.wrapDoneCallback(v);try{const{lines:g}=this,x=g+this.decoder.write(f),y=this.parse(x,!0);return this.processRows(y,b)}catch(g){return b(g)}}_flush(f){const h=u.wrapDoneCallback(f);if(this.hasHitRowLimit)return h();try{const v=this.lines+this.decoder.end(),b=this.parse(v,!1);return this.processRows(b,h)}catch(v){return h(v)}}parse(f,h){if(!f)return[];const{line:v,rows:b}=this.parser.parse(f,h);return this.lines=v,b}processRows(f,h){const v=f.length,b=g=>{const x=N=>N?h(N):g%100!=0?b(g+1):void o(()=>b(g+1));if(this.checkAndEmitHeaders(),g>=v||this.hasHitRowLimit)return h();if(this.parsedLineCount+=1,this.shouldSkipLine)return x();const y=f[g];this.rowCount+=1,this.parsedRowCount+=1;const E=this.rowCount;return this.transformRow(y,(N,I)=>{if(N)return this.rowCount-=1,x(N);if(!I)return x(new Error("expected transform result"));if(I.isValid){if(I.row)return this.pushRow(I.row,x)}else this.emit("data-invalid",I.row,E,I.reason);return x()})};b(0)}transformRow(f,h){try{this.headerTransformer.transform(f,(v,b)=>v?h(v):b?b.isValid?b.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(b.row,h):this.skipRow(h):(this.rowCount-=1,this.parsedRowCount-=1,h(null,{row:null,isValid:!0})):this.shouldEmitRows?h(null,{isValid:!1,row:f}):this.skipRow(h):h(new Error("Expected result from header transform")))}catch(v){h(v)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(f){return this.rowCount-=1,f(null,{row:null,isValid:!0})}pushRow(f,h){try{this.parserOptions.objectMode?this.push(f):this.push(JSON.stringify(f)),h()}catch(v){h(v)}}static wrapDoneCallback(f){let h=!1;return function(v){if(v){if(h)throw v;return h=!0,void f(v)}for(var b=arguments.length,g=new Array(b>1?b-1:0),x=1;x<b;x++)g[x-1]=arguments[x];f(...g)}}}a.CsvParserStream=u}).call(this)}).call(this,e("timers").setImmediate)},{"./parser":165,"./transforms":168,stream:505,string_decoder:218,timers:523}],154:[function(e,n,a){var o=function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(a,"__esModule",{value:!0}),a.ParserOptions=void 0;const s=o(e("lodash.escaperegexp")),l=o(e("lodash.isnil"));a.ParserOptions=class{constructor(c){var i;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,c||{}),this.delimiter.length>1)throw new Error("delimiter option must be one character long");this.escapedDelimiter=s.default(this.delimiter),this.escapeChar=(i=this.escape)!==null&&i!==void 0?i:this.quote,this.supportsComments=!l.default(this.comment),this.NEXT_TOKEN_REGEXP=new RegExp(`([^\\s]|\\r\\n|\\n|\\r|${this.escapedDelimiter})`),this.maxRows>0&&(this.limitRows=!0)}}},{"lodash.escaperegexp":442,"lodash.isnil":447}],155:[function(e,n,a){var o=Object.create?function(b,g,x,y){y===void 0&&(y=x),Object.defineProperty(b,y,{enumerable:!0,get:function(){return g[x]}})}:function(b,g,x,y){y===void 0&&(y=x),b[y]=g[x]},s=Object.create?function(b,g){Object.defineProperty(b,"default",{enumerable:!0,value:g})}:function(b,g){b.default=g},l=function(b){if(b&&b.__esModule)return b;var g={};if(b!=null)for(var x in b)x!=="default"&&Object.prototype.hasOwnProperty.call(b,x)&&o(g,b,x);return s(g,b),g},c=function(b,g){for(var x in b)x==="default"||Object.prototype.hasOwnProperty.call(g,x)||o(g,b,x)};Object.defineProperty(a,"__esModule",{value:!0}),a.parseString=a.parseFile=a.parseStream=a.parse=a.ParserOptions=a.CsvParserStream=void 0;const i=l(e("fs")),u=e("stream"),p=e("./ParserOptions"),f=e("./CsvParserStream");c(e("./types"),a);var h=e("./CsvParserStream");Object.defineProperty(a,"CsvParserStream",{enumerable:!0,get:function(){return h.CsvParserStream}});var v=e("./ParserOptions");Object.defineProperty(a,"ParserOptions",{enumerable:!0,get:function(){return v.ParserOptions}}),a.parse=b=>new f.CsvParserStream(new p.ParserOptions(b)),a.parseStream=(b,g)=>b.pipe(new f.CsvParserStream(new p.ParserOptions(g))),a.parseFile=function(b){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return i.createReadStream(b).pipe(new f.CsvParserStream(new p.ParserOptions(g)))},a.parseString=(b,g)=>{const x=new u.Readable;return x.push(b),x.push(null),x.pipe(new f.CsvParserStream(new p.ParserOptions(g)))}},{"./CsvParserStream":153,"./ParserOptions":154,"./types":169,fs:216,stream:505}],156:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.Parser=void 0;const o=e("./Scanner"),s=e("./RowParser"),l=e("./Token");class c{constructor(u){this.parserOptions=u,this.rowParser=new s.RowParser(this.parserOptions)}static removeBOM(u){return u&&u.charCodeAt(0)===65279?u.slice(1):u}parse(u,p){const f=new o.Scanner({line:c.removeBOM(u),parserOptions:this.parserOptions,hasMoreData:p});return this.parserOptions.supportsComments?this.parseWithComments(f):this.parseWithoutComments(f)}parseWithoutComments(u){const p=[];let f=!0;for(;f;)f=this.parseRow(u,p);return{line:u.line,rows:p}}parseWithComments(u){const{parserOptions:p}=this,f=[];for(let h=u.nextCharacterToken;h!==null;h=u.nextCharacterToken)if(l.Token.isTokenComment(h,p)){if(u.advancePastLine()===null)return{line:u.lineFromCursor,rows:f};if(!u.hasMoreCharacters)return{line:u.lineFromCursor,rows:f};u.truncateToCursor()}else if(!this.parseRow(u,f))break;return{line:u.line,rows:f}}parseRow(u,p){if(!u.nextNonSpaceToken)return!1;const f=this.rowParser.parse(u);return f!==null&&(this.parserOptions.ignoreEmpty&&s.RowParser.isEmptyRow(f)||p.push(f),!0)}}a.Parser=c},{"./RowParser":157,"./Scanner":158,"./Token":159}],157:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.RowParser=void 0;const o=e("./column"),s=e("./Token");a.RowParser=class{constructor(l){this.parserOptions=l,this.columnParser=new o.ColumnParser(l)}static isEmptyRow(l){return l.join("").replace(/\s+/g,"")===""}parse(l){const{parserOptions:c}=this,{hasMoreData:i}=l,u=l,p=[];let f=this.getStartToken(u,p);for(;f;){if(s.Token.isTokenRowDelimiter(f))return u.advancePastToken(f),!u.hasMoreCharacters&&s.Token.isTokenCarriageReturn(f,c)&&i?null:(u.truncateToCursor(),p);if(!this.shouldSkipColumnParse(u,f,p)){const h=this.columnParser.parse(u);if(h===null)return null;p.push(h)}f=u.nextNonSpaceToken}return i?null:(u.truncateToCursor(),p)}getStartToken(l,c){const i=l.nextNonSpaceToken;return i!==null&&s.Token.isTokenDelimiter(i,this.parserOptions)?(c.push(""),l.nextNonSpaceToken):i}shouldSkipColumnParse(l,c,i){const{parserOptions:u}=this;if(s.Token.isTokenDelimiter(c,u)){l.advancePastToken(c);const p=l.nextCharacterToken;if(!l.hasMoreCharacters||p!==null&&s.Token.isTokenRowDelimiter(p)||p!==null&&s.Token.isTokenDelimiter(p,u))return i.push(""),!0}return!1}}},{"./Token":159,"./column":164}],158:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.Scanner=void 0;const o=e("./Token"),s=/((?:\r\n)|\n|\r)/;a.Scanner=class{constructor(l){this.cursor=0,this.line=l.line,this.lineLength=this.line.length,this.parserOptions=l.parserOptions,this.hasMoreData=l.hasMoreData,this.cursor=l.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){const{lineFromCursor:l}=this,c=this.parserOptions.NEXT_TOKEN_REGEXP;if(l.search(c)===-1)return null;const i=c.exec(l);if(i==null)return null;const u=i[1],p=this.cursor+(i.index||0);return new o.Token({token:u,startCursor:p,endCursor:p+u.length-1})}get nextCharacterToken(){const{cursor:l,lineLength:c}=this;return c<=l?null:new o.Token({token:this.line[l],startCursor:l,endCursor:l})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){const l=s.exec(this.lineFromCursor);return l?(this.cursor+=(l.index||0)+l[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(l){return this.cursor=l,this}advanceToToken(l){return this.cursor=l.startCursor,this}advancePastToken(l){return this.cursor=l.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}}},{"./Token":159}],159:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.Token=void 0,a.Token=class{constructor(o){this.token=o.token,this.startCursor=o.startCursor,this.endCursor=o.endCursor}static isTokenRowDelimiter(o){const s=o.token;return s==="\r"||s===`
`||s===`\r
`}static isTokenCarriageReturn(o,s){return o.token===s.carriageReturn}static isTokenComment(o,s){return s.supportsComments&&!!o&&o.token===s.comment}static isTokenEscapeCharacter(o,s){return o.token===s.escapeChar}static isTokenQuote(o,s){return o.token===s.quote}static isTokenDelimiter(o,s){return o.token===s.delimiter}}},{}],160:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.ColumnFormatter=void 0,a.ColumnFormatter=class{constructor(o){o.trim?this.format=s=>s.trim():o.ltrim?this.format=s=>s.trimLeft():o.rtrim?this.format=s=>s.trimRight():this.format=s=>s}}},{}],161:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.ColumnParser=void 0;const o=e("./NonQuotedColumnParser"),s=e("./QuotedColumnParser"),l=e("../Token");a.ColumnParser=class{constructor(c){this.parserOptions=c,this.quotedColumnParser=new s.QuotedColumnParser(c),this.nonQuotedColumnParser=new o.NonQuotedColumnParser(c)}parse(c){const{nextNonSpaceToken:i}=c;return i!==null&&l.Token.isTokenQuote(i,this.parserOptions)?(c.advanceToToken(i),this.quotedColumnParser.parse(c)):this.nonQuotedColumnParser.parse(c)}}},{"../Token":159,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],162:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.NonQuotedColumnParser=void 0;const o=e("./ColumnFormatter"),s=e("../Token");a.NonQuotedColumnParser=class{constructor(l){this.parserOptions=l,this.columnFormatter=new o.ColumnFormatter(l)}parse(l){if(!l.hasMoreCharacters)return null;const{parserOptions:c}=this,i=[];let u=l.nextCharacterToken;for(;u&&!s.Token.isTokenDelimiter(u,c)&&!s.Token.isTokenRowDelimiter(u);u=l.nextCharacterToken)i.push(u.token),l.advancePastToken(u);return this.columnFormatter.format(i.join(""))}}},{"../Token":159,"./ColumnFormatter":160}],163:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.QuotedColumnParser=void 0;const o=e("./ColumnFormatter"),s=e("../Token");a.QuotedColumnParser=class{constructor(l){this.parserOptions=l,this.columnFormatter=new o.ColumnFormatter(l)}parse(l){if(!l.hasMoreCharacters)return null;const c=l.cursor,{foundClosingQuote:i,col:u}=this.gatherDataBetweenQuotes(l);if(!i){if(l.advanceTo(c),!l.hasMoreData)throw new Error(`Parse Error: missing closing: '${this.parserOptions.quote||""}' in line: at '${l.lineFromCursor.replace(/[\r\n]/g,"\\n'")}'`);return null}return this.checkForMalformedColumn(l),u}gatherDataBetweenQuotes(l){const{parserOptions:c}=this;let i=!1,u=!1;const p=[];let f=l.nextCharacterToken;for(;!u&&f!==null;f=l.nextCharacterToken){const h=s.Token.isTokenQuote(f,c);if(!i&&h)i=!0;else if(i)if(s.Token.isTokenEscapeCharacter(f,c)){l.advancePastToken(f);const v=l.nextCharacterToken;v!==null&&(s.Token.isTokenQuote(v,c)||s.Token.isTokenEscapeCharacter(v,c))?(p.push(v.token),f=v):h?u=!0:p.push(f.token)}else h?u=!0:p.push(f.token);l.advancePastToken(f)}return{col:this.columnFormatter.format(p.join("")),foundClosingQuote:u}}checkForMalformedColumn(l){const{parserOptions:c}=this,{nextNonSpaceToken:i}=l;if(i){const u=s.Token.isTokenDelimiter(i,c),p=s.Token.isTokenRowDelimiter(i);if(!u&&!p){const f=l.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw new Error(`Parse Error: expected: '${c.escapedDelimiter}' OR new line got: '${i.token}'. at '${f}`)}l.advanceToToken(i)}else l.hasMoreData||l.advancePastLine()}}},{"../Token":159,"./ColumnFormatter":160}],164:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.ColumnFormatter=a.QuotedColumnParser=a.NonQuotedColumnParser=a.ColumnParser=void 0;var o=e("./ColumnParser");Object.defineProperty(a,"ColumnParser",{enumerable:!0,get:function(){return o.ColumnParser}});var s=e("./NonQuotedColumnParser");Object.defineProperty(a,"NonQuotedColumnParser",{enumerable:!0,get:function(){return s.NonQuotedColumnParser}});var l=e("./QuotedColumnParser");Object.defineProperty(a,"QuotedColumnParser",{enumerable:!0,get:function(){return l.QuotedColumnParser}});var c=e("./ColumnFormatter");Object.defineProperty(a,"ColumnFormatter",{enumerable:!0,get:function(){return c.ColumnFormatter}})},{"./ColumnFormatter":160,"./ColumnParser":161,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],165:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.QuotedColumnParser=a.NonQuotedColumnParser=a.ColumnParser=a.Token=a.Scanner=a.RowParser=a.Parser=void 0;var o=e("./Parser");Object.defineProperty(a,"Parser",{enumerable:!0,get:function(){return o.Parser}});var s=e("./RowParser");Object.defineProperty(a,"RowParser",{enumerable:!0,get:function(){return s.RowParser}});var l=e("./Scanner");Object.defineProperty(a,"Scanner",{enumerable:!0,get:function(){return l.Scanner}});var c=e("./Token");Object.defineProperty(a,"Token",{enumerable:!0,get:function(){return c.Token}});var i=e("./column");Object.defineProperty(a,"ColumnParser",{enumerable:!0,get:function(){return i.ColumnParser}}),Object.defineProperty(a,"NonQuotedColumnParser",{enumerable:!0,get:function(){return i.NonQuotedColumnParser}}),Object.defineProperty(a,"QuotedColumnParser",{enumerable:!0,get:function(){return i.QuotedColumnParser}})},{"./Parser":156,"./RowParser":157,"./Scanner":158,"./Token":159,"./column":164}],166:[function(e,n,a){var o=function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(a,"__esModule",{value:!0}),a.HeaderTransformer=void 0;const s=o(e("lodash.isundefined")),l=o(e("lodash.isfunction")),c=o(e("lodash.uniq")),i=o(e("lodash.groupby"));a.HeaderTransformer=class{constructor(u){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=u,u.headers===!0?this.shouldUseFirstRow=!0:Array.isArray(u.headers)?this.setHeaders(u.headers):l.default(u.headers)&&(this.headersTransform=u.headers)}transform(u,p){return this.shouldMapRow(u)?p(null,this.processRow(u)):p(null,{row:null,isValid:!0})}shouldMapRow(u){const{parserOptions:p}=this;if(!this.headersTransform&&p.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw new Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(u)){if(this.headersTransform)this.setHeaders(this.headersTransform(u));else{if(!this.shouldUseFirstRow)return!0;this.setHeaders(u)}return!1}return!0}processRow(u){if(!this.headers)return{row:u,isValid:!0};const{parserOptions:p}=this;if(!p.discardUnmappedColumns&&u.length>this.headersLength){if(!p.strictColumnHandling)throw new Error(`Unexpected Error: column header mismatch expected: ${this.headersLength} columns got: ${u.length}`);return{row:u,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${u.length}`}}return p.strictColumnHandling&&u.length<this.headersLength?{row:u,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${u.length}`}:{row:this.mapHeaders(u),isValid:!0}}mapHeaders(u){const p={},{headers:f,headersLength:h}=this;for(let v=0;v<h;v+=1){const b=f[v];if(!s.default(b)){const g=u[v];s.default(g)?p[b]="":p[b]=g}}return p}setHeaders(u){var p;const f=u.filter(h=>!!h);if(c.default(f).length!==f.length){const h=i.default(f),v=Object.keys(h).filter(b=>h[b].length>1);throw new Error("Duplicate headers found "+JSON.stringify(v))}this.headers=u,this.receivedHeaders=!0,this.headersLength=((p=this.headers)===null||p===void 0?void 0:p.length)||0}}},{"lodash.groupby":443,"lodash.isfunction":446,"lodash.isundefined":448,"lodash.uniq":449}],167:[function(e,n,a){var o=function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(a,"__esModule",{value:!0}),a.RowTransformerValidator=void 0;const s=o(e("lodash.isfunction")),l=e("../types");class c{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(u){return l.isSyncTransform(u)?(p,f)=>{let h=null;try{h=u(p)}catch(v){return f(v)}return f(null,h)}:u}static createValidator(u){return l.isSyncValidate(u)?(p,f)=>{f(null,{row:p,isValid:u(p)})}:(p,f)=>{u(p,(h,v,b)=>h?f(h):f(null,v?{row:p,isValid:v,reason:b}:{row:p,isValid:!1,reason:b}))}}set rowTransform(u){if(!s.default(u))throw new TypeError("The transform should be a function");this._rowTransform=c.createTransform(u)}set rowValidator(u){if(!s.default(u))throw new TypeError("The validate should be a function");this._rowValidator=c.createValidator(u)}transformAndValidate(u,p){return this.callTransformer(u,(f,h)=>f?p(f):h?this.callValidator(h,(v,b)=>v?p(v):b&&!b.isValid?p(null,{row:h,isValid:!1,reason:b.reason}):p(null,{row:h,isValid:!0})):p(null,{row:null,isValid:!0}))}callTransformer(u,p){return this._rowTransform?this._rowTransform(u,p):p(null,u)}callValidator(u,p){return this._rowValidator?this._rowValidator(u,p):p(null,{row:u,isValid:!0})}}a.RowTransformerValidator=c},{"../types":169,"lodash.isfunction":446}],168:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.HeaderTransformer=a.RowTransformerValidator=void 0;var o=e("./RowTransformerValidator");Object.defineProperty(a,"RowTransformerValidator",{enumerable:!0,get:function(){return o.RowTransformerValidator}});var s=e("./HeaderTransformer");Object.defineProperty(a,"HeaderTransformer",{enumerable:!0,get:function(){return s.HeaderTransformer}})},{"./HeaderTransformer":166,"./RowTransformerValidator":167}],169:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.isSyncValidate=a.isSyncTransform=void 0,a.isSyncTransform=o=>o.length===1,a.isSyncValidate=o=>o.length===1},{}],170:[function(e,n,a){const o=a;o.bignum=e("bn.js"),o.define=e("./asn1/api").define,o.base=e("./asn1/base"),o.constants=e("./asn1/constants"),o.decoders=e("./asn1/decoders"),o.encoders=e("./asn1/encoders")},{"./asn1/api":171,"./asn1/base":173,"./asn1/constants":177,"./asn1/decoders":179,"./asn1/encoders":182,"bn.js":184}],171:[function(e,n,a){const o=e("./encoders"),s=e("./decoders"),l=e("inherits");function c(i,u){this.name=i,this.body=u,this.decoders={},this.encoders={}}a.define=function(i,u){return new c(i,u)},c.prototype._createNamed=function(i){const u=this.name;function p(f){this._initNamed(f,u)}return l(p,i),p.prototype._initNamed=function(f,h){i.call(this,f,h)},new p(this)},c.prototype._getDecoder=function(i){return i=i||"der",this.decoders.hasOwnProperty(i)||(this.decoders[i]=this._createNamed(s[i])),this.decoders[i]},c.prototype.decode=function(i,u,p){return this._getDecoder(u).decode(i,p)},c.prototype._getEncoder=function(i){return i=i||"der",this.encoders.hasOwnProperty(i)||(this.encoders[i]=this._createNamed(o[i])),this.encoders[i]},c.prototype.encode=function(i,u,p){return this._getEncoder(u).encode(i,p)}},{"./decoders":179,"./encoders":182,inherits:440}],172:[function(e,n,a){const o=e("inherits"),s=e("../base/reporter").Reporter,l=e("safer-buffer").Buffer;function c(u,p){s.call(this,p),l.isBuffer(u)?(this.base=u,this.offset=0,this.length=u.length):this.error("Input not Buffer")}function i(u,p){if(Array.isArray(u))this.length=0,this.value=u.map(function(f){return i.isEncoderBuffer(f)||(f=new i(f,p)),this.length+=f.length,f},this);else if(typeof u=="number"){if(!(0<=u&&u<=255))return p.error("non-byte EncoderBuffer value");this.value=u,this.length=1}else if(typeof u=="string")this.value=u,this.length=l.byteLength(u);else{if(!l.isBuffer(u))return p.error("Unsupported type: "+typeof u);this.value=u,this.length=u.length}}o(c,s),a.DecoderBuffer=c,c.isDecoderBuffer=function(u){return u instanceof c?!0:typeof u=="object"&&l.isBuffer(u.base)&&u.constructor.name==="DecoderBuffer"&&typeof u.offset=="number"&&typeof u.length=="number"&&typeof u.save=="function"&&typeof u.restore=="function"&&typeof u.isEmpty=="function"&&typeof u.readUInt8=="function"&&typeof u.skip=="function"&&typeof u.raw=="function"},c.prototype.save=function(){return{offset:this.offset,reporter:s.prototype.save.call(this)}},c.prototype.restore=function(u){const p=new c(this.base);return p.offset=u.offset,p.length=this.offset,this.offset=u.offset,s.prototype.restore.call(this,u.reporter),p},c.prototype.isEmpty=function(){return this.offset===this.length},c.prototype.readUInt8=function(u){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(u||"DecoderBuffer overrun")},c.prototype.skip=function(u,p){if(!(this.offset+u<=this.length))return this.error(p||"DecoderBuffer overrun");const f=new c(this.base);return f._reporterState=this._reporterState,f.offset=this.offset,f.length=this.offset+u,this.offset+=u,f},c.prototype.raw=function(u){return this.base.slice(u?u.offset:this.offset,this.length)},a.EncoderBuffer=i,i.isEncoderBuffer=function(u){return u instanceof i?!0:typeof u=="object"&&u.constructor.name==="EncoderBuffer"&&typeof u.length=="number"&&typeof u.join=="function"},i.prototype.join=function(u,p){return u||(u=l.alloc(this.length)),p||(p=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(f){f.join(u,p),p+=f.length}):(typeof this.value=="number"?u[p]=this.value:typeof this.value=="string"?u.write(this.value,p):l.isBuffer(this.value)&&this.value.copy(u,p),p+=this.length)),u}},{"../base/reporter":175,inherits:440,"safer-buffer":495}],173:[function(e,n,a){const o=a;o.Reporter=e("./reporter").Reporter,o.DecoderBuffer=e("./buffer").DecoderBuffer,o.EncoderBuffer=e("./buffer").EncoderBuffer,o.Node=e("./node")},{"./buffer":172,"./node":174,"./reporter":175}],174:[function(e,n,a){const o=e("../base/reporter").Reporter,s=e("../base/buffer").EncoderBuffer,l=e("../base/buffer").DecoderBuffer,c=e("minimalistic-assert"),i=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],u=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(i);function p(h,v,b){const g={};this._baseState=g,g.name=b,g.enc=h,g.parent=v||null,g.children=null,g.tag=null,g.args=null,g.reverseArgs=null,g.choice=null,g.optional=!1,g.any=!1,g.obj=!1,g.use=null,g.useDecoder=null,g.key=null,g.default=null,g.explicit=null,g.implicit=null,g.contains=null,g.parent||(g.children=[],this._wrap())}n.exports=p;const f=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];p.prototype.clone=function(){const h=this._baseState,v={};f.forEach(function(g){v[g]=h[g]});const b=new this.constructor(v.parent);return b._baseState=v,b},p.prototype._wrap=function(){const h=this._baseState;u.forEach(function(v){this[v]=function(){const b=new this.constructor(this);return h.children.push(b),b[v].apply(b,arguments)}},this)},p.prototype._init=function(h){const v=this._baseState;c(v.parent===null),h.call(this),v.children=v.children.filter(function(b){return b._baseState.parent===this},this),c.equal(v.children.length,1,"Root node can have only one child")},p.prototype._useArgs=function(h){const v=this._baseState,b=h.filter(function(g){return g instanceof this.constructor},this);h=h.filter(function(g){return!(g instanceof this.constructor)},this),b.length!==0&&(c(v.children===null),v.children=b,b.forEach(function(g){g._baseState.parent=this},this)),h.length!==0&&(c(v.args===null),v.args=h,v.reverseArgs=h.map(function(g){if(typeof g!="object"||g.constructor!==Object)return g;const x={};return Object.keys(g).forEach(function(y){y==(0|y)&&(y|=0);const E=g[y];x[E]=y}),x}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(h){p.prototype[h]=function(){const v=this._baseState;throw new Error(h+" not implemented for encoding: "+v.enc)}}),i.forEach(function(h){p.prototype[h]=function(){const v=this._baseState,b=Array.prototype.slice.call(arguments);return c(v.tag===null),v.tag=h,this._useArgs(b),this}}),p.prototype.use=function(h){c(h);const v=this._baseState;return c(v.use===null),v.use=h,this},p.prototype.optional=function(){return this._baseState.optional=!0,this},p.prototype.def=function(h){const v=this._baseState;return c(v.default===null),v.default=h,v.optional=!0,this},p.prototype.explicit=function(h){const v=this._baseState;return c(v.explicit===null&&v.implicit===null),v.explicit=h,this},p.prototype.implicit=function(h){const v=this._baseState;return c(v.explicit===null&&v.implicit===null),v.implicit=h,this},p.prototype.obj=function(){const h=this._baseState,v=Array.prototype.slice.call(arguments);return h.obj=!0,v.length!==0&&this._useArgs(v),this},p.prototype.key=function(h){const v=this._baseState;return c(v.key===null),v.key=h,this},p.prototype.any=function(){return this._baseState.any=!0,this},p.prototype.choice=function(h){const v=this._baseState;return c(v.choice===null),v.choice=h,this._useArgs(Object.keys(h).map(function(b){return h[b]})),this},p.prototype.contains=function(h){const v=this._baseState;return c(v.use===null),v.contains=h,this},p.prototype._decode=function(h,v){const b=this._baseState;if(b.parent===null)return h.wrapResult(b.children[0]._decode(h,v));let g,x=b.default,y=!0,E=null;if(b.key!==null&&(E=h.enterKey(b.key)),b.optional){let N=null;if(b.explicit!==null?N=b.explicit:b.implicit!==null?N=b.implicit:b.tag!==null&&(N=b.tag),N!==null||b.any){if(y=this._peekTag(h,N,b.any),h.isError(y))return y}else{const I=h.save();try{b.choice===null?this._decodeGeneric(b.tag,h,v):this._decodeChoice(h,v),y=!0}catch{y=!1}h.restore(I)}}if(b.obj&&y&&(g=h.enterObject()),y){if(b.explicit!==null){const I=this._decodeTag(h,b.explicit);if(h.isError(I))return I;h=I}const N=h.offset;if(b.use===null&&b.choice===null){let I;b.any&&(I=h.save());const L=this._decodeTag(h,b.implicit!==null?b.implicit:b.tag,b.any);if(h.isError(L))return L;b.any?x=h.raw(I):h=L}if(v&&v.track&&b.tag!==null&&v.track(h.path(),N,h.length,"tagged"),v&&v.track&&b.tag!==null&&v.track(h.path(),h.offset,h.length,"content"),b.any||(x=b.choice===null?this._decodeGeneric(b.tag,h,v):this._decodeChoice(h,v)),h.isError(x))return x;if(b.any||b.choice!==null||b.children===null||b.children.forEach(function(I){I._decode(h,v)}),b.contains&&(b.tag==="octstr"||b.tag==="bitstr")){const I=new l(x);x=this._getUse(b.contains,h._reporterState.obj)._decode(I,v)}}return b.obj&&y&&(x=h.leaveObject(g)),b.key===null||x===null&&y!==!0?E!==null&&h.exitKey(E):h.leaveKey(E,b.key,x),x},p.prototype._decodeGeneric=function(h,v,b){const g=this._baseState;return h==="seq"||h==="set"?null:h==="seqof"||h==="setof"?this._decodeList(v,h,g.args[0],b):/str$/.test(h)?this._decodeStr(v,h,b):h==="objid"&&g.args?this._decodeObjid(v,g.args[0],g.args[1],b):h==="objid"?this._decodeObjid(v,null,null,b):h==="gentime"||h==="utctime"?this._decodeTime(v,h,b):h==="null_"?this._decodeNull(v,b):h==="bool"?this._decodeBool(v,b):h==="objDesc"?this._decodeStr(v,h,b):h==="int"||h==="enum"?this._decodeInt(v,g.args&&g.args[0],b):g.use!==null?this._getUse(g.use,v._reporterState.obj)._decode(v,b):v.error("unknown tag: "+h)},p.prototype._getUse=function(h,v){const b=this._baseState;return b.useDecoder=this._use(h,v),c(b.useDecoder._baseState.parent===null),b.useDecoder=b.useDecoder._baseState.children[0],b.implicit!==b.useDecoder._baseState.implicit&&(b.useDecoder=b.useDecoder.clone(),b.useDecoder._baseState.implicit=b.implicit),b.useDecoder},p.prototype._decodeChoice=function(h,v){const b=this._baseState;let g=null,x=!1;return Object.keys(b.choice).some(function(y){const E=h.save(),N=b.choice[y];try{const I=N._decode(h,v);if(h.isError(I))return!1;g={type:y,value:I},x=!0}catch{return h.restore(E),!1}return!0},this),x?g:h.error("Choice not matched")},p.prototype._createEncoderBuffer=function(h){return new s(h,this.reporter)},p.prototype._encode=function(h,v,b){const g=this._baseState;if(g.default!==null&&g.default===h)return;const x=this._encodeValue(h,v,b);return x===void 0||this._skipDefault(x,v,b)?void 0:x},p.prototype._encodeValue=function(h,v,b){const g=this._baseState;if(g.parent===null)return g.children[0]._encode(h,v||new o);let x=null;if(this.reporter=v,g.optional&&h===void 0){if(g.default===null)return;h=g.default}let y=null,E=!1;if(g.any)x=this._createEncoderBuffer(h);else if(g.choice)x=this._encodeChoice(h,v);else if(g.contains)y=this._getUse(g.contains,b)._encode(h,v),E=!0;else if(g.children)y=g.children.map(function(N){if(N._baseState.tag==="null_")return N._encode(null,v,h);if(N._baseState.key===null)return v.error("Child should have a key");const I=v.enterKey(N._baseState.key);if(typeof h!="object")return v.error("Child expected, but input is not object");const L=N._encode(h[N._baseState.key],v,h);return v.leaveKey(I),L},this).filter(function(N){return N}),y=this._createEncoderBuffer(y);else if(g.tag==="seqof"||g.tag==="setof"){if(!g.args||g.args.length!==1)return v.error("Too many args for : "+g.tag);if(!Array.isArray(h))return v.error("seqof/setof, but data is not Array");const N=this.clone();N._baseState.implicit=null,y=this._createEncoderBuffer(h.map(function(I){const L=this._baseState;return this._getUse(L.args[0],h)._encode(I,v)},N))}else g.use!==null?x=this._getUse(g.use,b)._encode(h,v):(y=this._encodePrimitive(g.tag,h),E=!0);if(!g.any&&g.choice===null){const N=g.implicit!==null?g.implicit:g.tag,I=g.implicit===null?"universal":"context";N===null?g.use===null&&v.error("Tag could be omitted only for .use()"):g.use===null&&(x=this._encodeComposite(N,E,I,y))}return g.explicit!==null&&(x=this._encodeComposite(g.explicit,!1,"context",x)),x},p.prototype._encodeChoice=function(h,v){const b=this._baseState,g=b.choice[h.type];return g||c(!1,h.type+" not found in "+JSON.stringify(Object.keys(b.choice))),g._encode(h.value,v)},p.prototype._encodePrimitive=function(h,v){const b=this._baseState;if(/str$/.test(h))return this._encodeStr(v,h);if(h==="objid"&&b.args)return this._encodeObjid(v,b.reverseArgs[0],b.args[1]);if(h==="objid")return this._encodeObjid(v,null,null);if(h==="gentime"||h==="utctime")return this._encodeTime(v,h);if(h==="null_")return this._encodeNull();if(h==="int"||h==="enum")return this._encodeInt(v,b.args&&b.reverseArgs[0]);if(h==="bool")return this._encodeBool(v);if(h==="objDesc")return this._encodeStr(v,h);throw new Error("Unsupported tag: "+h)},p.prototype._isNumstr=function(h){return/^[0-9 ]*$/.test(h)},p.prototype._isPrintstr=function(h){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(h)}},{"../base/buffer":172,"../base/reporter":175,"minimalistic-assert":453}],175:[function(e,n,a){const o=e("inherits");function s(c){this._reporterState={obj:null,path:[],options:c||{},errors:[]}}function l(c,i){this.path=c,this.rethrow(i)}a.Reporter=s,s.prototype.isError=function(c){return c instanceof l},s.prototype.save=function(){const c=this._reporterState;return{obj:c.obj,pathLen:c.path.length}},s.prototype.restore=function(c){const i=this._reporterState;i.obj=c.obj,i.path=i.path.slice(0,c.pathLen)},s.prototype.enterKey=function(c){return this._reporterState.path.push(c)},s.prototype.exitKey=function(c){const i=this._reporterState;i.path=i.path.slice(0,c-1)},s.prototype.leaveKey=function(c,i,u){const p=this._reporterState;this.exitKey(c),p.obj!==null&&(p.obj[i]=u)},s.prototype.path=function(){return this._reporterState.path.join("/")},s.prototype.enterObject=function(){const c=this._reporterState,i=c.obj;return c.obj={},i},s.prototype.leaveObject=function(c){const i=this._reporterState,u=i.obj;return i.obj=c,u},s.prototype.error=function(c){let i;const u=this._reporterState,p=c instanceof l;if(i=p?c:new l(u.path.map(function(f){return"["+JSON.stringify(f)+"]"}).join(""),c.message||c,c.stack),!u.options.partial)throw i;return p||u.errors.push(i),i},s.prototype.wrapResult=function(c){const i=this._reporterState;return i.options.partial?{result:this.isError(c)?null:c,errors:i.errors}:c},o(l,Error),l.prototype.rethrow=function(c){if(this.message=c+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,l),!this.stack)try{throw new Error(this.message)}catch(i){this.stack=i.stack}return this}},{inherits:440}],176:[function(e,n,a){function o(s){const l={};return Object.keys(s).forEach(function(c){(0|c)==c&&(c|=0);const i=s[c];l[i]=c}),l}a.tagClass={0:"universal",1:"application",2:"context",3:"private"},a.tagClassByName=o(a.tagClass),a.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},a.tagByName=o(a.tag)},{}],177:[function(e,n,a){const o=a;o._reverse=function(s){const l={};return Object.keys(s).forEach(function(c){(0|c)==c&&(c|=0);const i=s[c];l[i]=c}),l},o.der=e("./der")},{"./der":176}],178:[function(e,n,a){const o=e("inherits"),s=e("bn.js"),l=e("../base/buffer").DecoderBuffer,c=e("../base/node"),i=e("../constants/der");function u(v){this.enc="der",this.name=v.name,this.entity=v,this.tree=new p,this.tree._init(v.body)}function p(v){c.call(this,"der",v)}function f(v,b){let g=v.readUInt8(b);if(v.isError(g))return g;const x=i.tagClass[g>>6],y=(32&g)==0;if((31&g)==31){let E=g;for(g=0;(128&E)==128;){if(E=v.readUInt8(b),v.isError(E))return E;g<<=7,g|=127&E}}else g&=31;return{cls:x,primitive:y,tag:g,tagStr:i.tag[g]}}function h(v,b,g){let x=v.readUInt8(g);if(v.isError(x))return x;if(!b&&x===128)return null;if((128&x)==0)return x;const y=127&x;if(y>4)return v.error("length octect is too long");x=0;for(let E=0;E<y;E++){x<<=8;const N=v.readUInt8(g);if(v.isError(N))return N;x|=N}return x}n.exports=u,u.prototype.decode=function(v,b){return l.isDecoderBuffer(v)||(v=new l(v,b)),this.tree._decode(v,b)},o(p,c),p.prototype._peekTag=function(v,b,g){if(v.isEmpty())return!1;const x=v.save(),y=f(v,'Failed to peek tag: "'+b+'"');return v.isError(y)?y:(v.restore(x),y.tag===b||y.tagStr===b||y.tagStr+"of"===b||g)},p.prototype._decodeTag=function(v,b,g){const x=f(v,'Failed to decode tag of "'+b+'"');if(v.isError(x))return x;let y=h(v,x.primitive,'Failed to get length of "'+b+'"');if(v.isError(y))return y;if(!g&&x.tag!==b&&x.tagStr!==b&&x.tagStr+"of"!==b)return v.error('Failed to match tag: "'+b+'"');if(x.primitive||y!==null)return v.skip(y,'Failed to match body of: "'+b+'"');const E=v.save(),N=this._skipUntilEnd(v,'Failed to skip indefinite length body: "'+this.tag+'"');return v.isError(N)?N:(y=v.offset-E.offset,v.restore(E),v.skip(y,'Failed to match body of: "'+b+'"'))},p.prototype._skipUntilEnd=function(v,b){for(;;){const g=f(v,b);if(v.isError(g))return g;const x=h(v,g.primitive,b);if(v.isError(x))return x;let y;if(y=g.primitive||x!==null?v.skip(x):this._skipUntilEnd(v,b),v.isError(y))return y;if(g.tagStr==="end")break}},p.prototype._decodeList=function(v,b,g,x){const y=[];for(;!v.isEmpty();){const E=this._peekTag(v,"end");if(v.isError(E))return E;const N=g.decode(v,"der",x);if(v.isError(N)&&E)break;y.push(N)}return y},p.prototype._decodeStr=function(v,b){if(b==="bitstr"){const g=v.readUInt8();return v.isError(g)?g:{unused:g,data:v.raw()}}if(b==="bmpstr"){const g=v.raw();if(g.length%2==1)return v.error("Decoding of string type: bmpstr length mismatch");let x="";for(let y=0;y<g.length/2;y++)x+=String.fromCharCode(g.readUInt16BE(2*y));return x}if(b==="numstr"){const g=v.raw().toString("ascii");return this._isNumstr(g)?g:v.error("Decoding of string type: numstr unsupported characters")}if(b==="octstr"||b==="objDesc")return v.raw();if(b==="printstr"){const g=v.raw().toString("ascii");return this._isPrintstr(g)?g:v.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(b)?v.raw().toString():v.error("Decoding of string type: "+b+" unsupported")},p.prototype._decodeObjid=function(v,b,g){let x;const y=[];let E=0,N=0;for(;!v.isEmpty();)N=v.readUInt8(),E<<=7,E|=127&N,(128&N)==0&&(y.push(E),E=0);128&N&&y.push(E);const I=y[0]/40|0,L=y[0]%40;if(x=g?y:[I,L].concat(y.slice(1)),b){let H=b[x.join(" ")];H===void 0&&(H=b[x.join(".")]),H!==void 0&&(x=H)}return x},p.prototype._decodeTime=function(v,b){const g=v.raw().toString();let x,y,E,N,I,L;if(b==="gentime")x=0|g.slice(0,4),y=0|g.slice(4,6),E=0|g.slice(6,8),N=0|g.slice(8,10),I=0|g.slice(10,12),L=0|g.slice(12,14);else{if(b!=="utctime")return v.error("Decoding "+b+" time is not supported yet");x=0|g.slice(0,2),y=0|g.slice(2,4),E=0|g.slice(4,6),N=0|g.slice(6,8),I=0|g.slice(8,10),L=0|g.slice(10,12),x=x<70?2e3+x:1900+x}return Date.UTC(x,y-1,E,N,I,L,0)},p.prototype._decodeNull=function(){return null},p.prototype._decodeBool=function(v){const b=v.readUInt8();return v.isError(b)?b:b!==0},p.prototype._decodeInt=function(v,b){const g=v.raw();let x=new s(g);return b&&(x=b[x.toString(10)]||x),x},p.prototype._use=function(v,b){return typeof v=="function"&&(v=v(b)),v._getDecoder("der").tree}},{"../base/buffer":172,"../base/node":174,"../constants/der":176,"bn.js":184,inherits:440}],179:[function(e,n,a){const o=a;o.der=e("./der"),o.pem=e("./pem")},{"./der":178,"./pem":180}],180:[function(e,n,a){const o=e("inherits"),s=e("safer-buffer").Buffer,l=e("./der");function c(i){l.call(this,i),this.enc="pem"}o(c,l),n.exports=c,c.prototype.decode=function(i,u){const p=i.toString().split(/[\r\n]+/g),f=u.label.toUpperCase(),h=/^-----(BEGIN|END) ([^-]+)-----$/;let v=-1,b=-1;for(let y=0;y<p.length;y++){const E=p[y].match(h);if(E!==null&&E[2]===f){if(v!==-1){if(E[1]!=="END")break;b=y;break}if(E[1]!=="BEGIN")break;v=y}}if(v===-1||b===-1)throw new Error("PEM section not found for: "+f);const g=p.slice(v+1,b).join("");g.replace(/[^a-z0-9+/=]+/gi,"");const x=s.from(g,"base64");return l.prototype.decode.call(this,x,u)}},{"./der":178,inherits:440,"safer-buffer":495}],181:[function(e,n,a){const o=e("inherits"),s=e("safer-buffer").Buffer,l=e("../base/node"),c=e("../constants/der");function i(f){this.enc="der",this.name=f.name,this.entity=f,this.tree=new u,this.tree._init(f.body)}function u(f){l.call(this,"der",f)}function p(f){return f<10?"0"+f:f}n.exports=i,i.prototype.encode=function(f,h){return this.tree._encode(f,h).join()},o(u,l),u.prototype._encodeComposite=function(f,h,v,b){const g=function(E,N,I,L){let H;if(E==="seqof"?E="seq":E==="setof"&&(E="set"),c.tagByName.hasOwnProperty(E))H=c.tagByName[E];else{if(typeof E!="number"||(0|E)!==E)return L.error("Unknown tag: "+E);H=E}return H>=31?L.error("Multi-octet tag encoding unsupported"):(N||(H|=32),H|=c.tagClassByName[I||"universal"]<<6,H)}(f,h,v,this.reporter);if(b.length<128){const E=s.alloc(2);return E[0]=g,E[1]=b.length,this._createEncoderBuffer([E,b])}let x=1;for(let E=b.length;E>=256;E>>=8)x++;const y=s.alloc(2+x);y[0]=g,y[1]=128|x;for(let E=1+x,N=b.length;N>0;E--,N>>=8)y[E]=255&N;return this._createEncoderBuffer([y,b])},u.prototype._encodeStr=function(f,h){if(h==="bitstr")return this._createEncoderBuffer([0|f.unused,f.data]);if(h==="bmpstr"){const v=s.alloc(2*f.length);for(let b=0;b<f.length;b++)v.writeUInt16BE(f.charCodeAt(b),2*b);return this._createEncoderBuffer(v)}return h==="numstr"?this._isNumstr(f)?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: numstr supports only digits and space"):h==="printstr"?this._isPrintstr(f)?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(h)||h==="objDesc"?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: "+h+" unsupported")},u.prototype._encodeObjid=function(f,h,v){if(typeof f=="string"){if(!h)return this.reporter.error("string objid given, but no values map found");if(!h.hasOwnProperty(f))return this.reporter.error("objid not found in values map");f=h[f].split(/[\s.]+/g);for(let y=0;y<f.length;y++)f[y]|=0}else if(Array.isArray(f)){f=f.slice();for(let y=0;y<f.length;y++)f[y]|=0}if(!Array.isArray(f))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(f));if(!v){if(f[1]>=40)return this.reporter.error("Second objid identifier OOB");f.splice(0,2,40*f[0]+f[1])}let b=0;for(let y=0;y<f.length;y++){let E=f[y];for(b++;E>=128;E>>=7)b++}const g=s.alloc(b);let x=g.length-1;for(let y=f.length-1;y>=0;y--){let E=f[y];for(g[x--]=127&E;(E>>=7)>0;)g[x--]=128|127&E}return this._createEncoderBuffer(g)},u.prototype._encodeTime=function(f,h){let v;const b=new Date(f);return h==="gentime"?v=[p(b.getUTCFullYear()),p(b.getUTCMonth()+1),p(b.getUTCDate()),p(b.getUTCHours()),p(b.getUTCMinutes()),p(b.getUTCSeconds()),"Z"].join(""):h==="utctime"?v=[p(b.getUTCFullYear()%100),p(b.getUTCMonth()+1),p(b.getUTCDate()),p(b.getUTCHours()),p(b.getUTCMinutes()),p(b.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+h+" time is not supported yet"),this._encodeStr(v,"octstr")},u.prototype._encodeNull=function(){return this._createEncoderBuffer("")},u.prototype._encodeInt=function(f,h){if(typeof f=="string"){if(!h)return this.reporter.error("String int or enum given, but no values map");if(!h.hasOwnProperty(f))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(f));f=h[f]}if(typeof f!="number"&&!s.isBuffer(f)){const g=f.toArray();!f.sign&&128&g[0]&&g.unshift(0),f=s.from(g)}if(s.isBuffer(f)){let g=f.length;f.length===0&&g++;const x=s.alloc(g);return f.copy(x),f.length===0&&(x[0]=0),this._createEncoderBuffer(x)}if(f<128)return this._createEncoderBuffer(f);if(f<256)return this._createEncoderBuffer([0,f]);let v=1;for(let g=f;g>=256;g>>=8)v++;const b=new Array(v);for(let g=b.length-1;g>=0;g--)b[g]=255&f,f>>=8;return 128&b[0]&&b.unshift(0),this._createEncoderBuffer(s.from(b))},u.prototype._encodeBool=function(f){return this._createEncoderBuffer(f?255:0)},u.prototype._use=function(f,h){return typeof f=="function"&&(f=f(h)),f._getEncoder("der").tree},u.prototype._skipDefault=function(f,h,v){const b=this._baseState;let g;if(b.default===null)return!1;const x=f.join();if(b.defaultBuffer===void 0&&(b.defaultBuffer=this._encodeValue(b.default,h,v).join()),x.length!==b.defaultBuffer.length)return!1;for(g=0;g<x.length;g++)if(x[g]!==b.defaultBuffer[g])return!1;return!0}},{"../base/node":174,"../constants/der":176,inherits:440,"safer-buffer":495}],182:[function(e,n,a){const o=a;o.der=e("./der"),o.pem=e("./pem")},{"./der":181,"./pem":183}],183:[function(e,n,a){const o=e("inherits"),s=e("./der");function l(c){s.call(this,c),this.enc="pem"}o(l,s),n.exports=l,l.prototype.encode=function(c,i){const u=s.prototype.encode.call(this,c).toString("base64"),p=["-----BEGIN "+i.label+"-----"];for(let f=0;f<u.length;f+=64)p.push(u.slice(f,f+64));return p.push("-----END "+i.label+"-----"),p.join(`
`)}},{"./der":181,inherits:440}],184:[function(e,n,a){(function(o,s){function l(D,M){if(!D)throw new Error(M||"Assertion failed")}function c(D,M){D.super_=M;var C=function(){};C.prototype=M.prototype,D.prototype=new C,D.prototype.constructor=D}function i(D,M,C){if(i.isBN(D))return D;this.negative=0,this.words=null,this.length=0,this.red=null,D!==null&&(M!=="le"&&M!=="be"||(C=M,M=10),this._init(D||0,M||10,C||"be"))}var u;typeof o=="object"?o.exports=i:(void 0).BN=i,i.BN=i,i.wordSize=26;try{u=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:e("buffer").Buffer}catch{}function p(D,M){var C=D.charCodeAt(M);return C>=65&&C<=70?C-55:C>=97&&C<=102?C-87:C-48&15}function f(D,M,C){var w=p(D,C);return C-1>=M&&(w|=p(D,C-1)<<4),w}function h(D,M,C,w){for(var T=0,A=Math.min(D.length,C),S=M;S<A;S++){var j=D.charCodeAt(S)-48;T*=w,T+=j>=49?j-49+10:j>=17?j-17+10:j}return T}i.isBN=function(D){return D instanceof i||D!==null&&typeof D=="object"&&D.constructor.wordSize===i.wordSize&&Array.isArray(D.words)},i.max=function(D,M){return D.cmp(M)>0?D:M},i.min=function(D,M){return D.cmp(M)<0?D:M},i.prototype._init=function(D,M,C){if(typeof D=="number")return this._initNumber(D,M,C);if(typeof D=="object")return this._initArray(D,M,C);M==="hex"&&(M=16),l(M===(0|M)&&M>=2&&M<=36);var w=0;(D=D.toString().replace(/\s+/g,""))[0]==="-"&&(w++,this.negative=1),w<D.length&&(M===16?this._parseHex(D,w,C):(this._parseBase(D,M,w),C==="le"&&this._initArray(this.toArray(),M,C)))},i.prototype._initNumber=function(D,M,C){D<0&&(this.negative=1,D=-D),D<67108864?(this.words=[67108863&D],this.length=1):D<4503599627370496?(this.words=[67108863&D,D/67108864&67108863],this.length=2):(l(D<9007199254740992),this.words=[67108863&D,D/67108864&67108863,1],this.length=3),C==="le"&&this._initArray(this.toArray(),M,C)},i.prototype._initArray=function(D,M,C){if(l(typeof D.length=="number"),D.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(D.length/3),this.words=new Array(this.length);for(var w=0;w<this.length;w++)this.words[w]=0;var T,A,S=0;if(C==="be")for(w=D.length-1,T=0;w>=0;w-=3)A=D[w]|D[w-1]<<8|D[w-2]<<16,this.words[T]|=A<<S&67108863,this.words[T+1]=A>>>26-S&67108863,(S+=24)>=26&&(S-=26,T++);else if(C==="le")for(w=0,T=0;w<D.length;w+=3)A=D[w]|D[w+1]<<8|D[w+2]<<16,this.words[T]|=A<<S&67108863,this.words[T+1]=A>>>26-S&67108863,(S+=24)>=26&&(S-=26,T++);return this.strip()},i.prototype._parseHex=function(D,M,C){this.length=Math.ceil((D.length-M)/6),this.words=new Array(this.length);for(var w=0;w<this.length;w++)this.words[w]=0;var T,A=0,S=0;if(C==="be")for(w=D.length-1;w>=M;w-=2)T=f(D,M,w)<<A,this.words[S]|=67108863&T,A>=18?(A-=18,S+=1,this.words[S]|=T>>>26):A+=8;else for(w=(D.length-M)%2==0?M+1:M;w<D.length;w+=2)T=f(D,M,w)<<A,this.words[S]|=67108863&T,A>=18?(A-=18,S+=1,this.words[S]|=T>>>26):A+=8;this.strip()},i.prototype._parseBase=function(D,M,C){this.words=[0],this.length=1;for(var w=0,T=1;T<=67108863;T*=M)w++;w--,T=T/M|0;for(var A=D.length-C,S=A%w,j=Math.min(A,A-S)+C,B=0,R=C;R<j;R+=w)B=h(D,R,R+w,M),this.imuln(T),this.words[0]+B<67108864?this.words[0]+=B:this._iaddn(B);if(S!==0){var X=1;for(B=h(D,R,D.length,M),R=0;R<S;R++)X*=M;this.imuln(X),this.words[0]+B<67108864?this.words[0]+=B:this._iaddn(B)}this.strip()},i.prototype.copy=function(D){D.words=new Array(this.length);for(var M=0;M<this.length;M++)D.words[M]=this.words[M];D.length=this.length,D.negative=this.negative,D.red=this.red},i.prototype.clone=function(){var D=new i(null);return this.copy(D),D},i.prototype._expand=function(D){for(;this.length<D;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var v=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],b=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],g=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function x(D,M,C){C.negative=M.negative^D.negative;var w=D.length+M.length|0;C.length=w,w=w-1|0;var T=0|D.words[0],A=0|M.words[0],S=T*A,j=67108863&S,B=S/67108864|0;C.words[0]=j;for(var R=1;R<w;R++){for(var X=B>>>26,Y=67108863&B,ee=Math.min(R,M.length-1),U=Math.max(0,R-D.length+1);U<=ee;U++){var Q=R-U|0;X+=(S=(T=0|D.words[Q])*(A=0|M.words[U])+Y)/67108864|0,Y=67108863&S}C.words[R]=0|Y,B=0|X}return B!==0?C.words[R]=0|B:C.length--,C.strip()}i.prototype.toString=function(D,M){var C;if(M=0|M||1,(D=D||10)===16||D==="hex"){C="";for(var w=0,T=0,A=0;A<this.length;A++){var S=this.words[A],j=(16777215&(S<<w|T)).toString(16);C=(T=S>>>24-w&16777215)!==0||A!==this.length-1?v[6-j.length]+j+C:j+C,(w+=2)>=26&&(w-=26,A--)}for(T!==0&&(C=T.toString(16)+C);C.length%M!=0;)C="0"+C;return this.negative!==0&&(C="-"+C),C}if(D===(0|D)&&D>=2&&D<=36){var B=b[D],R=g[D];C="";var X=this.clone();for(X.negative=0;!X.isZero();){var Y=X.modn(R).toString(D);C=(X=X.idivn(R)).isZero()?Y+C:v[B-Y.length]+Y+C}for(this.isZero()&&(C="0"+C);C.length%M!=0;)C="0"+C;return this.negative!==0&&(C="-"+C),C}l(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var D=this.words[0];return this.length===2?D+=67108864*this.words[1]:this.length===3&&this.words[2]===1?D+=4503599627370496+67108864*this.words[1]:this.length>2&&l(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-D:D},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(D,M){return l(u!==void 0),this.toArrayLike(u,D,M)},i.prototype.toArray=function(D,M){return this.toArrayLike(Array,D,M)},i.prototype.toArrayLike=function(D,M,C){var w=this.byteLength(),T=C||Math.max(1,w);l(w<=T,"byte array longer than desired length"),l(T>0,"Requested array length <= 0"),this.strip();var A,S,j=M==="le",B=new D(T),R=this.clone();if(j){for(S=0;!R.isZero();S++)A=R.andln(255),R.iushrn(8),B[S]=A;for(;S<T;S++)B[S]=0}else{for(S=0;S<T-w;S++)B[S]=0;for(S=0;!R.isZero();S++)A=R.andln(255),R.iushrn(8),B[T-S-1]=A}return B},Math.clz32?i.prototype._countBits=function(D){return 32-Math.clz32(D)}:i.prototype._countBits=function(D){var M=D,C=0;return M>=4096&&(C+=13,M>>>=13),M>=64&&(C+=7,M>>>=7),M>=8&&(C+=4,M>>>=4),M>=2&&(C+=2,M>>>=2),C+M},i.prototype._zeroBits=function(D){if(D===0)return 26;var M=D,C=0;return(8191&M)==0&&(C+=13,M>>>=13),(127&M)==0&&(C+=7,M>>>=7),(15&M)==0&&(C+=4,M>>>=4),(3&M)==0&&(C+=2,M>>>=2),(1&M)==0&&C++,C},i.prototype.bitLength=function(){var D=this.words[this.length-1],M=this._countBits(D);return 26*(this.length-1)+M},i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var D=0,M=0;M<this.length;M++){var C=this._zeroBits(this.words[M]);if(D+=C,C!==26)break}return D},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(D){return this.negative!==0?this.abs().inotn(D).iaddn(1):this.clone()},i.prototype.fromTwos=function(D){return this.testn(D-1)?this.notn(D).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(D){for(;this.length<D.length;)this.words[this.length++]=0;for(var M=0;M<D.length;M++)this.words[M]=this.words[M]|D.words[M];return this.strip()},i.prototype.ior=function(D){return l((this.negative|D.negative)==0),this.iuor(D)},i.prototype.or=function(D){return this.length>D.length?this.clone().ior(D):D.clone().ior(this)},i.prototype.uor=function(D){return this.length>D.length?this.clone().iuor(D):D.clone().iuor(this)},i.prototype.iuand=function(D){var M;M=this.length>D.length?D:this;for(var C=0;C<M.length;C++)this.words[C]=this.words[C]&D.words[C];return this.length=M.length,this.strip()},i.prototype.iand=function(D){return l((this.negative|D.negative)==0),this.iuand(D)},i.prototype.and=function(D){return this.length>D.length?this.clone().iand(D):D.clone().iand(this)},i.prototype.uand=function(D){return this.length>D.length?this.clone().iuand(D):D.clone().iuand(this)},i.prototype.iuxor=function(D){var M,C;this.length>D.length?(M=this,C=D):(M=D,C=this);for(var w=0;w<C.length;w++)this.words[w]=M.words[w]^C.words[w];if(this!==M)for(;w<M.length;w++)this.words[w]=M.words[w];return this.length=M.length,this.strip()},i.prototype.ixor=function(D){return l((this.negative|D.negative)==0),this.iuxor(D)},i.prototype.xor=function(D){return this.length>D.length?this.clone().ixor(D):D.clone().ixor(this)},i.prototype.uxor=function(D){return this.length>D.length?this.clone().iuxor(D):D.clone().iuxor(this)},i.prototype.inotn=function(D){l(typeof D=="number"&&D>=0);var M=0|Math.ceil(D/26),C=D%26;this._expand(M),C>0&&M--;for(var w=0;w<M;w++)this.words[w]=67108863&~this.words[w];return C>0&&(this.words[w]=~this.words[w]&67108863>>26-C),this.strip()},i.prototype.notn=function(D){return this.clone().inotn(D)},i.prototype.setn=function(D,M){l(typeof D=="number"&&D>=0);var C=D/26|0,w=D%26;return this._expand(C+1),this.words[C]=M?this.words[C]|1<<w:this.words[C]&~(1<<w),this.strip()},i.prototype.iadd=function(D){var M,C,w;if(this.negative!==0&&D.negative===0)return this.negative=0,M=this.isub(D),this.negative^=1,this._normSign();if(this.negative===0&&D.negative!==0)return D.negative=0,M=this.isub(D),D.negative=1,M._normSign();this.length>D.length?(C=this,w=D):(C=D,w=this);for(var T=0,A=0;A<w.length;A++)M=(0|C.words[A])+(0|w.words[A])+T,this.words[A]=67108863&M,T=M>>>26;for(;T!==0&&A<C.length;A++)M=(0|C.words[A])+T,this.words[A]=67108863&M,T=M>>>26;if(this.length=C.length,T!==0)this.words[this.length]=T,this.length++;else if(C!==this)for(;A<C.length;A++)this.words[A]=C.words[A];return this},i.prototype.add=function(D){var M;return D.negative!==0&&this.negative===0?(D.negative=0,M=this.sub(D),D.negative^=1,M):D.negative===0&&this.negative!==0?(this.negative=0,M=D.sub(this),this.negative=1,M):this.length>D.length?this.clone().iadd(D):D.clone().iadd(this)},i.prototype.isub=function(D){if(D.negative!==0){D.negative=0;var M=this.iadd(D);return D.negative=1,M._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(D),this.negative=1,this._normSign();var C,w,T=this.cmp(D);if(T===0)return this.negative=0,this.length=1,this.words[0]=0,this;T>0?(C=this,w=D):(C=D,w=this);for(var A=0,S=0;S<w.length;S++)A=(M=(0|C.words[S])-(0|w.words[S])+A)>>26,this.words[S]=67108863&M;for(;A!==0&&S<C.length;S++)A=(M=(0|C.words[S])+A)>>26,this.words[S]=67108863&M;if(A===0&&S<C.length&&C!==this)for(;S<C.length;S++)this.words[S]=C.words[S];return this.length=Math.max(this.length,S),C!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(D){return this.clone().isub(D)};var y=function(D,M,C){var w,T,A,S=D.words,j=M.words,B=C.words,R=0,X=0|S[0],Y=8191&X,ee=X>>>13,U=0|S[1],Q=8191&U,P=U>>>13,F=0|S[2],Z=8191&F,se=F>>>13,re=0|S[3],ae=8191&re,te=re>>>13,he=0|S[4],le=8191&he,ne=he>>>13,de=0|S[5],fe=8191&de,Se=de>>>13,_e=0|S[6],Ce=8191&_e,Re=_e>>>13,Pe=0|S[7],Ye=8191&Pe,at=Pe>>>13,tt=0|S[8],it=8191&tt,rt=tt>>>13,ct=0|S[9],Oe=8191&ct,pt=ct>>>13,Je=0|j[0],ot=8191&Je,ut=Je>>>13,_t=0|j[1],vt=8191&_t,ht=_t>>>13,$e=0|j[2],Be=8191&$e,wt=$e>>>13,et=0|j[3],dt=8191&et,we=et>>>13,Ne=0|j[4],lt=8191&Ne,Ct=Ne>>>13,$t=0|j[5],ke=8191&$t,De=$t>>>13,bt=0|j[6],xt=8191&bt,Ae=bt>>>13,Le=0|j[7],nt=8191&Le,ie=Le>>>13,be=0|j[8],ue=8191&be,me=be>>>13,ve=0|j[9],ge=8191&ve,Fe=ve>>>13;C.negative=D.negative^M.negative,C.length=19;var Ue=(R+(w=Math.imul(Y,ot))|0)+((8191&(T=(T=Math.imul(Y,ut))+Math.imul(ee,ot)|0))<<13)|0;R=((A=Math.imul(ee,ut))+(T>>>13)|0)+(Ue>>>26)|0,Ue&=67108863,w=Math.imul(Q,ot),T=(T=Math.imul(Q,ut))+Math.imul(P,ot)|0,A=Math.imul(P,ut);var Me=(R+(w=w+Math.imul(Y,vt)|0)|0)+((8191&(T=(T=T+Math.imul(Y,ht)|0)+Math.imul(ee,vt)|0))<<13)|0;R=((A=A+Math.imul(ee,ht)|0)+(T>>>13)|0)+(Me>>>26)|0,Me&=67108863,w=Math.imul(Z,ot),T=(T=Math.imul(Z,ut))+Math.imul(se,ot)|0,A=Math.imul(se,ut),w=w+Math.imul(Q,vt)|0,T=(T=T+Math.imul(Q,ht)|0)+Math.imul(P,vt)|0,A=A+Math.imul(P,ht)|0;var Ve=(R+(w=w+Math.imul(Y,Be)|0)|0)+((8191&(T=(T=T+Math.imul(Y,wt)|0)+Math.imul(ee,Be)|0))<<13)|0;R=((A=A+Math.imul(ee,wt)|0)+(T>>>13)|0)+(Ve>>>26)|0,Ve&=67108863,w=Math.imul(ae,ot),T=(T=Math.imul(ae,ut))+Math.imul(te,ot)|0,A=Math.imul(te,ut),w=w+Math.imul(Z,vt)|0,T=(T=T+Math.imul(Z,ht)|0)+Math.imul(se,vt)|0,A=A+Math.imul(se,ht)|0,w=w+Math.imul(Q,Be)|0,T=(T=T+Math.imul(Q,wt)|0)+Math.imul(P,Be)|0,A=A+Math.imul(P,wt)|0;var ze=(R+(w=w+Math.imul(Y,dt)|0)|0)+((8191&(T=(T=T+Math.imul(Y,we)|0)+Math.imul(ee,dt)|0))<<13)|0;R=((A=A+Math.imul(ee,we)|0)+(T>>>13)|0)+(ze>>>26)|0,ze&=67108863,w=Math.imul(le,ot),T=(T=Math.imul(le,ut))+Math.imul(ne,ot)|0,A=Math.imul(ne,ut),w=w+Math.imul(ae,vt)|0,T=(T=T+Math.imul(ae,ht)|0)+Math.imul(te,vt)|0,A=A+Math.imul(te,ht)|0,w=w+Math.imul(Z,Be)|0,T=(T=T+Math.imul(Z,wt)|0)+Math.imul(se,Be)|0,A=A+Math.imul(se,wt)|0,w=w+Math.imul(Q,dt)|0,T=(T=T+Math.imul(Q,we)|0)+Math.imul(P,dt)|0,A=A+Math.imul(P,we)|0;var xe=(R+(w=w+Math.imul(Y,lt)|0)|0)+((8191&(T=(T=T+Math.imul(Y,Ct)|0)+Math.imul(ee,lt)|0))<<13)|0;R=((A=A+Math.imul(ee,Ct)|0)+(T>>>13)|0)+(xe>>>26)|0,xe&=67108863,w=Math.imul(fe,ot),T=(T=Math.imul(fe,ut))+Math.imul(Se,ot)|0,A=Math.imul(Se,ut),w=w+Math.imul(le,vt)|0,T=(T=T+Math.imul(le,ht)|0)+Math.imul(ne,vt)|0,A=A+Math.imul(ne,ht)|0,w=w+Math.imul(ae,Be)|0,T=(T=T+Math.imul(ae,wt)|0)+Math.imul(te,Be)|0,A=A+Math.imul(te,wt)|0,w=w+Math.imul(Z,dt)|0,T=(T=T+Math.imul(Z,we)|0)+Math.imul(se,dt)|0,A=A+Math.imul(se,we)|0,w=w+Math.imul(Q,lt)|0,T=(T=T+Math.imul(Q,Ct)|0)+Math.imul(P,lt)|0,A=A+Math.imul(P,Ct)|0;var Ee=(R+(w=w+Math.imul(Y,ke)|0)|0)+((8191&(T=(T=T+Math.imul(Y,De)|0)+Math.imul(ee,ke)|0))<<13)|0;R=((A=A+Math.imul(ee,De)|0)+(T>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,w=Math.imul(Ce,ot),T=(T=Math.imul(Ce,ut))+Math.imul(Re,ot)|0,A=Math.imul(Re,ut),w=w+Math.imul(fe,vt)|0,T=(T=T+Math.imul(fe,ht)|0)+Math.imul(Se,vt)|0,A=A+Math.imul(Se,ht)|0,w=w+Math.imul(le,Be)|0,T=(T=T+Math.imul(le,wt)|0)+Math.imul(ne,Be)|0,A=A+Math.imul(ne,wt)|0,w=w+Math.imul(ae,dt)|0,T=(T=T+Math.imul(ae,we)|0)+Math.imul(te,dt)|0,A=A+Math.imul(te,we)|0,w=w+Math.imul(Z,lt)|0,T=(T=T+Math.imul(Z,Ct)|0)+Math.imul(se,lt)|0,A=A+Math.imul(se,Ct)|0,w=w+Math.imul(Q,ke)|0,T=(T=T+Math.imul(Q,De)|0)+Math.imul(P,ke)|0,A=A+Math.imul(P,De)|0;var We=(R+(w=w+Math.imul(Y,xt)|0)|0)+((8191&(T=(T=T+Math.imul(Y,Ae)|0)+Math.imul(ee,xt)|0))<<13)|0;R=((A=A+Math.imul(ee,Ae)|0)+(T>>>13)|0)+(We>>>26)|0,We&=67108863,w=Math.imul(Ye,ot),T=(T=Math.imul(Ye,ut))+Math.imul(at,ot)|0,A=Math.imul(at,ut),w=w+Math.imul(Ce,vt)|0,T=(T=T+Math.imul(Ce,ht)|0)+Math.imul(Re,vt)|0,A=A+Math.imul(Re,ht)|0,w=w+Math.imul(fe,Be)|0,T=(T=T+Math.imul(fe,wt)|0)+Math.imul(Se,Be)|0,A=A+Math.imul(Se,wt)|0,w=w+Math.imul(le,dt)|0,T=(T=T+Math.imul(le,we)|0)+Math.imul(ne,dt)|0,A=A+Math.imul(ne,we)|0,w=w+Math.imul(ae,lt)|0,T=(T=T+Math.imul(ae,Ct)|0)+Math.imul(te,lt)|0,A=A+Math.imul(te,Ct)|0,w=w+Math.imul(Z,ke)|0,T=(T=T+Math.imul(Z,De)|0)+Math.imul(se,ke)|0,A=A+Math.imul(se,De)|0,w=w+Math.imul(Q,xt)|0,T=(T=T+Math.imul(Q,Ae)|0)+Math.imul(P,xt)|0,A=A+Math.imul(P,Ae)|0;var ce=(R+(w=w+Math.imul(Y,nt)|0)|0)+((8191&(T=(T=T+Math.imul(Y,ie)|0)+Math.imul(ee,nt)|0))<<13)|0;R=((A=A+Math.imul(ee,ie)|0)+(T>>>13)|0)+(ce>>>26)|0,ce&=67108863,w=Math.imul(it,ot),T=(T=Math.imul(it,ut))+Math.imul(rt,ot)|0,A=Math.imul(rt,ut),w=w+Math.imul(Ye,vt)|0,T=(T=T+Math.imul(Ye,ht)|0)+Math.imul(at,vt)|0,A=A+Math.imul(at,ht)|0,w=w+Math.imul(Ce,Be)|0,T=(T=T+Math.imul(Ce,wt)|0)+Math.imul(Re,Be)|0,A=A+Math.imul(Re,wt)|0,w=w+Math.imul(fe,dt)|0,T=(T=T+Math.imul(fe,we)|0)+Math.imul(Se,dt)|0,A=A+Math.imul(Se,we)|0,w=w+Math.imul(le,lt)|0,T=(T=T+Math.imul(le,Ct)|0)+Math.imul(ne,lt)|0,A=A+Math.imul(ne,Ct)|0,w=w+Math.imul(ae,ke)|0,T=(T=T+Math.imul(ae,De)|0)+Math.imul(te,ke)|0,A=A+Math.imul(te,De)|0,w=w+Math.imul(Z,xt)|0,T=(T=T+Math.imul(Z,Ae)|0)+Math.imul(se,xt)|0,A=A+Math.imul(se,Ae)|0,w=w+Math.imul(Q,nt)|0,T=(T=T+Math.imul(Q,ie)|0)+Math.imul(P,nt)|0,A=A+Math.imul(P,ie)|0;var Te=(R+(w=w+Math.imul(Y,ue)|0)|0)+((8191&(T=(T=T+Math.imul(Y,me)|0)+Math.imul(ee,ue)|0))<<13)|0;R=((A=A+Math.imul(ee,me)|0)+(T>>>13)|0)+(Te>>>26)|0,Te&=67108863,w=Math.imul(Oe,ot),T=(T=Math.imul(Oe,ut))+Math.imul(pt,ot)|0,A=Math.imul(pt,ut),w=w+Math.imul(it,vt)|0,T=(T=T+Math.imul(it,ht)|0)+Math.imul(rt,vt)|0,A=A+Math.imul(rt,ht)|0,w=w+Math.imul(Ye,Be)|0,T=(T=T+Math.imul(Ye,wt)|0)+Math.imul(at,Be)|0,A=A+Math.imul(at,wt)|0,w=w+Math.imul(Ce,dt)|0,T=(T=T+Math.imul(Ce,we)|0)+Math.imul(Re,dt)|0,A=A+Math.imul(Re,we)|0,w=w+Math.imul(fe,lt)|0,T=(T=T+Math.imul(fe,Ct)|0)+Math.imul(Se,lt)|0,A=A+Math.imul(Se,Ct)|0,w=w+Math.imul(le,ke)|0,T=(T=T+Math.imul(le,De)|0)+Math.imul(ne,ke)|0,A=A+Math.imul(ne,De)|0,w=w+Math.imul(ae,xt)|0,T=(T=T+Math.imul(ae,Ae)|0)+Math.imul(te,xt)|0,A=A+Math.imul(te,Ae)|0,w=w+Math.imul(Z,nt)|0,T=(T=T+Math.imul(Z,ie)|0)+Math.imul(se,nt)|0,A=A+Math.imul(se,ie)|0,w=w+Math.imul(Q,ue)|0,T=(T=T+Math.imul(Q,me)|0)+Math.imul(P,ue)|0,A=A+Math.imul(P,me)|0;var qe=(R+(w=w+Math.imul(Y,ge)|0)|0)+((8191&(T=(T=T+Math.imul(Y,Fe)|0)+Math.imul(ee,ge)|0))<<13)|0;R=((A=A+Math.imul(ee,Fe)|0)+(T>>>13)|0)+(qe>>>26)|0,qe&=67108863,w=Math.imul(Oe,vt),T=(T=Math.imul(Oe,ht))+Math.imul(pt,vt)|0,A=Math.imul(pt,ht),w=w+Math.imul(it,Be)|0,T=(T=T+Math.imul(it,wt)|0)+Math.imul(rt,Be)|0,A=A+Math.imul(rt,wt)|0,w=w+Math.imul(Ye,dt)|0,T=(T=T+Math.imul(Ye,we)|0)+Math.imul(at,dt)|0,A=A+Math.imul(at,we)|0,w=w+Math.imul(Ce,lt)|0,T=(T=T+Math.imul(Ce,Ct)|0)+Math.imul(Re,lt)|0,A=A+Math.imul(Re,Ct)|0,w=w+Math.imul(fe,ke)|0,T=(T=T+Math.imul(fe,De)|0)+Math.imul(Se,ke)|0,A=A+Math.imul(Se,De)|0,w=w+Math.imul(le,xt)|0,T=(T=T+Math.imul(le,Ae)|0)+Math.imul(ne,xt)|0,A=A+Math.imul(ne,Ae)|0,w=w+Math.imul(ae,nt)|0,T=(T=T+Math.imul(ae,ie)|0)+Math.imul(te,nt)|0,A=A+Math.imul(te,ie)|0,w=w+Math.imul(Z,ue)|0,T=(T=T+Math.imul(Z,me)|0)+Math.imul(se,ue)|0,A=A+Math.imul(se,me)|0;var st=(R+(w=w+Math.imul(Q,ge)|0)|0)+((8191&(T=(T=T+Math.imul(Q,Fe)|0)+Math.imul(P,ge)|0))<<13)|0;R=((A=A+Math.imul(P,Fe)|0)+(T>>>13)|0)+(st>>>26)|0,st&=67108863,w=Math.imul(Oe,Be),T=(T=Math.imul(Oe,wt))+Math.imul(pt,Be)|0,A=Math.imul(pt,wt),w=w+Math.imul(it,dt)|0,T=(T=T+Math.imul(it,we)|0)+Math.imul(rt,dt)|0,A=A+Math.imul(rt,we)|0,w=w+Math.imul(Ye,lt)|0,T=(T=T+Math.imul(Ye,Ct)|0)+Math.imul(at,lt)|0,A=A+Math.imul(at,Ct)|0,w=w+Math.imul(Ce,ke)|0,T=(T=T+Math.imul(Ce,De)|0)+Math.imul(Re,ke)|0,A=A+Math.imul(Re,De)|0,w=w+Math.imul(fe,xt)|0,T=(T=T+Math.imul(fe,Ae)|0)+Math.imul(Se,xt)|0,A=A+Math.imul(Se,Ae)|0,w=w+Math.imul(le,nt)|0,T=(T=T+Math.imul(le,ie)|0)+Math.imul(ne,nt)|0,A=A+Math.imul(ne,ie)|0,w=w+Math.imul(ae,ue)|0,T=(T=T+Math.imul(ae,me)|0)+Math.imul(te,ue)|0,A=A+Math.imul(te,me)|0;var Et=(R+(w=w+Math.imul(Z,ge)|0)|0)+((8191&(T=(T=T+Math.imul(Z,Fe)|0)+Math.imul(se,ge)|0))<<13)|0;R=((A=A+Math.imul(se,Fe)|0)+(T>>>13)|0)+(Et>>>26)|0,Et&=67108863,w=Math.imul(Oe,dt),T=(T=Math.imul(Oe,we))+Math.imul(pt,dt)|0,A=Math.imul(pt,we),w=w+Math.imul(it,lt)|0,T=(T=T+Math.imul(it,Ct)|0)+Math.imul(rt,lt)|0,A=A+Math.imul(rt,Ct)|0,w=w+Math.imul(Ye,ke)|0,T=(T=T+Math.imul(Ye,De)|0)+Math.imul(at,ke)|0,A=A+Math.imul(at,De)|0,w=w+Math.imul(Ce,xt)|0,T=(T=T+Math.imul(Ce,Ae)|0)+Math.imul(Re,xt)|0,A=A+Math.imul(Re,Ae)|0,w=w+Math.imul(fe,nt)|0,T=(T=T+Math.imul(fe,ie)|0)+Math.imul(Se,nt)|0,A=A+Math.imul(Se,ie)|0,w=w+Math.imul(le,ue)|0,T=(T=T+Math.imul(le,me)|0)+Math.imul(ne,ue)|0,A=A+Math.imul(ne,me)|0;var gt=(R+(w=w+Math.imul(ae,ge)|0)|0)+((8191&(T=(T=T+Math.imul(ae,Fe)|0)+Math.imul(te,ge)|0))<<13)|0;R=((A=A+Math.imul(te,Fe)|0)+(T>>>13)|0)+(gt>>>26)|0,gt&=67108863,w=Math.imul(Oe,lt),T=(T=Math.imul(Oe,Ct))+Math.imul(pt,lt)|0,A=Math.imul(pt,Ct),w=w+Math.imul(it,ke)|0,T=(T=T+Math.imul(it,De)|0)+Math.imul(rt,ke)|0,A=A+Math.imul(rt,De)|0,w=w+Math.imul(Ye,xt)|0,T=(T=T+Math.imul(Ye,Ae)|0)+Math.imul(at,xt)|0,A=A+Math.imul(at,Ae)|0,w=w+Math.imul(Ce,nt)|0,T=(T=T+Math.imul(Ce,ie)|0)+Math.imul(Re,nt)|0,A=A+Math.imul(Re,ie)|0,w=w+Math.imul(fe,ue)|0,T=(T=T+Math.imul(fe,me)|0)+Math.imul(Se,ue)|0,A=A+Math.imul(Se,me)|0;var kt=(R+(w=w+Math.imul(le,ge)|0)|0)+((8191&(T=(T=T+Math.imul(le,Fe)|0)+Math.imul(ne,ge)|0))<<13)|0;R=((A=A+Math.imul(ne,Fe)|0)+(T>>>13)|0)+(kt>>>26)|0,kt&=67108863,w=Math.imul(Oe,ke),T=(T=Math.imul(Oe,De))+Math.imul(pt,ke)|0,A=Math.imul(pt,De),w=w+Math.imul(it,xt)|0,T=(T=T+Math.imul(it,Ae)|0)+Math.imul(rt,xt)|0,A=A+Math.imul(rt,Ae)|0,w=w+Math.imul(Ye,nt)|0,T=(T=T+Math.imul(Ye,ie)|0)+Math.imul(at,nt)|0,A=A+Math.imul(at,ie)|0,w=w+Math.imul(Ce,ue)|0,T=(T=T+Math.imul(Ce,me)|0)+Math.imul(Re,ue)|0,A=A+Math.imul(Re,me)|0;var Zt=(R+(w=w+Math.imul(fe,ge)|0)|0)+((8191&(T=(T=T+Math.imul(fe,Fe)|0)+Math.imul(Se,ge)|0))<<13)|0;R=((A=A+Math.imul(Se,Fe)|0)+(T>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,w=Math.imul(Oe,xt),T=(T=Math.imul(Oe,Ae))+Math.imul(pt,xt)|0,A=Math.imul(pt,Ae),w=w+Math.imul(it,nt)|0,T=(T=T+Math.imul(it,ie)|0)+Math.imul(rt,nt)|0,A=A+Math.imul(rt,ie)|0,w=w+Math.imul(Ye,ue)|0,T=(T=T+Math.imul(Ye,me)|0)+Math.imul(at,ue)|0,A=A+Math.imul(at,me)|0;var Ut=(R+(w=w+Math.imul(Ce,ge)|0)|0)+((8191&(T=(T=T+Math.imul(Ce,Fe)|0)+Math.imul(Re,ge)|0))<<13)|0;R=((A=A+Math.imul(Re,Fe)|0)+(T>>>13)|0)+(Ut>>>26)|0,Ut&=67108863,w=Math.imul(Oe,nt),T=(T=Math.imul(Oe,ie))+Math.imul(pt,nt)|0,A=Math.imul(pt,ie),w=w+Math.imul(it,ue)|0,T=(T=T+Math.imul(it,me)|0)+Math.imul(rt,ue)|0,A=A+Math.imul(rt,me)|0;var zt=(R+(w=w+Math.imul(Ye,ge)|0)|0)+((8191&(T=(T=T+Math.imul(Ye,Fe)|0)+Math.imul(at,ge)|0))<<13)|0;R=((A=A+Math.imul(at,Fe)|0)+(T>>>13)|0)+(zt>>>26)|0,zt&=67108863,w=Math.imul(Oe,ue),T=(T=Math.imul(Oe,me))+Math.imul(pt,ue)|0,A=Math.imul(pt,me);var It=(R+(w=w+Math.imul(it,ge)|0)|0)+((8191&(T=(T=T+Math.imul(it,Fe)|0)+Math.imul(rt,ge)|0))<<13)|0;R=((A=A+Math.imul(rt,Fe)|0)+(T>>>13)|0)+(It>>>26)|0,It&=67108863;var er=(R+(w=Math.imul(Oe,ge))|0)+((8191&(T=(T=Math.imul(Oe,Fe))+Math.imul(pt,ge)|0))<<13)|0;return R=((A=Math.imul(pt,Fe))+(T>>>13)|0)+(er>>>26)|0,er&=67108863,B[0]=Ue,B[1]=Me,B[2]=Ve,B[3]=ze,B[4]=xe,B[5]=Ee,B[6]=We,B[7]=ce,B[8]=Te,B[9]=qe,B[10]=st,B[11]=Et,B[12]=gt,B[13]=kt,B[14]=Zt,B[15]=Ut,B[16]=zt,B[17]=It,B[18]=er,R!==0&&(B[19]=R,C.length++),C};function E(D,M,C){return new N().mulp(D,M,C)}function N(D,M){this.x=D,this.y=M}Math.imul||(y=x),i.prototype.mulTo=function(D,M){var C=this.length+D.length;return this.length===10&&D.length===10?y(this,D,M):C<63?x(this,D,M):C<1024?function(w,T,A){A.negative=T.negative^w.negative,A.length=w.length+T.length;for(var S=0,j=0,B=0;B<A.length-1;B++){var R=j;j=0;for(var X=67108863&S,Y=Math.min(B,T.length-1),ee=Math.max(0,B-w.length+1);ee<=Y;ee++){var U=B-ee,Q=(0|w.words[U])*(0|T.words[ee]),P=67108863&Q;X=67108863&(P=P+X|0),j+=(R=(R=R+(Q/67108864|0)|0)+(P>>>26)|0)>>>26,R&=67108863}A.words[B]=X,S=R,R=j}return S!==0?A.words[B]=S:A.length--,A.strip()}(this,D,M):E(this,D,M)},N.prototype.makeRBT=function(D){for(var M=new Array(D),C=i.prototype._countBits(D)-1,w=0;w<D;w++)M[w]=this.revBin(w,C,D);return M},N.prototype.revBin=function(D,M,C){if(D===0||D===C-1)return D;for(var w=0,T=0;T<M;T++)w|=(1&D)<<M-T-1,D>>=1;return w},N.prototype.permute=function(D,M,C,w,T,A){for(var S=0;S<A;S++)w[S]=M[D[S]],T[S]=C[D[S]]},N.prototype.transform=function(D,M,C,w,T,A){this.permute(A,D,M,C,w,T);for(var S=1;S<T;S<<=1)for(var j=S<<1,B=Math.cos(2*Math.PI/j),R=Math.sin(2*Math.PI/j),X=0;X<T;X+=j)for(var Y=B,ee=R,U=0;U<S;U++){var Q=C[X+U],P=w[X+U],F=C[X+U+S],Z=w[X+U+S],se=Y*F-ee*Z;Z=Y*Z+ee*F,F=se,C[X+U]=Q+F,w[X+U]=P+Z,C[X+U+S]=Q-F,w[X+U+S]=P-Z,U!==j&&(se=B*Y-R*ee,ee=B*ee+R*Y,Y=se)}},N.prototype.guessLen13b=function(D,M){var C=1|Math.max(M,D),w=1&C,T=0;for(C=C/2|0;C;C>>>=1)T++;return 1<<T+1+w},N.prototype.conjugate=function(D,M,C){if(!(C<=1))for(var w=0;w<C/2;w++){var T=D[w];D[w]=D[C-w-1],D[C-w-1]=T,T=M[w],M[w]=-M[C-w-1],M[C-w-1]=-T}},N.prototype.normalize13b=function(D,M){for(var C=0,w=0;w<M/2;w++){var T=8192*Math.round(D[2*w+1]/M)+Math.round(D[2*w]/M)+C;D[w]=67108863&T,C=T<67108864?0:T/67108864|0}return D},N.prototype.convert13b=function(D,M,C,w){for(var T=0,A=0;A<M;A++)T+=0|D[A],C[2*A]=8191&T,T>>>=13,C[2*A+1]=8191&T,T>>>=13;for(A=2*M;A<w;++A)C[A]=0;l(T===0),l((-8192&T)==0)},N.prototype.stub=function(D){for(var M=new Array(D),C=0;C<D;C++)M[C]=0;return M},N.prototype.mulp=function(D,M,C){var w=2*this.guessLen13b(D.length,M.length),T=this.makeRBT(w),A=this.stub(w),S=new Array(w),j=new Array(w),B=new Array(w),R=new Array(w),X=new Array(w),Y=new Array(w),ee=C.words;ee.length=w,this.convert13b(D.words,D.length,S,w),this.convert13b(M.words,M.length,R,w),this.transform(S,A,j,B,w,T),this.transform(R,A,X,Y,w,T);for(var U=0;U<w;U++){var Q=j[U]*X[U]-B[U]*Y[U];B[U]=j[U]*Y[U]+B[U]*X[U],j[U]=Q}return this.conjugate(j,B,w),this.transform(j,B,ee,A,w,T),this.conjugate(ee,A,w),this.normalize13b(ee,w),C.negative=D.negative^M.negative,C.length=D.length+M.length,C.strip()},i.prototype.mul=function(D){var M=new i(null);return M.words=new Array(this.length+D.length),this.mulTo(D,M)},i.prototype.mulf=function(D){var M=new i(null);return M.words=new Array(this.length+D.length),E(this,D,M)},i.prototype.imul=function(D){return this.clone().mulTo(D,this)},i.prototype.imuln=function(D){l(typeof D=="number"),l(D<67108864);for(var M=0,C=0;C<this.length;C++){var w=(0|this.words[C])*D,T=(67108863&w)+(67108863&M);M>>=26,M+=w/67108864|0,M+=T>>>26,this.words[C]=67108863&T}return M!==0&&(this.words[C]=M,this.length++),this},i.prototype.muln=function(D){return this.clone().imuln(D)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(D){var M=function(A){for(var S=new Array(A.bitLength()),j=0;j<S.length;j++){var B=j/26|0,R=j%26;S[j]=(A.words[B]&1<<R)>>>R}return S}(D);if(M.length===0)return new i(1);for(var C=this,w=0;w<M.length&&M[w]===0;w++,C=C.sqr());if(++w<M.length)for(var T=C.sqr();w<M.length;w++,T=T.sqr())M[w]!==0&&(C=C.mul(T));return C},i.prototype.iushln=function(D){l(typeof D=="number"&&D>=0);var M,C=D%26,w=(D-C)/26,T=67108863>>>26-C<<26-C;if(C!==0){var A=0;for(M=0;M<this.length;M++){var S=this.words[M]&T,j=(0|this.words[M])-S<<C;this.words[M]=j|A,A=S>>>26-C}A&&(this.words[M]=A,this.length++)}if(w!==0){for(M=this.length-1;M>=0;M--)this.words[M+w]=this.words[M];for(M=0;M<w;M++)this.words[M]=0;this.length+=w}return this.strip()},i.prototype.ishln=function(D){return l(this.negative===0),this.iushln(D)},i.prototype.iushrn=function(D,M,C){var w;l(typeof D=="number"&&D>=0),w=M?(M-M%26)/26:0;var T=D%26,A=Math.min((D-T)/26,this.length),S=67108863^67108863>>>T<<T,j=C;if(w-=A,w=Math.max(0,w),j){for(var B=0;B<A;B++)j.words[B]=this.words[B];j.length=A}if(A!==0)if(this.length>A)for(this.length-=A,B=0;B<this.length;B++)this.words[B]=this.words[B+A];else this.words[0]=0,this.length=1;var R=0;for(B=this.length-1;B>=0&&(R!==0||B>=w);B--){var X=0|this.words[B];this.words[B]=R<<26-T|X>>>T,R=X&S}return j&&R!==0&&(j.words[j.length++]=R),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(D,M,C){return l(this.negative===0),this.iushrn(D,M,C)},i.prototype.shln=function(D){return this.clone().ishln(D)},i.prototype.ushln=function(D){return this.clone().iushln(D)},i.prototype.shrn=function(D){return this.clone().ishrn(D)},i.prototype.ushrn=function(D){return this.clone().iushrn(D)},i.prototype.testn=function(D){l(typeof D=="number"&&D>=0);var M=D%26,C=(D-M)/26,w=1<<M;return!(this.length<=C)&&!!(this.words[C]&w)},i.prototype.imaskn=function(D){l(typeof D=="number"&&D>=0);var M=D%26,C=(D-M)/26;if(l(this.negative===0,"imaskn works only with positive numbers"),this.length<=C)return this;if(M!==0&&C++,this.length=Math.min(C,this.length),M!==0){var w=67108863^67108863>>>M<<M;this.words[this.length-1]&=w}return this.strip()},i.prototype.maskn=function(D){return this.clone().imaskn(D)},i.prototype.iaddn=function(D){return l(typeof D=="number"),l(D<67108864),D<0?this.isubn(-D):this.negative!==0?this.length===1&&(0|this.words[0])<D?(this.words[0]=D-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(D),this.negative=1,this):this._iaddn(D)},i.prototype._iaddn=function(D){this.words[0]+=D;for(var M=0;M<this.length&&this.words[M]>=67108864;M++)this.words[M]-=67108864,M===this.length-1?this.words[M+1]=1:this.words[M+1]++;return this.length=Math.max(this.length,M+1),this},i.prototype.isubn=function(D){if(l(typeof D=="number"),l(D<67108864),D<0)return this.iaddn(-D);if(this.negative!==0)return this.negative=0,this.iaddn(D),this.negative=1,this;if(this.words[0]-=D,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var M=0;M<this.length&&this.words[M]<0;M++)this.words[M]+=67108864,this.words[M+1]-=1;return this.strip()},i.prototype.addn=function(D){return this.clone().iaddn(D)},i.prototype.subn=function(D){return this.clone().isubn(D)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(D,M,C){var w,T,A=D.length+C;this._expand(A);var S=0;for(w=0;w<D.length;w++){T=(0|this.words[w+C])+S;var j=(0|D.words[w])*M;S=((T-=67108863&j)>>26)-(j/67108864|0),this.words[w+C]=67108863&T}for(;w<this.length-C;w++)S=(T=(0|this.words[w+C])+S)>>26,this.words[w+C]=67108863&T;if(S===0)return this.strip();for(l(S===-1),S=0,w=0;w<this.length;w++)S=(T=-(0|this.words[w])+S)>>26,this.words[w]=67108863&T;return this.negative=1,this.strip()},i.prototype._wordDiv=function(D,M){var C=(this.length,D.length),w=this.clone(),T=D,A=0|T.words[T.length-1];(C=26-this._countBits(A))!==0&&(T=T.ushln(C),w.iushln(C),A=0|T.words[T.length-1]);var S,j=w.length-T.length;if(M!=="mod"){(S=new i(null)).length=j+1,S.words=new Array(S.length);for(var B=0;B<S.length;B++)S.words[B]=0}var R=w.clone()._ishlnsubmul(T,1,j);R.negative===0&&(w=R,S&&(S.words[j]=1));for(var X=j-1;X>=0;X--){var Y=67108864*(0|w.words[T.length+X])+(0|w.words[T.length+X-1]);for(Y=Math.min(Y/A|0,67108863),w._ishlnsubmul(T,Y,X);w.negative!==0;)Y--,w.negative=0,w._ishlnsubmul(T,1,X),w.isZero()||(w.negative^=1);S&&(S.words[X]=Y)}return S&&S.strip(),w.strip(),M!=="div"&&C!==0&&w.iushrn(C),{div:S||null,mod:w}},i.prototype.divmod=function(D,M,C){return l(!D.isZero()),this.isZero()?{div:new i(0),mod:new i(0)}:this.negative!==0&&D.negative===0?(A=this.neg().divmod(D,M),M!=="mod"&&(w=A.div.neg()),M!=="div"&&(T=A.mod.neg(),C&&T.negative!==0&&T.iadd(D)),{div:w,mod:T}):this.negative===0&&D.negative!==0?(A=this.divmod(D.neg(),M),M!=="mod"&&(w=A.div.neg()),{div:w,mod:A.mod}):(this.negative&D.negative)!=0?(A=this.neg().divmod(D.neg(),M),M!=="div"&&(T=A.mod.neg(),C&&T.negative!==0&&T.isub(D)),{div:A.div,mod:T}):D.length>this.length||this.cmp(D)<0?{div:new i(0),mod:this}:D.length===1?M==="div"?{div:this.divn(D.words[0]),mod:null}:M==="mod"?{div:null,mod:new i(this.modn(D.words[0]))}:{div:this.divn(D.words[0]),mod:new i(this.modn(D.words[0]))}:this._wordDiv(D,M);var w,T,A},i.prototype.div=function(D){return this.divmod(D,"div",!1).div},i.prototype.mod=function(D){return this.divmod(D,"mod",!1).mod},i.prototype.umod=function(D){return this.divmod(D,"mod",!0).mod},i.prototype.divRound=function(D){var M=this.divmod(D);if(M.mod.isZero())return M.div;var C=M.div.negative!==0?M.mod.isub(D):M.mod,w=D.ushrn(1),T=D.andln(1),A=C.cmp(w);return A<0||T===1&&A===0?M.div:M.div.negative!==0?M.div.isubn(1):M.div.iaddn(1)},i.prototype.modn=function(D){l(D<=67108863);for(var M=(1<<26)%D,C=0,w=this.length-1;w>=0;w--)C=(M*C+(0|this.words[w]))%D;return C},i.prototype.idivn=function(D){l(D<=67108863);for(var M=0,C=this.length-1;C>=0;C--){var w=(0|this.words[C])+67108864*M;this.words[C]=w/D|0,M=w%D}return this.strip()},i.prototype.divn=function(D){return this.clone().idivn(D)},i.prototype.egcd=function(D){l(D.negative===0),l(!D.isZero());var M=this,C=D.clone();M=M.negative!==0?M.umod(D):M.clone();for(var w=new i(1),T=new i(0),A=new i(0),S=new i(1),j=0;M.isEven()&&C.isEven();)M.iushrn(1),C.iushrn(1),++j;for(var B=C.clone(),R=M.clone();!M.isZero();){for(var X=0,Y=1;(M.words[0]&Y)==0&&X<26;++X,Y<<=1);if(X>0)for(M.iushrn(X);X-- >0;)(w.isOdd()||T.isOdd())&&(w.iadd(B),T.isub(R)),w.iushrn(1),T.iushrn(1);for(var ee=0,U=1;(C.words[0]&U)==0&&ee<26;++ee,U<<=1);if(ee>0)for(C.iushrn(ee);ee-- >0;)(A.isOdd()||S.isOdd())&&(A.iadd(B),S.isub(R)),A.iushrn(1),S.iushrn(1);M.cmp(C)>=0?(M.isub(C),w.isub(A),T.isub(S)):(C.isub(M),A.isub(w),S.isub(T))}return{a:A,b:S,gcd:C.iushln(j)}},i.prototype._invmp=function(D){l(D.negative===0),l(!D.isZero());var M=this,C=D.clone();M=M.negative!==0?M.umod(D):M.clone();for(var w,T=new i(1),A=new i(0),S=C.clone();M.cmpn(1)>0&&C.cmpn(1)>0;){for(var j=0,B=1;(M.words[0]&B)==0&&j<26;++j,B<<=1);if(j>0)for(M.iushrn(j);j-- >0;)T.isOdd()&&T.iadd(S),T.iushrn(1);for(var R=0,X=1;(C.words[0]&X)==0&&R<26;++R,X<<=1);if(R>0)for(C.iushrn(R);R-- >0;)A.isOdd()&&A.iadd(S),A.iushrn(1);M.cmp(C)>=0?(M.isub(C),T.isub(A)):(C.isub(M),A.isub(T))}return(w=M.cmpn(1)===0?T:A).cmpn(0)<0&&w.iadd(D),w},i.prototype.gcd=function(D){if(this.isZero())return D.abs();if(D.isZero())return this.abs();var M=this.clone(),C=D.clone();M.negative=0,C.negative=0;for(var w=0;M.isEven()&&C.isEven();w++)M.iushrn(1),C.iushrn(1);for(;;){for(;M.isEven();)M.iushrn(1);for(;C.isEven();)C.iushrn(1);var T=M.cmp(C);if(T<0){var A=M;M=C,C=A}else if(T===0||C.cmpn(1)===0)break;M.isub(C)}return C.iushln(w)},i.prototype.invm=function(D){return this.egcd(D).a.umod(D)},i.prototype.isEven=function(){return(1&this.words[0])==0},i.prototype.isOdd=function(){return(1&this.words[0])==1},i.prototype.andln=function(D){return this.words[0]&D},i.prototype.bincn=function(D){l(typeof D=="number");var M=D%26,C=(D-M)/26,w=1<<M;if(this.length<=C)return this._expand(C+1),this.words[C]|=w,this;for(var T=w,A=C;T!==0&&A<this.length;A++){var S=0|this.words[A];T=(S+=T)>>>26,S&=67108863,this.words[A]=S}return T!==0&&(this.words[A]=T,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(D){var M,C=D<0;if(this.negative!==0&&!C)return-1;if(this.negative===0&&C)return 1;if(this.strip(),this.length>1)M=1;else{C&&(D=-D),l(D<=67108863,"Number is too big");var w=0|this.words[0];M=w===D?0:w<D?-1:1}return this.negative!==0?0|-M:M},i.prototype.cmp=function(D){if(this.negative!==0&&D.negative===0)return-1;if(this.negative===0&&D.negative!==0)return 1;var M=this.ucmp(D);return this.negative!==0?0|-M:M},i.prototype.ucmp=function(D){if(this.length>D.length)return 1;if(this.length<D.length)return-1;for(var M=0,C=this.length-1;C>=0;C--){var w=0|this.words[C],T=0|D.words[C];if(w!==T){w<T?M=-1:w>T&&(M=1);break}}return M},i.prototype.gtn=function(D){return this.cmpn(D)===1},i.prototype.gt=function(D){return this.cmp(D)===1},i.prototype.gten=function(D){return this.cmpn(D)>=0},i.prototype.gte=function(D){return this.cmp(D)>=0},i.prototype.ltn=function(D){return this.cmpn(D)===-1},i.prototype.lt=function(D){return this.cmp(D)===-1},i.prototype.lten=function(D){return this.cmpn(D)<=0},i.prototype.lte=function(D){return this.cmp(D)<=0},i.prototype.eqn=function(D){return this.cmpn(D)===0},i.prototype.eq=function(D){return this.cmp(D)===0},i.red=function(D){return new z(D)},i.prototype.toRed=function(D){return l(!this.red,"Already a number in reduction context"),l(this.negative===0,"red works only with positives"),D.convertTo(this)._forceRed(D)},i.prototype.fromRed=function(){return l(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(D){return this.red=D,this},i.prototype.forceRed=function(D){return l(!this.red,"Already a number in reduction context"),this._forceRed(D)},i.prototype.redAdd=function(D){return l(this.red,"redAdd works only with red numbers"),this.red.add(this,D)},i.prototype.redIAdd=function(D){return l(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,D)},i.prototype.redSub=function(D){return l(this.red,"redSub works only with red numbers"),this.red.sub(this,D)},i.prototype.redISub=function(D){return l(this.red,"redISub works only with red numbers"),this.red.isub(this,D)},i.prototype.redShl=function(D){return l(this.red,"redShl works only with red numbers"),this.red.shl(this,D)},i.prototype.redMul=function(D){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,D),this.red.mul(this,D)},i.prototype.redIMul=function(D){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,D),this.red.imul(this,D)},i.prototype.redSqr=function(){return l(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return l(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return l(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return l(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return l(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(D){return l(this.red&&!D.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,D)};var I={k256:null,p224:null,p192:null,p25519:null};function L(D,M){this.name=D,this.p=new i(M,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function H(){L.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function V(){L.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function q(){L.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function K(){L.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function z(D){if(typeof D=="string"){var M=i._prime(D);this.m=M.p,this.prime=M}else l(D.gtn(1),"modulus must be greater than 1"),this.m=D,this.prime=null}function W(D){z.call(this,D),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}L.prototype._tmp=function(){var D=new i(null);return D.words=new Array(Math.ceil(this.n/13)),D},L.prototype.ireduce=function(D){var M,C=D;do this.split(C,this.tmp),M=(C=(C=this.imulK(C)).iadd(this.tmp)).bitLength();while(M>this.n);var w=M<this.n?-1:C.ucmp(this.p);return w===0?(C.words[0]=0,C.length=1):w>0?C.isub(this.p):C.strip!==void 0?C.strip():C._strip(),C},L.prototype.split=function(D,M){D.iushrn(this.n,0,M)},L.prototype.imulK=function(D){return D.imul(this.k)},c(H,L),H.prototype.split=function(D,M){for(var C=Math.min(D.length,9),w=0;w<C;w++)M.words[w]=D.words[w];if(M.length=C,D.length<=9)return D.words[0]=0,void(D.length=1);var T=D.words[9];for(M.words[M.length++]=4194303&T,w=10;w<D.length;w++){var A=0|D.words[w];D.words[w-10]=(4194303&A)<<4|T>>>22,T=A}T>>>=22,D.words[w-10]=T,T===0&&D.length>10?D.length-=10:D.length-=9},H.prototype.imulK=function(D){D.words[D.length]=0,D.words[D.length+1]=0,D.length+=2;for(var M=0,C=0;C<D.length;C++){var w=0|D.words[C];M+=977*w,D.words[C]=67108863&M,M=64*w+(M/67108864|0)}return D.words[D.length-1]===0&&(D.length--,D.words[D.length-1]===0&&D.length--),D},c(V,L),c(q,L),c(K,L),K.prototype.imulK=function(D){for(var M=0,C=0;C<D.length;C++){var w=19*(0|D.words[C])+M,T=67108863&w;w>>>=26,D.words[C]=T,M=w}return M!==0&&(D.words[D.length++]=M),D},i._prime=function(D){if(I[D])return I[D];var M;if(D==="k256")M=new H;else if(D==="p224")M=new V;else if(D==="p192")M=new q;else{if(D!=="p25519")throw new Error("Unknown prime "+D);M=new K}return I[D]=M,M},z.prototype._verify1=function(D){l(D.negative===0,"red works only with positives"),l(D.red,"red works only with red numbers")},z.prototype._verify2=function(D,M){l((D.negative|M.negative)==0,"red works only with positives"),l(D.red&&D.red===M.red,"red works only with red numbers")},z.prototype.imod=function(D){return this.prime?this.prime.ireduce(D)._forceRed(this):D.umod(this.m)._forceRed(this)},z.prototype.neg=function(D){return D.isZero()?D.clone():this.m.sub(D)._forceRed(this)},z.prototype.add=function(D,M){this._verify2(D,M);var C=D.add(M);return C.cmp(this.m)>=0&&C.isub(this.m),C._forceRed(this)},z.prototype.iadd=function(D,M){this._verify2(D,M);var C=D.iadd(M);return C.cmp(this.m)>=0&&C.isub(this.m),C},z.prototype.sub=function(D,M){this._verify2(D,M);var C=D.sub(M);return C.cmpn(0)<0&&C.iadd(this.m),C._forceRed(this)},z.prototype.isub=function(D,M){this._verify2(D,M);var C=D.isub(M);return C.cmpn(0)<0&&C.iadd(this.m),C},z.prototype.shl=function(D,M){return this._verify1(D),this.imod(D.ushln(M))},z.prototype.imul=function(D,M){return this._verify2(D,M),this.imod(D.imul(M))},z.prototype.mul=function(D,M){return this._verify2(D,M),this.imod(D.mul(M))},z.prototype.isqr=function(D){return this.imul(D,D.clone())},z.prototype.sqr=function(D){return this.mul(D,D)},z.prototype.sqrt=function(D){if(D.isZero())return D.clone();var M=this.m.andln(3);if(l(M%2==1),M===3){var C=this.m.add(new i(1)).iushrn(2);return this.pow(D,C)}for(var w=this.m.subn(1),T=0;!w.isZero()&&w.andln(1)===0;)T++,w.iushrn(1);l(!w.isZero());var A=new i(1).toRed(this),S=A.redNeg(),j=this.m.subn(1).iushrn(1),B=this.m.bitLength();for(B=new i(2*B*B).toRed(this);this.pow(B,j).cmp(S)!==0;)B.redIAdd(S);for(var R=this.pow(B,w),X=this.pow(D,w.addn(1).iushrn(1)),Y=this.pow(D,w),ee=T;Y.cmp(A)!==0;){for(var U=Y,Q=0;U.cmp(A)!==0;Q++)U=U.redSqr();l(Q<ee);var P=this.pow(R,new i(1).iushln(ee-Q-1));X=X.redMul(P),R=P.redSqr(),Y=Y.redMul(R),ee=Q}return X},z.prototype.invm=function(D){var M=D._invmp(this.m);return M.negative!==0?(M.negative=0,this.imod(M).redNeg()):this.imod(M)},z.prototype.pow=function(D,M){if(M.isZero())return new i(1).toRed(this);if(M.cmpn(1)===0)return D.clone();var C=new Array(16);C[0]=new i(1).toRed(this),C[1]=D;for(var w=2;w<C.length;w++)C[w]=this.mul(C[w-1],D);var T=C[0],A=0,S=0,j=M.bitLength()%26;for(j===0&&(j=26),w=M.length-1;w>=0;w--){for(var B=M.words[w],R=j-1;R>=0;R--){var X=B>>R&1;T!==C[0]&&(T=this.sqr(T)),X!==0||A!==0?(A<<=1,A|=X,(++S===4||w===0&&R===0)&&(T=this.mul(T,C[A]),S=0,A=0)):S=0}j=26}return T},z.prototype.convertTo=function(D){var M=D.umod(this.m);return M===D?M.clone():M},z.prototype.convertFrom=function(D){var M=D.clone();return M.red=null,M},i.mont=function(D){return new W(D)},c(W,z),W.prototype.convertTo=function(D){return this.imod(D.ushln(this.shift))},W.prototype.convertFrom=function(D){var M=this.imod(D.mul(this.rinv));return M.red=null,M},W.prototype.imul=function(D,M){if(D.isZero()||M.isZero())return D.words[0]=0,D.length=1,D;var C=D.imul(M),w=C.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),T=C.isub(w).iushrn(this.shift),A=T;return T.cmp(this.m)>=0?A=T.isub(this.m):T.cmpn(0)<0&&(A=T.iadd(this.m)),A._forceRed(this)},W.prototype.mul=function(D,M){if(D.isZero()||M.isZero())return new i(0)._forceRed(this);var C=D.mul(M),w=C.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),T=C.isub(w).iushrn(this.shift),A=T;return T.cmp(this.m)>=0?A=T.isub(this.m):T.cmpn(0)<0&&(A=T.iadd(this.m)),A._forceRed(this)},W.prototype.invm=function(D){return this.imod(D._invmp(this.m).mul(this.r2))._forceRed(this)}})(n===void 0||n)},{buffer:188}],185:[function(e,n,a){a.byteLength=function(h){var v=p(h),b=v[0],g=v[1];return 3*(b+g)/4-g},a.toByteArray=function(h){var v,b,g=p(h),x=g[0],y=g[1],E=new l(function(L,H,V){return 3*(H+V)/4-V}(0,x,y)),N=0,I=y>0?x-4:x;for(b=0;b<I;b+=4)v=s[h.charCodeAt(b)]<<18|s[h.charCodeAt(b+1)]<<12|s[h.charCodeAt(b+2)]<<6|s[h.charCodeAt(b+3)],E[N++]=v>>16&255,E[N++]=v>>8&255,E[N++]=255&v;return y===2&&(v=s[h.charCodeAt(b)]<<2|s[h.charCodeAt(b+1)]>>4,E[N++]=255&v),y===1&&(v=s[h.charCodeAt(b)]<<10|s[h.charCodeAt(b+1)]<<4|s[h.charCodeAt(b+2)]>>2,E[N++]=v>>8&255,E[N++]=255&v),E},a.fromByteArray=function(h){for(var v,b=h.length,g=b%3,x=[],y=0,E=b-g;y<E;y+=16383)x.push(f(h,y,y+16383>E?E:y+16383));return g===1?(v=h[b-1],x.push(o[v>>2]+o[v<<4&63]+"==")):g===2&&(v=(h[b-2]<<8)+h[b-1],x.push(o[v>>10]+o[v>>4&63]+o[v<<2&63]+"=")),x.join("")};for(var o=[],s=[],l=typeof Uint8Array<"u"?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,u=c.length;i<u;++i)o[i]=c[i],s[c.charCodeAt(i)]=i;function p(h){var v=h.length;if(v%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var b=h.indexOf("=");return b===-1&&(b=v),[b,b===v?0:4-b%4]}function f(h,v,b){for(var g,x,y=[],E=v;E<b;E+=3)g=(h[E]<<16&16711680)+(h[E+1]<<8&65280)+(255&h[E+2]),y.push(o[(x=g)>>18&63]+o[x>>12&63]+o[x>>6&63]+o[63&x]);return y.join("")}s[45]=62,s[95]=63},{}],186:[function(e,n,a){(function(o,s){function l(C,w){if(!C)throw new Error(w||"Assertion failed")}function c(C,w){C.super_=w;var T=function(){};T.prototype=w.prototype,C.prototype=new T,C.prototype.constructor=C}function i(C,w,T){if(i.isBN(C))return C;this.negative=0,this.words=null,this.length=0,this.red=null,C!==null&&(w!=="le"&&w!=="be"||(T=w,w=10),this._init(C||0,w||10,T||"be"))}var u;typeof o=="object"?o.exports=i:(void 0).BN=i,i.BN=i,i.wordSize=26;try{u=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:e("buffer").Buffer}catch{}function p(C,w){var T=C.charCodeAt(w);return T>=48&&T<=57?T-48:T>=65&&T<=70?T-55:T>=97&&T<=102?T-87:void l(!1,"Invalid character in "+C)}function f(C,w,T){var A=p(C,T);return T-1>=w&&(A|=p(C,T-1)<<4),A}function h(C,w,T,A){for(var S=0,j=0,B=Math.min(C.length,T),R=w;R<B;R++){var X=C.charCodeAt(R)-48;S*=A,j=X>=49?X-49+10:X>=17?X-17+10:X,l(X>=0&&j<A,"Invalid character"),S+=j}return S}function v(C,w){C.words=w.words,C.length=w.length,C.negative=w.negative,C.red=w.red}if(i.isBN=function(C){return C instanceof i||C!==null&&typeof C=="object"&&C.constructor.wordSize===i.wordSize&&Array.isArray(C.words)},i.max=function(C,w){return C.cmp(w)>0?C:w},i.min=function(C,w){return C.cmp(w)<0?C:w},i.prototype._init=function(C,w,T){if(typeof C=="number")return this._initNumber(C,w,T);if(typeof C=="object")return this._initArray(C,w,T);w==="hex"&&(w=16),l(w===(0|w)&&w>=2&&w<=36);var A=0;(C=C.toString().replace(/\s+/g,""))[0]==="-"&&(A++,this.negative=1),A<C.length&&(w===16?this._parseHex(C,A,T):(this._parseBase(C,w,A),T==="le"&&this._initArray(this.toArray(),w,T)))},i.prototype._initNumber=function(C,w,T){C<0&&(this.negative=1,C=-C),C<67108864?(this.words=[67108863&C],this.length=1):C<4503599627370496?(this.words=[67108863&C,C/67108864&67108863],this.length=2):(l(C<9007199254740992),this.words=[67108863&C,C/67108864&67108863,1],this.length=3),T==="le"&&this._initArray(this.toArray(),w,T)},i.prototype._initArray=function(C,w,T){if(l(typeof C.length=="number"),C.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(C.length/3),this.words=new Array(this.length);for(var A=0;A<this.length;A++)this.words[A]=0;var S,j,B=0;if(T==="be")for(A=C.length-1,S=0;A>=0;A-=3)j=C[A]|C[A-1]<<8|C[A-2]<<16,this.words[S]|=j<<B&67108863,this.words[S+1]=j>>>26-B&67108863,(B+=24)>=26&&(B-=26,S++);else if(T==="le")for(A=0,S=0;A<C.length;A+=3)j=C[A]|C[A+1]<<8|C[A+2]<<16,this.words[S]|=j<<B&67108863,this.words[S+1]=j>>>26-B&67108863,(B+=24)>=26&&(B-=26,S++);return this._strip()},i.prototype._parseHex=function(C,w,T){this.length=Math.ceil((C.length-w)/6),this.words=new Array(this.length);for(var A=0;A<this.length;A++)this.words[A]=0;var S,j=0,B=0;if(T==="be")for(A=C.length-1;A>=w;A-=2)S=f(C,w,A)<<j,this.words[B]|=67108863&S,j>=18?(j-=18,B+=1,this.words[B]|=S>>>26):j+=8;else for(A=(C.length-w)%2==0?w+1:w;A<C.length;A+=2)S=f(C,w,A)<<j,this.words[B]|=67108863&S,j>=18?(j-=18,B+=1,this.words[B]|=S>>>26):j+=8;this._strip()},i.prototype._parseBase=function(C,w,T){this.words=[0],this.length=1;for(var A=0,S=1;S<=67108863;S*=w)A++;A--,S=S/w|0;for(var j=C.length-T,B=j%A,R=Math.min(j,j-B)+T,X=0,Y=T;Y<R;Y+=A)X=h(C,Y,Y+A,w),this.imuln(S),this.words[0]+X<67108864?this.words[0]+=X:this._iaddn(X);if(B!==0){var ee=1;for(X=h(C,Y,C.length,w),Y=0;Y<B;Y++)ee*=w;this.imuln(ee),this.words[0]+X<67108864?this.words[0]+=X:this._iaddn(X)}this._strip()},i.prototype.copy=function(C){C.words=new Array(this.length);for(var w=0;w<this.length;w++)C.words[w]=this.words[w];C.length=this.length,C.negative=this.negative,C.red=this.red},i.prototype._move=function(C){v(C,this)},i.prototype.clone=function(){var C=new i(null);return this.copy(C),C},i.prototype._expand=function(C){for(;this.length<C;)this.words[this.length++]=0;return this},i.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{i.prototype[Symbol.for("nodejs.util.inspect.custom")]=b}catch{i.prototype.inspect=b}else i.prototype.inspect=b;function b(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var g=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],x=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(C,w){var T;if(w=0|w||1,(C=C||10)===16||C==="hex"){T="";for(var A=0,S=0,j=0;j<this.length;j++){var B=this.words[j],R=(16777215&(B<<A|S)).toString(16);S=B>>>24-A&16777215,(A+=2)>=26&&(A-=26,j--),T=S!==0||j!==this.length-1?g[6-R.length]+R+T:R+T}for(S!==0&&(T=S.toString(16)+T);T.length%w!=0;)T="0"+T;return this.negative!==0&&(T="-"+T),T}if(C===(0|C)&&C>=2&&C<=36){var X=x[C],Y=y[C];T="";var ee=this.clone();for(ee.negative=0;!ee.isZero();){var U=ee.modrn(Y).toString(C);T=(ee=ee.idivn(Y)).isZero()?U+T:g[X-U.length]+U+T}for(this.isZero()&&(T="0"+T);T.length%w!=0;)T="0"+T;return this.negative!==0&&(T="-"+T),T}l(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var C=this.words[0];return this.length===2?C+=67108864*this.words[1]:this.length===3&&this.words[2]===1?C+=4503599627370496+67108864*this.words[1]:this.length>2&&l(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-C:C},i.prototype.toJSON=function(){return this.toString(16,2)},u&&(i.prototype.toBuffer=function(C,w){return this.toArrayLike(u,C,w)}),i.prototype.toArray=function(C,w){return this.toArrayLike(Array,C,w)};function E(C,w,T){T.negative=w.negative^C.negative;var A=C.length+w.length|0;T.length=A,A=A-1|0;var S=0|C.words[0],j=0|w.words[0],B=S*j,R=67108863&B,X=B/67108864|0;T.words[0]=R;for(var Y=1;Y<A;Y++){for(var ee=X>>>26,U=67108863&X,Q=Math.min(Y,w.length-1),P=Math.max(0,Y-C.length+1);P<=Q;P++){var F=Y-P|0;ee+=(B=(S=0|C.words[F])*(j=0|w.words[P])+U)/67108864|0,U=67108863&B}T.words[Y]=0|U,X=0|ee}return X!==0?T.words[Y]=0|X:T.length--,T._strip()}i.prototype.toArrayLike=function(C,w,T){this._strip();var A=this.byteLength(),S=T||Math.max(1,A);l(A<=S,"byte array longer than desired length"),l(S>0,"Requested array length <= 0");var j=function(B,R){return B.allocUnsafe?B.allocUnsafe(R):new B(R)}(C,S);return this["_toArrayLike"+(w==="le"?"LE":"BE")](j,A),j},i.prototype._toArrayLikeLE=function(C,w){for(var T=0,A=0,S=0,j=0;S<this.length;S++){var B=this.words[S]<<j|A;C[T++]=255&B,T<C.length&&(C[T++]=B>>8&255),T<C.length&&(C[T++]=B>>16&255),j===6?(T<C.length&&(C[T++]=B>>24&255),A=0,j=0):(A=B>>>24,j+=2)}if(T<C.length)for(C[T++]=A;T<C.length;)C[T++]=0},i.prototype._toArrayLikeBE=function(C,w){for(var T=C.length-1,A=0,S=0,j=0;S<this.length;S++){var B=this.words[S]<<j|A;C[T--]=255&B,T>=0&&(C[T--]=B>>8&255),T>=0&&(C[T--]=B>>16&255),j===6?(T>=0&&(C[T--]=B>>24&255),A=0,j=0):(A=B>>>24,j+=2)}if(T>=0)for(C[T--]=A;T>=0;)C[T--]=0},Math.clz32?i.prototype._countBits=function(C){return 32-Math.clz32(C)}:i.prototype._countBits=function(C){var w=C,T=0;return w>=4096&&(T+=13,w>>>=13),w>=64&&(T+=7,w>>>=7),w>=8&&(T+=4,w>>>=4),w>=2&&(T+=2,w>>>=2),T+w},i.prototype._zeroBits=function(C){if(C===0)return 26;var w=C,T=0;return(8191&w)==0&&(T+=13,w>>>=13),(127&w)==0&&(T+=7,w>>>=7),(15&w)==0&&(T+=4,w>>>=4),(3&w)==0&&(T+=2,w>>>=2),(1&w)==0&&T++,T},i.prototype.bitLength=function(){var C=this.words[this.length-1],w=this._countBits(C);return 26*(this.length-1)+w},i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var C=0,w=0;w<this.length;w++){var T=this._zeroBits(this.words[w]);if(C+=T,T!==26)break}return C},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(C){return this.negative!==0?this.abs().inotn(C).iaddn(1):this.clone()},i.prototype.fromTwos=function(C){return this.testn(C-1)?this.notn(C).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(C){for(;this.length<C.length;)this.words[this.length++]=0;for(var w=0;w<C.length;w++)this.words[w]=this.words[w]|C.words[w];return this._strip()},i.prototype.ior=function(C){return l((this.negative|C.negative)==0),this.iuor(C)},i.prototype.or=function(C){return this.length>C.length?this.clone().ior(C):C.clone().ior(this)},i.prototype.uor=function(C){return this.length>C.length?this.clone().iuor(C):C.clone().iuor(this)},i.prototype.iuand=function(C){var w;w=this.length>C.length?C:this;for(var T=0;T<w.length;T++)this.words[T]=this.words[T]&C.words[T];return this.length=w.length,this._strip()},i.prototype.iand=function(C){return l((this.negative|C.negative)==0),this.iuand(C)},i.prototype.and=function(C){return this.length>C.length?this.clone().iand(C):C.clone().iand(this)},i.prototype.uand=function(C){return this.length>C.length?this.clone().iuand(C):C.clone().iuand(this)},i.prototype.iuxor=function(C){var w,T;this.length>C.length?(w=this,T=C):(w=C,T=this);for(var A=0;A<T.length;A++)this.words[A]=w.words[A]^T.words[A];if(this!==w)for(;A<w.length;A++)this.words[A]=w.words[A];return this.length=w.length,this._strip()},i.prototype.ixor=function(C){return l((this.negative|C.negative)==0),this.iuxor(C)},i.prototype.xor=function(C){return this.length>C.length?this.clone().ixor(C):C.clone().ixor(this)},i.prototype.uxor=function(C){return this.length>C.length?this.clone().iuxor(C):C.clone().iuxor(this)},i.prototype.inotn=function(C){l(typeof C=="number"&&C>=0);var w=0|Math.ceil(C/26),T=C%26;this._expand(w),T>0&&w--;for(var A=0;A<w;A++)this.words[A]=67108863&~this.words[A];return T>0&&(this.words[A]=~this.words[A]&67108863>>26-T),this._strip()},i.prototype.notn=function(C){return this.clone().inotn(C)},i.prototype.setn=function(C,w){l(typeof C=="number"&&C>=0);var T=C/26|0,A=C%26;return this._expand(T+1),this.words[T]=w?this.words[T]|1<<A:this.words[T]&~(1<<A),this._strip()},i.prototype.iadd=function(C){var w,T,A;if(this.negative!==0&&C.negative===0)return this.negative=0,w=this.isub(C),this.negative^=1,this._normSign();if(this.negative===0&&C.negative!==0)return C.negative=0,w=this.isub(C),C.negative=1,w._normSign();this.length>C.length?(T=this,A=C):(T=C,A=this);for(var S=0,j=0;j<A.length;j++)w=(0|T.words[j])+(0|A.words[j])+S,this.words[j]=67108863&w,S=w>>>26;for(;S!==0&&j<T.length;j++)w=(0|T.words[j])+S,this.words[j]=67108863&w,S=w>>>26;if(this.length=T.length,S!==0)this.words[this.length]=S,this.length++;else if(T!==this)for(;j<T.length;j++)this.words[j]=T.words[j];return this},i.prototype.add=function(C){var w;return C.negative!==0&&this.negative===0?(C.negative=0,w=this.sub(C),C.negative^=1,w):C.negative===0&&this.negative!==0?(this.negative=0,w=C.sub(this),this.negative=1,w):this.length>C.length?this.clone().iadd(C):C.clone().iadd(this)},i.prototype.isub=function(C){if(C.negative!==0){C.negative=0;var w=this.iadd(C);return C.negative=1,w._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(C),this.negative=1,this._normSign();var T,A,S=this.cmp(C);if(S===0)return this.negative=0,this.length=1,this.words[0]=0,this;S>0?(T=this,A=C):(T=C,A=this);for(var j=0,B=0;B<A.length;B++)j=(w=(0|T.words[B])-(0|A.words[B])+j)>>26,this.words[B]=67108863&w;for(;j!==0&&B<T.length;B++)j=(w=(0|T.words[B])+j)>>26,this.words[B]=67108863&w;if(j===0&&B<T.length&&T!==this)for(;B<T.length;B++)this.words[B]=T.words[B];return this.length=Math.max(this.length,B),T!==this&&(this.negative=1),this._strip()},i.prototype.sub=function(C){return this.clone().isub(C)};var N=function(C,w,T){var A,S,j,B=C.words,R=w.words,X=T.words,Y=0,ee=0|B[0],U=8191&ee,Q=ee>>>13,P=0|B[1],F=8191&P,Z=P>>>13,se=0|B[2],re=8191&se,ae=se>>>13,te=0|B[3],he=8191&te,le=te>>>13,ne=0|B[4],de=8191&ne,fe=ne>>>13,Se=0|B[5],_e=8191&Se,Ce=Se>>>13,Re=0|B[6],Pe=8191&Re,Ye=Re>>>13,at=0|B[7],tt=8191&at,it=at>>>13,rt=0|B[8],ct=8191&rt,Oe=rt>>>13,pt=0|B[9],Je=8191&pt,ot=pt>>>13,ut=0|R[0],_t=8191&ut,vt=ut>>>13,ht=0|R[1],$e=8191&ht,Be=ht>>>13,wt=0|R[2],et=8191&wt,dt=wt>>>13,we=0|R[3],Ne=8191&we,lt=we>>>13,Ct=0|R[4],$t=8191&Ct,ke=Ct>>>13,De=0|R[5],bt=8191&De,xt=De>>>13,Ae=0|R[6],Le=8191&Ae,nt=Ae>>>13,ie=0|R[7],be=8191&ie,ue=ie>>>13,me=0|R[8],ve=8191&me,ge=me>>>13,Fe=0|R[9],Ue=8191&Fe,Me=Fe>>>13;T.negative=C.negative^w.negative,T.length=19;var Ve=(Y+(A=Math.imul(U,_t))|0)+((8191&(S=(S=Math.imul(U,vt))+Math.imul(Q,_t)|0))<<13)|0;Y=((j=Math.imul(Q,vt))+(S>>>13)|0)+(Ve>>>26)|0,Ve&=67108863,A=Math.imul(F,_t),S=(S=Math.imul(F,vt))+Math.imul(Z,_t)|0,j=Math.imul(Z,vt);var ze=(Y+(A=A+Math.imul(U,$e)|0)|0)+((8191&(S=(S=S+Math.imul(U,Be)|0)+Math.imul(Q,$e)|0))<<13)|0;Y=((j=j+Math.imul(Q,Be)|0)+(S>>>13)|0)+(ze>>>26)|0,ze&=67108863,A=Math.imul(re,_t),S=(S=Math.imul(re,vt))+Math.imul(ae,_t)|0,j=Math.imul(ae,vt),A=A+Math.imul(F,$e)|0,S=(S=S+Math.imul(F,Be)|0)+Math.imul(Z,$e)|0,j=j+Math.imul(Z,Be)|0;var xe=(Y+(A=A+Math.imul(U,et)|0)|0)+((8191&(S=(S=S+Math.imul(U,dt)|0)+Math.imul(Q,et)|0))<<13)|0;Y=((j=j+Math.imul(Q,dt)|0)+(S>>>13)|0)+(xe>>>26)|0,xe&=67108863,A=Math.imul(he,_t),S=(S=Math.imul(he,vt))+Math.imul(le,_t)|0,j=Math.imul(le,vt),A=A+Math.imul(re,$e)|0,S=(S=S+Math.imul(re,Be)|0)+Math.imul(ae,$e)|0,j=j+Math.imul(ae,Be)|0,A=A+Math.imul(F,et)|0,S=(S=S+Math.imul(F,dt)|0)+Math.imul(Z,et)|0,j=j+Math.imul(Z,dt)|0;var Ee=(Y+(A=A+Math.imul(U,Ne)|0)|0)+((8191&(S=(S=S+Math.imul(U,lt)|0)+Math.imul(Q,Ne)|0))<<13)|0;Y=((j=j+Math.imul(Q,lt)|0)+(S>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,A=Math.imul(de,_t),S=(S=Math.imul(de,vt))+Math.imul(fe,_t)|0,j=Math.imul(fe,vt),A=A+Math.imul(he,$e)|0,S=(S=S+Math.imul(he,Be)|0)+Math.imul(le,$e)|0,j=j+Math.imul(le,Be)|0,A=A+Math.imul(re,et)|0,S=(S=S+Math.imul(re,dt)|0)+Math.imul(ae,et)|0,j=j+Math.imul(ae,dt)|0,A=A+Math.imul(F,Ne)|0,S=(S=S+Math.imul(F,lt)|0)+Math.imul(Z,Ne)|0,j=j+Math.imul(Z,lt)|0;var We=(Y+(A=A+Math.imul(U,$t)|0)|0)+((8191&(S=(S=S+Math.imul(U,ke)|0)+Math.imul(Q,$t)|0))<<13)|0;Y=((j=j+Math.imul(Q,ke)|0)+(S>>>13)|0)+(We>>>26)|0,We&=67108863,A=Math.imul(_e,_t),S=(S=Math.imul(_e,vt))+Math.imul(Ce,_t)|0,j=Math.imul(Ce,vt),A=A+Math.imul(de,$e)|0,S=(S=S+Math.imul(de,Be)|0)+Math.imul(fe,$e)|0,j=j+Math.imul(fe,Be)|0,A=A+Math.imul(he,et)|0,S=(S=S+Math.imul(he,dt)|0)+Math.imul(le,et)|0,j=j+Math.imul(le,dt)|0,A=A+Math.imul(re,Ne)|0,S=(S=S+Math.imul(re,lt)|0)+Math.imul(ae,Ne)|0,j=j+Math.imul(ae,lt)|0,A=A+Math.imul(F,$t)|0,S=(S=S+Math.imul(F,ke)|0)+Math.imul(Z,$t)|0,j=j+Math.imul(Z,ke)|0;var ce=(Y+(A=A+Math.imul(U,bt)|0)|0)+((8191&(S=(S=S+Math.imul(U,xt)|0)+Math.imul(Q,bt)|0))<<13)|0;Y=((j=j+Math.imul(Q,xt)|0)+(S>>>13)|0)+(ce>>>26)|0,ce&=67108863,A=Math.imul(Pe,_t),S=(S=Math.imul(Pe,vt))+Math.imul(Ye,_t)|0,j=Math.imul(Ye,vt),A=A+Math.imul(_e,$e)|0,S=(S=S+Math.imul(_e,Be)|0)+Math.imul(Ce,$e)|0,j=j+Math.imul(Ce,Be)|0,A=A+Math.imul(de,et)|0,S=(S=S+Math.imul(de,dt)|0)+Math.imul(fe,et)|0,j=j+Math.imul(fe,dt)|0,A=A+Math.imul(he,Ne)|0,S=(S=S+Math.imul(he,lt)|0)+Math.imul(le,Ne)|0,j=j+Math.imul(le,lt)|0,A=A+Math.imul(re,$t)|0,S=(S=S+Math.imul(re,ke)|0)+Math.imul(ae,$t)|0,j=j+Math.imul(ae,ke)|0,A=A+Math.imul(F,bt)|0,S=(S=S+Math.imul(F,xt)|0)+Math.imul(Z,bt)|0,j=j+Math.imul(Z,xt)|0;var Te=(Y+(A=A+Math.imul(U,Le)|0)|0)+((8191&(S=(S=S+Math.imul(U,nt)|0)+Math.imul(Q,Le)|0))<<13)|0;Y=((j=j+Math.imul(Q,nt)|0)+(S>>>13)|0)+(Te>>>26)|0,Te&=67108863,A=Math.imul(tt,_t),S=(S=Math.imul(tt,vt))+Math.imul(it,_t)|0,j=Math.imul(it,vt),A=A+Math.imul(Pe,$e)|0,S=(S=S+Math.imul(Pe,Be)|0)+Math.imul(Ye,$e)|0,j=j+Math.imul(Ye,Be)|0,A=A+Math.imul(_e,et)|0,S=(S=S+Math.imul(_e,dt)|0)+Math.imul(Ce,et)|0,j=j+Math.imul(Ce,dt)|0,A=A+Math.imul(de,Ne)|0,S=(S=S+Math.imul(de,lt)|0)+Math.imul(fe,Ne)|0,j=j+Math.imul(fe,lt)|0,A=A+Math.imul(he,$t)|0,S=(S=S+Math.imul(he,ke)|0)+Math.imul(le,$t)|0,j=j+Math.imul(le,ke)|0,A=A+Math.imul(re,bt)|0,S=(S=S+Math.imul(re,xt)|0)+Math.imul(ae,bt)|0,j=j+Math.imul(ae,xt)|0,A=A+Math.imul(F,Le)|0,S=(S=S+Math.imul(F,nt)|0)+Math.imul(Z,Le)|0,j=j+Math.imul(Z,nt)|0;var qe=(Y+(A=A+Math.imul(U,be)|0)|0)+((8191&(S=(S=S+Math.imul(U,ue)|0)+Math.imul(Q,be)|0))<<13)|0;Y=((j=j+Math.imul(Q,ue)|0)+(S>>>13)|0)+(qe>>>26)|0,qe&=67108863,A=Math.imul(ct,_t),S=(S=Math.imul(ct,vt))+Math.imul(Oe,_t)|0,j=Math.imul(Oe,vt),A=A+Math.imul(tt,$e)|0,S=(S=S+Math.imul(tt,Be)|0)+Math.imul(it,$e)|0,j=j+Math.imul(it,Be)|0,A=A+Math.imul(Pe,et)|0,S=(S=S+Math.imul(Pe,dt)|0)+Math.imul(Ye,et)|0,j=j+Math.imul(Ye,dt)|0,A=A+Math.imul(_e,Ne)|0,S=(S=S+Math.imul(_e,lt)|0)+Math.imul(Ce,Ne)|0,j=j+Math.imul(Ce,lt)|0,A=A+Math.imul(de,$t)|0,S=(S=S+Math.imul(de,ke)|0)+Math.imul(fe,$t)|0,j=j+Math.imul(fe,ke)|0,A=A+Math.imul(he,bt)|0,S=(S=S+Math.imul(he,xt)|0)+Math.imul(le,bt)|0,j=j+Math.imul(le,xt)|0,A=A+Math.imul(re,Le)|0,S=(S=S+Math.imul(re,nt)|0)+Math.imul(ae,Le)|0,j=j+Math.imul(ae,nt)|0,A=A+Math.imul(F,be)|0,S=(S=S+Math.imul(F,ue)|0)+Math.imul(Z,be)|0,j=j+Math.imul(Z,ue)|0;var st=(Y+(A=A+Math.imul(U,ve)|0)|0)+((8191&(S=(S=S+Math.imul(U,ge)|0)+Math.imul(Q,ve)|0))<<13)|0;Y=((j=j+Math.imul(Q,ge)|0)+(S>>>13)|0)+(st>>>26)|0,st&=67108863,A=Math.imul(Je,_t),S=(S=Math.imul(Je,vt))+Math.imul(ot,_t)|0,j=Math.imul(ot,vt),A=A+Math.imul(ct,$e)|0,S=(S=S+Math.imul(ct,Be)|0)+Math.imul(Oe,$e)|0,j=j+Math.imul(Oe,Be)|0,A=A+Math.imul(tt,et)|0,S=(S=S+Math.imul(tt,dt)|0)+Math.imul(it,et)|0,j=j+Math.imul(it,dt)|0,A=A+Math.imul(Pe,Ne)|0,S=(S=S+Math.imul(Pe,lt)|0)+Math.imul(Ye,Ne)|0,j=j+Math.imul(Ye,lt)|0,A=A+Math.imul(_e,$t)|0,S=(S=S+Math.imul(_e,ke)|0)+Math.imul(Ce,$t)|0,j=j+Math.imul(Ce,ke)|0,A=A+Math.imul(de,bt)|0,S=(S=S+Math.imul(de,xt)|0)+Math.imul(fe,bt)|0,j=j+Math.imul(fe,xt)|0,A=A+Math.imul(he,Le)|0,S=(S=S+Math.imul(he,nt)|0)+Math.imul(le,Le)|0,j=j+Math.imul(le,nt)|0,A=A+Math.imul(re,be)|0,S=(S=S+Math.imul(re,ue)|0)+Math.imul(ae,be)|0,j=j+Math.imul(ae,ue)|0,A=A+Math.imul(F,ve)|0,S=(S=S+Math.imul(F,ge)|0)+Math.imul(Z,ve)|0,j=j+Math.imul(Z,ge)|0;var Et=(Y+(A=A+Math.imul(U,Ue)|0)|0)+((8191&(S=(S=S+Math.imul(U,Me)|0)+Math.imul(Q,Ue)|0))<<13)|0;Y=((j=j+Math.imul(Q,Me)|0)+(S>>>13)|0)+(Et>>>26)|0,Et&=67108863,A=Math.imul(Je,$e),S=(S=Math.imul(Je,Be))+Math.imul(ot,$e)|0,j=Math.imul(ot,Be),A=A+Math.imul(ct,et)|0,S=(S=S+Math.imul(ct,dt)|0)+Math.imul(Oe,et)|0,j=j+Math.imul(Oe,dt)|0,A=A+Math.imul(tt,Ne)|0,S=(S=S+Math.imul(tt,lt)|0)+Math.imul(it,Ne)|0,j=j+Math.imul(it,lt)|0,A=A+Math.imul(Pe,$t)|0,S=(S=S+Math.imul(Pe,ke)|0)+Math.imul(Ye,$t)|0,j=j+Math.imul(Ye,ke)|0,A=A+Math.imul(_e,bt)|0,S=(S=S+Math.imul(_e,xt)|0)+Math.imul(Ce,bt)|0,j=j+Math.imul(Ce,xt)|0,A=A+Math.imul(de,Le)|0,S=(S=S+Math.imul(de,nt)|0)+Math.imul(fe,Le)|0,j=j+Math.imul(fe,nt)|0,A=A+Math.imul(he,be)|0,S=(S=S+Math.imul(he,ue)|0)+Math.imul(le,be)|0,j=j+Math.imul(le,ue)|0,A=A+Math.imul(re,ve)|0,S=(S=S+Math.imul(re,ge)|0)+Math.imul(ae,ve)|0,j=j+Math.imul(ae,ge)|0;var gt=(Y+(A=A+Math.imul(F,Ue)|0)|0)+((8191&(S=(S=S+Math.imul(F,Me)|0)+Math.imul(Z,Ue)|0))<<13)|0;Y=((j=j+Math.imul(Z,Me)|0)+(S>>>13)|0)+(gt>>>26)|0,gt&=67108863,A=Math.imul(Je,et),S=(S=Math.imul(Je,dt))+Math.imul(ot,et)|0,j=Math.imul(ot,dt),A=A+Math.imul(ct,Ne)|0,S=(S=S+Math.imul(ct,lt)|0)+Math.imul(Oe,Ne)|0,j=j+Math.imul(Oe,lt)|0,A=A+Math.imul(tt,$t)|0,S=(S=S+Math.imul(tt,ke)|0)+Math.imul(it,$t)|0,j=j+Math.imul(it,ke)|0,A=A+Math.imul(Pe,bt)|0,S=(S=S+Math.imul(Pe,xt)|0)+Math.imul(Ye,bt)|0,j=j+Math.imul(Ye,xt)|0,A=A+Math.imul(_e,Le)|0,S=(S=S+Math.imul(_e,nt)|0)+Math.imul(Ce,Le)|0,j=j+Math.imul(Ce,nt)|0,A=A+Math.imul(de,be)|0,S=(S=S+Math.imul(de,ue)|0)+Math.imul(fe,be)|0,j=j+Math.imul(fe,ue)|0,A=A+Math.imul(he,ve)|0,S=(S=S+Math.imul(he,ge)|0)+Math.imul(le,ve)|0,j=j+Math.imul(le,ge)|0;var kt=(Y+(A=A+Math.imul(re,Ue)|0)|0)+((8191&(S=(S=S+Math.imul(re,Me)|0)+Math.imul(ae,Ue)|0))<<13)|0;Y=((j=j+Math.imul(ae,Me)|0)+(S>>>13)|0)+(kt>>>26)|0,kt&=67108863,A=Math.imul(Je,Ne),S=(S=Math.imul(Je,lt))+Math.imul(ot,Ne)|0,j=Math.imul(ot,lt),A=A+Math.imul(ct,$t)|0,S=(S=S+Math.imul(ct,ke)|0)+Math.imul(Oe,$t)|0,j=j+Math.imul(Oe,ke)|0,A=A+Math.imul(tt,bt)|0,S=(S=S+Math.imul(tt,xt)|0)+Math.imul(it,bt)|0,j=j+Math.imul(it,xt)|0,A=A+Math.imul(Pe,Le)|0,S=(S=S+Math.imul(Pe,nt)|0)+Math.imul(Ye,Le)|0,j=j+Math.imul(Ye,nt)|0,A=A+Math.imul(_e,be)|0,S=(S=S+Math.imul(_e,ue)|0)+Math.imul(Ce,be)|0,j=j+Math.imul(Ce,ue)|0,A=A+Math.imul(de,ve)|0,S=(S=S+Math.imul(de,ge)|0)+Math.imul(fe,ve)|0,j=j+Math.imul(fe,ge)|0;var Zt=(Y+(A=A+Math.imul(he,Ue)|0)|0)+((8191&(S=(S=S+Math.imul(he,Me)|0)+Math.imul(le,Ue)|0))<<13)|0;Y=((j=j+Math.imul(le,Me)|0)+(S>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,A=Math.imul(Je,$t),S=(S=Math.imul(Je,ke))+Math.imul(ot,$t)|0,j=Math.imul(ot,ke),A=A+Math.imul(ct,bt)|0,S=(S=S+Math.imul(ct,xt)|0)+Math.imul(Oe,bt)|0,j=j+Math.imul(Oe,xt)|0,A=A+Math.imul(tt,Le)|0,S=(S=S+Math.imul(tt,nt)|0)+Math.imul(it,Le)|0,j=j+Math.imul(it,nt)|0,A=A+Math.imul(Pe,be)|0,S=(S=S+Math.imul(Pe,ue)|0)+Math.imul(Ye,be)|0,j=j+Math.imul(Ye,ue)|0,A=A+Math.imul(_e,ve)|0,S=(S=S+Math.imul(_e,ge)|0)+Math.imul(Ce,ve)|0,j=j+Math.imul(Ce,ge)|0;var Ut=(Y+(A=A+Math.imul(de,Ue)|0)|0)+((8191&(S=(S=S+Math.imul(de,Me)|0)+Math.imul(fe,Ue)|0))<<13)|0;Y=((j=j+Math.imul(fe,Me)|0)+(S>>>13)|0)+(Ut>>>26)|0,Ut&=67108863,A=Math.imul(Je,bt),S=(S=Math.imul(Je,xt))+Math.imul(ot,bt)|0,j=Math.imul(ot,xt),A=A+Math.imul(ct,Le)|0,S=(S=S+Math.imul(ct,nt)|0)+Math.imul(Oe,Le)|0,j=j+Math.imul(Oe,nt)|0,A=A+Math.imul(tt,be)|0,S=(S=S+Math.imul(tt,ue)|0)+Math.imul(it,be)|0,j=j+Math.imul(it,ue)|0,A=A+Math.imul(Pe,ve)|0,S=(S=S+Math.imul(Pe,ge)|0)+Math.imul(Ye,ve)|0,j=j+Math.imul(Ye,ge)|0;var zt=(Y+(A=A+Math.imul(_e,Ue)|0)|0)+((8191&(S=(S=S+Math.imul(_e,Me)|0)+Math.imul(Ce,Ue)|0))<<13)|0;Y=((j=j+Math.imul(Ce,Me)|0)+(S>>>13)|0)+(zt>>>26)|0,zt&=67108863,A=Math.imul(Je,Le),S=(S=Math.imul(Je,nt))+Math.imul(ot,Le)|0,j=Math.imul(ot,nt),A=A+Math.imul(ct,be)|0,S=(S=S+Math.imul(ct,ue)|0)+Math.imul(Oe,be)|0,j=j+Math.imul(Oe,ue)|0,A=A+Math.imul(tt,ve)|0,S=(S=S+Math.imul(tt,ge)|0)+Math.imul(it,ve)|0,j=j+Math.imul(it,ge)|0;var It=(Y+(A=A+Math.imul(Pe,Ue)|0)|0)+((8191&(S=(S=S+Math.imul(Pe,Me)|0)+Math.imul(Ye,Ue)|0))<<13)|0;Y=((j=j+Math.imul(Ye,Me)|0)+(S>>>13)|0)+(It>>>26)|0,It&=67108863,A=Math.imul(Je,be),S=(S=Math.imul(Je,ue))+Math.imul(ot,be)|0,j=Math.imul(ot,ue),A=A+Math.imul(ct,ve)|0,S=(S=S+Math.imul(ct,ge)|0)+Math.imul(Oe,ve)|0,j=j+Math.imul(Oe,ge)|0;var er=(Y+(A=A+Math.imul(tt,Ue)|0)|0)+((8191&(S=(S=S+Math.imul(tt,Me)|0)+Math.imul(it,Ue)|0))<<13)|0;Y=((j=j+Math.imul(it,Me)|0)+(S>>>13)|0)+(er>>>26)|0,er&=67108863,A=Math.imul(Je,ve),S=(S=Math.imul(Je,ge))+Math.imul(ot,ve)|0,j=Math.imul(ot,ge);var mr=(Y+(A=A+Math.imul(ct,Ue)|0)|0)+((8191&(S=(S=S+Math.imul(ct,Me)|0)+Math.imul(Oe,Ue)|0))<<13)|0;Y=((j=j+Math.imul(Oe,Me)|0)+(S>>>13)|0)+(mr>>>26)|0,mr&=67108863;var tr=(Y+(A=Math.imul(Je,Ue))|0)+((8191&(S=(S=Math.imul(Je,Me))+Math.imul(ot,Ue)|0))<<13)|0;return Y=((j=Math.imul(ot,Me))+(S>>>13)|0)+(tr>>>26)|0,tr&=67108863,X[0]=Ve,X[1]=ze,X[2]=xe,X[3]=Ee,X[4]=We,X[5]=ce,X[6]=Te,X[7]=qe,X[8]=st,X[9]=Et,X[10]=gt,X[11]=kt,X[12]=Zt,X[13]=Ut,X[14]=zt,X[15]=It,X[16]=er,X[17]=mr,X[18]=tr,Y!==0&&(X[19]=Y,T.length++),T};function I(C,w,T){T.negative=w.negative^C.negative,T.length=C.length+w.length;for(var A=0,S=0,j=0;j<T.length-1;j++){var B=S;S=0;for(var R=67108863&A,X=Math.min(j,w.length-1),Y=Math.max(0,j-C.length+1);Y<=X;Y++){var ee=j-Y,U=(0|C.words[ee])*(0|w.words[Y]),Q=67108863&U;R=67108863&(Q=Q+R|0),S+=(B=(B=B+(U/67108864|0)|0)+(Q>>>26)|0)>>>26,B&=67108863}T.words[j]=R,A=B,B=S}return A!==0?T.words[j]=A:T.length--,T._strip()}function L(C,w,T){return I(C,w,T)}Math.imul||(N=E),i.prototype.mulTo=function(C,w){var T=this.length+C.length;return this.length===10&&C.length===10?N(this,C,w):T<63?E(this,C,w):T<1024?I(this,C,w):L(this,C,w)},i.prototype.mul=function(C){var w=new i(null);return w.words=new Array(this.length+C.length),this.mulTo(C,w)},i.prototype.mulf=function(C){var w=new i(null);return w.words=new Array(this.length+C.length),L(this,C,w)},i.prototype.imul=function(C){return this.clone().mulTo(C,this)},i.prototype.imuln=function(C){var w=C<0;w&&(C=-C),l(typeof C=="number"),l(C<67108864);for(var T=0,A=0;A<this.length;A++){var S=(0|this.words[A])*C,j=(67108863&S)+(67108863&T);T>>=26,T+=S/67108864|0,T+=j>>>26,this.words[A]=67108863&j}return T!==0&&(this.words[A]=T,this.length++),w?this.ineg():this},i.prototype.muln=function(C){return this.clone().imuln(C)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(C){var w=function(j){for(var B=new Array(j.bitLength()),R=0;R<B.length;R++){var X=R/26|0,Y=R%26;B[R]=j.words[X]>>>Y&1}return B}(C);if(w.length===0)return new i(1);for(var T=this,A=0;A<w.length&&w[A]===0;A++,T=T.sqr());if(++A<w.length)for(var S=T.sqr();A<w.length;A++,S=S.sqr())w[A]!==0&&(T=T.mul(S));return T},i.prototype.iushln=function(C){l(typeof C=="number"&&C>=0);var w,T=C%26,A=(C-T)/26,S=67108863>>>26-T<<26-T;if(T!==0){var j=0;for(w=0;w<this.length;w++){var B=this.words[w]&S,R=(0|this.words[w])-B<<T;this.words[w]=R|j,j=B>>>26-T}j&&(this.words[w]=j,this.length++)}if(A!==0){for(w=this.length-1;w>=0;w--)this.words[w+A]=this.words[w];for(w=0;w<A;w++)this.words[w]=0;this.length+=A}return this._strip()},i.prototype.ishln=function(C){return l(this.negative===0),this.iushln(C)},i.prototype.iushrn=function(C,w,T){var A;l(typeof C=="number"&&C>=0),A=w?(w-w%26)/26:0;var S=C%26,j=Math.min((C-S)/26,this.length),B=67108863^67108863>>>S<<S,R=T;if(A-=j,A=Math.max(0,A),R){for(var X=0;X<j;X++)R.words[X]=this.words[X];R.length=j}if(j!==0)if(this.length>j)for(this.length-=j,X=0;X<this.length;X++)this.words[X]=this.words[X+j];else this.words[0]=0,this.length=1;var Y=0;for(X=this.length-1;X>=0&&(Y!==0||X>=A);X--){var ee=0|this.words[X];this.words[X]=Y<<26-S|ee>>>S,Y=ee&B}return R&&Y!==0&&(R.words[R.length++]=Y),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},i.prototype.ishrn=function(C,w,T){return l(this.negative===0),this.iushrn(C,w,T)},i.prototype.shln=function(C){return this.clone().ishln(C)},i.prototype.ushln=function(C){return this.clone().iushln(C)},i.prototype.shrn=function(C){return this.clone().ishrn(C)},i.prototype.ushrn=function(C){return this.clone().iushrn(C)},i.prototype.testn=function(C){l(typeof C=="number"&&C>=0);var w=C%26,T=(C-w)/26,A=1<<w;return!(this.length<=T)&&!!(this.words[T]&A)},i.prototype.imaskn=function(C){l(typeof C=="number"&&C>=0);var w=C%26,T=(C-w)/26;if(l(this.negative===0,"imaskn works only with positive numbers"),this.length<=T)return this;if(w!==0&&T++,this.length=Math.min(T,this.length),w!==0){var A=67108863^67108863>>>w<<w;this.words[this.length-1]&=A}return this._strip()},i.prototype.maskn=function(C){return this.clone().imaskn(C)},i.prototype.iaddn=function(C){return l(typeof C=="number"),l(C<67108864),C<0?this.isubn(-C):this.negative!==0?this.length===1&&(0|this.words[0])<=C?(this.words[0]=C-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(C),this.negative=1,this):this._iaddn(C)},i.prototype._iaddn=function(C){this.words[0]+=C;for(var w=0;w<this.length&&this.words[w]>=67108864;w++)this.words[w]-=67108864,w===this.length-1?this.words[w+1]=1:this.words[w+1]++;return this.length=Math.max(this.length,w+1),this},i.prototype.isubn=function(C){if(l(typeof C=="number"),l(C<67108864),C<0)return this.iaddn(-C);if(this.negative!==0)return this.negative=0,this.iaddn(C),this.negative=1,this;if(this.words[0]-=C,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var w=0;w<this.length&&this.words[w]<0;w++)this.words[w]+=67108864,this.words[w+1]-=1;return this._strip()},i.prototype.addn=function(C){return this.clone().iaddn(C)},i.prototype.subn=function(C){return this.clone().isubn(C)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(C,w,T){var A,S,j=C.length+T;this._expand(j);var B=0;for(A=0;A<C.length;A++){S=(0|this.words[A+T])+B;var R=(0|C.words[A])*w;B=((S-=67108863&R)>>26)-(R/67108864|0),this.words[A+T]=67108863&S}for(;A<this.length-T;A++)B=(S=(0|this.words[A+T])+B)>>26,this.words[A+T]=67108863&S;if(B===0)return this._strip();for(l(B===-1),B=0,A=0;A<this.length;A++)B=(S=-(0|this.words[A])+B)>>26,this.words[A]=67108863&S;return this.negative=1,this._strip()},i.prototype._wordDiv=function(C,w){var T=(this.length,C.length),A=this.clone(),S=C,j=0|S.words[S.length-1];(T=26-this._countBits(j))!==0&&(S=S.ushln(T),A.iushln(T),j=0|S.words[S.length-1]);var B,R=A.length-S.length;if(w!=="mod"){(B=new i(null)).length=R+1,B.words=new Array(B.length);for(var X=0;X<B.length;X++)B.words[X]=0}var Y=A.clone()._ishlnsubmul(S,1,R);Y.negative===0&&(A=Y,B&&(B.words[R]=1));for(var ee=R-1;ee>=0;ee--){var U=67108864*(0|A.words[S.length+ee])+(0|A.words[S.length+ee-1]);for(U=Math.min(U/j|0,67108863),A._ishlnsubmul(S,U,ee);A.negative!==0;)U--,A.negative=0,A._ishlnsubmul(S,1,ee),A.isZero()||(A.negative^=1);B&&(B.words[ee]=U)}return B&&B._strip(),A._strip(),w!=="div"&&T!==0&&A.iushrn(T),{div:B||null,mod:A}},i.prototype.divmod=function(C,w,T){return l(!C.isZero()),this.isZero()?{div:new i(0),mod:new i(0)}:this.negative!==0&&C.negative===0?(j=this.neg().divmod(C,w),w!=="mod"&&(A=j.div.neg()),w!=="div"&&(S=j.mod.neg(),T&&S.negative!==0&&S.iadd(C)),{div:A,mod:S}):this.negative===0&&C.negative!==0?(j=this.divmod(C.neg(),w),w!=="mod"&&(A=j.div.neg()),{div:A,mod:j.mod}):(this.negative&C.negative)!=0?(j=this.neg().divmod(C.neg(),w),w!=="div"&&(S=j.mod.neg(),T&&S.negative!==0&&S.isub(C)),{div:j.div,mod:S}):C.length>this.length||this.cmp(C)<0?{div:new i(0),mod:this}:C.length===1?w==="div"?{div:this.divn(C.words[0]),mod:null}:w==="mod"?{div:null,mod:new i(this.modrn(C.words[0]))}:{div:this.divn(C.words[0]),mod:new i(this.modrn(C.words[0]))}:this._wordDiv(C,w);var A,S,j},i.prototype.div=function(C){return this.divmod(C,"div",!1).div},i.prototype.mod=function(C){return this.divmod(C,"mod",!1).mod},i.prototype.umod=function(C){return this.divmod(C,"mod",!0).mod},i.prototype.divRound=function(C){var w=this.divmod(C);if(w.mod.isZero())return w.div;var T=w.div.negative!==0?w.mod.isub(C):w.mod,A=C.ushrn(1),S=C.andln(1),j=T.cmp(A);return j<0||S===1&&j===0?w.div:w.div.negative!==0?w.div.isubn(1):w.div.iaddn(1)},i.prototype.modrn=function(C){var w=C<0;w&&(C=-C),l(C<=67108863);for(var T=(1<<26)%C,A=0,S=this.length-1;S>=0;S--)A=(T*A+(0|this.words[S]))%C;return w?-A:A},i.prototype.modn=function(C){return this.modrn(C)},i.prototype.idivn=function(C){var w=C<0;w&&(C=-C),l(C<=67108863);for(var T=0,A=this.length-1;A>=0;A--){var S=(0|this.words[A])+67108864*T;this.words[A]=S/C|0,T=S%C}return this._strip(),w?this.ineg():this},i.prototype.divn=function(C){return this.clone().idivn(C)},i.prototype.egcd=function(C){l(C.negative===0),l(!C.isZero());var w=this,T=C.clone();w=w.negative!==0?w.umod(C):w.clone();for(var A=new i(1),S=new i(0),j=new i(0),B=new i(1),R=0;w.isEven()&&T.isEven();)w.iushrn(1),T.iushrn(1),++R;for(var X=T.clone(),Y=w.clone();!w.isZero();){for(var ee=0,U=1;(w.words[0]&U)==0&&ee<26;++ee,U<<=1);if(ee>0)for(w.iushrn(ee);ee-- >0;)(A.isOdd()||S.isOdd())&&(A.iadd(X),S.isub(Y)),A.iushrn(1),S.iushrn(1);for(var Q=0,P=1;(T.words[0]&P)==0&&Q<26;++Q,P<<=1);if(Q>0)for(T.iushrn(Q);Q-- >0;)(j.isOdd()||B.isOdd())&&(j.iadd(X),B.isub(Y)),j.iushrn(1),B.iushrn(1);w.cmp(T)>=0?(w.isub(T),A.isub(j),S.isub(B)):(T.isub(w),j.isub(A),B.isub(S))}return{a:j,b:B,gcd:T.iushln(R)}},i.prototype._invmp=function(C){l(C.negative===0),l(!C.isZero());var w=this,T=C.clone();w=w.negative!==0?w.umod(C):w.clone();for(var A,S=new i(1),j=new i(0),B=T.clone();w.cmpn(1)>0&&T.cmpn(1)>0;){for(var R=0,X=1;(w.words[0]&X)==0&&R<26;++R,X<<=1);if(R>0)for(w.iushrn(R);R-- >0;)S.isOdd()&&S.iadd(B),S.iushrn(1);for(var Y=0,ee=1;(T.words[0]&ee)==0&&Y<26;++Y,ee<<=1);if(Y>0)for(T.iushrn(Y);Y-- >0;)j.isOdd()&&j.iadd(B),j.iushrn(1);w.cmp(T)>=0?(w.isub(T),S.isub(j)):(T.isub(w),j.isub(S))}return(A=w.cmpn(1)===0?S:j).cmpn(0)<0&&A.iadd(C),A},i.prototype.gcd=function(C){if(this.isZero())return C.abs();if(C.isZero())return this.abs();var w=this.clone(),T=C.clone();w.negative=0,T.negative=0;for(var A=0;w.isEven()&&T.isEven();A++)w.iushrn(1),T.iushrn(1);for(;;){for(;w.isEven();)w.iushrn(1);for(;T.isEven();)T.iushrn(1);var S=w.cmp(T);if(S<0){var j=w;w=T,T=j}else if(S===0||T.cmpn(1)===0)break;w.isub(T)}return T.iushln(A)},i.prototype.invm=function(C){return this.egcd(C).a.umod(C)},i.prototype.isEven=function(){return(1&this.words[0])==0},i.prototype.isOdd=function(){return(1&this.words[0])==1},i.prototype.andln=function(C){return this.words[0]&C},i.prototype.bincn=function(C){l(typeof C=="number");var w=C%26,T=(C-w)/26,A=1<<w;if(this.length<=T)return this._expand(T+1),this.words[T]|=A,this;for(var S=A,j=T;S!==0&&j<this.length;j++){var B=0|this.words[j];S=(B+=S)>>>26,B&=67108863,this.words[j]=B}return S!==0&&(this.words[j]=S,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(C){var w,T=C<0;if(this.negative!==0&&!T)return-1;if(this.negative===0&&T)return 1;if(this._strip(),this.length>1)w=1;else{T&&(C=-C),l(C<=67108863,"Number is too big");var A=0|this.words[0];w=A===C?0:A<C?-1:1}return this.negative!==0?0|-w:w},i.prototype.cmp=function(C){if(this.negative!==0&&C.negative===0)return-1;if(this.negative===0&&C.negative!==0)return 1;var w=this.ucmp(C);return this.negative!==0?0|-w:w},i.prototype.ucmp=function(C){if(this.length>C.length)return 1;if(this.length<C.length)return-1;for(var w=0,T=this.length-1;T>=0;T--){var A=0|this.words[T],S=0|C.words[T];if(A!==S){A<S?w=-1:A>S&&(w=1);break}}return w},i.prototype.gtn=function(C){return this.cmpn(C)===1},i.prototype.gt=function(C){return this.cmp(C)===1},i.prototype.gten=function(C){return this.cmpn(C)>=0},i.prototype.gte=function(C){return this.cmp(C)>=0},i.prototype.ltn=function(C){return this.cmpn(C)===-1},i.prototype.lt=function(C){return this.cmp(C)===-1},i.prototype.lten=function(C){return this.cmpn(C)<=0},i.prototype.lte=function(C){return this.cmp(C)<=0},i.prototype.eqn=function(C){return this.cmpn(C)===0},i.prototype.eq=function(C){return this.cmp(C)===0},i.red=function(C){return new D(C)},i.prototype.toRed=function(C){return l(!this.red,"Already a number in reduction context"),l(this.negative===0,"red works only with positives"),C.convertTo(this)._forceRed(C)},i.prototype.fromRed=function(){return l(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(C){return this.red=C,this},i.prototype.forceRed=function(C){return l(!this.red,"Already a number in reduction context"),this._forceRed(C)},i.prototype.redAdd=function(C){return l(this.red,"redAdd works only with red numbers"),this.red.add(this,C)},i.prototype.redIAdd=function(C){return l(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,C)},i.prototype.redSub=function(C){return l(this.red,"redSub works only with red numbers"),this.red.sub(this,C)},i.prototype.redISub=function(C){return l(this.red,"redISub works only with red numbers"),this.red.isub(this,C)},i.prototype.redShl=function(C){return l(this.red,"redShl works only with red numbers"),this.red.shl(this,C)},i.prototype.redMul=function(C){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,C),this.red.mul(this,C)},i.prototype.redIMul=function(C){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,C),this.red.imul(this,C)},i.prototype.redSqr=function(){return l(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return l(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return l(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return l(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return l(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(C){return l(this.red&&!C.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,C)};var H={k256:null,p224:null,p192:null,p25519:null};function V(C,w){this.name=C,this.p=new i(w,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function q(){V.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function K(){V.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function z(){V.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function W(){V.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function D(C){if(typeof C=="string"){var w=i._prime(C);this.m=w.p,this.prime=w}else l(C.gtn(1),"modulus must be greater than 1"),this.m=C,this.prime=null}function M(C){D.call(this,C),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}V.prototype._tmp=function(){var C=new i(null);return C.words=new Array(Math.ceil(this.n/13)),C},V.prototype.ireduce=function(C){var w,T=C;do this.split(T,this.tmp),w=(T=(T=this.imulK(T)).iadd(this.tmp)).bitLength();while(w>this.n);var A=w<this.n?-1:T.ucmp(this.p);return A===0?(T.words[0]=0,T.length=1):A>0?T.isub(this.p):T.strip!==void 0?T.strip():T._strip(),T},V.prototype.split=function(C,w){C.iushrn(this.n,0,w)},V.prototype.imulK=function(C){return C.imul(this.k)},c(q,V),q.prototype.split=function(C,w){for(var T=Math.min(C.length,9),A=0;A<T;A++)w.words[A]=C.words[A];if(w.length=T,C.length<=9)return C.words[0]=0,void(C.length=1);var S=C.words[9];for(w.words[w.length++]=4194303&S,A=10;A<C.length;A++){var j=0|C.words[A];C.words[A-10]=(4194303&j)<<4|S>>>22,S=j}S>>>=22,C.words[A-10]=S,S===0&&C.length>10?C.length-=10:C.length-=9},q.prototype.imulK=function(C){C.words[C.length]=0,C.words[C.length+1]=0,C.length+=2;for(var w=0,T=0;T<C.length;T++){var A=0|C.words[T];w+=977*A,C.words[T]=67108863&w,w=64*A+(w/67108864|0)}return C.words[C.length-1]===0&&(C.length--,C.words[C.length-1]===0&&C.length--),C},c(K,V),c(z,V),c(W,V),W.prototype.imulK=function(C){for(var w=0,T=0;T<C.length;T++){var A=19*(0|C.words[T])+w,S=67108863&A;A>>>=26,C.words[T]=S,w=A}return w!==0&&(C.words[C.length++]=w),C},i._prime=function(C){if(H[C])return H[C];var w;if(C==="k256")w=new q;else if(C==="p224")w=new K;else if(C==="p192")w=new z;else{if(C!=="p25519")throw new Error("Unknown prime "+C);w=new W}return H[C]=w,w},D.prototype._verify1=function(C){l(C.negative===0,"red works only with positives"),l(C.red,"red works only with red numbers")},D.prototype._verify2=function(C,w){l((C.negative|w.negative)==0,"red works only with positives"),l(C.red&&C.red===w.red,"red works only with red numbers")},D.prototype.imod=function(C){return this.prime?this.prime.ireduce(C)._forceRed(this):(v(C,C.umod(this.m)._forceRed(this)),C)},D.prototype.neg=function(C){return C.isZero()?C.clone():this.m.sub(C)._forceRed(this)},D.prototype.add=function(C,w){this._verify2(C,w);var T=C.add(w);return T.cmp(this.m)>=0&&T.isub(this.m),T._forceRed(this)},D.prototype.iadd=function(C,w){this._verify2(C,w);var T=C.iadd(w);return T.cmp(this.m)>=0&&T.isub(this.m),T},D.prototype.sub=function(C,w){this._verify2(C,w);var T=C.sub(w);return T.cmpn(0)<0&&T.iadd(this.m),T._forceRed(this)},D.prototype.isub=function(C,w){this._verify2(C,w);var T=C.isub(w);return T.cmpn(0)<0&&T.iadd(this.m),T},D.prototype.shl=function(C,w){return this._verify1(C),this.imod(C.ushln(w))},D.prototype.imul=function(C,w){return this._verify2(C,w),this.imod(C.imul(w))},D.prototype.mul=function(C,w){return this._verify2(C,w),this.imod(C.mul(w))},D.prototype.isqr=function(C){return this.imul(C,C.clone())},D.prototype.sqr=function(C){return this.mul(C,C)},D.prototype.sqrt=function(C){if(C.isZero())return C.clone();var w=this.m.andln(3);if(l(w%2==1),w===3){var T=this.m.add(new i(1)).iushrn(2);return this.pow(C,T)}for(var A=this.m.subn(1),S=0;!A.isZero()&&A.andln(1)===0;)S++,A.iushrn(1);l(!A.isZero());var j=new i(1).toRed(this),B=j.redNeg(),R=this.m.subn(1).iushrn(1),X=this.m.bitLength();for(X=new i(2*X*X).toRed(this);this.pow(X,R).cmp(B)!==0;)X.redIAdd(B);for(var Y=this.pow(X,A),ee=this.pow(C,A.addn(1).iushrn(1)),U=this.pow(C,A),Q=S;U.cmp(j)!==0;){for(var P=U,F=0;P.cmp(j)!==0;F++)P=P.redSqr();l(F<Q);var Z=this.pow(Y,new i(1).iushln(Q-F-1));ee=ee.redMul(Z),Y=Z.redSqr(),U=U.redMul(Y),Q=F}return ee},D.prototype.invm=function(C){var w=C._invmp(this.m);return w.negative!==0?(w.negative=0,this.imod(w).redNeg()):this.imod(w)},D.prototype.pow=function(C,w){if(w.isZero())return new i(1).toRed(this);if(w.cmpn(1)===0)return C.clone();var T=new Array(16);T[0]=new i(1).toRed(this),T[1]=C;for(var A=2;A<T.length;A++)T[A]=this.mul(T[A-1],C);var S=T[0],j=0,B=0,R=w.bitLength()%26;for(R===0&&(R=26),A=w.length-1;A>=0;A--){for(var X=w.words[A],Y=R-1;Y>=0;Y--){var ee=X>>Y&1;S!==T[0]&&(S=this.sqr(S)),ee!==0||j!==0?(j<<=1,j|=ee,(++B===4||A===0&&Y===0)&&(S=this.mul(S,T[j]),B=0,j=0)):B=0}R=26}return S},D.prototype.convertTo=function(C){var w=C.umod(this.m);return w===C?w.clone():w},D.prototype.convertFrom=function(C){var w=C.clone();return w.red=null,w},i.mont=function(C){return new M(C)},c(M,D),M.prototype.convertTo=function(C){return this.imod(C.ushln(this.shift))},M.prototype.convertFrom=function(C){var w=this.imod(C.mul(this.rinv));return w.red=null,w},M.prototype.imul=function(C,w){if(C.isZero()||w.isZero())return C.words[0]=0,C.length=1,C;var T=C.imul(w),A=T.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=T.isub(A).iushrn(this.shift),j=S;return S.cmp(this.m)>=0?j=S.isub(this.m):S.cmpn(0)<0&&(j=S.iadd(this.m)),j._forceRed(this)},M.prototype.mul=function(C,w){if(C.isZero()||w.isZero())return new i(0)._forceRed(this);var T=C.mul(w),A=T.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=T.isub(A).iushrn(this.shift),j=S;return S.cmp(this.m)>=0?j=S.isub(this.m):S.cmpn(0)<0&&(j=S.iadd(this.m)),j._forceRed(this)},M.prototype.invm=function(C){return this.imod(C._invmp(this.m).mul(this.r2))._forceRed(this)}})(n===void 0||n)},{buffer:188}],187:[function(e,n,a){var o;function s(c){this.rand=c}if(n.exports=function(c){return o||(o=new s(null)),o.generate(c)},n.exports.Rand=s,s.prototype.generate=function(c){return this._rand(c)},s.prototype._rand=function(c){if(this.rand.getBytes)return this.rand.getBytes(c);for(var i=new Uint8Array(c),u=0;u<i.length;u++)i[u]=this.rand.getByte();return i},typeof self=="object")self.crypto&&self.crypto.getRandomValues?s.prototype._rand=function(c){var i=new Uint8Array(c);return self.crypto.getRandomValues(i),i}:self.msCrypto&&self.msCrypto.getRandomValues?s.prototype._rand=function(c){var i=new Uint8Array(c);return self.msCrypto.getRandomValues(i),i}:typeof window=="object"&&(s.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var l=e("crypto");if(typeof l.randomBytes!="function")throw new Error("Not supported");s.prototype._rand=function(c){return l.randomBytes(c)}}catch{}},{crypto:188}],188:[function(e,n,a){},{}],189:[function(e,n,a){var o=e("safe-buffer").Buffer;function s(f){o.isBuffer(f)||(f=o.from(f));for(var h=f.length/4|0,v=new Array(h),b=0;b<h;b++)v[b]=f.readUInt32BE(4*b);return v}function l(f){for(;0<f.length;f++)f[0]=0}function c(f,h,v,b,g){for(var x,y,E,N,I=v[0],L=v[1],H=v[2],V=v[3],q=f[0]^h[0],K=f[1]^h[1],z=f[2]^h[2],W=f[3]^h[3],D=4,M=1;M<g;M++)x=I[q>>>24]^L[K>>>16&255]^H[z>>>8&255]^V[255&W]^h[D++],y=I[K>>>24]^L[z>>>16&255]^H[W>>>8&255]^V[255&q]^h[D++],E=I[z>>>24]^L[W>>>16&255]^H[q>>>8&255]^V[255&K]^h[D++],N=I[W>>>24]^L[q>>>16&255]^H[K>>>8&255]^V[255&z]^h[D++],q=x,K=y,z=E,W=N;return x=(b[q>>>24]<<24|b[K>>>16&255]<<16|b[z>>>8&255]<<8|b[255&W])^h[D++],y=(b[K>>>24]<<24|b[z>>>16&255]<<16|b[W>>>8&255]<<8|b[255&q])^h[D++],E=(b[z>>>24]<<24|b[W>>>16&255]<<16|b[q>>>8&255]<<8|b[255&K])^h[D++],N=(b[W>>>24]<<24|b[q>>>16&255]<<16|b[K>>>8&255]<<8|b[255&z])^h[D++],[x>>>=0,y>>>=0,E>>>=0,N>>>=0]}var i=[0,1,2,4,8,16,32,64,128,27,54],u=function(){for(var f=new Array(256),h=0;h<256;h++)f[h]=h<128?h<<1:h<<1^283;for(var v=[],b=[],g=[[],[],[],[]],x=[[],[],[],[]],y=0,E=0,N=0;N<256;++N){var I=E^E<<1^E<<2^E<<3^E<<4;I=I>>>8^255&I^99,v[y]=I,b[I]=y;var L=f[y],H=f[L],V=f[H],q=257*f[I]^16843008*I;g[0][y]=q<<24|q>>>8,g[1][y]=q<<16|q>>>16,g[2][y]=q<<8|q>>>24,g[3][y]=q,q=16843009*V^65537*H^257*L^16843008*y,x[0][I]=q<<24|q>>>8,x[1][I]=q<<16|q>>>16,x[2][I]=q<<8|q>>>24,x[3][I]=q,y===0?y=E=1:(y=L^f[f[f[V^L]]],E^=f[f[E]])}return{SBOX:v,INV_SBOX:b,SUB_MIX:g,INV_SUB_MIX:x}}();function p(f){this._key=s(f),this._reset()}p.blockSize=16,p.keySize=32,p.prototype.blockSize=p.blockSize,p.prototype.keySize=p.keySize,p.prototype._reset=function(){for(var f=this._key,h=f.length,v=h+6,b=4*(v+1),g=[],x=0;x<h;x++)g[x]=f[x];for(x=h;x<b;x++){var y=g[x-1];x%h==0?(y=y<<8|y>>>24,y=u.SBOX[y>>>24]<<24|u.SBOX[y>>>16&255]<<16|u.SBOX[y>>>8&255]<<8|u.SBOX[255&y],y^=i[x/h|0]<<24):h>6&&x%h==4&&(y=u.SBOX[y>>>24]<<24|u.SBOX[y>>>16&255]<<16|u.SBOX[y>>>8&255]<<8|u.SBOX[255&y]),g[x]=g[x-h]^y}for(var E=[],N=0;N<b;N++){var I=b-N,L=g[I-(N%4?0:4)];E[N]=N<4||I<=4?L:u.INV_SUB_MIX[0][u.SBOX[L>>>24]]^u.INV_SUB_MIX[1][u.SBOX[L>>>16&255]]^u.INV_SUB_MIX[2][u.SBOX[L>>>8&255]]^u.INV_SUB_MIX[3][u.SBOX[255&L]]}this._nRounds=v,this._keySchedule=g,this._invKeySchedule=E},p.prototype.encryptBlockRaw=function(f){return c(f=s(f),this._keySchedule,u.SUB_MIX,u.SBOX,this._nRounds)},p.prototype.encryptBlock=function(f){var h=this.encryptBlockRaw(f),v=o.allocUnsafe(16);return v.writeUInt32BE(h[0],0),v.writeUInt32BE(h[1],4),v.writeUInt32BE(h[2],8),v.writeUInt32BE(h[3],12),v},p.prototype.decryptBlock=function(f){var h=(f=s(f))[1];f[1]=f[3],f[3]=h;var v=c(f,this._invKeySchedule,u.INV_SUB_MIX,u.INV_SBOX,this._nRounds),b=o.allocUnsafe(16);return b.writeUInt32BE(v[0],0),b.writeUInt32BE(v[3],4),b.writeUInt32BE(v[2],8),b.writeUInt32BE(v[1],12),b},p.prototype.scrub=function(){l(this._keySchedule),l(this._invKeySchedule),l(this._key)},n.exports.AES=p},{"safe-buffer":494}],190:[function(e,n,a){var o=e("./aes"),s=e("safe-buffer").Buffer,l=e("cipher-base"),c=e("inherits"),i=e("./ghash"),u=e("buffer-xor"),p=e("./incr32");function f(h,v,b,g){l.call(this);var x=s.alloc(4,0);this._cipher=new o.AES(v);var y=this._cipher.encryptBlock(x);this._ghash=new i(y),b=function(E,N,I){if(N.length===12)return E._finID=s.concat([N,s.from([0,0,0,1])]),s.concat([N,s.from([0,0,0,2])]);var L=new i(I),H=N.length,V=H%16;L.update(N),V&&(V=16-V,L.update(s.alloc(V,0))),L.update(s.alloc(8,0));var q=8*H,K=s.alloc(8);K.writeUIntBE(q,0,8),L.update(K),E._finID=L.state;var z=s.from(E._finID);return p(z),z}(this,b,y),this._prev=s.from(b),this._cache=s.allocUnsafe(0),this._secCache=s.allocUnsafe(0),this._decrypt=g,this._alen=0,this._len=0,this._mode=h,this._authTag=null,this._called=!1}c(f,l),f.prototype._update=function(h){if(!this._called&&this._alen){var v=16-this._alen%16;v<16&&(v=s.alloc(v,0),this._ghash.update(v))}this._called=!0;var b=this._mode.encrypt(this,h);return this._decrypt?this._ghash.update(h):this._ghash.update(b),this._len+=h.length,b},f.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var h=u(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(v,b){var g=0;v.length!==b.length&&g++;for(var x=Math.min(v.length,b.length),y=0;y<x;++y)g+=v[y]^b[y];return g}(h,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=h,this._cipher.scrub()},f.prototype.getAuthTag=function(){if(this._decrypt||!s.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},f.prototype.setAuthTag=function(h){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=h},f.prototype.setAAD=function(h){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(h),this._alen+=h.length},n.exports=f},{"./aes":189,"./ghash":194,"./incr32":195,"buffer-xor":219,"cipher-base":221,inherits:440,"safe-buffer":494}],191:[function(e,n,a){var o=e("./encrypter"),s=e("./decrypter"),l=e("./modes/list.json");a.createCipher=a.Cipher=o.createCipher,a.createCipheriv=a.Cipheriv=o.createCipheriv,a.createDecipher=a.Decipher=s.createDecipher,a.createDecipheriv=a.Decipheriv=s.createDecipheriv,a.listCiphers=a.getCiphers=function(){return Object.keys(l)}},{"./decrypter":192,"./encrypter":193,"./modes/list.json":203}],192:[function(e,n,a){var o=e("./authCipher"),s=e("safe-buffer").Buffer,l=e("./modes"),c=e("./streamCipher"),i=e("cipher-base"),u=e("./aes"),p=e("evp_bytestokey");function f(b,g,x){i.call(this),this._cache=new h,this._last=void 0,this._cipher=new u.AES(g),this._prev=s.from(x),this._mode=b,this._autopadding=!0}function h(){this.cache=s.allocUnsafe(0)}function v(b,g,x){var y=l[b.toLowerCase()];if(!y)throw new TypeError("invalid suite type");if(typeof x=="string"&&(x=s.from(x)),y.mode!=="GCM"&&x.length!==y.iv)throw new TypeError("invalid iv length "+x.length);if(typeof g=="string"&&(g=s.from(g)),g.length!==y.key/8)throw new TypeError("invalid key length "+g.length);return y.type==="stream"?new c(y.module,g,x,!0):y.type==="auth"?new o(y.module,g,x,!0):new f(y.module,g,x)}e("inherits")(f,i),f.prototype._update=function(b){var g,x;this._cache.add(b);for(var y=[];g=this._cache.get(this._autopadding);)x=this._mode.decrypt(this,g),y.push(x);return s.concat(y)},f.prototype._final=function(){var b=this._cache.flush();if(this._autopadding)return function(g){var x=g[15];if(x<1||x>16)throw new Error("unable to decrypt data");for(var y=-1;++y<x;)if(g[y+(16-x)]!==x)throw new Error("unable to decrypt data");if(x!==16)return g.slice(0,16-x)}(this._mode.decrypt(this,b));if(b)throw new Error("data not multiple of block length")},f.prototype.setAutoPadding=function(b){return this._autopadding=!!b,this},h.prototype.add=function(b){this.cache=s.concat([this.cache,b])},h.prototype.get=function(b){var g;if(b){if(this.cache.length>16)return g=this.cache.slice(0,16),this.cache=this.cache.slice(16),g}else if(this.cache.length>=16)return g=this.cache.slice(0,16),this.cache=this.cache.slice(16),g;return null},h.prototype.flush=function(){if(this.cache.length)return this.cache},a.createDecipher=function(b,g){var x=l[b.toLowerCase()];if(!x)throw new TypeError("invalid suite type");var y=p(g,!1,x.key,x.iv);return v(b,y.key,y.iv)},a.createDecipheriv=v},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],193:[function(e,n,a){var o=e("./modes"),s=e("./authCipher"),l=e("safe-buffer").Buffer,c=e("./streamCipher"),i=e("cipher-base"),u=e("./aes"),p=e("evp_bytestokey");function f(g,x,y){i.call(this),this._cache=new v,this._cipher=new u.AES(x),this._prev=l.from(y),this._mode=g,this._autopadding=!0}e("inherits")(f,i),f.prototype._update=function(g){var x,y;this._cache.add(g);for(var E=[];x=this._cache.get();)y=this._mode.encrypt(this,x),E.push(y);return l.concat(E)};var h=l.alloc(16,16);function v(){this.cache=l.allocUnsafe(0)}function b(g,x,y){var E=o[g.toLowerCase()];if(!E)throw new TypeError("invalid suite type");if(typeof x=="string"&&(x=l.from(x)),x.length!==E.key/8)throw new TypeError("invalid key length "+x.length);if(typeof y=="string"&&(y=l.from(y)),E.mode!=="GCM"&&y.length!==E.iv)throw new TypeError("invalid iv length "+y.length);return E.type==="stream"?new c(E.module,x,y):E.type==="auth"?new s(E.module,x,y):new f(E.module,x,y)}f.prototype._final=function(){var g=this._cache.flush();if(this._autopadding)return g=this._mode.encrypt(this,g),this._cipher.scrub(),g;if(!g.equals(h))throw this._cipher.scrub(),new Error("data not multiple of block length")},f.prototype.setAutoPadding=function(g){return this._autopadding=!!g,this},v.prototype.add=function(g){this.cache=l.concat([this.cache,g])},v.prototype.get=function(){if(this.cache.length>15){var g=this.cache.slice(0,16);return this.cache=this.cache.slice(16),g}return null},v.prototype.flush=function(){for(var g=16-this.cache.length,x=l.allocUnsafe(g),y=-1;++y<g;)x.writeUInt8(g,y);return l.concat([this.cache,x])},a.createCipheriv=b,a.createCipher=function(g,x){var y=o[g.toLowerCase()];if(!y)throw new TypeError("invalid suite type");var E=p(x,!1,y.key,y.iv);return b(g,E.key,E.iv)}},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],194:[function(e,n,a){var o=e("safe-buffer").Buffer,s=o.alloc(16,0);function l(i){var u=o.allocUnsafe(16);return u.writeUInt32BE(i[0]>>>0,0),u.writeUInt32BE(i[1]>>>0,4),u.writeUInt32BE(i[2]>>>0,8),u.writeUInt32BE(i[3]>>>0,12),u}function c(i){this.h=i,this.state=o.alloc(16,0),this.cache=o.allocUnsafe(0)}c.prototype.ghash=function(i){for(var u=-1;++u<i.length;)this.state[u]^=i[u];this._multiply()},c.prototype._multiply=function(){for(var i,u,p,f=[(i=this.h).readUInt32BE(0),i.readUInt32BE(4),i.readUInt32BE(8),i.readUInt32BE(12)],h=[0,0,0,0],v=-1;++v<128;){for((this.state[~~(v/8)]&1<<7-v%8)!=0&&(h[0]^=f[0],h[1]^=f[1],h[2]^=f[2],h[3]^=f[3]),p=(1&f[3])!=0,u=3;u>0;u--)f[u]=f[u]>>>1|(1&f[u-1])<<31;f[0]=f[0]>>>1,p&&(f[0]=f[0]^225<<24)}this.state=l(h)},c.prototype.update=function(i){var u;for(this.cache=o.concat([this.cache,i]);this.cache.length>=16;)u=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(u)},c.prototype.final=function(i,u){return this.cache.length&&this.ghash(o.concat([this.cache,s],16)),this.ghash(l([0,i,0,u])),this.state},n.exports=c},{"safe-buffer":494}],195:[function(e,n,a){n.exports=function(o){for(var s,l=o.length;l--;){if((s=o.readUInt8(l))!==255){s++,o.writeUInt8(s,l);break}o.writeUInt8(0,l)}}},{}],196:[function(e,n,a){var o=e("buffer-xor");a.encrypt=function(s,l){var c=o(l,s._prev);return s._prev=s._cipher.encryptBlock(c),s._prev},a.decrypt=function(s,l){var c=s._prev;s._prev=l;var i=s._cipher.decryptBlock(l);return o(i,c)}},{"buffer-xor":219}],197:[function(e,n,a){var o=e("safe-buffer").Buffer,s=e("buffer-xor");function l(c,i,u){var p=i.length,f=s(i,c._cache);return c._cache=c._cache.slice(p),c._prev=o.concat([c._prev,u?i:f]),f}a.encrypt=function(c,i,u){for(var p,f=o.allocUnsafe(0);i.length;){if(c._cache.length===0&&(c._cache=c._cipher.encryptBlock(c._prev),c._prev=o.allocUnsafe(0)),!(c._cache.length<=i.length)){f=o.concat([f,l(c,i,u)]);break}p=c._cache.length,f=o.concat([f,l(c,i.slice(0,p),u)]),i=i.slice(p)}return f}},{"buffer-xor":219,"safe-buffer":494}],198:[function(e,n,a){var o=e("safe-buffer").Buffer;function s(c,i,u){for(var p,f,h=-1,v=0;++h<8;)p=i&1<<7-h?128:0,v+=(128&(f=c._cipher.encryptBlock(c._prev)[0]^p))>>h%8,c._prev=l(c._prev,u?p:f);return v}function l(c,i){var u=c.length,p=-1,f=o.allocUnsafe(c.length);for(c=o.concat([c,o.from([i])]);++p<u;)f[p]=c[p]<<1|c[p+1]>>7;return f}a.encrypt=function(c,i,u){for(var p=i.length,f=o.allocUnsafe(p),h=-1;++h<p;)f[h]=s(c,i[h],u);return f}},{"safe-buffer":494}],199:[function(e,n,a){var o=e("safe-buffer").Buffer;function s(l,c,i){var u=l._cipher.encryptBlock(l._prev)[0]^c;return l._prev=o.concat([l._prev.slice(1),o.from([i?c:u])]),u}a.encrypt=function(l,c,i){for(var u=c.length,p=o.allocUnsafe(u),f=-1;++f<u;)p[f]=s(l,c[f],i);return p}},{"safe-buffer":494}],200:[function(e,n,a){var o=e("buffer-xor"),s=e("safe-buffer").Buffer,l=e("../incr32");function c(i){var u=i._cipher.encryptBlockRaw(i._prev);return l(i._prev),u}a.encrypt=function(i,u){var p=Math.ceil(u.length/16),f=i._cache.length;i._cache=s.concat([i._cache,s.allocUnsafe(16*p)]);for(var h=0;h<p;h++){var v=c(i),b=f+16*h;i._cache.writeUInt32BE(v[0],b+0),i._cache.writeUInt32BE(v[1],b+4),i._cache.writeUInt32BE(v[2],b+8),i._cache.writeUInt32BE(v[3],b+12)}var g=i._cache.slice(0,u.length);return i._cache=i._cache.slice(u.length),o(u,g)}},{"../incr32":195,"buffer-xor":219,"safe-buffer":494}],201:[function(e,n,a){a.encrypt=function(o,s){return o._cipher.encryptBlock(s)},a.decrypt=function(o,s){return o._cipher.decryptBlock(s)}},{}],202:[function(e,n,a){var o={ECB:e("./ecb"),CBC:e("./cbc"),CFB:e("./cfb"),CFB8:e("./cfb8"),CFB1:e("./cfb1"),OFB:e("./ofb"),CTR:e("./ctr"),GCM:e("./ctr")},s=e("./list.json");for(var l in s)s[l].module=o[s[l].mode];n.exports=s},{"./cbc":196,"./cfb":197,"./cfb1":198,"./cfb8":199,"./ctr":200,"./ecb":201,"./list.json":203,"./ofb":204}],203:[function(e,n,a){n.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],204:[function(e,n,a){(function(o){(function(){var s=e("buffer-xor");function l(c){return c._prev=c._cipher.encryptBlock(c._prev),c._prev}a.encrypt=function(c,i){for(;c._cache.length<i.length;)c._cache=o.concat([c._cache,l(c)]);var u=c._cache.slice(0,i.length);return c._cache=c._cache.slice(i.length),s(i,u)}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220,"buffer-xor":219}],205:[function(e,n,a){var o=e("./aes"),s=e("safe-buffer").Buffer,l=e("cipher-base");function c(i,u,p,f){l.call(this),this._cipher=new o.AES(u),this._prev=s.from(p),this._cache=s.allocUnsafe(0),this._secCache=s.allocUnsafe(0),this._decrypt=f,this._mode=i}e("inherits")(c,l),c.prototype._update=function(i){return this._mode.encrypt(this,i,this._decrypt)},c.prototype._final=function(){this._cipher.scrub()},n.exports=c},{"./aes":189,"cipher-base":221,inherits:440,"safe-buffer":494}],206:[function(e,n,a){var o=e("browserify-des"),s=e("browserify-aes/browser"),l=e("browserify-aes/modes"),c=e("browserify-des/modes"),i=e("evp_bytestokey");function u(f,h,v){if(f=f.toLowerCase(),l[f])return s.createCipheriv(f,h,v);if(c[f])return new o({key:h,iv:v,mode:f});throw new TypeError("invalid suite type")}function p(f,h,v){if(f=f.toLowerCase(),l[f])return s.createDecipheriv(f,h,v);if(c[f])return new o({key:h,iv:v,mode:f,decrypt:!0});throw new TypeError("invalid suite type")}a.createCipher=a.Cipher=function(f,h){var v,b;if(f=f.toLowerCase(),l[f])v=l[f].key,b=l[f].iv;else{if(!c[f])throw new TypeError("invalid suite type");v=8*c[f].key,b=c[f].iv}var g=i(h,!1,v,b);return u(f,g.key,g.iv)},a.createCipheriv=a.Cipheriv=u,a.createDecipher=a.Decipher=function(f,h){var v,b;if(f=f.toLowerCase(),l[f])v=l[f].key,b=l[f].iv;else{if(!c[f])throw new TypeError("invalid suite type");v=8*c[f].key,b=c[f].iv}var g=i(h,!1,v,b);return p(f,g.key,g.iv)},a.createDecipheriv=a.Decipheriv=p,a.listCiphers=a.getCiphers=function(){return Object.keys(c).concat(s.getCiphers())}},{"browserify-aes/browser":191,"browserify-aes/modes":202,"browserify-des":207,"browserify-des/modes":208,evp_bytestokey:423}],207:[function(e,n,a){var o=e("cipher-base"),s=e("des.js"),l=e("inherits"),c=e("safe-buffer").Buffer,i={"des-ede3-cbc":s.CBC.instantiate(s.EDE),"des-ede3":s.EDE,"des-ede-cbc":s.CBC.instantiate(s.EDE),"des-ede":s.EDE,"des-cbc":s.CBC.instantiate(s.DES),"des-ecb":s.DES};function u(p){o.call(this);var f,h=p.mode.toLowerCase(),v=i[h];f=p.decrypt?"decrypt":"encrypt";var b=p.key;c.isBuffer(b)||(b=c.from(b)),h!=="des-ede"&&h!=="des-ede-cbc"||(b=c.concat([b,b.slice(0,8)]));var g=p.iv;c.isBuffer(g)||(g=c.from(g)),this._des=v.create({key:b,iv:g,type:f})}i.des=i["des-cbc"],i.des3=i["des-ede3-cbc"],n.exports=u,l(u,o),u.prototype._update=function(p){return c.from(this._des.update(p))},u.prototype._final=function(){return c.from(this._des.final())}},{"cipher-base":221,"des.js":394,inherits:440,"safe-buffer":494}],208:[function(e,n,a){a["des-ecb"]={key:8,iv:0},a["des-cbc"]=a.des={key:8,iv:8},a["des-ede3-cbc"]=a.des3={key:24,iv:8},a["des-ede3"]={key:24,iv:0},a["des-ede-cbc"]={key:16,iv:8},a["des-ede"]={key:16,iv:0}},{}],209:[function(e,n,a){(function(o){(function(){var s=e("bn.js"),l=e("randombytes");function c(u){var p,f=u.modulus.byteLength();do p=new s(l(f));while(p.cmp(u.modulus)>=0||!p.umod(u.prime1)||!p.umod(u.prime2));return p}function i(u,p){var f=function(H){var V=c(H);return{blinder:V.toRed(s.mont(H.modulus)).redPow(new s(H.publicExponent)).fromRed(),unblinder:V.invm(H.modulus)}}(p),h=p.modulus.byteLength(),v=new s(u).mul(f.blinder).umod(p.modulus),b=v.toRed(s.mont(p.prime1)),g=v.toRed(s.mont(p.prime2)),x=p.coefficient,y=p.prime1,E=p.prime2,N=b.redPow(p.exponent1).fromRed(),I=g.redPow(p.exponent2).fromRed(),L=N.isub(I).imul(x).umod(y).imul(E);return I.iadd(L).imul(f.unblinder).umod(p.modulus).toArrayLike(o,"be",h)}i.getr=c,n.exports=i}).call(this)}).call(this,e("buffer").Buffer)},{"bn.js":186,buffer:220,randombytes:475}],210:[function(e,n,a){n.exports=e("./browser/algorithms.json")},{"./browser/algorithms.json":211}],211:[function(e,n,a){n.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],212:[function(e,n,a){n.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],213:[function(e,n,a){var o=e("safe-buffer").Buffer,s=e("create-hash"),l=e("readable-stream"),c=e("inherits"),i=e("./sign"),u=e("./verify"),p=e("./algorithms.json");function f(g){l.Writable.call(this);var x=p[g];if(!x)throw new Error("Unknown message digest");this._hashType=x.hash,this._hash=s(x.hash),this._tag=x.id,this._signType=x.sign}function h(g){l.Writable.call(this);var x=p[g];if(!x)throw new Error("Unknown message digest");this._hash=s(x.hash),this._tag=x.id,this._signType=x.sign}function v(g){return new f(g)}function b(g){return new h(g)}Object.keys(p).forEach(function(g){p[g].id=o.from(p[g].id,"hex"),p[g.toLowerCase()]=p[g]}),c(f,l.Writable),f.prototype._write=function(g,x,y){this._hash.update(g),y()},f.prototype.update=function(g,x){return typeof g=="string"&&(g=o.from(g,x)),this._hash.update(g),this},f.prototype.sign=function(g,x){this.end();var y=this._hash.digest(),E=i(y,g,this._hashType,this._signType,this._tag);return x?E.toString(x):E},c(h,l.Writable),h.prototype._write=function(g,x,y){this._hash.update(g),y()},h.prototype.update=function(g,x){return typeof g=="string"&&(g=o.from(g,x)),this._hash.update(g),this},h.prototype.verify=function(g,x,y){typeof x=="string"&&(x=o.from(x,y)),this.end();var E=this._hash.digest();return u(x,E,g,this._signType,this._tag)},n.exports={Sign:v,Verify:b,createSign:v,createVerify:b}},{"./algorithms.json":211,"./sign":214,"./verify":215,"create-hash":386,inherits:440,"readable-stream":491,"safe-buffer":494}],214:[function(e,n,a){var o=e("safe-buffer").Buffer,s=e("create-hmac"),l=e("browserify-rsa"),c=e("elliptic").ec,i=e("bn.js"),u=e("parse-asn1"),p=e("./curves.json");function f(g,x,y,E){if((g=o.from(g.toArray())).length<x.byteLength()){var N=o.alloc(x.byteLength()-g.length);g=o.concat([N,g])}var I=y.length,L=function(q,K){q=(q=h(q,K)).mod(K);var z=o.from(q.toArray());if(z.length<K.byteLength()){var W=o.alloc(K.byteLength()-z.length);z=o.concat([W,z])}return z}(y,x),H=o.alloc(I);H.fill(1);var V=o.alloc(I);return V=s(E,V).update(H).update(o.from([0])).update(g).update(L).digest(),H=s(E,V).update(H).digest(),{k:V=s(E,V).update(H).update(o.from([1])).update(g).update(L).digest(),v:H=s(E,V).update(H).digest()}}function h(g,x){var y=new i(g),E=(g.length<<3)-x.bitLength();return E>0&&y.ishrn(E),y}function v(g,x,y){var E,N;do{for(E=o.alloc(0);8*E.length<g.bitLength();)x.v=s(y,x.k).update(x.v).digest(),E=o.concat([E,x.v]);N=h(E,g),x.k=s(y,x.k).update(x.v).update(o.from([0])).digest(),x.v=s(y,x.k).update(x.v).digest()}while(N.cmp(g)!==-1);return N}function b(g,x,y,E){return g.toRed(i.mont(y)).redPow(x).fromRed().mod(E)}n.exports=function(g,x,y,E,N){var I=u(x);if(I.curve){if(E!=="ecdsa"&&E!=="ecdsa/rsa")throw new Error("wrong private key type");return function(q,K){var z=p[K.curve.join(".")];if(!z)throw new Error("unknown curve "+K.curve.join("."));var W=new c(z).keyFromPrivate(K.privateKey).sign(q);return o.from(W.toDER())}(g,I)}if(I.type==="dsa"){if(E!=="dsa")throw new Error("wrong private key type");return function(q,K,z){for(var W,D=K.params.priv_key,M=K.params.p,C=K.params.q,w=K.params.g,T=new i(0),A=h(q,C).mod(C),S=!1,j=f(D,C,q,z);S===!1;)W=v(C,j,z),T=b(w,W,M,C),(S=W.invm(C).imul(A.add(D.mul(T))).mod(C)).cmpn(0)===0&&(S=!1,T=new i(0));return function(B,R){B=B.toArray(),R=R.toArray(),128&B[0]&&(B=[0].concat(B)),128&R[0]&&(R=[0].concat(R));var X=[48,B.length+R.length+4,2,B.length];return X=X.concat(B,[2,R.length],R),o.from(X)}(T,S)}(g,I,y)}if(E!=="rsa"&&E!=="ecdsa/rsa")throw new Error("wrong private key type");g=o.concat([N,g]);for(var L=I.modulus.byteLength(),H=[0,1];g.length+H.length+1<L;)H.push(255);H.push(0);for(var V=-1;++V<g.length;)H.push(g[V]);return l(H,I)},n.exports.getKey=f,n.exports.makeKey=v},{"./curves.json":212,"bn.js":186,"browserify-rsa":209,"create-hmac":388,elliptic:405,"parse-asn1":459,"safe-buffer":494}],215:[function(e,n,a){var o=e("safe-buffer").Buffer,s=e("bn.js"),l=e("elliptic").ec,c=e("parse-asn1"),i=e("./curves.json");function u(p,f){if(p.cmpn(0)<=0)throw new Error("invalid sig");if(p.cmp(f)>=f)throw new Error("invalid sig")}n.exports=function(p,f,h,v,b){var g=c(h);if(g.type==="ec"){if(v!=="ecdsa"&&v!=="ecdsa/rsa")throw new Error("wrong public key type");return function(H,V,q){var K=i[q.data.algorithm.curve.join(".")];if(!K)throw new Error("unknown curve "+q.data.algorithm.curve.join("."));var z=new l(K),W=q.data.subjectPrivateKey.data;return z.verify(V,H,W)}(p,f,g)}if(g.type==="dsa"){if(v!=="dsa")throw new Error("wrong public key type");return function(H,V,q){var K=q.data.p,z=q.data.q,W=q.data.g,D=q.data.pub_key,M=c.signature.decode(H,"der"),C=M.s,w=M.r;u(C,z),u(w,z);var T=s.mont(K),A=C.invm(z);return W.toRed(T).redPow(new s(V).mul(A).mod(z)).fromRed().mul(D.toRed(T).redPow(w.mul(A).mod(z)).fromRed()).mod(K).mod(z).cmp(w)===0}(p,f,g)}if(v!=="rsa"&&v!=="ecdsa/rsa")throw new Error("wrong public key type");f=o.concat([b,f]);for(var x=g.modulus.byteLength(),y=[1],E=0;f.length+y.length+2<x;)y.push(255),E++;y.push(0);for(var N=-1;++N<f.length;)y.push(f[N]);y=o.from(y);var I=s.mont(g.modulus);p=(p=new s(p).toRed(I)).redPow(new s(g.publicExponent)),p=o.from(p.fromRed().toArray());var L=E<8?1:0;for(x=Math.min(p.length,y.length),p.length!==y.length&&(L=1),N=-1;++N<x;)L|=p[N]^y[N];return L===0}},{"./curves.json":212,"bn.js":186,elliptic:405,"parse-asn1":459,"safe-buffer":494}],216:[function(e,n,a){},{}],217:[function(e,n,a){var o=e("buffer"),s=o.Buffer;function l(i,u){for(var p in i)u[p]=i[p]}function c(i,u,p){return s(i,u,p)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?n.exports=o:(l(o,a),a.Buffer=c),l(s,c),c.from=function(i,u,p){if(typeof i=="number")throw new TypeError("Argument must not be a number");return s(i,u,p)},c.alloc=function(i,u,p){if(typeof i!="number")throw new TypeError("Argument must be a number");var f=s(i);return u!==void 0?typeof p=="string"?f.fill(u,p):f.fill(u):f.fill(0),f},c.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return s(i)},c.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return o.SlowBuffer(i)}},{buffer:220}],218:[function(e,n,a){var o=e("safe-buffer").Buffer,s=o.isEncoding||function(g){switch((g=""+g)&&g.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function l(g){var x;switch(this.encoding=function(y){var E=function(N){if(!N)return"utf8";for(var I;;)switch(N){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return N;default:if(I)return;N=(""+N).toLowerCase(),I=!0}}(y);if(typeof E!="string"&&(o.isEncoding===s||!s(y)))throw new Error("Unknown encoding: "+y);return E||y}(g),this.encoding){case"utf16le":this.text=u,this.end=p,x=4;break;case"utf8":this.fillLast=i,x=4;break;case"base64":this.text=f,this.end=h,x=3;break;default:return this.write=v,void(this.end=b)}this.lastNeed=0,this.lastTotal=0,this.lastChar=o.allocUnsafe(x)}function c(g){return g<=127?0:g>>5==6?2:g>>4==14?3:g>>3==30?4:g>>6==2?-1:-2}function i(g){var x=this.lastTotal-this.lastNeed,y=function(E,N,I){if((192&N[0])!=128)return E.lastNeed=0,"";if(E.lastNeed>1&&N.length>1){if((192&N[1])!=128)return E.lastNeed=1,"";if(E.lastNeed>2&&N.length>2&&(192&N[2])!=128)return E.lastNeed=2,""}}(this,g);return y!==void 0?y:this.lastNeed<=g.length?(g.copy(this.lastChar,x,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(g.copy(this.lastChar,x,0,g.length),void(this.lastNeed-=g.length))}function u(g,x){if((g.length-x)%2==0){var y=g.toString("utf16le",x);if(y){var E=y.charCodeAt(y.length-1);if(E>=55296&&E<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=g[g.length-2],this.lastChar[1]=g[g.length-1],y.slice(0,-1)}return y}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=g[g.length-1],g.toString("utf16le",x,g.length-1)}function p(g){var x=g&&g.length?this.write(g):"";if(this.lastNeed){var y=this.lastTotal-this.lastNeed;return x+this.lastChar.toString("utf16le",0,y)}return x}function f(g,x){var y=(g.length-x)%3;return y===0?g.toString("base64",x):(this.lastNeed=3-y,this.lastTotal=3,y===1?this.lastChar[0]=g[g.length-1]:(this.lastChar[0]=g[g.length-2],this.lastChar[1]=g[g.length-1]),g.toString("base64",x,g.length-y))}function h(g){var x=g&&g.length?this.write(g):"";return this.lastNeed?x+this.lastChar.toString("base64",0,3-this.lastNeed):x}function v(g){return g.toString(this.encoding)}function b(g){return g&&g.length?this.write(g):""}a.StringDecoder=l,l.prototype.write=function(g){if(g.length===0)return"";var x,y;if(this.lastNeed){if((x=this.fillLast(g))===void 0)return"";y=this.lastNeed,this.lastNeed=0}else y=0;return y<g.length?x?x+this.text(g,y):this.text(g,y):x||""},l.prototype.end=function(g){var x=g&&g.length?this.write(g):"";return this.lastNeed?x+"":x},l.prototype.text=function(g,x){var y=function(N,I,L){var H=I.length-1;if(H<L)return 0;var V=c(I[H]);return V>=0?(V>0&&(N.lastNeed=V-1),V):--H<L||V===-2?0:(V=c(I[H]))>=0?(V>0&&(N.lastNeed=V-2),V):--H<L||V===-2?0:(V=c(I[H]))>=0?(V>0&&(V===2?V=0:N.lastNeed=V-3),V):0}(this,g,x);if(!this.lastNeed)return g.toString("utf8",x);this.lastTotal=y;var E=g.length-(y-this.lastNeed);return g.copy(this.lastChar,0,E),g.toString("utf8",x,E)},l.prototype.fillLast=function(g){if(this.lastNeed<=g.length)return g.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);g.copy(this.lastChar,this.lastTotal-this.lastNeed,0,g.length),this.lastNeed-=g.length}},{"safe-buffer":217}],219:[function(e,n,a){(function(o){(function(){n.exports=function(s,l){for(var c=Math.min(s.length,l.length),i=new o(c),u=0;u<c;++u)i[u]=s[u]^l[u];return i}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220}],220:[function(e,n,a){(function(o){(function(){var s=e("base64-js"),l=e("ieee754");a.Buffer=i,a.SlowBuffer=function(P){return+P!=P&&(P=0),i.alloc(+P)},a.INSPECT_MAX_BYTES=50;function c(P){if(P>2147483647)throw new RangeError('The value "'+P+'" is invalid for option "size"');var F=new Uint8Array(P);return F.__proto__=i.prototype,F}function i(P,F,Z){if(typeof P=="number"){if(typeof F=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(P)}return u(P,F,Z)}function u(P,F,Z){if(typeof P=="string")return function(ae,te){if(typeof te=="string"&&te!==""||(te="utf8"),!i.isEncoding(te))throw new TypeError("Unknown encoding: "+te);var he=0|b(ae,te),le=c(he),ne=le.write(ae,te);return ne!==he&&(le=le.slice(0,ne)),le}(P,F);if(ArrayBuffer.isView(P))return h(P);if(P==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof P);if(U(P,ArrayBuffer)||P&&U(P.buffer,ArrayBuffer))return function(ae,te,he){if(te<0||ae.byteLength<te)throw new RangeError('"offset" is outside of buffer bounds');if(ae.byteLength<te+(he||0))throw new RangeError('"length" is outside of buffer bounds');var le;return le=te===void 0&&he===void 0?new Uint8Array(ae):he===void 0?new Uint8Array(ae,te):new Uint8Array(ae,te,he),le.__proto__=i.prototype,le}(P,F,Z);if(typeof P=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var se=P.valueOf&&P.valueOf();if(se!=null&&se!==P)return i.from(se,F,Z);var re=function(ae){if(i.isBuffer(ae)){var te=0|v(ae.length),he=c(te);return he.length===0||ae.copy(he,0,0,te),he}if(ae.length!==void 0)return typeof ae.length!="number"||Q(ae.length)?c(0):h(ae);if(ae.type==="Buffer"&&Array.isArray(ae.data))return h(ae.data)}(P);if(re)return re;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof P[Symbol.toPrimitive]=="function")return i.from(P[Symbol.toPrimitive]("string"),F,Z);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof P)}function p(P){if(typeof P!="number")throw new TypeError('"size" argument must be of type number');if(P<0)throw new RangeError('The value "'+P+'" is invalid for option "size"')}function f(P){return p(P),c(P<0?0:0|v(P))}function h(P){for(var F=P.length<0?0:0|v(P.length),Z=c(F),se=0;se<F;se+=1)Z[se]=255&P[se];return Z}function v(P){if(P>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|P}function b(P,F){if(i.isBuffer(P))return P.length;if(ArrayBuffer.isView(P)||U(P,ArrayBuffer))return P.byteLength;if(typeof P!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof P);var Z=P.length,se=arguments.length>2&&arguments[2]===!0;if(!se&&Z===0)return 0;for(var re=!1;;)switch(F){case"ascii":case"latin1":case"binary":return Z;case"utf8":case"utf-8":return X(P).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*Z;case"hex":return Z>>>1;case"base64":return Y(P).length;default:if(re)return se?-1:X(P).length;F=(""+F).toLowerCase(),re=!0}}function g(P,F,Z){var se=!1;if((F===void 0||F<0)&&(F=0),F>this.length||((Z===void 0||Z>this.length)&&(Z=this.length),Z<=0)||(Z>>>=0)<=(F>>>=0))return"";for(P||(P="utf8");;)switch(P){case"hex":return M(this,F,Z);case"utf8":case"utf-8":return z(this,F,Z);case"ascii":return W(this,F,Z);case"latin1":case"binary":return D(this,F,Z);case"base64":return K(this,F,Z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,F,Z);default:if(se)throw new TypeError("Unknown encoding: "+P);P=(P+"").toLowerCase(),se=!0}}function x(P,F,Z){var se=P[F];P[F]=P[Z],P[Z]=se}function y(P,F,Z,se,re){if(P.length===0)return-1;if(typeof Z=="string"?(se=Z,Z=0):Z>2147483647?Z=2147483647:Z<-2147483648&&(Z=-2147483648),Q(Z=+Z)&&(Z=re?0:P.length-1),Z<0&&(Z=P.length+Z),Z>=P.length){if(re)return-1;Z=P.length-1}else if(Z<0){if(!re)return-1;Z=0}if(typeof F=="string"&&(F=i.from(F,se)),i.isBuffer(F))return F.length===0?-1:E(P,F,Z,se,re);if(typeof F=="number")return F&=255,typeof Uint8Array.prototype.indexOf=="function"?re?Uint8Array.prototype.indexOf.call(P,F,Z):Uint8Array.prototype.lastIndexOf.call(P,F,Z):E(P,[F],Z,se,re);throw new TypeError("val must be string, number or Buffer")}function E(P,F,Z,se,re){var ae,te=1,he=P.length,le=F.length;if(se!==void 0&&((se=String(se).toLowerCase())==="ucs2"||se==="ucs-2"||se==="utf16le"||se==="utf-16le")){if(P.length<2||F.length<2)return-1;te=2,he/=2,le/=2,Z/=2}function ne(_e,Ce){return te===1?_e[Ce]:_e.readUInt16BE(Ce*te)}if(re){var de=-1;for(ae=Z;ae<he;ae++)if(ne(P,ae)===ne(F,de===-1?0:ae-de)){if(de===-1&&(de=ae),ae-de+1===le)return de*te}else de!==-1&&(ae-=ae-de),de=-1}else for(Z+le>he&&(Z=he-le),ae=Z;ae>=0;ae--){for(var fe=!0,Se=0;Se<le;Se++)if(ne(P,ae+Se)!==ne(F,Se)){fe=!1;break}if(fe)return ae}return-1}function N(P,F,Z,se){Z=Number(Z)||0;var re=P.length-Z;se?(se=Number(se))>re&&(se=re):se=re;var ae=F.length;se>ae/2&&(se=ae/2);for(var te=0;te<se;++te){var he=parseInt(F.substr(2*te,2),16);if(Q(he))return te;P[Z+te]=he}return te}function I(P,F,Z,se){return ee(X(F,P.length-Z),P,Z,se)}function L(P,F,Z,se){return ee(function(re){for(var ae=[],te=0;te<re.length;++te)ae.push(255&re.charCodeAt(te));return ae}(F),P,Z,se)}function H(P,F,Z,se){return L(P,F,Z,se)}function V(P,F,Z,se){return ee(Y(F),P,Z,se)}function q(P,F,Z,se){return ee(function(re,ae){for(var te,he,le,ne=[],de=0;de<re.length&&!((ae-=2)<0);++de)te=re.charCodeAt(de),he=te>>8,le=te%256,ne.push(le),ne.push(he);return ne}(F,P.length-Z),P,Z,se)}function K(P,F,Z){return F===0&&Z===P.length?s.fromByteArray(P):s.fromByteArray(P.slice(F,Z))}function z(P,F,Z){Z=Math.min(P.length,Z);for(var se=[],re=F;re<Z;){var ae,te,he,le,ne=P[re],de=null,fe=ne>239?4:ne>223?3:ne>191?2:1;if(re+fe<=Z)switch(fe){case 1:ne<128&&(de=ne);break;case 2:(192&(ae=P[re+1]))==128&&(le=(31&ne)<<6|63&ae)>127&&(de=le);break;case 3:ae=P[re+1],te=P[re+2],(192&ae)==128&&(192&te)==128&&(le=(15&ne)<<12|(63&ae)<<6|63&te)>2047&&(le<55296||le>57343)&&(de=le);break;case 4:ae=P[re+1],te=P[re+2],he=P[re+3],(192&ae)==128&&(192&te)==128&&(192&he)==128&&(le=(15&ne)<<18|(63&ae)<<12|(63&te)<<6|63&he)>65535&&le<1114112&&(de=le)}de===null?(de=65533,fe=1):de>65535&&(de-=65536,se.push(de>>>10&1023|55296),de=56320|1023&de),se.push(de),re+=fe}return function(Se){var _e=Se.length;if(_e<=4096)return String.fromCharCode.apply(String,Se);for(var Ce="",Re=0;Re<_e;)Ce+=String.fromCharCode.apply(String,Se.slice(Re,Re+=4096));return Ce}(se)}a.kMaxLength=2147483647,i.TYPED_ARRAY_SUPPORT=function(){try{var P=new Uint8Array(1);return P.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},P.foo()===42}catch{return!1}}(),i.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(i.prototype,"parent",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.buffer}}),Object.defineProperty(i.prototype,"offset",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),i.poolSize=8192,i.from=function(P,F,Z){return u(P,F,Z)},i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,i.alloc=function(P,F,Z){return function(se,re,ae){return p(se),se<=0?c(se):re!==void 0?typeof ae=="string"?c(se).fill(re,ae):c(se).fill(re):c(se)}(P,F,Z)},i.allocUnsafe=function(P){return f(P)},i.allocUnsafeSlow=function(P){return f(P)},i.isBuffer=function(P){return P!=null&&P._isBuffer===!0&&P!==i.prototype},i.compare=function(P,F){if(U(P,Uint8Array)&&(P=i.from(P,P.offset,P.byteLength)),U(F,Uint8Array)&&(F=i.from(F,F.offset,F.byteLength)),!i.isBuffer(P)||!i.isBuffer(F))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(P===F)return 0;for(var Z=P.length,se=F.length,re=0,ae=Math.min(Z,se);re<ae;++re)if(P[re]!==F[re]){Z=P[re],se=F[re];break}return Z<se?-1:se<Z?1:0},i.isEncoding=function(P){switch(String(P).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(P,F){if(!Array.isArray(P))throw new TypeError('"list" argument must be an Array of Buffers');if(P.length===0)return i.alloc(0);var Z;if(F===void 0)for(F=0,Z=0;Z<P.length;++Z)F+=P[Z].length;var se=i.allocUnsafe(F),re=0;for(Z=0;Z<P.length;++Z){var ae=P[Z];if(U(ae,Uint8Array)&&(ae=i.from(ae)),!i.isBuffer(ae))throw new TypeError('"list" argument must be an Array of Buffers');ae.copy(se,re),re+=ae.length}return se},i.byteLength=b,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var P=this.length;if(P%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var F=0;F<P;F+=2)x(this,F,F+1);return this},i.prototype.swap32=function(){var P=this.length;if(P%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var F=0;F<P;F+=4)x(this,F,F+3),x(this,F+1,F+2);return this},i.prototype.swap64=function(){var P=this.length;if(P%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var F=0;F<P;F+=8)x(this,F,F+7),x(this,F+1,F+6),x(this,F+2,F+5),x(this,F+3,F+4);return this},i.prototype.toString=function(){var P=this.length;return P===0?"":arguments.length===0?z(this,0,P):g.apply(this,arguments)},i.prototype.toLocaleString=i.prototype.toString,i.prototype.equals=function(P){if(!i.isBuffer(P))throw new TypeError("Argument must be a Buffer");return this===P||i.compare(this,P)===0},i.prototype.inspect=function(){var P="",F=a.INSPECT_MAX_BYTES;return P=this.toString("hex",0,F).replace(/(.{2})/g,"$1 ").trim(),this.length>F&&(P+=" ... "),"<Buffer "+P+">"},i.prototype.compare=function(P,F,Z,se,re){if(U(P,Uint8Array)&&(P=i.from(P,P.offset,P.byteLength)),!i.isBuffer(P))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof P);if(F===void 0&&(F=0),Z===void 0&&(Z=P?P.length:0),se===void 0&&(se=0),re===void 0&&(re=this.length),F<0||Z>P.length||se<0||re>this.length)throw new RangeError("out of range index");if(se>=re&&F>=Z)return 0;if(se>=re)return-1;if(F>=Z)return 1;if(this===P)return 0;for(var ae=(re>>>=0)-(se>>>=0),te=(Z>>>=0)-(F>>>=0),he=Math.min(ae,te),le=this.slice(se,re),ne=P.slice(F,Z),de=0;de<he;++de)if(le[de]!==ne[de]){ae=le[de],te=ne[de];break}return ae<te?-1:te<ae?1:0},i.prototype.includes=function(P,F,Z){return this.indexOf(P,F,Z)!==-1},i.prototype.indexOf=function(P,F,Z){return y(this,P,F,Z,!0)},i.prototype.lastIndexOf=function(P,F,Z){return y(this,P,F,Z,!1)},i.prototype.write=function(P,F,Z,se){if(F===void 0)se="utf8",Z=this.length,F=0;else if(Z===void 0&&typeof F=="string")se=F,Z=this.length,F=0;else{if(!isFinite(F))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");F>>>=0,isFinite(Z)?(Z>>>=0,se===void 0&&(se="utf8")):(se=Z,Z=void 0)}var re=this.length-F;if((Z===void 0||Z>re)&&(Z=re),P.length>0&&(Z<0||F<0)||F>this.length)throw new RangeError("Attempt to write outside buffer bounds");se||(se="utf8");for(var ae=!1;;)switch(se){case"hex":return N(this,P,F,Z);case"utf8":case"utf-8":return I(this,P,F,Z);case"ascii":return L(this,P,F,Z);case"latin1":case"binary":return H(this,P,F,Z);case"base64":return V(this,P,F,Z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,P,F,Z);default:if(ae)throw new TypeError("Unknown encoding: "+se);se=(""+se).toLowerCase(),ae=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function W(P,F,Z){var se="";Z=Math.min(P.length,Z);for(var re=F;re<Z;++re)se+=String.fromCharCode(127&P[re]);return se}function D(P,F,Z){var se="";Z=Math.min(P.length,Z);for(var re=F;re<Z;++re)se+=String.fromCharCode(P[re]);return se}function M(P,F,Z){var se=P.length;(!F||F<0)&&(F=0),(!Z||Z<0||Z>se)&&(Z=se);for(var re="",ae=F;ae<Z;++ae)re+=R(P[ae]);return re}function C(P,F,Z){for(var se=P.slice(F,Z),re="",ae=0;ae<se.length;ae+=2)re+=String.fromCharCode(se[ae]+256*se[ae+1]);return re}function w(P,F,Z){if(P%1!=0||P<0)throw new RangeError("offset is not uint");if(P+F>Z)throw new RangeError("Trying to access beyond buffer length")}function T(P,F,Z,se,re,ae){if(!i.isBuffer(P))throw new TypeError('"buffer" argument must be a Buffer instance');if(F>re||F<ae)throw new RangeError('"value" argument is out of bounds');if(Z+se>P.length)throw new RangeError("Index out of range")}function A(P,F,Z,se,re,ae){if(Z+se>P.length)throw new RangeError("Index out of range");if(Z<0)throw new RangeError("Index out of range")}function S(P,F,Z,se,re){return F=+F,Z>>>=0,re||A(P,0,Z,4),l.write(P,F,Z,se,23,4),Z+4}function j(P,F,Z,se,re){return F=+F,Z>>>=0,re||A(P,0,Z,8),l.write(P,F,Z,se,52,8),Z+8}i.prototype.slice=function(P,F){var Z=this.length;(P=~~P)<0?(P+=Z)<0&&(P=0):P>Z&&(P=Z),(F=F===void 0?Z:~~F)<0?(F+=Z)<0&&(F=0):F>Z&&(F=Z),F<P&&(F=P);var se=this.subarray(P,F);return se.__proto__=i.prototype,se},i.prototype.readUIntLE=function(P,F,Z){P>>>=0,F>>>=0,Z||w(P,F,this.length);for(var se=this[P],re=1,ae=0;++ae<F&&(re*=256);)se+=this[P+ae]*re;return se},i.prototype.readUIntBE=function(P,F,Z){P>>>=0,F>>>=0,Z||w(P,F,this.length);for(var se=this[P+--F],re=1;F>0&&(re*=256);)se+=this[P+--F]*re;return se},i.prototype.readUInt8=function(P,F){return P>>>=0,F||w(P,1,this.length),this[P]},i.prototype.readUInt16LE=function(P,F){return P>>>=0,F||w(P,2,this.length),this[P]|this[P+1]<<8},i.prototype.readUInt16BE=function(P,F){return P>>>=0,F||w(P,2,this.length),this[P]<<8|this[P+1]},i.prototype.readUInt32LE=function(P,F){return P>>>=0,F||w(P,4,this.length),(this[P]|this[P+1]<<8|this[P+2]<<16)+16777216*this[P+3]},i.prototype.readUInt32BE=function(P,F){return P>>>=0,F||w(P,4,this.length),16777216*this[P]+(this[P+1]<<16|this[P+2]<<8|this[P+3])},i.prototype.readIntLE=function(P,F,Z){P>>>=0,F>>>=0,Z||w(P,F,this.length);for(var se=this[P],re=1,ae=0;++ae<F&&(re*=256);)se+=this[P+ae]*re;return se>=(re*=128)&&(se-=Math.pow(2,8*F)),se},i.prototype.readIntBE=function(P,F,Z){P>>>=0,F>>>=0,Z||w(P,F,this.length);for(var se=F,re=1,ae=this[P+--se];se>0&&(re*=256);)ae+=this[P+--se]*re;return ae>=(re*=128)&&(ae-=Math.pow(2,8*F)),ae},i.prototype.readInt8=function(P,F){return P>>>=0,F||w(P,1,this.length),128&this[P]?-1*(255-this[P]+1):this[P]},i.prototype.readInt16LE=function(P,F){P>>>=0,F||w(P,2,this.length);var Z=this[P]|this[P+1]<<8;return 32768&Z?4294901760|Z:Z},i.prototype.readInt16BE=function(P,F){P>>>=0,F||w(P,2,this.length);var Z=this[P+1]|this[P]<<8;return 32768&Z?4294901760|Z:Z},i.prototype.readInt32LE=function(P,F){return P>>>=0,F||w(P,4,this.length),this[P]|this[P+1]<<8|this[P+2]<<16|this[P+3]<<24},i.prototype.readInt32BE=function(P,F){return P>>>=0,F||w(P,4,this.length),this[P]<<24|this[P+1]<<16|this[P+2]<<8|this[P+3]},i.prototype.readFloatLE=function(P,F){return P>>>=0,F||w(P,4,this.length),l.read(this,P,!0,23,4)},i.prototype.readFloatBE=function(P,F){return P>>>=0,F||w(P,4,this.length),l.read(this,P,!1,23,4)},i.prototype.readDoubleLE=function(P,F){return P>>>=0,F||w(P,8,this.length),l.read(this,P,!0,52,8)},i.prototype.readDoubleBE=function(P,F){return P>>>=0,F||w(P,8,this.length),l.read(this,P,!1,52,8)},i.prototype.writeUIntLE=function(P,F,Z,se){P=+P,F>>>=0,Z>>>=0,se||T(this,P,F,Z,Math.pow(2,8*Z)-1,0);var re=1,ae=0;for(this[F]=255&P;++ae<Z&&(re*=256);)this[F+ae]=P/re&255;return F+Z},i.prototype.writeUIntBE=function(P,F,Z,se){P=+P,F>>>=0,Z>>>=0,se||T(this,P,F,Z,Math.pow(2,8*Z)-1,0);var re=Z-1,ae=1;for(this[F+re]=255&P;--re>=0&&(ae*=256);)this[F+re]=P/ae&255;return F+Z},i.prototype.writeUInt8=function(P,F,Z){return P=+P,F>>>=0,Z||T(this,P,F,1,255,0),this[F]=255&P,F+1},i.prototype.writeUInt16LE=function(P,F,Z){return P=+P,F>>>=0,Z||T(this,P,F,2,65535,0),this[F]=255&P,this[F+1]=P>>>8,F+2},i.prototype.writeUInt16BE=function(P,F,Z){return P=+P,F>>>=0,Z||T(this,P,F,2,65535,0),this[F]=P>>>8,this[F+1]=255&P,F+2},i.prototype.writeUInt32LE=function(P,F,Z){return P=+P,F>>>=0,Z||T(this,P,F,4,4294967295,0),this[F+3]=P>>>24,this[F+2]=P>>>16,this[F+1]=P>>>8,this[F]=255&P,F+4},i.prototype.writeUInt32BE=function(P,F,Z){return P=+P,F>>>=0,Z||T(this,P,F,4,4294967295,0),this[F]=P>>>24,this[F+1]=P>>>16,this[F+2]=P>>>8,this[F+3]=255&P,F+4},i.prototype.writeIntLE=function(P,F,Z,se){if(P=+P,F>>>=0,!se){var re=Math.pow(2,8*Z-1);T(this,P,F,Z,re-1,-re)}var ae=0,te=1,he=0;for(this[F]=255&P;++ae<Z&&(te*=256);)P<0&&he===0&&this[F+ae-1]!==0&&(he=1),this[F+ae]=(P/te>>0)-he&255;return F+Z},i.prototype.writeIntBE=function(P,F,Z,se){if(P=+P,F>>>=0,!se){var re=Math.pow(2,8*Z-1);T(this,P,F,Z,re-1,-re)}var ae=Z-1,te=1,he=0;for(this[F+ae]=255&P;--ae>=0&&(te*=256);)P<0&&he===0&&this[F+ae+1]!==0&&(he=1),this[F+ae]=(P/te>>0)-he&255;return F+Z},i.prototype.writeInt8=function(P,F,Z){return P=+P,F>>>=0,Z||T(this,P,F,1,127,-128),P<0&&(P=255+P+1),this[F]=255&P,F+1},i.prototype.writeInt16LE=function(P,F,Z){return P=+P,F>>>=0,Z||T(this,P,F,2,32767,-32768),this[F]=255&P,this[F+1]=P>>>8,F+2},i.prototype.writeInt16BE=function(P,F,Z){return P=+P,F>>>=0,Z||T(this,P,F,2,32767,-32768),this[F]=P>>>8,this[F+1]=255&P,F+2},i.prototype.writeInt32LE=function(P,F,Z){return P=+P,F>>>=0,Z||T(this,P,F,4,2147483647,-2147483648),this[F]=255&P,this[F+1]=P>>>8,this[F+2]=P>>>16,this[F+3]=P>>>24,F+4},i.prototype.writeInt32BE=function(P,F,Z){return P=+P,F>>>=0,Z||T(this,P,F,4,2147483647,-2147483648),P<0&&(P=4294967295+P+1),this[F]=P>>>24,this[F+1]=P>>>16,this[F+2]=P>>>8,this[F+3]=255&P,F+4},i.prototype.writeFloatLE=function(P,F,Z){return S(this,P,F,!0,Z)},i.prototype.writeFloatBE=function(P,F,Z){return S(this,P,F,!1,Z)},i.prototype.writeDoubleLE=function(P,F,Z){return j(this,P,F,!0,Z)},i.prototype.writeDoubleBE=function(P,F,Z){return j(this,P,F,!1,Z)},i.prototype.copy=function(P,F,Z,se){if(!i.isBuffer(P))throw new TypeError("argument should be a Buffer");if(Z||(Z=0),se||se===0||(se=this.length),F>=P.length&&(F=P.length),F||(F=0),se>0&&se<Z&&(se=Z),se===Z||P.length===0||this.length===0)return 0;if(F<0)throw new RangeError("targetStart out of bounds");if(Z<0||Z>=this.length)throw new RangeError("Index out of range");if(se<0)throw new RangeError("sourceEnd out of bounds");se>this.length&&(se=this.length),P.length-F<se-Z&&(se=P.length-F+Z);var re=se-Z;if(this===P&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(F,Z,se);else if(this===P&&Z<F&&F<se)for(var ae=re-1;ae>=0;--ae)P[ae+F]=this[ae+Z];else Uint8Array.prototype.set.call(P,this.subarray(Z,se),F);return re},i.prototype.fill=function(P,F,Z,se){if(typeof P=="string"){if(typeof F=="string"?(se=F,F=0,Z=this.length):typeof Z=="string"&&(se=Z,Z=this.length),se!==void 0&&typeof se!="string")throw new TypeError("encoding must be a string");if(typeof se=="string"&&!i.isEncoding(se))throw new TypeError("Unknown encoding: "+se);if(P.length===1){var re=P.charCodeAt(0);(se==="utf8"&&re<128||se==="latin1")&&(P=re)}}else typeof P=="number"&&(P&=255);if(F<0||this.length<F||this.length<Z)throw new RangeError("Out of range index");if(Z<=F)return this;var ae;if(F>>>=0,Z=Z===void 0?this.length:Z>>>0,P||(P=0),typeof P=="number")for(ae=F;ae<Z;++ae)this[ae]=P;else{var te=i.isBuffer(P)?P:i.from(P,se),he=te.length;if(he===0)throw new TypeError('The value "'+P+'" is invalid for argument "value"');for(ae=0;ae<Z-F;++ae)this[ae+F]=te[ae%he]}return this};var B=/[^+/0-9A-Za-z-_]/g;function R(P){return P<16?"0"+P.toString(16):P.toString(16)}function X(P,F){var Z;F=F||1/0;for(var se=P.length,re=null,ae=[],te=0;te<se;++te){if((Z=P.charCodeAt(te))>55295&&Z<57344){if(!re){if(Z>56319){(F-=3)>-1&&ae.push(239,191,189);continue}if(te+1===se){(F-=3)>-1&&ae.push(239,191,189);continue}re=Z;continue}if(Z<56320){(F-=3)>-1&&ae.push(239,191,189),re=Z;continue}Z=65536+(re-55296<<10|Z-56320)}else re&&(F-=3)>-1&&ae.push(239,191,189);if(re=null,Z<128){if((F-=1)<0)break;ae.push(Z)}else if(Z<2048){if((F-=2)<0)break;ae.push(Z>>6|192,63&Z|128)}else if(Z<65536){if((F-=3)<0)break;ae.push(Z>>12|224,Z>>6&63|128,63&Z|128)}else{if(!(Z<1114112))throw new Error("Invalid code point");if((F-=4)<0)break;ae.push(Z>>18|240,Z>>12&63|128,Z>>6&63|128,63&Z|128)}}return ae}function Y(P){return s.toByteArray(function(F){if((F=(F=F.split("=")[0]).trim().replace(B,"")).length<2)return"";for(;F.length%4!=0;)F+="=";return F}(P))}function ee(P,F,Z,se){for(var re=0;re<se&&!(re+Z>=F.length||re>=P.length);++re)F[re+Z]=P[re];return re}function U(P,F){return P instanceof F||P!=null&&P.constructor!=null&&P.constructor.name!=null&&P.constructor.name===F.name}function Q(P){return P!=P}}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":185,buffer:220,ieee754:439}],221:[function(e,n,a){var o=e("safe-buffer").Buffer,s=e("stream").Transform,l=e("string_decoder").StringDecoder;function c(i){s.call(this),this.hashMode=typeof i=="string",this.hashMode?this[i]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}e("inherits")(c,s),c.prototype.update=function(i,u,p){typeof i=="string"&&(i=o.from(i,u));var f=this._update(i);return this.hashMode?this:(p&&(f=this._toString(f,p)),f)},c.prototype.setAutoPadding=function(){},c.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},c.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},c.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},c.prototype._transform=function(i,u,p){var f;try{this.hashMode?this._update(i):this.push(this._update(i))}catch(h){f=h}finally{p(f)}},c.prototype._flush=function(i){var u;try{this.push(this.__final())}catch(p){u=p}i(u)},c.prototype._finalOrDigest=function(i){var u=this.__final()||o.alloc(0);return i&&(u=this._toString(u,i,!0)),u},c.prototype._toString=function(i,u,p){if(this._decoder||(this._decoder=new l(u),this._encoding=u),this._encoding!==u)throw new Error("can't switch encodings");var f=this._decoder.write(i);return p&&(f+=this._decoder.end()),f},n.exports=c},{inherits:440,"safe-buffer":494,stream:505,string_decoder:218}],222:[function(e,n,a){var o=e("../internals/is-callable"),s=e("../internals/try-to-string"),l=TypeError;n.exports=function(c){if(o(c))return c;throw new l(s(c)+" is not a function")}},{"../internals/is-callable":285,"../internals/try-to-string":349}],223:[function(e,n,a){var o=e("../internals/is-constructor"),s=e("../internals/try-to-string"),l=TypeError;n.exports=function(c){if(o(c))return c;throw new l(s(c)+" is not a constructor")}},{"../internals/is-constructor":286,"../internals/try-to-string":349}],224:[function(e,n,a){var o=e("../internals/is-callable"),s=String,l=TypeError;n.exports=function(c){if(typeof c=="object"||o(c))return c;throw new l("Can't set "+s(c)+" as a prototype")}},{"../internals/is-callable":285}],225:[function(e,n,a){var o=e("../internals/well-known-symbol"),s=e("../internals/object-create"),l=e("../internals/object-define-property").f,c=o("unscopables"),i=Array.prototype;i[c]===void 0&&l(i,c,{configurable:!0,value:s(null)}),n.exports=function(u){i[c][u]=!0}},{"../internals/object-create":306,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],226:[function(e,n,a){var o=e("../internals/object-is-prototype-of"),s=TypeError;n.exports=function(l,c){if(o(c,l))return l;throw new s("Incorrect invocation")}},{"../internals/object-is-prototype-of":314}],227:[function(e,n,a){var o=e("../internals/is-object"),s=String,l=TypeError;n.exports=function(c){if(o(c))return c;throw new l(s(c)+" is not an object")}},{"../internals/is-object":289}],228:[function(e,n,a){var o=e("../internals/to-indexed-object"),s=e("../internals/to-absolute-index"),l=e("../internals/length-of-array-like"),c=function(i){return function(u,p,f){var h,v=o(u),b=l(v),g=s(f,b);if(i&&p!=p){for(;b>g;)if((h=v[g++])!=h)return!0}else for(;b>g;g++)if((i||g in v)&&v[g]===p)return i||g||0;return!i&&-1}};n.exports={includes:c(!0),indexOf:c(!1)}},{"../internals/length-of-array-like":299,"../internals/to-absolute-index":340,"../internals/to-indexed-object":341}],229:[function(e,n,a){var o=e("../internals/function-bind-context"),s=e("../internals/function-uncurry-this"),l=e("../internals/indexed-object"),c=e("../internals/to-object"),i=e("../internals/length-of-array-like"),u=e("../internals/array-species-create"),p=s([].push),f=function(h){var v=h===1,b=h===2,g=h===3,x=h===4,y=h===6,E=h===7,N=h===5||y;return function(I,L,H,V){for(var q,K,z=c(I),W=l(z),D=o(L,H),M=i(W),C=0,w=V||u,T=v?w(I,M):b||E?w(I,0):void 0;M>C;C++)if((N||C in W)&&(K=D(q=W[C],C,z),h))if(v)T[C]=K;else if(K)switch(h){case 3:return!0;case 5:return q;case 6:return C;case 2:p(T,q)}else switch(h){case 4:return!1;case 7:p(T,q)}return y?-1:g||x?x:T}};n.exports={forEach:f(0),map:f(1),filter:f(2),some:f(3),every:f(4),find:f(5),findIndex:f(6),filterReject:f(7)}},{"../internals/array-species-create":233,"../internals/function-bind-context":262,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/length-of-array-like":299,"../internals/to-object":344}],230:[function(e,n,a){var o=e("../internals/to-absolute-index"),s=e("../internals/length-of-array-like"),l=e("../internals/create-property"),c=Array,i=Math.max;n.exports=function(u,p,f){for(var h=s(u),v=o(p,h),b=o(f===void 0?h:f,h),g=c(i(b-v,0)),x=0;v<b;v++,x++)l(g,x,u[v]);return g.length=x,g}},{"../internals/create-property":243,"../internals/length-of-array-like":299,"../internals/to-absolute-index":340}],231:[function(e,n,a){var o=e("../internals/function-uncurry-this");n.exports=o([].slice)},{"../internals/function-uncurry-this":268}],232:[function(e,n,a){var o=e("../internals/is-array"),s=e("../internals/is-constructor"),l=e("../internals/is-object"),c=e("../internals/well-known-symbol")("species"),i=Array;n.exports=function(u){var p;return o(u)&&(p=u.constructor,(s(p)&&(p===i||o(p.prototype))||l(p)&&(p=p[c])===null)&&(p=void 0)),p===void 0?i:p}},{"../internals/is-array":284,"../internals/is-constructor":286,"../internals/is-object":289,"../internals/well-known-symbol":357}],233:[function(e,n,a){var o=e("../internals/array-species-constructor");n.exports=function(s,l){return new(o(s))(l===0?0:l)}},{"../internals/array-species-constructor":232}],234:[function(e,n,a){var o=e("../internals/well-known-symbol")("iterator"),s=!1;try{var l=0,c={next:function(){return{done:!!l++}},return:function(){s=!0}};c[o]=function(){return this},Array.from(c,function(){throw 2})}catch{}n.exports=function(i,u){try{if(!u&&!s)return!1}catch{return!1}var p=!1;try{var f={};f[o]=function(){return{next:function(){return{done:p=!0}}}},i(f)}catch{}return p}},{"../internals/well-known-symbol":357}],235:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=o({}.toString),l=o("".slice);n.exports=function(c){return l(s(c),8,-1)}},{"../internals/function-uncurry-this":268}],236:[function(e,n,a){var o=e("../internals/to-string-tag-support"),s=e("../internals/is-callable"),l=e("../internals/classof-raw"),c=e("../internals/well-known-symbol")("toStringTag"),i=Object,u=l(function(){return arguments}())==="Arguments";n.exports=o?l:function(p){var f,h,v;return p===void 0?"Undefined":p===null?"Null":typeof(h=function(b,g){try{return b[g]}catch{}}(f=i(p),c))=="string"?h:u?l(f):(v=l(f))==="Object"&&s(f.callee)?"Arguments":v}},{"../internals/classof-raw":235,"../internals/is-callable":285,"../internals/to-string-tag-support":347,"../internals/well-known-symbol":357}],237:[function(e,n,a){var o=e("../internals/has-own-property"),s=e("../internals/own-keys"),l=e("../internals/object-get-own-property-descriptor"),c=e("../internals/object-define-property");n.exports=function(i,u,p){for(var f=s(u),h=c.f,v=l.f,b=0;b<f.length;b++){var g=f[b];o(i,g)||p&&o(p,g)||h(i,g,v(u,g))}}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/own-keys":321}],238:[function(e,n,a){var o=e("../internals/well-known-symbol")("match");n.exports=function(s){var l=/./;try{"/./"[s](l)}catch{try{return l[o]=!1,"/./"[s](l)}catch{}}return!1}},{"../internals/well-known-symbol":357}],239:[function(e,n,a){var o=e("../internals/fails");n.exports=!o(function(){function s(){}return s.prototype.constructor=null,Object.getPrototypeOf(new s)!==s.prototype})},{"../internals/fails":260}],240:[function(e,n,a){n.exports=function(o,s){return{value:o,done:s}}},{}],241:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/object-define-property"),l=e("../internals/create-property-descriptor");n.exports=o?function(c,i,u){return s.f(c,i,l(1,u))}:function(c,i,u){return c[i]=u,c}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/object-define-property":308}],242:[function(e,n,a){n.exports=function(o,s){return{enumerable:!(1&o),configurable:!(2&o),writable:!(4&o),value:s}}},{}],243:[function(e,n,a){var o=e("../internals/to-property-key"),s=e("../internals/object-define-property"),l=e("../internals/create-property-descriptor");n.exports=function(c,i,u){var p=o(i);p in c?s.f(c,p,l(0,u)):c[p]=u}},{"../internals/create-property-descriptor":242,"../internals/object-define-property":308,"../internals/to-property-key":346}],244:[function(e,n,a){var o=e("../internals/make-built-in"),s=e("../internals/object-define-property");n.exports=function(l,c,i){return i.get&&o(i.get,c,{getter:!0}),i.set&&o(i.set,c,{setter:!0}),s.f(l,c,i)}},{"../internals/make-built-in":300,"../internals/object-define-property":308}],245:[function(e,n,a){var o=e("../internals/is-callable"),s=e("../internals/object-define-property"),l=e("../internals/make-built-in"),c=e("../internals/define-global-property");n.exports=function(i,u,p,f){f||(f={});var h=f.enumerable,v=f.name!==void 0?f.name:u;if(o(p)&&l(p,v,f),f.global)h?i[u]=p:c(u,p);else{try{f.unsafe?i[u]&&(h=!0):delete i[u]}catch{}h?i[u]=p:s.f(i,u,{value:p,enumerable:!1,configurable:!f.nonConfigurable,writable:!f.nonWritable})}return i}},{"../internals/define-global-property":246,"../internals/is-callable":285,"../internals/make-built-in":300,"../internals/object-define-property":308}],246:[function(e,n,a){var o=e("../internals/global"),s=Object.defineProperty;n.exports=function(l,c){try{s(o,l,{value:c,configurable:!0,writable:!0})}catch{o[l]=c}return c}},{"../internals/global":274}],247:[function(e,n,a){var o=e("../internals/fails");n.exports=!o(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},{"../internals/fails":260}],248:[function(e,n,a){var o=typeof document=="object"&&document.all,s=o===void 0&&o!==void 0;n.exports={all:o,IS_HTMLDDA:s}},{}],249:[function(e,n,a){var o=e("../internals/global"),s=e("../internals/is-object"),l=o.document,c=s(l)&&s(l.createElement);n.exports=function(i){return c?l.createElement(i):{}}},{"../internals/global":274,"../internals/is-object":289}],250:[function(e,n,a){var o=e("../internals/engine-is-deno"),s=e("../internals/engine-is-node");n.exports=!o&&!s&&typeof window=="object"&&typeof document=="object"},{"../internals/engine-is-deno":251,"../internals/engine-is-node":254}],251:[function(e,n,a){n.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},{}],252:[function(e,n,a){var o=e("../internals/engine-user-agent");n.exports=/ipad|iphone|ipod/i.test(o)&&typeof Pebble<"u"},{"../internals/engine-user-agent":256}],253:[function(e,n,a){var o=e("../internals/engine-user-agent");n.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(o)},{"../internals/engine-user-agent":256}],254:[function(e,n,a){var o=e("../internals/global"),s=e("../internals/classof-raw");n.exports=s(o.process)==="process"},{"../internals/classof-raw":235,"../internals/global":274}],255:[function(e,n,a){var o=e("../internals/engine-user-agent");n.exports=/web0s(?!.*chrome)/i.test(o)},{"../internals/engine-user-agent":256}],256:[function(e,n,a){n.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},{}],257:[function(e,n,a){var o,s,l=e("../internals/global"),c=e("../internals/engine-user-agent"),i=l.process,u=l.Deno,p=i&&i.versions||u&&u.version,f=p&&p.v8;f&&(s=(o=f.split("."))[0]>0&&o[0]<4?1:+(o[0]+o[1])),!s&&c&&(!(o=c.match(/Edge\/(\d+)/))||o[1]>=74)&&(o=c.match(/Chrome\/(\d+)/))&&(s=+o[1]),n.exports=s},{"../internals/engine-user-agent":256,"../internals/global":274}],258:[function(e,n,a){n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],259:[function(e,n,a){var o=e("../internals/global"),s=e("../internals/object-get-own-property-descriptor").f,l=e("../internals/create-non-enumerable-property"),c=e("../internals/define-built-in"),i=e("../internals/define-global-property"),u=e("../internals/copy-constructor-properties"),p=e("../internals/is-forced");n.exports=function(f,h){var v,b,g,x,y,E=f.target,N=f.global,I=f.stat;if(v=N?o:I?o[E]||i(E,{}):(o[E]||{}).prototype)for(b in h){if(x=h[b],g=f.dontCallGetSet?(y=s(v,b))&&y.value:v[b],!p(N?b:E+(I?".":"#")+b,f.forced)&&g!==void 0){if(typeof x==typeof g)continue;u(x,g)}(f.sham||g&&g.sham)&&l(x,"sham",!0),c(v,b,x,f)}}},{"../internals/copy-constructor-properties":237,"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/define-global-property":246,"../internals/global":274,"../internals/is-forced":287,"../internals/object-get-own-property-descriptor":309}],260:[function(e,n,a){n.exports=function(o){try{return!!o()}catch{return!0}}},{}],261:[function(e,n,a){var o=e("../internals/function-bind-native"),s=Function.prototype,l=s.apply,c=s.call;n.exports=typeof Reflect=="object"&&Reflect.apply||(o?c.bind(l):function(){return c.apply(l,arguments)})},{"../internals/function-bind-native":263}],262:[function(e,n,a){var o=e("../internals/function-uncurry-this-clause"),s=e("../internals/a-callable"),l=e("../internals/function-bind-native"),c=o(o.bind);n.exports=function(i,u){return s(i),u===void 0?i:l?c(i,u):function(){return i.apply(u,arguments)}}},{"../internals/a-callable":222,"../internals/function-bind-native":263,"../internals/function-uncurry-this-clause":267}],263:[function(e,n,a){var o=e("../internals/fails");n.exports=!o(function(){var s=(function(){}).bind();return typeof s!="function"||s.hasOwnProperty("prototype")})},{"../internals/fails":260}],264:[function(e,n,a){var o=e("../internals/function-bind-native"),s=Function.prototype.call;n.exports=o?s.bind(s):function(){return s.apply(s,arguments)}},{"../internals/function-bind-native":263}],265:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/has-own-property"),l=Function.prototype,c=o&&Object.getOwnPropertyDescriptor,i=s(l,"name"),u=i&&(function(){}).name==="something",p=i&&(!o||o&&c(l,"name").configurable);n.exports={EXISTS:i,PROPER:u,CONFIGURABLE:p}},{"../internals/descriptors":247,"../internals/has-own-property":275}],266:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=e("../internals/a-callable");n.exports=function(l,c,i){try{return o(s(Object.getOwnPropertyDescriptor(l,c)[i]))}catch{}}},{"../internals/a-callable":222,"../internals/function-uncurry-this":268}],267:[function(e,n,a){var o=e("../internals/classof-raw"),s=e("../internals/function-uncurry-this");n.exports=function(l){if(o(l)==="Function")return s(l)}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268}],268:[function(e,n,a){var o=e("../internals/function-bind-native"),s=Function.prototype,l=s.call,c=o&&s.bind.bind(l,l);n.exports=o?c:function(i){return function(){return l.apply(i,arguments)}}},{"../internals/function-bind-native":263}],269:[function(e,n,a){var o=e("../internals/global"),s=e("../internals/is-callable"),l=function(c){return s(c)?c:void 0};n.exports=function(c,i){return arguments.length<2?l(o[c]):o[c]&&o[c][i]}},{"../internals/global":274,"../internals/is-callable":285}],270:[function(e,n,a){var o=e("../internals/classof"),s=e("../internals/get-method"),l=e("../internals/is-null-or-undefined"),c=e("../internals/iterators"),i=e("../internals/well-known-symbol")("iterator");n.exports=function(u){if(!l(u))return s(u,i)||s(u,"@@iterator")||c[o(u)]}},{"../internals/classof":236,"../internals/get-method":273,"../internals/is-null-or-undefined":288,"../internals/iterators":298,"../internals/well-known-symbol":357}],271:[function(e,n,a){var o=e("../internals/function-call"),s=e("../internals/a-callable"),l=e("../internals/an-object"),c=e("../internals/try-to-string"),i=e("../internals/get-iterator-method"),u=TypeError;n.exports=function(p,f){var h=arguments.length<2?i(p):f;if(s(h))return l(o(h,p));throw new u(c(p)+" is not iterable")}},{"../internals/a-callable":222,"../internals/an-object":227,"../internals/function-call":264,"../internals/get-iterator-method":270,"../internals/try-to-string":349}],272:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=e("../internals/is-array"),l=e("../internals/is-callable"),c=e("../internals/classof-raw"),i=e("../internals/to-string"),u=o([].push);n.exports=function(p){if(l(p))return p;if(s(p)){for(var f=p.length,h=[],v=0;v<f;v++){var b=p[v];typeof b=="string"?u(h,b):typeof b!="number"&&c(b)!=="Number"&&c(b)!=="String"||u(h,i(b))}var g=h.length,x=!0;return function(y,E){if(x)return x=!1,E;if(s(this))return E;for(var N=0;N<g;N++)if(h[N]===y)return E}}}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268,"../internals/is-array":284,"../internals/is-callable":285,"../internals/to-string":348}],273:[function(e,n,a){var o=e("../internals/a-callable"),s=e("../internals/is-null-or-undefined");n.exports=function(l,c){var i=l[c];return s(i)?void 0:o(i)}},{"../internals/a-callable":222,"../internals/is-null-or-undefined":288}],274:[function(e,n,a){(function(o){(function(){var s=function(l){return l&&l.Math===Math&&l};n.exports=s(typeof globalThis=="object"&&globalThis)||s(typeof window=="object"&&window)||s(typeof self=="object"&&self)||s(typeof o=="object"&&o)||function(){return this}()||this||Function("return this")()}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],275:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=e("../internals/to-object"),l=o({}.hasOwnProperty);n.exports=Object.hasOwn||function(c,i){return l(s(c),i)}},{"../internals/function-uncurry-this":268,"../internals/to-object":344}],276:[function(e,n,a){n.exports={}},{}],277:[function(e,n,a){n.exports=function(o,s){try{arguments.length===1?console.error(o):console.error(o,s)}catch{}}},{}],278:[function(e,n,a){var o=e("../internals/get-built-in");n.exports=o("document","documentElement")},{"../internals/get-built-in":269}],279:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/fails"),l=e("../internals/document-create-element");n.exports=!o&&!s(function(){return Object.defineProperty(l("div"),"a",{get:function(){return 7}}).a!==7})},{"../internals/descriptors":247,"../internals/document-create-element":249,"../internals/fails":260}],280:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=e("../internals/fails"),l=e("../internals/classof-raw"),c=Object,i=o("".split);n.exports=s(function(){return!c("z").propertyIsEnumerable(0)})?function(u){return l(u)==="String"?i(u,""):c(u)}:c},{"../internals/classof-raw":235,"../internals/fails":260,"../internals/function-uncurry-this":268}],281:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=e("../internals/is-callable"),l=e("../internals/shared-store"),c=o(Function.toString);s(l.inspectSource)||(l.inspectSource=function(i){return c(i)}),n.exports=l.inspectSource},{"../internals/function-uncurry-this":268,"../internals/is-callable":285,"../internals/shared-store":333}],282:[function(e,n,a){var o,s,l,c=e("../internals/weak-map-basic-detection"),i=e("../internals/global"),u=e("../internals/is-object"),p=e("../internals/create-non-enumerable-property"),f=e("../internals/has-own-property"),h=e("../internals/shared-store"),v=e("../internals/shared-key"),b=e("../internals/hidden-keys"),g=i.TypeError,x=i.WeakMap;if(c||h.state){var y=h.state||(h.state=new x);y.get=y.get,y.has=y.has,y.set=y.set,o=function(N,I){if(y.has(N))throw new g("Object already initialized");return I.facade=N,y.set(N,I),I},s=function(N){return y.get(N)||{}},l=function(N){return y.has(N)}}else{var E=v("state");b[E]=!0,o=function(N,I){if(f(N,E))throw new g("Object already initialized");return I.facade=N,p(N,E,I),I},s=function(N){return f(N,E)?N[E]:{}},l=function(N){return f(N,E)}}n.exports={set:o,get:s,has:l,enforce:function(N){return l(N)?s(N):o(N,{})},getterFor:function(N){return function(I){var L;if(!u(I)||(L=s(I)).type!==N)throw new g("Incompatible receiver, "+N+" required");return L}}}},{"../internals/create-non-enumerable-property":241,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/is-object":289,"../internals/shared-key":332,"../internals/shared-store":333,"../internals/weak-map-basic-detection":354}],283:[function(e,n,a){var o=e("../internals/well-known-symbol"),s=e("../internals/iterators"),l=o("iterator"),c=Array.prototype;n.exports=function(i){return i!==void 0&&(s.Array===i||c[l]===i)}},{"../internals/iterators":298,"../internals/well-known-symbol":357}],284:[function(e,n,a){var o=e("../internals/classof-raw");n.exports=Array.isArray||function(s){return o(s)==="Array"}},{"../internals/classof-raw":235}],285:[function(e,n,a){var o=e("../internals/document-all"),s=o.all;n.exports=o.IS_HTMLDDA?function(l){return typeof l=="function"||l===s}:function(l){return typeof l=="function"}},{"../internals/document-all":248}],286:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=e("../internals/fails"),l=e("../internals/is-callable"),c=e("../internals/classof"),i=e("../internals/get-built-in"),u=e("../internals/inspect-source"),p=function(){},f=[],h=i("Reflect","construct"),v=/^\s*(?:class|function)\b/,b=o(v.exec),g=!v.test(p),x=function(E){if(!l(E))return!1;try{return h(p,f,E),!0}catch{return!1}},y=function(E){if(!l(E))return!1;switch(c(E)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return g||!!b(v,u(E))}catch{return!0}};y.sham=!0,n.exports=!h||s(function(){var E;return x(x.call)||!x(Object)||!x(function(){E=!0})||E})?y:x},{"../internals/classof":236,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/inspect-source":281,"../internals/is-callable":285}],287:[function(e,n,a){var o=e("../internals/fails"),s=e("../internals/is-callable"),l=/#|\.prototype\./,c=function(h,v){var b=u[i(h)];return b===f||b!==p&&(s(v)?o(v):!!v)},i=c.normalize=function(h){return String(h).replace(l,".").toLowerCase()},u=c.data={},p=c.NATIVE="N",f=c.POLYFILL="P";n.exports=c},{"../internals/fails":260,"../internals/is-callable":285}],288:[function(e,n,a){n.exports=function(o){return o==null}},{}],289:[function(e,n,a){var o=e("../internals/is-callable"),s=e("../internals/document-all"),l=s.all;n.exports=s.IS_HTMLDDA?function(c){return typeof c=="object"?c!==null:o(c)||c===l}:function(c){return typeof c=="object"?c!==null:o(c)}},{"../internals/document-all":248,"../internals/is-callable":285}],290:[function(e,n,a){n.exports=!1},{}],291:[function(e,n,a){var o=e("../internals/is-object"),s=e("../internals/classof-raw"),l=e("../internals/well-known-symbol")("match");n.exports=function(c){var i;return o(c)&&((i=c[l])!==void 0?!!i:s(c)==="RegExp")}},{"../internals/classof-raw":235,"../internals/is-object":289,"../internals/well-known-symbol":357}],292:[function(e,n,a){var o=e("../internals/get-built-in"),s=e("../internals/is-callable"),l=e("../internals/object-is-prototype-of"),c=e("../internals/use-symbol-as-uid"),i=Object;n.exports=c?function(u){return typeof u=="symbol"}:function(u){var p=o("Symbol");return s(p)&&l(p.prototype,i(u))}},{"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/object-is-prototype-of":314,"../internals/use-symbol-as-uid":351}],293:[function(e,n,a){var o=e("../internals/function-bind-context"),s=e("../internals/function-call"),l=e("../internals/an-object"),c=e("../internals/try-to-string"),i=e("../internals/is-array-iterator-method"),u=e("../internals/length-of-array-like"),p=e("../internals/object-is-prototype-of"),f=e("../internals/get-iterator"),h=e("../internals/get-iterator-method"),v=e("../internals/iterator-close"),b=TypeError,g=function(y,E){this.stopped=y,this.result=E},x=g.prototype;n.exports=function(y,E,N){var I,L,H,V,q,K,z,W=N&&N.that,D=!(!N||!N.AS_ENTRIES),M=!(!N||!N.IS_RECORD),C=!(!N||!N.IS_ITERATOR),w=!(!N||!N.INTERRUPTED),T=o(E,W),A=function(j){return I&&v(I,"normal",j),new g(!0,j)},S=function(j){return D?(l(j),w?T(j[0],j[1],A):T(j[0],j[1])):w?T(j,A):T(j)};if(M)I=y.iterator;else if(C)I=y;else{if(!(L=h(y)))throw new b(c(y)+" is not iterable");if(i(L)){for(H=0,V=u(y);V>H;H++)if((q=S(y[H]))&&p(x,q))return q;return new g(!1)}I=f(y,L)}for(K=M?y.next:I.next;!(z=s(K,I)).done;){try{q=S(z.value)}catch(j){v(I,"throw",j)}if(typeof q=="object"&&q&&p(x,q))return q}return new g(!1)}},{"../internals/an-object":227,"../internals/function-bind-context":262,"../internals/function-call":264,"../internals/get-iterator":271,"../internals/get-iterator-method":270,"../internals/is-array-iterator-method":283,"../internals/iterator-close":294,"../internals/length-of-array-like":299,"../internals/object-is-prototype-of":314,"../internals/try-to-string":349}],294:[function(e,n,a){var o=e("../internals/function-call"),s=e("../internals/an-object"),l=e("../internals/get-method");n.exports=function(c,i,u){var p,f;s(c);try{if(!(p=l(c,"return"))){if(i==="throw")throw u;return u}p=o(p,c)}catch(h){f=!0,p=h}if(i==="throw")throw u;if(f)throw p;return s(p),u}},{"../internals/an-object":227,"../internals/function-call":264,"../internals/get-method":273}],295:[function(e,n,a){var o=e("../internals/iterators-core").IteratorPrototype,s=e("../internals/object-create"),l=e("../internals/create-property-descriptor"),c=e("../internals/set-to-string-tag"),i=e("../internals/iterators"),u=function(){return this};n.exports=function(p,f,h,v){var b=f+" Iterator";return p.prototype=s(o,{next:l(+!v,h)}),c(p,b,!1,!0),i[b]=u,p}},{"../internals/create-property-descriptor":242,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-create":306,"../internals/set-to-string-tag":331}],296:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/function-call"),l=e("../internals/is-pure"),c=e("../internals/function-name"),i=e("../internals/is-callable"),u=e("../internals/iterator-create-constructor"),p=e("../internals/object-get-prototype-of"),f=e("../internals/object-set-prototype-of"),h=e("../internals/set-to-string-tag"),v=e("../internals/create-non-enumerable-property"),b=e("../internals/define-built-in"),g=e("../internals/well-known-symbol"),x=e("../internals/iterators"),y=e("../internals/iterators-core"),E=c.PROPER,N=c.CONFIGURABLE,I=y.IteratorPrototype,L=y.BUGGY_SAFARI_ITERATORS,H=g("iterator"),V=function(){return this};n.exports=function(q,K,z,W,D,M,C){u(z,K,W);var w,T,A,S=function(U){if(U===D&&Y)return Y;if(!L&&U&&U in R)return R[U];switch(U){case"keys":case"values":case"entries":return function(){return new z(this,U)}}return function(){return new z(this)}},j=K+" Iterator",B=!1,R=q.prototype,X=R[H]||R["@@iterator"]||D&&R[D],Y=!L&&X||S(D),ee=K==="Array"&&R.entries||X;if(ee&&(w=p(ee.call(new q)))!==Object.prototype&&w.next&&(l||p(w)===I||(f?f(w,I):i(w[H])||b(w,H,V)),h(w,j,!0,!0),l&&(x[j]=V)),E&&D==="values"&&X&&X.name!=="values"&&(!l&&N?v(R,"name","values"):(B=!0,Y=function(){return s(X,this)})),D)if(T={values:S("values"),keys:M?Y:S("keys"),entries:S("entries")},C)for(A in T)(L||B||!(A in R))&&b(R,A,T[A]);else o({target:K,proto:!0,forced:L||B},T);return l&&!C||R[H]===Y||b(R,H,Y,{name:D}),x[K]=Y,T}},{"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/export":259,"../internals/function-call":264,"../internals/function-name":265,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/iterator-create-constructor":295,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-get-prototype-of":313,"../internals/object-set-prototype-of":318,"../internals/set-to-string-tag":331,"../internals/well-known-symbol":357}],297:[function(e,n,a){var o,s,l,c=e("../internals/fails"),i=e("../internals/is-callable"),u=e("../internals/is-object"),p=e("../internals/object-create"),f=e("../internals/object-get-prototype-of"),h=e("../internals/define-built-in"),v=e("../internals/well-known-symbol"),b=e("../internals/is-pure"),g=v("iterator"),x=!1;[].keys&&("next"in(l=[].keys())?(s=f(f(l)))!==Object.prototype&&(o=s):x=!0),!u(o)||c(function(){var y={};return o[g].call(y)!==y})?o={}:b&&(o=p(o)),i(o[g])||h(o,g,function(){return this}),n.exports={IteratorPrototype:o,BUGGY_SAFARI_ITERATORS:x}},{"../internals/define-built-in":245,"../internals/fails":260,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-get-prototype-of":313,"../internals/well-known-symbol":357}],298:[function(e,n,a){arguments[4][276][0].apply(a,arguments)},{dup:276}],299:[function(e,n,a){var o=e("../internals/to-length");n.exports=function(s){return o(s.length)}},{"../internals/to-length":343}],300:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=e("../internals/fails"),l=e("../internals/is-callable"),c=e("../internals/has-own-property"),i=e("../internals/descriptors"),u=e("../internals/function-name").CONFIGURABLE,p=e("../internals/inspect-source"),f=e("../internals/internal-state"),h=f.enforce,v=f.get,b=String,g=Object.defineProperty,x=o("".slice),y=o("".replace),E=o([].join),N=i&&!s(function(){return g(function(){},"length",{value:8}).length!==8}),I=String(String).split("String"),L=n.exports=function(H,V,q){x(b(V),0,7)==="Symbol("&&(V="["+y(b(V),/^Symbol\(([^)]*)\)/,"$1")+"]"),q&&q.getter&&(V="get "+V),q&&q.setter&&(V="set "+V),(!c(H,"name")||u&&H.name!==V)&&(i?g(H,"name",{value:V,configurable:!0}):H.name=V),N&&q&&c(q,"arity")&&H.length!==q.arity&&g(H,"length",{value:q.arity});try{q&&c(q,"constructor")&&q.constructor?i&&g(H,"prototype",{writable:!1}):H.prototype&&(H.prototype=void 0)}catch{}var K=h(H);return c(K,"source")||(K.source=E(I,typeof V=="string"?V:"")),H};Function.prototype.toString=L(function(){return l(this)&&v(this).source||p(this)},"toString")},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-name":265,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/inspect-source":281,"../internals/internal-state":282,"../internals/is-callable":285}],301:[function(e,n,a){var o=Math.ceil,s=Math.floor;n.exports=Math.trunc||function(l){var c=+l;return(c>0?s:o)(c)}},{}],302:[function(e,n,a){var o,s,l,c,i,u=e("../internals/global"),p=e("../internals/function-bind-context"),f=e("../internals/object-get-own-property-descriptor").f,h=e("../internals/task").set,v=e("../internals/queue"),b=e("../internals/engine-is-ios"),g=e("../internals/engine-is-ios-pebble"),x=e("../internals/engine-is-webos-webkit"),y=e("../internals/engine-is-node"),E=u.MutationObserver||u.WebKitMutationObserver,N=u.document,I=u.process,L=u.Promise,H=f(u,"queueMicrotask"),V=H&&H.value;if(!V){var q=new v,K=function(){var z,W;for(y&&(z=I.domain)&&z.exit();W=q.get();)try{W()}catch(D){throw q.head&&o(),D}z&&z.enter()};b||y||x||!E||!N?!g&&L&&L.resolve?((c=L.resolve(void 0)).constructor=L,i=p(c.then,c),o=function(){i(K)}):y?o=function(){I.nextTick(K)}:(h=p(h,u),o=function(){h(K)}):(s=!0,l=N.createTextNode(""),new E(K).observe(l,{characterData:!0}),o=function(){l.data=s=!s}),V=function(z){q.head||o(),q.add(z)}}n.exports=V},{"../internals/engine-is-ios":253,"../internals/engine-is-ios-pebble":252,"../internals/engine-is-node":254,"../internals/engine-is-webos-webkit":255,"../internals/function-bind-context":262,"../internals/global":274,"../internals/object-get-own-property-descriptor":309,"../internals/queue":328,"../internals/task":339}],303:[function(e,n,a){var o=e("../internals/a-callable"),s=TypeError,l=function(c){var i,u;this.promise=new c(function(p,f){if(i!==void 0||u!==void 0)throw new s("Bad Promise constructor");i=p,u=f}),this.resolve=o(i),this.reject=o(u)};n.exports.f=function(c){return new l(c)}},{"../internals/a-callable":222}],304:[function(e,n,a){var o=e("../internals/is-regexp"),s=TypeError;n.exports=function(l){if(o(l))throw new s("The method doesn't accept regular expressions");return l}},{"../internals/is-regexp":291}],305:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/function-uncurry-this"),l=e("../internals/function-call"),c=e("../internals/fails"),i=e("../internals/object-keys"),u=e("../internals/object-get-own-property-symbols"),p=e("../internals/object-property-is-enumerable"),f=e("../internals/to-object"),h=e("../internals/indexed-object"),v=Object.assign,b=Object.defineProperty,g=s([].concat);n.exports=!v||c(function(){if(o&&v({b:1},v(b({},"a",{enumerable:!0,get:function(){b(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var x={},y={},E=Symbol("assign detection");return x[E]=7,"abcdefghijklmnopqrst".split("").forEach(function(N){y[N]=N}),v({},x)[E]!==7||i(v({},y)).join("")!=="abcdefghijklmnopqrst"})?function(x,y){for(var E=f(x),N=arguments.length,I=1,L=u.f,H=p.f;N>I;)for(var V,q=h(arguments[I++]),K=L?g(i(q),L(q)):i(q),z=K.length,W=0;z>W;)V=K[W++],o&&!l(H,q,V)||(E[V]=q[V]);return E}:v},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/object-get-own-property-symbols":312,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-object":344}],306:[function(e,n,a){var o,s=e("../internals/an-object"),l=e("../internals/object-define-properties"),c=e("../internals/enum-bug-keys"),i=e("../internals/hidden-keys"),u=e("../internals/html"),p=e("../internals/document-create-element"),f=e("../internals/shared-key"),h=f("IE_PROTO"),v=function(){},b=function(y){return"<script>"+y+"<\/script>"},g=function(y){y.write(b("")),y.close();var E=y.parentWindow.Object;return y=null,E},x=function(){try{o=new ActiveXObject("htmlfile")}catch{}var y,E;x=typeof document<"u"?document.domain&&o?g(o):((E=p("iframe")).style.display="none",u.appendChild(E),E.src="javascript:",(y=E.contentWindow.document).open(),y.write(b("document.F=Object")),y.close(),y.F):g(o);for(var N=c.length;N--;)delete x.prototype[c[N]];return x()};i[h]=!0,n.exports=Object.create||function(y,E){var N;return y!==null?(v.prototype=s(y),N=new v,v.prototype=null,N[h]=y):N=x(),E===void 0?N:l.f(N,E)}},{"../internals/an-object":227,"../internals/document-create-element":249,"../internals/enum-bug-keys":258,"../internals/hidden-keys":276,"../internals/html":278,"../internals/object-define-properties":307,"../internals/shared-key":332}],307:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/v8-prototype-define-bug"),l=e("../internals/object-define-property"),c=e("../internals/an-object"),i=e("../internals/to-indexed-object"),u=e("../internals/object-keys");a.f=o&&!s?Object.defineProperties:function(p,f){c(p);for(var h,v=i(f),b=u(f),g=b.length,x=0;g>x;)l.f(p,h=b[x++],v[h]);return p}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/object-define-property":308,"../internals/object-keys":316,"../internals/to-indexed-object":341,"../internals/v8-prototype-define-bug":352}],308:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/ie8-dom-define"),l=e("../internals/v8-prototype-define-bug"),c=e("../internals/an-object"),i=e("../internals/to-property-key"),u=TypeError,p=Object.defineProperty,f=Object.getOwnPropertyDescriptor;a.f=o?l?function(h,v,b){if(c(h),v=i(v),c(b),typeof h=="function"&&v==="prototype"&&"value"in b&&"writable"in b&&!b.writable){var g=f(h,v);g&&g.writable&&(h[v]=b.value,b={configurable:"configurable"in b?b.configurable:g.configurable,enumerable:"enumerable"in b?b.enumerable:g.enumerable,writable:!1})}return p(h,v,b)}:p:function(h,v,b){if(c(h),v=i(v),c(b),s)try{return p(h,v,b)}catch{}if("get"in b||"set"in b)throw new u("Accessors not supported");return"value"in b&&(h[v]=b.value),h}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/ie8-dom-define":279,"../internals/to-property-key":346,"../internals/v8-prototype-define-bug":352}],309:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/function-call"),l=e("../internals/object-property-is-enumerable"),c=e("../internals/create-property-descriptor"),i=e("../internals/to-indexed-object"),u=e("../internals/to-property-key"),p=e("../internals/has-own-property"),f=e("../internals/ie8-dom-define"),h=Object.getOwnPropertyDescriptor;a.f=o?h:function(v,b){if(v=i(v),b=u(b),f)try{return h(v,b)}catch{}if(p(v,b))return c(!s(l.f,v,b),v[b])}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/function-call":264,"../internals/has-own-property":275,"../internals/ie8-dom-define":279,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341,"../internals/to-property-key":346}],310:[function(e,n,a){var o=e("../internals/classof-raw"),s=e("../internals/to-indexed-object"),l=e("../internals/object-get-own-property-names").f,c=e("../internals/array-slice-simple"),i=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];n.exports.f=function(u){return i&&o(u)==="Window"?function(p){try{return l(p)}catch{return c(i)}}(u):l(s(u))}},{"../internals/array-slice-simple":230,"../internals/classof-raw":235,"../internals/object-get-own-property-names":311,"../internals/to-indexed-object":341}],311:[function(e,n,a){var o=e("../internals/object-keys-internal"),s=e("../internals/enum-bug-keys").concat("length","prototype");a.f=Object.getOwnPropertyNames||function(l){return o(l,s)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],312:[function(e,n,a){a.f=Object.getOwnPropertySymbols},{}],313:[function(e,n,a){var o=e("../internals/has-own-property"),s=e("../internals/is-callable"),l=e("../internals/to-object"),c=e("../internals/shared-key"),i=e("../internals/correct-prototype-getter"),u=c("IE_PROTO"),p=Object,f=p.prototype;n.exports=i?p.getPrototypeOf:function(h){var v=l(h);if(o(v,u))return v[u];var b=v.constructor;return s(b)&&v instanceof b?b.prototype:v instanceof p?f:null}},{"../internals/correct-prototype-getter":239,"../internals/has-own-property":275,"../internals/is-callable":285,"../internals/shared-key":332,"../internals/to-object":344}],314:[function(e,n,a){var o=e("../internals/function-uncurry-this");n.exports=o({}.isPrototypeOf)},{"../internals/function-uncurry-this":268}],315:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=e("../internals/has-own-property"),l=e("../internals/to-indexed-object"),c=e("../internals/array-includes").indexOf,i=e("../internals/hidden-keys"),u=o([].push);n.exports=function(p,f){var h,v=l(p),b=0,g=[];for(h in v)!s(i,h)&&s(v,h)&&u(g,h);for(;f.length>b;)s(v,h=f[b++])&&(~c(g,h)||u(g,h));return g}},{"../internals/array-includes":228,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/to-indexed-object":341}],316:[function(e,n,a){var o=e("../internals/object-keys-internal"),s=e("../internals/enum-bug-keys");n.exports=Object.keys||function(l){return o(l,s)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],317:[function(e,n,a){var o={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,l=s&&!o.call({1:2},1);a.f=l?function(c){var i=s(this,c);return!!i&&i.enumerable}:o},{}],318:[function(e,n,a){var o=e("../internals/function-uncurry-this-accessor"),s=e("../internals/an-object"),l=e("../internals/a-possible-prototype");n.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var c,i=!1,u={};try{(c=o(Object.prototype,"__proto__","set"))(u,[]),i=u instanceof Array}catch{}return function(p,f){return s(p),l(f),i?c(p,f):p.__proto__=f,p}}():void 0)},{"../internals/a-possible-prototype":224,"../internals/an-object":227,"../internals/function-uncurry-this-accessor":266}],319:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/fails"),l=e("../internals/function-uncurry-this"),c=e("../internals/object-get-prototype-of"),i=e("../internals/object-keys"),u=e("../internals/to-indexed-object"),p=l(e("../internals/object-property-is-enumerable").f),f=l([].push),h=o&&s(function(){var b=Object.create(null);return b[2]=2,!p(b,2)}),v=function(b){return function(g){for(var x,y=u(g),E=i(y),N=h&&c(y)===null,I=E.length,L=0,H=[];I>L;)x=E[L++],o&&!(N?x in y:p(y,x))||f(H,b?[x,y[x]]:y[x]);return H}};n.exports={entries:v(!0),values:v(!1)}},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/object-get-prototype-of":313,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341}],320:[function(e,n,a){var o=e("../internals/function-call"),s=e("../internals/is-callable"),l=e("../internals/is-object"),c=TypeError;n.exports=function(i,u){var p,f;if(u==="string"&&s(p=i.toString)&&!l(f=o(p,i))||s(p=i.valueOf)&&!l(f=o(p,i))||u!=="string"&&s(p=i.toString)&&!l(f=o(p,i)))return f;throw new c("Can't convert object to primitive value")}},{"../internals/function-call":264,"../internals/is-callable":285,"../internals/is-object":289}],321:[function(e,n,a){var o=e("../internals/get-built-in"),s=e("../internals/function-uncurry-this"),l=e("../internals/object-get-own-property-names"),c=e("../internals/object-get-own-property-symbols"),i=e("../internals/an-object"),u=s([].concat);n.exports=o("Reflect","ownKeys")||function(p){var f=l.f(i(p)),h=c.f;return h?u(f,h(p)):f}},{"../internals/an-object":227,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-symbols":312}],322:[function(e,n,a){var o=e("../internals/global");n.exports=o},{"../internals/global":274}],323:[function(e,n,a){n.exports=function(o){try{return{error:!1,value:o()}}catch(s){return{error:!0,value:s}}}},{}],324:[function(e,n,a){var o=e("../internals/global"),s=e("../internals/promise-native-constructor"),l=e("../internals/is-callable"),c=e("../internals/is-forced"),i=e("../internals/inspect-source"),u=e("../internals/well-known-symbol"),p=e("../internals/engine-is-browser"),f=e("../internals/engine-is-deno"),h=e("../internals/is-pure"),v=e("../internals/engine-v8-version"),b=s&&s.prototype,g=u("species"),x=!1,y=l(o.PromiseRejectionEvent),E=c("Promise",function(){var N=i(s),I=N!==String(s);if(!I&&v===66||h&&(!b.catch||!b.finally))return!0;if(!v||v<51||!/native code/.test(N)){var L=new s(function(V){V(1)}),H=function(V){V(function(){},function(){})};if((L.constructor={})[g]=H,!(x=L.then(function(){})instanceof H))return!0}return!I&&(p||f)&&!y});n.exports={CONSTRUCTOR:E,REJECTION_EVENT:y,SUBCLASSING:x}},{"../internals/engine-is-browser":250,"../internals/engine-is-deno":251,"../internals/engine-v8-version":257,"../internals/global":274,"../internals/inspect-source":281,"../internals/is-callable":285,"../internals/is-forced":287,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/well-known-symbol":357}],325:[function(e,n,a){var o=e("../internals/global");n.exports=o.Promise},{"../internals/global":274}],326:[function(e,n,a){var o=e("../internals/an-object"),s=e("../internals/is-object"),l=e("../internals/new-promise-capability");n.exports=function(c,i){if(o(c),s(i)&&i.constructor===c)return i;var u=l.f(c);return(0,u.resolve)(i),u.promise}},{"../internals/an-object":227,"../internals/is-object":289,"../internals/new-promise-capability":303}],327:[function(e,n,a){var o=e("../internals/promise-native-constructor"),s=e("../internals/check-correctness-of-iteration"),l=e("../internals/promise-constructor-detection").CONSTRUCTOR;n.exports=l||!s(function(c){o.all(c).then(void 0,function(){})})},{"../internals/check-correctness-of-iteration":234,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],328:[function(e,n,a){var o=function(){this.head=null,this.tail=null};o.prototype={add:function(s){var l={item:s,next:null},c=this.tail;c?c.next=l:this.head=l,this.tail=l},get:function(){var s=this.head;if(s)return(this.head=s.next)===null&&(this.tail=null),s.item}},n.exports=o},{}],329:[function(e,n,a){var o=e("../internals/is-null-or-undefined"),s=TypeError;n.exports=function(l){if(o(l))throw new s("Can't call method on "+l);return l}},{"../internals/is-null-or-undefined":288}],330:[function(e,n,a){var o=e("../internals/get-built-in"),s=e("../internals/define-built-in-accessor"),l=e("../internals/well-known-symbol"),c=e("../internals/descriptors"),i=l("species");n.exports=function(u){var p=o(u);c&&p&&!p[i]&&s(p,i,{configurable:!0,get:function(){return this}})}},{"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],331:[function(e,n,a){var o=e("../internals/object-define-property").f,s=e("../internals/has-own-property"),l=e("../internals/well-known-symbol")("toStringTag");n.exports=function(c,i,u){c&&!u&&(c=c.prototype),c&&!s(c,l)&&o(c,l,{configurable:!0,value:i})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],332:[function(e,n,a){var o=e("../internals/shared"),s=e("../internals/uid"),l=o("keys");n.exports=function(c){return l[c]||(l[c]=s(c))}},{"../internals/shared":334,"../internals/uid":350}],333:[function(e,n,a){var o=e("../internals/global"),s=e("../internals/define-global-property"),l=o["__core-js_shared__"]||s("__core-js_shared__",{});n.exports=l},{"../internals/define-global-property":246,"../internals/global":274}],334:[function(e,n,a){var o=e("../internals/is-pure"),s=e("../internals/shared-store");(n.exports=function(l,c){return s[l]||(s[l]=c!==void 0?c:{})})("versions",[]).push({version:"3.33.0",mode:o?"pure":"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})},{"../internals/is-pure":290,"../internals/shared-store":333}],335:[function(e,n,a){var o=e("../internals/an-object"),s=e("../internals/a-constructor"),l=e("../internals/is-null-or-undefined"),c=e("../internals/well-known-symbol")("species");n.exports=function(i,u){var p,f=o(i).constructor;return f===void 0||l(p=o(f)[c])?u:s(p)}},{"../internals/a-constructor":223,"../internals/an-object":227,"../internals/is-null-or-undefined":288,"../internals/well-known-symbol":357}],336:[function(e,n,a){var o=e("../internals/engine-v8-version"),s=e("../internals/fails"),l=e("../internals/global").String;n.exports=!!Object.getOwnPropertySymbols&&!s(function(){var c=Symbol("symbol detection");return!l(c)||!(Object(c)instanceof Symbol)||!Symbol.sham&&o&&o<41})},{"../internals/engine-v8-version":257,"../internals/fails":260,"../internals/global":274}],337:[function(e,n,a){var o=e("../internals/function-call"),s=e("../internals/get-built-in"),l=e("../internals/well-known-symbol"),c=e("../internals/define-built-in");n.exports=function(){var i=s("Symbol"),u=i&&i.prototype,p=u&&u.valueOf,f=l("toPrimitive");u&&!u[f]&&c(u,f,function(h){return o(p,this)},{arity:1})}},{"../internals/define-built-in":245,"../internals/function-call":264,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],338:[function(e,n,a){var o=e("../internals/symbol-constructor-detection");n.exports=o&&!!Symbol.for&&!!Symbol.keyFor},{"../internals/symbol-constructor-detection":336}],339:[function(e,n,a){var o,s,l,c,i=e("../internals/global"),u=e("../internals/function-apply"),p=e("../internals/function-bind-context"),f=e("../internals/is-callable"),h=e("../internals/has-own-property"),v=e("../internals/fails"),b=e("../internals/html"),g=e("../internals/array-slice"),x=e("../internals/document-create-element"),y=e("../internals/validate-arguments-length"),E=e("../internals/engine-is-ios"),N=e("../internals/engine-is-node"),I=i.setImmediate,L=i.clearImmediate,H=i.process,V=i.Dispatch,q=i.Function,K=i.MessageChannel,z=i.String,W=0,D={};v(function(){o=i.location});var M=function(A){if(h(D,A)){var S=D[A];delete D[A],S()}},C=function(A){return function(){M(A)}},w=function(A){M(A.data)},T=function(A){i.postMessage(z(A),o.protocol+"//"+o.host)};I&&L||(I=function(A){y(arguments.length,1);var S=f(A)?A:q(A),j=g(arguments,1);return D[++W]=function(){u(S,void 0,j)},s(W),W},L=function(A){delete D[A]},N?s=function(A){H.nextTick(C(A))}:V&&V.now?s=function(A){V.now(C(A))}:K&&!E?(c=(l=new K).port2,l.port1.onmessage=w,s=p(c.postMessage,c)):i.addEventListener&&f(i.postMessage)&&!i.importScripts&&o&&o.protocol!=="file:"&&!v(T)?(s=T,i.addEventListener("message",w,!1)):s="onreadystatechange"in x("script")?function(A){b.appendChild(x("script")).onreadystatechange=function(){b.removeChild(this),M(A)}}:function(A){setTimeout(C(A),0)}),n.exports={set:I,clear:L}},{"../internals/array-slice":231,"../internals/document-create-element":249,"../internals/engine-is-ios":253,"../internals/engine-is-node":254,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-bind-context":262,"../internals/global":274,"../internals/has-own-property":275,"../internals/html":278,"../internals/is-callable":285,"../internals/validate-arguments-length":353}],340:[function(e,n,a){var o=e("../internals/to-integer-or-infinity"),s=Math.max,l=Math.min;n.exports=function(c,i){var u=o(c);return u<0?s(u+i,0):l(u,i)}},{"../internals/to-integer-or-infinity":342}],341:[function(e,n,a){var o=e("../internals/indexed-object"),s=e("../internals/require-object-coercible");n.exports=function(l){return o(s(l))}},{"../internals/indexed-object":280,"../internals/require-object-coercible":329}],342:[function(e,n,a){var o=e("../internals/math-trunc");n.exports=function(s){var l=+s;return l!=l||l===0?0:o(l)}},{"../internals/math-trunc":301}],343:[function(e,n,a){var o=e("../internals/to-integer-or-infinity"),s=Math.min;n.exports=function(l){return l>0?s(o(l),9007199254740991):0}},{"../internals/to-integer-or-infinity":342}],344:[function(e,n,a){var o=e("../internals/require-object-coercible"),s=Object;n.exports=function(l){return s(o(l))}},{"../internals/require-object-coercible":329}],345:[function(e,n,a){var o=e("../internals/function-call"),s=e("../internals/is-object"),l=e("../internals/is-symbol"),c=e("../internals/get-method"),i=e("../internals/ordinary-to-primitive"),u=e("../internals/well-known-symbol"),p=TypeError,f=u("toPrimitive");n.exports=function(h,v){if(!s(h)||l(h))return h;var b,g=c(h,f);if(g){if(v===void 0&&(v="default"),b=o(g,h,v),!s(b)||l(b))return b;throw new p("Can't convert object to primitive value")}return v===void 0&&(v="number"),i(h,v)}},{"../internals/function-call":264,"../internals/get-method":273,"../internals/is-object":289,"../internals/is-symbol":292,"../internals/ordinary-to-primitive":320,"../internals/well-known-symbol":357}],346:[function(e,n,a){var o=e("../internals/to-primitive"),s=e("../internals/is-symbol");n.exports=function(l){var c=o(l,"string");return s(c)?c:c+""}},{"../internals/is-symbol":292,"../internals/to-primitive":345}],347:[function(e,n,a){var o={};o[e("../internals/well-known-symbol")("toStringTag")]="z",n.exports=String(o)==="[object z]"},{"../internals/well-known-symbol":357}],348:[function(e,n,a){var o=e("../internals/classof"),s=String;n.exports=function(l){if(o(l)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return s(l)}},{"../internals/classof":236}],349:[function(e,n,a){var o=String;n.exports=function(s){try{return o(s)}catch{return"Object"}}},{}],350:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=0,l=Math.random(),c=o(1 .toString);n.exports=function(i){return"Symbol("+(i===void 0?"":i)+")_"+c(++s+l,36)}},{"../internals/function-uncurry-this":268}],351:[function(e,n,a){var o=e("../internals/symbol-constructor-detection");n.exports=o&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/symbol-constructor-detection":336}],352:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/fails");n.exports=o&&s(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},{"../internals/descriptors":247,"../internals/fails":260}],353:[function(e,n,a){var o=TypeError;n.exports=function(s,l){if(s<l)throw new o("Not enough arguments");return s}},{}],354:[function(e,n,a){var o=e("../internals/global"),s=e("../internals/is-callable"),l=o.WeakMap;n.exports=s(l)&&/native code/.test(String(l))},{"../internals/global":274,"../internals/is-callable":285}],355:[function(e,n,a){var o=e("../internals/path"),s=e("../internals/has-own-property"),l=e("../internals/well-known-symbol-wrapped"),c=e("../internals/object-define-property").f;n.exports=function(i){var u=o.Symbol||(o.Symbol={});s(u,i)||c(u,i,{value:l.f(i)})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/path":322,"../internals/well-known-symbol-wrapped":356}],356:[function(e,n,a){var o=e("../internals/well-known-symbol");a.f=o},{"../internals/well-known-symbol":357}],357:[function(e,n,a){var o=e("../internals/global"),s=e("../internals/shared"),l=e("../internals/has-own-property"),c=e("../internals/uid"),i=e("../internals/symbol-constructor-detection"),u=e("../internals/use-symbol-as-uid"),p=o.Symbol,f=s("wks"),h=u?p.for||p:p&&p.withoutSetter||c;n.exports=function(v){return l(f,v)||(f[v]=i&&l(p,v)?p[v]:h("Symbol."+v)),f[v]}},{"../internals/global":274,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-constructor-detection":336,"../internals/uid":350,"../internals/use-symbol-as-uid":351}],358:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/array-iteration").findIndex,l=e("../internals/add-to-unscopables"),c=!0;"findIndex"in[]&&Array(1).findIndex(function(){c=!1}),o({target:"Array",proto:!0,forced:c},{findIndex:function(i){return s(this,i,arguments.length>1?arguments[1]:void 0)}}),l("findIndex")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],359:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/array-iteration").find,l=e("../internals/add-to-unscopables"),c=!0;"find"in[]&&Array(1).find(function(){c=!1}),o({target:"Array",proto:!0,forced:c},{find:function(i){return s(this,i,arguments.length>1?arguments[1]:void 0)}}),l("find")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],360:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/array-includes").includes,l=e("../internals/fails"),c=e("../internals/add-to-unscopables");o({target:"Array",proto:!0,forced:l(function(){return!Array(1).includes()})},{includes:function(i){return s(this,i,arguments.length>1?arguments[1]:void 0)}}),c("includes")},{"../internals/add-to-unscopables":225,"../internals/array-includes":228,"../internals/export":259,"../internals/fails":260}],361:[function(e,n,a){var o=e("../internals/to-indexed-object"),s=e("../internals/add-to-unscopables"),l=e("../internals/iterators"),c=e("../internals/internal-state"),i=e("../internals/object-define-property").f,u=e("../internals/iterator-define"),p=e("../internals/create-iter-result-object"),f=e("../internals/is-pure"),h=e("../internals/descriptors"),v=c.set,b=c.getterFor("Array Iterator");n.exports=u(Array,"Array",function(x,y){v(this,{type:"Array Iterator",target:o(x),index:0,kind:y})},function(){var x=b(this),y=x.target,E=x.kind,N=x.index++;if(!y||N>=y.length)return x.target=void 0,p(void 0,!0);switch(E){case"keys":return p(N,!1);case"values":return p(y[N],!1)}return p([N,y[N]],!1)},"values");var g=l.Arguments=l.Array;if(s("keys"),s("values"),s("entries"),!f&&h&&g.name!=="values")try{i(g,"name",{value:"values"})}catch{}},{"../internals/add-to-unscopables":225,"../internals/create-iter-result-object":240,"../internals/descriptors":247,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/iterator-define":296,"../internals/iterators":298,"../internals/object-define-property":308,"../internals/to-indexed-object":341}],362:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/get-built-in"),l=e("../internals/function-apply"),c=e("../internals/function-call"),i=e("../internals/function-uncurry-this"),u=e("../internals/fails"),p=e("../internals/is-callable"),f=e("../internals/is-symbol"),h=e("../internals/array-slice"),v=e("../internals/get-json-replacer-function"),b=e("../internals/symbol-constructor-detection"),g=String,x=s("JSON","stringify"),y=i(/./.exec),E=i("".charAt),N=i("".charCodeAt),I=i("".replace),L=i(1 .toString),H=/[\uD800-\uDFFF]/g,V=/^[\uD800-\uDBFF]$/,q=/^[\uDC00-\uDFFF]$/,K=!b||u(function(){var M=s("Symbol")("stringify detection");return x([M])!=="[null]"||x({a:M})!=="{}"||x(Object(M))!=="{}"}),z=u(function(){return x("\uDF06\uD834")!=='"\\udf06\\ud834"'||x("\uDEAD")!=='"\\udead"'}),W=function(M,C){var w=h(arguments),T=v(C);if(p(T)||M!==void 0&&!f(M))return w[1]=function(A,S){if(p(T)&&(S=c(T,this,g(A),S)),!f(S))return S},l(x,null,w)},D=function(M,C,w){var T=E(w,C-1),A=E(w,C+1);return y(V,M)&&!y(q,A)||y(q,M)&&!y(V,T)?"\\u"+L(N(M,0),16):M};x&&o({target:"JSON",stat:!0,arity:3,forced:K||z},{stringify:function(M,C,w){var T=h(arguments),A=l(K?W:x,null,T);return z&&typeof A=="string"?I(A,H,D):A}})},{"../internals/array-slice":231,"../internals/export":259,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/get-json-replacer-function":272,"../internals/is-callable":285,"../internals/is-symbol":292,"../internals/symbol-constructor-detection":336}],363:[function(e,n,a){e("../internals/export")({target:"Number",stat:!0},{isNaN:function(o){return o!=o}})},{"../internals/export":259}],364:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/object-assign");o({target:"Object",stat:!0,arity:2,forced:Object.assign!==s},{assign:s})},{"../internals/export":259,"../internals/object-assign":305}],365:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/symbol-constructor-detection"),l=e("../internals/fails"),c=e("../internals/object-get-own-property-symbols"),i=e("../internals/to-object");o({target:"Object",stat:!0,forced:!s||l(function(){c.f(1)})},{getOwnPropertySymbols:function(u){var p=c.f;return p?p(i(u)):[]}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-get-own-property-symbols":312,"../internals/symbol-constructor-detection":336,"../internals/to-object":344}],366:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/to-object"),l=e("../internals/object-keys");o({target:"Object",stat:!0,forced:e("../internals/fails")(function(){l(1)})},{keys:function(c){return l(s(c))}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-keys":316,"../internals/to-object":344}],367:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/object-to-array").values;o({target:"Object",stat:!0},{values:function(l){return s(l)}})},{"../internals/export":259,"../internals/object-to-array":319}],368:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/function-call"),l=e("../internals/a-callable"),c=e("../internals/new-promise-capability"),i=e("../internals/perform"),u=e("../internals/iterate");o({target:"Promise",stat:!0,forced:e("../internals/promise-statics-incorrect-iteration")},{all:function(p){var f=this,h=c.f(f),v=h.resolve,b=h.reject,g=i(function(){var x=l(f.resolve),y=[],E=0,N=1;u(p,function(I){var L=E++,H=!1;N++,s(x,f,I).then(function(V){H||(H=!0,y[L]=V,--N||v(y))},b)}),--N||v(y)});return g.error&&b(g.value),h.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],369:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/is-pure"),l=e("../internals/promise-constructor-detection").CONSTRUCTOR,c=e("../internals/promise-native-constructor"),i=e("../internals/get-built-in"),u=e("../internals/is-callable"),p=e("../internals/define-built-in"),f=c&&c.prototype;if(o({target:"Promise",proto:!0,forced:l,real:!0},{catch:function(v){return this.then(void 0,v)}}),!s&&u(c)){var h=i("Promise").prototype.catch;f.catch!==h&&p(f,"catch",h,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],370:[function(e,n,a){var o,s,l,c=e("../internals/export"),i=e("../internals/is-pure"),u=e("../internals/engine-is-node"),p=e("../internals/global"),f=e("../internals/function-call"),h=e("../internals/define-built-in"),v=e("../internals/object-set-prototype-of"),b=e("../internals/set-to-string-tag"),g=e("../internals/set-species"),x=e("../internals/a-callable"),y=e("../internals/is-callable"),E=e("../internals/is-object"),N=e("../internals/an-instance"),I=e("../internals/species-constructor"),L=e("../internals/task").set,H=e("../internals/microtask"),V=e("../internals/host-report-errors"),q=e("../internals/perform"),K=e("../internals/queue"),z=e("../internals/internal-state"),W=e("../internals/promise-native-constructor"),D=e("../internals/promise-constructor-detection"),M=e("../internals/new-promise-capability"),C=D.CONSTRUCTOR,w=D.REJECTION_EVENT,T=D.SUBCLASSING,A=z.getterFor("Promise"),S=z.set,j=W&&W.prototype,B=W,R=j,X=p.TypeError,Y=p.document,ee=p.process,U=M.f,Q=U,P=!!(Y&&Y.createEvent&&p.dispatchEvent),F=function(fe){var Se;return!(!E(fe)||!y(Se=fe.then))&&Se},Z=function(fe,Se){var _e,Ce,Re,Pe=Se.value,Ye=Se.state===1,at=Ye?fe.ok:fe.fail,tt=fe.resolve,it=fe.reject,rt=fe.domain;try{at?(Ye||(Se.rejection===2&&he(Se),Se.rejection=1),at===!0?_e=Pe:(rt&&rt.enter(),_e=at(Pe),rt&&(rt.exit(),Re=!0)),_e===fe.promise?it(new X("Promise-chain cycle")):(Ce=F(_e))?f(Ce,_e,tt,it):tt(_e)):it(Pe)}catch(ct){rt&&!Re&&rt.exit(),it(ct)}},se=function(fe,Se){fe.notified||(fe.notified=!0,H(function(){for(var _e,Ce=fe.reactions;_e=Ce.get();)Z(_e,fe);fe.notified=!1,Se&&!fe.rejection&&ae(fe)}))},re=function(fe,Se,_e){var Ce,Re;P?((Ce=Y.createEvent("Event")).promise=Se,Ce.reason=_e,Ce.initEvent(fe,!1,!0),p.dispatchEvent(Ce)):Ce={promise:Se,reason:_e},!w&&(Re=p["on"+fe])?Re(Ce):fe==="unhandledrejection"&&V("Unhandled promise rejection",_e)},ae=function(fe){f(L,p,function(){var Se,_e=fe.facade,Ce=fe.value;if(te(fe)&&(Se=q(function(){u?ee.emit("unhandledRejection",Ce,_e):re("unhandledrejection",_e,Ce)}),fe.rejection=u||te(fe)?2:1,Se.error))throw Se.value})},te=function(fe){return fe.rejection!==1&&!fe.parent},he=function(fe){f(L,p,function(){var Se=fe.facade;u?ee.emit("rejectionHandled",Se):re("rejectionhandled",Se,fe.value)})},le=function(fe,Se,_e){return function(Ce){fe(Se,Ce,_e)}},ne=function(fe,Se,_e){fe.done||(fe.done=!0,_e&&(fe=_e),fe.value=Se,fe.state=2,se(fe,!0))},de=function(fe,Se,_e){if(!fe.done){fe.done=!0,_e&&(fe=_e);try{if(fe.facade===Se)throw new X("Promise can't be resolved itself");var Ce=F(Se);Ce?H(function(){var Re={done:!1};try{f(Ce,Se,le(de,Re,fe),le(ne,Re,fe))}catch(Pe){ne(Re,Pe,fe)}}):(fe.value=Se,fe.state=1,se(fe,!1))}catch(Re){ne({done:!1},Re,fe)}}};if(C&&(R=(B=function(fe){N(this,R),x(fe),f(o,this);var Se=A(this);try{fe(le(de,Se),le(ne,Se))}catch(_e){ne(Se,_e)}}).prototype,(o=function(fe){S(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new K,rejection:!1,state:0,value:void 0})}).prototype=h(R,"then",function(fe,Se){var _e=A(this),Ce=U(I(this,B));return _e.parent=!0,Ce.ok=!y(fe)||fe,Ce.fail=y(Se)&&Se,Ce.domain=u?ee.domain:void 0,_e.state===0?_e.reactions.add(Ce):H(function(){Z(Ce,_e)}),Ce.promise}),s=function(){var fe=new o,Se=A(fe);this.promise=fe,this.resolve=le(de,Se),this.reject=le(ne,Se)},M.f=U=function(fe){return fe===B||fe===void 0?new s(fe):Q(fe)},!i&&y(W)&&j!==Object.prototype)){l=j.then,T||h(j,"then",function(fe,Se){var _e=this;return new B(function(Ce,Re){f(l,_e,Ce,Re)}).then(fe,Se)},{unsafe:!0});try{delete j.constructor}catch{}v&&v(j,R)}c({global:!0,constructor:!0,wrap:!0,forced:C},{Promise:B}),b(B,"Promise",!1,!0),g("Promise")},{"../internals/a-callable":222,"../internals/an-instance":226,"../internals/define-built-in":245,"../internals/engine-is-node":254,"../internals/export":259,"../internals/function-call":264,"../internals/global":274,"../internals/host-report-errors":277,"../internals/internal-state":282,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/microtask":302,"../internals/new-promise-capability":303,"../internals/object-set-prototype-of":318,"../internals/perform":323,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/queue":328,"../internals/set-species":330,"../internals/set-to-string-tag":331,"../internals/species-constructor":335,"../internals/task":339}],371:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/is-pure"),l=e("../internals/promise-native-constructor"),c=e("../internals/fails"),i=e("../internals/get-built-in"),u=e("../internals/is-callable"),p=e("../internals/species-constructor"),f=e("../internals/promise-resolve"),h=e("../internals/define-built-in"),v=l&&l.prototype;if(o({target:"Promise",proto:!0,real:!0,forced:!!l&&c(function(){v.finally.call({then:function(){}},function(){})})},{finally:function(g){var x=p(this,i("Promise")),y=u(g);return this.then(y?function(E){return f(x,g()).then(function(){return E})}:g,y?function(E){return f(x,g()).then(function(){throw E})}:g)}}),!s&&u(l)){var b=i("Promise").prototype.finally;v.finally!==b&&h(v,"finally",b,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/fails":260,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326,"../internals/species-constructor":335}],372:[function(e,n,a){e("../modules/es.promise.constructor"),e("../modules/es.promise.all"),e("../modules/es.promise.catch"),e("../modules/es.promise.race"),e("../modules/es.promise.reject"),e("../modules/es.promise.resolve")},{"../modules/es.promise.all":368,"../modules/es.promise.catch":369,"../modules/es.promise.constructor":370,"../modules/es.promise.race":373,"../modules/es.promise.reject":374,"../modules/es.promise.resolve":375}],373:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/function-call"),l=e("../internals/a-callable"),c=e("../internals/new-promise-capability"),i=e("../internals/perform"),u=e("../internals/iterate");o({target:"Promise",stat:!0,forced:e("../internals/promise-statics-incorrect-iteration")},{race:function(p){var f=this,h=c.f(f),v=h.reject,b=i(function(){var g=l(f.resolve);u(p,function(x){s(g,f,x).then(h.resolve,v)})});return b.error&&v(b.value),h.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],374:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/function-call"),l=e("../internals/new-promise-capability");o({target:"Promise",stat:!0,forced:e("../internals/promise-constructor-detection").CONSTRUCTOR},{reject:function(c){var i=l.f(this);return s(i.reject,void 0,c),i.promise}})},{"../internals/export":259,"../internals/function-call":264,"../internals/new-promise-capability":303,"../internals/promise-constructor-detection":324}],375:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/get-built-in"),l=e("../internals/is-pure"),c=e("../internals/promise-native-constructor"),i=e("../internals/promise-constructor-detection").CONSTRUCTOR,u=e("../internals/promise-resolve"),p=s("Promise"),f=l&&!i;o({target:"Promise",stat:!0,forced:l||i},{resolve:function(h){return u(f&&this===p?c:this,h)}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326}],376:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/function-uncurry-this"),l=e("../internals/to-absolute-index"),c=RangeError,i=String.fromCharCode,u=String.fromCodePoint,p=s([].join);o({target:"String",stat:!0,arity:1,forced:!!u&&u.length!==1},{fromCodePoint:function(f){for(var h,v=[],b=arguments.length,g=0;b>g;){if(h=+arguments[g++],l(h,1114111)!==h)throw new c(h+" is not a valid code point");v[g]=h<65536?i(h):i(55296+((h-=65536)>>10),h%1024+56320)}return p(v,"")}})},{"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/to-absolute-index":340}],377:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/function-uncurry-this"),l=e("../internals/not-a-regexp"),c=e("../internals/require-object-coercible"),i=e("../internals/to-string"),u=e("../internals/correct-is-regexp-logic"),p=s("".indexOf);o({target:"String",proto:!0,forced:!u("includes")},{includes:function(f){return!!~p(i(c(this)),i(l(f)),arguments.length>1?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":238,"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/not-a-regexp":304,"../internals/require-object-coercible":329,"../internals/to-string":348}],378:[function(e,n,a){e("../internals/well-known-symbol-define")("asyncIterator")},{"../internals/well-known-symbol-define":355}],379:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/global"),l=e("../internals/function-call"),c=e("../internals/function-uncurry-this"),i=e("../internals/is-pure"),u=e("../internals/descriptors"),p=e("../internals/symbol-constructor-detection"),f=e("../internals/fails"),h=e("../internals/has-own-property"),v=e("../internals/object-is-prototype-of"),b=e("../internals/an-object"),g=e("../internals/to-indexed-object"),x=e("../internals/to-property-key"),y=e("../internals/to-string"),E=e("../internals/create-property-descriptor"),N=e("../internals/object-create"),I=e("../internals/object-keys"),L=e("../internals/object-get-own-property-names"),H=e("../internals/object-get-own-property-names-external"),V=e("../internals/object-get-own-property-symbols"),q=e("../internals/object-get-own-property-descriptor"),K=e("../internals/object-define-property"),z=e("../internals/object-define-properties"),W=e("../internals/object-property-is-enumerable"),D=e("../internals/define-built-in"),M=e("../internals/define-built-in-accessor"),C=e("../internals/shared"),w=e("../internals/shared-key"),T=e("../internals/hidden-keys"),A=e("../internals/uid"),S=e("../internals/well-known-symbol"),j=e("../internals/well-known-symbol-wrapped"),B=e("../internals/well-known-symbol-define"),R=e("../internals/symbol-define-to-primitive"),X=e("../internals/set-to-string-tag"),Y=e("../internals/internal-state"),ee=e("../internals/array-iteration").forEach,U=w("hidden"),Q=Y.set,P=Y.getterFor("Symbol"),F=Object.prototype,Z=s.Symbol,se=Z&&Z.prototype,re=s.RangeError,ae=s.TypeError,te=s.QObject,he=q.f,le=K.f,ne=H.f,de=W.f,fe=c([].push),Se=C("symbols"),_e=C("op-symbols"),Ce=C("wks"),Re=!te||!te.prototype||!te.prototype.findChild,Pe=function(Je,ot,ut){var _t=he(F,ot);_t&&delete F[ot],le(Je,ot,ut),_t&&Je!==F&&le(F,ot,_t)},Ye=u&&f(function(){return N(le({},"a",{get:function(){return le(this,"a",{value:7}).a}})).a!==7})?Pe:le,at=function(Je,ot){var ut=Se[Je]=N(se);return Q(ut,{type:"Symbol",tag:Je,description:ot}),u||(ut.description=ot),ut},tt=function(Je,ot,ut){Je===F&&tt(_e,ot,ut),b(Je);var _t=x(ot);return b(ut),h(Se,_t)?(ut.enumerable?(h(Je,U)&&Je[U][_t]&&(Je[U][_t]=!1),ut=N(ut,{enumerable:E(0,!1)})):(h(Je,U)||le(Je,U,E(1,{})),Je[U][_t]=!0),Ye(Je,_t,ut)):le(Je,_t,ut)},it=function(Je,ot){b(Je);var ut=g(ot),_t=I(ut).concat(pt(ut));return ee(_t,function(vt){u&&!l(rt,ut,vt)||tt(Je,vt,ut[vt])}),Je},rt=function(Je){var ot=x(Je),ut=l(de,this,ot);return!(this===F&&h(Se,ot)&&!h(_e,ot))&&(!(ut||!h(this,ot)||!h(Se,ot)||h(this,U)&&this[U][ot])||ut)},ct=function(Je,ot){var ut=g(Je),_t=x(ot);if(ut!==F||!h(Se,_t)||h(_e,_t)){var vt=he(ut,_t);return!vt||!h(Se,_t)||h(ut,U)&&ut[U][_t]||(vt.enumerable=!0),vt}},Oe=function(Je){var ot=ne(g(Je)),ut=[];return ee(ot,function(_t){h(Se,_t)||h(T,_t)||fe(ut,_t)}),ut},pt=function(Je){var ot=Je===F,ut=ne(ot?_e:g(Je)),_t=[];return ee(ut,function(vt){!h(Se,vt)||ot&&!h(F,vt)||fe(_t,Se[vt])}),_t};p||(D(se=(Z=function(){if(v(se,this))throw new ae("Symbol is not a constructor");var Je=arguments.length&&arguments[0]!==void 0?y(arguments[0]):void 0,ot=A(Je),ut=function(_t){this===F&&l(ut,_e,_t),h(this,U)&&h(this[U],ot)&&(this[U][ot]=!1);var vt=E(1,_t);try{Ye(this,ot,vt)}catch(ht){if(!(ht instanceof re))throw ht;Pe(this,ot,vt)}};return u&&Re&&Ye(F,ot,{configurable:!0,set:ut}),at(ot,Je)}).prototype,"toString",function(){return P(this).tag}),D(Z,"withoutSetter",function(Je){return at(A(Je),Je)}),W.f=rt,K.f=tt,z.f=it,q.f=ct,L.f=H.f=Oe,V.f=pt,j.f=function(Je){return at(S(Je),Je)},u&&(M(se,"description",{configurable:!0,get:function(){return P(this).description}}),i||D(F,"propertyIsEnumerable",rt,{unsafe:!0}))),o({global:!0,constructor:!0,wrap:!0,forced:!p,sham:!p},{Symbol:Z}),ee(I(Ce),function(Je){B(Je)}),o({target:"Symbol",stat:!0,forced:!p},{useSetter:function(){Re=!0},useSimple:function(){Re=!1}}),o({target:"Object",stat:!0,forced:!p,sham:!u},{create:function(Je,ot){return ot===void 0?N(Je):it(N(Je),ot)},defineProperty:tt,defineProperties:it,getOwnPropertyDescriptor:ct}),o({target:"Object",stat:!0,forced:!p},{getOwnPropertyNames:Oe}),R(),X(Z,"Symbol"),T[U]=!0},{"../internals/an-object":227,"../internals/array-iteration":229,"../internals/create-property-descriptor":242,"../internals/define-built-in":245,"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/export":259,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-define-properties":307,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-names-external":310,"../internals/object-get-own-property-symbols":312,"../internals/object-is-prototype-of":314,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/set-to-string-tag":331,"../internals/shared":334,"../internals/shared-key":332,"../internals/symbol-constructor-detection":336,"../internals/symbol-define-to-primitive":337,"../internals/to-indexed-object":341,"../internals/to-property-key":346,"../internals/to-string":348,"../internals/uid":350,"../internals/well-known-symbol":357,"../internals/well-known-symbol-define":355,"../internals/well-known-symbol-wrapped":356}],380:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/get-built-in"),l=e("../internals/has-own-property"),c=e("../internals/to-string"),i=e("../internals/shared"),u=e("../internals/symbol-registry-detection"),p=i("string-to-symbol-registry"),f=i("symbol-to-string-registry");o({target:"Symbol",stat:!0,forced:!u},{for:function(h){var v=c(h);if(l(p,v))return p[v];var b=s("Symbol")(v);return p[v]=b,f[b]=v,b}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/to-string":348}],381:[function(e,n,a){e("../modules/es.symbol.constructor"),e("../modules/es.symbol.for"),e("../modules/es.symbol.key-for"),e("../modules/es.json.stringify"),e("../modules/es.object.get-own-property-symbols")},{"../modules/es.json.stringify":362,"../modules/es.object.get-own-property-symbols":365,"../modules/es.symbol.constructor":379,"../modules/es.symbol.for":380,"../modules/es.symbol.key-for":382}],382:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/has-own-property"),l=e("../internals/is-symbol"),c=e("../internals/try-to-string"),i=e("../internals/shared"),u=e("../internals/symbol-registry-detection"),p=i("symbol-to-string-registry");o({target:"Symbol",stat:!0,forced:!u},{keyFor:function(f){if(!l(f))throw new TypeError(c(f)+" is not a symbol");if(s(p,f))return p[f]}})},{"../internals/export":259,"../internals/has-own-property":275,"../internals/is-symbol":292,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/try-to-string":349}],383:[function(e,n,a){function o(s){return Object.prototype.toString.call(s)}a.isArray=function(s){return Array.isArray?Array.isArray(s):o(s)==="[object Array]"},a.isBoolean=function(s){return typeof s=="boolean"},a.isNull=function(s){return s===null},a.isNullOrUndefined=function(s){return s==null},a.isNumber=function(s){return typeof s=="number"},a.isString=function(s){return typeof s=="string"},a.isSymbol=function(s){return typeof s=="symbol"},a.isUndefined=function(s){return s===void 0},a.isRegExp=function(s){return o(s)==="[object RegExp]"},a.isObject=function(s){return typeof s=="object"&&s!==null},a.isDate=function(s){return o(s)==="[object Date]"},a.isError=function(s){return o(s)==="[object Error]"||s instanceof Error},a.isFunction=function(s){return typeof s=="function"},a.isPrimitive=function(s){return s===null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||typeof s=="symbol"||s===void 0},a.isBuffer=e("buffer").Buffer.isBuffer},{buffer:220}],384:[function(e,n,a){(function(o){(function(){var s=e("elliptic"),l=e("bn.js");n.exports=function(p){return new i(p)};var c={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function i(p){this.curveType=c[p],this.curveType||(this.curveType={name:p}),this.curve=new s.ec(this.curveType.name),this.keys=void 0}function u(p,f,h){Array.isArray(p)||(p=p.toArray());var v=new o(p);if(h&&v.length<h){var b=new o(h-v.length);b.fill(0),v=o.concat([b,v])}return f?v.toString(f):v}c.p224=c.secp224r1,c.p256=c.secp256r1=c.prime256v1,c.p192=c.secp192r1=c.prime192v1,c.p384=c.secp384r1,c.p521=c.secp521r1,i.prototype.generateKeys=function(p,f){return this.keys=this.curve.genKeyPair(),this.getPublicKey(p,f)},i.prototype.computeSecret=function(p,f,h){return f=f||"utf8",o.isBuffer(p)||(p=new o(p,f)),u(this.curve.keyFromPublic(p).getPublic().mul(this.keys.getPrivate()).getX(),h,this.curveType.byteLength)},i.prototype.getPublicKey=function(p,f){var h=this.keys.getPublic(f==="compressed",!0);return f==="hybrid"&&(h[h.length-1]%2?h[0]=7:h[0]=6),u(h,p)},i.prototype.getPrivateKey=function(p){return u(this.keys.getPrivate(),p)},i.prototype.setPublicKey=function(p,f){return f=f||"utf8",o.isBuffer(p)||(p=new o(p,f)),this.keys._importPublic(p),this},i.prototype.setPrivateKey=function(p,f){f=f||"utf8",o.isBuffer(p)||(p=new o(p,f));var h=new l(p);return h=h.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(h),this}}).call(this)}).call(this,e("buffer").Buffer)},{"bn.js":385,buffer:220,elliptic:405}],385:[function(e,n,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],386:[function(e,n,a){var o=e("inherits"),s=e("md5.js"),l=e("ripemd160"),c=e("sha.js"),i=e("cipher-base");function u(p){i.call(this,"digest"),this._hash=p}o(u,i),u.prototype._update=function(p){this._hash.update(p)},u.prototype._final=function(){return this._hash.digest()},n.exports=function(p){return(p=p.toLowerCase())==="md5"?new s:p==="rmd160"||p==="ripemd160"?new l:new u(c(p))}},{"cipher-base":221,inherits:440,"md5.js":450,ripemd160:493,"sha.js":498}],387:[function(e,n,a){var o=e("md5.js");n.exports=function(s){return new o().update(s).digest()}},{"md5.js":450}],388:[function(e,n,a){var o=e("inherits"),s=e("./legacy"),l=e("cipher-base"),c=e("safe-buffer").Buffer,i=e("create-hash/md5"),u=e("ripemd160"),p=e("sha.js"),f=c.alloc(128);function h(v,b){l.call(this,"digest"),typeof b=="string"&&(b=c.from(b));var g=v==="sha512"||v==="sha384"?128:64;this._alg=v,this._key=b,b.length>g?b=(v==="rmd160"?new u:p(v)).update(b).digest():b.length<g&&(b=c.concat([b,f],g));for(var x=this._ipad=c.allocUnsafe(g),y=this._opad=c.allocUnsafe(g),E=0;E<g;E++)x[E]=54^b[E],y[E]=92^b[E];this._hash=v==="rmd160"?new u:p(v),this._hash.update(x)}o(h,l),h.prototype._update=function(v){this._hash.update(v)},h.prototype._final=function(){var v=this._hash.digest();return(this._alg==="rmd160"?new u:p(this._alg)).update(this._opad).update(v).digest()},n.exports=function(v,b){return(v=v.toLowerCase())==="rmd160"||v==="ripemd160"?new h("rmd160",b):v==="md5"?new s(i,b):new h(v,b)}},{"./legacy":389,"cipher-base":221,"create-hash/md5":387,inherits:440,ripemd160:493,"safe-buffer":494,"sha.js":498}],389:[function(e,n,a){var o=e("inherits"),s=e("safe-buffer").Buffer,l=e("cipher-base"),c=s.alloc(128);function i(u,p){l.call(this,"digest"),typeof p=="string"&&(p=s.from(p)),this._alg=u,this._key=p,p.length>64?p=u(p):p.length<64&&(p=s.concat([p,c],64));for(var f=this._ipad=s.allocUnsafe(64),h=this._opad=s.allocUnsafe(64),v=0;v<64;v++)f[v]=54^p[v],h[v]=92^p[v];this._hash=[f]}o(i,l),i.prototype._update=function(u){this._hash.push(u)},i.prototype._final=function(){var u=this._alg(s.concat(this._hash));return this._alg(s.concat([this._opad,u]))},n.exports=i},{"cipher-base":221,inherits:440,"safe-buffer":494}],390:[function(e,n,a){a.randomBytes=a.rng=a.pseudoRandomBytes=a.prng=e("randombytes"),a.createHash=a.Hash=e("create-hash"),a.createHmac=a.Hmac=e("create-hmac");var o=e("browserify-sign/algos"),s=Object.keys(o),l=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(s);a.getHashes=function(){return l};var c=e("pbkdf2");a.pbkdf2=c.pbkdf2,a.pbkdf2Sync=c.pbkdf2Sync;var i=e("browserify-cipher");a.Cipher=i.Cipher,a.createCipher=i.createCipher,a.Cipheriv=i.Cipheriv,a.createCipheriv=i.createCipheriv,a.Decipher=i.Decipher,a.createDecipher=i.createDecipher,a.Decipheriv=i.Decipheriv,a.createDecipheriv=i.createDecipheriv,a.getCiphers=i.getCiphers,a.listCiphers=i.listCiphers;var u=e("diffie-hellman");a.DiffieHellmanGroup=u.DiffieHellmanGroup,a.createDiffieHellmanGroup=u.createDiffieHellmanGroup,a.getDiffieHellman=u.getDiffieHellman,a.createDiffieHellman=u.createDiffieHellman,a.DiffieHellman=u.DiffieHellman;var p=e("browserify-sign");a.createSign=p.createSign,a.Sign=p.Sign,a.createVerify=p.createVerify,a.Verify=p.Verify,a.createECDH=e("create-ecdh");var f=e("public-encrypt");a.publicEncrypt=f.publicEncrypt,a.privateEncrypt=f.privateEncrypt,a.publicDecrypt=f.publicDecrypt,a.privateDecrypt=f.privateDecrypt;var h=e("randomfill");a.randomFill=h.randomFill,a.randomFillSync=h.randomFillSync,a.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},a.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":206,"browserify-sign":213,"browserify-sign/algos":210,"create-ecdh":384,"create-hash":386,"create-hmac":388,"diffie-hellman":400,pbkdf2:460,"public-encrypt":468,randombytes:475,randomfill:476}],391:[function(e,n,a){(function(o,s){typeof a=="object"&&n!==void 0?n.exports=s():(o=typeof globalThis<"u"?globalThis:o||self).dayjs=s()})(void 0,function(){var o=6e4,s=36e5,l="millisecond",c="second",i="minute",u="hour",p="day",f="week",h="month",v="quarter",b="year",g="date",x="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,E=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,N={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(w){var T=["th","st","nd","rd"],A=w%100;return"["+w+(T[(A-20)%10]||T[A]||T[0])+"]"}},I=function(w,T,A){var S=String(w);return!S||S.length>=T?w:""+Array(T+1-S.length).join(A)+w},L={s:I,z:function(w){var T=-w.utcOffset(),A=Math.abs(T),S=Math.floor(A/60),j=A%60;return(T<=0?"+":"-")+I(S,2,"0")+":"+I(j,2,"0")},m:function w(T,A){if(T.date()<A.date())return-w(A,T);var S=12*(A.year()-T.year())+(A.month()-T.month()),j=T.clone().add(S,h),B=A-j<0,R=T.clone().add(S+(B?-1:1),h);return+(-(S+(A-j)/(B?j-R:R-j))||0)},a:function(w){return w<0?Math.ceil(w)||0:Math.floor(w)},p:function(w){return{M:h,y:b,w:f,d:p,D:g,h:u,m:i,s:c,ms:l,Q:v}[w]||String(w||"").toLowerCase().replace(/s$/,"")},u:function(w){return w===void 0}},H="en",V={};V[H]=N;var q="$isDayjsObject",K=function(w){return w instanceof M||!(!w||!w[q])},z=function w(T,A,S){var j;if(!T)return H;if(typeof T=="string"){var B=T.toLowerCase();V[B]&&(j=B),A&&(V[B]=A,j=B);var R=T.split("-");if(!j&&R.length>1)return w(R[0])}else{var X=T.name;V[X]=T,j=X}return!S&&j&&(H=j),j||!S&&H},W=function(w,T){if(K(w))return w.clone();var A=typeof T=="object"?T:{};return A.date=w,A.args=arguments,new M(A)},D=L;D.l=z,D.i=K,D.w=function(w,T){return W(w,{locale:T.$L,utc:T.$u,x:T.$x,$offset:T.$offset})};var M=function(){function w(A){this.$L=z(A.locale,null,!0),this.parse(A),this.$x=this.$x||A.x||{},this[q]=!0}var T=w.prototype;return T.parse=function(A){this.$d=function(S){var j=S.date,B=S.utc;if(j===null)return new Date(NaN);if(D.u(j))return new Date;if(j instanceof Date)return new Date(j);if(typeof j=="string"&&!/Z$/i.test(j)){var R=j.match(y);if(R){var X=R[2]-1||0,Y=(R[7]||"0").substring(0,3);return B?new Date(Date.UTC(R[1],X,R[3]||1,R[4]||0,R[5]||0,R[6]||0,Y)):new Date(R[1],X,R[3]||1,R[4]||0,R[5]||0,R[6]||0,Y)}}return new Date(j)}(A),this.init()},T.init=function(){var A=this.$d;this.$y=A.getFullYear(),this.$M=A.getMonth(),this.$D=A.getDate(),this.$W=A.getDay(),this.$H=A.getHours(),this.$m=A.getMinutes(),this.$s=A.getSeconds(),this.$ms=A.getMilliseconds()},T.$utils=function(){return D},T.isValid=function(){return this.$d.toString()!==x},T.isSame=function(A,S){var j=W(A);return this.startOf(S)<=j&&j<=this.endOf(S)},T.isAfter=function(A,S){return W(A)<this.startOf(S)},T.isBefore=function(A,S){return this.endOf(S)<W(A)},T.$g=function(A,S,j){return D.u(A)?this[S]:this.set(j,A)},T.unix=function(){return Math.floor(this.valueOf()/1e3)},T.valueOf=function(){return this.$d.getTime()},T.startOf=function(A,S){var j=this,B=!!D.u(S)||S,R=D.p(A),X=function(se,re){var ae=D.w(j.$u?Date.UTC(j.$y,re,se):new Date(j.$y,re,se),j);return B?ae:ae.endOf(p)},Y=function(se,re){return D.w(j.toDate()[se].apply(j.toDate("s"),(B?[0,0,0,0]:[23,59,59,999]).slice(re)),j)},ee=this.$W,U=this.$M,Q=this.$D,P="set"+(this.$u?"UTC":"");switch(R){case b:return B?X(1,0):X(31,11);case h:return B?X(1,U):X(0,U+1);case f:var F=this.$locale().weekStart||0,Z=(ee<F?ee+7:ee)-F;return X(B?Q-Z:Q+(6-Z),U);case p:case g:return Y(P+"Hours",0);case u:return Y(P+"Minutes",1);case i:return Y(P+"Seconds",2);case c:return Y(P+"Milliseconds",3);default:return this.clone()}},T.endOf=function(A){return this.startOf(A,!1)},T.$set=function(A,S){var j,B=D.p(A),R="set"+(this.$u?"UTC":""),X=(j={},j[p]=R+"Date",j[g]=R+"Date",j[h]=R+"Month",j[b]=R+"FullYear",j[u]=R+"Hours",j[i]=R+"Minutes",j[c]=R+"Seconds",j[l]=R+"Milliseconds",j)[B],Y=B===p?this.$D+(S-this.$W):S;if(B===h||B===b){var ee=this.clone().set(g,1);ee.$d[X](Y),ee.init(),this.$d=ee.set(g,Math.min(this.$D,ee.daysInMonth())).$d}else X&&this.$d[X](Y);return this.init(),this},T.set=function(A,S){return this.clone().$set(A,S)},T.get=function(A){return this[D.p(A)]()},T.add=function(A,S){var j,B=this;A=Number(A);var R=D.p(S),X=function(U){var Q=W(B);return D.w(Q.date(Q.date()+Math.round(U*A)),B)};if(R===h)return this.set(h,this.$M+A);if(R===b)return this.set(b,this.$y+A);if(R===p)return X(1);if(R===f)return X(7);var Y=(j={},j[i]=o,j[u]=s,j[c]=1e3,j)[R]||1,ee=this.$d.getTime()+A*Y;return D.w(ee,this)},T.subtract=function(A,S){return this.add(-1*A,S)},T.format=function(A){var S=this,j=this.$locale();if(!this.isValid())return j.invalidDate||x;var B=A||"YYYY-MM-DDTHH:mm:ssZ",R=D.z(this),X=this.$H,Y=this.$m,ee=this.$M,U=j.weekdays,Q=j.months,P=j.meridiem,F=function(re,ae,te,he){return re&&(re[ae]||re(S,B))||te[ae].slice(0,he)},Z=function(re){return D.s(X%12||12,re,"0")},se=P||function(re,ae,te){var he=re<12?"AM":"PM";return te?he.toLowerCase():he};return B.replace(E,function(re,ae){return ae||function(te){switch(te){case"YY":return String(S.$y).slice(-2);case"YYYY":return D.s(S.$y,4,"0");case"M":return ee+1;case"MM":return D.s(ee+1,2,"0");case"MMM":return F(j.monthsShort,ee,Q,3);case"MMMM":return F(Q,ee);case"D":return S.$D;case"DD":return D.s(S.$D,2,"0");case"d":return String(S.$W);case"dd":return F(j.weekdaysMin,S.$W,U,2);case"ddd":return F(j.weekdaysShort,S.$W,U,3);case"dddd":return U[S.$W];case"H":return String(X);case"HH":return D.s(X,2,"0");case"h":return Z(1);case"hh":return Z(2);case"a":return se(X,Y,!0);case"A":return se(X,Y,!1);case"m":return String(Y);case"mm":return D.s(Y,2,"0");case"s":return String(S.$s);case"ss":return D.s(S.$s,2,"0");case"SSS":return D.s(S.$ms,3,"0");case"Z":return R}return null}(re)||R.replace(":","")})},T.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},T.diff=function(A,S,j){var B,R=this,X=D.p(S),Y=W(A),ee=(Y.utcOffset()-this.utcOffset())*o,U=this-Y,Q=function(){return D.m(R,Y)};switch(X){case b:B=Q()/12;break;case h:B=Q();break;case v:B=Q()/3;break;case f:B=(U-ee)/6048e5;break;case p:B=(U-ee)/864e5;break;case u:B=U/s;break;case i:B=U/o;break;case c:B=U/1e3;break;default:B=U}return j?B:D.a(B)},T.daysInMonth=function(){return this.endOf(h).$D},T.$locale=function(){return V[this.$L]},T.locale=function(A,S){if(!A)return this.$L;var j=this.clone(),B=z(A,S,!0);return B&&(j.$L=B),j},T.clone=function(){return D.w(this.$d,this)},T.toDate=function(){return new Date(this.valueOf())},T.toJSON=function(){return this.isValid()?this.toISOString():null},T.toISOString=function(){return this.$d.toISOString()},T.toString=function(){return this.$d.toUTCString()},w}(),C=M.prototype;return W.prototype=C,[["$ms",l],["$s",c],["$m",i],["$H",u],["$W",p],["$M",h],["$y",b],["$D",g]].forEach(function(w){C[w[1]]=function(T){return this.$g(T,w[0],w[1])}}),W.extend=function(w,T){return w.$i||(w(T,M,W),w.$i=!0),W},W.locale=z,W.isDayjs=K,W.unix=function(w){return W(1e3*w)},W.en=V[H],W.Ls=V,W.p={},W})},{}],392:[function(e,n,a){(function(o,s){typeof a=="object"&&n!==void 0?n.exports=s():(o=typeof globalThis<"u"?globalThis:o||self).dayjs_plugin_customParseFormat=s()})(void 0,function(){var o={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},s=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,l=/\d\d/,c=/\d\d?/,i=/\d*[^-_:/,()\s\d]+/,u={},p=function(y){return(y=+y)+(y>68?1900:2e3)},f=function(y){return function(E){this[y]=+E}},h=[/[+-]\d\d:?(\d\d)?|Z/,function(y){(this.zone||(this.zone={})).offset=function(E){if(!E||E==="Z")return 0;var N=E.match(/([+-]|\d\d)/g),I=60*N[1]+(+N[2]||0);return I===0?0:N[0]==="+"?-I:I}(y)}],v=function(y){var E=u[y];return E&&(E.indexOf?E:E.s.concat(E.f))},b=function(y,E){var N,I=u.meridiem;if(I){for(var L=1;L<=24;L+=1)if(y.indexOf(I(L,0,E))>-1){N=L>12;break}}else N=y===(E?"pm":"PM");return N},g={A:[i,function(y){this.afternoon=b(y,!1)}],a:[i,function(y){this.afternoon=b(y,!0)}],S:[/\d/,function(y){this.milliseconds=100*+y}],SS:[l,function(y){this.milliseconds=10*+y}],SSS:[/\d{3}/,function(y){this.milliseconds=+y}],s:[c,f("seconds")],ss:[c,f("seconds")],m:[c,f("minutes")],mm:[c,f("minutes")],H:[c,f("hours")],h:[c,f("hours")],HH:[c,f("hours")],hh:[c,f("hours")],D:[c,f("day")],DD:[l,f("day")],Do:[i,function(y){var E=u.ordinal,N=y.match(/\d+/);if(this.day=N[0],E)for(var I=1;I<=31;I+=1)E(I).replace(/\[|\]/g,"")===y&&(this.day=I)}],M:[c,f("month")],MM:[l,f("month")],MMM:[i,function(y){var E=v("months"),N=(v("monthsShort")||E.map(function(I){return I.slice(0,3)})).indexOf(y)+1;if(N<1)throw new Error;this.month=N%12||N}],MMMM:[i,function(y){var E=v("months").indexOf(y)+1;if(E<1)throw new Error;this.month=E%12||E}],Y:[/[+-]?\d+/,f("year")],YY:[l,function(y){this.year=p(y)}],YYYY:[/\d{4}/,f("year")],Z:h,ZZ:h};function x(y){var E,N;E=y,N=u&&u.formats;for(var I=(y=E.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(W,D,M){var C=M&&M.toUpperCase();return D||N[M]||o[M]||N[C].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(w,T,A){return T||A.slice(1)})})).match(s),L=I.length,H=0;H<L;H+=1){var V=I[H],q=g[V],K=q&&q[0],z=q&&q[1];I[H]=z?{regex:K,parser:z}:V.replace(/^\[|\]$/g,"")}return function(W){for(var D={},M=0,C=0;M<L;M+=1){var w=I[M];if(typeof w=="string")C+=w.length;else{var T=w.regex,A=w.parser,S=W.slice(C),j=T.exec(S)[0];A.call(D,j),W=W.replace(j,"")}}return function(B){var R=B.afternoon;if(R!==void 0){var X=B.hours;R?X<12&&(B.hours+=12):X===12&&(B.hours=0),delete B.afternoon}}(D),D}}return function(y,E,N){N.p.customParseFormat=!0,y&&y.parseTwoDigitYear&&(p=y.parseTwoDigitYear);var I=E.prototype,L=I.parse;I.parse=function(H){var V=H.date,q=H.utc,K=H.args;this.$u=q;var z=K[1];if(typeof z=="string"){var W=K[2]===!0,D=K[3]===!0,M=W||D,C=K[2];D&&(C=K[2]),u=this.$locale(),!W&&C&&(u=N.Ls[C]),this.$d=function(S,j,B){try{if(["x","X"].indexOf(j)>-1)return new Date((j==="X"?1e3:1)*S);var R=x(j)(S),X=R.year,Y=R.month,ee=R.day,U=R.hours,Q=R.minutes,P=R.seconds,F=R.milliseconds,Z=R.zone,se=new Date,re=ee||(X||Y?1:se.getDate()),ae=X||se.getFullYear(),te=0;X&&!Y||(te=Y>0?Y-1:se.getMonth());var he=U||0,le=Q||0,ne=P||0,de=F||0;return Z?new Date(Date.UTC(ae,te,re,he,le,ne,de+60*Z.offset*1e3)):B?new Date(Date.UTC(ae,te,re,he,le,ne,de)):new Date(ae,te,re,he,le,ne,de)}catch{return new Date("")}}(V,z,q),this.init(),C&&C!==!0&&(this.$L=this.locale(C).$L),M&&V!=this.format(z)&&(this.$d=new Date("")),u={}}else if(z instanceof Array)for(var w=z.length,T=1;T<=w;T+=1){K[1]=z[T-1];var A=N.apply(this,K);if(A.isValid()){this.$d=A.$d,this.$L=A.$L,this.init();break}T===w&&(this.$d=new Date(""))}else L.call(this,H)}}})},{}],393:[function(e,n,a){(function(o,s){typeof a=="object"&&n!==void 0?n.exports=s():(o=typeof globalThis<"u"?globalThis:o||self).dayjs_plugin_utc=s()})(void 0,function(){var o="minute",s=/[+-]\d\d(?::?\d\d)?/g,l=/([+-]|\d\d)/g;return function(c,i,u){var p=i.prototype;u.utc=function(y){var E={date:y,utc:!0,args:arguments};return new i(E)},p.utc=function(y){var E=u(this.toDate(),{locale:this.$L,utc:!0});return y?E.add(this.utcOffset(),o):E},p.local=function(){return u(this.toDate(),{locale:this.$L,utc:!1})};var f=p.parse;p.parse=function(y){y.utc&&(this.$u=!0),this.$utils().u(y.$offset)||(this.$offset=y.$offset),f.call(this,y)};var h=p.init;p.init=function(){if(this.$u){var y=this.$d;this.$y=y.getUTCFullYear(),this.$M=y.getUTCMonth(),this.$D=y.getUTCDate(),this.$W=y.getUTCDay(),this.$H=y.getUTCHours(),this.$m=y.getUTCMinutes(),this.$s=y.getUTCSeconds(),this.$ms=y.getUTCMilliseconds()}else h.call(this)};var v=p.utcOffset;p.utcOffset=function(y,E){var N=this.$utils().u;if(N(y))return this.$u?0:N(this.$offset)?v.call(this):this.$offset;if(typeof y=="string"&&(y=function(V){V===void 0&&(V="");var q=V.match(s);if(!q)return null;var K=(""+q[0]).match(l)||["-",0,0],z=K[0],W=60*+K[1]+ +K[2];return W===0?0:z==="+"?W:-W}(y))===null)return this;var I=Math.abs(y)<=16?60*y:y,L=this;if(E)return L.$offset=I,L.$u=y===0,L;if(y!==0){var H=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(L=this.local().add(I+H,o)).$offset=I,L.$x.$localOffset=H}else L=this.utc();return L};var b=p.format;p.format=function(y){var E=y||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return b.call(this,E)},p.valueOf=function(){var y=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*y},p.isUTC=function(){return!!this.$u},p.toISOString=function(){return this.toDate().toISOString()},p.toString=function(){return this.toDate().toUTCString()};var g=p.toDate;p.toDate=function(y){return y==="s"&&this.$offset?u(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():g.call(this)};var x=p.diff;p.diff=function(y,E,N){if(y&&this.$u===y.$u)return x.call(this,y,E,N);var I=this.local(),L=u(y).local();return x.call(I,L,E,N)}}})},{}],394:[function(e,n,a){a.utils=e("./des/utils"),a.Cipher=e("./des/cipher"),a.DES=e("./des/des"),a.CBC=e("./des/cbc"),a.EDE=e("./des/ede")},{"./des/cbc":395,"./des/cipher":396,"./des/des":397,"./des/ede":398,"./des/utils":399}],395:[function(e,n,a){var o=e("minimalistic-assert"),s=e("inherits"),l={};function c(i){o.equal(i.length,8,"Invalid IV length"),this.iv=new Array(8);for(var u=0;u<this.iv.length;u++)this.iv[u]=i[u]}a.instantiate=function(i){function u(v){i.call(this,v),this._cbcInit()}s(u,i);for(var p=Object.keys(l),f=0;f<p.length;f++){var h=p[f];u.prototype[h]=l[h]}return u.create=function(v){return new u(v)},u},l._cbcInit=function(){var i=new c(this.options.iv);this._cbcState=i},l._update=function(i,u,p,f){var h=this._cbcState,v=this.constructor.super_.prototype,b=h.iv;if(this.type==="encrypt"){for(var g=0;g<this.blockSize;g++)b[g]^=i[u+g];for(v._update.call(this,b,0,p,f),g=0;g<this.blockSize;g++)b[g]=p[f+g]}else{for(v._update.call(this,i,u,p,f),g=0;g<this.blockSize;g++)p[f+g]^=b[g];for(g=0;g<this.blockSize;g++)b[g]=i[u+g]}}},{inherits:440,"minimalistic-assert":453}],396:[function(e,n,a){var o=e("minimalistic-assert");function s(l){this.options=l,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=l.padding!==!1}n.exports=s,s.prototype._init=function(){},s.prototype.update=function(l){return l.length===0?[]:this.type==="decrypt"?this._updateDecrypt(l):this._updateEncrypt(l)},s.prototype._buffer=function(l,c){for(var i=Math.min(this.buffer.length-this.bufferOff,l.length-c),u=0;u<i;u++)this.buffer[this.bufferOff+u]=l[c+u];return this.bufferOff+=i,i},s.prototype._flushBuffer=function(l,c){return this._update(this.buffer,0,l,c),this.bufferOff=0,this.blockSize},s.prototype._updateEncrypt=function(l){var c=0,i=0,u=(this.bufferOff+l.length)/this.blockSize|0,p=new Array(u*this.blockSize);this.bufferOff!==0&&(c+=this._buffer(l,c),this.bufferOff===this.buffer.length&&(i+=this._flushBuffer(p,i)));for(var f=l.length-(l.length-c)%this.blockSize;c<f;c+=this.blockSize)this._update(l,c,p,i),i+=this.blockSize;for(;c<l.length;c++,this.bufferOff++)this.buffer[this.bufferOff]=l[c];return p},s.prototype._updateDecrypt=function(l){for(var c=0,i=0,u=Math.ceil((this.bufferOff+l.length)/this.blockSize)-1,p=new Array(u*this.blockSize);u>0;u--)c+=this._buffer(l,c),i+=this._flushBuffer(p,i);return c+=this._buffer(l,c),p},s.prototype.final=function(l){var c,i;return l&&(c=this.update(l)),i=this.type==="encrypt"?this._finalEncrypt():this._finalDecrypt(),c?c.concat(i):i},s.prototype._pad=function(l,c){if(c===0)return!1;for(;c<l.length;)l[c++]=0;return!0},s.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var l=new Array(this.blockSize);return this._update(this.buffer,0,l,0),l},s.prototype._unpad=function(l){return l},s.prototype._finalDecrypt=function(){o.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var l=new Array(this.blockSize);return this._flushBuffer(l,0),this._unpad(l)}},{"minimalistic-assert":453}],397:[function(e,n,a){var o=e("minimalistic-assert"),s=e("inherits"),l=e("./utils"),c=e("./cipher");function i(){this.tmp=new Array(2),this.keys=null}function u(f){c.call(this,f);var h=new i;this._desState=h,this.deriveKeys(h,f.key)}s(u,c),n.exports=u,u.create=function(f){return new u(f)};var p=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];u.prototype.deriveKeys=function(f,h){f.keys=new Array(32),o.equal(h.length,this.blockSize,"Invalid key length");var v=l.readUInt32BE(h,0),b=l.readUInt32BE(h,4);l.pc1(v,b,f.tmp,0),v=f.tmp[0],b=f.tmp[1];for(var g=0;g<f.keys.length;g+=2){var x=p[g>>>1];v=l.r28shl(v,x),b=l.r28shl(b,x),l.pc2(v,b,f.keys,g)}},u.prototype._update=function(f,h,v,b){var g=this._desState,x=l.readUInt32BE(f,h),y=l.readUInt32BE(f,h+4);l.ip(x,y,g.tmp,0),x=g.tmp[0],y=g.tmp[1],this.type==="encrypt"?this._encrypt(g,x,y,g.tmp,0):this._decrypt(g,x,y,g.tmp,0),x=g.tmp[0],y=g.tmp[1],l.writeUInt32BE(v,x,b),l.writeUInt32BE(v,y,b+4)},u.prototype._pad=function(f,h){if(this.padding===!1)return!1;for(var v=f.length-h,b=h;b<f.length;b++)f[b]=v;return!0},u.prototype._unpad=function(f){if(this.padding===!1)return f;for(var h=f[f.length-1],v=f.length-h;v<f.length;v++)o.equal(f[v],h);return f.slice(0,f.length-h)},u.prototype._encrypt=function(f,h,v,b,g){for(var x=h,y=v,E=0;E<f.keys.length;E+=2){var N=f.keys[E],I=f.keys[E+1];l.expand(y,f.tmp,0),N^=f.tmp[0],I^=f.tmp[1];var L=l.substitute(N,I),H=y;y=(x^l.permute(L))>>>0,x=H}l.rip(y,x,b,g)},u.prototype._decrypt=function(f,h,v,b,g){for(var x=v,y=h,E=f.keys.length-2;E>=0;E-=2){var N=f.keys[E],I=f.keys[E+1];l.expand(x,f.tmp,0),N^=f.tmp[0],I^=f.tmp[1];var L=l.substitute(N,I),H=x;x=(y^l.permute(L))>>>0,y=H}l.rip(x,y,b,g)}},{"./cipher":396,"./utils":399,inherits:440,"minimalistic-assert":453}],398:[function(e,n,a){var o=e("minimalistic-assert"),s=e("inherits"),l=e("./cipher"),c=e("./des");function i(p,f){o.equal(f.length,24,"Invalid key length");var h=f.slice(0,8),v=f.slice(8,16),b=f.slice(16,24);this.ciphers=p==="encrypt"?[c.create({type:"encrypt",key:h}),c.create({type:"decrypt",key:v}),c.create({type:"encrypt",key:b})]:[c.create({type:"decrypt",key:b}),c.create({type:"encrypt",key:v}),c.create({type:"decrypt",key:h})]}function u(p){l.call(this,p);var f=new i(this.type,this.options.key);this._edeState=f}s(u,l),n.exports=u,u.create=function(p){return new u(p)},u.prototype._update=function(p,f,h,v){var b=this._edeState;b.ciphers[0]._update(p,f,h,v),b.ciphers[1]._update(h,v,h,v),b.ciphers[2]._update(h,v,h,v)},u.prototype._pad=c.prototype._pad,u.prototype._unpad=c.prototype._unpad},{"./cipher":396,"./des":397,inherits:440,"minimalistic-assert":453}],399:[function(e,n,a){a.readUInt32BE=function(c,i){return(c[0+i]<<24|c[1+i]<<16|c[2+i]<<8|c[3+i])>>>0},a.writeUInt32BE=function(c,i,u){c[0+u]=i>>>24,c[1+u]=i>>>16&255,c[2+u]=i>>>8&255,c[3+u]=255&i},a.ip=function(c,i,u,p){for(var f=0,h=0,v=6;v>=0;v-=2){for(var b=0;b<=24;b+=8)f<<=1,f|=i>>>b+v&1;for(b=0;b<=24;b+=8)f<<=1,f|=c>>>b+v&1}for(v=6;v>=0;v-=2){for(b=1;b<=25;b+=8)h<<=1,h|=i>>>b+v&1;for(b=1;b<=25;b+=8)h<<=1,h|=c>>>b+v&1}u[p+0]=f>>>0,u[p+1]=h>>>0},a.rip=function(c,i,u,p){for(var f=0,h=0,v=0;v<4;v++)for(var b=24;b>=0;b-=8)f<<=1,f|=i>>>b+v&1,f<<=1,f|=c>>>b+v&1;for(v=4;v<8;v++)for(b=24;b>=0;b-=8)h<<=1,h|=i>>>b+v&1,h<<=1,h|=c>>>b+v&1;u[p+0]=f>>>0,u[p+1]=h>>>0},a.pc1=function(c,i,u,p){for(var f=0,h=0,v=7;v>=5;v--){for(var b=0;b<=24;b+=8)f<<=1,f|=i>>b+v&1;for(b=0;b<=24;b+=8)f<<=1,f|=c>>b+v&1}for(b=0;b<=24;b+=8)f<<=1,f|=i>>b+v&1;for(v=1;v<=3;v++){for(b=0;b<=24;b+=8)h<<=1,h|=i>>b+v&1;for(b=0;b<=24;b+=8)h<<=1,h|=c>>b+v&1}for(b=0;b<=24;b+=8)h<<=1,h|=c>>b+v&1;u[p+0]=f>>>0,u[p+1]=h>>>0},a.r28shl=function(c,i){return c<<i&268435455|c>>>28-i};var o=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];a.pc2=function(c,i,u,p){for(var f=0,h=0,v=o.length>>>1,b=0;b<v;b++)f<<=1,f|=c>>>o[b]&1;for(b=v;b<o.length;b++)h<<=1,h|=i>>>o[b]&1;u[p+0]=f>>>0,u[p+1]=h>>>0},a.expand=function(c,i,u){var p=0,f=0;p=(1&c)<<5|c>>>27;for(var h=23;h>=15;h-=4)p<<=6,p|=c>>>h&63;for(h=11;h>=3;h-=4)f|=c>>>h&63,f<<=6;f|=(31&c)<<1|c>>>31,i[u+0]=p>>>0,i[u+1]=f>>>0};var s=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];a.substitute=function(c,i){for(var u=0,p=0;p<4;p++)u<<=4,u|=s[64*p+(c>>>18-6*p&63)];for(p=0;p<4;p++)u<<=4,u|=s[256+64*p+(i>>>18-6*p&63)];return u>>>0};var l=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];a.permute=function(c){for(var i=0,u=0;u<l.length;u++)i<<=1,i|=c>>>l[u]&1;return i>>>0},a.padSplit=function(c,i,u){for(var p=c.toString(2);p.length<i;)p="0"+p;for(var f=[],h=0;h<i;h+=u)f.push(p.slice(h,h+u));return f.join(" ")}},{}],400:[function(e,n,a){(function(o){(function(){var s=e("./lib/generatePrime"),l=e("./lib/primes.json"),c=e("./lib/dh"),i={binary:!0,hex:!0,base64:!0};a.DiffieHellmanGroup=a.createDiffieHellmanGroup=a.getDiffieHellman=function(u){var p=new o(l[u].prime,"hex"),f=new o(l[u].gen,"hex");return new c(p,f)},a.createDiffieHellman=a.DiffieHellman=function u(p,f,h,v){return o.isBuffer(f)||i[f]===void 0?u(p,"binary",f,h):(f=f||"binary",v=v||"binary",h=h||new o([2]),o.isBuffer(h)||(h=new o(h,v)),typeof p=="number"?new c(s(p,h),h,!0):(o.isBuffer(p)||(p=new o(p,f)),new c(p,h,!0)))}}).call(this)}).call(this,e("buffer").Buffer)},{"./lib/dh":401,"./lib/generatePrime":402,"./lib/primes.json":403,buffer:220}],401:[function(e,n,a){(function(o){(function(){var s=e("bn.js"),l=new(e("miller-rabin")),c=new s(24),i=new s(11),u=new s(10),p=new s(3),f=new s(7),h=e("./generatePrime"),v=e("randombytes");function b(N,I){return I=I||"utf8",o.isBuffer(N)||(N=new o(N,I)),this._pub=new s(N),this}function g(N,I){return I=I||"utf8",o.isBuffer(N)||(N=new o(N,I)),this._priv=new s(N),this}n.exports=y;var x={};function y(N,I,L){this.setGenerator(I),this.__prime=new s(N),this._prime=s.mont(this.__prime),this._primeLen=N.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,L?(this.setPublicKey=b,this.setPrivateKey=g):this._primeCode=8}function E(N,I){var L=new o(N.toArray());return I?L.toString(I):L}Object.defineProperty(y.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=function(N,I){var L=I.toString("hex"),H=[L,N.toString(16)].join("_");if(H in x)return x[H];var V,q=0;if(N.isEven()||!h.simpleSieve||!h.fermatTest(N)||!l.test(N))return q+=1,q+=L==="02"||L==="05"?8:4,x[H]=q,q;switch(l.test(N.shrn(1))||(q+=2),L){case"02":N.mod(c).cmp(i)&&(q+=8);break;case"05":(V=N.mod(u)).cmp(p)&&V.cmp(f)&&(q+=8);break;default:q+=4}return x[H]=q,q}(this.__prime,this.__gen)),this._primeCode}}),y.prototype.generateKeys=function(){return this._priv||(this._priv=new s(v(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},y.prototype.computeSecret=function(N){var I=(N=(N=new s(N)).toRed(this._prime)).redPow(this._priv).fromRed(),L=new o(I.toArray()),H=this.getPrime();if(L.length<H.length){var V=new o(H.length-L.length);V.fill(0),L=o.concat([V,L])}return L},y.prototype.getPublicKey=function(N){return E(this._pub,N)},y.prototype.getPrivateKey=function(N){return E(this._priv,N)},y.prototype.getPrime=function(N){return E(this.__prime,N)},y.prototype.getGenerator=function(N){return E(this._gen,N)},y.prototype.setGenerator=function(N,I){return I=I||"utf8",o.isBuffer(N)||(N=new o(N,I)),this.__gen=N,this._gen=new s(N),this}}).call(this)}).call(this,e("buffer").Buffer)},{"./generatePrime":402,"bn.js":404,buffer:220,"miller-rabin":451,randombytes:475}],402:[function(e,n,a){var o=e("randombytes");n.exports=N,N.simpleSieve=y,N.fermatTest=E;var s=e("bn.js"),l=new s(24),c=new(e("miller-rabin")),i=new s(1),u=new s(2),p=new s(5),f=(new s(16),new s(8),new s(10)),h=new s(3),v=(new s(7),new s(11)),b=new s(4),g=(new s(12),null);function x(){if(g!==null)return g;var I=[];I[0]=2;for(var L=1,H=3;H<1048576;H+=2){for(var V=Math.ceil(Math.sqrt(H)),q=0;q<L&&I[q]<=V&&H%I[q]!=0;q++);L!==q&&I[q]<=V||(I[L++]=H)}return g=I,I}function y(I){for(var L=x(),H=0;H<L.length;H++)if(I.modn(L[H])===0)return I.cmpn(L[H])===0;return!0}function E(I){var L=s.mont(I);return u.toRed(L).redPow(I.subn(1)).fromRed().cmpn(1)===0}function N(I,L){if(I<16)return new s(L===2||L===5?[140,123]:[140,39]);var H,V;for(L=new s(L);;){for(H=new s(o(Math.ceil(I/8)));H.bitLength()>I;)H.ishrn(1);if(H.isEven()&&H.iadd(i),H.testn(1)||H.iadd(u),L.cmp(u)){if(!L.cmp(p))for(;H.mod(f).cmp(h);)H.iadd(b)}else for(;H.mod(l).cmp(v);)H.iadd(b);if(y(V=H.shrn(1))&&y(H)&&E(V)&&E(H)&&c.test(V)&&c.test(H))return H}}},{"bn.js":404,"miller-rabin":451,randombytes:475}],403:[function(e,n,a){n.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],404:[function(e,n,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],405:[function(e,n,a){var o=a;o.version=e("../package.json").version,o.utils=e("./elliptic/utils"),o.rand=e("brorand"),o.curve=e("./elliptic/curve"),o.curves=e("./elliptic/curves"),o.ec=e("./elliptic/ec"),o.eddsa=e("./elliptic/eddsa")},{"../package.json":421,"./elliptic/curve":408,"./elliptic/curves":411,"./elliptic/ec":412,"./elliptic/eddsa":415,"./elliptic/utils":419,brorand:187}],406:[function(e,n,a){var o=e("bn.js"),s=e("../utils"),l=s.getNAF,c=s.getJSF,i=s.assert;function u(f,h){this.type=f,this.p=new o(h.p,16),this.red=h.prime?o.red(h.prime):o.mont(this.p),this.zero=new o(0).toRed(this.red),this.one=new o(1).toRed(this.red),this.two=new o(2).toRed(this.red),this.n=h.n&&new o(h.n,16),this.g=h.g&&this.pointFromJSON(h.g,h.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var v=this.n&&this.p.div(this.n);!v||v.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function p(f,h){this.curve=f,this.type=h,this.precomputed=null}n.exports=u,u.prototype.point=function(){throw new Error("Not implemented")},u.prototype.validate=function(){throw new Error("Not implemented")},u.prototype._fixedNafMul=function(f,h){i(f.precomputed);var v=f._getDoubles(),b=l(h,1,this._bitLength),g=(1<<v.step+1)-(v.step%2==0?2:1);g/=3;var x,y,E=[];for(x=0;x<b.length;x+=v.step){y=0;for(var N=x+v.step-1;N>=x;N--)y=(y<<1)+b[N];E.push(y)}for(var I=this.jpoint(null,null,null),L=this.jpoint(null,null,null),H=g;H>0;H--){for(x=0;x<E.length;x++)(y=E[x])===H?L=L.mixedAdd(v.points[x]):y===-H&&(L=L.mixedAdd(v.points[x].neg()));I=I.add(L)}return I.toP()},u.prototype._wnafMul=function(f,h){var v=4,b=f._getNAFPoints(v);v=b.wnd;for(var g=b.points,x=l(h,v,this._bitLength),y=this.jpoint(null,null,null),E=x.length-1;E>=0;E--){for(var N=0;E>=0&&x[E]===0;E--)N++;if(E>=0&&N++,y=y.dblp(N),E<0)break;var I=x[E];i(I!==0),y=f.type==="affine"?I>0?y.mixedAdd(g[I-1>>1]):y.mixedAdd(g[-I-1>>1].neg()):I>0?y.add(g[I-1>>1]):y.add(g[-I-1>>1].neg())}return f.type==="affine"?y.toP():y},u.prototype._wnafMulAdd=function(f,h,v,b,g){var x,y,E,N=this._wnafT1,I=this._wnafT2,L=this._wnafT3,H=0;for(x=0;x<b;x++){var V=(E=h[x])._getNAFPoints(f);N[x]=V.wnd,I[x]=V.points}for(x=b-1;x>=1;x-=2){var q=x-1,K=x;if(N[q]===1&&N[K]===1){var z=[h[q],null,null,h[K]];h[q].y.cmp(h[K].y)===0?(z[1]=h[q].add(h[K]),z[2]=h[q].toJ().mixedAdd(h[K].neg())):h[q].y.cmp(h[K].y.redNeg())===0?(z[1]=h[q].toJ().mixedAdd(h[K]),z[2]=h[q].add(h[K].neg())):(z[1]=h[q].toJ().mixedAdd(h[K]),z[2]=h[q].toJ().mixedAdd(h[K].neg()));var W=[-3,-1,-5,-7,0,7,5,1,3],D=c(v[q],v[K]);for(H=Math.max(D[0].length,H),L[q]=new Array(H),L[K]=new Array(H),y=0;y<H;y++){var M=0|D[0][y],C=0|D[1][y];L[q][y]=W[3*(M+1)+(C+1)],L[K][y]=0,I[q]=z}}else L[q]=l(v[q],N[q],this._bitLength),L[K]=l(v[K],N[K],this._bitLength),H=Math.max(L[q].length,H),H=Math.max(L[K].length,H)}var w=this.jpoint(null,null,null),T=this._wnafT4;for(x=H;x>=0;x--){for(var A=0;x>=0;){var S=!0;for(y=0;y<b;y++)T[y]=0|L[y][x],T[y]!==0&&(S=!1);if(!S)break;A++,x--}if(x>=0&&A++,w=w.dblp(A),x<0)break;for(y=0;y<b;y++){var j=T[y];j!==0&&(j>0?E=I[y][j-1>>1]:j<0&&(E=I[y][-j-1>>1].neg()),w=E.type==="affine"?w.mixedAdd(E):w.add(E))}}for(x=0;x<b;x++)I[x]=null;return g?w:w.toP()},u.BasePoint=p,p.prototype.eq=function(){throw new Error("Not implemented")},p.prototype.validate=function(){return this.curve.validate(this)},u.prototype.decodePoint=function(f,h){f=s.toArray(f,h);var v=this.p.byteLength();if((f[0]===4||f[0]===6||f[0]===7)&&f.length-1==2*v)return f[0]===6?i(f[f.length-1]%2==0):f[0]===7&&i(f[f.length-1]%2==1),this.point(f.slice(1,1+v),f.slice(1+v,1+2*v));if((f[0]===2||f[0]===3)&&f.length-1===v)return this.pointFromX(f.slice(1,1+v),f[0]===3);throw new Error("Unknown point format")},p.prototype.encodeCompressed=function(f){return this.encode(f,!0)},p.prototype._encode=function(f){var h=this.curve.p.byteLength(),v=this.getX().toArray("be",h);return f?[this.getY().isEven()?2:3].concat(v):[4].concat(v,this.getY().toArray("be",h))},p.prototype.encode=function(f,h){return s.encode(this._encode(h),f)},p.prototype.precompute=function(f){if(this.precomputed)return this;var h={doubles:null,naf:null,beta:null};return h.naf=this._getNAFPoints(8),h.doubles=this._getDoubles(4,f),h.beta=this._getBeta(),this.precomputed=h,this},p.prototype._hasDoubles=function(f){if(!this.precomputed)return!1;var h=this.precomputed.doubles;return!!h&&h.points.length>=Math.ceil((f.bitLength()+1)/h.step)},p.prototype._getDoubles=function(f,h){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var v=[this],b=this,g=0;g<h;g+=f){for(var x=0;x<f;x++)b=b.dbl();v.push(b)}return{step:f,points:v}},p.prototype._getNAFPoints=function(f){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var h=[this],v=(1<<f)-1,b=v===1?null:this.dbl(),g=1;g<v;g++)h[g]=h[g-1].add(b);return{wnd:f,points:h}},p.prototype._getBeta=function(){return null},p.prototype.dblp=function(f){for(var h=this,v=0;v<f;v++)h=h.dbl();return h}},{"../utils":419,"bn.js":420}],407:[function(e,n,a){var o=e("../utils"),s=e("bn.js"),l=e("inherits"),c=e("./base"),i=o.assert;function u(f){this.twisted=(0|f.a)!=1,this.mOneA=this.twisted&&(0|f.a)==-1,this.extended=this.mOneA,c.call(this,"edwards",f),this.a=new s(f.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new s(f.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new s(f.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),i(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(0|f.c)==1}function p(f,h,v,b,g){c.BasePoint.call(this,f,"projective"),h===null&&v===null&&b===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new s(h,16),this.y=new s(v,16),this.z=b?new s(b,16):this.curve.one,this.t=g&&new s(g,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}l(u,c),n.exports=u,u.prototype._mulA=function(f){return this.mOneA?f.redNeg():this.a.redMul(f)},u.prototype._mulC=function(f){return this.oneC?f:this.c.redMul(f)},u.prototype.jpoint=function(f,h,v,b){return this.point(f,h,v,b)},u.prototype.pointFromX=function(f,h){(f=new s(f,16)).red||(f=f.toRed(this.red));var v=f.redSqr(),b=this.c2.redSub(this.a.redMul(v)),g=this.one.redSub(this.c2.redMul(this.d).redMul(v)),x=b.redMul(g.redInvm()),y=x.redSqrt();if(y.redSqr().redSub(x).cmp(this.zero)!==0)throw new Error("invalid point");var E=y.fromRed().isOdd();return(h&&!E||!h&&E)&&(y=y.redNeg()),this.point(f,y)},u.prototype.pointFromY=function(f,h){(f=new s(f,16)).red||(f=f.toRed(this.red));var v=f.redSqr(),b=v.redSub(this.c2),g=v.redMul(this.d).redMul(this.c2).redSub(this.a),x=b.redMul(g.redInvm());if(x.cmp(this.zero)===0){if(h)throw new Error("invalid point");return this.point(this.zero,f)}var y=x.redSqrt();if(y.redSqr().redSub(x).cmp(this.zero)!==0)throw new Error("invalid point");return y.fromRed().isOdd()!==h&&(y=y.redNeg()),this.point(y,f)},u.prototype.validate=function(f){if(f.isInfinity())return!0;f.normalize();var h=f.x.redSqr(),v=f.y.redSqr(),b=h.redMul(this.a).redAdd(v),g=this.c2.redMul(this.one.redAdd(this.d.redMul(h).redMul(v)));return b.cmp(g)===0},l(p,c.BasePoint),u.prototype.pointFromJSON=function(f){return p.fromJSON(this,f)},u.prototype.point=function(f,h,v,b){return new p(this,f,h,v,b)},p.fromJSON=function(f,h){return new p(f,h[0],h[1],h[2])},p.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},p.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},p.prototype._extDbl=function(){var f=this.x.redSqr(),h=this.y.redSqr(),v=this.z.redSqr();v=v.redIAdd(v);var b=this.curve._mulA(f),g=this.x.redAdd(this.y).redSqr().redISub(f).redISub(h),x=b.redAdd(h),y=x.redSub(v),E=b.redSub(h),N=g.redMul(y),I=x.redMul(E),L=g.redMul(E),H=y.redMul(x);return this.curve.point(N,I,H,L)},p.prototype._projDbl=function(){var f,h,v,b,g,x,y=this.x.redAdd(this.y).redSqr(),E=this.x.redSqr(),N=this.y.redSqr();if(this.curve.twisted){var I=(b=this.curve._mulA(E)).redAdd(N);this.zOne?(f=y.redSub(E).redSub(N).redMul(I.redSub(this.curve.two)),h=I.redMul(b.redSub(N)),v=I.redSqr().redSub(I).redSub(I)):(g=this.z.redSqr(),x=I.redSub(g).redISub(g),f=y.redSub(E).redISub(N).redMul(x),h=I.redMul(b.redSub(N)),v=I.redMul(x))}else b=E.redAdd(N),g=this.curve._mulC(this.z).redSqr(),x=b.redSub(g).redSub(g),f=this.curve._mulC(y.redISub(b)).redMul(x),h=this.curve._mulC(b).redMul(E.redISub(N)),v=b.redMul(x);return this.curve.point(f,h,v)},p.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},p.prototype._extAdd=function(f){var h=this.y.redSub(this.x).redMul(f.y.redSub(f.x)),v=this.y.redAdd(this.x).redMul(f.y.redAdd(f.x)),b=this.t.redMul(this.curve.dd).redMul(f.t),g=this.z.redMul(f.z.redAdd(f.z)),x=v.redSub(h),y=g.redSub(b),E=g.redAdd(b),N=v.redAdd(h),I=x.redMul(y),L=E.redMul(N),H=x.redMul(N),V=y.redMul(E);return this.curve.point(I,L,V,H)},p.prototype._projAdd=function(f){var h,v,b=this.z.redMul(f.z),g=b.redSqr(),x=this.x.redMul(f.x),y=this.y.redMul(f.y),E=this.curve.d.redMul(x).redMul(y),N=g.redSub(E),I=g.redAdd(E),L=this.x.redAdd(this.y).redMul(f.x.redAdd(f.y)).redISub(x).redISub(y),H=b.redMul(N).redMul(L);return this.curve.twisted?(h=b.redMul(I).redMul(y.redSub(this.curve._mulA(x))),v=N.redMul(I)):(h=b.redMul(I).redMul(y.redSub(x)),v=this.curve._mulC(N).redMul(I)),this.curve.point(H,h,v)},p.prototype.add=function(f){return this.isInfinity()?f:f.isInfinity()?this:this.curve.extended?this._extAdd(f):this._projAdd(f)},p.prototype.mul=function(f){return this._hasDoubles(f)?this.curve._fixedNafMul(this,f):this.curve._wnafMul(this,f)},p.prototype.mulAdd=function(f,h,v){return this.curve._wnafMulAdd(1,[this,h],[f,v],2,!1)},p.prototype.jmulAdd=function(f,h,v){return this.curve._wnafMulAdd(1,[this,h],[f,v],2,!0)},p.prototype.normalize=function(){if(this.zOne)return this;var f=this.z.redInvm();return this.x=this.x.redMul(f),this.y=this.y.redMul(f),this.t&&(this.t=this.t.redMul(f)),this.z=this.curve.one,this.zOne=!0,this},p.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},p.prototype.getX=function(){return this.normalize(),this.x.fromRed()},p.prototype.getY=function(){return this.normalize(),this.y.fromRed()},p.prototype.eq=function(f){return this===f||this.getX().cmp(f.getX())===0&&this.getY().cmp(f.getY())===0},p.prototype.eqXToP=function(f){var h=f.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(h)===0)return!0;for(var v=f.clone(),b=this.curve.redN.redMul(this.z);;){if(v.iadd(this.curve.n),v.cmp(this.curve.p)>=0)return!1;if(h.redIAdd(b),this.x.cmp(h)===0)return!0}},p.prototype.toP=p.prototype.normalize,p.prototype.mixedAdd=p.prototype.add},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],408:[function(e,n,a){var o=a;o.base=e("./base"),o.short=e("./short"),o.mont=e("./mont"),o.edwards=e("./edwards")},{"./base":406,"./edwards":407,"./mont":409,"./short":410}],409:[function(e,n,a){var o=e("bn.js"),s=e("inherits"),l=e("./base"),c=e("../utils");function i(p){l.call(this,"mont",p),this.a=new o(p.a,16).toRed(this.red),this.b=new o(p.b,16).toRed(this.red),this.i4=new o(4).toRed(this.red).redInvm(),this.two=new o(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function u(p,f,h){l.BasePoint.call(this,p,"projective"),f===null&&h===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new o(f,16),this.z=new o(h,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}s(i,l),n.exports=i,i.prototype.validate=function(p){var f=p.normalize().x,h=f.redSqr(),v=h.redMul(f).redAdd(h.redMul(this.a)).redAdd(f);return v.redSqrt().redSqr().cmp(v)===0},s(u,l.BasePoint),i.prototype.decodePoint=function(p,f){return this.point(c.toArray(p,f),1)},i.prototype.point=function(p,f){return new u(this,p,f)},i.prototype.pointFromJSON=function(p){return u.fromJSON(this,p)},u.prototype.precompute=function(){},u.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},u.fromJSON=function(p,f){return new u(p,f[0],f[1]||p.one)},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return this.z.cmpn(0)===0},u.prototype.dbl=function(){var p=this.x.redAdd(this.z).redSqr(),f=this.x.redSub(this.z).redSqr(),h=p.redSub(f),v=p.redMul(f),b=h.redMul(f.redAdd(this.curve.a24.redMul(h)));return this.curve.point(v,b)},u.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.diffAdd=function(p,f){var h=this.x.redAdd(this.z),v=this.x.redSub(this.z),b=p.x.redAdd(p.z),g=p.x.redSub(p.z).redMul(h),x=b.redMul(v),y=f.z.redMul(g.redAdd(x).redSqr()),E=f.x.redMul(g.redISub(x).redSqr());return this.curve.point(y,E)},u.prototype.mul=function(p){for(var f=p.clone(),h=this,v=this.curve.point(null,null),b=[];f.cmpn(0)!==0;f.iushrn(1))b.push(f.andln(1));for(var g=b.length-1;g>=0;g--)b[g]===0?(h=h.diffAdd(v,this),v=v.dbl()):(v=h.diffAdd(v,this),h=h.dbl());return v},u.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.eq=function(p){return this.getX().cmp(p.getX())===0},u.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},u.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],410:[function(e,n,a){var o=e("../utils"),s=e("bn.js"),l=e("inherits"),c=e("./base"),i=o.assert;function u(h){c.call(this,"short",h),this.a=new s(h.a,16).toRed(this.red),this.b=new s(h.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(h),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function p(h,v,b,g){c.BasePoint.call(this,h,"affine"),v===null&&b===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new s(v,16),this.y=new s(b,16),g&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function f(h,v,b,g){c.BasePoint.call(this,h,"jacobian"),v===null&&b===null&&g===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new s(0)):(this.x=new s(v,16),this.y=new s(b,16),this.z=new s(g,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}l(u,c),n.exports=u,u.prototype._getEndomorphism=function(h){if(this.zeroA&&this.g&&this.n&&this.p.modn(3)===1){var v,b;if(h.beta)v=new s(h.beta,16).toRed(this.red);else{var g=this._getEndoRoots(this.p);v=(v=g[0].cmp(g[1])<0?g[0]:g[1]).toRed(this.red)}if(h.lambda)b=new s(h.lambda,16);else{var x=this._getEndoRoots(this.n);this.g.mul(x[0]).x.cmp(this.g.x.redMul(v))===0?b=x[0]:(b=x[1],i(this.g.mul(b).x.cmp(this.g.x.redMul(v))===0))}return{beta:v,lambda:b,basis:h.basis?h.basis.map(function(y){return{a:new s(y.a,16),b:new s(y.b,16)}}):this._getEndoBasis(b)}}},u.prototype._getEndoRoots=function(h){var v=h===this.p?this.red:s.mont(h),b=new s(2).toRed(v).redInvm(),g=b.redNeg(),x=new s(3).toRed(v).redNeg().redSqrt().redMul(b);return[g.redAdd(x).fromRed(),g.redSub(x).fromRed()]},u.prototype._getEndoBasis=function(h){for(var v,b,g,x,y,E,N,I,L,H=this.n.ushrn(Math.floor(this.n.bitLength()/2)),V=h,q=this.n.clone(),K=new s(1),z=new s(0),W=new s(0),D=new s(1),M=0;V.cmpn(0)!==0;){var C=q.div(V);I=q.sub(C.mul(V)),L=W.sub(C.mul(K));var w=D.sub(C.mul(z));if(!g&&I.cmp(H)<0)v=N.neg(),b=K,g=I.neg(),x=L;else if(g&&++M==2)break;N=I,q=V,V=I,W=K,K=L,D=z,z=w}y=I.neg(),E=L;var T=g.sqr().add(x.sqr());return y.sqr().add(E.sqr()).cmp(T)>=0&&(y=v,E=b),g.negative&&(g=g.neg(),x=x.neg()),y.negative&&(y=y.neg(),E=E.neg()),[{a:g,b:x},{a:y,b:E}]},u.prototype._endoSplit=function(h){var v=this.endo.basis,b=v[0],g=v[1],x=g.b.mul(h).divRound(this.n),y=b.b.neg().mul(h).divRound(this.n),E=x.mul(b.a),N=y.mul(g.a),I=x.mul(b.b),L=y.mul(g.b);return{k1:h.sub(E).sub(N),k2:I.add(L).neg()}},u.prototype.pointFromX=function(h,v){(h=new s(h,16)).red||(h=h.toRed(this.red));var b=h.redSqr().redMul(h).redIAdd(h.redMul(this.a)).redIAdd(this.b),g=b.redSqrt();if(g.redSqr().redSub(b).cmp(this.zero)!==0)throw new Error("invalid point");var x=g.fromRed().isOdd();return(v&&!x||!v&&x)&&(g=g.redNeg()),this.point(h,g)},u.prototype.validate=function(h){if(h.inf)return!0;var v=h.x,b=h.y,g=this.a.redMul(v),x=v.redSqr().redMul(v).redIAdd(g).redIAdd(this.b);return b.redSqr().redISub(x).cmpn(0)===0},u.prototype._endoWnafMulAdd=function(h,v,b){for(var g=this._endoWnafT1,x=this._endoWnafT2,y=0;y<h.length;y++){var E=this._endoSplit(v[y]),N=h[y],I=N._getBeta();E.k1.negative&&(E.k1.ineg(),N=N.neg(!0)),E.k2.negative&&(E.k2.ineg(),I=I.neg(!0)),g[2*y]=N,g[2*y+1]=I,x[2*y]=E.k1,x[2*y+1]=E.k2}for(var L=this._wnafMulAdd(1,g,x,2*y,b),H=0;H<2*y;H++)g[H]=null,x[H]=null;return L},l(p,c.BasePoint),u.prototype.point=function(h,v,b){return new p(this,h,v,b)},u.prototype.pointFromJSON=function(h,v){return p.fromJSON(this,h,v)},p.prototype._getBeta=function(){if(this.curve.endo){var h=this.precomputed;if(h&&h.beta)return h.beta;var v=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(h){var b=this.curve,g=function(x){return b.point(x.x.redMul(b.endo.beta),x.y)};h.beta=v,v.precomputed={beta:null,naf:h.naf&&{wnd:h.naf.wnd,points:h.naf.points.map(g)},doubles:h.doubles&&{step:h.doubles.step,points:h.doubles.points.map(g)}}}return v}},p.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},p.fromJSON=function(h,v,b){typeof v=="string"&&(v=JSON.parse(v));var g=h.point(v[0],v[1],b);if(!v[2])return g;function x(E){return h.point(E[0],E[1],b)}var y=v[2];return g.precomputed={beta:null,doubles:y.doubles&&{step:y.doubles.step,points:[g].concat(y.doubles.points.map(x))},naf:y.naf&&{wnd:y.naf.wnd,points:[g].concat(y.naf.points.map(x))}},g},p.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},p.prototype.isInfinity=function(){return this.inf},p.prototype.add=function(h){if(this.inf)return h;if(h.inf)return this;if(this.eq(h))return this.dbl();if(this.neg().eq(h))return this.curve.point(null,null);if(this.x.cmp(h.x)===0)return this.curve.point(null,null);var v=this.y.redSub(h.y);v.cmpn(0)!==0&&(v=v.redMul(this.x.redSub(h.x).redInvm()));var b=v.redSqr().redISub(this.x).redISub(h.x),g=v.redMul(this.x.redSub(b)).redISub(this.y);return this.curve.point(b,g)},p.prototype.dbl=function(){if(this.inf)return this;var h=this.y.redAdd(this.y);if(h.cmpn(0)===0)return this.curve.point(null,null);var v=this.curve.a,b=this.x.redSqr(),g=h.redInvm(),x=b.redAdd(b).redIAdd(b).redIAdd(v).redMul(g),y=x.redSqr().redISub(this.x.redAdd(this.x)),E=x.redMul(this.x.redSub(y)).redISub(this.y);return this.curve.point(y,E)},p.prototype.getX=function(){return this.x.fromRed()},p.prototype.getY=function(){return this.y.fromRed()},p.prototype.mul=function(h){return h=new s(h,16),this.isInfinity()?this:this._hasDoubles(h)?this.curve._fixedNafMul(this,h):this.curve.endo?this.curve._endoWnafMulAdd([this],[h]):this.curve._wnafMul(this,h)},p.prototype.mulAdd=function(h,v,b){var g=[this,v],x=[h,b];return this.curve.endo?this.curve._endoWnafMulAdd(g,x):this.curve._wnafMulAdd(1,g,x,2)},p.prototype.jmulAdd=function(h,v,b){var g=[this,v],x=[h,b];return this.curve.endo?this.curve._endoWnafMulAdd(g,x,!0):this.curve._wnafMulAdd(1,g,x,2,!0)},p.prototype.eq=function(h){return this===h||this.inf===h.inf&&(this.inf||this.x.cmp(h.x)===0&&this.y.cmp(h.y)===0)},p.prototype.neg=function(h){if(this.inf)return this;var v=this.curve.point(this.x,this.y.redNeg());if(h&&this.precomputed){var b=this.precomputed,g=function(x){return x.neg()};v.precomputed={naf:b.naf&&{wnd:b.naf.wnd,points:b.naf.points.map(g)},doubles:b.doubles&&{step:b.doubles.step,points:b.doubles.points.map(g)}}}return v},p.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},l(f,c.BasePoint),u.prototype.jpoint=function(h,v,b){return new f(this,h,v,b)},f.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var h=this.z.redInvm(),v=h.redSqr(),b=this.x.redMul(v),g=this.y.redMul(v).redMul(h);return this.curve.point(b,g)},f.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},f.prototype.add=function(h){if(this.isInfinity())return h;if(h.isInfinity())return this;var v=h.z.redSqr(),b=this.z.redSqr(),g=this.x.redMul(v),x=h.x.redMul(b),y=this.y.redMul(v.redMul(h.z)),E=h.y.redMul(b.redMul(this.z)),N=g.redSub(x),I=y.redSub(E);if(N.cmpn(0)===0)return I.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var L=N.redSqr(),H=L.redMul(N),V=g.redMul(L),q=I.redSqr().redIAdd(H).redISub(V).redISub(V),K=I.redMul(V.redISub(q)).redISub(y.redMul(H)),z=this.z.redMul(h.z).redMul(N);return this.curve.jpoint(q,K,z)},f.prototype.mixedAdd=function(h){if(this.isInfinity())return h.toJ();if(h.isInfinity())return this;var v=this.z.redSqr(),b=this.x,g=h.x.redMul(v),x=this.y,y=h.y.redMul(v).redMul(this.z),E=b.redSub(g),N=x.redSub(y);if(E.cmpn(0)===0)return N.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var I=E.redSqr(),L=I.redMul(E),H=b.redMul(I),V=N.redSqr().redIAdd(L).redISub(H).redISub(H),q=N.redMul(H.redISub(V)).redISub(x.redMul(L)),K=this.z.redMul(E);return this.curve.jpoint(V,q,K)},f.prototype.dblp=function(h){if(h===0)return this;if(this.isInfinity())return this;if(!h)return this.dbl();var v;if(this.curve.zeroA||this.curve.threeA){var b=this;for(v=0;v<h;v++)b=b.dbl();return b}var g=this.curve.a,x=this.curve.tinv,y=this.x,E=this.y,N=this.z,I=N.redSqr().redSqr(),L=E.redAdd(E);for(v=0;v<h;v++){var H=y.redSqr(),V=L.redSqr(),q=V.redSqr(),K=H.redAdd(H).redIAdd(H).redIAdd(g.redMul(I)),z=y.redMul(V),W=K.redSqr().redISub(z.redAdd(z)),D=z.redISub(W),M=K.redMul(D);M=M.redIAdd(M).redISub(q);var C=L.redMul(N);v+1<h&&(I=I.redMul(q)),y=W,N=C,L=M}return this.curve.jpoint(y,L.redMul(x),N)},f.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},f.prototype._zeroDbl=function(){var h,v,b;if(this.zOne){var g=this.x.redSqr(),x=this.y.redSqr(),y=x.redSqr(),E=this.x.redAdd(x).redSqr().redISub(g).redISub(y);E=E.redIAdd(E);var N=g.redAdd(g).redIAdd(g),I=N.redSqr().redISub(E).redISub(E),L=y.redIAdd(y);L=(L=L.redIAdd(L)).redIAdd(L),h=I,v=N.redMul(E.redISub(I)).redISub(L),b=this.y.redAdd(this.y)}else{var H=this.x.redSqr(),V=this.y.redSqr(),q=V.redSqr(),K=this.x.redAdd(V).redSqr().redISub(H).redISub(q);K=K.redIAdd(K);var z=H.redAdd(H).redIAdd(H),W=z.redSqr(),D=q.redIAdd(q);D=(D=D.redIAdd(D)).redIAdd(D),h=W.redISub(K).redISub(K),v=z.redMul(K.redISub(h)).redISub(D),b=(b=this.y.redMul(this.z)).redIAdd(b)}return this.curve.jpoint(h,v,b)},f.prototype._threeDbl=function(){var h,v,b;if(this.zOne){var g=this.x.redSqr(),x=this.y.redSqr(),y=x.redSqr(),E=this.x.redAdd(x).redSqr().redISub(g).redISub(y);E=E.redIAdd(E);var N=g.redAdd(g).redIAdd(g).redIAdd(this.curve.a),I=N.redSqr().redISub(E).redISub(E);h=I;var L=y.redIAdd(y);L=(L=L.redIAdd(L)).redIAdd(L),v=N.redMul(E.redISub(I)).redISub(L),b=this.y.redAdd(this.y)}else{var H=this.z.redSqr(),V=this.y.redSqr(),q=this.x.redMul(V),K=this.x.redSub(H).redMul(this.x.redAdd(H));K=K.redAdd(K).redIAdd(K);var z=q.redIAdd(q),W=(z=z.redIAdd(z)).redAdd(z);h=K.redSqr().redISub(W),b=this.y.redAdd(this.z).redSqr().redISub(V).redISub(H);var D=V.redSqr();D=(D=(D=D.redIAdd(D)).redIAdd(D)).redIAdd(D),v=K.redMul(z.redISub(h)).redISub(D)}return this.curve.jpoint(h,v,b)},f.prototype._dbl=function(){var h=this.curve.a,v=this.x,b=this.y,g=this.z,x=g.redSqr().redSqr(),y=v.redSqr(),E=b.redSqr(),N=y.redAdd(y).redIAdd(y).redIAdd(h.redMul(x)),I=v.redAdd(v),L=(I=I.redIAdd(I)).redMul(E),H=N.redSqr().redISub(L.redAdd(L)),V=L.redISub(H),q=E.redSqr();q=(q=(q=q.redIAdd(q)).redIAdd(q)).redIAdd(q);var K=N.redMul(V).redISub(q),z=b.redAdd(b).redMul(g);return this.curve.jpoint(H,K,z)},f.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var h=this.x.redSqr(),v=this.y.redSqr(),b=this.z.redSqr(),g=v.redSqr(),x=h.redAdd(h).redIAdd(h),y=x.redSqr(),E=this.x.redAdd(v).redSqr().redISub(h).redISub(g),N=(E=(E=(E=E.redIAdd(E)).redAdd(E).redIAdd(E)).redISub(y)).redSqr(),I=g.redIAdd(g);I=(I=(I=I.redIAdd(I)).redIAdd(I)).redIAdd(I);var L=x.redIAdd(E).redSqr().redISub(y).redISub(N).redISub(I),H=v.redMul(L);H=(H=H.redIAdd(H)).redIAdd(H);var V=this.x.redMul(N).redISub(H);V=(V=V.redIAdd(V)).redIAdd(V);var q=this.y.redMul(L.redMul(I.redISub(L)).redISub(E.redMul(N)));q=(q=(q=q.redIAdd(q)).redIAdd(q)).redIAdd(q);var K=this.z.redAdd(E).redSqr().redISub(b).redISub(N);return this.curve.jpoint(V,q,K)},f.prototype.mul=function(h,v){return h=new s(h,v),this.curve._wnafMul(this,h)},f.prototype.eq=function(h){if(h.type==="affine")return this.eq(h.toJ());if(this===h)return!0;var v=this.z.redSqr(),b=h.z.redSqr();if(this.x.redMul(b).redISub(h.x.redMul(v)).cmpn(0)!==0)return!1;var g=v.redMul(this.z),x=b.redMul(h.z);return this.y.redMul(x).redISub(h.y.redMul(g)).cmpn(0)===0},f.prototype.eqXToP=function(h){var v=this.z.redSqr(),b=h.toRed(this.curve.red).redMul(v);if(this.x.cmp(b)===0)return!0;for(var g=h.clone(),x=this.curve.redN.redMul(v);;){if(g.iadd(this.curve.n),g.cmp(this.curve.p)>=0)return!1;if(b.redIAdd(x),this.x.cmp(b)===0)return!0}},f.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},f.prototype.isInfinity=function(){return this.z.cmpn(0)===0}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],411:[function(e,n,a){var o,s=a,l=e("hash.js"),c=e("./curve"),i=e("./utils").assert;function u(f){f.type==="short"?this.curve=new c.short(f):f.type==="edwards"?this.curve=new c.edwards(f):this.curve=new c.mont(f),this.g=this.curve.g,this.n=this.curve.n,this.hash=f.hash,i(this.g.validate(),"Invalid curve"),i(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function p(f,h){Object.defineProperty(s,f,{configurable:!0,enumerable:!0,get:function(){var v=new u(h);return Object.defineProperty(s,f,{configurable:!0,enumerable:!0,value:v}),v}})}s.PresetCurve=u,p("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:l.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),p("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:l.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),p("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:l.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),p("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:l.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),p("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:l.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),p("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:l.sha256,gRed:!1,g:["9"]}),p("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:l.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{o=e("./precomputed/secp256k1")}catch{o=void 0}p("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:l.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",o]})},{"./curve":408,"./precomputed/secp256k1":418,"./utils":419,"hash.js":426}],412:[function(e,n,a){var o=e("bn.js"),s=e("hmac-drbg"),l=e("../utils"),c=e("../curves"),i=e("brorand"),u=l.assert,p=e("./key"),f=e("./signature");function h(v){if(!(this instanceof h))return new h(v);typeof v=="string"&&(u(Object.prototype.hasOwnProperty.call(c,v),"Unknown curve "+v),v=c[v]),v instanceof c.PresetCurve&&(v={curve:v}),this.curve=v.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=v.curve.g,this.g.precompute(v.curve.n.bitLength()+1),this.hash=v.hash||v.curve.hash}n.exports=h,h.prototype.keyPair=function(v){return new p(this,v)},h.prototype.keyFromPrivate=function(v,b){return p.fromPrivate(this,v,b)},h.prototype.keyFromPublic=function(v,b){return p.fromPublic(this,v,b)},h.prototype.genKeyPair=function(v){v||(v={});for(var b=new s({hash:this.hash,pers:v.pers,persEnc:v.persEnc||"utf8",entropy:v.entropy||i(this.hash.hmacStrength),entropyEnc:v.entropy&&v.entropyEnc||"utf8",nonce:this.n.toArray()}),g=this.n.byteLength(),x=this.n.sub(new o(2));;){var y=new o(b.generate(g));if(!(y.cmp(x)>0))return y.iaddn(1),this.keyFromPrivate(y)}},h.prototype._truncateToN=function(v,b){var g=8*v.byteLength()-this.n.bitLength();return g>0&&(v=v.ushrn(g)),!b&&v.cmp(this.n)>=0?v.sub(this.n):v},h.prototype.sign=function(v,b,g,x){typeof g=="object"&&(x=g,g=null),x||(x={}),b=this.keyFromPrivate(b,g),v=this._truncateToN(new o(v,16));for(var y=this.n.byteLength(),E=b.getPrivate().toArray("be",y),N=v.toArray("be",y),I=new s({hash:this.hash,entropy:E,nonce:N,pers:x.pers,persEnc:x.persEnc||"utf8"}),L=this.n.sub(new o(1)),H=0;;H++){var V=x.k?x.k(H):new o(I.generate(this.n.byteLength()));if(!((V=this._truncateToN(V,!0)).cmpn(1)<=0||V.cmp(L)>=0)){var q=this.g.mul(V);if(!q.isInfinity()){var K=q.getX(),z=K.umod(this.n);if(z.cmpn(0)!==0){var W=V.invm(this.n).mul(z.mul(b.getPrivate()).iadd(v));if((W=W.umod(this.n)).cmpn(0)!==0){var D=(q.getY().isOdd()?1:0)|(K.cmp(z)!==0?2:0);return x.canonical&&W.cmp(this.nh)>0&&(W=this.n.sub(W),D^=1),new f({r:z,s:W,recoveryParam:D})}}}}}},h.prototype.verify=function(v,b,g,x){v=this._truncateToN(new o(v,16)),g=this.keyFromPublic(g,x);var y=(b=new f(b,"hex")).r,E=b.s;if(y.cmpn(1)<0||y.cmp(this.n)>=0||E.cmpn(1)<0||E.cmp(this.n)>=0)return!1;var N,I=E.invm(this.n),L=I.mul(v).umod(this.n),H=I.mul(y).umod(this.n);return this.curve._maxwellTrick?!(N=this.g.jmulAdd(L,g.getPublic(),H)).isInfinity()&&N.eqXToP(y):!(N=this.g.mulAdd(L,g.getPublic(),H)).isInfinity()&&N.getX().umod(this.n).cmp(y)===0},h.prototype.recoverPubKey=function(v,b,g,x){u((3&g)===g,"The recovery param is more than two bits"),b=new f(b,x);var y=this.n,E=new o(v),N=b.r,I=b.s,L=1&g,H=g>>1;if(N.cmp(this.curve.p.umod(this.curve.n))>=0&&H)throw new Error("Unable to find sencond key candinate");N=H?this.curve.pointFromX(N.add(this.curve.n),L):this.curve.pointFromX(N,L);var V=b.r.invm(y),q=y.sub(E).mul(V).umod(y),K=I.mul(V).umod(y);return this.g.mulAdd(q,N,K)},h.prototype.getKeyRecoveryParam=function(v,b,g,x){if((b=new f(b,x)).recoveryParam!==null)return b.recoveryParam;for(var y=0;y<4;y++){var E;try{E=this.recoverPubKey(v,b,y)}catch{continue}if(E.eq(g))return y}throw new Error("Unable to find valid recovery factor")}},{"../curves":411,"../utils":419,"./key":413,"./signature":414,"bn.js":420,brorand:187,"hmac-drbg":438}],413:[function(e,n,a){var o=e("bn.js"),s=e("../utils").assert;function l(c,i){this.ec=c,this.priv=null,this.pub=null,i.priv&&this._importPrivate(i.priv,i.privEnc),i.pub&&this._importPublic(i.pub,i.pubEnc)}n.exports=l,l.fromPublic=function(c,i,u){return i instanceof l?i:new l(c,{pub:i,pubEnc:u})},l.fromPrivate=function(c,i,u){return i instanceof l?i:new l(c,{priv:i,privEnc:u})},l.prototype.validate=function(){var c=this.getPublic();return c.isInfinity()?{result:!1,reason:"Invalid public key"}:c.validate()?c.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},l.prototype.getPublic=function(c,i){return typeof c=="string"&&(i=c,c=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),i?this.pub.encode(i,c):this.pub},l.prototype.getPrivate=function(c){return c==="hex"?this.priv.toString(16,2):this.priv},l.prototype._importPrivate=function(c,i){this.priv=new o(c,i||16),this.priv=this.priv.umod(this.ec.curve.n)},l.prototype._importPublic=function(c,i){if(c.x||c.y)return this.ec.curve.type==="mont"?s(c.x,"Need x coordinate"):this.ec.curve.type!=="short"&&this.ec.curve.type!=="edwards"||s(c.x&&c.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(c.x,c.y));this.pub=this.ec.curve.decodePoint(c,i)},l.prototype.derive=function(c){return c.validate()||s(c.validate(),"public point not validated"),c.mul(this.priv).getX()},l.prototype.sign=function(c,i,u){return this.ec.sign(c,this,i,u)},l.prototype.verify=function(c,i){return this.ec.verify(c,i,this)},l.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":419,"bn.js":420}],414:[function(e,n,a){var o=e("bn.js"),s=e("../utils"),l=s.assert;function c(h,v){if(h instanceof c)return h;this._importDER(h,v)||(l(h.r&&h.s,"Signature without r or s"),this.r=new o(h.r,16),this.s=new o(h.s,16),h.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=h.recoveryParam)}function i(){this.place=0}function u(h,v){var b=h[v.place++];if(!(128&b))return b;var g=15&b;if(g===0||g>4)return!1;for(var x=0,y=0,E=v.place;y<g;y++,E++)x<<=8,x|=h[E],x>>>=0;return!(x<=127)&&(v.place=E,x)}function p(h){for(var v=0,b=h.length-1;!h[v]&&!(128&h[v+1])&&v<b;)v++;return v===0?h:h.slice(v)}function f(h,v){if(v<128)h.push(v);else{var b=1+(Math.log(v)/Math.LN2>>>3);for(h.push(128|b);--b;)h.push(v>>>(b<<3)&255);h.push(v)}}n.exports=c,c.prototype._importDER=function(h,v){h=s.toArray(h,v);var b=new i;if(h[b.place++]!==48)return!1;var g=u(h,b);if(g===!1||g+b.place!==h.length||h[b.place++]!==2)return!1;var x=u(h,b);if(x===!1)return!1;var y=h.slice(b.place,x+b.place);if(b.place+=x,h[b.place++]!==2)return!1;var E=u(h,b);if(E===!1||h.length!==E+b.place)return!1;var N=h.slice(b.place,E+b.place);if(y[0]===0){if(!(128&y[1]))return!1;y=y.slice(1)}if(N[0]===0){if(!(128&N[1]))return!1;N=N.slice(1)}return this.r=new o(y),this.s=new o(N),this.recoveryParam=null,!0},c.prototype.toDER=function(h){var v=this.r.toArray(),b=this.s.toArray();for(128&v[0]&&(v=[0].concat(v)),128&b[0]&&(b=[0].concat(b)),v=p(v),b=p(b);!(b[0]||128&b[1]);)b=b.slice(1);var g=[2];f(g,v.length),(g=g.concat(v)).push(2),f(g,b.length);var x=g.concat(b),y=[48];return f(y,x.length),y=y.concat(x),s.encode(y,h)}},{"../utils":419,"bn.js":420}],415:[function(e,n,a){var o=e("hash.js"),s=e("../curves"),l=e("../utils"),c=l.assert,i=l.parseBytes,u=e("./key"),p=e("./signature");function f(h){if(c(h==="ed25519","only tested with ed25519 so far"),!(this instanceof f))return new f(h);h=s[h].curve,this.curve=h,this.g=h.g,this.g.precompute(h.n.bitLength()+1),this.pointClass=h.point().constructor,this.encodingLength=Math.ceil(h.n.bitLength()/8),this.hash=o.sha512}n.exports=f,f.prototype.sign=function(h,v){h=i(h);var b=this.keyFromSecret(v),g=this.hashInt(b.messagePrefix(),h),x=this.g.mul(g),y=this.encodePoint(x),E=this.hashInt(y,b.pubBytes(),h).mul(b.priv()),N=g.add(E).umod(this.curve.n);return this.makeSignature({R:x,S:N,Rencoded:y})},f.prototype.verify=function(h,v,b){h=i(h),v=this.makeSignature(v);var g=this.keyFromPublic(b),x=this.hashInt(v.Rencoded(),g.pubBytes(),h),y=this.g.mul(v.S());return v.R().add(g.pub().mul(x)).eq(y)},f.prototype.hashInt=function(){for(var h=this.hash(),v=0;v<arguments.length;v++)h.update(arguments[v]);return l.intFromLE(h.digest()).umod(this.curve.n)},f.prototype.keyFromPublic=function(h){return u.fromPublic(this,h)},f.prototype.keyFromSecret=function(h){return u.fromSecret(this,h)},f.prototype.makeSignature=function(h){return h instanceof p?h:new p(this,h)},f.prototype.encodePoint=function(h){var v=h.getY().toArray("le",this.encodingLength);return v[this.encodingLength-1]|=h.getX().isOdd()?128:0,v},f.prototype.decodePoint=function(h){var v=(h=l.parseBytes(h)).length-1,b=h.slice(0,v).concat(-129&h[v]),g=(128&h[v])!=0,x=l.intFromLE(b);return this.curve.pointFromY(x,g)},f.prototype.encodeInt=function(h){return h.toArray("le",this.encodingLength)},f.prototype.decodeInt=function(h){return l.intFromLE(h)},f.prototype.isPoint=function(h){return h instanceof this.pointClass}},{"../curves":411,"../utils":419,"./key":416,"./signature":417,"hash.js":426}],416:[function(e,n,a){var o=e("../utils"),s=o.assert,l=o.parseBytes,c=o.cachedProperty;function i(u,p){this.eddsa=u,this._secret=l(p.secret),u.isPoint(p.pub)?this._pub=p.pub:this._pubBytes=l(p.pub)}i.fromPublic=function(u,p){return p instanceof i?p:new i(u,{pub:p})},i.fromSecret=function(u,p){return p instanceof i?p:new i(u,{secret:p})},i.prototype.secret=function(){return this._secret},c(i,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),c(i,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),c(i,"privBytes",function(){var u=this.eddsa,p=this.hash(),f=u.encodingLength-1,h=p.slice(0,u.encodingLength);return h[0]&=248,h[f]&=127,h[f]|=64,h}),c(i,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),c(i,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),c(i,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),i.prototype.sign=function(u){return s(this._secret,"KeyPair can only verify"),this.eddsa.sign(u,this)},i.prototype.verify=function(u,p){return this.eddsa.verify(u,p,this)},i.prototype.getSecret=function(u){return s(this._secret,"KeyPair is public only"),o.encode(this.secret(),u)},i.prototype.getPublic=function(u){return o.encode(this.pubBytes(),u)},n.exports=i},{"../utils":419}],417:[function(e,n,a){var o=e("bn.js"),s=e("../utils"),l=s.assert,c=s.cachedProperty,i=s.parseBytes;function u(p,f){this.eddsa=p,typeof f!="object"&&(f=i(f)),Array.isArray(f)&&(f={R:f.slice(0,p.encodingLength),S:f.slice(p.encodingLength)}),l(f.R&&f.S,"Signature without R or S"),p.isPoint(f.R)&&(this._R=f.R),f.S instanceof o&&(this._S=f.S),this._Rencoded=Array.isArray(f.R)?f.R:f.Rencoded,this._Sencoded=Array.isArray(f.S)?f.S:f.Sencoded}c(u,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),c(u,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),c(u,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),c(u,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),u.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},u.prototype.toHex=function(){return s.encode(this.toBytes(),"hex").toUpperCase()},n.exports=u},{"../utils":419,"bn.js":420}],418:[function(e,n,a){n.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],419:[function(e,n,a){var o=a,s=e("bn.js"),l=e("minimalistic-assert"),c=e("minimalistic-crypto-utils");o.assert=l,o.toArray=c.toArray,o.zero2=c.zero2,o.toHex=c.toHex,o.encode=c.encode,o.getNAF=function(i,u,p){var f=new Array(Math.max(i.bitLength(),p)+1);f.fill(0);for(var h=1<<u+1,v=i.clone(),b=0;b<f.length;b++){var g,x=v.andln(h-1);v.isOdd()?(g=x>(h>>1)-1?(h>>1)-x:x,v.isubn(g)):g=0,f[b]=g,v.iushrn(1)}return f},o.getJSF=function(i,u){var p=[[],[]];i=i.clone(),u=u.clone();for(var f,h=0,v=0;i.cmpn(-h)>0||u.cmpn(-v)>0;){var b,g,x=i.andln(3)+h&3,y=u.andln(3)+v&3;x===3&&(x=-1),y===3&&(y=-1),b=(1&x)==0?0:(f=i.andln(7)+h&7)!==3&&f!==5||y!==2?x:-x,p[0].push(b),g=(1&y)==0?0:(f=u.andln(7)+v&7)!==3&&f!==5||x!==2?y:-y,p[1].push(g),2*h===b+1&&(h=1-h),2*v===g+1&&(v=1-v),i.iushrn(1),u.iushrn(1)}return p},o.cachedProperty=function(i,u,p){var f="_"+u;i.prototype[u]=function(){return this[f]!==void 0?this[f]:this[f]=p.call(this)}},o.parseBytes=function(i){return typeof i=="string"?o.toArray(i,"hex"):i},o.intFromLE=function(i){return new s(i,"hex","le")}},{"bn.js":420,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],420:[function(e,n,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],421:[function(e,n,a){n.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}],422:[function(e,n,a){var o=Object.create||function(V){var q=function(){};return q.prototype=V,new q},s=Object.keys||function(V){var q=[];for(var K in V)Object.prototype.hasOwnProperty.call(V,K)&&q.push(K);return K},l=Function.prototype.bind||function(V){var q=this;return function(){return q.apply(V,arguments)}};function c(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=o(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}n.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0;var i,u=10;try{var p={};Object.defineProperty&&Object.defineProperty(p,"x",{value:0}),i=p.x===0}catch{i=!1}function f(V){return V._maxListeners===void 0?c.defaultMaxListeners:V._maxListeners}function h(V,q,K){if(q)V.call(K);else for(var z=V.length,W=H(V,z),D=0;D<z;++D)W[D].call(K)}function v(V,q,K,z){if(q)V.call(K,z);else for(var W=V.length,D=H(V,W),M=0;M<W;++M)D[M].call(K,z)}function b(V,q,K,z,W){if(q)V.call(K,z,W);else for(var D=V.length,M=H(V,D),C=0;C<D;++C)M[C].call(K,z,W)}function g(V,q,K,z,W,D){if(q)V.call(K,z,W,D);else for(var M=V.length,C=H(V,M),w=0;w<M;++w)C[w].call(K,z,W,D)}function x(V,q,K,z){if(q)V.apply(K,z);else for(var W=V.length,D=H(V,W),M=0;M<W;++M)D[M].apply(K,z)}function y(V,q,K,z){var W,D,M;if(typeof K!="function")throw new TypeError('"listener" argument must be a function');if((D=V._events)?(D.newListener&&(V.emit("newListener",q,K.listener?K.listener:K),D=V._events),M=D[q]):(D=V._events=o(null),V._eventsCount=0),M){if(typeof M=="function"?M=D[q]=z?[K,M]:[M,K]:z?M.unshift(K):M.push(K),!M.warned&&(W=f(V))&&W>0&&M.length>W){M.warned=!0;var C=new Error("Possible EventEmitter memory leak detected. "+M.length+' "'+String(q)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');C.name="MaxListenersExceededWarning",C.emitter=V,C.type=q,C.count=M.length,typeof console=="object"&&console.warn&&console.warn("%s: %s",C.name,C.message)}}else M=D[q]=K,++V._eventsCount;return V}function E(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var V=new Array(arguments.length),q=0;q<V.length;++q)V[q]=arguments[q];this.listener.apply(this.target,V)}}function N(V,q,K){var z={fired:!1,wrapFn:void 0,target:V,type:q,listener:K},W=l.call(E,z);return W.listener=K,z.wrapFn=W,W}function I(V,q,K){var z=V._events;if(!z)return[];var W=z[q];return W?typeof W=="function"?K?[W.listener||W]:[W]:K?function(D){for(var M=new Array(D.length),C=0;C<M.length;++C)M[C]=D[C].listener||D[C];return M}(W):H(W,W.length):[]}function L(V){var q=this._events;if(q){var K=q[V];if(typeof K=="function")return 1;if(K)return K.length}return 0}function H(V,q){for(var K=new Array(q),z=0;z<q;++z)K[z]=V[z];return K}i?Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(V){if(typeof V!="number"||V<0||V!=V)throw new TypeError('"defaultMaxListeners" must be a positive number');u=V}}):c.defaultMaxListeners=u,c.prototype.setMaxListeners=function(V){if(typeof V!="number"||V<0||isNaN(V))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=V,this},c.prototype.getMaxListeners=function(){return f(this)},c.prototype.emit=function(V){var q,K,z,W,D,M,C=V==="error";if(M=this._events)C=C&&M.error==null;else if(!C)return!1;if(C){if(arguments.length>1&&(q=arguments[1]),q instanceof Error)throw q;var w=new Error('Unhandled "error" event. ('+q+")");throw w.context=q,w}if(!(K=M[V]))return!1;var T=typeof K=="function";switch(z=arguments.length){case 1:h(K,T,this);break;case 2:v(K,T,this,arguments[1]);break;case 3:b(K,T,this,arguments[1],arguments[2]);break;case 4:g(K,T,this,arguments[1],arguments[2],arguments[3]);break;default:for(W=new Array(z-1),D=1;D<z;D++)W[D-1]=arguments[D];x(K,T,this,W)}return!0},c.prototype.addListener=function(V,q){return y(this,V,q,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(V,q){return y(this,V,q,!0)},c.prototype.once=function(V,q){if(typeof q!="function")throw new TypeError('"listener" argument must be a function');return this.on(V,N(this,V,q)),this},c.prototype.prependOnceListener=function(V,q){if(typeof q!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(V,N(this,V,q)),this},c.prototype.removeListener=function(V,q){var K,z,W,D,M;if(typeof q!="function")throw new TypeError('"listener" argument must be a function');if(!(z=this._events))return this;if(!(K=z[V]))return this;if(K===q||K.listener===q)--this._eventsCount==0?this._events=o(null):(delete z[V],z.removeListener&&this.emit("removeListener",V,K.listener||q));else if(typeof K!="function"){for(W=-1,D=K.length-1;D>=0;D--)if(K[D]===q||K[D].listener===q){M=K[D].listener,W=D;break}if(W<0)return this;W===0?K.shift():function(C,w){for(var T=w,A=T+1,S=C.length;A<S;T+=1,A+=1)C[T]=C[A];C.pop()}(K,W),K.length===1&&(z[V]=K[0]),z.removeListener&&this.emit("removeListener",V,M||q)}return this},c.prototype.removeAllListeners=function(V){var q,K,z;if(!(K=this._events))return this;if(!K.removeListener)return arguments.length===0?(this._events=o(null),this._eventsCount=0):K[V]&&(--this._eventsCount==0?this._events=o(null):delete K[V]),this;if(arguments.length===0){var W,D=s(K);for(z=0;z<D.length;++z)(W=D[z])!=="removeListener"&&this.removeAllListeners(W);return this.removeAllListeners("removeListener"),this._events=o(null),this._eventsCount=0,this}if(typeof(q=K[V])=="function")this.removeListener(V,q);else if(q)for(z=q.length-1;z>=0;z--)this.removeListener(V,q[z]);return this},c.prototype.listeners=function(V){return I(this,V,!0)},c.prototype.rawListeners=function(V){return I(this,V,!1)},c.listenerCount=function(V,q){return typeof V.listenerCount=="function"?V.listenerCount(q):L.call(V,q)},c.prototype.listenerCount=L,c.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],423:[function(e,n,a){var o=e("safe-buffer").Buffer,s=e("md5.js");n.exports=function(l,c,i,u){if(o.isBuffer(l)||(l=o.from(l,"binary")),c&&(o.isBuffer(c)||(c=o.from(c,"binary")),c.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var p=i/8,f=o.alloc(p),h=o.alloc(u||0),v=o.alloc(0);p>0||u>0;){var b=new s;b.update(v),b.update(l),c&&b.update(c),v=b.digest();var g=0;if(p>0){var x=f.length-p;g=Math.min(p,v.length),v.copy(f,x,0,g),p-=g}if(g<v.length&&u>0){var y=h.length-u,E=Math.min(u,v.length-g);v.copy(h,y,g,g+E),u-=E}}return v.fill(0),{key:f,iv:h}}},{"md5.js":450,"safe-buffer":494}],424:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.CsvParserStream=a.ParserOptions=a.parseFile=a.parseStream=a.parseString=a.parse=a.FormatterOptions=a.CsvFormatterStream=a.writeToPath=a.writeToString=a.writeToBuffer=a.writeToStream=a.write=a.format=void 0;var o=e("@fast-csv/format");Object.defineProperty(a,"format",{enumerable:!0,get:function(){return o.format}}),Object.defineProperty(a,"write",{enumerable:!0,get:function(){return o.write}}),Object.defineProperty(a,"writeToStream",{enumerable:!0,get:function(){return o.writeToStream}}),Object.defineProperty(a,"writeToBuffer",{enumerable:!0,get:function(){return o.writeToBuffer}}),Object.defineProperty(a,"writeToString",{enumerable:!0,get:function(){return o.writeToString}}),Object.defineProperty(a,"writeToPath",{enumerable:!0,get:function(){return o.writeToPath}}),Object.defineProperty(a,"CsvFormatterStream",{enumerable:!0,get:function(){return o.CsvFormatterStream}}),Object.defineProperty(a,"FormatterOptions",{enumerable:!0,get:function(){return o.FormatterOptions}});var s=e("@fast-csv/parse");Object.defineProperty(a,"parse",{enumerable:!0,get:function(){return s.parse}}),Object.defineProperty(a,"parseString",{enumerable:!0,get:function(){return s.parseString}}),Object.defineProperty(a,"parseStream",{enumerable:!0,get:function(){return s.parseStream}}),Object.defineProperty(a,"parseFile",{enumerable:!0,get:function(){return s.parseFile}}),Object.defineProperty(a,"ParserOptions",{enumerable:!0,get:function(){return s.ParserOptions}}),Object.defineProperty(a,"CsvParserStream",{enumerable:!0,get:function(){return s.CsvParserStream}})},{"@fast-csv/format":151,"@fast-csv/parse":155}],425:[function(e,n,a){var o=e("safe-buffer").Buffer,s=e("readable-stream").Transform;function l(c){s.call(this),this._block=o.allocUnsafe(c),this._blockSize=c,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}e("inherits")(l,s),l.prototype._transform=function(c,i,u){var p=null;try{this.update(c,i)}catch(f){p=f}u(p)},l.prototype._flush=function(c){var i=null;try{this.push(this.digest())}catch(u){i=u}c(i)},l.prototype.update=function(c,i){if(function(b,g){if(!o.isBuffer(b)&&typeof b!="string")throw new TypeError(g+" must be a string or a buffer")}(c,"Data"),this._finalized)throw new Error("Digest already called");o.isBuffer(c)||(c=o.from(c,i));for(var u=this._block,p=0;this._blockOffset+c.length-p>=this._blockSize;){for(var f=this._blockOffset;f<this._blockSize;)u[f++]=c[p++];this._update(),this._blockOffset=0}for(;p<c.length;)u[this._blockOffset++]=c[p++];for(var h=0,v=8*c.length;v>0;++h)this._length[h]+=v,(v=this._length[h]/4294967296|0)>0&&(this._length[h]-=4294967296*v);return this},l.prototype._update=function(){throw new Error("_update is not implemented")},l.prototype.digest=function(c){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var i=this._digest();c!==void 0&&(i=i.toString(c)),this._block.fill(0),this._blockOffset=0;for(var u=0;u<4;++u)this._length[u]=0;return i},l.prototype._digest=function(){throw new Error("_digest is not implemented")},n.exports=l},{inherits:440,"readable-stream":491,"safe-buffer":494}],426:[function(e,n,a){var o=a;o.utils=e("./hash/utils"),o.common=e("./hash/common"),o.sha=e("./hash/sha"),o.ripemd=e("./hash/ripemd"),o.hmac=e("./hash/hmac"),o.sha1=o.sha.sha1,o.sha256=o.sha.sha256,o.sha224=o.sha.sha224,o.sha384=o.sha.sha384,o.sha512=o.sha.sha512,o.ripemd160=o.ripemd.ripemd160},{"./hash/common":427,"./hash/hmac":428,"./hash/ripemd":429,"./hash/sha":430,"./hash/utils":437}],427:[function(e,n,a){var o=e("./utils"),s=e("minimalistic-assert");function l(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}a.BlockHash=l,l.prototype.update=function(c,i){if(c=o.toArray(c,i),this.pending?this.pending=this.pending.concat(c):this.pending=c,this.pendingTotal+=c.length,this.pending.length>=this._delta8){var u=(c=this.pending).length%this._delta8;this.pending=c.slice(c.length-u,c.length),this.pending.length===0&&(this.pending=null),c=o.join32(c,0,c.length-u,this.endian);for(var p=0;p<c.length;p+=this._delta32)this._update(c,p,p+this._delta32)}return this},l.prototype.digest=function(c){return this.update(this._pad()),s(this.pending===null),this._digest(c)},l.prototype._pad=function(){var c=this.pendingTotal,i=this._delta8,u=i-(c+this.padLength)%i,p=new Array(u+this.padLength);p[0]=128;for(var f=1;f<u;f++)p[f]=0;if(c<<=3,this.endian==="big"){for(var h=8;h<this.padLength;h++)p[f++]=0;p[f++]=0,p[f++]=0,p[f++]=0,p[f++]=0,p[f++]=c>>>24&255,p[f++]=c>>>16&255,p[f++]=c>>>8&255,p[f++]=255&c}else for(p[f++]=255&c,p[f++]=c>>>8&255,p[f++]=c>>>16&255,p[f++]=c>>>24&255,p[f++]=0,p[f++]=0,p[f++]=0,p[f++]=0,h=8;h<this.padLength;h++)p[f++]=0;return p}},{"./utils":437,"minimalistic-assert":453}],428:[function(e,n,a){var o=e("./utils"),s=e("minimalistic-assert");function l(c,i,u){if(!(this instanceof l))return new l(c,i,u);this.Hash=c,this.blockSize=c.blockSize/8,this.outSize=c.outSize/8,this.inner=null,this.outer=null,this._init(o.toArray(i,u))}n.exports=l,l.prototype._init=function(c){c.length>this.blockSize&&(c=new this.Hash().update(c).digest()),s(c.length<=this.blockSize);for(var i=c.length;i<this.blockSize;i++)c.push(0);for(i=0;i<c.length;i++)c[i]^=54;for(this.inner=new this.Hash().update(c),i=0;i<c.length;i++)c[i]^=106;this.outer=new this.Hash().update(c)},l.prototype.update=function(c,i){return this.inner.update(c,i),this},l.prototype.digest=function(c){return this.outer.update(this.inner.digest()),this.outer.digest(c)}},{"./utils":437,"minimalistic-assert":453}],429:[function(e,n,a){var o=e("./utils"),s=e("./common"),l=o.rotl32,c=o.sum32,i=o.sum32_3,u=o.sum32_4,p=s.BlockHash;function f(){if(!(this instanceof f))return new f;p.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function h(N,I,L,H){return N<=15?I^L^H:N<=31?I&L|~I&H:N<=47?(I|~L)^H:N<=63?I&H|L&~H:I^(L|~H)}function v(N){return N<=15?0:N<=31?1518500249:N<=47?1859775393:N<=63?2400959708:2840853838}function b(N){return N<=15?1352829926:N<=31?1548603684:N<=47?1836072691:N<=63?2053994217:0}o.inherits(f,p),a.ripemd160=f,f.blockSize=512,f.outSize=160,f.hmacStrength=192,f.padLength=64,f.prototype._update=function(N,I){for(var L=this.h[0],H=this.h[1],V=this.h[2],q=this.h[3],K=this.h[4],z=L,W=H,D=V,M=q,C=K,w=0;w<80;w++){var T=c(l(u(L,h(w,H,V,q),N[g[w]+I],v(w)),y[w]),K);L=K,K=q,q=l(V,10),V=H,H=T,T=c(l(u(z,h(79-w,W,D,M),N[x[w]+I],b(w)),E[w]),C),z=C,C=M,M=l(D,10),D=W,W=T}T=i(this.h[1],V,M),this.h[1]=i(this.h[2],q,C),this.h[2]=i(this.h[3],K,z),this.h[3]=i(this.h[4],L,W),this.h[4]=i(this.h[0],H,D),this.h[0]=T},f.prototype._digest=function(N){return N==="hex"?o.toHex32(this.h,"little"):o.split32(this.h,"little")};var g=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],x=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],y=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],E=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":427,"./utils":437}],430:[function(e,n,a){a.sha1=e("./sha/1"),a.sha224=e("./sha/224"),a.sha256=e("./sha/256"),a.sha384=e("./sha/384"),a.sha512=e("./sha/512")},{"./sha/1":431,"./sha/224":432,"./sha/256":433,"./sha/384":434,"./sha/512":435}],431:[function(e,n,a){var o=e("../utils"),s=e("../common"),l=e("./common"),c=o.rotl32,i=o.sum32,u=o.sum32_5,p=l.ft_1,f=s.BlockHash,h=[1518500249,1859775393,2400959708,3395469782];function v(){if(!(this instanceof v))return new v;f.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}o.inherits(v,f),n.exports=v,v.blockSize=512,v.outSize=160,v.hmacStrength=80,v.padLength=64,v.prototype._update=function(b,g){for(var x=this.W,y=0;y<16;y++)x[y]=b[g+y];for(;y<x.length;y++)x[y]=c(x[y-3]^x[y-8]^x[y-14]^x[y-16],1);var E=this.h[0],N=this.h[1],I=this.h[2],L=this.h[3],H=this.h[4];for(y=0;y<x.length;y++){var V=~~(y/20),q=u(c(E,5),p(V,N,I,L),H,x[y],h[V]);H=L,L=I,I=c(N,30),N=E,E=q}this.h[0]=i(this.h[0],E),this.h[1]=i(this.h[1],N),this.h[2]=i(this.h[2],I),this.h[3]=i(this.h[3],L),this.h[4]=i(this.h[4],H)},v.prototype._digest=function(b){return b==="hex"?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436}],432:[function(e,n,a){var o=e("../utils"),s=e("./256");function l(){if(!(this instanceof l))return new l;s.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}o.inherits(l,s),n.exports=l,l.blockSize=512,l.outSize=224,l.hmacStrength=192,l.padLength=64,l.prototype._digest=function(c){return c==="hex"?o.toHex32(this.h.slice(0,7),"big"):o.split32(this.h.slice(0,7),"big")}},{"../utils":437,"./256":433}],433:[function(e,n,a){var o=e("../utils"),s=e("../common"),l=e("./common"),c=e("minimalistic-assert"),i=o.sum32,u=o.sum32_4,p=o.sum32_5,f=l.ch32,h=l.maj32,v=l.s0_256,b=l.s1_256,g=l.g0_256,x=l.g1_256,y=s.BlockHash,E=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function N(){if(!(this instanceof N))return new N;y.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=E,this.W=new Array(64)}o.inherits(N,y),n.exports=N,N.blockSize=512,N.outSize=256,N.hmacStrength=192,N.padLength=64,N.prototype._update=function(I,L){for(var H=this.W,V=0;V<16;V++)H[V]=I[L+V];for(;V<H.length;V++)H[V]=u(x(H[V-2]),H[V-7],g(H[V-15]),H[V-16]);var q=this.h[0],K=this.h[1],z=this.h[2],W=this.h[3],D=this.h[4],M=this.h[5],C=this.h[6],w=this.h[7];for(c(this.k.length===H.length),V=0;V<H.length;V++){var T=p(w,b(D),f(D,M,C),this.k[V],H[V]),A=i(v(q),h(q,K,z));w=C,C=M,M=D,D=i(W,T),W=z,z=K,K=q,q=i(T,A)}this.h[0]=i(this.h[0],q),this.h[1]=i(this.h[1],K),this.h[2]=i(this.h[2],z),this.h[3]=i(this.h[3],W),this.h[4]=i(this.h[4],D),this.h[5]=i(this.h[5],M),this.h[6]=i(this.h[6],C),this.h[7]=i(this.h[7],w)},N.prototype._digest=function(I){return I==="hex"?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436,"minimalistic-assert":453}],434:[function(e,n,a){var o=e("../utils"),s=e("./512");function l(){if(!(this instanceof l))return new l;s.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}o.inherits(l,s),n.exports=l,l.blockSize=1024,l.outSize=384,l.hmacStrength=192,l.padLength=128,l.prototype._digest=function(c){return c==="hex"?o.toHex32(this.h.slice(0,12),"big"):o.split32(this.h.slice(0,12),"big")}},{"../utils":437,"./512":435}],435:[function(e,n,a){var o=e("../utils"),s=e("../common"),l=e("minimalistic-assert"),c=o.rotr64_hi,i=o.rotr64_lo,u=o.shr64_hi,p=o.shr64_lo,f=o.sum64,h=o.sum64_hi,v=o.sum64_lo,b=o.sum64_4_hi,g=o.sum64_4_lo,x=o.sum64_5_hi,y=o.sum64_5_lo,E=s.BlockHash,N=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function I(){if(!(this instanceof I))return new I;E.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=N,this.W=new Array(160)}function L(A,S,j,B,R){var X=A&j^~A&R;return X<0&&(X+=4294967296),X}function H(A,S,j,B,R,X){var Y=S&B^~S&X;return Y<0&&(Y+=4294967296),Y}function V(A,S,j,B,R){var X=A&j^A&R^j&R;return X<0&&(X+=4294967296),X}function q(A,S,j,B,R,X){var Y=S&B^S&X^B&X;return Y<0&&(Y+=4294967296),Y}function K(A,S){var j=c(A,S,28)^c(S,A,2)^c(S,A,7);return j<0&&(j+=4294967296),j}function z(A,S){var j=i(A,S,28)^i(S,A,2)^i(S,A,7);return j<0&&(j+=4294967296),j}function W(A,S){var j=c(A,S,14)^c(A,S,18)^c(S,A,9);return j<0&&(j+=4294967296),j}function D(A,S){var j=i(A,S,14)^i(A,S,18)^i(S,A,9);return j<0&&(j+=4294967296),j}function M(A,S){var j=c(A,S,1)^c(A,S,8)^u(A,S,7);return j<0&&(j+=4294967296),j}function C(A,S){var j=i(A,S,1)^i(A,S,8)^p(A,S,7);return j<0&&(j+=4294967296),j}function w(A,S){var j=c(A,S,19)^c(S,A,29)^u(A,S,6);return j<0&&(j+=4294967296),j}function T(A,S){var j=i(A,S,19)^i(S,A,29)^p(A,S,6);return j<0&&(j+=4294967296),j}o.inherits(I,E),n.exports=I,I.blockSize=1024,I.outSize=512,I.hmacStrength=192,I.padLength=128,I.prototype._prepareBlock=function(A,S){for(var j=this.W,B=0;B<32;B++)j[B]=A[S+B];for(;B<j.length;B+=2){var R=w(j[B-4],j[B-3]),X=T(j[B-4],j[B-3]),Y=j[B-14],ee=j[B-13],U=M(j[B-30],j[B-29]),Q=C(j[B-30],j[B-29]),P=j[B-32],F=j[B-31];j[B]=b(R,X,Y,ee,U,Q,P,F),j[B+1]=g(R,X,Y,ee,U,Q,P,F)}},I.prototype._update=function(A,S){this._prepareBlock(A,S);var j=this.W,B=this.h[0],R=this.h[1],X=this.h[2],Y=this.h[3],ee=this.h[4],U=this.h[5],Q=this.h[6],P=this.h[7],F=this.h[8],Z=this.h[9],se=this.h[10],re=this.h[11],ae=this.h[12],te=this.h[13],he=this.h[14],le=this.h[15];l(this.k.length===j.length);for(var ne=0;ne<j.length;ne+=2){var de=he,fe=le,Se=W(F,Z),_e=D(F,Z),Ce=L(F,Z,se,re,ae),Re=H(F,Z,se,re,ae,te),Pe=this.k[ne],Ye=this.k[ne+1],at=j[ne],tt=j[ne+1],it=x(de,fe,Se,_e,Ce,Re,Pe,Ye,at,tt),rt=y(de,fe,Se,_e,Ce,Re,Pe,Ye,at,tt);de=K(B,R),fe=z(B,R),Se=V(B,R,X,Y,ee),_e=q(B,R,X,Y,ee,U);var ct=h(de,fe,Se,_e),Oe=v(de,fe,Se,_e);he=ae,le=te,ae=se,te=re,se=F,re=Z,F=h(Q,P,it,rt),Z=v(P,P,it,rt),Q=ee,P=U,ee=X,U=Y,X=B,Y=R,B=h(it,rt,ct,Oe),R=v(it,rt,ct,Oe)}f(this.h,0,B,R),f(this.h,2,X,Y),f(this.h,4,ee,U),f(this.h,6,Q,P),f(this.h,8,F,Z),f(this.h,10,se,re),f(this.h,12,ae,te),f(this.h,14,he,le)},I.prototype._digest=function(A){return A==="hex"?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":427,"../utils":437,"minimalistic-assert":453}],436:[function(e,n,a){var o=e("../utils").rotr32;function s(i,u,p){return i&u^~i&p}function l(i,u,p){return i&u^i&p^u&p}function c(i,u,p){return i^u^p}a.ft_1=function(i,u,p,f){return i===0?s(u,p,f):i===1||i===3?c(u,p,f):i===2?l(u,p,f):void 0},a.ch32=s,a.maj32=l,a.p32=c,a.s0_256=function(i){return o(i,2)^o(i,13)^o(i,22)},a.s1_256=function(i){return o(i,6)^o(i,11)^o(i,25)},a.g0_256=function(i){return o(i,7)^o(i,18)^i>>>3},a.g1_256=function(i){return o(i,17)^o(i,19)^i>>>10}},{"../utils":437}],437:[function(e,n,a){var o=e("minimalistic-assert"),s=e("inherits");function l(p,f){return(64512&p.charCodeAt(f))==55296&&!(f<0||f+1>=p.length)&&(64512&p.charCodeAt(f+1))==56320}function c(p){return(p>>>24|p>>>8&65280|p<<8&16711680|(255&p)<<24)>>>0}function i(p){return p.length===1?"0"+p:p}function u(p){return p.length===7?"0"+p:p.length===6?"00"+p:p.length===5?"000"+p:p.length===4?"0000"+p:p.length===3?"00000"+p:p.length===2?"000000"+p:p.length===1?"0000000"+p:p}a.inherits=s,a.toArray=function(p,f){if(Array.isArray(p))return p.slice();if(!p)return[];var h=[];if(typeof p=="string")if(f){if(f==="hex")for((p=p.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(p="0"+p),b=0;b<p.length;b+=2)h.push(parseInt(p[b]+p[b+1],16))}else for(var v=0,b=0;b<p.length;b++){var g=p.charCodeAt(b);g<128?h[v++]=g:g<2048?(h[v++]=g>>6|192,h[v++]=63&g|128):l(p,b)?(g=65536+((1023&g)<<10)+(1023&p.charCodeAt(++b)),h[v++]=g>>18|240,h[v++]=g>>12&63|128,h[v++]=g>>6&63|128,h[v++]=63&g|128):(h[v++]=g>>12|224,h[v++]=g>>6&63|128,h[v++]=63&g|128)}else for(b=0;b<p.length;b++)h[b]=0|p[b];return h},a.toHex=function(p){for(var f="",h=0;h<p.length;h++)f+=i(p[h].toString(16));return f},a.htonl=c,a.toHex32=function(p,f){for(var h="",v=0;v<p.length;v++){var b=p[v];f==="little"&&(b=c(b)),h+=u(b.toString(16))}return h},a.zero2=i,a.zero8=u,a.join32=function(p,f,h,v){var b=h-f;o(b%4==0);for(var g=new Array(b/4),x=0,y=f;x<g.length;x++,y+=4){var E;E=v==="big"?p[y]<<24|p[y+1]<<16|p[y+2]<<8|p[y+3]:p[y+3]<<24|p[y+2]<<16|p[y+1]<<8|p[y],g[x]=E>>>0}return g},a.split32=function(p,f){for(var h=new Array(4*p.length),v=0,b=0;v<p.length;v++,b+=4){var g=p[v];f==="big"?(h[b]=g>>>24,h[b+1]=g>>>16&255,h[b+2]=g>>>8&255,h[b+3]=255&g):(h[b+3]=g>>>24,h[b+2]=g>>>16&255,h[b+1]=g>>>8&255,h[b]=255&g)}return h},a.rotr32=function(p,f){return p>>>f|p<<32-f},a.rotl32=function(p,f){return p<<f|p>>>32-f},a.sum32=function(p,f){return p+f>>>0},a.sum32_3=function(p,f,h){return p+f+h>>>0},a.sum32_4=function(p,f,h,v){return p+f+h+v>>>0},a.sum32_5=function(p,f,h,v,b){return p+f+h+v+b>>>0},a.sum64=function(p,f,h,v){var b=p[f],g=v+p[f+1]>>>0,x=(g<v?1:0)+h+b;p[f]=x>>>0,p[f+1]=g},a.sum64_hi=function(p,f,h,v){return(f+v>>>0<f?1:0)+p+h>>>0},a.sum64_lo=function(p,f,h,v){return f+v>>>0},a.sum64_4_hi=function(p,f,h,v,b,g,x,y){var E=0,N=f;return E+=(N=N+v>>>0)<f?1:0,E+=(N=N+g>>>0)<g?1:0,p+h+b+x+(E+=(N=N+y>>>0)<y?1:0)>>>0},a.sum64_4_lo=function(p,f,h,v,b,g,x,y){return f+v+g+y>>>0},a.sum64_5_hi=function(p,f,h,v,b,g,x,y,E,N){var I=0,L=f;return I+=(L=L+v>>>0)<f?1:0,I+=(L=L+g>>>0)<g?1:0,I+=(L=L+y>>>0)<y?1:0,p+h+b+x+E+(I+=(L=L+N>>>0)<N?1:0)>>>0},a.sum64_5_lo=function(p,f,h,v,b,g,x,y,E,N){return f+v+g+y+N>>>0},a.rotr64_hi=function(p,f,h){return(f<<32-h|p>>>h)>>>0},a.rotr64_lo=function(p,f,h){return(p<<32-h|f>>>h)>>>0},a.shr64_hi=function(p,f,h){return p>>>h},a.shr64_lo=function(p,f,h){return(p<<32-h|f>>>h)>>>0}},{inherits:440,"minimalistic-assert":453}],438:[function(e,n,a){var o=e("hash.js"),s=e("minimalistic-crypto-utils"),l=e("minimalistic-assert");function c(i){if(!(this instanceof c))return new c(i);this.hash=i.hash,this.predResist=!!i.predResist,this.outLen=this.hash.outSize,this.minEntropy=i.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var u=s.toArray(i.entropy,i.entropyEnc||"hex"),p=s.toArray(i.nonce,i.nonceEnc||"hex"),f=s.toArray(i.pers,i.persEnc||"hex");l(u.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(u,p,f)}n.exports=c,c.prototype._init=function(i,u,p){var f=i.concat(u).concat(p);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var h=0;h<this.V.length;h++)this.K[h]=0,this.V[h]=1;this._update(f),this._reseed=1,this.reseedInterval=281474976710656},c.prototype._hmac=function(){return new o.hmac(this.hash,this.K)},c.prototype._update=function(i){var u=this._hmac().update(this.V).update([0]);i&&(u=u.update(i)),this.K=u.digest(),this.V=this._hmac().update(this.V).digest(),i&&(this.K=this._hmac().update(this.V).update([1]).update(i).digest(),this.V=this._hmac().update(this.V).digest())},c.prototype.reseed=function(i,u,p,f){typeof u!="string"&&(f=p,p=u,u=null),i=s.toArray(i,u),p=s.toArray(p,f),l(i.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(i.concat(p||[])),this._reseed=1},c.prototype.generate=function(i,u,p,f){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof u!="string"&&(f=p,p=u,u=null),p&&(p=s.toArray(p,f||"hex"),this._update(p));for(var h=[];h.length<i;)this.V=this._hmac().update(this.V).digest(),h=h.concat(this.V);var v=h.slice(0,i);return this._update(p),this._reseed++,s.encode(v,u)}},{"hash.js":426,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],439:[function(e,n,a){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */a.read=function(o,s,l,c,i){var u,p,f=8*i-c-1,h=(1<<f)-1,v=h>>1,b=-7,g=l?i-1:0,x=l?-1:1,y=o[s+g];for(g+=x,u=y&(1<<-b)-1,y>>=-b,b+=f;b>0;u=256*u+o[s+g],g+=x,b-=8);for(p=u&(1<<-b)-1,u>>=-b,b+=c;b>0;p=256*p+o[s+g],g+=x,b-=8);if(u===0)u=1-v;else{if(u===h)return p?NaN:1/0*(y?-1:1);p+=Math.pow(2,c),u-=v}return(y?-1:1)*p*Math.pow(2,u-c)},a.write=function(o,s,l,c,i,u){var p,f,h,v=8*u-i-1,b=(1<<v)-1,g=b>>1,x=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=c?0:u-1,E=c?1:-1,N=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(f=isNaN(s)?1:0,p=b):(p=Math.floor(Math.log(s)/Math.LN2),s*(h=Math.pow(2,-p))<1&&(p--,h*=2),(s+=p+g>=1?x/h:x*Math.pow(2,1-g))*h>=2&&(p++,h/=2),p+g>=b?(f=0,p=b):p+g>=1?(f=(s*h-1)*Math.pow(2,i),p+=g):(f=s*Math.pow(2,g-1)*Math.pow(2,i),p=0));i>=8;o[l+y]=255&f,y+=E,f/=256,i-=8);for(p=p<<i|f,v+=i;v>0;o[l+y]=255&p,y+=E,p/=256,v-=8);o[l+y-E]|=128*N}},{}],440:[function(e,n,a){typeof Object.create=="function"?n.exports=function(o,s){s&&(o.super_=s,o.prototype=Object.create(s.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}))}:n.exports=function(o,s){if(s){o.super_=s;var l=function(){};l.prototype=s.prototype,o.prototype=new l,o.prototype.constructor=o}}},{}],441:[function(e,n,a){(function(o,s,l,c,i,u,p,f){(function(){/*!

		JSZip v3.10.1 - A JavaScript class for generating and reading zip files
		<http://stuartk.com/jszip>

		(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
		Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

		JSZip uses the library pako released under the MIT license :
		https://github.com/nodeca/pako/blob/main/LICENSE
		*/(function(h){typeof a=="object"&&n!==void 0?n.exports=h():(typeof window<"u"?window:s!==void 0?s:typeof self<"u"?self:this).JSZip=h()})(function(){return function h(v,b,g){function x(N,I){if(!b[N]){if(!v[N]){var L=typeof e=="function"&&e;if(!I&&L)return L(N,!0);if(y)return y(N,!0);var H=new Error("Cannot find module '"+N+"'");throw H.code="MODULE_NOT_FOUND",H}var V=b[N]={exports:{}};v[N][0].call(V.exports,function(q){return x(v[N][1][q]||q)},V,V.exports,h,v,b,g)}return b[N].exports}for(var y=typeof e=="function"&&e,E=0;E<g.length;E++)x(g[E]);return x}({1:[function(h,v,b){var g=h("./utils"),x=h("./support"),y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";b.encode=function(E){for(var N,I,L,H,V,q,K,z=[],W=0,D=E.length,M=D,C=g.getTypeOf(E)!=="string";W<E.length;)M=D-W,L=C?(N=E[W++],I=W<D?E[W++]:0,W<D?E[W++]:0):(N=E.charCodeAt(W++),I=W<D?E.charCodeAt(W++):0,W<D?E.charCodeAt(W++):0),H=N>>2,V=(3&N)<<4|I>>4,q=1<M?(15&I)<<2|L>>6:64,K=2<M?63&L:64,z.push(y.charAt(H)+y.charAt(V)+y.charAt(q)+y.charAt(K));return z.join("")},b.decode=function(E){var N,I,L,H,V,q,K=0,z=0,W="data:";if(E.substr(0,W.length)===W)throw new Error("Invalid base64 input, it looks like a data url.");var D,M=3*(E=E.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(E.charAt(E.length-1)===y.charAt(64)&&M--,E.charAt(E.length-2)===y.charAt(64)&&M--,M%1!=0)throw new Error("Invalid base64 input, bad content length.");for(D=x.uint8array?new Uint8Array(0|M):new Array(0|M);K<E.length;)N=y.indexOf(E.charAt(K++))<<2|(H=y.indexOf(E.charAt(K++)))>>4,I=(15&H)<<4|(V=y.indexOf(E.charAt(K++)))>>2,L=(3&V)<<6|(q=y.indexOf(E.charAt(K++))),D[z++]=N,V!==64&&(D[z++]=I),q!==64&&(D[z++]=L);return D}},{"./support":30,"./utils":32}],2:[function(h,v,b){var g=h("./external"),x=h("./stream/DataWorker"),y=h("./stream/Crc32Probe"),E=h("./stream/DataLengthProbe");function N(I,L,H,V,q){this.compressedSize=I,this.uncompressedSize=L,this.crc32=H,this.compression=V,this.compressedContent=q}N.prototype={getContentWorker:function(){var I=new x(g.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new E("data_length")),L=this;return I.on("end",function(){if(this.streamInfo.data_length!==L.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),I},getCompressedWorker:function(){return new x(g.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},N.createWorkerFrom=function(I,L,H){return I.pipe(new y).pipe(new E("uncompressedSize")).pipe(L.compressWorker(H)).pipe(new E("compressedSize")).withStreamInfo("compression",L)},v.exports=N},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(h,v,b){var g=h("./stream/GenericWorker");b.STORE={magic:"\0\0",compressWorker:function(){return new g("STORE compression")},uncompressWorker:function(){return new g("STORE decompression")}},b.DEFLATE=h("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(h,v,b){var g=h("./utils"),x=function(){for(var y,E=[],N=0;N<256;N++){y=N;for(var I=0;I<8;I++)y=1&y?3988292384^y>>>1:y>>>1;E[N]=y}return E}();v.exports=function(y,E){return y!==void 0&&y.length?g.getTypeOf(y)!=="string"?function(N,I,L,H){var V=x,q=0+L;N^=-1;for(var K=0;K<q;K++)N=N>>>8^V[255&(N^I[K])];return-1^N}(0|E,y,y.length):function(N,I,L,H){var V=x,q=0+L;N^=-1;for(var K=0;K<q;K++)N=N>>>8^V[255&(N^I.charCodeAt(K))];return-1^N}(0|E,y,y.length):0}},{"./utils":32}],5:[function(h,v,b){b.base64=!1,b.binary=!1,b.dir=!1,b.createFolders=!0,b.date=null,b.compression=null,b.compressionOptions=null,b.comment=null,b.unixPermissions=null,b.dosPermissions=null},{}],6:[function(h,v,b){var g;g=typeof Promise<"u"?Promise:h("lie"),v.exports={Promise:g}},{lie:37}],7:[function(h,v,b){var g=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",x=h("pako"),y=h("./utils"),E=h("./stream/GenericWorker"),N=g?"uint8array":"array";function I(L,H){E.call(this,"FlateWorker/"+L),this._pako=null,this._pakoAction=L,this._pakoOptions=H,this.meta={}}b.magic="\b\0",y.inherits(I,E),I.prototype.processChunk=function(L){this.meta=L.meta,this._pako===null&&this._createPako(),this._pako.push(y.transformTo(N,L.data),!1)},I.prototype.flush=function(){E.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},I.prototype.cleanUp=function(){E.prototype.cleanUp.call(this),this._pako=null},I.prototype._createPako=function(){this._pako=new x[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var L=this;this._pako.onData=function(H){L.push({data:H,meta:L.meta})}},b.compressWorker=function(L){return new I("Deflate",L)},b.uncompressWorker=function(){return new I("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(h,v,b){function g(V,q){var K,z="";for(K=0;K<q;K++)z+=String.fromCharCode(255&V),V>>>=8;return z}function x(V,q,K,z,W,D){var M,C,w=V.file,T=V.compression,A=D!==N.utf8encode,S=y.transformTo("string",D(w.name)),j=y.transformTo("string",N.utf8encode(w.name)),B=w.comment,R=y.transformTo("string",D(B)),X=y.transformTo("string",N.utf8encode(B)),Y=j.length!==w.name.length,ee=X.length!==B.length,U="",Q="",P="",F=w.dir,Z=w.date,se={crc32:0,compressedSize:0,uncompressedSize:0};q&&!K||(se.crc32=V.crc32,se.compressedSize=V.compressedSize,se.uncompressedSize=V.uncompressedSize);var re=0;q&&(re|=8),A||!Y&&!ee||(re|=2048);var ae=0,te=0;F&&(ae|=16),W==="UNIX"?(te=798,ae|=function(le,ne){var de=le;return le||(de=ne?16893:33204),(65535&de)<<16}(w.unixPermissions,F)):(te=20,ae|=function(le){return 63&(le||0)}(w.dosPermissions)),M=Z.getUTCHours(),M<<=6,M|=Z.getUTCMinutes(),M<<=5,M|=Z.getUTCSeconds()/2,C=Z.getUTCFullYear()-1980,C<<=4,C|=Z.getUTCMonth()+1,C<<=5,C|=Z.getUTCDate(),Y&&(Q=g(1,1)+g(I(S),4)+j,U+="up"+g(Q.length,2)+Q),ee&&(P=g(1,1)+g(I(R),4)+X,U+="uc"+g(P.length,2)+P);var he="";return he+=`
\0`,he+=g(re,2),he+=T.magic,he+=g(M,2),he+=g(C,2),he+=g(se.crc32,4),he+=g(se.compressedSize,4),he+=g(se.uncompressedSize,4),he+=g(S.length,2),he+=g(U.length,2),{fileRecord:L.LOCAL_FILE_HEADER+he+S+U,dirRecord:L.CENTRAL_FILE_HEADER+g(te,2)+he+g(R.length,2)+"\0\0\0\0"+g(ae,4)+g(z,4)+S+U+R}}var y=h("../utils"),E=h("../stream/GenericWorker"),N=h("../utf8"),I=h("../crc32"),L=h("../signature");function H(V,q,K,z){E.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=q,this.zipPlatform=K,this.encodeFileName=z,this.streamFiles=V,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}y.inherits(H,E),H.prototype.push=function(V){var q=V.meta.percent||0,K=this.entriesCount,z=this._sources.length;this.accumulate?this.contentBuffer.push(V):(this.bytesWritten+=V.data.length,E.prototype.push.call(this,{data:V.data,meta:{currentFile:this.currentFile,percent:K?(q+100*(K-z-1))/K:100}}))},H.prototype.openedSource=function(V){this.currentSourceOffset=this.bytesWritten,this.currentFile=V.file.name;var q=this.streamFiles&&!V.file.dir;if(q){var K=x(V,q,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:K.fileRecord,meta:{percent:0}})}else this.accumulate=!0},H.prototype.closedSource=function(V){this.accumulate=!1;var q=this.streamFiles&&!V.file.dir,K=x(V,q,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(K.dirRecord),q)this.push({data:function(z){return L.DATA_DESCRIPTOR+g(z.crc32,4)+g(z.compressedSize,4)+g(z.uncompressedSize,4)}(V),meta:{percent:100}});else for(this.push({data:K.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},H.prototype.flush=function(){for(var V=this.bytesWritten,q=0;q<this.dirRecords.length;q++)this.push({data:this.dirRecords[q],meta:{percent:100}});var K=this.bytesWritten-V,z=function(W,D,M,C,w){var T=y.transformTo("string",w(C));return L.CENTRAL_DIRECTORY_END+"\0\0\0\0"+g(W,2)+g(W,2)+g(D,4)+g(M,4)+g(T.length,2)+T}(this.dirRecords.length,K,V,this.zipComment,this.encodeFileName);this.push({data:z,meta:{percent:100}})},H.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},H.prototype.registerPrevious=function(V){this._sources.push(V);var q=this;return V.on("data",function(K){q.processChunk(K)}),V.on("end",function(){q.closedSource(q.previous.streamInfo),q._sources.length?q.prepareNextSource():q.end()}),V.on("error",function(K){q.error(K)}),this},H.prototype.resume=function(){return!!E.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},H.prototype.error=function(V){var q=this._sources;if(!E.prototype.error.call(this,V))return!1;for(var K=0;K<q.length;K++)try{q[K].error(V)}catch{}return!0},H.prototype.lock=function(){E.prototype.lock.call(this);for(var V=this._sources,q=0;q<V.length;q++)V[q].lock()},v.exports=H},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(h,v,b){var g=h("../compressions"),x=h("./ZipFileWorker");b.generateWorker=function(y,E,N){var I=new x(E.streamFiles,N,E.platform,E.encodeFileName),L=0;try{y.forEach(function(H,V){L++;var q=function(D,M){var C=D||M,w=g[C];if(!w)throw new Error(C+" is not a valid compression method !");return w}(V.options.compression,E.compression),K=V.options.compressionOptions||E.compressionOptions||{},z=V.dir,W=V.date;V._compressWorker(q,K).withStreamInfo("file",{name:H,dir:z,date:W,comment:V.comment||"",unixPermissions:V.unixPermissions,dosPermissions:V.dosPermissions}).pipe(I)}),I.entriesCount=L}catch(H){I.error(H)}return I}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(h,v,b){function g(){if(!(this instanceof g))return new g;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var x=new g;for(var y in this)typeof this[y]!="function"&&(x[y]=this[y]);return x}}(g.prototype=h("./object")).loadAsync=h("./load"),g.support=h("./support"),g.defaults=h("./defaults"),g.version="3.10.1",g.loadAsync=function(x,y){return new g().loadAsync(x,y)},g.external=h("./external"),v.exports=g},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(h,v,b){var g=h("./utils"),x=h("./external"),y=h("./utf8"),E=h("./zipEntries"),N=h("./stream/Crc32Probe"),I=h("./nodejsUtils");function L(H){return new x.Promise(function(V,q){var K=H.decompressed.getContentWorker().pipe(new N);K.on("error",function(z){q(z)}).on("end",function(){K.streamInfo.crc32!==H.decompressed.crc32?q(new Error("Corrupted zip : CRC32 mismatch")):V()}).resume()})}v.exports=function(H,V){var q=this;return V=g.extend(V||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:y.utf8decode}),I.isNode&&I.isStream(H)?x.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):g.prepareContent("the loaded zip file",H,!0,V.optimizedBinaryString,V.base64).then(function(K){var z=new E(V);return z.load(K),z}).then(function(K){var z=[x.Promise.resolve(K)],W=K.files;if(V.checkCRC32)for(var D=0;D<W.length;D++)z.push(L(W[D]));return x.Promise.all(z)}).then(function(K){for(var z=K.shift(),W=z.files,D=0;D<W.length;D++){var M=W[D],C=M.fileNameStr,w=g.resolve(M.fileNameStr);q.file(w,M.decompressed,{binary:!0,optimizedBinaryString:!0,date:M.date,dir:M.dir,comment:M.fileCommentStr.length?M.fileCommentStr:null,unixPermissions:M.unixPermissions,dosPermissions:M.dosPermissions,createFolders:V.createFolders}),M.dir||(q.file(w).unsafeOriginalName=C)}return z.zipComment.length&&(q.comment=z.zipComment),q})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(h,v,b){var g=h("../utils"),x=h("../stream/GenericWorker");function y(E,N){x.call(this,"Nodejs stream input adapter for "+E),this._upstreamEnded=!1,this._bindStream(N)}g.inherits(y,x),y.prototype._bindStream=function(E){var N=this;(this._stream=E).pause(),E.on("data",function(I){N.push({data:I,meta:{percent:0}})}).on("error",function(I){N.isPaused?this.generatedError=I:N.error(I)}).on("end",function(){N.isPaused?N._upstreamEnded=!0:N.end()})},y.prototype.pause=function(){return!!x.prototype.pause.call(this)&&(this._stream.pause(),!0)},y.prototype.resume=function(){return!!x.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},v.exports=y},{"../stream/GenericWorker":28,"../utils":32}],13:[function(h,v,b){var g=h("readable-stream").Readable;function x(y,E,N){g.call(this,E),this._helper=y;var I=this;y.on("data",function(L,H){I.push(L)||I._helper.pause(),N&&N(H)}).on("error",function(L){I.emit("error",L)}).on("end",function(){I.push(null)})}h("../utils").inherits(x,g),x.prototype._read=function(){this._helper.resume()},v.exports=x},{"../utils":32,"readable-stream":16}],14:[function(h,v,b){v.exports={isNode:l!==void 0,newBufferFrom:function(g,x){if(l.from&&l.from!==Uint8Array.from)return l.from(g,x);if(typeof g=="number")throw new Error('The "data" argument must not be a number');return new l(g,x)},allocBuffer:function(g){if(l.alloc)return l.alloc(g);var x=new l(g);return x.fill(0),x},isBuffer:function(g){return l.isBuffer(g)},isStream:function(g){return g&&typeof g.on=="function"&&typeof g.pause=="function"&&typeof g.resume=="function"}}},{}],15:[function(h,v,b){function g(w,T,A){var S,j=y.getTypeOf(T),B=y.extend(A||{},I);B.date=B.date||new Date,B.compression!==null&&(B.compression=B.compression.toUpperCase()),typeof B.unixPermissions=="string"&&(B.unixPermissions=parseInt(B.unixPermissions,8)),B.unixPermissions&&16384&B.unixPermissions&&(B.dir=!0),B.dosPermissions&&16&B.dosPermissions&&(B.dir=!0),B.dir&&(w=W(w)),B.createFolders&&(S=z(w))&&D.call(this,S,!0);var R=j==="string"&&B.binary===!1&&B.base64===!1;A&&A.binary!==void 0||(B.binary=!R),(T instanceof L&&T.uncompressedSize===0||B.dir||!T||T.length===0)&&(B.base64=!1,B.binary=!0,T="",B.compression="STORE",j="string");var X;X=T instanceof L||T instanceof E?T:q.isNode&&q.isStream(T)?new K(w,T):y.prepareContent(w,T,B.binary,B.optimizedBinaryString,B.base64);var Y=new H(w,X,B);this.files[w]=Y}var x=h("./utf8"),y=h("./utils"),E=h("./stream/GenericWorker"),N=h("./stream/StreamHelper"),I=h("./defaults"),L=h("./compressedObject"),H=h("./zipObject"),V=h("./generate"),q=h("./nodejsUtils"),K=h("./nodejs/NodejsStreamInputAdapter"),z=function(w){w.slice(-1)==="/"&&(w=w.substring(0,w.length-1));var T=w.lastIndexOf("/");return 0<T?w.substring(0,T):""},W=function(w){return w.slice(-1)!=="/"&&(w+="/"),w},D=function(w,T){return T=T!==void 0?T:I.createFolders,w=W(w),this.files[w]||g.call(this,w,null,{dir:!0,createFolders:T}),this.files[w]};function M(w){return Object.prototype.toString.call(w)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(w){var T,A,S;for(T in this.files)S=this.files[T],(A=T.slice(this.root.length,T.length))&&T.slice(0,this.root.length)===this.root&&w(A,S)},filter:function(w){var T=[];return this.forEach(function(A,S){w(A,S)&&T.push(S)}),T},file:function(w,T,A){if(arguments.length!==1)return w=this.root+w,g.call(this,w,T,A),this;if(M(w)){var S=w;return this.filter(function(B,R){return!R.dir&&S.test(B)})}var j=this.files[this.root+w];return j&&!j.dir?j:null},folder:function(w){if(!w)return this;if(M(w))return this.filter(function(j,B){return B.dir&&w.test(j)});var T=this.root+w,A=D.call(this,T),S=this.clone();return S.root=A.name,S},remove:function(w){w=this.root+w;var T=this.files[w];if(T||(w.slice(-1)!=="/"&&(w+="/"),T=this.files[w]),T&&!T.dir)delete this.files[w];else for(var A=this.filter(function(j,B){return B.name.slice(0,w.length)===w}),S=0;S<A.length;S++)delete this.files[A[S].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(w){var T,A={};try{if((A=y.extend(w||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:x.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");y.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var S=A.comment||this.comment||"";T=V.generateWorker(this,A,S)}catch(j){(T=new E("error")).error(j)}return new N(T,A.type||"string",A.mimeType)},generateAsync:function(w,T){return this.generateInternalStream(w).accumulate(T)},generateNodeStream:function(w,T){return(w=w||{}).type||(w.type="nodebuffer"),this.generateInternalStream(w).toNodejsStream(T)}};v.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(h,v,b){v.exports=h("stream")},{stream:void 0}],17:[function(h,v,b){var g=h("./DataReader");function x(y){g.call(this,y);for(var E=0;E<this.data.length;E++)y[E]=255&y[E]}h("../utils").inherits(x,g),x.prototype.byteAt=function(y){return this.data[this.zero+y]},x.prototype.lastIndexOfSignature=function(y){for(var E=y.charCodeAt(0),N=y.charCodeAt(1),I=y.charCodeAt(2),L=y.charCodeAt(3),H=this.length-4;0<=H;--H)if(this.data[H]===E&&this.data[H+1]===N&&this.data[H+2]===I&&this.data[H+3]===L)return H-this.zero;return-1},x.prototype.readAndCheckSignature=function(y){var E=y.charCodeAt(0),N=y.charCodeAt(1),I=y.charCodeAt(2),L=y.charCodeAt(3),H=this.readData(4);return E===H[0]&&N===H[1]&&I===H[2]&&L===H[3]},x.prototype.readData=function(y){if(this.checkOffset(y),y===0)return[];var E=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,E},v.exports=x},{"../utils":32,"./DataReader":18}],18:[function(h,v,b){var g=h("../utils");function x(y){this.data=y,this.length=y.length,this.index=0,this.zero=0}x.prototype={checkOffset:function(y){this.checkIndex(this.index+y)},checkIndex:function(y){if(this.length<this.zero+y||y<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+y+"). Corrupted zip ?")},setIndex:function(y){this.checkIndex(y),this.index=y},skip:function(y){this.setIndex(this.index+y)},byteAt:function(){},readInt:function(y){var E,N=0;for(this.checkOffset(y),E=this.index+y-1;E>=this.index;E--)N=(N<<8)+this.byteAt(E);return this.index+=y,N},readString:function(y){return g.transformTo("string",this.readData(y))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var y=this.readInt(4);return new Date(Date.UTC(1980+(y>>25&127),(y>>21&15)-1,y>>16&31,y>>11&31,y>>5&63,(31&y)<<1))}},v.exports=x},{"../utils":32}],19:[function(h,v,b){var g=h("./Uint8ArrayReader");function x(y){g.call(this,y)}h("../utils").inherits(x,g),x.prototype.readData=function(y){this.checkOffset(y);var E=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,E},v.exports=x},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(h,v,b){var g=h("./DataReader");function x(y){g.call(this,y)}h("../utils").inherits(x,g),x.prototype.byteAt=function(y){return this.data.charCodeAt(this.zero+y)},x.prototype.lastIndexOfSignature=function(y){return this.data.lastIndexOf(y)-this.zero},x.prototype.readAndCheckSignature=function(y){return y===this.readData(4)},x.prototype.readData=function(y){this.checkOffset(y);var E=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,E},v.exports=x},{"../utils":32,"./DataReader":18}],21:[function(h,v,b){var g=h("./ArrayReader");function x(y){g.call(this,y)}h("../utils").inherits(x,g),x.prototype.readData=function(y){if(this.checkOffset(y),y===0)return new Uint8Array(0);var E=this.data.subarray(this.zero+this.index,this.zero+this.index+y);return this.index+=y,E},v.exports=x},{"../utils":32,"./ArrayReader":17}],22:[function(h,v,b){var g=h("../utils"),x=h("../support"),y=h("./ArrayReader"),E=h("./StringReader"),N=h("./NodeBufferReader"),I=h("./Uint8ArrayReader");v.exports=function(L){var H=g.getTypeOf(L);return g.checkSupport(H),H!=="string"||x.uint8array?H==="nodebuffer"?new N(L):x.uint8array?new I(g.transformTo("uint8array",L)):new y(g.transformTo("array",L)):new E(L)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(h,v,b){b.LOCAL_FILE_HEADER="PK",b.CENTRAL_FILE_HEADER="PK",b.CENTRAL_DIRECTORY_END="PK",b.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",b.ZIP64_CENTRAL_DIRECTORY_END="PK",b.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(h,v,b){var g=h("./GenericWorker"),x=h("../utils");function y(E){g.call(this,"ConvertWorker to "+E),this.destType=E}x.inherits(y,g),y.prototype.processChunk=function(E){this.push({data:x.transformTo(this.destType,E.data),meta:E.meta})},v.exports=y},{"../utils":32,"./GenericWorker":28}],25:[function(h,v,b){var g=h("./GenericWorker"),x=h("../crc32");function y(){g.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}h("../utils").inherits(y,g),y.prototype.processChunk=function(E){this.streamInfo.crc32=x(E.data,this.streamInfo.crc32||0),this.push(E)},v.exports=y},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(h,v,b){var g=h("../utils"),x=h("./GenericWorker");function y(E){x.call(this,"DataLengthProbe for "+E),this.propName=E,this.withStreamInfo(E,0)}g.inherits(y,x),y.prototype.processChunk=function(E){if(E){var N=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=N+E.data.length}x.prototype.processChunk.call(this,E)},v.exports=y},{"../utils":32,"./GenericWorker":28}],27:[function(h,v,b){var g=h("../utils"),x=h("./GenericWorker");function y(E){x.call(this,"DataWorker");var N=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,E.then(function(I){N.dataIsReady=!0,N.data=I,N.max=I&&I.length||0,N.type=g.getTypeOf(I),N.isPaused||N._tickAndRepeat()},function(I){N.error(I)})}g.inherits(y,x),y.prototype.cleanUp=function(){x.prototype.cleanUp.call(this),this.data=null},y.prototype.resume=function(){return!!x.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,g.delay(this._tickAndRepeat,[],this)),!0)},y.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(g.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},y.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var E=null,N=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":E=this.data.substring(this.index,N);break;case"uint8array":E=this.data.subarray(this.index,N);break;case"array":case"nodebuffer":E=this.data.slice(this.index,N)}return this.index=N,this.push({data:E,meta:{percent:this.max?this.index/this.max*100:0}})},v.exports=y},{"../utils":32,"./GenericWorker":28}],28:[function(h,v,b){function g(x){this.name=x||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}g.prototype={push:function(x){this.emit("data",x)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(x){this.emit("error",x)}return!0},error:function(x){return!this.isFinished&&(this.isPaused?this.generatedError=x:(this.isFinished=!0,this.emit("error",x),this.previous&&this.previous.error(x),this.cleanUp()),!0)},on:function(x,y){return this._listeners[x].push(y),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(x,y){if(this._listeners[x])for(var E=0;E<this._listeners[x].length;E++)this._listeners[x][E].call(this,y)},pipe:function(x){return x.registerPrevious(this)},registerPrevious:function(x){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=x.streamInfo,this.mergeStreamInfo(),this.previous=x;var y=this;return x.on("data",function(E){y.processChunk(E)}),x.on("end",function(){y.end()}),x.on("error",function(E){y.error(E)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var x=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),x=!0),this.previous&&this.previous.resume(),!x},flush:function(){},processChunk:function(x){this.push(x)},withStreamInfo:function(x,y){return this.extraStreamInfo[x]=y,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var x in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,x)&&(this.streamInfo[x]=this.extraStreamInfo[x])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var x="Worker "+this.name;return this.previous?this.previous+" -> "+x:x}},v.exports=g},{}],29:[function(h,v,b){var g=h("../utils"),x=h("./ConvertWorker"),y=h("./GenericWorker"),E=h("../base64"),N=h("../support"),I=h("../external"),L=null;if(N.nodestream)try{L=h("../nodejs/NodejsStreamOutputAdapter")}catch{}function H(V,q,K){var z=q;switch(q){case"blob":case"arraybuffer":z="uint8array";break;case"base64":z="string"}try{this._internalType=z,this._outputType=q,this._mimeType=K,g.checkSupport(z),this._worker=V.pipe(new x(z)),V.lock()}catch(W){this._worker=new y("error"),this._worker.error(W)}}H.prototype={accumulate:function(V){return function(q,K){return new I.Promise(function(z,W){var D=[],M=q._internalType,C=q._outputType,w=q._mimeType;q.on("data",function(T,A){D.push(T),K&&K(A)}).on("error",function(T){D=[],W(T)}).on("end",function(){try{var T=function(A,S,j){switch(A){case"blob":return g.newBlob(g.transformTo("arraybuffer",S),j);case"base64":return E.encode(S);default:return g.transformTo(A,S)}}(C,function(A,S){var j,B=0,R=null,X=0;for(j=0;j<S.length;j++)X+=S[j].length;switch(A){case"string":return S.join("");case"array":return Array.prototype.concat.apply([],S);case"uint8array":for(R=new Uint8Array(X),j=0;j<S.length;j++)R.set(S[j],B),B+=S[j].length;return R;case"nodebuffer":return l.concat(S);default:throw new Error("concat : unsupported type '"+A+"'")}}(M,D),w);z(T)}catch(A){W(A)}D=[]}).resume()})}(this,V)},on:function(V,q){var K=this;return V==="data"?this._worker.on(V,function(z){q.call(K,z.data,z.meta)}):this._worker.on(V,function(){g.delay(q,arguments,K)}),this},resume:function(){return g.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(V){if(g.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new L(this,{objectMode:this._outputType!=="nodebuffer"},V)}},v.exports=H},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(h,v,b){if(b.base64=!0,b.array=!0,b.string=!0,b.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",b.nodebuffer=l!==void 0,b.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")b.blob=!1;else{var g=new ArrayBuffer(0);try{b.blob=new Blob([g],{type:"application/zip"}).size===0}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);x.append(g),b.blob=x.getBlob("application/zip").size===0}catch{b.blob=!1}}}try{b.nodestream=!!h("readable-stream").Readable}catch{b.nodestream=!1}},{"readable-stream":16}],31:[function(h,v,b){for(var g=h("./utils"),x=h("./support"),y=h("./nodejsUtils"),E=h("./stream/GenericWorker"),N=new Array(256),I=0;I<256;I++)N[I]=252<=I?6:248<=I?5:240<=I?4:224<=I?3:192<=I?2:1;function L(){E.call(this,"utf-8 decode"),this.leftOver=null}function H(){E.call(this,"utf-8 encode")}N[254]=N[254]=1,b.utf8encode=function(V){return x.nodebuffer?y.newBufferFrom(V,"utf-8"):function(q){var K,z,W,D,M,C=q.length,w=0;for(D=0;D<C;D++)(64512&(z=q.charCodeAt(D)))==55296&&D+1<C&&(64512&(W=q.charCodeAt(D+1)))==56320&&(z=65536+(z-55296<<10)+(W-56320),D++),w+=z<128?1:z<2048?2:z<65536?3:4;for(K=x.uint8array?new Uint8Array(w):new Array(w),D=M=0;M<w;D++)(64512&(z=q.charCodeAt(D)))==55296&&D+1<C&&(64512&(W=q.charCodeAt(D+1)))==56320&&(z=65536+(z-55296<<10)+(W-56320),D++),z<128?K[M++]=z:(z<2048?K[M++]=192|z>>>6:(z<65536?K[M++]=224|z>>>12:(K[M++]=240|z>>>18,K[M++]=128|z>>>12&63),K[M++]=128|z>>>6&63),K[M++]=128|63&z);return K}(V)},b.utf8decode=function(V){return x.nodebuffer?g.transformTo("nodebuffer",V).toString("utf-8"):function(q){var K,z,W,D,M=q.length,C=new Array(2*M);for(K=z=0;K<M;)if((W=q[K++])<128)C[z++]=W;else if(4<(D=N[W]))C[z++]=65533,K+=D-1;else{for(W&=D===2?31:D===3?15:7;1<D&&K<M;)W=W<<6|63&q[K++],D--;1<D?C[z++]=65533:W<65536?C[z++]=W:(W-=65536,C[z++]=55296|W>>10&1023,C[z++]=56320|1023&W)}return C.length!==z&&(C.subarray?C=C.subarray(0,z):C.length=z),g.applyFromCharCode(C)}(V=g.transformTo(x.uint8array?"uint8array":"array",V))},g.inherits(L,E),L.prototype.processChunk=function(V){var q=g.transformTo(x.uint8array?"uint8array":"array",V.data);if(this.leftOver&&this.leftOver.length){if(x.uint8array){var K=q;(q=new Uint8Array(K.length+this.leftOver.length)).set(this.leftOver,0),q.set(K,this.leftOver.length)}else q=this.leftOver.concat(q);this.leftOver=null}var z=function(D,M){var C;for((M=M||D.length)>D.length&&(M=D.length),C=M-1;0<=C&&(192&D[C])==128;)C--;return C<0||C===0?M:C+N[D[C]]>M?C:M}(q),W=q;z!==q.length&&(x.uint8array?(W=q.subarray(0,z),this.leftOver=q.subarray(z,q.length)):(W=q.slice(0,z),this.leftOver=q.slice(z,q.length))),this.push({data:b.utf8decode(W),meta:V.meta})},L.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:b.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},b.Utf8DecodeWorker=L,g.inherits(H,E),H.prototype.processChunk=function(V){this.push({data:b.utf8encode(V.data),meta:V.meta})},b.Utf8EncodeWorker=H},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(h,v,b){var g=h("./support"),x=h("./base64"),y=h("./nodejsUtils"),E=h("./external");function N(K){return K}function I(K,z){for(var W=0;W<K.length;++W)z[W]=255&K.charCodeAt(W);return z}h("setimmediate"),b.newBlob=function(K,z){b.checkSupport("blob");try{return new Blob([K],{type:z})}catch{try{var W=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return W.append(K),W.getBlob(z)}catch{throw new Error("Bug : can't construct the Blob.")}}};var L={stringifyByChunk:function(K,z,W){var D=[],M=0,C=K.length;if(C<=W)return String.fromCharCode.apply(null,K);for(;M<C;)z==="array"||z==="nodebuffer"?D.push(String.fromCharCode.apply(null,K.slice(M,Math.min(M+W,C)))):D.push(String.fromCharCode.apply(null,K.subarray(M,Math.min(M+W,C)))),M+=W;return D.join("")},stringifyByChar:function(K){for(var z="",W=0;W<K.length;W++)z+=String.fromCharCode(K[W]);return z},applyCanBeUsed:{uint8array:function(){try{return g.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return g.nodebuffer&&String.fromCharCode.apply(null,y.allocBuffer(1)).length===1}catch{return!1}}()}};function H(K){var z=65536,W=b.getTypeOf(K),D=!0;if(W==="uint8array"?D=L.applyCanBeUsed.uint8array:W==="nodebuffer"&&(D=L.applyCanBeUsed.nodebuffer),D)for(;1<z;)try{return L.stringifyByChunk(K,W,z)}catch{z=Math.floor(z/2)}return L.stringifyByChar(K)}function V(K,z){for(var W=0;W<K.length;W++)z[W]=K[W];return z}b.applyFromCharCode=H;var q={};q.string={string:N,array:function(K){return I(K,new Array(K.length))},arraybuffer:function(K){return q.string.uint8array(K).buffer},uint8array:function(K){return I(K,new Uint8Array(K.length))},nodebuffer:function(K){return I(K,y.allocBuffer(K.length))}},q.array={string:H,array:N,arraybuffer:function(K){return new Uint8Array(K).buffer},uint8array:function(K){return new Uint8Array(K)},nodebuffer:function(K){return y.newBufferFrom(K)}},q.arraybuffer={string:function(K){return H(new Uint8Array(K))},array:function(K){return V(new Uint8Array(K),new Array(K.byteLength))},arraybuffer:N,uint8array:function(K){return new Uint8Array(K)},nodebuffer:function(K){return y.newBufferFrom(new Uint8Array(K))}},q.uint8array={string:H,array:function(K){return V(K,new Array(K.length))},arraybuffer:function(K){return K.buffer},uint8array:N,nodebuffer:function(K){return y.newBufferFrom(K)}},q.nodebuffer={string:H,array:function(K){return V(K,new Array(K.length))},arraybuffer:function(K){return q.nodebuffer.uint8array(K).buffer},uint8array:function(K){return V(K,new Uint8Array(K.length))},nodebuffer:N},b.transformTo=function(K,z){if(z=z||"",!K)return z;b.checkSupport(K);var W=b.getTypeOf(z);return q[W][K](z)},b.resolve=function(K){for(var z=K.split("/"),W=[],D=0;D<z.length;D++){var M=z[D];M==="."||M===""&&D!==0&&D!==z.length-1||(M===".."?W.pop():W.push(M))}return W.join("/")},b.getTypeOf=function(K){return typeof K=="string"?"string":Object.prototype.toString.call(K)==="[object Array]"?"array":g.nodebuffer&&y.isBuffer(K)?"nodebuffer":g.uint8array&&K instanceof Uint8Array?"uint8array":g.arraybuffer&&K instanceof ArrayBuffer?"arraybuffer":void 0},b.checkSupport=function(K){if(!g[K.toLowerCase()])throw new Error(K+" is not supported by this platform")},b.MAX_VALUE_16BITS=65535,b.MAX_VALUE_32BITS=-1,b.pretty=function(K){var z,W,D="";for(W=0;W<(K||"").length;W++)D+="\\x"+((z=K.charCodeAt(W))<16?"0":"")+z.toString(16).toUpperCase();return D},b.delay=function(K,z,W){f(function(){K.apply(W||null,z||[])})},b.inherits=function(K,z){function W(){}W.prototype=z.prototype,K.prototype=new W},b.extend=function(){var K,z,W={};for(K=0;K<arguments.length;K++)for(z in arguments[K])Object.prototype.hasOwnProperty.call(arguments[K],z)&&W[z]===void 0&&(W[z]=arguments[K][z]);return W},b.prepareContent=function(K,z,W,D,M){return E.Promise.resolve(z).then(function(C){return g.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new E.Promise(function(w,T){var A=new FileReader;A.onload=function(S){w(S.target.result)},A.onerror=function(S){T(S.target.error)},A.readAsArrayBuffer(C)}):C}).then(function(C){var w=b.getTypeOf(C);return w?(w==="arraybuffer"?C=b.transformTo("uint8array",C):w==="string"&&(M?C=x.decode(C):W&&D!==!0&&(C=function(T){return I(T,g.uint8array?new Uint8Array(T.length):new Array(T.length))}(C))),C):E.Promise.reject(new Error("Can't read the data of '"+K+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(h,v,b){var g=h("./reader/readerFor"),x=h("./utils"),y=h("./signature"),E=h("./zipEntry"),N=h("./support");function I(L){this.files=[],this.loadOptions=L}I.prototype={checkSignature:function(L){if(!this.reader.readAndCheckSignature(L)){this.reader.index-=4;var H=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+x.pretty(H)+", expected "+x.pretty(L)+")")}},isSignature:function(L,H){var V=this.reader.index;this.reader.setIndex(L);var q=this.reader.readString(4)===H;return this.reader.setIndex(V),q},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var L=this.reader.readData(this.zipCommentLength),H=N.uint8array?"uint8array":"array",V=x.transformTo(H,L);this.zipComment=this.loadOptions.decodeFileName(V)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var L,H,V,q=this.zip64EndOfCentralSize-44;0<q;)L=this.reader.readInt(2),H=this.reader.readInt(4),V=this.reader.readData(H),this.zip64ExtensibleData[L]={id:L,length:H,value:V}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var L,H;for(L=0;L<this.files.length;L++)H=this.files[L],this.reader.setIndex(H.localHeaderOffset),this.checkSignature(y.LOCAL_FILE_HEADER),H.readLocalPart(this.reader),H.handleUTF8(),H.processAttributes()},readCentralDir:function(){var L;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(y.CENTRAL_FILE_HEADER);)(L=new E({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(L);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var L=this.reader.lastIndexOfSignature(y.CENTRAL_DIRECTORY_END);if(L<0)throw this.isSignature(0,y.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(L);var H=L;if(this.checkSignature(y.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===x.MAX_VALUE_16BITS||this.diskWithCentralDirStart===x.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===x.MAX_VALUE_16BITS||this.centralDirRecords===x.MAX_VALUE_16BITS||this.centralDirSize===x.MAX_VALUE_32BITS||this.centralDirOffset===x.MAX_VALUE_32BITS){if(this.zip64=!0,(L=this.reader.lastIndexOfSignature(y.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(L),this.checkSignature(y.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,y.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(y.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(y.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var V=this.centralDirOffset+this.centralDirSize;this.zip64&&(V+=20,V+=12+this.zip64EndOfCentralSize);var q=H-V;if(0<q)this.isSignature(H,y.CENTRAL_FILE_HEADER)||(this.reader.zero=q);else if(q<0)throw new Error("Corrupted zip: missing "+Math.abs(q)+" bytes.")},prepareReader:function(L){this.reader=g(L)},load:function(L){this.prepareReader(L),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},v.exports=I},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(h,v,b){var g=h("./reader/readerFor"),x=h("./utils"),y=h("./compressedObject"),E=h("./crc32"),N=h("./utf8"),I=h("./compressions"),L=h("./support");function H(V,q){this.options=V,this.loadOptions=q}H.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(V){var q,K;if(V.skip(22),this.fileNameLength=V.readInt(2),K=V.readInt(2),this.fileName=V.readData(this.fileNameLength),V.skip(K),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((q=function(z){for(var W in I)if(Object.prototype.hasOwnProperty.call(I,W)&&I[W].magic===z)return I[W];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+x.pretty(this.compressionMethod)+" unknown (inner file : "+x.transformTo("string",this.fileName)+")");this.decompressed=new y(this.compressedSize,this.uncompressedSize,this.crc32,q,V.readData(this.compressedSize))},readCentralPart:function(V){this.versionMadeBy=V.readInt(2),V.skip(2),this.bitFlag=V.readInt(2),this.compressionMethod=V.readString(2),this.date=V.readDate(),this.crc32=V.readInt(4),this.compressedSize=V.readInt(4),this.uncompressedSize=V.readInt(4);var q=V.readInt(2);if(this.extraFieldsLength=V.readInt(2),this.fileCommentLength=V.readInt(2),this.diskNumberStart=V.readInt(2),this.internalFileAttributes=V.readInt(2),this.externalFileAttributes=V.readInt(4),this.localHeaderOffset=V.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");V.skip(q),this.readExtraFields(V),this.parseZIP64ExtraField(V),this.fileComment=V.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var V=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),V==0&&(this.dosPermissions=63&this.externalFileAttributes),V==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var V=g(this.extraFields[1].value);this.uncompressedSize===x.MAX_VALUE_32BITS&&(this.uncompressedSize=V.readInt(8)),this.compressedSize===x.MAX_VALUE_32BITS&&(this.compressedSize=V.readInt(8)),this.localHeaderOffset===x.MAX_VALUE_32BITS&&(this.localHeaderOffset=V.readInt(8)),this.diskNumberStart===x.MAX_VALUE_32BITS&&(this.diskNumberStart=V.readInt(4))}},readExtraFields:function(V){var q,K,z,W=V.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});V.index+4<W;)q=V.readInt(2),K=V.readInt(2),z=V.readData(K),this.extraFields[q]={id:q,length:K,value:z};V.setIndex(W)},handleUTF8:function(){var V=L.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=N.utf8decode(this.fileName),this.fileCommentStr=N.utf8decode(this.fileComment);else{var q=this.findExtraFieldUnicodePath();if(q!==null)this.fileNameStr=q;else{var K=x.transformTo(V,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(K)}var z=this.findExtraFieldUnicodeComment();if(z!==null)this.fileCommentStr=z;else{var W=x.transformTo(V,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(W)}}},findExtraFieldUnicodePath:function(){var V=this.extraFields[28789];if(V){var q=g(V.value);return q.readInt(1)!==1||E(this.fileName)!==q.readInt(4)?null:N.utf8decode(q.readData(V.length-5))}return null},findExtraFieldUnicodeComment:function(){var V=this.extraFields[25461];if(V){var q=g(V.value);return q.readInt(1)!==1||E(this.fileComment)!==q.readInt(4)?null:N.utf8decode(q.readData(V.length-5))}return null}},v.exports=H},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(h,v,b){function g(q,K,z){this.name=q,this.dir=z.dir,this.date=z.date,this.comment=z.comment,this.unixPermissions=z.unixPermissions,this.dosPermissions=z.dosPermissions,this._data=K,this._dataBinary=z.binary,this.options={compression:z.compression,compressionOptions:z.compressionOptions}}var x=h("./stream/StreamHelper"),y=h("./stream/DataWorker"),E=h("./utf8"),N=h("./compressedObject"),I=h("./stream/GenericWorker");g.prototype={internalStream:function(q){var K=null,z="string";try{if(!q)throw new Error("No output type specified.");var W=(z=q.toLowerCase())==="string"||z==="text";z!=="binarystring"&&z!=="text"||(z="string"),K=this._decompressWorker();var D=!this._dataBinary;D&&!W&&(K=K.pipe(new E.Utf8EncodeWorker)),!D&&W&&(K=K.pipe(new E.Utf8DecodeWorker))}catch(M){(K=new I("error")).error(M)}return new x(K,z,"")},async:function(q,K){return this.internalStream(q).accumulate(K)},nodeStream:function(q,K){return this.internalStream(q||"nodebuffer").toNodejsStream(K)},_compressWorker:function(q,K){if(this._data instanceof N&&this._data.compression.magic===q.magic)return this._data.getCompressedWorker();var z=this._decompressWorker();return this._dataBinary||(z=z.pipe(new E.Utf8EncodeWorker)),N.createWorkerFrom(z,q,K)},_decompressWorker:function(){return this._data instanceof N?this._data.getContentWorker():this._data instanceof I?this._data:new y(this._data)}};for(var L=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],H=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},V=0;V<L.length;V++)g.prototype[L[V]]=H;v.exports=g},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(h,v,b){(function(g){var x,y,E=g.MutationObserver||g.WebKitMutationObserver;if(E){var N=0,I=new E(q),L=g.document.createTextNode("");I.observe(L,{characterData:!0}),x=function(){L.data=N=++N%2}}else if(g.setImmediate||g.MessageChannel===void 0)x="document"in g&&"onreadystatechange"in g.document.createElement("script")?function(){var K=g.document.createElement("script");K.onreadystatechange=function(){q(),K.onreadystatechange=null,K.parentNode.removeChild(K),K=null},g.document.documentElement.appendChild(K)}:function(){setTimeout(q,0)};else{var H=new g.MessageChannel;H.port1.onmessage=q,x=function(){H.port2.postMessage(0)}}var V=[];function q(){var K,z;y=!0;for(var W=V.length;W;){for(z=V,V=[],K=-1;++K<W;)z[K]();W=V.length}y=!1}v.exports=function(K){V.push(K)!==1||y||x()}}).call(this,s!==void 0?s:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(h,v,b){var g=h("immediate");function x(){}var y={},E=["REJECTED"],N=["FULFILLED"],I=["PENDING"];function L(W){if(typeof W!="function")throw new TypeError("resolver must be a function");this.state=I,this.queue=[],this.outcome=void 0,W!==x&&K(this,W)}function H(W,D,M){this.promise=W,typeof D=="function"&&(this.onFulfilled=D,this.callFulfilled=this.otherCallFulfilled),typeof M=="function"&&(this.onRejected=M,this.callRejected=this.otherCallRejected)}function V(W,D,M){g(function(){var C;try{C=D(M)}catch(w){return y.reject(W,w)}C===W?y.reject(W,new TypeError("Cannot resolve promise with itself")):y.resolve(W,C)})}function q(W){var D=W&&W.then;if(W&&(typeof W=="object"||typeof W=="function")&&typeof D=="function")return function(){D.apply(W,arguments)}}function K(W,D){var M=!1;function C(A){M||(M=!0,y.reject(W,A))}function w(A){M||(M=!0,y.resolve(W,A))}var T=z(function(){D(w,C)});T.status==="error"&&C(T.value)}function z(W,D){var M={};try{M.value=W(D),M.status="success"}catch(C){M.status="error",M.value=C}return M}(v.exports=L).prototype.finally=function(W){if(typeof W!="function")return this;var D=this.constructor;return this.then(function(M){return D.resolve(W()).then(function(){return M})},function(M){return D.resolve(W()).then(function(){throw M})})},L.prototype.catch=function(W){return this.then(null,W)},L.prototype.then=function(W,D){if(typeof W!="function"&&this.state===N||typeof D!="function"&&this.state===E)return this;var M=new this.constructor(x);return this.state!==I?V(M,this.state===N?W:D,this.outcome):this.queue.push(new H(M,W,D)),M},H.prototype.callFulfilled=function(W){y.resolve(this.promise,W)},H.prototype.otherCallFulfilled=function(W){V(this.promise,this.onFulfilled,W)},H.prototype.callRejected=function(W){y.reject(this.promise,W)},H.prototype.otherCallRejected=function(W){V(this.promise,this.onRejected,W)},y.resolve=function(W,D){var M=z(q,D);if(M.status==="error")return y.reject(W,M.value);var C=M.value;if(C)K(W,C);else{W.state=N,W.outcome=D;for(var w=-1,T=W.queue.length;++w<T;)W.queue[w].callFulfilled(D)}return W},y.reject=function(W,D){W.state=E,W.outcome=D;for(var M=-1,C=W.queue.length;++M<C;)W.queue[M].callRejected(D);return W},L.resolve=function(W){return W instanceof this?W:y.resolve(new this(x),W)},L.reject=function(W){var D=new this(x);return y.reject(D,W)},L.all=function(W){var D=this;if(Object.prototype.toString.call(W)!=="[object Array]")return this.reject(new TypeError("must be an array"));var M=W.length,C=!1;if(!M)return this.resolve([]);for(var w=new Array(M),T=0,A=-1,S=new this(x);++A<M;)j(W[A],A);return S;function j(B,R){D.resolve(B).then(function(X){w[R]=X,++T!==M||C||(C=!0,y.resolve(S,w))},function(X){C||(C=!0,y.reject(S,X))})}},L.race=function(W){if(Object.prototype.toString.call(W)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=W.length,M=!1;if(!D)return this.resolve([]);for(var C,w=-1,T=new this(x);++w<D;)C=W[w],this.resolve(C).then(function(A){M||(M=!0,y.resolve(T,A))},function(A){M||(M=!0,y.reject(T,A))});return T}},{immediate:36}],38:[function(h,v,b){var g={};(0,h("./lib/utils/common").assign)(g,h("./lib/deflate"),h("./lib/inflate"),h("./lib/zlib/constants")),v.exports=g},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(h,v,b){var g=h("./zlib/deflate"),x=h("./utils/common"),y=h("./utils/strings"),E=h("./zlib/messages"),N=h("./zlib/zstream"),I=Object.prototype.toString;function L(V){if(!(this instanceof L))return new L(V);this.options=x.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},V||{});var q=this.options;q.raw&&0<q.windowBits?q.windowBits=-q.windowBits:q.gzip&&0<q.windowBits&&q.windowBits<16&&(q.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new N,this.strm.avail_out=0;var K=g.deflateInit2(this.strm,q.level,q.method,q.windowBits,q.memLevel,q.strategy);if(K!==0)throw new Error(E[K]);if(q.header&&g.deflateSetHeader(this.strm,q.header),q.dictionary){var z;if(z=typeof q.dictionary=="string"?y.string2buf(q.dictionary):I.call(q.dictionary)==="[object ArrayBuffer]"?new Uint8Array(q.dictionary):q.dictionary,(K=g.deflateSetDictionary(this.strm,z))!==0)throw new Error(E[K]);this._dict_set=!0}}function H(V,q){var K=new L(q);if(K.push(V,!0),K.err)throw K.msg||E[K.err];return K.result}L.prototype.push=function(V,q){var K,z,W=this.strm,D=this.options.chunkSize;if(this.ended)return!1;z=q===~~q?q:q===!0?4:0,typeof V=="string"?W.input=y.string2buf(V):I.call(V)==="[object ArrayBuffer]"?W.input=new Uint8Array(V):W.input=V,W.next_in=0,W.avail_in=W.input.length;do{if(W.avail_out===0&&(W.output=new x.Buf8(D),W.next_out=0,W.avail_out=D),(K=g.deflate(W,z))!==1&&K!==0)return this.onEnd(K),!(this.ended=!0);W.avail_out!==0&&(W.avail_in!==0||z!==4&&z!==2)||(this.options.to==="string"?this.onData(y.buf2binstring(x.shrinkBuf(W.output,W.next_out))):this.onData(x.shrinkBuf(W.output,W.next_out)))}while((0<W.avail_in||W.avail_out===0)&&K!==1);return z===4?(K=g.deflateEnd(this.strm),this.onEnd(K),this.ended=!0,K===0):z!==2||(this.onEnd(0),!(W.avail_out=0))},L.prototype.onData=function(V){this.chunks.push(V)},L.prototype.onEnd=function(V){V===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=x.flattenChunks(this.chunks)),this.chunks=[],this.err=V,this.msg=this.strm.msg},b.Deflate=L,b.deflate=H,b.deflateRaw=function(V,q){return(q=q||{}).raw=!0,H(V,q)},b.gzip=function(V,q){return(q=q||{}).gzip=!0,H(V,q)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(h,v,b){var g=h("./zlib/inflate"),x=h("./utils/common"),y=h("./utils/strings"),E=h("./zlib/constants"),N=h("./zlib/messages"),I=h("./zlib/zstream"),L=h("./zlib/gzheader"),H=Object.prototype.toString;function V(K){if(!(this instanceof V))return new V(K);this.options=x.assign({chunkSize:16384,windowBits:0,to:""},K||{});var z=this.options;z.raw&&0<=z.windowBits&&z.windowBits<16&&(z.windowBits=-z.windowBits,z.windowBits===0&&(z.windowBits=-15)),!(0<=z.windowBits&&z.windowBits<16)||K&&K.windowBits||(z.windowBits+=32),15<z.windowBits&&z.windowBits<48&&(15&z.windowBits)==0&&(z.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new I,this.strm.avail_out=0;var W=g.inflateInit2(this.strm,z.windowBits);if(W!==E.Z_OK)throw new Error(N[W]);this.header=new L,g.inflateGetHeader(this.strm,this.header)}function q(K,z){var W=new V(z);if(W.push(K,!0),W.err)throw W.msg||N[W.err];return W.result}V.prototype.push=function(K,z){var W,D,M,C,w,T,A=this.strm,S=this.options.chunkSize,j=this.options.dictionary,B=!1;if(this.ended)return!1;D=z===~~z?z:z===!0?E.Z_FINISH:E.Z_NO_FLUSH,typeof K=="string"?A.input=y.binstring2buf(K):H.call(K)==="[object ArrayBuffer]"?A.input=new Uint8Array(K):A.input=K,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new x.Buf8(S),A.next_out=0,A.avail_out=S),(W=g.inflate(A,E.Z_NO_FLUSH))===E.Z_NEED_DICT&&j&&(T=typeof j=="string"?y.string2buf(j):H.call(j)==="[object ArrayBuffer]"?new Uint8Array(j):j,W=g.inflateSetDictionary(this.strm,T)),W===E.Z_BUF_ERROR&&B===!0&&(W=E.Z_OK,B=!1),W!==E.Z_STREAM_END&&W!==E.Z_OK)return this.onEnd(W),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&W!==E.Z_STREAM_END&&(A.avail_in!==0||D!==E.Z_FINISH&&D!==E.Z_SYNC_FLUSH)||(this.options.to==="string"?(M=y.utf8border(A.output,A.next_out),C=A.next_out-M,w=y.buf2string(A.output,M),A.next_out=C,A.avail_out=S-C,C&&x.arraySet(A.output,A.output,M,C,0),this.onData(w)):this.onData(x.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(B=!0)}while((0<A.avail_in||A.avail_out===0)&&W!==E.Z_STREAM_END);return W===E.Z_STREAM_END&&(D=E.Z_FINISH),D===E.Z_FINISH?(W=g.inflateEnd(this.strm),this.onEnd(W),this.ended=!0,W===E.Z_OK):D!==E.Z_SYNC_FLUSH||(this.onEnd(E.Z_OK),!(A.avail_out=0))},V.prototype.onData=function(K){this.chunks.push(K)},V.prototype.onEnd=function(K){K===E.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=x.flattenChunks(this.chunks)),this.chunks=[],this.err=K,this.msg=this.strm.msg},b.Inflate=V,b.inflate=q,b.inflateRaw=function(K,z){return(z=z||{}).raw=!0,q(K,z)},b.ungzip=q},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(h,v,b){var g=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";b.assign=function(E){for(var N=Array.prototype.slice.call(arguments,1);N.length;){var I=N.shift();if(I){if(typeof I!="object")throw new TypeError(I+"must be non-object");for(var L in I)I.hasOwnProperty(L)&&(E[L]=I[L])}}return E},b.shrinkBuf=function(E,N){return E.length===N?E:E.subarray?E.subarray(0,N):(E.length=N,E)};var x={arraySet:function(E,N,I,L,H){if(N.subarray&&E.subarray)E.set(N.subarray(I,I+L),H);else for(var V=0;V<L;V++)E[H+V]=N[I+V]},flattenChunks:function(E){var N,I,L,H,V,q;for(N=L=0,I=E.length;N<I;N++)L+=E[N].length;for(q=new Uint8Array(L),N=H=0,I=E.length;N<I;N++)V=E[N],q.set(V,H),H+=V.length;return q}},y={arraySet:function(E,N,I,L,H){for(var V=0;V<L;V++)E[H+V]=N[I+V]},flattenChunks:function(E){return[].concat.apply([],E)}};b.setTyped=function(E){E?(b.Buf8=Uint8Array,b.Buf16=Uint16Array,b.Buf32=Int32Array,b.assign(b,x)):(b.Buf8=Array,b.Buf16=Array,b.Buf32=Array,b.assign(b,y))},b.setTyped(g)},{}],42:[function(h,v,b){var g=h("./common"),x=!0,y=!0;try{String.fromCharCode.apply(null,[0])}catch{x=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{y=!1}for(var E=new g.Buf8(256),N=0;N<256;N++)E[N]=252<=N?6:248<=N?5:240<=N?4:224<=N?3:192<=N?2:1;function I(L,H){if(H<65537&&(L.subarray&&y||!L.subarray&&x))return String.fromCharCode.apply(null,g.shrinkBuf(L,H));for(var V="",q=0;q<H;q++)V+=String.fromCharCode(L[q]);return V}E[254]=E[254]=1,b.string2buf=function(L){var H,V,q,K,z,W=L.length,D=0;for(K=0;K<W;K++)(64512&(V=L.charCodeAt(K)))==55296&&K+1<W&&(64512&(q=L.charCodeAt(K+1)))==56320&&(V=65536+(V-55296<<10)+(q-56320),K++),D+=V<128?1:V<2048?2:V<65536?3:4;for(H=new g.Buf8(D),K=z=0;z<D;K++)(64512&(V=L.charCodeAt(K)))==55296&&K+1<W&&(64512&(q=L.charCodeAt(K+1)))==56320&&(V=65536+(V-55296<<10)+(q-56320),K++),V<128?H[z++]=V:(V<2048?H[z++]=192|V>>>6:(V<65536?H[z++]=224|V>>>12:(H[z++]=240|V>>>18,H[z++]=128|V>>>12&63),H[z++]=128|V>>>6&63),H[z++]=128|63&V);return H},b.buf2binstring=function(L){return I(L,L.length)},b.binstring2buf=function(L){for(var H=new g.Buf8(L.length),V=0,q=H.length;V<q;V++)H[V]=L.charCodeAt(V);return H},b.buf2string=function(L,H){var V,q,K,z,W=H||L.length,D=new Array(2*W);for(V=q=0;V<W;)if((K=L[V++])<128)D[q++]=K;else if(4<(z=E[K]))D[q++]=65533,V+=z-1;else{for(K&=z===2?31:z===3?15:7;1<z&&V<W;)K=K<<6|63&L[V++],z--;1<z?D[q++]=65533:K<65536?D[q++]=K:(K-=65536,D[q++]=55296|K>>10&1023,D[q++]=56320|1023&K)}return I(D,q)},b.utf8border=function(L,H){var V;for((H=H||L.length)>L.length&&(H=L.length),V=H-1;0<=V&&(192&L[V])==128;)V--;return V<0||V===0?H:V+E[L[V]]>H?V:H}},{"./common":41}],43:[function(h,v,b){v.exports=function(g,x,y,E){for(var N=65535&g|0,I=g>>>16&65535|0,L=0;y!==0;){for(y-=L=2e3<y?2e3:y;I=I+(N=N+x[E++]|0)|0,--L;);N%=65521,I%=65521}return N|I<<16|0}},{}],44:[function(h,v,b){v.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(h,v,b){var g=function(){for(var x,y=[],E=0;E<256;E++){x=E;for(var N=0;N<8;N++)x=1&x?3988292384^x>>>1:x>>>1;y[E]=x}return y}();v.exports=function(x,y,E,N){var I=g,L=N+E;x^=-1;for(var H=N;H<L;H++)x=x>>>8^I[255&(x^y[H])];return-1^x}},{}],46:[function(h,v,b){var g,x=h("../utils/common"),y=h("./trees"),E=h("./adler32"),N=h("./crc32"),I=h("./messages"),L=-2,H=258,V=262,q=113;function K(U,Q){return U.msg=I[Q],Q}function z(U){return(U<<1)-(4<U?9:0)}function W(U){for(var Q=U.length;0<=--Q;)U[Q]=0}function D(U){var Q=U.state,P=Q.pending;P>U.avail_out&&(P=U.avail_out),P!==0&&(x.arraySet(U.output,Q.pending_buf,Q.pending_out,P,U.next_out),U.next_out+=P,Q.pending_out+=P,U.total_out+=P,U.avail_out-=P,Q.pending-=P,Q.pending===0&&(Q.pending_out=0))}function M(U,Q){y._tr_flush_block(U,0<=U.block_start?U.block_start:-1,U.strstart-U.block_start,Q),U.block_start=U.strstart,D(U.strm)}function C(U,Q){U.pending_buf[U.pending++]=Q}function w(U,Q){U.pending_buf[U.pending++]=Q>>>8&255,U.pending_buf[U.pending++]=255&Q}function T(U,Q){var P,F,Z=U.max_chain_length,se=U.strstart,re=U.prev_length,ae=U.nice_match,te=U.strstart>U.w_size-V?U.strstart-(U.w_size-V):0,he=U.window,le=U.w_mask,ne=U.prev,de=U.strstart+H,fe=he[se+re-1],Se=he[se+re];U.prev_length>=U.good_match&&(Z>>=2),ae>U.lookahead&&(ae=U.lookahead);do if(he[(P=Q)+re]===Se&&he[P+re-1]===fe&&he[P]===he[se]&&he[++P]===he[se+1]){se+=2,P++;do;while(he[++se]===he[++P]&&he[++se]===he[++P]&&he[++se]===he[++P]&&he[++se]===he[++P]&&he[++se]===he[++P]&&he[++se]===he[++P]&&he[++se]===he[++P]&&he[++se]===he[++P]&&se<de);if(F=H-(de-se),se=de-H,re<F){if(U.match_start=Q,ae<=(re=F))break;fe=he[se+re-1],Se=he[se+re]}}while((Q=ne[Q&le])>te&&--Z!=0);return re<=U.lookahead?re:U.lookahead}function A(U){var Q,P,F,Z,se,re,ae,te,he,le,ne=U.w_size;do{if(Z=U.window_size-U.lookahead-U.strstart,U.strstart>=ne+(ne-V)){for(x.arraySet(U.window,U.window,ne,ne,0),U.match_start-=ne,U.strstart-=ne,U.block_start-=ne,Q=P=U.hash_size;F=U.head[--Q],U.head[Q]=ne<=F?F-ne:0,--P;);for(Q=P=ne;F=U.prev[--Q],U.prev[Q]=ne<=F?F-ne:0,--P;);Z+=ne}if(U.strm.avail_in===0)break;if(re=U.strm,ae=U.window,te=U.strstart+U.lookahead,le=void 0,(he=Z)<(le=re.avail_in)&&(le=he),P=le===0?0:(re.avail_in-=le,x.arraySet(ae,re.input,re.next_in,le,te),re.state.wrap===1?re.adler=E(re.adler,ae,le,te):re.state.wrap===2&&(re.adler=N(re.adler,ae,le,te)),re.next_in+=le,re.total_in+=le,le),U.lookahead+=P,U.lookahead+U.insert>=3)for(se=U.strstart-U.insert,U.ins_h=U.window[se],U.ins_h=(U.ins_h<<U.hash_shift^U.window[se+1])&U.hash_mask;U.insert&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[se+3-1])&U.hash_mask,U.prev[se&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=se,se++,U.insert--,!(U.lookahead+U.insert<3)););}while(U.lookahead<V&&U.strm.avail_in!==0)}function S(U,Q){for(var P,F;;){if(U.lookahead<V){if(A(U),U.lookahead<V&&Q===0)return 1;if(U.lookahead===0)break}if(P=0,U.lookahead>=3&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+3-1])&U.hash_mask,P=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart),P!==0&&U.strstart-P<=U.w_size-V&&(U.match_length=T(U,P)),U.match_length>=3)if(F=y._tr_tally(U,U.strstart-U.match_start,U.match_length-3),U.lookahead-=U.match_length,U.match_length<=U.max_lazy_match&&U.lookahead>=3){for(U.match_length--;U.strstart++,U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+3-1])&U.hash_mask,P=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart,--U.match_length!=0;);U.strstart++}else U.strstart+=U.match_length,U.match_length=0,U.ins_h=U.window[U.strstart],U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+1])&U.hash_mask;else F=y._tr_tally(U,0,U.window[U.strstart]),U.lookahead--,U.strstart++;if(F&&(M(U,!1),U.strm.avail_out===0))return 1}return U.insert=U.strstart<2?U.strstart:2,Q===4?(M(U,!0),U.strm.avail_out===0?3:4):U.last_lit&&(M(U,!1),U.strm.avail_out===0)?1:2}function j(U,Q){for(var P,F,Z;;){if(U.lookahead<V){if(A(U),U.lookahead<V&&Q===0)return 1;if(U.lookahead===0)break}if(P=0,U.lookahead>=3&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+3-1])&U.hash_mask,P=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart),U.prev_length=U.match_length,U.prev_match=U.match_start,U.match_length=2,P!==0&&U.prev_length<U.max_lazy_match&&U.strstart-P<=U.w_size-V&&(U.match_length=T(U,P),U.match_length<=5&&(U.strategy===1||U.match_length===3&&4096<U.strstart-U.match_start)&&(U.match_length=2)),U.prev_length>=3&&U.match_length<=U.prev_length){for(Z=U.strstart+U.lookahead-3,F=y._tr_tally(U,U.strstart-1-U.prev_match,U.prev_length-3),U.lookahead-=U.prev_length-1,U.prev_length-=2;++U.strstart<=Z&&(U.ins_h=(U.ins_h<<U.hash_shift^U.window[U.strstart+3-1])&U.hash_mask,P=U.prev[U.strstart&U.w_mask]=U.head[U.ins_h],U.head[U.ins_h]=U.strstart),--U.prev_length!=0;);if(U.match_available=0,U.match_length=2,U.strstart++,F&&(M(U,!1),U.strm.avail_out===0))return 1}else if(U.match_available){if((F=y._tr_tally(U,0,U.window[U.strstart-1]))&&M(U,!1),U.strstart++,U.lookahead--,U.strm.avail_out===0)return 1}else U.match_available=1,U.strstart++,U.lookahead--}return U.match_available&&(F=y._tr_tally(U,0,U.window[U.strstart-1]),U.match_available=0),U.insert=U.strstart<2?U.strstart:2,Q===4?(M(U,!0),U.strm.avail_out===0?3:4):U.last_lit&&(M(U,!1),U.strm.avail_out===0)?1:2}function B(U,Q,P,F,Z){this.good_length=U,this.max_lazy=Q,this.nice_length=P,this.max_chain=F,this.func=Z}function R(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new x.Buf16(1146),this.dyn_dtree=new x.Buf16(122),this.bl_tree=new x.Buf16(78),W(this.dyn_ltree),W(this.dyn_dtree),W(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new x.Buf16(16),this.heap=new x.Buf16(573),W(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new x.Buf16(573),W(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function X(U){var Q;return U&&U.state?(U.total_in=U.total_out=0,U.data_type=2,(Q=U.state).pending=0,Q.pending_out=0,Q.wrap<0&&(Q.wrap=-Q.wrap),Q.status=Q.wrap?42:q,U.adler=Q.wrap===2?0:1,Q.last_flush=0,y._tr_init(Q),0):K(U,L)}function Y(U){var Q=X(U);return Q===0&&function(P){P.window_size=2*P.w_size,W(P.head),P.max_lazy_match=g[P.level].max_lazy,P.good_match=g[P.level].good_length,P.nice_match=g[P.level].nice_length,P.max_chain_length=g[P.level].max_chain,P.strstart=0,P.block_start=0,P.lookahead=0,P.insert=0,P.match_length=P.prev_length=2,P.match_available=0,P.ins_h=0}(U.state),Q}function ee(U,Q,P,F,Z,se){if(!U)return L;var re=1;if(Q===-1&&(Q=6),F<0?(re=0,F=-F):15<F&&(re=2,F-=16),Z<1||9<Z||P!==8||F<8||15<F||Q<0||9<Q||se<0||4<se)return K(U,L);F===8&&(F=9);var ae=new R;return(U.state=ae).strm=U,ae.wrap=re,ae.gzhead=null,ae.w_bits=F,ae.w_size=1<<ae.w_bits,ae.w_mask=ae.w_size-1,ae.hash_bits=Z+7,ae.hash_size=1<<ae.hash_bits,ae.hash_mask=ae.hash_size-1,ae.hash_shift=~~((ae.hash_bits+3-1)/3),ae.window=new x.Buf8(2*ae.w_size),ae.head=new x.Buf16(ae.hash_size),ae.prev=new x.Buf16(ae.w_size),ae.lit_bufsize=1<<Z+6,ae.pending_buf_size=4*ae.lit_bufsize,ae.pending_buf=new x.Buf8(ae.pending_buf_size),ae.d_buf=1*ae.lit_bufsize,ae.l_buf=3*ae.lit_bufsize,ae.level=Q,ae.strategy=se,ae.method=P,Y(U)}g=[new B(0,0,0,0,function(U,Q){var P=65535;for(P>U.pending_buf_size-5&&(P=U.pending_buf_size-5);;){if(U.lookahead<=1){if(A(U),U.lookahead===0&&Q===0)return 1;if(U.lookahead===0)break}U.strstart+=U.lookahead,U.lookahead=0;var F=U.block_start+P;if((U.strstart===0||U.strstart>=F)&&(U.lookahead=U.strstart-F,U.strstart=F,M(U,!1),U.strm.avail_out===0)||U.strstart-U.block_start>=U.w_size-V&&(M(U,!1),U.strm.avail_out===0))return 1}return U.insert=0,Q===4?(M(U,!0),U.strm.avail_out===0?3:4):(U.strstart>U.block_start&&(M(U,!1),U.strm.avail_out),1)}),new B(4,4,8,4,S),new B(4,5,16,8,S),new B(4,6,32,32,S),new B(4,4,16,16,j),new B(8,16,32,32,j),new B(8,16,128,128,j),new B(8,32,128,256,j),new B(32,128,258,1024,j),new B(32,258,258,4096,j)],b.deflateInit=function(U,Q){return ee(U,Q,8,15,8,0)},b.deflateInit2=ee,b.deflateReset=Y,b.deflateResetKeep=X,b.deflateSetHeader=function(U,Q){return U&&U.state?U.state.wrap!==2?L:(U.state.gzhead=Q,0):L},b.deflate=function(U,Q){var P,F,Z,se;if(!U||!U.state||5<Q||Q<0)return U?K(U,L):L;if(F=U.state,!U.output||!U.input&&U.avail_in!==0||F.status===666&&Q!==4)return K(U,U.avail_out===0?-5:L);if(F.strm=U,P=F.last_flush,F.last_flush=Q,F.status===42)if(F.wrap===2)U.adler=0,C(F,31),C(F,139),C(F,8),F.gzhead?(C(F,(F.gzhead.text?1:0)+(F.gzhead.hcrc?2:0)+(F.gzhead.extra?4:0)+(F.gzhead.name?8:0)+(F.gzhead.comment?16:0)),C(F,255&F.gzhead.time),C(F,F.gzhead.time>>8&255),C(F,F.gzhead.time>>16&255),C(F,F.gzhead.time>>24&255),C(F,F.level===9?2:2<=F.strategy||F.level<2?4:0),C(F,255&F.gzhead.os),F.gzhead.extra&&F.gzhead.extra.length&&(C(F,255&F.gzhead.extra.length),C(F,F.gzhead.extra.length>>8&255)),F.gzhead.hcrc&&(U.adler=N(U.adler,F.pending_buf,F.pending,0)),F.gzindex=0,F.status=69):(C(F,0),C(F,0),C(F,0),C(F,0),C(F,0),C(F,F.level===9?2:2<=F.strategy||F.level<2?4:0),C(F,3),F.status=q);else{var re=8+(F.w_bits-8<<4)<<8;re|=(2<=F.strategy||F.level<2?0:F.level<6?1:F.level===6?2:3)<<6,F.strstart!==0&&(re|=32),re+=31-re%31,F.status=q,w(F,re),F.strstart!==0&&(w(F,U.adler>>>16),w(F,65535&U.adler)),U.adler=1}if(F.status===69)if(F.gzhead.extra){for(Z=F.pending;F.gzindex<(65535&F.gzhead.extra.length)&&(F.pending!==F.pending_buf_size||(F.gzhead.hcrc&&F.pending>Z&&(U.adler=N(U.adler,F.pending_buf,F.pending-Z,Z)),D(U),Z=F.pending,F.pending!==F.pending_buf_size));)C(F,255&F.gzhead.extra[F.gzindex]),F.gzindex++;F.gzhead.hcrc&&F.pending>Z&&(U.adler=N(U.adler,F.pending_buf,F.pending-Z,Z)),F.gzindex===F.gzhead.extra.length&&(F.gzindex=0,F.status=73)}else F.status=73;if(F.status===73)if(F.gzhead.name){Z=F.pending;do{if(F.pending===F.pending_buf_size&&(F.gzhead.hcrc&&F.pending>Z&&(U.adler=N(U.adler,F.pending_buf,F.pending-Z,Z)),D(U),Z=F.pending,F.pending===F.pending_buf_size)){se=1;break}se=F.gzindex<F.gzhead.name.length?255&F.gzhead.name.charCodeAt(F.gzindex++):0,C(F,se)}while(se!==0);F.gzhead.hcrc&&F.pending>Z&&(U.adler=N(U.adler,F.pending_buf,F.pending-Z,Z)),se===0&&(F.gzindex=0,F.status=91)}else F.status=91;if(F.status===91)if(F.gzhead.comment){Z=F.pending;do{if(F.pending===F.pending_buf_size&&(F.gzhead.hcrc&&F.pending>Z&&(U.adler=N(U.adler,F.pending_buf,F.pending-Z,Z)),D(U),Z=F.pending,F.pending===F.pending_buf_size)){se=1;break}se=F.gzindex<F.gzhead.comment.length?255&F.gzhead.comment.charCodeAt(F.gzindex++):0,C(F,se)}while(se!==0);F.gzhead.hcrc&&F.pending>Z&&(U.adler=N(U.adler,F.pending_buf,F.pending-Z,Z)),se===0&&(F.status=103)}else F.status=103;if(F.status===103&&(F.gzhead.hcrc?(F.pending+2>F.pending_buf_size&&D(U),F.pending+2<=F.pending_buf_size&&(C(F,255&U.adler),C(F,U.adler>>8&255),U.adler=0,F.status=q)):F.status=q),F.pending!==0){if(D(U),U.avail_out===0)return F.last_flush=-1,0}else if(U.avail_in===0&&z(Q)<=z(P)&&Q!==4)return K(U,-5);if(F.status===666&&U.avail_in!==0)return K(U,-5);if(U.avail_in!==0||F.lookahead!==0||Q!==0&&F.status!==666){var ae=F.strategy===2?function(te,he){for(var le;;){if(te.lookahead===0&&(A(te),te.lookahead===0)){if(he===0)return 1;break}if(te.match_length=0,le=y._tr_tally(te,0,te.window[te.strstart]),te.lookahead--,te.strstart++,le&&(M(te,!1),te.strm.avail_out===0))return 1}return te.insert=0,he===4?(M(te,!0),te.strm.avail_out===0?3:4):te.last_lit&&(M(te,!1),te.strm.avail_out===0)?1:2}(F,Q):F.strategy===3?function(te,he){for(var le,ne,de,fe,Se=te.window;;){if(te.lookahead<=H){if(A(te),te.lookahead<=H&&he===0)return 1;if(te.lookahead===0)break}if(te.match_length=0,te.lookahead>=3&&0<te.strstart&&(ne=Se[de=te.strstart-1])===Se[++de]&&ne===Se[++de]&&ne===Se[++de]){fe=te.strstart+H;do;while(ne===Se[++de]&&ne===Se[++de]&&ne===Se[++de]&&ne===Se[++de]&&ne===Se[++de]&&ne===Se[++de]&&ne===Se[++de]&&ne===Se[++de]&&de<fe);te.match_length=H-(fe-de),te.match_length>te.lookahead&&(te.match_length=te.lookahead)}if(te.match_length>=3?(le=y._tr_tally(te,1,te.match_length-3),te.lookahead-=te.match_length,te.strstart+=te.match_length,te.match_length=0):(le=y._tr_tally(te,0,te.window[te.strstart]),te.lookahead--,te.strstart++),le&&(M(te,!1),te.strm.avail_out===0))return 1}return te.insert=0,he===4?(M(te,!0),te.strm.avail_out===0?3:4):te.last_lit&&(M(te,!1),te.strm.avail_out===0)?1:2}(F,Q):g[F.level].func(F,Q);if(ae!==3&&ae!==4||(F.status=666),ae===1||ae===3)return U.avail_out===0&&(F.last_flush=-1),0;if(ae===2&&(Q===1?y._tr_align(F):Q!==5&&(y._tr_stored_block(F,0,0,!1),Q===3&&(W(F.head),F.lookahead===0&&(F.strstart=0,F.block_start=0,F.insert=0))),D(U),U.avail_out===0))return F.last_flush=-1,0}return Q!==4?0:F.wrap<=0?1:(F.wrap===2?(C(F,255&U.adler),C(F,U.adler>>8&255),C(F,U.adler>>16&255),C(F,U.adler>>24&255),C(F,255&U.total_in),C(F,U.total_in>>8&255),C(F,U.total_in>>16&255),C(F,U.total_in>>24&255)):(w(F,U.adler>>>16),w(F,65535&U.adler)),D(U),0<F.wrap&&(F.wrap=-F.wrap),F.pending!==0?0:1)},b.deflateEnd=function(U){var Q;return U&&U.state?(Q=U.state.status)!==42&&Q!==69&&Q!==73&&Q!==91&&Q!==103&&Q!==q&&Q!==666?K(U,L):(U.state=null,Q===q?K(U,-3):0):L},b.deflateSetDictionary=function(U,Q){var P,F,Z,se,re,ae,te,he,le=Q.length;if(!U||!U.state||(se=(P=U.state).wrap)===2||se===1&&P.status!==42||P.lookahead)return L;for(se===1&&(U.adler=E(U.adler,Q,le,0)),P.wrap=0,le>=P.w_size&&(se===0&&(W(P.head),P.strstart=0,P.block_start=0,P.insert=0),he=new x.Buf8(P.w_size),x.arraySet(he,Q,le-P.w_size,P.w_size,0),Q=he,le=P.w_size),re=U.avail_in,ae=U.next_in,te=U.input,U.avail_in=le,U.next_in=0,U.input=Q,A(P);P.lookahead>=3;){for(F=P.strstart,Z=P.lookahead-2;P.ins_h=(P.ins_h<<P.hash_shift^P.window[F+3-1])&P.hash_mask,P.prev[F&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=F,F++,--Z;);P.strstart=F,P.lookahead=2,A(P)}return P.strstart+=P.lookahead,P.block_start=P.strstart,P.insert=P.lookahead,P.lookahead=0,P.match_length=P.prev_length=2,P.match_available=0,U.next_in=ae,U.input=te,U.avail_in=re,P.wrap=se,0},b.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(h,v,b){v.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(h,v,b){v.exports=function(g,x){var y,E,N,I,L,H,V,q,K,z,W,D,M,C,w,T,A,S,j,B,R,X,Y,ee,U;y=g.state,E=g.next_in,ee=g.input,N=E+(g.avail_in-5),I=g.next_out,U=g.output,L=I-(x-g.avail_out),H=I+(g.avail_out-257),V=y.dmax,q=y.wsize,K=y.whave,z=y.wnext,W=y.window,D=y.hold,M=y.bits,C=y.lencode,w=y.distcode,T=(1<<y.lenbits)-1,A=(1<<y.distbits)-1;e:do{M<15&&(D+=ee[E++]<<M,M+=8,D+=ee[E++]<<M,M+=8),S=C[D&T];t:for(;;){if(D>>>=j=S>>>24,M-=j,(j=S>>>16&255)==0)U[I++]=65535&S;else{if(!(16&j)){if((64&j)==0){S=C[(65535&S)+(D&(1<<j)-1)];continue t}if(32&j){y.mode=12;break e}g.msg="invalid literal/length code",y.mode=30;break e}B=65535&S,(j&=15)&&(M<j&&(D+=ee[E++]<<M,M+=8),B+=D&(1<<j)-1,D>>>=j,M-=j),M<15&&(D+=ee[E++]<<M,M+=8,D+=ee[E++]<<M,M+=8),S=w[D&A];r:for(;;){if(D>>>=j=S>>>24,M-=j,!(16&(j=S>>>16&255))){if((64&j)==0){S=w[(65535&S)+(D&(1<<j)-1)];continue r}g.msg="invalid distance code",y.mode=30;break e}if(R=65535&S,M<(j&=15)&&(D+=ee[E++]<<M,(M+=8)<j&&(D+=ee[E++]<<M,M+=8)),V<(R+=D&(1<<j)-1)){g.msg="invalid distance too far back",y.mode=30;break e}if(D>>>=j,M-=j,(j=I-L)<R){if(K<(j=R-j)&&y.sane){g.msg="invalid distance too far back",y.mode=30;break e}if(Y=W,(X=0)===z){if(X+=q-j,j<B){for(B-=j;U[I++]=W[X++],--j;);X=I-R,Y=U}}else if(z<j){if(X+=q+z-j,(j-=z)<B){for(B-=j;U[I++]=W[X++],--j;);if(X=0,z<B){for(B-=j=z;U[I++]=W[X++],--j;);X=I-R,Y=U}}}else if(X+=z-j,j<B){for(B-=j;U[I++]=W[X++],--j;);X=I-R,Y=U}for(;2<B;)U[I++]=Y[X++],U[I++]=Y[X++],U[I++]=Y[X++],B-=3;B&&(U[I++]=Y[X++],1<B&&(U[I++]=Y[X++]))}else{for(X=I-R;U[I++]=U[X++],U[I++]=U[X++],U[I++]=U[X++],2<(B-=3););B&&(U[I++]=U[X++],1<B&&(U[I++]=U[X++]))}break}}break}}while(E<N&&I<H);E-=B=M>>3,D&=(1<<(M-=B<<3))-1,g.next_in=E,g.next_out=I,g.avail_in=E<N?N-E+5:5-(E-N),g.avail_out=I<H?H-I+257:257-(I-H),y.hold=D,y.bits=M}},{}],49:[function(h,v,b){var g=h("../utils/common"),x=h("./adler32"),y=h("./crc32"),E=h("./inffast"),N=h("./inftrees"),I=-2;function L(T){return(T>>>24&255)+(T>>>8&65280)+((65280&T)<<8)+((255&T)<<24)}function H(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new g.Buf16(320),this.work=new g.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function V(T){var A;return T&&T.state?(A=T.state,T.total_in=T.total_out=A.total=0,T.msg="",A.wrap&&(T.adler=1&A.wrap),A.mode=1,A.last=0,A.havedict=0,A.dmax=32768,A.head=null,A.hold=0,A.bits=0,A.lencode=A.lendyn=new g.Buf32(852),A.distcode=A.distdyn=new g.Buf32(592),A.sane=1,A.back=-1,0):I}function q(T){var A;return T&&T.state?((A=T.state).wsize=0,A.whave=0,A.wnext=0,V(T)):I}function K(T,A){var S,j;return T&&T.state?(j=T.state,A<0?(S=0,A=-A):(S=1+(A>>4),A<48&&(A&=15)),A&&(A<8||15<A)?I:(j.window!==null&&j.wbits!==A&&(j.window=null),j.wrap=S,j.wbits=A,q(T))):I}function z(T,A){var S,j;return T?(j=new H,(T.state=j).window=null,(S=K(T,A))!==0&&(T.state=null),S):I}var W,D,M=!0;function C(T){if(M){var A;for(W=new g.Buf32(512),D=new g.Buf32(32),A=0;A<144;)T.lens[A++]=8;for(;A<256;)T.lens[A++]=9;for(;A<280;)T.lens[A++]=7;for(;A<288;)T.lens[A++]=8;for(N(1,T.lens,0,288,W,0,T.work,{bits:9}),A=0;A<32;)T.lens[A++]=5;N(2,T.lens,0,32,D,0,T.work,{bits:5}),M=!1}T.lencode=W,T.lenbits=9,T.distcode=D,T.distbits=5}function w(T,A,S,j){var B,R=T.state;return R.window===null&&(R.wsize=1<<R.wbits,R.wnext=0,R.whave=0,R.window=new g.Buf8(R.wsize)),j>=R.wsize?(g.arraySet(R.window,A,S-R.wsize,R.wsize,0),R.wnext=0,R.whave=R.wsize):(j<(B=R.wsize-R.wnext)&&(B=j),g.arraySet(R.window,A,S-j,B,R.wnext),(j-=B)?(g.arraySet(R.window,A,S-j,j,0),R.wnext=j,R.whave=R.wsize):(R.wnext+=B,R.wnext===R.wsize&&(R.wnext=0),R.whave<R.wsize&&(R.whave+=B))),0}b.inflateReset=q,b.inflateReset2=K,b.inflateResetKeep=V,b.inflateInit=function(T){return z(T,15)},b.inflateInit2=z,b.inflate=function(T,A){var S,j,B,R,X,Y,ee,U,Q,P,F,Z,se,re,ae,te,he,le,ne,de,fe,Se,_e,Ce,Re=0,Pe=new g.Buf8(4),Ye=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!T||!T.state||!T.output||!T.input&&T.avail_in!==0)return I;(S=T.state).mode===12&&(S.mode=13),X=T.next_out,B=T.output,ee=T.avail_out,R=T.next_in,j=T.input,Y=T.avail_in,U=S.hold,Q=S.bits,P=Y,F=ee,Se=0;e:for(;;)switch(S.mode){case 1:if(S.wrap===0){S.mode=13;break}for(;Q<16;){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}if(2&S.wrap&&U===35615){Pe[S.check=0]=255&U,Pe[1]=U>>>8&255,S.check=y(S.check,Pe,2,0),Q=U=0,S.mode=2;break}if(S.flags=0,S.head&&(S.head.done=!1),!(1&S.wrap)||(((255&U)<<8)+(U>>8))%31){T.msg="incorrect header check",S.mode=30;break}if((15&U)!=8){T.msg="unknown compression method",S.mode=30;break}if(Q-=4,fe=8+(15&(U>>>=4)),S.wbits===0)S.wbits=fe;else if(fe>S.wbits){T.msg="invalid window size",S.mode=30;break}S.dmax=1<<fe,T.adler=S.check=1,S.mode=512&U?10:12,Q=U=0;break;case 2:for(;Q<16;){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}if(S.flags=U,(255&S.flags)!=8){T.msg="unknown compression method",S.mode=30;break}if(57344&S.flags){T.msg="unknown header flags set",S.mode=30;break}S.head&&(S.head.text=U>>8&1),512&S.flags&&(Pe[0]=255&U,Pe[1]=U>>>8&255,S.check=y(S.check,Pe,2,0)),Q=U=0,S.mode=3;case 3:for(;Q<32;){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}S.head&&(S.head.time=U),512&S.flags&&(Pe[0]=255&U,Pe[1]=U>>>8&255,Pe[2]=U>>>16&255,Pe[3]=U>>>24&255,S.check=y(S.check,Pe,4,0)),Q=U=0,S.mode=4;case 4:for(;Q<16;){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}S.head&&(S.head.xflags=255&U,S.head.os=U>>8),512&S.flags&&(Pe[0]=255&U,Pe[1]=U>>>8&255,S.check=y(S.check,Pe,2,0)),Q=U=0,S.mode=5;case 5:if(1024&S.flags){for(;Q<16;){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}S.length=U,S.head&&(S.head.extra_len=U),512&S.flags&&(Pe[0]=255&U,Pe[1]=U>>>8&255,S.check=y(S.check,Pe,2,0)),Q=U=0}else S.head&&(S.head.extra=null);S.mode=6;case 6:if(1024&S.flags&&(Y<(Z=S.length)&&(Z=Y),Z&&(S.head&&(fe=S.head.extra_len-S.length,S.head.extra||(S.head.extra=new Array(S.head.extra_len)),g.arraySet(S.head.extra,j,R,Z,fe)),512&S.flags&&(S.check=y(S.check,j,Z,R)),Y-=Z,R+=Z,S.length-=Z),S.length))break e;S.length=0,S.mode=7;case 7:if(2048&S.flags){if(Y===0)break e;for(Z=0;fe=j[R+Z++],S.head&&fe&&S.length<65536&&(S.head.name+=String.fromCharCode(fe)),fe&&Z<Y;);if(512&S.flags&&(S.check=y(S.check,j,Z,R)),Y-=Z,R+=Z,fe)break e}else S.head&&(S.head.name=null);S.length=0,S.mode=8;case 8:if(4096&S.flags){if(Y===0)break e;for(Z=0;fe=j[R+Z++],S.head&&fe&&S.length<65536&&(S.head.comment+=String.fromCharCode(fe)),fe&&Z<Y;);if(512&S.flags&&(S.check=y(S.check,j,Z,R)),Y-=Z,R+=Z,fe)break e}else S.head&&(S.head.comment=null);S.mode=9;case 9:if(512&S.flags){for(;Q<16;){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}if(U!==(65535&S.check)){T.msg="header crc mismatch",S.mode=30;break}Q=U=0}S.head&&(S.head.hcrc=S.flags>>9&1,S.head.done=!0),T.adler=S.check=0,S.mode=12;break;case 10:for(;Q<32;){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}T.adler=S.check=L(U),Q=U=0,S.mode=11;case 11:if(S.havedict===0)return T.next_out=X,T.avail_out=ee,T.next_in=R,T.avail_in=Y,S.hold=U,S.bits=Q,2;T.adler=S.check=1,S.mode=12;case 12:if(A===5||A===6)break e;case 13:if(S.last){U>>>=7&Q,Q-=7&Q,S.mode=27;break}for(;Q<3;){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}switch(S.last=1&U,Q-=1,3&(U>>>=1)){case 0:S.mode=14;break;case 1:if(C(S),S.mode=20,A!==6)break;U>>>=2,Q-=2;break e;case 2:S.mode=17;break;case 3:T.msg="invalid block type",S.mode=30}U>>>=2,Q-=2;break;case 14:for(U>>>=7&Q,Q-=7&Q;Q<32;){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}if((65535&U)!=(U>>>16^65535)){T.msg="invalid stored block lengths",S.mode=30;break}if(S.length=65535&U,Q=U=0,S.mode=15,A===6)break e;case 15:S.mode=16;case 16:if(Z=S.length){if(Y<Z&&(Z=Y),ee<Z&&(Z=ee),Z===0)break e;g.arraySet(B,j,R,Z,X),Y-=Z,R+=Z,ee-=Z,X+=Z,S.length-=Z;break}S.mode=12;break;case 17:for(;Q<14;){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}if(S.nlen=257+(31&U),U>>>=5,Q-=5,S.ndist=1+(31&U),U>>>=5,Q-=5,S.ncode=4+(15&U),U>>>=4,Q-=4,286<S.nlen||30<S.ndist){T.msg="too many length or distance symbols",S.mode=30;break}S.have=0,S.mode=18;case 18:for(;S.have<S.ncode;){for(;Q<3;){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}S.lens[Ye[S.have++]]=7&U,U>>>=3,Q-=3}for(;S.have<19;)S.lens[Ye[S.have++]]=0;if(S.lencode=S.lendyn,S.lenbits=7,_e={bits:S.lenbits},Se=N(0,S.lens,0,19,S.lencode,0,S.work,_e),S.lenbits=_e.bits,Se){T.msg="invalid code lengths set",S.mode=30;break}S.have=0,S.mode=19;case 19:for(;S.have<S.nlen+S.ndist;){for(;te=(Re=S.lencode[U&(1<<S.lenbits)-1])>>>16&255,he=65535&Re,!((ae=Re>>>24)<=Q);){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}if(he<16)U>>>=ae,Q-=ae,S.lens[S.have++]=he;else{if(he===16){for(Ce=ae+2;Q<Ce;){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}if(U>>>=ae,Q-=ae,S.have===0){T.msg="invalid bit length repeat",S.mode=30;break}fe=S.lens[S.have-1],Z=3+(3&U),U>>>=2,Q-=2}else if(he===17){for(Ce=ae+3;Q<Ce;){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}Q-=ae,fe=0,Z=3+(7&(U>>>=ae)),U>>>=3,Q-=3}else{for(Ce=ae+7;Q<Ce;){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}Q-=ae,fe=0,Z=11+(127&(U>>>=ae)),U>>>=7,Q-=7}if(S.have+Z>S.nlen+S.ndist){T.msg="invalid bit length repeat",S.mode=30;break}for(;Z--;)S.lens[S.have++]=fe}}if(S.mode===30)break;if(S.lens[256]===0){T.msg="invalid code -- missing end-of-block",S.mode=30;break}if(S.lenbits=9,_e={bits:S.lenbits},Se=N(1,S.lens,0,S.nlen,S.lencode,0,S.work,_e),S.lenbits=_e.bits,Se){T.msg="invalid literal/lengths set",S.mode=30;break}if(S.distbits=6,S.distcode=S.distdyn,_e={bits:S.distbits},Se=N(2,S.lens,S.nlen,S.ndist,S.distcode,0,S.work,_e),S.distbits=_e.bits,Se){T.msg="invalid distances set",S.mode=30;break}if(S.mode=20,A===6)break e;case 20:S.mode=21;case 21:if(6<=Y&&258<=ee){T.next_out=X,T.avail_out=ee,T.next_in=R,T.avail_in=Y,S.hold=U,S.bits=Q,E(T,F),X=T.next_out,B=T.output,ee=T.avail_out,R=T.next_in,j=T.input,Y=T.avail_in,U=S.hold,Q=S.bits,S.mode===12&&(S.back=-1);break}for(S.back=0;te=(Re=S.lencode[U&(1<<S.lenbits)-1])>>>16&255,he=65535&Re,!((ae=Re>>>24)<=Q);){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}if(te&&(240&te)==0){for(le=ae,ne=te,de=he;te=(Re=S.lencode[de+((U&(1<<le+ne)-1)>>le)])>>>16&255,he=65535&Re,!(le+(ae=Re>>>24)<=Q);){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}U>>>=le,Q-=le,S.back+=le}if(U>>>=ae,Q-=ae,S.back+=ae,S.length=he,te===0){S.mode=26;break}if(32&te){S.back=-1,S.mode=12;break}if(64&te){T.msg="invalid literal/length code",S.mode=30;break}S.extra=15&te,S.mode=22;case 22:if(S.extra){for(Ce=S.extra;Q<Ce;){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}S.length+=U&(1<<S.extra)-1,U>>>=S.extra,Q-=S.extra,S.back+=S.extra}S.was=S.length,S.mode=23;case 23:for(;te=(Re=S.distcode[U&(1<<S.distbits)-1])>>>16&255,he=65535&Re,!((ae=Re>>>24)<=Q);){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}if((240&te)==0){for(le=ae,ne=te,de=he;te=(Re=S.distcode[de+((U&(1<<le+ne)-1)>>le)])>>>16&255,he=65535&Re,!(le+(ae=Re>>>24)<=Q);){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}U>>>=le,Q-=le,S.back+=le}if(U>>>=ae,Q-=ae,S.back+=ae,64&te){T.msg="invalid distance code",S.mode=30;break}S.offset=he,S.extra=15&te,S.mode=24;case 24:if(S.extra){for(Ce=S.extra;Q<Ce;){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}S.offset+=U&(1<<S.extra)-1,U>>>=S.extra,Q-=S.extra,S.back+=S.extra}if(S.offset>S.dmax){T.msg="invalid distance too far back",S.mode=30;break}S.mode=25;case 25:if(ee===0)break e;if(Z=F-ee,S.offset>Z){if((Z=S.offset-Z)>S.whave&&S.sane){T.msg="invalid distance too far back",S.mode=30;break}se=Z>S.wnext?(Z-=S.wnext,S.wsize-Z):S.wnext-Z,Z>S.length&&(Z=S.length),re=S.window}else re=B,se=X-S.offset,Z=S.length;for(ee<Z&&(Z=ee),ee-=Z,S.length-=Z;B[X++]=re[se++],--Z;);S.length===0&&(S.mode=21);break;case 26:if(ee===0)break e;B[X++]=S.length,ee--,S.mode=21;break;case 27:if(S.wrap){for(;Q<32;){if(Y===0)break e;Y--,U|=j[R++]<<Q,Q+=8}if(F-=ee,T.total_out+=F,S.total+=F,F&&(T.adler=S.check=S.flags?y(S.check,B,F,X-F):x(S.check,B,F,X-F)),F=ee,(S.flags?U:L(U))!==S.check){T.msg="incorrect data check",S.mode=30;break}Q=U=0}S.mode=28;case 28:if(S.wrap&&S.flags){for(;Q<32;){if(Y===0)break e;Y--,U+=j[R++]<<Q,Q+=8}if(U!==(4294967295&S.total)){T.msg="incorrect length check",S.mode=30;break}Q=U=0}S.mode=29;case 29:Se=1;break e;case 30:Se=-3;break e;case 31:return-4;case 32:default:return I}return T.next_out=X,T.avail_out=ee,T.next_in=R,T.avail_in=Y,S.hold=U,S.bits=Q,(S.wsize||F!==T.avail_out&&S.mode<30&&(S.mode<27||A!==4))&&w(T,T.output,T.next_out,F-T.avail_out)?(S.mode=31,-4):(P-=T.avail_in,F-=T.avail_out,T.total_in+=P,T.total_out+=F,S.total+=F,S.wrap&&F&&(T.adler=S.check=S.flags?y(S.check,B,F,T.next_out-F):x(S.check,B,F,T.next_out-F)),T.data_type=S.bits+(S.last?64:0)+(S.mode===12?128:0)+(S.mode===20||S.mode===15?256:0),(P==0&&F===0||A===4)&&Se===0&&(Se=-5),Se)},b.inflateEnd=function(T){if(!T||!T.state)return I;var A=T.state;return A.window&&(A.window=null),T.state=null,0},b.inflateGetHeader=function(T,A){var S;return T&&T.state?(2&(S=T.state).wrap)==0?I:((S.head=A).done=!1,0):I},b.inflateSetDictionary=function(T,A){var S,j=A.length;return T&&T.state?(S=T.state).wrap!==0&&S.mode!==11?I:S.mode===11&&x(1,A,j,0)!==S.check?-3:w(T,A,j,j)?(S.mode=31,-4):(S.havedict=1,0):I},b.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(h,v,b){var g=h("../utils/common"),x=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],y=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],E=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],N=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];v.exports=function(I,L,H,V,q,K,z,W){var D,M,C,w,T,A,S,j,B,R=W.bits,X=0,Y=0,ee=0,U=0,Q=0,P=0,F=0,Z=0,se=0,re=0,ae=null,te=0,he=new g.Buf16(16),le=new g.Buf16(16),ne=null,de=0;for(X=0;X<=15;X++)he[X]=0;for(Y=0;Y<V;Y++)he[L[H+Y]]++;for(Q=R,U=15;1<=U&&he[U]===0;U--);if(U<Q&&(Q=U),U===0)return q[K++]=20971520,q[K++]=20971520,W.bits=1,0;for(ee=1;ee<U&&he[ee]===0;ee++);for(Q<ee&&(Q=ee),X=Z=1;X<=15;X++)if(Z<<=1,(Z-=he[X])<0)return-1;if(0<Z&&(I===0||U!==1))return-1;for(le[1]=0,X=1;X<15;X++)le[X+1]=le[X]+he[X];for(Y=0;Y<V;Y++)L[H+Y]!==0&&(z[le[L[H+Y]]++]=Y);if(A=I===0?(ae=ne=z,19):I===1?(ae=x,te-=257,ne=y,de-=257,256):(ae=E,ne=N,-1),X=ee,T=K,F=Y=re=0,C=-1,w=(se=1<<(P=Q))-1,I===1&&852<se||I===2&&592<se)return 1;for(;;){for(S=X-F,B=z[Y]<A?(j=0,z[Y]):z[Y]>A?(j=ne[de+z[Y]],ae[te+z[Y]]):(j=96,0),D=1<<X-F,ee=M=1<<P;q[T+(re>>F)+(M-=D)]=S<<24|j<<16|B|0,M!==0;);for(D=1<<X-1;re&D;)D>>=1;if(D!==0?(re&=D-1,re+=D):re=0,Y++,--he[X]==0){if(X===U)break;X=L[H+z[Y]]}if(Q<X&&(re&w)!==C){for(F===0&&(F=Q),T+=ee,Z=1<<(P=X-F);P+F<U&&!((Z-=he[P+F])<=0);)P++,Z<<=1;if(se+=1<<P,I===1&&852<se||I===2&&592<se)return 1;q[C=re&w]=Q<<24|P<<16|T-K|0}}return re!==0&&(q[T+re]=X-F<<24|64<<16|0),W.bits=Q,0}},{"../utils/common":41}],51:[function(h,v,b){v.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(h,v,b){var g=h("../utils/common");function x(ne){for(var de=ne.length;0<=--de;)ne[de]=0}var y=256,E=286,N=30,I=15,L=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],H=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],V=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=new Array(576);x(K);var z=new Array(60);x(z);var W=new Array(512);x(W);var D=new Array(256);x(D);var M=new Array(29);x(M);var C,w,T,A=new Array(N);function S(ne,de,fe,Se,_e){this.static_tree=ne,this.extra_bits=de,this.extra_base=fe,this.elems=Se,this.max_length=_e,this.has_stree=ne&&ne.length}function j(ne,de){this.dyn_tree=ne,this.max_code=0,this.stat_desc=de}function B(ne){return ne<256?W[ne]:W[256+(ne>>>7)]}function R(ne,de){ne.pending_buf[ne.pending++]=255&de,ne.pending_buf[ne.pending++]=de>>>8&255}function X(ne,de,fe){ne.bi_valid>16-fe?(ne.bi_buf|=de<<ne.bi_valid&65535,R(ne,ne.bi_buf),ne.bi_buf=de>>16-ne.bi_valid,ne.bi_valid+=fe-16):(ne.bi_buf|=de<<ne.bi_valid&65535,ne.bi_valid+=fe)}function Y(ne,de,fe){X(ne,fe[2*de],fe[2*de+1])}function ee(ne,de){for(var fe=0;fe|=1&ne,ne>>>=1,fe<<=1,0<--de;);return fe>>>1}function U(ne,de,fe){var Se,_e,Ce=new Array(16),Re=0;for(Se=1;Se<=I;Se++)Ce[Se]=Re=Re+fe[Se-1]<<1;for(_e=0;_e<=de;_e++){var Pe=ne[2*_e+1];Pe!==0&&(ne[2*_e]=ee(Ce[Pe]++,Pe))}}function Q(ne){var de;for(de=0;de<E;de++)ne.dyn_ltree[2*de]=0;for(de=0;de<N;de++)ne.dyn_dtree[2*de]=0;for(de=0;de<19;de++)ne.bl_tree[2*de]=0;ne.dyn_ltree[512]=1,ne.opt_len=ne.static_len=0,ne.last_lit=ne.matches=0}function P(ne){8<ne.bi_valid?R(ne,ne.bi_buf):0<ne.bi_valid&&(ne.pending_buf[ne.pending++]=ne.bi_buf),ne.bi_buf=0,ne.bi_valid=0}function F(ne,de,fe,Se){var _e=2*de,Ce=2*fe;return ne[_e]<ne[Ce]||ne[_e]===ne[Ce]&&Se[de]<=Se[fe]}function Z(ne,de,fe){for(var Se=ne.heap[fe],_e=fe<<1;_e<=ne.heap_len&&(_e<ne.heap_len&&F(de,ne.heap[_e+1],ne.heap[_e],ne.depth)&&_e++,!F(de,Se,ne.heap[_e],ne.depth));)ne.heap[fe]=ne.heap[_e],fe=_e,_e<<=1;ne.heap[fe]=Se}function se(ne,de,fe){var Se,_e,Ce,Re,Pe=0;if(ne.last_lit!==0)for(;Se=ne.pending_buf[ne.d_buf+2*Pe]<<8|ne.pending_buf[ne.d_buf+2*Pe+1],_e=ne.pending_buf[ne.l_buf+Pe],Pe++,Se===0?Y(ne,_e,de):(Y(ne,(Ce=D[_e])+y+1,de),(Re=L[Ce])!==0&&X(ne,_e-=M[Ce],Re),Y(ne,Ce=B(--Se),fe),(Re=H[Ce])!==0&&X(ne,Se-=A[Ce],Re)),Pe<ne.last_lit;);Y(ne,256,de)}function re(ne,de){var fe,Se,_e,Ce=de.dyn_tree,Re=de.stat_desc.static_tree,Pe=de.stat_desc.has_stree,Ye=de.stat_desc.elems,at=-1;for(ne.heap_len=0,ne.heap_max=573,fe=0;fe<Ye;fe++)Ce[2*fe]!==0?(ne.heap[++ne.heap_len]=at=fe,ne.depth[fe]=0):Ce[2*fe+1]=0;for(;ne.heap_len<2;)Ce[2*(_e=ne.heap[++ne.heap_len]=at<2?++at:0)]=1,ne.depth[_e]=0,ne.opt_len--,Pe&&(ne.static_len-=Re[2*_e+1]);for(de.max_code=at,fe=ne.heap_len>>1;1<=fe;fe--)Z(ne,Ce,fe);for(_e=Ye;fe=ne.heap[1],ne.heap[1]=ne.heap[ne.heap_len--],Z(ne,Ce,1),Se=ne.heap[1],ne.heap[--ne.heap_max]=fe,ne.heap[--ne.heap_max]=Se,Ce[2*_e]=Ce[2*fe]+Ce[2*Se],ne.depth[_e]=(ne.depth[fe]>=ne.depth[Se]?ne.depth[fe]:ne.depth[Se])+1,Ce[2*fe+1]=Ce[2*Se+1]=_e,ne.heap[1]=_e++,Z(ne,Ce,1),2<=ne.heap_len;);ne.heap[--ne.heap_max]=ne.heap[1],function(tt,it){var rt,ct,Oe,pt,Je,ot,ut=it.dyn_tree,_t=it.max_code,vt=it.stat_desc.static_tree,ht=it.stat_desc.has_stree,$e=it.stat_desc.extra_bits,Be=it.stat_desc.extra_base,wt=it.stat_desc.max_length,et=0;for(pt=0;pt<=I;pt++)tt.bl_count[pt]=0;for(ut[2*tt.heap[tt.heap_max]+1]=0,rt=tt.heap_max+1;rt<573;rt++)wt<(pt=ut[2*ut[2*(ct=tt.heap[rt])+1]+1]+1)&&(pt=wt,et++),ut[2*ct+1]=pt,_t<ct||(tt.bl_count[pt]++,Je=0,Be<=ct&&(Je=$e[ct-Be]),ot=ut[2*ct],tt.opt_len+=ot*(pt+Je),ht&&(tt.static_len+=ot*(vt[2*ct+1]+Je)));if(et!==0){do{for(pt=wt-1;tt.bl_count[pt]===0;)pt--;tt.bl_count[pt]--,tt.bl_count[pt+1]+=2,tt.bl_count[wt]--,et-=2}while(0<et);for(pt=wt;pt!==0;pt--)for(ct=tt.bl_count[pt];ct!==0;)_t<(Oe=tt.heap[--rt])||(ut[2*Oe+1]!==pt&&(tt.opt_len+=(pt-ut[2*Oe+1])*ut[2*Oe],ut[2*Oe+1]=pt),ct--)}}(ne,de),U(Ce,at,ne.bl_count)}function ae(ne,de,fe){var Se,_e,Ce=-1,Re=de[1],Pe=0,Ye=7,at=4;for(Re===0&&(Ye=138,at=3),de[2*(fe+1)+1]=65535,Se=0;Se<=fe;Se++)_e=Re,Re=de[2*(Se+1)+1],++Pe<Ye&&_e===Re||(Pe<at?ne.bl_tree[2*_e]+=Pe:_e!==0?(_e!==Ce&&ne.bl_tree[2*_e]++,ne.bl_tree[32]++):Pe<=10?ne.bl_tree[34]++:ne.bl_tree[36]++,Ce=_e,at=(Pe=0)===Re?(Ye=138,3):_e===Re?(Ye=6,3):(Ye=7,4))}function te(ne,de,fe){var Se,_e,Ce=-1,Re=de[1],Pe=0,Ye=7,at=4;for(Re===0&&(Ye=138,at=3),Se=0;Se<=fe;Se++)if(_e=Re,Re=de[2*(Se+1)+1],!(++Pe<Ye&&_e===Re)){if(Pe<at)for(;Y(ne,_e,ne.bl_tree),--Pe!=0;);else _e!==0?(_e!==Ce&&(Y(ne,_e,ne.bl_tree),Pe--),Y(ne,16,ne.bl_tree),X(ne,Pe-3,2)):Pe<=10?(Y(ne,17,ne.bl_tree),X(ne,Pe-3,3)):(Y(ne,18,ne.bl_tree),X(ne,Pe-11,7));Ce=_e,at=(Pe=0)===Re?(Ye=138,3):_e===Re?(Ye=6,3):(Ye=7,4)}}x(A);var he=!1;function le(ne,de,fe,Se){X(ne,0+(Se?1:0),3),function(_e,Ce,Re,Pe){P(_e),R(_e,Re),R(_e,~Re),g.arraySet(_e.pending_buf,_e.window,Ce,Re,_e.pending),_e.pending+=Re}(ne,de,fe)}b._tr_init=function(ne){he||(function(){var de,fe,Se,_e,Ce,Re=new Array(16);for(_e=Se=0;_e<28;_e++)for(M[_e]=Se,de=0;de<1<<L[_e];de++)D[Se++]=_e;for(D[Se-1]=_e,_e=Ce=0;_e<16;_e++)for(A[_e]=Ce,de=0;de<1<<H[_e];de++)W[Ce++]=_e;for(Ce>>=7;_e<N;_e++)for(A[_e]=Ce<<7,de=0;de<1<<H[_e]-7;de++)W[256+Ce++]=_e;for(fe=0;fe<=I;fe++)Re[fe]=0;for(de=0;de<=143;)K[2*de+1]=8,de++,Re[8]++;for(;de<=255;)K[2*de+1]=9,de++,Re[9]++;for(;de<=279;)K[2*de+1]=7,de++,Re[7]++;for(;de<=287;)K[2*de+1]=8,de++,Re[8]++;for(U(K,287,Re),de=0;de<N;de++)z[2*de+1]=5,z[2*de]=ee(de,5);C=new S(K,L,257,E,I),w=new S(z,H,0,N,I),T=new S(new Array(0),V,0,19,7)}(),he=!0),ne.l_desc=new j(ne.dyn_ltree,C),ne.d_desc=new j(ne.dyn_dtree,w),ne.bl_desc=new j(ne.bl_tree,T),ne.bi_buf=0,ne.bi_valid=0,Q(ne)},b._tr_stored_block=le,b._tr_flush_block=function(ne,de,fe,Se){var _e,Ce,Re=0;0<ne.level?(ne.strm.data_type===2&&(ne.strm.data_type=function(Pe){var Ye,at=4093624447;for(Ye=0;Ye<=31;Ye++,at>>>=1)if(1&at&&Pe.dyn_ltree[2*Ye]!==0)return 0;if(Pe.dyn_ltree[18]!==0||Pe.dyn_ltree[20]!==0||Pe.dyn_ltree[26]!==0)return 1;for(Ye=32;Ye<y;Ye++)if(Pe.dyn_ltree[2*Ye]!==0)return 1;return 0}(ne)),re(ne,ne.l_desc),re(ne,ne.d_desc),Re=function(Pe){var Ye;for(ae(Pe,Pe.dyn_ltree,Pe.l_desc.max_code),ae(Pe,Pe.dyn_dtree,Pe.d_desc.max_code),re(Pe,Pe.bl_desc),Ye=18;3<=Ye&&Pe.bl_tree[2*q[Ye]+1]===0;Ye--);return Pe.opt_len+=3*(Ye+1)+5+5+4,Ye}(ne),_e=ne.opt_len+3+7>>>3,(Ce=ne.static_len+3+7>>>3)<=_e&&(_e=Ce)):_e=Ce=fe+5,fe+4<=_e&&de!==-1?le(ne,de,fe,Se):ne.strategy===4||Ce===_e?(X(ne,2+(Se?1:0),3),se(ne,K,z)):(X(ne,4+(Se?1:0),3),function(Pe,Ye,at,tt){var it;for(X(Pe,Ye-257,5),X(Pe,at-1,5),X(Pe,tt-4,4),it=0;it<tt;it++)X(Pe,Pe.bl_tree[2*q[it]+1],3);te(Pe,Pe.dyn_ltree,Ye-1),te(Pe,Pe.dyn_dtree,at-1)}(ne,ne.l_desc.max_code+1,ne.d_desc.max_code+1,Re+1),se(ne,ne.dyn_ltree,ne.dyn_dtree)),Q(ne),Se&&P(ne)},b._tr_tally=function(ne,de,fe){return ne.pending_buf[ne.d_buf+2*ne.last_lit]=de>>>8&255,ne.pending_buf[ne.d_buf+2*ne.last_lit+1]=255&de,ne.pending_buf[ne.l_buf+ne.last_lit]=255&fe,ne.last_lit++,de===0?ne.dyn_ltree[2*fe]++:(ne.matches++,de--,ne.dyn_ltree[2*(D[fe]+y+1)]++,ne.dyn_dtree[2*B(de)]++),ne.last_lit===ne.lit_bufsize-1},b._tr_align=function(ne){X(ne,2,3),Y(ne,256,K),function(de){de.bi_valid===16?(R(de,de.bi_buf),de.bi_buf=0,de.bi_valid=0):8<=de.bi_valid&&(de.pending_buf[de.pending++]=255&de.bi_buf,de.bi_buf>>=8,de.bi_valid-=8)}(ne)}},{"../utils/common":41}],53:[function(h,v,b){v.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(h,v,b){(function(g){(function(x,y){if(!x.setImmediate){var E,N,I,L,H=1,V={},q=!1,K=x.document,z=Object.getPrototypeOf&&Object.getPrototypeOf(x);z=z&&z.setTimeout?z:x,E={}.toString.call(x.process)==="[object process]"?function(C){o.nextTick(function(){D(C)})}:function(){if(x.postMessage&&!x.importScripts){var C=!0,w=x.onmessage;return x.onmessage=function(){C=!1},x.postMessage("","*"),x.onmessage=w,C}}()?(L="setImmediate$"+Math.random()+"$",x.addEventListener?x.addEventListener("message",M,!1):x.attachEvent("onmessage",M),function(C){x.postMessage(L+C,"*")}):x.MessageChannel?((I=new MessageChannel).port1.onmessage=function(C){D(C.data)},function(C){I.port2.postMessage(C)}):K&&"onreadystatechange"in K.createElement("script")?(N=K.documentElement,function(C){var w=K.createElement("script");w.onreadystatechange=function(){D(C),w.onreadystatechange=null,N.removeChild(w),w=null},N.appendChild(w)}):function(C){setTimeout(D,0,C)},z.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var w=new Array(arguments.length-1),T=0;T<w.length;T++)w[T]=arguments[T+1];var A={callback:C,args:w};return V[H]=A,E(H),H++},z.clearImmediate=W}function W(C){delete V[C]}function D(C){if(q)setTimeout(D,0,C);else{var w=V[C];if(w){q=!0;try{(function(T){var A=T.callback,S=T.args;switch(S.length){case 0:A();break;case 1:A(S[0]);break;case 2:A(S[0],S[1]);break;case 3:A(S[0],S[1],S[2]);break;default:A.apply(void 0,S)}})(w)}finally{W(C),q=!1}}}}function M(C){C.source===x&&typeof C.data=="string"&&C.data.indexOf(L)===0&&D(+C.data.slice(L.length))}})(typeof self>"u"?g===void 0?this:g:self)}).call(this,s!==void 0?s:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],e("timers").setImmediate)},{_process:467,buffer:220,timers:523}],442:[function(e,n,a){(function(o){(function(){var s=/[\\^$.*+?()[\]{}|]/g,l=RegExp(s.source),c=typeof o=="object"&&o&&o.Object===Object&&o,i=typeof self=="object"&&self&&self.Object===Object&&self,u=c||i||Function("return this")(),p=Object.prototype.toString,f=u.Symbol,h=f?f.prototype:void 0,v=h?h.toString:void 0;function b(g){if(typeof g=="string")return g;if(function(y){return typeof y=="symbol"||function(E){return!!E&&typeof E=="object"}(y)&&p.call(y)=="[object Symbol]"}(g))return v?v.call(g):"";var x=g+"";return x=="0"&&1/g==-1/0?"-0":x}n.exports=function(g){var x;return(g=(x=g)==null?"":b(x))&&l.test(g)?g.replace(s,"\\$&"):g}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],443:[function(e,n,a){(function(o){(function(){var s="[object Arguments]",l="[object Map]",c="[object Object]",i="[object Set]",u=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,p=/^\w*$/,f=/^\./,h=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,v=/\\(\\)?/g,b=/^\[object .+?Constructor\]$/,g=/^(?:0|[1-9]\d*)$/,x={};x["[object Float32Array]"]=x["[object Float64Array]"]=x["[object Int8Array]"]=x["[object Int16Array]"]=x["[object Int32Array]"]=x["[object Uint8Array]"]=x["[object Uint8ClampedArray]"]=x["[object Uint16Array]"]=x["[object Uint32Array]"]=!0,x[s]=x["[object Array]"]=x["[object ArrayBuffer]"]=x["[object Boolean]"]=x["[object DataView]"]=x["[object Date]"]=x["[object Error]"]=x["[object Function]"]=x[l]=x["[object Number]"]=x[c]=x["[object RegExp]"]=x[i]=x["[object String]"]=x["[object WeakMap]"]=!1;var y=typeof o=="object"&&o&&o.Object===Object&&o,E=typeof self=="object"&&self&&self.Object===Object&&self,N=y||E||Function("return this")(),I=typeof a=="object"&&a&&!a.nodeType&&a,L=I&&typeof n=="object"&&n&&!n.nodeType&&n,H=L&&L.exports===I&&y.process,V=function(){try{return H&&H.binding("util")}catch{}}(),q=V&&V.isTypedArray;function K(ce,Te,qe,st){for(var Et=-1,gt=ce?ce.length:0;++Et<gt;){var kt=ce[Et];Te(st,kt,qe(kt),ce)}return st}function z(ce,Te){for(var qe=-1,st=ce?ce.length:0;++qe<st;)if(Te(ce[qe],qe,ce))return!0;return!1}function W(ce){var Te=!1;if(ce!=null&&typeof ce.toString!="function")try{Te=!!(ce+"")}catch{}return Te}function D(ce){var Te=-1,qe=Array(ce.size);return ce.forEach(function(st,Et){qe[++Te]=[Et,st]}),qe}function M(ce){var Te=-1,qe=Array(ce.size);return ce.forEach(function(st){qe[++Te]=st}),qe}var C,w,T,A=Array.prototype,S=Function.prototype,j=Object.prototype,B=N["__core-js_shared__"],R=(C=/[^.]+$/.exec(B&&B.keys&&B.keys.IE_PROTO||""))?"Symbol(src)_1."+C:"",X=S.toString,Y=j.hasOwnProperty,ee=j.toString,U=RegExp("^"+X.call(Y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Q=N.Symbol,P=N.Uint8Array,F=j.propertyIsEnumerable,Z=A.splice,se=(w=Object.keys,T=Object,function(ce){return w(T(ce))}),re=lt(N,"DataView"),ae=lt(N,"Map"),te=lt(N,"Promise"),he=lt(N,"Set"),le=lt(N,"WeakMap"),ne=lt(Object,"create"),de=Le(re),fe=Le(ae),Se=Le(te),_e=Le(he),Ce=Le(le),Re=Q?Q.prototype:void 0,Pe=Re?Re.valueOf:void 0,Ye=Re?Re.toString:void 0;function at(ce){var Te=-1,qe=ce?ce.length:0;for(this.clear();++Te<qe;){var st=ce[Te];this.set(st[0],st[1])}}function tt(ce){var Te=-1,qe=ce?ce.length:0;for(this.clear();++Te<qe;){var st=ce[Te];this.set(st[0],st[1])}}function it(ce){var Te=-1,qe=ce?ce.length:0;for(this.clear();++Te<qe;){var st=ce[Te];this.set(st[0],st[1])}}function rt(ce){var Te=-1,qe=ce?ce.length:0;for(this.__data__=new it;++Te<qe;)this.add(ce[Te])}function ct(ce){this.__data__=new tt(ce)}function Oe(ce,Te){var qe=ve(ce)||me(ce)?function(kt,Zt){for(var Ut=-1,zt=Array(kt);++Ut<kt;)zt[Ut]=Zt(Ut);return zt}(ce.length,String):[],st=qe.length,Et=!!st;for(var gt in ce)!Y.call(ce,gt)||Et&&(gt=="length"||$t(gt,st))||qe.push(gt);return qe}function pt(ce,Te){for(var qe=ce.length;qe--;)if(ue(ce[qe][0],Te))return qe;return-1}function Je(ce,Te,qe,st){return ut(ce,function(Et,gt,kt){Te(st,Et,qe(Et),kt)}),st}at.prototype.clear=function(){this.__data__=ne?ne(null):{}},at.prototype.delete=function(ce){return this.has(ce)&&delete this.__data__[ce]},at.prototype.get=function(ce){var Te=this.__data__;if(ne){var qe=Te[ce];return qe==="__lodash_hash_undefined__"?void 0:qe}return Y.call(Te,ce)?Te[ce]:void 0},at.prototype.has=function(ce){var Te=this.__data__;return ne?Te[ce]!==void 0:Y.call(Te,ce)},at.prototype.set=function(ce,Te){return this.__data__[ce]=ne&&Te===void 0?"__lodash_hash_undefined__":Te,this},tt.prototype.clear=function(){this.__data__=[]},tt.prototype.delete=function(ce){var Te=this.__data__,qe=pt(Te,ce);return!(qe<0)&&(qe==Te.length-1?Te.pop():Z.call(Te,qe,1),!0)},tt.prototype.get=function(ce){var Te=this.__data__,qe=pt(Te,ce);return qe<0?void 0:Te[qe][1]},tt.prototype.has=function(ce){return pt(this.__data__,ce)>-1},tt.prototype.set=function(ce,Te){var qe=this.__data__,st=pt(qe,ce);return st<0?qe.push([ce,Te]):qe[st][1]=Te,this},it.prototype.clear=function(){this.__data__={hash:new at,map:new(ae||tt),string:new at}},it.prototype.delete=function(ce){return Ne(this,ce).delete(ce)},it.prototype.get=function(ce){return Ne(this,ce).get(ce)},it.prototype.has=function(ce){return Ne(this,ce).has(ce)},it.prototype.set=function(ce,Te){return Ne(this,ce).set(ce,Te),this},rt.prototype.add=rt.prototype.push=function(ce){return this.__data__.set(ce,"__lodash_hash_undefined__"),this},rt.prototype.has=function(ce){return this.__data__.has(ce)},ct.prototype.clear=function(){this.__data__=new tt},ct.prototype.delete=function(ce){return this.__data__.delete(ce)},ct.prototype.get=function(ce){return this.__data__.get(ce)},ct.prototype.has=function(ce){return this.__data__.has(ce)},ct.prototype.set=function(ce,Te){var qe=this.__data__;if(qe instanceof tt){var st=qe.__data__;if(!ae||st.length<199)return st.push([ce,Te]),this;qe=this.__data__=new it(st)}return qe.set(ce,Te),this};var ot,ut=(ot=function(ce,Te){return ce&&_t(ce,Te,Ee)},function(ce,Te){if(ce==null)return ce;if(!ge(ce))return ot(ce,Te);for(var qe=ce.length,st=-1,Et=Object(ce);++st<qe&&Te(Et[st],st,Et)!==!1;);return ce}),_t=function(ce){return function(Te,qe,st){for(var Et=-1,gt=Object(Te),kt=st(Te),Zt=kt.length;Zt--;){var Ut=kt[++Et];if(qe(gt[Ut],Ut,gt)===!1)break}return Te}}();function vt(ce,Te){for(var qe=0,st=(Te=ke(Te,ce)?[Te]:dt(Te)).length;ce!=null&&qe<st;)ce=ce[Ae(Te[qe++])];return qe&&qe==st?ce:void 0}function ht(ce,Te){return ce!=null&&Te in Object(ce)}function $e(ce,Te,qe,st,Et){return ce===Te||(ce==null||Te==null||!Me(ce)&&!Ve(Te)?ce!=ce&&Te!=Te:function(gt,kt,Zt,Ut,zt,It){var er=ve(gt),mr=ve(kt),tr="[object Array]",Dr="[object Array]";er||(tr=(tr=Ct(gt))==s?c:tr),mr||(Dr=(Dr=Ct(kt))==s?c:Dr);var en=tr==c&&!W(gt),tn=Dr==c&&!W(kt),Qn=tr==Dr;if(Qn&&!en)return It||(It=new ct),er||xe(gt)?we(gt,kt,Zt,Ut,zt,It):function(gr,ir,qn,fs,ao,rn,Ha){switch(qn){case"[object DataView]":if(gr.byteLength!=ir.byteLength||gr.byteOffset!=ir.byteOffset)return!1;gr=gr.buffer,ir=ir.buffer;case"[object ArrayBuffer]":return!(gr.byteLength!=ir.byteLength||!fs(new P(gr),new P(ir)));case"[object Boolean]":case"[object Date]":case"[object Number]":return ue(+gr,+ir);case"[object Error]":return gr.name==ir.name&&gr.message==ir.message;case"[object RegExp]":case"[object String]":return gr==ir+"";case l:var qa=D;case i:var di=2&rn;if(qa||(qa=M),gr.size!=ir.size&&!di)return!1;var fi=Ha.get(gr);if(fi)return fi==ir;rn|=1,Ha.set(gr,ir);var hi=we(qa(gr),qa(ir),fs,ao,rn,Ha);return Ha.delete(gr),hi;case"[object Symbol]":if(Pe)return Pe.call(gr)==Pe.call(ir)}return!1}(gt,kt,tr,Zt,Ut,zt,It);if(!(2&zt)){var ka=en&&Y.call(gt,"__wrapped__"),ui=tn&&Y.call(kt,"__wrapped__");if(ka||ui){var hn=ka?gt.value():gt,ds=ui?kt.value():kt;return It||(It=new ct),Zt(hn,ds,Ut,zt,It)}}return Qn?(It||(It=new ct),function(gr,ir,qn,fs,ao,rn){var Ha=2&ao,qa=Ee(gr),di=qa.length,fi=Ee(ir).length;if(di!=fi&&!Ha)return!1;for(var hi=di;hi--;){var hs=qa[hi];if(!(Ha?hs in ir:Y.call(ir,hs)))return!1}var so=rn.get(gr);if(so&&rn.get(ir))return so==ir;var pi=!0;rn.set(gr,ir),rn.set(ir,gr);for(var io=Ha;++hi<di;){hs=qa[hi];var Wa=gr[hs],Ga=ir[hs];if(fs)var sc=Ha?fs(Ga,Wa,hs,ir,gr,rn):fs(Wa,Ga,hs,gr,ir,rn);if(!(sc===void 0?Wa===Ga||qn(Wa,Ga,fs,ao,rn):sc)){pi=!1;break}io||(io=hs=="constructor")}if(pi&&!io){var mi=gr.constructor,oo=ir.constructor;mi==oo||!("constructor"in gr)||!("constructor"in ir)||typeof mi=="function"&&mi instanceof mi&&typeof oo=="function"&&oo instanceof oo||(pi=!1)}return rn.delete(gr),rn.delete(ir),pi}(gt,kt,Zt,Ut,zt,It)):!1}(ce,Te,$e,qe,st,Et))}function Be(ce){return!(!Me(ce)||function(Te){return!!R&&R in Te}(ce))&&(Fe(ce)||W(ce)?U:b).test(Le(ce))}function wt(ce){return typeof ce=="function"?ce:ce==null?We:typeof ce=="object"?ve(ce)?function(st,Et){return ke(st)&&De(Et)?bt(Ae(st),Et):function(gt){var kt=function(Zt,Ut,zt){var It=Zt==null?void 0:vt(Zt,Ut);return It===void 0?zt:It}(gt,st);return kt===void 0&&kt===Et?function(Zt,Ut){return Zt!=null&&function(zt,It,er){It=ke(It,zt)?[It]:dt(It);for(var mr,tr=-1,Dr=It.length;++tr<Dr;){var en=Ae(It[tr]);if(!(mr=zt!=null&&er(zt,en)))break;zt=zt[en]}return mr||!!(Dr=zt?zt.length:0)&&Ue(Dr)&&$t(en,Dr)&&(ve(zt)||me(zt))}(Zt,Ut,ht)}(gt,st):$e(Et,kt,void 0,3)}}(ce[0],ce[1]):function(st){var Et=function(gt){for(var kt=Ee(gt),Zt=kt.length;Zt--;){var Ut=kt[Zt],zt=gt[Ut];kt[Zt]=[Ut,zt,De(zt)]}return kt}(st);return Et.length==1&&Et[0][2]?bt(Et[0][0],Et[0][1]):function(gt){return gt===st||function(kt,Zt,Ut,zt){var It=Ut.length,er=It;if(kt==null)return!er;for(kt=Object(kt);It--;){var mr=Ut[It];if(mr[2]?mr[1]!==kt[mr[0]]:!(mr[0]in kt))return!1}for(;++It<er;){var tr=(mr=Ut[It])[0],Dr=kt[tr],en=mr[1];if(mr[2]){if(Dr===void 0&&!(tr in kt))return!1}else{var tn=new ct,Qn;if(!(Qn===void 0?$e(en,Dr,zt,3,tn):Qn))return!1}}return!0}(gt,st,Et)}}(ce):ke(Te=ce)?(qe=Ae(Te),function(st){return st==null?void 0:st[qe]}):function(st){return function(Et){return vt(Et,st)}}(Te);var Te,qe}function et(ce){if(qe=(Te=ce)&&Te.constructor,st=typeof qe=="function"&&qe.prototype||j,Te!==st)return se(ce);var Te,qe,st,Et=[];for(var gt in Object(ce))Y.call(ce,gt)&&gt!="constructor"&&Et.push(gt);return Et}function dt(ce){return ve(ce)?ce:xt(ce)}function we(ce,Te,qe,st,Et,gt){var kt=2&Et,Zt=ce.length,Ut=Te.length;if(Zt!=Ut&&!(kt&&Ut>Zt))return!1;var zt=gt.get(ce);if(zt&&gt.get(Te))return zt==Te;var It=-1,er=!0,mr=1&Et?new rt:void 0;for(gt.set(ce,Te),gt.set(Te,ce);++It<Zt;){var tr=ce[It],Dr=Te[It];if(st)var en=kt?st(Dr,tr,It,Te,ce,gt):st(tr,Dr,It,ce,Te,gt);if(en!==void 0){if(en)continue;er=!1;break}if(mr){if(!z(Te,function(tn,Qn){if(!mr.has(Qn)&&(tr===tn||qe(tr,tn,st,Et,gt)))return mr.add(Qn)})){er=!1;break}}else if(tr!==Dr&&!qe(tr,Dr,st,Et,gt)){er=!1;break}}return gt.delete(ce),gt.delete(Te),er}function Ne(ce,Te){var qe,st,Et=ce.__data__;return((st=typeof(qe=Te))=="string"||st=="number"||st=="symbol"||st=="boolean"?qe!=="__proto__":qe===null)?Et[typeof Te=="string"?"string":"hash"]:Et.map}function lt(ce,Te){var qe=function(st,Et){return st==null?void 0:st[Et]}(ce,Te);return Be(qe)?qe:void 0}var Ct=function(ce){return ee.call(ce)};function $t(ce,Te){return!!(Te=Te??9007199254740991)&&(typeof ce=="number"||g.test(ce))&&ce>-1&&ce%1==0&&ce<Te}function ke(ce,Te){if(ve(ce))return!1;var qe=typeof ce;return!(qe!="number"&&qe!="symbol"&&qe!="boolean"&&ce!=null&&!ze(ce))||p.test(ce)||!u.test(ce)||Te!=null&&ce in Object(Te)}function De(ce){return ce==ce&&!Me(ce)}function bt(ce,Te){return function(qe){return qe!=null&&qe[ce]===Te&&(Te!==void 0||ce in Object(qe))}}(re&&Ct(new re(new ArrayBuffer(1)))!="[object DataView]"||ae&&Ct(new ae)!=l||te&&Ct(te.resolve())!="[object Promise]"||he&&Ct(new he)!=i||le&&Ct(new le)!="[object WeakMap]")&&(Ct=function(ce){var Te=ee.call(ce),qe=Te==c?ce.constructor:void 0,st=qe?Le(qe):void 0;if(st)switch(st){case de:return"[object DataView]";case fe:return l;case Se:return"[object Promise]";case _e:return i;case Ce:return"[object WeakMap]"}return Te});var xt=be(function(ce){var Te;ce=(Te=ce)==null?"":function(st){if(typeof st=="string")return st;if(ze(st))return Ye?Ye.call(st):"";var Et=st+"";return Et=="0"&&1/st==-1/0?"-0":Et}(Te);var qe=[];return f.test(ce)&&qe.push(""),ce.replace(h,function(st,Et,gt,kt){qe.push(gt?kt.replace(v,"$1"):Et||st)}),qe});function Ae(ce){if(typeof ce=="string"||ze(ce))return ce;var Te=ce+"";return Te=="0"&&1/ce==-1/0?"-0":Te}function Le(ce){if(ce!=null){try{return X.call(ce)}catch{}try{return ce+""}catch{}}return""}var nt,ie=(nt=function(ce,Te,qe){Y.call(ce,qe)?ce[qe].push(Te):ce[qe]=[Te]},function(ce,Te){var qe=ve(ce)?K:Je,st={};return qe(ce,nt,wt(Te),st)});function be(ce,Te){if(typeof ce!="function"||Te&&typeof Te!="function")throw new TypeError("Expected a function");var qe=function(){var st=arguments,Et=Te?Te.apply(this,st):st[0],gt=qe.cache;if(gt.has(Et))return gt.get(Et);var kt=ce.apply(this,st);return qe.cache=gt.set(Et,kt),kt};return qe.cache=new(be.Cache||it),qe}function ue(ce,Te){return ce===Te||ce!=ce&&Te!=Te}function me(ce){return function(Te){return Ve(Te)&&ge(Te)}(ce)&&Y.call(ce,"callee")&&(!F.call(ce,"callee")||ee.call(ce)==s)}be.Cache=it;var ve=Array.isArray;function ge(ce){return ce!=null&&Ue(ce.length)&&!Fe(ce)}function Fe(ce){var Te=Me(ce)?ee.call(ce):"";return Te=="[object Function]"||Te=="[object GeneratorFunction]"}function Ue(ce){return typeof ce=="number"&&ce>-1&&ce%1==0&&ce<=9007199254740991}function Me(ce){var Te=typeof ce;return!!ce&&(Te=="object"||Te=="function")}function Ve(ce){return!!ce&&typeof ce=="object"}function ze(ce){return typeof ce=="symbol"||Ve(ce)&&ee.call(ce)=="[object Symbol]"}var xe=q?function(ce){return function(Te){return ce(Te)}}(q):function(ce){return Ve(ce)&&Ue(ce.length)&&!!x[ee.call(ce)]};function Ee(ce){return ge(ce)?Oe(ce):et(ce)}function We(ce){return ce}n.exports=ie}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],444:[function(e,n,a){var o=Object.prototype.toString;n.exports=function(s){return s===!0||s===!1||function(l){return!!l&&typeof l=="object"}(s)&&o.call(s)=="[object Boolean]"}},{}],445:[function(e,n,a){(function(o){(function(){var s="[object Arguments]",l="[object Map]",c="[object Object]",i="[object Set]",u=/^\[object .+?Constructor\]$/,p=/^(?:0|[1-9]\d*)$/,f={};f["[object Float32Array]"]=f["[object Float64Array]"]=f["[object Int8Array]"]=f["[object Int16Array]"]=f["[object Int32Array]"]=f["[object Uint8Array]"]=f["[object Uint8ClampedArray]"]=f["[object Uint16Array]"]=f["[object Uint32Array]"]=!0,f[s]=f["[object Array]"]=f["[object ArrayBuffer]"]=f["[object Boolean]"]=f["[object DataView]"]=f["[object Date]"]=f["[object Error]"]=f["[object Function]"]=f[l]=f["[object Number]"]=f[c]=f["[object RegExp]"]=f[i]=f["[object String]"]=f["[object WeakMap]"]=!1;var h=typeof o=="object"&&o&&o.Object===Object&&o,v=typeof self=="object"&&self&&self.Object===Object&&self,b=h||v||Function("return this")(),g=typeof a=="object"&&a&&!a.nodeType&&a,x=g&&typeof n=="object"&&n&&!n.nodeType&&n,y=x&&x.exports===g,E=y&&h.process,N=function(){try{return E&&E.binding&&E.binding("util")}catch{}}(),I=N&&N.isTypedArray;function L(Ae,Le){for(var nt=-1,ie=Ae==null?0:Ae.length;++nt<ie;)if(Le(Ae[nt],nt,Ae))return!0;return!1}function H(Ae){var Le=-1,nt=Array(Ae.size);return Ae.forEach(function(ie,be){nt[++Le]=[be,ie]}),nt}function V(Ae){var Le=-1,nt=Array(Ae.size);return Ae.forEach(function(ie){nt[++Le]=ie}),nt}var q,K,z,W=Array.prototype,D=Function.prototype,M=Object.prototype,C=b["__core-js_shared__"],w=D.toString,T=M.hasOwnProperty,A=(q=/[^.]+$/.exec(C&&C.keys&&C.keys.IE_PROTO||""))?"Symbol(src)_1."+q:"",S=M.toString,j=RegExp("^"+w.call(T).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),B=y?b.Buffer:void 0,R=b.Symbol,X=b.Uint8Array,Y=M.propertyIsEnumerable,ee=W.splice,U=R?R.toStringTag:void 0,Q=Object.getOwnPropertySymbols,P=B?B.isBuffer:void 0,F=(K=Object.keys,z=Object,function(Ae){return K(z(Ae))}),Z=ht(b,"DataView"),se=ht(b,"Map"),re=ht(b,"Promise"),ae=ht(b,"Set"),te=ht(b,"WeakMap"),he=ht(Object,"create"),le=et(Z),ne=et(se),de=et(re),fe=et(ae),Se=et(te),_e=R?R.prototype:void 0,Ce=_e?_e.valueOf:void 0;function Re(Ae){var Le=-1,nt=Ae==null?0:Ae.length;for(this.clear();++Le<nt;){var ie=Ae[Le];this.set(ie[0],ie[1])}}function Pe(Ae){var Le=-1,nt=Ae==null?0:Ae.length;for(this.clear();++Le<nt;){var ie=Ae[Le];this.set(ie[0],ie[1])}}function Ye(Ae){var Le=-1,nt=Ae==null?0:Ae.length;for(this.clear();++Le<nt;){var ie=Ae[Le];this.set(ie[0],ie[1])}}function at(Ae){var Le=-1,nt=Ae==null?0:Ae.length;for(this.__data__=new Ye;++Le<nt;)this.add(Ae[Le])}function tt(Ae){var Le=this.__data__=new Pe(Ae);this.size=Le.size}function it(Ae,Le){var nt=Ne(Ae),ie=!nt&&we(Ae),be=!nt&&!ie&&lt(Ae),ue=!nt&&!ie&&!be&&bt(Ae),me=nt||ie||be||ue,ve=me?function(Ue,Me){for(var Ve=-1,ze=Array(Ue);++Ve<Ue;)ze[Ve]=Me(Ve);return ze}(Ae.length,String):[],ge=ve.length;for(var Fe in Ae)!T.call(Ae,Fe)||me&&(Fe=="length"||be&&(Fe=="offset"||Fe=="parent")||ue&&(Fe=="buffer"||Fe=="byteLength"||Fe=="byteOffset")||wt(Fe,ge))||ve.push(Fe);return ve}function rt(Ae,Le){for(var nt=Ae.length;nt--;)if(dt(Ae[nt][0],Le))return nt;return-1}function ct(Ae){return Ae==null?Ae===void 0?"[object Undefined]":"[object Null]":U&&U in Object(Ae)?function(Le){var nt=T.call(Le,U),ie=Le[U];try{Le[U]=void 0;var be=!0}catch{}var ue=S.call(Le);return be&&(nt?Le[U]=ie:delete Le[U]),ue}(Ae):function(Le){return S.call(Le)}(Ae)}function Oe(Ae){return De(Ae)&&ct(Ae)==s}function pt(Ae,Le,nt,ie,be){return Ae===Le||(Ae==null||Le==null||!De(Ae)&&!De(Le)?Ae!=Ae&&Le!=Le:function(ue,me,ve,ge,Fe,Ue){var Me=Ne(ue),Ve=Ne(me),ze=Me?"[object Array]":Be(ue),xe=Ve?"[object Array]":Be(me),Ee=(ze=ze==s?c:ze)==c,We=(xe=xe==s?c:xe)==c,ce=ze==xe;if(ce&&lt(ue)){if(!lt(me))return!1;Me=!0,Ee=!1}if(ce&&!Ee)return Ue||(Ue=new tt),Me||bt(ue)?ut(ue,me,ve,ge,Fe,Ue):function(gt,kt,Zt,Ut,zt,It,er){switch(Zt){case"[object DataView]":if(gt.byteLength!=kt.byteLength||gt.byteOffset!=kt.byteOffset)return!1;gt=gt.buffer,kt=kt.buffer;case"[object ArrayBuffer]":return!(gt.byteLength!=kt.byteLength||!It(new X(gt),new X(kt)));case"[object Boolean]":case"[object Date]":case"[object Number]":return dt(+gt,+kt);case"[object Error]":return gt.name==kt.name&&gt.message==kt.message;case"[object RegExp]":case"[object String]":return gt==kt+"";case l:var mr=H;case i:var tr=1&Ut;if(mr||(mr=V),gt.size!=kt.size&&!tr)return!1;var Dr=er.get(gt);if(Dr)return Dr==kt;Ut|=2,er.set(gt,kt);var en=ut(mr(gt),mr(kt),Ut,zt,It,er);return er.delete(gt),en;case"[object Symbol]":if(Ce)return Ce.call(gt)==Ce.call(kt)}return!1}(ue,me,ze,ve,ge,Fe,Ue);if(!(1&ve)){var Te=Ee&&T.call(ue,"__wrapped__"),qe=We&&T.call(me,"__wrapped__");if(Te||qe){var st=Te?ue.value():ue,Et=qe?me.value():me;return Ue||(Ue=new tt),Fe(st,Et,ve,ge,Ue)}}return ce?(Ue||(Ue=new tt),function(gt,kt,Zt,Ut,zt,It){var er=1&Zt,mr=_t(gt),tr=mr.length,Dr=_t(kt).length;if(tr!=Dr&&!er)return!1;for(var en=tr;en--;){var tn=mr[en];if(!(er?tn in kt:T.call(kt,tn)))return!1}var Qn=It.get(gt);if(Qn&&It.get(kt))return Qn==kt;var ka=!0;It.set(gt,kt),It.set(kt,gt);for(var ui=er;++en<tr;){tn=mr[en];var hn=gt[tn],ds=kt[tn];if(Ut)var gr=er?Ut(ds,hn,tn,kt,gt,It):Ut(hn,ds,tn,gt,kt,It);if(!(gr===void 0?hn===ds||zt(hn,ds,Zt,Ut,It):gr)){ka=!1;break}ui||(ui=tn=="constructor")}if(ka&&!ui){var ir=gt.constructor,qn=kt.constructor;ir==qn||!("constructor"in gt)||!("constructor"in kt)||typeof ir=="function"&&ir instanceof ir&&typeof qn=="function"&&qn instanceof qn||(ka=!1)}return It.delete(gt),It.delete(kt),ka}(ue,me,ve,ge,Fe,Ue)):!1}(Ae,Le,nt,ie,pt,be))}function Je(Ae){return!(!ke(Ae)||function(Le){return!!A&&A in Le}(Ae))&&(Ct(Ae)?j:u).test(et(Ae))}function ot(Ae){if(nt=(Le=Ae)&&Le.constructor,ie=typeof nt=="function"&&nt.prototype||M,Le!==ie)return F(Ae);var Le,nt,ie,be=[];for(var ue in Object(Ae))T.call(Ae,ue)&&ue!="constructor"&&be.push(ue);return be}function ut(Ae,Le,nt,ie,be,ue){var me=1&nt,ve=Ae.length,ge=Le.length;if(ve!=ge&&!(me&&ge>ve))return!1;var Fe=ue.get(Ae);if(Fe&&ue.get(Le))return Fe==Le;var Ue=-1,Me=!0,Ve=2&nt?new at:void 0;for(ue.set(Ae,Le),ue.set(Le,Ae);++Ue<ve;){var ze=Ae[Ue],xe=Le[Ue];if(ie)var Ee=me?ie(xe,ze,Ue,Le,Ae,ue):ie(ze,xe,Ue,Ae,Le,ue);if(Ee!==void 0){if(Ee)continue;Me=!1;break}if(Ve){if(!L(Le,function(We,ce){if(Te=ce,!Ve.has(Te)&&(ze===We||be(ze,We,nt,ie,ue)))return Ve.push(ce);var Te})){Me=!1;break}}else if(ze!==xe&&!be(ze,xe,nt,ie,ue)){Me=!1;break}}return ue.delete(Ae),ue.delete(Le),Me}function _t(Ae){return function(Le,nt,ie){var be=nt(Le);return Ne(Le)?be:function(ue,me){for(var ve=-1,ge=me.length,Fe=ue.length;++ve<ge;)ue[Fe+ve]=me[ve];return ue}(be,ie(Le))}(Ae,xt,$e)}function vt(Ae,Le){var nt,ie,be=Ae.__data__;return((ie=typeof(nt=Le))=="string"||ie=="number"||ie=="symbol"||ie=="boolean"?nt!=="__proto__":nt===null)?be[typeof Le=="string"?"string":"hash"]:be.map}function ht(Ae,Le){var nt=function(ie,be){return ie==null?void 0:ie[be]}(Ae,Le);return Je(nt)?nt:void 0}Re.prototype.clear=function(){this.__data__=he?he(null):{},this.size=0},Re.prototype.delete=function(Ae){var Le=this.has(Ae)&&delete this.__data__[Ae];return this.size-=Le?1:0,Le},Re.prototype.get=function(Ae){var Le=this.__data__;if(he){var nt=Le[Ae];return nt==="__lodash_hash_undefined__"?void 0:nt}return T.call(Le,Ae)?Le[Ae]:void 0},Re.prototype.has=function(Ae){var Le=this.__data__;return he?Le[Ae]!==void 0:T.call(Le,Ae)},Re.prototype.set=function(Ae,Le){var nt=this.__data__;return this.size+=this.has(Ae)?0:1,nt[Ae]=he&&Le===void 0?"__lodash_hash_undefined__":Le,this},Pe.prototype.clear=function(){this.__data__=[],this.size=0},Pe.prototype.delete=function(Ae){var Le=this.__data__,nt=rt(Le,Ae);return!(nt<0)&&(nt==Le.length-1?Le.pop():ee.call(Le,nt,1),--this.size,!0)},Pe.prototype.get=function(Ae){var Le=this.__data__,nt=rt(Le,Ae);return nt<0?void 0:Le[nt][1]},Pe.prototype.has=function(Ae){return rt(this.__data__,Ae)>-1},Pe.prototype.set=function(Ae,Le){var nt=this.__data__,ie=rt(nt,Ae);return ie<0?(++this.size,nt.push([Ae,Le])):nt[ie][1]=Le,this},Ye.prototype.clear=function(){this.size=0,this.__data__={hash:new Re,map:new(se||Pe),string:new Re}},Ye.prototype.delete=function(Ae){var Le=vt(this,Ae).delete(Ae);return this.size-=Le?1:0,Le},Ye.prototype.get=function(Ae){return vt(this,Ae).get(Ae)},Ye.prototype.has=function(Ae){return vt(this,Ae).has(Ae)},Ye.prototype.set=function(Ae,Le){var nt=vt(this,Ae),ie=nt.size;return nt.set(Ae,Le),this.size+=nt.size==ie?0:1,this},at.prototype.add=at.prototype.push=function(Ae){return this.__data__.set(Ae,"__lodash_hash_undefined__"),this},at.prototype.has=function(Ae){return this.__data__.has(Ae)},tt.prototype.clear=function(){this.__data__=new Pe,this.size=0},tt.prototype.delete=function(Ae){var Le=this.__data__,nt=Le.delete(Ae);return this.size=Le.size,nt},tt.prototype.get=function(Ae){return this.__data__.get(Ae)},tt.prototype.has=function(Ae){return this.__data__.has(Ae)},tt.prototype.set=function(Ae,Le){var nt=this.__data__;if(nt instanceof Pe){var ie=nt.__data__;if(!se||ie.length<199)return ie.push([Ae,Le]),this.size=++nt.size,this;nt=this.__data__=new Ye(ie)}return nt.set(Ae,Le),this.size=nt.size,this};var $e=Q?function(Ae){return Ae==null?[]:(Ae=Object(Ae),function(Le,nt){for(var ie=-1,be=Le==null?0:Le.length,ue=0,me=[];++ie<be;){var ve=Le[ie];nt(ve,ie,Le)&&(me[ue++]=ve)}return me}(Q(Ae),function(Le){return Y.call(Ae,Le)}))}:function(){return[]},Be=ct;function wt(Ae,Le){return!!(Le=Le??9007199254740991)&&(typeof Ae=="number"||p.test(Ae))&&Ae>-1&&Ae%1==0&&Ae<Le}function et(Ae){if(Ae!=null){try{return w.call(Ae)}catch{}try{return Ae+""}catch{}}return""}function dt(Ae,Le){return Ae===Le||Ae!=Ae&&Le!=Le}(Z&&Be(new Z(new ArrayBuffer(1)))!="[object DataView]"||se&&Be(new se)!=l||re&&Be(re.resolve())!="[object Promise]"||ae&&Be(new ae)!=i||te&&Be(new te)!="[object WeakMap]")&&(Be=function(Ae){var Le=ct(Ae),nt=Le==c?Ae.constructor:void 0,ie=nt?et(nt):"";if(ie)switch(ie){case le:return"[object DataView]";case ne:return l;case de:return"[object Promise]";case fe:return i;case Se:return"[object WeakMap]"}return Le});var we=Oe(function(){return arguments}())?Oe:function(Ae){return De(Ae)&&T.call(Ae,"callee")&&!Y.call(Ae,"callee")},Ne=Array.isArray,lt=P||function(){return!1};function Ct(Ae){if(!ke(Ae))return!1;var Le=ct(Ae);return Le=="[object Function]"||Le=="[object GeneratorFunction]"||Le=="[object AsyncFunction]"||Le=="[object Proxy]"}function $t(Ae){return typeof Ae=="number"&&Ae>-1&&Ae%1==0&&Ae<=9007199254740991}function ke(Ae){var Le=typeof Ae;return Ae!=null&&(Le=="object"||Le=="function")}function De(Ae){return Ae!=null&&typeof Ae=="object"}var bt=I?function(Ae){return function(Le){return Ae(Le)}}(I):function(Ae){return De(Ae)&&$t(Ae.length)&&!!f[ct(Ae)]};function xt(Ae){return(Le=Ae)!=null&&$t(Le.length)&&!Ct(Le)?it(Ae):ot(Ae);var Le}n.exports=function(Ae,Le){return pt(Ae,Le)}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],446:[function(e,n,a){(function(o){(function(){var s=typeof o=="object"&&o&&o.Object===Object&&o,l=typeof self=="object"&&self&&self.Object===Object&&self,c=s||l||Function("return this")(),i=Object.prototype,u=i.hasOwnProperty,p=i.toString,f=c.Symbol,h=f?f.toStringTag:void 0;function v(b){return b==null?b===void 0?"[object Undefined]":"[object Null]":h&&h in Object(b)?function(g){var x=u.call(g,h),y=g[h];try{g[h]=void 0;var E=!0}catch{}var N=p.call(g);return E&&(x?g[h]=y:delete g[h]),N}(b):function(g){return p.call(g)}(b)}n.exports=function(b){if(!function(x){var y=typeof x;return x!=null&&(y=="object"||y=="function")}(b))return!1;var g=v(b);return g=="[object Function]"||g=="[object GeneratorFunction]"||g=="[object AsyncFunction]"||g=="[object Proxy]"}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],447:[function(e,n,a){n.exports=function(o){return o==null}},{}],448:[function(e,n,a){n.exports=function(o){return o===void 0}},{}],449:[function(e,n,a){(function(o){(function(){var s=/^\[object .+?Constructor\]$/,l=typeof o=="object"&&o&&o.Object===Object&&o,c=typeof self=="object"&&self&&self.Object===Object&&self,i=l||c||Function("return this")();function u(R,X){return!!(R&&R.length)&&function(Y,ee,U){if(ee!=ee)return function(F,Z,se,re){for(var ae=F.length,te=se+-1;++te<ae;)if(Z(F[te],te,F))return te;return-1}(Y,p,U);for(var Q=U-1,P=Y.length;++Q<P;)if(Y[Q]===ee)return Q;return-1}(R,X,0)>-1}function p(R){return R!=R}function f(R,X){return R.has(X)}function h(R){var X=-1,Y=Array(R.size);return R.forEach(function(ee){Y[++X]=ee}),Y}var v,b=Array.prototype,g=Function.prototype,x=Object.prototype,y=i["__core-js_shared__"],E=(v=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+v:"",N=g.toString,I=x.hasOwnProperty,L=x.toString,H=RegExp("^"+N.call(I).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),V=b.splice,q=j(i,"Map"),K=j(i,"Set"),z=j(Object,"create");function W(R){var X=-1,Y=R?R.length:0;for(this.clear();++X<Y;){var ee=R[X];this.set(ee[0],ee[1])}}function D(R){var X=-1,Y=R?R.length:0;for(this.clear();++X<Y;){var ee=R[X];this.set(ee[0],ee[1])}}function M(R){var X=-1,Y=R?R.length:0;for(this.clear();++X<Y;){var ee=R[X];this.set(ee[0],ee[1])}}function C(R){var X=-1,Y=R?R.length:0;for(this.__data__=new M;++X<Y;)this.add(R[X])}function w(R,X){for(var Y,ee,U=R.length;U--;)if((Y=R[U][0])===(ee=X)||Y!=Y&&ee!=ee)return U;return-1}function T(R){return!(!B(R)||(X=R,E&&E in X))&&(function(Y){var ee=B(Y)?L.call(Y):"";return ee=="[object Function]"||ee=="[object GeneratorFunction]"}(R)||function(Y){var ee=!1;if(Y!=null&&typeof Y.toString!="function")try{ee=!!(Y+"")}catch{}return ee}(R)?H:s).test(function(Y){if(Y!=null){try{return N.call(Y)}catch{}try{return Y+""}catch{}}return""}(R));var X}W.prototype.clear=function(){this.__data__=z?z(null):{}},W.prototype.delete=function(R){return this.has(R)&&delete this.__data__[R]},W.prototype.get=function(R){var X=this.__data__;if(z){var Y=X[R];return Y==="__lodash_hash_undefined__"?void 0:Y}return I.call(X,R)?X[R]:void 0},W.prototype.has=function(R){var X=this.__data__;return z?X[R]!==void 0:I.call(X,R)},W.prototype.set=function(R,X){return this.__data__[R]=z&&X===void 0?"__lodash_hash_undefined__":X,this},D.prototype.clear=function(){this.__data__=[]},D.prototype.delete=function(R){var X=this.__data__,Y=w(X,R);return!(Y<0)&&(Y==X.length-1?X.pop():V.call(X,Y,1),!0)},D.prototype.get=function(R){var X=this.__data__,Y=w(X,R);return Y<0?void 0:X[Y][1]},D.prototype.has=function(R){return w(this.__data__,R)>-1},D.prototype.set=function(R,X){var Y=this.__data__,ee=w(Y,R);return ee<0?Y.push([R,X]):Y[ee][1]=X,this},M.prototype.clear=function(){this.__data__={hash:new W,map:new(q||D),string:new W}},M.prototype.delete=function(R){return S(this,R).delete(R)},M.prototype.get=function(R){return S(this,R).get(R)},M.prototype.has=function(R){return S(this,R).has(R)},M.prototype.set=function(R,X){return S(this,R).set(R,X),this},C.prototype.add=C.prototype.push=function(R){return this.__data__.set(R,"__lodash_hash_undefined__"),this},C.prototype.has=function(R){return this.__data__.has(R)};var A=K&&1/h(new K([,-0]))[1]==1/0?function(R){return new K(R)}:function(){};function S(R,X){var Y,ee,U=R.__data__;return((ee=typeof(Y=X))=="string"||ee=="number"||ee=="symbol"||ee=="boolean"?Y!=="__proto__":Y===null)?U[typeof X=="string"?"string":"hash"]:U.map}function j(R,X){var Y=function(ee,U){return ee==null?void 0:ee[U]}(R,X);return T(Y)?Y:void 0}function B(R){var X=typeof R;return!!R&&(X=="object"||X=="function")}n.exports=function(R){return R&&R.length?function(X,Y,ee){var U=-1,Q=u,P=X.length,F=!0,Z=[],se=Z;if(P>=200){var re=A(X);if(re)return h(re);F=!1,Q=f,se=new C}else se=Z;e:for(;++U<P;){var ae=X[U],te=ae;if(ae=ae!==0?ae:0,F&&te==te){for(var he=se.length;he--;)if(se[he]===te)continue e;Z.push(ae)}else Q(se,te,ee)||(se!==Z&&se.push(te),Z.push(ae))}return Z}(R):[]}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],450:[function(e,n,a){var o=e("inherits"),s=e("hash-base"),l=e("safe-buffer").Buffer,c=new Array(16);function i(){s.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function u(b,g){return b<<g|b>>>32-g}function p(b,g,x,y,E,N,I){return u(b+(g&x|~g&y)+E+N|0,I)+g|0}function f(b,g,x,y,E,N,I){return u(b+(g&y|x&~y)+E+N|0,I)+g|0}function h(b,g,x,y,E,N,I){return u(b+(g^x^y)+E+N|0,I)+g|0}function v(b,g,x,y,E,N,I){return u(b+(x^(g|~y))+E+N|0,I)+g|0}o(i,s),i.prototype._update=function(){for(var b=c,g=0;g<16;++g)b[g]=this._block.readInt32LE(4*g);var x=this._a,y=this._b,E=this._c,N=this._d;x=p(x,y,E,N,b[0],3614090360,7),N=p(N,x,y,E,b[1],3905402710,12),E=p(E,N,x,y,b[2],606105819,17),y=p(y,E,N,x,b[3],3250441966,22),x=p(x,y,E,N,b[4],4118548399,7),N=p(N,x,y,E,b[5],1200080426,12),E=p(E,N,x,y,b[6],2821735955,17),y=p(y,E,N,x,b[7],4249261313,22),x=p(x,y,E,N,b[8],1770035416,7),N=p(N,x,y,E,b[9],2336552879,12),E=p(E,N,x,y,b[10],4294925233,17),y=p(y,E,N,x,b[11],2304563134,22),x=p(x,y,E,N,b[12],1804603682,7),N=p(N,x,y,E,b[13],4254626195,12),E=p(E,N,x,y,b[14],2792965006,17),x=f(x,y=p(y,E,N,x,b[15],1236535329,22),E,N,b[1],4129170786,5),N=f(N,x,y,E,b[6],3225465664,9),E=f(E,N,x,y,b[11],643717713,14),y=f(y,E,N,x,b[0],3921069994,20),x=f(x,y,E,N,b[5],3593408605,5),N=f(N,x,y,E,b[10],38016083,9),E=f(E,N,x,y,b[15],3634488961,14),y=f(y,E,N,x,b[4],3889429448,20),x=f(x,y,E,N,b[9],568446438,5),N=f(N,x,y,E,b[14],3275163606,9),E=f(E,N,x,y,b[3],4107603335,14),y=f(y,E,N,x,b[8],1163531501,20),x=f(x,y,E,N,b[13],2850285829,5),N=f(N,x,y,E,b[2],4243563512,9),E=f(E,N,x,y,b[7],1735328473,14),x=h(x,y=f(y,E,N,x,b[12],2368359562,20),E,N,b[5],4294588738,4),N=h(N,x,y,E,b[8],2272392833,11),E=h(E,N,x,y,b[11],1839030562,16),y=h(y,E,N,x,b[14],4259657740,23),x=h(x,y,E,N,b[1],2763975236,4),N=h(N,x,y,E,b[4],1272893353,11),E=h(E,N,x,y,b[7],4139469664,16),y=h(y,E,N,x,b[10],3200236656,23),x=h(x,y,E,N,b[13],681279174,4),N=h(N,x,y,E,b[0],3936430074,11),E=h(E,N,x,y,b[3],3572445317,16),y=h(y,E,N,x,b[6],76029189,23),x=h(x,y,E,N,b[9],3654602809,4),N=h(N,x,y,E,b[12],3873151461,11),E=h(E,N,x,y,b[15],530742520,16),x=v(x,y=h(y,E,N,x,b[2],3299628645,23),E,N,b[0],4096336452,6),N=v(N,x,y,E,b[7],1126891415,10),E=v(E,N,x,y,b[14],2878612391,15),y=v(y,E,N,x,b[5],4237533241,21),x=v(x,y,E,N,b[12],1700485571,6),N=v(N,x,y,E,b[3],2399980690,10),E=v(E,N,x,y,b[10],4293915773,15),y=v(y,E,N,x,b[1],2240044497,21),x=v(x,y,E,N,b[8],1873313359,6),N=v(N,x,y,E,b[15],4264355552,10),E=v(E,N,x,y,b[6],2734768916,15),y=v(y,E,N,x,b[13],1309151649,21),x=v(x,y,E,N,b[4],4149444226,6),N=v(N,x,y,E,b[11],3174756917,10),E=v(E,N,x,y,b[2],718787259,15),y=v(y,E,N,x,b[9],3951481745,21),this._a=this._a+x|0,this._b=this._b+y|0,this._c=this._c+E|0,this._d=this._d+N|0},i.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var b=l.allocUnsafe(16);return b.writeInt32LE(this._a,0),b.writeInt32LE(this._b,4),b.writeInt32LE(this._c,8),b.writeInt32LE(this._d,12),b},n.exports=i},{"hash-base":425,inherits:440,"safe-buffer":494}],451:[function(e,n,a){var o=e("bn.js"),s=e("brorand");function l(c){this.rand=c||new s.Rand}n.exports=l,l.create=function(c){return new l(c)},l.prototype._randbelow=function(c){var i=c.bitLength(),u=Math.ceil(i/8);do var p=new o(this.rand.generate(u));while(p.cmp(c)>=0);return p},l.prototype._randrange=function(c,i){var u=i.sub(c);return c.add(this._randbelow(u))},l.prototype.test=function(c,i,u){var p=c.bitLength(),f=o.mont(c),h=new o(1).toRed(f);i||(i=Math.max(1,p/48|0));for(var v=c.subn(1),b=0;!v.testn(b);b++);for(var g=c.shrn(b),x=v.toRed(f);i>0;i--){var y=this._randrange(new o(2),v);u&&u(y);var E=y.toRed(f).redPow(g);if(E.cmp(h)!==0&&E.cmp(x)!==0){for(var N=1;N<b;N++){if((E=E.redSqr()).cmp(h)===0)return!1;if(E.cmp(x)===0)break}if(N===b)return!1}}return!0},l.prototype.getDivisor=function(c,i){var u=c.bitLength(),p=o.mont(c),f=new o(1).toRed(p);i||(i=Math.max(1,u/48|0));for(var h=c.subn(1),v=0;!h.testn(v);v++);for(var b=c.shrn(v),g=h.toRed(p);i>0;i--){var x=this._randrange(new o(2),h),y=c.gcd(x);if(y.cmpn(1)!==0)return y;var E=x.toRed(p).redPow(b);if(E.cmp(f)!==0&&E.cmp(g)!==0){for(var N=1;N<v;N++){if((E=E.redSqr()).cmp(f)===0)return E.fromRed().subn(1).gcd(c);if(E.cmp(g)===0)break}if(N===v)return(E=E.redSqr()).fromRed().subn(1).gcd(c)}}return!1}},{"bn.js":452,brorand:187}],452:[function(e,n,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],453:[function(e,n,a){function o(s,l){if(!s)throw new Error(l||"Assertion failed")}n.exports=o,o.equal=function(s,l,c){if(s!=l)throw new Error(c||"Assertion failed: "+s+" != "+l)}},{}],454:[function(e,n,a){var o=a;function s(c){return c.length===1?"0"+c:c}function l(c){for(var i="",u=0;u<c.length;u++)i+=s(c[u].toString(16));return i}o.toArray=function(c,i){if(Array.isArray(c))return c.slice();if(!c)return[];var u=[];if(typeof c!="string"){for(var p=0;p<c.length;p++)u[p]=0|c[p];return u}if(i==="hex")for((c=c.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(c="0"+c),p=0;p<c.length;p+=2)u.push(parseInt(c[p]+c[p+1],16));else for(p=0;p<c.length;p++){var f=c.charCodeAt(p),h=f>>8,v=255&f;h?u.push(h,v):u.push(v)}return u},o.zero2=s,o.toHex=l,o.encode=function(c,i){return i==="hex"?l(c):c}},{}],455:[function(e,n,a){n.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],456:[function(e,n,a){var o=e("asn1.js");a.certificate=e("./certificate");var s=o.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});a.RSAPrivateKey=s;var l=o.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});a.RSAPublicKey=l;var c=o.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(i),this.key("subjectPublicKey").bitstr())});a.PublicKey=c;var i=o.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),u=o.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(i),this.key("subjectPrivateKey").octstr())});a.PrivateKey=u;var p=o.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});a.EncryptedPrivateKey=p;var f=o.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});a.DSAPrivateKey=f,a.DSAparam=o.define("DSAparam",function(){this.int()});var h=o.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(v),this.key("publicKey").optional().explicit(1).bitstr())});a.ECPrivateKey=h;var v=o.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});a.signature=o.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},{"./certificate":457,"asn1.js":170}],457:[function(e,n,a){var o=e("asn1.js"),s=o.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),l=o.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),c=o.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),i=o.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(c),this.key("subjectPublicKey").bitstr())}),u=o.define("RelativeDistinguishedName",function(){this.setof(l)}),p=o.define("RDNSequence",function(){this.seqof(u)}),f=o.define("Name",function(){this.choice({rdnSequence:this.use(p)})}),h=o.define("Validity",function(){this.seq().obj(this.key("notBefore").use(s),this.key("notAfter").use(s))}),v=o.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),b=o.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(c),this.key("issuer").use(f),this.key("validity").use(h),this.key("subject").use(f),this.key("subjectPublicKeyInfo").use(i),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(v).optional())}),g=o.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(b),this.key("signatureAlgorithm").use(c),this.key("signatureValue").bitstr())});n.exports=g},{"asn1.js":170}],458:[function(e,n,a){var o=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,s=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,l=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,c=e("evp_bytestokey"),i=e("browserify-aes"),u=e("safe-buffer").Buffer;n.exports=function(p,f){var h,v=p.toString(),b=v.match(o);if(b){var g="aes"+b[1],x=u.from(b[2],"hex"),y=u.from(b[3].replace(/[\r\n]/g,""),"base64"),E=c(f,x.slice(0,8),parseInt(b[1],10)).key,N=[],I=i.createDecipheriv(g,E,x);N.push(I.update(y)),N.push(I.final()),h=u.concat(N)}else{var L=v.match(l);h=u.from(L[2].replace(/[\r\n]/g,""),"base64")}return{tag:v.match(s)[1],data:h}}},{"browserify-aes":191,evp_bytestokey:423,"safe-buffer":494}],459:[function(e,n,a){var o=e("./asn1"),s=e("./aesid.json"),l=e("./fixProc"),c=e("browserify-aes"),i=e("pbkdf2"),u=e("safe-buffer").Buffer;function p(f){var h;typeof f!="object"||u.isBuffer(f)||(h=f.passphrase,f=f.key),typeof f=="string"&&(f=u.from(f));var v,b,g=l(f,h),x=g.tag,y=g.data;switch(x){case"CERTIFICATE":b=o.certificate.decode(y,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(b||(b=o.PublicKey.decode(y,"der")),v=b.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return o.RSAPublicKey.decode(b.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return b.subjectPrivateKey=b.subjectPublicKey,{type:"ec",data:b};case"1.2.840.10040.4.1":return b.algorithm.params.pub_key=o.DSAparam.decode(b.subjectPublicKey.data,"der"),{type:"dsa",data:b.algorithm.params};default:throw new Error("unknown key id "+v)}case"ENCRYPTED PRIVATE KEY":y=function(E,N){var I=E.algorithm.decrypt.kde.kdeparams.salt,L=parseInt(E.algorithm.decrypt.kde.kdeparams.iters.toString(),10),H=s[E.algorithm.decrypt.cipher.algo.join(".")],V=E.algorithm.decrypt.cipher.iv,q=E.subjectPrivateKey,K=parseInt(H.split("-")[1],10)/8,z=i.pbkdf2Sync(N,I,L,K,"sha1"),W=c.createDecipheriv(H,z,V),D=[];return D.push(W.update(q)),D.push(W.final()),u.concat(D)}(y=o.EncryptedPrivateKey.decode(y,"der"),h);case"PRIVATE KEY":switch(v=(b=o.PrivateKey.decode(y,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return o.RSAPrivateKey.decode(b.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:b.algorithm.curve,privateKey:o.ECPrivateKey.decode(b.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return b.algorithm.params.priv_key=o.DSAparam.decode(b.subjectPrivateKey,"der"),{type:"dsa",params:b.algorithm.params};default:throw new Error("unknown key id "+v)}case"RSA PUBLIC KEY":return o.RSAPublicKey.decode(y,"der");case"RSA PRIVATE KEY":return o.RSAPrivateKey.decode(y,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:o.DSAPrivateKey.decode(y,"der")};case"EC PRIVATE KEY":return{curve:(y=o.ECPrivateKey.decode(y,"der")).parameters.value,privateKey:y.privateKey};default:throw new Error("unknown key type "+x)}}n.exports=p,p.signature=o.signature},{"./aesid.json":455,"./asn1":456,"./fixProc":458,"browserify-aes":191,pbkdf2:460,"safe-buffer":494}],460:[function(e,n,a){a.pbkdf2=e("./lib/async"),a.pbkdf2Sync=e("./lib/sync")},{"./lib/async":461,"./lib/sync":464}],461:[function(e,n,a){(function(o){(function(){var s,l,c=e("safe-buffer").Buffer,i=e("./precondition"),u=e("./default-encoding"),p=e("./sync"),f=e("./to-buffer"),h=o.crypto&&o.crypto.subtle,v={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},b=[];function g(){return l||(l=o.process&&o.process.nextTick?o.process.nextTick:o.queueMicrotask?o.queueMicrotask:o.setImmediate?o.setImmediate:o.setTimeout)}function x(y,E,N,I,L){return h.importKey("raw",y,{name:"PBKDF2"},!1,["deriveBits"]).then(function(H){return h.deriveBits({name:"PBKDF2",salt:E,iterations:N,hash:{name:L}},H,I<<3)}).then(function(H){return c.from(H)})}n.exports=function(y,E,N,I,L,H){typeof L=="function"&&(H=L,L=void 0);var V=v[(L=L||"sha1").toLowerCase()];if(V&&typeof o.Promise=="function"){if(i(N,I),y=f(y,u,"Password"),E=f(E,u,"Salt"),typeof H!="function")throw new Error("No callback provided to pbkdf2");(function(q,K){q.then(function(z){g()(function(){K(null,z)})},function(z){g()(function(){K(z)})})})(function(q){if(o.process&&!o.process.browser||!h||!h.importKey||!h.deriveBits)return Promise.resolve(!1);if(b[q]!==void 0)return b[q];var K=x(s=s||c.alloc(8),s,10,128,q).then(function(){return!0}).catch(function(){return!1});return b[q]=K,K}(V).then(function(q){return q?x(y,E,N,I,V):p(y,E,N,I,L)}),H)}else g()(function(){var q;try{q=p(y,E,N,I,L)}catch(K){return H(K)}H(null,q)})}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"./default-encoding":462,"./precondition":463,"./sync":464,"./to-buffer":465,"safe-buffer":494}],462:[function(e,n,a){(function(o,s){(function(){var l;s.process&&s.process.browser?l="utf-8":s.process&&s.process.version?l=parseInt(o.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":l="utf-8",n.exports=l}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467}],463:[function(e,n,a){var o=Math.pow(2,30)-1;n.exports=function(s,l){if(typeof s!="number")throw new TypeError("Iterations not a number");if(s<0)throw new TypeError("Bad iterations");if(typeof l!="number")throw new TypeError("Key length not a number");if(l<0||l>o||l!=l)throw new TypeError("Bad key length")}},{}],464:[function(e,n,a){var o=e("create-hash/md5"),s=e("ripemd160"),l=e("sha.js"),c=e("safe-buffer").Buffer,i=e("./precondition"),u=e("./default-encoding"),p=e("./to-buffer"),f=c.alloc(128),h={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function v(b,g,x){var y=function(V){function q(K){return l(V).update(K).digest()}return V==="rmd160"||V==="ripemd160"?function(K){return new s().update(K).digest()}:V==="md5"?o:q}(b),E=b==="sha512"||b==="sha384"?128:64;g.length>E?g=y(g):g.length<E&&(g=c.concat([g,f],E));for(var N=c.allocUnsafe(E+h[b]),I=c.allocUnsafe(E+h[b]),L=0;L<E;L++)N[L]=54^g[L],I[L]=92^g[L];var H=c.allocUnsafe(E+x+4);N.copy(H,0,0,E),this.ipad1=H,this.ipad2=N,this.opad=I,this.alg=b,this.blocksize=E,this.hash=y,this.size=h[b]}v.prototype.run=function(b,g){return b.copy(g,this.blocksize),this.hash(g).copy(this.opad,this.blocksize),this.hash(this.opad)},n.exports=function(b,g,x,y,E){i(x,y);var N=new v(E=E||"sha1",b=p(b,u,"Password"),(g=p(g,u,"Salt")).length),I=c.allocUnsafe(y),L=c.allocUnsafe(g.length+4);g.copy(L,0,0,g.length);for(var H=0,V=h[E],q=Math.ceil(y/V),K=1;K<=q;K++){L.writeUInt32BE(K,g.length);for(var z=N.run(L,N.ipad1),W=z,D=1;D<x;D++){W=N.run(W,N.ipad2);for(var M=0;M<V;M++)z[M]^=W[M]}z.copy(I,H),H+=V}return I}},{"./default-encoding":462,"./precondition":463,"./to-buffer":465,"create-hash/md5":387,ripemd160:493,"safe-buffer":494,"sha.js":498}],465:[function(e,n,a){var o=e("safe-buffer").Buffer;n.exports=function(s,l,c){if(o.isBuffer(s))return s;if(typeof s=="string")return o.from(s,l);if(ArrayBuffer.isView(s))return o.from(s.buffer);throw new TypeError(c+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":494}],466:[function(e,n,a){(function(o){(function(){o===void 0||!o.version||o.version.indexOf("v0.")===0||o.version.indexOf("v1.")===0&&o.version.indexOf("v1.8.")!==0?n.exports={nextTick:function(s,l,c,i){if(typeof s!="function")throw new TypeError('"callback" argument must be a function');var u,p,f=arguments.length;switch(f){case 0:case 1:return o.nextTick(s);case 2:return o.nextTick(function(){s.call(null,l)});case 3:return o.nextTick(function(){s.call(null,l,c)});case 4:return o.nextTick(function(){s.call(null,l,c,i)});default:for(u=new Array(f-1),p=0;p<u.length;)u[p++]=arguments[p];return o.nextTick(function(){s.apply(null,u)})}}}:n.exports=o}).call(this)}).call(this,e("_process"))},{_process:467}],467:[function(e,n,a){var o,s,l=n.exports={};function c(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function u(E){if(o===setTimeout)return setTimeout(E,0);if((o===c||!o)&&setTimeout)return o=setTimeout,setTimeout(E,0);try{return o(E,0)}catch{try{return o.call(null,E,0)}catch{return o.call(this,E,0)}}}(function(){try{o=typeof setTimeout=="function"?setTimeout:c}catch{o=c}try{s=typeof clearTimeout=="function"?clearTimeout:i}catch{s=i}})();var p,f=[],h=!1,v=-1;function b(){h&&p&&(h=!1,p.length?f=p.concat(f):v=-1,f.length&&g())}function g(){if(!h){var E=u(b);h=!0;for(var N=f.length;N;){for(p=f,f=[];++v<N;)p&&p[v].run();v=-1,N=f.length}p=null,h=!1,function(I){if(s===clearTimeout)return clearTimeout(I);if((s===i||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(I);try{s(I)}catch{try{return s.call(null,I)}catch{return s.call(this,I)}}}(E)}}function x(E,N){this.fun=E,this.array=N}function y(){}l.nextTick=function(E){var N=new Array(arguments.length-1);if(arguments.length>1)for(var I=1;I<arguments.length;I++)N[I-1]=arguments[I];f.push(new x(E,N)),f.length!==1||h||u(g)},x.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=y,l.addListener=y,l.once=y,l.off=y,l.removeListener=y,l.removeAllListeners=y,l.emit=y,l.prependListener=y,l.prependOnceListener=y,l.listeners=function(E){return[]},l.binding=function(E){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(E){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],468:[function(e,n,a){a.publicEncrypt=e("./publicEncrypt"),a.privateDecrypt=e("./privateDecrypt"),a.privateEncrypt=function(o,s){return a.publicEncrypt(o,s,!0)},a.publicDecrypt=function(o,s){return a.privateDecrypt(o,s,!0)}},{"./privateDecrypt":471,"./publicEncrypt":472}],469:[function(e,n,a){var o=e("create-hash"),s=e("safe-buffer").Buffer;function l(c){var i=s.allocUnsafe(4);return i.writeUInt32BE(c,0),i}n.exports=function(c,i){for(var u,p=s.alloc(0),f=0;p.length<i;)u=l(f++),p=s.concat([p,o("sha1").update(c).update(u).digest()]);return p.slice(0,i)}},{"create-hash":386,"safe-buffer":494}],470:[function(e,n,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],471:[function(e,n,a){var o=e("parse-asn1"),s=e("./mgf"),l=e("./xor"),c=e("bn.js"),i=e("browserify-rsa"),u=e("create-hash"),p=e("./withPublic"),f=e("safe-buffer").Buffer;n.exports=function(h,v,b){var g;g=h.padding?h.padding:b?1:4;var x,y=o(h),E=y.modulus.byteLength();if(v.length>E||new c(v).cmp(y.modulus)>=0)throw new Error("decryption error");x=b?p(new c(v),y):i(v,y);var N=f.alloc(E-x.length);if(x=f.concat([N,x],E),g===4)return function(I,L){var H=I.modulus.byteLength(),V=u("sha1").update(f.alloc(0)).digest(),q=V.length;if(L[0]!==0)throw new Error("decryption error");var K=L.slice(1,q+1),z=L.slice(q+1),W=l(K,s(z,q)),D=l(z,s(W,H-q-1));if(function(C,w){C=f.from(C),w=f.from(w);var T=0,A=C.length;C.length!==w.length&&(T++,A=Math.min(C.length,w.length));for(var S=-1;++S<A;)T+=C[S]^w[S];return T}(V,D.slice(0,q)))throw new Error("decryption error");for(var M=q;D[M]===0;)M++;if(D[M++]!==1)throw new Error("decryption error");return D.slice(M)}(y,x);if(g===1)return function(I,L,H){for(var V=L.slice(0,2),q=2,K=0;L[q++]!==0;)if(q>=L.length){K++;break}var z=L.slice(2,q-1);if((V.toString("hex")!=="0002"&&!H||V.toString("hex")!=="0001"&&H)&&K++,z.length<8&&K++,K)throw new Error("decryption error");return L.slice(q)}(0,x,b);if(g===3)return x;throw new Error("unknown padding")}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,"safe-buffer":494}],472:[function(e,n,a){var o=e("parse-asn1"),s=e("randombytes"),l=e("create-hash"),c=e("./mgf"),i=e("./xor"),u=e("bn.js"),p=e("./withPublic"),f=e("browserify-rsa"),h=e("safe-buffer").Buffer;n.exports=function(v,b,g){var x;x=v.padding?v.padding:g?1:4;var y,E=o(v);if(x===4)y=function(N,I){var L=N.modulus.byteLength(),H=I.length,V=l("sha1").update(h.alloc(0)).digest(),q=V.length,K=2*q;if(H>L-K-2)throw new Error("message too long");var z=h.alloc(L-H-K-2),W=L-q-1,D=s(q),M=i(h.concat([V,z,h.alloc(1,1),I],W),c(D,W)),C=i(D,c(M,q));return new u(h.concat([h.alloc(1),C,M],L))}(E,b);else if(x===1)y=function(N,I,L){var H,V=I.length,q=N.modulus.byteLength();if(V>q-11)throw new Error("message too long");return H=L?h.alloc(q-V-3,255):function(K){for(var z,W=h.allocUnsafe(K),D=0,M=s(2*K),C=0;D<K;)C===M.length&&(M=s(2*K),C=0),(z=M[C++])&&(W[D++]=z);return W}(q-V-3),new u(h.concat([h.from([0,L?1:2]),H,h.alloc(1),I],q))}(E,b,g);else{if(x!==3)throw new Error("unknown padding");if((y=new u(b)).cmp(E.modulus)>=0)throw new Error("data too long for modulus")}return g?f(y,E):p(y,E)}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,randombytes:475,"safe-buffer":494}],473:[function(e,n,a){var o=e("bn.js"),s=e("safe-buffer").Buffer;n.exports=function(l,c){return s.from(l.toRed(o.mont(c.modulus)).redPow(new o(c.publicExponent)).fromRed().toArray())}},{"bn.js":470,"safe-buffer":494}],474:[function(e,n,a){n.exports=function(o,s){for(var l=o.length,c=-1;++c<l;)o[c]^=s[c];return o}},{}],475:[function(e,n,a){(function(o,s){(function(){var l=e("safe-buffer").Buffer,c=s.crypto||s.msCrypto;c&&c.getRandomValues?n.exports=function(i,u){if(i>4294967295)throw new RangeError("requested too many random bytes");var p=l.allocUnsafe(i);if(i>0)if(i>65536)for(var f=0;f<i;f+=65536)c.getRandomValues(p.slice(f,f+65536));else c.getRandomValues(p);return typeof u=="function"?o.nextTick(function(){u(null,p)}):p}:n.exports=function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,"safe-buffer":494}],476:[function(e,n,a){(function(o,s){(function(){function l(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var c=e("safe-buffer"),i=e("randombytes"),u=c.Buffer,p=c.kMaxLength,f=s.crypto||s.msCrypto,h=Math.pow(2,32)-1;function v(x,y){if(typeof x!="number"||x!=x)throw new TypeError("offset must be a number");if(x>h||x<0)throw new TypeError("offset must be a uint32");if(x>p||x>y)throw new RangeError("offset out of range")}function b(x,y,E){if(typeof x!="number"||x!=x)throw new TypeError("size must be a number");if(x>h||x<0)throw new TypeError("size must be a uint32");if(x+y>E||x>p)throw new RangeError("buffer too small")}function g(x,y,E,N){if(o.browser){var I=x.buffer,L=new Uint8Array(I,y,E);return f.getRandomValues(L),N?void o.nextTick(function(){N(null,x)}):x}if(!N)return i(E).copy(x,y),x;i(E,function(H,V){if(H)return N(H);V.copy(x,y),N(null,x)})}f&&f.getRandomValues||!o.browser?(a.randomFill=function(x,y,E,N){if(!(u.isBuffer(x)||x instanceof s.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof y=="function")N=y,y=0,E=x.length;else if(typeof E=="function")N=E,E=x.length-y;else if(typeof N!="function")throw new TypeError('"cb" argument must be a function');return v(y,x.length),b(E,y,x.length),g(x,y,E,N)},a.randomFillSync=function(x,y,E){if(y===void 0&&(y=0),!(u.isBuffer(x)||x instanceof s.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return v(y,x.length),E===void 0&&(E=x.length-y),b(E,y,x.length),g(x,y,E)}):(a.randomFill=l,a.randomFillSync=l)}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,randombytes:475,"safe-buffer":494}],477:[function(e,n,a){var o={};function s(c,i,u){u||(u=Error);var p=function(f){var h,v;function b(g,x,y){return f.call(this,function(E,N,I){return typeof i=="string"?i:i(E,N,I)}(g,x,y))||this}return v=f,(h=b).prototype=Object.create(v.prototype),h.prototype.constructor=h,h.__proto__=v,b}(u);p.prototype.name=u.name,p.prototype.code=c,o[c]=p}function l(c,i){if(Array.isArray(c)){var u=c.length;return c=c.map(function(p){return String(p)}),u>2?"one of ".concat(i," ").concat(c.slice(0,u-1).join(", "),", or ")+c[u-1]:u===2?"one of ".concat(i," ").concat(c[0]," or ").concat(c[1]):"of ".concat(i," ").concat(c[0])}return"of ".concat(i," ").concat(String(c))}s("ERR_INVALID_OPT_VALUE",function(c,i){return'The value "'+i+'" is invalid for option "'+c+'"'},TypeError),s("ERR_INVALID_ARG_TYPE",function(c,i,u){var p,f,h;if(typeof i=="string"&&(f="not ",i.substr(0,f.length)===f)?(p="must not be",i=i.replace(/^not /,"")):p="must be",function(b,g,x){return(x===void 0||x>b.length)&&(x=b.length),b.substring(x-g.length,x)===g}(c," argument"))h="The ".concat(c," ").concat(p," ").concat(l(i,"type"));else{var v=function(b,g,x){return typeof x!="number"&&(x=0),!(x+g.length>b.length)&&b.indexOf(g,x)!==-1}(c,".")?"property":"argument";h='The "'.concat(c,'" ').concat(v," ").concat(p," ").concat(l(i,"type"))}return h+=". Received type ".concat(typeof u)},TypeError),s("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),s("ERR_METHOD_NOT_IMPLEMENTED",function(c){return"The "+c+" method is not implemented"}),s("ERR_STREAM_PREMATURE_CLOSE","Premature close"),s("ERR_STREAM_DESTROYED",function(c){return"Cannot call "+c+" after a stream was destroyed"}),s("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),s("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),s("ERR_STREAM_WRITE_AFTER_END","write after end"),s("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),s("ERR_UNKNOWN_ENCODING",function(c){return"Unknown encoding: "+c},TypeError),s("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),n.exports.codes=o},{}],478:[function(e,n,a){(function(o){(function(){var s=Object.keys||function(b){var g=[];for(var x in b)g.push(x);return g};n.exports=f;var l=e("./_stream_readable"),c=e("./_stream_writable");e("inherits")(f,l);for(var i=s(c.prototype),u=0;u<i.length;u++){var p=i[u];f.prototype[p]||(f.prototype[p]=c.prototype[p])}function f(b){if(!(this instanceof f))return new f(b);l.call(this,b),c.call(this,b),this.allowHalfOpen=!0,b&&(b.readable===!1&&(this.readable=!1),b.writable===!1&&(this.writable=!1),b.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||o.nextTick(v,this)}function v(b){b.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(f.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(f.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(b){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=b,this._writableState.destroyed=b)}})}).call(this)}).call(this,e("_process"))},{"./_stream_readable":480,"./_stream_writable":482,_process:467,inherits:440}],479:[function(e,n,a){n.exports=s;var o=e("./_stream_transform");function s(l){if(!(this instanceof s))return new s(l);o.call(this,l)}e("inherits")(s,o),s.prototype._transform=function(l,c,i){i(null,l)}},{"./_stream_transform":481,inherits:440}],480:[function(e,n,a){(function(o,s){(function(){var l;n.exports=W,W.ReadableState=z,e("events").EventEmitter;var c=function(P,F){return P.listeners(F).length},i=e("./internal/streams/stream"),u=e("buffer").Buffer,p=(s!==void 0?s:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},f,h=e("util");f=h&&h.debuglog?h.debuglog("stream"):function(){};var v,b,g,x=e("./internal/streams/buffer_list"),y=e("./internal/streams/destroy"),E=e("./internal/streams/state").getHighWaterMark,N=e("../errors").codes,I=N.ERR_INVALID_ARG_TYPE,L=N.ERR_STREAM_PUSH_AFTER_EOF,H=N.ERR_METHOD_NOT_IMPLEMENTED,V=N.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(W,i);var q=y.errorOrDestroy,K=["error","close","destroy","pause","resume"];function z(P,F,Z){l=l||e("./_stream_duplex"),P=P||{},typeof Z!="boolean"&&(Z=F instanceof l),this.objectMode=!!P.objectMode,Z&&(this.objectMode=this.objectMode||!!P.readableObjectMode),this.highWaterMark=E(this,P,"readableHighWaterMark",Z),this.buffer=new x,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=P.emitClose!==!1,this.autoDestroy=!!P.autoDestroy,this.destroyed=!1,this.defaultEncoding=P.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,P.encoding&&(v||(v=e("string_decoder/").StringDecoder),this.decoder=new v(P.encoding),this.encoding=P.encoding)}function W(P){if(l=l||e("./_stream_duplex"),!(this instanceof W))return new W(P);var F=this instanceof l;this._readableState=new z(P,this,F),this.readable=!0,P&&(typeof P.read=="function"&&(this._read=P.read),typeof P.destroy=="function"&&(this._destroy=P.destroy)),i.call(this)}function D(P,F,Z,se,re){f("readableAddChunk",F);var ae,te=P._readableState;if(F===null)te.reading=!1,function(he,le){if(f("onEofChunk"),!le.ended){if(le.decoder){var ne=le.decoder.end();ne&&ne.length&&(le.buffer.push(ne),le.length+=le.objectMode?1:ne.length)}le.ended=!0,le.sync?w(he):(le.needReadable=!1,le.emittedReadable||(le.emittedReadable=!0,T(he)))}}(P,te);else if(re||(ae=function(he,le){var ne;de=le,u.isBuffer(de)||de instanceof p||typeof le=="string"||le===void 0||he.objectMode||(ne=new I("chunk",["string","Buffer","Uint8Array"],le));var de;return ne}(te,F)),ae)q(P,ae);else if(te.objectMode||F&&F.length>0)if(typeof F=="string"||te.objectMode||Object.getPrototypeOf(F)===u.prototype||(F=function(he){return u.from(he)}(F)),se)te.endEmitted?q(P,new V):M(P,te,F,!0);else if(te.ended)q(P,new L);else{if(te.destroyed)return!1;te.reading=!1,te.decoder&&!Z?(F=te.decoder.write(F),te.objectMode||F.length!==0?M(P,te,F,!1):A(P,te)):M(P,te,F,!1)}else se||(te.reading=!1,A(P,te));return!te.ended&&(te.length<te.highWaterMark||te.length===0)}function M(P,F,Z,se){F.flowing&&F.length===0&&!F.sync?(F.awaitDrain=0,P.emit("data",Z)):(F.length+=F.objectMode?1:Z.length,se?F.buffer.unshift(Z):F.buffer.push(Z),F.needReadable&&w(P)),A(P,F)}Object.defineProperty(W.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(P){this._readableState&&(this._readableState.destroyed=P)}}),W.prototype.destroy=y.destroy,W.prototype._undestroy=y.undestroy,W.prototype._destroy=function(P,F){F(P)},W.prototype.push=function(P,F){var Z,se=this._readableState;return se.objectMode?Z=!0:typeof P=="string"&&((F=F||se.defaultEncoding)!==se.encoding&&(P=u.from(P,F),F=""),Z=!0),D(this,P,F,!1,Z)},W.prototype.unshift=function(P){return D(this,P,null,!0,!1)},W.prototype.isPaused=function(){return this._readableState.flowing===!1},W.prototype.setEncoding=function(P){v||(v=e("string_decoder/").StringDecoder);var F=new v(P);this._readableState.decoder=F,this._readableState.encoding=this._readableState.decoder.encoding;for(var Z=this._readableState.buffer.head,se="";Z!==null;)se+=F.write(Z.data),Z=Z.next;return this._readableState.buffer.clear(),se!==""&&this._readableState.buffer.push(se),this._readableState.length=se.length,this};function C(P,F){return P<=0||F.length===0&&F.ended?0:F.objectMode?1:P!=P?F.flowing&&F.length?F.buffer.head.data.length:F.length:(P>F.highWaterMark&&(F.highWaterMark=function(Z){return Z>=1073741824?Z=1073741824:(Z--,Z|=Z>>>1,Z|=Z>>>2,Z|=Z>>>4,Z|=Z>>>8,Z|=Z>>>16,Z++),Z}(P)),P<=F.length?P:F.ended?F.length:(F.needReadable=!0,0))}function w(P){var F=P._readableState;f("emitReadable",F.needReadable,F.emittedReadable),F.needReadable=!1,F.emittedReadable||(f("emitReadable",F.flowing),F.emittedReadable=!0,o.nextTick(T,P))}function T(P){var F=P._readableState;f("emitReadable_",F.destroyed,F.length,F.ended),F.destroyed||!F.length&&!F.ended||(P.emit("readable"),F.emittedReadable=!1),F.needReadable=!F.flowing&&!F.ended&&F.length<=F.highWaterMark,X(P)}function A(P,F){F.readingMore||(F.readingMore=!0,o.nextTick(S,P,F))}function S(P,F){for(;!F.reading&&!F.ended&&(F.length<F.highWaterMark||F.flowing&&F.length===0);){var Z=F.length;if(f("maybeReadMore read 0"),P.read(0),Z===F.length)break}F.readingMore=!1}function j(P){var F=P._readableState;F.readableListening=P.listenerCount("readable")>0,F.resumeScheduled&&!F.paused?F.flowing=!0:P.listenerCount("data")>0&&P.resume()}function B(P){f("readable nexttick read 0"),P.read(0)}function R(P,F){f("resume",F.reading),F.reading||P.read(0),F.resumeScheduled=!1,P.emit("resume"),X(P),F.flowing&&!F.reading&&P.read(0)}function X(P){var F=P._readableState;for(f("flow",F.flowing);F.flowing&&P.read()!==null;);}function Y(P,F){return F.length===0?null:(F.objectMode?Z=F.buffer.shift():!P||P>=F.length?(Z=F.decoder?F.buffer.join(""):F.buffer.length===1?F.buffer.first():F.buffer.concat(F.length),F.buffer.clear()):Z=F.buffer.consume(P,F.decoder),Z);var Z}function ee(P){var F=P._readableState;f("endReadable",F.endEmitted),F.endEmitted||(F.ended=!0,o.nextTick(U,F,P))}function U(P,F){if(f("endReadableNT",P.endEmitted,P.length),!P.endEmitted&&P.length===0&&(P.endEmitted=!0,F.readable=!1,F.emit("end"),P.autoDestroy)){var Z=F._writableState;(!Z||Z.autoDestroy&&Z.finished)&&F.destroy()}}function Q(P,F){for(var Z=0,se=P.length;Z<se;Z++)if(P[Z]===F)return Z;return-1}W.prototype.read=function(P){f("read",P),P=parseInt(P,10);var F=this._readableState,Z=P;if(P!==0&&(F.emittedReadable=!1),P===0&&F.needReadable&&((F.highWaterMark!==0?F.length>=F.highWaterMark:F.length>0)||F.ended))return f("read: emitReadable",F.length,F.ended),F.length===0&&F.ended?ee(this):w(this),null;if((P=C(P,F))===0&&F.ended)return F.length===0&&ee(this),null;var se,re=F.needReadable;return f("need readable",re),(F.length===0||F.length-P<F.highWaterMark)&&f("length less than watermark",re=!0),F.ended||F.reading?f("reading or ended",re=!1):re&&(f("do read"),F.reading=!0,F.sync=!0,F.length===0&&(F.needReadable=!0),this._read(F.highWaterMark),F.sync=!1,F.reading||(P=C(Z,F))),(se=P>0?Y(P,F):null)===null?(F.needReadable=F.length<=F.highWaterMark,P=0):(F.length-=P,F.awaitDrain=0),F.length===0&&(F.ended||(F.needReadable=!0),Z!==P&&F.ended&&ee(this)),se!==null&&this.emit("data",se),se},W.prototype._read=function(P){q(this,new H("_read()"))},W.prototype.pipe=function(P,F){var Z=this,se=this._readableState;switch(se.pipesCount){case 0:se.pipes=P;break;case 1:se.pipes=[se.pipes,P];break;default:se.pipes.push(P)}se.pipesCount+=1,f("pipe count=%d opts=%j",se.pipesCount,F);var re=(!F||F.end!==!1)&&P!==o.stdout&&P!==o.stderr?te:_e;function ae(Ce,Re){f("onunpipe"),Ce===Z&&Re&&Re.hasUnpiped===!1&&(Re.hasUnpiped=!0,f("cleanup"),P.removeListener("close",fe),P.removeListener("finish",Se),P.removeListener("drain",he),P.removeListener("error",de),P.removeListener("unpipe",ae),Z.removeListener("end",te),Z.removeListener("end",_e),Z.removeListener("data",ne),le=!0,!se.awaitDrain||P._writableState&&!P._writableState.needDrain||he())}function te(){f("onend"),P.end()}se.endEmitted?o.nextTick(re):Z.once("end",re),P.on("unpipe",ae);var he=function(Ce){return function(){var Re=Ce._readableState;f("pipeOnDrain",Re.awaitDrain),Re.awaitDrain&&Re.awaitDrain--,Re.awaitDrain===0&&c(Ce,"data")&&(Re.flowing=!0,X(Ce))}}(Z);P.on("drain",he);var le=!1;function ne(Ce){f("ondata");var Re=P.write(Ce);f("dest.write",Re),Re===!1&&((se.pipesCount===1&&se.pipes===P||se.pipesCount>1&&Q(se.pipes,P)!==-1)&&!le&&(f("false write response, pause",se.awaitDrain),se.awaitDrain++),Z.pause())}function de(Ce){f("onerror",Ce),_e(),P.removeListener("error",de),c(P,"error")===0&&q(P,Ce)}function fe(){P.removeListener("finish",Se),_e()}function Se(){f("onfinish"),P.removeListener("close",fe),_e()}function _e(){f("unpipe"),Z.unpipe(P)}return Z.on("data",ne),function(Ce,Re,Pe){if(typeof Ce.prependListener=="function")return Ce.prependListener(Re,Pe);Ce._events&&Ce._events[Re]?Array.isArray(Ce._events[Re])?Ce._events[Re].unshift(Pe):Ce._events[Re]=[Pe,Ce._events[Re]]:Ce.on(Re,Pe)}(P,"error",de),P.once("close",fe),P.once("finish",Se),P.emit("pipe",Z),se.flowing||(f("pipe resume"),Z.resume()),P},W.prototype.unpipe=function(P){var F=this._readableState,Z={hasUnpiped:!1};if(F.pipesCount===0)return this;if(F.pipesCount===1)return P&&P!==F.pipes||(P||(P=F.pipes),F.pipes=null,F.pipesCount=0,F.flowing=!1,P&&P.emit("unpipe",this,Z)),this;if(!P){var se=F.pipes,re=F.pipesCount;F.pipes=null,F.pipesCount=0,F.flowing=!1;for(var ae=0;ae<re;ae++)se[ae].emit("unpipe",this,{hasUnpiped:!1});return this}var te=Q(F.pipes,P);return te===-1||(F.pipes.splice(te,1),F.pipesCount-=1,F.pipesCount===1&&(F.pipes=F.pipes[0]),P.emit("unpipe",this,Z)),this},W.prototype.on=function(P,F){var Z=i.prototype.on.call(this,P,F),se=this._readableState;return P==="data"?(se.readableListening=this.listenerCount("readable")>0,se.flowing!==!1&&this.resume()):P==="readable"&&(se.endEmitted||se.readableListening||(se.readableListening=se.needReadable=!0,se.flowing=!1,se.emittedReadable=!1,f("on readable",se.length,se.reading),se.length?w(this):se.reading||o.nextTick(B,this))),Z},W.prototype.addListener=W.prototype.on,W.prototype.removeListener=function(P,F){var Z=i.prototype.removeListener.call(this,P,F);return P==="readable"&&o.nextTick(j,this),Z},W.prototype.removeAllListeners=function(P){var F=i.prototype.removeAllListeners.apply(this,arguments);return P!=="readable"&&P!==void 0||o.nextTick(j,this),F},W.prototype.resume=function(){var P=this._readableState;return P.flowing||(f("resume"),P.flowing=!P.readableListening,function(F,Z){Z.resumeScheduled||(Z.resumeScheduled=!0,o.nextTick(R,F,Z))}(this,P)),P.paused=!1,this},W.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},W.prototype.wrap=function(P){var F=this,Z=this._readableState,se=!1;for(var re in P.on("end",function(){if(f("wrapped end"),Z.decoder&&!Z.ended){var te=Z.decoder.end();te&&te.length&&F.push(te)}F.push(null)}),P.on("data",function(te){f("wrapped data"),Z.decoder&&(te=Z.decoder.write(te)),Z.objectMode&&te==null||(Z.objectMode||te&&te.length)&&(F.push(te)||(se=!0,P.pause()))}),P)this[re]===void 0&&typeof P[re]=="function"&&(this[re]=function(te){return function(){return P[te].apply(P,arguments)}}(re));for(var ae=0;ae<K.length;ae++)P.on(K[ae],this.emit.bind(this,K[ae]));return this._read=function(te){f("wrapped _read",te),se&&(se=!1,P.resume())},this},typeof Symbol=="function"&&(W.prototype[Symbol.asyncIterator]=function(){return b===void 0&&(b=e("./internal/streams/async_iterator")),b(this)}),Object.defineProperty(W.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(W.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(W.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(P){this._readableState&&(this._readableState.flowing=P)}}),W._fromList=Y,Object.defineProperty(W.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(W.from=function(P,F){return g===void 0&&(g=e("./internal/streams/from")),g(W,P,F)})}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/async_iterator":483,"./internal/streams/buffer_list":484,"./internal/streams/destroy":485,"./internal/streams/from":487,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,events:422,inherits:440,"string_decoder/":522,util:188}],481:[function(e,n,a){n.exports=f;var o=e("../errors").codes,s=o.ERR_METHOD_NOT_IMPLEMENTED,l=o.ERR_MULTIPLE_CALLBACK,c=o.ERR_TRANSFORM_ALREADY_TRANSFORMING,i=o.ERR_TRANSFORM_WITH_LENGTH_0,u=e("./_stream_duplex");function p(b,g){var x=this._transformState;x.transforming=!1;var y=x.writecb;if(y===null)return this.emit("error",new l);x.writechunk=null,x.writecb=null,g!=null&&this.push(g),y(b);var E=this._readableState;E.reading=!1,(E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}function f(b){if(!(this instanceof f))return new f(b);u.call(this,b),this._transformState={afterTransform:p.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,b&&(typeof b.transform=="function"&&(this._transform=b.transform),typeof b.flush=="function"&&(this._flush=b.flush)),this.on("prefinish",h)}function h(){var b=this;typeof this._flush!="function"||this._readableState.destroyed?v(this,null,null):this._flush(function(g,x){v(b,g,x)})}function v(b,g,x){if(g)return b.emit("error",g);if(x!=null&&b.push(x),b._writableState.length)throw new i;if(b._transformState.transforming)throw new c;return b.push(null)}e("inherits")(f,u),f.prototype.push=function(b,g){return this._transformState.needTransform=!1,u.prototype.push.call(this,b,g)},f.prototype._transform=function(b,g,x){x(new s("_transform()"))},f.prototype._write=function(b,g,x){var y=this._transformState;if(y.writecb=x,y.writechunk=b,y.writeencoding=g,!y.transforming){var E=this._readableState;(y.needTransform||E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}},f.prototype._read=function(b){var g=this._transformState;g.writechunk===null||g.transforming?g.needTransform=!0:(g.transforming=!0,this._transform(g.writechunk,g.writeencoding,g.afterTransform))},f.prototype._destroy=function(b,g){u.prototype._destroy.call(this,b,function(x){g(x)})}},{"../errors":477,"./_stream_duplex":478,inherits:440}],482:[function(e,n,a){(function(o,s){(function(){function l(S){var j=this;this.next=null,this.entry=null,this.finish=function(){(function(B,R,X){var Y=B.entry;for(B.entry=null;Y;){var ee=Y.callback;R.pendingcb--,ee(X),Y=Y.next}R.corkedRequestsFree.next=B})(j,S)}}var c;n.exports=W,W.WritableState=z;var i={deprecate:e("util-deprecate")},u=e("./internal/streams/stream"),p=e("buffer").Buffer,f=(s!==void 0?s:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},h,v=e("./internal/streams/destroy"),b=e("./internal/streams/state").getHighWaterMark,g=e("../errors").codes,x=g.ERR_INVALID_ARG_TYPE,y=g.ERR_METHOD_NOT_IMPLEMENTED,E=g.ERR_MULTIPLE_CALLBACK,N=g.ERR_STREAM_CANNOT_PIPE,I=g.ERR_STREAM_DESTROYED,L=g.ERR_STREAM_NULL_VALUES,H=g.ERR_STREAM_WRITE_AFTER_END,V=g.ERR_UNKNOWN_ENCODING,q=v.errorOrDestroy;function K(){}function z(S,j,B){c=c||e("./_stream_duplex"),S=S||{},typeof B!="boolean"&&(B=j instanceof c),this.objectMode=!!S.objectMode,B&&(this.objectMode=this.objectMode||!!S.writableObjectMode),this.highWaterMark=b(this,S,"writableHighWaterMark",B),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var R=S.decodeStrings===!1;this.decodeStrings=!R,this.defaultEncoding=S.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(X){(function(Y,ee){var U=Y._writableState,Q=U.sync,P=U.writecb;if(typeof P!="function")throw new E;if(function(Z){Z.writing=!1,Z.writecb=null,Z.length-=Z.writelen,Z.writelen=0}(U),ee)(function(Z,se,re,ae,te){--se.pendingcb,re?(o.nextTick(te,ae),o.nextTick(A,Z,se),Z._writableState.errorEmitted=!0,q(Z,ae)):(te(ae),Z._writableState.errorEmitted=!0,q(Z,ae),A(Z,se))})(Y,U,Q,ee,P);else{var F=w(U)||Y.destroyed;F||U.corked||U.bufferProcessing||!U.bufferedRequest||C(Y,U),Q?o.nextTick(M,Y,U,F,P):M(Y,U,F,P)}})(j,X)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=S.emitClose!==!1,this.autoDestroy=!!S.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new l(this)}function W(S){var j=this instanceof(c=c||e("./_stream_duplex"));if(!j&&!h.call(W,this))return new W(S);this._writableState=new z(S,this,j),this.writable=!0,S&&(typeof S.write=="function"&&(this._write=S.write),typeof S.writev=="function"&&(this._writev=S.writev),typeof S.destroy=="function"&&(this._destroy=S.destroy),typeof S.final=="function"&&(this._final=S.final)),u.call(this)}function D(S,j,B,R,X,Y,ee){j.writelen=R,j.writecb=ee,j.writing=!0,j.sync=!0,j.destroyed?j.onwrite(new I("write")):B?S._writev(X,j.onwrite):S._write(X,Y,j.onwrite),j.sync=!1}function M(S,j,B,R){B||function(X,Y){Y.length===0&&Y.needDrain&&(Y.needDrain=!1,X.emit("drain"))}(S,j),j.pendingcb--,R(),A(S,j)}function C(S,j){j.bufferProcessing=!0;var B=j.bufferedRequest;if(S._writev&&B&&B.next){var R=j.bufferedRequestCount,X=new Array(R),Y=j.corkedRequestsFree;Y.entry=B;for(var ee=0,U=!0;B;)X[ee]=B,B.isBuf||(U=!1),B=B.next,ee+=1;X.allBuffers=U,D(S,j,!0,j.length,X,"",Y.finish),j.pendingcb++,j.lastBufferedRequest=null,Y.next?(j.corkedRequestsFree=Y.next,Y.next=null):j.corkedRequestsFree=new l(j),j.bufferedRequestCount=0}else{for(;B;){var Q=B.chunk,P=B.encoding,F=B.callback;if(D(S,j,!1,j.objectMode?1:Q.length,Q,P,F),B=B.next,j.bufferedRequestCount--,j.writing)break}B===null&&(j.lastBufferedRequest=null)}j.bufferedRequest=B,j.bufferProcessing=!1}function w(S){return S.ending&&S.length===0&&S.bufferedRequest===null&&!S.finished&&!S.writing}function T(S,j){S._final(function(B){j.pendingcb--,B&&q(S,B),j.prefinished=!0,S.emit("prefinish"),A(S,j)})}function A(S,j){var B=w(j);if(B&&(function(X,Y){Y.prefinished||Y.finalCalled||(typeof X._final!="function"||Y.destroyed?(Y.prefinished=!0,X.emit("prefinish")):(Y.pendingcb++,Y.finalCalled=!0,o.nextTick(T,X,Y)))}(S,j),j.pendingcb===0&&(j.finished=!0,S.emit("finish"),j.autoDestroy))){var R=S._readableState;(!R||R.autoDestroy&&R.endEmitted)&&S.destroy()}return B}e("inherits")(W,u),z.prototype.getBuffer=function(){for(var S=this.bufferedRequest,j=[];S;)j.push(S),S=S.next;return j},function(){try{Object.defineProperty(z.prototype,"buffer",{get:i.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(h=Function.prototype[Symbol.hasInstance],Object.defineProperty(W,Symbol.hasInstance,{value:function(S){return!!h.call(this,S)||this===W&&S&&S._writableState instanceof z}})):h=function(S){return S instanceof this},W.prototype.pipe=function(){q(this,new N)},W.prototype.write=function(S,j,B){var R,X=this._writableState,Y=!1,ee=!X.objectMode&&(R=S,p.isBuffer(R)||R instanceof f);return ee&&!p.isBuffer(S)&&(S=function(U){return p.from(U)}(S)),typeof j=="function"&&(B=j,j=null),ee?j="buffer":j||(j=X.defaultEncoding),typeof B!="function"&&(B=K),X.ending?function(U,Q){var P=new H;q(U,P),o.nextTick(Q,P)}(this,B):(ee||function(U,Q,P,F){var Z;return P===null?Z=new L:typeof P=="string"||Q.objectMode||(Z=new x("chunk",["string","Buffer"],P)),!Z||(q(U,Z),o.nextTick(F,Z),!1)}(this,X,S,B))&&(X.pendingcb++,Y=function(U,Q,P,F,Z,se){if(!P){var re=function(le,ne,de){return le.objectMode||le.decodeStrings===!1||typeof ne!="string"||(ne=p.from(ne,de)),ne}(Q,F,Z);F!==re&&(P=!0,Z="buffer",F=re)}var ae=Q.objectMode?1:F.length;Q.length+=ae;var te=Q.length<Q.highWaterMark;if(te||(Q.needDrain=!0),Q.writing||Q.corked){var he=Q.lastBufferedRequest;Q.lastBufferedRequest={chunk:F,encoding:Z,isBuf:P,callback:se,next:null},he?he.next=Q.lastBufferedRequest:Q.bufferedRequest=Q.lastBufferedRequest,Q.bufferedRequestCount+=1}else D(U,Q,!1,ae,F,Z,se);return te}(this,X,ee,S,j,B)),Y},W.prototype.cork=function(){this._writableState.corked++},W.prototype.uncork=function(){var S=this._writableState;S.corked&&(S.corked--,S.writing||S.corked||S.bufferProcessing||!S.bufferedRequest||C(this,S))},W.prototype.setDefaultEncoding=function(S){if(typeof S=="string"&&(S=S.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((S+"").toLowerCase())>-1))throw new V(S);return this._writableState.defaultEncoding=S,this},Object.defineProperty(W.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(W.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),W.prototype._write=function(S,j,B){B(new y("_write()"))},W.prototype._writev=null,W.prototype.end=function(S,j,B){var R=this._writableState;return typeof S=="function"?(B=S,S=null,j=null):typeof j=="function"&&(B=j,j=null),S!=null&&this.write(S,j),R.corked&&(R.corked=1,this.uncork()),R.ending||function(X,Y,ee){Y.ending=!0,A(X,Y),ee&&(Y.finished?o.nextTick(ee):X.once("finish",ee)),Y.ended=!0,X.writable=!1}(this,R,B),this},Object.defineProperty(W.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(W.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(S){this._writableState&&(this._writableState.destroyed=S)}}),W.prototype.destroy=v.destroy,W.prototype._undestroy=v.undestroy,W.prototype._destroy=function(S,j){j(S)}}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/destroy":485,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,inherits:440,"util-deprecate":524}],483:[function(e,n,a){(function(o){(function(){var s;function l(I,L,H){return(L=function(V){var q=function(K,z){if(typeof K!="object"||K===null)return K;var W=K[Symbol.toPrimitive];if(W!==void 0){var D=W.call(K,z);if(typeof D!="object")return D;throw new TypeError("@@toPrimitive must return a primitive value.")}return(z==="string"?String:Number)(K)}(V,"string");return typeof q=="symbol"?q:String(q)}(L))in I?Object.defineProperty(I,L,{value:H,enumerable:!0,configurable:!0,writable:!0}):I[L]=H,I}var c=e("./end-of-stream"),i=Symbol("lastResolve"),u=Symbol("lastReject"),p=Symbol("error"),f=Symbol("ended"),h=Symbol("lastPromise"),v=Symbol("handlePromise"),b=Symbol("stream");function g(I,L){return{value:I,done:L}}function x(I){var L=I[i];if(L!==null){var H=I[b].read();H!==null&&(I[h]=null,I[i]=null,I[u]=null,L(g(H,!1)))}}function y(I){o.nextTick(x,I)}var E=Object.getPrototypeOf(function(){}),N=Object.setPrototypeOf((l(s={get stream(){return this[b]},next:function(){var I=this,L=this[p];if(L!==null)return Promise.reject(L);if(this[f])return Promise.resolve(g(void 0,!0));if(this[b].destroyed)return new Promise(function(K,z){o.nextTick(function(){I[p]?z(I[p]):K(g(void 0,!0))})});var H,V=this[h];if(V)H=new Promise(function(K,z){return function(W,D){K.then(function(){z[f]?W(g(void 0,!0)):z[v](W,D)},D)}}(V,this));else{var q=this[b].read();if(q!==null)return Promise.resolve(g(q,!1));H=new Promise(this[v])}return this[h]=H,H}},Symbol.asyncIterator,function(){return this}),l(s,"return",function(){var I=this;return new Promise(function(L,H){I[b].destroy(null,function(V){V?H(V):L(g(void 0,!0))})})}),s),E);n.exports=function(I){var L,H=Object.create(N,(l(L={},b,{value:I,writable:!0}),l(L,i,{value:null,writable:!0}),l(L,u,{value:null,writable:!0}),l(L,p,{value:null,writable:!0}),l(L,f,{value:I._readableState.endEmitted,writable:!0}),l(L,v,{value:function(V,q){var K=H[b].read();K?(H[h]=null,H[i]=null,H[u]=null,V(g(K,!1))):(H[i]=V,H[u]=q)},writable:!0}),L));return H[h]=null,c(I,function(V){if(V&&V.code!=="ERR_STREAM_PREMATURE_CLOSE"){var q=H[u];return q!==null&&(H[h]=null,H[i]=null,H[u]=null,q(V)),void(H[p]=V)}var K=H[i];K!==null&&(H[h]=null,H[i]=null,H[u]=null,K(g(void 0,!0))),H[f]=!0}),I.on("readable",y.bind(null,H)),H}}).call(this)}).call(this,e("_process"))},{"./end-of-stream":486,_process:467}],484:[function(e,n,a){function o(h,v){var b=Object.keys(h);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(h);v&&(g=g.filter(function(x){return Object.getOwnPropertyDescriptor(h,x).enumerable})),b.push.apply(b,g)}return b}function s(h){for(var v=1;v<arguments.length;v++){var b=arguments[v]!=null?arguments[v]:{};v%2?o(Object(b),!0).forEach(function(g){l(h,g,b[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(b)):o(Object(b)).forEach(function(g){Object.defineProperty(h,g,Object.getOwnPropertyDescriptor(b,g))})}return h}function l(h,v,b){return(v=i(v))in h?Object.defineProperty(h,v,{value:b,enumerable:!0,configurable:!0,writable:!0}):h[v]=b,h}function c(h,v){for(var b=0;b<v.length;b++){var g=v[b];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(h,i(g.key),g)}}function i(h){var v=function(b,g){if(typeof b!="object"||b===null)return b;var x=b[Symbol.toPrimitive];if(x!==void 0){var y=x.call(b,g);if(typeof y!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return(g==="string"?String:Number)(b)}(h,"string");return typeof v=="symbol"?v:String(v)}var u=e("buffer").Buffer,p=e("util").inspect,f=p&&p.custom||"inspect";n.exports=function(){function h(){(function(g,x){if(!(g instanceof x))throw new TypeError("Cannot call a class as a function")})(this,h),this.head=null,this.tail=null,this.length=0}var v,b;return v=h,(b=[{key:"push",value:function(g){var x={data:g,next:null};this.length>0?this.tail.next=x:this.head=x,this.tail=x,++this.length}},{key:"unshift",value:function(g){var x={data:g,next:this.head};this.length===0&&(this.tail=x),this.head=x,++this.length}},{key:"shift",value:function(){if(this.length!==0){var g=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,g}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(g){if(this.length===0)return"";for(var x=this.head,y=""+x.data;x=x.next;)y+=g+x.data;return y}},{key:"concat",value:function(g){if(this.length===0)return u.alloc(0);for(var x,y,E,N=u.allocUnsafe(g>>>0),I=this.head,L=0;I;)x=I.data,y=N,E=L,u.prototype.copy.call(x,y,E),L+=I.data.length,I=I.next;return N}},{key:"consume",value:function(g,x){var y;return g<this.head.data.length?(y=this.head.data.slice(0,g),this.head.data=this.head.data.slice(g)):y=g===this.head.data.length?this.shift():x?this._getString(g):this._getBuffer(g),y}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(g){var x=this.head,y=1,E=x.data;for(g-=E.length;x=x.next;){var N=x.data,I=g>N.length?N.length:g;if(I===N.length?E+=N:E+=N.slice(0,g),(g-=I)==0){I===N.length?(++y,x.next?this.head=x.next:this.head=this.tail=null):(this.head=x,x.data=N.slice(I));break}++y}return this.length-=y,E}},{key:"_getBuffer",value:function(g){var x=u.allocUnsafe(g),y=this.head,E=1;for(y.data.copy(x),g-=y.data.length;y=y.next;){var N=y.data,I=g>N.length?N.length:g;if(N.copy(x,x.length-g,0,I),(g-=I)==0){I===N.length?(++E,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=N.slice(I));break}++E}return this.length-=E,x}},{key:f,value:function(g,x){return p(this,s(s({},x),{},{depth:0,customInspect:!1}))}}])&&c(v.prototype,b),Object.defineProperty(v,"prototype",{writable:!1}),h}()},{buffer:220,util:188}],485:[function(e,n,a){(function(o){(function(){function s(i,u){c(i,u),l(i)}function l(i){i._writableState&&!i._writableState.emitClose||i._readableState&&!i._readableState.emitClose||i.emit("close")}function c(i,u){i.emit("error",u)}n.exports={destroy:function(i,u){var p=this,f=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return f||h?(u?u(i):i&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,o.nextTick(c,this,i)):o.nextTick(c,this,i)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(i||null,function(v){!u&&v?p._writableState?p._writableState.errorEmitted?o.nextTick(l,p):(p._writableState.errorEmitted=!0,o.nextTick(s,p,v)):o.nextTick(s,p,v):u?(o.nextTick(l,p),u(v)):o.nextTick(l,p)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(i,u){var p=i._readableState,f=i._writableState;p&&p.autoDestroy||f&&f.autoDestroy?i.destroy(u):i.emit("error",u)}}}).call(this)}).call(this,e("_process"))},{_process:467}],486:[function(e,n,a){var o=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function s(){}n.exports=function l(c,i,u){if(typeof i=="function")return l(c,null,i);i||(i={}),u=function(I){var L=!1;return function(){if(!L){L=!0;for(var H=arguments.length,V=new Array(H),q=0;q<H;q++)V[q]=arguments[q];I.apply(this,V)}}}(u||s);var p=i.readable||i.readable!==!1&&c.readable,f=i.writable||i.writable!==!1&&c.writable,h=function(){c.writable||b()},v=c._writableState&&c._writableState.finished,b=function(){f=!1,v=!0,p||u.call(c)},g=c._readableState&&c._readableState.endEmitted,x=function(){p=!1,g=!0,f||u.call(c)},y=function(I){u.call(c,I)},E=function(){var I;return p&&!g?(c._readableState&&c._readableState.ended||(I=new o),u.call(c,I)):f&&!v?(c._writableState&&c._writableState.ended||(I=new o),u.call(c,I)):void 0},N=function(){c.req.on("finish",b)};return function(I){return I.setHeader&&typeof I.abort=="function"}(c)?(c.on("complete",b),c.on("abort",E),c.req?N():c.on("request",N)):f&&!c._writableState&&(c.on("end",h),c.on("close",h)),c.on("end",x),c.on("finish",b),i.error!==!1&&c.on("error",y),c.on("close",E),function(){c.removeListener("complete",b),c.removeListener("abort",E),c.removeListener("request",N),c.req&&c.req.removeListener("finish",b),c.removeListener("end",h),c.removeListener("close",h),c.removeListener("finish",b),c.removeListener("end",x),c.removeListener("error",y),c.removeListener("close",E)}}},{"../../../errors":477}],487:[function(e,n,a){n.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],488:[function(e,n,a){var o,s=e("../../../errors").codes,l=s.ERR_MISSING_ARGS,c=s.ERR_STREAM_DESTROYED;function i(v){if(v)throw v}function u(v,b,g,x){x=function(N){var I=!1;return function(){I||(I=!0,N.apply(void 0,arguments))}}(x);var y=!1;v.on("close",function(){y=!0}),o===void 0&&(o=e("./end-of-stream")),o(v,{readable:b,writable:g},function(N){if(N)return x(N);y=!0,x()});var E=!1;return function(N){if(!y&&!E)return E=!0,function(I){return I.setHeader&&typeof I.abort=="function"}(v)?v.abort():typeof v.destroy=="function"?v.destroy():void x(N||new c("pipe"))}}function p(v){v()}function f(v,b){return v.pipe(b)}function h(v){return v.length?typeof v[v.length-1]!="function"?i:v.pop():i}n.exports=function(){for(var v=arguments.length,b=new Array(v),g=0;g<v;g++)b[g]=arguments[g];var x,y=h(b);if(Array.isArray(b[0])&&(b=b[0]),b.length<2)throw new l("streams");var E=b.map(function(N,I){var L=I<b.length-1;return u(N,L,I>0,function(H){x||(x=H),H&&E.forEach(p),L||(E.forEach(p),y(x))})});return b.reduce(f)}},{"../../../errors":477,"./end-of-stream":486}],489:[function(e,n,a){var o=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;n.exports={getHighWaterMark:function(s,l,c,i){var u=function(p,f,h){return p.highWaterMark!=null?p.highWaterMark:f?p[h]:null}(l,i,c);if(u!=null){if(!isFinite(u)||Math.floor(u)!==u||u<0)throw new o(i?c:"highWaterMark",u);return Math.floor(u)}return s.objectMode?16:16384}}},{"../../../errors":477}],490:[function(e,n,a){n.exports=e("events").EventEmitter},{events:422}],491:[function(e,n,a){(a=n.exports=e("./lib/_stream_readable.js")).Stream=a,a.Readable=a,a.Writable=e("./lib/_stream_writable.js"),a.Duplex=e("./lib/_stream_duplex.js"),a.Transform=e("./lib/_stream_transform.js"),a.PassThrough=e("./lib/_stream_passthrough.js"),a.finished=e("./lib/internal/streams/end-of-stream.js"),a.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":478,"./lib/_stream_passthrough.js":479,"./lib/_stream_readable.js":480,"./lib/_stream_transform.js":481,"./lib/_stream_writable.js":482,"./lib/internal/streams/end-of-stream.js":486,"./lib/internal/streams/pipeline.js":488}],492:[function(e,n,a){var o=function(s){var l=Object.prototype,c=l.hasOwnProperty,i=Object.defineProperty||function(A,S,j){A[S]=j.value},u=typeof Symbol=="function"?Symbol:{},p=u.iterator||"@@iterator",f=u.asyncIterator||"@@asyncIterator",h=u.toStringTag||"@@toStringTag";function v(A,S,j){return Object.defineProperty(A,S,{value:j,enumerable:!0,configurable:!0,writable:!0}),A[S]}try{v({},"")}catch{v=function(S,j,B){return S[j]=B}}function b(A,S,j,B){var R=S&&S.prototype instanceof y?S:y,X=Object.create(R.prototype),Y=new C(B||[]);return i(X,"_invoke",{value:z(A,j,Y)}),X}function g(A,S,j){try{return{type:"normal",arg:A.call(S,j)}}catch(B){return{type:"throw",arg:B}}}s.wrap=b;var x={};function y(){}function E(){}function N(){}var I={};v(I,p,function(){return this});var L=Object.getPrototypeOf,H=L&&L(L(w([])));H&&H!==l&&c.call(H,p)&&(I=H);var V=N.prototype=y.prototype=Object.create(I);function q(A){["next","throw","return"].forEach(function(S){v(A,S,function(j){return this._invoke(S,j)})})}function K(A,S){var j;i(this,"_invoke",{value:function(B,R){function X(){return new S(function(Y,ee){(function U(Q,P,F,Z){var se=g(A[Q],A,P);if(se.type!=="throw"){var re=se.arg,ae=re.value;return ae&&typeof ae=="object"&&c.call(ae,"__await")?S.resolve(ae.__await).then(function(te){U("next",te,F,Z)},function(te){U("throw",te,F,Z)}):S.resolve(ae).then(function(te){re.value=te,F(re)},function(te){return U("throw",te,F,Z)})}Z(se.arg)})(B,R,Y,ee)})}return j=j?j.then(X,X):X()}})}function z(A,S,j){var B="suspendedStart";return function(R,X){if(B==="executing")throw new Error("Generator is already running");if(B==="completed"){if(R==="throw")throw X;return T()}for(j.method=R,j.arg=X;;){var Y=j.delegate;if(Y){var ee=W(Y,j);if(ee){if(ee===x)continue;return ee}}if(j.method==="next")j.sent=j._sent=j.arg;else if(j.method==="throw"){if(B==="suspendedStart")throw B="completed",j.arg;j.dispatchException(j.arg)}else j.method==="return"&&j.abrupt("return",j.arg);B="executing";var U=g(A,S,j);if(U.type==="normal"){if(B=j.done?"completed":"suspendedYield",U.arg===x)continue;return{value:U.arg,done:j.done}}U.type==="throw"&&(B="completed",j.method="throw",j.arg=U.arg)}}}function W(A,S){var j=S.method,B=A.iterator[j];if(B===void 0)return S.delegate=null,j==="throw"&&A.iterator.return&&(S.method="return",S.arg=void 0,W(A,S),S.method==="throw")||j!=="return"&&(S.method="throw",S.arg=new TypeError("The iterator does not provide a '"+j+"' method")),x;var R=g(B,A.iterator,S.arg);if(R.type==="throw")return S.method="throw",S.arg=R.arg,S.delegate=null,x;var X=R.arg;return X?X.done?(S[A.resultName]=X.value,S.next=A.nextLoc,S.method!=="return"&&(S.method="next",S.arg=void 0),S.delegate=null,x):X:(S.method="throw",S.arg=new TypeError("iterator result is not an object"),S.delegate=null,x)}function D(A){var S={tryLoc:A[0]};1 in A&&(S.catchLoc=A[1]),2 in A&&(S.finallyLoc=A[2],S.afterLoc=A[3]),this.tryEntries.push(S)}function M(A){var S=A.completion||{};S.type="normal",delete S.arg,A.completion=S}function C(A){this.tryEntries=[{tryLoc:"root"}],A.forEach(D,this),this.reset(!0)}function w(A){if(A){var S=A[p];if(S)return S.call(A);if(typeof A.next=="function")return A;if(!isNaN(A.length)){var j=-1,B=function R(){for(;++j<A.length;)if(c.call(A,j))return R.value=A[j],R.done=!1,R;return R.value=void 0,R.done=!0,R};return B.next=B}}return{next:T}}function T(){return{value:void 0,done:!0}}return E.prototype=N,i(V,"constructor",{value:N,configurable:!0}),i(N,"constructor",{value:E,configurable:!0}),E.displayName=v(N,h,"GeneratorFunction"),s.isGeneratorFunction=function(A){var S=typeof A=="function"&&A.constructor;return!!S&&(S===E||(S.displayName||S.name)==="GeneratorFunction")},s.mark=function(A){return Object.setPrototypeOf?Object.setPrototypeOf(A,N):(A.__proto__=N,v(A,h,"GeneratorFunction")),A.prototype=Object.create(V),A},s.awrap=function(A){return{__await:A}},q(K.prototype),v(K.prototype,f,function(){return this}),s.AsyncIterator=K,s.async=function(A,S,j,B,R){R===void 0&&(R=Promise);var X=new K(b(A,S,j,B),R);return s.isGeneratorFunction(S)?X:X.next().then(function(Y){return Y.done?Y.value:X.next()})},q(V),v(V,h,"Generator"),v(V,p,function(){return this}),v(V,"toString",function(){return"[object Generator]"}),s.keys=function(A){var S=Object(A),j=[];for(var B in S)j.push(B);return j.reverse(),function R(){for(;j.length;){var X=j.pop();if(X in S)return R.value=X,R.done=!1,R}return R.done=!0,R}},s.values=w,C.prototype={constructor:C,reset:function(A){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(M),!A)for(var S in this)S.charAt(0)==="t"&&c.call(this,S)&&!isNaN(+S.slice(1))&&(this[S]=void 0)},stop:function(){this.done=!0;var A=this.tryEntries[0].completion;if(A.type==="throw")throw A.arg;return this.rval},dispatchException:function(A){if(this.done)throw A;var S=this;function j(U,Q){return X.type="throw",X.arg=A,S.next=U,Q&&(S.method="next",S.arg=void 0),!!Q}for(var B=this.tryEntries.length-1;B>=0;--B){var R=this.tryEntries[B],X=R.completion;if(R.tryLoc==="root")return j("end");if(R.tryLoc<=this.prev){var Y=c.call(R,"catchLoc"),ee=c.call(R,"finallyLoc");if(Y&&ee){if(this.prev<R.catchLoc)return j(R.catchLoc,!0);if(this.prev<R.finallyLoc)return j(R.finallyLoc)}else if(Y){if(this.prev<R.catchLoc)return j(R.catchLoc,!0)}else{if(!ee)throw new Error("try statement without catch or finally");if(this.prev<R.finallyLoc)return j(R.finallyLoc)}}}},abrupt:function(A,S){for(var j=this.tryEntries.length-1;j>=0;--j){var B=this.tryEntries[j];if(B.tryLoc<=this.prev&&c.call(B,"finallyLoc")&&this.prev<B.finallyLoc){var R=B;break}}R&&(A==="break"||A==="continue")&&R.tryLoc<=S&&S<=R.finallyLoc&&(R=null);var X=R?R.completion:{};return X.type=A,X.arg=S,R?(this.method="next",this.next=R.finallyLoc,x):this.complete(X)},complete:function(A,S){if(A.type==="throw")throw A.arg;return A.type==="break"||A.type==="continue"?this.next=A.arg:A.type==="return"?(this.rval=this.arg=A.arg,this.method="return",this.next="end"):A.type==="normal"&&S&&(this.next=S),x},finish:function(A){for(var S=this.tryEntries.length-1;S>=0;--S){var j=this.tryEntries[S];if(j.finallyLoc===A)return this.complete(j.completion,j.afterLoc),M(j),x}},catch:function(A){for(var S=this.tryEntries.length-1;S>=0;--S){var j=this.tryEntries[S];if(j.tryLoc===A){var B=j.completion;if(B.type==="throw"){var R=B.arg;M(j)}return R}}throw new Error("illegal catch attempt")},delegateYield:function(A,S,j){return this.delegate={iterator:w(A),resultName:S,nextLoc:j},this.method==="next"&&(this.arg=void 0),x}},s}(typeof n=="object"?n.exports:{});try{regeneratorRuntime=o}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}},{}],493:[function(e,n,a){var o=e("buffer").Buffer,s=e("inherits"),l=e("hash-base"),c=new Array(16),i=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],u=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],p=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],f=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],h=[0,1518500249,1859775393,2400959708,2840853838],v=[1352829926,1548603684,1836072691,2053994217,0];function b(){l.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function g(L,H){return L<<H|L>>>32-H}function x(L,H,V,q,K,z,W,D){return g(L+(H^V^q)+z+W|0,D)+K|0}function y(L,H,V,q,K,z,W,D){return g(L+(H&V|~H&q)+z+W|0,D)+K|0}function E(L,H,V,q,K,z,W,D){return g(L+((H|~V)^q)+z+W|0,D)+K|0}function N(L,H,V,q,K,z,W,D){return g(L+(H&q|V&~q)+z+W|0,D)+K|0}function I(L,H,V,q,K,z,W,D){return g(L+(H^(V|~q))+z+W|0,D)+K|0}s(b,l),b.prototype._update=function(){for(var L=c,H=0;H<16;++H)L[H]=this._block.readInt32LE(4*H);for(var V=0|this._a,q=0|this._b,K=0|this._c,z=0|this._d,W=0|this._e,D=0|this._a,M=0|this._b,C=0|this._c,w=0|this._d,T=0|this._e,A=0;A<80;A+=1){var S,j;A<16?(S=x(V,q,K,z,W,L[i[A]],h[0],p[A]),j=I(D,M,C,w,T,L[u[A]],v[0],f[A])):A<32?(S=y(V,q,K,z,W,L[i[A]],h[1],p[A]),j=N(D,M,C,w,T,L[u[A]],v[1],f[A])):A<48?(S=E(V,q,K,z,W,L[i[A]],h[2],p[A]),j=E(D,M,C,w,T,L[u[A]],v[2],f[A])):A<64?(S=N(V,q,K,z,W,L[i[A]],h[3],p[A]),j=y(D,M,C,w,T,L[u[A]],v[3],f[A])):(S=I(V,q,K,z,W,L[i[A]],h[4],p[A]),j=x(D,M,C,w,T,L[u[A]],v[4],f[A])),V=W,W=z,z=g(K,10),K=q,q=S,D=T,T=w,w=g(C,10),C=M,M=j}var B=this._b+K+w|0;this._b=this._c+z+T|0,this._c=this._d+W+D|0,this._d=this._e+V+M|0,this._e=this._a+q+C|0,this._a=B},b.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var L=o.alloc?o.alloc(20):new o(20);return L.writeInt32LE(this._a,0),L.writeInt32LE(this._b,4),L.writeInt32LE(this._c,8),L.writeInt32LE(this._d,12),L.writeInt32LE(this._e,16),L},n.exports=b},{buffer:220,"hash-base":425,inherits:440}],494:[function(e,n,a){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var o=e("buffer"),s=o.Buffer;function l(i,u){for(var p in i)u[p]=i[p]}function c(i,u,p){return s(i,u,p)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?n.exports=o:(l(o,a),a.Buffer=c),c.prototype=Object.create(s.prototype),l(s,c),c.from=function(i,u,p){if(typeof i=="number")throw new TypeError("Argument must not be a number");return s(i,u,p)},c.alloc=function(i,u,p){if(typeof i!="number")throw new TypeError("Argument must be a number");var f=s(i);return u!==void 0?typeof p=="string"?f.fill(u,p):f.fill(u):f.fill(0),f},c.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return s(i)},c.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return o.SlowBuffer(i)}},{buffer:220}],495:[function(e,n,a){(function(o){(function(){var s,l=e("buffer"),c=l.Buffer,i={};for(s in l)l.hasOwnProperty(s)&&s!=="SlowBuffer"&&s!=="Buffer"&&(i[s]=l[s]);var u=i.Buffer={};for(s in c)c.hasOwnProperty(s)&&s!=="allocUnsafe"&&s!=="allocUnsafeSlow"&&(u[s]=c[s]);if(i.Buffer.prototype=c.prototype,u.from&&u.from!==Uint8Array.from||(u.from=function(p,f,h){if(typeof p=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof p);if(p&&p.length===void 0)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p);return c(p,f,h)}),u.alloc||(u.alloc=function(p,f,h){if(typeof p!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof p);if(p<0||p>=2*(1<<30))throw new RangeError('The value "'+p+'" is invalid for option "size"');var v=c(p);return f&&f.length!==0?typeof h=="string"?v.fill(f,h):v.fill(f):v.fill(0),v}),!i.kStringMaxLength)try{i.kStringMaxLength=o.binding("buffer").kStringMaxLength}catch{}i.constants||(i.constants={MAX_LENGTH:i.kMaxLength},i.kStringMaxLength&&(i.constants.MAX_STRING_LENGTH=i.kStringMaxLength)),n.exports=i}).call(this)}).call(this,e("_process"))},{_process:467,buffer:220}],496:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0});const o=e("xmlchars/xml/1.0/ed5"),s=e("xmlchars/xml/1.1/ed2"),l=e("xmlchars/xmlns/1.0/ed3");var c=o.isS,i=o.isChar,u=o.isNameStartChar,p=o.isNameChar,f=o.S_LIST,h=o.NAME_RE,v=s.isChar,b=l.isNCNameStartChar,g=l.isNCNameChar,x=l.NC_NAME_RE;const y="http://www.w3.org/XML/1998/namespace",E="http://www.w3.org/2000/xmlns/",N={__proto__:null,xml:y,xmlns:E},I={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},L=w=>w===34||w===39,H=[34,39],V=[...H,91,62],q=[...H,60,93],K=[61,63,...f],z=[...f,62,38,60];function W(w,T,A){switch(T){case"xml":A!==y&&w.fail(`xml prefix must be bound to ${y}.`);break;case"xmlns":A!==E&&w.fail(`xmlns prefix must be bound to ${E}.`)}switch(A){case E:w.fail(T===""?`the default namespace may not be set to ${A}.`:`may not assign a prefix (even "xmlns") to the URI ${E}.`);break;case y:switch(T){case"xml":break;case"":w.fail(`the default namespace may not be set to ${A}.`);break;default:w.fail("may not assign the xml namespace to another prefix.")}}}const D=w=>x.test(w),M=w=>h.test(w);a.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const C={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};a.SaxesParser=class{constructor(w){this.opt=w??{},this.fragmentOpt=!!this.opt.fragment;const T=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,T){this.nameStartCheck=b,this.nameCheck=g,this.isName=D,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},N);const A=this.opt.additionalNamespaces;A!=null&&(function(S,j){for(const B of Object.keys(j))W(S,B,j[B])}(this,A),Object.assign(this.ns,A))}else this.nameStartCheck=u,this.nameCheck=p,this.isName=M,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var w;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:T}=this;this.state=T?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=T,this.xmlDeclPossible=!T,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:A}=this.opt;if(A===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");A="1.0"}this.setXMLVersion(A),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(I),(w=this.readyHandler)===null||w===void 0||w.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(w,T){this[C[w]]=T}off(w){this[C[w]]=void 0}makeError(w){var T;let A=(T=this.fileName)!==null&&T!==void 0?T:"";return this.trackPosition&&(A.length>0&&(A+=":"),A+=`${this.line}:${this.column}`),A.length>0&&(A+=": "),new Error(A+w)}fail(w){const T=this.makeError(w),A=this.errorHandler;if(A===void 0)throw T;return A(T),this}write(w){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let T=!1;w===null?(T=!0,w=""):typeof w=="object"&&(w=w.toString()),this.carriedFromPrevious!==void 0&&(w=`${this.carriedFromPrevious}${w}`,this.carriedFromPrevious=void 0);let A=w.length;const S=w.charCodeAt(A-1);!T&&(S===13||S>=55296&&S<=56319)&&(this.carriedFromPrevious=w[A-1],A--,w=w.slice(0,A));const{stateTable:j}=this;for(this.chunk=w,this.i=0;this.i<A;)j[this.state].call(this);return this.chunkPosition+=A,T?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:w,i:T}=this;if(this.prevI=T,this.i=T+1,T>=w.length)return-1;const A=w.charCodeAt(T);if(this.column++,A<55296){if(A>=32||A===9)return A;switch(A){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return w.charCodeAt(T+1)===10&&(this.i=T+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),A}}if(A>56319)return A>=57344&&A<=65533||this.fail("disallowed character."),A;const S=65536+1024*(A-55296)+(w.charCodeAt(T+1)-56320);return this.i=T+2,S>1114111&&this.fail("disallowed character."),S}getCode11(){const{chunk:w,i:T}=this;if(this.prevI=T,this.i=T+1,T>=w.length)return-1;const A=w.charCodeAt(T);if(this.column++,A<55296){if(A>31&&A<127||A>159&&A!==8232||A===9)return A;switch(A){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{const j=w.charCodeAt(T+1);j!==10&&j!==133||(this.i=T+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),A}}if(A>56319)return A>=57344&&A<=65533||this.fail("disallowed character."),A;const S=65536+1024*(A-55296)+(w.charCodeAt(T+1)-56320);return this.i=T+2,S>1114111&&this.fail("disallowed character."),S}getCodeNorm(){const w=this.getCode();return w===-2?10:w}unget(){this.i=this.prevI,this.column--}captureTo(w){let{i:T}=this;const{chunk:A}=this;for(;;){const S=this.getCode(),j=S===-2,B=j?10:S;if(B===-1||w.includes(B))return this.text+=A.slice(T,this.prevI),B;j&&(this.text+=A.slice(T,this.prevI)+`
`,T=this.i)}}captureToChar(w){let{i:T}=this;const{chunk:A}=this;for(;;){let S=this.getCode();switch(S){case-2:this.text+=A.slice(T,this.prevI)+`
`,T=this.i,S=10;break;case-1:return this.text+=A.slice(T),!1}if(S===w)return this.text+=A.slice(T,this.prevI),!0}}captureNameChars(){const{chunk:w,i:T}=this;for(;;){const A=this.getCode();if(A===-1)return this.name+=w.slice(T),-1;if(!p(A))return this.name+=w.slice(T,this.prevI),A===-2?10:A}}skipSpaces(){for(;;){const w=this.getCodeNorm();if(w===-1||!c(w))return w}}setXMLVersion(w){this.currentXMLVersion=w,w==="1.0"?(this.isChar=i,this.getCode=this.getCode10):(this.isChar=v,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const w=this.i,T=this.skipSpaces();switch(this.prevI!==w&&(this.xmlDeclPossible=!1),T){case 60:if(this.state=15,this.text.length!==0)throw new Error("no-empty text at start");break;case-1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var w;const T=this.captureTo(V);switch(T){case 62:(w=this.doctypeHandler)===null||w===void 0||w.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case-1:break;default:this.text+=String.fromCodePoint(T),T===91?this.state=4:L(T)&&(this.state=3,this.q=T)}}sDoctypeQuote(){const w=this.q;this.captureToChar(w)&&(this.text+=String.fromCodePoint(w),this.q=null,this.state=2)}sDTD(){const w=this.captureTo(q);w!==-1&&(this.text+=String.fromCodePoint(w),w===93?this.state=2:w===60?this.state=6:L(w)&&(this.state=5,this.q=w))}sDTDQuoted(){const w=this.q;this.captureToChar(w)&&(this.text+=String.fromCodePoint(w),this.state=4,this.q=null)}sDTDOpenWaka(){const w=this.getCodeNorm();switch(this.text+=String.fromCodePoint(w),w){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const w=String.fromCodePoint(this.getCodeNorm()),T=this.openWakaBang+=w;this.text+=w,T!=="-"&&(this.state=T==="--"?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const w=this.getCodeNorm();this.text+=String.fromCodePoint(w),this.state=w===45?10:8}sDTDCommentEnded(){const w=this.getCodeNorm();this.text+=String.fromCodePoint(w),w===62?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const w=this.getCodeNorm();this.text+=String.fromCodePoint(w),w===62&&(this.state=4)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:w}=this;const{chunk:T}=this;e:for(;;)switch(this.getCode()){case-2:this.entity+=T.slice(w,this.prevI)+`
`,w=this.i;break;case 59:{const{entityReturnState:A}=this,S=this.entity+T.slice(w,this.prevI);let j;this.state=A,S===""?(this.fail("empty entity name."),j="&;"):(j=this.parseEntity(S),this.entity=""),A===13&&this.textHandler===void 0||(this.text+=j);break e}case-1:this.entity+=T.slice(w);break e}}sOpenWaka(){const w=this.getCode();if(u(w))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(w){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var w;const T=this.getCodeNorm();T===45?(this.state=19,(w=this.commentHandler)===null||w===void 0||w.call(this,this.text),this.text=""):(this.text+="-"+String.fromCodePoint(T),this.state=17)}sCommentEnded(){const w=this.getCodeNorm();w!==62?(this.fail("malformed comment."),this.text+="--"+String.fromCodePoint(w),this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){const w=this.getCodeNorm();w===93?this.state=22:(this.text+="]"+String.fromCodePoint(w),this.state=20)}sCDataEnding2(){var w;const T=this.getCodeNorm();switch(T){case 62:(w=this.cdataHandler)===null||w===void 0||w.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+="]]"+String.fromCodePoint(T),this.state=20}}sPIFirstChar(){const w=this.getCodeNorm();this.nameStartCheck(w)?(this.piTarget+=String.fromCodePoint(w),this.state=24):w===63||c(w)?(this.fail("processing instruction without a target."),this.state=w===63?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(w),this.state=24)}sPIRest(){const{chunk:w,i:T}=this;for(;;){const A=this.getCodeNorm();if(A===-1)return void(this.piTarget+=w.slice(T));if(!this.nameCheck(A)){this.piTarget+=w.slice(T,this.prevI);const S=A===63;S||c(A)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=S?33:27):this.state=S?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(A));break}}}sPIBody(){if(this.text.length===0){const w=this.getCodeNorm();w===63?this.state=26:c(w)||(this.text=String.fromCodePoint(w))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var w;const T=this.getCodeNorm();if(T===62){const{piTarget:A}=this;A.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(w=this.piHandler)===null||w===void 0||w.call(this,{target:A,body:this.text}),this.piTarget=this.text="",this.state=13}else T===63?this.text+="?":(this.text+="?"+String.fromCodePoint(T),this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const w=this.skipSpaces();w!==63?w!==-1&&(this.state=28,this.name=String.fromCodePoint(w)):this.state=33}sXMLDeclName(){const w=this.captureTo(K);if(w===63)return this.state=33,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(c(w)||w===61){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail("expected one of "+this.xmlDeclExpects.join(", "))}this.state=w===61?30:29}}sXMLDeclEq(){const w=this.getCodeNorm();if(w===63)return this.state=33,void this.fail("XML declaration is incomplete.");c(w)||(w!==61&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const w=this.getCodeNorm();if(w===63)return this.state=33,void this.fail("XML declaration is incomplete.");c(w)||(L(w)?this.q=w:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const w=this.captureTo([this.q,63]);if(w===63)return this.state=33,this.text="",void this.fail("XML declaration is incomplete.");if(w===-1)return;const T=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const A=T;this.xmlDecl.version=A,/^1\.[0-9]+$/.test(A)?this.opt.forceXMLVersion||this.setXMLVersion(A):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(T)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=T;break;case"standalone":T!=="yes"&&T!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=T}this.name="",this.state=32}sXMLDeclSeparator(){const w=this.getCodeNorm();w!==63?(c(w)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=33}sXMLDeclEnding(){var w;this.getCodeNorm()===62?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(w=this.xmldeclHandler)===null||w===void 0||w.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var w;const T=this.captureNameChars();if(T===-1)return;const A=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=A.ns=Object.create(null)),(w=this.openTagStartHandler)===null||w===void 0||w.call(this,A),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),T){case 62:this.openTag();break;case 47:this.state=35;break;default:c(T)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){this.getCode()===62?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const w=this.skipSpaces();w!==-1&&(u(w)?(this.unget(),this.state=37):w===62?this.openTag():w===47?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const w=this.captureNameChars();w===61?this.state=39:c(w)?this.state=38:w===62?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):w!==-1&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const w=this.skipSpaces();switch(w){case-1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",w===62?this.openTag():u(w)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const w=this.getCodeNorm();L(w)?(this.q=w,this.state=40):c(w)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){const{q:w,chunk:T}=this;let{i:A}=this;for(;;)switch(this.getCode()){case w:return this.pushAttrib(this.name,this.text+T.slice(A,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=T.slice(A,this.prevI),this.state=14,void(this.entityReturnState=40);case 10:case-2:case 9:this.text+=T.slice(A,this.prevI)+" ",A=this.i;break;case 60:return this.text+=T.slice(A,this.prevI),void this.fail("disallowed character.");case-1:return void(this.text+=T.slice(A))}}sAttribValueClosed(){const w=this.getCodeNorm();c(w)?this.state=36:w===62?this.openTag():w===47?this.state=35:u(w)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const w=this.captureTo(z);switch(w){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case-1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",w===62?this.openTag():this.state=36}}sCloseTag(){const w=this.captureNameChars();w===62?this.closeTag():c(w)?this.state=44:w!==-1&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case-1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:w,forbiddenState:T}=this;const{chunk:A,textHandler:S}=this;e:for(;;)switch(this.getCode()){case 60:if(this.state=15,S!==void 0){const{text:j}=this,B=A.slice(w,this.prevI);j.length!==0?(S(j+B),this.text=""):B.length!==0&&S(B)}T=0;break e;case 38:this.state=14,this.entityReturnState=13,S!==void 0&&(this.text+=A.slice(w,this.prevI)),T=0;break e;case 93:switch(T){case 0:T=1;break;case 1:T=2;break;case 2:break;default:throw new Error("impossible state")}break;case 62:T===2&&this.fail('the string "]]>" is disallowed in char data.'),T=0;break;case-2:S!==void 0&&(this.text+=A.slice(w,this.prevI)+`
`),w=this.i,T=0;break;case-1:S!==void 0&&(this.text+=A.slice(w));break e;default:T=0}this.forbiddenState=T}handleTextOutsideRoot(){let{i:w}=this;const{chunk:T,textHandler:A}=this;let S=!1;e:for(;;){const j=this.getCode();switch(j){case 60:if(this.state=15,A!==void 0){const{text:B}=this,R=T.slice(w,this.prevI);B.length!==0?(A(B+R),this.text=""):R.length!==0&&A(R)}break e;case 38:this.state=14,this.entityReturnState=13,A!==void 0&&(this.text+=T.slice(w,this.prevI)),S=!0;break e;case-2:A!==void 0&&(this.text+=T.slice(w,this.prevI)+`
`),w=this.i;break;case-1:A!==void 0&&(this.text+=T.slice(w));break e;default:c(j)||(S=!0)}}S&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(w,T){var A;const{prefix:S,local:j}=this.qname(w),B={name:w,prefix:S,local:j,value:T};if(this.attribList.push(B),(A=this.attributeHandler)===null||A===void 0||A.call(this,B),S==="xmlns"){const R=T.trim();this.currentXMLVersion==="1.0"&&R===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[j]=R,W(this,j,R)}else if(w==="xmlns"){const R=T.trim();this.topNS[""]=R,W(this,"",R)}}pushAttribPlain(w,T){var A;const S={name:w,value:T};this.attribList.push(S),(A=this.attributeHandler)===null||A===void 0||A.call(this,S)}end(){var w,T;this.sawRoot||this.fail("document must contain a root element.");const{tags:A}=this;for(;A.length>0;){const j=A.pop();this.fail("unclosed tag: "+j.name)}this.state!==0&&this.state!==13&&this.fail("unexpected end.");const{text:S}=this;return S.length!==0&&((w=this.textHandler)===null||w===void 0||w.call(this,S),this.text=""),this._closed=!0,(T=this.endHandler)===null||T===void 0||T.call(this),this._init(),this}resolve(w){var T,A;let S=this.topNS[w];if(S!==void 0)return S;const{tags:j}=this;for(let B=j.length-1;B>=0;B--)if(S=j[B].ns[w],S!==void 0)return S;return S=this.ns[w],S!==void 0?S:(A=(T=this.opt).resolvePrefix)===null||A===void 0?void 0:A.call(T,w)}qname(w){const T=w.indexOf(":");if(T===-1)return{prefix:"",local:w};const A=w.slice(T+1),S=w.slice(0,T);return(S===""||A===""||A.includes(":"))&&this.fail(`malformed name: ${w}.`),{prefix:S,local:A}}processAttribsNS(){var w;const{attribList:T}=this,A=this.tag;{const{prefix:B,local:R}=this.qname(A.name);A.prefix=B,A.local=R;const X=A.uri=(w=this.resolve(B))!==null&&w!==void 0?w:"";B!==""&&(B==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),X===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(B)}.`),A.uri=B))}if(T.length===0)return;const{attributes:S}=A,j=new Set;for(const B of T){const{name:R,prefix:X,local:Y}=B;let ee,U;X===""?(ee=R==="xmlns"?E:"",U=R):(ee=this.resolve(X),ee===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(X)}.`),ee=X),U=`{${ee}}${Y}`),j.has(U)&&this.fail(`duplicate attribute: ${U}.`),j.add(U),B.uri=ee,S[R]=B}this.attribList=[]}processAttribsPlain(){const{attribList:w}=this,T=this.tag.attributes;for(const{name:A,value:S}of w)T[A]!==void 0&&this.fail(`duplicate attribute: ${A}.`),T[A]=S;this.attribList=[]}openTag(){var w;this.processAttribs();const{tags:T}=this,A=this.tag;A.isSelfClosing=!1,(w=this.openTagHandler)===null||w===void 0||w.call(this,A),T.push(A),this.state=13,this.name=""}openSelfClosingTag(){var w,T,A;this.processAttribs();const{tags:S}=this,j=this.tag;j.isSelfClosing=!0,(w=this.openTagHandler)===null||w===void 0||w.call(this,j),(T=this.closeTagHandler)===null||T===void 0||T.call(this,j),(this.tag=(A=S[S.length-1])!==null&&A!==void 0?A:null)===null&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){const{tags:w,name:T}=this;if(this.state=13,this.name="",T==="")return this.fail("weird empty close tag."),void(this.text+="</>");const A=this.closeTagHandler;let S=w.length;for(;S-- >0;){const j=this.tag=w.pop();if(this.topNS=j.ns,A==null||A(j),j.name===T)break;this.fail("unexpected close tag.")}S===0?this.closedRoot=!0:S<0&&(this.fail(`unmatched closing tag: ${T}.`),this.text+=`</${T}>`)}parseEntity(w){if(w[0]!=="#"){const A=this.ENTITIES[w];return A!==void 0?A:(this.fail(this.isName(w)?"undefined entity.":"disallowed character in entity name."),`&${w};`)}let T=NaN;return w[1]==="x"&&/^#x[0-9a-f]+$/i.test(w)?T=parseInt(w.slice(2),16):/^#[0-9]+$/.test(w)&&(T=parseInt(w.slice(1),10)),this.isChar(T)?String.fromCodePoint(T):(this.fail("malformed character entity."),`&${w};`)}}},{"xmlchars/xml/1.0/ed5":543,"xmlchars/xml/1.1/ed2":544,"xmlchars/xmlns/1.0/ed3":545}],497:[function(e,n,a){var o=e("safe-buffer").Buffer;function s(l,c){this._block=o.alloc(l),this._finalSize=c,this._blockSize=l,this._len=0}s.prototype.update=function(l,c){typeof l=="string"&&(c=c||"utf8",l=o.from(l,c));for(var i=this._block,u=this._blockSize,p=l.length,f=this._len,h=0;h<p;){for(var v=f%u,b=Math.min(p-h,u-v),g=0;g<b;g++)i[v+g]=l[h+g];h+=b,(f+=b)%u==0&&this._update(i)}return this._len+=p,this},s.prototype.digest=function(l){var c=this._len%this._blockSize;this._block[c]=128,this._block.fill(0,c+1),c>=this._finalSize&&(this._update(this._block),this._block.fill(0));var i=8*this._len;if(i<=4294967295)this._block.writeUInt32BE(i,this._blockSize-4);else{var u=(4294967295&i)>>>0,p=(i-u)/4294967296;this._block.writeUInt32BE(p,this._blockSize-8),this._block.writeUInt32BE(u,this._blockSize-4)}this._update(this._block);var f=this._hash();return l?f.toString(l):f},s.prototype._update=function(){throw new Error("_update must be implemented by subclass")},n.exports=s},{"safe-buffer":494}],498:[function(e,n,a){var o=n.exports=function(s){s=s.toLowerCase();var l=o[s];if(!l)throw new Error(s+" is not supported (we accept pull requests)");return new l};o.sha=e("./sha"),o.sha1=e("./sha1"),o.sha224=e("./sha224"),o.sha256=e("./sha256"),o.sha384=e("./sha384"),o.sha512=e("./sha512")},{"./sha":499,"./sha1":500,"./sha224":501,"./sha256":502,"./sha384":503,"./sha512":504}],499:[function(e,n,a){var o=e("inherits"),s=e("./hash"),l=e("safe-buffer").Buffer,c=[1518500249,1859775393,-1894007588,-899497514],i=new Array(80);function u(){this.init(),this._w=i,s.call(this,64,56)}function p(h){return h<<30|h>>>2}function f(h,v,b,g){return h===0?v&b|~v&g:h===2?v&b|v&g|b&g:v^b^g}o(u,s),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(h){for(var v,b=this._w,g=0|this._a,x=0|this._b,y=0|this._c,E=0|this._d,N=0|this._e,I=0;I<16;++I)b[I]=h.readInt32BE(4*I);for(;I<80;++I)b[I]=b[I-3]^b[I-8]^b[I-14]^b[I-16];for(var L=0;L<80;++L){var H=~~(L/20),V=0|((v=g)<<5|v>>>27)+f(H,x,y,E)+N+b[L]+c[H];N=E,E=y,y=p(x),x=g,g=V}this._a=g+this._a|0,this._b=x+this._b|0,this._c=y+this._c|0,this._d=E+this._d|0,this._e=N+this._e|0},u.prototype._hash=function(){var h=l.allocUnsafe(20);return h.writeInt32BE(0|this._a,0),h.writeInt32BE(0|this._b,4),h.writeInt32BE(0|this._c,8),h.writeInt32BE(0|this._d,12),h.writeInt32BE(0|this._e,16),h},n.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],500:[function(e,n,a){var o=e("inherits"),s=e("./hash"),l=e("safe-buffer").Buffer,c=[1518500249,1859775393,-1894007588,-899497514],i=new Array(80);function u(){this.init(),this._w=i,s.call(this,64,56)}function p(v){return v<<5|v>>>27}function f(v){return v<<30|v>>>2}function h(v,b,g,x){return v===0?b&g|~b&x:v===2?b&g|b&x|g&x:b^g^x}o(u,s),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(v){for(var b,g=this._w,x=0|this._a,y=0|this._b,E=0|this._c,N=0|this._d,I=0|this._e,L=0;L<16;++L)g[L]=v.readInt32BE(4*L);for(;L<80;++L)g[L]=(b=g[L-3]^g[L-8]^g[L-14]^g[L-16])<<1|b>>>31;for(var H=0;H<80;++H){var V=~~(H/20),q=p(x)+h(V,y,E,N)+I+g[H]+c[V]|0;I=N,N=E,E=f(y),y=x,x=q}this._a=x+this._a|0,this._b=y+this._b|0,this._c=E+this._c|0,this._d=N+this._d|0,this._e=I+this._e|0},u.prototype._hash=function(){var v=l.allocUnsafe(20);return v.writeInt32BE(0|this._a,0),v.writeInt32BE(0|this._b,4),v.writeInt32BE(0|this._c,8),v.writeInt32BE(0|this._d,12),v.writeInt32BE(0|this._e,16),v},n.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],501:[function(e,n,a){var o=e("inherits"),s=e("./sha256"),l=e("./hash"),c=e("safe-buffer").Buffer,i=new Array(64);function u(){this.init(),this._w=i,l.call(this,64,56)}o(u,s),u.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},u.prototype._hash=function(){var p=c.allocUnsafe(28);return p.writeInt32BE(this._a,0),p.writeInt32BE(this._b,4),p.writeInt32BE(this._c,8),p.writeInt32BE(this._d,12),p.writeInt32BE(this._e,16),p.writeInt32BE(this._f,20),p.writeInt32BE(this._g,24),p},n.exports=u},{"./hash":497,"./sha256":502,inherits:440,"safe-buffer":494}],502:[function(e,n,a){var o=e("inherits"),s=e("./hash"),l=e("safe-buffer").Buffer,c=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],i=new Array(64);function u(){this.init(),this._w=i,s.call(this,64,56)}function p(g,x,y){return y^g&(x^y)}function f(g,x,y){return g&x|y&(g|x)}function h(g){return(g>>>2|g<<30)^(g>>>13|g<<19)^(g>>>22|g<<10)}function v(g){return(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7)}function b(g){return(g>>>7|g<<25)^(g>>>18|g<<14)^g>>>3}o(u,s),u.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},u.prototype._update=function(g){for(var x,y=this._w,E=0|this._a,N=0|this._b,I=0|this._c,L=0|this._d,H=0|this._e,V=0|this._f,q=0|this._g,K=0|this._h,z=0;z<16;++z)y[z]=g.readInt32BE(4*z);for(;z<64;++z)y[z]=0|(((x=y[z-2])>>>17|x<<15)^(x>>>19|x<<13)^x>>>10)+y[z-7]+b(y[z-15])+y[z-16];for(var W=0;W<64;++W){var D=K+v(H)+p(H,V,q)+c[W]+y[W]|0,M=h(E)+f(E,N,I)|0;K=q,q=V,V=H,H=L+D|0,L=I,I=N,N=E,E=D+M|0}this._a=E+this._a|0,this._b=N+this._b|0,this._c=I+this._c|0,this._d=L+this._d|0,this._e=H+this._e|0,this._f=V+this._f|0,this._g=q+this._g|0,this._h=K+this._h|0},u.prototype._hash=function(){var g=l.allocUnsafe(32);return g.writeInt32BE(this._a,0),g.writeInt32BE(this._b,4),g.writeInt32BE(this._c,8),g.writeInt32BE(this._d,12),g.writeInt32BE(this._e,16),g.writeInt32BE(this._f,20),g.writeInt32BE(this._g,24),g.writeInt32BE(this._h,28),g},n.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],503:[function(e,n,a){var o=e("inherits"),s=e("./sha512"),l=e("./hash"),c=e("safe-buffer").Buffer,i=new Array(160);function u(){this.init(),this._w=i,l.call(this,128,112)}o(u,s),u.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},u.prototype._hash=function(){var p=c.allocUnsafe(48);function f(h,v,b){p.writeInt32BE(h,b),p.writeInt32BE(v,b+4)}return f(this._ah,this._al,0),f(this._bh,this._bl,8),f(this._ch,this._cl,16),f(this._dh,this._dl,24),f(this._eh,this._el,32),f(this._fh,this._fl,40),p},n.exports=u},{"./hash":497,"./sha512":504,inherits:440,"safe-buffer":494}],504:[function(e,n,a){var o=e("inherits"),s=e("./hash"),l=e("safe-buffer").Buffer,c=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],i=new Array(160);function u(){this.init(),this._w=i,s.call(this,128,112)}function p(N,I,L){return L^N&(I^L)}function f(N,I,L){return N&I|L&(N|I)}function h(N,I){return(N>>>28|I<<4)^(I>>>2|N<<30)^(I>>>7|N<<25)}function v(N,I){return(N>>>14|I<<18)^(N>>>18|I<<14)^(I>>>9|N<<23)}function b(N,I){return(N>>>1|I<<31)^(N>>>8|I<<24)^N>>>7}function g(N,I){return(N>>>1|I<<31)^(N>>>8|I<<24)^(N>>>7|I<<25)}function x(N,I){return(N>>>19|I<<13)^(I>>>29|N<<3)^N>>>6}function y(N,I){return(N>>>19|I<<13)^(I>>>29|N<<3)^(N>>>6|I<<26)}function E(N,I){return N>>>0<I>>>0?1:0}o(u,s),u.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},u.prototype._update=function(N){for(var I=this._w,L=0|this._ah,H=0|this._bh,V=0|this._ch,q=0|this._dh,K=0|this._eh,z=0|this._fh,W=0|this._gh,D=0|this._hh,M=0|this._al,C=0|this._bl,w=0|this._cl,T=0|this._dl,A=0|this._el,S=0|this._fl,j=0|this._gl,B=0|this._hl,R=0;R<32;R+=2)I[R]=N.readInt32BE(4*R),I[R+1]=N.readInt32BE(4*R+4);for(;R<160;R+=2){var X=I[R-30],Y=I[R-30+1],ee=b(X,Y),U=g(Y,X),Q=x(X=I[R-4],Y=I[R-4+1]),P=y(Y,X),F=I[R-14],Z=I[R-14+1],se=I[R-32],re=I[R-32+1],ae=U+Z|0,te=ee+F+E(ae,U)|0;te=(te=te+Q+E(ae=ae+P|0,P)|0)+se+E(ae=ae+re|0,re)|0,I[R]=te,I[R+1]=ae}for(var he=0;he<160;he+=2){te=I[he],ae=I[he+1];var le=f(L,H,V),ne=f(M,C,w),de=h(L,M),fe=h(M,L),Se=v(K,A),_e=v(A,K),Ce=c[he],Re=c[he+1],Pe=p(K,z,W),Ye=p(A,S,j),at=B+_e|0,tt=D+Se+E(at,B)|0;tt=(tt=(tt=tt+Pe+E(at=at+Ye|0,Ye)|0)+Ce+E(at=at+Re|0,Re)|0)+te+E(at=at+ae|0,ae)|0;var it=fe+ne|0,rt=de+le+E(it,fe)|0;D=W,B=j,W=z,j=S,z=K,S=A,K=q+tt+E(A=T+at|0,T)|0,q=V,T=w,V=H,w=C,H=L,C=M,L=tt+rt+E(M=at+it|0,at)|0}this._al=this._al+M|0,this._bl=this._bl+C|0,this._cl=this._cl+w|0,this._dl=this._dl+T|0,this._el=this._el+A|0,this._fl=this._fl+S|0,this._gl=this._gl+j|0,this._hl=this._hl+B|0,this._ah=this._ah+L+E(this._al,M)|0,this._bh=this._bh+H+E(this._bl,C)|0,this._ch=this._ch+V+E(this._cl,w)|0,this._dh=this._dh+q+E(this._dl,T)|0,this._eh=this._eh+K+E(this._el,A)|0,this._fh=this._fh+z+E(this._fl,S)|0,this._gh=this._gh+W+E(this._gl,j)|0,this._hh=this._hh+D+E(this._hl,B)|0},u.prototype._hash=function(){var N=l.allocUnsafe(64);function I(L,H,V){N.writeInt32BE(L,V),N.writeInt32BE(H,V+4)}return I(this._ah,this._al,0),I(this._bh,this._bl,8),I(this._ch,this._cl,16),I(this._dh,this._dl,24),I(this._eh,this._el,32),I(this._fh,this._fl,40),I(this._gh,this._gl,48),I(this._hh,this._hl,56),N},n.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],505:[function(e,n,a){n.exports=s;var o=e("events").EventEmitter;function s(){o.call(this)}e("inherits")(s,o),s.Readable=e("readable-stream/readable.js"),s.Writable=e("readable-stream/writable.js"),s.Duplex=e("readable-stream/duplex.js"),s.Transform=e("readable-stream/transform.js"),s.PassThrough=e("readable-stream/passthrough.js"),s.Stream=s,s.prototype.pipe=function(l,c){var i=this;function u(x){l.writable&&l.write(x)===!1&&i.pause&&i.pause()}function p(){i.readable&&i.resume&&i.resume()}i.on("data",u),l.on("drain",p),l._isStdio||c&&c.end===!1||(i.on("end",h),i.on("close",v));var f=!1;function h(){f||(f=!0,l.end())}function v(){f||(f=!0,typeof l.destroy=="function"&&l.destroy())}function b(x){if(g(),o.listenerCount(this,"error")===0)throw x}function g(){i.removeListener("data",u),l.removeListener("drain",p),i.removeListener("end",h),i.removeListener("close",v),i.removeListener("error",b),l.removeListener("error",b),i.removeListener("end",g),i.removeListener("close",g),l.removeListener("close",g)}return i.on("error",b),l.on("error",b),i.on("end",g),i.on("close",g),l.on("close",g),l.emit("pipe",i),l}},{events:422,inherits:440,"readable-stream/duplex.js":507,"readable-stream/passthrough.js":516,"readable-stream/readable.js":517,"readable-stream/transform.js":518,"readable-stream/writable.js":519}],506:[function(e,n,a){var o={}.toString;n.exports=Array.isArray||function(s){return o.call(s)=="[object Array]"}},{}],507:[function(e,n,a){n.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":508}],508:[function(e,n,a){var o=e("process-nextick-args"),s=Object.keys||function(g){var x=[];for(var y in g)x.push(y);return x};n.exports=h;var l=Object.create(e("core-util-is"));l.inherits=e("inherits");var c=e("./_stream_readable"),i=e("./_stream_writable");l.inherits(h,c);for(var u=s(i.prototype),p=0;p<u.length;p++){var f=u[p];h.prototype[f]||(h.prototype[f]=i.prototype[f])}function h(g){if(!(this instanceof h))return new h(g);c.call(this,g),i.call(this,g),g&&g.readable===!1&&(this.readable=!1),g&&g.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,g&&g.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",v)}function v(){this.allowHalfOpen||this._writableState.ended||o.nextTick(b,this)}function b(g){g.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(g){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=g,this._writableState.destroyed=g)}}),h.prototype._destroy=function(g,x){this.push(null),this.end(),o.nextTick(x,g)}},{"./_stream_readable":510,"./_stream_writable":512,"core-util-is":383,inherits:440,"process-nextick-args":466}],509:[function(e,n,a){n.exports=l;var o=e("./_stream_transform"),s=Object.create(e("core-util-is"));function l(c){if(!(this instanceof l))return new l(c);o.call(this,c)}s.inherits=e("inherits"),s.inherits(l,o),l.prototype._transform=function(c,i,u){u(null,c)}},{"./_stream_transform":511,"core-util-is":383,inherits:440}],510:[function(e,n,a){(function(o,s){(function(){var l=e("process-nextick-args");n.exports=L;var c,i=e("isarray");L.ReadableState=I,e("events").EventEmitter;var u=function(B,R){return B.listeners(R).length},p=e("./internal/streams/stream"),f=e("safe-buffer").Buffer,h=(s!==void 0?s:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},v=Object.create(e("core-util-is"));v.inherits=e("inherits");var b=e("util"),g=void 0;g=b&&b.debuglog?b.debuglog("stream"):function(){};var x,y=e("./internal/streams/BufferList"),E=e("./internal/streams/destroy");v.inherits(L,p);var N=["error","close","destroy","pause","resume"];function I(B,R){B=B||{};var X=R instanceof(c=c||e("./_stream_duplex"));this.objectMode=!!B.objectMode,X&&(this.objectMode=this.objectMode||!!B.readableObjectMode);var Y=B.highWaterMark,ee=B.readableHighWaterMark,U=this.objectMode?16:16384;this.highWaterMark=Y||Y===0?Y:X&&(ee||ee===0)?ee:U,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=B.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,B.encoding&&(x||(x=e("string_decoder/").StringDecoder),this.decoder=new x(B.encoding),this.encoding=B.encoding)}function L(B){if(c=c||e("./_stream_duplex"),!(this instanceof L))return new L(B);this._readableState=new I(B,this),this.readable=!0,B&&(typeof B.read=="function"&&(this._read=B.read),typeof B.destroy=="function"&&(this._destroy=B.destroy)),p.call(this)}function H(B,R,X,Y,ee){var U,Q=B._readableState;return R===null?(Q.reading=!1,function(P,F){if(!F.ended){if(F.decoder){var Z=F.decoder.end();Z&&Z.length&&(F.buffer.push(Z),F.length+=F.objectMode?1:Z.length)}F.ended=!0,K(P)}}(B,Q)):(ee||(U=function(P,F){var Z;se=F,f.isBuffer(se)||se instanceof h||typeof F=="string"||F===void 0||P.objectMode||(Z=new TypeError("Invalid non-string/buffer chunk"));var se;return Z}(Q,R)),U?B.emit("error",U):Q.objectMode||R&&R.length>0?(typeof R=="string"||Q.objectMode||Object.getPrototypeOf(R)===f.prototype||(R=function(P){return f.from(P)}(R)),Y?Q.endEmitted?B.emit("error",new Error("stream.unshift() after end event")):V(B,Q,R,!0):Q.ended?B.emit("error",new Error("stream.push() after EOF")):(Q.reading=!1,Q.decoder&&!X?(R=Q.decoder.write(R),Q.objectMode||R.length!==0?V(B,Q,R,!1):W(B,Q)):V(B,Q,R,!1))):Y||(Q.reading=!1)),function(P){return!P.ended&&(P.needReadable||P.length<P.highWaterMark||P.length===0)}(Q)}function V(B,R,X,Y){R.flowing&&R.length===0&&!R.sync?(B.emit("data",X),B.read(0)):(R.length+=R.objectMode?1:X.length,Y?R.buffer.unshift(X):R.buffer.push(X),R.needReadable&&K(B)),W(B,R)}Object.defineProperty(L.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(B){this._readableState&&(this._readableState.destroyed=B)}}),L.prototype.destroy=E.destroy,L.prototype._undestroy=E.undestroy,L.prototype._destroy=function(B,R){this.push(null),R(B)},L.prototype.push=function(B,R){var X,Y=this._readableState;return Y.objectMode?X=!0:typeof B=="string"&&((R=R||Y.defaultEncoding)!==Y.encoding&&(B=f.from(B,R),R=""),X=!0),H(this,B,R,!1,X)},L.prototype.unshift=function(B){return H(this,B,null,!0,!1)},L.prototype.isPaused=function(){return this._readableState.flowing===!1},L.prototype.setEncoding=function(B){return x||(x=e("string_decoder/").StringDecoder),this._readableState.decoder=new x(B),this._readableState.encoding=B,this};function q(B,R){return B<=0||R.length===0&&R.ended?0:R.objectMode?1:B!=B?R.flowing&&R.length?R.buffer.head.data.length:R.length:(B>R.highWaterMark&&(R.highWaterMark=function(X){return X>=8388608?X=8388608:(X--,X|=X>>>1,X|=X>>>2,X|=X>>>4,X|=X>>>8,X|=X>>>16,X++),X}(B)),B<=R.length?B:R.ended?R.length:(R.needReadable=!0,0))}function K(B){var R=B._readableState;R.needReadable=!1,R.emittedReadable||(g("emitReadable",R.flowing),R.emittedReadable=!0,R.sync?l.nextTick(z,B):z(B))}function z(B){g("emit readable"),B.emit("readable"),w(B)}function W(B,R){R.readingMore||(R.readingMore=!0,l.nextTick(D,B,R))}function D(B,R){for(var X=R.length;!R.reading&&!R.flowing&&!R.ended&&R.length<R.highWaterMark&&(g("maybeReadMore read 0"),B.read(0),X!==R.length);)X=R.length;R.readingMore=!1}function M(B){g("readable nexttick read 0"),B.read(0)}function C(B,R){R.reading||(g("resume read 0"),B.read(0)),R.resumeScheduled=!1,R.awaitDrain=0,B.emit("resume"),w(B),R.flowing&&!R.reading&&B.read(0)}function w(B){var R=B._readableState;for(g("flow",R.flowing);R.flowing&&B.read()!==null;);}function T(B,R){return R.length===0?null:(R.objectMode?X=R.buffer.shift():!B||B>=R.length?(X=R.decoder?R.buffer.join(""):R.buffer.length===1?R.buffer.head.data:R.buffer.concat(R.length),R.buffer.clear()):X=function(Y,ee,U){var Q;return Y<ee.head.data.length?(Q=ee.head.data.slice(0,Y),ee.head.data=ee.head.data.slice(Y)):Q=Y===ee.head.data.length?ee.shift():U?function(P,F){var Z=F.head,se=1,re=Z.data;for(P-=re.length;Z=Z.next;){var ae=Z.data,te=P>ae.length?ae.length:P;if(te===ae.length?re+=ae:re+=ae.slice(0,P),(P-=te)===0){te===ae.length?(++se,Z.next?F.head=Z.next:F.head=F.tail=null):(F.head=Z,Z.data=ae.slice(te));break}++se}return F.length-=se,re}(Y,ee):function(P,F){var Z=f.allocUnsafe(P),se=F.head,re=1;for(se.data.copy(Z),P-=se.data.length;se=se.next;){var ae=se.data,te=P>ae.length?ae.length:P;if(ae.copy(Z,Z.length-P,0,te),(P-=te)===0){te===ae.length?(++re,se.next?F.head=se.next:F.head=F.tail=null):(F.head=se,se.data=ae.slice(te));break}++re}return F.length-=re,Z}(Y,ee),Q}(B,R.buffer,R.decoder),X);var X}function A(B){var R=B._readableState;if(R.length>0)throw new Error('"endReadable()" called on non-empty stream');R.endEmitted||(R.ended=!0,l.nextTick(S,R,B))}function S(B,R){B.endEmitted||B.length!==0||(B.endEmitted=!0,R.readable=!1,R.emit("end"))}function j(B,R){for(var X=0,Y=B.length;X<Y;X++)if(B[X]===R)return X;return-1}L.prototype.read=function(B){g("read",B),B=parseInt(B,10);var R=this._readableState,X=B;if(B!==0&&(R.emittedReadable=!1),B===0&&R.needReadable&&(R.length>=R.highWaterMark||R.ended))return g("read: emitReadable",R.length,R.ended),R.length===0&&R.ended?A(this):K(this),null;if((B=q(B,R))===0&&R.ended)return R.length===0&&A(this),null;var Y,ee=R.needReadable;return g("need readable",ee),(R.length===0||R.length-B<R.highWaterMark)&&g("length less than watermark",ee=!0),R.ended||R.reading?g("reading or ended",ee=!1):ee&&(g("do read"),R.reading=!0,R.sync=!0,R.length===0&&(R.needReadable=!0),this._read(R.highWaterMark),R.sync=!1,R.reading||(B=q(X,R))),(Y=B>0?T(B,R):null)===null?(R.needReadable=!0,B=0):R.length-=B,R.length===0&&(R.ended||(R.needReadable=!0),X!==B&&R.ended&&A(this)),Y!==null&&this.emit("data",Y),Y},L.prototype._read=function(B){this.emit("error",new Error("_read() is not implemented"))},L.prototype.pipe=function(B,R){var X=this,Y=this._readableState;switch(Y.pipesCount){case 0:Y.pipes=B;break;case 1:Y.pipes=[Y.pipes,B];break;default:Y.pipes.push(B)}Y.pipesCount+=1,g("pipe count=%d opts=%j",Y.pipesCount,R);var ee=(!R||R.end!==!1)&&B!==o.stdout&&B!==o.stderr?Q:he;function U(le,ne){g("onunpipe"),le===X&&ne&&ne.hasUnpiped===!1&&(ne.hasUnpiped=!0,g("cleanup"),B.removeListener("close",ae),B.removeListener("finish",te),B.removeListener("drain",P),B.removeListener("error",re),B.removeListener("unpipe",U),X.removeListener("end",Q),X.removeListener("end",he),X.removeListener("data",se),F=!0,!Y.awaitDrain||B._writableState&&!B._writableState.needDrain||P())}function Q(){g("onend"),B.end()}Y.endEmitted?l.nextTick(ee):X.once("end",ee),B.on("unpipe",U);var P=function(le){return function(){var ne=le._readableState;g("pipeOnDrain",ne.awaitDrain),ne.awaitDrain&&ne.awaitDrain--,ne.awaitDrain===0&&u(le,"data")&&(ne.flowing=!0,w(le))}}(X);B.on("drain",P);var F=!1,Z=!1;function se(le){g("ondata"),Z=!1,B.write(le)!==!1||Z||((Y.pipesCount===1&&Y.pipes===B||Y.pipesCount>1&&j(Y.pipes,B)!==-1)&&!F&&(g("false write response, pause",Y.awaitDrain),Y.awaitDrain++,Z=!0),X.pause())}function re(le){g("onerror",le),he(),B.removeListener("error",re),u(B,"error")===0&&B.emit("error",le)}function ae(){B.removeListener("finish",te),he()}function te(){g("onfinish"),B.removeListener("close",ae),he()}function he(){g("unpipe"),X.unpipe(B)}return X.on("data",se),function(le,ne,de){if(typeof le.prependListener=="function")return le.prependListener(ne,de);le._events&&le._events[ne]?i(le._events[ne])?le._events[ne].unshift(de):le._events[ne]=[de,le._events[ne]]:le.on(ne,de)}(B,"error",re),B.once("close",ae),B.once("finish",te),B.emit("pipe",X),Y.flowing||(g("pipe resume"),X.resume()),B},L.prototype.unpipe=function(B){var R=this._readableState,X={hasUnpiped:!1};if(R.pipesCount===0)return this;if(R.pipesCount===1)return B&&B!==R.pipes||(B||(B=R.pipes),R.pipes=null,R.pipesCount=0,R.flowing=!1,B&&B.emit("unpipe",this,X)),this;if(!B){var Y=R.pipes,ee=R.pipesCount;R.pipes=null,R.pipesCount=0,R.flowing=!1;for(var U=0;U<ee;U++)Y[U].emit("unpipe",this,{hasUnpiped:!1});return this}var Q=j(R.pipes,B);return Q===-1||(R.pipes.splice(Q,1),R.pipesCount-=1,R.pipesCount===1&&(R.pipes=R.pipes[0]),B.emit("unpipe",this,X)),this},L.prototype.on=function(B,R){var X=p.prototype.on.call(this,B,R);if(B==="data")this._readableState.flowing!==!1&&this.resume();else if(B==="readable"){var Y=this._readableState;Y.endEmitted||Y.readableListening||(Y.readableListening=Y.needReadable=!0,Y.emittedReadable=!1,Y.reading?Y.length&&K(this):l.nextTick(M,this))}return X},L.prototype.addListener=L.prototype.on,L.prototype.resume=function(){var B=this._readableState;return B.flowing||(g("resume"),B.flowing=!0,function(R,X){X.resumeScheduled||(X.resumeScheduled=!0,l.nextTick(C,R,X))}(this,B)),this},L.prototype.pause=function(){return g("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(g("pause"),this._readableState.flowing=!1,this.emit("pause")),this},L.prototype.wrap=function(B){var R=this,X=this._readableState,Y=!1;for(var ee in B.on("end",function(){if(g("wrapped end"),X.decoder&&!X.ended){var Q=X.decoder.end();Q&&Q.length&&R.push(Q)}R.push(null)}),B.on("data",function(Q){g("wrapped data"),X.decoder&&(Q=X.decoder.write(Q)),X.objectMode&&Q==null||(X.objectMode||Q&&Q.length)&&(R.push(Q)||(Y=!0,B.pause()))}),B)this[ee]===void 0&&typeof B[ee]=="function"&&(this[ee]=function(Q){return function(){return B[Q].apply(B,arguments)}}(ee));for(var U=0;U<N.length;U++)B.on(N[U],this.emit.bind(this,N[U]));return this._read=function(Q){g("wrapped _read",Q),Y&&(Y=!1,B.resume())},this},Object.defineProperty(L.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),L._fromList=T}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"./_stream_duplex":508,"./internal/streams/BufferList":513,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,events:422,inherits:440,isarray:506,"process-nextick-args":466,"safe-buffer":520,"string_decoder/":521,util:188}],511:[function(e,n,a){n.exports=c;var o=e("./_stream_duplex"),s=Object.create(e("core-util-is"));function l(p,f){var h=this._transformState;h.transforming=!1;var v=h.writecb;if(!v)return this.emit("error",new Error("write callback called multiple times"));h.writechunk=null,h.writecb=null,f!=null&&this.push(f),v(p);var b=this._readableState;b.reading=!1,(b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}function c(p){if(!(this instanceof c))return new c(p);o.call(this,p),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,p&&(typeof p.transform=="function"&&(this._transform=p.transform),typeof p.flush=="function"&&(this._flush=p.flush)),this.on("prefinish",i)}function i(){var p=this;typeof this._flush=="function"?this._flush(function(f,h){u(p,f,h)}):u(this,null,null)}function u(p,f,h){if(f)return p.emit("error",f);if(h!=null&&p.push(h),p._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(p._transformState.transforming)throw new Error("Calling transform done when still transforming");return p.push(null)}s.inherits=e("inherits"),s.inherits(c,o),c.prototype.push=function(p,f){return this._transformState.needTransform=!1,o.prototype.push.call(this,p,f)},c.prototype._transform=function(p,f,h){throw new Error("_transform() is not implemented")},c.prototype._write=function(p,f,h){var v=this._transformState;if(v.writecb=h,v.writechunk=p,v.writeencoding=f,!v.transforming){var b=this._readableState;(v.needTransform||b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}},c.prototype._read=function(p){var f=this._transformState;f.writechunk!==null&&f.writecb&&!f.transforming?(f.transforming=!0,this._transform(f.writechunk,f.writeencoding,f.afterTransform)):f.needTransform=!0},c.prototype._destroy=function(p,f){var h=this;o.prototype._destroy.call(this,p,function(v){f(v),h.emit("close")})}},{"./_stream_duplex":508,"core-util-is":383,inherits:440}],512:[function(e,n,a){(function(o,s,l){(function(){var c=e("process-nextick-args");function i(W){var D=this;this.next=null,this.entry=null,this.finish=function(){(function(M,C,w){var T=M.entry;for(M.entry=null;T;){var A=T.callback;C.pendingcb--,A(w),T=T.next}C.corkedRequestsFree.next=M})(D,W)}}n.exports=I;var u,p=!o.browser&&["v0.10","v0.9."].indexOf(o.version.slice(0,5))>-1?l:c.nextTick;I.WritableState=N;var f=Object.create(e("core-util-is"));f.inherits=e("inherits");var h={deprecate:e("util-deprecate")},v=e("./internal/streams/stream"),b=e("safe-buffer").Buffer,g=(s!==void 0?s:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},x,y=e("./internal/streams/destroy");function E(){}function N(W,D){u=u||e("./_stream_duplex"),W=W||{};var M=D instanceof u;this.objectMode=!!W.objectMode,M&&(this.objectMode=this.objectMode||!!W.writableObjectMode);var C=W.highWaterMark,w=W.writableHighWaterMark,T=this.objectMode?16:16384;this.highWaterMark=C||C===0?C:M&&(w||w===0)?w:T,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var A=W.decodeStrings===!1;this.decodeStrings=!A,this.defaultEncoding=W.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(S){(function(j,B){var R=j._writableState,X=R.sync,Y=R.writecb;if(function(U){U.writing=!1,U.writecb=null,U.length-=U.writelen,U.writelen=0}(R),B)(function(U,Q,P,F,Z){--Q.pendingcb,P?(c.nextTick(Z,F),c.nextTick(z,U,Q),U._writableState.errorEmitted=!0,U.emit("error",F)):(Z(F),U._writableState.errorEmitted=!0,U.emit("error",F),z(U,Q))})(j,R,X,B,Y);else{var ee=q(R);ee||R.corked||R.bufferProcessing||!R.bufferedRequest||V(j,R),X?p(H,j,R,ee,Y):H(j,R,ee,Y)}})(D,S)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function I(W){if(u=u||e("./_stream_duplex"),!(x.call(I,this)||this instanceof u))return new I(W);this._writableState=new N(W,this),this.writable=!0,W&&(typeof W.write=="function"&&(this._write=W.write),typeof W.writev=="function"&&(this._writev=W.writev),typeof W.destroy=="function"&&(this._destroy=W.destroy),typeof W.final=="function"&&(this._final=W.final)),v.call(this)}function L(W,D,M,C,w,T,A){D.writelen=C,D.writecb=A,D.writing=!0,D.sync=!0,M?W._writev(w,D.onwrite):W._write(w,T,D.onwrite),D.sync=!1}function H(W,D,M,C){M||function(w,T){T.length===0&&T.needDrain&&(T.needDrain=!1,w.emit("drain"))}(W,D),D.pendingcb--,C(),z(W,D)}function V(W,D){D.bufferProcessing=!0;var M=D.bufferedRequest;if(W._writev&&M&&M.next){var C=D.bufferedRequestCount,w=new Array(C),T=D.corkedRequestsFree;T.entry=M;for(var A=0,S=!0;M;)w[A]=M,M.isBuf||(S=!1),M=M.next,A+=1;w.allBuffers=S,L(W,D,!0,D.length,w,"",T.finish),D.pendingcb++,D.lastBufferedRequest=null,T.next?(D.corkedRequestsFree=T.next,T.next=null):D.corkedRequestsFree=new i(D),D.bufferedRequestCount=0}else{for(;M;){var j=M.chunk,B=M.encoding,R=M.callback;if(L(W,D,!1,D.objectMode?1:j.length,j,B,R),M=M.next,D.bufferedRequestCount--,D.writing)break}M===null&&(D.lastBufferedRequest=null)}D.bufferedRequest=M,D.bufferProcessing=!1}function q(W){return W.ending&&W.length===0&&W.bufferedRequest===null&&!W.finished&&!W.writing}function K(W,D){W._final(function(M){D.pendingcb--,M&&W.emit("error",M),D.prefinished=!0,W.emit("prefinish"),z(W,D)})}function z(W,D){var M=q(D);return M&&(function(C,w){w.prefinished||w.finalCalled||(typeof C._final=="function"?(w.pendingcb++,w.finalCalled=!0,c.nextTick(K,C,w)):(w.prefinished=!0,C.emit("prefinish")))}(W,D),D.pendingcb===0&&(D.finished=!0,W.emit("finish"))),M}f.inherits(I,v),N.prototype.getBuffer=function(){for(var W=this.bufferedRequest,D=[];W;)D.push(W),W=W.next;return D},function(){try{Object.defineProperty(N.prototype,"buffer",{get:h.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(x=Function.prototype[Symbol.hasInstance],Object.defineProperty(I,Symbol.hasInstance,{value:function(W){return!!x.call(this,W)||this===I&&W&&W._writableState instanceof N}})):x=function(W){return W instanceof this},I.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},I.prototype.write=function(W,D,M){var C,w=this._writableState,T=!1,A=!w.objectMode&&(C=W,b.isBuffer(C)||C instanceof g);return A&&!b.isBuffer(W)&&(W=function(S){return b.from(S)}(W)),typeof D=="function"&&(M=D,D=null),A?D="buffer":D||(D=w.defaultEncoding),typeof M!="function"&&(M=E),w.ended?function(S,j){var B=new Error("write after end");S.emit("error",B),c.nextTick(j,B)}(this,M):(A||function(S,j,B,R){var X=!0,Y=!1;return B===null?Y=new TypeError("May not write null values to stream"):typeof B=="string"||B===void 0||j.objectMode||(Y=new TypeError("Invalid non-string/buffer chunk")),Y&&(S.emit("error",Y),c.nextTick(R,Y),X=!1),X}(this,w,W,M))&&(w.pendingcb++,T=function(S,j,B,R,X,Y){if(!B){var ee=function(F,Z,se){return F.objectMode||F.decodeStrings===!1||typeof Z!="string"||(Z=b.from(Z,se)),Z}(j,R,X);R!==ee&&(B=!0,X="buffer",R=ee)}var U=j.objectMode?1:R.length;j.length+=U;var Q=j.length<j.highWaterMark;if(Q||(j.needDrain=!0),j.writing||j.corked){var P=j.lastBufferedRequest;j.lastBufferedRequest={chunk:R,encoding:X,isBuf:B,callback:Y,next:null},P?P.next=j.lastBufferedRequest:j.bufferedRequest=j.lastBufferedRequest,j.bufferedRequestCount+=1}else L(S,j,!1,U,R,X,Y);return Q}(this,w,A,W,D,M)),T},I.prototype.cork=function(){this._writableState.corked++},I.prototype.uncork=function(){var W=this._writableState;W.corked&&(W.corked--,W.writing||W.corked||W.bufferProcessing||!W.bufferedRequest||V(this,W))},I.prototype.setDefaultEncoding=function(W){if(typeof W=="string"&&(W=W.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((W+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+W);return this._writableState.defaultEncoding=W,this},Object.defineProperty(I.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),I.prototype._write=function(W,D,M){M(new Error("_write() is not implemented"))},I.prototype._writev=null,I.prototype.end=function(W,D,M){var C=this._writableState;typeof W=="function"?(M=W,W=null,D=null):typeof D=="function"&&(M=D,D=null),W!=null&&this.write(W,D),C.corked&&(C.corked=1,this.uncork()),C.ending||function(w,T,A){T.ending=!0,z(w,T),A&&(T.finished?c.nextTick(A):w.once("finish",A)),T.ended=!0,w.writable=!1}(this,C,M)},Object.defineProperty(I.prototype,"destroyed",{get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(W){this._writableState&&(this._writableState.destroyed=W)}}),I.prototype.destroy=y.destroy,I.prototype._undestroy=y.undestroy,I.prototype._destroy=function(W,D){this.end(),D(W)}}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{},e("timers").setImmediate)},{"./_stream_duplex":508,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,inherits:440,"process-nextick-args":466,"safe-buffer":520,timers:523,"util-deprecate":524}],513:[function(e,n,a){var o=e("safe-buffer").Buffer,s=e("util");n.exports=function(){function l(){(function(c,i){if(!(c instanceof i))throw new TypeError("Cannot call a class as a function")})(this,l),this.head=null,this.tail=null,this.length=0}return l.prototype.push=function(c){var i={data:c,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length},l.prototype.unshift=function(c){var i={data:c,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length},l.prototype.shift=function(){if(this.length!==0){var c=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,c}},l.prototype.clear=function(){this.head=this.tail=null,this.length=0},l.prototype.join=function(c){if(this.length===0)return"";for(var i=this.head,u=""+i.data;i=i.next;)u+=c+i.data;return u},l.prototype.concat=function(c){if(this.length===0)return o.alloc(0);for(var i,u,p,f=o.allocUnsafe(c>>>0),h=this.head,v=0;h;)i=h.data,u=f,p=v,i.copy(u,p),v+=h.data.length,h=h.next;return f},l}(),s&&s.inspect&&s.inspect.custom&&(n.exports.prototype[s.inspect.custom]=function(){var l=s.inspect({length:this.length});return this.constructor.name+" "+l})},{"safe-buffer":520,util:188}],514:[function(e,n,a){var o=e("process-nextick-args");function s(l,c){l.emit("error",c)}n.exports={destroy:function(l,c){var i=this,u=this._readableState&&this._readableState.destroyed,p=this._writableState&&this._writableState.destroyed;return u||p?(c?c(l):l&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,o.nextTick(s,this,l)):o.nextTick(s,this,l)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(l||null,function(f){!c&&f?i._writableState?i._writableState.errorEmitted||(i._writableState.errorEmitted=!0,o.nextTick(s,i,f)):o.nextTick(s,i,f):c&&c(f)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":466}],515:[function(e,n,a){arguments[4][490][0].apply(a,arguments)},{dup:490,events:422}],516:[function(e,n,a){n.exports=e("./readable").PassThrough},{"./readable":517}],517:[function(e,n,a){(a=n.exports=e("./lib/_stream_readable.js")).Stream=a,a.Readable=a,a.Writable=e("./lib/_stream_writable.js"),a.Duplex=e("./lib/_stream_duplex.js"),a.Transform=e("./lib/_stream_transform.js"),a.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":508,"./lib/_stream_passthrough.js":509,"./lib/_stream_readable.js":510,"./lib/_stream_transform.js":511,"./lib/_stream_writable.js":512}],518:[function(e,n,a){n.exports=e("./readable").Transform},{"./readable":517}],519:[function(e,n,a){n.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":512}],520:[function(e,n,a){arguments[4][217][0].apply(a,arguments)},{buffer:220,dup:217}],521:[function(e,n,a){arguments[4][218][0].apply(a,arguments)},{dup:218,"safe-buffer":520}],522:[function(e,n,a){arguments[4][218][0].apply(a,arguments)},{dup:218,"safe-buffer":494}],523:[function(e,n,a){(function(o,s){(function(){var l=e("process/browser.js").nextTick,c=Function.prototype.apply,i=Array.prototype.slice,u={},p=0;function f(h,v){this._id=h,this._clearFn=v}a.setTimeout=function(){return new f(c.call(setTimeout,window,arguments),clearTimeout)},a.setInterval=function(){return new f(c.call(setInterval,window,arguments),clearInterval)},a.clearTimeout=a.clearInterval=function(h){h.close()},f.prototype.unref=f.prototype.ref=function(){},f.prototype.close=function(){this._clearFn.call(window,this._id)},a.enroll=function(h,v){clearTimeout(h._idleTimeoutId),h._idleTimeout=v},a.unenroll=function(h){clearTimeout(h._idleTimeoutId),h._idleTimeout=-1},a._unrefActive=a.active=function(h){clearTimeout(h._idleTimeoutId);var v=h._idleTimeout;v>=0&&(h._idleTimeoutId=setTimeout(function(){h._onTimeout&&h._onTimeout()},v))},a.setImmediate=typeof o=="function"?o:function(h){var v=p++,b=!(arguments.length<2)&&i.call(arguments,1);return u[v]=!0,l(function(){u[v]&&(b?h.apply(null,b):h.call(null),a.clearImmediate(v))}),v},a.clearImmediate=typeof s=="function"?s:function(h){delete u[h]}}).call(this)}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":467,timers:523}],524:[function(e,n,a){(function(o){(function(){function s(l){try{if(!o.localStorage)return!1}catch{return!1}var c=o.localStorage[l];return c!=null&&String(c).toLowerCase()==="true"}n.exports=function(l,c){if(s("noDeprecation"))return l;var i=!1;return function(){if(!i){if(s("throwDeprecation"))throw new Error(c);s("traceDeprecation")?console.trace(c):console.warn(c),i=!0}return l.apply(this,arguments)}}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],525:[function(e,n,a){typeof Object.create=="function"?n.exports=function(o,s){o.super_=s,o.prototype=Object.create(s.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}})}:n.exports=function(o,s){o.super_=s;var l=function(){};l.prototype=s.prototype,o.prototype=new l,o.prototype.constructor=o}},{}],526:[function(e,n,a){n.exports=function(o){return o&&typeof o=="object"&&typeof o.copy=="function"&&typeof o.fill=="function"&&typeof o.readUInt8=="function"}},{}],527:[function(e,n,a){(function(o,s){(function(){var l=/%[sdj%]/g;a.format=function(w){if(!N(w)){for(var T=[],A=0;A<arguments.length;A++)T.push(u(arguments[A]));return T.join(" ")}A=1;for(var S=arguments,j=S.length,B=String(w).replace(l,function(X){if(X==="%%")return"%";if(A>=j)return X;switch(X){case"%s":return String(S[A++]);case"%d":return Number(S[A++]);case"%j":try{return JSON.stringify(S[A++])}catch{return"[Circular]"}default:return X}}),R=S[A];A<j;R=S[++A])y(R)||!H(R)?B+=" "+R:B+=" "+u(R);return B},a.deprecate=function(w,T){if(I(s.process))return function(){return a.deprecate(w,T).apply(this,arguments)};if(o.noDeprecation===!0)return w;var A=!1;return function(){if(!A){if(o.throwDeprecation)throw new Error(T);o.traceDeprecation?console.trace(T):console.error(T),A=!0}return w.apply(this,arguments)}};var c,i={};function u(w,T){var A={seen:[],stylize:f};return arguments.length>=3&&(A.depth=arguments[2]),arguments.length>=4&&(A.colors=arguments[3]),x(T)?A.showHidden=T:T&&a._extend(A,T),I(A.showHidden)&&(A.showHidden=!1),I(A.depth)&&(A.depth=2),I(A.colors)&&(A.colors=!1),I(A.customInspect)&&(A.customInspect=!0),A.colors&&(A.stylize=p),h(A,w,A.depth)}function p(w,T){var A=u.styles[T];return A?"\x1B["+u.colors[A][0]+"m"+w+"\x1B["+u.colors[A][1]+"m":w}function f(w,T){return w}function h(w,T,A){if(w.customInspect&&T&&K(T.inspect)&&T.inspect!==a.inspect&&(!T.constructor||T.constructor.prototype!==T)){var S=T.inspect(A,w);return N(S)||(S=h(w,S,A)),S}var j=function(P,F){if(I(F))return P.stylize("undefined","undefined");if(N(F)){var Z="'"+JSON.stringify(F).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return P.stylize(Z,"string")}if(E(F))return P.stylize(""+F,"number");if(x(F))return P.stylize(""+F,"boolean");if(y(F))return P.stylize("null","null")}(w,T);if(j)return j;var B=Object.keys(T),R=function(P){var F={};return P.forEach(function(Z,se){F[Z]=!0}),F}(B);if(w.showHidden&&(B=Object.getOwnPropertyNames(T)),q(T)&&(B.indexOf("message")>=0||B.indexOf("description")>=0))return v(T);if(B.length===0){if(K(T)){var X=T.name?": "+T.name:"";return w.stylize("[Function"+X+"]","special")}if(L(T))return w.stylize(RegExp.prototype.toString.call(T),"regexp");if(V(T))return w.stylize(Date.prototype.toString.call(T),"date");if(q(T))return v(T)}var Y,ee="",U=!1,Q=["{","}"];return g(T)&&(U=!0,Q=["[","]"]),K(T)&&(ee=" [Function"+(T.name?": "+T.name:"")+"]"),L(T)&&(ee=" "+RegExp.prototype.toString.call(T)),V(T)&&(ee=" "+Date.prototype.toUTCString.call(T)),q(T)&&(ee=" "+v(T)),B.length!==0||U&&T.length!=0?A<0?L(T)?w.stylize(RegExp.prototype.toString.call(T),"regexp"):w.stylize("[Object]","special"):(w.seen.push(T),Y=U?function(P,F,Z,se,re){for(var ae=[],te=0,he=F.length;te<he;++te)C(F,String(te))?ae.push(b(P,F,Z,se,String(te),!0)):ae.push("");return re.forEach(function(le){le.match(/^\d+$/)||ae.push(b(P,F,Z,se,le,!0))}),ae}(w,T,A,R,B):B.map(function(P){return b(w,T,A,R,P,U)}),w.seen.pop(),function(P,F,Z){return P.reduce(function(se,re){return re.indexOf(`
`)>=0,se+re.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?Z[0]+(F===""?"":F+`
 `)+" "+P.join(`,
  `)+" "+Z[1]:Z[0]+F+" "+P.join(", ")+" "+Z[1]}(Y,ee,Q)):Q[0]+ee+Q[1]}function v(w){return"["+Error.prototype.toString.call(w)+"]"}function b(w,T,A,S,j,B){var R,X,Y;if((Y=Object.getOwnPropertyDescriptor(T,j)||{value:T[j]}).get?X=Y.set?w.stylize("[Getter/Setter]","special"):w.stylize("[Getter]","special"):Y.set&&(X=w.stylize("[Setter]","special")),C(S,j)||(R="["+j+"]"),X||(w.seen.indexOf(Y.value)<0?(X=y(A)?h(w,Y.value,null):h(w,Y.value,A-1)).indexOf(`
`)>-1&&(X=B?X.split(`
`).map(function(ee){return"  "+ee}).join(`
`).substr(2):`
`+X.split(`
`).map(function(ee){return"   "+ee}).join(`
`)):X=w.stylize("[Circular]","special")),I(R)){if(B&&j.match(/^\d+$/))return X;(R=JSON.stringify(""+j)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(R=R.substr(1,R.length-2),R=w.stylize(R,"name")):(R=R.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),R=w.stylize(R,"string"))}return R+": "+X}function g(w){return Array.isArray(w)}function x(w){return typeof w=="boolean"}function y(w){return w===null}function E(w){return typeof w=="number"}function N(w){return typeof w=="string"}function I(w){return w===void 0}function L(w){return H(w)&&z(w)==="[object RegExp]"}function H(w){return typeof w=="object"&&w!==null}function V(w){return H(w)&&z(w)==="[object Date]"}function q(w){return H(w)&&(z(w)==="[object Error]"||w instanceof Error)}function K(w){return typeof w=="function"}function z(w){return Object.prototype.toString.call(w)}function W(w){return w<10?"0"+w.toString(10):w.toString(10)}a.debuglog=function(w){if(I(c)&&(c=o.env.NODE_DEBUG||""),w=w.toUpperCase(),!i[w])if(new RegExp("\\b"+w+"\\b","i").test(c)){var T=o.pid;i[w]=function(){var A=a.format.apply(a,arguments);console.error("%s %d: %s",w,T,A)}}else i[w]=function(){};return i[w]},a.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},a.isArray=g,a.isBoolean=x,a.isNull=y,a.isNullOrUndefined=function(w){return w==null},a.isNumber=E,a.isString=N,a.isSymbol=function(w){return typeof w=="symbol"},a.isUndefined=I,a.isRegExp=L,a.isObject=H,a.isDate=V,a.isError=q,a.isFunction=K,a.isPrimitive=function(w){return w===null||typeof w=="boolean"||typeof w=="number"||typeof w=="string"||typeof w=="symbol"||w===void 0},a.isBuffer=e("./support/isBuffer");var D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function M(){var w=new Date,T=[W(w.getHours()),W(w.getMinutes()),W(w.getSeconds())].join(":");return[w.getDate(),D[w.getMonth()],T].join(" ")}function C(w,T){return Object.prototype.hasOwnProperty.call(w,T)}a.log=function(){console.log("%s - %s",M(),a.format.apply(a,arguments))},a.inherits=e("inherits"),a._extend=function(w,T){if(!T||!H(T))return w;for(var A=Object.keys(T),S=A.length;S--;)w[A[S]]=T[A[S]];return w}}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":526,_process:467,inherits:525}],528:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"v1",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(a,"v3",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(a,"v4",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(a,"v5",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(a,"NIL",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(a,"version",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(a,"validate",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(a,"stringify",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(a,"parse",{enumerable:!0,get:function(){return h.default}});var o=v(e("./v1.js")),s=v(e("./v3.js")),l=v(e("./v4.js")),c=v(e("./v5.js")),i=v(e("./nil.js")),u=v(e("./version.js")),p=v(e("./validate.js")),f=v(e("./stringify.js")),h=v(e("./parse.js"));function v(b){return b&&b.__esModule?b:{default:b}}},{"./nil.js":530,"./parse.js":531,"./stringify.js":535,"./v1.js":536,"./v3.js":537,"./v4.js":539,"./v5.js":540,"./validate.js":541,"./version.js":542}],529:[function(e,n,a){function o(h){return 14+(h+64>>>9<<4)+1}function s(h,v){const b=(65535&h)+(65535&v);return(h>>16)+(v>>16)+(b>>16)<<16|65535&b}function l(h,v,b,g,x,y){return s((E=s(s(v,h),s(g,y)))<<(N=x)|E>>>32-N,b);var E,N}function c(h,v,b,g,x,y,E){return l(v&b|~v&g,h,v,x,y,E)}function i(h,v,b,g,x,y,E){return l(v&g|b&~g,h,v,x,y,E)}function u(h,v,b,g,x,y,E){return l(v^b^g,h,v,x,y,E)}function p(h,v,b,g,x,y,E){return l(b^(v|~g),h,v,x,y,E)}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var f=function(h){if(typeof h=="string"){const v=unescape(encodeURIComponent(h));h=new Uint8Array(v.length);for(let b=0;b<v.length;++b)h[b]=v.charCodeAt(b)}return function(v){const b=[],g=32*v.length;for(let x=0;x<g;x+=8){const y=v[x>>5]>>>x%32&255,E=parseInt("0123456789abcdef".charAt(y>>>4&15)+"0123456789abcdef".charAt(15&y),16);b.push(E)}return b}(function(v,b){v[b>>5]|=128<<b%32,v[o(b)-1]=b;let g=1732584193,x=-271733879,y=-1732584194,E=271733878;for(let N=0;N<v.length;N+=16){const I=g,L=x,H=y,V=E;g=c(g,x,y,E,v[N],7,-680876936),E=c(E,g,x,y,v[N+1],12,-389564586),y=c(y,E,g,x,v[N+2],17,606105819),x=c(x,y,E,g,v[N+3],22,-1044525330),g=c(g,x,y,E,v[N+4],7,-176418897),E=c(E,g,x,y,v[N+5],12,1200080426),y=c(y,E,g,x,v[N+6],17,-1473231341),x=c(x,y,E,g,v[N+7],22,-45705983),g=c(g,x,y,E,v[N+8],7,1770035416),E=c(E,g,x,y,v[N+9],12,-1958414417),y=c(y,E,g,x,v[N+10],17,-42063),x=c(x,y,E,g,v[N+11],22,-1990404162),g=c(g,x,y,E,v[N+12],7,1804603682),E=c(E,g,x,y,v[N+13],12,-40341101),y=c(y,E,g,x,v[N+14],17,-1502002290),x=c(x,y,E,g,v[N+15],22,1236535329),g=i(g,x,y,E,v[N+1],5,-165796510),E=i(E,g,x,y,v[N+6],9,-1069501632),y=i(y,E,g,x,v[N+11],14,643717713),x=i(x,y,E,g,v[N],20,-373897302),g=i(g,x,y,E,v[N+5],5,-701558691),E=i(E,g,x,y,v[N+10],9,38016083),y=i(y,E,g,x,v[N+15],14,-660478335),x=i(x,y,E,g,v[N+4],20,-405537848),g=i(g,x,y,E,v[N+9],5,568446438),E=i(E,g,x,y,v[N+14],9,-1019803690),y=i(y,E,g,x,v[N+3],14,-187363961),x=i(x,y,E,g,v[N+8],20,1163531501),g=i(g,x,y,E,v[N+13],5,-1444681467),E=i(E,g,x,y,v[N+2],9,-51403784),y=i(y,E,g,x,v[N+7],14,1735328473),x=i(x,y,E,g,v[N+12],20,-1926607734),g=u(g,x,y,E,v[N+5],4,-378558),E=u(E,g,x,y,v[N+8],11,-2022574463),y=u(y,E,g,x,v[N+11],16,1839030562),x=u(x,y,E,g,v[N+14],23,-35309556),g=u(g,x,y,E,v[N+1],4,-1530992060),E=u(E,g,x,y,v[N+4],11,1272893353),y=u(y,E,g,x,v[N+7],16,-155497632),x=u(x,y,E,g,v[N+10],23,-1094730640),g=u(g,x,y,E,v[N+13],4,681279174),E=u(E,g,x,y,v[N],11,-358537222),y=u(y,E,g,x,v[N+3],16,-722521979),x=u(x,y,E,g,v[N+6],23,76029189),g=u(g,x,y,E,v[N+9],4,-640364487),E=u(E,g,x,y,v[N+12],11,-421815835),y=u(y,E,g,x,v[N+15],16,530742520),x=u(x,y,E,g,v[N+2],23,-995338651),g=p(g,x,y,E,v[N],6,-198630844),E=p(E,g,x,y,v[N+7],10,1126891415),y=p(y,E,g,x,v[N+14],15,-1416354905),x=p(x,y,E,g,v[N+5],21,-57434055),g=p(g,x,y,E,v[N+12],6,1700485571),E=p(E,g,x,y,v[N+3],10,-1894986606),y=p(y,E,g,x,v[N+10],15,-1051523),x=p(x,y,E,g,v[N+1],21,-2054922799),g=p(g,x,y,E,v[N+8],6,1873313359),E=p(E,g,x,y,v[N+15],10,-30611744),y=p(y,E,g,x,v[N+6],15,-1560198380),x=p(x,y,E,g,v[N+13],21,1309151649),g=p(g,x,y,E,v[N+4],6,-145523070),E=p(E,g,x,y,v[N+11],10,-1120210379),y=p(y,E,g,x,v[N+2],15,718787259),x=p(x,y,E,g,v[N+9],21,-343485551),g=s(g,I),x=s(x,L),y=s(y,H),E=s(E,V)}return[g,x,y,E]}(function(v){if(v.length===0)return[];const b=8*v.length,g=new Uint32Array(o(b));for(let x=0;x<b;x+=8)g[x>>5]|=(255&v[x/8])<<x%32;return g}(h),8*h.length))};a.default=f},{}],530:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,a.default="00000000-0000-0000-0000-000000000000"},{}],531:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o,s=(o=e("./validate.js"))&&o.__esModule?o:{default:o},l=function(c){if(!(0,s.default)(c))throw TypeError("Invalid UUID");let i;const u=new Uint8Array(16);return u[0]=(i=parseInt(c.slice(0,8),16))>>>24,u[1]=i>>>16&255,u[2]=i>>>8&255,u[3]=255&i,u[4]=(i=parseInt(c.slice(9,13),16))>>>8,u[5]=255&i,u[6]=(i=parseInt(c.slice(14,18),16))>>>8,u[7]=255&i,u[8]=(i=parseInt(c.slice(19,23),16))>>>8,u[9]=255&i,u[10]=(i=parseInt(c.slice(24,36),16))/1099511627776&255,u[11]=i/4294967296&255,u[12]=i>>>24&255,u[13]=i>>>16&255,u[14]=i>>>8&255,u[15]=255&i,u};a.default=l},{"./validate.js":541}],532:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,a.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],533:[function(e,n,a){let o;Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(){if(!o&&(o=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!o))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(s)};const s=new Uint8Array(16)},{}],534:[function(e,n,a){function o(c,i,u,p){switch(c){case 0:return i&u^~i&p;case 1:return i^u^p;case 2:return i&u^i&p^u&p;case 3:return i^u^p}}function s(c,i){return c<<i|c>>>32-i}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=function(c){const i=[1518500249,1859775393,2400959708,3395469782],u=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof c=="string"){const v=unescape(encodeURIComponent(c));c=[];for(let b=0;b<v.length;++b)c.push(v.charCodeAt(b))}else Array.isArray(c)||(c=Array.prototype.slice.call(c));c.push(128);const p=c.length/4+2,f=Math.ceil(p/16),h=new Array(f);for(let v=0;v<f;++v){const b=new Uint32Array(16);for(let g=0;g<16;++g)b[g]=c[64*v+4*g]<<24|c[64*v+4*g+1]<<16|c[64*v+4*g+2]<<8|c[64*v+4*g+3];h[v]=b}h[f-1][14]=8*(c.length-1)/Math.pow(2,32),h[f-1][14]=Math.floor(h[f-1][14]),h[f-1][15]=8*(c.length-1)&4294967295;for(let v=0;v<f;++v){const b=new Uint32Array(80);for(let I=0;I<16;++I)b[I]=h[v][I];for(let I=16;I<80;++I)b[I]=s(b[I-3]^b[I-8]^b[I-14]^b[I-16],1);let g=u[0],x=u[1],y=u[2],E=u[3],N=u[4];for(let I=0;I<80;++I){const L=Math.floor(I/20),H=s(g,5)+o(L,x,y,E)+N+i[L]+b[I]>>>0;N=E,E=y,y=s(x,30)>>>0,x=g,g=H}u[0]=u[0]+g>>>0,u[1]=u[1]+x>>>0,u[2]=u[2]+y>>>0,u[3]=u[3]+E>>>0,u[4]=u[4]+N>>>0}return[u[0]>>24&255,u[0]>>16&255,u[0]>>8&255,255&u[0],u[1]>>24&255,u[1]>>16&255,u[1]>>8&255,255&u[1],u[2]>>24&255,u[2]>>16&255,u[2]>>8&255,255&u[2],u[3]>>24&255,u[3]>>16&255,u[3]>>8&255,255&u[3],u[4]>>24&255,u[4]>>16&255,u[4]>>8&255,255&u[4]]};a.default=l},{}],535:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o,s=(o=e("./validate.js"))&&o.__esModule?o:{default:o};const l=[];for(let i=0;i<256;++i)l.push((i+256).toString(16).substr(1));var c=function(i){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const p=(l[i[u+0]]+l[i[u+1]]+l[i[u+2]]+l[i[u+3]]+"-"+l[i[u+4]]+l[i[u+5]]+"-"+l[i[u+6]]+l[i[u+7]]+"-"+l[i[u+8]]+l[i[u+9]]+"-"+l[i[u+10]]+l[i[u+11]]+l[i[u+12]]+l[i[u+13]]+l[i[u+14]]+l[i[u+15]]).toLowerCase();if(!(0,s.default)(p))throw TypeError("Stringified UUID is invalid");return p};a.default=c},{"./validate.js":541}],536:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=l(e("./rng.js")),s=l(e("./stringify.js"));function l(h){return h&&h.__esModule?h:{default:h}}let c,i,u=0,p=0;var f=function(h,v,b){let g=v&&b||0;const x=v||new Array(16);let y=(h=h||{}).node||c,E=h.clockseq!==void 0?h.clockseq:i;if(y==null||E==null){const q=h.random||(h.rng||o.default)();y==null&&(y=c=[1|q[0],q[1],q[2],q[3],q[4],q[5]]),E==null&&(E=i=16383&(q[6]<<8|q[7]))}let N=h.msecs!==void 0?h.msecs:Date.now(),I=h.nsecs!==void 0?h.nsecs:p+1;const L=N-u+(I-p)/1e4;if(L<0&&h.clockseq===void 0&&(E=E+1&16383),(L<0||N>u)&&h.nsecs===void 0&&(I=0),I>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=N,p=I,i=E,N+=122192928e5;const H=(1e4*(268435455&N)+I)%4294967296;x[g++]=H>>>24&255,x[g++]=H>>>16&255,x[g++]=H>>>8&255,x[g++]=255&H;const V=N/4294967296*1e4&268435455;x[g++]=V>>>8&255,x[g++]=255&V,x[g++]=V>>>24&15|16,x[g++]=V>>>16&255,x[g++]=E>>>8|128,x[g++]=255&E;for(let q=0;q<6;++q)x[g+q]=y[q];return v||(0,s.default)(x)};a.default=f},{"./rng.js":533,"./stringify.js":535}],537:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=l(e("./v35.js")),s=l(e("./md5.js"));function l(i){return i&&i.__esModule?i:{default:i}}var c=(0,o.default)("v3",48,s.default);a.default=c},{"./md5.js":529,"./v35.js":538}],538:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(u,p,f){function h(v,b,g,x){if(typeof v=="string"&&(v=function(E){E=unescape(encodeURIComponent(E));const N=[];for(let I=0;I<E.length;++I)N.push(E.charCodeAt(I));return N}(v)),typeof b=="string"&&(b=(0,s.default)(b)),b.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let y=new Uint8Array(16+v.length);if(y.set(b),y.set(v,b.length),y=f(y),y[6]=15&y[6]|p,y[8]=63&y[8]|128,g){x=x||0;for(let E=0;E<16;++E)g[x+E]=y[E];return g}return(0,o.default)(y)}try{h.name=u}catch{}return h.DNS=c,h.URL=i,h},a.URL=a.DNS=void 0;var o=l(e("./stringify.js")),s=l(e("./parse.js"));function l(u){return u&&u.__esModule?u:{default:u}}const c="6ba7b810-9dad-11d1-80b4-00c04fd430c8";a.DNS=c;const i="6ba7b811-9dad-11d1-80b4-00c04fd430c8";a.URL=i},{"./parse.js":531,"./stringify.js":535}],539:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=l(e("./rng.js")),s=l(e("./stringify.js"));function l(i){return i&&i.__esModule?i:{default:i}}var c=function(i,u,p){const f=(i=i||{}).random||(i.rng||o.default)();if(f[6]=15&f[6]|64,f[8]=63&f[8]|128,u){p=p||0;for(let h=0;h<16;++h)u[p+h]=f[h];return u}return(0,s.default)(f)};a.default=c},{"./rng.js":533,"./stringify.js":535}],540:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=l(e("./v35.js")),s=l(e("./sha1.js"));function l(i){return i&&i.__esModule?i:{default:i}}var c=(0,o.default)("v5",80,s.default);a.default=c},{"./sha1.js":534,"./v35.js":538}],541:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o,s=(o=e("./regex.js"))&&o.__esModule?o:{default:o},l=function(c){return typeof c=="string"&&s.default.test(c)};a.default=l},{"./regex.js":532}],542:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o,s=(o=e("./validate.js"))&&o.__esModule?o:{default:o},l=function(c){if(!(0,s.default)(c))throw TypeError("Invalid UUID");return parseInt(c.substr(14,1),16)};a.default=l},{"./validate.js":541}],543:[function(e,n,a){/**
* Character classes and associated utilities for the 5th edition of XML 1.0.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(a,"__esModule",{value:!0}),a.CHAR=`	
\r ---`,a.S=` 	\r
`,a.NAME_START_CHAR=":A-Z_a-z-----------",a.NAME_CHAR="-"+a.NAME_START_CHAR+".0-9--",a.CHAR_RE=new RegExp("^["+a.CHAR+"]$","u"),a.S_RE=new RegExp("^["+a.S+"]+$","u"),a.NAME_START_CHAR_RE=new RegExp("^["+a.NAME_START_CHAR+"]$","u"),a.NAME_CHAR_RE=new RegExp("^["+a.NAME_CHAR+"]$","u"),a.NAME_RE=new RegExp("^["+a.NAME_START_CHAR+"]["+a.NAME_CHAR+"]*$","u"),a.NMTOKEN_RE=new RegExp("^["+a.NAME_CHAR+"]+$","u");function o(s){return s>=65&&s<=90||s>=97&&s<=122||s===58||s===95||s===8204||s===8205||s>=192&&s<=214||s>=216&&s<=246||s>=248&&s<=767||s>=880&&s<=893||s>=895&&s<=8191||s>=8304&&s<=8591||s>=11264&&s<=12271||s>=12289&&s<=55295||s>=63744&&s<=64975||s>=65008&&s<=65533||s>=65536&&s<=983039}a.S_LIST=[32,10,13,9],a.isChar=function(s){return s>=32&&s<=55295||s===10||s===13||s===9||s>=57344&&s<=65533||s>=65536&&s<=1114111},a.isS=function(s){return s===32||s===10||s===13||s===9},a.isNameStartChar=o,a.isNameChar=function(s){return o(s)||s>=48&&s<=57||s===45||s===46||s===183||s>=768&&s<=879||s>=8255&&s<=8256}},{}],544:[function(e,n,a){/**
* Character classes and associated utilities for the 2nd edition of XML 1.1.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(a,"__esModule",{value:!0}),a.CHAR="---",a.RESTRICTED_CHAR="-\b\v\f---",a.S=` 	\r
`,a.NAME_START_CHAR=":A-Z_a-z-----------",a.NAME_CHAR="-"+a.NAME_START_CHAR+".0-9--",a.CHAR_RE=new RegExp("^["+a.CHAR+"]$","u"),a.RESTRICTED_CHAR_RE=new RegExp("^["+a.RESTRICTED_CHAR+"]$","u"),a.S_RE=new RegExp("^["+a.S+"]+$","u"),a.NAME_START_CHAR_RE=new RegExp("^["+a.NAME_START_CHAR+"]$","u"),a.NAME_CHAR_RE=new RegExp("^["+a.NAME_CHAR+"]$","u"),a.NAME_RE=new RegExp("^["+a.NAME_START_CHAR+"]["+a.NAME_CHAR+"]*$","u"),a.NMTOKEN_RE=new RegExp("^["+a.NAME_CHAR+"]+$","u");function o(s){return s>=65&&s<=90||s>=97&&s<=122||s===58||s===95||s===8204||s===8205||s>=192&&s<=214||s>=216&&s<=246||s>=248&&s<=767||s>=880&&s<=893||s>=895&&s<=8191||s>=8304&&s<=8591||s>=11264&&s<=12271||s>=12289&&s<=55295||s>=63744&&s<=64975||s>=65008&&s<=65533||s>=65536&&s<=983039}a.S_LIST=[32,10,13,9],a.isChar=function(s){return s>=1&&s<=55295||s>=57344&&s<=65533||s>=65536&&s<=1114111},a.isRestrictedChar=function(s){return s>=1&&s<=8||s===11||s===12||s>=14&&s<=31||s>=127&&s<=132||s>=134&&s<=159},a.isCharAndNotRestricted=function(s){return s===9||s===10||s===13||s>31&&s<127||s===133||s>159&&s<=55295||s>=57344&&s<=65533||s>=65536&&s<=1114111},a.isS=function(s){return s===32||s===10||s===13||s===9},a.isNameStartChar=o,a.isNameChar=function(s){return o(s)||s>=48&&s<=57||s===45||s===46||s===183||s>=768&&s<=879||s>=8255&&s<=8256}},{}],545:[function(e,n,a){/**
* Character class utilities for XML NS 1.0 edition 3.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/function o(s){return s>=65&&s<=90||s===95||s>=97&&s<=122||s>=192&&s<=214||s>=216&&s<=246||s>=248&&s<=767||s>=880&&s<=893||s>=895&&s<=8191||s>=8204&&s<=8205||s>=8304&&s<=8591||s>=11264&&s<=12271||s>=12289&&s<=55295||s>=63744&&s<=64975||s>=65008&&s<=65533||s>=65536&&s<=983039}Object.defineProperty(a,"__esModule",{value:!0}),a.NC_NAME_START_CHAR="A-Z_a-z------------",a.NC_NAME_CHAR="-"+a.NC_NAME_START_CHAR+".0-9--",a.NC_NAME_START_CHAR_RE=new RegExp("^["+a.NC_NAME_START_CHAR+"]$","u"),a.NC_NAME_CHAR_RE=new RegExp("^["+a.NC_NAME_CHAR+"]$","u"),a.NC_NAME_RE=new RegExp("^["+a.NC_NAME_START_CHAR+"]["+a.NC_NAME_CHAR+"]*$","u"),a.isNCNameStartChar=o,a.isNCNameChar=function(s){return o(s)||s===45||s===46||s>=48&&s<=57||s===183||s>=768&&s<=879||s>=8255&&s<=8256}},{}]},{},[15])(15)})}(bp)),bp.exports}var ZN=KN();const JN=n8(ZN);function QN(t){let r=0;return t.forEach(e=>{(e.itens||[]).forEach(a=>{r+=Number(a.quantidade)||0})}),r}function eO({data:t,stats:r,filters:e}){const n=t.reduce((S,j)=>{const B=j.nome_cliente||"Desconhecido",R=Number(j.valor_total_nota)||0;return S[B]=(S[B]||0)+R,S},{}),a=Object.entries(n).map(([S,j])=>({name:S,value:j})).sort((S,j)=>j.value-S.value).slice(0,5),o=t.reduce((S,j)=>{const B=j.vendedor||"Desconhecido",R=Number(j.valor_total_nota)||0;return S[B]=(S[B]||0)+R,S},{}),s=Object.entries(o).map(([S,j])=>({name:S,value:j})).sort((S,j)=>j.value-S.value).slice(0,5),l=t.reduce((S,j)=>{const B=j.rede||"Sem rede",R=Number(j.valor_total_nota)||0;return S[B]=(S[B]||0)+R,S},{}),c=Object.entries(l).map(([S,j])=>({name:S,value:j})).sort((S,j)=>j.value-S.value).slice(0,5),i=t.reduce((S,j)=>{const B=j.cidade_origem||"N/A";return S[B]=(S[B]||0)+(Number(j.valor_total_nota)||0),S},{}),u=Object.entries(i).map(([S,j])=>({name:S,value:j})).sort((S,j)=>j.value-S.value).slice(0,6),p=t.reduce((S,j)=>{const B=j.motivo_nome||"No informado";return S[B]=(S[B]||0)+1,S},{}),f=Object.entries(p).map(([S,j])=>({name:S,value:j})).sort((S,j)=>j.value-S.value).slice(0,5),h={};t.forEach(S=>{(S.itens||[]).forEach(B=>{const Y=(B.descricao||"Desconhecido").split(" ").slice(0,2).join(" "),ee=Number(B.quantidade)||0;h[Y]=(h[Y]||0)+ee})});const v=Object.entries(h).map(([S,j])=>({name:S,quantidade:j})).sort((S,j)=>j.quantidade-S.quantidade).slice(0,10),b=t.reduce((S,j)=>{const B=j.nome_cliente||"Desconhecido";return S[B]=(S[B]||0)+1,S},{}),g=Object.entries(b).map(([S,j])=>({name:S,count:j})).sort((S,j)=>j.count-S.count).slice(0,5),x=t.filter(S=>S.resultado==="PENDENTE VALIDAO").length,y=t.filter(S=>S.resultado==="TRATATIVA DE ANULAO").length,E=t.filter(S=>S.resultado==="VALIDADA").length,N=y+E,I=N>0?(N/x*100).toFixed(1):"0",L=t.reduce((S,j)=>S+(Number(j.valor_total_nota)||0),0),H=t.length,V=H>0?L/H:0,q=QN(t),K=[];if(H>0&&K.push(` Total de ${H} devoluo(es) no perodo selecionado, totalizando R$ ${L.toLocaleString("pt-BR",{minimumFractionDigits:2})}.`),a.length>0&&L>0){const S=a[0].value/L*100;S>20&&K.push(` Cliente "${a[0].name}" concentra ${S.toFixed(1)}% do valor total de devolues.`)}s.length>0&&K.push(` Vendedor "${s[0].name}" lidera em devolues com R$ ${s[0].value.toLocaleString("pt-BR")}.`),v.length>0&&K.push(` Produto "${v[0].name}"  o mais devolvido com ${v[0].quantidade.toFixed(2)} unidades.`);const z=[];r.nfAtraso>0&&z.push(` ${r.nfAtraso} nota(s) fiscal(is) em atraso requerem ateno imediata`),r.nfPendentes>10&&z.push(` Alto volume de pendncias (${r.nfPendentes}) - considere revisar processos`),r.totalCancelamento>r.totalGeral*.1&&z.push(" Taxa de cancelamento acima de 10% - investigar causas"),z.length===0&&z.push(" Nenhum alerta crtico identificado");const W=t.filter(S=>S.resultado==="VALIDADA"),D=t.length>0?(W.length/t.length*100).toFixed(1):"0",M=t.length>0?(r.nfCancelamento/t.length*100).toFixed(1):"0",C=e.startDate&&e.endDate?`${Jt(e.startDate,"dd/MM/yyyy",{locale:jr})} a ${Jt(e.endDate,"dd/MM/yyyy",{locale:jr})}`:e.period||"Perodo no especificado",w=t.filter(S=>S.resultado==="PENDENTE VALIDAO"),T=t.filter(S=>S.resultado==="TRATATIVA DE ANULAO"),A=[];return t.filter(S=>S.resultado==="PENDENTE VALIDAO").forEach(S=>{S.itens&&S.itens.length>0&&S.itens.forEach(j=>{A.push({nf:S.numero||"-",vendedor:S.vendedor||"-",cliente:(S.nome_cliente||"-").substring(0,25),produto:(j.descricao||"-").substring(0,30),unidade:j.unidade||"-",quantidade:j.quantidade?j.quantidade.toString():"-",valor:`R$ ${(Number(j.valor_total_bruto)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`})})}),`
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Relatrio de Devolues - Grupo Doce Mel</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"><\/script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
      color-adjust: exact !important;
    }
    
    /* A4 Portrait: 210mm x 297mm */
    @page {
      size: A4 portrait;
      margin: 15mm;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      padding: 20px;
      color: #333;
      font-size: 11px;
      line-height: 1.4;
    }
    
    .container {
      max-width: 210mm; /* Largura A4 */
      margin: 0 auto;
      background: white;
      box-shadow: 0 10px 40px rgba(0,0,0,0.15);
      border-radius: 12px;
      overflow: hidden;
    }
    
    .no-print {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      gap: 10px;
    }
    
    .btn {
      background: linear-gradient(135deg, #073e29 0%, #0a4d33 100%);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 13px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(7,62,41,0.4);
      transition: all 0.3s ease;
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(7,62,41,0.5);
    }
    
    .header {
      background: linear-gradient(135deg, #073e29 0%, #0a4d33 100%);
      color: white;
      padding: 25px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      page-break-after: avoid;
      position: relative;
      overflow: hidden;
    }
    
    .header::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -10%;
      width: 300px;
      height: 300px;
      background: rgba(255,255,255,0.05);
      border-radius: 50%;
    }
    
    .header-left {
      display: flex;
      align-items: center;
      gap: 20px;
      z-index: 1;
    }
    
    .logo {
      width: 60px;
      height: 60px;
      background: white;
      border-radius: 12px;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }
    
    .logo img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
    
    .header-title h1 {
      font-size: 24px;
      margin-bottom: 6px;
      font-weight: 800;
      letter-spacing: -0.5px;
    }
    
    .header-title p {
      font-size: 13px;
      opacity: 0.9;
      font-weight: 500;
    }
    
    .header-right {
      text-align: right;
      font-size: 11px;
      z-index: 1;
    }
    
    .header-right div {
      margin-bottom: 6px;
      background: rgba(255,255,255,0.1);
      padding: 6px 12px;
      border-radius: 6px;
      backdrop-filter: blur(10px);
    }
    
    .content {
      padding: 25px 30px;
    }
    
    /* Stats Grid - 4 colunas */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      margin-bottom: 20px;
      page-break-after: avoid;
    }
    
    .stat-card {
      background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
      border: 2px solid #e9ecef;
      border-radius: 8px;
      padding: 10px 12px;
      text-align: center;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
    
    .stat-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      border-color: #073e29;
    }
    
    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #073e29 0%, #0a4d33 100%);
    }
    
    .stat-icon {
      font-size: 20px;
      margin-bottom: 4px;
    }
    
    .stat-title {
      font-size: 9px;
      color: #6c757d;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.3px;
      margin-bottom: 5px;
    }
    
    .stat-value {
      font-size: 20px;
      font-weight: 800;
      color: #073e29;
      margin-bottom: 3px;
      line-height: 1;
    }
    
    .stat-subvalue {
      font-size: 9px;
      color: #6c757d;
      font-weight: 600;
    }
    
    .section-title {
      font-size: 18px;
      font-weight: 800;
      color: #073e29;
      margin: 25px 0 15px 0;
      padding-bottom: 10px;
      border-bottom: 3px solid #073e29;
      page-break-after: avoid;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .section-title::before {
      content: '';
      width: 5px;
      height: 24px;
      background: linear-gradient(180deg, #073e29 0%, #0a4d33 100%);
      border-radius: 3px;
    }
    
    /* Charts Grid - 2 colunas para A4 */
    .charts-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-bottom: 25px;
      page-break-inside: avoid;
    }
    
    .chart-card {
      background: white;
      border: 2px solid #e9ecef;
      border-radius: 10px;
      padding: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      page-break-inside: avoid;
      transition: all 0.3s ease;
    }
    
    .chart-card:hover {
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      border-color: #073e29;
    }
    
    .chart-title {
      font-size: 11px;
      font-weight: 700;
      color: #073e29;
      margin-bottom: 10px;
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 0.3px;
    }
    
    .chart-container {
      position: relative;
      height: 180px; /* Altura fixa para consistncia */
    }
    
    .insights-box {
      background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
      border: 2px solid #073e29;
      border-radius: 10px;
      padding: 12px;
      margin-bottom: 15px;
      page-break-inside: avoid;
      box-shadow: 0 2px 6px rgba(7,62,41,0.1);
    }
    
    .insights-title {
      font-size: 14px;
      font-weight: 800;
      color: #073e29;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .insights-list {
      list-style: none;
    }
    
    .insights-list li {
      padding: 6px 10px;
      margin-bottom: 5px;
      border-left: 3px solid #073e29;
      background: white;
      border-radius: 5px;
      font-size: 10px;
      color: #374151;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }
    
    .data-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      margin-bottom: 30px;
      font-size: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      border-radius: 10px;
      overflow: hidden;
    }
    
    .data-table thead {
      background: linear-gradient(135deg, #073e29 0%, #0a4d33 100%);
      color: white;
    }
    
    .data-table th {
      padding: 10px 8px;
      text-align: left;
      font-weight: 700;
      font-size: 9px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .data-table td {
      padding: 8px;
      border-bottom: 1px solid #e9ecef;
      font-size: 10px;
    }
    
    .data-table tbody tr {
      page-break-inside: avoid;
      transition: background-color 0.2s ease;
    }
    
    .data-table tbody tr:hover {
      background-color: #f8f9fa;
    }
    
    .data-table tbody tr:last-child td {
      border-bottom: none;
    }
    
    .intelligence-section {
      background: linear-gradient(135deg, #fff7ed 0%, #fed7aa 100%);
      border: 2px solid #f97316;
      border-radius: 10px;
      padding: 12px;
      margin-bottom: 15px;
      page-break-inside: avoid;
      box-shadow: 0 2px 6px rgba(249,115,22,0.1);
    }
    
    .intelligence-title {
      font-size: 14px;
      font-weight: 800;
      color: #ea580c;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .intelligence-subsection {
      margin-bottom: 10px;
      background: white;
      padding: 10px;
      border-radius: 6px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.05);
    }
    
    .intelligence-subsection h4 {
      font-size: 11px;
      color: #ea580c;
      margin-bottom: 6px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .intelligence-subsection ul {
      list-style: none;
      padding-left: 0;
    }
    
    .intelligence-subsection li {
      padding: 5px 8px;
      font-size: 10px;
      color: #374151;
      border-left: 3px solid #f97316;
      margin-bottom: 4px;
      background: #fff7ed;
      border-radius: 4px;
    }
    
    .page-break {
      page-break-before: always;
    }
    
    .table-subtitle {
      color: #073e29;
      margin: 20px 0 12px 0;
      font-size: 14px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .table-subtitle::before {
      content: '';
      color: #073e29;
    }
    
    @media print {
      * {
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
        color-adjust: exact !important;
      }
      
      @page {
        size: A4 portrait;
        margin: 15mm;
      }
      
      .no-print {
        display: none !important;
      }
      
      body {
        padding: 0;
        background: white !important;
      }
      
      .container {
        box-shadow: none;
        border-radius: 0;
        max-width: 100%;
      }
      
      .chart-container {
        height: 200px;
      }
      
      .page-break {
        page-break-before: always;
      }
      
      .chart-card,
      .stat-card,
      .insights-box,
      .intelligence-section {
        page-break-inside: avoid;
      }
    }
    
    @media screen and (max-width: 768px) {
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .charts-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="no-print">
    <button class="btn" onclick="window.print()">
       Imprimir / Salvar PDF
    </button>
    <button class="btn" onclick="window.close()">
       Fechar
    </button>
  </div>

  <div class="container">
    <!-- Header -->
    <div class="header">
      <div class="header-left">
        <div class="logo">
          <img src="/logo.png" alt="Logo Doce Mel" onerror="this.onerror=null; this.style.display='none';">
        </div>
        <div class="header-title">
          <h1>Relatrio de Devolues</h1>
          <p>GRUPO DOCE MEL</p>
        </div>
      </div>
      <div class="header-right">
        <div><strong>Gerado em:</strong> ${Jt(new Date,"dd/MM/yyyy, HH:mm:ss",{locale:jr})}</div>
        <div><strong>Perodo:</strong> ${C}</div>
      </div>
    </div>

    <div class="content">
      <!-- Stats Cards - 4 colunas, 2 linhas -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon"></div>
          <div class="stat-title">NF Pendentes</div>
          <div class="stat-value">${r.nfPendentes}</div>
          <div class="stat-subvalue">R$ ${r.totalPendente.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon"></div>
          <div class="stat-title">NF Cancelamento</div>
          <div class="stat-value">${r.nfCancelamento}</div>
          <div class="stat-subvalue">R$ ${r.totalCancelamento.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon"></div>
          <div class="stat-title">NF em Atraso</div>
          <div class="stat-value">${r.nfAtraso}</div>
          <div class="stat-subvalue">R$ ${r.totalAtraso.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon"></div>
          <div class="stat-title">NF Validadas</div>
          <div class="stat-value">${r.nfValidadas}</div>
          <div class="stat-subvalue">R$ ${r.totalValidadas.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon"></div>
          <div class="stat-title">Total Geral</div>
          <div class="stat-value">${t.length}</div>
          <div class="stat-subvalue">R$ ${r.totalGeral.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon"></div>
          <div class="stat-title">% Pendente</div>
          <div class="stat-value">${I}%</div>
          <div class="stat-subvalue">Pendentes / Processados</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon"></div>
          <div class="stat-title">Ticket Mdio</div>
          <div class="stat-value">R$ ${V.toLocaleString("pt-BR",{minimumFractionDigits:0,maximumFractionDigits:0})}</div>
          <div class="stat-subvalue">Por devoluo</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon"></div>
          <div class="stat-title">Produtos Devolvidos</div>
          <div class="stat-value">${q}</div>
          <div class="stat-subvalue">Quantidade total</div>
        </div>
      </div>

      <!-- Inteligncia e Anlises -->
      <div class="intelligence-section">
        <div class="intelligence-title"> Inteligncia e Anlises</div>
        
        <div class="intelligence-subsection">
          <h4> Clientes com Maior Recorrncia:</h4>
          <ul>
            ${g.map((S,j)=>`
              <li><strong>${j+1}.</strong> ${S.name}: ${S.count} devoluo(es)</li>
            `).join("")}
          </ul>
        </div>
        
        <div class="intelligence-subsection">
          <h4> Alertas e Recomendaes:</h4>
          <ul>
            ${z.map(S=>`<li>${S}</li>`).join("")}
          </ul>
        </div>
        
        <div class="intelligence-subsection">
          <h4> Tendncias:</h4>
          <ul>
            <li>Taxa de Validao: <strong>${D}%</strong></li>
            <li>Taxa de Cancelamento: <strong>${M}%</strong></li>
            <li>Total Processado: <strong>${t.length} nota(s) fiscal(is)</strong></li>
          </ul>
        </div>
      </div>

      <!-- Insights -->
      <div class="insights-box">
        <div class="insights-title"> Insights Automticos</div>
        <ul class="insights-list">
          ${K.map(S=>`<li>${S}</li>`).join("")}
        </ul>
      </div>

      <!-- Grficos - 2 por linha em formato A4 -->
      <h2 class="section-title"> Anlises Grficas</h2>

      <div class="charts-grid">
        <div class="chart-card">
          <div class="chart-title">Top 5 Clientes (Valor)</div>
          <div class="chart-container">
            <canvas id="chartClientes"></canvas>
          </div>
        </div>

        <div class="chart-card">
          <div class="chart-title">Top 5 Vendedores (Valor)</div>
          <div class="chart-container">
            <canvas id="chartVendedores"></canvas>
          </div>
        </div>

        <div class="chart-card">
          <div class="chart-title">Top 5 Redes (Valor)</div>
          <div class="chart-container">
            <canvas id="chartRedes"></canvas>
          </div>
        </div>

        <div class="chart-card">
          <div class="chart-title">Distribuio por Municpio</div>
          <div class="chart-container">
            <canvas id="chartMunicipios"></canvas>
          </div>
        </div>

        <div class="chart-card">
          <div class="chart-title">Principais Motivos</div>
          <div class="chart-container">
            <canvas id="chartMotivos"></canvas>
          </div>
        </div>

        <div class="chart-card">
          <div class="chart-title">Produtos Crticos (Top 10)</div>
          <div class="chart-container">
            <canvas id="chartProdutos"></canvas>
          </div>
        </div>
      </div>
    </div>

    <!-- PGINA 2: Tabelas Detalhadas -->
    <div class="content page-break">
      <h2 class="section-title"> Dados Detalhados</h2>
      
      ${T.length>0?`
        <h3 class="table-subtitle">Notas em Tratativa de Anulao (${T.length})</h3>
        <table class="data-table">
          <thead>
            <tr>
              <th>Data Emisso</th>
              <th>NF</th>
              <th>Cliente</th>
              <th>Vendedor</th>
              <th>Valor</th>
              <th>Dias</th>
              <th>Prazo</th>
            </tr>
          </thead>
          <tbody>
            ${T.slice(0,50).map(S=>`
              <tr>
                <td>${S.data_emissao?Jt(new Date(S.data_emissao),"dd/MM/yyyy",{locale:jr}):"-"}</td>
                <td><strong>${S.numero||"-"}</strong></td>
                <td>${(S.nome_cliente||"-").substring(0,30)}</td>
                <td>${S.vendedor||"-"}</td>
                <td><strong>R$ ${(Number(S.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}</strong></td>
                <td>${S.dias!==null&&S.dias!==void 0?S.dias:"-"}</td>
                <td>${S.prazo||"-"}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>
      `:""}

      ${w.length>0?`
        <h3 class="table-subtitle">Notas Pendentes (${w.length})</h3>
        <table class="data-table">
          <thead>
            <tr>
              <th>Data Emisso</th>
              <th>NF</th>
              <th>Cliente</th>
              <th>Vendedor</th>
              <th>Valor</th>
              <th>Dias</th>
              <th>Prazo</th>
            </tr>
          </thead>
          <tbody>
            ${w.slice(0,50).map(S=>`
              <tr>
                <td>${S.data_emissao?Jt(new Date(S.data_emissao),"dd/MM/yyyy",{locale:jr}):"-"}</td>
                <td><strong>${S.numero||"-"}</strong></td>
                <td>${(S.nome_cliente||"-").substring(0,30)}</td>
                <td>${S.vendedor||"-"}</td>
                <td><strong>R$ ${(Number(S.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}</strong></td>
                <td>${S.dias!==null&&S.dias!==void 0?S.dias:"-"}</td>
                <td>${S.prazo||"-"}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>
      `:""}

      ${W.length>0?`
        <h3 class="table-subtitle">Notas Validadas (${W.length})</h3>
        <table class="data-table">
          <thead>
            <tr>
              <th>Data Emisso</th>
              <th>NF</th>
              <th>Cliente</th>
              <th>Vendedor</th>
              <th>Motivo</th>
              <th>Valor</th>
            </tr>
          </thead>
          <tbody>
            ${W.slice(0,50).map(S=>`
              <tr>
                <td>${S.data_emissao?Jt(new Date(S.data_emissao),"dd/MM/yyyy",{locale:jr}):"-"}</td>
                <td><strong>${S.numero||"-"}</strong></td>
                <td>${(S.nome_cliente||"-").substring(0,30)}</td>
                <td>${S.vendedor||"-"}</td>
                <td>${S.motivo_nome||"-"}</td>
                <td><strong>R$ ${(Number(S.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}</strong></td>
              </tr>
            `).join("")}
          </tbody>
        </table>
      `:""}

      ${A.length>0?`
        <h3 class="table-subtitle">Lista Completa com Produtos (${A.length})</h3>
        <table class="data-table">
          <thead>
            <tr>
              <th>NF</th>
              <th>Vendedor</th>
              <th>Cliente</th>
              <th>Produto</th>
              <th>Unidade</th>
              <th>Quantidade</th>
              <th>Valor</th>
            </tr>
          </thead>
          <tbody>
            ${A.slice(0,100).map(S=>`
              <tr>
                <td><strong>${S.nf}</strong></td>
                <td>${S.vendedor}</td>
                <td>${S.cliente}</td>
                <td>${S.produto}</td>
                <td>${S.unidade}</td>
                <td>${S.quantidade}</td>
                <td><strong>${S.valor}</strong></td>
              </tr>
            `).join("")}
          </tbody>
        </table>
      `:""}
    </div>
  </div>

  <script>
    // Configurao padro dos grficos
    Chart.defaults.font.family = "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";
    Chart.defaults.font.size = 10;
    Chart.defaults.color = '#374151';

    const chartColors = {
      primary: '#073e29',
      secondary: '#0a4d33',
      accent: '#16a34a',
      gradient: ['#073e29', '#0a4d33', '#0d5d3f', '#10704b', '#138357']
    };

    // Grfico de Clientes
    new Chart(document.getElementById('chartClientes'), {
      type: 'bar',
      data: {
        labels: ${JSON.stringify(a.map(S=>S.name.substring(0,12)))},
        datasets: [{
          label: 'Valor (R$)',
          data: ${JSON.stringify(a.map(S=>S.value))},
          backgroundColor: chartColors.gradient,
          borderColor: chartColors.primary,
          borderWidth: 2,
          borderRadius: 6
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: false
          },
          tooltip: {
            backgroundColor: 'rgba(7, 62, 41, 0.9)',
            padding: 10,
            titleFont: { size: 12, weight: 'bold' },
            bodyFont: { size: 11 },
            callbacks: {
              label: function(context) {
                return 'R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 });
              }
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            grid: {
              color: 'rgba(0, 0, 0, 0.05)'
            },
            ticks: {
              font: { size: 9 },
              callback: function(value) {
                return 'R$ ' + value.toLocaleString('pt-BR', { maximumFractionDigits: 0 });
              }
            }
          },
          x: {
            grid: {
              display: false
            },
            ticks: {
              font: { size: 9 }
            }
          }
        }
      }
    });

    // Grfico de Vendedores
    new Chart(document.getElementById('chartVendedores'), {
      type: 'bar',
      data: {
        labels: ${JSON.stringify(s.map(S=>S.name.substring(0,12)))},
        datasets: [{
          label: 'Valor (R$)',
          data: ${JSON.stringify(s.map(S=>S.value))},
          backgroundColor: chartColors.gradient,
          borderColor: chartColors.primary,
          borderWidth: 2,
          borderRadius: 6
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: false
          },
          tooltip: {
            backgroundColor: 'rgba(7, 62, 41, 0.9)',
            padding: 10,
            titleFont: { size: 12, weight: 'bold' },
            bodyFont: { size: 11 },
            callbacks: {
              label: function(context) {
                return 'R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 });
              }
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            grid: {
              color: 'rgba(0, 0, 0, 0.05)'
            },
            ticks: {
              font: { size: 9 },
              callback: function(value) {
                return 'R$ ' + value.toLocaleString('pt-BR', { maximumFractionDigits: 0 });
              }
            }
          },
          x: {
            grid: {
              display: false
            },
            ticks: {
              font: { size: 9 }
            }
          }
        }
      }
    });

    // Grfico de Redes
    new Chart(document.getElementById('chartRedes'), {
      type: 'doughnut',
      data: {
        labels: ${JSON.stringify(c.map(S=>S.name))},
        datasets: [{
          data: ${JSON.stringify(c.map(S=>S.value))},
          backgroundColor: chartColors.gradient,
          borderColor: 'white',
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'bottom',
            labels: {
              padding: 10,
              font: {
                size: 9,
                weight: 'bold'
              }
            }
          },
          tooltip: {
            backgroundColor: 'rgba(7, 62, 41, 0.9)',
            padding: 10,
            titleFont: { size: 12, weight: 'bold' },
            bodyFont: { size: 11 },
            callbacks: {
              label: function(context) {
                return context.label + ': R$ ' + context.parsed.toLocaleString('pt-BR', { minimumFractionDigits: 2 });
              }
            }
          }
        }
      }
    });

    // Grfico de Municpios
    new Chart(document.getElementById('chartMunicipios'), {
      type: 'bar',
      data: {
        labels: ${JSON.stringify(u.map(S=>S.name.substring(0,12)))},
        datasets: [{
          label: 'Valor (R$)',
          data: ${JSON.stringify(u.map(S=>S.value))},
          backgroundColor: chartColors.gradient,
          borderColor: chartColors.primary,
          borderWidth: 2,
          borderRadius: 6
        }]
      },
      options: {
        indexAxis: 'y',
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: false
          },
          tooltip: {
            backgroundColor: 'rgba(7, 62, 41, 0.9)',
            padding: 10,
            titleFont: { size: 12, weight: 'bold' },
            bodyFont: { size: 11 },
            callbacks: {
              label: function(context) {
                return 'R$ ' + context.parsed.x.toLocaleString('pt-BR', { minimumFractionDigits: 2 });
              }
            }
          }
        },
        scales: {
          x: {
            beginAtZero: true,
            grid: {
              color: 'rgba(0, 0, 0, 0.05)'
            },
            ticks: {
              font: { size: 9 },
              callback: function(value) {
                return 'R$ ' + value.toLocaleString('pt-BR', { maximumFractionDigits: 0 });
              }
            }
          },
          y: {
            grid: {
              display: false
            },
            ticks: {
              font: { size: 9 }
            }
          }
        }
      }
    });

    // Grfico de Motivos
    new Chart(document.getElementById('chartMotivos'), {
      type: 'pie',
      data: {
        labels: ${JSON.stringify(f.map(S=>S.name))},
        datasets: [{
          data: ${JSON.stringify(f.map(S=>S.value))},
          backgroundColor: chartColors.gradient,
          borderColor: 'white',
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'bottom',
            labels: {
              padding: 10,
              font: {
                size: 9,
                weight: 'bold'
              }
            }
          },
          tooltip: {
            backgroundColor: 'rgba(7, 62, 41, 0.9)',
            padding: 10,
            titleFont: { size: 12, weight: 'bold' },
            bodyFont: { size: 11 },
            callbacks: {
              label: function(context) {
                return context.label + ': ' + context.parsed + ' ocorrncias';
              }
            }
          }
        }
      }
    });

    // Grfico de Produtos
    new Chart(document.getElementById('chartProdutos'), {
      type: 'bar',
      data: {
        labels: ${JSON.stringify(v.slice(0,10).map(S=>S.name.substring(0,12)))},
        datasets: [{
          label: 'Quantidade',
          data: ${JSON.stringify(v.slice(0,10).map(S=>S.quantidade))},
          backgroundColor: chartColors.gradient,
          borderColor: chartColors.primary,
          borderWidth: 2,
          borderRadius: 6
        }]
      },
      options: {
        indexAxis: 'y',
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: false
          },
          tooltip: {
            backgroundColor: 'rgba(7, 62, 41, 0.9)',
            padding: 10,
            titleFont: { size: 12, weight: 'bold' },
            bodyFont: { size: 11 },
            callbacks: {
              label: function(context) {
                return context.parsed.x.toFixed(2) + ' unidades';
              }
            }
          }
        },
        scales: {
          x: {
            beginAtZero: true,
            grid: {
              color: 'rgba(0, 0, 0, 0.05)'
            },
            ticks: {
              font: { size: 9 },
              callback: function(value) {
                return value.toFixed(0);
              }
            }
          },
          y: {
            grid: {
              display: false
            },
            ticks: {
              font: { size: 9 }
            }
          }
        }
      }
    });
  <\/script>
</body>
</html>
  `}const zi={"PENDENTE VALIDAO":1,VALIDADA:2,LANADA:3,"TRATATIVA DE ANULAO":4,"ANULADA/CANCELADA":5};function tO(){const{filters:t}=ec(),{user:r}=Dn(),[e,n]=ye.useState([]),[a,o]=ye.useState([]),[s,l]=ye.useState([]),[c,i]=ye.useState(!0),[u,p]=ye.useState(1),[f,h]=ye.useState(null),[v,b]=ye.useState(null),[g,x]=ye.useState(null),[y,E]=ye.useState({valorTotalLancado:0,notasLancadas:0,valorTotalAnulado:0,notasAnuladas:0,momPercent:0,yoyPercent:0}),N=100;ye.useEffect(()=>{I(),b(null),x(null),p(1)},[t]);const I=async()=>{i(!0);const z=(r==null?void 0:r.role)==="VENDEDOR"?r.vendedor:null;let W=Tt.from("devolucoes").select(`
        *,
        itens:itens_devolucao(*, motivo_item:motivos_devolucao(id, nome)),
        setores(nome),
        motivos_devolucao(nome, setores:setores(nome))
      `);r&&r.role==="VENDEDOR"&&z&&(W=W.eq("vendedor",z),console.log(" Reports - Filtrando por vendedor:",z));const D=t.period&&!t.startDate&&!t.endDate?Kf(t.period):{},M=t.startDate||D.startDate,C=t.endDate||D.endDate;t.search&&(W=W.or(`nome_cliente.ilike.%${t.search}%,vendedor.ilike.%${t.search}%,numero.ilike.%${t.search}%`)),t.resultado&&t.resultado.length>0&&(W=W.in("resultado",t.resultado)),t.motivo&&t.motivo.length>0&&(W=W.in("motivo_id",t.motivo)),t.cliente&&t.cliente.length>0&&(W=W.in("nome_cliente",t.cliente)),t.vendedor&&t.vendedor.length>0&&(W=W.in("vendedor",t.vendedor));let w=[];if(t.setor&&t.setor.length>0){const{data:j}=await Tt.from("motivos_devolucao").select("id").in("sector_id",t.setor);w=(j==null?void 0:j.map(B=>B.id))||[],W=W.in("setor_id",t.setor)}const T=w;if(M){const j=new Date(M);j.setHours(0,0,0,0);const B=new Date(j.getTime()-3*60*60*1e3);W=W.gte("data_emissao",B.toISOString().split("T")[0])}if(C){const j=new Date(C);j.setHours(23,59,59,999);const B=new Date(j.getTime()-3*60*60*1e3);W=W.lte("data_emissao",B.toISOString().split("T")[0])}const{data:A,error:S}=await W;if(S)console.error(S),St.error("Erro ao carregar dados do relatrio");else if(A){let j=A;t.setor&&t.setor.length>0&&T.length>0&&(j=A.filter(ae=>{const te=ae.setor_id&&t.setor.includes(ae.setor_id),he=ae.motivo_id&&T.includes(ae.motivo_id);return te||he}));const B=j.map(ae=>ae.cnpj_destinatario).filter(ae=>ae&&ae.trim()!=="");let R=new Map;if(B.length>0){const{data:ae}=await Tt.from("clientes").select("cnpj_cpf, nome, vendedor, rede, uf, municipio").in("cnpj_cpf",B);ae&&ae.forEach(te=>{R.set(te.cnpj_cpf,te)})}const X=j.map(ae=>{var he,le,ne;const te=R.get(ae.cnpj_destinatario);return{...ae,setor_nome:typeof ae.setores=="object"&&((he=ae.setores)!=null&&he.nome)?ae.setores.nome:typeof ae.setores=="string"?ae.setores:"-",motivo_nome:typeof ae.motivos_devolucao=="object"&&((le=ae.motivos_devolucao)!=null&&le.nome)?ae.motivos_devolucao.nome:typeof ae.motivos_devolucao=="string"?ae.motivos_devolucao:"-",itens_count:((ne=ae.itens)==null?void 0:ne.length)||0,nome_cliente:(te==null?void 0:te.nome)||ae.nome_cliente||"Cliente no encontrado",vendedor:(te==null?void 0:te.vendedor)||ae.vendedor||"-",rede:(te==null?void 0:te.rede)||ae.rede||"-",uf_destino:(te==null?void 0:te.uf)||ae.uf_destino||"-",cidade_destino:(te==null?void 0:te.municipio)||ae.cidade_destino||"-",prazo:ae.prazo||(ae.resultado==="LANADA"||ae.resultado==="ANULADA/CANCELADA"?"FINALIZADO":ae.prazo),nome_validador:ae.nome_validador||"-",finalizada_por:ae.finalizada_por||"-",justificativa:ae.justificativa||""}}),Y=X.sort((ae,te)=>{const he=zi[ae.resultado]||999,le=zi[te.resultado]||999;if(he!==le)return he-le;const ne=ae.data_emissao?new Date(ae.data_emissao).getTime():0;return(te.data_emissao?new Date(te.data_emissao).getTime():0)-ne});o(Y);const U=X.filter(ae=>ae.resultado==="LANADA"||ae.resultado==="ANULADA/CANCELADA").sort((ae,te)=>{const he=zi[ae.resultado]||999,le=zi[te.resultado]||999;if(he!==le)return he-le;const ne=ae.data_emissao?new Date(ae.data_emissao).getTime():0;return(te.data_emissao?new Date(te.data_emissao).getTime():0)-ne});l(U);const Q=Y.filter(ae=>ae.resultado==="LANADA"),P=Y.filter(ae=>ae.resultado==="ANULADA/CANCELADA"),F=Q.reduce((ae,te)=>ae+(Number(te.valor_total_nota)||0),0),Z=P.reduce((ae,te)=>ae+(Number(te.valor_total_nota)||0),0);let se=0,re=0;if(M&&C){const ae=Math.ceil((C.getTime()-M.getTime())/864e5),te=new Date(M);te.setMonth(te.getMonth()-1);const he=new Date(te);he.setDate(he.getDate()+ae);const{data:le}=await Tt.from("devolucoes").select("valor_total_nota, resultado").gte("data_emissao",te.toISOString().split("T")[0]).lte("data_emissao",he.toISOString().split("T")[0]).eq("resultado","LANADA"),ne=(le==null?void 0:le.reduce((Ce,Re)=>Ce+(Number(Re.valor_total_nota)||0),0))||0;se=ne>0?(F-ne)/ne*100:0;const de=new Date(M);de.setFullYear(de.getFullYear()-1);const fe=new Date(C);fe.setFullYear(fe.getFullYear()-1);const{data:Se}=await Tt.from("devolucoes").select("valor_total_nota, resultado").gte("data_emissao",de.toISOString().split("T")[0]).lte("data_emissao",fe.toISOString().split("T")[0]).eq("resultado","LANADA"),_e=(Se==null?void 0:Se.reduce((Ce,Re)=>Ce+(Number(Re.valor_total_nota)||0),0))||0;re=_e>0?(F-_e)/_e*100:0}E({valorTotalLancado:F,notasLancadas:Q.length,valorTotalAnulado:Z,notasAnuladas:P.length,momPercent:se,yoyPercent:re})}i(!1)},L=()=>{try{const z=new h8("p","mm","a4"),W=z.internal.pageSize.getWidth(),D=z.internal.pageSize.getHeight();let M=20;const C=[7,62,41],w=[10,80,55],T=[7,62,41],A=[251,191,36],S=[239,68,68],j=[220,252,231],B=[7,62,41],R={nfPendentes:a.filter(we=>we.resultado==="PENDENTE VALIDAO").length,totalPendente:a.filter(we=>we.resultado==="PENDENTE VALIDAO").reduce((we,Ne)=>we+(Number(Ne.valor_total_nota)||0),0),nfCancelamento:a.filter(we=>we.resultado==="TRATATIVA DE ANULAO").length,totalCancelamento:a.filter(we=>we.resultado==="TRATATIVA DE ANULAO").reduce((we,Ne)=>we+(Number(Ne.valor_total_nota)||0),0),nfAtraso:a.filter(we=>we.prazo==="EM ATRASO").length,totalAtraso:a.filter(we=>we.prazo==="EM ATRASO").reduce((we,Ne)=>we+(Number(Ne.valor_total_nota)||0),0)};z.setFillColor(C[0],C[1],C[2]),z.rect(0,0,W,45,"F");try{const we=new Image;we.src="/logo.png",z.addImage(we,"PNG",15,8,25,25)}catch{z.setFillColor(255,255,255),z.rect(15,8,12,12,"F"),z.setFillColor(w[0],w[1],w[2]),z.rect(15.5,8.5,11,11,"F"),z.setTextColor(255,255,255),z.setFontSize(10),z.setFont("helvetica","bold"),z.text("DM",19,16)}z.setFontSize(22),z.setFont("helvetica","bold"),z.setTextColor(255,255,255),z.text("Gesto de Devolues",45,18),z.setFontSize(10),z.setFont("helvetica","normal"),z.setTextColor(255,255,255),z.text("Grupo Doce Mel",45,28),z.text(`Relatrio Gerado em: ${Jt(new Date,"dd/MM/yyyy HH:mm",{locale:jr})}`,15,38);const X=t.startDate&&t.endDate?`${Jt(t.startDate,"dd/MM/yyyy",{locale:jr})} a ${Jt(t.endDate,"dd/MM/yyyy",{locale:jr})}`:t.period||"Perodo no especificado";z.text(`Perodo: ${X}`,W-15,20,{align:"right"}),z.text("Filial: Todas",W-15,30,{align:"right"}),M=55,z.setTextColor(w[0],w[1],w[2]),z.setFontSize(14),z.setFont("helvetica","bold"),z.text("Resumo Executivo",15,M),M+=10;const Y=(W-45)/3,ee=25;let U=15,Q=M;z.setFillColor(j[0],j[1],j[2]),z.setDrawColor(B[0],B[1],B[2]),z.setLineWidth(.5),z.rect(U,Q,Y,ee,"FD"),z.setFontSize(10),z.setFont("helvetica","bold"),z.setTextColor(w[0],w[1],w[2]),z.text("NF Pendentes",U+5,Q+8),z.setFontSize(16),z.setTextColor(S[0],S[1],S[2]),z.text(R.nfPendentes.toString(),U+5,Q+18),z.setFontSize(8),z.setTextColor(100,100,100),z.text(`R$ ${R.totalPendente.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,U+5,Q+23),U+=Y+7.5,z.setFillColor(j[0],j[1],j[2]),z.setDrawColor(B[0],B[1],B[2]),z.setLineWidth(.5),z.rect(U,Q,Y,ee,"FD"),z.setFontSize(10),z.setFont("helvetica","bold"),z.setTextColor(w[0],w[1],w[2]),z.text("NF Cancelamento",U+5,Q+8),z.setFontSize(16),z.setTextColor(A[0],A[1],A[2]),z.text(R.nfCancelamento.toString(),U+5,Q+18),z.setFontSize(8),z.setTextColor(100,100,100),z.text(`R$ ${R.totalCancelamento.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,U+5,Q+23),U+=Y+7.5,z.setFillColor(j[0],j[1],j[2]),z.setDrawColor(B[0],B[1],B[2]),z.setLineWidth(.5),z.rect(U,Q,Y,ee,"FD"),z.setFontSize(10),z.setFont("helvetica","bold"),z.setTextColor(w[0],w[1],w[2]),z.text("NF em Atraso",U+5,Q+8),z.setFontSize(16),z.setTextColor(S[0],S[1],S[2]),z.text(R.nfAtraso.toString(),U+5,Q+18),z.setFontSize(8),z.setTextColor(100,100,100),z.text(`R$ ${R.totalAtraso.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,U+5,Q+23),M+=ee+15,U=15,Q=M;const P=a.filter(we=>we.resultado==="VALIDADA").length,F=a.filter(we=>we.resultado==="VALIDADA").reduce((we,Ne)=>we+(Number(Ne.valor_total_nota)||0),0);z.setFillColor(j[0],j[1],j[2]),z.setDrawColor(B[0],B[1],B[2]),z.setLineWidth(.5),z.rect(U,Q,Y,ee,"FD"),z.setFontSize(10),z.setFont("helvetica","bold"),z.setTextColor(w[0],w[1],w[2]),z.text("NF Validadas",U+5,Q+8),z.setFontSize(16),z.setTextColor(T[0],T[1],T[2]),z.text(P.toString(),U+5,Q+18),z.setFontSize(8),z.setTextColor(100,100,100),z.text(`R$ ${F.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,U+5,Q+23);const Z=a.filter(we=>we.resultado==="LANADA").length,se=a.filter(we=>we.resultado==="LANADA").reduce((we,Ne)=>we+(Number(Ne.valor_total_nota)||0),0);U+=Y+7.5,z.setFillColor(j[0],j[1],j[2]),z.setDrawColor(B[0],B[1],B[2]),z.setLineWidth(.5),z.rect(U,Q,Y,ee,"FD"),z.setFontSize(10),z.setFont("helvetica","bold"),z.setTextColor(w[0],w[1],w[2]),z.text("NF Lanadas",U+5,Q+8),z.setFontSize(16),z.setTextColor(T[0],T[1],T[2]),z.text(Z.toString(),U+5,Q+18),z.setFontSize(8),z.setTextColor(100,100,100),z.text(`R$ ${se.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,U+5,Q+23);const re=a.reduce((we,Ne)=>we+(Number(Ne.valor_total_nota)||0),0);U+=Y+7.5,z.setFillColor(j[0],j[1],j[2]),z.setDrawColor(B[0],B[1],B[2]),z.setLineWidth(.5),z.rect(U,Q,Y,ee,"FD"),z.setFontSize(10),z.setFont("helvetica","bold"),z.setTextColor(w[0],w[1],w[2]),z.text("Total Geral",U+5,Q+8),z.setFontSize(16),z.setTextColor(C[0],C[1],C[2]),z.text(a.length.toString(),U+5,Q+18),z.setFontSize(8),z.setTextColor(100,100,100),z.text(`R$ ${re.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,U+5,Q+23),M+=ee+20;const ae=a.reduce((we,Ne)=>{const lt=Ne.nome_cliente||"Desconhecido",Ct=Number(Ne.valor_total_nota)||0;return we[lt]=(we[lt]||0)+Ct,we},{}),te=Object.entries(ae).map(([we,Ne])=>({name:we,value:Ne})).sort((we,Ne)=>Ne.value-we.value).slice(0,5),he=a.reduce((we,Ne)=>{const lt=Ne.vendedor||"Desconhecido",Ct=Number(Ne.valor_total_nota)||0;return we[lt]=(we[lt]||0)+Ct,we},{}),le=Object.entries(he).map(([we,Ne])=>({name:we,value:Ne})).sort((we,Ne)=>Ne.value-we.value).slice(0,5),ne=a.reduce((we,Ne)=>{const lt=Ne.rede||"Sem rede",Ct=Number(Ne.valor_total_nota)||0;return we[lt]=(we[lt]||0)+Ct,we},{}),de=Object.entries(ne).map(([we,Ne])=>({name:we,value:Ne})).sort((we,Ne)=>Ne.value-we.value).slice(0,5),fe=a.filter(we=>we.resultado==="TRATATIVA DE ANULAO").reduce((we,Ne)=>{const lt=new Date(Ne.data_emissao||Ne.created_at),Ct=Jt(lt,"dd/MM",{locale:jr});return we[Ct]=(we[Ct]||0)+1,we},{}),Se=a.reduce((we,Ne)=>{const lt=Ne.cidade_origem||"N/A";return we[lt]=(we[lt]||0)+(Number(Ne.valor_total_nota)||0),we},{}),_e=Object.entries(Se).map(([we,Ne])=>({name:we,value:Ne})).sort((we,Ne)=>Ne.value-we.value).slice(0,6),Ce=a.reduce((we,Ne)=>{const lt=Ne.motivo_nome||"No informado";return we[lt]=(we[lt]||0)+1,we},{}),Re=Object.entries(Ce).map(([we,Ne])=>({name:we,value:Ne})).sort((we,Ne)=>Ne.value-we.value).slice(0,5),Pe={};a.forEach(we=>{(we.itens||[]).forEach(lt=>{const ke=(lt.descricao||"Desconhecido").split(" ").slice(0,2).join(" "),De=Number(lt.quantidade)||0;Pe[ke]=(Pe[ke]||0)+De})});const Ye=Object.entries(Pe).map(([we,Ne])=>({name:we,quantidade:Ne})).sort((we,Ne)=>Ne.quantidade-we.quantidade).slice(0,10);z.setTextColor(w[0],w[1],w[2]),z.setFontSize(14),z.setFont("helvetica","bold"),z.text("Analises Graficas",15,M),M+=10,z.setFontSize(11),z.setFont("helvetica","bold"),z.setTextColor(w[0],w[1],w[2]),z.text("Top 5 Clientes (Valor)",15,M),M+=6,z.setFont("helvetica","normal"),z.setFontSize(9),te.forEach((we,Ne)=>{const lt=we.name.length>40?we.name.substring(0,37)+"...":we.name;z.text(`${Ne+1}. ${lt}: R$ ${we.value.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,20,M),M+=5}),M+=5,z.setFont("helvetica","bold"),z.setFontSize(11),z.text("Top 5 Vendedores (Valor)",15,M),M+=6,z.setFont("helvetica","normal"),z.setFontSize(9),le.forEach((we,Ne)=>{const lt=we.name.length>40?we.name.substring(0,37)+"...":we.name;z.text(`${Ne+1}. ${lt}: R$ ${we.value.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,20,M),M+=5}),M+=5,z.setFont("helvetica","bold"),z.setFontSize(11),z.text("Top 5 Redes (Valor)",15,M),M+=6,z.setFont("helvetica","normal"),z.setFontSize(9),de.forEach((we,Ne)=>{const lt=we.name.length>40?we.name.substring(0,37)+"...":we.name;z.text(`${Ne+1}. ${lt}: R$ ${we.value.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,20,M),M+=5}),M+=5;const at=Object.entries(fe).sort((we,Ne)=>{const lt=new Date(we[0].split("/").reverse().join("-")),Ct=new Date(Ne[0].split("/").reverse().join("-"));return lt.getTime()-Ct.getTime()}).slice(0,10);z.setFont("helvetica","bold"),z.setFontSize(11),z.text("Notas em Cancelamento",15,M),M+=6,z.setFont("helvetica","normal"),z.setFontSize(9),at.forEach(([we,Ne])=>{z.text(`${we}: ${Ne} nota(s)`,20,M),M+=5}),M+=5,z.setFont("helvetica","bold"),z.setFontSize(11),z.text("Distribuio por Municpio",15,M),M+=6,z.setFont("helvetica","normal"),z.setFontSize(9),_e.forEach((we,Ne)=>{const lt=we.name.length>40?we.name.substring(0,37)+"...":we.name;z.text(`${Ne+1}. ${lt}: R$ ${we.value.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,20,M),M+=5}),M+=5,z.setFont("helvetica","bold"),z.setFontSize(11),z.text("Principais Motivos",15,M),M+=6,z.setFont("helvetica","normal"),z.setFontSize(9),Re.forEach((we,Ne)=>{const lt=we.name.length>40?we.name.substring(0,37)+"...":we.name;z.text(`${Ne+1}. ${lt}: ${we.value} ocorrncia(s)`,20,M),M+=5}),M+=5,z.setFont("helvetica","bold"),z.setFontSize(11),z.text("Produtos Crticos (Top 10)",15,M),M+=6,z.setFont("helvetica","normal"),z.setFontSize(9),Ye.forEach((we,Ne)=>{const lt=we.name.length>40?we.name.substring(0,37)+"...":we.name;z.text(`${Ne+1}. ${lt}: ${we.quantidade.toFixed(2)} unidades`,20,M),M+=5}),M+=10,M>D-50&&(z.addPage(),M=20),z.setTextColor(w[0],w[1],w[2]),z.setFontSize(12),z.setFont("helvetica","bold");const tt=a.filter(we=>we.resultado==="PENDENTE VALIDAO");if(tt.length>0){z.text("1. Lista de Pendentes",15,M),M+=5;const we=tt.map(Ne=>[Ne.numero||"-",Ne.vendedor||"-",(Ne.nome_cliente||"-").substring(0,30),Ne.data_emissao?Jt(new Date(Ne.data_emissao),"dd/MM/yyyy",{locale:jr}):"-",`R$ ${(Number(Ne.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,Ne.prazo||"-",Ne.dias!==null&&Ne.dias!==void 0?Ne.dias.toString():"-",Ne.resultado||"-"]);sf(z,{head:[["NF","Vendedor","Cliente","Data Emisso","Valor","Prazo","Dias","Resultado"]],body:we,startY:M,styles:{fontSize:7,cellPadding:2},headStyles:{fillColor:[C[0],C[1],C[2]],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:15,right:15}}),M=z.lastAutoTable.finalY+10}M>D-50&&(z.addPage(),M=20);const it=a.filter(we=>we.resultado==="TRATATIVA DE ANULAO");if(it.length>0){z.text("2. Lista em Tratativas",15,M),M+=5;const we=it.map(Ne=>[Ne.numero||"-",Ne.vendedor||"-",(Ne.nome_cliente||"-").substring(0,30),Ne.data_emissao?Jt(new Date(Ne.data_emissao),"dd/MM/yyyy",{locale:jr}):"-",`R$ ${(Number(Ne.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,Ne.prazo||"-",Ne.dias!==null&&Ne.dias!==void 0?Ne.dias.toString():"-",Ne.resultado||"-"]);sf(z,{head:[["NF","Vendedor","Cliente","Data Emisso","Valor","Prazo","Dias","Resultado"]],body:we,startY:M,styles:{fontSize:7,cellPadding:2},headStyles:{fillColor:[A[0],A[1],A[2]],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[255,250,240]},margin:{left:15,right:15}}),M=z.lastAutoTable.finalY+10}M>D-50&&(z.addPage(),M=20);const rt=a.filter(we=>we.resultado==="VALIDADA");if(rt.length>0){z.text("3. Lista Validadas",15,M),M+=5;const we=rt.map(Ne=>[Ne.numero||"-",Ne.vendedor||"-",(Ne.nome_cliente||"-").substring(0,30),Ne.data_emissao?Jt(new Date(Ne.data_emissao),"dd/MM/yyyy",{locale:jr}):"-",`R$ ${(Number(Ne.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,Ne.prazo||"-",Ne.dias!==null&&Ne.dias!==void 0?Ne.dias.toString():"-",Ne.resultado||"-"]);sf(z,{head:[["NF","Vendedor","Cliente","Data Emisso","Valor","Prazo","Dias","Resultado"]],body:we,startY:M,styles:{fontSize:7,cellPadding:2},headStyles:{fillColor:[T[0],T[1],T[2]],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[240,255,240]},margin:{left:15,right:15}}),M=z.lastAutoTable.finalY+10}M>D-50&&(z.addPage(),M=20),z.text("4. Lista Completa com Produtos",15,M),M+=5;const ct=[];a.forEach(we=>{we.itens&&we.itens.length>0?we.itens.forEach(Ne=>{ct.push([we.numero||"-",we.vendedor||"-",(we.nome_cliente||"-").substring(0,25),(Ne.descricao||"-").substring(0,30),Ne.unidade||"-",Ne.quantidade?Ne.quantidade.toString():"-",`R$ ${(Number(Ne.valor_total_bruto)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`])}):ct.push([we.numero||"-",we.vendedor||"-",(we.nome_cliente||"-").substring(0,25),"Sem itens","-","-",`R$ ${(Number(we.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`])}),sf(z,{head:[["NF","Vendedor","Cliente","Produto","Unidade","Quantidade","Valor"]],body:ct.slice(0,50),startY:M,styles:{fontSize:6,cellPadding:1.5},headStyles:{fillColor:[w[0],w[1],w[2]],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[250,250,250]},margin:{left:15,right:15}}),M=z.lastAutoTable.finalY+10,M>D-60&&(z.addPage(),M=20),z.setFillColor(C[0],C[1],C[2]),z.rect(0,M-5,W,8,"F"),z.setTextColor(255,255,255),z.setFontSize(14),z.setFont("helvetica","bold"),z.text("Inteligencia e Analises",15,M+3),M+=15;const Oe=a.reduce((we,Ne)=>we+(Number(Ne.valor_total_nota)||0),0),pt=a.length,Je=a.reduce((we,Ne)=>{const lt=Ne.itens||[];return we+lt.reduce((Ct,$t)=>Ct+(Number($t.quantidade)||0),0)},0),ot=pt>0?Oe/pt:0,ut=Je>0&&pt>0?Je/pt:0,_t=[];if(pt>0&&_t.push(`Total de ${pt} devolucao(oes) no periodo selecionado, totalizando R$ ${Oe.toLocaleString("pt-BR",{minimumFractionDigits:2})}.`),te.length>0&&Oe>0){const we=te[0].value/Oe*100;we>20&&_t.push(`Cliente "${te[0].name}" concentra ${we.toFixed(1)}% do valor total de devolucoes.`)}ut>0&&_t.push(`Media de ${ut.toFixed(1)} produtos por devolucao.`),le.length>0&&_t.push(`Vendedor "${le[0].name}" lidera em devolucoes com R$ ${le[0].value.toLocaleString("pt-BR")}.`),Ye.length>0&&_t.push(`Produto "${Ye[0].name}" e o mais devolvido com ${Ye[0].quantidade.toFixed(2)} unidades.`);const vt=a.filter(we=>we.resultado==="TRATATIVA DE ANULAO"||we.resultado==="ANULADA/CANCELADA").length,ht=pt>0?vt/pt*100:0;if(ht>10?_t.push(`Taxa de cancelamento alta: ${ht.toFixed(1)}% das devolucoes estao em cancelamento.`):vt>0&&_t.push(`${vt} devolucao(oes) em processo de cancelamento.`),Re.length>0&&_t.push(`Motivo mais frequente: "${Re[0].name}" com ${Re[0].value} ocorrencia(s).`),ot>0){const we=a.filter(Ne=>Number(Ne.valor_total_nota)>ot*1.5).length;we>0&&_t.push(`${we} devolucao(oes) com valor acima de 150% do ticket medio.`)}if(de.length>0&&Oe>0){const we=de[0].value/Oe*100;we>15&&_t.push(`Rede "${de[0].name}" representa ${we.toFixed(1)}% do valor devolvido.`)}z.setTextColor(w[0],w[1],w[2]),z.setFontSize(11),z.setFont("helvetica","bold"),z.text("Insights Automaticos:",15,M),M+=7,z.setFont("helvetica","normal"),z.setFontSize(9),z.setTextColor(0,0,0),_t.forEach(we=>{M>D-20&&(z.addPage(),M=20),z.text(we,20,M),M+=5}),M+=5,z.setFont("helvetica","bold"),z.setFontSize(11),z.setTextColor(w[0],w[1],w[2]),z.text("Alertas e Recomendacoes:",15,M),M+=7,z.setFont("helvetica","normal"),z.setFontSize(9),z.setTextColor(0,0,0);const $e=[];if(R.nfAtraso>0&&$e.push(`${R.nfAtraso} nota(s) fiscal(is) em atraso requerem atencao imediata`),R.nfPendentes>10&&$e.push(`Alto volume de pendencias (${R.nfPendentes}) - considere revisar processos`),R.totalCancelamento>re*.1&&$e.push("Taxa de cancelamento acima de 10% - investigar causas"),a.length>0){const we=a.filter(Ne=>Ne.dias!==null&&Ne.dias!==void 0).reduce((Ne,lt)=>Ne+(lt.dias||0),0)/a.filter(Ne=>Ne.dias!==null&&Ne.dias!==void 0).length;we>30&&$e.push(`Tempo medio de processamento alto (${we.toFixed(1)} dias)`)}$e.length===0&&$e.push("Nenhum alerta critico identificado"),$e.forEach(we=>{M>D-20&&(z.addPage(),M=20),z.text(we,20,M),M+=5}),M+=5,z.setFont("helvetica","bold"),z.setFontSize(11),z.setTextColor(w[0],w[1],w[2]),z.text("Tendencias:",15,M),M+=7,z.setFont("helvetica","normal"),z.setFontSize(9),z.setTextColor(0,0,0);const Be=a.length>0?(rt.length/a.length*100).toFixed(1):"0",wt=a.length>0?(R.nfCancelamento/a.length*100).toFixed(1):"0";z.text(`Taxa de Validacao: ${Be}%`,20,M),M+=5,z.text(`Taxa de Cancelamento: ${wt}%`,20,M),M+=5,z.text(`Total Processado: ${a.length} nota(s) fiscal(is)`,20,M);const et=z.getNumberOfPages();for(let we=1;we<=et;we++)z.setPage(we),z.setFontSize(8),z.setTextColor(150,150,150),z.text(`Pgina ${we} de ${et} - Sistema de Devolues`,W/2,D-10,{align:"center"});const dt=`Relatorio_Devolucoes_${Jt(new Date,"yyyy-MM-dd_HH-mm-ss",{locale:jr})}.pdf`;z.save(dt),St.success("PDF gerado com sucesso!")}catch(z){console.error("Erro ao gerar PDF:",z),St.error("Erro ao gerar PDF: "+z.message)}};ye.useEffect(()=>{if(s.length===0)return;let z=[...s];v&&g?z=[...a].sort((M,C)=>{let w,T;switch(v){case"data_emissao":w=M.data_emissao?new Date(M.data_emissao).getTime():0,T=C.data_emissao?new Date(C.data_emissao).getTime():0;break;case"numero":w=M.numero||"",T=C.numero||"";break;case"nome_cliente":w=(M.nome_cliente||"").toLowerCase(),T=(C.nome_cliente||"").toLowerCase();break;case"cidade_origem":w=(M.cidade_origem||"").toLowerCase(),T=(C.cidade_origem||"").toLowerCase();break;case"vendedor":w=(M.vendedor||"").toLowerCase(),T=(C.vendedor||"").toLowerCase();break;case"motivo_nome":w=(M.motivo_nome||"").toLowerCase(),T=(C.motivo_nome||"").toLowerCase();break;case"valor_total_nota":w=parseFloat(M.valor_total_nota||0),T=parseFloat(C.valor_total_nota||0);break;case"dias":w=M.dias!==null&&M.dias!==void 0?M.dias:-1,T=C.dias!==null&&C.dias!==void 0?C.dias:-1;break;case"prazo":w=(M.prazo||"").toLowerCase(),T=(C.prazo||"").toLowerCase();break;case"resultado":w=zi[M.resultado]||999,T=zi[C.resultado]||999;break;default:return 0}return w<T?g==="asc"?-1:1:w>T?g==="asc"?1:-1:0}):z=[...s].sort((M,C)=>{const w=zi[M.resultado]||999,T=zi[C.resultado]||999;if(w!==T)return w-T;const A=M.data_emissao?new Date(M.data_emissao).getTime():0;return(C.data_emissao?new Date(C.data_emissao).getTime():0)-A});const W=(u-1)*N,D=W+N;n(z.slice(W,D))},[v,g,s,u]);const H=z=>{v===z?g==="asc"?x("desc"):g==="desc"&&(b(null),x(null)):(b(z),x("asc")),p(1)},V=({field:z})=>v!==z?k.jsx(My,{className:"ml-1 h-4 w-4 opacity-50"}):g==="asc"?k.jsx(Ry,{className:"ml-1 h-4 w-4"}):k.jsx(Dy,{className:"ml-1 h-4 w-4"}),q=async()=>{if(!(!f||!r))try{const{error:z}=await Tt.from("itens_devolucao").delete().eq("devolucao_id",f);if(z)throw z;const{error:W}=await Tt.from("devolucoes").delete().eq("id",f);if(W)throw W;St.success("Registro excludo com sucesso!"),h(null),I()}catch(z){St.error("Erro ao excluir registro: "+z.message)}},K=async()=>{if(a.length===0){St.warning("Sem dados para exportar");return}try{const z=a.map(Y=>Y.id);let W=new Map;if(z.length>0){const{data:Y}=await Tt.from("logs_validacao").select(`
            devolucao_id,
            status_novo,
            usuario_id
          `).in("devolucao_id",z).order("created_at",{ascending:!1});if(Y){const ee=[...new Set(Y.map(Q=>Q.usuario_id).filter(Boolean))],U=new Map;if(ee.length>0){const{data:Q}=await Tt.from("profiles").select("id, name").in("id",ee);Q&&Q.forEach(P=>{U.set(P.id,P.name)})}Y.forEach(Q=>{const P=`${Q.devolucao_id}_${Q.status_novo}`;if(!W.has(P)){const F=U.get(Q.usuario_id);F&&W.set(P,F)}})}}const D=[];a.forEach(Y=>{const ee=Y.resultado||"PENDENTE VALIDAO",U=ee!=="PENDENTE VALIDAO"&&W.get(`${Y.id}_${ee}`)||"-";!Y.itens||Y.itens.length===0?D.push({"Data Emisso":Y.data_emissao?Jt(new Date(Y.data_emissao),"dd/MM/yyyy"):"","Data Criao":Y.created_at?Jt(new Date(Y.created_at),"dd/MM/yyyy HH:mm"):"","Nota Fiscal":Y.numero||"",Srie:Y.serie||"","Chave de Acesso":Y.chave_acesso||"",Cliente:Y.nome_cliente||"","CNPJ Cliente":Y.cnpj_destinatario||"","CNPJ Emitente":Y.cnpj_emitente||"","Razo Social Emitente":Y.razao_social_emitente||"",Vendedor:Y.vendedor||"",Rede:Y.rede||"","Cidade Origem":Y.cidade_origem||"","UF Origem":Y.uf_origem||"","Cidade Destino":Y.cidade_destino||"","UF Destino":Y.uf_destino||"",Setor:Y.setor_nome||"",Motivo:Y.motivo_nome||"",Status:ee,"Validado Por":U,Comentrio:Y.justificativa||"",Dias:Y.dias!==null&&Y.dias!==void 0?Y.dias:"",Prazo:Y.prazo||"","Valor Total Nota":Y.valor_total_nota?Number(Y.valor_total_nota).toFixed(2):"0.00","Peso Lquido":Y.peso_liquido||"","Sincronizao ERP":Y.sincronizacao_erp||"","Finalidade NFe":Y.finalidade_nfe||"","Natureza Operao":Y.natureza_operacao||"",CFOP:Y.cfop||"","Nmero Item":"","Descrio Produto":"",Unidade:"",Quantidade:"","Valor Unitrio":"","Valor Total Item":""}):Y.itens.forEach((Q,P)=>{D.push({"Data Emisso":P===0&&Y.data_emissao?Jt(new Date(Y.data_emissao),"dd/MM/yyyy"):"","Data Criao":P===0&&Y.created_at?Jt(new Date(Y.created_at),"dd/MM/yyyy HH:mm"):"","Nota Fiscal":P===0&&Y.numero||"",Srie:P===0&&Y.serie||"","Chave de Acesso":P===0&&Y.chave_acesso||"",Cliente:P===0&&Y.nome_cliente||"","CNPJ Cliente":P===0&&Y.cnpj_destinatario||"","CNPJ Emitente":P===0&&Y.cnpj_emitente||"","Razo Social Emitente":P===0&&Y.razao_social_emitente||"",Vendedor:P===0&&Y.vendedor||"",Rede:P===0&&Y.rede||"","Cidade Origem":P===0&&Y.cidade_origem||"","UF Origem":P===0&&Y.uf_origem||"","Cidade Destino":P===0&&Y.cidade_destino||"","UF Destino":P===0&&Y.uf_destino||"",Setor:P===0&&Y.setor_nome||"",Motivo:P===0&&Y.motivo_nome||"",Status:P===0?ee:"","Validado Por":P===0?U:"",Comentrio:P===0&&Y.justificativa||"",Dias:P===0&&Y.dias!==null&&Y.dias!==void 0?Y.dias:"",Prazo:P===0&&Y.prazo||"","Valor Total Nota":P===0?Y.valor_total_nota?Number(Y.valor_total_nota).toFixed(2):"0.00":"","Peso Lquido":P===0&&Y.peso_liquido||"","Sincronizao ERP":P===0&&Y.sincronizacao_erp||"","Finalidade NFe":P===0&&Y.finalidade_nfe||"","Natureza Operao":P===0&&Y.natureza_operacao||"",CFOP:P===0&&Y.cfop||"","Nmero Item":Q.numero_item||"","Descrio Produto":Q.descricao||"",Unidade:Q.unidade||"",Quantidade:Q.quantidade?Number(Q.quantidade).toFixed(2):"","Valor Unitrio":Q.valor_unitario?Number(Q.valor_unitario).toFixed(2):"","Valor Total Item":Q.valor_total_bruto?Number(Q.valor_total_bruto).toFixed(2):""})})});const M=new JN.Workbook,C=M.addWorksheet("Devolues"),w=["Data Emisso","Data Criao","Nota Fiscal","Srie","Chave de Acesso","Cliente","CNPJ Cliente","CNPJ Emitente","Razo Social Emitente","Vendedor","Rede","Cidade Origem","UF Origem","Cidade Destino","UF Destino","Setor","Motivo","Status","Validado Por","Comentrio","Dias","Prazo","Valor Total Nota","Peso Lquido","Sincronizao ERP","Finalidade NFe","Natureza Operao","CFOP","Nmero Item","Descrio Produto","Unidade","Quantidade","Valor Unitrio","Valor Total Item"],T=[12,18,12,8,45,30,18,18,30,20,20,20,5,20,5,15,30,20,20,40,8,12,15,12,18,15,20,8,12,40,8,12,15,15],A=C.addRow(w);A.eachCell(Y=>{Y.font={bold:!0,color:{argb:"FFFFFFFF"},size:11},Y.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF073E29"}},Y.alignment={vertical:"middle",horizontal:"center",wrapText:!0},Y.border={top:{style:"thin",color:{argb:"FF000000"}},left:{style:"thin",color:{argb:"FF000000"}},bottom:{style:"thin",color:{argb:"FF000000"}},right:{style:"thin",color:{argb:"FF000000"}}}}),A.height=25,T.forEach((Y,ee)=>{C.getColumn(ee+1).width=Y}),D.forEach(Y=>{C.addRow(w.map(U=>Y[U]||"")).eachCell(U=>{U.border={top:{style:"thin",color:{argb:"FFCCCCCC"}},left:{style:"thin",color:{argb:"FFCCCCCC"}},bottom:{style:"thin",color:{argb:"FFCCCCCC"}},right:{style:"thin",color:{argb:"FFCCCCCC"}}}})});const S=w.indexOf("Chave de Acesso")+1;C.getColumn(S).numFmt="@",C.autoFilter={from:{row:1,column:1},to:{row:D.length+1,column:w.length}},C.views=[{state:"frozen",ySplit:1}];const j=await M.xlsx.writeBuffer(),B=new Blob([j],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),R=window.URL.createObjectURL(B),X=document.createElement("a");X.href=R,X.download=`Relatorio_Devolucoes_${Jt(new Date,"yyyy-MM-dd_HHmm")}.xlsx`,X.click(),window.URL.revokeObjectURL(R),St.success("Relatrio Excel gerado com sucesso!")}catch(z){console.error("Erro ao gerar Excel:",z),St.error("Erro ao gerar relatrio Excel: "+z.message)}};return k.jsxs("div",{className:"space-y-6",children:[k.jsx(Qi,{title:"Relatrios",description:"Visualize e exporte relatrios detalhados das devolues. Gere PDFs e planilhas Excel com todos os dados filtrados."}),k.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[k.jsx(Xf,{}),k.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full md:w-auto shrink-0",children:[k.jsxs(Nt,{variant:"outline",onClick:K,className:"w-full sm:w-auto",children:[k.jsx(RS,{className:"mr-2 h-4 w-4 text-green-600"}),"Exportar Excel"]}),k.jsxs(Nt,{variant:"outline",onClick:()=>{const z=eO({data:a,stats:{nfPendentes:a.filter(D=>D.resultado==="PENDENTE VALIDAO").length,totalPendente:a.filter(D=>D.resultado==="PENDENTE VALIDAO").reduce((D,M)=>D+(Number(M.valor_total_nota)||0),0),nfCancelamento:a.filter(D=>D.resultado==="TRATATIVA DE ANULAO").length,totalCancelamento:a.filter(D=>D.resultado==="TRATATIVA DE ANULAO").reduce((D,M)=>D+(Number(M.valor_total_nota)||0),0),nfAtraso:a.filter(D=>D.prazo==="EM ATRASO").length,totalAtraso:a.filter(D=>D.prazo==="EM ATRASO").reduce((D,M)=>D+(Number(M.valor_total_nota)||0),0),nfValidadas:a.filter(D=>D.resultado==="VALIDADA").length,totalValidadas:a.filter(D=>D.resultado==="VALIDADA").reduce((D,M)=>D+(Number(M.valor_total_nota)||0),0),nfLancadas:a.filter(D=>D.resultado==="LANADA").length,totalLancadas:a.filter(D=>D.resultado==="LANADA").reduce((D,M)=>D+(Number(M.valor_total_nota)||0),0),totalGeral:a.reduce((D,M)=>D+(Number(M.valor_total_nota)||0),0)},filters:t}),W=window.open("","_blank");W&&(W.document.write(z),W.document.close())},className:"w-full sm:w-auto",children:[k.jsx(Jb,{className:"mr-2 h-4 w-4"}),"Gerar Relatrio HTML"]}),k.jsxs(Nt,{variant:"outline",onClick:L,className:"w-full sm:w-auto",children:[k.jsx(Jb,{className:"mr-2 h-4 w-4"}),"Gerar PDF"]})]})]}),k.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-6",children:[k.jsxs(Dt,{children:[k.jsx(Rt,{className:"pb-3",children:k.jsx(Ft,{className:"text-sm font-semibold",children:"Valor Total Lanado"})}),k.jsxs(Mt,{children:[k.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",y.valorTotalLancado.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),k.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[y.notasLancadas," nota(s) lanada(s)"]})]})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{className:"pb-3",children:k.jsx(Ft,{className:"text-sm font-semibold",children:"Notas Lanadas"})}),k.jsxs(Mt,{children:[k.jsx("div",{className:"text-2xl font-bold",children:y.notasLancadas}),k.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Total de notas com resultado LANADA"})]})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{className:"pb-3",children:k.jsx(Ft,{className:"text-sm font-semibold",children:"Valor Total Anulado"})}),k.jsxs(Mt,{children:[k.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",y.valorTotalAnulado.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),k.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[y.notasAnuladas," nota(s) anulada(s)"]})]})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{className:"pb-3",children:k.jsx(Ft,{className:"text-sm font-semibold",children:"Notas Anuladas"})}),k.jsxs(Mt,{children:[k.jsx("div",{className:"text-2xl font-bold",children:y.notasAnuladas}),k.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Total de notas com resultado ANULADA/CANCELADA"})]})]})]}),k.jsxs("div",{className:"grid gap-4 md:grid-cols-2 mb-6",children:[k.jsxs(Dt,{children:[k.jsx(Rt,{className:"pb-3",children:k.jsx(Ft,{className:"text-sm font-semibold",children:"Comparativo MoM"})}),k.jsxs(Mt,{children:[k.jsxs("div",{className:"flex items-center gap-2",children:[y.momPercent>=0?k.jsx(_u,{className:"h-6 w-6 text-red-600"}):k.jsx(ox,{className:"h-6 w-6 text-green-600"}),k.jsxs("div",{className:"text-2xl font-bold",style:{color:y.momPercent>=0?"#dc2626":"#16a34a"},children:[Math.abs(y.momPercent).toFixed(2),"%"]})]}),k.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Variao ms sobre ms (valor total)"})]})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{className:"pb-3",children:k.jsx(Ft,{className:"text-sm font-semibold",children:"Comparativo YoY"})}),k.jsxs(Mt,{children:[k.jsxs("div",{className:"flex items-center gap-2",children:[y.yoyPercent>=0?k.jsx(_u,{className:"h-6 w-6 text-red-600"}):k.jsx(ox,{className:"h-6 w-6 text-green-600"}),k.jsxs("div",{className:"text-2xl font-bold",style:{color:y.yoyPercent>=0?"#dc2626":"#16a34a"},children:[Math.abs(y.yoyPercent).toFixed(2),"%"]})]}),k.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Variao ano sobre ano (valor total)"})]})]})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{children:k.jsx(Ft,{children:"Detalhamento de Devolues"})}),k.jsx(Mt,{children:c?k.jsx("div",{className:"flex justify-center py-10",children:k.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"})}):k.jsx("div",{className:"rounded-md border overflow-x-auto",children:k.jsxs(Ua,{children:[k.jsx(os,{children:k.jsxs(Nr,{children:[k.jsx(jt,{className:"w-[50px]"}),k.jsx(jt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>H("data_emissao"),children:k.jsxs("div",{className:"flex items-center",children:["Data Emisso",k.jsx(V,{field:"data_emissao"})]})}),k.jsx(jt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>H("numero"),children:k.jsxs("div",{className:"flex items-center",children:["Nota Fiscal",k.jsx(V,{field:"numero"})]})}),k.jsx(jt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>H("nome_cliente"),children:k.jsxs("div",{className:"flex items-center",children:["Cliente",k.jsx(V,{field:"nome_cliente"})]})}),k.jsx(jt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>H("vendedor"),children:k.jsxs("div",{className:"flex items-center",children:["Vendedor",k.jsx(V,{field:"vendedor"})]})}),k.jsx(jt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>H("motivo"),children:k.jsxs("div",{className:"flex items-center",children:["Motivo",k.jsx(V,{field:"motivo"})]})}),k.jsx(jt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>H("valor_total_nota"),children:k.jsxs("div",{className:"flex items-center",children:["Valor Total",k.jsx(V,{field:"valor_total_nota"})]})}),k.jsx(jt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>H("prazo"),children:k.jsxs("div",{className:"flex items-center",children:["Prazo",k.jsx(V,{field:"prazo"})]})}),k.jsx(jt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>H("resultado"),children:k.jsxs("div",{className:"flex items-center",children:["Resultado",k.jsx(V,{field:"resultado"})]})}),k.jsx(jt,{className:"text-[10px] px-2",children:"Validado Por"}),k.jsx(jt,{className:"text-[10px] px-2",children:"Finalizada Por"}),k.jsx(jt,{className:"text-[10px] px-2",children:"Comentrio"}),k.jsx(jt,{className:"text-[10px] px-2",children:"Aes"})]})}),k.jsxs(za,{children:[e.map(z=>k.jsx(Nr,{className:"group",children:k.jsx(Kt,{colSpan:13,className:"p-0 border-b",children:k.jsx(s_,{type:"single",collapsible:!0,className:"w-full",children:k.jsxs(Lm,{value:z.id,className:"border-b-0",children:[k.jsx("div",{className:"flex items-center w-full py-2 px-4 hover:bg-muted/50",children:k.jsxs("div",{className:"flex gap-2 w-full items-center text-[10px]",children:[k.jsx(Bm,{className:"w-[50px] py-0 pr-4 hover:no-underline flex-shrink-0"}),k.jsx("div",{className:"w-20",children:z.data_emissao?Jt(new Date(z.data_emissao),"dd/MM/yyyy"):"-"}),k.jsx("div",{className:"w-20 font-medium",children:z.numero}),k.jsx("div",{className:"w-32 truncate",title:z.nome_cliente,children:z.nome_cliente}),k.jsx("div",{className:"w-24 truncate",title:z.vendedor,children:z.vendedor}),k.jsx("div",{className:"w-40 truncate",title:z.motivo_nome,children:z.motivo_nome||"-"}),k.jsxs("div",{className:"w-28 text-right",children:["R$ ",Number(z.valor_total_nota||0).toLocaleString("pt-BR",{minimumFractionDigits:2})]}),k.jsx("div",{className:"w-20",children:k.jsx("span",{className:`text-[9px] px-1 py-0.5 rounded ${z.prazo==="EM ATRASO"?"bg-red-500 text-white":z.prazo==="NO PRAZO"?"bg-green-500 text-white":z.prazo==="FINALIZADO"?"bg-green-200 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-500 text-white"}`,children:z.prazo||"-"})}),k.jsx("div",{className:"w-32",children:k.jsx("span",{className:`text-[9px] px-1 py-0.5 rounded ${z.resultado==="VALIDADA"||z.resultado==="LANADA"?"bg-blue-500 text-white":z.resultado==="ANULADA/CANCELADA"?"bg-red-500 text-white":"bg-gray-500 text-white"}`,children:z.resultado||"-"})}),k.jsx("div",{className:"w-28 truncate text-[9px]",title:z.nome_validador||"-",children:z.nome_validador||"-"}),k.jsx("div",{className:"w-28 truncate text-[9px]",title:z.finalizada_por||"-",children:z.finalizada_por||"-"}),k.jsx("div",{className:"w-48 truncate text-[9px]",title:z.justificativa||"-",children:z.justificativa||"-"}),k.jsx("div",{className:"w-28 flex gap-1",children:((r==null?void 0:r.role)==="ADMIN"||(r==null?void 0:r.role)==="LOGISTICA")&&k.jsx(k.Fragment,{children:k.jsx(Nt,{size:"sm",variant:"destructive",className:"h-7 px-1",onClick:W=>{W.stopPropagation(),h(z.id)},title:"Excluir",children:k.jsx(Pa,{className:"h-3 w-3"})})})})]})}),k.jsx(Um,{children:k.jsx("div",{className:"px-4 pb-4",children:k.jsxs("div",{className:"rounded-md border bg-muted/50 p-4",children:[k.jsx("h4",{className:"font-semibold mb-2 text-sm",children:"Itens da Devoluo"}),k.jsxs(Ua,{children:[k.jsx(os,{children:k.jsxs(Nr,{children:[k.jsx(jt,{className:"h-8 text-xs",children:"Nmero"}),k.jsx(jt,{className:"h-8 text-xs",children:"Descrio"}),k.jsx(jt,{className:"h-8 text-xs",children:"Unidade"}),k.jsx(jt,{className:"h-8 text-xs",children:"Quantidade"}),k.jsx(jt,{className:"h-8 text-xs",children:"Valor Unitrio"}),k.jsx(jt,{className:"h-8 text-xs",children:"Valor Total Bruto"}),k.jsx(jt,{className:"h-8 text-xs",children:"Motivo"})]})}),k.jsx(za,{children:z.itens&&z.itens.length>0?z.itens.map((W,D)=>{var M;return k.jsxs(Nr,{children:[k.jsx(Kt,{className:"text-xs",children:W.numero_item||"-"}),k.jsx(Kt,{className:"text-xs",children:W.descricao||"-"}),k.jsx(Kt,{className:"text-xs",children:W.unidade||"-"}),k.jsx(Kt,{className:"text-xs",children:W.quantidade||"-"}),k.jsxs(Kt,{className:"text-xs",children:["R$ ",Number(W.valor_unitario||0).toFixed(2)]}),k.jsxs(Kt,{className:"text-xs",children:["R$ ",Number(W.valor_total_bruto||0).toFixed(2)]}),k.jsx(Kt,{className:"text-xs",children:((M=W.motivo_item)==null?void 0:M.nome)||"-"})]},D)}):k.jsx(Nr,{children:k.jsx(Kt,{colSpan:7,className:"text-center text-xs text-muted-foreground",children:"Nenhum item cadastrado"})})})]})]})})})]})})})},z.id)),e.length===0&&k.jsx(Nr,{children:k.jsx(Kt,{colSpan:13,className:"text-center py-8 text-muted-foreground",children:"Nenhum dado encontrado com os filtros atuais."})})]})]})})})]}),!c&&s.length>0&&k.jsxs("div",{className:"flex items-center justify-between",children:[k.jsxs("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",(u-1)*N+1," a ",Math.min(u*N,s.length)," de ",s.length," registros"]}),k.jsxs("div",{className:"flex gap-2",children:[k.jsxs(Nt,{variant:"outline",size:"sm",onClick:()=>p(z=>Math.max(1,z-1)),disabled:u===1,children:[k.jsx(yu,{className:"h-4 w-4 mr-1"}),"Anterior"]}),k.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.ceil(s.length/N)},(z,W)=>W+1).filter(z=>{const W=Math.ceil(s.length/N);return z===1||z===W||z>=u-2&&z<=u+2}).map((z,W,D)=>{const M=D[W-1],C=M&&z-M>1;return k.jsxs("div",{className:"flex items-center gap-1",children:[C&&k.jsx("span",{className:"px-2",children:"..."}),k.jsx(Nt,{variant:u===z?"default":"outline",size:"sm",onClick:()=>p(z),className:"w-10",children:z})]},z)})}),k.jsxs(Nt,{variant:"outline",size:"sm",onClick:()=>p(z=>Math.min(Math.ceil(s.length/N),z+1)),disabled:u>=Math.ceil(s.length/N),children:["Prxima",k.jsx(wu,{className:"h-4 w-4 ml-1"})]})]})]}),k.jsx(ri,{open:!!f,onOpenChange:z=>!z&&h(null),children:k.jsxs(As,{className:"sm:max-w-[425px]",children:[k.jsxs(Cs,{children:[k.jsxs(Os,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[k.jsx(Pa,{className:"h-5 w-5"}),"Confirmar Excluso"]}),k.jsx(js,{className:"pt-2",children:"Tem certeza que deseja excluir este registro?"}),k.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mt-4",children:k.jsx("p",{className:"text-sm text-destructive font-medium",children:" Esta ao no pode ser desfeita."})})]}),k.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[k.jsx(Nt,{variant:"outline",onClick:()=>h(null),className:"flex-1 sm:flex-initial",children:"No"}),k.jsx(Nt,{variant:"destructive",onClick:q,className:"flex-1 sm:flex-initial",children:"Sim, Excluir"})]})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var o_=1252,rO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],zm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},$m=function(t){rO.indexOf(t)!=-1&&(o_=zm[0]=t)};function nO(){$m(1252)}var ls=function(t){$m(t)};function l_(){ls(1200),nO()}function Gx(t){for(var r=[],e=0,n=t.length;e<n;++e)r[e]=t.charCodeAt(e);return r}function aO(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e)+(t.charCodeAt(2*e+1)<<8));return r.join("")}function c_(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e+1)+(t.charCodeAt(2*e)<<8));return r.join("")}var au=function(t){var r=t.charCodeAt(0),e=t.charCodeAt(1);return r==255&&e==254?aO(t.slice(2)):r==254&&e==255?c_(t.slice(2)):r==65279?t.slice(1):t},hf=function(r){return String.fromCharCode(r)},Yx=function(r){return String.fromCharCode(r)},Ou,Wi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Xx(t){for(var r="",e=0,n=0,a=0,o=0,s=0,l=0,c=0,i=0;i<t.length;)e=t.charCodeAt(i++),o=e>>2,n=t.charCodeAt(i++),s=(e&3)<<4|n>>4,a=t.charCodeAt(i++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),r+=Wi.charAt(o)+Wi.charAt(s)+Wi.charAt(l)+Wi.charAt(c);return r}function Sa(t){var r="",e=0,n=0,a=0,o=0,s=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var i=0;i<t.length;)o=Wi.indexOf(t.charAt(i++)),s=Wi.indexOf(t.charAt(i++)),e=o<<2|s>>4,r+=String.fromCharCode(e),l=Wi.indexOf(t.charAt(i++)),n=(s&15)<<4|l>>2,l!==64&&(r+=String.fromCharCode(n)),c=Wi.indexOf(t.charAt(i++)),a=(l&3)<<6|c,c!==64&&(r+=String.fromCharCode(a));return r}var dr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),$o=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(r,e){return e?new Buffer(r,e):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function eo(t){return dr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Kx(t){return dr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ss=function(r){return dr?$o(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)&255})};function Vo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],e=0;e<t.length;++e)r[e]=String.fromCharCode(t[e]);return r.join("")}function Vm(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Vm(new Uint8Array(t));for(var r=new Array(t.length),e=0;e<t.length;++e)r[e]=t[e];return r}var qi=dr?function(t){return Buffer.concat(t.map(function(r){return Buffer.isBuffer(r)?r:$o(r)}))}:function(t){if(typeof Uint8Array<"u"){var r=0,e=0;for(r=0;r<t.length;++r)e+=t[r].length;var n=new Uint8Array(e),a=0;for(r=0,e=0;r<t.length;e+=a,++r)if(a=t[r].length,t[r]instanceof Uint8Array)n.set(t[r],e);else{if(typeof t[r]=="string")throw"wtf";n.set(new Uint8Array(t[r]),e)}return n}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function sO(t){for(var r=[],e=0,n=t.length+250,a=eo(t.length+255),o=0;o<t.length;++o){var s=t.charCodeAt(o);if(s<128)a[e++]=s;else if(s<2048)a[e++]=192|s>>6&31,a[e++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var l=t.charCodeAt(++o)&1023;a[e++]=240|s>>8&7,a[e++]=128|s>>2&63,a[e++]=128|l>>6&15|(s&3)<<4,a[e++]=128|l&63}else a[e++]=224|s>>12&15,a[e++]=128|s>>6&63,a[e++]=128|s&63;e>n&&(r.push(a.slice(0,e)),e=0,a=eo(65535),n=65530)}return r.push(a.slice(0,e)),qi(r)}var Zn=/\u0000/g,su=/[\u0001-\u0006]/g;function Wl(t){for(var r="",e=t.length-1;e>=0;)r+=t.charAt(e--);return r}function cs(t,r){var e=""+t;return e.length>=r?e:Gr("0",r-e.length)+e}function Hm(t,r){var e=""+t;return e.length>=r?e:Gr(" ",r-e.length)+e}function Cf(t,r){var e=""+t;return e.length>=r?e:e+Gr(" ",r-e.length)}function iO(t,r){var e=""+Math.round(t);return e.length>=r?e:Gr("0",r-e.length)+e}function oO(t,r){var e=""+t;return e.length>=r?e:Gr("0",r-e.length)+e}var Zx=Math.pow(2,32);function jl(t,r){if(t>Zx||t<-Zx)return iO(t,r);var e=Math.round(t);return oO(e,r)}function Nf(t,r){return r=r||0,t.length>=7+r&&(t.charCodeAt(r)|32)===103&&(t.charCodeAt(r+1)|32)===101&&(t.charCodeAt(r+2)|32)===110&&(t.charCodeAt(r+3)|32)===101&&(t.charCodeAt(r+4)|32)===114&&(t.charCodeAt(r+5)|32)===97&&(t.charCodeAt(r+6)|32)===108}var Jx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],xp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function lO(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var rr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Qx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},cO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Of(t,r,e){for(var n=t<0?-1:1,a=t*n,o=0,s=1,l=0,c=1,i=0,u=0,p=Math.floor(a);i<r&&(p=Math.floor(a),l=p*s+o,u=p*i+c,!(a-p<5e-8));)a=1/(a-p),o=s,s=l,c=i,i=u;if(u>r&&(i>r?(u=c,l=o):(u=i,l=s)),!e)return[0,n*l,u];var f=Math.floor(n*l/u);return[f,n*l-f*u,u]}function Fo(t,r,e){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),o=0,s=[],l={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),r&&r.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)s=e?[1317,10,29]:[1900,2,29],o=3;else if(n===0)s=e?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],o=c.getDay(),n<60&&(o=(o+6)%7),e&&(o=mO(c,s))}return l.y=s[0],l.m=s[1],l.d=s[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=o,l}var u_=new Date(1899,11,31,0,0,0),uO=u_.getTime(),dO=new Date(1900,2,1,0,0,0);function d_(t,r){var e=t.getTime();return r?e-=1461*24*60*60*1e3:t>=dO&&(e+=24*60*60*1e3),(e-(uO+(t.getTimezoneOffset()-u_.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function qm(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function fO(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function hO(t){var r=t<0?12:11,e=qm(t.toFixed(12));return e.length<=r||(e=t.toPrecision(10),e.length<=r)?e:t.toExponential(5)}function pO(t){var r=qm(t.toFixed(11));return r.length>(t<0?12:11)||r==="0"||r==="-0"?t.toPrecision(6):r}function ju(t){var r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),e;return r>=-4&&r<=-1?e=t.toPrecision(10+r):Math.abs(r)<=9?e=hO(t):r===10?e=t.toFixed(10).substr(0,12):e=pO(t),qm(fO(e.toUpperCase()))}function Bo(t,r){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):ju(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return $a(14,d_(t,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+t)}function mO(t,r){r[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}function gO(t,r,e,n){var a="",o=0,s=0,l=e.y,c,i=0;switch(t){case 98:l=e.y+543;case 121:switch(r.length){case 1:case 2:c=l%100,i=2;break;default:c=l%1e4,i=4;break}break;case 109:switch(r.length){case 1:case 2:c=e.m,i=r.length;break;case 3:return xp[e.m-1][1];case 5:return xp[e.m-1][0];default:return xp[e.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=e.d,i=r.length;break;case 3:return Jx[e.q][0];default:return Jx[e.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(e.H+11)%12,i=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=e.H,i=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=e.M,i=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return e.u===0&&(r=="s"||r=="ss")?cs(e.S,r.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,o=Math.round(s*(e.S+e.u)),o>=60*s&&(o=0),r==="s"?o===0?"0":""+o/s:(a=cs(o,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=e.D*24+e.H;break;case"[m]":case"[mm]":c=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":c=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+r}i=r.length===3?1:2;break;case 101:c=l,i=1;break}var u=i>0?cs(c,i):"";return u}function Gi(t){var r=3;if(t.length<=r)return t;for(var e=t.length%r,n=t.substr(0,e);e!=t.length;e+=r)n+=(n.length>0?",":"")+t.substr(e,r);return n}var f_=/%/g;function vO(t,r,e){var n=r.replace(f_,""),a=r.length-n.length;return ai(t,n,e*Math.pow(10,2*a))+Gr("%",a)}function bO(t,r,e){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return ai(t,r.substr(0,n),e/Math.pow(10,3*(r.length-n)))}function h_(t,r){var e,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+h_(t,-r);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%a;if(o<0&&(o+=a),e=(r/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),e.indexOf("e")===-1){var s=Math.floor(Math.log(r)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+o):e+="E+"+(s-o);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,a)+"."+e.substr(2+a),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,i,u){return c+i+u.substr(0,(a+o)%a)+"."+u.substr(o)+"E"})}else e=r.toExponential(n);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var p_=/# (\?+)( ?)\/( ?)(\d+)/;function xO(t,r,e){var n=parseInt(t[4],10),a=Math.round(r*n),o=Math.floor(a/n),s=a-o*n,l=n;return e+(o===0?"":""+o)+" "+(s===0?Gr(" ",t[1].length+1+t[4].length):Hm(s,t[1].length)+t[2]+"/"+t[3]+cs(l,t[4].length))}function yO(t,r,e){return e+(r===0?"":""+r)+Gr(" ",t[1].length+2+t[4].length)}var m_=/^#*0*\.([0#]+)/,g_=/\).*[0#]/,v_=/\(###\) ###\\?-####/;function Yn(t){for(var r="",e,n=0;n!=t.length;++n)switch(e=t.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(e)}return r}function e2(t,r){var e=Math.pow(10,r);return""+Math.round(t*e)/e}function t2(t,r){var e=t-Math.floor(t),n=Math.pow(10,r);return r<(""+Math.round(e*n)).length?0:Math.round(e*n)}function wO(t,r){return r<(""+Math.round((t-Math.floor(t))*Math.pow(10,r))).length?1:0}function _O(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ma(t,r,e){if(t.charCodeAt(0)===40&&!r.match(g_)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Ma("n",n,e):"("+Ma("n",n,-e)+")"}if(r.charCodeAt(r.length-1)===44)return bO(t,r,e);if(r.indexOf("%")!==-1)return vO(t,r,e);if(r.indexOf("E")!==-1)return h_(r,e);if(r.charCodeAt(0)===36)return"$"+Ma(t,r.substr(r.charAt(1)==" "?2:1),e);var a,o,s,l,c=Math.abs(e),i=e<0?"-":"";if(r.match(/^00+$/))return i+jl(c,r.length);if(r.match(/^[#?]+$/))return a=jl(e,0),a==="0"&&(a=""),a.length>r.length?a:Yn(r.substr(0,r.length-a.length))+a;if(o=r.match(p_))return xO(o,c,i);if(r.match(/^#+0+$/))return i+jl(c,r.length-r.indexOf("0"));if(o=r.match(m_))return a=e2(e,o[1].length).replace(/^([^\.]+)$/,"$1."+Yn(o[1])).replace(/\.$/,"."+Yn(o[1])).replace(/\.(\d*)$/,function(v,b){return"."+b+Gr("0",Yn(o[1]).length-b.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return i+e2(c,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return i+Gi(jl(c,0));if(o=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Ma(t,r,-e):Gi(""+(Math.floor(e)+wO(e,o[1].length)))+"."+cs(t2(e,o[1].length),o[1].length);if(o=r.match(/^#,#*,#0/))return Ma(t,r.replace(/^#,#*,/,""),e);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Wl(Ma(t,r.replace(/[\\-]/g,""),e)),s=0,Wl(Wl(r.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<a.length?a.charAt(s++):v==="0"?"0":""}));if(r.match(v_))return a=Ma(t,"##########",e),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),l=Of(c,Math.pow(10,s)-1,!1),a=""+i,u=ai("n",o[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+o[2]+"/"+o[3],u=Cf(l[2],s),u.length<o[4].length&&(u=Yn(o[4].substr(o[4].length-u.length))+u),a+=u,a;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),l=Of(c,Math.pow(10,s)-1,!0),i+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Hm(l[1],s)+o[2]+"/"+o[3]+Cf(l[2],s):Gr(" ",2*s+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return a=jl(e,0),r.length<=a.length?a:Yn(r.substr(0,r.length-a.length))+a;if(o=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var p=r.indexOf(".")-s,f=r.length-a.length-p;return Yn(r.substr(0,p)+a+r.substr(r.length-f))}if(o=r.match(/^00,000\.([#0]*0)$/))return s=t2(e,o[1].length),e<0?"-"+Ma(t,r,-e):Gi(_O(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?cs(0,3-v.length):"")+v})+"."+cs(s,o[1].length);switch(r){case"###,##0.00":return Ma(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var h=Gi(jl(c,0));return h!=="0"?i+h:"";case"###,###.00":return Ma(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Ma(t,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function SO(t,r,e){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return ai(t,r.substr(0,n),e/Math.pow(10,3*(r.length-n)))}function kO(t,r,e){var n=r.replace(f_,""),a=r.length-n.length;return ai(t,n,e*Math.pow(10,2*a))+Gr("%",a)}function b_(t,r){var e,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+b_(t,-r);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%a;if(o<0&&(o+=a),e=(r/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),!e.match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+o):e+="E+"+(s-o),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,i,u){return c+i+u.substr(0,(a+o)%a)+"."+u.substr(o)+"E"})}else e=r.toExponential(n);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function _s(t,r,e){if(t.charCodeAt(0)===40&&!r.match(g_)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?_s("n",n,e):"("+_s("n",n,-e)+")"}if(r.charCodeAt(r.length-1)===44)return SO(t,r,e);if(r.indexOf("%")!==-1)return kO(t,r,e);if(r.indexOf("E")!==-1)return b_(r,e);if(r.charCodeAt(0)===36)return"$"+_s(t,r.substr(r.charAt(1)==" "?2:1),e);var a,o,s,l,c=Math.abs(e),i=e<0?"-":"";if(r.match(/^00+$/))return i+cs(c,r.length);if(r.match(/^[#?]+$/))return a=""+e,e===0&&(a=""),a.length>r.length?a:Yn(r.substr(0,r.length-a.length))+a;if(o=r.match(p_))return yO(o,c,i);if(r.match(/^#+0+$/))return i+cs(c,r.length-r.indexOf("0"));if(o=r.match(m_))return a=(""+e).replace(/^([^\.]+)$/,"$1."+Yn(o[1])).replace(/\.$/,"."+Yn(o[1])),a=a.replace(/\.(\d*)$/,function(v,b){return"."+b+Gr("0",Yn(o[1]).length-b.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return i+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return i+Gi(""+c);if(o=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+_s(t,r,-e):Gi(""+e)+"."+Gr("0",o[1].length);if(o=r.match(/^#,#*,#0/))return _s(t,r.replace(/^#,#*,/,""),e);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Wl(_s(t,r.replace(/[\\-]/g,""),e)),s=0,Wl(Wl(r.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<a.length?a.charAt(s++):v==="0"?"0":""}));if(r.match(v_))return a=_s(t,"##########",e),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),l=Of(c,Math.pow(10,s)-1,!1),a=""+i,u=ai("n",o[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+o[2]+"/"+o[3],u=Cf(l[2],s),u.length<o[4].length&&(u=Yn(o[4].substr(o[4].length-u.length))+u),a+=u,a;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),l=Of(c,Math.pow(10,s)-1,!0),i+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Hm(l[1],s)+o[2]+"/"+o[3]+Cf(l[2],s):Gr(" ",2*s+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return a=""+e,r.length<=a.length?a:Yn(r.substr(0,r.length-a.length))+a;if(o=r.match(/^([#0]+)\.([#0]+)$/)){a=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var p=r.indexOf(".")-s,f=r.length-a.length-p;return Yn(r.substr(0,p)+a+r.substr(r.length-f))}if(o=r.match(/^00,000\.([#0]*0)$/))return e<0?"-"+_s(t,r,-e):Gi(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?cs(0,3-v.length):"")+v})+"."+cs(0,o[1].length);switch(r){case"###,###":case"##,###":case"#,###":var h=Gi(""+c);return h!=="0"?i+h:"";default:if(r.match(/\.[0#?]*$/))return _s(t,r.slice(0,r.lastIndexOf(".")),e)+Yn(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function ai(t,r,e){return(e|0)===e?_s(t,r,e):Ma(t,r,e)}function EO(t){for(var r=[],e=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:e=!e;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=t.substr(a,n-a),a=n+1}if(r[r.length]=t.substr(a),e===!0)throw new Error("Format |"+t+"| unterminated string ");return r}var x_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function rc(t){for(var r=0,e="",n="";r<t.length;)switch(e=t.charAt(r)){case"G":Nf(t,r)&&(r+=6),r++;break;case'"':for(;t.charCodeAt(++r)!==34&&r<t.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(t.charAt(r+1)==="1"||t.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(r,3).toUpperCase()==="A/P"||t.substr(r,5).toUpperCase()==="AM/PM"||t.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(n=e;t.charAt(r++)!=="]"&&r<t.length;)n+=t.charAt(r);if(n.match(x_))return!0;break;case".":case"0":case"#":for(;r<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++r))>-1||e=="\\"&&t.charAt(r+1)=="-"&&"0#".indexOf(t.charAt(r+2))>-1););break;case"?":for(;t.charAt(++r)===e;);break;case"*":++r,(t.charAt(r)==" "||t.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<t.length&&"0123456789".indexOf(t.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function TO(t,r,e,n){for(var a=[],o="",s=0,l="",c="t",i,u,p,f="H";s<t.length;)switch(l=t.charAt(s)){case"G":if(!Nf(t,s))throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(o="";(p=t.charCodeAt(++s))!==34&&s<t.length;)o+=String.fromCharCode(p);a[a.length]={t:"t",v:o},++s;break;case"\\":var h=t.charAt(++s),v=h==="("||h===")"?h:"t";a[a.length]={t:v,v:h},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:r},++s;break;case"B":case"b":if(t.charAt(s+1)==="1"||t.charAt(s+1)==="2"){if(i==null&&(i=Fo(r,e,t.charAt(s+1)==="2"),i==null))return"";a[a.length]={t:"X",v:t.substr(s,2)},c=l,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||i==null&&(i=Fo(r,e),i==null))return"";for(o=l;++s<t.length&&t.charAt(s).toLowerCase()===l;)o+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=f),a[a.length]={t:l,v:o},c=l;break;case"A":case"a":case"":var b={t:l,v:l};if(i==null&&(i=Fo(r,e)),t.substr(s,3).toUpperCase()==="A/P"?(i!=null&&(b.v=i.H>=12?"P":"A"),b.t="T",f="h",s+=3):t.substr(s,5).toUpperCase()==="AM/PM"?(i!=null&&(b.v=i.H>=12?"PM":"AM"),b.t="T",s+=5,f="h"):t.substr(s,5).toUpperCase()==="/"?(i!=null&&(b.v=i.H>=12?"":""),b.t="T",s+=5,f="h"):(b.t="t",++s),i==null&&b.t==="T")return"";a[a.length]=b,c=l;break;case"[":for(o=l;t.charAt(s++)!=="]"&&s<t.length;)o+=t.charAt(s);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(x_)){if(i==null&&(i=Fo(r,e),i==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},c=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",rc(t)||(a[a.length]={t:"t",v:o}));break;case".":if(i!=null){for(o=l;++s<t.length&&(l=t.charAt(s))==="0";)o+=l;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=l;++s<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(s))>-1;)o+=l;a[a.length]={t:"n",v:o};break;case"?":for(o=l;t.charAt(++s)===l;)o+=l;a[a.length]={t:l,v:o},c=l;break;case"*":++s,(t.charAt(s)==" "||t.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=l;s<t.length&&"0123456789".indexOf(t.charAt(++s))>-1;)o+=t.charAt(s);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:l,v:l},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"t",v:l},++s;break}var g=0,x=0,y;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=f,c="h",g<1&&(g=1);break;case"s":(y=a[s].v.match(/\.0+$/))&&(x=Math.max(x,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=a[s].t;break;case"m":c==="s"&&(a[s].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&a[s].v.match(/[Hh]/)&&(g=1),g<2&&a[s].v.match(/[Mm]/)&&(g=2),g<3&&a[s].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M),i.M>=60&&(i.M=0,++i.H);break;case 2:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M);break}var E="",N;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=gO(a[s].t.charCodeAt(0),a[s].v,i,x),a[s].t="t";break;case"n":case"?":for(N=s+1;a[N]!=null&&((l=a[N].t)==="?"||l==="D"||(l===" "||l==="t")&&a[N+1]!=null&&(a[N+1].t==="?"||a[N+1].t==="t"&&a[N+1].v==="/")||a[s].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[N].v==="/"||a[N].v===" "&&a[N+1]!=null&&a[N+1].t=="?"));)a[s].v+=a[N].v,a[N]={v:"",t:";"},++N;E+=a[s].v,s=N-1;break;case"G":a[s].t="t",a[s].v=Bo(r,e);break}var I="",L,H;if(E.length>0){E.charCodeAt(0)==40?(L=r<0&&E.charCodeAt(0)===45?-r:r,H=ai("n",E,L)):(L=r<0&&n>1?-r:r,H=ai("n",E,L),L<0&&a[0]&&a[0].t=="t"&&(H=H.substr(1),a[0].v="-"+a[0].v)),N=H.length-1;var V=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){V=s;break}var q=a.length;if(V===a.length&&H.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(N>=a[s].v.length-1?(N-=a[s].v.length,a[s].v=H.substr(N+1,a[s].v.length)):N<0?a[s].v="":(a[s].v=H.substr(0,N+1),N=-1),a[s].t="t",q=s);N>=0&&q<a.length&&(a[q].v=H.substr(0,N+1)+a[q].v)}else if(V!==a.length&&H.indexOf("E")===-1){for(N=H.indexOf(".")-1,s=V;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(u=a[s].v.indexOf(".")>-1&&s===V?a[s].v.indexOf(".")-1:a[s].v.length-1,I=a[s].v.substr(u+1);u>=0;--u)N>=0&&(a[s].v.charAt(u)==="0"||a[s].v.charAt(u)==="#")&&(I=H.charAt(N--)+I);a[s].v=I,a[s].t="t",q=s}for(N>=0&&q<a.length&&(a[q].v=H.substr(0,N+1)+a[q].v),N=H.indexOf(".")+1,s=V;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==V)){for(u=a[s].v.indexOf(".")>-1&&s===V?a[s].v.indexOf(".")+1:0,I=a[s].v.substr(0,u);u<a[s].v.length;++u)N<H.length&&(I+=H.charAt(N++));a[s].v=I,a[s].t="t",q=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(L=n>1&&r<0&&s>0&&a[s-1].v==="-"?-r:r,a[s].v=ai(a[s].t,a[s].v,L),a[s].t="t");var K="";for(s=0;s!==a.length;++s)a[s]!=null&&(K+=a[s].v);return K}var r2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function n2(t,r){if(r==null)return!1;var e=parseFloat(r[2]);switch(r[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0;break}return!1}function AO(t,r){var e=EO(t),n=e.length,a=e[n-1].indexOf("@");if(n<4&&a>-1&&--n,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof r!="number")return[4,e.length===4||a>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=a>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=a>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=a>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var o=r>0?e[0]:r<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[n,o];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var s=e[0].match(r2),l=e[1].match(r2);return n2(r,s)?[n,e[0]]:n2(r,l)?[n,e[1]]:[n,e[s!=null&&l!=null?2:1]]}return[n,o]}function $a(t,r,e){e==null&&(e={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&e.dateNF?n=e.dateNF:n=t;break;case"number":t==14&&e.dateNF?n=e.dateNF:n=(e.table!=null?e.table:rr)[t],n==null&&(n=e.table&&e.table[Qx[t]]||rr[Qx[t]]),n==null&&(n=cO[t]||"General");break}if(Nf(n,0))return Bo(r,e);r instanceof Date&&(r=d_(r,e.date1904));var a=AO(n,r);if(Nf(a[1]))return Bo(r,e);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return TO(a[1],r,e,a[0])}function Po(t,r){if(typeof r!="number"){r=+r||-1;for(var e=0;e<392;++e){if(rr[e]==null){r<0&&(r=e);continue}if(rr[e]==t){r=e;break}}r<0&&(r=391)}return rr[r]=t,r}function y_(){rr=lO()}var CO={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},w_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function NO(t){var r=typeof t=="number"?rr[t]:t;return r=r.replace(w_,"(\\d+)"),new RegExp("^"+r+"$")}function OO(t,r,e){var n=-1,a=-1,o=-1,s=-1,l=-1,c=-1;(r.match(w_)||[]).forEach(function(p,f){var h=parseInt(e[f+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=h;break;case"d":o=h;break;case"h":s=h;break;case"s":c=h;break;case"m":s>=0?l=h:a=h;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var i=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);i.length==7&&(i="0"+i),i.length==8&&(i="20"+i);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&l==-1&&c==-1?i:n==-1&&a==-1&&o==-1?u:i+"T"+u}var jO=function(){var t={};t.version="1.2.0";function r(){for(var H=0,V=new Array(256),q=0;q!=256;++q)H=q,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,H=H&1?-306674912^H>>>1:H>>>1,V[q]=H;return typeof Int32Array<"u"?new Int32Array(V):V}var e=r();function n(H){var V=0,q=0,K=0,z=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(K=0;K!=256;++K)z[K]=H[K];for(K=0;K!=256;++K)for(q=H[K],V=256+K;V<4096;V+=256)q=z[V]=q>>>8^H[q&255];var W=[];for(K=1;K!=16;++K)W[K-1]=typeof Int32Array<"u"?z.subarray(K*256,K*256+256):z.slice(K*256,K*256+256);return W}var a=n(e),o=a[0],s=a[1],l=a[2],c=a[3],i=a[4],u=a[5],p=a[6],f=a[7],h=a[8],v=a[9],b=a[10],g=a[11],x=a[12],y=a[13],E=a[14];function N(H,V){for(var q=V^-1,K=0,z=H.length;K<z;)q=q>>>8^e[(q^H.charCodeAt(K++))&255];return~q}function I(H,V){for(var q=V^-1,K=H.length-15,z=0;z<K;)q=E[H[z++]^q&255]^y[H[z++]^q>>8&255]^x[H[z++]^q>>16&255]^g[H[z++]^q>>>24]^b[H[z++]]^v[H[z++]]^h[H[z++]]^f[H[z++]]^p[H[z++]]^u[H[z++]]^i[H[z++]]^c[H[z++]]^l[H[z++]]^s[H[z++]]^o[H[z++]]^e[H[z++]];for(K+=15;z<K;)q=q>>>8^e[(q^H[z++])&255];return~q}function L(H,V){for(var q=V^-1,K=0,z=H.length,W=0,D=0;K<z;)W=H.charCodeAt(K++),W<128?q=q>>>8^e[(q^W)&255]:W<2048?(q=q>>>8^e[(q^(192|W>>6&31))&255],q=q>>>8^e[(q^(128|W&63))&255]):W>=55296&&W<57344?(W=(W&1023)+64,D=H.charCodeAt(K++)&1023,q=q>>>8^e[(q^(240|W>>8&7))&255],q=q>>>8^e[(q^(128|W>>2&63))&255],q=q>>>8^e[(q^(128|D>>6&15|(W&3)<<4))&255],q=q>>>8^e[(q^(128|D&63))&255]):(q=q>>>8^e[(q^(224|W>>12&15))&255],q=q>>>8^e[(q^(128|W>>6&63))&255],q=q>>>8^e[(q^(128|W&63))&255]);return~q}return t.table=e,t.bstr=N,t.buf=I,t.str=L,t}(),hr=function(){var r={};r.version="1.2.1";function e(ie,be){for(var ue=ie.split("/"),me=be.split("/"),ve=0,ge=0,Fe=Math.min(ue.length,me.length);ve<Fe;++ve){if(ge=ue[ve].length-me[ve].length)return ge;if(ue[ve]!=me[ve])return ue[ve]<me[ve]?-1:1}return ue.length-me.length}function n(ie){if(ie.charAt(ie.length-1)=="/")return ie.slice(0,-1).indexOf("/")===-1?ie:n(ie.slice(0,-1));var be=ie.lastIndexOf("/");return be===-1?ie:ie.slice(0,be+1)}function a(ie){if(ie.charAt(ie.length-1)=="/")return a(ie.slice(0,-1));var be=ie.lastIndexOf("/");return be===-1?ie:ie.slice(be+1)}function o(ie,be){typeof be=="string"&&(be=new Date(be));var ue=be.getHours();ue=ue<<6|be.getMinutes(),ue=ue<<5|be.getSeconds()>>>1,ie.write_shift(2,ue);var me=be.getFullYear()-1980;me=me<<4|be.getMonth()+1,me=me<<5|be.getDate(),ie.write_shift(2,me)}function s(ie){var be=ie.read_shift(2)&65535,ue=ie.read_shift(2)&65535,me=new Date,ve=ue&31;ue>>>=5;var ge=ue&15;ue>>>=4,me.setMilliseconds(0),me.setFullYear(ue+1980),me.setMonth(ge-1),me.setDate(ve);var Fe=be&31;be>>>=5;var Ue=be&63;return be>>>=6,me.setHours(be),me.setMinutes(Ue),me.setSeconds(Fe<<1),me}function l(ie){jn(ie,0);for(var be={},ue=0;ie.l<=ie.length-4;){var me=ie.read_shift(2),ve=ie.read_shift(2),ge=ie.l+ve,Fe={};switch(me){case 21589:ue=ie.read_shift(1),ue&1&&(Fe.mtime=ie.read_shift(4)),ve>5&&(ue&2&&(Fe.atime=ie.read_shift(4)),ue&4&&(Fe.ctime=ie.read_shift(4))),Fe.mtime&&(Fe.mt=new Date(Fe.mtime*1e3));break}ie.l=ge,be[me]=Fe}return be}var c;function i(){return c||(c={})}function u(ie,be){if(ie[0]==80&&ie[1]==75)return Be(ie,be);if((ie[0]|32)==109&&(ie[1]|32)==105)return ke(ie,be);if(ie.length<512)throw new Error("CFB file size "+ie.length+" < 512");var ue=3,me=512,ve=0,ge=0,Fe=0,Ue=0,Me=0,Ve=[],ze=ie.slice(0,512);jn(ze,0);var xe=p(ze);switch(ue=xe[0],ue){case 3:me=512;break;case 4:me=4096;break;case 0:if(xe[1]==0)return Be(ie,be);default:throw new Error("Major Version: Expected 3 or 4 saw "+ue)}me!==512&&(ze=ie.slice(0,me),jn(ze,28));var Ee=ie.slice(0,me);f(ze,ue);var We=ze.read_shift(4,"i");if(ue===3&&We!==0)throw new Error("# Directory Sectors: Expected 0 saw "+We);ze.l+=4,Fe=ze.read_shift(4,"i"),ze.l+=4,ze.chk("00100000","Mini Stream Cutoff Size: "),Ue=ze.read_shift(4,"i"),ve=ze.read_shift(4,"i"),Me=ze.read_shift(4,"i"),ge=ze.read_shift(4,"i");for(var ce=-1,Te=0;Te<109&&(ce=ze.read_shift(4,"i"),!(ce<0));++Te)Ve[Te]=ce;var qe=h(ie,me);g(Me,ge,qe,me,Ve);var st=y(qe,Fe,Ve,me);st[Fe].name="!Directory",ve>0&&Ue!==D&&(st[Ue].name="!MiniFAT"),st[Ve[0]].name="!FAT",st.fat_addrs=Ve,st.ssz=me;var Et={},gt=[],kt=[],Zt=[];E(Fe,st,qe,gt,ve,Et,kt,Ue),v(kt,Zt,gt),gt.shift();var Ut={FileIndex:kt,FullPaths:Zt};return be&&be.raw&&(Ut.raw={header:Ee,sectors:qe}),Ut}function p(ie){if(ie[ie.l]==80&&ie[ie.l+1]==75)return[0,0];ie.chk(M,"Header Signature: "),ie.l+=16;var be=ie.read_shift(2,"u");return[ie.read_shift(2,"u"),be]}function f(ie,be){var ue=9;switch(ie.l+=2,ue=ie.read_shift(2)){case 9:if(be!=3)throw new Error("Sector Shift: Expected 9 saw "+ue);break;case 12:if(be!=4)throw new Error("Sector Shift: Expected 12 saw "+ue);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ue)}ie.chk("0600","Mini Sector Shift: "),ie.chk("000000000000","Reserved: ")}function h(ie,be){for(var ue=Math.ceil(ie.length/be)-1,me=[],ve=1;ve<ue;++ve)me[ve-1]=ie.slice(ve*be,(ve+1)*be);return me[ue-1]=ie.slice(ue*be),me}function v(ie,be,ue){for(var me=0,ve=0,ge=0,Fe=0,Ue=0,Me=ue.length,Ve=[],ze=[];me<Me;++me)Ve[me]=ze[me]=me,be[me]=ue[me];for(;Ue<ze.length;++Ue)me=ze[Ue],ve=ie[me].L,ge=ie[me].R,Fe=ie[me].C,Ve[me]===me&&(ve!==-1&&Ve[ve]!==ve&&(Ve[me]=Ve[ve]),ge!==-1&&Ve[ge]!==ge&&(Ve[me]=Ve[ge])),Fe!==-1&&(Ve[Fe]=me),ve!==-1&&me!=Ve[me]&&(Ve[ve]=Ve[me],ze.lastIndexOf(ve)<Ue&&ze.push(ve)),ge!==-1&&me!=Ve[me]&&(Ve[ge]=Ve[me],ze.lastIndexOf(ge)<Ue&&ze.push(ge));for(me=1;me<Me;++me)Ve[me]===me&&(ge!==-1&&Ve[ge]!==ge?Ve[me]=Ve[ge]:ve!==-1&&Ve[ve]!==ve&&(Ve[me]=Ve[ve]));for(me=1;me<Me;++me)if(ie[me].type!==0){if(Ue=me,Ue!=Ve[Ue])do Ue=Ve[Ue],be[me]=be[Ue]+"/"+be[me];while(Ue!==0&&Ve[Ue]!==-1&&Ue!=Ve[Ue]);Ve[me]=-1}for(be[0]+="/",me=1;me<Me;++me)ie[me].type!==2&&(be[me]+="/")}function b(ie,be,ue){for(var me=ie.start,ve=ie.size,ge=[],Fe=me;ue&&ve>0&&Fe>=0;)ge.push(be.slice(Fe*W,Fe*W+W)),ve-=W,Fe=Do(ue,Fe*4);return ge.length===0?vn(0):qi(ge).slice(0,ie.size)}function g(ie,be,ue,me,ve){var ge=D;if(ie===D){if(be!==0)throw new Error("DIFAT chain shorter than expected")}else if(ie!==-1){var Fe=ue[ie],Ue=(me>>>2)-1;if(!Fe)return;for(var Me=0;Me<Ue&&(ge=Do(Fe,Me*4))!==D;++Me)ve.push(ge);g(Do(Fe,me-4),be-1,ue,me,ve)}}function x(ie,be,ue,me,ve){var ge=[],Fe=[];ve||(ve=[]);var Ue=me-1,Me=0,Ve=0;for(Me=be;Me>=0;){ve[Me]=!0,ge[ge.length]=Me,Fe.push(ie[Me]);var ze=ue[Math.floor(Me*4/me)];if(Ve=Me*4&Ue,me<4+Ve)throw new Error("FAT boundary crossed: "+Me+" 4 "+me);if(!ie[ze])break;Me=Do(ie[ze],Ve)}return{nodes:ge,data:h2([Fe])}}function y(ie,be,ue,me){var ve=ie.length,ge=[],Fe=[],Ue=[],Me=[],Ve=me-1,ze=0,xe=0,Ee=0,We=0;for(ze=0;ze<ve;++ze)if(Ue=[],Ee=ze+be,Ee>=ve&&(Ee-=ve),!Fe[Ee]){Me=[];var ce=[];for(xe=Ee;xe>=0;){ce[xe]=!0,Fe[xe]=!0,Ue[Ue.length]=xe,Me.push(ie[xe]);var Te=ue[Math.floor(xe*4/me)];if(We=xe*4&Ve,me<4+We)throw new Error("FAT boundary crossed: "+xe+" 4 "+me);if(!ie[Te]||(xe=Do(ie[Te],We),ce[xe]))break}ge[Ee]={nodes:Ue,data:h2([Me])}}return ge}function E(ie,be,ue,me,ve,ge,Fe,Ue){for(var Me=0,Ve=me.length?2:0,ze=be[ie].data,xe=0,Ee=0,We;xe<ze.length;xe+=128){var ce=ze.slice(xe,xe+128);jn(ce,64),Ee=ce.read_shift(2),We=Km(ce,0,Ee-Ve),me.push(We);var Te={name:We,type:ce.read_shift(1),color:ce.read_shift(1),L:ce.read_shift(4,"i"),R:ce.read_shift(4,"i"),C:ce.read_shift(4,"i"),clsid:ce.read_shift(16),state:ce.read_shift(4,"i"),start:0,size:0},qe=ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2);qe!==0&&(Te.ct=N(ce,ce.l-8));var st=ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2);st!==0&&(Te.mt=N(ce,ce.l-8)),Te.start=ce.read_shift(4,"i"),Te.size=ce.read_shift(4,"i"),Te.size<0&&Te.start<0&&(Te.size=Te.type=0,Te.start=D,Te.name=""),Te.type===5?(Me=Te.start,ve>0&&Me!==D&&(be[Me].name="!StreamData")):Te.size>=4096?(Te.storage="fat",be[Te.start]===void 0&&(be[Te.start]=x(ue,Te.start,be.fat_addrs,be.ssz)),be[Te.start].name=Te.name,Te.content=be[Te.start].data.slice(0,Te.size)):(Te.storage="minifat",Te.size<0?Te.size=0:Me!==D&&Te.start!==D&&be[Me]&&(Te.content=b(Te,be[Me].data,(be[Ue]||{}).data))),Te.content&&jn(Te.content,0),ge[We]=Te,Fe.push(Te)}}function N(ie,be){return new Date((ba(ie,be+4)/1e7*Math.pow(2,32)+ba(ie,be)/1e7-11644473600)*1e3)}function I(ie,be){return i(),u(c.readFileSync(ie),be)}function L(ie,be){var ue=be&&be.type;switch(ue||dr&&Buffer.isBuffer(ie)&&(ue="buffer"),ue||"base64"){case"file":return I(ie,be);case"base64":return u(ss(Sa(ie)),be);case"binary":return u(ss(ie),be)}return u(ie,be)}function H(ie,be){var ue=be||{},me=ue.root||"Root Entry";if(ie.FullPaths||(ie.FullPaths=[]),ie.FileIndex||(ie.FileIndex=[]),ie.FullPaths.length!==ie.FileIndex.length)throw new Error("inconsistent CFB structure");ie.FullPaths.length===0&&(ie.FullPaths[0]=me+"/",ie.FileIndex[0]={name:me,type:5}),ue.CLSID&&(ie.FileIndex[0].clsid=ue.CLSID),V(ie)}function V(ie){var be="Sh33tJ5";if(!hr.find(ie,"/"+be)){var ue=vn(4);ue[0]=55,ue[1]=ue[3]=50,ue[2]=54,ie.FileIndex.push({name:be,type:2,content:ue,size:4,L:69,R:69,C:69}),ie.FullPaths.push(ie.FullPaths[0]+be),q(ie)}}function q(ie,be){H(ie);for(var ue=!1,me=!1,ve=ie.FullPaths.length-1;ve>=0;--ve){var ge=ie.FileIndex[ve];switch(ge.type){case 0:me?ue=!0:(ie.FileIndex.pop(),ie.FullPaths.pop());break;case 1:case 2:case 5:me=!0,isNaN(ge.R*ge.L*ge.C)&&(ue=!0),ge.R>-1&&ge.L>-1&&ge.R==ge.L&&(ue=!0);break;default:ue=!0;break}}if(!(!ue&&!be)){var Fe=new Date(1987,1,19),Ue=0,Me=Object.create?Object.create(null):{},Ve=[];for(ve=0;ve<ie.FullPaths.length;++ve)Me[ie.FullPaths[ve]]=!0,ie.FileIndex[ve].type!==0&&Ve.push([ie.FullPaths[ve],ie.FileIndex[ve]]);for(ve=0;ve<Ve.length;++ve){var ze=n(Ve[ve][0]);me=Me[ze],me||(Ve.push([ze,{name:a(ze).replace("/",""),type:1,clsid:w,ct:Fe,mt:Fe,content:null}]),Me[ze]=!0)}for(Ve.sort(function(We,ce){return e(We[0],ce[0])}),ie.FullPaths=[],ie.FileIndex=[],ve=0;ve<Ve.length;++ve)ie.FullPaths[ve]=Ve[ve][0],ie.FileIndex[ve]=Ve[ve][1];for(ve=0;ve<Ve.length;++ve){var xe=ie.FileIndex[ve],Ee=ie.FullPaths[ve];if(xe.name=a(Ee).replace("/",""),xe.L=xe.R=xe.C=-(xe.color=1),xe.size=xe.content?xe.content.length:0,xe.start=0,xe.clsid=xe.clsid||w,ve===0)xe.C=Ve.length>1?1:-1,xe.size=0,xe.type=5;else if(Ee.slice(-1)=="/"){for(Ue=ve+1;Ue<Ve.length&&n(ie.FullPaths[Ue])!=Ee;++Ue);for(xe.C=Ue>=Ve.length?-1:Ue,Ue=ve+1;Ue<Ve.length&&n(ie.FullPaths[Ue])!=n(Ee);++Ue);xe.R=Ue>=Ve.length?-1:Ue,xe.type=1}else n(ie.FullPaths[ve+1]||"")==n(Ee)&&(xe.R=ve+1),xe.type=2}}}function K(ie,be){var ue=be||{};if(ue.fileType=="mad")return De(ie,ue);switch(q(ie),ue.fileType){case"zip":return et(ie,ue)}var me=function(We){for(var ce=0,Te=0,qe=0;qe<We.FileIndex.length;++qe){var st=We.FileIndex[qe];if(st.content){var Et=st.content.length;Et>0&&(Et<4096?ce+=Et+63>>6:Te+=Et+511>>9)}}for(var gt=We.FullPaths.length+3>>2,kt=ce+7>>3,Zt=ce+127>>7,Ut=kt+Te+gt+Zt,zt=Ut+127>>7,It=zt<=109?0:Math.ceil((zt-109)/127);Ut+zt+It+127>>7>zt;)It=++zt<=109?0:Math.ceil((zt-109)/127);var er=[1,It,zt,Zt,gt,Te,ce,0];return We.FileIndex[0].size=ce<<6,er[7]=(We.FileIndex[0].start=er[0]+er[1]+er[2]+er[3]+er[4]+er[5])+(er[6]+7>>3),er}(ie),ve=vn(me[7]<<9),ge=0,Fe=0;{for(ge=0;ge<8;++ge)ve.write_shift(1,C[ge]);for(ge=0;ge<8;++ge)ve.write_shift(2,0);for(ve.write_shift(2,62),ve.write_shift(2,3),ve.write_shift(2,65534),ve.write_shift(2,9),ve.write_shift(2,6),ge=0;ge<3;++ge)ve.write_shift(2,0);for(ve.write_shift(4,0),ve.write_shift(4,me[2]),ve.write_shift(4,me[0]+me[1]+me[2]+me[3]-1),ve.write_shift(4,0),ve.write_shift(4,4096),ve.write_shift(4,me[3]?me[0]+me[1]+me[2]-1:D),ve.write_shift(4,me[3]),ve.write_shift(-4,me[1]?me[0]-1:D),ve.write_shift(4,me[1]),ge=0;ge<109;++ge)ve.write_shift(-4,ge<me[2]?me[1]+ge:-1)}if(me[1])for(Fe=0;Fe<me[1];++Fe){for(;ge<236+Fe*127;++ge)ve.write_shift(-4,ge<me[2]?me[1]+ge:-1);ve.write_shift(-4,Fe===me[1]-1?D:Fe+1)}var Ue=function(We){for(Fe+=We;ge<Fe-1;++ge)ve.write_shift(-4,ge+1);We&&(++ge,ve.write_shift(-4,D))};for(Fe=ge=0,Fe+=me[1];ge<Fe;++ge)ve.write_shift(-4,T.DIFSECT);for(Fe+=me[2];ge<Fe;++ge)ve.write_shift(-4,T.FATSECT);Ue(me[3]),Ue(me[4]);for(var Me=0,Ve=0,ze=ie.FileIndex[0];Me<ie.FileIndex.length;++Me)ze=ie.FileIndex[Me],ze.content&&(Ve=ze.content.length,!(Ve<4096)&&(ze.start=Fe,Ue(Ve+511>>9)));for(Ue(me[6]+7>>3);ve.l&511;)ve.write_shift(-4,T.ENDOFCHAIN);for(Fe=ge=0,Me=0;Me<ie.FileIndex.length;++Me)ze=ie.FileIndex[Me],ze.content&&(Ve=ze.content.length,!(!Ve||Ve>=4096)&&(ze.start=Fe,Ue(Ve+63>>6)));for(;ve.l&511;)ve.write_shift(-4,T.ENDOFCHAIN);for(ge=0;ge<me[4]<<2;++ge){var xe=ie.FullPaths[ge];if(!xe||xe.length===0){for(Me=0;Me<17;++Me)ve.write_shift(4,0);for(Me=0;Me<3;++Me)ve.write_shift(4,-1);for(Me=0;Me<12;++Me)ve.write_shift(4,0);continue}ze=ie.FileIndex[ge],ge===0&&(ze.start=ze.size?ze.start-1:D);var Ee=ge===0&&ue.root||ze.name;if(Ve=2*(Ee.length+1),ve.write_shift(64,Ee,"utf16le"),ve.write_shift(2,Ve),ve.write_shift(1,ze.type),ve.write_shift(1,ze.color),ve.write_shift(-4,ze.L),ve.write_shift(-4,ze.R),ve.write_shift(-4,ze.C),ze.clsid)ve.write_shift(16,ze.clsid,"hex");else for(Me=0;Me<4;++Me)ve.write_shift(4,0);ve.write_shift(4,ze.state||0),ve.write_shift(4,0),ve.write_shift(4,0),ve.write_shift(4,0),ve.write_shift(4,0),ve.write_shift(4,ze.start),ve.write_shift(4,ze.size),ve.write_shift(4,0)}for(ge=1;ge<ie.FileIndex.length;++ge)if(ze=ie.FileIndex[ge],ze.size>=4096)if(ve.l=ze.start+1<<9,dr&&Buffer.isBuffer(ze.content))ze.content.copy(ve,ve.l,0,ze.size),ve.l+=ze.size+511&-512;else{for(Me=0;Me<ze.size;++Me)ve.write_shift(1,ze.content[Me]);for(;Me&511;++Me)ve.write_shift(1,0)}for(ge=1;ge<ie.FileIndex.length;++ge)if(ze=ie.FileIndex[ge],ze.size>0&&ze.size<4096)if(dr&&Buffer.isBuffer(ze.content))ze.content.copy(ve,ve.l,0,ze.size),ve.l+=ze.size+63&-64;else{for(Me=0;Me<ze.size;++Me)ve.write_shift(1,ze.content[Me]);for(;Me&63;++Me)ve.write_shift(1,0)}if(dr)ve.l=ve.length;else for(;ve.l<ve.length;)ve.write_shift(1,0);return ve}function z(ie,be){var ue=ie.FullPaths.map(function(Me){return Me.toUpperCase()}),me=ue.map(function(Me){var Ve=Me.split("/");return Ve[Ve.length-(Me.slice(-1)=="/"?2:1)]}),ve=!1;be.charCodeAt(0)===47?(ve=!0,be=ue[0].slice(0,-1)+be):ve=be.indexOf("/")!==-1;var ge=be.toUpperCase(),Fe=ve===!0?ue.indexOf(ge):me.indexOf(ge);if(Fe!==-1)return ie.FileIndex[Fe];var Ue=!ge.match(su);for(ge=ge.replace(Zn,""),Ue&&(ge=ge.replace(su,"!")),Fe=0;Fe<ue.length;++Fe)if((Ue?ue[Fe].replace(su,"!"):ue[Fe]).replace(Zn,"")==ge||(Ue?me[Fe].replace(su,"!"):me[Fe]).replace(Zn,"")==ge)return ie.FileIndex[Fe];return null}var W=64,D=-2,M="d0cf11e0a1b11ae1",C=[208,207,17,224,161,177,26,225],w="00000000000000000000000000000000",T={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:D,FREESECT:-1,HEADER_SIGNATURE:M,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:w,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function A(ie,be,ue){i();var me=K(ie,ue);c.writeFileSync(be,me)}function S(ie){for(var be=new Array(ie.length),ue=0;ue<ie.length;++ue)be[ue]=String.fromCharCode(ie[ue]);return be.join("")}function j(ie,be){var ue=K(ie,be);switch(be&&be.type||"buffer"){case"file":return i(),c.writeFileSync(be.filename,ue),ue;case"binary":return typeof ue=="string"?ue:S(ue);case"base64":return Xx(typeof ue=="string"?ue:S(ue));case"buffer":if(dr)return Buffer.isBuffer(ue)?ue:$o(ue);case"array":return typeof ue=="string"?ss(ue):ue}return ue}var B;function R(ie){try{var be=ie.InflateRaw,ue=new be;if(ue._processChunk(new Uint8Array([3,0]),ue._finishFlushFlag),ue.bytesRead)B=ie;else throw new Error("zlib does not expose bytesRead")}catch(me){console.error("cannot use native zlib: "+(me.message||me))}}function X(ie,be){if(!B)return ht(ie,be);var ue=B.InflateRaw,me=new ue,ve=me._processChunk(ie.slice(ie.l),me._finishFlushFlag);return ie.l+=me.bytesRead,ve}function Y(ie){return B?B.deflateRawSync(ie):ct(ie)}var ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function P(ie){var be=(ie<<1|ie<<11)&139536|(ie<<5|ie<<15)&558144;return(be>>16|be>>8|be)&255}for(var F=typeof Uint8Array<"u",Z=F?new Uint8Array(256):[],se=0;se<256;++se)Z[se]=P(se);function re(ie,be){var ue=Z[ie&255];return be<=8?ue>>>8-be:(ue=ue<<8|Z[ie>>8&255],be<=16?ue>>>16-be:(ue=ue<<8|Z[ie>>16&255],ue>>>24-be))}function ae(ie,be){var ue=be&7,me=be>>>3;return(ie[me]|(ue<=6?0:ie[me+1]<<8))>>>ue&3}function te(ie,be){var ue=be&7,me=be>>>3;return(ie[me]|(ue<=5?0:ie[me+1]<<8))>>>ue&7}function he(ie,be){var ue=be&7,me=be>>>3;return(ie[me]|(ue<=4?0:ie[me+1]<<8))>>>ue&15}function le(ie,be){var ue=be&7,me=be>>>3;return(ie[me]|(ue<=3?0:ie[me+1]<<8))>>>ue&31}function ne(ie,be){var ue=be&7,me=be>>>3;return(ie[me]|(ue<=1?0:ie[me+1]<<8))>>>ue&127}function de(ie,be,ue){var me=be&7,ve=be>>>3,ge=(1<<ue)-1,Fe=ie[ve]>>>me;return ue<8-me||(Fe|=ie[ve+1]<<8-me,ue<16-me)||(Fe|=ie[ve+2]<<16-me,ue<24-me)||(Fe|=ie[ve+3]<<24-me),Fe&ge}function fe(ie,be,ue){var me=be&7,ve=be>>>3;return me<=5?ie[ve]|=(ue&7)<<me:(ie[ve]|=ue<<me&255,ie[ve+1]=(ue&7)>>8-me),be+3}function Se(ie,be,ue){var me=be&7,ve=be>>>3;return ue=(ue&1)<<me,ie[ve]|=ue,be+1}function _e(ie,be,ue){var me=be&7,ve=be>>>3;return ue<<=me,ie[ve]|=ue&255,ue>>>=8,ie[ve+1]=ue,be+8}function Ce(ie,be,ue){var me=be&7,ve=be>>>3;return ue<<=me,ie[ve]|=ue&255,ue>>>=8,ie[ve+1]=ue&255,ie[ve+2]=ue>>>8,be+16}function Re(ie,be){var ue=ie.length,me=2*ue>be?2*ue:be+5,ve=0;if(ue>=be)return ie;if(dr){var ge=Kx(me);if(ie.copy)ie.copy(ge);else for(;ve<ie.length;++ve)ge[ve]=ie[ve];return ge}else if(F){var Fe=new Uint8Array(me);if(Fe.set)Fe.set(ie);else for(;ve<ue;++ve)Fe[ve]=ie[ve];return Fe}return ie.length=me,ie}function Pe(ie){for(var be=new Array(ie),ue=0;ue<ie;++ue)be[ue]=0;return be}function Ye(ie,be,ue){var me=1,ve=0,ge=0,Fe=0,Ue=0,Me=ie.length,Ve=F?new Uint16Array(32):Pe(32);for(ge=0;ge<32;++ge)Ve[ge]=0;for(ge=Me;ge<ue;++ge)ie[ge]=0;Me=ie.length;var ze=F?new Uint16Array(Me):Pe(Me);for(ge=0;ge<Me;++ge)Ve[ve=ie[ge]]++,me<ve&&(me=ve),ze[ge]=0;for(Ve[0]=0,ge=1;ge<=me;++ge)Ve[ge+16]=Ue=Ue+Ve[ge-1]<<1;for(ge=0;ge<Me;++ge)Ue=ie[ge],Ue!=0&&(ze[ge]=Ve[Ue+16]++);var xe=0;for(ge=0;ge<Me;++ge)if(xe=ie[ge],xe!=0)for(Ue=re(ze[ge],me)>>me-xe,Fe=(1<<me+4-xe)-1;Fe>=0;--Fe)be[Ue|Fe<<xe]=xe&15|ge<<4;return me}var at=F?new Uint16Array(512):Pe(512),tt=F?new Uint16Array(32):Pe(32);if(!F){for(var it=0;it<512;++it)at[it]=0;for(it=0;it<32;++it)tt[it]=0}(function(){for(var ie=[],be=0;be<32;be++)ie.push(5);Ye(ie,tt,32);var ue=[];for(be=0;be<=143;be++)ue.push(8);for(;be<=255;be++)ue.push(9);for(;be<=279;be++)ue.push(7);for(;be<=287;be++)ue.push(8);Ye(ue,at,288)})();var rt=function(){for(var be=F?new Uint8Array(32768):[],ue=0,me=0;ue<Q.length-1;++ue)for(;me<Q[ue+1];++me)be[me]=ue;for(;me<32768;++me)be[me]=29;var ve=F?new Uint8Array(259):[];for(ue=0,me=0;ue<U.length-1;++ue)for(;me<U[ue+1];++me)ve[me]=ue;function ge(Ue,Me){for(var Ve=0;Ve<Ue.length;){var ze=Math.min(65535,Ue.length-Ve),xe=Ve+ze==Ue.length;for(Me.write_shift(1,+xe),Me.write_shift(2,ze),Me.write_shift(2,~ze&65535);ze-- >0;)Me[Me.l++]=Ue[Ve++]}return Me.l}function Fe(Ue,Me){for(var Ve=0,ze=0,xe=F?new Uint16Array(32768):[];ze<Ue.length;){var Ee=Math.min(65535,Ue.length-ze);if(Ee<10){for(Ve=fe(Me,Ve,+(ze+Ee==Ue.length)),Ve&7&&(Ve+=8-(Ve&7)),Me.l=Ve/8|0,Me.write_shift(2,Ee),Me.write_shift(2,~Ee&65535);Ee-- >0;)Me[Me.l++]=Ue[ze++];Ve=Me.l*8;continue}Ve=fe(Me,Ve,+(ze+Ee==Ue.length)+2);for(var We=0;Ee-- >0;){var ce=Ue[ze];We=(We<<5^ce)&32767;var Te=-1,qe=0;if((Te=xe[We])&&(Te|=ze&-32768,Te>ze&&(Te-=32768),Te<ze))for(;Ue[Te+qe]==Ue[ze+qe]&&qe<250;)++qe;if(qe>2){ce=ve[qe],ce<=22?Ve=_e(Me,Ve,Z[ce+1]>>1)-1:(_e(Me,Ve,3),Ve+=5,_e(Me,Ve,Z[ce-23]>>5),Ve+=3);var st=ce<8?0:ce-4>>2;st>0&&(Ce(Me,Ve,qe-U[ce]),Ve+=st),ce=be[ze-Te],Ve=_e(Me,Ve,Z[ce]>>3),Ve-=3;var Et=ce<4?0:ce-2>>1;Et>0&&(Ce(Me,Ve,ze-Te-Q[ce]),Ve+=Et);for(var gt=0;gt<qe;++gt)xe[We]=ze&32767,We=(We<<5^Ue[ze])&32767,++ze;Ee-=qe-1}else ce<=143?ce=ce+48:Ve=Se(Me,Ve,1),Ve=_e(Me,Ve,Z[ce]),xe[We]=ze&32767,++ze}Ve=_e(Me,Ve,0)-1}return Me.l=(Ve+7)/8|0,Me.l}return function(Me,Ve){return Me.length<8?ge(Me,Ve):Fe(Me,Ve)}}();function ct(ie){var be=vn(50+Math.floor(ie.length*1.1)),ue=rt(ie,be);return be.slice(0,ue)}var Oe=F?new Uint16Array(32768):Pe(32768),pt=F?new Uint16Array(32768):Pe(32768),Je=F?new Uint16Array(128):Pe(128),ot=1,ut=1;function _t(ie,be){var ue=le(ie,be)+257;be+=5;var me=le(ie,be)+1;be+=5;var ve=he(ie,be)+4;be+=4;for(var ge=0,Fe=F?new Uint8Array(19):Pe(19),Ue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Me=1,Ve=F?new Uint8Array(8):Pe(8),ze=F?new Uint8Array(8):Pe(8),xe=Fe.length,Ee=0;Ee<ve;++Ee)Fe[ee[Ee]]=ge=te(ie,be),Me<ge&&(Me=ge),Ve[ge]++,be+=3;var We=0;for(Ve[0]=0,Ee=1;Ee<=Me;++Ee)ze[Ee]=We=We+Ve[Ee-1]<<1;for(Ee=0;Ee<xe;++Ee)(We=Fe[Ee])!=0&&(Ue[Ee]=ze[We]++);var ce=0;for(Ee=0;Ee<xe;++Ee)if(ce=Fe[Ee],ce!=0){We=Z[Ue[Ee]]>>8-ce;for(var Te=(1<<7-ce)-1;Te>=0;--Te)Je[We|Te<<ce]=ce&7|Ee<<3}var qe=[];for(Me=1;qe.length<ue+me;)switch(We=Je[ne(ie,be)],be+=We&7,We>>>=3){case 16:for(ge=3+ae(ie,be),be+=2,We=qe[qe.length-1];ge-- >0;)qe.push(We);break;case 17:for(ge=3+te(ie,be),be+=3;ge-- >0;)qe.push(0);break;case 18:for(ge=11+ne(ie,be),be+=7;ge-- >0;)qe.push(0);break;default:qe.push(We),Me<We&&(Me=We);break}var st=qe.slice(0,ue),Et=qe.slice(ue);for(Ee=ue;Ee<286;++Ee)st[Ee]=0;for(Ee=me;Ee<30;++Ee)Et[Ee]=0;return ot=Ye(st,Oe,286),ut=Ye(Et,pt,30),be}function vt(ie,be){if(ie[0]==3&&!(ie[1]&3))return[eo(be),2];for(var ue=0,me=0,ve=Kx(be||1<<18),ge=0,Fe=ve.length>>>0,Ue=0,Me=0;(me&1)==0;){if(me=te(ie,ue),ue+=3,me>>>1)me>>1==1?(Ue=9,Me=5):(ue=_t(ie,ue),Ue=ot,Me=ut);else{ue&7&&(ue+=8-(ue&7));var Ve=ie[ue>>>3]|ie[(ue>>>3)+1]<<8;if(ue+=32,Ve>0)for(!be&&Fe<ge+Ve&&(ve=Re(ve,ge+Ve),Fe=ve.length);Ve-- >0;)ve[ge++]=ie[ue>>>3],ue+=8;continue}for(;;){!be&&Fe<ge+32767&&(ve=Re(ve,ge+32767),Fe=ve.length);var ze=de(ie,ue,Ue),xe=me>>>1==1?at[ze]:Oe[ze];if(ue+=xe&15,xe>>>=4,(xe>>>8&255)===0)ve[ge++]=xe;else{if(xe==256)break;xe-=257;var Ee=xe<8?0:xe-4>>2;Ee>5&&(Ee=0);var We=ge+U[xe];Ee>0&&(We+=de(ie,ue,Ee),ue+=Ee),ze=de(ie,ue,Me),xe=me>>>1==1?tt[ze]:pt[ze],ue+=xe&15,xe>>>=4;var ce=xe<4?0:xe-2>>1,Te=Q[xe];for(ce>0&&(Te+=de(ie,ue,ce),ue+=ce),!be&&Fe<We&&(ve=Re(ve,We+100),Fe=ve.length);ge<We;)ve[ge]=ve[ge-Te],++ge}}}return be?[ve,ue+7>>>3]:[ve.slice(0,ge),ue+7>>>3]}function ht(ie,be){var ue=ie.slice(ie.l||0),me=vt(ue,be);return ie.l+=me[1],me[0]}function $e(ie,be){if(ie)typeof console<"u"&&console.error(be);else throw new Error(be)}function Be(ie,be){var ue=ie;jn(ue,0);var me=[],ve=[],ge={FileIndex:me,FullPaths:ve};H(ge,{root:be.root});for(var Fe=ue.length-4;(ue[Fe]!=80||ue[Fe+1]!=75||ue[Fe+2]!=5||ue[Fe+3]!=6)&&Fe>=0;)--Fe;ue.l=Fe+4,ue.l+=4;var Ue=ue.read_shift(2);ue.l+=6;var Me=ue.read_shift(4);for(ue.l=Me,Fe=0;Fe<Ue;++Fe){ue.l+=20;var Ve=ue.read_shift(4),ze=ue.read_shift(4),xe=ue.read_shift(2),Ee=ue.read_shift(2),We=ue.read_shift(2);ue.l+=8;var ce=ue.read_shift(4),Te=l(ue.slice(ue.l+xe,ue.l+xe+Ee));ue.l+=xe+Ee+We;var qe=ue.l;ue.l=ce+4,wt(ue,Ve,ze,ge,Te),ue.l=qe}return ge}function wt(ie,be,ue,me,ve){ie.l+=2;var ge=ie.read_shift(2),Fe=ie.read_shift(2),Ue=s(ie);if(ge&8257)throw new Error("Unsupported ZIP encryption");for(var Me=ie.read_shift(4),Ve=ie.read_shift(4),ze=ie.read_shift(4),xe=ie.read_shift(2),Ee=ie.read_shift(2),We="",ce=0;ce<xe;++ce)We+=String.fromCharCode(ie[ie.l++]);if(Ee){var Te=l(ie.slice(ie.l,ie.l+Ee));(Te[21589]||{}).mt&&(Ue=Te[21589].mt),((ve||{})[21589]||{}).mt&&(Ue=ve[21589].mt)}ie.l+=Ee;var qe=ie.slice(ie.l,ie.l+Ve);switch(Fe){case 8:qe=X(ie,ze);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Fe)}var st=!1;ge&8&&(Me=ie.read_shift(4),Me==134695760&&(Me=ie.read_shift(4),st=!0),Ve=ie.read_shift(4),ze=ie.read_shift(4)),Ve!=be&&$e(st,"Bad compressed size: "+be+" != "+Ve),ze!=ue&&$e(st,"Bad uncompressed size: "+ue+" != "+ze),xt(me,We,qe,{unsafe:!0,mt:Ue})}function et(ie,be){var ue=be||{},me=[],ve=[],ge=vn(1),Fe=ue.compression?8:0,Ue=0,Me=0,Ve=0,ze=0,xe=0,Ee=ie.FullPaths[0],We=Ee,ce=ie.FileIndex[0],Te=[],qe=0;for(Me=1;Me<ie.FullPaths.length;++Me)if(We=ie.FullPaths[Me].slice(Ee.length),ce=ie.FileIndex[Me],!(!ce.size||!ce.content||We=="Sh33tJ5")){var st=ze,Et=vn(We.length);for(Ve=0;Ve<We.length;++Ve)Et.write_shift(1,We.charCodeAt(Ve)&127);Et=Et.slice(0,Et.l),Te[xe]=jO.buf(ce.content,0);var gt=ce.content;Fe==8&&(gt=Y(gt)),ge=vn(30),ge.write_shift(4,67324752),ge.write_shift(2,20),ge.write_shift(2,Ue),ge.write_shift(2,Fe),ce.mt?o(ge,ce.mt):ge.write_shift(4,0),ge.write_shift(-4,Te[xe]),ge.write_shift(4,gt.length),ge.write_shift(4,ce.content.length),ge.write_shift(2,Et.length),ge.write_shift(2,0),ze+=ge.length,me.push(ge),ze+=Et.length,me.push(Et),ze+=gt.length,me.push(gt),ge=vn(46),ge.write_shift(4,33639248),ge.write_shift(2,0),ge.write_shift(2,20),ge.write_shift(2,Ue),ge.write_shift(2,Fe),ge.write_shift(4,0),ge.write_shift(-4,Te[xe]),ge.write_shift(4,gt.length),ge.write_shift(4,ce.content.length),ge.write_shift(2,Et.length),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(4,0),ge.write_shift(4,st),qe+=ge.l,ve.push(ge),qe+=Et.length,ve.push(Et),++xe}return ge=vn(22),ge.write_shift(4,101010256),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,xe),ge.write_shift(2,xe),ge.write_shift(4,qe),ge.write_shift(4,ze),ge.write_shift(2,0),qi([qi(me),qi(ve),ge])}var dt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function we(ie,be){if(ie.ctype)return ie.ctype;var ue=ie.name||"",me=ue.match(/\.([^\.]+)$/);return me&&dt[me[1]]||be&&(me=(ue=be).match(/[\.\\]([^\.\\])+$/),me&&dt[me[1]])?dt[me[1]]:"application/octet-stream"}function Ne(ie){for(var be=Xx(ie),ue=[],me=0;me<be.length;me+=76)ue.push(be.slice(me,me+76));return ue.join(`\r
`)+`\r
`}function lt(ie){var be=ie.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ve){var ze=Ve.charCodeAt(0).toString(16).toUpperCase();return"="+(ze.length==1?"0"+ze:ze)});be=be.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),be.charAt(0)==`
`&&(be="=0D"+be.slice(1)),be=be.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ue=[],me=be.split(`\r
`),ve=0;ve<me.length;++ve){var ge=me[ve];if(ge.length==0){ue.push("");continue}for(var Fe=0;Fe<ge.length;){var Ue=76,Me=ge.slice(Fe,Fe+Ue);Me.charAt(Ue-1)=="="?Ue--:Me.charAt(Ue-2)=="="?Ue-=2:Me.charAt(Ue-3)=="="&&(Ue-=3),Me=ge.slice(Fe,Fe+Ue),Fe+=Ue,Fe<ge.length&&(Me+="="),ue.push(Me)}}return ue.join(`\r
`)}function Ct(ie){for(var be=[],ue=0;ue<ie.length;++ue){for(var me=ie[ue];ue<=ie.length&&me.charAt(me.length-1)=="=";)me=me.slice(0,me.length-1)+ie[++ue];be.push(me)}for(var ve=0;ve<be.length;++ve)be[ve]=be[ve].replace(/[=][0-9A-Fa-f]{2}/g,function(ge){return String.fromCharCode(parseInt(ge.slice(1),16))});return ss(be.join(`\r
`))}function $t(ie,be,ue){for(var me="",ve="",ge="",Fe,Ue=0;Ue<10;++Ue){var Me=be[Ue];if(!Me||Me.match(/^\s*$/))break;var Ve=Me.match(/^(.*?):\s*([^\s].*)$/);if(Ve)switch(Ve[1].toLowerCase()){case"content-location":me=Ve[2].trim();break;case"content-type":ge=Ve[2].trim();break;case"content-transfer-encoding":ve=Ve[2].trim();break}}switch(++Ue,ve.toLowerCase()){case"base64":Fe=ss(Sa(be.slice(Ue).join("")));break;case"quoted-printable":Fe=Ct(be.slice(Ue));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ve)}var ze=xt(ie,me.slice(ue.length),Fe,{unsafe:!0});ge&&(ze.ctype=ge)}function ke(ie,be){if(S(ie.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ue=be&&be.root||"",me=(dr&&Buffer.isBuffer(ie)?ie.toString("binary"):S(ie)).split(`\r
`),ve=0,ge="";for(ve=0;ve<me.length;++ve)if(ge=me[ve],!!/^Content-Location:/i.test(ge)&&(ge=ge.slice(ge.indexOf("file")),ue||(ue=ge.slice(0,ge.lastIndexOf("/")+1)),ge.slice(0,ue.length)!=ue))for(;ue.length>0&&(ue=ue.slice(0,ue.length-1),ue=ue.slice(0,ue.lastIndexOf("/")+1),ge.slice(0,ue.length)!=ue););var Fe=(me[1]||"").match(/boundary="(.*?)"/);if(!Fe)throw new Error("MAD cannot find boundary");var Ue="--"+(Fe[1]||""),Me=[],Ve=[],ze={FileIndex:Me,FullPaths:Ve};H(ze);var xe,Ee=0;for(ve=0;ve<me.length;++ve){var We=me[ve];We!==Ue&&We!==Ue+"--"||(Ee++&&$t(ze,me.slice(xe,ve),ue),xe=ve)}return ze}function De(ie,be){var ue=be||{},me=ue.boundary||"SheetJS";me="------="+me;for(var ve=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+me.slice(2)+'"',"","",""],ge=ie.FullPaths[0],Fe=ge,Ue=ie.FileIndex[0],Me=1;Me<ie.FullPaths.length;++Me)if(Fe=ie.FullPaths[Me].slice(ge.length),Ue=ie.FileIndex[Me],!(!Ue.size||!Ue.content||Fe=="Sh33tJ5")){Fe=Fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(qe){return"_x"+qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(qe){return"_u"+qe.charCodeAt(0).toString(16)+"_"});for(var Ve=Ue.content,ze=dr&&Buffer.isBuffer(Ve)?Ve.toString("binary"):S(Ve),xe=0,Ee=Math.min(1024,ze.length),We=0,ce=0;ce<=Ee;++ce)(We=ze.charCodeAt(ce))>=32&&We<128&&++xe;var Te=xe>=Ee*4/5;ve.push(me),ve.push("Content-Location: "+(ue.root||"file:///C:/SheetJS/")+Fe),ve.push("Content-Transfer-Encoding: "+(Te?"quoted-printable":"base64")),ve.push("Content-Type: "+we(Ue,Fe)),ve.push(""),ve.push(Te?lt(ze):Ne(ze))}return ve.push(me+`--\r
`),ve.join(`\r
`)}function bt(ie){var be={};return H(be,ie),be}function xt(ie,be,ue,me){var ve=me&&me.unsafe;ve||H(ie);var ge=!ve&&hr.find(ie,be);if(!ge){var Fe=ie.FullPaths[0];be.slice(0,Fe.length)==Fe?Fe=be:(Fe.slice(-1)!="/"&&(Fe+="/"),Fe=(Fe+be).replace("//","/")),ge={name:a(be),type:2},ie.FileIndex.push(ge),ie.FullPaths.push(Fe),ve||hr.utils.cfb_gc(ie)}return ge.content=ue,ge.size=ue?ue.length:0,me&&(me.CLSID&&(ge.clsid=me.CLSID),me.mt&&(ge.mt=me.mt),me.ct&&(ge.ct=me.ct)),ge}function Ae(ie,be){H(ie);var ue=hr.find(ie,be);if(ue){for(var me=0;me<ie.FileIndex.length;++me)if(ie.FileIndex[me]==ue)return ie.FileIndex.splice(me,1),ie.FullPaths.splice(me,1),!0}return!1}function Le(ie,be,ue){H(ie);var me=hr.find(ie,be);if(me){for(var ve=0;ve<ie.FileIndex.length;++ve)if(ie.FileIndex[ve]==me)return ie.FileIndex[ve].name=a(ue),ie.FullPaths[ve]=ue,!0}return!1}function nt(ie){q(ie,!0)}return r.find=z,r.read=L,r.parse=u,r.write=j,r.writeFile=A,r.utils={cfb_new:bt,cfb_add:xt,cfb_del:Ae,cfb_mov:Le,cfb_gc:nt,ReadShift:uu,CheckField:V_,prep_blob:jn,bconcat:qi,use_zlib:R,_deflateRaw:ct,_inflateRaw:ht,consts:T},r}();function DO(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(t);r.open("r"),r.encoding="binary";var e=r.read();return r.close(),e}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ds(t){for(var r=Object.keys(t),e=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(t,r[n])&&e.push(r[n]);return e}function Wm(t){for(var r=[],e=Ds(t),n=0;n!==e.length;++n)r[t[e[n]]]=e[n];return r}var jf=new Date(1899,11,30,0,0,0);function Jn(t,r){var e=t.getTime(),n=jf.getTime()+(t.getTimezoneOffset()-jf.getTimezoneOffset())*6e4;return(e-n)/(24*60*60*1e3)}var __=new Date,MO=jf.getTime()+(__.getTimezoneOffset()-jf.getTimezoneOffset())*6e4,a2=__.getTimezoneOffset();function Zf(t){var r=new Date;return r.setTime(t*24*60*60*1e3+MO),r.getTimezoneOffset()!==a2&&r.setTime(r.getTime()+(r.getTimezoneOffset()-a2)*6e4),r}function RO(t){var r=0,e=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(e=1,o>3&&(n=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":e*=24;case"H":e*=60;case"M":if(n)e*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=e*parseInt(a[o],10)}return r}var s2=new Date("2017-02-19T19:06:09.000Z"),S_=isNaN(s2.getFullYear())?new Date("2/19/17"):s2,FO=S_.getFullYear()==2017;function kn(t,r){var e=new Date(t);if(FO)return r>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):r<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(t instanceof Date)return t;if(S_.getFullYear()==1917&&!isNaN(e.getFullYear())){var n=e.getFullYear();return t.indexOf(""+n)>-1||e.setFullYear(e.getFullYear()+100),e}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function Uo(t,r){if(dr&&Buffer.isBuffer(t)){if(r){if(t[0]==255&&t[1]==254)return ou(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ou(c_(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(t[0]==255&&t[1]==254)return ou(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ou(new TextDecoder("utf-16be").decode(t.slice(2)))}var e={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(o){return e[o]||o})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function Mn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var r={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=Mn(t[e]));return r}function Gr(t,r){for(var e="";e.length<r;)e+=t;return e}function us(t){var r=Number(t);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(t))return r;var e=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,o){return e=-e,o}),!isNaN(r=Number(n)))?r/e:r}var IO=["january","february","march","april","may","june","july","august","september","october","november","december"];function Zl(t){var r=new Date(t),e=new Date(NaN),n=r.getYear(),a=r.getMonth(),o=r.getDate();if(isNaN(o))return e;var s=t.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&IO.indexOf(s)==-1)return e}else if(s.match(/[a-z]/))return e;return n<0||n>8099?e:(a>0||o>1)&&n!=101?r:t.match(/[^-0-9:,\/\\]/)?e:r}var PO=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(e,n,a){if(t||typeof n=="string")return e.split(n);for(var o=e.split(n),s=[o[0]],l=1;l<o.length;++l)s.push(a),s.push(o[l]);return s}}();function k_(t){return t?t.content&&t.type?Uo(t.content,!0):t.data?au(t.data):t.asNodeBuffer&&dr?au(t.asNodeBuffer().toString("binary")):t.asBinary?au(t.asBinary()):t._data&&t._data.getContent?au(Uo(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function E_(t){if(!t)return null;if(t.data)return Gx(t.data);if(t.asNodeBuffer&&dr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var r=t._data.getContent();return typeof r=="string"?Gx(r):Array.prototype.slice.call(r)}return t.content&&t.type?t.content:null}function LO(t){return t&&t.name.slice(-4)===".bin"?E_(t):k_(t)}function Fa(t,r){for(var e=t.FullPaths||Ds(t.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),o=0;o<e.length;++o){var s=e[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return t.files?t.files[e[o]]:t.FileIndex[o]}return null}function Gm(t,r){var e=Fa(t,r);if(e==null)throw new Error("Cannot find file "+r+" in zip");return e}function on(t,r,e){if(!e)return LO(Gm(t,r));if(!r)return null;try{return on(t,r)}catch{return null}}function wa(t,r,e){if(!e)return k_(Gm(t,r));if(!r)return null;try{return wa(t,r)}catch{return null}}function BO(t,r,e){return E_(Gm(t,r))}function i2(t){for(var r=t.FullPaths||Ds(t.files),e=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&e.push(r[n].replace(/^Root Entry[\/]/,""));return e.sort()}function UO(t,r,e){if(t.FullPaths){if(typeof e=="string"){var n;return dr?n=$o(e):n=sO(e),hr.utils.cfb_add(t,r,n)}hr.utils.cfb_add(t,r,e)}else t.file(r,e)}function T_(t,r){switch(r.type){case"base64":return hr.read(t,{type:"base64"});case"binary":return hr.read(t,{type:"binary"});case"buffer":case"array":return hr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function iu(t,r){if(t.charAt(0)=="/")return t.slice(1);var e=r.split("/");r.slice(-1)!="/"&&e.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?e.pop():a!=="."&&e.push(a)}return e.join("/")}var A_=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,zO=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,o2=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,$O=/<[^>]*>/g,Hn=A_.match(o2)?o2:$O,VO=/<\w*:/,HO=/<(\/?)\w+:/;function Xt(t,r,e){for(var n={},a=0,o=0;a!==t.length&&!((o=t.charCodeAt(a))===32||o===10||o===13);++a);if(r||(n[0]=t.slice(0,a)),a===t.length)return n;var s=t.match(zO),l=0,c="",i=0,u="",p="",f=1;if(s)for(i=0;i!=s.length;++i){for(p=s[i],o=0;o!=p.length&&p.charCodeAt(o)!==61;++o);for(u=p.slice(0,o).trim();p.charCodeAt(o+1)==32;)++o;for(f=(a=p.charCodeAt(o+1))==34||a==39?1:0,c=p.slice(o+1+f,p.length-f),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,n[u.toLowerCase()]=c;else{var h=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(n[h]&&u.slice(l-3,l)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function Fs(t){return t.replace(HO,"<$1")}var C_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},qO=Wm(C_),vr=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function e(n){var a=n+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(t,function(l,c){return C_[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(r,function(l,c){return String.fromCharCode(parseInt(c,16))});var s=a.indexOf("]]>");return e(a.slice(0,o))+a.slice(o+9,s)+e(a.slice(s+3))}}(),WO=/[&<>'"]/g,GO=/[\u0000-\u001f]/g;function Ym(t){var r=t+"";return r.replace(WO,function(e){return qO[e]}).replace(/\n/g,"<br/>").replace(GO,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var l2=function(){var t=/&#(\d+);/g;function r(e,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,r)}}();function Lr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function yp(t){for(var r="",e=0,n=0,a=0,o=0,s=0,l=0;e<t.length;){if(n=t.charCodeAt(e++),n<128){r+=String.fromCharCode(n);continue}if(a=t.charCodeAt(e++),n>191&&n<224){s=(n&31)<<6,s|=a&63,r+=String.fromCharCode(s);continue}if(o=t.charCodeAt(e++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|o&63);continue}s=t.charCodeAt(e++),l=((n&7)<<18|(a&63)<<12|(o&63)<<6|s&63)-65536,r+=String.fromCharCode(55296+(l>>>10&1023)),r+=String.fromCharCode(56320+(l&1023))}return r}function c2(t){var r=eo(2*t.length),e,n,a=1,o=0,s=0,l;for(n=0;n<t.length;n+=a)a=1,(l=t.charCodeAt(n))<128?e=l:l<224?(e=(l&31)*64+(t.charCodeAt(n+1)&63),a=2):l<240?(e=(l&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,e=(l&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),e-=65536,s=55296+(e>>>10&1023),e=56320+(e&1023)),s!==0&&(r[o++]=s&255,r[o++]=s>>>8,s=0),r[o++]=e%256,r[o++]=e>>>8;return r.slice(0,o).toString("ucs2")}function u2(t){return $o(t,"binary").toString("utf8")}var pf="foo bar baz",Fr=dr&&(u2(pf)==yp(pf)&&u2||c2(pf)==yp(pf)&&c2)||yp,ou=dr?function(t){return $o(t,"utf8").toString("binary")}:function(t){for(var r=[],e=0,n=0,a=0;e<t.length;)switch(n=t.charCodeAt(e++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(e++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Du=function(){var t={};return function(e,n){var a=e+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",n||"")}}(),N_=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(e){for(var n=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}}(),YO=function(){var t={};return function(e){return t[e]!==void 0?t[e]:t[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}}(),XO=/<\/?(?:vt:)?variant>/g,KO=/<(?:vt:)([^>]*)>([\s\S]*)</;function d2(t,r){var e=Xt(t),n=t.match(YO(e.baseType))||[],a=[];if(n.length!=e.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+e.size);return a}return n.forEach(function(o){var s=o.replace(XO,"").match(KO);s&&a.push({v:Fr(s[2]),t:s[1]})}),a}var ZO=/(^\s|\s$|\n)/;function JO(t){return Ds(t).map(function(r){return" "+r+'="'+t[r]+'"'}).join("")}function QO(t,r,e){return"<"+t+(e!=null?JO(e):"")+(r!=null?(r.match(ZO)?' xml:space="preserve"':"")+">"+r+"</"+t:"/")+">"}function Xm(t){if(dr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Fr(Vo(Vm(t)));throw new Error("Bad input format: expected Buffer or string")}var Mu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ej={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},tj=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function rj(t,r){for(var e=1-2*(t[r+7]>>>7),n=((t[r+7]&127)<<4)+(t[r+6]>>>4&15),a=t[r+6]&15,o=5;o>=0;--o)a=a*256+t[r+o];return n==2047?a==0?e*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),e*Math.pow(2,n-52)*a)}function nj(t,r,e){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,o=0,s=n?-r:r;isFinite(s)?s==0?a=o=0:(a=Math.floor(Math.log(s)/Math.LN2),o=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(r)?26985:0);for(var l=0;l<=5;++l,o/=256)t[e+l]=o&255;t[e+6]=(a&15)<<4|o&15,t[e+7]=a>>4|n}var f2=function(t){for(var r=[],e=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,o=t[0][n].length;a<o;a+=e)r.push.apply(r,t[0][n].slice(a,a+e));return r},h2=dr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(r){return Buffer.isBuffer(r)?r:$o(r)})):f2(t)}:f2,p2=function(t,r,e){for(var n=[],a=r;a<e;a+=2)n.push(String.fromCharCode(ni(t,a)));return n.join("").replace(Zn,"")},Km=dr?function(t,r,e){return Buffer.isBuffer(t)?t.toString("utf16le",r,e).replace(Zn,""):p2(t,r,e)}:p2,m2=function(t,r,e){for(var n=[],a=r;a<r+e;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},O_=dr?function(t,r,e){return Buffer.isBuffer(t)?t.toString("hex",r,r+e):m2(t,r,e)}:m2,g2=function(t,r,e){for(var n=[],a=r;a<e;a++)n.push(String.fromCharCode(Bl(t,a)));return n.join("")},Wu=dr?function(r,e,n){return Buffer.isBuffer(r)?r.toString("utf8",e,n):g2(r,e,n)}:g2,j_=function(t,r){var e=ba(t,r);return e>0?Wu(t,r+4,r+4+e-1):""},D_=j_,M_=function(t,r){var e=ba(t,r);return e>0?Wu(t,r+4,r+4+e-1):""},R_=M_,F_=function(t,r){var e=2*ba(t,r);return e>0?Wu(t,r+4,r+4+e-1):""},I_=F_,P_=function(r,e){var n=ba(r,e);return n>0?Km(r,e+4,e+4+n):""},L_=P_,B_=function(t,r){var e=ba(t,r);return e>0?Wu(t,r+4,r+4+e):""},U_=B_,z_=function(t,r){return rj(t,r)},Df=z_,$_=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};dr&&(D_=function(r,e){if(!Buffer.isBuffer(r))return j_(r,e);var n=r.readUInt32LE(e);return n>0?r.toString("utf8",e+4,e+4+n-1):""},R_=function(r,e){if(!Buffer.isBuffer(r))return M_(r,e);var n=r.readUInt32LE(e);return n>0?r.toString("utf8",e+4,e+4+n-1):""},I_=function(r,e){if(!Buffer.isBuffer(r))return F_(r,e);var n=2*r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+n-1)},L_=function(r,e){if(!Buffer.isBuffer(r))return P_(r,e);var n=r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+n)},U_=function(r,e){if(!Buffer.isBuffer(r))return B_(r,e);var n=r.readUInt32LE(e);return r.toString("utf8",e+4,e+4+n)},Df=function(r,e){return Buffer.isBuffer(r)?r.readDoubleLE(e):z_(r,e)},$_=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Bl=function(t,r){return t[r]},ni=function(t,r){return t[r+1]*256+t[r]},aj=function(t,r){var e=t[r+1]*256+t[r];return e<32768?e:(65535-e+1)*-1},ba=function(t,r){return t[r+3]*(1<<24)+(t[r+2]<<16)+(t[r+1]<<8)+t[r]},Do=function(t,r){return t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]},sj=function(t,r){return t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]};function uu(t,r){var e="",n,a,o=[],s,l,c,i;switch(r){case"dbcs":if(i=this.l,dr&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)e+=String.fromCharCode(ni(this,i)),i+=2;t*=2;break;case"utf8":e=Wu(this,this.l,this.l+t);break;case"utf16le":t*=2,e=Km(this,this.l,this.l+t);break;case"wstr":return uu.call(this,t,"dbcs");case"lpstr-ansi":e=D_(this,this.l),t=4+ba(this,this.l);break;case"lpstr-cp":e=R_(this,this.l),t=4+ba(this,this.l);break;case"lpwstr":e=I_(this,this.l),t=4+2*ba(this,this.l);break;case"lpp4":t=4+ba(this,this.l),e=L_(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ba(this,this.l),e=U_(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,e="";(s=Bl(this,this.l+t++))!==0;)o.push(hf(s));e=o.join("");break;case"_wstr":for(t=0,e="";(s=ni(this,this.l+t))!==0;)o.push(hf(s)),t+=2;t+=2,e=o.join("");break;case"dbcs-cont":for(e="",i=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(i)!==-1)return s=Bl(this,i),this.l=i+1,l=uu.call(this,t-c,s?"dbcs-cont":"sbcs-cont"),o.join("")+l;o.push(hf(ni(this,i))),i+=2}e=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(e="",i=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(i)!==-1)return s=Bl(this,i),this.l=i+1,l=uu.call(this,t-c,s?"dbcs-cont":"sbcs-cont"),o.join("")+l;o.push(hf(Bl(this,i))),i+=1}e=o.join("");break;default:switch(t){case 1:return n=Bl(this,this.l),this.l++,n;case 2:return n=(r==="i"?aj:ni)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(t>0?Do:sj)(this,this.l),this.l+=4,n):(a=ba(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return t==8?a=Df(this,this.l):a=Df([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:e=O_(this,this.l,t);break}}return this.l+=t,e}var ij=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24&255},oj=function(t,r,e){t[e]=r&255,t[e+1]=r>>8&255,t[e+2]=r>>16&255,t[e+3]=r>>24&255},lj=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255};function cj(t,r,e){var n=0,a=0;if(e==="dbcs"){for(a=0;a!=r.length;++a)lj(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(e==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(e==="hex"){for(;a<t;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(e==="utf16le"){var o=Math.min(this.l+t,this.length);for(a=0;a<Math.min(r.length,t);++a){var s=r.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,ij(this,r,this.l);break;case 8:if(n=8,e==="f"){nj(this,r,this.l);break}case 16:break;case-4:n=4,oj(this,r,this.l);break}return this.l+=n,this}function V_(t,r){var e=O_(this,this.l,t.length>>1);if(e!==t)throw new Error(r+"Expected "+t+" saw "+e);this.l+=t.length>>1}function jn(t,r){t.l=r,t.read_shift=uu,t.chk=V_,t.write_shift=cj}function Vn(t,r){t.l+=r}function vn(t){var r=eo(t);return jn(r,0),r}function ci(t,r,e){if(t){var n,a,o;jn(t,t.l||0);for(var s=t.length,l=0,c=0;t.l<s;){l=t.read_shift(1),l&128&&(l=(l&127)+((t.read_shift(1)&127)<<7));var i=Lf[l]||Lf[65535];for(n=t.read_shift(1),o=n&127,a=1;a<4&&n&128;++a)o+=((n=t.read_shift(1))&127)<<7*a;c=t.l+o;var u=i.f&&i.f(t,o,e);if(t.l=c,r(u,i,l))return}}}function Qp(){var t=[],r=dr?256:2048,e=function(i){var u=vn(i);return jn(u,0),u},n=e(r),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},o=function(i){return n&&i<n.length-n.l?n:(a(),n=e(Math.max(i+1,r)))},s=function(){return a(),qi(t)},l=function(i){a(),n=i,n.l==null&&(n.l=n.length),o(r)};return{next:o,push:l,end:s,_bufs:t}}function du(t,r,e){var n=Mn(t);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!e||e.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function v2(t,r,e){var n=Mn(t);return n.s=du(n.s,r.s,e),n.e=du(n.e,r.s,e),n}function fu(t,r){if(t.cRel&&t.c<0)for(t=Mn(t);t.c<0;)t.c+=r>8?16384:256;if(t.rRel&&t.r<0)for(t=Mn(t);t.r<0;)t.r+=r>8?1048576:r>5?65536:16384;var e=Qt(t);return!t.cRel&&t.cRel!=null&&(e=fj(e)),!t.rRel&&t.rRel!=null&&(e=uj(e)),e}function wp(t,r){return t.s.r==0&&!t.s.rRel&&t.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+bn(t.s.c)+":"+(t.e.cRel?"":"$")+bn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(r.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Rn(t.s.r)+":"+(t.e.rRel?"":"$")+Rn(t.e.r):fu(t.s,r.biff)+":"+fu(t.e,r.biff)}function Zm(t){return parseInt(dj(t),10)-1}function Rn(t){return""+(t+1)}function uj(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function dj(t){return t.replace(/\$(\d+)$/,"$1")}function Jm(t){for(var r=hj(t),e=0,n=0;n!==r.length;++n)e=26*e+r.charCodeAt(n)-64;return e-1}function bn(t){if(t<0)throw new Error("invalid column "+t);var r="";for(++t;t;t=Math.floor((t-1)/26))r=String.fromCharCode((t-1)%26+65)+r;return r}function fj(t){return t.replace(/^([A-Z])/,"$$$1")}function hj(t){return t.replace(/^\$([A-Z])/,"$1")}function pj(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Kn(t){for(var r=0,e=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(e=26*e+(a-64))}return{c:e-1,r:r-1}}function Qt(t){for(var r=t.c+1,e="";r;r=(r-1)/26|0)e=String.fromCharCode((r-1)%26+65)+e;return e+(t.r+1)}function nc(t){var r=t.indexOf(":");return r==-1?{s:Kn(t),e:Kn(t)}:{s:Kn(t.slice(0,r)),e:Kn(t.slice(r+1))}}function pr(t,r){return typeof r>"u"||typeof r=="number"?pr(t.s,t.e):(typeof t!="string"&&(t=Qt(t)),typeof r!="string"&&(r=Qt(r)),t==r?t:t+":"+r)}function Yr(t){var r={s:{c:0,r:0},e:{c:0,r:0}},e=0,n=0,a=0,o=t.length;for(e=0;n<o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)e=26*e+a;for(r.s.c=--e,e=0;n<o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)e=10*e+a;if(r.s.r=--e,n===o||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,e=0;n!=o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)e=26*e+a;for(r.e.c=--e,e=0;n!=o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)e=10*e+a;return r.e.r=--e,r}function b2(t,r){var e=t.t=="d"&&r instanceof Date;if(t.z!=null)try{return t.w=$a(t.z,e?Jn(r):r)}catch{}try{return t.w=$a((t.XF||{}).numFmtId||(e?14:0),e?Jn(r):r)}catch{return""+r}}function ii(t,r,e){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),t.t=="e"?Wo[t.v]||t.v:r==null?b2(t,t.v):b2(t,r))}function no(t,r){var e=r&&r.sheet?r.sheet:"Sheet1",n={};return n[e]=t,{SheetNames:[e],Sheets:n}}function H_(t,r,e){var n=e||{},a=t?Array.isArray(t):n.dense,o=t||(a?[]:{}),s=0,l=0;if(o&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Kn(n.origin):n.origin;s=c.r,l=c.c}o["!ref"]||(o["!ref"]="A1:A1")}var i={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var u=Yr(o["!ref"]);i.s.c=u.s.c,i.s.r=u.s.r,i.e.c=Math.max(i.e.c,u.e.c),i.e.r=Math.max(i.e.r,u.e.r),s==-1&&(i.e.r=s=u.e.r+1)}for(var p=0;p!=r.length;++p)if(r[p]){if(!Array.isArray(r[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=r[p].length;++f)if(!(typeof r[p][f]>"u")){var h={v:r[p][f]},v=s+p,b=l+f;if(i.s.r>v&&(i.s.r=v),i.s.c>b&&(i.s.c=b),i.e.r<v&&(i.e.r=v),i.e.c<b&&(i.e.c=b),r[p][f]&&typeof r[p][f]=="object"&&!Array.isArray(r[p][f])&&!(r[p][f]instanceof Date))h=r[p][f];else if(Array.isArray(h.v)&&(h.f=r[p][f][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||rr[14],n.cellDates?(h.t="d",h.w=$a(h.z,Jn(h.v))):(h.t="n",h.v=Jn(h.v),h.w=$a(h.z,h.v))):h.t="s";if(a)o[v]||(o[v]=[]),o[v][b]&&o[v][b].z&&(h.z=o[v][b].z),o[v][b]=h;else{var g=Qt({c:b,r:v});o[g]&&o[g].z&&(h.z=o[g].z),o[g]=h}}}return i.s.c<1e7&&(o["!ref"]=pr(i)),o}function ac(t,r){return H_(null,t,r)}function mj(t){return t.read_shift(4,"i")}function $n(t){var r=t.read_shift(4);return r===0?"":t.read_shift(r,"dbcs")}function gj(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Qm(t,r){var e=t.l,n=t.read_shift(1),a=$n(t),o=[],s={t:a,h:a};if((n&1)!==0){for(var l=t.read_shift(4),c=0;c!=l;++c)o.push(gj(t));s.r=o}else s.r=[{ich:0,ifnt:0}];return t.l=e+r,s}var vj=Qm;function Va(t){var r=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:r,iStyleRef:e}}function Ho(t){var r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:r}}var bj=$n;function e1(t){var r=t.read_shift(4);return r===0||r===4294967295?"":t.read_shift(r,"dbcs")}var xj=$n,em=e1;function t1(t){var r=t.slice(t.l,t.l+4),e=r[0]&1,n=r[0]&2;t.l+=4;var a=n===0?Df([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Do(r,0)>>2;return e?a/100:a}function q_(t){var r={s:{},e:{}};return r.s.r=t.read_shift(4),r.e.r=t.read_shift(4),r.s.c=t.read_shift(4),r.e.c=t.read_shift(4),r}var qo=q_;function Un(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function yj(t){var r={},e=t.read_shift(1),n=e>>>1,a=t.read_shift(1),o=t.read_shift(2,"i"),s=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var i=Lo[a];i&&(r.rgb=Fu(i));break;case 2:r.rgb=Fu([s,l,c]);break;case 3:r.theme=a;break}return o!=0&&(r.tint=o>0?o/32767:o/32768),r}function wj(t){var r=t.read_shift(1);t.l++;var e={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return e}function W_(t,r){var e={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return e[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,r==1?"lpstr":"lpwstr")}function _j(t){return W_(t,1)}function Sj(t){return W_(t,2)}var r1=2,sa=3,mf=11,x2=12,Mf=19,gf=64,kj=65,Ej=71,Tj=4108,Aj=4126,Sn=80,G_=81,Cj=[Sn,G_],Nj={1:{n:"CodePage",t:r1},2:{n:"Category",t:Sn},3:{n:"PresentationFormat",t:Sn},4:{n:"ByteCount",t:sa},5:{n:"LineCount",t:sa},6:{n:"ParagraphCount",t:sa},7:{n:"SlideCount",t:sa},8:{n:"NoteCount",t:sa},9:{n:"HiddenCount",t:sa},10:{n:"MultimediaClipCount",t:sa},11:{n:"ScaleCrop",t:mf},12:{n:"HeadingPairs",t:Tj},13:{n:"TitlesOfParts",t:Aj},14:{n:"Manager",t:Sn},15:{n:"Company",t:Sn},16:{n:"LinksUpToDate",t:mf},17:{n:"CharacterCount",t:sa},19:{n:"SharedDoc",t:mf},22:{n:"HyperlinksChanged",t:mf},23:{n:"AppVersion",t:sa,p:"version"},24:{n:"DigSig",t:kj},26:{n:"ContentType",t:Sn},27:{n:"ContentStatus",t:Sn},28:{n:"Language",t:Sn},29:{n:"Version",t:Sn},255:{},2147483648:{n:"Locale",t:Mf},2147483651:{n:"Behavior",t:Mf},1919054434:{}},Oj={1:{n:"CodePage",t:r1},2:{n:"Title",t:Sn},3:{n:"Subject",t:Sn},4:{n:"Author",t:Sn},5:{n:"Keywords",t:Sn},6:{n:"Comments",t:Sn},7:{n:"Template",t:Sn},8:{n:"LastAuthor",t:Sn},9:{n:"RevNumber",t:Sn},10:{n:"EditTime",t:gf},11:{n:"LastPrinted",t:gf},12:{n:"CreatedDate",t:gf},13:{n:"ModifiedDate",t:gf},14:{n:"PageCount",t:sa},15:{n:"WordCount",t:sa},16:{n:"CharCount",t:sa},17:{n:"Thumbnail",t:Ej},18:{n:"Application",t:Sn},19:{n:"DocSecurity",t:sa},255:{},2147483648:{n:"Locale",t:Mf},2147483651:{n:"Behavior",t:Mf},1919054434:{}},y2={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},jj=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Dj(t){return t.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var Mj=Dj([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Lo=Mn(Mj),Wo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Y_={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},w2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function Rj(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Fj(t){var r=Rj();if(!t||!t.match)return r;var e={};if((t.match(Hn)||[]).forEach(function(n){var a=Xt(n);switch(a[0].replace(VO,"<")){case"<?xml":break;case"<Types":r.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[a.Extension]=a.ContentType;break;case"<Override":r[w2[a.ContentType]]!==void 0&&r[w2[a.ContentType]].push(a.PartName);break}}),r.xmlns!==ej.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=e,delete r.calcchains,r}var $l={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function tm(t){var r=t.lastIndexOf("/");return t.slice(0,r+1)+"_rels/"+t.slice(r+1)+".rels"}function hu(t,r){var e={"!id":{}};if(!t)return e;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(t.match(Hn)||[]).forEach(function(a){var o=Xt(a);if(o[0]==="<Relationship"){var s={};s.Type=o.Type,s.Target=o.Target,s.Id=o.Id,o.TargetMode&&(s.TargetMode=o.TargetMode);var l=o.TargetMode==="External"?o.Target:iu(o.Target,r);e[l]=s,n[o.Id]=s}}),e["!id"]=n,e}var Ij="application/vnd.oasis.opendocument.spreadsheet";function Pj(t,r){for(var e=Xm(t),n,a;n=Mu.exec(e);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Xt(n[0],!1),a.path=="/"&&a.type!==Ij)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var pu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Lj=function(){for(var t=new Array(pu.length),r=0;r<pu.length;++r){var e=pu[r],n="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);t[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function X_(t){var r={};t=Fr(t);for(var e=0;e<pu.length;++e){var n=pu[e],a=t.match(Lj[e]);a!=null&&a.length>0&&(r[n[1]]=vr(a[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=kn(r[n[1]]))}return r}var Bj=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function K_(t,r,e,n){var a=[];if(typeof t=="string")a=d2(t,n);else for(var o=0;o<t.length;++o)a=a.concat(t[o].map(function(u){return{v:u}}));var s=typeof r=="string"?d2(r,n).map(function(u){return u.v}):r,l=0,c=0;if(s.length>0)for(var i=0;i!==a.length;i+=2){switch(c=+a[i+1].v,a[i].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":e.Worksheets=c,e.SheetNames=s.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":e.NamedRanges=c,e.DefinedNames=s.slice(l,l+c);break;case"Charts":case"Diagramme":e.Chartsheets=c,e.ChartNames=s.slice(l,l+c);break}l+=c}}function Uj(t,r,e){var n={};return r||(r={}),t=Fr(t),Bj.forEach(function(a){var o=(t.match(Du(a[0]))||[])[1];switch(a[2]){case"string":o&&(r[a[1]]=vr(o));break;case"bool":r[a[1]]=o==="true";break;case"raw":var s=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&K_(n.HeadingPairs,n.TitlesOfParts,r,e),r}var zj=/<[^>]+>[^<]*/g;function $j(t,r){var e={},n="",a=t.match(zj);if(a)for(var o=0;o!=a.length;++o){var s=a[o],l=Xt(s);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=vr(l.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),i=c[0].slice(4),u=c[1];switch(i){case"lpstr":case"bstr":case"lpwstr":e[n]=vr(u);break;case"bool":e[n]=Lr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":e[n]=parseFloat(u);break;case"filetime":case"date":e[n]=kn(u);break;case"cy":case"error":e[n]=vr(u);break;default:if(i.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",s,i,c)}}else if(s.slice(0,2)!=="</"){if(r.WTF)throw new Error(s)}}}return e}var Vj={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},_p;function Hj(t,r,e){_p||(_p=Wm(Vj)),r=_p[r]||r,t[r]=e}function n1(t){var r=t.read_shift(4),e=t.read_shift(4);return new Date((e/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Z_(t,r,e){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(e)for(;t.l-n&3;)++t.l;return a}function J_(t,r,e){var n=t.read_shift(0,"lpwstr");return n}function Q_(t,r,e){return r===31?J_(t):Z_(t,r,e)}function rm(t,r,e){return Q_(t,r,e===!1?0:4)}function qj(t,r){if(!r)throw new Error("VtUnalignedString must have positive length");return Q_(t,r,0)}function Wj(t){for(var r=t.read_shift(4),e=[],n=0;n!=r;++n){var a=t.l;e[n]=t.read_shift(0,"lpwstr").replace(Zn,""),t.l-a&2&&(t.l+=2)}return e}function Gj(t){for(var r=t.read_shift(4),e=[],n=0;n!=r;++n)e[n]=t.read_shift(0,"lpstr-cp").replace(Zn,"");return e}function Yj(t){var r=t.l,e=Rf(t,G_);t[t.l]==0&&t[t.l+1]==0&&t.l-r&2&&(t.l+=2);var n=Rf(t,sa);return[e,n]}function Xj(t){for(var r=t.read_shift(4),e=[],n=0;n<r/2;++n)e.push(Yj(t));return e}function _2(t,r){for(var e=t.read_shift(4),n={},a=0;a!=e;++a){var o=t.read_shift(4),s=t.read_shift(4);n[o]=t.read_shift(s,r===1200?"utf16le":"utf8").replace(Zn,"").replace(su,"!"),r===1200&&s%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function e4(t){var r=t.read_shift(4),e=t.slice(t.l,t.l+r);return t.l+=r,(r&3)>0&&(t.l+=4-(r&3)&3),e}function Kj(t){var r={};return r.Size=t.read_shift(4),t.l+=r.Size+3-(r.Size-1)%4,r}function Rf(t,r,e){var n=t.read_shift(2),a,o=e||{};if(t.l+=2,r!==x2&&n!==r&&Cj.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===x2?n:r){case 2:return a=t.read_shift(2,"i"),o.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return Z_(t,n,4).replace(Zn,"");case 31:return J_(t);case 64:return n1(t);case 65:return e4(t);case 71:return Kj(t);case 80:return rm(t,n,!o.raw).replace(Zn,"");case 81:return qj(t,n).replace(Zn,"");case 4108:return Xj(t);case 4126:case 4127:return n==4127?Wj(t):Gj(t);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function S2(t,r){var e=t.l,n=t.read_shift(4),a=t.read_shift(4),o=[],s=0,l=0,c=-1,i={};for(s=0;s!=a;++s){var u=t.read_shift(4),p=t.read_shift(4);o[s]=[u,p+e]}o.sort(function(y,E){return y[1]-E[1]});var f={};for(s=0;s!=a;++s){if(t.l!==o[s][1]){var h=!0;if(s>0&&r)switch(r[o[s-1][0]].t){case 2:t.l+2===o[s][1]&&(t.l+=2,h=!1);break;case 80:t.l<=o[s][1]&&(t.l=o[s][1],h=!1);break;case 4108:t.l<=o[s][1]&&(t.l=o[s][1],h=!1);break}if((!r||s==0)&&t.l<=o[s][1]&&(h=!1,t.l=o[s][1]),h)throw new Error("Read Error: Expected address "+o[s][1]+" at "+t.l+" :"+s)}if(r){var v=r[o[s][0]];if(f[v.n]=Rf(t,v.t,{raw:!0}),v.p==="version"&&(f[v.n]=String(f[v.n]>>16)+"."+("0000"+String(f[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(f[v.n]){case 0:f[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ls(l=f[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[v.n])}}else if(o[s][0]===1){if(l=f.CodePage=Rf(t,r1),ls(l),c!==-1){var b=t.l;t.l=o[c][1],i=_2(t,l),t.l=b}}else if(o[s][0]===0){if(l===0){c=s,t.l=o[s+1][1];continue}i=_2(t,l)}else{var g=i[o[s][0]],x;switch(t[t.l]){case 65:t.l+=4,x=e4(t);break;case 30:t.l+=4,x=rm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,x=rm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,x=t.read_shift(4,"i");break;case 19:t.l+=4,x=t.read_shift(4);break;case 5:t.l+=4,x=t.read_shift(8,"f");break;case 11:t.l+=4,x=Zr(t,4);break;case 64:t.l+=4,x=kn(n1(t));break;default:throw new Error("unparsed value: "+t[t.l])}f[g]=x}}return t.l=e+n,f}function k2(t,r,e){var n=t.content;if(!n)return{};jn(n,0);var a,o,s,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var i=n.read_shift(4),u=n.read_shift(16);if(u!==hr.utils.consts.HEADER_CLSID&&u!==e)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(s=n.read_shift(16),c=n.read_shift(4));var p=S2(n,r),f={SystemIdentifier:i};for(var h in p)f[h]=p[h];if(f.FMTID=o,a===1)return f;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var v;try{v=S2(n,null)}catch{}for(h in v)f[h]=v[h];return f.FMTID=[o,s],f}function $i(t,r){return t.read_shift(r),null}function Zj(t,r,e){for(var n=[],a=t.l+r;t.l<a;)n.push(e(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Zr(t,r){return t.read_shift(r)===1}function ln(t){return t.read_shift(2,"u")}function t4(t,r){return Zj(t,r,ln)}function Jj(t){var r=t.read_shift(1),e=t.read_shift(1);return e===1?r:r===1}function Gu(t,r,e){var n=t.read_shift(e&&e.biff>=12?2:1),a="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var o=t.read_shift(1);o&&(a="dbcs-cont")}else e.biff==12&&(a="wstr");e.biff>=2&&e.biff<=5&&(a="cpstr");var s=n?t.read_shift(n,a):"";return s}function Qj(t){var r=t.read_shift(2),e=t.read_shift(1),n=e&4,a=e&8,o=1+(e&1),s=0,l,c={};a&&(s=t.read_shift(2)),n&&(l=t.read_shift(4));var i=o==2?"dbcs-cont":"sbcs-cont",u=r===0?"":t.read_shift(r,i);return a&&(t.l+=4*s),n&&(t.l+=l),c.t=u,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function zo(t,r,e){var n;if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(r,"cpstr");if(e.biff>=12)return t.read_shift(r,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(r,"sbcs-cont"):n=t.read_shift(r,"dbcs-cont"),n}function Yu(t,r,e){var n=t.read_shift(e&&e.biff==2?1:2);return n===0?(t.l++,""):zo(t,n,e)}function Go(t,r,e){if(e.biff>5)return Yu(t,r,e);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function eD(t){var r=t.read_shift(1);t.l++;var e=t.read_shift(2);return t.l+=2,[r,e]}function tD(t){var r=t.read_shift(4),e=t.l,n=!1;r>24&&(t.l+=r-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=e);var a=t.read_shift((n?r-24:r)>>1,"utf16le").replace(Zn,"");return n&&(t.l+=24),a}function rD(t){for(var r=t.read_shift(2),e="";r-- >0;)e+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return e+n.replace(/\\/g,"/");var o=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=t.read_shift(o>>1,"utf16le").replace(Zn,"");return e+s}function nD(t,r){var e=t.read_shift(16);switch(e){case"e0c9ea79f9bace118c8200aa004ba90b":return tD(t);case"0303000000000000c000000000000046":return rD(t);default:throw new Error("Unsupported Moniker "+e)}}function vf(t){var r=t.read_shift(4),e=r>0?t.read_shift(r,"utf16le").replace(Zn,""):"";return e}function aD(t,r){var e=t.l+r,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var o,s,l,c,i="",u,p;a&16&&(o=vf(t,e-t.l)),a&128&&(s=vf(t,e-t.l)),(a&257)===257&&(l=vf(t,e-t.l)),(a&257)===1&&(c=nD(t,e-t.l)),a&8&&(i=vf(t,e-t.l)),a&32&&(u=t.read_shift(16)),a&64&&(p=n1(t)),t.l=e;var f=s||l||c||"";f&&i&&(f+="#"+i),f||(f="#"+i),a&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var h={Target:f};return u&&(h.guid=u),p&&(h.time=p),o&&(h.Tooltip=o),h}function r4(t){var r=t.read_shift(1),e=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[r,e,n,a]}function n4(t,r){var e=r4(t);return e[3]=0,e}function Is(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2);return{r,c:e,ixfe:n}}function sD(t){var r=t.read_shift(2),e=t.read_shift(2);return t.l+=8,{type:r,flags:e}}function iD(t,r,e){return r===0?"":Go(t,r,e)}function oD(t,r,e){var n=e.biff>8?4:2,a=t.read_shift(n),o=t.read_shift(n,"i"),s=t.read_shift(n,"i");return[a,o,s]}function a4(t){var r=t.read_shift(2),e=t1(t);return[r,e]}function lD(t,r,e){t.l+=4,r-=4;var n=t.l+r,a=Gu(t,r,e),o=t.read_shift(2);if(n-=t.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return t.l+=o,a}function Jf(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r},e:{c:a,r:e}}}function s4(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r},e:{c:a,r:e}}}var cD=s4;function i4(t){t.l+=4;var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[e,r,n]}function uD(t){var r={};return t.l+=4,t.l+=16,r.fSharedNote=t.read_shift(2),t.l+=4,r}function dD(t){var r={};return t.l+=4,t.cf=t.read_shift(2),r}function In(t){t.l+=2,t.l+=t.read_shift(2)}var fD={0:In,4:In,5:In,6:In,7:dD,8:In,9:In,10:In,11:In,12:In,13:uD,14:In,15:In,16:In,17:In,18:In,19:In,20:In,21:i4};function hD(t,r){for(var e=t.l+r,n=[];t.l<e;){var a=t.read_shift(2);t.l-=2;try{n.push(fD[a](t,e-t.l))}catch{return t.l=e,n}}return t.l!=e&&(t.l=e),n}function bf(t,r){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=t.read_shift(2),r-=2,r>=2&&(e.dt=t.read_shift(2),t.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return t.read_shift(r),e}function pD(t,r){return r===0||t.read_shift(2),1200}function mD(t,r,e){if(e.enc)return t.l+=r,"";var n=t.l,a=Go(t,0,e);return t.read_shift(r+n-t.l),a}function gD(t,r,e){var n=e&&e.biff==8||r==2?t.read_shift(2):(t.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function vD(t,r,e){var n=t.read_shift(4),a=t.read_shift(1)&3,o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var s=Gu(t,0,e);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:o,name:s}}function bD(t,r){for(var e=t.l+r,n=t.read_shift(4),a=t.read_shift(4),o=[],s=0;s!=a&&t.l<e;++s)o.push(Qj(t));return o.Count=n,o.Unique=a,o}function xD(t,r){var e={};return e.dsst=t.read_shift(2),t.l+=r-2,e}function yD(t){var r={};r.r=t.read_shift(2),r.c=t.read_shift(2),r.cnt=t.read_shift(2)-r.c;var e=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=e/20),r}function wD(t){var r=sD(t);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var e=t.read_shift(4);return e!==0}function _D(t){return t.read_shift(2),t.read_shift(4)}function E2(t,r,e){var n=0;e&&e.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);e&&e.biff==2&&(n=1-(a>>15),a&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,a]}function SD(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),s=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),i=t.read_shift(2);return{Pos:[r,e],Dim:[n,a],Flags:o,CurTab:s,FirstTab:l,Selected:c,TabRatio:i}}function kD(t,r,e){if(e&&e.biff>=2&&e.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function ED(){}function TD(t,r,e){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Gu(t,0,e),n}function AD(t){var r=Is(t);return r.isst=t.read_shift(4),r}function CD(t,r,e){e.biffguess&&e.biff==2&&(e.biff=5);var n=t.l+r,a=Is(t);e.biff==2&&t.l++;var o=Yu(t,n-t.l,e);return a.val=o,a}function ND(t,r,e){var n=t.read_shift(2),a=Go(t,0,e);return[n,a]}var OD=Go;function T2(t,r,e){var n=t.l+r,a=e.biff==8||!e.biff?4:2,o=t.read_shift(a),s=t.read_shift(a),l=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:o,c:l},e:{r:s,c}}}function jD(t){var r=t.read_shift(2),e=t.read_shift(2),n=a4(t);return{r,c:e,ixfe:n[0],rknum:n[1]}}function DD(t,r){for(var e=t.l+r-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<e;)o.push(a4(t));if(t.l!==e)throw new Error("MulRK read error");var s=t.read_shift(2);if(o.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:o}}function MD(t,r){for(var e=t.l+r-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<e;)o.push(t.read_shift(2));if(t.l!==e)throw new Error("MulBlank read error");var s=t.read_shift(2);if(o.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:o}}function RD(t,r,e,n){var a={},o=t.read_shift(4),s=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(2);return a.patternType=jj[l>>26],n.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function FD(t,r,e){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=RD(t,r,n.fStyle,e),n}function ID(t){t.l+=4;var r=[t.read_shift(2),t.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function A2(t,r,e){var n=Is(t);(e.biff==2||r==9)&&++t.l;var a=Jj(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function PD(t,r,e){e.biffguess&&e.biff==2&&(e.biff=5);var n=Is(t),a=Un(t);return n.val=a,n}var C2=iD;function LD(t,r,e){var n=t.l+r,a=t.read_shift(2),o=t.read_shift(2);if(e.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var s=zo(t,o),l=[];n>t.l;)l.push(Yu(t));return[o,a,s,l]}function N2(t,r,e){var n=t.read_shift(2),a,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return e.sbcch===14849&&(a=lD(t,r-2,e)),o.body=a||t.read_shift(r-2),typeof a=="string"&&(o.Name=a),o}var BD=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function O2(t,r,e){var n=t.l+r,a=t.read_shift(2),o=t.read_shift(1),s=t.read_shift(1),l=t.read_shift(e&&e.biff==2?1:2),c=0;(!e||e.biff>=5)&&(e.biff!=5&&(t.l+=2),c=t.read_shift(2),e.biff==5&&(t.l+=2),t.l+=4);var i=zo(t,s,e);a&32&&(i=BD[i.charCodeAt(0)]);var u=n-t.l;e&&e.biff==2&&--u;var p=n==t.l||l===0||!(u>0)?[]:yI(t,u,e,l);return{chKey:o,Name:i,itab:c,rgce:p}}function o4(t,r,e){if(e.biff<8)return UD(t,r,e);for(var n=[],a=t.l+r,o=t.read_shift(e.biff>8?4:2);o--!==0;)n.push(oD(t,e.biff>8?12:6,e));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function UD(t,r,e){t[t.l+1]==3&&t[t.l]++;var n=Gu(t,r,e);return n.charCodeAt(0)==3?n.slice(1):n}function zD(t,r,e){if(e.biff<8){t.l+=r;return}var n=t.read_shift(2),a=t.read_shift(2),o=zo(t,n,e),s=zo(t,a,e);return[o,s]}function $D(t,r,e){var n=s4(t);t.l++;var a=t.read_shift(1);return r-=8,[wI(t,r,e),a,n]}function j2(t,r,e){var n=cD(t);switch(e.biff){case 2:t.l++,r-=7;break;case 3:case 4:t.l+=2,r-=8;break;default:t.l+=6,r-=12}return[n,bI(t,r,e)]}function VD(t){var r=t.read_shift(4)!==0,e=t.read_shift(4)!==0,n=t.read_shift(4);return[r,e,n]}function HD(t,r,e){if(!(e.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),s=t.read_shift(2),l=Go(t,0,e);return e.biff<8&&t.read_shift(1),[{r:n,c:a},l,s,o]}}function qD(t,r,e){return HD(t,r,e)}function WD(t,r){for(var e=[],n=t.read_shift(2);n--;)e.push(Jf(t));return e}function GD(t,r,e){if(e&&e.biff<8)return XD(t,r,e);var n=i4(t),a=hD(t,r-22,n[1]);return{cmo:n,ft:a}}var YD={8:function(t,r){var e=t.l+r;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=e,{fmt:n}}};function XD(t,r,e){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,r-=36;var s=[];return s.push((YD[n]||Vn)(t,r,e)),{cmo:[a,n,o],ft:s}}function KD(t,r,e){var n=t.l,a="";try{t.l+=4;var o=(e.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(o)==-1?t.l+=6:s=eD(t,6,e);var l=t.read_shift(2);t.read_shift(2),ln(t,2);var c=t.read_shift(2);t.l+=c;for(var i=1;i<t.lens.length-1;++i){if(t.l-n!=t.lens[i])throw new Error("TxO: bad continue record");var u=t[t.l],p=zo(t,t.lens[i+1]-t.lens[i]-1);if(a+=p,a.length>=(u?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return t.l=n+r,{t:a}}catch{return t.l=n+r,{t:a}}}function ZD(t,r){var e=Jf(t);t.l+=16;var n=aD(t,r-24);return[e,n]}function JD(t,r){t.read_shift(2);var e=Jf(t),n=t.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(Zn,""),[e,n]}function QD(t){var r=[0,0],e;return e=t.read_shift(2),r[0]=y2[e]||e,e=t.read_shift(2),r[1]=y2[e]||e,r}function eM(t){for(var r=t.read_shift(2),e=[];r-- >0;)e.push(n4(t));return e}function tM(t){for(var r=t.read_shift(2),e=[];r-- >0;)e.push(n4(t));return e}function rM(t){t.l+=2;var r={cxfs:0,crc:0};return r.cxfs=t.read_shift(2),r.crc=t.read_shift(4),r}function l4(t,r,e){if(!e.cellStyles)return Vn(t,r);var n=e&&e.biff>=12?4:2,a=t.read_shift(n),o=t.read_shift(n),s=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var i={s:a,e:o,w:s,ixfe:l,flags:c};return(e.biff>=5||!e.biff)&&(i.level=c>>8&7),i}function nM(t,r){var e={};return r<32||(t.l+=16,e.header=Un(t),e.footer=Un(t),t.l+=2),e}function aM(t,r,e){var n={area:!1};if(e.biff!=5)return t.l+=r,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}var sM=Is,iM=t4,oM=Yu;function lM(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(4),a={fmt:r,env:e,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function cM(t,r,e){e.biffguess&&e.biff==5&&(e.biff=2);var n=Is(t);++t.l;var a=Go(t,r-7,e);return n.t="str",n.val=a,n}function uM(t){var r=Is(t);++t.l;var e=Un(t);return r.t="n",r.val=e,r}function dM(t){var r=Is(t);++t.l;var e=t.read_shift(2);return r.t="n",r.val=e,r}function fM(t){var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,"sbcs-cont")}function hM(t,r){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=r-13}function pM(t,r,e){var n=t.l+r,a=Is(t),o=t.read_shift(2),s=zo(t,o,e);return t.l=n,a.t="str",a.val=s,a}var mM=[2,3,48,49,131,139,140,245],D2=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Wm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(l,c){var i=[],u=eo(1);switch(c.type){case"base64":u=ss(Sa(l));break;case"binary":u=ss(l);break;case"buffer":case"array":u=l;break}jn(u,0);var p=u.read_shift(1),f=!!(p&136),h=!1,v=!1;switch(p){case 2:break;case 3:break;case 48:h=!0,f=!0;break;case 49:h=!0,f=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var b=0,g=521;p==2&&(b=u.read_shift(2)),u.l+=3,p!=2&&(b=u.read_shift(4)),b>1048576&&(b=1e6),p!=2&&(g=u.read_shift(2));var x=u.read_shift(2),y=c.codepage||1252;p!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(y=t[u[u.l]]),u.l+=1,u.l+=2),v&&(u.l+=36);for(var E=[],N={},I=Math.min(u.length,p==2?521:g-10-(h?264:0)),L=v?32:11;u.l<I&&u[u.l]!=13;)switch(N={},N.name=Ou.utils.decode(y,u.slice(u.l,u.l+L)).replace(/[\u0000\r\n].*$/g,""),u.l+=L,N.type=String.fromCharCode(u.read_shift(1)),p!=2&&!v&&(N.offset=u.read_shift(4)),N.len=u.read_shift(1),p==2&&(N.offset=u.read_shift(2)),N.dec=u.read_shift(1),N.name.length&&E.push(N),p!=2&&(u.l+=v?13:14),N.type){case"B":(!h||N.len!=8)&&c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var H=0,V=0;for(i[0]=[],V=0;V!=E.length;++V)i[0][V]=E[V].name;for(;b-- >0;){if(u[u.l]===42){u.l+=x;continue}for(++u.l,i[++H]=[],V=0,V=0;V!=E.length;++V){var q=u.slice(u.l,u.l+E[V].len);u.l+=E[V].len,jn(q,0);var K=Ou.utils.decode(y,q);switch(E[V].type){case"C":K.trim().length&&(i[H][V]=K.replace(/\s+$/,""));break;case"D":K.length===8?i[H][V]=new Date(+K.slice(0,4),+K.slice(4,6)-1,+K.slice(6,8)):i[H][V]=K;break;case"F":i[H][V]=parseFloat(K.trim());break;case"+":case"I":i[H][V]=v?q.read_shift(-4,"i")^2147483648:q.read_shift(4,"i");break;case"L":switch(K.trim().toUpperCase()){case"Y":case"T":i[H][V]=!0;break;case"N":case"F":i[H][V]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+K+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));i[H][V]="##MEMO##"+(v?parseInt(K.trim(),10):q.read_shift(4));break;case"N":K=K.replace(/\u0000/g,"").trim(),K&&K!="."&&(i[H][V]=+K||0);break;case"@":i[H][V]=new Date(q.read_shift(-8,"f")-621356832e5);break;case"T":i[H][V]=new Date((q.read_shift(4)-2440588)*864e5+q.read_shift(4));break;case"Y":i[H][V]=q.read_shift(4,"i")/1e4+q.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":i[H][V]=-q.read_shift(-8,"f");break;case"B":if(h&&E[V].len==8){i[H][V]=q.read_shift(8,"f");break}case"G":case"P":q.l+=E[V].len;break;case"0":if(E[V].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+E[V].type)}}}if(p!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(i=i.slice(0,c.sheetRows)),c.DBF=E,i}function n(l,c){var i=c||{};i.dateNF||(i.dateNF="yyyymmdd");var u=ac(e(l,i),i);return u["!cols"]=i.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete i.DBF,u}function a(l,c){try{return no(n(l,c),c)}catch(i){if(c&&c.WTF)throw i}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function s(l,c){var i=c||{};if(+i.codepage>=0&&ls(+i.codepage),i.type=="string")throw new Error("Cannot write DBF to JS string");var u=Qp(),p=lm(l,{header:1,raw:!0,cellDates:!0}),f=p[0],h=p.slice(1),v=l["!cols"]||[],b=0,g=0,x=0,y=1;for(b=0;b<f.length;++b){if(((v[b]||{}).DBF||{}).name){f[b]=v[b].DBF.name,++x;continue}if(f[b]!=null){if(++x,typeof f[b]=="number"&&(f[b]=f[b].toString(10)),typeof f[b]!="string")throw new Error("DBF Invalid column name "+f[b]+" |"+typeof f[b]+"|");if(f.indexOf(f[b])!==b){for(g=0;g<1024;++g)if(f.indexOf(f[b]+"_"+g)==-1){f[b]+="_"+g;break}}}}var E=Yr(l["!ref"]),N=[],I=[],L=[];for(b=0;b<=E.e.c-E.s.c;++b){var H="",V="",q=0,K=[];for(g=0;g<h.length;++g)h[g][b]!=null&&K.push(h[g][b]);if(K.length==0||f[b]==null){N[b]="?";continue}for(g=0;g<K.length;++g){switch(typeof K[g]){case"number":V="B";break;case"string":V="C";break;case"boolean":V="L";break;case"object":V=K[g]instanceof Date?"D":"C";break;default:V="C"}q=Math.max(q,String(K[g]).length),H=H&&H!=V?"C":V}q>250&&(q=250),V=((v[b]||{}).DBF||{}).type,V=="C"&&v[b].DBF.len>q&&(q=v[b].DBF.len),H=="B"&&V=="N"&&(H="N",L[b]=v[b].DBF.dec,q=v[b].DBF.len),I[b]=H=="C"||V=="N"?q:o[H]||0,y+=I[b],N[b]=H}var z=u.next(32);for(z.write_shift(4,318902576),z.write_shift(4,h.length),z.write_shift(2,296+32*x),z.write_shift(2,y),b=0;b<4;++b)z.write_shift(4,0);for(z.write_shift(4,0|(+r[o_]||3)<<8),b=0,g=0;b<f.length;++b)if(f[b]!=null){var W=u.next(32),D=(f[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);W.write_shift(1,D,"sbcs"),W.write_shift(1,N[b]=="?"?"C":N[b],"sbcs"),W.write_shift(4,g),W.write_shift(1,I[b]||o[N[b]]||0),W.write_shift(1,L[b]||0),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(1,0),W.write_shift(4,0),W.write_shift(4,0),g+=I[b]||o[N[b]]||0}var M=u.next(264);for(M.write_shift(4,13),b=0;b<65;++b)M.write_shift(4,0);for(b=0;b<h.length;++b){var C=u.next(y);for(C.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(N[g]){case"L":C.write_shift(1,h[b][g]==null?63:h[b][g]?84:70);break;case"B":C.write_shift(8,h[b][g]||0,"f");break;case"N":var w="0";for(typeof h[b][g]=="number"&&(w=h[b][g].toFixed(L[g]||0)),x=0;x<I[g]-w.length;++x)C.write_shift(1,32);C.write_shift(1,w,"sbcs");break;case"D":h[b][g]?(C.write_shift(4,("0000"+h[b][g].getFullYear()).slice(-4),"sbcs"),C.write_shift(2,("00"+(h[b][g].getMonth()+1)).slice(-2),"sbcs"),C.write_shift(2,("00"+h[b][g].getDate()).slice(-2),"sbcs")):C.write_shift(8,"00000000","sbcs");break;case"C":var T=String(h[b][g]!=null?h[b][g]:"").slice(0,I[g]);for(C.write_shift(1,T,"sbcs"),x=0;x<I[g]-T.length;++x)C.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),gM=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Ds(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(f,h){var v=t[h];return typeof v=="number"?Yx(v):v},n=function(f,h,v){var b=h.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return b==59?f:Yx(b)};t["|"]=254;function a(f,h){switch(h.type){case"base64":return o(Sa(f),h);case"binary":return o(f,h);case"buffer":return o(dr&&Buffer.isBuffer(f)?f.toString("binary"):Vo(f),h);case"array":return o(Uo(f),h)}throw new Error("Unrecognized type "+h.type)}function o(f,h){var v=f.split(/[\n\r]+/),b=-1,g=-1,x=0,y=0,E=[],N=[],I=null,L={},H=[],V=[],q=[],K=0,z;for(+h.codepage>=0&&ls(+h.codepage);x!==v.length;++x){K=0;var W=v[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,e),D=W.replace(/;;/g,"\0").split(";").map(function(ee){return ee.replace(/\u0000/g,";")}),M=D[0],C;if(W.length>0)switch(M){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":D[1].charAt(0)=="P"&&N.push(W.slice(3).replace(/;;/g,";"));break;case"C":var w=!1,T=!1,A=!1,S=!1,j=-1,B=-1;for(y=1;y<D.length;++y)switch(D[y].charAt(0)){case"A":break;case"X":g=parseInt(D[y].slice(1))-1,T=!0;break;case"Y":for(b=parseInt(D[y].slice(1))-1,T||(g=0),z=E.length;z<=b;++z)E[z]=[];break;case"K":C=D[y].slice(1),C.charAt(0)==='"'?C=C.slice(1,C.length-1):C==="TRUE"?C=!0:C==="FALSE"?C=!1:isNaN(us(C))?isNaN(Zl(C).getDate())||(C=kn(C)):(C=us(C),I!==null&&rc(I)&&(C=Zf(C))),w=!0;break;case"E":S=!0;var R=Gl(D[y].slice(1),{r:b,c:g});E[b][g]=[E[b][g],R];break;case"S":A=!0,E[b][g]=[E[b][g],"S5S"];break;case"G":break;case"R":j=parseInt(D[y].slice(1))-1;break;case"C":B=parseInt(D[y].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+W)}if(w&&(E[b][g]&&E[b][g].length==2?E[b][g][0]=C:E[b][g]=C,I=null),A){if(S)throw new Error("SYLK shared formula cannot have own formula");var X=j>-1&&E[j][B];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");E[b][g][1]=b4(X[1],{r:b-j,c:g-B})}break;case"F":var Y=0;for(y=1;y<D.length;++y)switch(D[y].charAt(0)){case"X":g=parseInt(D[y].slice(1))-1,++Y;break;case"Y":for(b=parseInt(D[y].slice(1))-1,z=E.length;z<=b;++z)E[z]=[];break;case"M":K=parseInt(D[y].slice(1))/20;break;case"F":break;case"G":break;case"P":I=N[parseInt(D[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(q=D[y].slice(1).split(" "),z=parseInt(q[0],10);z<=parseInt(q[1],10);++z)K=parseInt(q[2],10),V[z-1]=K===0?{hidden:!0}:{wch:K},Jl(V[z-1]);break;case"C":g=parseInt(D[y].slice(1))-1,V[g]||(V[g]={});break;case"R":b=parseInt(D[y].slice(1))-1,H[b]||(H[b]={}),K>0?(H[b].hpt=K,H[b].hpx=Iu(K)):K===0&&(H[b].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+W)}Y<1&&(I=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+W)}}return H.length>0&&(L["!rows"]=H),V.length>0&&(L["!cols"]=V),h&&h.sheetRows&&(E=E.slice(0,h.sheetRows)),[E,L]}function s(f,h){var v=a(f,h),b=v[0],g=v[1],x=ac(b,h);return Ds(g).forEach(function(y){x[y]=g[y]}),x}function l(f,h){return no(s(f,h),h)}function c(f,h,v,b){var g="C;Y"+(v+1)+";X"+(b+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+rF(f.f,{r:v,c:b}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function i(f,h){h.forEach(function(v,b){var g="F;W"+(b+1)+" "+(b+1)+" ";v.hidden?g+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=If(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Pf(v.wpx)),typeof v.wch=="number"&&(g+=Math.round(v.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function u(f,h){h.forEach(function(v,b){var g="F;";v.hidden?g+="M0;":v.hpt?g+="M"+20*v.hpt+";":v.hpx&&(g+="M"+20*m4(v.hpx)+";"),g.length>2&&f.push(g+"R"+(b+1))})}function p(f,h){var v=["ID;PWXL;N;E"],b=[],g=Yr(f["!ref"]),x,y=Array.isArray(f),E=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),f["!cols"]&&i(v,f["!cols"]),f["!rows"]&&u(v,f["!rows"]),v.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var N=g.s.r;N<=g.e.r;++N)for(var I=g.s.c;I<=g.e.c;++I){var L=Qt({r:N,c:I});x=y?(f[N]||[])[I]:f[L],!(!x||x.v==null&&(!x.f||x.F))&&b.push(c(x,f,N,I))}return v.join(E)+E+b.join(E)+E+"E"+E}return{to_workbook:l,to_sheet:s,from_sheet:p}}(),vM=function(){function t(o,s){switch(s.type){case"base64":return r(Sa(o),s);case"binary":return r(o,s);case"buffer":return r(dr&&Buffer.isBuffer(o)?o.toString("binary"):Vo(o),s);case"array":return r(Uo(o),s)}throw new Error("Unrecognized type "+s.type)}function r(o,s){for(var l=o.split(`
`),c=-1,i=-1,u=0,p=[];u!==l.length;++u){if(l[u].trim()==="BOT"){p[++c]=[],i=0;continue}if(!(c<0)){var f=l[u].trim().split(","),h=f[0],v=f[1];++u;for(var b=l[u]||"";(b.match(/["]/g)||[]).length&1&&u<l.length-1;)b+=`
`+l[++u];switch(b=b.trim(),+h){case-1:if(b==="BOT"){p[++c]=[],i=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?p[c][i]=!0:b==="FALSE"?p[c][i]=!1:isNaN(us(v))?isNaN(Zl(v).getDate())?p[c][i]=v:p[c][i]=kn(v):p[c][i]=us(v),++i;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),p[c][i++]=b!==""?b:null;break}if(b==="EOD")break}}return s&&s.sheetRows&&(p=p.slice(0,s.sheetRows)),p}function e(o,s){return ac(t(o,s),s)}function n(o,s){return no(e(o,s),s)}var a=function(){var o=function(c,i,u,p,f){c.push(i),c.push(u+","+p),c.push('"'+f.replace(/"/g,'""')+'"')},s=function(c,i,u,p){c.push(i+","+u),c.push(i==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(c){var i=[],u=Yr(c["!ref"]),p,f=Array.isArray(c);o(i,"TABLE",0,1,"sheetjs"),o(i,"VECTORS",0,u.e.r-u.s.r+1,""),o(i,"TUPLES",0,u.e.c-u.s.c+1,""),o(i,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){s(i,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var b=Qt({r:h,c:v});if(p=f?(c[h]||[])[v]:c[b],!p){s(i,1,0,"");continue}switch(p.t){case"n":var g=p.w;!g&&p.v!=null&&(g=p.v),g==null?p.f&&!p.F?s(i,1,0,"="+p.f):s(i,1,0,""):s(i,0,g,"V");break;case"b":s(i,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":s(i,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=$a(p.z||rr[14],Jn(kn(p.v)))),s(i,0,p.w,"V");break;default:s(i,1,0,"")}}}s(i,-1,0,"EOD");var x=`\r
`,y=i.join(x);return y}}();return{to_workbook:n,to_sheet:e,from_sheet:a}}(),bM=function(){function t(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(p,f){for(var h=p.split(`
`),v=-1,b=-1,g=0,x=[];g!==h.length;++g){var y=h[g].trim().split(":");if(y[0]==="cell"){var E=Kn(y[1]);if(x.length<=E.r)for(v=x.length;v<=E.r;++v)x[v]||(x[v]=[]);switch(v=E.r,b=E.c,y[2]){case"t":x[v][b]=t(y[3]);break;case"v":x[v][b]=+y[3];break;case"vtf":var N=y[y.length-1];case"vtc":switch(y[3]){case"nl":x[v][b]=!!+y[4];break;default:x[v][b]=+y[4];break}y[2]=="vtf"&&(x[v][b]=[x[v][b],N])}}}return f&&f.sheetRows&&(x=x.slice(0,f.sheetRows)),x}function n(p,f){return ac(e(p,f),f)}function a(p,f){return no(n(p,f),f)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function i(p){if(!p||!p["!ref"])return"";for(var f=[],h=[],v,b="",g=nc(p["!ref"]),x=Array.isArray(p),y=g.s.r;y<=g.e.r;++y)for(var E=g.s.c;E<=g.e.c;++E)if(b=Qt({r:y,c:E}),v=x?(p[y]||[])[E]:p[b],!(!v||v.v==null||v.t==="z")){switch(h=["cell",b,"t"],v.t){case"s":case"str":h.push(r(v.v));break;case"n":v.f?(h[2]="vtf",h[3]="n",h[4]=v.v,h[5]=r(v.f)):(h[2]="v",h[3]=v.v);break;case"b":h[2]="vt"+(v.f?"f":"c"),h[3]="nl",h[4]=v.v?"1":"0",h[5]=r(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var N=Jn(kn(v.v));h[2]="vtc",h[3]="nd",h[4]=""+N,h[5]=v.w||$a(v.z||rr[14],N);break;case"e":continue}f.push(h.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(p){return[o,s,l,s,i(p),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),Ru=function(){function t(u,p,f,h,v){v.raw?p[f][h]=u:u===""||(u==="TRUE"?p[f][h]=!0:u==="FALSE"?p[f][h]=!1:isNaN(us(u))?isNaN(Zl(u).getDate())?p[f][h]=u:p[f][h]=kn(u):p[f][h]=us(u))}function r(u,p){var f=p||{},h=[];if(!u||u.length===0)return h;for(var v=u.split(/[\r\n]/),b=v.length-1;b>=0&&v[b].length===0;)--b;for(var g=10,x=0,y=0;y<=b;++y)x=v[y].indexOf(" "),x==-1?x=v[y].length:x++,g=Math.max(g,x);for(y=0;y<=b;++y){h[y]=[];var E=0;for(t(v[y].slice(0,g).trim(),h,y,E,f),E=1;E<=(v[y].length-g)/10+1;++E)t(v[y].slice(g+(E-1)*10,g+E*10).trim(),h,y,E,f)}return f.sheetRows&&(h=h.slice(0,f.sheetRows)),h}var e={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var p={},f=!1,h=0,v=0;h<u.length;++h)(v=u.charCodeAt(h))==34?f=!f:!f&&v in e&&(p[v]=(p[v]||0)+1);v=[];for(h in p)Object.prototype.hasOwnProperty.call(p,h)&&v.push([p[h],h]);if(!v.length){p=n;for(h in p)Object.prototype.hasOwnProperty.call(p,h)&&v.push([p[h],h])}return v.sort(function(b,g){return b[0]-g[0]||n[b[1]]-n[g[1]]}),e[v.pop()[1]]||44}function o(u,p){var f=p||{},h="",v=f.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=a(u.slice(0,1024)):f&&f.FS?h=f.FS:h=a(u.slice(0,1024));var g=0,x=0,y=0,E=0,N=0,I=h.charCodeAt(0),L=!1,H=0,V=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var q=f.dateNF!=null?NO(f.dateNF):null;function K(){var z=u.slice(E,N),W={};if(z.charAt(0)=='"'&&z.charAt(z.length-1)=='"'&&(z=z.slice(1,-1).replace(/""/g,'"')),z.length===0)W.t="z";else if(f.raw)W.t="s",W.v=z;else if(z.trim().length===0)W.t="s",W.v=z;else if(z.charCodeAt(0)==61)z.charCodeAt(1)==34&&z.charCodeAt(z.length-1)==34?(W.t="s",W.v=z.slice(2,-1).replace(/""/g,'"')):aF(z)?(W.t="n",W.f=z.slice(1)):(W.t="s",W.v=z);else if(z=="TRUE")W.t="b",W.v=!0;else if(z=="FALSE")W.t="b",W.v=!1;else if(!isNaN(y=us(z)))W.t="n",f.cellText!==!1&&(W.w=z),W.v=y;else if(!isNaN(Zl(z).getDate())||q&&z.match(q)){W.z=f.dateNF||rr[14];var D=0;q&&z.match(q)&&(z=OO(z,f.dateNF,z.match(q)||[]),D=1),f.cellDates?(W.t="d",W.v=kn(z,D)):(W.t="n",W.v=Jn(kn(z,D))),f.cellText!==!1&&(W.w=$a(W.z,W.v instanceof Date?Jn(W.v):W.v)),f.cellNF||delete W.z}else W.t="s",W.v=z;if(W.t=="z"||(f.dense?(v[g]||(v[g]=[]),v[g][x]=W):v[Qt({c:x,r:g})]=W),E=N+1,V=u.charCodeAt(E),b.e.c<x&&(b.e.c=x),b.e.r<g&&(b.e.r=g),H==I)++x;else if(x=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;N<u.length;++N)switch(H=u.charCodeAt(N)){case 34:V===34&&(L=!L);break;case I:case 10:case 13:if(!L&&K())break e;break}return N-E>0&&K(),v["!ref"]=pr(b),v}function s(u,p){return!(p&&p.PRN)||p.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?o(u,p):ac(r(u,p),p)}function l(u,p){var f="",h=p.type=="string"?[0,0,0,0]:d1(u,p);switch(p.type){case"base64":f=Sa(u);break;case"binary":f=u;break;case"buffer":p.codepage==65001?f=u.toString("utf8"):p.codepage&&typeof Ou<"u"||(f=dr&&Buffer.isBuffer(u)?u.toString("binary"):Vo(u));break;case"array":f=Uo(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+p.type)}return h[0]==239&&h[1]==187&&h[2]==191?f=Fr(f.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?f=Fr(f):p.type=="binary"&&typeof Ou<"u",f.slice(0,19)=="socialcalc:version:"?bM.to_sheet(p.type=="string"?f:Fr(f),p):s(f,p)}function c(u,p){return no(l(u,p),p)}function i(u){for(var p=[],f=Yr(u["!ref"]),h,v=Array.isArray(u),b=f.s.r;b<=f.e.r;++b){for(var g=[],x=f.s.c;x<=f.e.c;++x){var y=Qt({r:b,c:x});if(h=v?(u[b]||[])[x]:u[y],!h||h.v==null){g.push("          ");continue}for(var E=(h.w||(ii(h),h.w)||"").slice(0,10);E.length<10;)E+=" ";g.push(E+(x===0?" ":""))}p.push(g.join(""))}return p.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:i}}();function xM(t,r){var e=r||{},n=!!e.WTF;e.WTF=!0;try{var a=gM.to_workbook(t,e);return e.WTF=n,a}catch(o){if(e.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return Ru.to_workbook(t,r)}}var mu=function(){function t(R,X,Y){if(R){jn(R,R.l||0);for(var ee=Y.Enum||j;R.l<R.length;){var U=R.read_shift(2),Q=ee[U]||ee[65535],P=R.read_shift(2),F=R.l+P,Z=Q.f&&Q.f(R,P,Y);if(R.l=F,X(Z,Q,U))return}}}function r(R,X){switch(X.type){case"base64":return e(ss(Sa(R)),X);case"binary":return e(ss(R),X);case"buffer":case"array":return e(R,X)}throw"Unsupported type "+X.type}function e(R,X){if(!R)return R;var Y=X||{},ee=Y.dense?[]:{},U="Sheet1",Q="",P=0,F={},Z=[],se=[],re={s:{r:0,c:0},e:{r:0,c:0}},ae=Y.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)Y.Enum=j,t(R,function(ne,de,fe){switch(fe){case 0:Y.vers=ne,ne>=4096&&(Y.qpro=!0);break;case 6:re=ne;break;case 204:ne&&(Q=ne);break;case 222:Q=ne;break;case 15:case 51:Y.qpro||(ne[1].v=ne[1].v.slice(1));case 13:case 14:case 16:fe==14&&(ne[2]&112)==112&&(ne[2]&15)>1&&(ne[2]&15)<15&&(ne[1].z=Y.dateNF||rr[14],Y.cellDates&&(ne[1].t="d",ne[1].v=Zf(ne[1].v))),Y.qpro&&ne[3]>P&&(ee["!ref"]=pr(re),F[U]=ee,Z.push(U),ee=Y.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},P=ne[3],U=Q||"Sheet"+(P+1),Q="");var Se=Y.dense?(ee[ne[0].r]||[])[ne[0].c]:ee[Qt(ne[0])];if(Se){Se.t=ne[1].t,Se.v=ne[1].v,ne[1].z!=null&&(Se.z=ne[1].z),ne[1].f!=null&&(Se.f=ne[1].f);break}Y.dense?(ee[ne[0].r]||(ee[ne[0].r]=[]),ee[ne[0].r][ne[0].c]=ne[1]):ee[Qt(ne[0])]=ne[1];break}},Y);else if(R[2]==26||R[2]==14)Y.Enum=B,R[2]==14&&(Y.qpro=!0,R.l=0),t(R,function(ne,de,fe){switch(fe){case 204:U=ne;break;case 22:ne[1].v=ne[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ne[3]>P&&(ee["!ref"]=pr(re),F[U]=ee,Z.push(U),ee=Y.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},P=ne[3],U="Sheet"+(P+1)),ae>0&&ne[0].r>=ae)break;Y.dense?(ee[ne[0].r]||(ee[ne[0].r]=[]),ee[ne[0].r][ne[0].c]=ne[1]):ee[Qt(ne[0])]=ne[1],re.e.c<ne[0].c&&(re.e.c=ne[0].c),re.e.r<ne[0].r&&(re.e.r=ne[0].r);break;case 27:ne[14e3]&&(se[ne[14e3][0]]=ne[14e3][1]);break;case 1537:se[ne[0]]=ne[1],ne[0]==P&&(U=ne[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(ee["!ref"]=pr(re),F[Q||U]=ee,Z.push(Q||U),!se.length)return{SheetNames:Z,Sheets:F};for(var te={},he=[],le=0;le<se.length;++le)F[Z[le]]?(he.push(se[le]||Z[le]),te[se[le]]=F[se[le]]||F[Z[le]]):(he.push(se[le]),te[se[le]]={"!ref":"A1"});return{SheetNames:he,Sheets:te}}function n(R,X){var Y=X||{};if(+Y.codepage>=0&&ls(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var ee=Qp(),U=Yr(R["!ref"]),Q=Array.isArray(R),P=[];es(ee,0,o(1030)),es(ee,6,c(U));for(var F=Math.min(U.e.r,8191),Z=U.s.r;Z<=F;++Z)for(var se=Rn(Z),re=U.s.c;re<=U.e.c;++re){Z===U.s.r&&(P[re]=bn(re));var ae=P[re]+se,te=Q?(R[Z]||[])[re]:R[ae];if(!(!te||te.t=="z"))if(te.t=="n")(te.v|0)==te.v&&te.v>=-32768&&te.v<=32767?es(ee,13,h(Z,re,te.v)):es(ee,14,b(Z,re,te.v));else{var he=ii(te);es(ee,15,p(Z,re,he.slice(0,239)))}}return es(ee,1),ee.end()}function a(R,X){var Y=X||{};if(+Y.codepage>=0&&ls(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var ee=Qp();es(ee,0,s(R));for(var U=0,Q=0;U<R.SheetNames.length;++U)(R.Sheets[R.SheetNames[U]]||{})["!ref"]&&es(ee,27,S(R.SheetNames[U],Q++));var P=0;for(U=0;U<R.SheetNames.length;++U){var F=R.Sheets[R.SheetNames[U]];if(!(!F||!F["!ref"])){for(var Z=Yr(F["!ref"]),se=Array.isArray(F),re=[],ae=Math.min(Z.e.r,8191),te=Z.s.r;te<=ae;++te)for(var he=Rn(te),le=Z.s.c;le<=Z.e.c;++le){te===Z.s.r&&(re[le]=bn(le));var ne=re[le]+he,de=se?(F[te]||[])[le]:F[ne];if(!(!de||de.t=="z"))if(de.t=="n")es(ee,23,K(te,le,P,de.v));else{var fe=ii(de);es(ee,22,H(te,le,P,fe.slice(0,239)))}}++P}}return es(ee,1),ee.end()}function o(R){var X=vn(2);return X.write_shift(2,R),X}function s(R){var X=vn(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var Y=0,ee=0,U=0,Q=0;Q<R.SheetNames.length;++Q){var P=R.SheetNames[Q],F=R.Sheets[P];if(!(!F||!F["!ref"])){++U;var Z=nc(F["!ref"]);Y<Z.e.r&&(Y=Z.e.r),ee<Z.e.c&&(ee=Z.e.c)}}return Y>8191&&(Y=8191),X.write_shift(2,Y),X.write_shift(1,U),X.write_shift(1,ee),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function l(R,X,Y){var ee={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&Y.qpro?(ee.s.c=R.read_shift(1),R.l++,ee.s.r=R.read_shift(2),ee.e.c=R.read_shift(1),R.l++,ee.e.r=R.read_shift(2),ee):(ee.s.c=R.read_shift(2),ee.s.r=R.read_shift(2),X==12&&Y.qpro&&(R.l+=2),ee.e.c=R.read_shift(2),ee.e.r=R.read_shift(2),X==12&&Y.qpro&&(R.l+=2),ee.s.c==65535&&(ee.s.c=ee.e.c=ee.s.r=ee.e.r=0),ee)}function c(R){var X=vn(8);return X.write_shift(2,R.s.c),X.write_shift(2,R.s.r),X.write_shift(2,R.e.c),X.write_shift(2,R.e.r),X}function i(R,X,Y){var ee=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(ee[0].c=R.read_shift(1),ee[3]=R.read_shift(1),ee[0].r=R.read_shift(2),R.l+=2):(ee[2]=R.read_shift(1),ee[0].c=R.read_shift(2),ee[0].r=R.read_shift(2)),ee}function u(R,X,Y){var ee=R.l+X,U=i(R,X,Y);if(U[1].t="s",Y.vers==20768){R.l++;var Q=R.read_shift(1);return U[1].v=R.read_shift(Q,"utf8"),U}return Y.qpro&&R.l++,U[1].v=R.read_shift(ee-R.l,"cstr"),U}function p(R,X,Y){var ee=vn(7+Y.length);ee.write_shift(1,255),ee.write_shift(2,X),ee.write_shift(2,R),ee.write_shift(1,39);for(var U=0;U<ee.length;++U){var Q=Y.charCodeAt(U);ee.write_shift(1,Q>=128?95:Q)}return ee.write_shift(1,0),ee}function f(R,X,Y){var ee=i(R,X,Y);return ee[1].v=R.read_shift(2,"i"),ee}function h(R,X,Y){var ee=vn(7);return ee.write_shift(1,255),ee.write_shift(2,X),ee.write_shift(2,R),ee.write_shift(2,Y,"i"),ee}function v(R,X,Y){var ee=i(R,X,Y);return ee[1].v=R.read_shift(8,"f"),ee}function b(R,X,Y){var ee=vn(13);return ee.write_shift(1,255),ee.write_shift(2,X),ee.write_shift(2,R),ee.write_shift(8,Y,"f"),ee}function g(R,X,Y){var ee=R.l+X,U=i(R,X,Y);if(U[1].v=R.read_shift(8,"f"),Y.qpro)R.l=ee;else{var Q=R.read_shift(2);N(R.slice(R.l,R.l+Q),U),R.l+=Q}return U}function x(R,X,Y){var ee=X&32768;return X&=-32769,X=(ee?R:0)+(X>=8192?X-16384:X),(ee?"":"$")+(Y?bn(X):Rn(X))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},E=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(R,X){jn(R,0);for(var Y=[],ee=0,U="",Q="",P="",F="";R.l<R.length;){var Z=R[R.l++];switch(Z){case 0:Y.push(R.read_shift(8,"f"));break;case 1:Q=x(X[0].c,R.read_shift(2),!0),U=x(X[0].r,R.read_shift(2),!1),Y.push(Q+U);break;case 2:{var se=x(X[0].c,R.read_shift(2),!0),re=x(X[0].r,R.read_shift(2),!1);Q=x(X[0].c,R.read_shift(2),!0),U=x(X[0].r,R.read_shift(2),!1),Y.push(se+re+":"+Q+U)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(R.read_shift(2));break;case 6:{for(var ae="";Z=R[R.l++];)ae+=String.fromCharCode(Z);Y.push('"'+ae.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:F=Y.pop(),P=Y.pop(),Y.push(["AND","OR"][Z-20]+"("+P+","+F+")");break;default:if(Z<32&&E[Z])F=Y.pop(),P=Y.pop(),Y.push(P+E[Z]+F);else if(y[Z]){if(ee=y[Z][1],ee==69&&(ee=R[R.l++]),ee>Y.length){console.error("WK1 bad formula parse 0x"+Z.toString(16)+":|"+Y.join("|")+"|");return}var te=Y.slice(-ee);Y.length-=ee,Y.push(y[Z][0]+"("+te.join(",")+")")}else return Z<=7?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=24?console.error("WK1 unsupported op "+Z.toString(16)):Z<=30?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=115?console.error("WK1 unsupported function opcode "+Z.toString(16)):console.error("WK1 unrecognized opcode "+Z.toString(16))}}Y.length==1?X[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function I(R){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=R.read_shift(2),X[3]=R[R.l++],X[0].c=R[R.l++],X}function L(R,X){var Y=I(R);return Y[1].t="s",Y[1].v=R.read_shift(X-4,"cstr"),Y}function H(R,X,Y,ee){var U=vn(6+ee.length);U.write_shift(2,R),U.write_shift(1,Y),U.write_shift(1,X),U.write_shift(1,39);for(var Q=0;Q<ee.length;++Q){var P=ee.charCodeAt(Q);U.write_shift(1,P>=128?95:P)}return U.write_shift(1,0),U}function V(R,X){var Y=I(R);Y[1].v=R.read_shift(2);var ee=Y[1].v>>1;if(Y[1].v&1)switch(ee&7){case 0:ee=(ee>>3)*5e3;break;case 1:ee=(ee>>3)*500;break;case 2:ee=(ee>>3)/20;break;case 3:ee=(ee>>3)/200;break;case 4:ee=(ee>>3)/2e3;break;case 5:ee=(ee>>3)/2e4;break;case 6:ee=(ee>>3)/16;break;case 7:ee=(ee>>3)/64;break}return Y[1].v=ee,Y}function q(R,X){var Y=I(R),ee=R.read_shift(4),U=R.read_shift(4),Q=R.read_shift(2);if(Q==65535)return ee===0&&U===3221225472?(Y[1].t="e",Y[1].v=15):ee===0&&U===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var P=Q&32768;return Q=(Q&32767)-16446,Y[1].v=(1-P*2)*(U*Math.pow(2,Q+32)+ee*Math.pow(2,Q)),Y}function K(R,X,Y,ee){var U=vn(14);if(U.write_shift(2,R),U.write_shift(1,Y),U.write_shift(1,X),ee==0)return U.write_shift(4,0),U.write_shift(4,0),U.write_shift(2,65535),U;var Q=0,P=0,F=0,Z=0;return ee<0&&(Q=1,ee=-ee),P=Math.log2(ee)|0,ee/=Math.pow(2,P-31),Z=ee>>>0,(Z&2147483648)==0&&(ee/=2,++P,Z=ee>>>0),ee-=Z,Z|=2147483648,Z>>>=0,ee*=Math.pow(2,32),F=ee>>>0,U.write_shift(4,F),U.write_shift(4,Z),P+=16383+(Q?32768:0),U.write_shift(2,P),U}function z(R,X){var Y=q(R);return R.l+=X-14,Y}function W(R,X){var Y=I(R),ee=R.read_shift(4);return Y[1].v=ee>>6,Y}function D(R,X){var Y=I(R),ee=R.read_shift(8,"f");return Y[1].v=ee,Y}function M(R,X){var Y=D(R);return R.l+=X-10,Y}function C(R,X){return R[R.l+X-1]==0?R.read_shift(X,"cstr"):""}function w(R,X){var Y=R[R.l++];Y>X-1&&(Y=X-1);for(var ee="";ee.length<Y;)ee+=String.fromCharCode(R[R.l++]);return ee}function T(R,X,Y){if(!(!Y.qpro||X<21)){var ee=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var U=R.read_shift(X-21,"cstr");return[ee,U]}}function A(R,X){for(var Y={},ee=R.l+X;R.l<ee;){var U=R.read_shift(2);if(U==14e3){for(Y[U]=[0,""],Y[U][0]=R.read_shift(2);R[R.l];)Y[U][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return Y}function S(R,X){var Y=vn(5+R.length);Y.write_shift(2,14e3),Y.write_shift(2,X);for(var ee=0;ee<R.length;++ee){var U=R.charCodeAt(ee);Y[Y.l++]=U>127?95:U}return Y[Y.l++]=0,Y}var j={0:{n:"BOF",f:ln},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:C},222:{n:"SHEETNAMELP",f:w},65535:{n:""}},B={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:q},24:{n:"NUMBER18",f:V},25:{n:"FORMULA19",f:z},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:A},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:W},38:{n:"??"},39:{n:"NUMBER27",f:D},40:{n:"FORMULA28",f:M},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:C},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:T},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:r}}();function yM(t){var r={},e=t.match(Hn),n=0,a=!1;if(e)for(;n!=e.length;++n){var o=Xt(e[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;r.cp=zm[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=o.val;break;case"<sz":r.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":o.rgb&&(r.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return r}var wM=function(){var t=Du("t"),r=Du("rPr");function e(o){var s=o.match(t);if(!s)return{t:"s",v:""};var l={t:"s",v:vr(s[1])},c=o.match(r);return c&&(l.s=yM(c[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(e).filter(function(l){return l.v})}}(),_M=function(){var r=/(\r\n|\n)/g;function e(a,o,s){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),o.push('<span style="'+l.join("")+'">'),a.b&&(o.push("<b>"),s.push("</b>")),a.i&&(o.push("<i>"),s.push("</i>")),a.strike&&(o.push("<s>"),s.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(o.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),a}function n(a){var o=[[],a.v,[]];return a.v?(a.s&&e(a.s,o[0],o[2]),o[0].join("")+o[1].replace(r,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}}(),SM=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,kM=/<(?:\w+:)?r>/,EM=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function a1(t,r){var e=r?r.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=vr(Fr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Fr(t),e&&(n.h=Ym(n.t))):t.match(kM)&&(n.r=Fr(t),n.t=vr(Fr((t.replace(EM,"").match(SM)||[]).join("").replace(Hn,""))),e&&(n.h=_M(wM(n.r)))),n):{t:""}}var TM=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,AM=/<(?:\w+:)?(?:si|sstItem)>/g,CM=/<\/(?:\w+:)?(?:si|sstItem)>/;function NM(t,r){var e=[],n="";if(!t)return e;var a=t.match(TM);if(a){n=a[2].replace(AM,"").split(CM);for(var o=0;o!=n.length;++o){var s=a1(n[o].trim(),r);s!=null&&(e[e.length]=s)}a=Xt(a[1]),e.Count=a.count,e.Unique=a.uniqueCount}return e}function OM(t){return[t.read_shift(4),t.read_shift(4)]}function jM(t,r){var e=[],n=!1;return ci(t,function(o,s,l){switch(l){case 159:e.Count=o[0],e.Unique=o[1];break;case 19:e.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),e}function c4(t){for(var r=[],e=t.split(""),n=0;n<e.length;++n)r[n]=e[n].charCodeAt(0);return r}function si(t,r){var e={};return e.Major=t.read_shift(2),e.Minor=t.read_shift(2),r>=4&&(t.l+=r-4),e}function DM(t){var r={};return r.id=t.read_shift(0,"lpp4"),r.R=si(t,4),r.U=si(t,4),r.W=si(t,4),r}function MM(t){for(var r=t.read_shift(4),e=t.l+r-4,n={},a=t.read_shift(4),o=[];a-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=o,t.l!=e)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+e);return n}function RM(t){var r=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)r.push(MM(t));return r}function FM(t){var r=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)r.push(t.read_shift(0,"lpp4"));return r}function IM(t){var r={};return t.read_shift(4),t.l+=4,r.id=t.read_shift(0,"lpp4"),r.name=t.read_shift(0,"lpp4"),r.R=si(t,4),r.U=si(t,4),r.W=si(t,4),r}function PM(t){var r=IM(t);if(r.ename=t.read_shift(0,"8lpp4"),r.blksz=t.read_shift(4),r.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function u4(t,r){var e=t.l+r,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(e-t.l>>1,"utf16le"),t.l=e,n}function d4(t,r){var e={},n=t.l+r;return t.l+=4,e.Salt=t.slice(t.l,t.l+16),t.l+=16,e.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),e.VerifierHash=t.slice(t.l,n),t.l=n,e}function LM(t){var r=si(t);switch(r.Minor){case 2:return[r.Minor,BM(t)];case 3:return[r.Minor,UM()];case 4:return[r.Minor,zM(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function BM(t){var r=t.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var e=t.read_shift(4),n=u4(t,e),a=d4(t,t.length-t.l);return{t:"Std",h:n,v:a}}function UM(){throw new Error("File is password-protected: ECMA-376 Extensible")}function zM(t){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var e=t.read_shift(t.length-t.l,"utf8"),n={};return e.replace(Hn,function(o){var s=Xt(o);switch(Fs(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(l){n[l]=s[l]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function $M(t,r){var e={},n=e.EncryptionVersionInfo=si(t,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);e.Flags=t.read_shift(4),r-=4;var a=t.read_shift(4);return r-=4,e.EncryptionHeader=u4(t,a),r-=a,e.EncryptionVerifier=d4(t,r),e}function VM(t){var r={},e=r.EncryptionVersionInfo=si(t,4);if(e.Major!=1||e.Minor!=1)throw"unrecognized version code "+e.Major+" : "+e.Minor;return r.Salt=t.read_shift(16),r.EncryptedVerifier=t.read_shift(16),r.EncryptedVerifierHash=t.read_shift(16),r}function HM(t){var r=0,e,n=c4(t),a=n.length+1,o,s,l,c,i;for(e=eo(a),e[0]=n.length,o=1;o!=a;++o)e[o]=n[o-1];for(o=a-1;o>=0;--o)s=e[o],l=(r&16384)===0?0:1,c=r<<1&32767,i=l|c,r=i^s;return r^52811}var f4=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,l){return n(s^l)},o=function(s){for(var l=r[s.length-1],c=104,i=s.length-1;i>=0;--i)for(var u=s[i],p=0;p!=7;++p)u&64&&(l^=e[c]),u*=2,--c;return l};return function(s){for(var l=c4(s),c=o(l),i=l.length,u=eo(16),p=0;p!=16;++p)u[p]=0;var f,h,v;for((i&1)===1&&(f=c>>8,u[i]=a(t[0],f),--i,f=c&255,h=l[l.length-1],u[i]=a(h,f));i>0;)--i,f=c>>8,u[i]=a(l[i],f),--i,f=c&255,u[i]=a(l[i],f);for(i=15,v=15-l.length;v>0;)f=c>>8,u[i]=a(t[v],f),--i,--v,f=c&255,u[i]=a(l[i],f),--i,--v;return u}}(),qM=function(t,r,e,n,a){a||(a=r),n||(n=f4(t));var o,s;for(o=0;o!=r.length;++o)s=r[o],s^=n[e],s=(s>>5|s<<3)&255,a[o]=s,++e;return[a,e,n]},WM=function(t){var r=0,e=f4(t);return function(n){var a=qM("",n,r,e);return r=a[1],a[0]}};function GM(t,r,e,n){var a={key:ln(t),verificationBytes:ln(t)};return e.password&&(a.verifier=HM(e.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=WM(e.password)),a}function YM(t,r,e){var n=e||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=VM(t):n.Data=$M(t,r),n}function XM(t,r,e){var n={Type:e.biff>=8?t.read_shift(2):0};return n.Type?YM(t,r-2,n):GM(t,e.biff>=8?r:r-2,e,n),n}var KM=function(){function t(a,o){switch(o.type){case"base64":return r(Sa(a),o);case"binary":return r(a,o);case"buffer":return r(dr&&Buffer.isBuffer(a)?a.toString("binary"):Vo(a),o);case"array":return r(Uo(a),o)}throw new Error("Unrecognized type "+o.type)}function r(a,o){var s=o||{},l=s.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var i={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,p){Array.isArray(l)&&(l[p]=[]);for(var f=/\\\w+\b/g,h=0,v,b=-1;v=f.exec(u);){switch(v[0]){case"\\cell":var g=u.slice(h,f.lastIndex-v[0].length);if(g[0]==" "&&(g=g.slice(1)),++b,g.length){var x={v:g,t:"s"};Array.isArray(l)?l[p][b]=x:l[Qt({r:p,c:b})]=x}break}h=f.lastIndex}b>i.e.c&&(i.e.c=b)}),l["!ref"]=pr(i),l}function e(a,o){return no(t(a,o),o)}function n(a){for(var o=["{\\rtf1\\ansi"],s=Yr(a["!ref"]),l,c=Array.isArray(a),i=s.s.r;i<=s.e.r;++i){o.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)o.push("\\cellx"+(u+1));for(o.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var p=Qt({r:i,c:u});l=c?(a[i]||[])[u]:a[p],!(!l||l.v==null&&(!l.f||l.F))&&(o.push(" "+(l.w||(ii(l),l.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:e,to_sheet:t,from_sheet:n}}();function ZM(t){var r=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Fu(t){for(var r=0,e=1;r!=3;++r)e=e*256+(t[r]>255?255:t[r]<0?0:t[r]);return e.toString(16).toUpperCase().slice(1)}function JM(t){var r=t[0]/255,e=t[1]/255,n=t[2]/255,a=Math.max(r,e,n),o=Math.min(r,e,n),s=a-o;if(s===0)return[0,0,r];var l=0,c=0,i=a+o;switch(c=s/(i>1?2-i:i),a){case r:l=((e-n)/s+6)%6;break;case e:l=(n-r)/s+2;break;case n:l=(r-e)/s+4;break}return[l/6,c,i/2]}function QM(t){var r=t[0],e=t[1],n=t[2],a=e*2*(n<.5?n:1-n),o=n-a/2,s=[o,o,o],l=6*r,c;if(e!==0)switch(l|0){case 0:case 6:c=a*l,s[0]+=a,s[1]+=c;break;case 1:c=a*(2-l),s[0]+=c,s[1]+=a;break;case 2:c=a*(l-2),s[1]+=a,s[2]+=c;break;case 3:c=a*(4-l),s[1]+=c,s[2]+=a;break;case 4:c=a*(l-4),s[2]+=a,s[0]+=c;break;case 5:c=a*(6-l),s[2]+=c,s[0]+=a;break}for(var i=0;i!=3;++i)s[i]=Math.round(s[i]*255);return s}function Ff(t,r){if(r===0)return t;var e=JM(ZM(t));return r<0?e[2]=e[2]*(1+r):e[2]=1-(1-e[2])*(1-r),Fu(QM(e))}var h4=6,eR=15,tR=1,Xn=h4;function If(t){return Math.floor((t+Math.round(128/Xn)/256)*Xn)}function Pf(t){return Math.floor((t-5)/Xn*100+.5)/100}function nm(t){return Math.round((t*Xn+5)/Xn*256)/256}function Sp(t){return nm(Pf(If(t)))}function s1(t){var r=Math.abs(t-Sp(t)),e=Xn;if(r>.005)for(Xn=tR;Xn<eR;++Xn)Math.abs(t-Sp(t))<=r&&(r=Math.abs(t-Sp(t)),e=Xn);Xn=e}function Jl(t){t.width?(t.wpx=If(t.width),t.wch=Pf(t.wpx),t.MDW=Xn):t.wpx?(t.wch=Pf(t.wpx),t.width=nm(t.wch),t.MDW=Xn):typeof t.wch=="number"&&(t.width=nm(t.wch),t.wpx=If(t.width),t.MDW=Xn),t.customWidth&&delete t.customWidth}var rR=96,p4=rR;function m4(t){return t*96/p4}function Iu(t){return t*p4/96}var nR={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function aR(t,r,e,n){r.Borders=[];var a={},o=!1;(t[0].match(Hn)||[]).forEach(function(s){var l=Xt(s);switch(Fs(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=Lr(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=Lr(l.diagonalDown)),r.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+l[0]+" in borders")}})}function sR(t,r,e,n){r.Fills=[];var a={},o=!1;(t[0].match(Hn)||[]).forEach(function(s){var l=Xt(s);switch(Fs(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},r.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+l[0]+" in fills")}})}function iR(t,r,e,n){r.Fonts=[];var a={},o=!1;(t[0].match(Hn)||[]).forEach(function(s){var l=Xt(s);switch(Fs(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=Fr(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?Lr(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?Lr(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?Lr(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?Lr(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?Lr(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?Lr(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?Lr(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=zm[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=Lr(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var c=Lo[a.color.index];a.color.index==81&&(c=Lo[1]),c||(c=Lo[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&e.themeElements&&e.themeElements.clrScheme&&(a.color.rgb=Ff(e.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+l[0]+" in fonts")}})}function oR(t,r,e){r.NumberFmt=[];for(var n=Ds(rr),a=0;a<n.length;++a)r.NumberFmt[n[a]]=rr[n[a]];var o=t[0].match(Hn);if(o)for(a=0;a<o.length;++a){var s=Xt(o[a]);switch(Fs(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=vr(Fr(s.formatCode)),c=parseInt(s.numFmtId,10);if(r.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&r.NumberFmt[c]!=null;--c);r.NumberFmt[c]=l}Po(l,c)}}break;case"</numFmt>":break;default:if(e.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var xf=["numFmtId","fillId","fontId","borderId","xfId"],yf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function lR(t,r,e){r.CellXf=[];var n,a=!1;(t[0].match(Hn)||[]).forEach(function(o){var s=Xt(o),l=0;switch(Fs(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],l=0;l<xf.length;++l)n[xf[l]]&&(n[xf[l]]=parseInt(n[xf[l]],10));for(l=0;l<yf.length;++l)n[yf[l]]&&(n[yf[l]]=Lr(n[yf[l]]));if(r.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[l]){n.numFmtId=l;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=Lr(s.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(e&&e.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var cR=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,i){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=l.match(r))&&oR(p,u,i),(p=l.match(a))&&iR(p,u,c,i),(p=l.match(n))&&sR(p,u,c,i),(p=l.match(o))&&aR(p,u,c,i),(p=l.match(e))&&lR(p,u,i),u}}();function uR(t,r){var e=t.read_shift(2),n=$n(t);return[e,n]}function dR(t,r,e){var n={};n.sz=t.read_shift(2)/20;var a=wj(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var o=t.read_shift(2);switch(o===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=t.read_shift(1);s!=0&&(n.underline=s);var l=t.read_shift(1);l>0&&(n.family=l);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=yj(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=$n(t),n}var fR=Vn;function hR(t,r){var e=t.l+r,n=t.read_shift(2),a=t.read_shift(2);return t.l=e,{ixfe:n,numFmtId:a}}var pR=Vn;function mR(t,r,e){var n={};n.NumberFmt=[];for(var a in rr)n.NumberFmt[a]=rr[a];n.CellXf=[],n.Fonts=[];var o=[],s=!1;return ci(t,function(c,i,u){switch(u){case 44:n.NumberFmt[c[0]]=c[1],Po(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(c.color.rgb=Ff(r.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:o.push(u),s=!0;break;case 38:o.pop(),s=!1;break;default:if(i.T>0)o.push(u);else if(i.T<0)o.pop();else if(!s||e.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var gR=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function vR(t,r,e){r.themeElements.clrScheme=[];var n={};(t[0].match(Hn)||[]).forEach(function(a){var o=Xt(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(r.themeElements.clrScheme[gR.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function bR(){}function xR(){}var yR=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,wR=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,_R=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function SR(t,r,e){r.themeElements={};var n;[["clrScheme",yR,vR],["fontScheme",wR,bR],["fmtScheme",_R,xR]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,r,e)})}var kR=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function g4(t,r){(!t||t.length===0)&&(t=ER());var e,n={};if(!(e=t.match(kR)))throw new Error("themeElements not found in theme");return SR(e[0],n,r),n.raw=t,n}function ER(t,r){var e=[A_];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function TR(t,r,e){var n=t.l+r,a=t.read_shift(4);if(a!==124226){if(!e.cellStyles){t.l=n;return}var o=t.slice(t.l);t.l=n;var s;try{s=T_(o,{type:"array"})}catch{return}var l=wa(s,"theme/theme/theme1.xml",!0);if(l)return g4(l,e)}}function AR(t){return t.read_shift(4)}function CR(t){var r={};switch(r.xclrType=t.read_shift(2),r.nTintShade=t.read_shift(2),r.xclrType){case 0:t.l+=4;break;case 1:r.xclrValue=NR(t,4);break;case 2:r.xclrValue=r4(t);break;case 3:r.xclrValue=AR(t);break;case 4:t.l+=4;break}return t.l+=8,r}function NR(t,r){return Vn(t,r)}function OR(t,r){return Vn(t,r)}function jR(t){var r=t.read_shift(2),e=t.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=CR(t);break;case 6:n[1]=OR(t,e);break;case 14:case 15:n[1]=t.read_shift(e===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+e)}return n}function DR(t,r){var e=t.l+r;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),o=[];a-- >0;)o.push(jR(t,e-t.l));return{ixfe:n,ext:o}}function MR(t,r){r.forEach(function(e){e[0]})}function RR(t,r){return{flags:t.read_shift(4),version:t.read_shift(4),name:$n(t)}}function FR(t){for(var r=[],e=t.read_shift(4);e-- >0;)r.push([t.read_shift(4),t.read_shift(4)]);return r}function IR(t){return t.l+=4,t.read_shift(4)!=0}function PR(t,r,e){var n={Types:[],Cell:[],Value:[]},a=e||{},o=[],s=!1,l=2;return ci(t,function(c,i,u){switch(u){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(p){l==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):l==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:o.push(u),s=!0;break;case 36:o.pop(),s=!1;break;default:if(!i.T){if(!s||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function LR(t,r,e){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,o=2,s;return t.replace(Hn,function(l){var c=Xt(l);switch(Fs(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var i=0;i<n.Types.length;++i)n.Types[i].name==c.name&&(s=n.Types[i]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):o==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!a&&e.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function BR(t){var r=[];if(!t)return r;var e=1;return(t.match(Hn)||[]).forEach(function(n){var a=Xt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?e=a.i:a.i=e,r.push(a);break}}),r}function UR(t){var r={};r.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),r.r=Qt(e);var n=t.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function zR(t,r,e){var n=[];return ci(t,function(o,s,l){switch(l){case 63:n.push(o);break;default:if(!s.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function $R(t,r,e,n){if(!t)return t;var a=n||{},o=!1;ci(t,function(l,c,i){switch(i){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!c.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}}},a)}function VR(t,r){if(!t)return"??";var e=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][e].Target}function M2(t,r,e,n){var a=Array.isArray(t),o;r.forEach(function(s){var l=Kn(s.ref);if(a?(t[l.r]||(t[l.r]=[]),o=t[l.r][l.c]):o=t[s.ref],!o){o={t:"z"},a?t[l.r][l.c]=o:t[s.ref]=o;var c=Yr(t["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var i=pr(c);i!==t["!ref"]&&(t["!ref"]=i)}o.c||(o.c=[]);var u={a:s.author,t:s.t,r:s.r,T:e};s.h&&(u.h=s.h);for(var p=o.c.length-1;p>=0;--p){if(!e&&o.c[p].T)return;e&&!o.c[p].T&&o.c.splice(p,1)}if(e&&n){for(p=0;p<n.length;++p)if(u.a==n[p].id){u.a=n[p].name||u.a;break}}o.c.push(u)})}function HR(t,r){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var l=s.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&e.push(l[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var l=s.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Xt(l[0]),i={author:c.authorId&&e[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=Kn(c.ref);if(!(r.sheetRows&&r.sheetRows<=u.r)){var p=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!p&&!!p[1]&&a1(p[1])||{r:"",t:"",h:""};i.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),i.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(i.h=f.h),n.push(i)}}}}),n}function qR(t,r){var e=[],n=!1,a={},o=0;return t.replace(Hn,function(l,c){var i=Xt(l);switch(Fs(i[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:i.personId,guid:i.id,ref:i.ref,T:1};break;case"</threadedComment>":a.t!=null&&e.push(a);break;case"<text>":case"<text":o=c+l.length;break;case"</text>":a.t=t.slice(o,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return l}),e}function WR(t,r){var e=[],n=!1;return t.replace(Hn,function(o){var s=Xt(o);switch(Fs(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":e.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return o}),e}function GR(t){var r={};r.iauthor=t.read_shift(4);var e=qo(t);return r.rfx=e.s,r.ref=Qt(e.s),t.l+=16,r}var YR=$n;function XR(t,r){var e=[],n=[],a={},o=!1;return ci(t,function(l,c,i){switch(i){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,r.sheetRows&&a.rfx&&r.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,e.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!o||r.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}}}),e}var KR="application/vnd.ms-office.vbaProject";function ZR(t){var r=hr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(e,n){if(!(e.slice(-1)==="/"||!e.match(/_VBA_PROJECT_CUR/))){var a=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");hr.utils.cfb_add(r,a,t.FileIndex[n].content)}}),hr.write(r)}function JR(){return{"!type":"dialog"}}function QR(){return{"!type":"dialog"}}function eF(){return{"!type":"macro"}}function tF(){return{"!type":"macro"}}var Gl=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function e(n,a,o,s){var l=!1,c=!1;o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1)),s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1));var i=o.length>0?parseInt(o,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return l?u+=r.c:--u,c?i+=r.r:--i,a+(l?"":"$")+bn(u)+(c?"":"$")+Rn(i)}return function(a,o){return r=o,a.replace(t,e)}}(),v4=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,rF=function(){return function(r,e){return r.replace(v4,function(n,a,o,s,l,c){var i=Jm(s)-(o?0:e.c),u=Zm(c)-(l?0:e.r),p=u==0?"":l?u+1:"["+u+"]",f=i==0?"":o?i+1:"["+i+"]";return a+"R"+p+"C"+f})}}();function b4(t,r){return t.replace(v4,function(e,n,a,o,s,l){return n+(a=="$"?a+o:bn(Jm(o)+r.c))+(s=="$"?s+l:Rn(Zm(l)+r.r))})}function nF(t,r,e){var n=nc(r),a=n.s,o=Kn(e),s={r:o.r-a.r,c:o.c-a.c};return b4(t,s)}function aF(t){return t.length!=1}function R2(t){return t.replace(/_xlfn\./g,"")}function sn(t){t.l+=1}function to(t,r){var e=t.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function x4(t,r,e){var n=2;if(e){if(e.biff>=2&&e.biff<=5)return y4(t);e.biff==12&&(n=4)}var a=t.read_shift(n),o=t.read_shift(n),s=to(t),l=to(t);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:o,c:l[0],cRel:l[1],rRel:l[2]}}}function y4(t){var r=to(t),e=to(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:e[0],c:a,cRel:e[1],rRel:e[2]}}}function sF(t,r,e){if(e.biff<8)return y4(t);var n=t.read_shift(e.biff==12?4:2),a=t.read_shift(e.biff==12?4:2),o=to(t),s=to(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function w4(t,r,e){if(e&&e.biff>=2&&e.biff<=5)return iF(t);var n=t.read_shift(e&&e.biff==12?4:2),a=to(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function iF(t){var r=to(t),e=t.read_shift(1);return{r:r[0],c:e,cRel:r[1],rRel:r[2]}}function oF(t){var r=t.read_shift(2),e=t.read_shift(2);return{r,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function lF(t,r,e){var n=e&&e.biff?e.biff:8;if(n>=2&&n<=5)return cF(t);var a=t.read_shift(n>=12?4:2),o=t.read_shift(2),s=(o&16384)>>14,l=(o&32768)>>15;if(o&=16383,l==1)for(;a>524287;)a-=1048576;if(s==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:s,rRel:l}}function cF(t){var r=t.read_shift(2),e=t.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&e>=128&&(e=e-256),{r,c:e,cRel:a,rRel:n}}function uF(t,r,e){var n=(t[t.l++]&96)>>5,a=x4(t,e.biff>=2&&e.biff<=5?6:8,e);return[n,a]}function dF(t,r,e){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),o=8;if(e)switch(e.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var s=x4(t,o,e);return[n,a,s]}function fF(t,r,e){var n=(t[t.l++]&96)>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[n]}function hF(t,r,e){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=8;if(e)switch(e.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[n,a]}function pF(t,r,e){var n=(t[t.l++]&96)>>5,a=sF(t,r-1,e);return[n,a]}function mF(t,r,e){var n=(t[t.l++]&96)>>5;return t.l+=e.biff==2?6:e.biff==12?14:7,[n]}function F2(t){var r=t[t.l+1]&1,e=1;return t.l+=4,[r,e]}function gF(t,r,e){t.l+=2;for(var n=t.read_shift(e&&e.biff==2?1:2),a=[],o=0;o<=n;++o)a.push(t.read_shift(e&&e.biff==2?1:2));return a}function vF(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(e&&e.biff==2?1:2)]}function bF(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(e&&e.biff==2?1:2)]}function xF(t){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(2)]}function yF(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=e&&e.biff==2?3:4,[n]}function _4(t){var r=t.read_shift(1),e=t.read_shift(1);return[r,e]}function wF(t){return t.read_shift(2),_4(t)}function _F(t){return t.read_shift(2),_4(t)}function SF(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var a=w4(t,0,e);return[n,a]}function kF(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var a=lF(t,0,e);return[n,a]}function EF(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);e&&e.biff==5&&(t.l+=12);var o=w4(t,0,e);return[n,a,o]}function TF(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(e&&e.biff<=3?1:2);return[AI[a],E4[a],n]}function AF(t,r,e){var n=t[t.l++],a=t.read_shift(1),o=e&&e.biff<=3?[n==88?-1:0,t.read_shift(1)]:CF(t);return[a,(o[0]===0?E4:TI)[o[1]]]}function CF(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function NF(t,r,e){t.l+=e&&e.biff==2?3:4}function OF(t,r,e){if(t.l++,e&&e.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(e&&e.biff==2?1:2);return[n,a]}function jF(t){return t.l++,Wo[t.read_shift(1)]}function DF(t){return t.l++,t.read_shift(2)}function MF(t){return t.l++,t.read_shift(1)!==0}function RF(t){return t.l++,Un(t)}function FF(t,r,e){return t.l++,Gu(t,r-1,e)}function IF(t,r){var e=[t.read_shift(1)];if(r==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=Zr(t,1)?"TRUE":"FALSE",r!=12&&(t.l+=7);break;case 37:case 16:e[1]=Wo[t[t.l]],t.l+=r==12?4:8;break;case 0:t.l+=8;break;case 1:e[1]=Un(t);break;case 2:e[1]=Go(t,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function PF(t,r,e){for(var n=t.read_shift(e.biff==12?4:2),a=[],o=0;o!=n;++o)a.push((e.biff==12?qo:Jf)(t));return a}function LF(t,r,e){var n=0,a=0;e.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--n,--a==0&&(a=256));for(var o=0,s=[];o!=n&&(s[o]=[]);++o)for(var l=0;l!=a;++l)s[o][l]=IF(t,e.biff);return s}function BF(t,r,e){var n=t.read_shift(1)>>>5&3,a=!e||e.biff>=8?4:2,o=t.read_shift(a);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,o]}function UF(t,r,e){if(e.biff==5)return zF(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),o=t.read_shift(4);return[n,a,o]}function zF(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[r,e,n]}function $F(t,r,e){var n=t.read_shift(1)>>>5&3;t.l+=e&&e.biff==2?3:4;var a=t.read_shift(e&&e.biff==2?1:2);return[n,a]}function VF(t,r,e){var n=t.read_shift(1)>>>5&3,a=t.read_shift(e&&e.biff==2?1:2);return[n,a]}function HF(t,r,e){var n=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,e.biff==12&&(t.l+=2),[n]}function qF(t,r,e){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=4;if(e)switch(e.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[n,a]}var WF=Vn,GF=Vn,YF=Vn;function Xu(t,r,e){return t.l+=2,[oF(t)]}function i1(t){return t.l+=6,[]}var XF=Xu,KF=i1,ZF=i1,JF=Xu;function S4(t){return t.l+=2,[ln(t),t.read_shift(2)&1]}var QF=Xu,eI=S4,tI=i1,rI=Xu,nI=Xu,aI=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function sI(t){t.l+=2;var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),o=t.read_shift(2),s=aI[e>>2&31];return{ixti:r,coltype:e&3,rt:s,idx:n,c:a,C:o}}function iI(t){return t.l+=2,[t.read_shift(4)]}function oI(t,r,e){return t.l+=5,t.l+=2,t.l+=e.biff==2?1:4,["PTGSHEET"]}function lI(t,r,e){return t.l+=e.biff==2?4:5,["PTGENDSHEET"]}function cI(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function uI(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function dI(t){return t.l+=4,[0,0]}var I2={1:{n:"PtgExp",f:OF},2:{n:"PtgTbl",f:YF},3:{n:"PtgAdd",f:sn},4:{n:"PtgSub",f:sn},5:{n:"PtgMul",f:sn},6:{n:"PtgDiv",f:sn},7:{n:"PtgPower",f:sn},8:{n:"PtgConcat",f:sn},9:{n:"PtgLt",f:sn},10:{n:"PtgLe",f:sn},11:{n:"PtgEq",f:sn},12:{n:"PtgGe",f:sn},13:{n:"PtgGt",f:sn},14:{n:"PtgNe",f:sn},15:{n:"PtgIsect",f:sn},16:{n:"PtgUnion",f:sn},17:{n:"PtgRange",f:sn},18:{n:"PtgUplus",f:sn},19:{n:"PtgUminus",f:sn},20:{n:"PtgPercent",f:sn},21:{n:"PtgParen",f:sn},22:{n:"PtgMissArg",f:sn},23:{n:"PtgStr",f:FF},26:{n:"PtgSheet",f:oI},27:{n:"PtgEndSheet",f:lI},28:{n:"PtgErr",f:jF},29:{n:"PtgBool",f:MF},30:{n:"PtgInt",f:DF},31:{n:"PtgNum",f:RF},32:{n:"PtgArray",f:mF},33:{n:"PtgFunc",f:TF},34:{n:"PtgFuncVar",f:AF},35:{n:"PtgName",f:BF},36:{n:"PtgRef",f:SF},37:{n:"PtgArea",f:uF},38:{n:"PtgMemArea",f:$F},39:{n:"PtgMemErr",f:WF},40:{n:"PtgMemNoMem",f:GF},41:{n:"PtgMemFunc",f:VF},42:{n:"PtgRefErr",f:HF},43:{n:"PtgAreaErr",f:fF},44:{n:"PtgRefN",f:kF},45:{n:"PtgAreaN",f:pF},46:{n:"PtgMemAreaN",f:cI},47:{n:"PtgMemNoMemN",f:uI},57:{n:"PtgNameX",f:UF},58:{n:"PtgRef3d",f:EF},59:{n:"PtgArea3d",f:dF},60:{n:"PtgRefErr3d",f:qF},61:{n:"PtgAreaErr3d",f:hF},255:{}},fI={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},hI={1:{n:"PtgElfLel",f:S4},2:{n:"PtgElfRw",f:rI},3:{n:"PtgElfCol",f:XF},6:{n:"PtgElfRwV",f:nI},7:{n:"PtgElfColV",f:JF},10:{n:"PtgElfRadical",f:QF},11:{n:"PtgElfRadicalS",f:tI},13:{n:"PtgElfColS",f:KF},15:{n:"PtgElfColSV",f:ZF},16:{n:"PtgElfRadicalLel",f:eI},25:{n:"PtgList",f:sI},29:{n:"PtgSxName",f:iI},255:{}},pI={0:{n:"PtgAttrNoop",f:dI},1:{n:"PtgAttrSemi",f:yF},2:{n:"PtgAttrIf",f:bF},4:{n:"PtgAttrChoose",f:gF},8:{n:"PtgAttrGoto",f:vF},16:{n:"PtgAttrSum",f:NF},32:{n:"PtgAttrBaxcel",f:F2},33:{n:"PtgAttrBaxcel",f:F2},64:{n:"PtgAttrSpace",f:wF},65:{n:"PtgAttrSpaceSemi",f:_F},128:{n:"PtgAttrIfError",f:xF},255:{}};function Ku(t,r,e,n){if(n.biff<8)return Vn(t,r);for(var a=t.l+r,o=[],s=0;s!==e.length;++s)switch(e[s][0]){case"PtgArray":e[s][1]=LF(t,0,n),o.push(e[s][1]);break;case"PtgMemArea":e[s][2]=PF(t,e[s][1],n),o.push(e[s][2]);break;case"PtgExp":n&&n.biff==12&&(e[s][1][1]=t.read_shift(4),o.push(e[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[s][0]}return r=a-t.l,r!==0&&o.push(Vn(t,r)),o}function Zu(t,r,e){for(var n=t.l+r,a,o,s=[];n!=t.l;)r=n-t.l,o=t[t.l],a=I2[o]||I2[fI[o]],(o===24||o===25)&&(a=(o===24?hI:pI)[t[t.l+1]]),!a||!a.f?Vn(t,r):s.push([a.n,a.f(t,r,e)]);return s}function mI(t){for(var r=[],e=0;e<t.length;++e){for(var n=t[e],a=[],o=0;o<n.length;++o){var s=n[o];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var gI={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function vI(t,r){if(!t&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function k4(t,r,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[r]))return t.SheetNames[r];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[r];if(e.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":t.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(e.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return e.SID!=null?t.SheetNames[e.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function P2(t,r,e){var n=k4(t,r,e);return n=="#REF"?n:vI(n,e)}function Bn(t,r,e,n,a){var o=a&&a.biff||8,s={s:{c:0,r:0}},l=[],c,i,u,p=0,f=0,h,v="";if(!t[0]||!t[0][0])return"";for(var b=-1,g="",x=0,y=t[0].length;x<y;++x){var E=t[0][x];switch(E[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),i=l.pop(),b>=0){switch(t[0][b][1][0]){case 0:g=Gr(" ",t[0][b][1][1]);break;case 1:g=Gr("\r",t[0][b][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][b][1][0])}i=i+g,b=-1}l.push(i+gI[E[0]]+c);break;case"PtgIsect":c=l.pop(),i=l.pop(),l.push(i+" "+c);break;case"PtgUnion":c=l.pop(),i=l.pop(),l.push(i+","+c);break;case"PtgRange":c=l.pop(),i=l.pop(),l.push(i+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=du(E[1][1],s,a),l.push(fu(u,o));break;case"PtgRefN":u=e?du(E[1][1],e,a):E[1][1],l.push(fu(u,o));break;case"PtgRef3d":p=E[1][1],u=du(E[1][2],s,a),v=P2(n,p,a),l.push(v+"!"+fu(u,o));break;case"PtgFunc":case"PtgFuncVar":var N=E[1][0],I=E[1][1];N||(N=0),N&=127;var L=N==0?[]:l.slice(-N);l.length-=N,I==="User"&&(I=L.shift()),l.push(I+"("+L.join(",")+")");break;case"PtgBool":l.push(E[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(E[1]);break;case"PtgNum":l.push(String(E[1]));break;case"PtgStr":l.push('"'+E[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(E[1]);break;case"PtgAreaN":h=v2(E[1][1],e?{s:e}:s,a),l.push(wp(h,a));break;case"PtgArea":h=v2(E[1][1],s,a),l.push(wp(h,a));break;case"PtgArea3d":p=E[1][1],h=E[1][2],v=P2(n,p,a),l.push(v+"!"+wp(h,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=E[1][2];var H=(n.names||[])[f-1]||(n[0]||[])[f],V=H?H.Name:"SH33TJSNAME"+String(f);V&&V.slice(0,6)=="_xlfn."&&!a.xlfn&&(V=V.slice(6)),l.push(V);break;case"PtgNameX":var q=E[1][1];f=E[1][2];var K;if(a.biff<=5)q<0&&(q=-q),n[q]&&(K=n[q][f]);else{var z="";if(((n[q]||[])[0]||[])[0]==14849||(((n[q]||[])[0]||[])[0]==1025?n[q][f]&&n[q][f].itab>0&&(z=n.SheetNames[n[q][f].itab-1]+"!"):z=n.SheetNames[f-1]+"!"),n[q]&&n[q][f])z+=n[q][f].Name;else if(n[0]&&n[0][f])z+=n[0][f].Name;else{var W=(k4(n,q,a)||"").split(";;");W[f-1]?z=W[f-1]:z+="SH33TJSERRX"}l.push(z);break}K||(K={Name:"SH33TJSERRY"}),l.push(K.Name);break;case"PtgParen":var D="(",M=")";if(b>=0){switch(g="",t[0][b][1][0]){case 2:D=Gr(" ",t[0][b][1][1])+D;break;case 3:D=Gr("\r",t[0][b][1][1])+D;break;case 4:M=Gr(" ",t[0][b][1][1])+M;break;case 5:M=Gr("\r",t[0][b][1][1])+M;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][b][1][0])}b=-1}l.push(D+l.pop()+M);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:E[1][1],r:E[1][0]};var C={c:e.c,r:e.r};if(n.sharedf[Qt(u)]){var w=n.sharedf[Qt(u)];l.push(Bn(w,s,C,n,a))}else{var T=!1;for(c=0;c!=n.arrayf.length;++c)if(i=n.arrayf[c],!(u.c<i[0].s.c||u.c>i[0].e.c)&&!(u.r<i[0].s.r||u.r>i[0].e.r)){l.push(Bn(i[1],s,C,n,a)),T=!0;break}T||l.push(E[1])}break;case"PtgArray":l.push("{"+mI(E[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+E[1].idx+"[#"+E[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(E));default:throw new Error("Unrecognized Formula Token: "+String(E))}var A=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&b>=0&&A.indexOf(t[0][x][0])==-1){E=t[0][b];var S=!0;switch(E[1][0]){case 4:S=!1;case 0:g=Gr(" ",E[1][1]);break;case 5:S=!1;case 1:g=Gr("\r",E[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+E[1][0])}l.push((S?g:"")+l.pop()+(S?"":g)),b=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function bI(t,r,e){var n=t.l+r,a=e.biff==2?1:2,o,s=t.read_shift(a);if(s==65535)return[[],Vn(t,r-2)];var l=Zu(t,s,e);return r!==s+a&&(o=Ku(t,r-s-a,l,e)),t.l=n,[l,o]}function xI(t,r,e){var n=t.l+r,a=e.biff==2?1:2,o,s=t.read_shift(a);if(s==65535)return[[],Vn(t,r-2)];var l=Zu(t,s,e);return r!==s+a&&(o=Ku(t,r-s-a,l,e)),t.l=n,[l,o]}function yI(t,r,e,n){var a=t.l+r,o=Zu(t,n,e),s;return a!==t.l&&(s=Ku(t,a-t.l,o,e)),[o,s]}function wI(t,r,e){var n=t.l+r,a,o=t.read_shift(2),s=Zu(t,o,e);return o==65535?[[],Vn(t,r-2)]:(r!==o+2&&(a=Ku(t,n-o-2,s,e)),[s,a])}function _I(t){var r;if(ni(t,t.l+6)!==65535)return[Un(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return r=t[t.l+2]===1,t.l+=8,[r,"b"];case 2:return r=t[t.l+2],t.l+=8,[r,"e"];case 3:return t.l+=8,["","s"]}return[]}function kp(t,r,e){var n=t.l+r,a=Is(t);e.biff==2&&++t.l;var o=_I(t),s=t.read_shift(1);e.biff!=2&&(t.read_shift(1),e.biff>=5&&t.read_shift(4));var l=xI(t,n-t.l,e);return{cell:a,val:o[0],formula:l,shared:s>>3&1,tt:o[1]}}function Qf(t,r,e){var n=t.read_shift(4),a=Zu(t,n,e),o=t.read_shift(4),s=o>0?Ku(t,o,a,e):null;return[a,s]}var SI=Qf,eh=Qf,kI=Qf,EI=Qf,TI={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},E4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},AI={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function L2(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,e){return e.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Ep(t){var r=t.split(":"),e=r[0].split(".")[0];return[e,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var gu={},Yl={};function vu(t,r){if(t){var e=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(e=[1,1,1,1,.5,.5]),t.left==null&&(t.left=e[0]),t.right==null&&(t.right=e[1]),t.top==null&&(t.top=e[2]),t.bottom==null&&(t.bottom=e[3]),t.header==null&&(t.header=e[4]),t.footer==null&&(t.footer=e[5])}}function T4(t,r,e,n,a,o){try{n.cellNF&&(t.z=rr[r])}catch(l){if(n.WTF)throw l}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=kn(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(rr[r]==null&&Po(CO[r]||"General",r),t.t==="e")t.w=t.w||Wo[t.v];else if(r===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ju(t.v);else if(t.t==="d"){var s=Jn(t.v);(s|0)===s?t.w=s.toString(10):t.w=ju(s)}else{if(t.v===void 0)return"";t.w=Bo(t.v,Yl)}else t.t==="d"?t.w=$a(r,Jn(t.v),Yl):t.w=$a(r,t.v,Yl)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&e!=null)try{t.s=o.Fills[e],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Ff(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Ff(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&o.Fills)throw l}}}function CI(t,r){var e=Yr(r);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(t["!ref"]=pr(e))}var NI=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,OI=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,jI=/<(?:\w:)?hyperlink [^>]*>/mg,DI=/"(\w*:\w*)"/,MI=/<(?:\w:)?col\b[^>]*[\/]?>/g,RI=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,FI=/<(?:\w:)?pageMargins[^>]*\/>/g,A4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,II=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,PI=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function LI(t,r,e,n,a,o,s){if(!t)return t;n||(n={"!id":{}});var l=r.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},i="",u="",p=t.match(OI);p?(i=t.slice(0,p.index),u=t.slice(p.index+p[0].length)):i=u=t;var f=i.match(A4);f?o1(f[0],l,a,e):(f=i.match(II))&&BI(f[0],f[1]||"",l,a,e);var h=(i.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var v=i.slice(h,h+50).match(DI);v&&CI(l,v[1])}var b=i.match(PI);b&&b[1]&&qI(b[1],a);var g=[];if(r.cellStyles){var x=i.match(MI);x&&$I(g,x)}p&&WI(p[1],l,r,c,o,s);var y=u.match(RI);y&&(l["!autofilter"]=VI(y[0]));var E=[],N=u.match(NI);if(N)for(h=0;h!=N.length;++h)E[h]=Yr(N[h].slice(N[h].indexOf('"')+1));var I=u.match(jI);I&&UI(l,I,n);var L=u.match(FI);if(L&&(l["!margins"]=zI(Xt(L[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=pr(c)),r.sheetRows>0&&l["!ref"]){var H=Yr(l["!ref"]);r.sheetRows<=+H.e.r&&(H.e.r=r.sheetRows-1,H.e.r>c.e.r&&(H.e.r=c.e.r),H.e.r<H.s.r&&(H.s.r=H.e.r),H.e.c>c.e.c&&(H.e.c=c.e.c),H.e.c<H.s.c&&(H.s.c=H.e.c),l["!fullref"]=l["!ref"],l["!ref"]=pr(H))}return g.length>0&&(l["!cols"]=g),E.length>0&&(l["!merges"]=E),l}function o1(t,r,e,n){var a=Xt(t);e.Sheets[n]||(e.Sheets[n]={}),a.codeName&&(e.Sheets[n].CodeName=vr(Fr(a.codeName)))}function BI(t,r,e,n,a){o1(t.slice(0,t.indexOf(">")),e,n,a)}function UI(t,r,e){for(var n=Array.isArray(t),a=0;a!=r.length;++a){var o=Xt(Fr(r[a]),!0);if(!o.ref)return;var s=((e||{})["!id"]||[])[o.id];s?(o.Target=s.Target,o.location&&(o.Target+="#"+vr(o.location))):(o.Target="#"+vr(o.location),s={Target:o.Target,TargetMode:"Internal"}),o.Rel=s,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var l=Yr(o.ref),c=l.s.r;c<=l.e.r;++c)for(var i=l.s.c;i<=l.e.c;++i){var u=Qt({c:i,r:c});n?(t[c]||(t[c]=[]),t[c][i]||(t[c][i]={t:"z",v:void 0}),t[c][i].l=o):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=o)}}}function zI(t){var r={};return["left","right","top","bottom","header","footer"].forEach(function(e){t[e]&&(r[e]=parseFloat(t[e]))}),r}function $I(t,r){for(var e=!1,n=0;n!=r.length;++n){var a=Xt(r[n],!0);a.hidden&&(a.hidden=Lr(a.hidden));var o=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!e&&a.width&&(e=!0,s1(a.width)),Jl(a);o<=s;)t[o++]=Mn(a)}}function VI(t){var r={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return r}var HI=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function qI(t,r){r.Views||(r.Views=[{}]),(t.match(HI)||[]).forEach(function(e,n){var a=Xt(e);r.Views[n]||(r.Views[n]={}),+a.zoomScale&&(r.Views[n].zoom=+a.zoomScale),Lr(a.rightToLeft)&&(r.Views[n].RTL=!0)})}var WI=function(){var t=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=Du("v"),s=Du("f");return function(c,i,u,p,f,h){for(var v=0,b="",g=[],x=[],y=0,E=0,N=0,I="",L,H,V=0,q=0,K,z,W=0,D=0,M=Array.isArray(h.CellXf),C,w=[],T=[],A=Array.isArray(i),S=[],j={},B=!1,R=!!u.sheetStubs,X=c.split(r),Y=0,ee=X.length;Y!=ee;++Y){b=X[Y].trim();var U=b.length;if(U!==0){var Q=0;e:for(v=0;v<U;++v)switch(b[v]){case">":if(b[v-1]!="/"){++v;break e}if(u&&u.cellStyles){if(H=Xt(b.slice(Q,v),!0),V=H.r!=null?parseInt(H.r,10):V+1,q=-1,u.sheetRows&&u.sheetRows<V)continue;j={},B=!1,H.ht&&(B=!0,j.hpt=parseFloat(H.ht),j.hpx=Iu(j.hpt)),H.hidden=="1"&&(B=!0,j.hidden=!0),H.outlineLevel!=null&&(B=!0,j.level=+H.outlineLevel),B&&(S[V-1]=j)}break;case"<":Q=v;break}if(Q>=v)break;if(H=Xt(b.slice(Q,v),!0),V=H.r!=null?parseInt(H.r,10):V+1,q=-1,!(u.sheetRows&&u.sheetRows<V)){p.s.r>V-1&&(p.s.r=V-1),p.e.r<V-1&&(p.e.r=V-1),u&&u.cellStyles&&(j={},B=!1,H.ht&&(B=!0,j.hpt=parseFloat(H.ht),j.hpx=Iu(j.hpt)),H.hidden=="1"&&(B=!0,j.hidden=!0),H.outlineLevel!=null&&(B=!0,j.level=+H.outlineLevel),B&&(S[V-1]=j)),g=b.slice(v).split(t);for(var P=0;P!=g.length&&g[P].trim().charAt(0)=="<";++P);for(g=g.slice(P),v=0;v!=g.length;++v)if(b=g[v].trim(),b.length!==0){if(x=b.match(e),y=v,E=0,N=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,x!=null&&x.length===2){for(y=0,I=x[1],E=0;E!=I.length&&!((N=I.charCodeAt(E)-64)<1||N>26);++E)y=26*y+N;--y,q=y}else++q;for(E=0;E!=b.length&&b.charCodeAt(E)!==62;++E);if(++E,H=Xt(b.slice(0,E),!0),H.r||(H.r=Qt({r:V-1,c:q})),I=b.slice(E),L={t:""},(x=I.match(o))!=null&&x[1]!==""&&(L.v=vr(x[1])),u.cellFormula){if((x=I.match(s))!=null&&x[1]!==""){if(L.f=vr(Fr(x[1])).replace(/\r\n/g,`
`),u.xlfn||(L.f=R2(L.f)),x[0].indexOf('t="array"')>-1)L.F=(I.match(a)||[])[1],L.F.indexOf(":")>-1&&w.push([Yr(L.F),L.F]);else if(x[0].indexOf('t="shared"')>-1){z=Xt(x[0]);var F=vr(Fr(x[1]));u.xlfn||(F=R2(F)),T[parseInt(z.si,10)]=[z,F,H.r]}}else(x=I.match(/<f[^>]*\/>/))&&(z=Xt(x[0]),T[z.si]&&(L.f=nF(T[z.si][1],T[z.si][2],H.r)));var Z=Kn(H.r);for(E=0;E<w.length;++E)Z.r>=w[E][0].s.r&&Z.r<=w[E][0].e.r&&Z.c>=w[E][0].s.c&&Z.c<=w[E][0].e.c&&(L.F=w[E][1])}if(H.t==null&&L.v===void 0)if(L.f||L.F)L.v=0,L.t="n";else if(R)L.t="z";else continue;else L.t=H.t||"n";switch(p.s.c>q&&(p.s.c=q),p.e.c<q&&(p.e.c=q),L.t){case"n":if(L.v==""||L.v==null){if(!R)continue;L.t="z"}else L.v=parseFloat(L.v);break;case"s":if(typeof L.v>"u"){if(!R)continue;L.t="z"}else K=gu[parseInt(L.v,10)],L.v=K.t,L.r=K.r,u.cellHTML&&(L.h=K.h);break;case"str":L.t="s",L.v=L.v!=null?Fr(L.v):"",u.cellHTML&&(L.h=Ym(L.v));break;case"inlineStr":x=I.match(n),L.t="s",x!=null&&(K=a1(x[1]))?(L.v=K.t,u.cellHTML&&(L.h=K.h)):L.v="";break;case"b":L.v=Lr(L.v);break;case"d":u.cellDates?L.v=kn(L.v,1):(L.v=Jn(kn(L.v,1)),L.t="n");break;case"e":(!u||u.cellText!==!1)&&(L.w=L.v),L.v=Y_[L.v];break}if(W=D=0,C=null,M&&H.s!==void 0&&(C=h.CellXf[H.s],C!=null&&(C.numFmtId!=null&&(W=C.numFmtId),u.cellStyles&&C.fillId!=null&&(D=C.fillId))),T4(L,W,D,u,f,h),u.cellDates&&M&&L.t=="n"&&rc(rr[W])&&(L.t="d",L.v=Zf(L.v)),H.cm&&u.xlmeta){var se=(u.xlmeta.Cell||[])[+H.cm-1];se&&se.type=="XLDAPR"&&(L.D=!0)}if(A){var re=Kn(H.r);i[re.r]||(i[re.r]=[]),i[re.r][re.c]=L}else i[H.r]=L}}}}S.length>0&&(i["!rows"]=S)}}();function GI(t,r){var e={},n=t.l+r;e.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=n,o&7&&(e.level=o&7),o&16&&(e.hidden=!0),o&32&&(e.hpt=a/20),e}var YI=qo;function XI(){}function KI(t,r){var e={},n=t[t.l];return++t.l,e.above=!(n&64),e.left=!(n&128),t.l+=18,e.name=bj(t),e}function ZI(t){var r=Va(t);return[r]}function JI(t){var r=Ho(t);return[r]}function QI(t){var r=Va(t),e=t.read_shift(1);return[r,e,"b"]}function eP(t){var r=Ho(t),e=t.read_shift(1);return[r,e,"b"]}function tP(t){var r=Va(t),e=t.read_shift(1);return[r,e,"e"]}function rP(t){var r=Ho(t),e=t.read_shift(1);return[r,e,"e"]}function nP(t){var r=Va(t),e=t.read_shift(4);return[r,e,"s"]}function aP(t){var r=Ho(t),e=t.read_shift(4);return[r,e,"s"]}function sP(t){var r=Va(t),e=Un(t);return[r,e,"n"]}function C4(t){var r=Ho(t),e=Un(t);return[r,e,"n"]}function iP(t){var r=Va(t),e=t1(t);return[r,e,"n"]}function oP(t){var r=Ho(t),e=t1(t);return[r,e,"n"]}function lP(t){var r=Va(t),e=Qm(t);return[r,e,"is"]}function cP(t){var r=Va(t),e=$n(t);return[r,e,"str"]}function uP(t){var r=Ho(t),e=$n(t);return[r,e,"str"]}function dP(t,r,e){var n=t.l+r,a=Va(t);a.r=e["!row"];var o=t.read_shift(1),s=[a,o,"b"];if(e.cellFormula){t.l+=2;var l=eh(t,n-t.l,e);s[3]=Bn(l,null,a,e.supbooks,e)}else t.l=n;return s}function fP(t,r,e){var n=t.l+r,a=Va(t);a.r=e["!row"];var o=t.read_shift(1),s=[a,o,"e"];if(e.cellFormula){t.l+=2;var l=eh(t,n-t.l,e);s[3]=Bn(l,null,a,e.supbooks,e)}else t.l=n;return s}function hP(t,r,e){var n=t.l+r,a=Va(t);a.r=e["!row"];var o=Un(t),s=[a,o,"n"];if(e.cellFormula){t.l+=2;var l=eh(t,n-t.l,e);s[3]=Bn(l,null,a,e.supbooks,e)}else t.l=n;return s}function pP(t,r,e){var n=t.l+r,a=Va(t);a.r=e["!row"];var o=$n(t),s=[a,o,"str"];if(e.cellFormula){t.l+=2;var l=eh(t,n-t.l,e);s[3]=Bn(l,null,a,e.supbooks,e)}else t.l=n;return s}var mP=qo;function gP(t,r){var e=t.l+r,n=qo(t),a=e1(t),o=$n(t),s=$n(t),l=$n(t);t.l=e;var c={rfx:n,relId:a,loc:o,display:l};return s&&(c.Tooltip=s),c}function vP(){}function bP(t,r,e){var n=t.l+r,a=q_(t),o=t.read_shift(1),s=[a];if(s[2]=o,e.cellFormula){var l=SI(t,n-t.l,e);s[1]=l}else t.l=n;return s}function xP(t,r,e){var n=t.l+r,a=qo(t),o=[a];if(e.cellFormula){var s=EI(t,n-t.l,e);o[1]=s,t.l=n}else t.l=n;return o}var yP=["left","right","top","bottom","header","footer"];function wP(t){var r={};return yP.forEach(function(e){r[e]=Un(t)}),r}function _P(t){var r=t.read_shift(2);return t.l+=28,{RTL:r&32}}function SP(){}function kP(){}function EP(t,r,e,n,a,o,s){if(!t)return t;var l=r||{};n||(n={"!id":{}});var c=l.dense?[]:{},i,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,f=!1,h,v,b,g,x,y,E,N,I,L=[];l.biff=12,l["!row"]=0;var H=0,V=!1,q=[],K={},z=l.supbooks||a.supbooks||[[]];if(z.sharedf=K,z.arrayf=q,z.SheetNames=a.SheetNames||a.Sheets.map(function(A){return A.name}),!l.supbooks&&(l.supbooks=z,a.Names))for(var W=0;W<a.Names.length;++W)z[0][W+1]=a.Names[W];var D=[],M=[],C=!1;Lf[16]={n:"BrtShortReal",f:C4};var w;if(ci(t,function(S,j,B){if(!f)switch(B){case 148:i=S;break;case 0:h=S,l.sheetRows&&l.sheetRows<=h.r&&(f=!0),N=Rn(g=h.r),l["!row"]=h.r,(S.hidden||S.hpt||S.level!=null)&&(S.hpt&&(S.hpx=Iu(S.hpt)),M[S.r]=S);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:S[2]},S[2]){case"n":v.v=S[1];break;case"s":E=gu[S[1]],v.v=E.t,v.r=E.r;break;case"b":v.v=!!S[1];break;case"e":v.v=S[1],l.cellText!==!1&&(v.w=Wo[v.v]);break;case"str":v.t="s",v.v=S[1];break;case"is":v.t="s",v.v=S[1].t;break}if((b=s.CellXf[S[0].iStyleRef])&&T4(v,b.numFmtId,null,l,o,s),x=S[0].c==-1?x+1:S[0].c,l.dense?(c[g]||(c[g]=[]),c[g][x]=v):c[bn(x)+N]=v,l.cellFormula){for(V=!1,H=0;H<q.length;++H){var R=q[H];h.r>=R[0].s.r&&h.r<=R[0].e.r&&x>=R[0].s.c&&x<=R[0].e.c&&(v.F=pr(R[0]),V=!0)}!V&&S.length>3&&(v.f=S[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>x&&(u.s.c=x),u.e.r<h.r&&(u.e.r=h.r),u.e.c<x&&(u.e.c=x),l.cellDates&&b&&v.t=="n"&&rc(rr[b.numFmtId])){var X=Fo(v.v);X&&(v.t="d",v.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}w&&(w.type=="XLDAPR"&&(v.D=!0),w=void 0);break;case 1:case 12:if(!l.sheetStubs||p)break;v={t:"z",v:void 0},x=S[0].c==-1?x+1:S[0].c,l.dense?(c[g]||(c[g]=[]),c[g][x]=v):c[bn(x)+N]=v,u.s.r>h.r&&(u.s.r=h.r),u.s.c>x&&(u.s.c=x),u.e.r<h.r&&(u.e.r=h.r),u.e.c<x&&(u.e.c=x),w&&(w.type=="XLDAPR"&&(v.D=!0),w=void 0);break;case 176:L.push(S);break;case 49:w=((l.xlmeta||{}).Cell||[])[S-1];break;case 494:var Y=n["!id"][S.relId];for(Y?(S.Target=Y.Target,S.loc&&(S.Target+="#"+S.loc),S.Rel=Y):S.relId==""&&(S.Target="#"+S.loc),g=S.rfx.s.r;g<=S.rfx.e.r;++g)for(x=S.rfx.s.c;x<=S.rfx.e.c;++x)l.dense?(c[g]||(c[g]=[]),c[g][x]||(c[g][x]={t:"z",v:void 0}),c[g][x].l=S):(y=Qt({c:x,r:g}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=S);break;case 426:if(!l.cellFormula)break;q.push(S),I=l.dense?c[g][x]:c[bn(x)+N],I.f=Bn(S[1],u,{r:h.r,c:x},z,l),I.F=pr(S[0]);break;case 427:if(!l.cellFormula)break;K[Qt(S[0].s)]=S[1],I=l.dense?c[g][x]:c[bn(x)+N],I.f=Bn(S[1],u,{r:h.r,c:x},z,l);break;case 60:if(!l.cellStyles)break;for(;S.e>=S.s;)D[S.e--]={width:S.w/256,hidden:!!(S.flags&1),level:S.level},C||(C=!0,s1(S.w/256)),Jl(D[S.e+1]);break;case 161:c["!autofilter"]={ref:pr(S)};break;case 476:c["!margins"]=S;break;case 147:a.Sheets[e]||(a.Sheets[e]={}),S.name&&(a.Sheets[e].CodeName=S.name),(S.above||S.left)&&(c["!outline"]={above:S.above,left:S.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),S.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!j.T){if(!p||l.WTF)throw new Error("Unexpected record 0x"+B.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(u.s.r<2e6||i&&(i.e.r>0||i.e.c>0||i.s.r>0||i.s.c>0))&&(c["!ref"]=pr(i||u)),l.sheetRows&&c["!ref"]){var T=Yr(c["!ref"]);l.sheetRows<=+T.e.r&&(T.e.r=l.sheetRows-1,T.e.r>u.e.r&&(T.e.r=u.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>u.e.c&&(T.e.c=u.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),c["!fullref"]=c["!ref"],c["!ref"]=pr(T))}return L.length>0&&(c["!merges"]=L),D.length>0&&(c["!cols"]=D),M.length>0&&(c["!rows"]=M),c}function TP(t){var r=[],e=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var s=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(r[+s[1]]=e?+s[2]:s[2])});var a=vr((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[r,a,n]}function AP(t,r,e,n,a,o){var s=o||{"!type":"chart"};if(!t)return o;var l=0,c=0,i="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var f=TP(p);u.s.r=u.s.c=0,u.e.c=l,i=bn(l),f[0].forEach(function(h,v){s[i+Rn(v)]={t:"n",v:h,z:f[1]},c=v}),u.e.r<c&&(u.e.r=c),++l}),l>0&&(s["!ref"]=pr(u)),s}function CP(t,r,e,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},s,l=t.match(A4);return l&&o1(l[0],o,a,e),(s=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=s[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function NP(t,r){t.l+=10;var e=$n(t);return{name:e}}function OP(t,r,e,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},s=!1;return ci(t,function(c,i,u){switch(u){case 550:o["!rel"]=c;break;case 651:a.Sheets[e]||(a.Sheets[e]={}),c.name&&(a.Sheets[e].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(i.T>0)){if(!(i.T<0)){if(!s||r.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},r),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var N4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],jP=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],DP=[],MP=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function B2(t,r){for(var e=0;e!=t.length;++e)for(var n=t[e],a=0;a!=r.length;++a){var o=r[a];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=Lr(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function U2(t,r){for(var e=0;e!=r.length;++e){var n=r[e];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Lr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function O4(t){U2(t.WBProps,N4),U2(t.CalcPr,MP),B2(t.WBView,jP),B2(t.Sheets,DP),Yl.date1904=Lr(t.WBProps.date1904)}var RP="][*?/\\".split("");function FP(t,r){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return RP.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}var IP=/<\w+:workbook/;function PP(t,r){if(!t)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",o={},s=0;if(t.replace(Hn,function(c,i){var u=Xt(c);switch(Fs(u[0])){case"<?xml":break;case"<workbook":c.match(IP)&&(a="xmlns"+c.match(/<(\w+):/)[1]),e.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],e.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":N4.forEach(function(p){if(u[p[0]]!=null)switch(p[2]){case"bool":e.WBProps[p[0]]=Lr(u[p[0]]);break;case"int":e.WBProps[p[0]]=parseInt(u[p[0]],10);break;default:e.WBProps[p[0]]=u[p[0]]}}),u.codeName&&(e.WBProps.CodeName=Fr(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],e.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=vr(Fr(u.name)),delete u[0],e.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=Fr(u.name),u.comment&&(o.Comment=u.comment),u.localSheetId&&(o.Sheet=+u.localSheetId),Lr(u.hidden||"0")&&(o.Hidden=!0),s=i+c.length;break;case"</definedName>":o.Ref=vr(Fr(t.slice(s,i))),e.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete u[0],e.CalcPr=u;break;case"<calcPr/>":delete u[0],e.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),tj.indexOf(e.xmlns)===-1)throw new Error("Unknown Namespace: "+e.xmlns);return O4(e),e}function LP(t,r){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=em(t),e.name=$n(t),e}function BP(t,r){var e={},n=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var a=r>8?$n(t):"";return a.length>0&&(e.CodeName=a),e.autoCompressPictures=!!(n&65536),e.backupFile=!!(n&64),e.checkCompatibility=!!(n&4096),e.date1904=!!(n&1),e.filterPrivacy=!!(n&8),e.hidePivotFieldList=!!(n&1024),e.promptedSolutions=!!(n&16),e.publishItems=!!(n&2048),e.refreshAllConnections=!!(n&262144),e.saveExternalLinkValues=!!(n&128),e.showBorderUnselectedTables=!!(n&4),e.showInkAnnotation=!!(n&32),e.showObjects=["all","placeholders","none"][n>>13&3],e.showPivotChartFilter=!!(n&32768),e.updateLinks=["userSet","never","always"][n>>8&3],e}function UP(t,r){var e={};return t.read_shift(4),e.ArchID=t.read_shift(4),t.l+=r-8,e}function zP(t,r,e){var n=t.l+r;t.l+=4,t.l+=1;var a=t.read_shift(4),o=xj(t),s=kI(t,0,e),l=e1(t);t.l=n;var c={Name:o,Ptg:s};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function $P(t,r){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;r||(r={}),r.biff=12;var o=[],s=[[]];return s.SheetNames=[],s.XTI=[],Lf[16]={n:"BrtFRTArchID$",f:UP},ci(t,function(c,i,u){switch(u){case 156:s.SheetNames.push(c.name),e.Sheets.push(c);break;case 153:e.WBProps=c;break;case 39:c.Sheet!=null&&(r.SID=c.Sheet),c.Ref=Bn(c.Ptg,null,null,s,r),delete r.SID,delete c.Ptg,o.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([u,c]):s[0]=[u,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!i.T){if(!a||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},r),O4(e),e.Names=o,e.supbooks=s,e}function VP(t,r,e){return r.slice(-4)===".bin"?$P(t,e):PP(t,e)}function HP(t,r,e,n,a,o,s,l){return r.slice(-4)===".bin"?EP(t,n,e,a,o,s,l):LI(t,n,e,a,o,s,l)}function qP(t,r,e,n,a,o,s,l){return r.slice(-4)===".bin"?OP(t,n,e,a,o):CP(t,n,e,a,o)}function WP(t,r,e,n,a,o,s,l){return r.slice(-4)===".bin"?eF():tF()}function GP(t,r,e,n,a,o,s,l){return r.slice(-4)===".bin"?JR():QR()}function YP(t,r,e,n){return r.slice(-4)===".bin"?mR(t,e,n):cR(t,e,n)}function XP(t,r,e){return g4(t,e)}function KP(t,r,e){return r.slice(-4)===".bin"?jM(t,e):NM(t,e)}function ZP(t,r,e){return r.slice(-4)===".bin"?XR(t,e):HR(t,e)}function JP(t,r,e){return r.slice(-4)===".bin"?zR(t):BR(t)}function QP(t,r,e,n){return e.slice(-4)===".bin"?$R(t,r,e,n):void 0}function eL(t,r,e){return r.slice(-4)===".bin"?PR(t,r,e):LR(t,r,e)}var j4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,D4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Qa(t,r){var e=t.split(/\s+/),n=[];if(n[0]=e[0],e.length===1)return n;var a=t.match(j4),o,s,l,c;if(a)for(c=0;c!=a.length;++c)o=a[c].match(D4),(s=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?l="xmlns"+o[1].slice(6):l=o[1].slice(s+1),n[l]=o[2].slice(1,o[2].length-1));return n}function tL(t){var r=t.split(/\s+/),e={};if(r.length===1)return e;var n=t.match(j4),a,o,s,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(D4),(o=a[1].indexOf(":"))===-1?e[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(o+1),e[s]=a[2].slice(1,a[2].length-1));return e}var bu;function rL(t,r){var e=bu[t]||vr(t);return e==="General"?Bo(r):$a(e,r)}function nL(t,r,e,n){var a=n;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Lr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=kn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}t[vr(r)]=a}function aL(t,r,e){if(t.t!=="z"){if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Wo[t.v]:r==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ju(t.v):t.w=Bo(t.v):t.w=rL(r||"General",t.v)}catch(o){if(e.WTF)throw o}try{var n=bu[r]||r||"General";if(e.cellNF&&(t.z=n),e.cellDates&&t.t=="n"&&rc(n)){var a=Fo(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(e.WTF)throw o}}}function sL(t,r,e){if(e.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=nR[n.Pattern]||n.Pattern)}t[r.ID]=r}function iL(t,r,e,n,a,o,s,l,c,i){var u="General",p=n.StyleID,f={};i=i||{};var h=[],v=0;for(p===void 0&&l&&(p=l.StyleID),p===void 0&&s&&(p=s.StyleID);o[p]!==void 0&&(o[p].nf&&(u=o[p].nf),o[p].Interior&&h.push(o[p].Interior),!!o[p].Parent);)p=o[p].Parent;switch(e.Type){case"Boolean":n.t="b",n.v=Lr(t);break;case"String":n.t="s",n.r=l2(vr(t)),n.v=t.indexOf("<")>-1?vr(r||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(kn(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=vr(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Y_[t],i.cellText!==!1&&(n.w=t);break;default:t==""&&r==""?n.t="z":(n.t="s",n.v=l2(r||t));break}if(aL(n,u,i),i.cellFormula!==!1)if(n.Formula){var b=vr(n.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),n.f=Gl(b,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Gl("RC:RC",a):n.ArrayRange&&(n.F=Gl(n.ArrayRange,a),c.push([Yr(n.F),n.F]))}else for(v=0;v<c.length;++v)a.r>=c[v][0].s.r&&a.r<=c[v][0].e.r&&a.c>=c[v][0].s.c&&a.c<=c[v][0].e.c&&(n.F=c[v][1]);i.cellStyles&&(h.forEach(function(g){!f.patternType&&g.patternType&&(f.patternType=g.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function oL(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Tp(t,r){var e=r||{};y_();var n=au(Xm(t));(e.type=="binary"||e.type=="array"||e.type=="base64")&&(n=Fr(n));var a=n.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=Mn(e);return s.type="string",Ru.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(de){a.indexOf("<"+de)>=0&&(o=!0)}),o)return gL(n,e);bu={"General Number":"General","General Date":rr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":rr[15],"Short Date":rr[14],"Long Time":rr[19],"Medium Time":rr[18],"Short Time":rr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:rr[2],Standard:rr[4],Percent:rr[10],Scientific:rr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],i,u={},p=[],f=e.dense?[]:{},h="",v={},b={},g=Qa('<Data ss:Type="String">'),x=0,y=0,E=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},I={},L={},H="",V=0,q=[],K={},z={},W=0,D=[],M=[],C={},w=[],T,A=!1,S=[],j=[],B={},R=0,X=0,Y={Sheets:[],WBProps:{date1904:!1}},ee={};Mu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var U="";l=Mu.exec(n);)switch(l[3]=(U=l[3]).toLowerCase()){case"data":if(U=="data"){if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?iL(n.slice(x,l.index),H,g,c[c.length-1][0]=="comment"?C:v,{c:y,r:E},I,w[y],b,S,e):(H="",g=Qa(l[0]),x=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(M.length>0&&(v.c=M),(!e.sheetRows||e.sheetRows>E)&&v.v!==void 0&&(e.dense?(f[E]||(f[E]=[]),f[E][y]=v):f[bn(y)+Rn(E)]=v),v.HRef&&(v.l={Target:vr(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(R=y+(parseInt(v.MergeAcross,10)|0),X=E+(parseInt(v.MergeDown,10)|0),q.push({s:{c:y,r:E},e:{c:R,r:X}})),!e.sheetStubs)v.MergeAcross?y=R+1:++y;else if(v.MergeAcross||v.MergeDown){for(var Q=y;Q<=R;++Q)for(var P=E;P<=X;++P)(Q>y||P>E)&&(e.dense?(f[P]||(f[P]=[]),f[P][Q]={t:"z"}):f[bn(Q)+Rn(P)]={t:"z"});y=R+1}else++y;else v=tL(l[0]),v.Index&&(y=+v.Index-1),y<N.s.c&&(N.s.c=y),y>N.e.c&&(N.e.c=y),l[0].slice(-2)==="/>"&&++y,M=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(E<N.s.r&&(N.s.r=E),E>N.e.r&&(N.e.r=E),l[0].slice(-2)==="/>"&&(b=Qa(l[0]),b.Index&&(E=+b.Index-1)),y=0,++E):(b=Qa(l[0]),b.Index&&(E=+b.Index-1),B={},(b.AutoFitHeight=="0"||b.Height)&&(B.hpx=parseInt(b.Height,10),B.hpt=m4(B.hpx),j[E]=B),b.Hidden=="1"&&(B.hidden=!0,j[E]=B));break;case"worksheet":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"));p.push(h),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(f["!ref"]=pr(N),e.sheetRows&&e.sheetRows<=N.e.r&&(f["!fullref"]=f["!ref"],N.e.r=e.sheetRows-1,f["!ref"]=pr(N))),q.length&&(f["!merges"]=q),w.length>0&&(f["!cols"]=w),j.length>0&&(f["!rows"]=j),u[h]=f}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=y=0,c.push([l[3],!1]),i=Qa(l[0]),h=vr(i.Name),f=e.dense?[]:{},q=[],S=[],j=[],ee={name:h,Hidden:0},Y.Sheets.push(ee);break;case"table":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),w=[],A=!1}break;case"style":l[1]==="/"?sL(I,L,e):L=Qa(l[0]);break;case"numberformat":L.nf=vr(Qa(l[0]).Format||"General"),bu[L.nf]&&(L.nf=bu[L.nf]);for(var F=0;F!=392&&rr[F]!=L.nf;++F);if(F==392){for(F=57;F!=392;++F)if(rr[F]==null){Po(L.nf,F);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(T=Qa(l[0]),T.Hidden&&(T.hidden=!0,delete T.Hidden),T.Width&&(T.wpx=parseInt(T.Width,10)),!A&&T.wpx>10){A=!0,Xn=h4;for(var Z=0;Z<w.length;++Z)w[Z]&&Jl(w[Z])}A&&Jl(T),w[T.Index-1||w.length]=T;for(var se=0;se<+T.Span;++se)w[w.length]=Mn(T);break;case"namedrange":if(l[1]==="/")break;Y.Names||(Y.Names=[]);var re=Xt(l[0]),ae={Name:re.Name,Ref:Gl(re.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(ae.Sheet=Y.Sheets.length-1),Y.Names.push(ae);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?H+=n.slice(V,l.index):V=l.index+l[0].length;break;case"interior":if(!e.cellStyles)break;L.Interior=Qa(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?Hj(K,U,n.slice(W,l.index)):W=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"));oL(C),M.push(C)}else c.push([l[3],!1]),i=Qa(l[0]),C={a:i.Author};break;case"autofilter":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var te=Qa(l[0]);f["!autofilter"]={ref:Gl(te.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return W2(n,e);var he=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:he=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:he=!1}break;case"excelworkbook":switch(l[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:he=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:he=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(W,l.index)){case"SheetHidden":ee.Hidden=1;break;case"SheetVeryHidden":ee.Hidden=2;break}else W=l.index+l[0].length;break;case"header":f["!margins"]||vu(f["!margins"]={},"xlml"),isNaN(+Xt(l[0]).Margin)||(f["!margins"].header=+Xt(l[0]).Margin);break;case"footer":f["!margins"]||vu(f["!margins"]={},"xlml"),isNaN(+Xt(l[0]).Margin)||(f["!margins"].footer=+Xt(l[0]).Margin);break;case"pagemargins":var le=Xt(l[0]);f["!margins"]||vu(f["!margins"]={},"xlml"),isNaN(+le.Top)||(f["!margins"].top=+le.Top),isNaN(+le.Left)||(f["!margins"].left=+le.Left),isNaN(+le.Right)||(f["!margins"].right=+le.Right),isNaN(+le.Bottom)||(f["!margins"].bottom=+le.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:he=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:he=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:he=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:he=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:he=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:he=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:he=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:he=!1}break;case"smarttags":break;default:he=!1;break}if(he||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?nL(z,U,D,n.slice(W,l.index)):(D=l,W=l.index+l[0].length);break}if(e.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var ne={};return!e.bookSheets&&!e.bookProps&&(ne.Sheets=u),ne.SheetNames=p,ne.Workbook=Y,ne.SSF=Mn(rr),ne.Props=K,ne.Custprops=z,ne}function am(t,r){switch(u1(r=r||{}),r.type||"base64"){case"base64":return Tp(Sa(t),r);case"binary":case"buffer":case"file":return Tp(t,r);case"array":return Tp(Vo(t),r)}}function lL(t){var r={},e=t.content;if(e.l=28,r.AnsiUserType=e.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=_j(e),e.length-e.l<=4)return r;var n=e.read_shift(4);if(n==0||n>40||(e.l-=4,r.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||(n=e.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=Sj(e),n=e.read_shift(4),n==0||n>40))return r;e.l-=4,r.Reserved2=e.read_shift(0,"lpwstr")}var cL=[60,1084,2066,2165,2175];function uL(t,r,e,n,a){var o=n,s=[],l=e.slice(e.l,e.l+o);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}s.push(l),e.l+=o;for(var c=ni(e,e.l),i=sm[c],u=0;i!=null&&cL.indexOf(c)>-1;)o=ni(e,e.l+2),u=e.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),l=e.slice(u,e.l+4+o),s.push(l),e.l+=4+o,i=sm[c=ni(e,e.l)];var p=qi(s);jn(p,0);var f=0;p.lens=[];for(var h=0;h<s.length;++h)p.lens.push(f),f+=s[h].length;if(p.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+p.length+" < "+n;return r.f(p,p.length,a)}function ws(t,r,e){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,r.cellNF&&(t.z=rr[n])}catch(o){if(r.WTF)throw o}if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Wo[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ju(t.v):t.w=Bo(t.v):t.w=$a(n,t.v,{date1904:!!e,dateNF:r&&r.dateNF})}catch(o){if(r.WTF)throw o}if(r.cellDates&&n&&t.t=="n"&&rc(rr[n]||String(n))){var a=Fo(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function wf(t,r,e){return{v:t,ixfe:r,t:e}}function dL(t,r){var e={opts:{}},n={},a=r.dense?[]:{},o={},s={},l=null,c=[],i="",u={},p,f="",h,v,b,g,x={},y=[],E,N,I=[],L=[],H={Sheets:[],WBProps:{date1904:!1},Views:[{}]},V={},q=function(ct){return ct<8?Lo[ct]:ct<64&&L[ct-8]||Lo[ct]},K=function(ct,Oe,pt){var Je=Oe.XF.data;if(!(!Je||!Je.patternType||!pt||!pt.cellStyles)){Oe.s={},Oe.s.patternType=Je.patternType;var ot;(ot=Fu(q(Je.icvFore)))&&(Oe.s.fgColor={rgb:ot}),(ot=Fu(q(Je.icvBack)))&&(Oe.s.bgColor={rgb:ot})}},z=function(ct,Oe,pt){if(!(B>1)&&!(pt.sheetRows&&ct.r>=pt.sheetRows)){if(pt.cellStyles&&Oe.XF&&Oe.XF.data&&K(ct,Oe,pt),delete Oe.ixfe,delete Oe.XF,p=ct,f=Qt(ct),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),ct.r<s.s.r&&(s.s.r=ct.r),ct.c<s.s.c&&(s.s.c=ct.c),ct.r+1>s.e.r&&(s.e.r=ct.r+1),ct.c+1>s.e.c&&(s.e.c=ct.c+1),pt.cellFormula&&Oe.f){for(var Je=0;Je<y.length;++Je)if(!(y[Je][0].s.c>ct.c||y[Je][0].s.r>ct.r)&&!(y[Je][0].e.c<ct.c||y[Je][0].e.r<ct.r)){Oe.F=pr(y[Je][0]),(y[Je][0].s.c!=ct.c||y[Je][0].s.r!=ct.r)&&delete Oe.f,Oe.f&&(Oe.f=""+Bn(y[Je][1],s,ct,S,W));break}}pt.dense?(a[ct.r]||(a[ct.r]=[]),a[ct.r][ct.c]=Oe):a[f]=Oe}},W={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(W.password=r.password);var D,M=[],C=[],w=[],T=[],A=!1,S=[];S.SheetNames=W.snames,S.sharedf=W.sharedf,S.arrayf=W.arrayf,S.names=[],S.XTI=[];var j=0,B=0,R=0,X=[],Y=[],ee;W.codepage=1200,ls(1200);for(var U=!1;t.l<t.length-1;){var Q=t.l,P=t.read_shift(2);if(P===0&&j===10)break;var F=t.l===t.length?0:t.read_shift(2),Z=sm[P];if(Z&&Z.f){if(r.bookSheets&&j===133&&P!==133)break;if(j=P,Z.r===2||Z.r==12){var se=t.read_shift(2);if(F-=2,!W.enc&&se!==P&&((se&255)<<8|se>>8)!==P)throw new Error("rt mismatch: "+se+"!="+P);Z.r==12&&(t.l+=10,F-=10)}var re={};if(P===10?re=Z.f(t,F,W):re=uL(P,Z,t,F,W),B==0&&[9,521,1033,2057].indexOf(j)===-1)continue;switch(P){case 34:e.opts.Date1904=H.WBProps.date1904=re;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(W.enc||(t.l=0),W.enc=re,!r.password)throw new Error("File is password-protected");if(re.valid==null)throw new Error("Encryption scheme unsupported");if(!re.valid)throw new Error("Password is incorrect");break;case 92:W.lastuser=re;break;case 66:var ae=Number(re);switch(ae){case 21010:ae=1200;break;case 32768:ae=1e4;break;case 32769:ae=1252;break}ls(W.codepage=ae),U=!0;break;case 317:W.rrtabid=re;break;case 25:W.winlocked=re;break;case 439:e.opts.RefreshAll=re;break;case 12:e.opts.CalcCount=re;break;case 16:e.opts.CalcDelta=re;break;case 17:e.opts.CalcIter=re;break;case 13:e.opts.CalcMode=re;break;case 14:e.opts.CalcPrecision=re;break;case 95:e.opts.CalcSaveRecalc=re;break;case 15:W.CalcRefMode=re;break;case 2211:e.opts.FullCalc=re;break;case 129:re.fDialog&&(a["!type"]="dialog"),re.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),re.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:I.push(re);break;case 430:S.push([re]),S[S.length-1].XTI=[];break;case 35:case 547:S[S.length-1].push(re);break;case 24:case 536:ee={Name:re.Name,Ref:Bn(re.rgce,s,null,S,W)},re.itab>0&&(ee.Sheet=re.itab-1),S.names.push(ee),S[0]||(S[0]=[],S[0].XTI=[]),S[S.length-1].push(re),re.Name=="_xlnm._FilterDatabase"&&re.itab>0&&re.rgce&&re.rgce[0]&&re.rgce[0][0]&&re.rgce[0][0][0]=="PtgArea3d"&&(Y[re.itab-1]={ref:pr(re.rgce[0][0][1][2])});break;case 22:W.ExternCount=re;break;case 23:S.length==0&&(S[0]=[],S[0].XTI=[]),S[S.length-1].XTI=S[S.length-1].XTI.concat(re),S.XTI=S.XTI.concat(re);break;case 2196:if(W.biff<8)break;ee!=null&&(ee.Comment=re[1]);break;case 18:a["!protect"]=re;break;case 19:re!==0&&W.WTF&&console.error("Password verifier: "+re);break;case 133:o[re.pos]=re,W.snames.push(re.name);break;case 10:{if(--B)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=pr(s),r.sheetRows&&r.sheetRows<=s.e.r){var te=s.e.r;s.e.r=r.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=pr(s),s.e.r=te}s.e.r++,s.e.c++}M.length>0&&(a["!merges"]=M),C.length>0&&(a["!objects"]=C),w.length>0&&(a["!cols"]=w),T.length>0&&(a["!rows"]=T),H.Sheets.push(V)}i===""?u=a:n[i]=a,a=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(W.biff===8&&(W.biff={9:2,521:3,1033:4}[P]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[re.BIFFVer]||8),W.biffguess=re.BIFFVer==0,re.BIFFVer==0&&re.dt==4096&&(W.biff=5,U=!0,ls(W.codepage=28591)),W.biff==8&&re.BIFFVer==0&&re.dt==16&&(W.biff=2),B++)break;if(a=r.dense?[]:{},W.biff<8&&!U&&(U=!0,ls(W.codepage=r.codepage||1252)),W.biff<5||re.BIFFVer==0&&re.dt==4096){i===""&&(i="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var he={pos:t.l-F,name:i};o[he.pos]=he,W.snames.push(i)}else i=(o[Q]||{name:""}).name;re.dt==32&&(a["!type"]="chart"),re.dt==64&&(a["!type"]="macro"),M=[],C=[],W.arrayf=y=[],w=[],T=[],A=!1,V={Hidden:(o[Q]||{hs:0}).hs,name:i}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(r.dense?(a[re.r]||[])[re.c]:a[Qt({c:re.c,r:re.r})])&&++re.c,E={ixfe:re.ixfe,XF:I[re.ixfe]||{},v:re.val,t:"n"},R>0&&(E.z=X[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),z({c:re.c,r:re.r},E,r);break;case 5:case 517:E={ixfe:re.ixfe,XF:I[re.ixfe],v:re.val,t:re.t},R>0&&(E.z=X[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),z({c:re.c,r:re.r},E,r);break;case 638:E={ixfe:re.ixfe,XF:I[re.ixfe],v:re.rknum,t:"n"},R>0&&(E.z=X[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),z({c:re.c,r:re.r},E,r);break;case 189:for(var le=re.c;le<=re.C;++le){var ne=re.rkrec[le-re.c][0];E={ixfe:ne,XF:I[ne],v:re.rkrec[le-re.c][1],t:"n"},R>0&&(E.z=X[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),z({c:le,r:re.r},E,r)}break;case 6:case 518:case 1030:{if(re.val=="String"){l=re;break}if(E=wf(re.val,re.cell.ixfe,re.tt),E.XF=I[E.ixfe],r.cellFormula){var de=re.formula;if(de&&de[0]&&de[0][0]&&de[0][0][0]=="PtgExp"){var fe=de[0][0][1][0],Se=de[0][0][1][1],_e=Qt({r:fe,c:Se});x[_e]?E.f=""+Bn(re.formula,s,re.cell,S,W):E.F=((r.dense?(a[fe]||[])[Se]:a[_e])||{}).F}else E.f=""+Bn(re.formula,s,re.cell,S,W)}R>0&&(E.z=X[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),z(re.cell,E,r),l=re}break;case 7:case 519:if(l)l.val=re,E=wf(re,l.cell.ixfe,"s"),E.XF=I[E.ixfe],r.cellFormula&&(E.f=""+Bn(l.formula,s,l.cell,S,W)),R>0&&(E.z=X[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),z(l.cell,E,r),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(re);var Ce=Qt(re[0].s);if(h=r.dense?(a[re[0].s.r]||[])[re[0].s.c]:a[Ce],r.cellFormula&&h){if(!l||!Ce||!h)break;h.f=""+Bn(re[1],s,re[0],S,W),h.F=pr(re[0])}}break;case 1212:{if(!r.cellFormula)break;if(f){if(!l)break;x[Qt(l.cell)]=re[0],h=r.dense?(a[l.cell.r]||[])[l.cell.c]:a[Qt(l.cell)],(h||{}).f=""+Bn(re[0],s,p,S,W)}}break;case 253:E=wf(c[re.isst].t,re.ixfe,"s"),c[re.isst].h&&(E.h=c[re.isst].h),E.XF=I[E.ixfe],R>0&&(E.z=X[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),z({c:re.c,r:re.r},E,r);break;case 513:r.sheetStubs&&(E={ixfe:re.ixfe,XF:I[re.ixfe],t:"z"},R>0&&(E.z=X[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),z({c:re.c,r:re.r},E,r));break;case 190:if(r.sheetStubs)for(var Re=re.c;Re<=re.C;++Re){var Pe=re.ixfe[Re-re.c];E={ixfe:Pe,XF:I[Pe],t:"z"},R>0&&(E.z=X[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),z({c:Re,r:re.r},E,r)}break;case 214:case 516:case 4:E=wf(re.val,re.ixfe,"s"),E.XF=I[E.ixfe],R>0&&(E.z=X[E.ixfe>>8&63]),ws(E,r,e.opts.Date1904),z({c:re.c,r:re.r},E,r);break;case 0:case 512:B===1&&(s=re);break;case 252:c=re;break;case 1054:if(W.biff==4){X[R++]=re[1];for(var Ye=0;Ye<R+163&&rr[Ye]!=re[1];++Ye);Ye>=163&&Po(re[1],R+163)}else Po(re[1],re[0]);break;case 30:{X[R++]=re;for(var at=0;at<R+163&&rr[at]!=re;++at);at>=163&&Po(re,R+163)}break;case 229:M=M.concat(re);break;case 93:C[re.cmo[0]]=W.lastobj=re;break;case 438:W.lastobj.TxO=re;break;case 127:W.lastobj.ImData=re;break;case 440:for(g=re[0].s.r;g<=re[0].e.r;++g)for(b=re[0].s.c;b<=re[0].e.c;++b)h=r.dense?(a[g]||[])[b]:a[Qt({c:b,r:g})],h&&(h.l=re[1]);break;case 2048:for(g=re[0].s.r;g<=re[0].e.r;++g)for(b=re[0].s.c;b<=re[0].e.c;++b)h=r.dense?(a[g]||[])[b]:a[Qt({c:b,r:g})],h&&h.l&&(h.l.Tooltip=re[1]);break;case 28:{if(W.biff<=5&&W.biff>=2)break;h=r.dense?(a[re[0].r]||[])[re[0].c]:a[Qt(re[0])];var tt=C[re[2]];h||(r.dense?(a[re[0].r]||(a[re[0].r]=[]),h=a[re[0].r][re[0].c]={t:"z"}):h=a[Qt(re[0])]={t:"z"},s.e.r=Math.max(s.e.r,re[0].r),s.s.r=Math.min(s.s.r,re[0].r),s.e.c=Math.max(s.e.c,re[0].c),s.s.c=Math.min(s.s.c,re[0].c)),h.c||(h.c=[]),v={a:re[1],t:tt.TxO.t},h.c.push(v)}break;case 2173:MR(I[re.ixfe],re.ext);break;case 125:{if(!W.cellStyles)break;for(;re.e>=re.s;)w[re.e--]={width:re.w/256,level:re.level||0,hidden:!!(re.flags&1)},A||(A=!0,s1(re.w/256)),Jl(w[re.e+1])}break;case 520:{var it={};re.level!=null&&(T[re.r]=it,it.level=re.level),re.hidden&&(T[re.r]=it,it.hidden=!0),re.hpt&&(T[re.r]=it,it.hpt=re.hpt,it.hpx=Iu(re.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||vu(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[P]]=re;break;case 161:a["!margins"]||vu(a["!margins"]={}),a["!margins"].header=re.header,a["!margins"].footer=re.footer;break;case 574:re.RTL&&(H.Views[0].RTL=!0);break;case 146:L=re;break;case 2198:D=re;break;case 140:N=re;break;case 442:i?V.CodeName=re||V.name:H.WBProps.CodeName=re||"ThisWorkbook";break}}else Z||console.error("Missing Info for XLS Record 0x"+P.toString(16)),t.l+=F}return e.SheetNames=Ds(o).sort(function(rt,ct){return Number(rt)-Number(ct)}).map(function(rt){return o[rt].name}),r.bookSheets||(e.Sheets=n),!e.SheetNames.length&&u["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=u)):e.Preamble=u,e.Sheets&&Y.forEach(function(rt,ct){e.Sheets[e.SheetNames[ct]]["!autofilter"]=rt}),e.Strings=c,e.SSF=Mn(rr),W.enc&&(e.Encryption=W.enc),D&&(e.Themes=D),e.Metadata={},N!==void 0&&(e.Metadata.Country=N),S.names.length>0&&(H.Names=S.names),e.Workbook=H,e}var z2={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function fL(t,r,e){var n=hr.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=k2(n,Nj,z2.DSI);for(var o in a)r[o]=a[o]}catch(i){if(e.WTF)throw i}var s=hr.find(t,"/!SummaryInformation");if(s&&s.size>0)try{var l=k2(s,Oj,z2.SI);for(var c in l)r[c]==null&&(r[c]=l[c])}catch(i){if(e.WTF)throw i}r.HeadingPairs&&r.TitlesOfParts&&(K_(r.HeadingPairs,r.TitlesOfParts,r,e),delete r.HeadingPairs,delete r.TitlesOfParts)}function M4(t,r){r||(r={}),u1(r),l_(),r.codepage&&$m(r.codepage);var e,n;if(t.FullPaths){if(hr.find(t,"/encryption"))throw new Error("File is password-protected");e=hr.find(t,"!CompObj"),n=hr.find(t,"/Workbook")||hr.find(t,"/Book")}else{switch(r.type){case"base64":t=ss(Sa(t));break;case"binary":t=ss(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}jn(t,0),n={content:t}}var a,o;if(e&&lL(e),r.bookProps&&!r.bookSheets)a={};else{var s=dr?"buffer":"array";if(n&&n.content)a=dL(n.content,r);else if((o=hr.find(t,"PerfectOffice_MAIN"))&&o.content)a=mu.to_workbook(o.content,(r.type=s,r));else if((o=hr.find(t,"NativeContent_MAIN"))&&o.content)a=mu.to_workbook(o.content,(r.type=s,r));else throw(o=hr.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&t.FullPaths&&hr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=ZR(t))}var l={};return t.FullPaths&&fL(t,l,r),a.Props=a.Custprops=l,r.bookFiles&&(a.cfb=t),a}var Lf={0:{f:GI},1:{f:ZI},2:{f:iP},3:{f:tP},4:{f:QI},5:{f:sP},6:{f:cP},7:{f:nP},8:{f:pP},9:{f:hP},10:{f:dP},11:{f:fP},12:{f:JI},13:{f:oP},14:{f:rP},15:{f:eP},16:{f:C4},17:{f:uP},18:{f:aP},19:{f:Qm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:zP},40:{},42:{},43:{f:dR},44:{f:uR},45:{f:fR},46:{f:pR},47:{f:hR},48:{},49:{f:mj},50:{},51:{f:FR},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:l4},62:{f:lP},63:{f:UR},64:{f:SP},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Vn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:_P},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:KI},148:{f:YI,p:16},151:{f:vP},152:{},153:{f:BP},154:{},155:{},156:{f:LP},157:{},158:{},159:{T:1,f:OM},160:{T:-1},161:{T:1,f:qo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:mP},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:RR},336:{T:-1},337:{f:IR,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:em},357:{},358:{},359:{},360:{T:1},361:{},362:{f:o4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:bP},427:{f:xP},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:wP},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:XI},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:gP},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:em},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:YR},633:{T:1},634:{T:-1},635:{T:1,f:GR},636:{T:-1},637:{f:vj},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:NP},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:kP},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},sm={6:{f:kp},10:{f:$i},12:{f:ln},13:{f:ln},14:{f:Zr},15:{f:Zr},16:{f:Un},17:{f:Zr},18:{f:Zr},19:{f:ln},20:{f:C2},21:{f:C2},23:{f:o4},24:{f:O2},25:{f:Zr},26:{},27:{},28:{f:qD},29:{},34:{f:Zr},35:{f:N2},38:{f:Un},39:{f:Un},40:{f:Un},41:{f:Un},42:{f:Zr},43:{f:Zr},47:{f:XM},49:{f:TD},51:{f:ln},60:{},61:{f:SD},64:{f:Zr},65:{f:ED},66:{f:ln},77:{},80:{},81:{},82:{},85:{f:ln},89:{},90:{},91:{},92:{f:mD},93:{f:GD},94:{},95:{f:Zr},96:{},97:{},99:{f:Zr},125:{f:l4},128:{f:ID},129:{f:gD},130:{f:ln},131:{f:Zr},132:{f:Zr},133:{f:vD},134:{},140:{f:QD},141:{f:ln},144:{},146:{f:tM},151:{},152:{},153:{},154:{},155:{},156:{f:ln},157:{},158:{},160:{f:iM},161:{f:nM},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:DD},190:{f:MD},193:{f:$i},197:{},198:{},199:{},200:{},201:{},202:{f:Zr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ln},220:{},221:{f:Zr},222:{},224:{f:FD},225:{f:pD},226:{f:$i},227:{},229:{f:WD},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:bD},253:{f:AD},255:{f:xD},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:t4},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Zr},353:{f:$i},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:LD},431:{f:Zr},432:{},433:{},434:{},437:{},438:{f:KD},439:{f:Zr},440:{f:ZD},441:{},442:{f:Yu},443:{},444:{f:ln},445:{},446:{},448:{f:$i},449:{f:_D,r:2},450:{f:$i},512:{f:T2},513:{f:sM},515:{f:PD},516:{f:CD},517:{f:A2},519:{f:oM},520:{f:yD},523:{},545:{f:j2},549:{f:E2},566:{},574:{f:kD},638:{f:jD},659:{},1048:{},1054:{f:ND},1084:{},1212:{f:$D},2048:{f:JD},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:bf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:$i},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:rM,r:12},2173:{f:DR,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Zr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:zD,r:12},2197:{},2198:{f:TR,r:12},2199:{},2200:{},2201:{},2202:{f:VD,r:12},2203:{f:$i},2204:{},2205:{},2206:{},2207:{},2211:{f:wD},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ln},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:aM},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:eM},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:T2},1:{},2:{f:dM},3:{f:uM},4:{f:cM},5:{f:A2},7:{f:fM},8:{},9:{f:bf},11:{},22:{f:ln},30:{f:OD},31:{},32:{},33:{f:j2},36:{},37:{f:E2},50:{f:hM},62:{},52:{},67:{},68:{f:ln},69:{},86:{},126:{},127:{f:lM},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:pM},223:{},234:{},354:{},421:{},518:{f:kp},521:{f:bf},536:{f:O2},547:{f:N2},561:{},579:{},1030:{f:kp},1033:{f:bf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function es(t,r,e,n){var a=r;if(!isNaN(a)){var o=(e||[]).length||0,s=t.next(4);s.write_shift(2,a),s.write_shift(2,o),o>0&&$_(e)&&t.push(e)}}function $2(t,r){var e=r||{},n=e.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),s=a.index,l=o&&o.index||t.length,c=PO(t.slice(s,l),/(:?<tr[^>]*>)/i,"<tr>"),i=-1,u=0,p=0,f=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(s=0;s<c.length;++s){var b=c[s].trim(),g=b.slice(0,3).toLowerCase();if(g=="<tr"){if(++i,e.sheetRows&&e.sheetRows<=i){--i;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var x=b.split(/<\/t[dh]>/i);for(l=0;l<x.length;++l){var y=x[l].trim();if(y.match(/<t[dh]/i)){for(var E=y,N=0;E.charAt(0)=="<"&&(N=E.indexOf(">"))>-1;)E=E.slice(N+1);for(var I=0;I<v.length;++I){var L=v[I];L.s.c==u&&L.s.r<i&&i<=L.e.r&&(u=L.e.c+1,I=-1)}var H=Xt(y.slice(0,y.indexOf(">")));f=H.colspan?+H.colspan:1,((p=+H.rowspan)>1||f>1)&&v.push({s:{r:i,c:u},e:{r:i+(p||1)-1,c:u+f-1}});var V=H.t||H["data-t"]||"";if(!E.length){u+=f;continue}if(E=N_(E),h.s.r>i&&(h.s.r=i),h.e.r<i&&(h.e.r=i),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!E.length){u+=f;continue}var q={t:"s",v:E};e.raw||!E.trim().length||V=="s"||(E==="TRUE"?q={t:"b",v:!0}:E==="FALSE"?q={t:"b",v:!1}:isNaN(us(E))?isNaN(Zl(E).getDate())||(q={t:"d",v:kn(E)},e.cellDates||(q={t:"n",v:Jn(q.v)}),q.z=e.dateNF||rr[14]):q={t:"n",v:us(E)}),e.dense?(n[i]||(n[i]=[]),n[i][u]=q):n[Qt({r:i,c:u})]=q,u+=f}}}}return n["!ref"]=pr(h),v.length&&(n["!merges"]=v),n}function hL(t,r,e,n){for(var a=t["!merges"]||[],o=[],s=r.s.c;s<=r.e.c;++s){for(var l=0,c=0,i=0;i<a.length;++i)if(!(a[i].s.r>e||a[i].s.c>s)&&!(a[i].e.r<e||a[i].e.c<s)){if(a[i].s.r<e||a[i].s.c<s){l=-1;break}l=a[i].e.r-a[i].s.r+1,c=a[i].e.c-a[i].s.c+1;break}if(!(l<0)){var u=Qt({r:e,c:s}),p=n.dense?(t[e]||[])[s]:t[u],f=p&&p.v!=null&&(p.h||Ym(p.w||(ii(p),p.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?f='<span contenteditable="true">'+f+"</span>":p&&(h["data-t"]=p&&p.t||"z",p.v!=null&&(h["data-v"]=p.v),p.z!=null&&(h["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+p.l.Target+'">'+f+"</a>")),h.id=(n.id||"sjs")+"-"+u,o.push(QO("td",f,h))}}var v="<tr>";return v+o.join("")+"</tr>"}var pL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',mL="</body></html>";function gL(t,r){var e=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||e.length==0)throw new Error("Invalid HTML: could not find <table>");if(e.length==1)return no($2(e[0],r),r);var n=f1();return e.forEach(function(a,o){h1(n,$2(a,r),"Sheet"+(o+1))}),n}function vL(t,r,e){var n=[];return n.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function bL(t,r){var e=r||{},n=e.header!=null?e.header:pL,a=e.footer!=null?e.footer:mL,o=[n],s=nc(t["!ref"]);e.dense=Array.isArray(t),o.push(vL(t,s,e));for(var l=s.s.r;l<=s.e.r;++l)o.push(hL(t,s,l,e));return o.push("</table>"+a),o.join("")}function R4(t,r,e){var n=e||{},a=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?Kn(n.origin):n.origin;a=s.r,o=s.c}var l=r.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),i={s:{r:0,c:0},e:{r:a,c:o}};if(t["!ref"]){var u=nc(t["!ref"]);i.s.r=Math.min(i.s.r,u.s.r),i.s.c=Math.min(i.s.c,u.s.c),i.e.r=Math.max(i.e.r,u.e.r),i.e.c=Math.max(i.e.c,u.e.c),a==-1&&(i.e.r=a=u.e.r+1)}var p=[],f=0,h=t["!rows"]||(t["!rows"]=[]),v=0,b=0,g=0,x=0,y=0,E=0;for(t["!cols"]||(t["!cols"]=[]);v<l.length&&b<c;++v){var N=l[v];if(V2(N)){if(n.display)continue;h[b]={hidden:!0}}var I=N.children;for(g=x=0;g<I.length;++g){var L=I[g];if(!(n.display&&V2(L))){var H=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):N_(L.innerHTML),V=L.getAttribute("data-z")||L.getAttribute("z");for(f=0;f<p.length;++f){var q=p[f];q.s.c==x+o&&q.s.r<b+a&&b+a<=q.e.r&&(x=q.e.c+1-o,f=-1)}E=+L.getAttribute("colspan")||1,((y=+L.getAttribute("rowspan")||1)>1||E>1)&&p.push({s:{r:b+a,c:x+o},e:{r:b+a+(y||1)-1,c:x+o+(E||1)-1}});var K={t:"s",v:H},z=L.getAttribute("data-t")||L.getAttribute("t")||"";H!=null&&(H.length==0?K.t=z||"z":n.raw||H.trim().length==0||z=="s"||(H==="TRUE"?K={t:"b",v:!0}:H==="FALSE"?K={t:"b",v:!1}:isNaN(us(H))?isNaN(Zl(H).getDate())||(K={t:"d",v:kn(H)},n.cellDates||(K={t:"n",v:Jn(K.v)}),K.z=n.dateNF||rr[14]):K={t:"n",v:us(H)})),K.z===void 0&&V!=null&&(K.z=V);var W="",D=L.getElementsByTagName("A");if(D&&D.length)for(var M=0;M<D.length&&!(D[M].hasAttribute("href")&&(W=D[M].getAttribute("href"),W.charAt(0)!="#"));++M);W&&W.charAt(0)!="#"&&(K.l={Target:W}),n.dense?(t[b+a]||(t[b+a]=[]),t[b+a][x+o]=K):t[Qt({c:x+o,r:b+a})]=K,i.e.c<x+o&&(i.e.c=x+o),x+=E}}++b}return p.length&&(t["!merges"]=(t["!merges"]||[]).concat(p)),i.e.r=Math.max(i.e.r,b-1+a),t["!ref"]=pr(i),b>=c&&(t["!fullref"]=pr((i.e.r=l.length-v+b-1+a,i))),t}function F4(t,r){var e=r||{},n=e.dense?[]:{};return R4(n,t,r)}function xL(t,r){return no(F4(t,r),r)}function V2(t){var r="",e=yL(t);return e&&(r=e(t).getPropertyValue("display")),r||(r=t.style&&t.style.display),r==="none"}function yL(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function wL(t){var r=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),e=vr(r.replace(/<[^>]*>/g,""));return[e]}var H2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function I4(t,r){var e=r||{},n=Xm(t),a=[],o,s,l={name:""},c="",i=0,u,p,f={},h=[],v=e.dense?[]:{},b,g,x={value:""},y="",E=0,N=[],I=-1,L=-1,H={s:{r:1e6,c:1e7},e:{r:0,c:0}},V=0,q={},K=[],z={},W=0,D=0,M=[],C=1,w=1,T=[],A={Names:[]},S={},j=["",""],B=[],R={},X="",Y=0,ee=!1,U=!1,Q=0;for(Mu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=Mu.exec(n);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(H.e.c>=H.s.c&&H.e.r>=H.s.r?v["!ref"]=pr(H):v["!ref"]="A1:A1",e.sheetRows>0&&e.sheetRows<=H.e.r&&(v["!fullref"]=v["!ref"],H.e.r=e.sheetRows-1,v["!ref"]=pr(H)),K.length&&(v["!merges"]=K),M.length&&(v["!rows"]=M),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),f[u.name]=v,U=!1):b[0].charAt(b[0].length-2)!=="/"&&(u=Xt(b[0],!1),I=L=-1,H.s.r=H.s.c=1e7,H.e.r=H.e.c=0,v=e.dense?[]:{},K=[],M=[],U=!0);break;case"table-row-group":b[1]==="/"?--V:++V;break;case"table-row":case"":if(b[1]==="/"){I+=C,C=1;break}if(p=Xt(b[0],!1),p.?I=p.-1:I==-1&&(I=0),C=+p["number-rows-repeated"]||1,C<10)for(Q=0;Q<C;++Q)V>0&&(M[I+Q]={level:V});L=-1;break;case"covered-table-cell":b[1]!=="/"&&++L,e.sheetStubs&&(e.dense?(v[I]||(v[I]=[]),v[I][L]={t:"z"}):v[Qt({r:I,c:L})]={t:"z"}),y="",N=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++L,x=Xt(b[0],!1),w=parseInt(x["number-columns-repeated"]||"1",10),g={t:"z",v:null},x.formula&&e.cellFormula!=!1&&(g.f=L2(vr(x.formula))),(x.||x["value-type"])=="string"&&(g.t="s",g.v=vr(x["string-value"]||""),e.dense?(v[I]||(v[I]=[]),v[I][L]=g):v[Qt({r:I,c:L})]=g),L+=w-1;else if(b[1]!=="/"){++L,y="",E=0,N=[],w=1;var P=C?I+C-1:I;if(L>H.e.c&&(H.e.c=L),L<H.s.c&&(H.s.c=L),I<H.s.r&&(H.s.r=I),P>H.e.r&&(H.e.r=P),x=Xt(b[0],!1),B=[],R={},g={t:x.||x["value-type"],v:null},e.cellFormula)if(x.formula&&(x.formula=vr(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(W=parseInt(x["number-matrix-rows-spanned"],10)||0,D=parseInt(x["number-matrix-columns-spanned"],10)||0,z={s:{r:I,c:L},e:{r:I+W-1,c:L+D-1}},g.F=pr(z),T.push([z,g.F])),x.formula)g.f=L2(x.formula);else for(Q=0;Q<T.length;++Q)I>=T[Q][0].s.r&&I<=T[Q][0].e.r&&L>=T[Q][0].s.c&&L<=T[Q][0].e.c&&(g.F=T[Q][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(W=parseInt(x["number-rows-spanned"],10)||0,D=parseInt(x["number-columns-spanned"],10)||0,z={s:{r:I,c:L},e:{r:I+W-1,c:L+D-1}},K.push(z)),x["number-columns-repeated"]&&(w=parseInt(x["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Lr(x["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(x.value);break;case"percentage":g.t="n",g.v=parseFloat(x.value);break;case"currency":g.t="n",g.v=parseFloat(x.value);break;case"date":g.t="d",g.v=kn(x["date-value"]),e.cellDates||(g.t="n",g.v=Jn(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=RO(x["time-value"])/86400,e.cellDates&&(g.t="d",g.v=Zf(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(x.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",x["string-value"]!=null&&(y=vr(x["string-value"]),N=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(ee=!1,g.t==="s"&&(g.v=y||"",N.length&&(g.R=N),ee=E==0),S.Target&&(g.l=S),B.length>0&&(g.c=B,B=[]),y&&e.cellText!==!1&&(g.w=y),ee&&(g.t="z",delete g.v),(!ee||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=I))for(var F=0;F<C;++F){if(w=parseInt(x["number-columns-repeated"]||"1",10),e.dense)for(v[I+F]||(v[I+F]=[]),v[I+F][L]=F==0?g:Mn(g);--w>0;)v[I+F][L+w]=Mn(g);else for(v[Qt({r:I+F,c:L})]=g;--w>0;)v[Qt({r:I+F,c:L+w})]=Mn(g);H.e.c<=L&&(H.e.c=L)}w=parseInt(x["number-columns-repeated"]||"1",10),L+=w-1,w=0,g={},y="",N=[]}S={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((o=a.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((o=a.pop())[0]!==b[3])throw"Bad state: "+o;R.t=y,N.length&&(R.R=N),R.a=X,B.push(R)}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);X="",Y=0,y="",E=0,N=[];break;case"creator":b[1]==="/"?X=n.slice(Y,b.index):Y=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((o=a.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);y="",E=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(q[l.name]=c,(o=a.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&(c="",l=Xt(b[0],!1),a.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=Xt(b[0],!1),c+=H2[b[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=Xt(b[0],!1),c+=H2[b[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(i,b.index);break}else i=b.index+b[0].length;break;case"named-range":s=Xt(b[0],!1),j=Ep(s["cell-range-address"]);var Z={Name:s.name,Ref:j[0]+"!"+j[1]};U&&(Z.Sheet=h.length),A.Names.push(Z);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(b[1]==="/"&&(!x||!x["string-value"])){var se=wL(n.slice(E,b.index));y=(y.length>0?y+`
`:"")+se[0]}else Xt(b[0],!1),E=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{j=Ep(Xt(b[0])["target-range-address"]),f[j[0]]["!autofilter"]={ref:j[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(S=Xt(b[0],!1),!S.href)break;S.Target=vr(S.href),delete S.href,S.Target.charAt(0)=="#"&&S.Target.indexOf(".")>-1?(j=Ep(S.Target.slice(1)),S.Target="#"+j[0]+"!"+j[1]):S.Target.match(/^\.\.[\\\/]/)&&(S.Target=S.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(e.WTF)throw new Error(b)}}var re={Sheets:f,SheetNames:h,Workbook:A};return e.bookSheets&&delete re.Sheets,re}function q2(t,r){r=r||{},Fa(t,"META-INF/manifest.xml")&&Pj(on(t,"META-INF/manifest.xml"),r);var e=wa(t,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var n=I4(Fr(e),r);return Fa(t,"meta.xml")&&(n.Props=X_(on(t,"meta.xml"))),n}function W2(t,r){return I4(t,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function l1(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function im(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Fr(Vo(t))}function om(t){var r=t.reduce(function(a,o){return a+o.length},0),e=new Uint8Array(r),n=0;return t.forEach(function(a){e.set(a,n),n+=a.length}),e}function G2(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function _L(t,r){for(var e=(t[r+15]&127)<<7|t[r+14]>>1,n=t[r+14]&1,a=r+13;a>=r;--a)n=n*256+t[a];return(t[r+15]&128?-n:n)*Math.pow(10,e-6176)}function Pu(t,r){var e=r?r[0]:0,n=t[e]&127;e:if(t[e++]>=128&&(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,28),++e,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,35),++e,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,42),++e,t[e++]<128)))break e;return r&&(r[0]=e),n}function xn(t){var r=0,e=t[r]&127;e:if(t[r++]>=128){if(e|=(t[r]&127)<<7,t[r++]<128||(e|=(t[r]&127)<<14,t[r++]<128)||(e|=(t[r]&127)<<21,t[r++]<128))break e;e|=(t[r]&127)<<28}return e}function zn(t){for(var r=[],e=[0];e[0]<t.length;){var n=e[0],a=Pu(t,e),o=a&7;a=Math.floor(a/8);var s=0,l;if(a==0)break;switch(o){case 0:{for(var c=e[0];t[e[0]++]>=128;);l=t.slice(c,e[0])}break;case 5:s=4,l=t.slice(e[0],e[0]+s),e[0]+=s;break;case 1:s=8,l=t.slice(e[0],e[0]+s),e[0]+=s;break;case 2:s=Pu(t,e),l=t.slice(e[0],e[0]+s),e[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(n))}var i={data:l,type:o};r[a]==null?r[a]=[i]:r[a].push(i)}return r}function c1(t,r){return(t==null?void 0:t.map(function(e){return r(e.data)}))||[]}function SL(t){for(var r,e=[],n=[0];n[0]<t.length;){var a=Pu(t,n),o=zn(t.slice(n[0],n[0]+a));n[0]+=a;var s={id:xn(o[1][0].data),messages:[]};o[2].forEach(function(l){var c=zn(l.data),i=xn(c[3][0].data);s.messages.push({meta:c,data:t.slice(n[0],n[0]+i)}),n[0]+=i}),(r=o[3])!=null&&r[0]&&(s.merge=xn(o[3][0].data)>>>0>0),e.push(s)}return e}function kL(t,r){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],n=Pu(r,e),a=[];e[0]<r.length;){var o=r[e[0]]&3;if(o==0){var s=r[e[0]++]>>2;if(s<60)++s;else{var l=s-59;s=r[e[0]],l>1&&(s|=r[e[0]+1]<<8),l>2&&(s|=r[e[0]+2]<<16),l>3&&(s|=r[e[0]+3]<<24),s>>>=0,s++,e[0]+=l}a.push(r.slice(e[0],e[0]+s)),e[0]+=s;continue}else{var c=0,i=0;if(o==1?(i=(r[e[0]]>>2&7)+4,c=(r[e[0]++]&224)<<3,c|=r[e[0]++]):(i=(r[e[0]++]>>2)+1,o==2?(c=r[e[0]]|r[e[0]+1]<<8,e[0]+=2):(c=(r[e[0]]|r[e[0]+1]<<8|r[e[0]+2]<<16|r[e[0]+3]<<24)>>>0,e[0]+=4)),a=[om(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(i>=c)for(a.push(a[0].slice(-c)),i-=c;i>=a[a.length-1].length;)a.push(a[a.length-1]),i-=a[a.length-1].length;a.push(a[0].slice(-c,-c+i))}}var u=om(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function EL(t){for(var r=[],e=0;e<t.length;){var n=t[e++],a=t[e]|t[e+1]<<8|t[e+2]<<16;e+=3,r.push(kL(n,t.slice(e,e+a))),e+=a}if(e!==t.length)throw new Error("data is not a valid framed stream!");return om(r)}function TL(t,r,e,n){var a=l1(t),o=a.getUint32(4,!0),s=(n>1?12:8)+G2(o&(n>1?3470:398))*4,l=-1,c=-1,i=NaN,u=new Date(2001,0,1);o&512&&(l=a.getUint32(s,!0),s+=4),s+=G2(o&(n>1?12288:4096))*4,o&16&&(c=a.getUint32(s,!0),s+=4),o&32&&(i=a.getFloat64(s,!0),s+=8),o&64&&(u.setTime(u.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var p;switch(t[2]){case 0:break;case 2:p={t:"n",v:i};break;case 3:p={t:"s",v:r[c]};break;case 5:p={t:"d",v:u};break;case 6:p={t:"b",v:i>0};break;case 7:p={t:"n",v:i/86400};break;case 8:p={t:"e",v:0};break;case 9:if(l>-1)p={t:"s",v:e[l]};else if(c>-1)p={t:"s",v:r[c]};else if(!isNaN(i))p={t:"n",v:i};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return p}function AL(t,r,e){var n=l1(t),a=n.getUint32(8,!0),o=12,s=-1,l=-1,c=NaN,i=NaN,u=new Date(2001,0,1);a&1&&(c=_L(t,o),o+=16),a&2&&(i=n.getFloat64(o,!0),o+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(o,!0)*1e3),o+=8),a&8&&(l=n.getUint32(o,!0),o+=4),a&16&&(s=n.getUint32(o,!0),o+=4);var p;switch(t[1]){case 0:break;case 2:p={t:"n",v:c};break;case 3:p={t:"s",v:r[l]};break;case 5:p={t:"d",v:u};break;case 6:p={t:"b",v:i>0};break;case 7:p={t:"n",v:i/86400};break;case 8:p={t:"e",v:0};break;case 9:if(s>-1)p={t:"s",v:e[s]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:p={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return p}function CL(t,r,e){switch(t[0]){case 0:case 1:case 2:case 3:return TL(t,r,e,t[0]);case 5:return AL(t,r,e);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Zi(t){var r=zn(t);return Pu(r[1][0].data)}function Y2(t,r){var e=zn(r.data),n=xn(e[1][0].data),a=e[3],o=[];return(a||[]).forEach(function(s){var l=zn(s.data),c=xn(l[1][0].data)>>>0;switch(n){case 1:o[c]=im(l[3][0].data);break;case 8:{var i=t[Zi(l[9][0].data)][0],u=zn(i.data),p=t[Zi(u[1][0].data)][0],f=xn(p.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var h=zn(p.data);o[c]=h[3].map(function(v){return im(v.data)}).join("")}break}}),o}function NL(t,r){var e,n,a,o,s,l,c,i,u,p,f,h,v,b,g=zn(t),x=xn(g[1][0].data)>>>0,y=xn(g[2][0].data)>>>0,E=((n=(e=g[8])==null?void 0:e[0])==null?void 0:n.data)&&xn(g[8][0].data)>0||!1,N,I;if((o=(a=g[7])==null?void 0:a[0])!=null&&o.data&&r!=0)N=(l=(s=g[7])==null?void 0:s[0])==null?void 0:l.data,I=(i=(c=g[6])==null?void 0:c[0])==null?void 0:i.data;else if((p=(u=g[4])==null?void 0:u[0])!=null&&p.data&&r!=1)N=(h=(f=g[4])==null?void 0:f[0])==null?void 0:h.data,I=(b=(v=g[3])==null?void 0:v[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var L=E?4:1,H=l1(N),V=[],q=0;q<N.length/2;++q){var K=H.getUint16(q*2,!0);K<65535&&V.push([q,K])}if(V.length!=y)throw"Expected ".concat(y," cells, found ").concat(V.length);var z=[];for(q=0;q<V.length-1;++q)z[V[q][0]]=I.subarray(V[q][1]*L,V[q+1][1]*L);return V.length>=1&&(z[V[V.length-1][0]]=I.subarray(V[V.length-1][1]*L)),{R:x,cells:z}}function OL(t,r){var e,n=zn(r.data),a=(e=n==null?void 0:n[7])!=null&&e[0]?xn(n[7][0].data)>>>0>0?1:0:-1,o=c1(n[5],function(s){return NL(s,a)});return{nrows:xn(n[4][0].data)>>>0,data:o.reduce(function(s,l){return s[l.R]||(s[l.R]=[]),l.cells.forEach(function(c,i){if(s[l.R][i])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(i));s[l.R][i]=c}),s},[])}}function jL(t,r,e){var n,a=zn(r.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(xn(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(xn(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));e["!ref"]=pr(o);var s=zn(a[4][0].data),l=Y2(t,t[Zi(s[4][0].data)][0]),c=(n=s[17])!=null&&n[0]?Y2(t,t[Zi(s[17][0].data)][0]):[],i=zn(s[3][0].data),u=0;i[1].forEach(function(p){var f=zn(p.data),h=t[Zi(f[2][0].data)][0],v=xn(h.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var b=OL(t,h);b.data.forEach(function(g,x){g.forEach(function(y,E){var N=Qt({r:u+x,c:E}),I=CL(y,l,c);I&&(e[N]=I)})}),u+=b.nrows})}function DL(t,r){var e=zn(r.data),n={"!ref":"A1"},a=t[Zi(e[2][0].data)],o=xn(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return jL(t,a[0],n),n}function ML(t,r){var e,n=zn(r.data),a={name:(e=n[1])!=null&&e[0]?im(n[1][0].data):"",sheets:[]},o=c1(n[2],Zi);return o.forEach(function(s){t[s].forEach(function(l){var c=xn(l.meta[1][0].data);c==6e3&&a.sheets.push(DL(t,l))})}),a}function RL(t,r){var e=f1(),n=zn(r.data),a=c1(n[1],Zi);if(a.forEach(function(o){t[o].forEach(function(s){var l=xn(s.meta[1][0].data);if(l==2){var c=ML(t,s);c.sheets.forEach(function(i,u){h1(e,i,u==0?c.name:c.name+"_"+u,!0)})}})}),e.SheetNames.length==0)throw new Error("Empty NUMBERS file");return e}function Ap(t){var r,e,n,a,o={},s=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var i;try{i=EL(c.content)}catch(p){return console.log("?? "+c.content.length+" "+(p.message||p))}var u;try{u=SL(i)}catch(p){return console.log("## "+(p.message||p))}u.forEach(function(p){o[p.id]=p.messages,s.push(p.id)})}}),!s.length)throw new Error("File has no messages");var l=((a=(n=(e=(r=o==null?void 0:o[1])==null?void 0:r[0])==null?void 0:e.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&xn(o[1][0].meta[1][0].data)==1&&o[1][0];if(l||s.forEach(function(c){o[c].forEach(function(i){var u=xn(i.meta[1][0].data)>>>0;if(u==1)if(!l)l=i;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return RL(o,l)}function FL(t){return function(e){for(var n=0;n!=t.length;++n){var a=t[n];e[a[0]]===void 0&&(e[a[0]]=a[1]),a[2]==="n"&&(e[a[0]]=Number(e[a[0]]))}}}function u1(t){FL([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function IL(t){return $l.WS.indexOf(t)>-1?"sheet":t==$l.CS?"chart":t==$l.DS?"dialog":t==$l.MS?"macro":t&&t.length?t:"sheet"}function PL(t,r){if(!t)return 0;try{t=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,IL(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function LL(t,r,e,n,a,o,s,l,c,i,u,p){try{o[n]=hu(wa(t,e,!0),r);var f=on(t,r),h;switch(l){case"sheet":h=HP(f,r,a,c,o[n],i,u,p);break;case"chart":if(h=qP(f,r,a,c,o[n],i,u,p),!h||!h["!drawel"])break;var v=iu(h["!drawel"].Target,r),b=tm(v),g=VR(wa(t,v,!0),hu(wa(t,b,!0),v)),x=iu(g,v),y=tm(x);h=AP(wa(t,x,!0),x,c,hu(wa(t,y,!0),x),i,h);break;case"macro":h=WP(f,r,a,c,o[n],i,u,p);break;case"dialog":h=GP(f,r,a,c,o[n],i,u,p);break;default:throw new Error("Unrecognized sheet type "+l)}s[n]=h;var E=[];o&&o[n]&&Ds(o[n]).forEach(function(N){var I="";if(o[n][N].Type==$l.CMNT){I=iu(o[n][N].Target,r);var L=ZP(on(t,I,!0),I,c);if(!L||!L.length)return;M2(h,L,!1)}o[n][N].Type==$l.TCMNT&&(I=iu(o[n][N].Target,r),E=E.concat(qR(on(t,I,!0),c)))}),E&&E.length&&M2(h,E,!0,c.people||[])}catch(N){if(c.WTF)throw N}}function Da(t){return t.charAt(0)=="/"?t.slice(1):t}function BL(t,r){if(y_(),r=r||{},u1(r),Fa(t,"META-INF/manifest.xml")||Fa(t,"objectdata.xml"))return q2(t,r);if(Fa(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ap<"u"){if(t.FileIndex)return Ap(t);var e=hr.utils.cfb_new();return i2(t).forEach(function(M){UO(e,M,BO(t,M))}),Ap(e)}throw new Error("Unsupported NUMBERS file")}if(!Fa(t,"[Content_Types].xml"))throw Fa(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Fa(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=i2(t),a=Fj(wa(t,"[Content_Types].xml")),o=!1,s,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",on(t,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!on(t,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var c={},i={};if(!r.bookSheets&&!r.bookProps){if(gu=[],a.sst)try{gu=KP(on(t,Da(a.sst)),a.sst,r)}catch(M){if(r.WTF)throw M}r.cellStyles&&a.themes.length&&(c=XP(wa(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],r)),a.style&&(i=YP(on(t,Da(a.style)),a.style,c,r))}a.links.map(function(M){try{var C=hu(wa(t,tm(Da(M))),M);return QP(on(t,Da(M)),C,M,r)}catch{}});var u=VP(on(t,Da(a.workbooks[0])),a.workbooks[0],r),p={},f="";a.coreprops.length&&(f=on(t,Da(a.coreprops[0]),!0),f&&(p=X_(f)),a.extprops.length!==0&&(f=on(t,Da(a.extprops[0]),!0),f&&Uj(f,p,r)));var h={};(!r.bookSheets||r.bookProps)&&a.custprops.length!==0&&(f=wa(t,Da(a.custprops[0]),!0),f&&(h=$j(f,r)));var v={};if((r.bookSheets||r.bookProps)&&(u.Sheets?s=u.Sheets.map(function(C){return C.name}):p.Worksheets&&p.SheetNames.length>0&&(s=p.SheetNames),r.bookProps&&(v.Props=p,v.Custprops=h),r.bookSheets&&typeof s<"u"&&(v.SheetNames=s),r.bookSheets?v.SheetNames:r.bookProps))return v;s={};var b={};r.bookDeps&&a.calcchain&&(b=JP(on(t,Da(a.calcchain)),a.calcchain));var g=0,x={},y,E;{var N=u.Sheets;p.Worksheets=N.length,p.SheetNames=[];for(var I=0;I!=N.length;++I)p.SheetNames[I]=N[I].name}var L=o?"bin":"xml",H=a.workbooks[0].lastIndexOf("/"),V=(a.workbooks[0].slice(0,H+1)+"_rels/"+a.workbooks[0].slice(H+1)+".rels").replace(/^\//,"");Fa(t,V)||(V="xl/_rels/workbook."+L+".rels");var q=hu(wa(t,V,!0),V.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(r.xlmeta=eL(on(t,Da(a.metadata[0])),a.metadata[0],r)),(a.people||[]).length>=1&&(r.people=WR(on(t,Da(a.people[0])),r)),q&&(q=PL(q,u.Sheets));var K=on(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=p.Worksheets;++g){var z="sheet";if(q&&q[g]?(y="xl/"+q[g][1].replace(/[\/]?xl\//,""),Fa(t,y)||(y=q[g][1]),Fa(t,y)||(y=V.replace(/_rels\/.*$/,"")+q[g][1]),z=q[g][2]):(y="xl/worksheets/sheet"+(g+1-K)+"."+L,y=y.replace(/sheet0\./,"sheet.")),E=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(g!=r.sheets)continue e;break;case"string":if(p.SheetNames[g].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var W=!1,D=0;D!=r.sheets.length;++D)typeof r.sheets[D]=="number"&&r.sheets[D]==g&&(W=1),typeof r.sheets[D]=="string"&&r.sheets[D].toLowerCase()==p.SheetNames[g].toLowerCase()&&(W=1);if(!W)continue e}}LL(t,y,E,p.SheetNames[g],g,x,s,z,r,u,c,i)}return v={Directory:a,Workbook:u,Props:p,Custprops:h,Deps:b,Sheets:s,SheetNames:p.SheetNames,Strings:gu,Styles:i,Themes:c,SSF:Mn(rr)},r&&r.bookFiles&&(t.files?(v.keys=n,v.files=t.files):(v.keys=[],v.files={},t.FullPaths.forEach(function(M,C){M=M.replace(/^Root Entry[\/]/,""),v.keys.push(M),v.files[M]=t.FileIndex[C]}))),r&&r.bookVBA&&(a.vba.length>0?v.vbaraw=on(t,Da(a.vba[0]),!0):a.defaults&&a.defaults.bin===KR&&(v.vbaraw=on(t,"xl/vbaProject.bin",!0))),v}function UL(t,r){var e=r||{},n="Workbook",a=hr.find(t,n);try{if(n="/!DataSpaces/Version",a=hr.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(DM(a.content),n="/!DataSpaces/DataSpaceMap",a=hr.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=RM(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=hr.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=FM(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=hr.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);PM(a.content)}catch{}if(n="/EncryptionInfo",a=hr.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=LM(a.content);if(n="/EncryptedPackage",a=hr.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,e.password||"",e);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,e.password||"",e);throw new Error("File is password-protected")}function d1(t,r){var e="";switch((r||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=Sa(t.slice(0,12));break;case"binary":e=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function zL(t,r){return hr.find(t,"EncryptedPackage")?UL(t,r):M4(t,r)}function $L(t,r){var e,n=t,a=r||{};return a.type||(a.type=dr&&Buffer.isBuffer(t)?"buffer":"base64"),e=T_(n,a),BL(e,a)}function P4(t,r){var e=0;e:for(;e<t.length;)switch(t.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return am(t.slice(e),r);default:break e}return Ru.to_workbook(t,r)}function VL(t,r){var e="",n=d1(t,r);switch(r.type){case"base64":e=Sa(t);break;case"binary":e=t;break;case"buffer":e=t.toString("binary");break;case"array":e=Uo(t);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(e=Fr(e)),r.type="binary",P4(e,r)}function HL(t,r){var e=t;return r.type=="base64"&&(e=Sa(e)),e=Ou.utils.decode(1200,e.slice(2),"str"),r.type="binary",P4(e,r)}function qL(t){return t.match(/[^\x00-\x7F]/)?ou(t):t}function Cp(t,r,e,n){return n?(e.type="string",Ru.to_workbook(t,e)):Ru.to_workbook(r,e)}function Bf(t,r){l_();var e=r||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Bf(new Uint8Array(t),(e=Mn(e),e.type="array",e));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!e.type&&(e.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],o=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),Yl={},e.dateNF&&(Yl.dateNF=e.dateNF),e.type||(e.type=dr&&Buffer.isBuffer(t)?"buffer":"base64"),e.type=="file"&&(e.type=dr?"buffer":"binary",n=DO(t),typeof Uint8Array<"u"&&!dr&&(e.type="array")),e.type=="string"&&(o=!0,e.type="binary",e.codepage=65001,n=qL(t)),e.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),l=new Uint8Array(s);if(l.foo="bar",!l.foo)return e=Mn(e),e.type="array",Bf(Vm(n),e)}switch((a=d1(n,e))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return zL(hr.read(n,e),e);break;case 9:if(a[1]<=8)return M4(n,e);break;case 60:return am(n,e);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return xM(n,e);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return vM.to_workbook(n,e);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?$L(n,e):Cp(t,n,e,o);case 239:return a[3]===60?am(n,e):Cp(t,n,e,o);case 255:if(a[1]===254)return HL(n,e);if(a[1]===0&&a[2]===2&&a[3]===0)return mu.to_workbook(n,e);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return mu.to_workbook(n,e);break;case 3:case 131:case 139:case 140:return D2.to_workbook(n,e);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return KM.to_workbook(n,e);break;case 10:case 13:case 32:return VL(n,e);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return mM.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?D2.to_workbook(n,e):Cp(t,n,e,o)}function WL(t,r,e,n,a,o,s,l){var c=Rn(e),i=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),p=!0,f=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:e,enumerable:!1})}catch{f.__rowNum__=e}else f.__rowNum__=e;if(!s||t[e])for(var h=r.s.c;h<=r.e.c;++h){var v=s?t[e][h]:t[n[h]+c];if(v===void 0||v.t===void 0){if(i===void 0)continue;o[h]!=null&&(f[o[h]]=i);continue}var b=v.v;switch(v.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(o[h]!=null){if(b==null)if(v.t=="e"&&b===null)f[o[h]]=null;else if(i!==void 0)f[o[h]]=i;else if(u&&b===null)f[o[h]]=null;else continue;else f[o[h]]=u&&(v.t!=="n"||v.t==="n"&&l.rawNumbers!==!1)?b:ii(v,b,l);b!=null&&(p=!1)}}return{row:f,isempty:p}}function lm(t,r){if(t==null||t["!ref"]==null)return[];var e={t:"n",v:0},n=0,a=1,o=[],s=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},i=r||{},u=i.range!=null?i.range:t["!ref"];switch(i.header===1?n=1:i.header==="A"?n=2:Array.isArray(i.header)?n=3:i.header==null&&(n=0),typeof u){case"string":c=Yr(u);break;case"number":c=Yr(t["!ref"]),c.s.r=u;break;default:c=u}n>0&&(a=0);var p=Rn(c.s.r),f=[],h=[],v=0,b=0,g=Array.isArray(t),x=c.s.r,y=0,E={};g&&!t[x]&&(t[x]=[]);var N=i.skipHidden&&t["!cols"]||[],I=i.skipHidden&&t["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(N[y]||{}).hidden)switch(f[y]=bn(y),e=g?t[x][y]:t[f[y]+p],n){case 1:o[y]=y-c.s.c;break;case 2:o[y]=f[y];break;case 3:o[y]=i.header[y-c.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),l=s=ii(e,null,i),b=E[s]||0,!b)E[s]=1;else{do l=s+"_"+b++;while(E[l]);E[s]=b,E[l]=1}o[y]=l}for(x=c.s.r+a;x<=c.e.r;++x)if(!(I[x]||{}).hidden){var L=WL(t,c,x,f,n,o,g,i);(L.isempty===!1||(n===1?i.blankrows!==!1:i.blankrows))&&(h[v++]=L.row)}return h.length=v,h}var X2=/"/g;function GL(t,r,e,n,a,o,s,l){for(var c=!0,i=[],u="",p=Rn(e),f=r.s.c;f<=r.e.c;++f)if(n[f]){var h=l.dense?(t[e]||[])[f]:t[n[f]+p];if(h==null)u="";else if(h.v!=null){c=!1,u=""+(l.rawNumbers&&h.t=="n"?h.v:ii(h,null,l));for(var v=0,b=0;v!==u.length;++v)if((b=u.charCodeAt(v))===a||b===o||b===34||l.forceQuotes){u='"'+u.replace(X2,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(c=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(X2,'""')+'"')):u="";i.push(u)}return l.blankrows===!1&&c?null:i.join(s)}function L4(t,r){var e=[],n=r??{};if(t==null||t["!ref"]==null)return"";var a=Yr(t["!ref"]),o=n.FS!==void 0?n.FS:",",s=o.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),i=new RegExp((o=="|"?"\\|":o)+"+$"),u="",p=[];n.dense=Array.isArray(t);for(var f=n.skipHidden&&t["!cols"]||[],h=n.skipHidden&&t["!rows"]||[],v=a.s.c;v<=a.e.c;++v)(f[v]||{}).hidden||(p[v]=bn(v));for(var b=0,g=a.s.r;g<=a.e.r;++g)(h[g]||{}).hidden||(u=GL(t,a,g,p,s,c,o,n),u!=null&&(n.strip&&(u=u.replace(i,"")),(u||n.blankrows!==!1)&&e.push((b++?l:"")+u)));return delete n.dense,e.join("")}function YL(t,r){r||(r={}),r.FS="	",r.RS=`
`;var e=L4(t,r);return e}function XL(t){var r="",e,n="";if(t==null||t["!ref"]==null)return[];var a=Yr(t["!ref"]),o="",s=[],l,c=[],i=Array.isArray(t);for(l=a.s.c;l<=a.e.c;++l)s[l]=bn(l);for(var u=a.s.r;u<=a.e.r;++u)for(o=Rn(u),l=a.s.c;l<=a.e.c;++l)if(r=s[l]+o,e=i?(t[u]||[])[l]:t[r],n="",e!==void 0){if(e.F!=null){if(r=e.F,!e.f)continue;n=e.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(e.f!=null)n=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)n=""+e.v;else if(e.t=="b")n=e.v?"TRUE":"FALSE";else if(e.w!==void 0)n="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?n="'"+e.v:n=""+e.v}}c[c.length]=r+"="+n}return c}function B4(t,r,e){var n=e||{},a=+!n.skipHeader,o=t||{},s=0,l=0;if(o&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Kn(n.origin):n.origin;s=c.r,l=c.c}var i,u={s:{c:0,r:0},e:{c:l,r:s+r.length-1+a}};if(o["!ref"]){var p=Yr(o["!ref"]);u.e.c=Math.max(u.e.c,p.e.c),u.e.r=Math.max(u.e.r,p.e.r),s==-1&&(s=p.e.r+1,u.e.r=s+r.length-1+a)}else s==-1&&(s=0,u.e.r=r.length-1+a);var f=n.header||[],h=0;r.forEach(function(b,g){Ds(b).forEach(function(x){(h=f.indexOf(x))==-1&&(f[h=f.length]=x);var y=b[x],E="z",N="",I=Qt({c:l+h,r:s+g+a});i=Lu(o,I),y&&typeof y=="object"&&!(y instanceof Date)?o[I]=y:(typeof y=="number"?E="n":typeof y=="boolean"?E="b":typeof y=="string"?E="s":y instanceof Date?(E="d",n.cellDates||(E="n",y=Jn(y)),N=n.dateNF||rr[14]):y===null&&n.nullError&&(E="e",y=0),i?(i.t=E,i.v=y,delete i.w,delete i.R,N&&(i.z=N)):o[I]=i={t:E,v:y},N&&(i.z=N))})}),u.e.c=Math.max(u.e.c,l+f.length-1);var v=Rn(s);if(a)for(h=0;h<f.length;++h)o[bn(h+l)+v]={t:"s",v:f[h]};return o["!ref"]=pr(u),o}function KL(t,r){return B4(null,t,r)}function Lu(t,r,e){if(typeof r=="string"){if(Array.isArray(t)){var n=Kn(r);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return typeof r!="number"?Lu(t,Qt(r)):Lu(t,Qt({r,c:e||0}))}function ZL(t,r){if(typeof r=="number"){if(r>=0&&t.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var e=t.SheetNames.indexOf(r);if(e>-1)return e;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function f1(){return{SheetNames:[],Sheets:{}}}function h1(t,r,e,n){var a=1;if(!e)for(;a<=65535&&t.SheetNames.indexOf(e="Sheet"+a)!=-1;++a,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(e)>=0){var o=e.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var s=o&&o[1]||e;for(++a;a<=65535&&t.SheetNames.indexOf(e=s+a)!=-1;++a);}if(FP(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=r,e}function JL(t,r,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=ZL(t,r);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[n].Hidden=e}function QL(t,r){return t.z=r,t}function U4(t,r,e){return r?(t.l={Target:r},e&&(t.l.Tooltip=e)):delete t.l,t}function eB(t,r,e){return U4(t,"#"+r,e)}function tB(t,r,e){t.c||(t.c=[]),t.c.push({t:r,a:e||"SheetJS"})}function rB(t,r,e,n){for(var a=typeof r!="string"?r:Yr(r),o=typeof r=="string"?r:pr(r),s=a.s.r;s<=a.e.r;++s)for(var l=a.s.c;l<=a.e.c;++l){var c=Lu(t,s,l);c.t="n",c.F=o,delete c.v,s==a.s.r&&l==a.s.c&&(c.f=e,n&&(c.D=!0))}return t}var K2={encode_col:bn,encode_row:Rn,encode_cell:Qt,encode_range:pr,decode_col:Jm,decode_row:Zm,split_cell:pj,decode_cell:Kn,decode_range:nc,format_cell:ii,sheet_add_aoa:H_,sheet_add_json:B4,sheet_add_dom:R4,aoa_to_sheet:ac,json_to_sheet:KL,table_to_sheet:F4,table_to_book:xL,sheet_to_csv:L4,sheet_to_txt:YL,sheet_to_json:lm,sheet_to_html:bL,sheet_to_formulae:XL,sheet_to_row_object_array:lm,sheet_get_cell:Lu,book_new:f1,book_append_sheet:h1,book_set_sheet_visibility:JL,cell_set_number_format:QL,cell_set_hyperlink:U4,cell_set_internal_link:eB,cell_add_comment:tB,sheet_set_array_formula:rB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Z2={"CNPJ Destinatrio":{dbField:"cnpj_destinatario",visible:!1,type:"string"},Destinatrio:{dbField:"destinatario",visible:!1,type:"string"},"Cidade Destino":{dbField:"cidade_destino",visible:!1,type:"string"},"UF Destino":{dbField:"uf_destino",visible:!1,type:"string"},"CNPJ Emitente":{dbField:"cnpj_emitente",visible:!1,type:"string"},"Nome PJ Emitente":{dbField:"nome_pj_emitente",visible:!1,type:"string"},"Chave de Acesso":{dbField:"chave_acesso",visible:!1,type:"string"},Srie:{dbField:"serie",visible:!1,type:"string"},Tipo:{dbField:"tipo",visible:!1,type:"string"},Status:{dbField:"status_nfe",visible:!1,type:"string"},"Nome ou e-mail do usurio que fez a sincronizao":{dbField:"nome_usuario_sync",visible:!1,type:"string"},"Data da sincronizao":{dbField:"data_sync",visible:!1,type:"date"},"Natureza Operao":{dbField:"natureza_operacao",visible:!1,type:"string"},"CFOPs da Nota":{dbField:"cfops",visible:!1,type:"string"},Etiquetas:{dbField:"etiquetas",visible:!1,type:"string"},"Nome Filial":{dbField:"nome_filial",visible:!0,type:"string"},FILIAL:{dbField:"nome_filial",visible:!0,type:"string"},"Nome Cliente":{dbField:"nome_cliente",visible:!0,type:"string"},"Cidade Origem":{dbField:"cidade_origem",visible:!0,type:"string"},"UF Origem":{dbField:"uf_origem",visible:!0,type:"string"},"Data Emisso":{dbField:"data_emissao",visible:!0,type:"date"},Nmero:{dbField:"numero",visible:!0,type:"string"},"Valor Total da Nota":{dbField:"valor_total_nota",visible:!0,type:"number"},"Peso lquido":{dbField:"peso_liquido",visible:!0,type:"number"},"Sincronizao ERP":{dbField:"sincronizacao_erp",visible:!0,type:"string"},"Finalidade NFe":{dbField:"finalidade_nfe",visible:!0,type:"string"},"Dados Adicionais":{dbField:"dados_adicionais",visible:!0,type:"string"},Vendedor:{dbField:"vendedor",visible:!0,type:"string"},Motivo:{dbField:"motivo",visible:!0,type:"string"},Resultado:{dbField:"resultado",visible:!0,type:"string"},"[Item] Descrio":{dbField:"item_description",visible:!0,type:"string"},"[Item] Unidade":{dbField:"item_unit",visible:!0,type:"string"},"[Item] Quantidade":{dbField:"item_quantity",visible:!0,type:"number"},"[Item] Valor Unitrio":{dbField:"item_unit_value",visible:!0,type:"number"},"[Item] Valor Total Bruto":{dbField:"item_total_value",visible:!0,type:"number"},"[Item] Nmero do Item.":{dbField:"item_number",visible:!0,type:"string"}};function nB(){const[t,r]=ye.useState(null),[e,n]=ye.useState([]),[a,o]=ye.useState(!1),s=h=>{if(h.target.files&&h.target.files[0]){const v=h.target.files[0];r(v),l(v)}},l=async h=>{const v=new FileReader;v.onload=async b=>{var x;const g=(x=b.target)==null?void 0:x.result;if(g){const y=Bf(g,{type:"binary",cellDates:!0}),E=y.SheetNames[0],N=y.Sheets[E],I=K2.sheet_to_json(N),L=I.map(W=>String(W["CNPJ Emitente"]||"")).filter(W=>W&&W.trim()!=="");let H=new Map,V=new Map;const q=W=>W?W.replace(/[^\d]/g,""):"";if(L.length>0){const{data:W}=await Tt.from("clientes").select("cnpj_cpf, nome, vendedor, rede, uf, municipio");W&&W.forEach(D=>{const M=q(D.cnpj_cpf||"");M&&M.length>=11&&H.set(M,D)})}const{data:K}=await Tt.from("emitentes").select("cnpj, nome_fantasia");K&&K.forEach(W=>{const D=q(W.cnpj||"");if(D&&D.length>=11){const M=W.nome_fantasia||"";V.set(D,M)}});const z=I.slice(0,10).map(W=>{const D={...W};D["Data Emisso"]instanceof Date&&(D["Data Emisso"]=D["Data Emisso"].toLocaleDateString("pt-BR"));const M=String(W["CNPJ Emitente"]||""),C=q(M),w=C.length>=11?H.get(C):null;w?(D["Nome Cliente"]=w.nome||"",D.Vendedor=w.vendedor||""):(D["Nome Cliente"]="",D.Vendedor="");const T=String(W["CNPJ Destinatrio"]||""),A=q(T);if(A&&A.length>=11){const S=V.get(A);S&&S.trim()!==""?(D["Nome Filial"]=S,D.FILIAL=S):(D["Nome Filial"]="",D.FILIAL="")}else D["Nome Filial"]="",D.FILIAL="";return D});n(z)}},v.readAsBinaryString(h)},c=h=>h?String(h).replace(/[.\-\/\s]/g,"").trim():"",i=h=>{if(typeof h=="number"&&!isNaN(h))return h;if(h==null||h==="")return null;let v=String(h).trim();if(v==="")return null;v=v.replace(/\s/g,""),v.includes(",")&&(v=v.replace(/\./g,""),v=v.replace(",","."));const b=parseFloat(v);return isNaN(b)?null:b},u=async()=>{const h=new Map;try{const{data:v,error:b}=await Tt.from("clientes").select("nome, razao_social, cnpj_cpf, vendedor, rede").not("cnpj_cpf","is",null);if(b)return console.error("Erro ao buscar clientes:",b),h;v&&v.length>0&&v.forEach(g=>{if(g.cnpj_cpf){const x=c(g.cnpj_cpf);if(x&&x.length>=11){const y=g.nome||g.razao_social||"";h.set(x,{nome:y,vendedor:g.vendedor||"",rede:g.rede||""})}}})}catch(v){console.error("Erro ao carregar clientes:",v)}return h},p=async()=>{if(t){o(!0);try{const h=new FileReader;h.onload=async v=>{var z,W,D;const b=(z=v.target)==null?void 0:z.result,g=Bf(b,{type:"binary",cellDates:!0}),x=g.Sheets[g.SheetNames[0]],y=K2.sheet_to_json(x),E=new Map;for(const M of y){const C=M.Nmero;if(!C)continue;if(!E.has(C)){let A=new Date().toISOString();if(M["Data Emisso"])if(M["Data Emisso"]instanceof Date)A=M["Data Emisso"].toISOString();else{const S=new Date(M["Data Emisso"]);isNaN(S.getTime())||(A=S.toISOString())}E.set(C,{invoice_number:String(C),customer_cnpj:String(M["CNPJ Destinatrio"]||""),destinatario:String(M.Destinatrio||""),cidade_origem:String(M["Cidade Origem"]||""),uf_origem:String(M["UF Origem"]||""),cidade_destino:String(M["Cidade Destino"]||""),uf_destino:String(M["UF Destino"]||""),cnpj_emitente:String(M["CNPJ Emitente"]||""),nome_pj_emitente:String(M["Nome PJ Emitente"]||""),chave_acesso:String(M["Chave de Acesso"]||""),serie:String(M.Srie||""),peso_liquido:i(M["Peso lquido"])||0,tipo:String(M.Tipo||""),status_nfe:String(M.Status||""),sincronizacao_erp:String(M["Sincronizao ERP"]||""),finalidade_nfe:String(M["Finalidade NFe"]||""),natureza_operacao:String(M["Natureza Operao"]||""),cfops:String(M["CFOPs da Nota"]||""),dados_adicionais:String(M["Dados Adicionais"]||""),nfe_referenciada:String(M["NFe Referenciada"]||""),etiquetas:String(M.Etiquetas||""),invoice_date:A,total_value:0,motivo_id:null,sector_id:null,items:[]})}const w=E.get(C),T=i(M["[Item] Valor Total Bruto"])||0;w.total_value+=T,w.items.push({description:M["[Item] Descrio"],quantity:i(M["[Item] Quantidade"])||0,unit:M["[Item] Unidade"],unit_value:i(M["[Item] Valor Unitrio"])||0,total_value:i(T)||0,item_number:String(M["[Item] Nmero do Item."]||"")})}let N=0,I=0;const L=Array.from(E.values()),H=await u(),V=new Map;try{const{data:M}=await Tt.from("emitentes").select("cnpj, nome_fantasia").not("cnpj","is",null);M&&M.forEach(C=>{if(C.cnpj){const w=c(C.cnpj);if(w&&w.length>=11){const T=C.nome_fantasia||"";V.set(w,T)}}})}catch(M){console.error("Erro ao carregar emitentes:",M)}const{data:q}=await Tt.from("devolucoes").select("chave_acesso").not("chave_acesso","is",null),K=new Set((q||[]).map(M=>M.chave_acesso).filter(M=>M&&M.trim()!==""));for(const M of L){if(M.chave_acesso&&M.chave_acesso.trim()!==""&&K.has(M.chave_acesso)){console.log(`Chave de acesso duplicada ignorada: ${M.chave_acesso}`),I++;continue}const C=String(M.sincronizacao_erp||"").trim().toUpperCase();if(C==="SINCRONIZADO"||C==="SIM"||C==="S"){console.log(`Registro descartado - j sincronizado: ${M.invoice_number} (Chave: ${M.chave_acesso})`),I++;continue}let w="",T="",A="";if(M.cnpj_emitente){const R=c(M.cnpj_emitente);if(R&&R.length>=11){const X=H.get(R);X&&(w=X.nome||"",T=X.vendedor||"",A=X.rede||"")}}let S="";if(M.customer_cnpj){const R=c(M.customer_cnpj);if(R&&R.length>=11){const X=V.get(R);X&&X.trim()!==""&&(S=X)}}const{data:j,error:B}=await Tt.from("devolucoes").insert({numero:M.invoice_number,nome_cliente:w,cnpj_destinatario:M.customer_cnpj,destinatario:M.destinatario,cidade_origem:M.cidade_origem,uf_origem:M.uf_origem,cidade_destino:M.cidade_destino,uf_destino:M.uf_destino,cnpj_emitente:M.cnpj_emitente,nome_pj_emitente:M.nome_pj_emitente,chave_acesso:M.chave_acesso||null,serie:M.serie,peso_liquido:i(M.peso_liquido),tipo:M.tipo,status_nfe:M.status_nfe,sincronizacao_erp:M.sincronizacao_erp,finalidade_nfe:M.finalidade_nfe,natureza_operacao:M.natureza_operacao,cfops:M.cfops,dados_adicionais:M.dados_adicionais,nfe_referenciada:M.nfe_referenciada,etiquetas:M.etiquetas,nome_filial:S,data_emissao:M.invoice_date,valor_total_nota:i(M.total_value)||0,vendedor:T,rede:A,resultado:"PENDENTE VALIDAO",motivo_id:M.reason_id,setor_id:M.sector_id}).select().single();if(B){if(B.code==="23505"||(W=B.message)!=null&&W.includes("unique")||(D=B.message)!=null&&D.includes("duplicate")){console.log(`Chave de acesso duplicada ignorada (constraint): ${M.chave_acesso}`),I++;continue}console.error("Erro ao inserir devoluo:",B);continue}if(j){M.chave_acesso&&M.chave_acesso.trim()!==""&&K.add(M.chave_acesso);const R=M.items.map(Y=>({devolucao_id:j.id,descricao:Y.description,quantidade:i(Y.quantity)||0,unidade:Y.unit,valor_unitario:i(Y.unit_value)||0,valor_total_bruto:i(Y.total_value)||0,numero_item:Y.item_number})),{error:X}=await Tt.from("itens_devolucao").insert(R);X||N++}}if(N>0){let M=`${N} devoluo(es) importada(s) com sucesso!`;I>0&&(M+=` ${I} registro(s) ignorado(s) (duplicados ou j sincronizados).`),St.success(M)}else I>0?St.warning(`${I} registro(s) ignorado(s) (duplicados ou j sincronizados). Nenhuma devoluo nova foi importada.`):St.warning("Nenhuma devoluo importada. Verifique o arquivo.");o(!1),r(null),n([])},h.readAsBinaryString(t)}catch(h){console.error(h),St.error("Erro crtico ao processar arquivo"),o(!1)}}},f=Object.keys(Z2).filter(h=>Z2[h].visible);return k.jsxs("div",{className:"space-y-6",children:[k.jsx(Qi,{title:"Sincronizao",description:"Importe arquivos CSV ou XLSX para sincronizar devolues. O sistema busca automaticamente dados de clientes e filiais."}),k.jsx("div",{className:"grid gap-6 md:grid-cols-1",children:k.jsxs(Dt,{children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:"Importar Arquivo"}),k.jsx(Vr,{children:"Faa upload de arquivos CSV ou XLSX. O sistema identificar automaticamente os Motivos, Setores e buscar o nome do cliente na base de dados usando o CNPJ."})]}),k.jsxs(Mt,{children:[k.jsxs("div",{className:"flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-10 hover:bg-muted/50 transition-colors relative",children:[k.jsx(wr,{type:"file",accept:".csv, .xlsx, .xls",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:s}),k.jsx(NS,{className:"h-10 w-10 text-muted-foreground mb-4"}),k.jsx("p",{className:"text-sm font-medium mb-1",children:t?t.name:"Arraste e solte ou clique para selecionar"}),k.jsx("p",{className:"text-xs text-muted-foreground",children:"Suporta .csv e .xlsx"})]}),e.length>0&&k.jsxs("div",{className:"mt-6 space-y-4",children:[k.jsxs("div",{className:"flex items-center justify-between",children:[k.jsx("h3",{className:"text-sm font-semibold",children:"Pr-visualizao"}),k.jsxs(Nt,{onClick:p,disabled:a,children:[a&&k.jsx(oi,{className:"mr-2 h-4 w-4 animate-spin"}),"Confirmar e Processar"]})]}),k.jsx("div",{className:"overflow-x-auto rounded-md border",children:k.jsxs(Ua,{children:[k.jsx(os,{children:k.jsx(Nr,{children:f.map(h=>k.jsx(jt,{className:"whitespace-nowrap",children:h},h))})}),k.jsx(za,{children:e.map((h,v)=>k.jsx(Nr,{children:f.map(b=>k.jsx(Kt,{className:"whitespace-nowrap",children:h[b]},`${v}-${b}`))},v))})]})}),k.jsxs("div",{className:"flex items-center gap-2 text-xs text-amber-600 bg-amber-50 p-2 rounded border border-amber-200",children:[k.jsx(Rl,{className:"h-4 w-4"}),k.jsx("span",{children:'Certifique-se de que os nomes dos "Motivos" no Excel correspondam exatamente aos cadastrados em Configuraes para que os grficos funcionem.'})]})]})]})]})})]})}const cm=ye.forwardRef(({className:t,...r},e)=>k.jsx("textarea",{className:At("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:e,...r}));cm.displayName="Textarea";const J2=["PENDENTE VALIDAO","VALIDADA","LANADA","TRATATIVA DE ANULAO","ANULADA/CANCELADA"],Q2={"PENDENTE VALIDAO":"bg-red-500 hover:bg-red-600 text-white",VALIDADA:"bg-blue-500 hover:bg-blue-600 text-white",LANADA:"bg-green-500 hover:bg-green-600 text-white","TRATATIVA DE ANULAO":"bg-orange-500 hover:bg-orange-600 text-white","ANULADA/CANCELADA":"bg-black hover:bg-gray-900 text-white"},Dl={"PENDENTE VALIDAO":1,VALIDADA:2,LANADA:3,"TRATATIVA DE ANULAO":4,"ANULADA/CANCELADA":5};function aB(t){return t.trim().split(/\s+/).filter(r=>r.length>0).length}function sB(){const[t,r]=ye.useState([]),[e,n]=ye.useState([]),[a,o]=ye.useState(!0),[s,l]=ye.useState([]),[c,i]=ye.useState({}),[u,p]=ye.useState({}),[f,h]=ye.useState(1),[v,b]=ye.useState(null),[g,x]=ye.useState(null),[y,E]=ye.useState(new Set),[N,I]=ye.useState(null),[L,H]=ye.useState(null),[V,q]=ye.useState(!1),[K,z]=ye.useState(!1),[W,D]=ye.useState({nfPendentes:0,totalPendente:0,nfValidadas:0,totalValidadas:0,nfCancelamento:0,totalCancelamento:0,nfAtraso:0,totalAtraso:0}),{user:M}=Dn(),{filters:C}=ec(),w=100;ye.useEffect(()=>{T(),A(),b(null),x(null),h(1)},[C]);const T=async()=>{try{const{data:te,error:he}=await Tt.from("motivos_devolucao").select("id, nome, sector_id").order("nome");if(he){console.error("Erro ao buscar motivos:",he),St.error("Erro ao carregar motivos");return}if(!te||te.length===0){console.warn("Nenhum motivo encontrado"),l([]);return}const le=te.map(fe=>fe.sector_id).filter(fe=>fe!==null);let ne={};if(le.length>0){const{data:fe}=await Tt.from("setores").select("id, nome").in("id",le);fe&&(ne=fe.reduce((Se,_e)=>(Se[_e.id]=_e.nome,Se),{}))}const de=te.map(fe=>({...fe,setores:fe.sector_id?{nome:ne[fe.sector_id]||""}:null}));console.log("Motivos carregados:",de.length),l(de)}catch(te){console.error("Erro ao buscar motivos:",te),St.error("Erro ao carregar motivos")}},A=async()=>{o(!0);const te=(M==null?void 0:M.role)==="VENDEDOR"?M.vendedor:null;let he=Tt.from("devolucoes").select(`
            *,
            itens:itens_devolucao(*, motivo_item:motivos_devolucao(id, nome)),
            setores:setores(nome),
            motivos_devolucao:motivos_devolucao(id, nome, setores:setores(nome))
        `);M&&M.role==="VENDEDOR"&&te&&(he=he.eq("vendedor",te),console.log(" Validao - Filtrando por vendedor:",te));const le=C.period&&!C.startDate&&!C.endDate?Kf(C.period):{},ne=C.startDate||le.startDate,de=C.endDate||le.endDate;C.search&&(he=he.or(`nome_cliente.ilike.%${C.search}%,vendedor.ilike.%${C.search}%,numero.ilike.%${C.search}%`)),C.resultado&&C.resultado.length>0&&(he=he.in("resultado",C.resultado)),C.motivo&&C.motivo.length>0&&(he=he.in("motivo_id",C.motivo)),C.cliente&&C.cliente.length>0&&(he=he.in("nome_cliente",C.cliente)),C.vendedor&&C.vendedor.length>0&&(he=he.in("vendedor",C.vendedor));let fe=[];if(C.setor&&C.setor.length>0){const{data:Ce}=await Tt.from("motivos_devolucao").select("id").in("sector_id",C.setor);fe=(Ce==null?void 0:Ce.map(Re=>Re.id))||[],he=he.in("setor_id",C.setor)}if(ne){const Ce=new Date(ne);Ce.setHours(0,0,0,0);const Re=new Date(Ce.getTime()-3*60*60*1e3);he=he.gte("data_emissao",Re.toISOString().split("T")[0])}if(de){const Ce=new Date(de);Ce.setHours(23,59,59,999);const Re=new Date(Ce.getTime()-3*60*60*1e3);he=he.lte("data_emissao",Re.toISOString().split("T")[0])}const{data:Se,error:_e}=await he.order("created_at",{ascending:!1});if(_e)St.error("Erro ao carregar devolues"),console.error(_e);else if(Se){let Ce=Se;C.setor&&C.setor.length>0&&fe.length>0&&(Ce=Se.filter($e=>{const Be=$e.setor_id&&C.setor.includes($e.setor_id),wt=$e.motivo_id&&fe.includes($e.motivo_id);return Be||wt}));const Re=Ce.filter($e=>$e.resultado==="PENDENTE VALIDAO"||$e.resultado==="VALIDADA"||$e.resultado==="TRATATIVA DE ANULAO"),Pe=Re.map($e=>$e.cnpj_destinatario).filter($e=>$e&&$e.trim()!=="");let Ye=new Map;if(Pe.length>0){const{data:$e}=await Tt.from("clientes").select("cnpj_cpf, nome, vendedor, rede, uf, municipio").in("cnpj_cpf",Pe);$e&&$e.forEach(Be=>{Ye.set(Be.cnpj_cpf,Be)})}const at=Re.map($e=>$e.id);let tt=new Map;if(at.length>0){const{data:$e}=await Tt.from("logs_validacao").select(`
              devolucao_id,
              status_novo,
              usuario_id
            `).in("devolucao_id",at).order("created_at",{ascending:!1});if($e){const Be=[...new Set($e.map(et=>et.usuario_id).filter(Boolean))],wt=new Map;if(Be.length>0){const{data:et}=await Tt.from("profiles").select("id, name").in("id",Be);et&&et.forEach(dt=>{wt.set(dt.id,dt.name)})}$e.forEach(et=>{const dt=`${et.devolucao_id}_${et.status_novo}`;if(!tt.has(dt)){const we=wt.get(et.usuario_id);we&&tt.set(dt,we)}})}}const rt=Re.map($e=>{var lt,Ct,$t;const Be=Ye.get($e.cnpj_destinatario),wt=(lt=$e.itens)==null?void 0:lt.map(ke=>{var De;return ke.id||console.warn("Item sem ID:",ke),{...ke,id:ke.id,motivo_id:ke.motivo_id||null,motivo_nome:((De=ke.motivo_item)==null?void 0:De.nome)||"-"}}),et=$e.resultado||"PENDENTE VALIDAO";let dt="-";if(et!=="PENDENTE VALIDAO"){const ke=`${$e.id}_${et}`;dt=tt.get(ke)||"-"}let we=null;if($e.data_emissao)try{const ke=new Date,De=-3*60,bt=ke.getTime()+ke.getTimezoneOffset()*6e4,xt=new Date(bt+De*6e4);xt.setHours(0,0,0,0);const Ae=new Date($e.data_emissao);Ae.setHours(0,0,0,0),we=sN(Ae,xt)}catch(ke){console.warn("Erro ao calcular dias:",ke),we=$e.dias}let Ne=$e.prazo;if(et==="LANADA"||et==="ANULADA/CANCELADA")Ne="FINALIZADO";else if(et==="TRATATIVA DE ANULAO")Ne="TRATANDO";else if(et==="VALIDADA")Ne="CONCLUIDO";else if(et==="PENDENTE VALIDAO"){const ke=we!==null?we:$e.dias;ke!=null&&(ke>=3?Ne="EM ATRASO":Ne="NO PRAZO")}return{...$e,setor:(Ct=$e.setores)==null?void 0:Ct.nome,motivo:typeof $e.motivos_devolucao=="object"&&(($t=$e.motivos_devolucao)!=null&&$t.nome)?$e.motivos_devolucao.nome:typeof $e.motivos_devolucao=="string"?$e.motivos_devolucao:"-",motivo_id:$e.motivo_id,resultado:et,itens:wt,nome_validador:dt,prazo:Ne,dias:we!==null?we:$e.dias,nome_cliente:(Be==null?void 0:Be.nome)||$e.nome_cliente||"Cliente no encontrado",vendedor:(Be==null?void 0:Be.vendedor)||$e.vendedor||"-",rede:(Be==null?void 0:Be.rede)||$e.rede||"-",uf_destino:(Be==null?void 0:Be.uf)||$e.uf_destino||"-",cidade_destino:(Be==null?void 0:Be.municipio)||$e.cidade_destino||"-"}}).sort(($e,Be)=>{const wt=Dl[$e.resultado]||999,et=Dl[Be.resultado]||999;if(wt!==et)return wt-et;const dt=$e.data_emissao?new Date($e.data_emissao).getTime():0;return(Be.data_emissao?new Date(Be.data_emissao).getTime():0)-dt});n(rt);const ct=rt.filter($e=>$e.resultado==="PENDENTE VALIDAO").length,Oe=rt.filter($e=>$e.resultado==="PENDENTE VALIDAO").reduce(($e,Be)=>$e+(Number(Be.valor_total_nota)||0),0),pt=rt.filter($e=>$e.resultado==="VALIDADA").length,Je=rt.filter($e=>$e.resultado==="VALIDADA").reduce(($e,Be)=>$e+(Number(Be.valor_total_nota)||0),0),ot=rt.filter($e=>$e.resultado==="TRATATIVA DE ANULAO").length,ut=rt.filter($e=>$e.resultado==="TRATATIVA DE ANULAO").reduce(($e,Be)=>$e+(Number(Be.valor_total_nota)||0),0),_t=rt.filter($e=>$e.prazo==="EM ATRASO").length,vt=rt.filter($e=>$e.prazo==="EM ATRASO").reduce(($e,Be)=>$e+(Number(Be.valor_total_nota)||0),0);D({nfPendentes:ct,totalPendente:Oe,nfValidadas:pt,totalValidadas:Je,nfCancelamento:ot,totalCancelamento:ut,nfAtraso:_t,totalAtraso:vt});const ht={};rt.forEach($e=>{ht[$e.id]=$e.justificativa||""}),i(ht)}o(!1)};ye.useEffect(()=>{if(e.length===0)return;let te=[...e];v&&g?te=[...e].sort((ne,de)=>{let fe,Se;switch(v){case"data_emissao":fe=ne.data_emissao?new Date(ne.data_emissao).getTime():0,Se=de.data_emissao?new Date(de.data_emissao).getTime():0;break;case"numero":const _e=parseInt(ne.numero||"0",10)||0,Ce=parseInt(de.numero||"0",10)||0;_e!==0||Ce!==0?(fe=_e,Se=Ce):(fe=(ne.numero||"").toLowerCase(),Se=(de.numero||"").toLowerCase());break;case"nome_cliente":fe=(ne.nome_cliente||"").toLowerCase(),Se=(de.nome_cliente||"").toLowerCase();break;case"vendedor":fe=(ne.vendedor||"").toLowerCase(),Se=(de.vendedor||"").toLowerCase();break;case"motivo":fe=(ne.motivo||"").toLowerCase(),Se=(de.motivo||"").toLowerCase();break;case"valor_total_nota":fe=parseFloat(ne.valor_total_nota||0),Se=parseFloat(de.valor_total_nota||0);break;case"dias":fe=ne.dias!==null&&ne.dias!==void 0?ne.dias:-1,Se=de.dias!==null&&de.dias!==void 0?de.dias:-1;break;case"prazo":fe=(ne.prazo||"").toLowerCase(),Se=(de.prazo||"").toLowerCase();break;case"resultado":fe=Dl[ne.resultado]||999,Se=Dl[de.resultado]||999;break;default:return 0}return fe<Se?g==="asc"?-1:1:fe>Se?g==="asc"?1:-1:0}):te=[...e].sort((ne,de)=>{const fe=Dl[ne.resultado]||999,Se=Dl[de.resultado]||999;if(fe!==Se)return fe-Se;const _e=ne.data_emissao?new Date(ne.data_emissao).getTime():0;return(de.data_emissao?new Date(de.data_emissao).getTime():0)-_e});const he=(f-1)*w,le=he+w;r(te.slice(he,le))},[v,g,e,f]);const S=te=>{v===te?g==="asc"?x("desc"):g==="desc"&&(b(null),x(null)):(b(te),x("asc")),h(1)},j=({field:te})=>v!==te?k.jsx(My,{className:"ml-1 h-4 w-4 opacity-50"}):g==="asc"?k.jsx(Ry,{className:"ml-1 h-4 w-4"}):k.jsx(Dy,{className:"ml-1 h-4 w-4"}),B=async(te,he)=>{if(!M)return;const le=he;if(!J2.includes(le)){console.error("Resultado invlido:",he),St.error("Resultado invlido");return}try{if(le==="LANADA"){const{data:at,error:tt}=await Tt.from("devolucoes").select(`
              *,
              itens:itens_devolucao(id, motivo_id)
            `).eq("id",te).single();if(tt)throw console.error("Erro ao buscar devoluo:",tt),tt;if(!at.motivo_id){St.error("No  possvel lanar a nota sem o motivo principal preenchido.");return}if(at.itens&&at.itens.length>0){const it=at.itens.filter(rt=>!rt.motivo_id);if(it.length>0){St.error(`No  possvel lanar a nota. ${it.length} item(ns) ainda no possui(m) motivo preenchido.`);return}}}const{data:ne,error:de}=await Tt.from("devolucoes").select("resultado").eq("id",te).single();if(de)throw console.error("Erro ao buscar resultado atual:",de),de;const fe=(ne==null?void 0:ne.resultado)||"PENDENTE VALIDAO";if(fe===le)return;let Se=null;le==="LANADA"||le==="ANULADA/CANCELADA"?Se="FINALIZADO":le==="TRATATIVA DE ANULAO"?Se="TRATANDO":le==="VALIDADA"?Se="CONCLUIDO":le==="PENDENTE VALIDAO"&&(Se=null);const _e={resultado:le};Se&&(_e.prazo=Se);const Ce=M.name||M.email||"-";(le==="VALIDADA"||le==="TRATATIVA DE ANULAO")&&(_e.nome_validador=Ce),(le==="LANADA"||le==="ANULADA/CANCELADA")&&(_e.finalizada_por=Ce,_e.data_finalizacao=new Date().toISOString());const{error:Re}=await Tt.from("devolucoes").update(_e).eq("id",te);if(Re)throw Re;const{error:Pe}=await Tt.from("logs_validacao").insert({devolucao_id:te,usuario_id:M.id,acao:"ALTERAR_RESULTADO",status_anterior:fe,status_novo:le});Pe&&console.error("Erro ao salvar log:",Pe),St.success(`Resultado alterado para: ${le}`);let Ye=null;if(le==="LANADA"||le==="ANULADA/CANCELADA"?Ye="FINALIZADO":le==="TRATATIVA DE ANULAO"?Ye="TRATANDO":le==="VALIDADA"&&(Ye="CONCLUIDO"),le==="LANADA"||le==="ANULADA/CANCELADA")r(at=>at.filter(tt=>tt.id!==te)),n(at=>at.filter(tt=>tt.id!==te));else{const at=tt=>tt.id===te?{...tt,resultado:le,nome_validador:le!=="PENDENTE VALIDAO"&&(M.name||M.email)||"-",prazo:Ye||tt.prazo}:tt;r(tt=>tt.map(at)),n(tt=>tt.map(at))}}catch(ne){St.error("Erro ao processar: "+ne.message)}},R=async(te,he)=>{if(M)try{const{data:le}=await Tt.from("devolucoes").select("resultado").eq("id",te).single(),ne=(le==null?void 0:le.resultado)||"PENDENTE VALIDAO",{data:de}=await Tt.from("itens_devolucao").select("id").eq("devolucao_id",te);if(de&&de.length>0)for(const Ce of de){const{error:Re}=await Tt.from("itens_devolucao").update({motivo_id:he}).eq("id",Ce.id);if(Re)throw console.error("Erro ao atualizar item:",Re),Re}const{error:fe}=await Tt.from("devolucoes").update({motivo_id:he,resultado:"VALIDADA",prazo:"CONCLUIDO",nome_validador:M.name||M.email||"-"}).eq("id",te);if(fe)throw fe;const{error:Se}=await Tt.from("logs_validacao").insert({devolucao_id:te,usuario_id:M.id,acao:"SELECIONAR_MOTIVO",status_anterior:ne,status_novo:"VALIDADA"});Se&&console.error("Erro ao salvar log:",Se),St.success("Motivo aplicado a todos os produtos e resultado alterado para VALIDADA!");const _e=Ce=>{var Re,Pe;return Ce.id===te?{...Ce,motivo_id:he,resultado:"VALIDADA",nome_validador:M.name||M.email||"-",prazo:"CONCLUIDO",motivo:((Re=s.find(Ye=>Ye.id===he))==null?void 0:Re.nome)||Ce.motivo,itens:(Pe=Ce.itens)==null?void 0:Pe.map(Ye=>({...Ye,motivo_id:he}))}:Ce};r(Ce=>Ce.map(_e)),n(Ce=>Ce.map(_e))}catch(le){St.error("Erro ao processar: "+le.message)}},X=(te,he)=>{i(le=>({...le,[te]:he}))},Y=te=>aB(te)>100?(St.warning("Mximo de 100 palavras permitido"),!1):!0,ee=async te=>{if(M&&Y(c[te]||"")){p(he=>({...he,[te]:!0}));try{const{error:he}=await Tt.from("devolucoes").update({justificativa:c[te]||null}).eq("id",te);if(he)throw he;St.success("Comentrio salvo com sucesso!"),await Tt.from("logs_validacao").insert({devolucao_id:te,usuario_id:M.id,acao:"ADICIONAR_COMENTARIO",status_anterior:null,status_novo:null})}catch(he){St.error("Erro ao salvar comentrio: "+he.message)}finally{p(he=>({...he,[te]:!1}))}}},U=async(te,he,le)=>{var fe;if(!M){console.error("Usurio no autenticado");return}if(!he||he.trim()===""){console.log("Motivo vazio, ignorando...");return}if(!te||!le){console.error("IDs invlidos:",{itemId:te,devolucaoId:le,tipoItemId:typeof te,tipoDevolucaoId:typeof le}),St.error("Erro: IDs invlidos. Verifique o console para mais detalhes.");return}const ne=String(te).trim(),de=String(le).trim();if(!ne||ne==="undefined"||ne==="null"){console.error("itemId invlido aps converso:",{itemId:te,itemIdString:ne}),St.error("Erro: ID do produto invlido");return}try{const Se=M.name||M.email||"-";console.log("Salvando motivo:",{itemId:ne,motivoId:he,devolucaoId:de});const{data:_e,error:Ce}=await Tt.from("itens_devolucao").select("id, motivo_id, devolucao_id").eq("id",ne).single();if(Ce)throw console.error("Erro ao verificar item:",Ce),St.error("Erro: Item no encontrado no banco de dados. Verifique o console."),Ce;if(!_e){console.error("Item no encontrado:",ne),St.error("Erro: Item no encontrado");return}if(console.log("Item encontrado:",_e),_e.devolucao_id!==de){console.error("Item no pertence  devoluo:",{itemDevolucaoId:_e.devolucao_id,devolucaoIdEsperado:de}),St.error("Erro: Item no pertence  devoluo correta");return}console.log("Tentando atualizar item:",{itemIdString:ne,motivoId:he});const{data:Re,error:Pe}=await Tt.from("itens_devolucao").update({motivo_id:he}).eq("id",ne).select("id, motivo_id");if(console.log("Resultado do update:",{updatedItem:Re,error:Pe}),Pe)throw console.error("Erro ao salvar motivo no Supabase:",Pe),St.error("Erro ao salvar motivo: "+Pe.message),Pe;Re&&Re.length>0&&Re[0].motivo_id===he?console.log(" Motivo salvo com sucesso! Item atualizado:",Re[0]):console.warn(" Update pode no ter funcionado completamente, verificando..."),await new Promise(ht=>setTimeout(ht,500));let Ye=null,at=0;const tt=5;for(;at<tt;){const{data:ht,error:$e}=await Tt.from("itens_devolucao").select("id, motivo_id, devolucao_id").eq("id",ne).single();if($e){if(console.error(`Erro ao verificar item (tentativa ${at+1}):`,$e),at===tt-1){console.warn("No foi possvel verificar o item aps todas as tentativas");break}}else if(ht&&(Ye=ht,console.log(`Item verificado (tentativa ${at+1}):`,Ye),Ye.motivo_id===he)){console.log(" Motivo confirmado no banco de dados!");break}at<tt-1&&await new Promise(Be=>setTimeout(Be,300)),at++}if(!Ye||Ye.motivo_id!==he){console.error(" Update no funcionou aps todas as tentativas!",{esperado:he,atual:(Ye==null?void 0:Ye.motivo_id)||"null",itemVerificado:Ye}),St.error("Erro: No foi possvel salvar o motivo. Pode ser um problema de permisses no banco de dados.");return}const it=ht=>{var Be;return{itensAtualizados:(Be=ht.itens)==null?void 0:Be.map(wt=>String(wt.id)===ne?{...wt,motivo_id:he}:wt)}};r(ht=>ht.map($e=>{if(String($e.id)!==de)return $e;const Be=it($e);return{...$e,itens:Be.itensAtualizados}})),n(ht=>ht.map($e=>{if(String($e.id)!==de)return $e;const Be=it($e);return{...$e,itens:Be.itensAtualizados}})),await new Promise(ht=>setTimeout(ht,500));let rt=null,ct=null,Oe=0;const pt=5;for(;Oe<pt;){const{data:ht,error:$e}=await Tt.from("devolucoes").select(`
            itens:itens_devolucao(id, motivo_id)
          `).eq("id",de).single();if($e){console.error(`Erro ao buscar devoluo (tentativa ${Oe+1}):`,$e);const{data:Be,error:wt}=await Tt.from("itens_devolucao").select("id, motivo_id").eq("devolucao_id",de);rt=Be,ct=wt}else ht&&ht.itens&&(rt=ht.itens,ct=null);if(ct){if(console.error(`Erro ao buscar itens (tentativa ${Oe+1}):`,ct),Oe===pt-1)break}else if(rt){const Be=rt.find(wt=>String(wt.id)===ne);if(console.log(`Tentativa ${Oe+1} - Item encontrado:`,Be),Be&&Be.motivo_id===he){console.log(` Item confirmado com motivo na tentativa ${Oe+1}`);break}else Be&&console.log(`Item ainda no tem o motivo correto. Esperado: ${he}, Atual: ${Be.motivo_id}`)}Oe<pt-1&&(console.log(`Aguardando e tentando novamente... (tentativa ${Oe+1}/${pt})`),await new Promise(Be=>setTimeout(Be,400))),Oe++}if(ct)throw console.error("Erro ao buscar itens aps todas as tentativas:",ct),ct;if(!rt){console.error("No foi possvel buscar os itens"),St.error("Erro: No foi possvel buscar os itens da devoluo");return}console.log("Itens encontrados:",rt);const ot=rt&&rt.length>0&&rt.every(ht=>{const $e=!!ht.motivo_id&&ht.motivo_id!==null&&ht.motivo_id!=="";return console.log("Item:",ht.id,"tem motivo?",$e,"motivo_id:",ht.motivo_id),$e});console.log("Todos tm motivo?",ot,"Total de itens:",rt.length,"Itens com motivos:",rt.filter(ht=>!!ht.motivo_id).length);const ut={};let _t=null,vt=0;if(rt&&rt.forEach(ht=>{if(!ht.motivo_id||ht.motivo_id===null||ht.motivo_id==="")return;const $e=String(ht.motivo_id),Be=(ut[$e]||0)+1;ut[$e]=Be,Be>vt&&(vt=Be,_t=$e)}),console.log("Motivo mais repetido:",_t,"Contagem:",ut),ot){const ht=_t||(rt&&rt.length>0&&((fe=rt[0])!=null&&fe.motivo_id)?String(rt[0].motivo_id):null);if(!ht){console.error("Erro: Todos tm motivos mas no foi possvel determinar o motivo principal"),St.error("Erro ao validar: no foi possvel determinar o motivo principal");return}console.log("Validando nota...",{motivoParaSalvar:ht});const{data:$e,error:Be}=await Tt.from("devolucoes").select("resultado, motivo_id").eq("id",de).single();if(Be)throw console.error("Erro ao buscar devoluo:",Be),Be;const wt=s.find(Ne=>Ne.id===ht),et=(wt==null?void 0:wt.nome)||"",dt={resultado:"VALIDADA",prazo:"CONCLUIDO",nome_validador:Se,motivo_id:ht};console.log("Atualizando devoluo com:",dt);const{error:we}=await Tt.from("devolucoes").update(dt).eq("id",de);if(we)throw console.error("Erro ao atualizar devoluo:",we),we;console.log("Devoluo atualizada com sucesso!"),await Tt.from("logs_validacao").insert({devolucao_id:de,usuario_id:M.id,acao:"SELECIONAR_MOTIVO_PRODUTO",status_anterior:($e==null?void 0:$e.resultado)||"PENDENTE VALIDAO",status_novo:"VALIDADA"}),r(Ne=>Ne.map(lt=>String(lt.id)!==de?lt:{...lt,resultado:"VALIDADA",prazo:"CONCLUIDO",nome_validador:Se,motivo_id:ht,motivo:et||lt.motivo})),n(Ne=>Ne.map(lt=>String(lt.id)!==de?lt:{...lt,resultado:"VALIDADA",prazo:"CONCLUIDO",nome_validador:Se,motivo_id:ht,motivo:et||lt.motivo})),St.success("Motivo salvo! Todos os produtos tm motivos. Resultado alterado para VALIDADA!")}else{const ht=(rt==null?void 0:rt.filter(Be=>!!Be.motivo_id).length)||0,$e=(rt==null?void 0:rt.length)||0;St.success(`Motivo salvo para o produto! (${ht}/${$e} produtos com motivos)`)}}catch(Se){console.error("Erro completo:",Se),St.error("Erro ao atualizar motivo: "+Se.message)}},Q=async()=>{if(!(!L||!M))try{const{error:te}=await Tt.from("itens_devolucao").delete().eq("devolucao_id",L);if(te)throw te;const{error:he}=await Tt.from("devolucoes").delete().eq("id",L);if(he)throw he;St.success("Registro excludo com sucesso!"),H(null),A(),E(new Set)}catch(te){St.error("Erro ao excluir registro: "+te.message)}},P=async()=>{if(y.size===0){St.warning("Selecione pelo menos um registro para excluir");return}if(!V){q(!0);return}try{const te=Array.from(y);for(const le of te)await Tt.from("itens_devolucao").delete().eq("devolucao_id",le);const{error:he}=await Tt.from("devolucoes").delete().in("id",te);if(he)throw he;St.success(`${te.length} registro(s) excludo(s) com sucesso!`),q(!1),A(),E(new Set),z(!1)}catch(te){St.error("Erro ao excluir registros: "+te.message),q(!1)}},F=te=>{I(te)},Z=async()=>{if(!(!N||!M))try{const{error:te}=await Tt.from("devolucoes").update({numero:N.numero,nome_cliente:N.nome_cliente,vendedor:N.vendedor,cidade_origem:N.cidade_origem,uf_origem:N.uf_origem,data_emissao:N.data_emissao,valor_total_nota:N.valor_total_nota,peso_liquido:N.peso_liquido,motivo_id:N.motivo_id,setor_id:N.setor_id,resultado:N.resultado,justificativa:N.justificativa,updated_at:new Date().toISOString()}).eq("id",N.id);if(te)throw te;St.success("Registro atualizado com sucesso!"),I(null),A()}catch(te){St.error("Erro ao atualizar registro: "+te.message)}},se=te=>{var de;const he=((de=te.itens)==null?void 0:de.map((fe,Se)=>`${Se+1}. ${fe.descricao||"-"}
   Quantidade: ${fe.quantidade||"-"} ${fe.unidade||""}
   Valor Unitrio: R$ ${(Number(fe.valor_unitario)||0).toFixed(2)}
   Valor Total: R$ ${(Number(fe.valor_total_bruto)||0).toFixed(2)}`).join(`

`))||"Nenhum produto cadastrado",le=` *Devoluo - Nota Fiscal ${te.numero||"-"}*

*Cliente:* ${te.nome_cliente||"-"}
*Vendedor:* ${te.vendedor||"-"}
*Data de Emisso:* ${te.data_emissao?Jt(new Date(te.data_emissao),"dd/MM/yyyy",{locale:jr}):"-"}
*Origem:* ${te.cidade_origem||"-"}/${te.uf_origem||"-"}

*Valor Total:* R$ ${(Number(te.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}
*Peso Lquido:* ${te.peso_liquido||"-"} kg
*Dias:* ${te.dias!==null&&te.dias!==void 0?te.dias:"-"}
*Prazo:* ${te.prazo||"-"}
*Resultado:* ${te.resultado||"-"}
*Motivo:* ${te.motivo||"-"}
*Setor:* ${te.setor||"-"}

*Produtos:*
${he}

${te.justificativa?`*Comentrio:*
${te.justificativa}`:""}`,ne=`https://wa.me/?text=${encodeURIComponent(le)}`;window.open(ne,"_blank")},re=te=>{const he=new Set(y);he.has(te)?he.delete(te):he.add(te),E(he)},ae=()=>{y.size===t.length?E(new Set):E(new Set(t.map(te=>te.id)))};return k.jsxs("div",{className:"space-y-6",children:[k.jsx(Qi,{title:"Validao",description:"Valide e gerencie devolues pendentes. Selecione motivos, altere resultados e adicione comentrios para cada devoluo."}),k.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[k.jsx(Xf,{}),k.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full md:w-auto shrink-0",children:[K&&y.size>0&&k.jsxs(Nt,{variant:"destructive",onClick:()=>q(!0),className:"w-full sm:w-auto",disabled:y.size===0,children:[k.jsx(Pa,{className:"mr-2 h-4 w-4"}),"Excluir (",y.size,")"]}),k.jsx(Nt,{variant:K?"default":"outline",onClick:()=>{z(!K),E(new Set)},className:"w-full sm:w-auto",children:K?k.jsxs(k.Fragment,{children:[k.jsx(Vf,{className:"mr-2 h-4 w-4"}),"Cancelar Seleo"]}):k.jsxs(k.Fragment,{children:[k.jsx(_f,{className:"mr-2 h-4 w-4"}),"Selecionar"]})})]})]}),k.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[k.jsxs(Dt,{children:[k.jsx(Rt,{className:"pb-2",children:k.jsx(Ft,{className:"text-sm font-medium",children:"NF Pendentes"})}),k.jsx(Mt,{children:k.jsx("div",{className:"text-2xl font-bold",children:W.nfPendentes})})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{className:"pb-2",children:k.jsx(Ft,{className:"text-sm font-medium",children:"Total Pendente"})}),k.jsx(Mt,{children:k.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",W.totalPendente.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{className:"pb-2",children:k.jsx(Ft,{className:"text-sm font-medium",children:"NF Validadas"})}),k.jsx(Mt,{children:k.jsx("div",{className:"text-2xl font-bold text-blue-600",children:W.nfValidadas})})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{className:"pb-2",children:k.jsx(Ft,{className:"text-sm font-medium",children:"Total Validadas"})}),k.jsx(Mt,{children:k.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["R$ ",W.totalValidadas.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{className:"pb-2",children:k.jsx(Ft,{className:"text-sm font-medium",children:"NF em Cancelamento"})}),k.jsx(Mt,{children:k.jsx("div",{className:"text-2xl font-bold",children:W.nfCancelamento})})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{className:"pb-2",children:k.jsx(Ft,{className:"text-sm font-medium",children:"Total Cancelamento"})}),k.jsx(Mt,{children:k.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",W.totalCancelamento.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{className:"pb-2",children:k.jsx(Ft,{className:"text-sm font-medium",children:"NF em Atraso"})}),k.jsx(Mt,{children:k.jsx("div",{className:"text-2xl font-bold text-red-600",children:W.nfAtraso})})]}),k.jsxs(Dt,{children:[k.jsx(Rt,{className:"pb-2",children:k.jsx(Ft,{className:"text-sm font-medium",children:"Total em Atraso"})}),k.jsx(Mt,{children:k.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["R$ ",W.totalAtraso.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]})]}),k.jsx("div",{className:"rounded-md border bg-card min-h-[400px]",children:a?k.jsx("div",{className:"flex items-center justify-center h-full py-20",children:k.jsx(oi,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):t.length===0?k.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-20 text-muted-foreground",children:[k.jsx(Iy,{className:"h-10 w-10 mb-2"}),k.jsx("p",{children:"Nenhuma devoluo encontrada."})]}):k.jsxs("div",{children:[e.length>w&&k.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[k.jsxs("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",(f-1)*w+1," a ",Math.min(f*w,e.length)," de ",e.length," registros"]}),k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsxs(Nt,{variant:"outline",size:"sm",onClick:()=>h(te=>Math.max(1,te-1)),disabled:f===1,children:[k.jsx(yu,{className:"h-4 w-4 mr-1"}),"Anterior"]}),k.jsxs("div",{className:"text-sm text-muted-foreground",children:["Pgina ",f," de ",Math.ceil(e.length/w)]}),k.jsxs(Nt,{variant:"outline",size:"sm",onClick:()=>h(te=>Math.min(Math.ceil(e.length/w),te+1)),disabled:f>=Math.ceil(e.length/w),children:["Prxima",k.jsx(wu,{className:"h-4 w-4 ml-1"})]})]})]}),k.jsx("div",{className:"overflow-x-auto border rounded-lg",children:k.jsxs(Ua,{children:[k.jsx(os,{className:"bg-muted/50",children:k.jsxs(Nr,{children:[K&&k.jsx(jt,{className:"w-[50px] sticky left-0 bg-muted/50 z-10",children:k.jsx("button",{onClick:ae,className:"p-1 hover:bg-muted rounded",children:y.size===t.length&&t.length>0?k.jsx(_f,{className:"h-4 w-4"}):k.jsx(sx,{className:"h-4 w-4"})})}),k.jsx(jt,{className:"w-[50px] sticky left-0 bg-muted/50 z-10"}),k.jsx(jt,{className:"min-w-[100px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>S("data_emissao"),children:k.jsxs("div",{className:"flex items-center gap-1",children:["Data Emisso",k.jsx(j,{field:"data_emissao"})]})}),k.jsx(jt,{className:"min-w-[120px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>S("numero"),children:k.jsxs("div",{className:"flex items-center gap-1",children:["Nota Fiscal",k.jsx(j,{field:"numero"})]})}),k.jsx(jt,{className:"min-w-[200px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>S("nome_cliente"),children:k.jsxs("div",{className:"flex items-center gap-1",children:["Cliente",k.jsx(j,{field:"nome_cliente"})]})}),k.jsx(jt,{className:"min-w-[150px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>S("vendedor"),children:k.jsxs("div",{className:"flex items-center gap-1",children:["Vendedor",k.jsx(j,{field:"vendedor"})]})}),k.jsx(jt,{className:"min-w-[150px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>S("motivo"),children:k.jsxs("div",{className:"flex items-center gap-1",children:["Motivo",k.jsx(j,{field:"motivo"})]})}),k.jsx(jt,{className:"min-w-[100px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>S("valor_total_nota"),children:k.jsxs("div",{className:"flex items-center gap-1",children:["Valor Total",k.jsx(j,{field:"valor_total_nota"})]})}),k.jsx(jt,{className:"min-w-[60px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>S("dias"),children:k.jsxs("div",{className:"flex items-center gap-1",children:["Dias",k.jsx(j,{field:"dias"})]})}),k.jsx(jt,{className:"min-w-[100px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>S("prazo"),children:k.jsxs("div",{className:"flex items-center gap-1",children:["Prazo",k.jsx(j,{field:"prazo"})]})}),k.jsx(jt,{className:"min-w-[120px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>S("resultado"),children:k.jsxs("div",{className:"flex items-center gap-1",children:["Resultado",k.jsx(j,{field:"resultado"})]})}),k.jsx(jt,{className:"min-w-[150px] text-xs font-semibold px-3 py-3",children:"Validado Por"}),k.jsx(jt,{className:"min-w-[200px] text-xs font-semibold px-3 py-3",children:"Comentrio"}),k.jsx(jt,{className:"min-w-[120px] text-xs font-semibold px-3 py-3",children:"Aes"})]})}),k.jsx(za,{children:t.map(te=>{const he=te.resultado||"PENDENTE VALIDAO";return k.jsx(Nr,{className:"group hover:bg-muted/30",children:k.jsx(Kt,{colSpan:K?15:14,className:"p-0",children:k.jsx(s_,{type:"single",collapsible:!0,className:"w-full",children:k.jsxs(Lm,{value:te.id,className:"border-0",children:[k.jsxs("div",{className:"flex items-center w-full py-3 px-3 hover:bg-muted/50 transition-colors",children:[K&&k.jsx("button",{onClick:()=>re(te.id),className:"w-[50px] flex items-center justify-center flex-shrink-0",children:y.has(te.id)?k.jsx(_f,{className:"h-4 w-4 text-primary"}):k.jsx(sx,{className:"h-4 w-4"})}),k.jsxs("div",{className:"flex items-center gap-3 w-full text-xs",children:[k.jsx(Bm,{className:"w-[50px] py-0 pr-2 hover:no-underline flex-shrink-0"}),k.jsx("div",{className:"min-w-[100px] text-xs",children:te.data_emissao?Jt(new Date(te.data_emissao),"dd/MM/yyyy",{locale:jr}):"-"}),k.jsx("div",{className:"min-w-[120px] font-medium text-xs",children:te.numero}),k.jsx("div",{className:"min-w-[200px] truncate text-xs",title:te.nome_cliente,children:te.nome_cliente}),k.jsx("div",{className:"min-w-[150px] truncate text-xs",title:te.vendedor,children:te.vendedor}),k.jsx("div",{className:"w-40",style:{position:"relative",zIndex:1e4},onMouseDown:le=>{le.stopPropagation(),le.preventDefault()},onPointerDown:le=>{le.stopPropagation(),le.preventDefault()},onClick:le=>{le.stopPropagation()},children:k.jsxs("select",{value:te.motivo_id||"",onChange:le=>{le.stopPropagation(),R(te.id,le.target.value)},onMouseDown:le=>{le.stopPropagation()},onPointerDown:le=>{le.stopPropagation()},onClick:le=>{le.stopPropagation()},onFocus:le=>{le.stopPropagation()},onKeyDown:le=>{le.stopPropagation()},className:"h-7 w-full px-2 text-[10px] border rounded-md bg-background cursor-pointer",style:{position:"relative",zIndex:10001},children:[k.jsxs("option",{value:"",children:["Selecione... (",s.length," motivos)"]}),s&&s.length>0?s.map(le=>{var de;const ne=((de=le.setores)==null?void 0:de.nome)||"";return k.jsxs("option",{value:le.id,children:[le.nome," ",ne?`(${ne})`:""]},le.id)}):k.jsx("option",{value:"",disabled:!0,children:"Carregando motivos..."})]})}),k.jsx("div",{className:"w-24 text-[9px] text-muted-foreground",children:te.motivo_id&&(()=>{var de;const le=s.find(fe=>fe.id===te.motivo_id),ne=le?(de=le.setores)==null?void 0:de.nome:null;return ne?`Setor: ${ne}`:""})()}),k.jsxs("div",{className:"w-20 font-bold",children:["R$ ",Number(te.valor_total_nota||0).toFixed(2)]}),k.jsx("div",{className:"w-12 text-center",children:te.dias!==null&&te.dias!==void 0?te.dias:"-"}),k.jsx("div",{className:"w-20",children:k.jsx("span",{className:`text-[9px] px-1 py-0.5 rounded ${te.prazo==="EM ATRASO"?"bg-red-500 text-white":te.prazo==="NO PRAZO"?"bg-green-500 text-white":te.prazo==="FINALIZADO"?"bg-green-200 text-green-800 dark:bg-green-900 dark:text-green-200":te.prazo==="TRATANDO"?"bg-purple-200 text-purple-800 dark:bg-purple-900 dark:text-purple-200":te.prazo==="CONCLUIDO"?"bg-blue-200 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-gray-500 text-white"}`,children:te.prazo||"-"})}),k.jsx("div",{className:"w-32",children:k.jsxs(La,{value:he,onValueChange:le=>{B(te.id,le)},children:[k.jsx(ga,{className:`h-6 w-full text-[8px] px-1 py-0.5 ${Q2[he]} border-0 cursor-pointer hover:opacity-90`,onClick:le=>le.stopPropagation(),onMouseDown:le=>le.stopPropagation(),children:k.jsx(Ba,{className:"text-white",children:he})}),k.jsx(va,{onClick:le=>le.stopPropagation(),onMouseDown:le=>le.stopPropagation(),className:"z-[10000]",children:J2.map(le=>k.jsx(sr,{value:le,className:`${Q2[le]} text-white cursor-pointer hover:opacity-90`,children:le},le))})]})}),k.jsx("div",{className:"w-28 truncate text-[9px]",title:te.nome_validador||"-",children:te.nome_validador||"-"}),k.jsxs("div",{className:"w-48 flex gap-1",children:[k.jsx(cm,{className:`h-7 text-[9px] min-h-[28px] max-h-[28px] resize-none flex-1 ${c[te.id]||te.justificativa?"bg-red-100/50 dark:bg-red-900/20 border-red-300 dark:border-red-700":""}`,placeholder:"Comentrio...",value:c[te.id]||"",onChange:le=>X(te.id,le.target.value),onClick:le=>le.stopPropagation(),maxLength:500}),k.jsx(Nt,{size:"sm",variant:"outline",className:"h-7 px-1",onClick:le=>{le.stopPropagation(),ee(te.id)},disabled:u[te.id],children:k.jsx(ik,{className:"h-3 w-3"})})]}),k.jsxs("div",{className:"w-28 flex gap-1",children:[k.jsx(Nt,{size:"sm",variant:"outline",className:"h-7 px-1",onClick:le=>{le.stopPropagation(),se(te)},title:"Compartilhar via WhatsApp",children:k.jsx(Fp,{className:"h-3 w-3"})}),((M==null?void 0:M.role)==="ADMIN"||(M==null?void 0:M.role)==="LOGISTICA")&&k.jsxs(k.Fragment,{children:[k.jsx(Nt,{size:"sm",variant:"outline",className:"h-7 px-1",onClick:le=>{le.stopPropagation(),F(te)},title:"Editar",children:k.jsx(ax,{className:"h-3 w-3"})}),k.jsx(Nt,{size:"sm",variant:"destructive",className:"h-7 px-1",onClick:le=>{le.stopPropagation(),H(te.id)},title:"Excluir",children:k.jsx(Pa,{className:"h-3 w-3"})})]})]})]})]}),k.jsx(Um,{children:k.jsx("div",{className:"px-4 pb-4",children:k.jsxs("div",{className:"rounded-md border bg-muted/50 p-4",children:[k.jsx("div",{className:"mb-3 pb-2 border-b",children:k.jsxs("p",{className:"text-sm font-medium text-muted-foreground",children:[k.jsx("span",{className:"font-semibold",children:"Origem:"})," ",te.cidade_origem||"-","/",te.uf_origem||"-"]})}),k.jsx("h4",{className:"font-semibold mb-2 text-sm",children:"Itens da Devoluo"}),k.jsxs(Ua,{children:[k.jsx(os,{children:k.jsxs(Nr,{children:[k.jsx(jt,{className:"h-8 text-xs",children:"Nmero"}),k.jsx(jt,{className:"h-8 text-xs",children:"Descrio"}),k.jsx(jt,{className:"h-8 text-xs",children:"Unidade"}),k.jsx(jt,{className:"h-8 text-xs",children:"Quantidade"}),k.jsx(jt,{className:"h-8 text-xs",children:"Valor Unitrio"}),k.jsx(jt,{className:"h-8 text-xs",children:"Valor Total Bruto"}),k.jsx(jt,{className:"h-8 text-xs",children:"Motivo"})]})}),k.jsx(za,{children:te.itens&&te.itens.length>0?te.itens.map((le,ne)=>k.jsxs(Nr,{children:[k.jsx(Kt,{className:"text-xs",children:le.numero_item||"-"}),k.jsx(Kt,{className:"text-xs",children:le.descricao||"-"}),k.jsx(Kt,{className:"text-xs",children:le.unidade||"-"}),k.jsx(Kt,{className:"text-xs",children:le.quantidade||"-"}),k.jsxs(Kt,{className:"text-xs",children:["R$ ",Number(le.valor_unitario||0).toFixed(2)]}),k.jsxs(Kt,{className:"text-xs",children:["R$ ",Number(le.valor_total_bruto||0).toFixed(2)]}),k.jsxs(Kt,{className:"text-xs relative",style:{position:"relative",zIndex:9999},onMouseDown:de=>de.stopPropagation(),onPointerDown:de=>de.stopPropagation(),onClick:de=>de.stopPropagation(),children:[k.jsxs("select",{value:le.motivo_id||"",onChange:de=>{de.stopPropagation();const fe=de.target.value;console.log("Select onChange:",{motivoSelecionado:fe,prodId:le.id,itemId:te.id,produto:le}),fe&&le.id&&te.id?U(le.id,fe,te.id):(console.error("Valores invlidos:",{motivoSelecionado:fe,prodId:le.id,itemId:te.id}),St.error("Erro: Dados invlidos para salvar motivo"))},onMouseDown:de=>{de.stopPropagation()},onPointerDown:de=>{de.stopPropagation()},onClick:de=>{de.stopPropagation()},onFocus:de=>{de.stopPropagation()},className:"h-7 w-full px-2 text-xs border rounded-md bg-background cursor-pointer",style:{position:"relative",zIndex:9999},children:[k.jsx("option",{value:"",children:"Selecione..."}),s&&s.length>0?s.map(de=>{var Se;const fe=((Se=de.setores)==null?void 0:Se.nome)||"";return k.jsxs("option",{value:de.id,children:[de.nome," ",fe?`(${fe})`:""]},de.id)}):k.jsx("option",{value:"",disabled:!0,children:"Carregando motivos..."})]}),le.motivo_id&&(()=>{var Se;const de=s.find(_e=>_e.id===le.motivo_id),fe=de?(Se=de.setores)==null?void 0:Se.nome:null;return fe?k.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Setor: ",fe]}):null})()]})]},ne)):k.jsx(Nr,{children:k.jsx(Kt,{colSpan:7,className:"text-center text-xs text-muted-foreground",children:"Nenhum item cadastrado"})})})]}),te.dados_adicionais&&k.jsx("div",{className:"mt-4 pt-4 border-t",children:k.jsx("p",{className:"text-[10px] font-bold italic text-muted-foreground whitespace-pre-wrap break-words",children:te.dados_adicionais})})]})})})]})})})},te.id)})})]})}),e.length>w&&k.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t",children:[k.jsxs("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",(f-1)*w+1," a ",Math.min(f*w,e.length)," de ",e.length," registros"]}),k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsxs(Nt,{variant:"outline",size:"sm",onClick:()=>h(te=>Math.max(1,te-1)),disabled:f===1,children:[k.jsx(yu,{className:"h-4 w-4 mr-1"}),"Anterior"]}),k.jsxs("div",{className:"text-sm text-muted-foreground",children:["Pgina ",f," de ",Math.ceil(e.length/w)]}),k.jsxs(Nt,{variant:"outline",size:"sm",onClick:()=>h(te=>Math.min(Math.ceil(e.length/w),te+1)),disabled:f>=Math.ceil(e.length/w),children:["Prxima",k.jsx(wu,{className:"h-4 w-4 ml-1"})]})]})]})]})}),k.jsx(ri,{open:!!L,onOpenChange:te=>!te&&H(null),children:k.jsxs(As,{className:"sm:max-w-[425px]",children:[k.jsxs(Cs,{children:[k.jsxs(Os,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[k.jsx(Pa,{className:"h-5 w-5"}),"Confirmar Excluso"]}),k.jsx(js,{className:"pt-2",children:"Tem certeza que deseja excluir este registro?"}),k.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mt-4",children:k.jsx("p",{className:"text-sm text-destructive font-medium",children:" Esta ao no pode ser desfeita."})})]}),k.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[k.jsx(Nt,{variant:"outline",onClick:()=>H(null),className:"flex-1 sm:flex-initial",children:"No"}),k.jsx(Nt,{variant:"destructive",onClick:Q,className:"flex-1 sm:flex-initial",children:"Sim, Excluir"})]})]})}),k.jsx(ri,{open:V,onOpenChange:te=>!te&&q(!1),children:k.jsxs(As,{className:"sm:max-w-[425px]",children:[k.jsxs(Cs,{children:[k.jsxs(Os,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[k.jsx(Pa,{className:"h-5 w-5"}),"Confirmar Excluso"]}),k.jsxs(js,{className:"pt-2",children:["Tem certeza que deseja excluir ",k.jsxs("span",{className:"font-semibold text-foreground",children:[y.size," registro(s)"]}),"?"]}),k.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mt-4",children:k.jsx("p",{className:"text-sm text-destructive font-medium",children:" Esta ao no pode ser desfeita."})})]}),k.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[k.jsx(Nt,{variant:"outline",onClick:()=>q(!1),className:"flex-1 sm:flex-initial",children:"No"}),k.jsx(Nt,{variant:"destructive",onClick:P,className:"flex-1 sm:flex-initial",children:"Sim, Excluir"})]})]})}),k.jsx(ri,{open:!!N,onOpenChange:te=>!te&&I(null),children:k.jsxs(As,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[k.jsxs(Cs,{children:[k.jsxs(Os,{className:"text-xl font-bold flex items-center gap-2",children:[k.jsx(ax,{className:"h-5 w-5 text-primary"}),"Editar Registro"]}),k.jsx(js,{className:"pt-2",children:"Alterar informaes da nota fiscal"})]}),N&&k.jsxs("div",{className:"space-y-4 py-4",children:[k.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"Nmero da Nota"}),k.jsx(wr,{value:N.numero||"",onChange:te=>I({...N,numero:te.target.value})})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"Cliente"}),k.jsx(wr,{value:N.nome_cliente||"",onChange:te=>I({...N,nome_cliente:te.target.value})})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"Vendedor"}),k.jsx(wr,{value:N.vendedor||"",onChange:te=>I({...N,vendedor:te.target.value})})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"Cidade Origem"}),k.jsx(wr,{value:N.cidade_origem||"",onChange:te=>I({...N,cidade_origem:te.target.value})})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"UF Origem"}),k.jsx(wr,{value:N.uf_origem||"",onChange:te=>I({...N,uf_origem:te.target.value})})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"Data de Emisso"}),k.jsx(wr,{type:"date",value:N.data_emissao?new Date(N.data_emissao).toISOString().split("T")[0]:"",onChange:te=>I({...N,data_emissao:te.target.value})})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"Valor Total"}),k.jsx(wr,{type:"number",step:"0.01",value:N.valor_total_nota||"",onChange:te=>I({...N,valor_total_nota:te.target.value})})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"Peso Lquido"}),k.jsx(wr,{type:"number",step:"0.01",value:N.peso_liquido||"",onChange:te=>I({...N,peso_liquido:te.target.value})})]})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"Motivo Principal"}),k.jsxs(La,{value:N.motivo_id||"",onValueChange:te=>I({...N,motivo_id:te}),children:[k.jsx(ga,{children:k.jsx(Ba,{placeholder:"Selecione um motivo"})}),k.jsx(va,{children:s.map(te=>k.jsx(sr,{value:te.id,children:te.nome},te.id))})]})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"Justificativa"}),k.jsx(cm,{value:N.justificativa||"",onChange:te=>I({...N,justificativa:te.target.value})})]})]}),k.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[k.jsx(Nt,{variant:"outline",onClick:()=>I(null),className:"flex-1 sm:flex-initial",children:"Cancelar"}),k.jsx(Nt,{onClick:Z,className:"flex-1 sm:flex-initial bg-primary hover:bg-primary/90",children:"Salvar Alteraes"})]})]})})]})}var Np="rovingFocusGroup.onEntryFocus",iB={bubbles:!1,cancelable:!0},Ju="RovingFocusGroup",[um,z4,oB]=Z5(Ju),[lB,$4]=Uf(Ju,[oB]),[cB,uB]=lB(Ju),V4=ye.forwardRef((t,r)=>k.jsx(um.Provider,{scope:t.__scopeRovingFocusGroup,children:k.jsx(um.Slot,{scope:t.__scopeRovingFocusGroup,children:k.jsx(dB,{...t,ref:r})})}));V4.displayName=Ju;var dB=ye.forwardRef((t,r)=>{const{__scopeRovingFocusGroup:e,orientation:n,loop:a=!1,dir:o,currentTabStopId:s,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:i,preventScrollOnEntryFocus:u=!1,...p}=t,f=ye.useRef(null),h=Bu(r,f),v=gy(o),[b,g]=hm({prop:s,defaultProp:l??null,onChange:c,caller:Ju}),[x,y]=ye.useState(!1),E=dm(i),N=z4(e),I=ye.useRef(!1),[L,H]=ye.useState(0);return ye.useEffect(()=>{const V=f.current;if(V)return V.addEventListener(Np,E),()=>V.removeEventListener(Np,E)},[E]),k.jsx(cB,{scope:e,orientation:n,dir:v,loop:a,currentTabStopId:b,onItemFocus:ye.useCallback(V=>g(V),[g]),onItemShiftTab:ye.useCallback(()=>y(!0),[]),onFocusableItemAdd:ye.useCallback(()=>H(V=>V+1),[]),onFocusableItemRemove:ye.useCallback(()=>H(V=>V-1),[]),children:k.jsx(Ms.div,{tabIndex:x||L===0?-1:0,"data-orientation":n,...p,ref:h,style:{outline:"none",...t.style},onMouseDown:ia(t.onMouseDown,()=>{I.current=!0}),onFocus:ia(t.onFocus,V=>{const q=!I.current;if(V.target===V.currentTarget&&q&&!x){const K=new CustomEvent(Np,iB);if(V.currentTarget.dispatchEvent(K),!K.defaultPrevented){const z=N().filter(w=>w.focusable),W=z.find(w=>w.active),D=z.find(w=>w.id===b),C=[W,D,...z].filter(Boolean).map(w=>w.ref.current);W4(C,u)}}I.current=!1}),onBlur:ia(t.onBlur,()=>y(!1))})})}),H4="RovingFocusGroupItem",q4=ye.forwardRef((t,r)=>{const{__scopeRovingFocusGroup:e,focusable:n=!0,active:a=!1,tabStopId:o,children:s,...l}=t,c=pm(),i=o||c,u=uB(H4,e),p=u.currentTabStopId===i,f=z4(e),{onFocusableItemAdd:h,onFocusableItemRemove:v,currentTabStopId:b}=u;return ye.useEffect(()=>{if(n)return h(),()=>v()},[n,h,v]),k.jsx(um.ItemSlot,{scope:e,id:i,focusable:n,active:a,children:k.jsx(Ms.span,{tabIndex:p?0:-1,"data-orientation":u.orientation,...l,ref:r,onMouseDown:ia(t.onMouseDown,g=>{n?u.onItemFocus(i):g.preventDefault()}),onFocus:ia(t.onFocus,()=>u.onItemFocus(i)),onKeyDown:ia(t.onKeyDown,g=>{if(g.key==="Tab"&&g.shiftKey){u.onItemShiftTab();return}if(g.target!==g.currentTarget)return;const x=pB(g,u.orientation,u.dir);if(x!==void 0){if(g.metaKey||g.ctrlKey||g.altKey||g.shiftKey)return;g.preventDefault();let E=f().filter(N=>N.focusable).map(N=>N.ref.current);if(x==="last")E.reverse();else if(x==="prev"||x==="next"){x==="prev"&&E.reverse();const N=E.indexOf(g.currentTarget);E=u.loop?mB(E,N+1):E.slice(N+1)}setTimeout(()=>W4(E))}}),children:typeof s=="function"?s({isCurrentTabStop:p,hasTabStop:b!=null}):s})})});q4.displayName=H4;var fB={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function hB(t,r){return r!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function pB(t,r,e){const n=hB(t.key,e);if(!(r==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(r==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return fB[n]}function W4(t,r=!1){const e=document.activeElement;for(const n of t)if(n===e||(n.focus({preventScroll:r}),document.activeElement!==e))return}function mB(t,r){return t.map((e,n)=>t[(r+n)%t.length])}var gB=V4,vB=q4,th="Tabs",[bB,YB]=Uf(th,[$4]),G4=$4(),[xB,p1]=bB(th),Y4=ye.forwardRef((t,r)=>{const{__scopeTabs:e,value:n,onValueChange:a,defaultValue:o,orientation:s="horizontal",dir:l,activationMode:c="automatic",...i}=t,u=gy(l),[p,f]=hm({prop:n,onChange:a,defaultProp:o??"",caller:th});return k.jsx(xB,{scope:e,baseId:pm(),value:p,onValueChange:f,orientation:s,dir:u,activationMode:c,children:k.jsx(Ms.div,{dir:u,"data-orientation":s,...i,ref:r})})});Y4.displayName=th;var X4="TabsList",K4=ye.forwardRef((t,r)=>{const{__scopeTabs:e,loop:n=!0,...a}=t,o=p1(X4,e),s=G4(e);return k.jsx(gB,{asChild:!0,...s,orientation:o.orientation,dir:o.dir,loop:n,children:k.jsx(Ms.div,{role:"tablist","aria-orientation":o.orientation,...a,ref:r})})});K4.displayName=X4;var Z4="TabsTrigger",J4=ye.forwardRef((t,r)=>{const{__scopeTabs:e,value:n,disabled:a=!1,...o}=t,s=p1(Z4,e),l=G4(e),c=t3(s.baseId,n),i=r3(s.baseId,n),u=n===s.value;return k.jsx(vB,{asChild:!0,...l,focusable:!a,active:u,children:k.jsx(Ms.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":i,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...o,ref:r,onMouseDown:ia(t.onMouseDown,p=>{!a&&p.button===0&&p.ctrlKey===!1?s.onValueChange(n):p.preventDefault()}),onKeyDown:ia(t.onKeyDown,p=>{[" ","Enter"].includes(p.key)&&s.onValueChange(n)}),onFocus:ia(t.onFocus,()=>{const p=s.activationMode!=="manual";!u&&!a&&p&&s.onValueChange(n)})})})});J4.displayName=Z4;var Q4="TabsContent",e3=ye.forwardRef((t,r)=>{const{__scopeTabs:e,value:n,forceMount:a,children:o,...s}=t,l=p1(Q4,e),c=t3(l.baseId,n),i=r3(l.baseId,n),u=n===l.value,p=ye.useRef(u);return ye.useEffect(()=>{const f=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(f)},[]),k.jsx(fm,{present:a||u,children:({present:f})=>k.jsx(Ms.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:i,tabIndex:0,...s,ref:r,style:{...t.style,animationDuration:p.current?"0s":void 0},children:f&&o})})});e3.displayName=Q4;function t3(t,r){return`${t}-trigger-${r}`}function r3(t,r){return`${t}-content-${r}`}var yB=Y4,n3=K4,a3=J4,s3=e3;const i3=yB,m1=ye.forwardRef(({className:t,...r},e)=>k.jsx(n3,{ref:e,className:At("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...r}));m1.displayName=n3.displayName;const Yi=ye.forwardRef(({className:t,...r},e)=>k.jsx(a3,{ref:e,className:At("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...r}));Yi.displayName=a3.displayName;const Xi=ye.forwardRef(({className:t,...r},e)=>k.jsx(s3,{ref:e,className:At("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r}));Xi.displayName=s3.displayName;function wB(){const{user:t}=Dn(),[r,e]=ye.useState([]),[n,a]=ye.useState([]),[o,s]=ye.useState([]),[l,c]=ye.useState([]),[i,u]=ye.useState([]),[p,f]=ye.useState(""),[h,v]=ye.useState(""),[b,g]=ye.useState(""),[x,y]=ye.useState(""),[E,N]=ye.useState(""),[I,L]=ye.useState(""),[H,V]=ye.useState(""),[q,K]=ye.useState(""),[z,W]=ye.useState(""),[D,M]=ye.useState(""),[C,w]=ye.useState(null),[T,A]=ye.useState(""),[S,j]=ye.useState("COMERCIAL"),[B,R]=ye.useState(""),[X,Y]=ye.useState(""),[ee,U]=ye.useState(null),[Q,P]=ye.useState(null),[F,Z]=ye.useState(null),[se,re]=ye.useState(""),[ae,te]=ye.useState(""),[he,le]=ye.useState(""),[ne,de]=ye.useState("NOVO"),[fe,Se]=ye.useState("");ye.useEffect(()=>{_e()},[]);const _e=async()=>{var _t;const[Oe,pt,Je,ot,ut]=await Promise.all([Tt.from("setores").select("*").order("nome"),Tt.from("motivos_devolucao").select("*, setor:setores(nome)").order("nome"),Tt.from("profiles").select("*").order("name"),Tt.from("clientes").select("*").order("nome"),Tt.from("devolucoes").select("vendedor").not("vendedor","is",null)]);if(Oe.data&&e(Oe.data.map(vt=>({id:vt.id,name:vt.nome}))),pt.data&&a(pt.data.map(vt=>({id:vt.id,name:vt.nome,sector_id:vt.sector_id,sector:vt.setor}))),Je.data&&s(Je.data),ot.data&&c(ot.data),ut.data){const vt=new Set;ut.data.forEach(ht=>{ht.vendedor&&ht.vendedor.trim()&&vt.add(ht.vendedor.trim().toUpperCase())}),(_t=ot.data)==null||_t.forEach(ht=>{ht.vendedor&&ht.vendedor.trim()&&vt.add(ht.vendedor.trim().toUpperCase())}),u(Array.from(vt).sort())}},Ce=async()=>{if(!h)return;const{error:Oe}=await Tt.from("setores").insert({nome:h});Oe?St.error("Erro ao adicionar setor: "+Oe.message):(St.success("Setor adicionado!"),v(""),_e())},Re=async()=>{if(!b||!b.trim()){St.error("Nome do motivo  obrigatrio");return}if(!x){St.error("Selecione um setor para o motivo");return}try{const{error:Oe}=await Tt.from("motivos_devolucao").insert({nome:b.trim(),sector_id:x});Oe?(console.error("Erro ao adicionar motivo:",Oe),St.error("Erro ao adicionar motivo: "+Oe.message)):(St.success("Motivo adicionado!"),g(""),y(""),_e())}catch(Oe){console.error("Erro ao adicionar motivo:",Oe),St.error("Erro ao adicionar motivo: "+(Oe.message||"Erro desconhecido"))}},Pe=async()=>{var Oe,pt;if(!E||!E.trim()){St.error("Nome do cliente  obrigatrio");return}if(!I||!I.trim()){St.error("CNPJ/CPF  obrigatrio");return}if(z&&z.length!==2){St.error("UF deve ter 2 caracteres");return}try{const{error:Je}=await Tt.from("clientes").insert({nome:E.trim(),cnpj_cpf:I.trim(),vendedor:(H==null?void 0:H.trim())||null,rede:(q==null?void 0:q.trim())||null,uf:(z==null?void 0:z.trim().toUpperCase())||null,municipio:(D==null?void 0:D.trim())||null});Je?(console.error("Erro ao adicionar cliente:",Je),Je.code==="23505"||(Oe=Je.message)!=null&&Oe.includes("duplicate")||(pt=Je.message)!=null&&pt.includes("unique")?St.error("Cliente com este CNPJ/CPF j est cadastrado"):St.error("Erro ao adicionar cliente: "+Je.message)):(St.success("Cliente adicionado!"),N(""),L(""),V(""),K(""),W(""),M(""),_e())}catch(Je){console.error("Erro ao adicionar cliente:",Je),St.error("Erro ao adicionar cliente: "+(Je.message||"Erro desconhecido"))}},Ye=async()=>{var pt,Je,ot,ut;if(!se||!ae||!he){St.error("Nome, email e senha so obrigatrios");return}if(he.length<6){St.error("A senha deve ter pelo menos 6 caracteres");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(ae)){St.error("Email invlido");return}try{const _t={name:se},{data:vt,error:ht}=await Tt.auth.signUp({email:ae.trim().toLowerCase(),password:he,options:{data:_t,emailRedirectTo:void 0}});if(ht){console.error("Erro no auth.signUp:",ht),(pt=ht.message)!=null&&pt.includes("already registered")||(Je=ht.message)!=null&&Je.includes("already exists")?St.error("Este email j est cadastrado no sistema"):(ot=ht.message)!=null&&ot.includes("password")?St.error("Senha invlida. Verifique os requisitos de senha."):(ut=ht.message)!=null&&ut.includes("email")?St.error("Email invlido ou j cadastrado"):St.error(`Erro ao criar usurio: ${ht.message||"Erro desconhecido"}`);return}if(vt.user){console.log(" Usurio criado no Auth:",vt.user.id,vt.user.email),await new Promise(et=>setTimeout(et,1500));let $e=null,Be=0;const wt=3;for(;Be<wt&&!$e;){Be++,console.log(` Tentativa ${Be}/${wt} de verificar perfil...`);const{data:et,error:dt}=await Tt.from("profiles").select("*").eq("id",vt.user.id).single();if(dt&&dt.code!=="PGRST116"&&console.warn("Erro ao verificar perfil:",dt),et){$e=et,console.log(" Perfil encontrado:",$e);break}Be<wt&&await new Promise(we=>setTimeout(we,1500))}if($e){const{error:et}=await Tt.from("profiles").update({name:se,role:"NOVO",vendedor:null}).eq("id",vt.user.id);et?console.warn(" Aviso ao atualizar perfil:",et):console.log(" Perfil atualizado com sucesso")}else{console.log(" Perfil no encontrado aps tentativas, criando manualmente...");const{data:et,error:dt}=await Tt.from("profiles").insert({id:vt.user.id,name:se,email:ae.trim().toLowerCase(),role:"NOVO",vendedor:null}).select().single();if(dt){console.error(" Erro ao inserir perfil:",dt),St.error(`Usurio criado no Auth, mas erro ao criar perfil: ${dt.message}. Verifique o perfil manualmente no Supabase.`);return}$e=et,console.log(" Perfil criado manualmente:",$e)}St.success("Usurio criado com sucesso! O usurio foi criado como tipo NOVO. Atribua a funo apropriada na gesto de usurios."),re(""),te(""),le(""),de("NOVO"),Se(""),_e()}else St.warning("Usurio criado, mas no foi possvel obter os dados. Recarregue a pgina.")}catch(_t){console.error("Erro ao criar usurio:",_t),St.error(`Erro ao criar usurio: ${_t.message||"Erro desconhecido"}`)}},at=async()=>{var Oe,pt;if(C){if(S==="VENDEDOR"&&!B){St.error("Usurios do tipo VENDEDOR devem ter um vendedor selecionado");return}if(!S||S==="NOVO"){St.error("Selecione um role vlido para o usurio");return}try{const Je={name:T.trim()};S&&(Je.role=S),S==="VENDEDOR"?Je.vendedor=B||null:Je.vendedor=null,console.log(" Atualizando usurio:",C.id,"com dados:",Je),console.log(" Usurio atual (ADMIN):",t==null?void 0:t.email,"role:",t==null?void 0:t.role),Je.updated_at=new Date().toISOString();const{error:ot,data:ut}=await Tt.from("profiles").update(Je).eq("id",C.id).select();if(ot){console.error(" Erro ao atualizar perfil:",ot),console.error(" Detalhes do erro:",JSON.stringify(ot,null,2)),console.error(" Cdigo do erro:",ot.code),console.error(" Mensagem:",ot.message),console.error(" Detalhes:",ot.details),console.error(" Hint:",ot.hint),ot.code==="42501"||(Oe=ot.message)!=null&&Oe.includes("permission")||(pt=ot.message)!=null&&pt.includes("policy")?St.error("Erro de permisso: Verifique se voc tem permisso para atualizar este usurio. Apenas ADMINs podem atualizar outros perfis."):St.error("Erro ao atualizar usurio: "+(ot.message||"Erro desconhecido"));return}if(console.log(" Resposta do update:",ut),!ut||ut.length===0){console.error(" Update retornou array vazio - possvel problema de RLS"),St.error("Usurio no foi atualizado. Verifique se voc tem permisso ADMIN para atualizar outros perfis.");return}console.log(" Usurio atualizado com sucesso:",ut[0]),X&&X.length>=6&&(St.warning("Alterao de senha de outros usurios requer configurao de Edge Function ou uso da API Admin do Supabase. Por favor, use o Supabase Dashboard para alterar senhas."),Y("")),St.success("Usurio atualizado com sucesso!"),w(null),Y(""),_e()}catch(Je){console.error("Erro ao atualizar usurio:",Je),St.error("Erro ao atualizar usurio: "+Je.message)}}},tt=async()=>{if(ee)try{const{error:Oe}=await Tt.from("profiles").delete().eq("id",ee.id);if(Oe){St.error("Erro ao excluir usurio: "+Oe.message);return}St.success("Usurio excludo com sucesso! (Nota: O registro no Auth pode precisar ser removido manualmente no Supabase Dashboard)"),U(null),_e()}catch(Oe){St.error("Erro ao excluir usurio: "+Oe.message)}},it=async()=>{if(Q)try{const{error:Oe}=await Tt.from("motivos_devolucao").delete().eq("id",Q);Oe?St.error("Erro ao excluir: "+Oe.message):(St.success("Excludo com sucesso"),P(null),_e())}catch(Oe){St.error("Erro ao excluir: "+Oe.message)}},rt=()=>{F&&(u(i.filter(Oe=>Oe!==F)),St.success("Vendedor removido da lista!"),Z(null))},ct=async()=>{if(!p||!p.trim()){St.error("Nome do vendedor  obrigatrio");return}const Oe=p.trim().toUpperCase();if(i.includes(Oe)){St.warning("Este vendedor j est cadastrado");return}u([...i,Oe].sort()),f(""),St.success("Vendedor adicionado  lista!")};return(t==null?void 0:t.role)!=="ADMIN"&&(t==null?void 0:t.role)!=="LOGISTICA"?k.jsx("div",{className:"p-8 text-center",children:"Acesso restrito a administradores e logstica."}):k.jsxs("div",{className:"space-y-6",children:[k.jsx(Qi,{title:"Configuraes",description:"Gerencie setores, motivos de devoluo, vendedores, clientes e usurios do sistema. Acesso restrito a administradores."}),k.jsxs(i3,{defaultValue:"master-data",children:[k.jsx("div",{className:"overflow-x-auto",children:k.jsxs(m1,{className:"w-full md:w-auto min-w-full md:min-w-0",children:[k.jsx(Yi,{value:"master-data",className:"text-xs sm:text-sm whitespace-nowrap",children:"Master Data (Setores/Motivos)"}),k.jsx(Yi,{value:"vendedores",className:"text-xs sm:text-sm whitespace-nowrap",children:"Vendedores"}),k.jsx(Yi,{value:"clientes",className:"text-xs sm:text-sm whitespace-nowrap",children:"Clientes"}),(t==null?void 0:t.role)==="ADMIN"&&k.jsx(Yi,{value:"users",className:"text-xs sm:text-sm whitespace-nowrap",children:"Usurios"})]})}),k.jsx(Xi,{value:"master-data",className:"space-y-6 mt-6",children:k.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[k.jsxs(Dt,{children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:"Setores"}),k.jsx(Vr,{children:"Gerencie as reas responsveis."})]}),k.jsxs(Mt,{children:[k.jsxs("div",{className:"flex gap-2 mb-4",children:[k.jsx(wr,{placeholder:"Novo Setor",value:h,onChange:Oe=>v(Oe.target.value)}),k.jsx(Nt,{onClick:Ce,size:"icon",children:k.jsx(tu,{className:"h-4 w-4"})})]}),k.jsx("div",{className:"rounded-md border max-h-[300px] overflow-y-auto",children:k.jsx(Ua,{children:k.jsx(za,{children:r.map(Oe=>k.jsx(Nr,{children:k.jsx(Kt,{children:Oe.name})},Oe.id))})})})]})]}),k.jsxs(Dt,{children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:"Motivos de Devoluo"}),k.jsx(Vr,{children:"Associe motivos aos setores."})]}),k.jsxs(Mt,{children:[k.jsxs("div",{className:"flex flex-col gap-2 mb-4",children:[k.jsxs(La,{value:x,onValueChange:y,children:[k.jsx(ga,{children:k.jsx(Ba,{placeholder:"Selecione o Setor"})}),k.jsx(va,{children:r.map(Oe=>k.jsx(sr,{value:Oe.id,children:Oe.name},Oe.id))})]}),k.jsxs("div",{className:"flex gap-2",children:[k.jsx(wr,{placeholder:"Novo Motivo",value:b,onChange:Oe=>g(Oe.target.value)}),k.jsx(Nt,{onClick:Re,size:"icon",children:k.jsx(tu,{className:"h-4 w-4"})})]})]}),k.jsx("div",{className:"rounded-md border max-h-[300px] overflow-y-auto",children:k.jsxs(Ua,{children:[k.jsx(os,{children:k.jsxs(Nr,{children:[k.jsx(jt,{children:"Motivo"}),k.jsx(jt,{children:"Setor"}),k.jsx(jt,{className:"w-[50px]"})]})}),k.jsx(za,{children:n.length===0?k.jsx(Nr,{children:k.jsx(Kt,{colSpan:3,className:"text-center text-muted-foreground",children:"Nenhum motivo cadastrado"})}):n.map(Oe=>{var pt;return k.jsxs(Nr,{children:[k.jsx(Kt,{children:Oe.name}),k.jsx(Kt,{className:"text-xs text-muted-foreground",children:((pt=Oe.sector)==null?void 0:pt.name)||"-"}),k.jsx(Kt,{children:k.jsx(Nt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:bg-destructive/10",onClick:()=>P(Oe.id),children:k.jsx(Pa,{className:"h-3 w-3"})})})]},Oe.id)})})]})})]})]})]})}),k.jsx(Xi,{value:"vendedores",className:"space-y-6 mt-6",children:k.jsxs(Dt,{children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:"Cadastro de Vendedores"}),k.jsx(Vr,{children:"Gerencie a lista de vendedores disponveis no sistema."})]}),k.jsxs(Mt,{children:[k.jsxs("div",{className:"flex gap-2 mb-4",children:[k.jsx(wr,{placeholder:"Nome do Vendedor",value:p,onChange:Oe=>f(Oe.target.value),onKeyPress:Oe=>Oe.key==="Enter"&&ct()}),k.jsx(Nt,{onClick:ct,size:"icon",children:k.jsx(tu,{className:"h-4 w-4"})})]}),k.jsx("div",{className:"rounded-md border max-h-[400px] overflow-y-auto",children:k.jsxs(Ua,{children:[k.jsx(os,{children:k.jsxs(Nr,{children:[k.jsx(jt,{children:"Nome"}),k.jsx(jt,{className:"text-right",children:"Aes"})]})}),k.jsxs(za,{children:[i.map((Oe,pt)=>k.jsxs(Nr,{children:[k.jsx(Kt,{className:"font-medium",children:Oe}),k.jsx(Kt,{className:"text-right",children:k.jsx(Nt,{variant:"ghost",size:"icon",className:"hover:bg-destructive/10",onClick:()=>Z(Oe),children:k.jsx(Pa,{className:"h-4 w-4 text-destructive"})})})]},pt)),i.length===0&&k.jsx(Nr,{children:k.jsx(Kt,{colSpan:2,className:"text-center text-muted-foreground",children:"Nenhum vendedor cadastrado. Adicione um acima."})})]})]})})]})]})}),k.jsx(Xi,{value:"clientes",className:"space-y-6 mt-6",children:k.jsxs(Dt,{children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:"Cadastro de Clientes"}),k.jsx(Vr,{children:"Adicione novos clientes ao sistema."})]}),k.jsxs(Mt,{children:[k.jsxs("div",{className:"space-y-4 mb-6",children:[k.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"Nome *"}),k.jsx(wr,{value:E,onChange:Oe=>N(Oe.target.value),placeholder:"Nome do cliente"})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"CNPJ/CPF *"}),k.jsx(wr,{value:I,onChange:Oe=>L(Oe.target.value),placeholder:"00.000.000/0000-00"})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"Vendedor"}),k.jsx(wr,{value:H,onChange:Oe=>V(Oe.target.value),placeholder:"Nome do vendedor"})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"Rede"}),k.jsx(wr,{value:q,onChange:Oe=>K(Oe.target.value),placeholder:"Nome da rede"})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"UF"}),k.jsx(wr,{value:z,onChange:Oe=>W(Oe.target.value.toUpperCase()),placeholder:"UF",maxLength:2})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"Municpio"}),k.jsx(wr,{value:D,onChange:Oe=>M(Oe.target.value),placeholder:"Nome do municpio"})]})]}),k.jsxs(Nt,{onClick:Pe,children:[k.jsx(tu,{className:"mr-2 h-4 w-4"}),"Adicionar Cliente"]})]}),k.jsx("div",{className:"rounded-md border max-h-[400px] overflow-y-auto",children:k.jsxs(Ua,{children:[k.jsx(os,{children:k.jsxs(Nr,{children:[k.jsx(jt,{children:"Nome"}),k.jsx(jt,{children:"CNPJ/CPF"}),k.jsx(jt,{children:"Vendedor"}),k.jsx(jt,{children:"Rede"}),k.jsx(jt,{children:"UF"}),k.jsx(jt,{children:"Municpio"})]})}),k.jsx(za,{children:l.map(Oe=>k.jsxs(Nr,{children:[k.jsx(Kt,{className:"font-medium",children:Oe.nome}),k.jsx(Kt,{children:Oe.cnpj_cpf}),k.jsx(Kt,{children:Oe.vendedor||"-"}),k.jsx(Kt,{children:Oe.rede||"-"}),k.jsx(Kt,{children:Oe.uf||"-"}),k.jsx(Kt,{children:Oe.municipio||"-"})]},Oe.id))})]})})]})]})}),k.jsxs(Xi,{value:"users",className:"space-y-6 mt-6",children:[k.jsxs(Dt,{children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:"Cadastro de Usurios"}),k.jsx(Vr,{children:"Adicione novos usurios ao sistema."})]}),k.jsx(Mt,{children:k.jsxs("div",{className:"space-y-4 mb-6 p-4 border rounded-lg",children:[k.jsx("h3",{className:"font-semibold mb-4",children:"Novo Usurio"}),k.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"Nome *"}),k.jsx(wr,{value:se,onChange:Oe=>re(Oe.target.value),placeholder:"Nome completo"})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"Email *"}),k.jsx(wr,{type:"email",value:ae,onChange:Oe=>te(Oe.target.value),placeholder:"email@exemplo.com"})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"Senha *"}),k.jsx(wr,{type:"password",value:he,onChange:Oe=>le(Oe.target.value),placeholder:"Senha"})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{children:"Funo"}),k.jsx(wr,{value:"NOVO (Ser atribudo pelo Admin)",disabled:!0,className:"bg-muted"}),k.jsx("p",{className:"text-xs text-muted-foreground",children:"Novos usurios so criados como tipo NOVO. O administrador deve atribuir a funo apropriada aps o cadastro."})]}),!1]}),k.jsxs(Nt,{onClick:Ye,children:[k.jsx(tu,{className:"mr-2 h-4 w-4"}),"Criar Usurio"]})]})})]}),k.jsxs(Dt,{children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:"Gesto de Usurios"}),k.jsx(Vr,{children:"Visualize e gerencie os usurios do sistema."})]}),k.jsx(Mt,{children:k.jsx("div",{className:"rounded-md border",children:k.jsxs(Ua,{children:[k.jsx(os,{children:k.jsxs(Nr,{children:[k.jsx(jt,{children:"Nome"}),k.jsx(jt,{children:"Email"}),k.jsx(jt,{children:"Funo"}),k.jsx(jt,{children:"Vendedor"}),k.jsx(jt,{className:"text-right",children:"Aes"})]})}),k.jsx(za,{children:o.map(Oe=>k.jsxs(Nr,{children:[k.jsx(Kt,{className:"font-medium",children:Oe.name}),k.jsx(Kt,{children:Oe.email}),k.jsx(Kt,{children:k.jsx(Ia,{variant:Oe.role==="ADMIN"?"default":Oe.role==="NOVO"?"destructive":"secondary",children:Oe.role||"NOVO"})}),k.jsx(Kt,{children:k.jsx(Ia,{variant:"outline",children:Oe.vendedor||"GERAL"})}),k.jsx(Kt,{className:"text-right",children:k.jsxs("div",{className:"flex justify-end gap-2",children:[k.jsx(Nt,{variant:"ghost",size:"icon",className:"hover:bg-primary/10",onClick:()=>{w(Oe),A(Oe.name),j(Oe.role),R(Oe.vendedor||""),Y("")},children:k.jsx(rx,{className:"h-4 w-4 text-primary"})}),k.jsx(Nt,{variant:"ghost",size:"icon",className:"hover:bg-destructive/10",onClick:()=>U({id:Oe.id,name:Oe.name}),disabled:Oe.id===(t==null?void 0:t.id),children:k.jsx(Pa,{className:"h-4 w-4 text-destructive"})})]})})]},Oe.id))})]})})})]})]})]}),k.jsx(ri,{open:!!ee,onOpenChange:Oe=>!Oe&&U(null),children:k.jsxs(As,{className:"sm:max-w-[425px]",children:[k.jsxs(Cs,{children:[k.jsxs(Os,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[k.jsx(Pa,{className:"h-5 w-5"}),"Confirmar Excluso"]}),k.jsxs(js,{className:"pt-2",children:["Tem certeza que deseja excluir o usurio ",k.jsxs("span",{className:"font-semibold text-foreground",children:['"',ee==null?void 0:ee.name,'"']}),"?"]}),k.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mt-4",children:k.jsx("p",{className:"text-sm text-destructive font-medium",children:" Esta ao no pode ser desfeita. O usurio perder acesso ao sistema."})})]}),k.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[k.jsx(Nt,{variant:"outline",onClick:()=>U(null),className:"flex-1 sm:flex-initial",children:"No"}),k.jsx(Nt,{variant:"destructive",onClick:tt,className:"flex-1 sm:flex-initial",children:"Sim, Excluir"})]})]})}),k.jsx(ri,{open:!!Q,onOpenChange:Oe=>!Oe&&P(null),children:k.jsxs(As,{className:"sm:max-w-[425px]",children:[k.jsxs(Cs,{children:[k.jsxs(Os,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[k.jsx(Pa,{className:"h-5 w-5"}),"Confirmar Excluso"]}),k.jsx(js,{className:"pt-2",children:"Tem certeza que deseja excluir este motivo de devoluo?"}),k.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mt-4",children:k.jsx("p",{className:"text-sm text-destructive font-medium",children:" Esta ao no pode ser desfeita."})})]}),k.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[k.jsx(Nt,{variant:"outline",onClick:()=>P(null),className:"flex-1 sm:flex-initial",children:"No"}),k.jsx(Nt,{variant:"destructive",onClick:it,className:"flex-1 sm:flex-initial",children:"Sim, Excluir"})]})]})}),k.jsx(ri,{open:!!F,onOpenChange:Oe=>!Oe&&Z(null),children:k.jsxs(As,{className:"sm:max-w-[425px]",children:[k.jsxs(Cs,{children:[k.jsxs(Os,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[k.jsx(Pa,{className:"h-5 w-5"}),"Confirmar Excluso"]}),k.jsxs(js,{className:"pt-2",children:["Tem certeza que deseja remover o vendedor ",k.jsxs("span",{className:"font-semibold text-foreground",children:['"',F,'"']})," da lista?"]}),k.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mt-4",children:k.jsx("p",{className:"text-sm text-destructive font-medium",children:" Esta ao no pode ser desfeita."})})]}),k.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[k.jsx(Nt,{variant:"outline",onClick:()=>Z(null),className:"flex-1 sm:flex-initial",children:"No"}),k.jsx(Nt,{variant:"destructive",onClick:rt,className:"flex-1 sm:flex-initial",children:"Sim, Remover"})]})]})}),k.jsx(ri,{open:!!C,onOpenChange:Oe=>{Oe||(w(null),Y(""))},children:k.jsxs(As,{className:"sm:max-w-[500px]",children:[k.jsxs(Cs,{children:[k.jsxs(Os,{className:"text-xl font-bold flex items-center gap-2",children:[k.jsx(rx,{className:"h-5 w-5 text-primary"}),"Editar Usurio"]}),k.jsxs(js,{className:"pt-2",children:["Alterar permisses e dados de ",k.jsx("span",{className:"font-semibold text-foreground",children:C==null?void 0:C.name})]})]}),k.jsxs("div",{className:"space-y-4 py-4",children:[k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{className:"text-sm font-medium",children:"Nome"}),k.jsx(wr,{value:T,onChange:Oe=>A(Oe.target.value),className:"h-10"})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{className:"text-sm font-medium",children:"Funo (Role)"}),k.jsxs(La,{value:S||"",onValueChange:Oe=>{j(Oe),Oe!=="VENDEDOR"&&R("")},children:[k.jsx(ga,{className:"h-10",children:k.jsx(Ba,{})}),k.jsxs(va,{children:[k.jsx(sr,{value:"ADMIN",children:"ADMIN"}),k.jsx(sr,{value:"GESTOR",children:"GESTOR"}),k.jsx(sr,{value:"COMERCIAL",children:"COMERCIAL"}),k.jsx(sr,{value:"LOGISTICA",children:"LOGISTICA"}),k.jsx(sr,{value:"VENDEDOR",children:"VENDEDOR"}),k.jsx(sr,{value:"NOVO",children:"NOVO (Sem Acesso)"})]})]})]}),S==="VENDEDOR"&&k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{className:"text-sm font-medium",children:"Vendedor *"}),k.jsxs(La,{value:B,onValueChange:R,children:[k.jsx(ga,{className:"h-10",children:k.jsx(Ba,{placeholder:"Selecione o vendedor"})}),k.jsxs(va,{children:[i.map(Oe=>k.jsx(sr,{value:Oe,children:Oe},Oe)),i.length===0&&k.jsx(sr,{value:"",disabled:!0,children:"Nenhum vendedor cadastrado"})]})]})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{className:"text-sm font-medium",children:"Nova Senha (opcional)"}),k.jsx(wr,{type:"password",value:X,onChange:Oe=>Y(Oe.target.value),placeholder:"Deixe em branco para manter a senha atual",minLength:6,className:"h-10"}),k.jsx("p",{className:"text-xs text-muted-foreground",children:"Mnimo de 6 caracteres. Deixe em branco para no alterar."})]})]}),k.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[k.jsx(Nt,{variant:"outline",onClick:()=>{w(null),Y("")},className:"flex-1 sm:flex-initial",children:"Cancelar"}),k.jsx(Nt,{onClick:at,className:"flex-1 sm:flex-initial bg-primary hover:bg-primary/90",children:"Salvar Alteraes"})]})]})})]})}function _B(t,r=[]){let e=[];function n(o,s){const l=ye.createContext(s);l.displayName=o+"Context";const c=e.length;e=[...e,s];const i=p=>{var x;const{scope:f,children:h,...v}=p,b=((x=f==null?void 0:f[t])==null?void 0:x[c])||l,g=ye.useMemo(()=>v,Object.values(v));return k.jsx(b.Provider,{value:g,children:h})};i.displayName=o+"Provider";function u(p,f){var b;const h=((b=f==null?void 0:f[t])==null?void 0:b[c])||l,v=ye.useContext(h);if(v)return v;if(s!==void 0)return s;throw new Error(`\`${p}\` must be used within \`${o}\``)}return[i,u]}const a=()=>{const o=e.map(s=>ye.createContext(s));return function(l){const c=(l==null?void 0:l[t])||o;return ye.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return a.scopeName=t,[n,SB(a,...r)]}function SB(...t){const r=t[0];if(t.length===1)return r;const e=()=>{const n=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(o){const s=n.reduce((l,{useScope:c,scopeName:i})=>{const p=c(o)[`__scope${i}`];return{...l,...p}},{});return ye.useMemo(()=>({[`__scope${r.scopeName}`]:s}),[s])}};return e.scopeName=r.scopeName,e}var kB=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],g1=kB.reduce((t,r)=>{const e=gm(`Primitive.${r}`),n=ye.forwardRef((a,o)=>{const{asChild:s,...l}=a,c=s?e:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),k.jsx(c,{...l,ref:o})});return n.displayName=`Primitive.${r}`,{...t,[r]:n}},{}),EB=u8();function TB(){return EB.useSyncExternalStore(AB,()=>!0,()=>!1)}function AB(){return()=>{}}var v1="Avatar",[CB,XB]=_B(v1),[NB,o3]=CB(v1),l3=ye.forwardRef((t,r)=>{const{__scopeAvatar:e,...n}=t,[a,o]=ye.useState("idle");return k.jsx(NB,{scope:e,imageLoadingStatus:a,onImageLoadingStatusChange:o,children:k.jsx(g1.span,{...n,ref:r})})});l3.displayName=v1;var c3="AvatarImage",u3=ye.forwardRef((t,r)=>{const{__scopeAvatar:e,src:n,onLoadingStatusChange:a=()=>{},...o}=t,s=o3(c3,e),l=OB(n,o),c=dm(i=>{a(i),s.onImageLoadingStatusChange(i)});return xu(()=>{l!=="idle"&&c(l)},[l,c]),l==="loaded"?k.jsx(g1.img,{...o,ref:r,src:n}):null});u3.displayName=c3;var d3="AvatarFallback",f3=ye.forwardRef((t,r)=>{const{__scopeAvatar:e,delayMs:n,...a}=t,o=o3(d3,e),[s,l]=ye.useState(n===void 0);return ye.useEffect(()=>{if(n!==void 0){const c=window.setTimeout(()=>l(!0),n);return()=>window.clearTimeout(c)}},[n]),s&&o.imageLoadingStatus!=="loaded"?k.jsx(g1.span,{...a,ref:r}):null});f3.displayName=d3;function ey(t,r){return t?r?(t.src!==r&&(t.src=r),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function OB(t,{referrerPolicy:r,crossOrigin:e}){const n=TB(),a=ye.useRef(null),o=n?(a.current||(a.current=new window.Image),a.current):null,[s,l]=ye.useState(()=>ey(o,t));return xu(()=>{l(ey(o,t))},[o,t]),xu(()=>{const c=p=>()=>{l(p)};if(!o)return;const i=c("loaded"),u=c("error");return o.addEventListener("load",i),o.addEventListener("error",u),r&&(o.referrerPolicy=r),typeof e=="string"&&(o.crossOrigin=e),()=>{o.removeEventListener("load",i),o.removeEventListener("error",u)}},[o,e,r]),s}var h3=l3,p3=u3,m3=f3;const g3=ye.forwardRef(({className:t,...r},e)=>k.jsx(h3,{ref:e,className:At("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...r}));g3.displayName=h3.displayName;const v3=ye.forwardRef(({className:t,...r},e)=>k.jsx(p3,{ref:e,className:At("aspect-square h-full w-full",t),...r}));v3.displayName=p3.displayName;const b3=ye.forwardRef(({className:t,...r},e)=>k.jsx(m3,{ref:e,className:At("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...r}));b3.displayName=m3.displayName;function jB(){const{user:t}=Dn(),{filters:r}=ec(),[e,n]=ye.useState(""),[a,o]=ye.useState(!1),[s,l]=ye.useState([]),[c,i]=ye.useState(1),[u,p]=ye.useState(0),f=100,[h,v]=ye.useState({myReturnsCount:0,approvalRate:0,totalValue:0,avgCompanyTicket:0,avgCompanyReturns:0}),[b,g]=ye.useState([]),[x,y]=ye.useState(""),[E,N]=ye.useState(null),[I,L]=ye.useState(!1),[H,V]=ye.useState(new Date);ye.useEffect(()=>{t&&(q(),(t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA")&&A(),(t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA")&&K())},[t,r,c]);const q=async()=>{if(!t)return;let j=Tt.from("devolucoes").select("*");t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"||(t.role==="VENDEDOR"&&t.vendedor?j=j.eq("vendedor",t.vendedor):j=j.ilike("vendedor",`%${t.name}%`)),r.startDate&&(j=j.gte("data_emissao",r.startDate.toISOString())),r.endDate&&(j=j.lte("data_emissao",r.endDate.toISOString()));const{data:B}=await j;let R=Tt.from("devolucoes").select("*");r.startDate&&(R=R.gte("data_emissao",r.startDate.toISOString())),r.endDate&&(R=R.lte("data_emissao",r.endDate.toISOString()));const{data:X}=await R;if(B){const Y=B.length,ee=B.reduce((de,fe)=>de+(Number(fe.valor_total_nota)||0),0),U=B.filter(de=>de.resultado&&de.resultado!=="PENDENTE VALIDAO"),Q=B.filter(de=>de.resultado==="VALIDADA"||de.resultado==="LANADA").length,P=U.length>0?Q/U.length*100:0,F=(X==null?void 0:X.length)||0,Z=(X==null?void 0:X.reduce((de,fe)=>de+(Number(fe.valor_total_nota)||0),0))||0,se=F>0?Z/F:0,re=Y>0?ee/Y:0;v({myReturnsCount:Y,totalValue:ee,approvalRate:Math.round(P),avgCompanyTicket:se,avgCompanyReturns:F});const ae=B.reduce((de,fe)=>{const Se=new Date(fe.data_emissao||fe.created_at),_e=Jt(Se,"MMM yyyy",{locale:jr});return de[_e]||(de[_e]={count:0,value:0}),de[_e].count+=1,de[_e].value+=Number(fe.valor_total_nota)||0,de},{}),te=Object.entries(ae).map(([de,fe])=>({name:de,quantidade:fe.count,valor:fe.value})).sort((de,fe)=>{var rt,ct;const Se={jan:1,fev:2,mar:3,abr:4,mai:5,jun:6,jul:7,ago:8,set:9,out:10,nov:11,dez:12},_e=de.name.toLowerCase().split(" "),Ce=fe.name.toLowerCase().split(" "),Re=Se[((rt=_e[0])==null?void 0:rt.substring(0,3))||""]||0,Pe=Se[((ct=Ce[0])==null?void 0:ct.substring(0,3))||""]||0,Ye=parseInt(_e[1]||"0"),at=parseInt(Ce[1]||"0"),tt=new Date(Ye,Re-1),it=new Date(at,Pe-1);return tt.getTime()-it.getTime()});g(te);const he=re>se?"acima":re<se?"abaixo":"igual",le=se>0?Math.abs((re-se)/se*100).toFixed(1):"0";let ne=`Voc registrou ${Y} devolues neste perodo, totalizando R$ ${ee.toLocaleString("pt-BR")}. `;ne+=`Sua taxa de aprovao  de ${Math.round(P)}%. `,Y>0&&F>0&&(ne+=`Seu ticket mdio (R$ ${re.toLocaleString("pt-BR",{maximumFractionDigits:0})}) est ${he} da mdia da empresa (R$ ${se.toLocaleString("pt-BR",{maximumFractionDigits:0})}). `,he!=="igual"&&(ne+=`Diferena de ${le}%. `)),ne+=`A empresa registrou ${F} devolues no total neste perodo.`,y(ne)}},K=async()=>{if(!(!t||t.role!=="ADMIN"&&t.role!=="COMERCIAL"&&t.role!=="LOGISTICA"))try{const{data:j}=await Tt.from("profiles").select("id, name, role, vendedor").eq("role","VENDEDOR");if(!j)return;const{data:B}=await Tt.from("devolucoes").select(`
            *,
            logs_validacao(
              usuario_id,
              created_at,
              status_novo,
              status_anterior
            )
          `);if(!B)return;const R={};j.forEach(Y=>{Y.vendedor&&(R[Y.vendedor]={id:Y.id,name:Y.name,role:Y.role,vendedor:Y.vendedor,tempoMedioValidacao:0,diasAtraso:0,totalValidacoes:0,notasPendentes:0,notasCancelamento:0,devolucoesValidadas:[],ultimaValidacao:null})}),new Date().setHours(0,0,0,0),B.forEach(Y=>{const ee=Y.vendedor;if(!ee||!R[ee])return;const U=R[ee],Q=Y.logs_validacao||[];Y.resultado==="PENDENTE VALIDAO"&&U.notasPendentes++,Y.resultado==="TRATATIVA DE ANULAO"&&U.notasCancelamento++;const P=Q.find(F=>F.status_novo==="VALIDADA");if(P){const F=new Date(P.created_at),Z=new Date(Y.data_emissao||Y.created_at),se=Math.floor((F.getTime()-Z.getTime())/(1e3*60*60*24));U.totalValidacoes++,U.tempoMedioValidacao+=se,(!U.ultimaValidacao||F>U.ultimaValidacao)&&(U.ultimaValidacao=F),U.devolucoesValidadas.push({dias:se,prazo:Y.prazo})}}),Object.keys(R).forEach(Y=>{const ee=R[Y];ee.totalValidacoes>0&&(ee.tempoMedioValidacao=Math.round(ee.tempoMedioValidacao/ee.totalValidacoes));const U=B.filter(Q=>Q.vendedor===Y&&Q.resultado==="PENDENTE VALIDAO"&&Q.prazo==="EM ATRASO"&&Q.dias!=null&&Q.dias>0);if(U.length>0){const Q=U.reduce((P,F)=>P+(Number(F.dias)||0),0);ee.diasAtraso=Math.round(Q/U.length)}else ee.diasAtraso=0}),N({usuarios:Object.values(R),totalUsuarios:Object.keys(R).length})}catch(j){console.error("Erro ao buscar KPIs de usurios:",j)}},z=async j=>{if(!t||t.role!=="VENDEDOR"||!t.vendedor)return[];const B=Jt(j,"yyyy-MM-dd");console.log("Buscando validaes para a data:",B),console.log("Vendedor do usurio:",t.vendedor);const{data:R,error:X}=await Tt.from("devolucoes").select(`
        *,
        itens:itens_devolucao(*, motivo_item:motivos_devolucao(nome)),
        logs_validacao!inner(
          created_at,
          status_novo,
          acao
        )
      `).eq("vendedor",t.vendedor).eq("resultado","VALIDADA").eq("logs_validacao.status_novo","VALIDADA");if(X){console.error("Erro ao buscar devolues com logs:",X),console.log("Tentando fallback: buscar devolues sem join...");const{data:U,error:Q}=await Tt.from("devolucoes").select(`
          *,
          itens:itens_devolucao(*, motivo_item:motivos_devolucao(nome))
        `).eq("vendedor",t.vendedor).eq("resultado","VALIDADA");if(Q)return console.error("Erro ao buscar devolues simples:",Q),[];if(console.log("Devolues encontradas (sem filtro de data):",(U==null?void 0:U.length)||0),U&&U.length>0){const P=U.map(ae=>ae.id),{data:F,error:Z}=await Tt.from("logs_validacao").select("devolucao_id, created_at, status_novo").in("devolucao_id",P).eq("status_novo","VALIDADA").order("created_at",{ascending:!1});if(Z)return console.error("Erro ao buscar logs:",Z),console.log("Retornando todas as devolues sem filtro de data"),U;console.log("Logs encontrados:",(F==null?void 0:F.length)||0),F&&F.length>0?console.log("Primeiros 3 logs:",F.slice(0,3).map(ae=>({devolucao_id:ae.devolucao_id,created_at:ae.created_at,data_formatada:Jt(new Date(ae.created_at),"yyyy-MM-dd"),status:ae.status_novo}))):console.log(" Nenhum log encontrado para as devolues!");const se=new Map;if(F==null||F.forEach(ae=>{const te=se.get(ae.devolucao_id),he=new Date(ae.created_at);(!te||he>te)&&se.set(ae.devolucao_id,he)}),console.log("Mapa de validaes criado:",se.size,"devolues com data de validao"),console.log("Data buscada:",B),se.size>0){const ae=Array.from(se.entries()).slice(0,5);console.log("Primeiras datas de validao:",ae.map(([te,he])=>({devolucao_id:te.substring(0,8)+"...",data:Jt(he,"yyyy-MM-dd")})))}const re=U.filter(ae=>{const te=se.get(ae.id);if(!te)return console.log("Devoluo",ae.numero,"no tem data de validao nos logs"),!1;const he=Jt(te,"yyyy-MM-dd"),le=he===B;return le||console.log("Devoluo",ae.numero,"validada em",he,"no corresponde a",B),le});return console.log("Devolues filtradas pela data:",re.length),re.length>0&&console.log("Primeiras devolues filtradas:",re.slice(0,3).map(ae=>({numero:ae.numero,vendedor:ae.vendedor}))),re}return[]}if(!R||R.length===0)return console.log("Nenhuma devoluo encontrada"),[];console.log("Devolues encontradas (com join):",R.length);const Y=R.filter(U=>{const Q=U.logs_validacao||[];if(Q.length===0)return!1;const P=Q.filter(se=>se.status_novo==="VALIDADA").sort((se,re)=>new Date(re.created_at).getTime()-new Date(se.created_at).getTime())[0];if(!P)return!1;const F=new Date(P.created_at);return Jt(F,"yyyy-MM-dd")===B});return console.log("Devolues filtradas pela data:",Y.length),Y.map(U=>{const{logs_validacao:Q,...P}=U;return P})},W=async()=>{if(!t||t.role!=="VENDEDOR"||!t.vendedor)return[];const{data:j}=await Tt.from("devolucoes").select(`
        *,
        itens:itens_devolucao(*)
      `).eq("vendedor",t.vendedor).eq("resultado","TRATATIVA DE ANULAO").order("data_emissao",{ascending:!1});return j||[]},D=(j,B)=>{if(!t||!t.vendedor)return"";const R=Jt(B,"dd/MM/yyyy",{locale:jr});let X=` *RESUMO: NOTAS VALIDADAS - ${t.vendedor}*

`;return X+=` *DATA DA VALIDAO* ${R}
`,X+=` *USURIO* ${t.name}

`,X+=` *DETALHAMENTO*

`,j.forEach((Y,ee)=>{var Z,se;X+=`============= ${ee+1} NOTA FISCAL =============
`,X+=` *DEVOLUO N* ${Y.numero||"-"}
`,X+=` *Cliente:* ${Y.nome_cliente||"-"}
`,X+=` *Vendedor:* ${Y.vendedor||"-"}
`,X+=` *Data de Emisso:* ${Jt(new Date(Y.data_emissao),"dd/MM/yyyy",{locale:jr})}
`,X+=` *Observao:* ${Y.justificativa||"-"}
`;const U=((Z=Y.itens)==null?void 0:Z.reduce((re,ae)=>re+(Number(ae.valor_total_bruto)||0),0))||Number(Y.valor_total_nota)||0;X+=` *Valor Total da NFD:* R$ ${U.toFixed(2)}
`;const Q=new Date(Y.data_emissao),P=new Date(B),F=Math.floor((P.getTime()-Q.getTime())/(1e3*60*60*24));X+=` *Mdia de Dias p/ Validao:* ${F} dias
`,X+=` *Prazo:* ${F>=3?"VALIDADA COM ATRASO":"DENTRO DO PRAZO"}
`,X+=`-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
`,(se=Y.itens)==null||se.forEach(re=>{var he;const te=(re.descricao||"-").split(" ").slice(0,3).join(" ");X+=` *Produto:* ${te}
`,X+=` *Quantidade:* ${re.quantidade||0} ${re.unidade||"UN"}
`,X+=` *Valor Total:* R$ ${Number(re.valor_total_bruto||0).toFixed(2)}
`,X+=` *Motivo:* ${((he=re.motivo_item)==null?void 0:he.nome)||"-"}
`,X+=`-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
`})}),X},M=j=>{if(!t||!t.vendedor)return"";let B=` *RESUMO: NOTAS EM TRATATIVAS - ${t.vendedor}*

`;return B+=` *DATA DA SINALIZAO* ${Jt(new Date,"dd/MM/yyyy",{locale:jr})}
`,B+=` *USURIO* ${t.name}

`,B+=` *DETALHAMENTO*

`,j.forEach((R,X)=>{var ee,U;B+=`============= ${X+1} NOTA FISCAL =============
`,B+=` *DEVOLUO N* ${R.numero||"-"}
`,B+=` *Cliente:* ${R.nome_cliente||"-"}
`,B+=` *Vendedor:* ${R.vendedor||"-"}
`,B+=` *Data de Emisso:* ${Jt(new Date(R.data_emissao),"dd/MM/yyyy",{locale:jr})}
`;const Y=((ee=R.itens)==null?void 0:ee.reduce((Q,P)=>Q+(Number(P.valor_total_bruto)||0),0))||Number(R.valor_total_nota)||0;B+=` *Valor Total da NFD:* R$ ${Y.toFixed(2)}
`,B+=` *Observao:* ${R.justificativa||"-"}
`,B+=`-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
`,(U=R.itens)==null||U.forEach(Q=>{const F=(Q.descricao||"-").split(" ").slice(0,3).join(" ");B+=` *Produto:* ${F}
`})}),B},C=j=>{const B=encodeURIComponent(j);window.open(`https://api.whatsapp.com/send?text=${B}`,"_blank")},w=async()=>{if(!H){St.error("Selecione uma data");return}const j=await z(H);if(j.length===0){St.error("Nenhuma validao encontrada para esta data");return}const B=D(j,H);C(B),L(!1)},T=async()=>{const j=await W();if(j.length===0){St.error("Nenhuma tratativa encontrada");return}const B=M(j);C(B)},A=async()=>{console.log(" fetchAuditLogs - Iniciando busca de logs para role:",t==null?void 0:t.role);let j=Tt.from("logs_validacao").select("*",{count:"exact",head:!0});r.startDate&&(j=j.gte("created_at",r.startDate.toISOString())),r.endDate&&(j=j.lte("created_at",r.endDate.toISOString()));const{count:B,error:R}=await j;R&&console.error(" Erro ao contar logs:",R),console.log(" Total de logs encontrados:",B),p(B||0);const X=(c-1)*f,Y=X+f-1;let ee=Tt.from("logs_validacao").select(`
            *,
            user:profiles(name, email),
            devolucao:devolucoes(numero, nome_cliente)
        `).order("created_at",{ascending:!1}).range(X,Y);r.startDate&&(ee=ee.gte("created_at",r.startDate.toISOString())),r.endDate&&(ee=ee.lte("created_at",r.endDate.toISOString()));const{data:U,error:Q}=await ee;Q?console.error(" Erro ao buscar logs:",Q):console.log(" Logs carregados:",(U==null?void 0:U.length)||0),l(U||[])},S=async j=>{j.preventDefault(),o(!0);try{const{error:B}=await Tt.auth.updateUser({password:e});if(B)throw B;St.success("Senha atualizada com sucesso!"),n("")}catch(B){St.error(B.message)}finally{o(!1)}};return t?!t.role||t.role==="NOVO"?k.jsxs("div",{className:"space-y-6",children:[k.jsx(Qi,{title:"Meu Perfil",description:"Aguarde a atribuio de permisses por um administrador para acessar os recursos do sistema."}),k.jsx(Dt,{children:k.jsx(Mt,{className:"pt-6",children:k.jsxs("div",{className:"text-center py-12",children:[k.jsx(nx,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground opacity-50"}),k.jsx("p",{className:"text-muted-foreground",children:"Seu perfil est aguardando a atribuio de permisses por um administrador."}),k.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Entre em contato com o administrador do sistema para obter acesso."})]})})})]}):k.jsxs("div",{className:"space-y-6",children:[k.jsx(Qi,{title:t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"?"Painel Administrativo":"Meu Perfil",description:t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"?"Viso geral de todos os dados do sistema, mtricas gerais e KPIs de usurios.":"Visualize suas mtricas pessoais, histrico de validaes e gerencie suas configuraes de segurana."}),k.jsxs("div",{className:"grid gap-6 md:grid-cols-7",children:[k.jsxs(Dt,{className:"md:col-span-2 h-fit",children:[k.jsxs(Rt,{className:"text-center",children:[k.jsx("div",{className:"flex justify-center mb-4",children:k.jsxs(g3,{className:"h-24 w-24 border-4 border-primary/10",children:[k.jsx(v3,{src:t.avatar_url}),k.jsx(b3,{className:"text-2xl font-bold text-primary bg-primary/10",children:t.name.charAt(0).toUpperCase()})]})}),k.jsx(Ft,{children:t.name}),k.jsx(Vr,{children:t.email}),k.jsxs("div",{className:"mt-2 space-y-1",children:[k.jsx(Ia,{variant:"outline",className:"border-primary text-primary",children:t.role||"Sem permisses"}),t.role==="VENDEDOR"&&t.vendedor&&k.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:[k.jsx("div",{className:"font-medium",children:"VENDEDOR"}),k.jsx("div",{className:"text-primary font-semibold",children:t.vendedor})]})]})]}),k.jsx(Mt,{children:k.jsxs("div",{className:"space-y-4 text-sm bg-muted/30 p-4 rounded-lg",children:[k.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[k.jsx(Ip,{className:"h-4 w-4 text-primary"}),k.jsxs("span",{className:"truncate",title:t.id,children:["ID: ",t.id.slice(0,8),"..."]})]}),k.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[k.jsx(GS,{className:"h-4 w-4 text-primary"}),k.jsx("span",{className:"truncate",title:t.email,children:t.email})]}),k.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[k.jsx(nx,{className:"h-4 w-4 text-primary"}),k.jsxs("span",{children:["Acesso: ",t.role]})]})]})})]}),k.jsxs(Dt,{className:"md:col-span-5",children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:"Painel do Usurio"}),k.jsx(Vr,{children:"Suas mtricas e configuraes pessoais"})]}),k.jsx(Mt,{children:k.jsxs(i3,{defaultValue:t.role==="GESTOR"?"security":"overview",children:[k.jsxs(m1,{className:"w-full justify-start",children:[t.role!=="GESTOR"&&k.jsx(Yi,{value:"overview",children:"Viso Geral"}),(t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA")&&k.jsx(Yi,{value:"audit",children:"Histrico de Validaes"}),k.jsx(Yi,{value:"security",children:"Segurana"})]}),k.jsxs(Xi,{value:"overview",className:"space-y-6 mt-6",children:[k.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[k.jsxs(Dt,{className:"bg-primary/5 border-primary/20",children:[k.jsxs(Rt,{className:"pb-2 flex flex-row items-center justify-between",children:[k.jsx(Ft,{className:"text-sm font-medium text-muted-foreground",children:t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"?"Total de Devolues":"Minhas Devolues"}),k.jsx(ek,{className:"h-4 w-4 text-primary"})]}),k.jsxs(Mt,{children:[k.jsx("div",{className:"text-2xl font-bold text-foreground",children:h.myReturnsCount}),k.jsx("p",{className:"text-xs text-muted-foreground",children:"No perodo selecionado"})]})]}),k.jsxs(Dt,{children:[k.jsxs(Rt,{className:"pb-2 flex flex-row items-center justify-between",children:[k.jsx(Ft,{className:"text-sm font-medium text-muted-foreground",children:"Valor Envolvido"}),k.jsx(_u,{className:"h-4 w-4 text-muted-foreground"})]}),k.jsxs(Mt,{children:[k.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",h.totalValue.toLocaleString("pt-BR",{maximumFractionDigits:0})]}),k.jsx("p",{className:"text-xs text-muted-foreground",children:"Total devolvido"})]})]}),k.jsxs(Dt,{children:[k.jsxs(Rt,{className:"pb-2 flex flex-row items-center justify-between",children:[k.jsx(Ft,{className:"text-sm font-medium text-muted-foreground",children:"Taxa de Aprovao"}),k.jsx(Zb,{className:"h-4 w-4 text-muted-foreground"})]}),k.jsxs(Mt,{children:[k.jsxs("div",{className:"text-2xl font-bold",children:[h.approvalRate,"%"]}),k.jsx("p",{className:"text-xs text-muted-foreground",children:"Das devolues finalizadas"})]})]})]}),b.length>0&&k.jsxs(Dt,{children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"?"Devolues no Tempo":"Minhas Devolues no Tempo"}),k.jsx(Vr,{children:t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"?"Evoluo mensal de todas as devolues":"Evoluo mensal das suas devolues"})]}),k.jsx(Mt,{children:k.jsx(Jr,{width:"100%",height:300,children:k.jsxs(d8,{data:b,children:[k.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),k.jsx(dn,{dataKey:"name",className:"text-xs"}),k.jsx(zr,{yAxisId:"left",className:"text-xs"}),k.jsx(zr,{yAxisId:"right",orientation:"right",className:"text-xs",tickFormatter:j=>`R$${j}`}),k.jsx(Qr,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)",color:"var(--foreground)"},formatter:(j,B)=>B==="quantidade"?[j,"Quantidade"]:B==="valor"?[`R$ ${(j||0).toLocaleString("pt-BR")}`,"Valor"]:[j,B||""]}),k.jsx(_y,{}),k.jsx(Xl,{yAxisId:"left",type:"monotone",dataKey:"quantidade",stroke:"#073e29",strokeWidth:2,name:"Quantidade"}),k.jsx(Xl,{yAxisId:"right",type:"monotone",dataKey:"valor",stroke:"#4a9170",strokeWidth:2,name:"Valor (R$)"})]})})})]}),h.myReturnsCount>0&&h.avgCompanyReturns>0&&k.jsxs(Dt,{children:[k.jsx(Rt,{children:k.jsx(Ft,{children:"Comparao com Mdia da Empresa"})}),k.jsxs(Mt,{children:[k.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[k.jsxs("div",{className:"space-y-2",children:[k.jsx("div",{className:"text-sm text-muted-foreground",children:"Seu Ticket Mdio"}),k.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",h.myReturnsCount>0?(h.totalValue/h.myReturnsCount).toLocaleString("pt-BR",{maximumFractionDigits:0}):"0"]})]}),k.jsxs("div",{className:"space-y-2",children:[k.jsx("div",{className:"text-sm text-muted-foreground",children:"Ticket Mdio da Empresa"}),k.jsxs("div",{className:"text-2xl font-bold text-muted-foreground",children:["R$ ",h.avgCompanyTicket.toLocaleString("pt-BR",{maximumFractionDigits:0})]})]})]}),h.myReturnsCount>0&&k.jsx("div",{className:"mt-4 p-3 bg-muted/50 rounded-lg",children:k.jsx("div",{className:"text-sm",children:h.totalValue/h.myReturnsCount>h.avgCompanyTicket?k.jsxs("span",{className:"text-orange-600 dark:text-orange-400",children:[" Seu ticket mdio est ",(h.totalValue/h.myReturnsCount/h.avgCompanyTicket*100-100).toFixed(1),"% acima da mdia da empresa."]}):h.totalValue/h.myReturnsCount<h.avgCompanyTicket?k.jsxs("span",{className:"text-green-600 dark:text-green-400",children:[" Seu ticket mdio est ",(100-h.totalValue/h.myReturnsCount/h.avgCompanyTicket*100).toFixed(1),"% abaixo da mdia da empresa."]}):k.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:" Seu ticket mdio est igual  mdia da empresa."})})})]})]}),k.jsxs("div",{className:"rounded-lg border p-6 bg-card flex items-start gap-4 shadow-sm",children:[k.jsx("div",{className:"p-3 bg-primary/10 rounded-full",children:k.jsx(Zb,{className:"h-6 w-6 text-primary"})}),k.jsxs("div",{children:[k.jsx("h3",{className:"font-semibold text-lg mb-1",children:"Resumo Automtico"}),k.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:x||(h.myReturnsCount>0?`Voc registrou ${h.myReturnsCount} devolues neste perodo, totalizando R$ ${h.totalValue.toLocaleString("pt-BR")}. Sua taxa de aprovao atual  de ${h.approvalRate}%.`:"Nenhuma atividade registrada para o perodo selecionado. Ajuste os filtros acima para ver seu histrico.")})]})]}),t.role==="VENDEDOR"&&t.vendedor&&k.jsxs(Dt,{children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:"Compartilhar Resumos"}),k.jsx(Vr,{children:"Compartilhe seus resumos via WhatsApp"})]}),k.jsx(Mt,{children:k.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[k.jsxs(ri,{open:I,onOpenChange:L,children:[k.jsx(YN,{asChild:!0,children:k.jsxs(Nt,{className:"flex-1",variant:"outline",children:[k.jsx(Fp,{className:"mr-2 h-4 w-4"}),"COMPARTILHAR VALIDAO"]})}),k.jsxs(As,{children:[k.jsxs(Cs,{children:[k.jsx(Os,{children:"Selecione a Data da Validao"}),k.jsx(js,{children:"Escolha a data para gerar o resumo de validaes"})]}),k.jsx("div",{className:"py-4",children:k.jsx(Pw,{mode:"single",selected:H,onSelect:V,className:"rounded-md border"})}),k.jsxs(Ns,{children:[k.jsx(Nt,{variant:"outline",onClick:()=>L(!1),children:"Cancelar"}),k.jsx(Nt,{onClick:w,children:"OK"})]})]})]}),k.jsxs(Nt,{className:"flex-1",variant:"outline",onClick:T,children:[k.jsx(Fp,{className:"mr-2 h-4 w-4"}),"COMPARTILHAR TRATATIVAS"]})]})})]}),(t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA")&&E&&k.jsxs(Dt,{children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:"KPIs de Usurios"}),k.jsx(Vr,{children:"Mtricas de desempenho por usurio"})]}),k.jsx(Mt,{children:k.jsxs("div",{className:"space-y-4",children:[E.usuarios.map((j,B)=>k.jsxs("div",{className:"border rounded-lg p-4",children:[k.jsxs("div",{className:"flex items-center justify-between mb-2",children:[k.jsxs("div",{children:[k.jsx("h4",{className:"font-semibold",children:j.name}),j.role==="VENDEDOR"&&j.vendedor&&k.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[k.jsx("span",{className:"font-medium",children:"VENDEDOR:"})," ",k.jsx("span",{className:"text-primary font-semibold",children:j.vendedor})]})]}),k.jsx(Ia,{variant:"outline",children:j.role})]}),k.jsxs("div",{className:"grid gap-2 md:grid-cols-3 text-sm",children:[j.role==="VENDEDOR"&&k.jsxs(k.Fragment,{children:[k.jsxs("div",{children:[k.jsx("span",{className:"text-muted-foreground",children:"Mdia Tempo Validao:"}),k.jsxs("span",{className:"ml-2 font-semibold",children:[j.tempoMedioValidacao," dias"]})]}),k.jsxs("div",{children:[k.jsx("span",{className:"text-muted-foreground",children:"Total Validaes:"}),k.jsx("span",{className:"ml-2 font-semibold",children:j.totalValidacoes})]}),k.jsxs("div",{children:[k.jsx("span",{className:"text-muted-foreground",children:"Dias em Atraso:"}),k.jsxs("span",{className:`ml-2 font-semibold ${j.diasAtraso>=3?"text-red-600":"text-green-600"}`,children:[j.diasAtraso," dias"]})]}),k.jsxs("div",{children:[k.jsx("span",{className:"text-muted-foreground",children:"Notas Pendentes:"}),k.jsx("span",{className:"ml-2 font-semibold",children:j.notasPendentes||0})]}),k.jsxs("div",{children:[k.jsx("span",{className:"text-muted-foreground",children:"Notas em Cancelamento:"}),k.jsx("span",{className:"ml-2 font-semibold",children:j.notasCancelamento||0})]})]}),j.role==="LOGISTICA"&&k.jsxs(k.Fragment,{children:[k.jsxs("div",{children:[k.jsx("span",{className:"text-muted-foreground",children:"Mdia Tempo Lanamento:"}),k.jsxs("span",{className:"ml-2 font-semibold",children:[j.tempoMedioLancamento," dias"]})]}),k.jsxs("div",{children:[k.jsx("span",{className:"text-muted-foreground",children:"Total Lanamentos:"}),k.jsx("span",{className:"ml-2 font-semibold",children:j.totalLancamentos})]})]})]})]},B)),E.usuarios.length===0&&k.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhum usurio VENDEDOR ou LOGISTICA encontrado."})]})})]})]}),k.jsxs(Xi,{value:"audit",className:"mt-6",children:[k.jsx("div",{className:"rounded-md border",children:k.jsxs(Ua,{children:[k.jsx(os,{children:k.jsxs(Nr,{children:[k.jsx(jt,{children:"Data"}),k.jsx(jt,{children:"Usurio"}),k.jsx(jt,{children:"Nota Fiscal"}),k.jsx(jt,{children:"Ao"}),k.jsx(jt,{children:"Status Anterior"})]})}),k.jsx(za,{children:s&&s.length>0?s.map(j=>{var B,R,X;return k.jsxs(Nr,{children:[k.jsx(Kt,{className:"text-xs",children:Jt(new Date(j.created_at),"dd/MM/yyyy HH:mm")}),k.jsx(Kt,{className:"font-medium",children:((B=j.user)==null?void 0:B.name)||"Sistema"}),k.jsx(Kt,{children:((R=j.devolucao)==null?void 0:R.numero)||((X=j.devolucao_id)==null?void 0:X.slice(0,8))||"-"}),k.jsx(Kt,{children:k.jsx(Ia,{variant:j.acao==="SELECIONAR_MOTIVO"||j.status_novo==="VALIDADA"?"default":j.status_novo==="TRATATIVA DE ANULAO"?"destructive":"secondary",children:j.acao==="SELECIONAR_MOTIVO"?"Validou":j.acao==="ALTERAR_RESULTADO"?"Alterou Resultado":j.acao||"Ao"})}),k.jsxs(Kt,{className:"text-muted-foreground text-xs",children:[j.status_anterior,"  ",j.status_novo]})]},j.id)}):k.jsx(Nr,{children:k.jsxs(Kt,{colSpan:5,className:"text-center py-12 text-muted-foreground",children:[k.jsx(BS,{className:"h-10 w-10 mx-auto mb-3 opacity-20"}),k.jsx("p",{children:"Nenhum registro de validao encontrado."}),(t==null?void 0:t.role)==="COMERCIAL"||(t==null?void 0:t.role)==="LOGISTICA"?k.jsx("p",{className:"text-xs mt-2",children:"Carregando dados..."}):null]})})})]})}),u>0&&k.jsxs("div",{className:"flex items-center justify-between px-2 py-4 border-t",children:[k.jsx("div",{className:"text-sm text-muted-foreground",children:u>f?k.jsxs(k.Fragment,{children:["Mostrando ",(c-1)*f+1," a ",Math.min(c*f,u)," de ",u," registros"]}):k.jsxs(k.Fragment,{children:["Total de ",u," registro(s)"]})}),u>f&&k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsxs(Nt,{variant:"outline",size:"sm",onClick:()=>{i(j=>Math.max(1,j-1))},disabled:c===1,children:[k.jsx(yu,{className:"h-4 w-4"}),"Anterior"]}),k.jsxs("div",{className:"text-sm text-muted-foreground",children:["Pgina ",c," de ",Math.ceil(u/f)]}),k.jsxs(Nt,{variant:"outline",size:"sm",onClick:()=>{i(j=>{const B=Math.ceil(u/f);return Math.min(B,j+1)})},disabled:c>=Math.ceil(u/f),children:["Prxima",k.jsx(wu,{className:"h-4 w-4"})]})]})]})]}),k.jsx(Xi,{value:"security",className:"mt-6",children:k.jsxs(Dt,{children:[k.jsxs(Rt,{children:[k.jsx(Ft,{children:"Alterar Senha"}),k.jsx(Vr,{children:"Escolha uma senha forte para proteger sua conta."})]}),k.jsx(Mt,{children:k.jsxs("form",{onSubmit:S,className:"space-y-4 max-w-md",children:[k.jsxs("div",{className:"space-y-2",children:[k.jsx(Er,{htmlFor:"new-password",children:"Nova Senha"}),k.jsx(wr,{id:"new-password",type:"password",value:e,onChange:j=>n(j.target.value),placeholder:"Mnimo de 6 caracteres",minLength:6})]}),k.jsx(Nt,{type:"submit",disabled:a||!e,children:a?"Atualizando...":"Atualizar Senha"})]})})]})})]})})]})]})]}):null}function DB(){const{user:t,logout:r}=Dn();return console.log("EmptyPage - Renderizando para usurio:",t==null?void 0:t.email,"role:",t==null?void 0:t.role),t?k.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background",children:k.jsxs(Dt,{className:"w-full max-w-md",children:[k.jsxs(Rt,{className:"text-center",children:[k.jsx(Ft,{className:"text-2xl",children:"Acesso Pendente"}),k.jsx(Vr,{children:"Seu cadastro est aguardando aprovao. Entre em contato com o administrador para obter acesso ao sistema."})]}),k.jsxs(Mt,{className:"space-y-4",children:[k.jsxs("div",{className:"text-center space-y-2",children:[k.jsxs("p",{className:"text-sm text-muted-foreground",children:["Usurio: ",k.jsx("span",{className:"font-semibold",children:t==null?void 0:t.email})]}),k.jsxs("p",{className:"text-sm text-muted-foreground",children:["Status: ",k.jsx("span",{className:"font-semibold text-orange-600",children:"NOVO"})]})]}),k.jsxs(Nt,{variant:"destructive",className:"w-full",onClick:r,children:[k.jsx(Mp,{className:"mr-2 h-4 w-4"}),"Sair"]})]})]})}):k.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background",children:k.jsx("div",{className:"text-center",children:k.jsx("p",{className:"text-muted-foreground",children:"Carregando..."})})})}function MB({className:t,isOpen:r=!1,onClose:e}){const{user:n,logout:a}=Dn(),o=vy(),s=()=>{const p=document.querySelector("html");p&&(p.classList.contains("dark")?p.classList.remove("dark"):p.classList.add("dark"))};if(!n)return null;console.log("Sidebar - User role:",n.role,"Tipo:",typeof n.role);const l=[{label:"Dashboard Pendncias",icon:ex,href:"/dashboard",roles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"]},{label:"Dashboard Lanadas",icon:ex,href:"/dashboard-lancadas",roles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"]},{label:"Validao",icon:_f,href:"/validation",roles:["COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"]},{label:"Relatrios",icon:DS,href:"/reports",roles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"]},{label:"Sincronizao",icon:vm,href:"/sync",roles:["LOGISTICA","ADMIN"]},{label:"Configuraes",icon:uk,href:"/settings",roles:["ADMIN"]}],c=!n.role||n.role==="NOVO",i=typeof n.role=="string"?n.role.toUpperCase():n.role;console.log("Sidebar - Filtrando rotas com role:",i);const u=c?[]:l.filter(p=>p.roles.includes(i));return console.log("Sidebar - Rotas filtradas:",u.map(p=>p.label)),k.jsxs(k.Fragment,{children:[k.jsxs("div",{className:At("hidden lg:flex pb-12 w-64 border-r bg-card h-screen fixed left-0 top-0 z-30 shadow-lg flex-col dark:border-r-zinc-800 transition-transform duration-300 ease-in-out",r?"translate-x-0":"-translate-x-full",t),onClick:p=>p.stopPropagation(),children:[k.jsxs("div",{className:"px-6 py-8 flex flex-col items-center border-b border-border/50",children:[k.jsx("div",{className:"h-24 w-24 relative mb-3 flex items-center justify-center overflow-hidden",children:k.jsx("img",{src:"https://i.ibb.co/b095hpJ/Chat-GPT-Image-25-de-dez-de-2025-15-24-45.png",alt:"Logo Doce Mel",className:"object-contain rounded"})}),k.jsx("h2",{className:"text-xl font-bold tracking-tight text-primary font-serif",children:"TRIELO CD BA"}),k.jsx("p",{className:"text-[10px] text-muted-foreground uppercase tracking-widest mt-1",children:"Gesto de Devolues"})]}),!c&&k.jsx("div",{className:"flex-1 overflow-y-auto py-4 px-3",children:k.jsx("div",{className:"space-y-1",children:u.map(p=>k.jsx(af,{to:p.href,children:k.jsxs(Nt,{variant:o.pathname===p.href?"secondary":"ghost",className:At("w-full justify-start transition-all duration-200 mb-1",o.pathname===p.href?"bg-primary/10 text-primary font-bold border-r-4 border-primary rounded-r-none dark:text-primary dark:bg-primary/20":"hover:bg-muted text-muted-foreground hover:text-foreground"),children:[k.jsx(p.icon,{className:At("mr-3 h-4 w-4",o.pathname===p.href?"text-primary":"text-muted-foreground")}),p.label]})},p.href))})}),k.jsxs("div",{className:"p-4 border-t border-border/50 bg-muted/10",children:[!c&&k.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[k.jsx("span",{className:"text-xs font-semibold text-muted-foreground",children:"Tema"}),k.jsxs(Nt,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:s,children:[k.jsx(ix,{className:"h-4 w-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),k.jsx(tx,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"})]})]}),k.jsxs("div",{className:"space-y-1 mb-4",children:[!c&&k.jsx(af,{to:"/profile",children:k.jsxs(Nt,{variant:o.pathname==="/profile"?"secondary":"ghost",className:"w-full justify-start h-9",children:[k.jsx(Ip,{className:"mr-2 h-4 w-4"}),"Perfil"]})}),k.jsxs(Nt,{variant:"ghost",className:"w-full justify-start text-destructive hover:text-destructive hover:bg-destructive/10 h-9",onClick:a,children:[k.jsx(Mp,{className:"mr-2 h-4 w-4"}),"Sair"]})]}),k.jsxs("div",{className:"flex items-center gap-3 px-2 py-2 rounded-lg bg-card border shadow-sm",children:[k.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/20 flex items-center justify-center text-primary font-bold text-xs",children:n.name.charAt(0).toUpperCase()}),k.jsxs("div",{className:"flex-1 overflow-hidden",children:[k.jsx("p",{className:"text-sm font-bold truncate text-foreground leading-none",children:n.name}),k.jsx("p",{className:"text-[10px] text-muted-foreground mt-1 truncate",children:n.role})]})]})]})]}),k.jsxs("div",{className:At("lg:hidden pb-12 w-64 border-r bg-card h-screen fixed left-0 top-0 z-40 shadow-lg flex flex-col dark:border-r-zinc-800 transition-transform duration-300 ease-in-out",r?"translate-x-0":"-translate-x-full",t),onClick:p=>p.stopPropagation(),children:[k.jsxs("div",{className:"px-6 py-8 flex flex-col items-center border-b border-border/50 relative",children:[k.jsx(Nt,{variant:"ghost",size:"icon",className:"absolute top-4 right-4",onClick:e,children:k.jsx(Vf,{className:"h-5 w-5"})}),k.jsx("div",{className:"h-24 w-24 relative mb-3 flex items-center justify-center overflow-hidden",children:k.jsx("img",{src:"https://i.ibb.co/b095hpJ/Chat-GPT-Image-25-de-dez-de-2025-15-24-45.png",alt:"Logo Doce Mel",className:"object-contain rounded"})}),k.jsx("h2",{className:"text-xl font-bold tracking-tight text-foreground font-serif",children:"TRIELO CD BA"}),k.jsx("p",{className:"text-[10px] text-muted-foreground uppercase tracking-widest mt-1",children:"Gesto de Devolues"})]}),!c&&k.jsx("div",{className:"flex-1 overflow-y-auto py-4 px-3",children:k.jsx("div",{className:"space-y-1",children:u.map(p=>k.jsx(af,{to:p.href,onClick:e,children:k.jsxs(Nt,{variant:o.pathname===p.href?"secondary":"ghost",className:At("w-full justify-start transition-all duration-200 mb-1",o.pathname===p.href?"bg-primary/10 text-primary font-bold border-r-4 border-primary rounded-r-none dark:text-primary dark:bg-primary/20":"hover:bg-muted text-muted-foreground hover:text-foreground"),children:[k.jsx(p.icon,{className:At("mr-3 h-4 w-4",o.pathname===p.href?"text-primary":"text-muted-foreground")}),p.label]})},p.href))})}),k.jsxs("div",{className:"p-4 border-t border-border/50 bg-muted/10",children:[!c&&k.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[k.jsx("span",{className:"text-xs font-semibold text-muted-foreground",children:"Tema"}),k.jsxs(Nt,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:s,children:[k.jsx(ix,{className:"h-4 w-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),k.jsx(tx,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"})]})]}),k.jsxs("div",{className:"space-y-1 mb-4",children:[!c&&k.jsx(af,{to:"/profile",onClick:e,children:k.jsxs(Nt,{variant:o.pathname==="/profile"?"secondary":"ghost",className:"w-full justify-start h-9",children:[k.jsx(Ip,{className:"mr-2 h-4 w-4"}),"Perfil"]})}),k.jsxs(Nt,{variant:"ghost",className:"w-full justify-start text-destructive hover:text-destructive hover:bg-destructive/10 h-9",onClick:a,children:[k.jsx(Mp,{className:"mr-2 h-4 w-4"}),"Sair"]})]}),k.jsxs("div",{className:"flex items-center gap-3 px-2 py-2 rounded-lg bg-card border shadow-sm",children:[k.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/20 flex items-center justify-center text-primary font-bold text-xs",children:n.name.charAt(0).toUpperCase()}),k.jsxs("div",{className:"flex-1 overflow-hidden",children:[k.jsx("p",{className:"text-sm font-bold truncate text-foreground leading-none",children:n.name}),k.jsx("p",{className:"text-[10px] text-muted-foreground mt-1 truncate",children:n.role})]})]})]})]})]})}function RB(){const{user:t}=Dn(),r=!(t!=null&&t.role)||t.role==="NOVO",[e,n]=ye.useState(!r),a=()=>{n(!e)},o=()=>{n(!1)};return k.jsxs("div",{className:"flex h-screen bg-background relative",children:[e&&!r&&k.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:o}),!r&&k.jsx(Nt,{variant:"ghost",size:"icon",className:"fixed top-4 left-4 z-50",onClick:a,children:e?k.jsx(Vf,{className:"h-6 w-6"}):k.jsx(KS,{className:"h-6 w-6"})}),k.jsx(MB,{isOpen:e,onClose:o}),k.jsx("main",{className:`flex-1 overflow-y-auto transition-all duration-300 ${!r&&e?"lg:ml-64":"lg:ml-0"} ${r?"":"pt-16 lg:pt-0"}`,onClick:()=>{e&&!r&&o()},children:k.jsx("div",{className:r?"":"p-4 lg:p-6",children:k.jsx(a8,{})})})]})}var FB=(t,r,e,n,a,o,s,l)=>{let c=document.documentElement,i=["light","dark"];function u(h){(Array.isArray(t)?t:[t]).forEach(v=>{let b=v==="class",g=b&&o?a.map(x=>o[x]||x):a;b?(c.classList.remove(...g),c.classList.add(o&&o[h]?o[h]:h)):c.setAttribute(v,h)}),p(h)}function p(h){l&&i.includes(h)&&(c.style.colorScheme=h)}function f(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(n)u(n);else try{let h=localStorage.getItem(r)||e,v=s&&h==="system"?f():h;u(v)}catch{}},IB=ye.createContext(void 0),PB={setTheme:t=>{},themes:[]},LB=()=>{var t;return(t=ye.useContext(IB))!=null?t:PB};ye.memo(({forcedTheme:t,storageKey:r,attribute:e,enableSystem:n,enableColorScheme:a,defaultTheme:o,value:s,themes:l,nonce:c,scriptProps:i})=>{let u=JSON.stringify([e,r,o,t,l,s,n,a]).slice(1,-1);return ye.createElement("script",{...i,suppressHydrationWarning:!0,nonce:typeof window>"u"?c:"",dangerouslySetInnerHTML:{__html:`(${FB.toString()})(${u})`}})});const BB=({...t})=>{const{theme:r="system"}=LB();return k.jsx(DN,{theme:r,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};function UB(){return k.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background",children:k.jsxs("div",{className:"max-w-md p-8 space-y-4 text-center",children:[k.jsx("div",{className:"text-destructive",children:k.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:k.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),k.jsx("h1",{className:"text-2xl font-bold",children:"Erro de Configurao"}),k.jsx("p",{className:"text-muted-foreground",children:"As variveis de ambiente do Supabase no esto configuradas."}),k.jsxs("p",{className:"text-sm text-muted-foreground",children:["Crie um arquivo ",k.jsx("code",{className:"px-2 py-1 bg-muted rounded",children:".env"})," na raiz do projeto com:"]}),k.jsx("pre",{className:"p-4 text-left bg-muted rounded-lg text-sm",children:`VITE_SUPABASE_URL=sua_url_aqui
VITE_SUPABASE_ANON_KEY=sua_chave_aqui`}),k.jsx("p",{className:"text-sm text-muted-foreground",children:"Aps configurar, reinicie o servidor de desenvolvimento."})]})})}function ty({children:t,allowNovo:r=!1}){const{user:e,isLoading:n}=Dn(),a=vy();return console.log("ProtectedRoute - isLoading:",n,"user:",e==null?void 0:e.email,"location:",a.pathname),n?k.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[k.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"}),k.jsx("p",{className:"ml-4 text-sm text-muted-foreground",children:"Carregando..."})]}):e?r?k.jsx(k.Fragment,{children:t}):(!e.role||e.role==="NOVO")&&a.pathname!=="/empty"?(console.log("ProtectedRoute - Redirecionando usurio NOVO para /empty"),k.jsx(Io,{to:"/empty",replace:!0})):k.jsx(k.Fragment,{children:t}):(console.log("ProtectedRoute - Redirecionando para /login"),k.jsx(Io,{to:"/login",replace:!0}))}function zB(){const{user:t,isLoading:r}=Dn();return r?k.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[k.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"}),k.jsx("p",{className:"ml-4 text-sm text-muted-foreground",children:"Carregando..."})]}):!(t!=null&&t.role)||t.role==="NOVO"?k.jsx(Io,{to:"/empty",replace:!0}):k.jsx(Io,{to:"/dashboard",replace:!0})}function Ml({children:t,allowedRoles:r}){const{user:e,isLoading:n}=Dn();if(n)return k.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[k.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"}),k.jsx("p",{className:"ml-4 text-sm text-muted-foreground",children:"Carregando..."})]});if(!e)return k.jsx(Io,{to:"/login",replace:!0});if(!e.role||e.role==="NOVO")return console.warn(` Acesso negado: usurio ${e.email} (${e.role||"sem role"}) tentou acessar rota protegida`),k.jsx(Io,{to:"/empty",replace:!0});const a=typeof e.role=="string"?e.role.toUpperCase():e.role;return r.includes(a)?k.jsx(k.Fragment,{children:t}):(console.warn(` Acesso negado: usurio ${e.email} (${a}) tentou acessar rota permitida apenas para:`,r),k.jsx(Io,{to:"/profile",replace:!0}))}function $B(){const{setUser:t,setIsLoading:r}=Dn(),[e,n]=ye.useState(!1);return ye.useEffect(()=>{let a=!0;console.log(" App - Inicializando autenticao...");const o=setTimeout(()=>{a&&(console.warn(" Timeout de segurana - forando setIsLoading(false)"),r(!1))},15e3),s=async(c,i)=>{var h,v,b;console.log(" Carregando perfil para:",i,"userId:",c);const p=Dn.getState().user;if(p&&p.id===c&&p.role&&p.role!=="NOVO")return console.log(" Usando perfil em cache:",p.role),p;try{const g=Date.now(),x=Tt.from("profiles").select("id, email, name, role, vendedor").eq("id",c).maybeSingle(),y=new Promise((H,V)=>{setTimeout(()=>V(new Error("Query timeout aps 8 segundos")),8e3)});let E;try{E=await Promise.race([x,y])}catch(H){throw console.warn(" Query timeout, continuando com fallback..."),H}const{data:N,error:I}=E,L=Date.now()-g;if(console.log(` Query executada em ${L}ms`,{hasData:!!N,error:I==null?void 0:I.message}),N&&!I){let H="NOVO";if(N.role){const q=String(N.role).trim().toUpperCase();console.log(" Role processado:",q),["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR","NOVO"].includes(q)?H=q:(console.warn(" Role invlido no banco:",q,"- usando NOVO"),H="NOVO")}else console.warn(" Role est vazio no banco - usando NOVO"),H="NOVO";const V={id:N.id,email:i,name:N.name||i.split("@")[0],role:H,vendedor:N.vendedor||null};console.log(" Perfil carregado do banco:",V);try{const q={...V,_cacheTime:Date.now()};localStorage.setItem(`profile_${c}`,JSON.stringify(q))}catch(q){console.warn(" Erro ao salvar perfil no localStorage:",q)}return V}else console.warn(" Sem dados do perfil no banco. Erro:",I)}catch(g){console.warn(" Erro na query do banco, tentando fallback...",(g==null?void 0:g.message)||g)}try{console.log(" Tentando fallback 1: metadata do auth...");const{data:g,error:x}=await Tt.auth.getUser();if(!x&&(g!=null&&g.user)){const y=(h=g.user.user_metadata)==null?void 0:h.role,E=y&&["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR","NOVO"].includes(String(y).toUpperCase())?String(y).toUpperCase():"NOVO",N={id:c,email:i,name:((v=g.user.user_metadata)==null?void 0:v.name)||i.split("@")[0],role:E,vendedor:((b=g.user.user_metadata)==null?void 0:b.vendedor)||null};return console.log(" Usando fallback (metadata):",N),N}else console.warn(" Metadata retornou erro ou sem dados:",x)}catch(g){console.warn(" Erro ao buscar metadata:",g)}const f={id:c,email:i,name:i.split("@")[0],role:"NOVO",vendedor:null};return console.log(" Usando fallback final (NOVO) - query do banco falhou:",f),f},{data:{subscription:l}}=Tt.auth.onAuthStateChange(async(c,i)=>{var u;if(console.log(" Auth mudou:",c,(u=i==null?void 0:i.user)==null?void 0:u.email),!!a){if(c==="TOKEN_REFRESHED"){console.log(" Token renovado - mantendo perfil atual");return}if(c!=="SIGNED_IN"&&c!=="SIGNED_OUT"&&c!=="USER_UPDATED"){console.log(" Evento ignorado:",c);return}try{if(i!=null&&i.user){const f=Dn.getState().user;if(f&&f.id===i.user.id&&c!=="USER_UPDATED"){console.log(" Usurio j carregado, mantendo perfil atual:",f.role),a&&r(!1);return}const h=s(i.user.id,i.user.email),v=new Promise(g=>{setTimeout(()=>{const x={id:i.user.id,email:i.user.email,name:i.user.email.split("@")[0],role:"NOVO",vendedor:null};console.log(" Timeout no loadProfile - usando perfil mnimo:",x),g(x)},1e4)}),b=await Promise.race([h,v]);a&&b&&(console.log(" Usurio setado:",{email:b.email,role:b.role,name:b.name,id:b.id,vendedor:b.vendedor}),t(b))}else a&&(console.log(" Sem sesso"),t(null))}catch(p){if(console.error(" Erro no listener de auth:",p),a&&(i!=null&&i.user)){const f={id:i.user.id,email:i.user.email,name:i.user.email.split("@")[0],role:"NOVO",vendedor:null};console.log(" Usando perfil mnimo devido a erro:",f),t(f)}else t(null)}finally{a&&r(!1)}}});return Tt.auth.getSession().then(async({data:{session:c}})=>{if(a)try{if(c!=null&&c.user){console.log(" Sesso encontrada:",c.user.email);const u=Dn.getState().user;if(u&&u.id===c.user.id&&u.role&&u.role!=="NOVO"){console.log(" Usando perfil do store (cache):",u.role),r(!1),clearTimeout(o),s(c.user.id,c.user.email).then(f=>{f&&a&&t(f)}).catch(f=>{console.warn(" Erro ao atualizar perfil em background:",f)});return}try{const f=localStorage.getItem(`profile_${c.user.id}`);if(f){const h=JSON.parse(f),v=h._cacheTime||0,g=Date.now()-v,x=24*60*60*1e3;if(g<x&&h.role&&h.role!=="NOVO"){const{_cacheTime:y,...E}=h;console.log(" Usando perfil do localStorage:",E.role),t(E),r(!1),clearTimeout(o),s(c.user.id,c.user.email).then(N=>{N&&a&&t(N)}).catch(N=>{console.warn(" Erro ao atualizar perfil em background:",N)});return}else console.log(" Cache expirado ou invlido, buscando do banco..."),localStorage.removeItem(`profile_${c.user.id}`)}}catch(f){console.warn(" Erro ao ler cache do localStorage:",f)}const p=await s(c.user.id,c.user.email);if(a&&p){console.log(" Setando usurio inicial:",{email:p.email,role:p.role,name:p.name,vendedor:p.vendedor});try{const f={...p,_cacheTime:Date.now()};localStorage.setItem(`profile_${c.user.id}`,JSON.stringify(f))}catch(f){console.warn(" Erro ao salvar no localStorage:",f)}t(p),r(!1),clearTimeout(o)}}else console.log(" Sem sesso inicial"),a&&(t(null),r(!1),clearTimeout(o))}catch(i){if(console.error(" Erro ao carregar sesso inicial:",i),a&&(c!=null&&c.user)){const p=Dn.getState().user;if(p&&p.id===c.user.id&&p.role&&p.role!=="NOVO"){console.log(" Usando perfil do store devido a erro:",p.role),r(!1),clearTimeout(o);return}try{const h=localStorage.getItem(`profile_${c.user.id}`);if(h){const v=JSON.parse(h),{_cacheTime:b,...g}=v;if(g.role&&g.role!=="NOVO"){console.log(" Usando perfil do cache devido a erro:",g.role),t(g),r(!1),clearTimeout(o);return}}}catch(h){console.warn(" Erro ao ler cache em fallback:",h)}const f={id:c.user.id,email:c.user.email,name:c.user.email.split("@")[0],role:"NOVO",vendedor:null};console.log(" Usando perfil mnimo devido a erro (sem cache vlido):",f),t(f),r(!1),clearTimeout(o)}else t(null),r(!1),clearTimeout(o)}}).catch(c=>{console.error(" Erro ao verificar sesso:",c),a&&(t(null),r(!1),clearTimeout(o))}),()=>{console.log(" Cleanup"),a=!1,clearTimeout(o),l.unsubscribe()}},[t,r]),e?k.jsx(UB,{}):k.jsxs(s8,{children:[k.jsxs(i8,{children:[k.jsx(Za,{path:"/login",element:k.jsx(qN,{})}),k.jsx(Za,{path:"/empty",element:k.jsx(ty,{allowNovo:!0,children:k.jsx(DB,{})})}),k.jsxs(Za,{path:"/",element:k.jsx(ty,{children:k.jsx(RB,{})}),children:[k.jsx(Za,{index:!0,element:k.jsx(zB,{})}),k.jsx(Za,{path:"dashboard",element:k.jsx(Ml,{allowedRoles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"],children:k.jsx(FN,{})})}),k.jsx(Za,{path:"dashboard-lancadas",element:k.jsx(Ml,{allowedRoles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"],children:k.jsx(LN,{})})}),k.jsx(Za,{path:"validation",element:k.jsx(Ml,{allowedRoles:["COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"],children:k.jsx(sB,{})})}),k.jsx(Za,{path:"reports",element:k.jsx(Ml,{allowedRoles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"],children:k.jsx(tO,{})})}),k.jsx(Za,{path:"sync",element:k.jsx(Ml,{allowedRoles:["LOGISTICA","ADMIN"],children:k.jsx(nB,{})})}),k.jsx(Za,{path:"settings",element:k.jsx(Ml,{allowedRoles:["ADMIN","LOGISTICA"],children:k.jsx(wB,{})})}),k.jsx(Za,{path:"profile",element:k.jsx(jB,{})})]})]}),k.jsx(BB,{})]})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log(" Service Worker registrado com sucesso:",t.scope)}).catch(t=>{console.warn(" Falha ao registrar Service Worker:",t)})});b8.createRoot(document.getElementById("root")).render(k.jsx($B,{}));
