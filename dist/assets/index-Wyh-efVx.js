import{j as _,c as ry,T as ny,I as x5,S as ay,a as sy,P as y5,C as iy,V as w5,L as oy,b as ly,d as _5,e as S5,f as cy,R as k5,g as E5,h as Uf,u as Bu,i as T5,k as A5,o as C5,s as N5,l as j5,m as O5,n as D5,p as R5,q as M5,r as F5,t as dm,v as xu,w as Rs,x as I5,y as fm,z as P5,A as L5,B as B5,D as ca,E as U5,F as z5,G as $5,H as hm,J as pm,_ as V5,K as zf,M as H5,N as q5,O as uy,Q as dy,U as W5,W as fy,X as G5,Y as hy,Z as Y5,$ as py,a0 as my,a1 as X5,a2 as K5,a3 as Z5,a4 as gy}from"./ui-vendor-C68SU9xL.js";import{d as J5,e as Q5,r as _e,R as Ze,b as e8,c as t8,u as r8,f as ur,g as n8,h as vy,L as af,O as a8,B as s8,i as i8,j as Qa,N as Io}from"./react-vendor-D3tagoQh.js";import{c as by,R as Jr,A as xy,C as un,X as dn,Y as $r,T as Qr,a as yy,L as Xl,B as Xn,b as jn,d as Pn,e as wy,P as o8,f as l8,g as c8,h as _y,r as u8,i as d8}from"./chart-vendor-9iNHXFEB.js";import{_ as f8,E as h8,a as sf}from"./pdf-vendor-CXTw4Jop.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function e(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=e(a);fetch(a.href,o)}})();var Q0={exports:{}},Jc={},ep={exports:{}},tp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ub;function p8(){return Ub||(Ub=1,function(t){function r(w,E){var A=w.length;w.push(E);e:for(;0<A;){var T=A-1>>>1,D=w[T];if(0<a(D,E))w[T]=E,w[A]=D,A=T;else break e}}function e(w){return w.length===0?null:w[0]}function n(w){if(w.length===0)return null;var E=w[0],A=w.pop();if(A!==E){w[0]=A;e:for(var T=0,D=w.length,U=D>>>1;T<U;){var P=2*(T+1)-1,K=w[P],Y=P+1,re=w[Y];if(0>a(K,A))Y<D&&0>a(re,K)?(w[T]=re,w[Y]=A,T=Y):(w[T]=K,w[P]=A,T=P);else if(Y<D&&0>a(re,A))w[T]=re,w[Y]=A,T=Y;else break e}}return E}function a(w,E){var A=w.sortIndex-E.sortIndex;return A!==0?A:w.id-E.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],i=[],u=1,p=null,f=3,h=!1,v=!1,b=!1,g=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function N(w){for(var E=e(i);E!==null;){if(E.callback===null)n(i);else if(E.startTime<=w)n(i),E.sortIndex=E.expirationTime,r(c,E);else break;E=e(i)}}function F(w){if(b=!1,N(w),!v)if(e(c)!==null)v=!0,B||(B=!0,H());else{var E=e(i);E!==null&&C(F,E.startTime-w)}}var B=!1,W=-1,V=5,q=-1;function X(){return g?!0:!(t.unstable_now()-q<V)}function I(){if(g=!1,B){var w=t.unstable_now();q=w;var E=!0;try{e:{v=!1,b&&(b=!1,y(W),W=-1),h=!0;var A=f;try{t:{for(N(w),p=e(c);p!==null&&!(p.expirationTime>w&&X());){var T=p.callback;if(typeof T=="function"){p.callback=null,f=p.priorityLevel;var D=T(p.expirationTime<=w);if(w=t.unstable_now(),typeof D=="function"){p.callback=D,N(w),E=!0;break t}p===e(c)&&n(c),N(w)}else n(c);p=e(c)}if(p!==null)E=!0;else{var U=e(i);U!==null&&C(F,U.startTime-w),E=!1}}break e}finally{p=null,f=A,h=!1}E=void 0}}finally{E?H():B=!1}}}var H;if(typeof k=="function")H=function(){k(I)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,R=O.port2;O.port1.onmessage=I,H=function(){R.postMessage(null)}}else H=function(){x(I,0)};function C(w,E){W=x(function(){w(t.unstable_now())},E)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(w){w.callback=null},t.unstable_forceFrameRate=function(w){0>w||125<w?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<w?Math.floor(1e3/w):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(w){switch(f){case 1:case 2:case 3:var E=3;break;default:E=f}var A=f;f=E;try{return w()}finally{f=A}},t.unstable_requestPaint=function(){g=!0},t.unstable_runWithPriority=function(w,E){switch(w){case 1:case 2:case 3:case 4:case 5:break;default:w=3}var A=f;f=w;try{return E()}finally{f=A}},t.unstable_scheduleCallback=function(w,E,A){var T=t.unstable_now();switch(typeof A=="object"&&A!==null?(A=A.delay,A=typeof A=="number"&&0<A?T+A:T):A=T,w){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=A+D,w={id:u++,callback:E,priorityLevel:w,startTime:A,expirationTime:D,sortIndex:-1},A>T?(w.sortIndex=A,r(i,w),e(c)===null&&w===e(i)&&(b?(y(W),W=-1):b=!0,C(F,A-T))):(w.sortIndex=D,r(c,w),v||h||(v=!0,B||(B=!0,H()))),w},t.unstable_shouldYield=X,t.unstable_wrapCallback=function(w){var E=f;return function(){var A=f;f=E;try{return w.apply(this,arguments)}finally{f=A}}}}(tp)),tp}var zb;function m8(){return zb||(zb=1,ep.exports=p8()),ep.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $b;function g8(){if($b)return Jc;$b=1;var t=m8(),r=J5(),e=Q5();function n(d){var m="https://react.dev/errors/"+d;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var S=2;S<arguments.length;S++)m+="&args[]="+encodeURIComponent(arguments[S])}return"Minified React error #"+d+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function o(d){var m=d,S=d;if(d.alternate)for(;m.return;)m=m.return;else{d=m;do m=d,(m.flags&4098)!==0&&(S=m.return),d=m.return;while(d)}return m.tag===3?S:null}function s(d){if(d.tag===13){var m=d.memoizedState;if(m===null&&(d=d.alternate,d!==null&&(m=d.memoizedState)),m!==null)return m.dehydrated}return null}function l(d){if(o(d)!==d)throw Error(n(188))}function c(d){var m=d.alternate;if(!m){if(m=o(d),m===null)throw Error(n(188));return m!==d?null:d}for(var S=d,j=m;;){var G=S.return;if(G===null)break;var J=G.alternate;if(J===null){if(j=G.return,j!==null){S=j;continue}break}if(G.child===J.child){for(J=G.child;J;){if(J===S)return l(G),d;if(J===j)return l(G),m;J=J.sibling}throw Error(n(188))}if(S.return!==j.return)S=G,j=J;else{for(var oe=!1,me=G.child;me;){if(me===S){oe=!0,S=G,j=J;break}if(me===j){oe=!0,j=G,S=J;break}me=me.sibling}if(!oe){for(me=J.child;me;){if(me===S){oe=!0,S=J,j=G;break}if(me===j){oe=!0,j=J,S=G;break}me=me.sibling}if(!oe)throw Error(n(189))}}if(S.alternate!==j)throw Error(n(190))}if(S.tag!==3)throw Error(n(188));return S.stateNode.current===S?d:m}function i(d){var m=d.tag;if(m===5||m===26||m===27||m===6)return d;for(d=d.child;d!==null;){if(m=i(d),m!==null)return m;d=d.sibling}return null}var u=Object.assign,p=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),h=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),y=Symbol.for("react.consumer"),k=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),B=Symbol.for("react.suspense_list"),W=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),q=Symbol.for("react.activity"),X=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function H(d){return d===null||typeof d!="object"?null:(d=I&&d[I]||d["@@iterator"],typeof d=="function"?d:null)}var O=Symbol.for("react.client.reference");function R(d){if(d==null)return null;if(typeof d=="function")return d.$$typeof===O?null:d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case v:return"Fragment";case g:return"Profiler";case b:return"StrictMode";case F:return"Suspense";case B:return"SuspenseList";case q:return"Activity"}if(typeof d=="object")switch(d.$$typeof){case h:return"Portal";case k:return(d.displayName||"Context")+".Provider";case y:return(d._context.displayName||"Context")+".Consumer";case N:var m=d.render;return d=d.displayName,d||(d=m.displayName||m.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case W:return m=d.displayName||null,m!==null?m:R(d.type)||"Memo";case V:m=d._payload,d=d._init;try{return R(d(m))}catch{}}return null}var C=Array.isArray,w=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,E=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,A={pending:!1,data:null,method:null,action:null},T=[],D=-1;function U(d){return{current:d}}function P(d){0>D||(d.current=T[D],T[D]=null,D--)}function K(d,m){D++,T[D]=d.current,d.current=m}var Y=U(null),re=U(null),z=U(null),ee=U(null);function L(d,m){switch(K(z,m),K(re,d),K(Y,null),m.nodeType){case 9:case 11:d=(d=m.documentElement)&&(d=d.namespaceURI)?pb(d):0;break;default:if(d=m.tagName,m=m.namespaceURI)m=pb(m),d=mb(m,d);else switch(d){case"svg":d=1;break;case"math":d=2;break;default:d=0}}P(Y),K(Y,d)}function M(){P(Y),P(re),P(z)}function Z(d){d.memoizedState!==null&&K(ee,d);var m=Y.current,S=mb(m,d.type);m!==S&&(K(re,d),K(Y,S))}function se(d){re.current===d&&(P(Y),P(re)),ee.current===d&&(P(ee),Gc._currentValue=A)}var ae=Object.prototype.hasOwnProperty,ne=t.unstable_scheduleCallback,Q=t.unstable_cancelCallback,fe=t.unstable_shouldYield,le=t.unstable_requestPaint,te=t.unstable_now,ce=t.unstable_getCurrentPriorityLevel,he=t.unstable_ImmediatePriority,Ee=t.unstable_UserBlockingPriority,ke=t.unstable_NormalPriority,Ce=t.unstable_LowPriority,Fe=t.unstable_IdlePriority,Pe=t.log,Xe=t.unstable_setDisableYieldValue,ct=null,st=null;function lt(d){if(typeof Pe=="function"&&Xe(d),st&&typeof st.setStrictMode=="function")try{st.setStrictMode(ct,d)}catch{}}var tt=Math.clz32?Math.clz32:ht,ot=Math.log,De=Math.LN2;function ht(d){return d>>>=0,d===0?32:31-(ot(d)/De|0)|0}var rt=256,it=4194304;function dt(d){var m=d&42;if(m!==0)return m;switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return d&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return d}}function wt(d,m,S){var j=d.pendingLanes;if(j===0)return 0;var G=0,J=d.suspendedLanes,oe=d.pingedLanes;d=d.warmLanes;var me=j&134217727;return me!==0?(j=me&~J,j!==0?G=dt(j):(oe&=me,oe!==0?G=dt(oe):S||(S=me&~d,S!==0&&(G=dt(S))))):(me=j&~J,me!==0?G=dt(me):oe!==0?G=dt(oe):S||(S=j&~d,S!==0&&(G=dt(S)))),G===0?0:m!==0&&m!==G&&(m&J)===0&&(J=G&-G,S=m&-m,J>=S||J===32&&(S&4194048)!==0)?m:G}function gt(d,m){return(d.pendingLanes&~(d.suspendedLanes&~d.pingedLanes)&m)===0}function vt(d,m){switch(d){case 1:case 2:case 4:case 8:case 64:return m+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ve(){var d=rt;return rt<<=1,(rt&4194048)===0&&(rt=256),d}function $e(){var d=it;return it<<=1,(it&62914560)===0&&(it=4194304),d}function xt(d){for(var m=[],S=0;31>S;S++)m.push(d);return m}function nt(d,m){d.pendingLanes|=m,m!==268435456&&(d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0)}function pt(d,m,S,j,G,J){var oe=d.pendingLanes;d.pendingLanes=S,d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0,d.expiredLanes&=S,d.entangledLanes&=S,d.errorRecoveryDisabledLanes&=S,d.shellSuspendCounter=0;var me=d.entanglements,Oe=d.expirationTimes,Ke=d.hiddenUpdates;for(S=oe&~S;0<S;){var ft=31-tt(S),bt=1<<ft;me[ft]=0,Oe[ft]=-1;var Je=Ke[ft];if(Je!==null)for(Ke[ft]=null,ft=0;ft<Je.length;ft++){var et=Je[ft];et!==null&&(et.lane&=-536870913)}S&=~bt}j!==0&&Se(d,j,0),J!==0&&G===0&&d.tag!==0&&(d.suspendedLanes|=J&~(oe&~m))}function Se(d,m,S){d.pendingLanes|=m,d.suspendedLanes&=~m;var j=31-tt(m);d.entangledLanes|=m,d.entanglements[j]=d.entanglements[j]|1073741824|S&4194090}function je(d,m){var S=d.entangledLanes|=m;for(d=d.entanglements;S;){var j=31-tt(S),G=1<<j;G&m|d[j]&m&&(d[j]|=m),S&=~G}}function Qe(d){switch(d){case 2:d=1;break;case 8:d=4;break;case 32:d=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:d=128;break;case 268435456:d=134217728;break;default:d=0}return d}function At(d){return d&=-d,2<d?8<d?(d&134217727)!==0?32:268435456:8:2}function Vt(){var d=E.p;return d!==0?d:(d=window.event,d===void 0?32:Mb(d.type))}function yt(d,m){var S=E.p;try{return E.p=d,m()}finally{E.p=S}}var Ct=Math.random().toString(36).slice(2),It="__reactFiber$"+Ct,kt="__reactProps$"+Ct,Ne="__reactContainer$"+Ct,Le="__reactEvents$"+Ct,at="__reactListeners$"+Ct,ie="__reactHandles$"+Ct,we="__reactResources$"+Ct,de="__reactMarker$"+Ct;function ge(d){delete d[It],delete d[kt],delete d[Le],delete d[at],delete d[ie]}function ve(d){var m=d[It];if(m)return m;for(var S=d.parentNode;S;){if(m=S[Ne]||S[It]){if(S=m.alternate,m.child!==null||S!==null&&S.child!==null)for(d=xb(d);d!==null;){if(S=d[It])return S;d=xb(d)}return m}d=S,S=d.parentNode}return null}function ye(d){if(d=d[It]||d[Ne]){var m=d.tag;if(m===5||m===6||m===13||m===26||m===27||m===3)return d}return null}function Me(d){var m=d.tag;if(m===5||m===26||m===27||m===6)return d.stateNode;throw Error(n(33))}function Ue(d){var m=d[we];return m||(m=d[we]={hoistableStyles:new Map,hoistableScripts:new Map}),m}function Re(d){d[de]=!0}var Be=new Set,ze={};function be(d,m){Te(d,m),Te(d+"Capture",m)}function Te(d,m){for(ze[d]=m,d=0;d<m.length;d++)Be.add(m[d])}var Ge=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ue={},Ae={};function pe(d){return ae.call(Ae,d)?!0:ae.call(ue,d)?!1:Ge.test(d)?Ae[d]=!0:(ue[d]=!0,!1)}function xe(d,m,S){if(pe(m))if(S===null)d.removeAttribute(m);else{switch(typeof S){case"undefined":case"function":case"symbol":d.removeAttribute(m);return;case"boolean":var j=m.toLowerCase().slice(0,5);if(j!=="data-"&&j!=="aria-"){d.removeAttribute(m);return}}d.setAttribute(m,""+S)}}function We(d,m,S){if(S===null)d.removeAttribute(m);else{switch(typeof S){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(m);return}d.setAttribute(m,""+S)}}function qe(d,m,S,j){if(j===null)d.removeAttribute(S);else{switch(typeof j){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(S);return}d.setAttributeNS(m,S,""+j)}}var ut,Mt;function Bt(d){if(ut===void 0)try{throw Error()}catch(S){var m=S.stack.trim().match(/\n( *(at )?)/);ut=m&&m[1]||"",Mt=-1<S.stack.indexOf(`
    at`)?" (<anonymous>)":-1<S.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ut+d+Mt}var Ht=!1;function Lt(d,m){if(!d||Ht)return"";Ht=!0;var S=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var j={DetermineComponentFrameRoot:function(){try{if(m){var bt=function(){throw Error()};if(Object.defineProperty(bt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(bt,[])}catch(et){var Je=et}Reflect.construct(d,[],bt)}else{try{bt.call()}catch(et){Je=et}d.call(bt.prototype)}}else{try{throw Error()}catch(et){Je=et}(bt=d())&&typeof bt.catch=="function"&&bt.catch(function(){})}}catch(et){if(et&&Je&&typeof et.stack=="string")return[et.stack,Je.stack]}return[null,null]}};j.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var G=Object.getOwnPropertyDescriptor(j.DetermineComponentFrameRoot,"name");G&&G.configurable&&Object.defineProperty(j.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var J=j.DetermineComponentFrameRoot(),oe=J[0],me=J[1];if(oe&&me){var Oe=oe.split(`
`),Ke=me.split(`
`);for(G=j=0;j<Oe.length&&!Oe[j].includes("DetermineComponentFrameRoot");)j++;for(;G<Ke.length&&!Ke[G].includes("DetermineComponentFrameRoot");)G++;if(j===Oe.length||G===Ke.length)for(j=Oe.length-1,G=Ke.length-1;1<=j&&0<=G&&Oe[j]!==Ke[G];)G--;for(;1<=j&&0<=G;j--,G--)if(Oe[j]!==Ke[G]){if(j!==1||G!==1)do if(j--,G--,0>G||Oe[j]!==Ke[G]){var ft=`
`+Oe[j].replace(" at new "," at ");return d.displayName&&ft.includes("<anonymous>")&&(ft=ft.replace("<anonymous>",d.displayName)),ft}while(1<=j&&0<=G);break}}}finally{Ht=!1,Error.prepareStackTrace=S}return(S=d?d.displayName||d.name:"")?Bt(S):""}function er(d){switch(d.tag){case 26:case 27:case 5:return Bt(d.type);case 16:return Bt("Lazy");case 13:return Bt("Suspense");case 19:return Bt("SuspenseList");case 0:case 15:return Lt(d.type,!1);case 11:return Lt(d.type.render,!1);case 1:return Lt(d.type,!0);case 31:return Bt("Activity");default:return""}}function gr(d){try{var m="";do m+=er(d),d=d.return;while(d);return m}catch(S){return`
Error generating stack: `+S.message+`
`+S.stack}}function tr(d){switch(typeof d){case"bigint":case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Rr(d){var m=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function en(d){var m=Rr(d)?"checked":"value",S=Object.getOwnPropertyDescriptor(d.constructor.prototype,m),j=""+d[m];if(!d.hasOwnProperty(m)&&typeof S<"u"&&typeof S.get=="function"&&typeof S.set=="function"){var G=S.get,J=S.set;return Object.defineProperty(d,m,{configurable:!0,get:function(){return G.call(this)},set:function(oe){j=""+oe,J.call(this,oe)}}),Object.defineProperty(d,m,{enumerable:S.enumerable}),{getValue:function(){return j},setValue:function(oe){j=""+oe},stopTracking:function(){d._valueTracker=null,delete d[m]}}}}function tn(d){d._valueTracker||(d._valueTracker=en(d))}function ra(d){if(!d)return!1;var m=d._valueTracker;if(!m)return!0;var S=m.getValue(),j="";return d&&(j=Rr(d)?d.checked?"true":"false":d.value),d=j,d!==S?(m.setValue(d),!0):!1}function Aa(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}var ui=/[\n"\\]/g;function hn(d){return d.replace(ui,function(m){return"\\"+m.charCodeAt(0).toString(16)+" "})}function ds(d,m,S,j,G,J,oe,me){d.name="",oe!=null&&typeof oe!="function"&&typeof oe!="symbol"&&typeof oe!="boolean"?d.type=oe:d.removeAttribute("type"),m!=null?oe==="number"?(m===0&&d.value===""||d.value!=m)&&(d.value=""+tr(m)):d.value!==""+tr(m)&&(d.value=""+tr(m)):oe!=="submit"&&oe!=="reset"||d.removeAttribute("value"),m!=null?ir(d,oe,tr(m)):S!=null?ir(d,oe,tr(S)):j!=null&&d.removeAttribute("value"),G==null&&J!=null&&(d.defaultChecked=!!J),G!=null&&(d.checked=G&&typeof G!="function"&&typeof G!="symbol"),me!=null&&typeof me!="function"&&typeof me!="symbol"&&typeof me!="boolean"?d.name=""+tr(me):d.removeAttribute("name")}function vr(d,m,S,j,G,J,oe,me){if(J!=null&&typeof J!="function"&&typeof J!="symbol"&&typeof J!="boolean"&&(d.type=J),m!=null||S!=null){if(!(J!=="submit"&&J!=="reset"||m!=null))return;S=S!=null?""+tr(S):"",m=m!=null?""+tr(m):S,me||m===d.value||(d.value=m),d.defaultValue=m}j=j??G,j=typeof j!="function"&&typeof j!="symbol"&&!!j,d.checked=me?d.checked:!!j,d.defaultChecked=!!j,oe!=null&&typeof oe!="function"&&typeof oe!="symbol"&&typeof oe!="boolean"&&(d.name=oe)}function ir(d,m,S){m==="number"&&Aa(d.ownerDocument)===d||d.defaultValue===""+S||(d.defaultValue=""+S)}function Gn(d,m,S,j){if(d=d.options,m){m={};for(var G=0;G<S.length;G++)m["$"+S[G]]=!0;for(S=0;S<d.length;S++)G=m.hasOwnProperty("$"+d[S].value),d[S].selected!==G&&(d[S].selected=G),G&&j&&(d[S].defaultSelected=!0)}else{for(S=""+tr(S),m=null,G=0;G<d.length;G++){if(d[G].value===S){d[G].selected=!0,j&&(d[G].defaultSelected=!0);return}m!==null||d[G].disabled||(m=d[G])}m!==null&&(m.selected=!0)}}function fs(d,m,S){if(m!=null&&(m=""+tr(m),m!==d.value&&(d.value=m),S==null)){d.defaultValue!==m&&(d.defaultValue=m);return}d.defaultValue=S!=null?""+tr(S):""}function ao(d,m,S,j){if(m==null){if(j!=null){if(S!=null)throw Error(n(92));if(C(j)){if(1<j.length)throw Error(n(93));j=j[0]}S=j}S==null&&(S=""),m=S}S=tr(m),d.defaultValue=S,j=d.textContent,j===S&&j!==""&&j!==null&&(d.value=j)}function rn(d,m){if(m){var S=d.firstChild;if(S&&S===d.lastChild&&S.nodeType===3){S.nodeValue=m;return}}d.textContent=m}var Wa=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ga(d,m,S){var j=m.indexOf("--")===0;S==null||typeof S=="boolean"||S===""?j?d.setProperty(m,""):m==="float"?d.cssFloat="":d[m]="":j?d.setProperty(m,S):typeof S!="number"||S===0||Wa.has(m)?m==="float"?d.cssFloat=S:d[m]=(""+S).trim():d[m]=S+"px"}function di(d,m,S){if(m!=null&&typeof m!="object")throw Error(n(62));if(d=d.style,S!=null){for(var j in S)!S.hasOwnProperty(j)||m!=null&&m.hasOwnProperty(j)||(j.indexOf("--")===0?d.setProperty(j,""):j==="float"?d.cssFloat="":d[j]="");for(var G in m)j=m[G],m.hasOwnProperty(G)&&S[G]!==j&&Ga(d,G,j)}else for(var J in m)m.hasOwnProperty(J)&&Ga(d,J,m[J])}function fi(d){if(d.indexOf("-")===-1)return!1;switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hi=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function so(d){return hs.test(""+d)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":d}var pi=null;function io(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var Ya=null,Xa=null;function sc(d){var m=ye(d);if(m&&(d=m.stateNode)){var S=d[kt]||null;e:switch(d=m.stateNode,m.type){case"input":if(ds(d,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name),m=S.name,S.type==="radio"&&m!=null){for(S=d;S.parentNode;)S=S.parentNode;for(S=S.querySelectorAll('input[name="'+hn(""+m)+'"][type="radio"]'),m=0;m<S.length;m++){var j=S[m];if(j!==d&&j.form===d.form){var G=j[kt]||null;if(!G)throw Error(n(90));ds(j,G.value,G.defaultValue,G.defaultValue,G.checked,G.defaultChecked,G.type,G.name)}}for(m=0;m<S.length;m++)j=S[m],j.form===d.form&&ra(j)}break e;case"textarea":fs(d,S.value,S.defaultValue);break e;case"select":m=S.value,m!=null&&Gn(d,!!S.multiple,m,!1)}}}var mi=!1;function oo(d,m,S){if(mi)return d(m,S);mi=!0;try{var j=d(m);return j}finally{if(mi=!1,(Ya!==null||Xa!==null)&&(Pd(),Ya&&(m=Ya,d=Xa,Xa=Ya=null,sc(m),d)))for(m=0;m<d.length;m++)sc(d[m])}}function ic(d,m){var S=d.stateNode;if(S===null)return null;var j=S[kt]||null;if(j===null)return null;S=j[m];e:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(j=!j.disabled)||(d=d.type,j=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!j;break e;default:d=!1}if(d)return null;if(S&&typeof S!="function")throw Error(n(231,m,typeof S));return S}var Ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rh=!1;if(Ps)try{var oc={};Object.defineProperty(oc,"passive",{get:function(){rh=!0}}),window.addEventListener("test",oc,oc),window.removeEventListener("test",oc,oc)}catch{rh=!1}var gi=null,nh=null,Qu=null;function b1(){if(Qu)return Qu;var d,m=nh,S=m.length,j,G="value"in gi?gi.value:gi.textContent,J=G.length;for(d=0;d<S&&m[d]===G[d];d++);var oe=S-d;for(j=1;j<=oe&&m[S-j]===G[J-j];j++);return Qu=G.slice(d,1<j?1-j:void 0)}function ed(d){var m=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&m===13&&(d=13)):d=m,d===10&&(d=13),32<=d||d===13?d:0}function td(){return!0}function x1(){return!1}function na(d){function m(S,j,G,J,oe){this._reactName=S,this._targetInst=G,this.type=j,this.nativeEvent=J,this.target=oe,this.currentTarget=null;for(var me in d)d.hasOwnProperty(me)&&(S=d[me],this[me]=S?S(J):J[me]);return this.isDefaultPrevented=(J.defaultPrevented!=null?J.defaultPrevented:J.returnValue===!1)?td:x1,this.isPropagationStopped=x1,this}return u(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var S=this.nativeEvent;S&&(S.preventDefault?S.preventDefault():typeof S.returnValue!="unknown"&&(S.returnValue=!1),this.isDefaultPrevented=td)},stopPropagation:function(){var S=this.nativeEvent;S&&(S.stopPropagation?S.stopPropagation():typeof S.cancelBubble!="unknown"&&(S.cancelBubble=!0),this.isPropagationStopped=td)},persist:function(){},isPersistent:td}),m}var lo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rd=na(lo),lc=u({},lo,{view:0,detail:0}),x3=na(lc),ah,sh,cc,nd=u({},lc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oh,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==cc&&(cc&&d.type==="mousemove"?(ah=d.screenX-cc.screenX,sh=d.screenY-cc.screenY):sh=ah=0,cc=d),ah)},movementY:function(d){return"movementY"in d?d.movementY:sh}}),y1=na(nd),y3=u({},nd,{dataTransfer:0}),w3=na(y3),_3=u({},lc,{relatedTarget:0}),ih=na(_3),S3=u({},lo,{animationName:0,elapsedTime:0,pseudoElement:0}),k3=na(S3),E3=u({},lo,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),T3=na(E3),A3=u({},lo,{data:0}),w1=na(A3),C3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},N3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},j3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function O3(d){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(d):(d=j3[d])?!!m[d]:!1}function oh(){return O3}var D3=u({},lc,{key:function(d){if(d.key){var m=C3[d.key]||d.key;if(m!=="Unidentified")return m}return d.type==="keypress"?(d=ed(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?N3[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oh,charCode:function(d){return d.type==="keypress"?ed(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?ed(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),R3=na(D3),M3=u({},nd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_1=na(M3),F3=u({},lc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oh}),I3=na(F3),P3=u({},lo,{propertyName:0,elapsedTime:0,pseudoElement:0}),L3=na(P3),B3=u({},nd,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),U3=na(B3),z3=u({},lo,{newState:0,oldState:0}),$3=na(z3),V3=[9,13,27,32],lh=Ps&&"CompositionEvent"in window,uc=null;Ps&&"documentMode"in document&&(uc=document.documentMode);var H3=Ps&&"TextEvent"in window&&!uc,S1=Ps&&(!lh||uc&&8<uc&&11>=uc),k1=" ",E1=!1;function T1(d,m){switch(d){case"keyup":return V3.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function A1(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var Yo=!1;function q3(d,m){switch(d){case"compositionend":return A1(m);case"keypress":return m.which!==32?null:(E1=!0,k1);case"textInput":return d=m.data,d===k1&&E1?null:d;default:return null}}function W3(d,m){if(Yo)return d==="compositionend"||!lh&&T1(d,m)?(d=b1(),Qu=nh=gi=null,Yo=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return S1&&m.locale!=="ko"?null:m.data;default:return null}}var G3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function C1(d){var m=d&&d.nodeName&&d.nodeName.toLowerCase();return m==="input"?!!G3[d.type]:m==="textarea"}function N1(d,m,S,j){Ya?Xa?Xa.push(j):Xa=[j]:Ya=j,m=Vd(m,"onChange"),0<m.length&&(S=new rd("onChange","change",null,S,j),d.push({event:S,listeners:m}))}var dc=null,fc=null;function Y3(d){cb(d,0)}function ad(d){var m=Me(d);if(ra(m))return d}function j1(d,m){if(d==="change")return m}var O1=!1;if(Ps){var ch;if(Ps){var uh="oninput"in document;if(!uh){var D1=document.createElement("div");D1.setAttribute("oninput","return;"),uh=typeof D1.oninput=="function"}ch=uh}else ch=!1;O1=ch&&(!document.documentMode||9<document.documentMode)}function R1(){dc&&(dc.detachEvent("onpropertychange",M1),fc=dc=null)}function M1(d){if(d.propertyName==="value"&&ad(fc)){var m=[];N1(m,fc,d,io(d)),oo(Y3,m)}}function X3(d,m,S){d==="focusin"?(R1(),dc=m,fc=S,dc.attachEvent("onpropertychange",M1)):d==="focusout"&&R1()}function K3(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return ad(fc)}function Z3(d,m){if(d==="click")return ad(m)}function J3(d,m){if(d==="input"||d==="change")return ad(m)}function Q3(d,m){return d===m&&(d!==0||1/d===1/m)||d!==d&&m!==m}var ua=typeof Object.is=="function"?Object.is:Q3;function hc(d,m){if(ua(d,m))return!0;if(typeof d!="object"||d===null||typeof m!="object"||m===null)return!1;var S=Object.keys(d),j=Object.keys(m);if(S.length!==j.length)return!1;for(j=0;j<S.length;j++){var G=S[j];if(!ae.call(m,G)||!ua(d[G],m[G]))return!1}return!0}function F1(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function I1(d,m){var S=F1(d);d=0;for(var j;S;){if(S.nodeType===3){if(j=d+S.textContent.length,d<=m&&j>=m)return{node:S,offset:m-d};d=j}e:{for(;S;){if(S.nextSibling){S=S.nextSibling;break e}S=S.parentNode}S=void 0}S=F1(S)}}function P1(d,m){return d&&m?d===m?!0:d&&d.nodeType===3?!1:m&&m.nodeType===3?P1(d,m.parentNode):"contains"in d?d.contains(m):d.compareDocumentPosition?!!(d.compareDocumentPosition(m)&16):!1:!1}function L1(d){d=d!=null&&d.ownerDocument!=null&&d.ownerDocument.defaultView!=null?d.ownerDocument.defaultView:window;for(var m=Aa(d.document);m instanceof d.HTMLIFrameElement;){try{var S=typeof m.contentWindow.location.href=="string"}catch{S=!1}if(S)d=m.contentWindow;else break;m=Aa(d.document)}return m}function dh(d){var m=d&&d.nodeName&&d.nodeName.toLowerCase();return m&&(m==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||m==="textarea"||d.contentEditable==="true")}var e6=Ps&&"documentMode"in document&&11>=document.documentMode,Xo=null,fh=null,pc=null,hh=!1;function B1(d,m,S){var j=S.window===S?S.document:S.nodeType===9?S:S.ownerDocument;hh||Xo==null||Xo!==Aa(j)||(j=Xo,"selectionStart"in j&&dh(j)?j={start:j.selectionStart,end:j.selectionEnd}:(j=(j.ownerDocument&&j.ownerDocument.defaultView||window).getSelection(),j={anchorNode:j.anchorNode,anchorOffset:j.anchorOffset,focusNode:j.focusNode,focusOffset:j.focusOffset}),pc&&hc(pc,j)||(pc=j,j=Vd(fh,"onSelect"),0<j.length&&(m=new rd("onSelect","select",null,m,S),d.push({event:m,listeners:j}),m.target=Xo)))}function co(d,m){var S={};return S[d.toLowerCase()]=m.toLowerCase(),S["Webkit"+d]="webkit"+m,S["Moz"+d]="moz"+m,S}var Ko={animationend:co("Animation","AnimationEnd"),animationiteration:co("Animation","AnimationIteration"),animationstart:co("Animation","AnimationStart"),transitionrun:co("Transition","TransitionRun"),transitionstart:co("Transition","TransitionStart"),transitioncancel:co("Transition","TransitionCancel"),transitionend:co("Transition","TransitionEnd")},ph={},U1={};Ps&&(U1=document.createElement("div").style,"AnimationEvent"in window||(delete Ko.animationend.animation,delete Ko.animationiteration.animation,delete Ko.animationstart.animation),"TransitionEvent"in window||delete Ko.transitionend.transition);function uo(d){if(ph[d])return ph[d];if(!Ko[d])return d;var m=Ko[d],S;for(S in m)if(m.hasOwnProperty(S)&&S in U1)return ph[d]=m[S];return d}var z1=uo("animationend"),$1=uo("animationiteration"),V1=uo("animationstart"),t6=uo("transitionrun"),r6=uo("transitionstart"),n6=uo("transitioncancel"),H1=uo("transitionend"),q1=new Map,mh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");mh.push("scrollEnd");function Ka(d,m){q1.set(d,m),be(m,[d])}var W1=new WeakMap;function Ca(d,m){if(typeof d=="object"&&d!==null){var S=W1.get(d);return S!==void 0?S:(m={value:d,source:m,stack:gr(m)},W1.set(d,m),m)}return{value:d,source:m,stack:gr(m)}}var Na=[],Zo=0,gh=0;function sd(){for(var d=Zo,m=gh=Zo=0;m<d;){var S=Na[m];Na[m++]=null;var j=Na[m];Na[m++]=null;var G=Na[m];Na[m++]=null;var J=Na[m];if(Na[m++]=null,j!==null&&G!==null){var oe=j.pending;oe===null?G.next=G:(G.next=oe.next,oe.next=G),j.pending=G}J!==0&&G1(S,G,J)}}function id(d,m,S,j){Na[Zo++]=d,Na[Zo++]=m,Na[Zo++]=S,Na[Zo++]=j,gh|=j,d.lanes|=j,d=d.alternate,d!==null&&(d.lanes|=j)}function vh(d,m,S,j){return id(d,m,S,j),od(d)}function Jo(d,m){return id(d,null,null,m),od(d)}function G1(d,m,S){d.lanes|=S;var j=d.alternate;j!==null&&(j.lanes|=S);for(var G=!1,J=d.return;J!==null;)J.childLanes|=S,j=J.alternate,j!==null&&(j.childLanes|=S),J.tag===22&&(d=J.stateNode,d===null||d._visibility&1||(G=!0)),d=J,J=J.return;return d.tag===3?(J=d.stateNode,G&&m!==null&&(G=31-tt(S),d=J.hiddenUpdates,j=d[G],j===null?d[G]=[m]:j.push(m),m.lane=S|536870912),J):null}function od(d){if(50<Bc)throw Bc=0,S0=null,Error(n(185));for(var m=d.return;m!==null;)d=m,m=d.return;return d.tag===3?d.stateNode:null}var Qo={};function a6(d,m,S,j){this.tag=d,this.key=S,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=j,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function da(d,m,S,j){return new a6(d,m,S,j)}function bh(d){return d=d.prototype,!(!d||!d.isReactComponent)}function Ls(d,m){var S=d.alternate;return S===null?(S=da(d.tag,m,d.key,d.mode),S.elementType=d.elementType,S.type=d.type,S.stateNode=d.stateNode,S.alternate=d,d.alternate=S):(S.pendingProps=m,S.type=d.type,S.flags=0,S.subtreeFlags=0,S.deletions=null),S.flags=d.flags&65011712,S.childLanes=d.childLanes,S.lanes=d.lanes,S.child=d.child,S.memoizedProps=d.memoizedProps,S.memoizedState=d.memoizedState,S.updateQueue=d.updateQueue,m=d.dependencies,S.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},S.sibling=d.sibling,S.index=d.index,S.ref=d.ref,S.refCleanup=d.refCleanup,S}function Y1(d,m){d.flags&=65011714;var S=d.alternate;return S===null?(d.childLanes=0,d.lanes=m,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=S.childLanes,d.lanes=S.lanes,d.child=S.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=S.memoizedProps,d.memoizedState=S.memoizedState,d.updateQueue=S.updateQueue,d.type=S.type,m=S.dependencies,d.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext}),d}function ld(d,m,S,j,G,J){var oe=0;if(j=d,typeof d=="function")bh(d)&&(oe=1);else if(typeof d=="string")oe=i5(d,S,Y.current)?26:d==="html"||d==="head"||d==="body"?27:5;else e:switch(d){case q:return d=da(31,S,m,G),d.elementType=q,d.lanes=J,d;case v:return fo(S.children,G,J,m);case b:oe=8,G|=24;break;case g:return d=da(12,S,m,G|2),d.elementType=g,d.lanes=J,d;case F:return d=da(13,S,m,G),d.elementType=F,d.lanes=J,d;case B:return d=da(19,S,m,G),d.elementType=B,d.lanes=J,d;default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case x:case k:oe=10;break e;case y:oe=9;break e;case N:oe=11;break e;case W:oe=14;break e;case V:oe=16,j=null;break e}oe=29,S=Error(n(130,d===null?"null":typeof d,"")),j=null}return m=da(oe,S,m,G),m.elementType=d,m.type=j,m.lanes=J,m}function fo(d,m,S,j){return d=da(7,d,j,m),d.lanes=S,d}function xh(d,m,S){return d=da(6,d,null,m),d.lanes=S,d}function yh(d,m,S){return m=da(4,d.children!==null?d.children:[],d.key,m),m.lanes=S,m.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},m}var el=[],tl=0,cd=null,ud=0,ja=[],Oa=0,ho=null,Bs=1,Us="";function po(d,m){el[tl++]=ud,el[tl++]=cd,cd=d,ud=m}function X1(d,m,S){ja[Oa++]=Bs,ja[Oa++]=Us,ja[Oa++]=ho,ho=d;var j=Bs;d=Us;var G=32-tt(j)-1;j&=~(1<<G),S+=1;var J=32-tt(m)+G;if(30<J){var oe=G-G%5;J=(j&(1<<oe)-1).toString(32),j>>=oe,G-=oe,Bs=1<<32-tt(m)+G|S<<G|j,Us=J+d}else Bs=1<<J|S<<G|j,Us=d}function wh(d){d.return!==null&&(po(d,1),X1(d,1,0))}function _h(d){for(;d===cd;)cd=el[--tl],el[tl]=null,ud=el[--tl],el[tl]=null;for(;d===ho;)ho=ja[--Oa],ja[Oa]=null,Us=ja[--Oa],ja[Oa]=null,Bs=ja[--Oa],ja[Oa]=null}var Yn=null,Hr=null,wr=!1,mo=null,ps=!1,Sh=Error(n(519));function go(d){var m=Error(n(418,""));throw vc(Ca(m,d)),Sh}function K1(d){var m=d.stateNode,S=d.type,j=d.memoizedProps;switch(m[It]=d,m[kt]=j,S){case"dialog":cr("cancel",m),cr("close",m);break;case"iframe":case"object":case"embed":cr("load",m);break;case"video":case"audio":for(S=0;S<zc.length;S++)cr(zc[S],m);break;case"source":cr("error",m);break;case"img":case"image":case"link":cr("error",m),cr("load",m);break;case"details":cr("toggle",m);break;case"input":cr("invalid",m),vr(m,j.value,j.defaultValue,j.checked,j.defaultChecked,j.type,j.name,!0),tn(m);break;case"select":cr("invalid",m);break;case"textarea":cr("invalid",m),ao(m,j.value,j.defaultValue,j.children),tn(m)}S=j.children,typeof S!="string"&&typeof S!="number"&&typeof S!="bigint"||m.textContent===""+S||j.suppressHydrationWarning===!0||hb(m.textContent,S)?(j.popover!=null&&(cr("beforetoggle",m),cr("toggle",m)),j.onScroll!=null&&cr("scroll",m),j.onScrollEnd!=null&&cr("scrollend",m),j.onClick!=null&&(m.onclick=Hd),m=!0):m=!1,m||go(d)}function Z1(d){for(Yn=d.return;Yn;)switch(Yn.tag){case 5:case 13:ps=!1;return;case 27:case 3:ps=!0;return;default:Yn=Yn.return}}function mc(d){if(d!==Yn)return!1;if(!wr)return Z1(d),wr=!0,!1;var m=d.tag,S;if((S=m!==3&&m!==27)&&((S=m===5)&&(S=d.type,S=!(S!=="form"&&S!=="button")||B0(d.type,d.memoizedProps)),S=!S),S&&Hr&&go(d),Z1(d),m===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(n(317));e:{for(d=d.nextSibling,m=0;d;){if(d.nodeType===8)if(S=d.data,S==="/$"){if(m===0){Hr=Ja(d.nextSibling);break e}m--}else S!=="$"&&S!=="$!"&&S!=="$?"||m++;d=d.nextSibling}Hr=null}}else m===27?(m=Hr,Di(d.type)?(d=V0,V0=null,Hr=d):Hr=m):Hr=Yn?Ja(d.stateNode.nextSibling):null;return!0}function gc(){Hr=Yn=null,wr=!1}function J1(){var d=mo;return d!==null&&(ia===null?ia=d:ia.push.apply(ia,d),mo=null),d}function vc(d){mo===null?mo=[d]:mo.push(d)}var kh=U(null),vo=null,zs=null;function vi(d,m,S){K(kh,m._currentValue),m._currentValue=S}function $s(d){d._currentValue=kh.current,P(kh)}function Eh(d,m,S){for(;d!==null;){var j=d.alternate;if((d.childLanes&m)!==m?(d.childLanes|=m,j!==null&&(j.childLanes|=m)):j!==null&&(j.childLanes&m)!==m&&(j.childLanes|=m),d===S)break;d=d.return}}function Th(d,m,S,j){var G=d.child;for(G!==null&&(G.return=d);G!==null;){var J=G.dependencies;if(J!==null){var oe=G.child;J=J.firstContext;e:for(;J!==null;){var me=J;J=G;for(var Oe=0;Oe<m.length;Oe++)if(me.context===m[Oe]){J.lanes|=S,me=J.alternate,me!==null&&(me.lanes|=S),Eh(J.return,S,d),j||(oe=null);break e}J=me.next}}else if(G.tag===18){if(oe=G.return,oe===null)throw Error(n(341));oe.lanes|=S,J=oe.alternate,J!==null&&(J.lanes|=S),Eh(oe,S,d),oe=null}else oe=G.child;if(oe!==null)oe.return=G;else for(oe=G;oe!==null;){if(oe===d){oe=null;break}if(G=oe.sibling,G!==null){G.return=oe.return,oe=G;break}oe=oe.return}G=oe}}function bc(d,m,S,j){d=null;for(var G=m,J=!1;G!==null;){if(!J){if((G.flags&524288)!==0)J=!0;else if((G.flags&262144)!==0)break}if(G.tag===10){var oe=G.alternate;if(oe===null)throw Error(n(387));if(oe=oe.memoizedProps,oe!==null){var me=G.type;ua(G.pendingProps.value,oe.value)||(d!==null?d.push(me):d=[me])}}else if(G===ee.current){if(oe=G.alternate,oe===null)throw Error(n(387));oe.memoizedState.memoizedState!==G.memoizedState.memoizedState&&(d!==null?d.push(Gc):d=[Gc])}G=G.return}d!==null&&Th(m,d,S,j),m.flags|=262144}function dd(d){for(d=d.firstContext;d!==null;){if(!ua(d.context._currentValue,d.memoizedValue))return!0;d=d.next}return!1}function bo(d){vo=d,zs=null,d=d.dependencies,d!==null&&(d.firstContext=null)}function Fn(d){return Q1(vo,d)}function fd(d,m){return vo===null&&bo(d),Q1(d,m)}function Q1(d,m){var S=m._currentValue;if(m={context:m,memoizedValue:S,next:null},zs===null){if(d===null)throw Error(n(308));zs=m,d.dependencies={lanes:0,firstContext:m},d.flags|=524288}else zs=zs.next=m;return S}var s6=typeof AbortController<"u"?AbortController:function(){var d=[],m=this.signal={aborted:!1,addEventListener:function(S,j){d.push(j)}};this.abort=function(){m.aborted=!0,d.forEach(function(S){return S()})}},i6=t.unstable_scheduleCallback,o6=t.unstable_NormalPriority,pn={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ah(){return{controller:new s6,data:new Map,refCount:0}}function xc(d){d.refCount--,d.refCount===0&&i6(o6,function(){d.controller.abort()})}var yc=null,Ch=0,rl=0,nl=null;function l6(d,m){if(yc===null){var S=yc=[];Ch=0,rl=j0(),nl={status:"pending",value:void 0,then:function(j){S.push(j)}}}return Ch++,m.then(eg,eg),m}function eg(){if(--Ch===0&&yc!==null){nl!==null&&(nl.status="fulfilled");var d=yc;yc=null,rl=0,nl=null;for(var m=0;m<d.length;m++)(0,d[m])()}}function c6(d,m){var S=[],j={status:"pending",value:null,reason:null,then:function(G){S.push(G)}};return d.then(function(){j.status="fulfilled",j.value=m;for(var G=0;G<S.length;G++)(0,S[G])(m)},function(G){for(j.status="rejected",j.reason=G,G=0;G<S.length;G++)(0,S[G])(void 0)}),j}var tg=w.S;w.S=function(d,m){typeof m=="object"&&m!==null&&typeof m.then=="function"&&l6(d,m),tg!==null&&tg(d,m)};var xo=U(null);function Nh(){var d=xo.current;return d!==null?d:Mr.pooledCache}function hd(d,m){m===null?K(xo,xo.current):K(xo,m.pool)}function rg(){var d=Nh();return d===null?null:{parent:pn._currentValue,pool:d}}var wc=Error(n(460)),ng=Error(n(474)),pd=Error(n(542)),jh={then:function(){}};function ag(d){return d=d.status,d==="fulfilled"||d==="rejected"}function md(){}function sg(d,m,S){switch(S=d[S],S===void 0?d.push(m):S!==m&&(m.then(md,md),m=S),m.status){case"fulfilled":return m.value;case"rejected":throw d=m.reason,og(d),d;default:if(typeof m.status=="string")m.then(md,md);else{if(d=Mr,d!==null&&100<d.shellSuspendCounter)throw Error(n(482));d=m,d.status="pending",d.then(function(j){if(m.status==="pending"){var G=m;G.status="fulfilled",G.value=j}},function(j){if(m.status==="pending"){var G=m;G.status="rejected",G.reason=j}})}switch(m.status){case"fulfilled":return m.value;case"rejected":throw d=m.reason,og(d),d}throw _c=m,wc}}var _c=null;function ig(){if(_c===null)throw Error(n(459));var d=_c;return _c=null,d}function og(d){if(d===wc||d===pd)throw Error(n(483))}var bi=!1;function Oh(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Dh(d,m){d=d.updateQueue,m.updateQueue===d&&(m.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,callbacks:null})}function xi(d){return{lane:d,tag:0,payload:null,callback:null,next:null}}function yi(d,m,S){var j=d.updateQueue;if(j===null)return null;if(j=j.shared,(Er&2)!==0){var G=j.pending;return G===null?m.next=m:(m.next=G.next,G.next=m),j.pending=m,m=od(d),G1(d,null,S),m}return id(d,j,m,S),od(d)}function Sc(d,m,S){if(m=m.updateQueue,m!==null&&(m=m.shared,(S&4194048)!==0)){var j=m.lanes;j&=d.pendingLanes,S|=j,m.lanes=S,je(d,S)}}function Rh(d,m){var S=d.updateQueue,j=d.alternate;if(j!==null&&(j=j.updateQueue,S===j)){var G=null,J=null;if(S=S.firstBaseUpdate,S!==null){do{var oe={lane:S.lane,tag:S.tag,payload:S.payload,callback:null,next:null};J===null?G=J=oe:J=J.next=oe,S=S.next}while(S!==null);J===null?G=J=m:J=J.next=m}else G=J=m;S={baseState:j.baseState,firstBaseUpdate:G,lastBaseUpdate:J,shared:j.shared,callbacks:j.callbacks},d.updateQueue=S;return}d=S.lastBaseUpdate,d===null?S.firstBaseUpdate=m:d.next=m,S.lastBaseUpdate=m}var Mh=!1;function kc(){if(Mh){var d=nl;if(d!==null)throw d}}function Ec(d,m,S,j){Mh=!1;var G=d.updateQueue;bi=!1;var J=G.firstBaseUpdate,oe=G.lastBaseUpdate,me=G.shared.pending;if(me!==null){G.shared.pending=null;var Oe=me,Ke=Oe.next;Oe.next=null,oe===null?J=Ke:oe.next=Ke,oe=Oe;var ft=d.alternate;ft!==null&&(ft=ft.updateQueue,me=ft.lastBaseUpdate,me!==oe&&(me===null?ft.firstBaseUpdate=Ke:me.next=Ke,ft.lastBaseUpdate=Oe))}if(J!==null){var bt=G.baseState;oe=0,ft=Ke=Oe=null,me=J;do{var Je=me.lane&-536870913,et=Je!==me.lane;if(et?(hr&Je)===Je:(j&Je)===Je){Je!==0&&Je===rl&&(Mh=!0),ft!==null&&(ft=ft.next={lane:0,tag:me.tag,payload:me.payload,callback:null,next:null});e:{var Zt=d,qt=me;Je=m;var jr=S;switch(qt.tag){case 1:if(Zt=qt.payload,typeof Zt=="function"){bt=Zt.call(jr,bt,Je);break e}bt=Zt;break e;case 3:Zt.flags=Zt.flags&-65537|128;case 0:if(Zt=qt.payload,Je=typeof Zt=="function"?Zt.call(jr,bt,Je):Zt,Je==null)break e;bt=u({},bt,Je);break e;case 2:bi=!0}}Je=me.callback,Je!==null&&(d.flags|=64,et&&(d.flags|=8192),et=G.callbacks,et===null?G.callbacks=[Je]:et.push(Je))}else et={lane:Je,tag:me.tag,payload:me.payload,callback:me.callback,next:null},ft===null?(Ke=ft=et,Oe=bt):ft=ft.next=et,oe|=Je;if(me=me.next,me===null){if(me=G.shared.pending,me===null)break;et=me,me=et.next,et.next=null,G.lastBaseUpdate=et,G.shared.pending=null}}while(!0);ft===null&&(Oe=bt),G.baseState=Oe,G.firstBaseUpdate=Ke,G.lastBaseUpdate=ft,J===null&&(G.shared.lanes=0),Ci|=oe,d.lanes=oe,d.memoizedState=bt}}function lg(d,m){if(typeof d!="function")throw Error(n(191,d));d.call(m)}function cg(d,m){var S=d.callbacks;if(S!==null)for(d.callbacks=null,d=0;d<S.length;d++)lg(S[d],m)}var al=U(null),gd=U(0);function ug(d,m){d=Xs,K(gd,d),K(al,m),Xs=d|m.baseLanes}function Fh(){K(gd,Xs),K(al,al.current)}function Ih(){Xs=gd.current,P(al),P(gd)}var wi=0,ar=null,Cr=null,nn=null,vd=!1,sl=!1,yo=!1,bd=0,Tc=0,il=null,u6=0;function Xr(){throw Error(n(321))}function Ph(d,m){if(m===null)return!1;for(var S=0;S<m.length&&S<d.length;S++)if(!ua(d[S],m[S]))return!1;return!0}function Lh(d,m,S,j,G,J){return wi=J,ar=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,w.H=d===null||d.memoizedState===null?Gg:Yg,yo=!1,J=S(j,G),yo=!1,sl&&(J=fg(m,S,j,G)),dg(d),J}function dg(d){w.H=kd;var m=Cr!==null&&Cr.next!==null;if(wi=0,nn=Cr=ar=null,vd=!1,Tc=0,il=null,m)throw Error(n(300));d===null||yn||(d=d.dependencies,d!==null&&dd(d)&&(yn=!0))}function fg(d,m,S,j){ar=d;var G=0;do{if(sl&&(il=null),Tc=0,sl=!1,25<=G)throw Error(n(301));if(G+=1,nn=Cr=null,d.updateQueue!=null){var J=d.updateQueue;J.lastEffect=null,J.events=null,J.stores=null,J.memoCache!=null&&(J.memoCache.index=0)}w.H=v6,J=m(S,j)}while(sl);return J}function d6(){var d=w.H,m=d.useState()[0];return m=typeof m.then=="function"?Ac(m):m,d=d.useState()[0],(Cr!==null?Cr.memoizedState:null)!==d&&(ar.flags|=1024),m}function Bh(){var d=bd!==0;return bd=0,d}function Uh(d,m,S){m.updateQueue=d.updateQueue,m.flags&=-2053,d.lanes&=~S}function zh(d){if(vd){for(d=d.memoizedState;d!==null;){var m=d.queue;m!==null&&(m.pending=null),d=d.next}vd=!1}wi=0,nn=Cr=ar=null,sl=!1,Tc=bd=0,il=null}function aa(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return nn===null?ar.memoizedState=nn=d:nn=nn.next=d,nn}function an(){if(Cr===null){var d=ar.alternate;d=d!==null?d.memoizedState:null}else d=Cr.next;var m=nn===null?ar.memoizedState:nn.next;if(m!==null)nn=m,Cr=d;else{if(d===null)throw ar.alternate===null?Error(n(467)):Error(n(310));Cr=d,d={memoizedState:Cr.memoizedState,baseState:Cr.baseState,baseQueue:Cr.baseQueue,queue:Cr.queue,next:null},nn===null?ar.memoizedState=nn=d:nn=nn.next=d}return nn}function $h(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ac(d){var m=Tc;return Tc+=1,il===null&&(il=[]),d=sg(il,d,m),m=ar,(nn===null?m.memoizedState:nn.next)===null&&(m=m.alternate,w.H=m===null||m.memoizedState===null?Gg:Yg),d}function xd(d){if(d!==null&&typeof d=="object"){if(typeof d.then=="function")return Ac(d);if(d.$$typeof===k)return Fn(d)}throw Error(n(438,String(d)))}function Vh(d){var m=null,S=ar.updateQueue;if(S!==null&&(m=S.memoCache),m==null){var j=ar.alternate;j!==null&&(j=j.updateQueue,j!==null&&(j=j.memoCache,j!=null&&(m={data:j.data.map(function(G){return G.slice()}),index:0})))}if(m==null&&(m={data:[],index:0}),S===null&&(S=$h(),ar.updateQueue=S),S.memoCache=m,S=m.data[m.index],S===void 0)for(S=m.data[m.index]=Array(d),j=0;j<d;j++)S[j]=X;return m.index++,S}function Vs(d,m){return typeof m=="function"?m(d):m}function yd(d){var m=an();return Hh(m,Cr,d)}function Hh(d,m,S){var j=d.queue;if(j===null)throw Error(n(311));j.lastRenderedReducer=S;var G=d.baseQueue,J=j.pending;if(J!==null){if(G!==null){var oe=G.next;G.next=J.next,J.next=oe}m.baseQueue=G=J,j.pending=null}if(J=d.baseState,G===null)d.memoizedState=J;else{m=G.next;var me=oe=null,Oe=null,Ke=m,ft=!1;do{var bt=Ke.lane&-536870913;if(bt!==Ke.lane?(hr&bt)===bt:(wi&bt)===bt){var Je=Ke.revertLane;if(Je===0)Oe!==null&&(Oe=Oe.next={lane:0,revertLane:0,action:Ke.action,hasEagerState:Ke.hasEagerState,eagerState:Ke.eagerState,next:null}),bt===rl&&(ft=!0);else if((wi&Je)===Je){Ke=Ke.next,Je===rl&&(ft=!0);continue}else bt={lane:0,revertLane:Ke.revertLane,action:Ke.action,hasEagerState:Ke.hasEagerState,eagerState:Ke.eagerState,next:null},Oe===null?(me=Oe=bt,oe=J):Oe=Oe.next=bt,ar.lanes|=Je,Ci|=Je;bt=Ke.action,yo&&S(J,bt),J=Ke.hasEagerState?Ke.eagerState:S(J,bt)}else Je={lane:bt,revertLane:Ke.revertLane,action:Ke.action,hasEagerState:Ke.hasEagerState,eagerState:Ke.eagerState,next:null},Oe===null?(me=Oe=Je,oe=J):Oe=Oe.next=Je,ar.lanes|=bt,Ci|=bt;Ke=Ke.next}while(Ke!==null&&Ke!==m);if(Oe===null?oe=J:Oe.next=me,!ua(J,d.memoizedState)&&(yn=!0,ft&&(S=nl,S!==null)))throw S;d.memoizedState=J,d.baseState=oe,d.baseQueue=Oe,j.lastRenderedState=J}return G===null&&(j.lanes=0),[d.memoizedState,j.dispatch]}function qh(d){var m=an(),S=m.queue;if(S===null)throw Error(n(311));S.lastRenderedReducer=d;var j=S.dispatch,G=S.pending,J=m.memoizedState;if(G!==null){S.pending=null;var oe=G=G.next;do J=d(J,oe.action),oe=oe.next;while(oe!==G);ua(J,m.memoizedState)||(yn=!0),m.memoizedState=J,m.baseQueue===null&&(m.baseState=J),S.lastRenderedState=J}return[J,j]}function hg(d,m,S){var j=ar,G=an(),J=wr;if(J){if(S===void 0)throw Error(n(407));S=S()}else S=m();var oe=!ua((Cr||G).memoizedState,S);oe&&(G.memoizedState=S,yn=!0),G=G.queue;var me=gg.bind(null,j,G,d);if(Cc(2048,8,me,[d]),G.getSnapshot!==m||oe||nn!==null&&nn.memoizedState.tag&1){if(j.flags|=2048,ol(9,wd(),mg.bind(null,j,G,S,m),null),Mr===null)throw Error(n(349));J||(wi&124)!==0||pg(j,m,S)}return S}function pg(d,m,S){d.flags|=16384,d={getSnapshot:m,value:S},m=ar.updateQueue,m===null?(m=$h(),ar.updateQueue=m,m.stores=[d]):(S=m.stores,S===null?m.stores=[d]:S.push(d))}function mg(d,m,S,j){m.value=S,m.getSnapshot=j,vg(m)&&bg(d)}function gg(d,m,S){return S(function(){vg(m)&&bg(d)})}function vg(d){var m=d.getSnapshot;d=d.value;try{var S=m();return!ua(d,S)}catch{return!0}}function bg(d){var m=Jo(d,2);m!==null&&ga(m,d,2)}function Wh(d){var m=aa();if(typeof d=="function"){var S=d;if(d=S(),yo){lt(!0);try{S()}finally{lt(!1)}}}return m.memoizedState=m.baseState=d,m.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:d},m}function xg(d,m,S,j){return d.baseState=S,Hh(d,Cr,typeof j=="function"?j:Vs)}function f6(d,m,S,j,G){if(Sd(d))throw Error(n(485));if(d=m.action,d!==null){var J={payload:G,action:d,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(oe){J.listeners.push(oe)}};w.T!==null?S(!0):J.isTransition=!1,j(J),S=m.pending,S===null?(J.next=m.pending=J,yg(m,J)):(J.next=S.next,m.pending=S.next=J)}}function yg(d,m){var S=m.action,j=m.payload,G=d.state;if(m.isTransition){var J=w.T,oe={};w.T=oe;try{var me=S(G,j),Oe=w.S;Oe!==null&&Oe(oe,me),wg(d,m,me)}catch(Ke){Gh(d,m,Ke)}finally{w.T=J}}else try{J=S(G,j),wg(d,m,J)}catch(Ke){Gh(d,m,Ke)}}function wg(d,m,S){S!==null&&typeof S=="object"&&typeof S.then=="function"?S.then(function(j){_g(d,m,j)},function(j){return Gh(d,m,j)}):_g(d,m,S)}function _g(d,m,S){m.status="fulfilled",m.value=S,Sg(m),d.state=S,m=d.pending,m!==null&&(S=m.next,S===m?d.pending=null:(S=S.next,m.next=S,yg(d,S)))}function Gh(d,m,S){var j=d.pending;if(d.pending=null,j!==null){j=j.next;do m.status="rejected",m.reason=S,Sg(m),m=m.next;while(m!==j)}d.action=null}function Sg(d){d=d.listeners;for(var m=0;m<d.length;m++)(0,d[m])()}function kg(d,m){return m}function Eg(d,m){if(wr){var S=Mr.formState;if(S!==null){e:{var j=ar;if(wr){if(Hr){t:{for(var G=Hr,J=ps;G.nodeType!==8;){if(!J){G=null;break t}if(G=Ja(G.nextSibling),G===null){G=null;break t}}J=G.data,G=J==="F!"||J==="F"?G:null}if(G){Hr=Ja(G.nextSibling),j=G.data==="F!";break e}}go(j)}j=!1}j&&(m=S[0])}}return S=aa(),S.memoizedState=S.baseState=m,j={pending:null,lanes:0,dispatch:null,lastRenderedReducer:kg,lastRenderedState:m},S.queue=j,S=Hg.bind(null,ar,j),j.dispatch=S,j=Wh(!1),J=Jh.bind(null,ar,!1,j.queue),j=aa(),G={state:m,dispatch:null,action:d,pending:null},j.queue=G,S=f6.bind(null,ar,G,J,S),G.dispatch=S,j.memoizedState=d,[m,S,!1]}function Tg(d){var m=an();return Ag(m,Cr,d)}function Ag(d,m,S){if(m=Hh(d,m,kg)[0],d=yd(Vs)[0],typeof m=="object"&&m!==null&&typeof m.then=="function")try{var j=Ac(m)}catch(oe){throw oe===wc?pd:oe}else j=m;m=an();var G=m.queue,J=G.dispatch;return S!==m.memoizedState&&(ar.flags|=2048,ol(9,wd(),h6.bind(null,G,S),null)),[j,J,d]}function h6(d,m){d.action=m}function Cg(d){var m=an(),S=Cr;if(S!==null)return Ag(m,S,d);an(),m=m.memoizedState,S=an();var j=S.queue.dispatch;return S.memoizedState=d,[m,j,!1]}function ol(d,m,S,j){return d={tag:d,create:S,deps:j,inst:m,next:null},m=ar.updateQueue,m===null&&(m=$h(),ar.updateQueue=m),S=m.lastEffect,S===null?m.lastEffect=d.next=d:(j=S.next,S.next=d,d.next=j,m.lastEffect=d),d}function wd(){return{destroy:void 0,resource:void 0}}function Ng(){return an().memoizedState}function _d(d,m,S,j){var G=aa();j=j===void 0?null:j,ar.flags|=d,G.memoizedState=ol(1|m,wd(),S,j)}function Cc(d,m,S,j){var G=an();j=j===void 0?null:j;var J=G.memoizedState.inst;Cr!==null&&j!==null&&Ph(j,Cr.memoizedState.deps)?G.memoizedState=ol(m,J,S,j):(ar.flags|=d,G.memoizedState=ol(1|m,J,S,j))}function jg(d,m){_d(8390656,8,d,m)}function Og(d,m){Cc(2048,8,d,m)}function Dg(d,m){return Cc(4,2,d,m)}function Rg(d,m){return Cc(4,4,d,m)}function Mg(d,m){if(typeof m=="function"){d=d();var S=m(d);return function(){typeof S=="function"?S():m(null)}}if(m!=null)return d=d(),m.current=d,function(){m.current=null}}function Fg(d,m,S){S=S!=null?S.concat([d]):null,Cc(4,4,Mg.bind(null,m,d),S)}function Yh(){}function Ig(d,m){var S=an();m=m===void 0?null:m;var j=S.memoizedState;return m!==null&&Ph(m,j[1])?j[0]:(S.memoizedState=[d,m],d)}function Pg(d,m){var S=an();m=m===void 0?null:m;var j=S.memoizedState;if(m!==null&&Ph(m,j[1]))return j[0];if(j=d(),yo){lt(!0);try{d()}finally{lt(!1)}}return S.memoizedState=[j,m],j}function Xh(d,m,S){return S===void 0||(wi&1073741824)!==0?d.memoizedState=m:(d.memoizedState=S,d=Uv(),ar.lanes|=d,Ci|=d,S)}function Lg(d,m,S,j){return ua(S,m)?S:al.current!==null?(d=Xh(d,S,j),ua(d,m)||(yn=!0),d):(wi&42)===0?(yn=!0,d.memoizedState=S):(d=Uv(),ar.lanes|=d,Ci|=d,m)}function Bg(d,m,S,j,G){var J=E.p;E.p=J!==0&&8>J?J:8;var oe=w.T,me={};w.T=me,Jh(d,!1,m,S);try{var Oe=G(),Ke=w.S;if(Ke!==null&&Ke(me,Oe),Oe!==null&&typeof Oe=="object"&&typeof Oe.then=="function"){var ft=c6(Oe,j);Nc(d,m,ft,ma(d))}else Nc(d,m,j,ma(d))}catch(bt){Nc(d,m,{then:function(){},status:"rejected",reason:bt},ma())}finally{E.p=J,w.T=oe}}function p6(){}function Kh(d,m,S,j){if(d.tag!==5)throw Error(n(476));var G=Ug(d).queue;Bg(d,G,m,A,S===null?p6:function(){return zg(d),S(j)})}function Ug(d){var m=d.memoizedState;if(m!==null)return m;m={memoizedState:A,baseState:A,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:A},next:null};var S={};return m.next={memoizedState:S,baseState:S,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:S},next:null},d.memoizedState=m,d=d.alternate,d!==null&&(d.memoizedState=m),m}function zg(d){var m=Ug(d).next.queue;Nc(d,m,{},ma())}function Zh(){return Fn(Gc)}function $g(){return an().memoizedState}function Vg(){return an().memoizedState}function m6(d){for(var m=d.return;m!==null;){switch(m.tag){case 24:case 3:var S=ma();d=xi(S);var j=yi(m,d,S);j!==null&&(ga(j,m,S),Sc(j,m,S)),m={cache:Ah()},d.payload=m;return}m=m.return}}function g6(d,m,S){var j=ma();S={lane:j,revertLane:0,action:S,hasEagerState:!1,eagerState:null,next:null},Sd(d)?qg(m,S):(S=vh(d,m,S,j),S!==null&&(ga(S,d,j),Wg(S,m,j)))}function Hg(d,m,S){var j=ma();Nc(d,m,S,j)}function Nc(d,m,S,j){var G={lane:j,revertLane:0,action:S,hasEagerState:!1,eagerState:null,next:null};if(Sd(d))qg(m,G);else{var J=d.alternate;if(d.lanes===0&&(J===null||J.lanes===0)&&(J=m.lastRenderedReducer,J!==null))try{var oe=m.lastRenderedState,me=J(oe,S);if(G.hasEagerState=!0,G.eagerState=me,ua(me,oe))return id(d,m,G,0),Mr===null&&sd(),!1}catch{}finally{}if(S=vh(d,m,G,j),S!==null)return ga(S,d,j),Wg(S,m,j),!0}return!1}function Jh(d,m,S,j){if(j={lane:2,revertLane:j0(),action:j,hasEagerState:!1,eagerState:null,next:null},Sd(d)){if(m)throw Error(n(479))}else m=vh(d,S,j,2),m!==null&&ga(m,d,2)}function Sd(d){var m=d.alternate;return d===ar||m!==null&&m===ar}function qg(d,m){sl=vd=!0;var S=d.pending;S===null?m.next=m:(m.next=S.next,S.next=m),d.pending=m}function Wg(d,m,S){if((S&4194048)!==0){var j=m.lanes;j&=d.pendingLanes,S|=j,m.lanes=S,je(d,S)}}var kd={readContext:Fn,use:xd,useCallback:Xr,useContext:Xr,useEffect:Xr,useImperativeHandle:Xr,useLayoutEffect:Xr,useInsertionEffect:Xr,useMemo:Xr,useReducer:Xr,useRef:Xr,useState:Xr,useDebugValue:Xr,useDeferredValue:Xr,useTransition:Xr,useSyncExternalStore:Xr,useId:Xr,useHostTransitionStatus:Xr,useFormState:Xr,useActionState:Xr,useOptimistic:Xr,useMemoCache:Xr,useCacheRefresh:Xr},Gg={readContext:Fn,use:xd,useCallback:function(d,m){return aa().memoizedState=[d,m===void 0?null:m],d},useContext:Fn,useEffect:jg,useImperativeHandle:function(d,m,S){S=S!=null?S.concat([d]):null,_d(4194308,4,Mg.bind(null,m,d),S)},useLayoutEffect:function(d,m){return _d(4194308,4,d,m)},useInsertionEffect:function(d,m){_d(4,2,d,m)},useMemo:function(d,m){var S=aa();m=m===void 0?null:m;var j=d();if(yo){lt(!0);try{d()}finally{lt(!1)}}return S.memoizedState=[j,m],j},useReducer:function(d,m,S){var j=aa();if(S!==void 0){var G=S(m);if(yo){lt(!0);try{S(m)}finally{lt(!1)}}}else G=m;return j.memoizedState=j.baseState=G,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:G},j.queue=d,d=d.dispatch=g6.bind(null,ar,d),[j.memoizedState,d]},useRef:function(d){var m=aa();return d={current:d},m.memoizedState=d},useState:function(d){d=Wh(d);var m=d.queue,S=Hg.bind(null,ar,m);return m.dispatch=S,[d.memoizedState,S]},useDebugValue:Yh,useDeferredValue:function(d,m){var S=aa();return Xh(S,d,m)},useTransition:function(){var d=Wh(!1);return d=Bg.bind(null,ar,d.queue,!0,!1),aa().memoizedState=d,[!1,d]},useSyncExternalStore:function(d,m,S){var j=ar,G=aa();if(wr){if(S===void 0)throw Error(n(407));S=S()}else{if(S=m(),Mr===null)throw Error(n(349));(hr&124)!==0||pg(j,m,S)}G.memoizedState=S;var J={value:S,getSnapshot:m};return G.queue=J,jg(gg.bind(null,j,J,d),[d]),j.flags|=2048,ol(9,wd(),mg.bind(null,j,J,S,m),null),S},useId:function(){var d=aa(),m=Mr.identifierPrefix;if(wr){var S=Us,j=Bs;S=(j&~(1<<32-tt(j)-1)).toString(32)+S,m=""+m+"R"+S,S=bd++,0<S&&(m+="H"+S.toString(32)),m+=""}else S=u6++,m=""+m+"r"+S.toString(32)+"";return d.memoizedState=m},useHostTransitionStatus:Zh,useFormState:Eg,useActionState:Eg,useOptimistic:function(d){var m=aa();m.memoizedState=m.baseState=d;var S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return m.queue=S,m=Jh.bind(null,ar,!0,S),S.dispatch=m,[d,m]},useMemoCache:Vh,useCacheRefresh:function(){return aa().memoizedState=m6.bind(null,ar)}},Yg={readContext:Fn,use:xd,useCallback:Ig,useContext:Fn,useEffect:Og,useImperativeHandle:Fg,useInsertionEffect:Dg,useLayoutEffect:Rg,useMemo:Pg,useReducer:yd,useRef:Ng,useState:function(){return yd(Vs)},useDebugValue:Yh,useDeferredValue:function(d,m){var S=an();return Lg(S,Cr.memoizedState,d,m)},useTransition:function(){var d=yd(Vs)[0],m=an().memoizedState;return[typeof d=="boolean"?d:Ac(d),m]},useSyncExternalStore:hg,useId:$g,useHostTransitionStatus:Zh,useFormState:Tg,useActionState:Tg,useOptimistic:function(d,m){var S=an();return xg(S,Cr,d,m)},useMemoCache:Vh,useCacheRefresh:Vg},v6={readContext:Fn,use:xd,useCallback:Ig,useContext:Fn,useEffect:Og,useImperativeHandle:Fg,useInsertionEffect:Dg,useLayoutEffect:Rg,useMemo:Pg,useReducer:qh,useRef:Ng,useState:function(){return qh(Vs)},useDebugValue:Yh,useDeferredValue:function(d,m){var S=an();return Cr===null?Xh(S,d,m):Lg(S,Cr.memoizedState,d,m)},useTransition:function(){var d=qh(Vs)[0],m=an().memoizedState;return[typeof d=="boolean"?d:Ac(d),m]},useSyncExternalStore:hg,useId:$g,useHostTransitionStatus:Zh,useFormState:Cg,useActionState:Cg,useOptimistic:function(d,m){var S=an();return Cr!==null?xg(S,Cr,d,m):(S.baseState=d,[d,S.queue.dispatch])},useMemoCache:Vh,useCacheRefresh:Vg},ll=null,jc=0;function Ed(d){var m=jc;return jc+=1,ll===null&&(ll=[]),sg(ll,d,m)}function Oc(d,m){m=m.props.ref,d.ref=m!==void 0?m:null}function Td(d,m){throw m.$$typeof===p?Error(n(525)):(d=Object.prototype.toString.call(m),Error(n(31,d==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":d)))}function Xg(d){var m=d._init;return m(d._payload)}function Kg(d){function m(He,Ie){if(d){var Ye=He.deletions;Ye===null?(He.deletions=[Ie],He.flags|=16):Ye.push(Ie)}}function S(He,Ie){if(!d)return null;for(;Ie!==null;)m(He,Ie),Ie=Ie.sibling;return null}function j(He){for(var Ie=new Map;He!==null;)He.key!==null?Ie.set(He.key,He):Ie.set(He.index,He),He=He.sibling;return Ie}function G(He,Ie){return He=Ls(He,Ie),He.index=0,He.sibling=null,He}function J(He,Ie,Ye){return He.index=Ye,d?(Ye=He.alternate,Ye!==null?(Ye=Ye.index,Ye<Ie?(He.flags|=67108866,Ie):Ye):(He.flags|=67108866,Ie)):(He.flags|=1048576,Ie)}function oe(He){return d&&He.alternate===null&&(He.flags|=67108866),He}function me(He,Ie,Ye,mt){return Ie===null||Ie.tag!==6?(Ie=xh(Ye,He.mode,mt),Ie.return=He,Ie):(Ie=G(Ie,Ye),Ie.return=He,Ie)}function Oe(He,Ie,Ye,mt){var Ft=Ye.type;return Ft===v?ft(He,Ie,Ye.props.children,mt,Ye.key):Ie!==null&&(Ie.elementType===Ft||typeof Ft=="object"&&Ft!==null&&Ft.$$typeof===V&&Xg(Ft)===Ie.type)?(Ie=G(Ie,Ye.props),Oc(Ie,Ye),Ie.return=He,Ie):(Ie=ld(Ye.type,Ye.key,Ye.props,null,He.mode,mt),Oc(Ie,Ye),Ie.return=He,Ie)}function Ke(He,Ie,Ye,mt){return Ie===null||Ie.tag!==4||Ie.stateNode.containerInfo!==Ye.containerInfo||Ie.stateNode.implementation!==Ye.implementation?(Ie=yh(Ye,He.mode,mt),Ie.return=He,Ie):(Ie=G(Ie,Ye.children||[]),Ie.return=He,Ie)}function ft(He,Ie,Ye,mt,Ft){return Ie===null||Ie.tag!==7?(Ie=fo(Ye,He.mode,mt,Ft),Ie.return=He,Ie):(Ie=G(Ie,Ye),Ie.return=He,Ie)}function bt(He,Ie,Ye){if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint")return Ie=xh(""+Ie,He.mode,Ye),Ie.return=He,Ie;if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case f:return Ye=ld(Ie.type,Ie.key,Ie.props,null,He.mode,Ye),Oc(Ye,Ie),Ye.return=He,Ye;case h:return Ie=yh(Ie,He.mode,Ye),Ie.return=He,Ie;case V:var mt=Ie._init;return Ie=mt(Ie._payload),bt(He,Ie,Ye)}if(C(Ie)||H(Ie))return Ie=fo(Ie,He.mode,Ye,null),Ie.return=He,Ie;if(typeof Ie.then=="function")return bt(He,Ed(Ie),Ye);if(Ie.$$typeof===k)return bt(He,fd(He,Ie),Ye);Td(He,Ie)}return null}function Je(He,Ie,Ye,mt){var Ft=Ie!==null?Ie.key:null;if(typeof Ye=="string"&&Ye!==""||typeof Ye=="number"||typeof Ye=="bigint")return Ft!==null?null:me(He,Ie,""+Ye,mt);if(typeof Ye=="object"&&Ye!==null){switch(Ye.$$typeof){case f:return Ye.key===Ft?Oe(He,Ie,Ye,mt):null;case h:return Ye.key===Ft?Ke(He,Ie,Ye,mt):null;case V:return Ft=Ye._init,Ye=Ft(Ye._payload),Je(He,Ie,Ye,mt)}if(C(Ye)||H(Ye))return Ft!==null?null:ft(He,Ie,Ye,mt,null);if(typeof Ye.then=="function")return Je(He,Ie,Ed(Ye),mt);if(Ye.$$typeof===k)return Je(He,Ie,fd(He,Ye),mt);Td(He,Ye)}return null}function et(He,Ie,Ye,mt,Ft){if(typeof mt=="string"&&mt!==""||typeof mt=="number"||typeof mt=="bigint")return He=He.get(Ye)||null,me(Ie,He,""+mt,Ft);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case f:return He=He.get(mt.key===null?Ye:mt.key)||null,Oe(Ie,He,mt,Ft);case h:return He=He.get(mt.key===null?Ye:mt.key)||null,Ke(Ie,He,mt,Ft);case V:var or=mt._init;return mt=or(mt._payload),et(He,Ie,Ye,mt,Ft)}if(C(mt)||H(mt))return He=He.get(Ye)||null,ft(Ie,He,mt,Ft,null);if(typeof mt.then=="function")return et(He,Ie,Ye,Ed(mt),Ft);if(mt.$$typeof===k)return et(He,Ie,Ye,fd(Ie,mt),Ft);Td(Ie,mt)}return null}function Zt(He,Ie,Ye,mt){for(var Ft=null,or=null,zt=Ie,Yt=Ie=0,_n=null;zt!==null&&Yt<Ye.length;Yt++){zt.index>Yt?(_n=zt,zt=null):_n=zt.sibling;var yr=Je(He,zt,Ye[Yt],mt);if(yr===null){zt===null&&(zt=_n);break}d&&zt&&yr.alternate===null&&m(He,zt),Ie=J(yr,Ie,Yt),or===null?Ft=yr:or.sibling=yr,or=yr,zt=_n}if(Yt===Ye.length)return S(He,zt),wr&&po(He,Yt),Ft;if(zt===null){for(;Yt<Ye.length;Yt++)zt=bt(He,Ye[Yt],mt),zt!==null&&(Ie=J(zt,Ie,Yt),or===null?Ft=zt:or.sibling=zt,or=zt);return wr&&po(He,Yt),Ft}for(zt=j(zt);Yt<Ye.length;Yt++)_n=et(zt,He,Yt,Ye[Yt],mt),_n!==null&&(d&&_n.alternate!==null&&zt.delete(_n.key===null?Yt:_n.key),Ie=J(_n,Ie,Yt),or===null?Ft=_n:or.sibling=_n,or=_n);return d&&zt.forEach(function(Pi){return m(He,Pi)}),wr&&po(He,Yt),Ft}function qt(He,Ie,Ye,mt){if(Ye==null)throw Error(n(151));for(var Ft=null,or=null,zt=Ie,Yt=Ie=0,_n=null,yr=Ye.next();zt!==null&&!yr.done;Yt++,yr=Ye.next()){zt.index>Yt?(_n=zt,zt=null):_n=zt.sibling;var Pi=Je(He,zt,yr.value,mt);if(Pi===null){zt===null&&(zt=_n);break}d&&zt&&Pi.alternate===null&&m(He,zt),Ie=J(Pi,Ie,Yt),or===null?Ft=Pi:or.sibling=Pi,or=Pi,zt=_n}if(yr.done)return S(He,zt),wr&&po(He,Yt),Ft;if(zt===null){for(;!yr.done;Yt++,yr=Ye.next())yr=bt(He,yr.value,mt),yr!==null&&(Ie=J(yr,Ie,Yt),or===null?Ft=yr:or.sibling=yr,or=yr);return wr&&po(He,Yt),Ft}for(zt=j(zt);!yr.done;Yt++,yr=Ye.next())yr=et(zt,He,Yt,yr.value,mt),yr!==null&&(d&&yr.alternate!==null&&zt.delete(yr.key===null?Yt:yr.key),Ie=J(yr,Ie,Yt),or===null?Ft=yr:or.sibling=yr,or=yr);return d&&zt.forEach(function(b5){return m(He,b5)}),wr&&po(He,Yt),Ft}function jr(He,Ie,Ye,mt){if(typeof Ye=="object"&&Ye!==null&&Ye.type===v&&Ye.key===null&&(Ye=Ye.props.children),typeof Ye=="object"&&Ye!==null){switch(Ye.$$typeof){case f:e:{for(var Ft=Ye.key;Ie!==null;){if(Ie.key===Ft){if(Ft=Ye.type,Ft===v){if(Ie.tag===7){S(He,Ie.sibling),mt=G(Ie,Ye.props.children),mt.return=He,He=mt;break e}}else if(Ie.elementType===Ft||typeof Ft=="object"&&Ft!==null&&Ft.$$typeof===V&&Xg(Ft)===Ie.type){S(He,Ie.sibling),mt=G(Ie,Ye.props),Oc(mt,Ye),mt.return=He,He=mt;break e}S(He,Ie);break}else m(He,Ie);Ie=Ie.sibling}Ye.type===v?(mt=fo(Ye.props.children,He.mode,mt,Ye.key),mt.return=He,He=mt):(mt=ld(Ye.type,Ye.key,Ye.props,null,He.mode,mt),Oc(mt,Ye),mt.return=He,He=mt)}return oe(He);case h:e:{for(Ft=Ye.key;Ie!==null;){if(Ie.key===Ft)if(Ie.tag===4&&Ie.stateNode.containerInfo===Ye.containerInfo&&Ie.stateNode.implementation===Ye.implementation){S(He,Ie.sibling),mt=G(Ie,Ye.children||[]),mt.return=He,He=mt;break e}else{S(He,Ie);break}else m(He,Ie);Ie=Ie.sibling}mt=yh(Ye,He.mode,mt),mt.return=He,He=mt}return oe(He);case V:return Ft=Ye._init,Ye=Ft(Ye._payload),jr(He,Ie,Ye,mt)}if(C(Ye))return Zt(He,Ie,Ye,mt);if(H(Ye)){if(Ft=H(Ye),typeof Ft!="function")throw Error(n(150));return Ye=Ft.call(Ye),qt(He,Ie,Ye,mt)}if(typeof Ye.then=="function")return jr(He,Ie,Ed(Ye),mt);if(Ye.$$typeof===k)return jr(He,Ie,fd(He,Ye),mt);Td(He,Ye)}return typeof Ye=="string"&&Ye!==""||typeof Ye=="number"||typeof Ye=="bigint"?(Ye=""+Ye,Ie!==null&&Ie.tag===6?(S(He,Ie.sibling),mt=G(Ie,Ye),mt.return=He,He=mt):(S(He,Ie),mt=xh(Ye,He.mode,mt),mt.return=He,He=mt),oe(He)):S(He,Ie)}return function(He,Ie,Ye,mt){try{jc=0;var Ft=jr(He,Ie,Ye,mt);return ll=null,Ft}catch(zt){if(zt===wc||zt===pd)throw zt;var or=da(29,zt,null,He.mode);return or.lanes=mt,or.return=He,or}finally{}}}var cl=Kg(!0),Zg=Kg(!1),Da=U(null),ms=null;function _i(d){var m=d.alternate;K(mn,mn.current&1),K(Da,d),ms===null&&(m===null||al.current!==null||m.memoizedState!==null)&&(ms=d)}function Jg(d){if(d.tag===22){if(K(mn,mn.current),K(Da,d),ms===null){var m=d.alternate;m!==null&&m.memoizedState!==null&&(ms=d)}}else Si()}function Si(){K(mn,mn.current),K(Da,Da.current)}function Hs(d){P(Da),ms===d&&(ms=null),P(mn)}var mn=U(0);function Ad(d){for(var m=d;m!==null;){if(m.tag===13){var S=m.memoizedState;if(S!==null&&(S=S.dehydrated,S===null||S.data==="$?"||$0(S)))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}function Qh(d,m,S,j){m=d.memoizedState,S=S(j,m),S=S==null?m:u({},m,S),d.memoizedState=S,d.lanes===0&&(d.updateQueue.baseState=S)}var e0={enqueueSetState:function(d,m,S){d=d._reactInternals;var j=ma(),G=xi(j);G.payload=m,S!=null&&(G.callback=S),m=yi(d,G,j),m!==null&&(ga(m,d,j),Sc(m,d,j))},enqueueReplaceState:function(d,m,S){d=d._reactInternals;var j=ma(),G=xi(j);G.tag=1,G.payload=m,S!=null&&(G.callback=S),m=yi(d,G,j),m!==null&&(ga(m,d,j),Sc(m,d,j))},enqueueForceUpdate:function(d,m){d=d._reactInternals;var S=ma(),j=xi(S);j.tag=2,m!=null&&(j.callback=m),m=yi(d,j,S),m!==null&&(ga(m,d,S),Sc(m,d,S))}};function Qg(d,m,S,j,G,J,oe){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(j,J,oe):m.prototype&&m.prototype.isPureReactComponent?!hc(S,j)||!hc(G,J):!0}function ev(d,m,S,j){d=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(S,j),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(S,j),m.state!==d&&e0.enqueueReplaceState(m,m.state,null)}function wo(d,m){var S=m;if("ref"in m){S={};for(var j in m)j!=="ref"&&(S[j]=m[j])}if(d=d.defaultProps){S===m&&(S=u({},S));for(var G in d)S[G]===void 0&&(S[G]=d[G])}return S}var Cd=typeof reportError=="function"?reportError:function(d){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var m=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof d=="object"&&d!==null&&typeof d.message=="string"?String(d.message):String(d),error:d});if(!window.dispatchEvent(m))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",d);return}console.error(d)};function tv(d){Cd(d)}function rv(d){console.error(d)}function nv(d){Cd(d)}function Nd(d,m){try{var S=d.onUncaughtError;S(m.value,{componentStack:m.stack})}catch(j){setTimeout(function(){throw j})}}function av(d,m,S){try{var j=d.onCaughtError;j(S.value,{componentStack:S.stack,errorBoundary:m.tag===1?m.stateNode:null})}catch(G){setTimeout(function(){throw G})}}function t0(d,m,S){return S=xi(S),S.tag=3,S.payload={element:null},S.callback=function(){Nd(d,m)},S}function sv(d){return d=xi(d),d.tag=3,d}function iv(d,m,S,j){var G=S.type.getDerivedStateFromError;if(typeof G=="function"){var J=j.value;d.payload=function(){return G(J)},d.callback=function(){av(m,S,j)}}var oe=S.stateNode;oe!==null&&typeof oe.componentDidCatch=="function"&&(d.callback=function(){av(m,S,j),typeof G!="function"&&(Ni===null?Ni=new Set([this]):Ni.add(this));var me=j.stack;this.componentDidCatch(j.value,{componentStack:me!==null?me:""})})}function b6(d,m,S,j,G){if(S.flags|=32768,j!==null&&typeof j=="object"&&typeof j.then=="function"){if(m=S.alternate,m!==null&&bc(m,S,G,!0),S=Da.current,S!==null){switch(S.tag){case 13:return ms===null?E0():S.alternate===null&&qr===0&&(qr=3),S.flags&=-257,S.flags|=65536,S.lanes=G,j===jh?S.flags|=16384:(m=S.updateQueue,m===null?S.updateQueue=new Set([j]):m.add(j),A0(d,j,G)),!1;case 22:return S.flags|=65536,j===jh?S.flags|=16384:(m=S.updateQueue,m===null?(m={transitions:null,markerInstances:null,retryQueue:new Set([j])},S.updateQueue=m):(S=m.retryQueue,S===null?m.retryQueue=new Set([j]):S.add(j)),A0(d,j,G)),!1}throw Error(n(435,S.tag))}return A0(d,j,G),E0(),!1}if(wr)return m=Da.current,m!==null?((m.flags&65536)===0&&(m.flags|=256),m.flags|=65536,m.lanes=G,j!==Sh&&(d=Error(n(422),{cause:j}),vc(Ca(d,S)))):(j!==Sh&&(m=Error(n(423),{cause:j}),vc(Ca(m,S))),d=d.current.alternate,d.flags|=65536,G&=-G,d.lanes|=G,j=Ca(j,S),G=t0(d.stateNode,j,G),Rh(d,G),qr!==4&&(qr=2)),!1;var J=Error(n(520),{cause:j});if(J=Ca(J,S),Lc===null?Lc=[J]:Lc.push(J),qr!==4&&(qr=2),m===null)return!0;j=Ca(j,S),S=m;do{switch(S.tag){case 3:return S.flags|=65536,d=G&-G,S.lanes|=d,d=t0(S.stateNode,j,d),Rh(S,d),!1;case 1:if(m=S.type,J=S.stateNode,(S.flags&128)===0&&(typeof m.getDerivedStateFromError=="function"||J!==null&&typeof J.componentDidCatch=="function"&&(Ni===null||!Ni.has(J))))return S.flags|=65536,G&=-G,S.lanes|=G,G=sv(G),iv(G,d,S,j),Rh(S,G),!1}S=S.return}while(S!==null);return!1}var ov=Error(n(461)),yn=!1;function En(d,m,S,j){m.child=d===null?Zg(m,null,S,j):cl(m,d.child,S,j)}function lv(d,m,S,j,G){S=S.render;var J=m.ref;if("ref"in j){var oe={};for(var me in j)me!=="ref"&&(oe[me]=j[me])}else oe=j;return bo(m),j=Lh(d,m,S,oe,J,G),me=Bh(),d!==null&&!yn?(Uh(d,m,G),qs(d,m,G)):(wr&&me&&wh(m),m.flags|=1,En(d,m,j,G),m.child)}function cv(d,m,S,j,G){if(d===null){var J=S.type;return typeof J=="function"&&!bh(J)&&J.defaultProps===void 0&&S.compare===null?(m.tag=15,m.type=J,uv(d,m,J,j,G)):(d=ld(S.type,null,j,m,m.mode,G),d.ref=m.ref,d.return=m,m.child=d)}if(J=d.child,!c0(d,G)){var oe=J.memoizedProps;if(S=S.compare,S=S!==null?S:hc,S(oe,j)&&d.ref===m.ref)return qs(d,m,G)}return m.flags|=1,d=Ls(J,j),d.ref=m.ref,d.return=m,m.child=d}function uv(d,m,S,j,G){if(d!==null){var J=d.memoizedProps;if(hc(J,j)&&d.ref===m.ref)if(yn=!1,m.pendingProps=j=J,c0(d,G))(d.flags&131072)!==0&&(yn=!0);else return m.lanes=d.lanes,qs(d,m,G)}return r0(d,m,S,j,G)}function dv(d,m,S){var j=m.pendingProps,G=j.children,J=d!==null?d.memoizedState:null;if(j.mode==="hidden"){if((m.flags&128)!==0){if(j=J!==null?J.baseLanes|S:S,d!==null){for(G=m.child=d.child,J=0;G!==null;)J=J|G.lanes|G.childLanes,G=G.sibling;m.childLanes=J&~j}else m.childLanes=0,m.child=null;return fv(d,m,j,S)}if((S&536870912)!==0)m.memoizedState={baseLanes:0,cachePool:null},d!==null&&hd(m,J!==null?J.cachePool:null),J!==null?ug(m,J):Fh(),Jg(m);else return m.lanes=m.childLanes=536870912,fv(d,m,J!==null?J.baseLanes|S:S,S)}else J!==null?(hd(m,J.cachePool),ug(m,J),Si(),m.memoizedState=null):(d!==null&&hd(m,null),Fh(),Si());return En(d,m,G,S),m.child}function fv(d,m,S,j){var G=Nh();return G=G===null?null:{parent:pn._currentValue,pool:G},m.memoizedState={baseLanes:S,cachePool:G},d!==null&&hd(m,null),Fh(),Jg(m),d!==null&&bc(d,m,j,!0),null}function jd(d,m){var S=m.ref;if(S===null)d!==null&&d.ref!==null&&(m.flags|=4194816);else{if(typeof S!="function"&&typeof S!="object")throw Error(n(284));(d===null||d.ref!==S)&&(m.flags|=4194816)}}function r0(d,m,S,j,G){return bo(m),S=Lh(d,m,S,j,void 0,G),j=Bh(),d!==null&&!yn?(Uh(d,m,G),qs(d,m,G)):(wr&&j&&wh(m),m.flags|=1,En(d,m,S,G),m.child)}function hv(d,m,S,j,G,J){return bo(m),m.updateQueue=null,S=fg(m,j,S,G),dg(d),j=Bh(),d!==null&&!yn?(Uh(d,m,J),qs(d,m,J)):(wr&&j&&wh(m),m.flags|=1,En(d,m,S,J),m.child)}function pv(d,m,S,j,G){if(bo(m),m.stateNode===null){var J=Qo,oe=S.contextType;typeof oe=="object"&&oe!==null&&(J=Fn(oe)),J=new S(j,J),m.memoizedState=J.state!==null&&J.state!==void 0?J.state:null,J.updater=e0,m.stateNode=J,J._reactInternals=m,J=m.stateNode,J.props=j,J.state=m.memoizedState,J.refs={},Oh(m),oe=S.contextType,J.context=typeof oe=="object"&&oe!==null?Fn(oe):Qo,J.state=m.memoizedState,oe=S.getDerivedStateFromProps,typeof oe=="function"&&(Qh(m,S,oe,j),J.state=m.memoizedState),typeof S.getDerivedStateFromProps=="function"||typeof J.getSnapshotBeforeUpdate=="function"||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(oe=J.state,typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount(),oe!==J.state&&e0.enqueueReplaceState(J,J.state,null),Ec(m,j,J,G),kc(),J.state=m.memoizedState),typeof J.componentDidMount=="function"&&(m.flags|=4194308),j=!0}else if(d===null){J=m.stateNode;var me=m.memoizedProps,Oe=wo(S,me);J.props=Oe;var Ke=J.context,ft=S.contextType;oe=Qo,typeof ft=="object"&&ft!==null&&(oe=Fn(ft));var bt=S.getDerivedStateFromProps;ft=typeof bt=="function"||typeof J.getSnapshotBeforeUpdate=="function",me=m.pendingProps!==me,ft||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(me||Ke!==oe)&&ev(m,J,j,oe),bi=!1;var Je=m.memoizedState;J.state=Je,Ec(m,j,J,G),kc(),Ke=m.memoizedState,me||Je!==Ke||bi?(typeof bt=="function"&&(Qh(m,S,bt,j),Ke=m.memoizedState),(Oe=bi||Qg(m,S,Oe,j,Je,Ke,oe))?(ft||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount()),typeof J.componentDidMount=="function"&&(m.flags|=4194308)):(typeof J.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=j,m.memoizedState=Ke),J.props=j,J.state=Ke,J.context=oe,j=Oe):(typeof J.componentDidMount=="function"&&(m.flags|=4194308),j=!1)}else{J=m.stateNode,Dh(d,m),oe=m.memoizedProps,ft=wo(S,oe),J.props=ft,bt=m.pendingProps,Je=J.context,Ke=S.contextType,Oe=Qo,typeof Ke=="object"&&Ke!==null&&(Oe=Fn(Ke)),me=S.getDerivedStateFromProps,(Ke=typeof me=="function"||typeof J.getSnapshotBeforeUpdate=="function")||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(oe!==bt||Je!==Oe)&&ev(m,J,j,Oe),bi=!1,Je=m.memoizedState,J.state=Je,Ec(m,j,J,G),kc();var et=m.memoizedState;oe!==bt||Je!==et||bi||d!==null&&d.dependencies!==null&&dd(d.dependencies)?(typeof me=="function"&&(Qh(m,S,me,j),et=m.memoizedState),(ft=bi||Qg(m,S,ft,j,Je,et,Oe)||d!==null&&d.dependencies!==null&&dd(d.dependencies))?(Ke||typeof J.UNSAFE_componentWillUpdate!="function"&&typeof J.componentWillUpdate!="function"||(typeof J.componentWillUpdate=="function"&&J.componentWillUpdate(j,et,Oe),typeof J.UNSAFE_componentWillUpdate=="function"&&J.UNSAFE_componentWillUpdate(j,et,Oe)),typeof J.componentDidUpdate=="function"&&(m.flags|=4),typeof J.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof J.componentDidUpdate!="function"||oe===d.memoizedProps&&Je===d.memoizedState||(m.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||oe===d.memoizedProps&&Je===d.memoizedState||(m.flags|=1024),m.memoizedProps=j,m.memoizedState=et),J.props=j,J.state=et,J.context=Oe,j=ft):(typeof J.componentDidUpdate!="function"||oe===d.memoizedProps&&Je===d.memoizedState||(m.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||oe===d.memoizedProps&&Je===d.memoizedState||(m.flags|=1024),j=!1)}return J=j,jd(d,m),j=(m.flags&128)!==0,J||j?(J=m.stateNode,S=j&&typeof S.getDerivedStateFromError!="function"?null:J.render(),m.flags|=1,d!==null&&j?(m.child=cl(m,d.child,null,G),m.child=cl(m,null,S,G)):En(d,m,S,G),m.memoizedState=J.state,d=m.child):d=qs(d,m,G),d}function mv(d,m,S,j){return gc(),m.flags|=256,En(d,m,S,j),m.child}var n0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function a0(d){return{baseLanes:d,cachePool:rg()}}function s0(d,m,S){return d=d!==null?d.childLanes&~S:0,m&&(d|=Ra),d}function gv(d,m,S){var j=m.pendingProps,G=!1,J=(m.flags&128)!==0,oe;if((oe=J)||(oe=d!==null&&d.memoizedState===null?!1:(mn.current&2)!==0),oe&&(G=!0,m.flags&=-129),oe=(m.flags&32)!==0,m.flags&=-33,d===null){if(wr){if(G?_i(m):Si(),wr){var me=Hr,Oe;if(Oe=me){e:{for(Oe=me,me=ps;Oe.nodeType!==8;){if(!me){me=null;break e}if(Oe=Ja(Oe.nextSibling),Oe===null){me=null;break e}}me=Oe}me!==null?(m.memoizedState={dehydrated:me,treeContext:ho!==null?{id:Bs,overflow:Us}:null,retryLane:536870912,hydrationErrors:null},Oe=da(18,null,null,0),Oe.stateNode=me,Oe.return=m,m.child=Oe,Yn=m,Hr=null,Oe=!0):Oe=!1}Oe||go(m)}if(me=m.memoizedState,me!==null&&(me=me.dehydrated,me!==null))return $0(me)?m.lanes=32:m.lanes=536870912,null;Hs(m)}return me=j.children,j=j.fallback,G?(Si(),G=m.mode,me=Od({mode:"hidden",children:me},G),j=fo(j,G,S,null),me.return=m,j.return=m,me.sibling=j,m.child=me,G=m.child,G.memoizedState=a0(S),G.childLanes=s0(d,oe,S),m.memoizedState=n0,j):(_i(m),i0(m,me))}if(Oe=d.memoizedState,Oe!==null&&(me=Oe.dehydrated,me!==null)){if(J)m.flags&256?(_i(m),m.flags&=-257,m=o0(d,m,S)):m.memoizedState!==null?(Si(),m.child=d.child,m.flags|=128,m=null):(Si(),G=j.fallback,me=m.mode,j=Od({mode:"visible",children:j.children},me),G=fo(G,me,S,null),G.flags|=2,j.return=m,G.return=m,j.sibling=G,m.child=j,cl(m,d.child,null,S),j=m.child,j.memoizedState=a0(S),j.childLanes=s0(d,oe,S),m.memoizedState=n0,m=G);else if(_i(m),$0(me)){if(oe=me.nextSibling&&me.nextSibling.dataset,oe)var Ke=oe.dgst;oe=Ke,j=Error(n(419)),j.stack="",j.digest=oe,vc({value:j,source:null,stack:null}),m=o0(d,m,S)}else if(yn||bc(d,m,S,!1),oe=(S&d.childLanes)!==0,yn||oe){if(oe=Mr,oe!==null&&(j=S&-S,j=(j&42)!==0?1:Qe(j),j=(j&(oe.suspendedLanes|S))!==0?0:j,j!==0&&j!==Oe.retryLane))throw Oe.retryLane=j,Jo(d,j),ga(oe,d,j),ov;me.data==="$?"||E0(),m=o0(d,m,S)}else me.data==="$?"?(m.flags|=192,m.child=d.child,m=null):(d=Oe.treeContext,Hr=Ja(me.nextSibling),Yn=m,wr=!0,mo=null,ps=!1,d!==null&&(ja[Oa++]=Bs,ja[Oa++]=Us,ja[Oa++]=ho,Bs=d.id,Us=d.overflow,ho=m),m=i0(m,j.children),m.flags|=4096);return m}return G?(Si(),G=j.fallback,me=m.mode,Oe=d.child,Ke=Oe.sibling,j=Ls(Oe,{mode:"hidden",children:j.children}),j.subtreeFlags=Oe.subtreeFlags&65011712,Ke!==null?G=Ls(Ke,G):(G=fo(G,me,S,null),G.flags|=2),G.return=m,j.return=m,j.sibling=G,m.child=j,j=G,G=m.child,me=d.child.memoizedState,me===null?me=a0(S):(Oe=me.cachePool,Oe!==null?(Ke=pn._currentValue,Oe=Oe.parent!==Ke?{parent:Ke,pool:Ke}:Oe):Oe=rg(),me={baseLanes:me.baseLanes|S,cachePool:Oe}),G.memoizedState=me,G.childLanes=s0(d,oe,S),m.memoizedState=n0,j):(_i(m),S=d.child,d=S.sibling,S=Ls(S,{mode:"visible",children:j.children}),S.return=m,S.sibling=null,d!==null&&(oe=m.deletions,oe===null?(m.deletions=[d],m.flags|=16):oe.push(d)),m.child=S,m.memoizedState=null,S)}function i0(d,m){return m=Od({mode:"visible",children:m},d.mode),m.return=d,d.child=m}function Od(d,m){return d=da(22,d,null,m),d.lanes=0,d.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},d}function o0(d,m,S){return cl(m,d.child,null,S),d=i0(m,m.pendingProps.children),d.flags|=2,m.memoizedState=null,d}function vv(d,m,S){d.lanes|=m;var j=d.alternate;j!==null&&(j.lanes|=m),Eh(d.return,m,S)}function l0(d,m,S,j,G){var J=d.memoizedState;J===null?d.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:j,tail:S,tailMode:G}:(J.isBackwards=m,J.rendering=null,J.renderingStartTime=0,J.last=j,J.tail=S,J.tailMode=G)}function bv(d,m,S){var j=m.pendingProps,G=j.revealOrder,J=j.tail;if(En(d,m,j.children,S),j=mn.current,(j&2)!==0)j=j&1|2,m.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=m.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&vv(d,S,m);else if(d.tag===19)vv(d,S,m);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===m)break e;for(;d.sibling===null;){if(d.return===null||d.return===m)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}j&=1}switch(K(mn,j),G){case"forwards":for(S=m.child,G=null;S!==null;)d=S.alternate,d!==null&&Ad(d)===null&&(G=S),S=S.sibling;S=G,S===null?(G=m.child,m.child=null):(G=S.sibling,S.sibling=null),l0(m,!1,G,S,J);break;case"backwards":for(S=null,G=m.child,m.child=null;G!==null;){if(d=G.alternate,d!==null&&Ad(d)===null){m.child=G;break}d=G.sibling,G.sibling=S,S=G,G=d}l0(m,!0,S,null,J);break;case"together":l0(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function qs(d,m,S){if(d!==null&&(m.dependencies=d.dependencies),Ci|=m.lanes,(S&m.childLanes)===0)if(d!==null){if(bc(d,m,S,!1),(S&m.childLanes)===0)return null}else return null;if(d!==null&&m.child!==d.child)throw Error(n(153));if(m.child!==null){for(d=m.child,S=Ls(d,d.pendingProps),m.child=S,S.return=m;d.sibling!==null;)d=d.sibling,S=S.sibling=Ls(d,d.pendingProps),S.return=m;S.sibling=null}return m.child}function c0(d,m){return(d.lanes&m)!==0?!0:(d=d.dependencies,!!(d!==null&&dd(d)))}function x6(d,m,S){switch(m.tag){case 3:L(m,m.stateNode.containerInfo),vi(m,pn,d.memoizedState.cache),gc();break;case 27:case 5:Z(m);break;case 4:L(m,m.stateNode.containerInfo);break;case 10:vi(m,m.type,m.memoizedProps.value);break;case 13:var j=m.memoizedState;if(j!==null)return j.dehydrated!==null?(_i(m),m.flags|=128,null):(S&m.child.childLanes)!==0?gv(d,m,S):(_i(m),d=qs(d,m,S),d!==null?d.sibling:null);_i(m);break;case 19:var G=(d.flags&128)!==0;if(j=(S&m.childLanes)!==0,j||(bc(d,m,S,!1),j=(S&m.childLanes)!==0),G){if(j)return bv(d,m,S);m.flags|=128}if(G=m.memoizedState,G!==null&&(G.rendering=null,G.tail=null,G.lastEffect=null),K(mn,mn.current),j)break;return null;case 22:case 23:return m.lanes=0,dv(d,m,S);case 24:vi(m,pn,d.memoizedState.cache)}return qs(d,m,S)}function xv(d,m,S){if(d!==null)if(d.memoizedProps!==m.pendingProps)yn=!0;else{if(!c0(d,S)&&(m.flags&128)===0)return yn=!1,x6(d,m,S);yn=(d.flags&131072)!==0}else yn=!1,wr&&(m.flags&1048576)!==0&&X1(m,ud,m.index);switch(m.lanes=0,m.tag){case 16:e:{d=m.pendingProps;var j=m.elementType,G=j._init;if(j=G(j._payload),m.type=j,typeof j=="function")bh(j)?(d=wo(j,d),m.tag=1,m=pv(null,m,j,d,S)):(m.tag=0,m=r0(null,m,j,d,S));else{if(j!=null){if(G=j.$$typeof,G===N){m.tag=11,m=lv(null,m,j,d,S);break e}else if(G===W){m.tag=14,m=cv(null,m,j,d,S);break e}}throw m=R(j)||j,Error(n(306,m,""))}}return m;case 0:return r0(d,m,m.type,m.pendingProps,S);case 1:return j=m.type,G=wo(j,m.pendingProps),pv(d,m,j,G,S);case 3:e:{if(L(m,m.stateNode.containerInfo),d===null)throw Error(n(387));j=m.pendingProps;var J=m.memoizedState;G=J.element,Dh(d,m),Ec(m,j,null,S);var oe=m.memoizedState;if(j=oe.cache,vi(m,pn,j),j!==J.cache&&Th(m,[pn],S,!0),kc(),j=oe.element,J.isDehydrated)if(J={element:j,isDehydrated:!1,cache:oe.cache},m.updateQueue.baseState=J,m.memoizedState=J,m.flags&256){m=mv(d,m,j,S);break e}else if(j!==G){G=Ca(Error(n(424)),m),vc(G),m=mv(d,m,j,S);break e}else{switch(d=m.stateNode.containerInfo,d.nodeType){case 9:d=d.body;break;default:d=d.nodeName==="HTML"?d.ownerDocument.body:d}for(Hr=Ja(d.firstChild),Yn=m,wr=!0,mo=null,ps=!0,S=Zg(m,null,j,S),m.child=S;S;)S.flags=S.flags&-3|4096,S=S.sibling}else{if(gc(),j===G){m=qs(d,m,S);break e}En(d,m,j,S)}m=m.child}return m;case 26:return jd(d,m),d===null?(S=Sb(m.type,null,m.pendingProps,null))?m.memoizedState=S:wr||(S=m.type,d=m.pendingProps,j=qd(z.current).createElement(S),j[It]=m,j[kt]=d,An(j,S,d),Re(j),m.stateNode=j):m.memoizedState=Sb(m.type,d.memoizedProps,m.pendingProps,d.memoizedState),null;case 27:return Z(m),d===null&&wr&&(j=m.stateNode=yb(m.type,m.pendingProps,z.current),Yn=m,ps=!0,G=Hr,Di(m.type)?(V0=G,Hr=Ja(j.firstChild)):Hr=G),En(d,m,m.pendingProps.children,S),jd(d,m),d===null&&(m.flags|=4194304),m.child;case 5:return d===null&&wr&&((G=j=Hr)&&(j=G6(j,m.type,m.pendingProps,ps),j!==null?(m.stateNode=j,Yn=m,Hr=Ja(j.firstChild),ps=!1,G=!0):G=!1),G||go(m)),Z(m),G=m.type,J=m.pendingProps,oe=d!==null?d.memoizedProps:null,j=J.children,B0(G,J)?j=null:oe!==null&&B0(G,oe)&&(m.flags|=32),m.memoizedState!==null&&(G=Lh(d,m,d6,null,null,S),Gc._currentValue=G),jd(d,m),En(d,m,j,S),m.child;case 6:return d===null&&wr&&((d=S=Hr)&&(S=Y6(S,m.pendingProps,ps),S!==null?(m.stateNode=S,Yn=m,Hr=null,d=!0):d=!1),d||go(m)),null;case 13:return gv(d,m,S);case 4:return L(m,m.stateNode.containerInfo),j=m.pendingProps,d===null?m.child=cl(m,null,j,S):En(d,m,j,S),m.child;case 11:return lv(d,m,m.type,m.pendingProps,S);case 7:return En(d,m,m.pendingProps,S),m.child;case 8:return En(d,m,m.pendingProps.children,S),m.child;case 12:return En(d,m,m.pendingProps.children,S),m.child;case 10:return j=m.pendingProps,vi(m,m.type,j.value),En(d,m,j.children,S),m.child;case 9:return G=m.type._context,j=m.pendingProps.children,bo(m),G=Fn(G),j=j(G),m.flags|=1,En(d,m,j,S),m.child;case 14:return cv(d,m,m.type,m.pendingProps,S);case 15:return uv(d,m,m.type,m.pendingProps,S);case 19:return bv(d,m,S);case 31:return j=m.pendingProps,S=m.mode,j={mode:j.mode,children:j.children},d===null?(S=Od(j,S),S.ref=m.ref,m.child=S,S.return=m,m=S):(S=Ls(d.child,j),S.ref=m.ref,m.child=S,S.return=m,m=S),m;case 22:return dv(d,m,S);case 24:return bo(m),j=Fn(pn),d===null?(G=Nh(),G===null&&(G=Mr,J=Ah(),G.pooledCache=J,J.refCount++,J!==null&&(G.pooledCacheLanes|=S),G=J),m.memoizedState={parent:j,cache:G},Oh(m),vi(m,pn,G)):((d.lanes&S)!==0&&(Dh(d,m),Ec(m,null,null,S),kc()),G=d.memoizedState,J=m.memoizedState,G.parent!==j?(G={parent:j,cache:j},m.memoizedState=G,m.lanes===0&&(m.memoizedState=m.updateQueue.baseState=G),vi(m,pn,j)):(j=J.cache,vi(m,pn,j),j!==G.cache&&Th(m,[pn],S,!0))),En(d,m,m.pendingProps.children,S),m.child;case 29:throw m.pendingProps}throw Error(n(156,m.tag))}function Ws(d){d.flags|=4}function yv(d,m){if(m.type!=="stylesheet"||(m.state.loading&4)!==0)d.flags&=-16777217;else if(d.flags|=16777216,!Cb(m)){if(m=Da.current,m!==null&&((hr&4194048)===hr?ms!==null:(hr&62914560)!==hr&&(hr&536870912)===0||m!==ms))throw _c=jh,ng;d.flags|=8192}}function Dd(d,m){m!==null&&(d.flags|=4),d.flags&16384&&(m=d.tag!==22?$e():536870912,d.lanes|=m,hl|=m)}function Dc(d,m){if(!wr)switch(d.tailMode){case"hidden":m=d.tail;for(var S=null;m!==null;)m.alternate!==null&&(S=m),m=m.sibling;S===null?d.tail=null:S.sibling=null;break;case"collapsed":S=d.tail;for(var j=null;S!==null;)S.alternate!==null&&(j=S),S=S.sibling;j===null?m||d.tail===null?d.tail=null:d.tail.sibling=null:j.sibling=null}}function Ur(d){var m=d.alternate!==null&&d.alternate.child===d.child,S=0,j=0;if(m)for(var G=d.child;G!==null;)S|=G.lanes|G.childLanes,j|=G.subtreeFlags&65011712,j|=G.flags&65011712,G.return=d,G=G.sibling;else for(G=d.child;G!==null;)S|=G.lanes|G.childLanes,j|=G.subtreeFlags,j|=G.flags,G.return=d,G=G.sibling;return d.subtreeFlags|=j,d.childLanes=S,m}function y6(d,m,S){var j=m.pendingProps;switch(_h(m),m.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ur(m),null;case 1:return Ur(m),null;case 3:return S=m.stateNode,j=null,d!==null&&(j=d.memoizedState.cache),m.memoizedState.cache!==j&&(m.flags|=2048),$s(pn),M(),S.pendingContext&&(S.context=S.pendingContext,S.pendingContext=null),(d===null||d.child===null)&&(mc(m)?Ws(m):d===null||d.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,J1())),Ur(m),null;case 26:return S=m.memoizedState,d===null?(Ws(m),S!==null?(Ur(m),yv(m,S)):(Ur(m),m.flags&=-16777217)):S?S!==d.memoizedState?(Ws(m),Ur(m),yv(m,S)):(Ur(m),m.flags&=-16777217):(d.memoizedProps!==j&&Ws(m),Ur(m),m.flags&=-16777217),null;case 27:se(m),S=z.current;var G=m.type;if(d!==null&&m.stateNode!=null)d.memoizedProps!==j&&Ws(m);else{if(!j){if(m.stateNode===null)throw Error(n(166));return Ur(m),null}d=Y.current,mc(m)?K1(m):(d=yb(G,j,S),m.stateNode=d,Ws(m))}return Ur(m),null;case 5:if(se(m),S=m.type,d!==null&&m.stateNode!=null)d.memoizedProps!==j&&Ws(m);else{if(!j){if(m.stateNode===null)throw Error(n(166));return Ur(m),null}if(d=Y.current,mc(m))K1(m);else{switch(G=qd(z.current),d){case 1:d=G.createElementNS("http://www.w3.org/2000/svg",S);break;case 2:d=G.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;default:switch(S){case"svg":d=G.createElementNS("http://www.w3.org/2000/svg",S);break;case"math":d=G.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;case"script":d=G.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild);break;case"select":d=typeof j.is=="string"?G.createElement("select",{is:j.is}):G.createElement("select"),j.multiple?d.multiple=!0:j.size&&(d.size=j.size);break;default:d=typeof j.is=="string"?G.createElement(S,{is:j.is}):G.createElement(S)}}d[It]=m,d[kt]=j;e:for(G=m.child;G!==null;){if(G.tag===5||G.tag===6)d.appendChild(G.stateNode);else if(G.tag!==4&&G.tag!==27&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===m)break e;for(;G.sibling===null;){if(G.return===null||G.return===m)break e;G=G.return}G.sibling.return=G.return,G=G.sibling}m.stateNode=d;e:switch(An(d,S,j),S){case"button":case"input":case"select":case"textarea":d=!!j.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&Ws(m)}}return Ur(m),m.flags&=-16777217,null;case 6:if(d&&m.stateNode!=null)d.memoizedProps!==j&&Ws(m);else{if(typeof j!="string"&&m.stateNode===null)throw Error(n(166));if(d=z.current,mc(m)){if(d=m.stateNode,S=m.memoizedProps,j=null,G=Yn,G!==null)switch(G.tag){case 27:case 5:j=G.memoizedProps}d[It]=m,d=!!(d.nodeValue===S||j!==null&&j.suppressHydrationWarning===!0||hb(d.nodeValue,S)),d||go(m)}else d=qd(d).createTextNode(j),d[It]=m,m.stateNode=d}return Ur(m),null;case 13:if(j=m.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(G=mc(m),j!==null&&j.dehydrated!==null){if(d===null){if(!G)throw Error(n(318));if(G=m.memoizedState,G=G!==null?G.dehydrated:null,!G)throw Error(n(317));G[It]=m}else gc(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;Ur(m),G=!1}else G=J1(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=G),G=!0;if(!G)return m.flags&256?(Hs(m),m):(Hs(m),null)}if(Hs(m),(m.flags&128)!==0)return m.lanes=S,m;if(S=j!==null,d=d!==null&&d.memoizedState!==null,S){j=m.child,G=null,j.alternate!==null&&j.alternate.memoizedState!==null&&j.alternate.memoizedState.cachePool!==null&&(G=j.alternate.memoizedState.cachePool.pool);var J=null;j.memoizedState!==null&&j.memoizedState.cachePool!==null&&(J=j.memoizedState.cachePool.pool),J!==G&&(j.flags|=2048)}return S!==d&&S&&(m.child.flags|=8192),Dd(m,m.updateQueue),Ur(m),null;case 4:return M(),d===null&&M0(m.stateNode.containerInfo),Ur(m),null;case 10:return $s(m.type),Ur(m),null;case 19:if(P(mn),G=m.memoizedState,G===null)return Ur(m),null;if(j=(m.flags&128)!==0,J=G.rendering,J===null)if(j)Dc(G,!1);else{if(qr!==0||d!==null&&(d.flags&128)!==0)for(d=m.child;d!==null;){if(J=Ad(d),J!==null){for(m.flags|=128,Dc(G,!1),d=J.updateQueue,m.updateQueue=d,Dd(m,d),m.subtreeFlags=0,d=S,S=m.child;S!==null;)Y1(S,d),S=S.sibling;return K(mn,mn.current&1|2),m.child}d=d.sibling}G.tail!==null&&te()>Fd&&(m.flags|=128,j=!0,Dc(G,!1),m.lanes=4194304)}else{if(!j)if(d=Ad(J),d!==null){if(m.flags|=128,j=!0,d=d.updateQueue,m.updateQueue=d,Dd(m,d),Dc(G,!0),G.tail===null&&G.tailMode==="hidden"&&!J.alternate&&!wr)return Ur(m),null}else 2*te()-G.renderingStartTime>Fd&&S!==536870912&&(m.flags|=128,j=!0,Dc(G,!1),m.lanes=4194304);G.isBackwards?(J.sibling=m.child,m.child=J):(d=G.last,d!==null?d.sibling=J:m.child=J,G.last=J)}return G.tail!==null?(m=G.tail,G.rendering=m,G.tail=m.sibling,G.renderingStartTime=te(),m.sibling=null,d=mn.current,K(mn,j?d&1|2:d&1),m):(Ur(m),null);case 22:case 23:return Hs(m),Ih(),j=m.memoizedState!==null,d!==null?d.memoizedState!==null!==j&&(m.flags|=8192):j&&(m.flags|=8192),j?(S&536870912)!==0&&(m.flags&128)===0&&(Ur(m),m.subtreeFlags&6&&(m.flags|=8192)):Ur(m),S=m.updateQueue,S!==null&&Dd(m,S.retryQueue),S=null,d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(S=d.memoizedState.cachePool.pool),j=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(j=m.memoizedState.cachePool.pool),j!==S&&(m.flags|=2048),d!==null&&P(xo),null;case 24:return S=null,d!==null&&(S=d.memoizedState.cache),m.memoizedState.cache!==S&&(m.flags|=2048),$s(pn),Ur(m),null;case 25:return null;case 30:return null}throw Error(n(156,m.tag))}function w6(d,m){switch(_h(m),m.tag){case 1:return d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 3:return $s(pn),M(),d=m.flags,(d&65536)!==0&&(d&128)===0?(m.flags=d&-65537|128,m):null;case 26:case 27:case 5:return se(m),null;case 13:if(Hs(m),d=m.memoizedState,d!==null&&d.dehydrated!==null){if(m.alternate===null)throw Error(n(340));gc()}return d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 19:return P(mn),null;case 4:return M(),null;case 10:return $s(m.type),null;case 22:case 23:return Hs(m),Ih(),d!==null&&P(xo),d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 24:return $s(pn),null;case 25:return null;default:return null}}function wv(d,m){switch(_h(m),m.tag){case 3:$s(pn),M();break;case 26:case 27:case 5:se(m);break;case 4:M();break;case 13:Hs(m);break;case 19:P(mn);break;case 10:$s(m.type);break;case 22:case 23:Hs(m),Ih(),d!==null&&P(xo);break;case 24:$s(pn)}}function Rc(d,m){try{var S=m.updateQueue,j=S!==null?S.lastEffect:null;if(j!==null){var G=j.next;S=G;do{if((S.tag&d)===d){j=void 0;var J=S.create,oe=S.inst;j=J(),oe.destroy=j}S=S.next}while(S!==G)}}catch(me){Dr(m,m.return,me)}}function ki(d,m,S){try{var j=m.updateQueue,G=j!==null?j.lastEffect:null;if(G!==null){var J=G.next;j=J;do{if((j.tag&d)===d){var oe=j.inst,me=oe.destroy;if(me!==void 0){oe.destroy=void 0,G=m;var Oe=S,Ke=me;try{Ke()}catch(ft){Dr(G,Oe,ft)}}}j=j.next}while(j!==J)}}catch(ft){Dr(m,m.return,ft)}}function _v(d){var m=d.updateQueue;if(m!==null){var S=d.stateNode;try{cg(m,S)}catch(j){Dr(d,d.return,j)}}}function Sv(d,m,S){S.props=wo(d.type,d.memoizedProps),S.state=d.memoizedState;try{S.componentWillUnmount()}catch(j){Dr(d,m,j)}}function Mc(d,m){try{var S=d.ref;if(S!==null){switch(d.tag){case 26:case 27:case 5:var j=d.stateNode;break;case 30:j=d.stateNode;break;default:j=d.stateNode}typeof S=="function"?d.refCleanup=S(j):S.current=j}}catch(G){Dr(d,m,G)}}function gs(d,m){var S=d.ref,j=d.refCleanup;if(S!==null)if(typeof j=="function")try{j()}catch(G){Dr(d,m,G)}finally{d.refCleanup=null,d=d.alternate,d!=null&&(d.refCleanup=null)}else if(typeof S=="function")try{S(null)}catch(G){Dr(d,m,G)}else S.current=null}function kv(d){var m=d.type,S=d.memoizedProps,j=d.stateNode;try{e:switch(m){case"button":case"input":case"select":case"textarea":S.autoFocus&&j.focus();break e;case"img":S.src?j.src=S.src:S.srcSet&&(j.srcset=S.srcSet)}}catch(G){Dr(d,d.return,G)}}function u0(d,m,S){try{var j=d.stateNode;$6(j,d.type,S,m),j[kt]=m}catch(G){Dr(d,d.return,G)}}function Ev(d){return d.tag===5||d.tag===3||d.tag===26||d.tag===27&&Di(d.type)||d.tag===4}function d0(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||Ev(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.tag===27&&Di(d.type)||d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function f0(d,m,S){var j=d.tag;if(j===5||j===6)d=d.stateNode,m?(S.nodeType===9?S.body:S.nodeName==="HTML"?S.ownerDocument.body:S).insertBefore(d,m):(m=S.nodeType===9?S.body:S.nodeName==="HTML"?S.ownerDocument.body:S,m.appendChild(d),S=S._reactRootContainer,S!=null||m.onclick!==null||(m.onclick=Hd));else if(j!==4&&(j===27&&Di(d.type)&&(S=d.stateNode,m=null),d=d.child,d!==null))for(f0(d,m,S),d=d.sibling;d!==null;)f0(d,m,S),d=d.sibling}function Rd(d,m,S){var j=d.tag;if(j===5||j===6)d=d.stateNode,m?S.insertBefore(d,m):S.appendChild(d);else if(j!==4&&(j===27&&Di(d.type)&&(S=d.stateNode),d=d.child,d!==null))for(Rd(d,m,S),d=d.sibling;d!==null;)Rd(d,m,S),d=d.sibling}function Tv(d){var m=d.stateNode,S=d.memoizedProps;try{for(var j=d.type,G=m.attributes;G.length;)m.removeAttributeNode(G[0]);An(m,j,S),m[It]=d,m[kt]=S}catch(J){Dr(d,d.return,J)}}var Gs=!1,Kr=!1,h0=!1,Av=typeof WeakSet=="function"?WeakSet:Set,wn=null;function _6(d,m){if(d=d.containerInfo,P0=Zd,d=L1(d),dh(d)){if("selectionStart"in d)var S={start:d.selectionStart,end:d.selectionEnd};else e:{S=(S=d.ownerDocument)&&S.defaultView||window;var j=S.getSelection&&S.getSelection();if(j&&j.rangeCount!==0){S=j.anchorNode;var G=j.anchorOffset,J=j.focusNode;j=j.focusOffset;try{S.nodeType,J.nodeType}catch{S=null;break e}var oe=0,me=-1,Oe=-1,Ke=0,ft=0,bt=d,Je=null;t:for(;;){for(var et;bt!==S||G!==0&&bt.nodeType!==3||(me=oe+G),bt!==J||j!==0&&bt.nodeType!==3||(Oe=oe+j),bt.nodeType===3&&(oe+=bt.nodeValue.length),(et=bt.firstChild)!==null;)Je=bt,bt=et;for(;;){if(bt===d)break t;if(Je===S&&++Ke===G&&(me=oe),Je===J&&++ft===j&&(Oe=oe),(et=bt.nextSibling)!==null)break;bt=Je,Je=bt.parentNode}bt=et}S=me===-1||Oe===-1?null:{start:me,end:Oe}}else S=null}S=S||{start:0,end:0}}else S=null;for(L0={focusedElem:d,selectionRange:S},Zd=!1,wn=m;wn!==null;)if(m=wn,d=m.child,(m.subtreeFlags&1024)!==0&&d!==null)d.return=m,wn=d;else for(;wn!==null;){switch(m=wn,J=m.alternate,d=m.flags,m.tag){case 0:break;case 11:case 15:break;case 1:if((d&1024)!==0&&J!==null){d=void 0,S=m,G=J.memoizedProps,J=J.memoizedState,j=S.stateNode;try{var Zt=wo(S.type,G,S.elementType===S.type);d=j.getSnapshotBeforeUpdate(Zt,J),j.__reactInternalSnapshotBeforeUpdate=d}catch(qt){Dr(S,S.return,qt)}}break;case 3:if((d&1024)!==0){if(d=m.stateNode.containerInfo,S=d.nodeType,S===9)z0(d);else if(S===1)switch(d.nodeName){case"HEAD":case"HTML":case"BODY":z0(d);break;default:d.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(n(163))}if(d=m.sibling,d!==null){d.return=m.return,wn=d;break}wn=m.return}}function Cv(d,m,S){var j=S.flags;switch(S.tag){case 0:case 11:case 15:Ei(d,S),j&4&&Rc(5,S);break;case 1:if(Ei(d,S),j&4)if(d=S.stateNode,m===null)try{d.componentDidMount()}catch(oe){Dr(S,S.return,oe)}else{var G=wo(S.type,m.memoizedProps);m=m.memoizedState;try{d.componentDidUpdate(G,m,d.__reactInternalSnapshotBeforeUpdate)}catch(oe){Dr(S,S.return,oe)}}j&64&&_v(S),j&512&&Mc(S,S.return);break;case 3:if(Ei(d,S),j&64&&(d=S.updateQueue,d!==null)){if(m=null,S.child!==null)switch(S.child.tag){case 27:case 5:m=S.child.stateNode;break;case 1:m=S.child.stateNode}try{cg(d,m)}catch(oe){Dr(S,S.return,oe)}}break;case 27:m===null&&j&4&&Tv(S);case 26:case 5:Ei(d,S),m===null&&j&4&&kv(S),j&512&&Mc(S,S.return);break;case 12:Ei(d,S);break;case 13:Ei(d,S),j&4&&Ov(d,S),j&64&&(d=S.memoizedState,d!==null&&(d=d.dehydrated,d!==null&&(S=O6.bind(null,S),X6(d,S))));break;case 22:if(j=S.memoizedState!==null||Gs,!j){m=m!==null&&m.memoizedState!==null||Kr,G=Gs;var J=Kr;Gs=j,(Kr=m)&&!J?Ti(d,S,(S.subtreeFlags&8772)!==0):Ei(d,S),Gs=G,Kr=J}break;case 30:break;default:Ei(d,S)}}function Nv(d){var m=d.alternate;m!==null&&(d.alternate=null,Nv(m)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(m=d.stateNode,m!==null&&ge(m)),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}var Lr=null,sa=!1;function Ys(d,m,S){for(S=S.child;S!==null;)jv(d,m,S),S=S.sibling}function jv(d,m,S){if(st&&typeof st.onCommitFiberUnmount=="function")try{st.onCommitFiberUnmount(ct,S)}catch{}switch(S.tag){case 26:Kr||gs(S,m),Ys(d,m,S),S.memoizedState?S.memoizedState.count--:S.stateNode&&(S=S.stateNode,S.parentNode.removeChild(S));break;case 27:Kr||gs(S,m);var j=Lr,G=sa;Di(S.type)&&(Lr=S.stateNode,sa=!1),Ys(d,m,S),Vc(S.stateNode),Lr=j,sa=G;break;case 5:Kr||gs(S,m);case 6:if(j=Lr,G=sa,Lr=null,Ys(d,m,S),Lr=j,sa=G,Lr!==null)if(sa)try{(Lr.nodeType===9?Lr.body:Lr.nodeName==="HTML"?Lr.ownerDocument.body:Lr).removeChild(S.stateNode)}catch(J){Dr(S,m,J)}else try{Lr.removeChild(S.stateNode)}catch(J){Dr(S,m,J)}break;case 18:Lr!==null&&(sa?(d=Lr,bb(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,S.stateNode),Zc(d)):bb(Lr,S.stateNode));break;case 4:j=Lr,G=sa,Lr=S.stateNode.containerInfo,sa=!0,Ys(d,m,S),Lr=j,sa=G;break;case 0:case 11:case 14:case 15:Kr||ki(2,S,m),Kr||ki(4,S,m),Ys(d,m,S);break;case 1:Kr||(gs(S,m),j=S.stateNode,typeof j.componentWillUnmount=="function"&&Sv(S,m,j)),Ys(d,m,S);break;case 21:Ys(d,m,S);break;case 22:Kr=(j=Kr)||S.memoizedState!==null,Ys(d,m,S),Kr=j;break;default:Ys(d,m,S)}}function Ov(d,m){if(m.memoizedState===null&&(d=m.alternate,d!==null&&(d=d.memoizedState,d!==null&&(d=d.dehydrated,d!==null))))try{Zc(d)}catch(S){Dr(m,m.return,S)}}function S6(d){switch(d.tag){case 13:case 19:var m=d.stateNode;return m===null&&(m=d.stateNode=new Av),m;case 22:return d=d.stateNode,m=d._retryCache,m===null&&(m=d._retryCache=new Av),m;default:throw Error(n(435,d.tag))}}function p0(d,m){var S=S6(d);m.forEach(function(j){var G=D6.bind(null,d,j);S.has(j)||(S.add(j),j.then(G,G))})}function fa(d,m){var S=m.deletions;if(S!==null)for(var j=0;j<S.length;j++){var G=S[j],J=d,oe=m,me=oe;e:for(;me!==null;){switch(me.tag){case 27:if(Di(me.type)){Lr=me.stateNode,sa=!1;break e}break;case 5:Lr=me.stateNode,sa=!1;break e;case 3:case 4:Lr=me.stateNode.containerInfo,sa=!0;break e}me=me.return}if(Lr===null)throw Error(n(160));jv(J,oe,G),Lr=null,sa=!1,J=G.alternate,J!==null&&(J.return=null),G.return=null}if(m.subtreeFlags&13878)for(m=m.child;m!==null;)Dv(m,d),m=m.sibling}var Za=null;function Dv(d,m){var S=d.alternate,j=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:fa(m,d),ha(d),j&4&&(ki(3,d,d.return),Rc(3,d),ki(5,d,d.return));break;case 1:fa(m,d),ha(d),j&512&&(Kr||S===null||gs(S,S.return)),j&64&&Gs&&(d=d.updateQueue,d!==null&&(j=d.callbacks,j!==null&&(S=d.shared.hiddenCallbacks,d.shared.hiddenCallbacks=S===null?j:S.concat(j))));break;case 26:var G=Za;if(fa(m,d),ha(d),j&512&&(Kr||S===null||gs(S,S.return)),j&4){var J=S!==null?S.memoizedState:null;if(j=d.memoizedState,S===null)if(j===null)if(d.stateNode===null){e:{j=d.type,S=d.memoizedProps,G=G.ownerDocument||G;t:switch(j){case"title":J=G.getElementsByTagName("title")[0],(!J||J[de]||J[It]||J.namespaceURI==="http://www.w3.org/2000/svg"||J.hasAttribute("itemprop"))&&(J=G.createElement(j),G.head.insertBefore(J,G.querySelector("head > title"))),An(J,j,S),J[It]=d,Re(J),j=J;break e;case"link":var oe=Tb("link","href",G).get(j+(S.href||""));if(oe){for(var me=0;me<oe.length;me++)if(J=oe[me],J.getAttribute("href")===(S.href==null||S.href===""?null:S.href)&&J.getAttribute("rel")===(S.rel==null?null:S.rel)&&J.getAttribute("title")===(S.title==null?null:S.title)&&J.getAttribute("crossorigin")===(S.crossOrigin==null?null:S.crossOrigin)){oe.splice(me,1);break t}}J=G.createElement(j),An(J,j,S),G.head.appendChild(J);break;case"meta":if(oe=Tb("meta","content",G).get(j+(S.content||""))){for(me=0;me<oe.length;me++)if(J=oe[me],J.getAttribute("content")===(S.content==null?null:""+S.content)&&J.getAttribute("name")===(S.name==null?null:S.name)&&J.getAttribute("property")===(S.property==null?null:S.property)&&J.getAttribute("http-equiv")===(S.httpEquiv==null?null:S.httpEquiv)&&J.getAttribute("charset")===(S.charSet==null?null:S.charSet)){oe.splice(me,1);break t}}J=G.createElement(j),An(J,j,S),G.head.appendChild(J);break;default:throw Error(n(468,j))}J[It]=d,Re(J),j=J}d.stateNode=j}else Ab(G,d.type,d.stateNode);else d.stateNode=Eb(G,j,d.memoizedProps);else J!==j?(J===null?S.stateNode!==null&&(S=S.stateNode,S.parentNode.removeChild(S)):J.count--,j===null?Ab(G,d.type,d.stateNode):Eb(G,j,d.memoizedProps)):j===null&&d.stateNode!==null&&u0(d,d.memoizedProps,S.memoizedProps)}break;case 27:fa(m,d),ha(d),j&512&&(Kr||S===null||gs(S,S.return)),S!==null&&j&4&&u0(d,d.memoizedProps,S.memoizedProps);break;case 5:if(fa(m,d),ha(d),j&512&&(Kr||S===null||gs(S,S.return)),d.flags&32){G=d.stateNode;try{rn(G,"")}catch(et){Dr(d,d.return,et)}}j&4&&d.stateNode!=null&&(G=d.memoizedProps,u0(d,G,S!==null?S.memoizedProps:G)),j&1024&&(h0=!0);break;case 6:if(fa(m,d),ha(d),j&4){if(d.stateNode===null)throw Error(n(162));j=d.memoizedProps,S=d.stateNode;try{S.nodeValue=j}catch(et){Dr(d,d.return,et)}}break;case 3:if(Yd=null,G=Za,Za=Wd(m.containerInfo),fa(m,d),Za=G,ha(d),j&4&&S!==null&&S.memoizedState.isDehydrated)try{Zc(m.containerInfo)}catch(et){Dr(d,d.return,et)}h0&&(h0=!1,Rv(d));break;case 4:j=Za,Za=Wd(d.stateNode.containerInfo),fa(m,d),ha(d),Za=j;break;case 12:fa(m,d),ha(d);break;case 13:fa(m,d),ha(d),d.child.flags&8192&&d.memoizedState!==null!=(S!==null&&S.memoizedState!==null)&&(y0=te()),j&4&&(j=d.updateQueue,j!==null&&(d.updateQueue=null,p0(d,j)));break;case 22:G=d.memoizedState!==null;var Oe=S!==null&&S.memoizedState!==null,Ke=Gs,ft=Kr;if(Gs=Ke||G,Kr=ft||Oe,fa(m,d),Kr=ft,Gs=Ke,ha(d),j&8192)e:for(m=d.stateNode,m._visibility=G?m._visibility&-2:m._visibility|1,G&&(S===null||Oe||Gs||Kr||_o(d)),S=null,m=d;;){if(m.tag===5||m.tag===26){if(S===null){Oe=S=m;try{if(J=Oe.stateNode,G)oe=J.style,typeof oe.setProperty=="function"?oe.setProperty("display","none","important"):oe.display="none";else{me=Oe.stateNode;var bt=Oe.memoizedProps.style,Je=bt!=null&&bt.hasOwnProperty("display")?bt.display:null;me.style.display=Je==null||typeof Je=="boolean"?"":(""+Je).trim()}}catch(et){Dr(Oe,Oe.return,et)}}}else if(m.tag===6){if(S===null){Oe=m;try{Oe.stateNode.nodeValue=G?"":Oe.memoizedProps}catch(et){Dr(Oe,Oe.return,et)}}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===d)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===d)break e;for(;m.sibling===null;){if(m.return===null||m.return===d)break e;S===m&&(S=null),m=m.return}S===m&&(S=null),m.sibling.return=m.return,m=m.sibling}j&4&&(j=d.updateQueue,j!==null&&(S=j.retryQueue,S!==null&&(j.retryQueue=null,p0(d,S))));break;case 19:fa(m,d),ha(d),j&4&&(j=d.updateQueue,j!==null&&(d.updateQueue=null,p0(d,j)));break;case 30:break;case 21:break;default:fa(m,d),ha(d)}}function ha(d){var m=d.flags;if(m&2){try{for(var S,j=d.return;j!==null;){if(Ev(j)){S=j;break}j=j.return}if(S==null)throw Error(n(160));switch(S.tag){case 27:var G=S.stateNode,J=d0(d);Rd(d,J,G);break;case 5:var oe=S.stateNode;S.flags&32&&(rn(oe,""),S.flags&=-33);var me=d0(d);Rd(d,me,oe);break;case 3:case 4:var Oe=S.stateNode.containerInfo,Ke=d0(d);f0(d,Ke,Oe);break;default:throw Error(n(161))}}catch(ft){Dr(d,d.return,ft)}d.flags&=-3}m&4096&&(d.flags&=-4097)}function Rv(d){if(d.subtreeFlags&1024)for(d=d.child;d!==null;){var m=d;Rv(m),m.tag===5&&m.flags&1024&&m.stateNode.reset(),d=d.sibling}}function Ei(d,m){if(m.subtreeFlags&8772)for(m=m.child;m!==null;)Cv(d,m.alternate,m),m=m.sibling}function _o(d){for(d=d.child;d!==null;){var m=d;switch(m.tag){case 0:case 11:case 14:case 15:ki(4,m,m.return),_o(m);break;case 1:gs(m,m.return);var S=m.stateNode;typeof S.componentWillUnmount=="function"&&Sv(m,m.return,S),_o(m);break;case 27:Vc(m.stateNode);case 26:case 5:gs(m,m.return),_o(m);break;case 22:m.memoizedState===null&&_o(m);break;case 30:_o(m);break;default:_o(m)}d=d.sibling}}function Ti(d,m,S){for(S=S&&(m.subtreeFlags&8772)!==0,m=m.child;m!==null;){var j=m.alternate,G=d,J=m,oe=J.flags;switch(J.tag){case 0:case 11:case 15:Ti(G,J,S),Rc(4,J);break;case 1:if(Ti(G,J,S),j=J,G=j.stateNode,typeof G.componentDidMount=="function")try{G.componentDidMount()}catch(Ke){Dr(j,j.return,Ke)}if(j=J,G=j.updateQueue,G!==null){var me=j.stateNode;try{var Oe=G.shared.hiddenCallbacks;if(Oe!==null)for(G.shared.hiddenCallbacks=null,G=0;G<Oe.length;G++)lg(Oe[G],me)}catch(Ke){Dr(j,j.return,Ke)}}S&&oe&64&&_v(J),Mc(J,J.return);break;case 27:Tv(J);case 26:case 5:Ti(G,J,S),S&&j===null&&oe&4&&kv(J),Mc(J,J.return);break;case 12:Ti(G,J,S);break;case 13:Ti(G,J,S),S&&oe&4&&Ov(G,J);break;case 22:J.memoizedState===null&&Ti(G,J,S),Mc(J,J.return);break;case 30:break;default:Ti(G,J,S)}m=m.sibling}}function m0(d,m){var S=null;d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(S=d.memoizedState.cachePool.pool),d=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(d=m.memoizedState.cachePool.pool),d!==S&&(d!=null&&d.refCount++,S!=null&&xc(S))}function g0(d,m){d=null,m.alternate!==null&&(d=m.alternate.memoizedState.cache),m=m.memoizedState.cache,m!==d&&(m.refCount++,d!=null&&xc(d))}function vs(d,m,S,j){if(m.subtreeFlags&10256)for(m=m.child;m!==null;)Mv(d,m,S,j),m=m.sibling}function Mv(d,m,S,j){var G=m.flags;switch(m.tag){case 0:case 11:case 15:vs(d,m,S,j),G&2048&&Rc(9,m);break;case 1:vs(d,m,S,j);break;case 3:vs(d,m,S,j),G&2048&&(d=null,m.alternate!==null&&(d=m.alternate.memoizedState.cache),m=m.memoizedState.cache,m!==d&&(m.refCount++,d!=null&&xc(d)));break;case 12:if(G&2048){vs(d,m,S,j),d=m.stateNode;try{var J=m.memoizedProps,oe=J.id,me=J.onPostCommit;typeof me=="function"&&me(oe,m.alternate===null?"mount":"update",d.passiveEffectDuration,-0)}catch(Oe){Dr(m,m.return,Oe)}}else vs(d,m,S,j);break;case 13:vs(d,m,S,j);break;case 23:break;case 22:J=m.stateNode,oe=m.alternate,m.memoizedState!==null?J._visibility&2?vs(d,m,S,j):Fc(d,m):J._visibility&2?vs(d,m,S,j):(J._visibility|=2,ul(d,m,S,j,(m.subtreeFlags&10256)!==0)),G&2048&&m0(oe,m);break;case 24:vs(d,m,S,j),G&2048&&g0(m.alternate,m);break;default:vs(d,m,S,j)}}function ul(d,m,S,j,G){for(G=G&&(m.subtreeFlags&10256)!==0,m=m.child;m!==null;){var J=d,oe=m,me=S,Oe=j,Ke=oe.flags;switch(oe.tag){case 0:case 11:case 15:ul(J,oe,me,Oe,G),Rc(8,oe);break;case 23:break;case 22:var ft=oe.stateNode;oe.memoizedState!==null?ft._visibility&2?ul(J,oe,me,Oe,G):Fc(J,oe):(ft._visibility|=2,ul(J,oe,me,Oe,G)),G&&Ke&2048&&m0(oe.alternate,oe);break;case 24:ul(J,oe,me,Oe,G),G&&Ke&2048&&g0(oe.alternate,oe);break;default:ul(J,oe,me,Oe,G)}m=m.sibling}}function Fc(d,m){if(m.subtreeFlags&10256)for(m=m.child;m!==null;){var S=d,j=m,G=j.flags;switch(j.tag){case 22:Fc(S,j),G&2048&&m0(j.alternate,j);break;case 24:Fc(S,j),G&2048&&g0(j.alternate,j);break;default:Fc(S,j)}m=m.sibling}}var Ic=8192;function dl(d){if(d.subtreeFlags&Ic)for(d=d.child;d!==null;)Fv(d),d=d.sibling}function Fv(d){switch(d.tag){case 26:dl(d),d.flags&Ic&&d.memoizedState!==null&&l5(Za,d.memoizedState,d.memoizedProps);break;case 5:dl(d);break;case 3:case 4:var m=Za;Za=Wd(d.stateNode.containerInfo),dl(d),Za=m;break;case 22:d.memoizedState===null&&(m=d.alternate,m!==null&&m.memoizedState!==null?(m=Ic,Ic=16777216,dl(d),Ic=m):dl(d));break;default:dl(d)}}function Iv(d){var m=d.alternate;if(m!==null&&(d=m.child,d!==null)){m.child=null;do m=d.sibling,d.sibling=null,d=m;while(d!==null)}}function Pc(d){var m=d.deletions;if((d.flags&16)!==0){if(m!==null)for(var S=0;S<m.length;S++){var j=m[S];wn=j,Lv(j,d)}Iv(d)}if(d.subtreeFlags&10256)for(d=d.child;d!==null;)Pv(d),d=d.sibling}function Pv(d){switch(d.tag){case 0:case 11:case 15:Pc(d),d.flags&2048&&ki(9,d,d.return);break;case 3:Pc(d);break;case 12:Pc(d);break;case 22:var m=d.stateNode;d.memoizedState!==null&&m._visibility&2&&(d.return===null||d.return.tag!==13)?(m._visibility&=-3,Md(d)):Pc(d);break;default:Pc(d)}}function Md(d){var m=d.deletions;if((d.flags&16)!==0){if(m!==null)for(var S=0;S<m.length;S++){var j=m[S];wn=j,Lv(j,d)}Iv(d)}for(d=d.child;d!==null;){switch(m=d,m.tag){case 0:case 11:case 15:ki(8,m,m.return),Md(m);break;case 22:S=m.stateNode,S._visibility&2&&(S._visibility&=-3,Md(m));break;default:Md(m)}d=d.sibling}}function Lv(d,m){for(;wn!==null;){var S=wn;switch(S.tag){case 0:case 11:case 15:ki(8,S,m);break;case 23:case 22:if(S.memoizedState!==null&&S.memoizedState.cachePool!==null){var j=S.memoizedState.cachePool.pool;j!=null&&j.refCount++}break;case 24:xc(S.memoizedState.cache)}if(j=S.child,j!==null)j.return=S,wn=j;else e:for(S=d;wn!==null;){j=wn;var G=j.sibling,J=j.return;if(Nv(j),j===S){wn=null;break e}if(G!==null){G.return=J,wn=G;break e}wn=J}}}var k6={getCacheForType:function(d){var m=Fn(pn),S=m.data.get(d);return S===void 0&&(S=d(),m.data.set(d,S)),S}},E6=typeof WeakMap=="function"?WeakMap:Map,Er=0,Mr=null,lr=null,hr=0,Tr=0,pa=null,Ai=!1,fl=!1,v0=!1,Xs=0,qr=0,Ci=0,So=0,b0=0,Ra=0,hl=0,Lc=null,ia=null,x0=!1,y0=0,Fd=1/0,Id=null,Ni=null,Tn=0,ji=null,pl=null,ml=0,w0=0,_0=null,Bv=null,Bc=0,S0=null;function ma(){if((Er&2)!==0&&hr!==0)return hr&-hr;if(w.T!==null){var d=rl;return d!==0?d:j0()}return Vt()}function Uv(){Ra===0&&(Ra=(hr&536870912)===0||wr?Ve():536870912);var d=Da.current;return d!==null&&(d.flags|=32),Ra}function ga(d,m,S){(d===Mr&&(Tr===2||Tr===9)||d.cancelPendingCommit!==null)&&(gl(d,0),Oi(d,hr,Ra,!1)),nt(d,S),((Er&2)===0||d!==Mr)&&(d===Mr&&((Er&2)===0&&(So|=S),qr===4&&Oi(d,hr,Ra,!1)),bs(d))}function zv(d,m,S){if((Er&6)!==0)throw Error(n(327));var j=!S&&(m&124)===0&&(m&d.expiredLanes)===0||gt(d,m),G=j?C6(d,m):T0(d,m,!0),J=j;do{if(G===0){fl&&!j&&Oi(d,m,0,!1);break}else{if(S=d.current.alternate,J&&!T6(S)){G=T0(d,m,!1),J=!1;continue}if(G===2){if(J=m,d.errorRecoveryDisabledLanes&J)var oe=0;else oe=d.pendingLanes&-536870913,oe=oe!==0?oe:oe&536870912?536870912:0;if(oe!==0){m=oe;e:{var me=d;G=Lc;var Oe=me.current.memoizedState.isDehydrated;if(Oe&&(gl(me,oe).flags|=256),oe=T0(me,oe,!1),oe!==2){if(v0&&!Oe){me.errorRecoveryDisabledLanes|=J,So|=J,G=4;break e}J=ia,ia=G,J!==null&&(ia===null?ia=J:ia.push.apply(ia,J))}G=oe}if(J=!1,G!==2)continue}}if(G===1){gl(d,0),Oi(d,m,0,!0);break}e:{switch(j=d,J=G,J){case 0:case 1:throw Error(n(345));case 4:if((m&4194048)!==m)break;case 6:Oi(j,m,Ra,!Ai);break e;case 2:ia=null;break;case 3:case 5:break;default:throw Error(n(329))}if((m&62914560)===m&&(G=y0+300-te(),10<G)){if(Oi(j,m,Ra,!Ai),wt(j,0,!0)!==0)break e;j.timeoutHandle=gb($v.bind(null,j,S,ia,Id,x0,m,Ra,So,hl,Ai,J,2,-0,0),G);break e}$v(j,S,ia,Id,x0,m,Ra,So,hl,Ai,J,0,-0,0)}}break}while(!0);bs(d)}function $v(d,m,S,j,G,J,oe,me,Oe,Ke,ft,bt,Je,et){if(d.timeoutHandle=-1,bt=m.subtreeFlags,(bt&8192||(bt&16785408)===16785408)&&(Wc={stylesheets:null,count:0,unsuspend:o5},Fv(m),bt=c5(),bt!==null)){d.cancelPendingCommit=bt(Xv.bind(null,d,m,J,S,j,G,oe,me,Oe,ft,1,Je,et)),Oi(d,J,oe,!Ke);return}Xv(d,m,J,S,j,G,oe,me,Oe)}function T6(d){for(var m=d;;){var S=m.tag;if((S===0||S===11||S===15)&&m.flags&16384&&(S=m.updateQueue,S!==null&&(S=S.stores,S!==null)))for(var j=0;j<S.length;j++){var G=S[j],J=G.getSnapshot;G=G.value;try{if(!ua(J(),G))return!1}catch{return!1}}if(S=m.child,m.subtreeFlags&16384&&S!==null)S.return=m,m=S;else{if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function Oi(d,m,S,j){m&=~b0,m&=~So,d.suspendedLanes|=m,d.pingedLanes&=~m,j&&(d.warmLanes|=m),j=d.expirationTimes;for(var G=m;0<G;){var J=31-tt(G),oe=1<<J;j[J]=-1,G&=~oe}S!==0&&Se(d,S,m)}function Pd(){return(Er&6)===0?(Uc(0),!1):!0}function k0(){if(lr!==null){if(Tr===0)var d=lr.return;else d=lr,zs=vo=null,zh(d),ll=null,jc=0,d=lr;for(;d!==null;)wv(d.alternate,d),d=d.return;lr=null}}function gl(d,m){var S=d.timeoutHandle;S!==-1&&(d.timeoutHandle=-1,H6(S)),S=d.cancelPendingCommit,S!==null&&(d.cancelPendingCommit=null,S()),k0(),Mr=d,lr=S=Ls(d.current,null),hr=m,Tr=0,pa=null,Ai=!1,fl=gt(d,m),v0=!1,hl=Ra=b0=So=Ci=qr=0,ia=Lc=null,x0=!1,(m&8)!==0&&(m|=m&32);var j=d.entangledLanes;if(j!==0)for(d=d.entanglements,j&=m;0<j;){var G=31-tt(j),J=1<<G;m|=d[G],j&=~J}return Xs=m,sd(),S}function Vv(d,m){ar=null,w.H=kd,m===wc||m===pd?(m=ig(),Tr=3):m===ng?(m=ig(),Tr=4):Tr=m===ov?8:m!==null&&typeof m=="object"&&typeof m.then=="function"?6:1,pa=m,lr===null&&(qr=1,Nd(d,Ca(m,d.current)))}function Hv(){var d=w.H;return w.H=kd,d===null?kd:d}function qv(){var d=w.A;return w.A=k6,d}function E0(){qr=4,Ai||(hr&4194048)!==hr&&Da.current!==null||(fl=!0),(Ci&134217727)===0&&(So&134217727)===0||Mr===null||Oi(Mr,hr,Ra,!1)}function T0(d,m,S){var j=Er;Er|=2;var G=Hv(),J=qv();(Mr!==d||hr!==m)&&(Id=null,gl(d,m)),m=!1;var oe=qr;e:do try{if(Tr!==0&&lr!==null){var me=lr,Oe=pa;switch(Tr){case 8:k0(),oe=6;break e;case 3:case 2:case 9:case 6:Da.current===null&&(m=!0);var Ke=Tr;if(Tr=0,pa=null,vl(d,me,Oe,Ke),S&&fl){oe=0;break e}break;default:Ke=Tr,Tr=0,pa=null,vl(d,me,Oe,Ke)}}A6(),oe=qr;break}catch(ft){Vv(d,ft)}while(!0);return m&&d.shellSuspendCounter++,zs=vo=null,Er=j,w.H=G,w.A=J,lr===null&&(Mr=null,hr=0,sd()),oe}function A6(){for(;lr!==null;)Wv(lr)}function C6(d,m){var S=Er;Er|=2;var j=Hv(),G=qv();Mr!==d||hr!==m?(Id=null,Fd=te()+500,gl(d,m)):fl=gt(d,m);e:do try{if(Tr!==0&&lr!==null){m=lr;var J=pa;t:switch(Tr){case 1:Tr=0,pa=null,vl(d,m,J,1);break;case 2:case 9:if(ag(J)){Tr=0,pa=null,Gv(m);break}m=function(){Tr!==2&&Tr!==9||Mr!==d||(Tr=7),bs(d)},J.then(m,m);break e;case 3:Tr=7;break e;case 4:Tr=5;break e;case 7:ag(J)?(Tr=0,pa=null,Gv(m)):(Tr=0,pa=null,vl(d,m,J,7));break;case 5:var oe=null;switch(lr.tag){case 26:oe=lr.memoizedState;case 5:case 27:var me=lr;if(!oe||Cb(oe)){Tr=0,pa=null;var Oe=me.sibling;if(Oe!==null)lr=Oe;else{var Ke=me.return;Ke!==null?(lr=Ke,Ld(Ke)):lr=null}break t}}Tr=0,pa=null,vl(d,m,J,5);break;case 6:Tr=0,pa=null,vl(d,m,J,6);break;case 8:k0(),qr=6;break e;default:throw Error(n(462))}}N6();break}catch(ft){Vv(d,ft)}while(!0);return zs=vo=null,w.H=j,w.A=G,Er=S,lr!==null?0:(Mr=null,hr=0,sd(),qr)}function N6(){for(;lr!==null&&!fe();)Wv(lr)}function Wv(d){var m=xv(d.alternate,d,Xs);d.memoizedProps=d.pendingProps,m===null?Ld(d):lr=m}function Gv(d){var m=d,S=m.alternate;switch(m.tag){case 15:case 0:m=hv(S,m,m.pendingProps,m.type,void 0,hr);break;case 11:m=hv(S,m,m.pendingProps,m.type.render,m.ref,hr);break;case 5:zh(m);default:wv(S,m),m=lr=Y1(m,Xs),m=xv(S,m,Xs)}d.memoizedProps=d.pendingProps,m===null?Ld(d):lr=m}function vl(d,m,S,j){zs=vo=null,zh(m),ll=null,jc=0;var G=m.return;try{if(b6(d,G,m,S,hr)){qr=1,Nd(d,Ca(S,d.current)),lr=null;return}}catch(J){if(G!==null)throw lr=G,J;qr=1,Nd(d,Ca(S,d.current)),lr=null;return}m.flags&32768?(wr||j===1?d=!0:fl||(hr&536870912)!==0?d=!1:(Ai=d=!0,(j===2||j===9||j===3||j===6)&&(j=Da.current,j!==null&&j.tag===13&&(j.flags|=16384))),Yv(m,d)):Ld(m)}function Ld(d){var m=d;do{if((m.flags&32768)!==0){Yv(m,Ai);return}d=m.return;var S=y6(m.alternate,m,Xs);if(S!==null){lr=S;return}if(m=m.sibling,m!==null){lr=m;return}lr=m=d}while(m!==null);qr===0&&(qr=5)}function Yv(d,m){do{var S=w6(d.alternate,d);if(S!==null){S.flags&=32767,lr=S;return}if(S=d.return,S!==null&&(S.flags|=32768,S.subtreeFlags=0,S.deletions=null),!m&&(d=d.sibling,d!==null)){lr=d;return}lr=d=S}while(d!==null);qr=6,lr=null}function Xv(d,m,S,j,G,J,oe,me,Oe){d.cancelPendingCommit=null;do Bd();while(Tn!==0);if((Er&6)!==0)throw Error(n(327));if(m!==null){if(m===d.current)throw Error(n(177));if(J=m.lanes|m.childLanes,J|=gh,pt(d,S,J,oe,me,Oe),d===Mr&&(lr=Mr=null,hr=0),pl=m,ji=d,ml=S,w0=J,_0=G,Bv=j,(m.subtreeFlags&10256)!==0||(m.flags&10256)!==0?(d.callbackNode=null,d.callbackPriority=0,R6(ke,function(){return eb(),null})):(d.callbackNode=null,d.callbackPriority=0),j=(m.flags&13878)!==0,(m.subtreeFlags&13878)!==0||j){j=w.T,w.T=null,G=E.p,E.p=2,oe=Er,Er|=4;try{_6(d,m,S)}finally{Er=oe,E.p=G,w.T=j}}Tn=1,Kv(),Zv(),Jv()}}function Kv(){if(Tn===1){Tn=0;var d=ji,m=pl,S=(m.flags&13878)!==0;if((m.subtreeFlags&13878)!==0||S){S=w.T,w.T=null;var j=E.p;E.p=2;var G=Er;Er|=4;try{Dv(m,d);var J=L0,oe=L1(d.containerInfo),me=J.focusedElem,Oe=J.selectionRange;if(oe!==me&&me&&me.ownerDocument&&P1(me.ownerDocument.documentElement,me)){if(Oe!==null&&dh(me)){var Ke=Oe.start,ft=Oe.end;if(ft===void 0&&(ft=Ke),"selectionStart"in me)me.selectionStart=Ke,me.selectionEnd=Math.min(ft,me.value.length);else{var bt=me.ownerDocument||document,Je=bt&&bt.defaultView||window;if(Je.getSelection){var et=Je.getSelection(),Zt=me.textContent.length,qt=Math.min(Oe.start,Zt),jr=Oe.end===void 0?qt:Math.min(Oe.end,Zt);!et.extend&&qt>jr&&(oe=jr,jr=qt,qt=oe);var He=I1(me,qt),Ie=I1(me,jr);if(He&&Ie&&(et.rangeCount!==1||et.anchorNode!==He.node||et.anchorOffset!==He.offset||et.focusNode!==Ie.node||et.focusOffset!==Ie.offset)){var Ye=bt.createRange();Ye.setStart(He.node,He.offset),et.removeAllRanges(),qt>jr?(et.addRange(Ye),et.extend(Ie.node,Ie.offset)):(Ye.setEnd(Ie.node,Ie.offset),et.addRange(Ye))}}}}for(bt=[],et=me;et=et.parentNode;)et.nodeType===1&&bt.push({element:et,left:et.scrollLeft,top:et.scrollTop});for(typeof me.focus=="function"&&me.focus(),me=0;me<bt.length;me++){var mt=bt[me];mt.element.scrollLeft=mt.left,mt.element.scrollTop=mt.top}}Zd=!!P0,L0=P0=null}finally{Er=G,E.p=j,w.T=S}}d.current=m,Tn=2}}function Zv(){if(Tn===2){Tn=0;var d=ji,m=pl,S=(m.flags&8772)!==0;if((m.subtreeFlags&8772)!==0||S){S=w.T,w.T=null;var j=E.p;E.p=2;var G=Er;Er|=4;try{Cv(d,m.alternate,m)}finally{Er=G,E.p=j,w.T=S}}Tn=3}}function Jv(){if(Tn===4||Tn===3){Tn=0,le();var d=ji,m=pl,S=ml,j=Bv;(m.subtreeFlags&10256)!==0||(m.flags&10256)!==0?Tn=5:(Tn=0,pl=ji=null,Qv(d,d.pendingLanes));var G=d.pendingLanes;if(G===0&&(Ni=null),At(S),m=m.stateNode,st&&typeof st.onCommitFiberRoot=="function")try{st.onCommitFiberRoot(ct,m,void 0,(m.current.flags&128)===128)}catch{}if(j!==null){m=w.T,G=E.p,E.p=2,w.T=null;try{for(var J=d.onRecoverableError,oe=0;oe<j.length;oe++){var me=j[oe];J(me.value,{componentStack:me.stack})}}finally{w.T=m,E.p=G}}(ml&3)!==0&&Bd(),bs(d),G=d.pendingLanes,(S&4194090)!==0&&(G&42)!==0?d===S0?Bc++:(Bc=0,S0=d):Bc=0,Uc(0)}}function Qv(d,m){(d.pooledCacheLanes&=m)===0&&(m=d.pooledCache,m!=null&&(d.pooledCache=null,xc(m)))}function Bd(d){return Kv(),Zv(),Jv(),eb()}function eb(){if(Tn!==5)return!1;var d=ji,m=w0;w0=0;var S=At(ml),j=w.T,G=E.p;try{E.p=32>S?32:S,w.T=null,S=_0,_0=null;var J=ji,oe=ml;if(Tn=0,pl=ji=null,ml=0,(Er&6)!==0)throw Error(n(331));var me=Er;if(Er|=4,Pv(J.current),Mv(J,J.current,oe,S),Er=me,Uc(0,!1),st&&typeof st.onPostCommitFiberRoot=="function")try{st.onPostCommitFiberRoot(ct,J)}catch{}return!0}finally{E.p=G,w.T=j,Qv(d,m)}}function tb(d,m,S){m=Ca(S,m),m=t0(d.stateNode,m,2),d=yi(d,m,2),d!==null&&(nt(d,2),bs(d))}function Dr(d,m,S){if(d.tag===3)tb(d,d,S);else for(;m!==null;){if(m.tag===3){tb(m,d,S);break}else if(m.tag===1){var j=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof j.componentDidCatch=="function"&&(Ni===null||!Ni.has(j))){d=Ca(S,d),S=sv(2),j=yi(m,S,2),j!==null&&(iv(S,j,m,d),nt(j,2),bs(j));break}}m=m.return}}function A0(d,m,S){var j=d.pingCache;if(j===null){j=d.pingCache=new E6;var G=new Set;j.set(m,G)}else G=j.get(m),G===void 0&&(G=new Set,j.set(m,G));G.has(S)||(v0=!0,G.add(S),d=j6.bind(null,d,m,S),m.then(d,d))}function j6(d,m,S){var j=d.pingCache;j!==null&&j.delete(m),d.pingedLanes|=d.suspendedLanes&S,d.warmLanes&=~S,Mr===d&&(hr&S)===S&&(qr===4||qr===3&&(hr&62914560)===hr&&300>te()-y0?(Er&2)===0&&gl(d,0):b0|=S,hl===hr&&(hl=0)),bs(d)}function rb(d,m){m===0&&(m=$e()),d=Jo(d,m),d!==null&&(nt(d,m),bs(d))}function O6(d){var m=d.memoizedState,S=0;m!==null&&(S=m.retryLane),rb(d,S)}function D6(d,m){var S=0;switch(d.tag){case 13:var j=d.stateNode,G=d.memoizedState;G!==null&&(S=G.retryLane);break;case 19:j=d.stateNode;break;case 22:j=d.stateNode._retryCache;break;default:throw Error(n(314))}j!==null&&j.delete(m),rb(d,S)}function R6(d,m){return ne(d,m)}var Ud=null,bl=null,C0=!1,zd=!1,N0=!1,ko=0;function bs(d){d!==bl&&d.next===null&&(bl===null?Ud=bl=d:bl=bl.next=d),zd=!0,C0||(C0=!0,F6())}function Uc(d,m){if(!N0&&zd){N0=!0;do for(var S=!1,j=Ud;j!==null;){if(d!==0){var G=j.pendingLanes;if(G===0)var J=0;else{var oe=j.suspendedLanes,me=j.pingedLanes;J=(1<<31-tt(42|d)+1)-1,J&=G&~(oe&~me),J=J&201326741?J&201326741|1:J?J|2:0}J!==0&&(S=!0,ib(j,J))}else J=hr,J=wt(j,j===Mr?J:0,j.cancelPendingCommit!==null||j.timeoutHandle!==-1),(J&3)===0||gt(j,J)||(S=!0,ib(j,J));j=j.next}while(S);N0=!1}}function M6(){nb()}function nb(){zd=C0=!1;var d=0;ko!==0&&(V6()&&(d=ko),ko=0);for(var m=te(),S=null,j=Ud;j!==null;){var G=j.next,J=ab(j,m);J===0?(j.next=null,S===null?Ud=G:S.next=G,G===null&&(bl=S)):(S=j,(d!==0||(J&3)!==0)&&(zd=!0)),j=G}Uc(d)}function ab(d,m){for(var S=d.suspendedLanes,j=d.pingedLanes,G=d.expirationTimes,J=d.pendingLanes&-62914561;0<J;){var oe=31-tt(J),me=1<<oe,Oe=G[oe];Oe===-1?((me&S)===0||(me&j)!==0)&&(G[oe]=vt(me,m)):Oe<=m&&(d.expiredLanes|=me),J&=~me}if(m=Mr,S=hr,S=wt(d,d===m?S:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),j=d.callbackNode,S===0||d===m&&(Tr===2||Tr===9)||d.cancelPendingCommit!==null)return j!==null&&j!==null&&Q(j),d.callbackNode=null,d.callbackPriority=0;if((S&3)===0||gt(d,S)){if(m=S&-S,m===d.callbackPriority)return m;switch(j!==null&&Q(j),At(S)){case 2:case 8:S=Ee;break;case 32:S=ke;break;case 268435456:S=Fe;break;default:S=ke}return j=sb.bind(null,d),S=ne(S,j),d.callbackPriority=m,d.callbackNode=S,m}return j!==null&&j!==null&&Q(j),d.callbackPriority=2,d.callbackNode=null,2}function sb(d,m){if(Tn!==0&&Tn!==5)return d.callbackNode=null,d.callbackPriority=0,null;var S=d.callbackNode;if(Bd()&&d.callbackNode!==S)return null;var j=hr;return j=wt(d,d===Mr?j:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),j===0?null:(zv(d,j,m),ab(d,te()),d.callbackNode!=null&&d.callbackNode===S?sb.bind(null,d):null)}function ib(d,m){if(Bd())return null;zv(d,m,!0)}function F6(){q6(function(){(Er&6)!==0?ne(he,M6):nb()})}function j0(){return ko===0&&(ko=Ve()),ko}function ob(d){return d==null||typeof d=="symbol"||typeof d=="boolean"?null:typeof d=="function"?d:so(""+d)}function lb(d,m){var S=m.ownerDocument.createElement("input");return S.name=m.name,S.value=m.value,d.id&&S.setAttribute("form",d.id),m.parentNode.insertBefore(S,m),d=new FormData(d),S.parentNode.removeChild(S),d}function I6(d,m,S,j,G){if(m==="submit"&&S&&S.stateNode===G){var J=ob((G[kt]||null).action),oe=j.submitter;oe&&(m=(m=oe[kt]||null)?ob(m.formAction):oe.getAttribute("formAction"),m!==null&&(J=m,oe=null));var me=new rd("action","action",null,j,G);d.push({event:me,listeners:[{instance:null,listener:function(){if(j.defaultPrevented){if(ko!==0){var Oe=oe?lb(G,oe):new FormData(G);Kh(S,{pending:!0,data:Oe,method:G.method,action:J},null,Oe)}}else typeof J=="function"&&(me.preventDefault(),Oe=oe?lb(G,oe):new FormData(G),Kh(S,{pending:!0,data:Oe,method:G.method,action:J},J,Oe))},currentTarget:G}]})}}for(var O0=0;O0<mh.length;O0++){var D0=mh[O0],P6=D0.toLowerCase(),L6=D0[0].toUpperCase()+D0.slice(1);Ka(P6,"on"+L6)}Ka(z1,"onAnimationEnd"),Ka($1,"onAnimationIteration"),Ka(V1,"onAnimationStart"),Ka("dblclick","onDoubleClick"),Ka("focusin","onFocus"),Ka("focusout","onBlur"),Ka(t6,"onTransitionRun"),Ka(r6,"onTransitionStart"),Ka(n6,"onTransitionCancel"),Ka(H1,"onTransitionEnd"),Te("onMouseEnter",["mouseout","mouseover"]),Te("onMouseLeave",["mouseout","mouseover"]),Te("onPointerEnter",["pointerout","pointerover"]),Te("onPointerLeave",["pointerout","pointerover"]),be("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),be("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),be("onBeforeInput",["compositionend","keypress","textInput","paste"]),be("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),be("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),be("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),B6=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(zc));function cb(d,m){m=(m&4)!==0;for(var S=0;S<d.length;S++){var j=d[S],G=j.event;j=j.listeners;e:{var J=void 0;if(m)for(var oe=j.length-1;0<=oe;oe--){var me=j[oe],Oe=me.instance,Ke=me.currentTarget;if(me=me.listener,Oe!==J&&G.isPropagationStopped())break e;J=me,G.currentTarget=Ke;try{J(G)}catch(ft){Cd(ft)}G.currentTarget=null,J=Oe}else for(oe=0;oe<j.length;oe++){if(me=j[oe],Oe=me.instance,Ke=me.currentTarget,me=me.listener,Oe!==J&&G.isPropagationStopped())break e;J=me,G.currentTarget=Ke;try{J(G)}catch(ft){Cd(ft)}G.currentTarget=null,J=Oe}}}}function cr(d,m){var S=m[Le];S===void 0&&(S=m[Le]=new Set);var j=d+"__bubble";S.has(j)||(ub(m,d,2,!1),S.add(j))}function R0(d,m,S){var j=0;m&&(j|=4),ub(S,d,j,m)}var $d="_reactListening"+Math.random().toString(36).slice(2);function M0(d){if(!d[$d]){d[$d]=!0,Be.forEach(function(S){S!=="selectionchange"&&(B6.has(S)||R0(S,!1,d),R0(S,!0,d))});var m=d.nodeType===9?d:d.ownerDocument;m===null||m[$d]||(m[$d]=!0,R0("selectionchange",!1,m))}}function ub(d,m,S,j){switch(Mb(m)){case 2:var G=f5;break;case 8:G=h5;break;default:G=Y0}S=G.bind(null,m,S,d),G=void 0,!rh||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(G=!0),j?G!==void 0?d.addEventListener(m,S,{capture:!0,passive:G}):d.addEventListener(m,S,!0):G!==void 0?d.addEventListener(m,S,{passive:G}):d.addEventListener(m,S,!1)}function F0(d,m,S,j,G){var J=j;if((m&1)===0&&(m&2)===0&&j!==null)e:for(;;){if(j===null)return;var oe=j.tag;if(oe===3||oe===4){var me=j.stateNode.containerInfo;if(me===G)break;if(oe===4)for(oe=j.return;oe!==null;){var Oe=oe.tag;if((Oe===3||Oe===4)&&oe.stateNode.containerInfo===G)return;oe=oe.return}for(;me!==null;){if(oe=ve(me),oe===null)return;if(Oe=oe.tag,Oe===5||Oe===6||Oe===26||Oe===27){j=J=oe;continue e}me=me.parentNode}}j=j.return}oo(function(){var Ke=J,ft=io(S),bt=[];e:{var Je=q1.get(d);if(Je!==void 0){var et=rd,Zt=d;switch(d){case"keypress":if(ed(S)===0)break e;case"keydown":case"keyup":et=R3;break;case"focusin":Zt="focus",et=ih;break;case"focusout":Zt="blur",et=ih;break;case"beforeblur":case"afterblur":et=ih;break;case"click":if(S.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":et=y1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":et=w3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":et=I3;break;case z1:case $1:case V1:et=k3;break;case H1:et=L3;break;case"scroll":case"scrollend":et=x3;break;case"wheel":et=U3;break;case"copy":case"cut":case"paste":et=T3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":et=_1;break;case"toggle":case"beforetoggle":et=$3}var qt=(m&4)!==0,jr=!qt&&(d==="scroll"||d==="scrollend"),He=qt?Je!==null?Je+"Capture":null:Je;qt=[];for(var Ie=Ke,Ye;Ie!==null;){var mt=Ie;if(Ye=mt.stateNode,mt=mt.tag,mt!==5&&mt!==26&&mt!==27||Ye===null||He===null||(mt=ic(Ie,He),mt!=null&&qt.push($c(Ie,mt,Ye))),jr)break;Ie=Ie.return}0<qt.length&&(Je=new et(Je,Zt,null,S,ft),bt.push({event:Je,listeners:qt}))}}if((m&7)===0){e:{if(Je=d==="mouseover"||d==="pointerover",et=d==="mouseout"||d==="pointerout",Je&&S!==pi&&(Zt=S.relatedTarget||S.fromElement)&&(ve(Zt)||Zt[Ne]))break e;if((et||Je)&&(Je=ft.window===ft?ft:(Je=ft.ownerDocument)?Je.defaultView||Je.parentWindow:window,et?(Zt=S.relatedTarget||S.toElement,et=Ke,Zt=Zt?ve(Zt):null,Zt!==null&&(jr=o(Zt),qt=Zt.tag,Zt!==jr||qt!==5&&qt!==27&&qt!==6)&&(Zt=null)):(et=null,Zt=Ke),et!==Zt)){if(qt=y1,mt="onMouseLeave",He="onMouseEnter",Ie="mouse",(d==="pointerout"||d==="pointerover")&&(qt=_1,mt="onPointerLeave",He="onPointerEnter",Ie="pointer"),jr=et==null?Je:Me(et),Ye=Zt==null?Je:Me(Zt),Je=new qt(mt,Ie+"leave",et,S,ft),Je.target=jr,Je.relatedTarget=Ye,mt=null,ve(ft)===Ke&&(qt=new qt(He,Ie+"enter",Zt,S,ft),qt.target=Ye,qt.relatedTarget=jr,mt=qt),jr=mt,et&&Zt)t:{for(qt=et,He=Zt,Ie=0,Ye=qt;Ye;Ye=xl(Ye))Ie++;for(Ye=0,mt=He;mt;mt=xl(mt))Ye++;for(;0<Ie-Ye;)qt=xl(qt),Ie--;for(;0<Ye-Ie;)He=xl(He),Ye--;for(;Ie--;){if(qt===He||He!==null&&qt===He.alternate)break t;qt=xl(qt),He=xl(He)}qt=null}else qt=null;et!==null&&db(bt,Je,et,qt,!1),Zt!==null&&jr!==null&&db(bt,jr,Zt,qt,!0)}}e:{if(Je=Ke?Me(Ke):window,et=Je.nodeName&&Je.nodeName.toLowerCase(),et==="select"||et==="input"&&Je.type==="file")var Ft=j1;else if(C1(Je))if(O1)Ft=J3;else{Ft=K3;var or=X3}else et=Je.nodeName,!et||et.toLowerCase()!=="input"||Je.type!=="checkbox"&&Je.type!=="radio"?Ke&&fi(Ke.elementType)&&(Ft=j1):Ft=Z3;if(Ft&&(Ft=Ft(d,Ke))){N1(bt,Ft,S,ft);break e}or&&or(d,Je,Ke),d==="focusout"&&Ke&&Je.type==="number"&&Ke.memoizedProps.value!=null&&ir(Je,"number",Je.value)}switch(or=Ke?Me(Ke):window,d){case"focusin":(C1(or)||or.contentEditable==="true")&&(Xo=or,fh=Ke,pc=null);break;case"focusout":pc=fh=Xo=null;break;case"mousedown":hh=!0;break;case"contextmenu":case"mouseup":case"dragend":hh=!1,B1(bt,S,ft);break;case"selectionchange":if(e6)break;case"keydown":case"keyup":B1(bt,S,ft)}var zt;if(lh)e:{switch(d){case"compositionstart":var Yt="onCompositionStart";break e;case"compositionend":Yt="onCompositionEnd";break e;case"compositionupdate":Yt="onCompositionUpdate";break e}Yt=void 0}else Yo?T1(d,S)&&(Yt="onCompositionEnd"):d==="keydown"&&S.keyCode===229&&(Yt="onCompositionStart");Yt&&(S1&&S.locale!=="ko"&&(Yo||Yt!=="onCompositionStart"?Yt==="onCompositionEnd"&&Yo&&(zt=b1()):(gi=ft,nh="value"in gi?gi.value:gi.textContent,Yo=!0)),or=Vd(Ke,Yt),0<or.length&&(Yt=new w1(Yt,d,null,S,ft),bt.push({event:Yt,listeners:or}),zt?Yt.data=zt:(zt=A1(S),zt!==null&&(Yt.data=zt)))),(zt=H3?q3(d,S):W3(d,S))&&(Yt=Vd(Ke,"onBeforeInput"),0<Yt.length&&(or=new w1("onBeforeInput","beforeinput",null,S,ft),bt.push({event:or,listeners:Yt}),or.data=zt)),I6(bt,d,Ke,S,ft)}cb(bt,m)})}function $c(d,m,S){return{instance:d,listener:m,currentTarget:S}}function Vd(d,m){for(var S=m+"Capture",j=[];d!==null;){var G=d,J=G.stateNode;if(G=G.tag,G!==5&&G!==26&&G!==27||J===null||(G=ic(d,S),G!=null&&j.unshift($c(d,G,J)),G=ic(d,m),G!=null&&j.push($c(d,G,J))),d.tag===3)return j;d=d.return}return[]}function xl(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5&&d.tag!==27);return d||null}function db(d,m,S,j,G){for(var J=m._reactName,oe=[];S!==null&&S!==j;){var me=S,Oe=me.alternate,Ke=me.stateNode;if(me=me.tag,Oe!==null&&Oe===j)break;me!==5&&me!==26&&me!==27||Ke===null||(Oe=Ke,G?(Ke=ic(S,J),Ke!=null&&oe.unshift($c(S,Ke,Oe))):G||(Ke=ic(S,J),Ke!=null&&oe.push($c(S,Ke,Oe)))),S=S.return}oe.length!==0&&d.push({event:m,listeners:oe})}var U6=/\r\n?/g,z6=/\u0000|\uFFFD/g;function fb(d){return(typeof d=="string"?d:""+d).replace(U6,`
`).replace(z6,"")}function hb(d,m){return m=fb(m),fb(d)===m}function Hd(){}function Nr(d,m,S,j,G,J){switch(S){case"children":typeof j=="string"?m==="body"||m==="textarea"&&j===""||rn(d,j):(typeof j=="number"||typeof j=="bigint")&&m!=="body"&&rn(d,""+j);break;case"className":We(d,"class",j);break;case"tabIndex":We(d,"tabindex",j);break;case"dir":case"role":case"viewBox":case"width":case"height":We(d,S,j);break;case"style":di(d,j,J);break;case"data":if(m!=="object"){We(d,"data",j);break}case"src":case"href":if(j===""&&(m!=="a"||S!=="href")){d.removeAttribute(S);break}if(j==null||typeof j=="function"||typeof j=="symbol"||typeof j=="boolean"){d.removeAttribute(S);break}j=so(""+j),d.setAttribute(S,j);break;case"action":case"formAction":if(typeof j=="function"){d.setAttribute(S,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof J=="function"&&(S==="formAction"?(m!=="input"&&Nr(d,m,"name",G.name,G,null),Nr(d,m,"formEncType",G.formEncType,G,null),Nr(d,m,"formMethod",G.formMethod,G,null),Nr(d,m,"formTarget",G.formTarget,G,null)):(Nr(d,m,"encType",G.encType,G,null),Nr(d,m,"method",G.method,G,null),Nr(d,m,"target",G.target,G,null)));if(j==null||typeof j=="symbol"||typeof j=="boolean"){d.removeAttribute(S);break}j=so(""+j),d.setAttribute(S,j);break;case"onClick":j!=null&&(d.onclick=Hd);break;case"onScroll":j!=null&&cr("scroll",d);break;case"onScrollEnd":j!=null&&cr("scrollend",d);break;case"dangerouslySetInnerHTML":if(j!=null){if(typeof j!="object"||!("__html"in j))throw Error(n(61));if(S=j.__html,S!=null){if(G.children!=null)throw Error(n(60));d.innerHTML=S}}break;case"multiple":d.multiple=j&&typeof j!="function"&&typeof j!="symbol";break;case"muted":d.muted=j&&typeof j!="function"&&typeof j!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(j==null||typeof j=="function"||typeof j=="boolean"||typeof j=="symbol"){d.removeAttribute("xlink:href");break}S=so(""+j),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",S);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":j!=null&&typeof j!="function"&&typeof j!="symbol"?d.setAttribute(S,""+j):d.removeAttribute(S);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":j&&typeof j!="function"&&typeof j!="symbol"?d.setAttribute(S,""):d.removeAttribute(S);break;case"capture":case"download":j===!0?d.setAttribute(S,""):j!==!1&&j!=null&&typeof j!="function"&&typeof j!="symbol"?d.setAttribute(S,j):d.removeAttribute(S);break;case"cols":case"rows":case"size":case"span":j!=null&&typeof j!="function"&&typeof j!="symbol"&&!isNaN(j)&&1<=j?d.setAttribute(S,j):d.removeAttribute(S);break;case"rowSpan":case"start":j==null||typeof j=="function"||typeof j=="symbol"||isNaN(j)?d.removeAttribute(S):d.setAttribute(S,j);break;case"popover":cr("beforetoggle",d),cr("toggle",d),xe(d,"popover",j);break;case"xlinkActuate":qe(d,"http://www.w3.org/1999/xlink","xlink:actuate",j);break;case"xlinkArcrole":qe(d,"http://www.w3.org/1999/xlink","xlink:arcrole",j);break;case"xlinkRole":qe(d,"http://www.w3.org/1999/xlink","xlink:role",j);break;case"xlinkShow":qe(d,"http://www.w3.org/1999/xlink","xlink:show",j);break;case"xlinkTitle":qe(d,"http://www.w3.org/1999/xlink","xlink:title",j);break;case"xlinkType":qe(d,"http://www.w3.org/1999/xlink","xlink:type",j);break;case"xmlBase":qe(d,"http://www.w3.org/XML/1998/namespace","xml:base",j);break;case"xmlLang":qe(d,"http://www.w3.org/XML/1998/namespace","xml:lang",j);break;case"xmlSpace":qe(d,"http://www.w3.org/XML/1998/namespace","xml:space",j);break;case"is":xe(d,"is",j);break;case"innerText":case"textContent":break;default:(!(2<S.length)||S[0]!=="o"&&S[0]!=="O"||S[1]!=="n"&&S[1]!=="N")&&(S=hi.get(S)||S,xe(d,S,j))}}function I0(d,m,S,j,G,J){switch(S){case"style":di(d,j,J);break;case"dangerouslySetInnerHTML":if(j!=null){if(typeof j!="object"||!("__html"in j))throw Error(n(61));if(S=j.__html,S!=null){if(G.children!=null)throw Error(n(60));d.innerHTML=S}}break;case"children":typeof j=="string"?rn(d,j):(typeof j=="number"||typeof j=="bigint")&&rn(d,""+j);break;case"onScroll":j!=null&&cr("scroll",d);break;case"onScrollEnd":j!=null&&cr("scrollend",d);break;case"onClick":j!=null&&(d.onclick=Hd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ze.hasOwnProperty(S))e:{if(S[0]==="o"&&S[1]==="n"&&(G=S.endsWith("Capture"),m=S.slice(2,G?S.length-7:void 0),J=d[kt]||null,J=J!=null?J[S]:null,typeof J=="function"&&d.removeEventListener(m,J,G),typeof j=="function")){typeof J!="function"&&J!==null&&(S in d?d[S]=null:d.hasAttribute(S)&&d.removeAttribute(S)),d.addEventListener(m,j,G);break e}S in d?d[S]=j:j===!0?d.setAttribute(S,""):xe(d,S,j)}}}function An(d,m,S){switch(m){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":cr("error",d),cr("load",d);var j=!1,G=!1,J;for(J in S)if(S.hasOwnProperty(J)){var oe=S[J];if(oe!=null)switch(J){case"src":j=!0;break;case"srcSet":G=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,m));default:Nr(d,m,J,oe,S,null)}}G&&Nr(d,m,"srcSet",S.srcSet,S,null),j&&Nr(d,m,"src",S.src,S,null);return;case"input":cr("invalid",d);var me=J=oe=G=null,Oe=null,Ke=null;for(j in S)if(S.hasOwnProperty(j)){var ft=S[j];if(ft!=null)switch(j){case"name":G=ft;break;case"type":oe=ft;break;case"checked":Oe=ft;break;case"defaultChecked":Ke=ft;break;case"value":J=ft;break;case"defaultValue":me=ft;break;case"children":case"dangerouslySetInnerHTML":if(ft!=null)throw Error(n(137,m));break;default:Nr(d,m,j,ft,S,null)}}vr(d,J,me,Oe,Ke,oe,G,!1),tn(d);return;case"select":cr("invalid",d),j=oe=J=null;for(G in S)if(S.hasOwnProperty(G)&&(me=S[G],me!=null))switch(G){case"value":J=me;break;case"defaultValue":oe=me;break;case"multiple":j=me;default:Nr(d,m,G,me,S,null)}m=J,S=oe,d.multiple=!!j,m!=null?Gn(d,!!j,m,!1):S!=null&&Gn(d,!!j,S,!0);return;case"textarea":cr("invalid",d),J=G=j=null;for(oe in S)if(S.hasOwnProperty(oe)&&(me=S[oe],me!=null))switch(oe){case"value":j=me;break;case"defaultValue":G=me;break;case"children":J=me;break;case"dangerouslySetInnerHTML":if(me!=null)throw Error(n(91));break;default:Nr(d,m,oe,me,S,null)}ao(d,j,G,J),tn(d);return;case"option":for(Oe in S)if(S.hasOwnProperty(Oe)&&(j=S[Oe],j!=null))switch(Oe){case"selected":d.selected=j&&typeof j!="function"&&typeof j!="symbol";break;default:Nr(d,m,Oe,j,S,null)}return;case"dialog":cr("beforetoggle",d),cr("toggle",d),cr("cancel",d),cr("close",d);break;case"iframe":case"object":cr("load",d);break;case"video":case"audio":for(j=0;j<zc.length;j++)cr(zc[j],d);break;case"image":cr("error",d),cr("load",d);break;case"details":cr("toggle",d);break;case"embed":case"source":case"link":cr("error",d),cr("load",d);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ke in S)if(S.hasOwnProperty(Ke)&&(j=S[Ke],j!=null))switch(Ke){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,m));default:Nr(d,m,Ke,j,S,null)}return;default:if(fi(m)){for(ft in S)S.hasOwnProperty(ft)&&(j=S[ft],j!==void 0&&I0(d,m,ft,j,S,void 0));return}}for(me in S)S.hasOwnProperty(me)&&(j=S[me],j!=null&&Nr(d,m,me,j,S,null))}function $6(d,m,S,j){switch(m){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var G=null,J=null,oe=null,me=null,Oe=null,Ke=null,ft=null;for(et in S){var bt=S[et];if(S.hasOwnProperty(et)&&bt!=null)switch(et){case"checked":break;case"value":break;case"defaultValue":Oe=bt;default:j.hasOwnProperty(et)||Nr(d,m,et,null,j,bt)}}for(var Je in j){var et=j[Je];if(bt=S[Je],j.hasOwnProperty(Je)&&(et!=null||bt!=null))switch(Je){case"type":J=et;break;case"name":G=et;break;case"checked":Ke=et;break;case"defaultChecked":ft=et;break;case"value":oe=et;break;case"defaultValue":me=et;break;case"children":case"dangerouslySetInnerHTML":if(et!=null)throw Error(n(137,m));break;default:et!==bt&&Nr(d,m,Je,et,j,bt)}}ds(d,oe,me,Oe,Ke,ft,J,G);return;case"select":et=oe=me=Je=null;for(J in S)if(Oe=S[J],S.hasOwnProperty(J)&&Oe!=null)switch(J){case"value":break;case"multiple":et=Oe;default:j.hasOwnProperty(J)||Nr(d,m,J,null,j,Oe)}for(G in j)if(J=j[G],Oe=S[G],j.hasOwnProperty(G)&&(J!=null||Oe!=null))switch(G){case"value":Je=J;break;case"defaultValue":me=J;break;case"multiple":oe=J;default:J!==Oe&&Nr(d,m,G,J,j,Oe)}m=me,S=oe,j=et,Je!=null?Gn(d,!!S,Je,!1):!!j!=!!S&&(m!=null?Gn(d,!!S,m,!0):Gn(d,!!S,S?[]:"",!1));return;case"textarea":et=Je=null;for(me in S)if(G=S[me],S.hasOwnProperty(me)&&G!=null&&!j.hasOwnProperty(me))switch(me){case"value":break;case"children":break;default:Nr(d,m,me,null,j,G)}for(oe in j)if(G=j[oe],J=S[oe],j.hasOwnProperty(oe)&&(G!=null||J!=null))switch(oe){case"value":Je=G;break;case"defaultValue":et=G;break;case"children":break;case"dangerouslySetInnerHTML":if(G!=null)throw Error(n(91));break;default:G!==J&&Nr(d,m,oe,G,j,J)}fs(d,Je,et);return;case"option":for(var Zt in S)if(Je=S[Zt],S.hasOwnProperty(Zt)&&Je!=null&&!j.hasOwnProperty(Zt))switch(Zt){case"selected":d.selected=!1;break;default:Nr(d,m,Zt,null,j,Je)}for(Oe in j)if(Je=j[Oe],et=S[Oe],j.hasOwnProperty(Oe)&&Je!==et&&(Je!=null||et!=null))switch(Oe){case"selected":d.selected=Je&&typeof Je!="function"&&typeof Je!="symbol";break;default:Nr(d,m,Oe,Je,j,et)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var qt in S)Je=S[qt],S.hasOwnProperty(qt)&&Je!=null&&!j.hasOwnProperty(qt)&&Nr(d,m,qt,null,j,Je);for(Ke in j)if(Je=j[Ke],et=S[Ke],j.hasOwnProperty(Ke)&&Je!==et&&(Je!=null||et!=null))switch(Ke){case"children":case"dangerouslySetInnerHTML":if(Je!=null)throw Error(n(137,m));break;default:Nr(d,m,Ke,Je,j,et)}return;default:if(fi(m)){for(var jr in S)Je=S[jr],S.hasOwnProperty(jr)&&Je!==void 0&&!j.hasOwnProperty(jr)&&I0(d,m,jr,void 0,j,Je);for(ft in j)Je=j[ft],et=S[ft],!j.hasOwnProperty(ft)||Je===et||Je===void 0&&et===void 0||I0(d,m,ft,Je,j,et);return}}for(var He in S)Je=S[He],S.hasOwnProperty(He)&&Je!=null&&!j.hasOwnProperty(He)&&Nr(d,m,He,null,j,Je);for(bt in j)Je=j[bt],et=S[bt],!j.hasOwnProperty(bt)||Je===et||Je==null&&et==null||Nr(d,m,bt,Je,j,et)}var P0=null,L0=null;function qd(d){return d.nodeType===9?d:d.ownerDocument}function pb(d){switch(d){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function mb(d,m){if(d===0)switch(m){case"svg":return 1;case"math":return 2;default:return 0}return d===1&&m==="foreignObject"?0:d}function B0(d,m){return d==="textarea"||d==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.children=="bigint"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var U0=null;function V6(){var d=window.event;return d&&d.type==="popstate"?d===U0?!1:(U0=d,!0):(U0=null,!1)}var gb=typeof setTimeout=="function"?setTimeout:void 0,H6=typeof clearTimeout=="function"?clearTimeout:void 0,vb=typeof Promise=="function"?Promise:void 0,q6=typeof queueMicrotask=="function"?queueMicrotask:typeof vb<"u"?function(d){return vb.resolve(null).then(d).catch(W6)}:gb;function W6(d){setTimeout(function(){throw d})}function Di(d){return d==="head"}function bb(d,m){var S=m,j=0,G=0;do{var J=S.nextSibling;if(d.removeChild(S),J&&J.nodeType===8)if(S=J.data,S==="/$"){if(0<j&&8>j){S=j;var oe=d.ownerDocument;if(S&1&&Vc(oe.documentElement),S&2&&Vc(oe.body),S&4)for(S=oe.head,Vc(S),oe=S.firstChild;oe;){var me=oe.nextSibling,Oe=oe.nodeName;oe[de]||Oe==="SCRIPT"||Oe==="STYLE"||Oe==="LINK"&&oe.rel.toLowerCase()==="stylesheet"||S.removeChild(oe),oe=me}}if(G===0){d.removeChild(J),Zc(m);return}G--}else S==="$"||S==="$?"||S==="$!"?G++:j=S.charCodeAt(0)-48;else j=0;S=J}while(S);Zc(m)}function z0(d){var m=d.firstChild;for(m&&m.nodeType===10&&(m=m.nextSibling);m;){var S=m;switch(m=m.nextSibling,S.nodeName){case"HTML":case"HEAD":case"BODY":z0(S),ge(S);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(S.rel.toLowerCase()==="stylesheet")continue}d.removeChild(S)}}function G6(d,m,S,j){for(;d.nodeType===1;){var G=S;if(d.nodeName.toLowerCase()!==m.toLowerCase()){if(!j&&(d.nodeName!=="INPUT"||d.type!=="hidden"))break}else if(j){if(!d[de])switch(m){case"meta":if(!d.hasAttribute("itemprop"))break;return d;case"link":if(J=d.getAttribute("rel"),J==="stylesheet"&&d.hasAttribute("data-precedence"))break;if(J!==G.rel||d.getAttribute("href")!==(G.href==null||G.href===""?null:G.href)||d.getAttribute("crossorigin")!==(G.crossOrigin==null?null:G.crossOrigin)||d.getAttribute("title")!==(G.title==null?null:G.title))break;return d;case"style":if(d.hasAttribute("data-precedence"))break;return d;case"script":if(J=d.getAttribute("src"),(J!==(G.src==null?null:G.src)||d.getAttribute("type")!==(G.type==null?null:G.type)||d.getAttribute("crossorigin")!==(G.crossOrigin==null?null:G.crossOrigin))&&J&&d.hasAttribute("async")&&!d.hasAttribute("itemprop"))break;return d;default:return d}}else if(m==="input"&&d.type==="hidden"){var J=G.name==null?null:""+G.name;if(G.type==="hidden"&&d.getAttribute("name")===J)return d}else return d;if(d=Ja(d.nextSibling),d===null)break}return null}function Y6(d,m,S){if(m==="")return null;for(;d.nodeType!==3;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!S||(d=Ja(d.nextSibling),d===null))return null;return d}function $0(d){return d.data==="$!"||d.data==="$?"&&d.ownerDocument.readyState==="complete"}function X6(d,m){var S=d.ownerDocument;if(d.data!=="$?"||S.readyState==="complete")m();else{var j=function(){m(),S.removeEventListener("DOMContentLoaded",j)};S.addEventListener("DOMContentLoaded",j),d._reactRetry=j}}function Ja(d){for(;d!=null;d=d.nextSibling){var m=d.nodeType;if(m===1||m===3)break;if(m===8){if(m=d.data,m==="$"||m==="$!"||m==="$?"||m==="F!"||m==="F")break;if(m==="/$")return null}}return d}var V0=null;function xb(d){d=d.previousSibling;for(var m=0;d;){if(d.nodeType===8){var S=d.data;if(S==="$"||S==="$!"||S==="$?"){if(m===0)return d;m--}else S==="/$"&&m++}d=d.previousSibling}return null}function yb(d,m,S){switch(m=qd(S),d){case"html":if(d=m.documentElement,!d)throw Error(n(452));return d;case"head":if(d=m.head,!d)throw Error(n(453));return d;case"body":if(d=m.body,!d)throw Error(n(454));return d;default:throw Error(n(451))}}function Vc(d){for(var m=d.attributes;m.length;)d.removeAttributeNode(m[0]);ge(d)}var Ma=new Map,wb=new Set;function Wd(d){return typeof d.getRootNode=="function"?d.getRootNode():d.nodeType===9?d:d.ownerDocument}var Ks=E.d;E.d={f:K6,r:Z6,D:J6,C:Q6,L:e5,m:t5,X:n5,S:r5,M:a5};function K6(){var d=Ks.f(),m=Pd();return d||m}function Z6(d){var m=ye(d);m!==null&&m.tag===5&&m.type==="form"?zg(m):Ks.r(d)}var yl=typeof document>"u"?null:document;function _b(d,m,S){var j=yl;if(j&&typeof m=="string"&&m){var G=hn(m);G='link[rel="'+d+'"][href="'+G+'"]',typeof S=="string"&&(G+='[crossorigin="'+S+'"]'),wb.has(G)||(wb.add(G),d={rel:d,crossOrigin:S,href:m},j.querySelector(G)===null&&(m=j.createElement("link"),An(m,"link",d),Re(m),j.head.appendChild(m)))}}function J6(d){Ks.D(d),_b("dns-prefetch",d,null)}function Q6(d,m){Ks.C(d,m),_b("preconnect",d,m)}function e5(d,m,S){Ks.L(d,m,S);var j=yl;if(j&&d&&m){var G='link[rel="preload"][as="'+hn(m)+'"]';m==="image"&&S&&S.imageSrcSet?(G+='[imagesrcset="'+hn(S.imageSrcSet)+'"]',typeof S.imageSizes=="string"&&(G+='[imagesizes="'+hn(S.imageSizes)+'"]')):G+='[href="'+hn(d)+'"]';var J=G;switch(m){case"style":J=wl(d);break;case"script":J=_l(d)}Ma.has(J)||(d=u({rel:"preload",href:m==="image"&&S&&S.imageSrcSet?void 0:d,as:m},S),Ma.set(J,d),j.querySelector(G)!==null||m==="style"&&j.querySelector(Hc(J))||m==="script"&&j.querySelector(qc(J))||(m=j.createElement("link"),An(m,"link",d),Re(m),j.head.appendChild(m)))}}function t5(d,m){Ks.m(d,m);var S=yl;if(S&&d){var j=m&&typeof m.as=="string"?m.as:"script",G='link[rel="modulepreload"][as="'+hn(j)+'"][href="'+hn(d)+'"]',J=G;switch(j){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":J=_l(d)}if(!Ma.has(J)&&(d=u({rel:"modulepreload",href:d},m),Ma.set(J,d),S.querySelector(G)===null)){switch(j){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(S.querySelector(qc(J)))return}j=S.createElement("link"),An(j,"link",d),Re(j),S.head.appendChild(j)}}}function r5(d,m,S){Ks.S(d,m,S);var j=yl;if(j&&d){var G=Ue(j).hoistableStyles,J=wl(d);m=m||"default";var oe=G.get(J);if(!oe){var me={loading:0,preload:null};if(oe=j.querySelector(Hc(J)))me.loading=5;else{d=u({rel:"stylesheet",href:d,"data-precedence":m},S),(S=Ma.get(J))&&H0(d,S);var Oe=oe=j.createElement("link");Re(Oe),An(Oe,"link",d),Oe._p=new Promise(function(Ke,ft){Oe.onload=Ke,Oe.onerror=ft}),Oe.addEventListener("load",function(){me.loading|=1}),Oe.addEventListener("error",function(){me.loading|=2}),me.loading|=4,Gd(oe,m,j)}oe={type:"stylesheet",instance:oe,count:1,state:me},G.set(J,oe)}}}function n5(d,m){Ks.X(d,m);var S=yl;if(S&&d){var j=Ue(S).hoistableScripts,G=_l(d),J=j.get(G);J||(J=S.querySelector(qc(G)),J||(d=u({src:d,async:!0},m),(m=Ma.get(G))&&q0(d,m),J=S.createElement("script"),Re(J),An(J,"link",d),S.head.appendChild(J)),J={type:"script",instance:J,count:1,state:null},j.set(G,J))}}function a5(d,m){Ks.M(d,m);var S=yl;if(S&&d){var j=Ue(S).hoistableScripts,G=_l(d),J=j.get(G);J||(J=S.querySelector(qc(G)),J||(d=u({src:d,async:!0,type:"module"},m),(m=Ma.get(G))&&q0(d,m),J=S.createElement("script"),Re(J),An(J,"link",d),S.head.appendChild(J)),J={type:"script",instance:J,count:1,state:null},j.set(G,J))}}function Sb(d,m,S,j){var G=(G=z.current)?Wd(G):null;if(!G)throw Error(n(446));switch(d){case"meta":case"title":return null;case"style":return typeof S.precedence=="string"&&typeof S.href=="string"?(m=wl(S.href),S=Ue(G).hoistableStyles,j=S.get(m),j||(j={type:"style",instance:null,count:0,state:null},S.set(m,j)),j):{type:"void",instance:null,count:0,state:null};case"link":if(S.rel==="stylesheet"&&typeof S.href=="string"&&typeof S.precedence=="string"){d=wl(S.href);var J=Ue(G).hoistableStyles,oe=J.get(d);if(oe||(G=G.ownerDocument||G,oe={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},J.set(d,oe),(J=G.querySelector(Hc(d)))&&!J._p&&(oe.instance=J,oe.state.loading=5),Ma.has(d)||(S={rel:"preload",as:"style",href:S.href,crossOrigin:S.crossOrigin,integrity:S.integrity,media:S.media,hrefLang:S.hrefLang,referrerPolicy:S.referrerPolicy},Ma.set(d,S),J||s5(G,d,S,oe.state))),m&&j===null)throw Error(n(528,""));return oe}if(m&&j!==null)throw Error(n(529,""));return null;case"script":return m=S.async,S=S.src,typeof S=="string"&&m&&typeof m!="function"&&typeof m!="symbol"?(m=_l(S),S=Ue(G).hoistableScripts,j=S.get(m),j||(j={type:"script",instance:null,count:0,state:null},S.set(m,j)),j):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,d))}}function wl(d){return'href="'+hn(d)+'"'}function Hc(d){return'link[rel="stylesheet"]['+d+"]"}function kb(d){return u({},d,{"data-precedence":d.precedence,precedence:null})}function s5(d,m,S,j){d.querySelector('link[rel="preload"][as="style"]['+m+"]")?j.loading=1:(m=d.createElement("link"),j.preload=m,m.addEventListener("load",function(){return j.loading|=1}),m.addEventListener("error",function(){return j.loading|=2}),An(m,"link",S),Re(m),d.head.appendChild(m))}function _l(d){return'[src="'+hn(d)+'"]'}function qc(d){return"script[async]"+d}function Eb(d,m,S){if(m.count++,m.instance===null)switch(m.type){case"style":var j=d.querySelector('style[data-href~="'+hn(S.href)+'"]');if(j)return m.instance=j,Re(j),j;var G=u({},S,{"data-href":S.href,"data-precedence":S.precedence,href:null,precedence:null});return j=(d.ownerDocument||d).createElement("style"),Re(j),An(j,"style",G),Gd(j,S.precedence,d),m.instance=j;case"stylesheet":G=wl(S.href);var J=d.querySelector(Hc(G));if(J)return m.state.loading|=4,m.instance=J,Re(J),J;j=kb(S),(G=Ma.get(G))&&H0(j,G),J=(d.ownerDocument||d).createElement("link"),Re(J);var oe=J;return oe._p=new Promise(function(me,Oe){oe.onload=me,oe.onerror=Oe}),An(J,"link",j),m.state.loading|=4,Gd(J,S.precedence,d),m.instance=J;case"script":return J=_l(S.src),(G=d.querySelector(qc(J)))?(m.instance=G,Re(G),G):(j=S,(G=Ma.get(J))&&(j=u({},S),q0(j,G)),d=d.ownerDocument||d,G=d.createElement("script"),Re(G),An(G,"link",j),d.head.appendChild(G),m.instance=G);case"void":return null;default:throw Error(n(443,m.type))}else m.type==="stylesheet"&&(m.state.loading&4)===0&&(j=m.instance,m.state.loading|=4,Gd(j,S.precedence,d));return m.instance}function Gd(d,m,S){for(var j=S.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),G=j.length?j[j.length-1]:null,J=G,oe=0;oe<j.length;oe++){var me=j[oe];if(me.dataset.precedence===m)J=me;else if(J!==G)break}J?J.parentNode.insertBefore(d,J.nextSibling):(m=S.nodeType===9?S.head:S,m.insertBefore(d,m.firstChild))}function H0(d,m){d.crossOrigin==null&&(d.crossOrigin=m.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=m.referrerPolicy),d.title==null&&(d.title=m.title)}function q0(d,m){d.crossOrigin==null&&(d.crossOrigin=m.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=m.referrerPolicy),d.integrity==null&&(d.integrity=m.integrity)}var Yd=null;function Tb(d,m,S){if(Yd===null){var j=new Map,G=Yd=new Map;G.set(S,j)}else G=Yd,j=G.get(S),j||(j=new Map,G.set(S,j));if(j.has(d))return j;for(j.set(d,null),S=S.getElementsByTagName(d),G=0;G<S.length;G++){var J=S[G];if(!(J[de]||J[It]||d==="link"&&J.getAttribute("rel")==="stylesheet")&&J.namespaceURI!=="http://www.w3.org/2000/svg"){var oe=J.getAttribute(m)||"";oe=d+oe;var me=j.get(oe);me?me.push(J):j.set(oe,[J])}}return j}function Ab(d,m,S){d=d.ownerDocument||d,d.head.insertBefore(S,m==="title"?d.querySelector("head > title"):null)}function i5(d,m,S){if(S===1||m.itemProp!=null)return!1;switch(d){case"meta":case"title":return!0;case"style":if(typeof m.precedence!="string"||typeof m.href!="string"||m.href==="")break;return!0;case"link":if(typeof m.rel!="string"||typeof m.href!="string"||m.href===""||m.onLoad||m.onError)break;switch(m.rel){case"stylesheet":return d=m.disabled,typeof m.precedence=="string"&&d==null;default:return!0}case"script":if(m.async&&typeof m.async!="function"&&typeof m.async!="symbol"&&!m.onLoad&&!m.onError&&m.src&&typeof m.src=="string")return!0}return!1}function Cb(d){return!(d.type==="stylesheet"&&(d.state.loading&3)===0)}var Wc=null;function o5(){}function l5(d,m,S){if(Wc===null)throw Error(n(475));var j=Wc;if(m.type==="stylesheet"&&(typeof S.media!="string"||matchMedia(S.media).matches!==!1)&&(m.state.loading&4)===0){if(m.instance===null){var G=wl(S.href),J=d.querySelector(Hc(G));if(J){d=J._p,d!==null&&typeof d=="object"&&typeof d.then=="function"&&(j.count++,j=Xd.bind(j),d.then(j,j)),m.state.loading|=4,m.instance=J,Re(J);return}J=d.ownerDocument||d,S=kb(S),(G=Ma.get(G))&&H0(S,G),J=J.createElement("link"),Re(J);var oe=J;oe._p=new Promise(function(me,Oe){oe.onload=me,oe.onerror=Oe}),An(J,"link",S),m.instance=J}j.stylesheets===null&&(j.stylesheets=new Map),j.stylesheets.set(m,d),(d=m.state.preload)&&(m.state.loading&3)===0&&(j.count++,m=Xd.bind(j),d.addEventListener("load",m),d.addEventListener("error",m))}}function c5(){if(Wc===null)throw Error(n(475));var d=Wc;return d.stylesheets&&d.count===0&&W0(d,d.stylesheets),0<d.count?function(m){var S=setTimeout(function(){if(d.stylesheets&&W0(d,d.stylesheets),d.unsuspend){var j=d.unsuspend;d.unsuspend=null,j()}},6e4);return d.unsuspend=m,function(){d.unsuspend=null,clearTimeout(S)}}:null}function Xd(){if(this.count--,this.count===0){if(this.stylesheets)W0(this,this.stylesheets);else if(this.unsuspend){var d=this.unsuspend;this.unsuspend=null,d()}}}var Kd=null;function W0(d,m){d.stylesheets=null,d.unsuspend!==null&&(d.count++,Kd=new Map,m.forEach(u5,d),Kd=null,Xd.call(d))}function u5(d,m){if(!(m.state.loading&4)){var S=Kd.get(d);if(S)var j=S.get(null);else{S=new Map,Kd.set(d,S);for(var G=d.querySelectorAll("link[data-precedence],style[data-precedence]"),J=0;J<G.length;J++){var oe=G[J];(oe.nodeName==="LINK"||oe.getAttribute("media")!=="not all")&&(S.set(oe.dataset.precedence,oe),j=oe)}j&&S.set(null,j)}G=m.instance,oe=G.getAttribute("data-precedence"),J=S.get(oe)||j,J===j&&S.set(null,G),S.set(oe,G),this.count++,j=Xd.bind(this),G.addEventListener("load",j),G.addEventListener("error",j),J?J.parentNode.insertBefore(G,J.nextSibling):(d=d.nodeType===9?d.head:d,d.insertBefore(G,d.firstChild)),m.state.loading|=4}}var Gc={$$typeof:k,Provider:null,Consumer:null,_currentValue:A,_currentValue2:A,_threadCount:0};function d5(d,m,S,j,G,J,oe,me){this.tag=1,this.containerInfo=d,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=xt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xt(0),this.hiddenUpdates=xt(null),this.identifierPrefix=j,this.onUncaughtError=G,this.onCaughtError=J,this.onRecoverableError=oe,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=me,this.incompleteTransitions=new Map}function Nb(d,m,S,j,G,J,oe,me,Oe,Ke,ft,bt){return d=new d5(d,m,S,oe,me,Oe,Ke,bt),m=1,J===!0&&(m|=24),J=da(3,null,null,m),d.current=J,J.stateNode=d,m=Ah(),m.refCount++,d.pooledCache=m,m.refCount++,J.memoizedState={element:j,isDehydrated:S,cache:m},Oh(J),d}function jb(d){return d?(d=Qo,d):Qo}function Ob(d,m,S,j,G,J){G=jb(G),j.context===null?j.context=G:j.pendingContext=G,j=xi(m),j.payload={element:S},J=J===void 0?null:J,J!==null&&(j.callback=J),S=yi(d,j,m),S!==null&&(ga(S,d,m),Sc(S,d,m))}function Db(d,m){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var S=d.retryLane;d.retryLane=S!==0&&S<m?S:m}}function G0(d,m){Db(d,m),(d=d.alternate)&&Db(d,m)}function Rb(d){if(d.tag===13){var m=Jo(d,67108864);m!==null&&ga(m,d,67108864),G0(d,67108864)}}var Zd=!0;function f5(d,m,S,j){var G=w.T;w.T=null;var J=E.p;try{E.p=2,Y0(d,m,S,j)}finally{E.p=J,w.T=G}}function h5(d,m,S,j){var G=w.T;w.T=null;var J=E.p;try{E.p=8,Y0(d,m,S,j)}finally{E.p=J,w.T=G}}function Y0(d,m,S,j){if(Zd){var G=X0(j);if(G===null)F0(d,m,j,Jd,S),Fb(d,j);else if(m5(G,d,m,S,j))j.stopPropagation();else if(Fb(d,j),m&4&&-1<p5.indexOf(d)){for(;G!==null;){var J=ye(G);if(J!==null)switch(J.tag){case 3:if(J=J.stateNode,J.current.memoizedState.isDehydrated){var oe=dt(J.pendingLanes);if(oe!==0){var me=J;for(me.pendingLanes|=2,me.entangledLanes|=2;oe;){var Oe=1<<31-tt(oe);me.entanglements[1]|=Oe,oe&=~Oe}bs(J),(Er&6)===0&&(Fd=te()+500,Uc(0))}}break;case 13:me=Jo(J,2),me!==null&&ga(me,J,2),Pd(),G0(J,2)}if(J=X0(j),J===null&&F0(d,m,j,Jd,S),J===G)break;G=J}G!==null&&j.stopPropagation()}else F0(d,m,j,null,S)}}function X0(d){return d=io(d),K0(d)}var Jd=null;function K0(d){if(Jd=null,d=ve(d),d!==null){var m=o(d);if(m===null)d=null;else{var S=m.tag;if(S===13){if(d=s(m),d!==null)return d;d=null}else if(S===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;d=null}else m!==d&&(d=null)}}return Jd=d,null}function Mb(d){switch(d){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case he:return 2;case Ee:return 8;case ke:case Ce:return 32;case Fe:return 268435456;default:return 32}default:return 32}}var Z0=!1,Ri=null,Mi=null,Fi=null,Yc=new Map,Xc=new Map,Ii=[],p5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Fb(d,m){switch(d){case"focusin":case"focusout":Ri=null;break;case"dragenter":case"dragleave":Mi=null;break;case"mouseover":case"mouseout":Fi=null;break;case"pointerover":case"pointerout":Yc.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xc.delete(m.pointerId)}}function Kc(d,m,S,j,G,J){return d===null||d.nativeEvent!==J?(d={blockedOn:m,domEventName:S,eventSystemFlags:j,nativeEvent:J,targetContainers:[G]},m!==null&&(m=ye(m),m!==null&&Rb(m)),d):(d.eventSystemFlags|=j,m=d.targetContainers,G!==null&&m.indexOf(G)===-1&&m.push(G),d)}function m5(d,m,S,j,G){switch(m){case"focusin":return Ri=Kc(Ri,d,m,S,j,G),!0;case"dragenter":return Mi=Kc(Mi,d,m,S,j,G),!0;case"mouseover":return Fi=Kc(Fi,d,m,S,j,G),!0;case"pointerover":var J=G.pointerId;return Yc.set(J,Kc(Yc.get(J)||null,d,m,S,j,G)),!0;case"gotpointercapture":return J=G.pointerId,Xc.set(J,Kc(Xc.get(J)||null,d,m,S,j,G)),!0}return!1}function Ib(d){var m=ve(d.target);if(m!==null){var S=o(m);if(S!==null){if(m=S.tag,m===13){if(m=s(S),m!==null){d.blockedOn=m,yt(d.priority,function(){if(S.tag===13){var j=ma();j=Qe(j);var G=Jo(S,j);G!==null&&ga(G,S,j),G0(S,j)}});return}}else if(m===3&&S.stateNode.current.memoizedState.isDehydrated){d.blockedOn=S.tag===3?S.stateNode.containerInfo:null;return}}}d.blockedOn=null}function Qd(d){if(d.blockedOn!==null)return!1;for(var m=d.targetContainers;0<m.length;){var S=X0(d.nativeEvent);if(S===null){S=d.nativeEvent;var j=new S.constructor(S.type,S);pi=j,S.target.dispatchEvent(j),pi=null}else return m=ye(S),m!==null&&Rb(m),d.blockedOn=S,!1;m.shift()}return!0}function Pb(d,m,S){Qd(d)&&S.delete(m)}function g5(){Z0=!1,Ri!==null&&Qd(Ri)&&(Ri=null),Mi!==null&&Qd(Mi)&&(Mi=null),Fi!==null&&Qd(Fi)&&(Fi=null),Yc.forEach(Pb),Xc.forEach(Pb)}function ef(d,m){d.blockedOn===m&&(d.blockedOn=null,Z0||(Z0=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,g5)))}var tf=null;function Lb(d){tf!==d&&(tf=d,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){tf===d&&(tf=null);for(var m=0;m<d.length;m+=3){var S=d[m],j=d[m+1],G=d[m+2];if(typeof j!="function"){if(K0(j||S)===null)continue;break}var J=ye(S);J!==null&&(d.splice(m,3),m-=3,Kh(J,{pending:!0,data:G,method:S.method,action:j},j,G))}}))}function Zc(d){function m(Oe){return ef(Oe,d)}Ri!==null&&ef(Ri,d),Mi!==null&&ef(Mi,d),Fi!==null&&ef(Fi,d),Yc.forEach(m),Xc.forEach(m);for(var S=0;S<Ii.length;S++){var j=Ii[S];j.blockedOn===d&&(j.blockedOn=null)}for(;0<Ii.length&&(S=Ii[0],S.blockedOn===null);)Ib(S),S.blockedOn===null&&Ii.shift();if(S=(d.ownerDocument||d).$$reactFormReplay,S!=null)for(j=0;j<S.length;j+=3){var G=S[j],J=S[j+1],oe=G[kt]||null;if(typeof J=="function")oe||Lb(S);else if(oe){var me=null;if(J&&J.hasAttribute("formAction")){if(G=J,oe=J[kt]||null)me=oe.formAction;else if(K0(G)!==null)continue}else me=oe.action;typeof me=="function"?S[j+1]=me:(S.splice(j,3),j-=3),Lb(S)}}}function J0(d){this._internalRoot=d}rf.prototype.render=J0.prototype.render=function(d){var m=this._internalRoot;if(m===null)throw Error(n(409));var S=m.current,j=ma();Ob(S,j,d,m,null,null)},rf.prototype.unmount=J0.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var m=d.containerInfo;Ob(d.current,2,null,d,null,null),Pd(),m[Ne]=null}};function rf(d){this._internalRoot=d}rf.prototype.unstable_scheduleHydration=function(d){if(d){var m=Vt();d={blockedOn:null,target:d,priority:m};for(var S=0;S<Ii.length&&m!==0&&m<Ii[S].priority;S++);Ii.splice(S,0,d),S===0&&Ib(d)}};var Bb=r.version;if(Bb!=="19.1.0")throw Error(n(527,Bb,"19.1.0"));E.findDOMNode=function(d){var m=d._reactInternals;if(m===void 0)throw typeof d.render=="function"?Error(n(188)):(d=Object.keys(d).join(","),Error(n(268,d)));return d=c(m),d=d!==null?i(d):null,d=d===null?null:d.stateNode,d};var v5={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:w,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nf.isDisabled&&nf.supportsFiber)try{ct=nf.inject(v5),st=nf}catch{}}return Jc.createRoot=function(d,m){if(!a(d))throw Error(n(299));var S=!1,j="",G=tv,J=rv,oe=nv,me=null;return m!=null&&(m.unstable_strictMode===!0&&(S=!0),m.identifierPrefix!==void 0&&(j=m.identifierPrefix),m.onUncaughtError!==void 0&&(G=m.onUncaughtError),m.onCaughtError!==void 0&&(J=m.onCaughtError),m.onRecoverableError!==void 0&&(oe=m.onRecoverableError),m.unstable_transitionCallbacks!==void 0&&(me=m.unstable_transitionCallbacks)),m=Nb(d,1,!1,null,null,S,j,G,J,oe,me,null),d[Ne]=m.current,M0(d),new J0(m)},Jc.hydrateRoot=function(d,m,S){if(!a(d))throw Error(n(299));var j=!1,G="",J=tv,oe=rv,me=nv,Oe=null,Ke=null;return S!=null&&(S.unstable_strictMode===!0&&(j=!0),S.identifierPrefix!==void 0&&(G=S.identifierPrefix),S.onUncaughtError!==void 0&&(J=S.onUncaughtError),S.onCaughtError!==void 0&&(oe=S.onCaughtError),S.onRecoverableError!==void 0&&(me=S.onRecoverableError),S.unstable_transitionCallbacks!==void 0&&(Oe=S.unstable_transitionCallbacks),S.formState!==void 0&&(Ke=S.formState)),m=Nb(d,1,!0,m,S??null,j,G,J,oe,me,Oe,Ke),m.context=jb(null),S=m.current,j=ma(),j=Qe(j),G=xi(j),G.callback=null,yi(S,G,j),S=j,m.current.lanes=S,nt(m,S),bs(m),d[Ne]=m.current,M0(d),new rf(m)},Jc.version="19.1.0",Jc}var Vb;function v8(){if(Vb)return Q0.exports;Vb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(r){console.error(r)}}return t(),Q0.exports=g8(),Q0.exports}var b8=v8();const mm="-",x8=t=>{const r=w8(t),{conflictingClassGroups:e,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:s=>{const l=s.split(mm);return l[0]===""&&l.length!==1&&l.shift(),Sy(l,r)||y8(s)},getConflictingClassGroupIds:(s,l)=>{const c=e[s]||[];return l&&n[s]?[...c,...n[s]]:c}}},Sy=(t,r)=>{var s;if(t.length===0)return r.classGroupId;const e=t[0],n=r.nextPart.get(e),a=n?Sy(t.slice(1),n):void 0;if(a)return a;if(r.validators.length===0)return;const o=t.join(mm);return(s=r.validators.find(({validator:l})=>l(o)))==null?void 0:s.classGroupId},Hb=/^\[(.+)\]$/,y8=t=>{if(Hb.test(t)){const r=Hb.exec(t)[1],e=r==null?void 0:r.substring(0,r.indexOf(":"));if(e)return"arbitrary.."+e}},w8=t=>{const{theme:r,prefix:e}=t,n={nextPart:new Map,validators:[]};return S8(Object.entries(t.classGroups),e).forEach(([o,s])=>{jp(s,n,o,r)}),n},jp=(t,r,e,n)=>{t.forEach(a=>{if(typeof a=="string"){const o=a===""?r:qb(r,a);o.classGroupId=e;return}if(typeof a=="function"){if(_8(a)){jp(a(n),r,e,n);return}r.validators.push({validator:a,classGroupId:e});return}Object.entries(a).forEach(([o,s])=>{jp(s,qb(r,o),e,n)})})},qb=(t,r)=>{let e=t;return r.split(mm).forEach(n=>{e.nextPart.has(n)||e.nextPart.set(n,{nextPart:new Map,validators:[]}),e=e.nextPart.get(n)}),e},_8=t=>t.isThemeGetter,S8=(t,r)=>r?t.map(([e,n])=>{const a=n.map(o=>typeof o=="string"?r+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([s,l])=>[r+s,l])):o);return[e,a]}):t,k8=t=>{if(t<1)return{get:()=>{},set:()=>{}};let r=0,e=new Map,n=new Map;const a=(o,s)=>{e.set(o,s),r++,r>t&&(r=0,n=e,e=new Map)};return{get(o){let s=e.get(o);if(s!==void 0)return s;if((s=n.get(o))!==void 0)return a(o,s),s},set(o,s){e.has(o)?e.set(o,s):a(o,s)}}},ky="!",E8=t=>{const{separator:r,experimentalParseClassName:e}=t,n=r.length===1,a=r[0],o=r.length,s=l=>{const c=[];let i=0,u=0,p;for(let g=0;g<l.length;g++){let x=l[g];if(i===0){if(x===a&&(n||l.slice(g,g+o)===r)){c.push(l.slice(u,g)),u=g+o;continue}if(x==="/"){p=g;continue}}x==="["?i++:x==="]"&&i--}const f=c.length===0?l:l.substring(u),h=f.startsWith(ky),v=h?f.substring(1):f,b=p&&p>u?p-u:void 0;return{modifiers:c,hasImportantModifier:h,baseClassName:v,maybePostfixModifierPosition:b}};return e?l=>e({className:l,parseClassName:s}):s},T8=t=>{if(t.length<=1)return t;const r=[];let e=[];return t.forEach(n=>{n[0]==="["?(r.push(...e.sort(),n),e=[]):e.push(n)}),r.push(...e.sort()),r},A8=t=>({cache:k8(t.cacheSize),parseClassName:E8(t),...x8(t)}),C8=/\s+/,N8=(t,r)=>{const{parseClassName:e,getClassGroupId:n,getConflictingClassGroupIds:a}=r,o=[],s=t.trim().split(C8);let l="";for(let c=s.length-1;c>=0;c-=1){const i=s[c],{modifiers:u,hasImportantModifier:p,baseClassName:f,maybePostfixModifierPosition:h}=e(i);let v=!!h,b=n(v?f.substring(0,h):f);if(!b){if(!v){l=i+(l.length>0?" "+l:l);continue}if(b=n(f),!b){l=i+(l.length>0?" "+l:l);continue}v=!1}const g=T8(u).join(":"),x=p?g+ky:g,y=x+b;if(o.includes(y))continue;o.push(y);const k=a(b,v);for(let N=0;N<k.length;++N){const F=k[N];o.push(x+F)}l=i+(l.length>0?" "+l:l)}return l};function j8(){let t=0,r,e,n="";for(;t<arguments.length;)(r=arguments[t++])&&(e=Ey(r))&&(n&&(n+=" "),n+=e);return n}const Ey=t=>{if(typeof t=="string")return t;let r,e="";for(let n=0;n<t.length;n++)t[n]&&(r=Ey(t[n]))&&(e&&(e+=" "),e+=r);return e};function O8(t,...r){let e,n,a,o=s;function s(c){const i=r.reduce((u,p)=>p(u),t());return e=A8(i),n=e.cache.get,a=e.cache.set,o=l,l(c)}function l(c){const i=n(c);if(i)return i;const u=N8(c,e);return a(c,u),u}return function(){return o(j8.apply(null,arguments))}}const Pr=t=>{const r=e=>e[t]||[];return r.isThemeGetter=!0,r},Ty=/^\[(?:([a-z-]+):)?(.+)\]$/i,D8=/^\d+\/\d+$/,R8=new Set(["px","full","screen"]),M8=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,F8=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,I8=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,P8=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,L8=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Zs=t=>Vl(t)||R8.has(t)||D8.test(t),Li=t=>Ql(t,"length",W8),Vl=t=>!!t&&!Number.isNaN(Number(t)),rp=t=>Ql(t,"number",Vl),Qc=t=>!!t&&Number.isInteger(Number(t)),B8=t=>t.endsWith("%")&&Vl(t.slice(0,-1)),nr=t=>Ty.test(t),Bi=t=>M8.test(t),U8=new Set(["length","size","percentage"]),z8=t=>Ql(t,U8,Ay),$8=t=>Ql(t,"position",Ay),V8=new Set(["image","url"]),H8=t=>Ql(t,V8,Y8),q8=t=>Ql(t,"",G8),eu=()=>!0,Ql=(t,r,e)=>{const n=Ty.exec(t);return n?n[1]?typeof r=="string"?n[1]===r:r.has(n[1]):e(n[2]):!1},W8=t=>F8.test(t)&&!I8.test(t),Ay=()=>!1,G8=t=>P8.test(t),Y8=t=>L8.test(t),X8=()=>{const t=Pr("colors"),r=Pr("spacing"),e=Pr("blur"),n=Pr("brightness"),a=Pr("borderColor"),o=Pr("borderRadius"),s=Pr("borderSpacing"),l=Pr("borderWidth"),c=Pr("contrast"),i=Pr("grayscale"),u=Pr("hueRotate"),p=Pr("invert"),f=Pr("gap"),h=Pr("gradientColorStops"),v=Pr("gradientColorStopPositions"),b=Pr("inset"),g=Pr("margin"),x=Pr("opacity"),y=Pr("padding"),k=Pr("saturate"),N=Pr("scale"),F=Pr("sepia"),B=Pr("skew"),W=Pr("space"),V=Pr("translate"),q=()=>["auto","contain","none"],X=()=>["auto","hidden","clip","visible","scroll"],I=()=>["auto",nr,r],H=()=>[nr,r],O=()=>["",Zs,Li],R=()=>["auto",Vl,nr],C=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],w=()=>["solid","dashed","dotted","double","none"],E=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],A=()=>["start","end","center","between","around","evenly","stretch"],T=()=>["","0",nr],D=()=>["auto","avoid","all","avoid-page","page","left","right","column"],U=()=>[Vl,nr];return{cacheSize:500,separator:":",theme:{colors:[eu],spacing:[Zs,Li],blur:["none","",Bi,nr],brightness:U(),borderColor:[t],borderRadius:["none","","full",Bi,nr],borderSpacing:H(),borderWidth:O(),contrast:U(),grayscale:T(),hueRotate:U(),invert:T(),gap:H(),gradientColorStops:[t],gradientColorStopPositions:[B8,Li],inset:I(),margin:I(),opacity:U(),padding:H(),saturate:U(),scale:U(),sepia:T(),skew:U(),space:H(),translate:H()},classGroups:{aspect:[{aspect:["auto","square","video",nr]}],container:["container"],columns:[{columns:[Bi]}],"break-after":[{"break-after":D()}],"break-before":[{"break-before":D()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...C(),nr]}],overflow:[{overflow:X()}],"overflow-x":[{"overflow-x":X()}],"overflow-y":[{"overflow-y":X()}],overscroll:[{overscroll:q()}],"overscroll-x":[{"overscroll-x":q()}],"overscroll-y":[{"overscroll-y":q()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Qc,nr]}],basis:[{basis:I()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",nr]}],grow:[{grow:T()}],shrink:[{shrink:T()}],order:[{order:["first","last","none",Qc,nr]}],"grid-cols":[{"grid-cols":[eu]}],"col-start-end":[{col:["auto",{span:["full",Qc,nr]},nr]}],"col-start":[{"col-start":R()}],"col-end":[{"col-end":R()}],"grid-rows":[{"grid-rows":[eu]}],"row-start-end":[{row:["auto",{span:[Qc,nr]},nr]}],"row-start":[{"row-start":R()}],"row-end":[{"row-end":R()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",nr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",nr]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...A()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...A(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...A(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[W]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[W]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",nr,r]}],"min-w":[{"min-w":[nr,r,"min","max","fit"]}],"max-w":[{"max-w":[nr,r,"none","full","min","max","fit","prose",{screen:[Bi]},Bi]}],h:[{h:[nr,r,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[nr,r,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[nr,r,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[nr,r,"auto","min","max","fit"]}],"font-size":[{text:["base",Bi,Li]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",rp]}],"font-family":[{font:[eu]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",nr]}],"line-clamp":[{"line-clamp":["none",Vl,rp]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Zs,nr]}],"list-image":[{"list-image":["none",nr]}],"list-style-type":[{list:["none","disc","decimal",nr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...w(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Zs,Li]}],"underline-offset":[{"underline-offset":["auto",Zs,nr]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:H()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",nr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",nr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...C(),$8]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",z8]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},H8]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...w(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:w()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...w()]}],"outline-offset":[{"outline-offset":[Zs,nr]}],"outline-w":[{outline:[Zs,Li]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:O()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Zs,Li]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Bi,q8]}],"shadow-color":[{shadow:[eu]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...E(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":E()}],filter:[{filter:["","none"]}],blur:[{blur:[e]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Bi,nr]}],grayscale:[{grayscale:[i]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[p]}],saturate:[{saturate:[k]}],sepia:[{sepia:[F]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[e]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[i]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[p]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[k]}],"backdrop-sepia":[{"backdrop-sepia":[F]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",nr]}],duration:[{duration:U()}],ease:[{ease:["linear","in","out","in-out",nr]}],delay:[{delay:U()}],animate:[{animate:["none","spin","ping","pulse","bounce",nr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[Qc,nr]}],"translate-x":[{"translate-x":[V]}],"translate-y":[{"translate-y":[V]}],"skew-x":[{"skew-x":[B]}],"skew-y":[{"skew-y":[B]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",nr]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",nr]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":H()}],"scroll-mx":[{"scroll-mx":H()}],"scroll-my":[{"scroll-my":H()}],"scroll-ms":[{"scroll-ms":H()}],"scroll-me":[{"scroll-me":H()}],"scroll-mt":[{"scroll-mt":H()}],"scroll-mr":[{"scroll-mr":H()}],"scroll-mb":[{"scroll-mb":H()}],"scroll-ml":[{"scroll-ml":H()}],"scroll-p":[{"scroll-p":H()}],"scroll-px":[{"scroll-px":H()}],"scroll-py":[{"scroll-py":H()}],"scroll-ps":[{"scroll-ps":H()}],"scroll-pe":[{"scroll-pe":H()}],"scroll-pt":[{"scroll-pt":H()}],"scroll-pr":[{"scroll-pr":H()}],"scroll-pb":[{"scroll-pb":H()}],"scroll-pl":[{"scroll-pl":H()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",nr]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Zs,Li,rp]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},K8=O8(X8);function Et(...t){return K8(by(t))}const jt=_e.forwardRef(({className:t,...r},e)=>_.jsx("div",{ref:e,className:Et("rounded-xl border bg-card text-card-foreground shadow dark:shadow-[0_0_15px_-3px_rgba(255,255,255,0.05)]",t),...r}));jt.displayName="Card";const Dt=_e.forwardRef(({className:t,...r},e)=>_.jsx("div",{ref:e,className:Et("flex flex-col space-y-1.5 p-6",t),...r}));Dt.displayName="CardHeader";const Rt=_e.forwardRef(({className:t,...r},e)=>_.jsx("div",{ref:e,className:Et("font-semibold leading-none tracking-tight",t),...r}));Rt.displayName="CardTitle";const Or=_e.forwardRef(({className:t,...r},e)=>_.jsx("div",{ref:e,className:Et("text-sm text-muted-foreground",t),...r}));Or.displayName="CardDescription";const Ot=_e.forwardRef(({className:t,...r},e)=>_.jsx("div",{ref:e,className:Et("p-6 pt-0",t),...r}));Ot.displayName="CardContent";const Cy=_e.forwardRef(({className:t,...r},e)=>_.jsx("div",{ref:e,className:Et("flex items-center p-6 pt-0",t),...r}));Cy.displayName="CardFooter";function Ba({title:t,value:r,description:e,icon:n,trend:a,trendValue:o}){return _.jsxs(jt,{children:[_.jsxs(Dt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[_.jsx(Rt,{className:"text-sm font-medium",children:t}),_.jsx(n,{className:"h-4 w-4 text-muted-foreground"})]}),_.jsxs(Ot,{children:[_.jsx("div",{className:"text-2xl font-bold",children:r}),(e||o)&&_.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[a==="up"&&_.jsxs("span",{className:"text-green-500 mr-1",children:[" ",o]}),a==="down"&&_.jsxs("span",{className:"text-red-500 mr-1",children:[" ",o]}),e]})]})]})}const Wb=t=>{let r;const e=new Set,n=(i,u)=>{const p=typeof i=="function"?i(r):i;if(!Object.is(p,r)){const f=r;r=u??(typeof p!="object"||p===null)?p:Object.assign({},r,p),e.forEach(h=>h(r,f))}},a=()=>r,l={setState:n,getState:a,getInitialState:()=>c,subscribe:i=>(e.add(i),()=>e.delete(i))},c=r=t(n,a,l);return l},Z8=t=>t?Wb(t):Wb,J8=t=>t;function Q8(t,r=J8){const e=Ze.useSyncExternalStore(t.subscribe,Ze.useCallback(()=>r(t.getState()),[t,r]),Ze.useCallback(()=>r(t.getInitialState()),[t,r]));return Ze.useDebugValue(e),e}const Gb=t=>{const r=Z8(t),e=n=>Q8(r,n);return Object.assign(e,r),e},Ny=t=>t?Gb(t):Gb,eS=()=>{try{const t=localStorage.getItem("auth_user");if(t){const r=JSON.parse(t),e=r._cacheTime||0,a=Date.now()-e,o=24*60*60*1e3;if(a<o){const{_cacheTime:s,...l}=r;return l}else localStorage.removeItem("auth_user")}}catch(t){console.warn(" Erro ao carregar usurio do localStorage:",t),localStorage.removeItem("auth_user")}return null},Dn=Ny(t=>({user:eS(),isLoading:!0,setUser:r=>{if(t({user:r}),r)try{const e={...r,_cacheTime:Date.now()};localStorage.setItem("auth_user",JSON.stringify(e))}catch(e){console.warn(" Erro ao salvar usurio no localStorage:",e)}else localStorage.removeItem("auth_user")},setIsLoading:r=>t({isLoading:r}),logout:async()=>{const{supabase:r}=await f8(async()=>{const{supabase:e}=await Promise.resolve().then(()=>lN);return{supabase:e}},void 0);await r.auth.signOut(),localStorage.removeItem("auth_user"),Object.keys(localStorage).forEach(e=>{e.startsWith("profile_")&&localStorage.removeItem(e)}),t({user:null,isLoading:!1})}})),ec=Ny(t=>({filters:{period:void 0},setFilters:r=>t(e=>({filters:{...e.filters,...r}})),resetFilters:()=>t({filters:{period:void 0}})}));var tS=Symbol.for("react.lazy"),Sf=e8[" use ".trim().toString()];function rS(t){return typeof t=="object"&&t!==null&&"then"in t}function jy(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===tS&&"_payload"in t&&rS(t._payload)}function gm(t){const r=aS(t),e=_e.forwardRef((n,a)=>{let{children:o,...s}=n;jy(o)&&typeof Sf=="function"&&(o=Sf(o._payload));const l=_e.Children.toArray(o),c=l.find(iS);if(c){const i=c.props.children,u=l.map(p=>p===c?_e.Children.count(i)>1?_e.Children.only(null):_e.isValidElement(i)?i.props.children:null:p);return _.jsx(r,{...s,ref:a,children:_e.isValidElement(i)?_e.cloneElement(i,void 0,u):null})}return _.jsx(r,{...s,ref:a,children:o})});return e.displayName=`${t}.Slot`,e}var nS=gm("Slot");function aS(t){const r=_e.forwardRef((e,n)=>{let{children:a,...o}=e;if(jy(a)&&typeof Sf=="function"&&(a=Sf(a._payload)),_e.isValidElement(a)){const s=lS(a),l=oS(o,a.props);return a.type!==_e.Fragment&&(l.ref=n?ry(n,s):s),_e.cloneElement(a,l)}return _e.Children.count(a)>1?_e.Children.only(null):null});return r.displayName=`${t}.SlotClone`,r}var sS=Symbol("radix.slottable");function iS(t){return _e.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===sS}function oS(t,r){const e={...r};for(const n in r){const a=t[n],o=r[n];/^on[A-Z]/.test(n)?a&&o?e[n]=(...l)=>{const c=o(...l);return a(...l),c}:a&&(e[n]=a):n==="style"?e[n]={...a,...o}:n==="className"&&(e[n]=[a,o].filter(Boolean).join(" "))}return{...t,...e}}function lS(t){var n,a;let r=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,e=r&&"isReactWarning"in r&&r.isReactWarning;return e?t.ref:(r=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,e=r&&"isReactWarning"in r&&r.isReactWarning,e?t.props.ref:t.props.ref||t.ref)}const Yb=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Xb=by,$f=(t,r)=>e=>{var n;if((r==null?void 0:r.variants)==null)return Xb(t,e==null?void 0:e.class,e==null?void 0:e.className);const{variants:a,defaultVariants:o}=r,s=Object.keys(a).map(i=>{const u=e==null?void 0:e[i],p=o==null?void 0:o[i];if(u===null)return null;const f=Yb(u)||Yb(p);return a[i][f]}),l=e&&Object.entries(e).reduce((i,u)=>{let[p,f]=u;return f===void 0||(i[p]=f),i},{}),c=r==null||(n=r.compoundVariants)===null||n===void 0?void 0:n.reduce((i,u)=>{let{class:p,className:f,...h}=u;return Object.entries(h).every(v=>{let[b,g]=v;return Array.isArray(g)?g.includes({...o,...l}[b]):{...o,...l}[b]===g})?[...i,p,f]:i},[]);return Xb(t,s,c,e==null?void 0:e.class,e==null?void 0:e.className)},Op=$f("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Nt=_e.forwardRef(({className:t,variant:r,size:e,asChild:n=!1,...a},o)=>{const s=n?nS:"button";return _.jsx(s,{className:Et(Op({variant:r,size:e,className:t})),ref:o,...a})});Nt.displayName="Button";const _r=_e.forwardRef(({className:t,type:r,...e},n)=>_.jsx("input",{type:r,className:Et("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:n,...e}));_r.displayName="Input";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),uS=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(r,e,n)=>n?n.toUpperCase():e.toLowerCase()),Kb=t=>{const r=uS(t);return r.charAt(0).toUpperCase()+r.slice(1)},Oy=(...t)=>t.filter((r,e,n)=>!!r&&r.trim()!==""&&n.indexOf(r)===e).join(" ").trim(),dS=t=>{for(const r in t)if(r.startsWith("aria-")||r==="role"||r==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var fS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hS=_e.forwardRef(({color:t="currentColor",size:r=24,strokeWidth:e=2,absoluteStrokeWidth:n,className:a="",children:o,iconNode:s,...l},c)=>_e.createElement("svg",{ref:c,...fS,width:r,height:r,stroke:t,strokeWidth:n?Number(e)*24/Number(r):e,className:Oy("lucide",a),...!o&&!dS(l)&&{"aria-hidden":"true"},...l},[...s.map(([i,u])=>_e.createElement(i,u)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=(t,r)=>{const e=_e.forwardRef(({className:n,...a},o)=>_e.createElement(hS,{ref:o,iconNode:r,className:Oy(`lucide-${cS(Kb(t))}`,`lucide-${t}`,n),...a}));return e.displayName=Kb(t),e};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],Dy=Gt("arrow-down",pS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mS=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],Ry=Gt("arrow-up-down",mS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gS=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],My=Gt("arrow-up",gS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],bS=Gt("calendar",vS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xS=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Zb=Gt("chart-column",xS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],wS=Gt("check",yS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _S=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Uu=Gt("chevron-down",_S);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SS=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],yu=Gt("chevron-left",SS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kS=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],wu=Gt("chevron-right",kS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ES=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Fy=Gt("chevron-up",ES);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Iy=Gt("circle-alert",TS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ao=Gt("circle-x",AS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CS=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],NS=Gt("cloud-upload",CS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jS=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Dp=Gt("dollar-sign",jS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M16 18v-6",key:"15y0np"}]],DS=Gt("file-chart-column-increasing",OS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],MS=Gt("file-spreadsheet",RS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FS=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Jb=Gt("file-text",FS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IS=[["path",{d:"M12.531 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14v6a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341l.427-.473",key:"ol2ft2"}],["path",{d:"m16.5 3.5 5 5",key:"15e6fa"}],["path",{d:"m21.5 3.5-5 5",key:"m0lwru"}]],PS=Gt("funnel-x",IS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LS=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],BS=Gt("history",LS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const US=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Qb=Gt("info",US);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zS=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],$S=Gt("layers",zS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VS=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],ex=Gt("layout-dashboard",VS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HS=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],oi=Gt("loader-circle",HS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qS=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Rp=Gt("log-out",qS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WS=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],GS=Gt("mail",WS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YS=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Mp=Gt("map-pin",YS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XS=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],KS=Gt("menu",XS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZS=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],tx=Gt("moon",ZS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JS=[["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}],["path",{d:"m17 13 5 5m-5 0 5-5",key:"im3w4b"}]],Ul=Gt("package-x",JS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QS=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],ek=Gt("package",QS);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tk=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],rx=Gt("pen",tk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rk=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],nk=Gt("percent",rk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ak=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],tu=Gt("plus",ak);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sk=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],ik=Gt("printer",sk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ok=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],Py=Gt("refresh-ccw",ok);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lk=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],vm=Gt("refresh-cw",lk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ck=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],uk=Gt("save",ck);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dk=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],fk=Gt("search",dk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hk=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],pk=Gt("settings",hk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mk=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Fp=Gt("share-2",mk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gk=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],nx=Gt("shield",gk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vk=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],_f=Gt("square-check-big",vk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bk=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ax=Gt("square-pen",bk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xk=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],sx=Gt("square",xk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yk=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],ix=Gt("sun",yk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wk=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],za=Gt("trash-2",wk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _k=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],ox=Gt("trending-down",_k);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sk=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],_u=Gt("trending-up",Sk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kk=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ml=Gt("triangle-alert",kk);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ek=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ip=Gt("user",Ek);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Vf=Gt("x",Tk),$a=k5,Va=E5,xa=_e.forwardRef(({className:t,children:r,...e},n)=>_.jsxs(ny,{ref:n,className:Et("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...e,children:[r,_.jsx(x5,{asChild:!0,children:_.jsx(Uu,{className:"h-4 w-4 opacity-50"})})]}));xa.displayName=ny.displayName;const Ly=_e.forwardRef(({className:t,...r},e)=>_.jsx(ay,{ref:e,className:Et("flex cursor-default items-center justify-center py-1",t),...r,children:_.jsx(Fy,{className:"h-4 w-4"})}));Ly.displayName=ay.displayName;const By=_e.forwardRef(({className:t,...r},e)=>_.jsx(sy,{ref:e,className:Et("flex cursor-default items-center justify-center py-1",t),...r,children:_.jsx(Uu,{className:"h-4 w-4"})}));By.displayName=sy.displayName;const ya=_e.forwardRef(({className:t,children:r,position:e="popper",...n},a)=>_.jsx(y5,{children:_.jsxs(iy,{ref:a,className:Et("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",e==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:e,...n,children:[_.jsx(Ly,{}),_.jsx(w5,{className:Et("p-1",e==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),_.jsx(By,{})]})}));ya.displayName=iy.displayName;const Ak=_e.forwardRef(({className:t,...r},e)=>_.jsx(oy,{ref:e,className:Et("px-2 py-1.5 text-sm font-semibold",t),...r}));Ak.displayName=oy.displayName;const sr=_e.forwardRef(({className:t,children:r,...e},n)=>_.jsxs(ly,{ref:n,className:Et("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...e,children:[_.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:_.jsx(_5,{children:_.jsx(wS,{className:"h-4 w-4"})})}),_.jsx(S5,{children:r})]}));sr.displayName=ly.displayName;const Ck=_e.forwardRef(({className:t,...r},e)=>_.jsx(cy,{ref:e,className:Et("-mx-1 my-1 h-px bg-muted",t),...r}));Ck.displayName=cy.displayName;var bm="Popper",[Uy,zy]=Uf(bm),[Nk,$y]=Uy(bm),Vy=t=>{const{__scopePopper:r,children:e}=t,[n,a]=_e.useState(null);return _.jsx(Nk,{scope:r,anchor:n,onAnchorChange:a,children:e})};Vy.displayName=bm;var Hy="PopperAnchor",qy=_e.forwardRef((t,r)=>{const{__scopePopper:e,virtualRef:n,...a}=t,o=$y(Hy,e),s=_e.useRef(null),l=Bu(r,s),c=_e.useRef(null);return _e.useEffect(()=>{const i=c.current;c.current=(n==null?void 0:n.current)||s.current,i!==c.current&&o.onAnchorChange(c.current)}),n?null:_.jsx(Rs.div,{...a,ref:l})});qy.displayName=Hy;var xm="PopperContent",[jk,Ok]=Uy(xm),Wy=_e.forwardRef((t,r)=>{var ee,L,M,Z,se,ae;const{__scopePopper:e,side:n="bottom",sideOffset:a=0,align:o="center",alignOffset:s=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:i=[],collisionPadding:u=0,sticky:p="partial",hideWhenDetached:f=!1,updatePositionStrategy:h="optimized",onPlaced:v,...b}=t,g=$y(xm,e),[x,y]=_e.useState(null),k=Bu(r,ne=>y(ne)),[N,F]=_e.useState(null),B=T5(N),W=(B==null?void 0:B.width)??0,V=(B==null?void 0:B.height)??0,q=n+(o!=="center"?"-"+o:""),X=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},I=Array.isArray(i)?i:[i],H=I.length>0,O={padding:X,boundary:I.filter(Rk),altBoundary:H},{refs:R,floatingStyles:C,placement:w,isPositioned:E,middlewareData:A}=A5({strategy:"fixed",placement:q,whileElementsMounted:(...ne)=>F5(...ne,{animationFrame:h==="always"}),elements:{reference:g.anchor},middleware:[C5({mainAxis:a+V,alignmentAxis:s}),c&&N5({mainAxis:!0,crossAxis:!1,limiter:p==="partial"?M5():void 0,...O}),c&&j5({...O}),O5({...O,apply:({elements:ne,rects:Q,availableWidth:fe,availableHeight:le})=>{const{width:te,height:ce}=Q.reference,he=ne.floating.style;he.setProperty("--radix-popper-available-width",`${fe}px`),he.setProperty("--radix-popper-available-height",`${le}px`),he.setProperty("--radix-popper-anchor-width",`${te}px`),he.setProperty("--radix-popper-anchor-height",`${ce}px`)}}),N&&D5({element:N,padding:l}),Mk({arrowWidth:W,arrowHeight:V}),f&&R5({strategy:"referenceHidden",...O})]}),[T,D]=Xy(w),U=dm(v);xu(()=>{E&&(U==null||U())},[E,U]);const P=(ee=A.arrow)==null?void 0:ee.x,K=(L=A.arrow)==null?void 0:L.y,Y=((M=A.arrow)==null?void 0:M.centerOffset)!==0,[re,z]=_e.useState();return xu(()=>{x&&z(window.getComputedStyle(x).zIndex)},[x]),_.jsx("div",{ref:R.setFloating,"data-radix-popper-content-wrapper":"",style:{...C,transform:E?C.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:re,"--radix-popper-transform-origin":[(Z=A.transformOrigin)==null?void 0:Z.x,(se=A.transformOrigin)==null?void 0:se.y].join(" "),...((ae=A.hide)==null?void 0:ae.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:_.jsx(jk,{scope:e,placedSide:T,onArrowChange:F,arrowX:P,arrowY:K,shouldHideArrow:Y,children:_.jsx(Rs.div,{"data-side":T,"data-align":D,...b,ref:k,style:{...b.style,animation:E?void 0:"none"}})})})});Wy.displayName=xm;var Gy="PopperArrow",Dk={top:"bottom",right:"left",bottom:"top",left:"right"},Yy=_e.forwardRef(function(r,e){const{__scopePopper:n,...a}=r,o=Ok(Gy,n),s=Dk[o.placedSide];return _.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:_.jsx(I5,{...a,ref:e,style:{...a.style,display:"block"}})})});Yy.displayName=Gy;function Rk(t){return t!==null}var Mk=t=>({name:"transformOrigin",options:t,fn(r){var g,x,y;const{placement:e,rects:n,middlewareData:a}=r,s=((g=a.arrow)==null?void 0:g.centerOffset)!==0,l=s?0:t.arrowWidth,c=s?0:t.arrowHeight,[i,u]=Xy(e),p={start:"0%",center:"50%",end:"100%"}[u],f=(((x=a.arrow)==null?void 0:x.x)??0)+l/2,h=(((y=a.arrow)==null?void 0:y.y)??0)+c/2;let v="",b="";return i==="bottom"?(v=s?p:`${f}px`,b=`${-c}px`):i==="top"?(v=s?p:`${f}px`,b=`${n.floating.height+c}px`):i==="right"?(v=`${-c}px`,b=s?p:`${h}px`):i==="left"&&(v=`${n.floating.width+c}px`,b=s?p:`${h}px`),{data:{x:v,y:b}}}});function Xy(t){const[r,e="center"]=t.split("-");return[r,e]}var Fk=Vy,Ky=qy,Ik=Wy,Pk=Yy;function Lk(t){const r=Bk(t),e=_e.forwardRef((n,a)=>{const{children:o,...s}=n,l=_e.Children.toArray(o),c=l.find(zk);if(c){const i=c.props.children,u=l.map(p=>p===c?_e.Children.count(i)>1?_e.Children.only(null):_e.isValidElement(i)?i.props.children:null:p);return _.jsx(r,{...s,ref:a,children:_e.isValidElement(i)?_e.cloneElement(i,void 0,u):null})}return _.jsx(r,{...s,ref:a,children:o})});return e.displayName=`${t}.Slot`,e}function Bk(t){const r=_e.forwardRef((e,n)=>{const{children:a,...o}=e;if(_e.isValidElement(a)){const s=Vk(a),l=$k(o,a.props);return a.type!==_e.Fragment&&(l.ref=n?ry(n,s):s),_e.cloneElement(a,l)}return _e.Children.count(a)>1?_e.Children.only(null):null});return r.displayName=`${t}.SlotClone`,r}var Uk=Symbol("radix.slottable");function zk(t){return _e.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Uk}function $k(t,r){const e={...r};for(const n in r){const a=t[n],o=r[n];/^on[A-Z]/.test(n)?a&&o?e[n]=(...l)=>{const c=o(...l);return a(...l),c}:a&&(e[n]=a):n==="style"?e[n]={...a,...o}:n==="className"&&(e[n]=[a,o].filter(Boolean).join(" "))}return{...t,...e}}function Vk(t){var n,a;let r=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,e=r&&"isReactWarning"in r&&r.isReactWarning;return e?t.ref:(r=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,e=r&&"isReactWarning"in r&&r.isReactWarning,e?t.props.ref:t.props.ref||t.ref)}var Hf="Popover",[Zy,KB]=Uf(Hf,[zy]),zu=zy(),[Hk,ro]=Zy(Hf),Jy=t=>{const{__scopePopover:r,children:e,open:n,defaultOpen:a,onOpenChange:o,modal:s=!1}=t,l=zu(r),c=_e.useRef(null),[i,u]=_e.useState(!1),[p,f]=hm({prop:n,defaultProp:a??!1,onChange:o,caller:Hf});return _.jsx(Fk,{...l,children:_.jsx(Hk,{scope:r,contentId:pm(),triggerRef:c,open:p,onOpenChange:f,onOpenToggle:_e.useCallback(()=>f(h=>!h),[f]),hasCustomAnchor:i,onCustomAnchorAdd:_e.useCallback(()=>u(!0),[]),onCustomAnchorRemove:_e.useCallback(()=>u(!1),[]),modal:s,children:e})})};Jy.displayName=Hf;var Qy="PopoverAnchor",qk=_e.forwardRef((t,r)=>{const{__scopePopover:e,...n}=t,a=ro(Qy,e),o=zu(e),{onCustomAnchorAdd:s,onCustomAnchorRemove:l}=a;return _e.useEffect(()=>(s(),()=>l()),[s,l]),_.jsx(Ky,{...o,...n,ref:r})});qk.displayName=Qy;var ew="PopoverTrigger",tw=_e.forwardRef((t,r)=>{const{__scopePopover:e,...n}=t,a=ro(ew,e),o=zu(e),s=Bu(r,a.triggerRef),l=_.jsx(Rs.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":iw(a.open),...n,ref:s,onClick:ca(t.onClick,a.onOpenToggle)});return a.hasCustomAnchor?l:_.jsx(Ky,{asChild:!0,...o,children:l})});tw.displayName=ew;var ym="PopoverPortal",[Wk,Gk]=Zy(ym,{forceMount:void 0}),rw=t=>{const{__scopePopover:r,forceMount:e,children:n,container:a}=t,o=ro(ym,r);return _.jsx(Wk,{scope:r,forceMount:e,children:_.jsx(fm,{present:e||o.open,children:_.jsx(P5,{asChild:!0,container:a,children:n})})})};rw.displayName=ym;var Kl="PopoverContent",nw=_e.forwardRef((t,r)=>{const e=Gk(Kl,t.__scopePopover),{forceMount:n=e.forceMount,...a}=t,o=ro(Kl,t.__scopePopover);return _.jsx(fm,{present:n||o.open,children:o.modal?_.jsx(Xk,{...a,ref:r}):_.jsx(Kk,{...a,ref:r})})});nw.displayName=Kl;var Yk=Lk("PopoverContent.RemoveScroll"),Xk=_e.forwardRef((t,r)=>{const e=ro(Kl,t.__scopePopover),n=_e.useRef(null),a=Bu(r,n),o=_e.useRef(!1);return _e.useEffect(()=>{const s=n.current;if(s)return L5(s)},[]),_.jsx(B5,{as:Yk,allowPinchZoom:!0,children:_.jsx(aw,{...t,ref:a,trapFocus:e.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ca(t.onCloseAutoFocus,s=>{var l;s.preventDefault(),o.current||(l=e.triggerRef.current)==null||l.focus()}),onPointerDownOutside:ca(t.onPointerDownOutside,s=>{const l=s.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,i=l.button===2||c;o.current=i},{checkForDefaultPrevented:!1}),onFocusOutside:ca(t.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1})})})}),Kk=_e.forwardRef((t,r)=>{const e=ro(Kl,t.__scopePopover),n=_e.useRef(!1),a=_e.useRef(!1);return _.jsx(aw,{...t,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var s,l;(s=t.onCloseAutoFocus)==null||s.call(t,o),o.defaultPrevented||(n.current||(l=e.triggerRef.current)==null||l.focus(),o.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:o=>{var c,i;(c=t.onInteractOutside)==null||c.call(t,o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const s=o.target;((i=e.triggerRef.current)==null?void 0:i.contains(s))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),aw=_e.forwardRef((t,r)=>{const{__scopePopover:e,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:s,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:i,onInteractOutside:u,...p}=t,f=ro(Kl,e),h=zu(e);return U5(),_.jsx(z5,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:o,children:_.jsx($5,{asChild:!0,disableOutsidePointerEvents:s,onInteractOutside:u,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:i,onDismiss:()=>f.onOpenChange(!1),children:_.jsx(Ik,{"data-state":iw(f.open),role:"dialog",id:f.contentId,...h,...p,ref:r,style:{...p.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),sw="PopoverClose",Zk=_e.forwardRef((t,r)=>{const{__scopePopover:e,...n}=t,a=ro(sw,e);return _.jsx(Rs.button,{type:"button",...n,ref:r,onClick:ca(t.onClick,()=>a.onOpenChange(!1))})});Zk.displayName=sw;var Jk="PopoverArrow",Qk=_e.forwardRef((t,r)=>{const{__scopePopover:e,...n}=t,a=zu(e);return _.jsx(Pk,{...a,...n,ref:r})});Qk.displayName=Jk;function iw(t){return t?"open":"closed"}var eE=Jy,tE=tw,rE=rw,ow=nw;const nE=eE,aE=tE,lw=_e.forwardRef(({className:t,align:r="center",sideOffset:e=4,...n},a)=>_.jsx(rE,{children:_.jsx(ow,{ref:a,align:r,sideOffset:e,className:Et("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",t),...n})}));lw.displayName=ow.displayName;function sE(t,r,e="long"){return new Intl.DateTimeFormat("en-US",{hour:"numeric",timeZone:t,timeZoneName:e}).format(r).split(/\s/g).slice(2).join(" ")}const np={},ru={};function Ro(t,r){try{const n=(np[t]||(np[t]=new Intl.DateTimeFormat("en-US",{timeZone:t,timeZoneName:"longOffset"}).format))(r).split("GMT")[1];return n in ru?ru[n]:lx(n,n.split(":"))}catch{if(t in ru)return ru[t];const e=t==null?void 0:t.match(iE);return e?lx(t,e.slice(1)):NaN}}const iE=/([+-]\d\d):?(\d\d)?/;function lx(t,r){const e=+(r[0]||0),n=+(r[1]||0),a=+(r[2]||0)/60;return ru[t]=e*60+n>0?e*60+n+a:e*60-n-a}class Ts extends Date{constructor(...r){super(),r.length>1&&typeof r[r.length-1]=="string"&&(this.timeZone=r.pop()),this.internal=new Date,isNaN(Ro(this.timeZone,this))?this.setTime(NaN):r.length?typeof r[0]=="number"&&(r.length===1||r.length===2&&typeof r[1]!="number")?this.setTime(r[0]):typeof r[0]=="string"?this.setTime(+new Date(r[0])):r[0]instanceof Date?this.setTime(+r[0]):(this.setTime(+new Date(...r)),cw(this),Pp(this)):this.setTime(Date.now())}static tz(r,...e){return e.length?new Ts(...e,r):new Ts(Date.now(),r)}withTimeZone(r){return new Ts(+this,r)}getTimezoneOffset(){const r=-Ro(this.timeZone,this);return r>0?Math.floor(r):Math.ceil(r)}setTime(r){return Date.prototype.setTime.apply(this,arguments),Pp(this),+this}[Symbol.for("constructDateFrom")](r){return new Ts(+new Date(r),this.timeZone)}}const cx=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(t=>{if(!cx.test(t))return;const r=t.replace(cx,"$1UTC");Ts.prototype[r]&&(t.startsWith("get")?Ts.prototype[t]=function(){return this.internal[r]()}:(Ts.prototype[t]=function(){return Date.prototype[r].apply(this.internal,arguments),oE(this),+this},Ts.prototype[r]=function(){return Date.prototype[r].apply(this,arguments),Pp(this),+this}))});function Pp(t){t.internal.setTime(+t),t.internal.setUTCSeconds(t.internal.getUTCSeconds()-Math.round(-Ro(t.timeZone,t)*60))}function oE(t){Date.prototype.setFullYear.call(t,t.internal.getUTCFullYear(),t.internal.getUTCMonth(),t.internal.getUTCDate()),Date.prototype.setHours.call(t,t.internal.getUTCHours(),t.internal.getUTCMinutes(),t.internal.getUTCSeconds(),t.internal.getUTCMilliseconds()),cw(t)}function cw(t){const r=Ro(t.timeZone,t),e=r>0?Math.floor(r):Math.ceil(r),n=new Date(+t);n.setUTCHours(n.getUTCHours()-1);const a=-new Date(+t).getTimezoneOffset(),o=-new Date(+n).getTimezoneOffset(),s=a-o,l=Date.prototype.getHours.apply(t)!==t.internal.getUTCHours();s&&l&&t.internal.setUTCMinutes(t.internal.getUTCMinutes()+s);const c=a-e;c&&Date.prototype.setUTCMinutes.call(t,Date.prototype.getUTCMinutes.call(t)+c);const i=new Date(+t);i.setUTCSeconds(0);const u=a>0?i.getSeconds():(i.getSeconds()-60)%60,p=Math.round(-(Ro(t.timeZone,t)*60))%60;(p||u)&&(t.internal.setUTCSeconds(t.internal.getUTCSeconds()+p),Date.prototype.setUTCSeconds.call(t,Date.prototype.getUTCSeconds.call(t)+p+u));const f=Ro(t.timeZone,t),h=f>0?Math.floor(f):Math.ceil(f),b=-new Date(+t).getTimezoneOffset()-h,g=h!==e,x=b-c;if(g&&x){Date.prototype.setUTCMinutes.call(t,Date.prototype.getUTCMinutes.call(t)+x);const y=Ro(t.timeZone,t),k=y>0?Math.floor(y):Math.ceil(y),N=h-k;N&&(t.internal.setUTCMinutes(t.internal.getUTCMinutes()+N),Date.prototype.setUTCMinutes.call(t,Date.prototype.getUTCMinutes.call(t)+N))}}class Ln extends Ts{static tz(r,...e){return e.length?new Ln(...e,r):new Ln(Date.now(),r)}toISOString(){const[r,e,n]=this.tzComponents(),a=`${r}${e}:${n}`;return this.internal.toISOString().slice(0,-1)+a}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[r,e,n,a]=this.internal.toUTCString().split(" ");return`${r==null?void 0:r.slice(0,-1)} ${n} ${e} ${a}`}toTimeString(){const r=this.internal.toUTCString().split(" ")[4],[e,n,a]=this.tzComponents();return`${r} GMT${e}${n}${a} (${sE(this.timeZone,this)})`}toLocaleString(r,e){return Date.prototype.toLocaleString.call(this,r,{...e,timeZone:(e==null?void 0:e.timeZone)||this.timeZone})}toLocaleDateString(r,e){return Date.prototype.toLocaleDateString.call(this,r,{...e,timeZone:(e==null?void 0:e.timeZone)||this.timeZone})}toLocaleTimeString(r,e){return Date.prototype.toLocaleTimeString.call(this,r,{...e,timeZone:(e==null?void 0:e.timeZone)||this.timeZone})}tzComponents(){const r=this.getTimezoneOffset(),e=r>0?"-":"+",n=String(Math.floor(Math.abs(r)/60)).padStart(2,"0"),a=String(Math.abs(r)%60).padStart(2,"0");return[e,n,a]}withTimeZone(r){return new Ln(+this,r)}[Symbol.for("constructDateFrom")](r){return new Ln(+new Date(r),this.timeZone)}}const uw=6048e5,lE=864e5,ux=Symbol.for("constructDateFrom");function fn(t,r){return typeof t=="function"?t(r):t&&typeof t=="object"&&ux in t?t[ux](r):t instanceof Date?new t.constructor(r):new Date(r)}function Sr(t,r){return fn(r||t,t)}function wm(t,r,e){const n=Sr(t,e==null?void 0:e.in);return isNaN(r)?fn(t,NaN):(r&&n.setDate(n.getDate()+r),n)}function _m(t,r,e){const n=Sr(t,e==null?void 0:e.in);if(isNaN(r))return fn(t,NaN);if(!r)return n;const a=n.getDate(),o=fn(t,n.getTime());o.setMonth(n.getMonth()+r+1,0);const s=o.getDate();return a>=s?o:(n.setFullYear(o.getFullYear(),o.getMonth(),a),n)}let cE={};function $u(){return cE}function Ji(t,r){var l,c,i,u;const e=$u(),n=(r==null?void 0:r.weekStartsOn)??((c=(l=r==null?void 0:r.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??e.weekStartsOn??((u=(i=e.locale)==null?void 0:i.options)==null?void 0:u.weekStartsOn)??0,a=Sr(t,r==null?void 0:r.in),o=a.getDay(),s=(o<n?7:0)+o-n;return a.setDate(a.getDate()-s),a.setHours(0,0,0,0),a}function Su(t,r){return Ji(t,{...r,weekStartsOn:1})}function dw(t,r){const e=Sr(t,r==null?void 0:r.in),n=e.getFullYear(),a=fn(e,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const o=Su(a),s=fn(e,0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);const l=Su(s);return e.getTime()>=o.getTime()?n+1:e.getTime()>=l.getTime()?n:n-1}function dx(t){const r=Sr(t),e=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return e.setUTCFullYear(r.getFullYear()),+t-+e}function tc(t,...r){const e=fn.bind(null,r.find(n=>typeof n=="object"));return r.map(e)}function Ki(t,r){const e=Sr(t,r==null?void 0:r.in);return e.setHours(0,0,0,0),e}function Sm(t,r,e){const[n,a]=tc(e==null?void 0:e.in,t,r),o=Ki(n),s=Ki(a),l=+o-dx(o),c=+s-dx(s);return Math.round((l-c)/lE)}function uE(t,r){const e=dw(t,r),n=fn(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),Su(n)}function fw(t,r,e){return wm(t,r*7,e)}function dE(t,r,e){return _m(t,r*12,e)}function fE(t,r){let e,n=r==null?void 0:r.in;return t.forEach(a=>{!n&&typeof a=="object"&&(n=fn.bind(null,a));const o=Sr(a,n);(!e||e<o||isNaN(+o))&&(e=o)}),fn(n,e||NaN)}function hE(t,r){let e,n=r==null?void 0:r.in;return t.forEach(a=>{!n&&typeof a=="object"&&(n=fn.bind(null,a));const o=Sr(a,n);(!e||e>o||isNaN(+o))&&(e=o)}),fn(n,e||NaN)}function pE(t,r,e){const[n,a]=tc(e==null?void 0:e.in,t,r);return+Ki(n)==+Ki(a)}function hw(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function mE(t){return!(!hw(t)&&typeof t!="number"||isNaN(+Sr(t)))}function pw(t,r,e){const[n,a]=tc(e==null?void 0:e.in,t,r),o=n.getFullYear()-a.getFullYear(),s=n.getMonth()-a.getMonth();return o*12+s}function ap(t,r){const e=Sr(t,r==null?void 0:r.in);return e.setHours(23,59,59,999),e}function Lp(t,r){const e=Sr(t,r==null?void 0:r.in),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function mw(t,r){const[e,n]=tc(t,r.start,r.end);return{start:e,end:n}}function gE(t,r){const{start:e,end:n}=mw(r==null?void 0:r.in,t);let a=+e>+n;const o=a?+e:+n,s=a?n:e;s.setHours(0,0,0,0),s.setDate(1);let l=1;const c=[];for(;+s<=o;)c.push(fn(e,s)),s.setMonth(s.getMonth()+l);return a?c.reverse():c}function vE(t,r){const e=Sr(t,r==null?void 0:r.in),n=e.getMonth(),a=n-n%3;return e.setMonth(a,1),e.setHours(0,0,0,0),e}function Bp(t,r){const e=Sr(t,r==null?void 0:r.in);return e.setDate(1),e.setHours(0,0,0,0),e}function Up(t,r){const e=Sr(t,r==null?void 0:r.in),n=e.getFullYear();return e.setFullYear(n+1,0,0),e.setHours(23,59,59,999),e}function km(t,r){const e=Sr(t,r==null?void 0:r.in);return e.setFullYear(e.getFullYear(),0,1),e.setHours(0,0,0,0),e}function bE(t,r){const{start:e,end:n}=mw(r==null?void 0:r.in,t);let a=+e>+n;const o=a?+e:+n,s=a?n:e;s.setHours(0,0,0,0),s.setMonth(0,1);let l=1;const c=[];for(;+s<=o;)c.push(fn(e,s)),s.setFullYear(s.getFullYear()+l);return a?c.reverse():c}function kf(t,r){var l,c,i,u;const e=$u(),n=(r==null?void 0:r.weekStartsOn)??((c=(l=r==null?void 0:r.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??e.weekStartsOn??((u=(i=e.locale)==null?void 0:i.options)==null?void 0:u.weekStartsOn)??0,a=Sr(t,r==null?void 0:r.in),o=a.getDay(),s=(o<n?-7:0)+6-(o-n);return a.setDate(a.getDate()+s),a.setHours(23,59,59,999),a}function xE(t,r){return kf(t,{...r,weekStartsOn:1})}function yE(t,r){const e=Sr(t,r==null?void 0:r.in),n=e.getMonth(),a=n-n%3+3;return e.setMonth(a,0),e.setHours(23,59,59,999),e}const wE={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},_E=(t,r,e)=>{let n;const a=wE[t];return typeof a=="string"?n=a:r===1?n=a.one:n=a.other.replace("{{count}}",r.toString()),e!=null&&e.addSuffix?e.comparison&&e.comparison>0?"in "+n:n+" ago":n};function Hl(t){return(r={})=>{const e=r.width?String(r.width):t.defaultWidth;return t.formats[e]||t.formats[t.defaultWidth]}}const SE={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},kE={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},EE={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},TE={date:Hl({formats:SE,defaultWidth:"full"}),time:Hl({formats:kE,defaultWidth:"full"}),dateTime:Hl({formats:EE,defaultWidth:"full"})},AE={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},CE=(t,r,e,n)=>AE[t];function ks(t){return(r,e)=>{const n=e!=null&&e.context?String(e.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const s=t.defaultFormattingWidth||t.defaultWidth,l=e!=null&&e.width?String(e.width):s;a=t.formattingValues[l]||t.formattingValues[s]}else{const s=t.defaultWidth,l=e!=null&&e.width?String(e.width):t.defaultWidth;a=t.values[l]||t.values[s]}const o=t.argumentCallback?t.argumentCallback(r):r;return a[o]}}const NE={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},jE={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},OE={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},DE={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},RE={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},ME={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},FE=(t,r)=>{const e=Number(t),n=e%100;if(n>20||n<10)switch(n%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"},IE={ordinalNumber:FE,era:ks({values:NE,defaultWidth:"wide"}),quarter:ks({values:jE,defaultWidth:"wide",argumentCallback:t=>t-1}),month:ks({values:OE,defaultWidth:"wide"}),day:ks({values:DE,defaultWidth:"wide"}),dayPeriod:ks({values:RE,defaultWidth:"wide",formattingValues:ME,defaultFormattingWidth:"wide"})};function Es(t){return(r,e={})=>{const n=e.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],o=r.match(a);if(!o)return null;const s=o[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?LE(l,p=>p.test(s)):PE(l,p=>p.test(s));let i;i=t.valueCallback?t.valueCallback(c):c,i=e.valueCallback?e.valueCallback(i):i;const u=r.slice(s.length);return{value:i,rest:u}}}function PE(t,r){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&r(t[e]))return e}function LE(t,r){for(let e=0;e<t.length;e++)if(r(t[e]))return e}function gw(t){return(r,e={})=>{const n=r.match(t.matchPattern);if(!n)return null;const a=n[0],o=r.match(t.parsePattern);if(!o)return null;let s=t.valueCallback?t.valueCallback(o[0]):o[0];s=e.valueCallback?e.valueCallback(s):s;const l=r.slice(a.length);return{value:s,rest:l}}}const BE=/^(\d+)(th|st|nd|rd)?/i,UE=/\d+/i,zE={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},$E={any:[/^b/i,/^(a|c)/i]},VE={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},HE={any:[/1/i,/2/i,/3/i,/4/i]},qE={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},WE={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},GE={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},YE={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},XE={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},KE={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},ZE={ordinalNumber:gw({matchPattern:BE,parsePattern:UE,valueCallback:t=>parseInt(t,10)}),era:Es({matchPatterns:zE,defaultMatchWidth:"wide",parsePatterns:$E,defaultParseWidth:"any"}),quarter:Es({matchPatterns:VE,defaultMatchWidth:"wide",parsePatterns:HE,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Es({matchPatterns:qE,defaultMatchWidth:"wide",parsePatterns:WE,defaultParseWidth:"any"}),day:Es({matchPatterns:GE,defaultMatchWidth:"wide",parsePatterns:YE,defaultParseWidth:"any"}),dayPeriod:Es({matchPatterns:XE,defaultMatchWidth:"any",parsePatterns:KE,defaultParseWidth:"any"})},Fl={code:"en-US",formatDistance:_E,formatLong:TE,formatRelative:CE,localize:IE,match:ZE,options:{weekStartsOn:0,firstWeekContainsDate:1}};function JE(t,r){const e=Sr(t,r==null?void 0:r.in);return Sm(e,km(e))+1}function Em(t,r){const e=Sr(t,r==null?void 0:r.in),n=+Su(e)-+uE(e);return Math.round(n/uw)+1}function vw(t,r){var u,p,f,h;const e=Sr(t,r==null?void 0:r.in),n=e.getFullYear(),a=$u(),o=(r==null?void 0:r.firstWeekContainsDate)??((p=(u=r==null?void 0:r.locale)==null?void 0:u.options)==null?void 0:p.firstWeekContainsDate)??a.firstWeekContainsDate??((h=(f=a.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,s=fn((r==null?void 0:r.in)||t,0);s.setFullYear(n+1,0,o),s.setHours(0,0,0,0);const l=Ji(s,r),c=fn((r==null?void 0:r.in)||t,0);c.setFullYear(n,0,o),c.setHours(0,0,0,0);const i=Ji(c,r);return+e>=+l?n+1:+e>=+i?n:n-1}function QE(t,r){var l,c,i,u;const e=$u(),n=(r==null?void 0:r.firstWeekContainsDate)??((c=(l=r==null?void 0:r.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??e.firstWeekContainsDate??((u=(i=e.locale)==null?void 0:i.options)==null?void 0:u.firstWeekContainsDate)??1,a=vw(t,r),o=fn((r==null?void 0:r.in)||t,0);return o.setFullYear(a,0,n),o.setHours(0,0,0,0),Ji(o,r)}function Tm(t,r){const e=Sr(t,r==null?void 0:r.in),n=+Ji(e,r)-+QE(e,r);return Math.round(n/uw)+1}function Ar(t,r){const e=t<0?"-":"",n=Math.abs(t).toString().padStart(r,"0");return e+n}const Ui={y(t,r){const e=t.getFullYear(),n=e>0?e:1-e;return Ar(r==="yy"?n%100:n,r.length)},M(t,r){const e=t.getMonth();return r==="M"?String(e+1):Ar(e+1,2)},d(t,r){return Ar(t.getDate(),r.length)},a(t,r){const e=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return e.toUpperCase();case"aaa":return e;case"aaaaa":return e[0];case"aaaa":default:return e==="am"?"a.m.":"p.m."}},h(t,r){return Ar(t.getHours()%12||12,r.length)},H(t,r){return Ar(t.getHours(),r.length)},m(t,r){return Ar(t.getMinutes(),r.length)},s(t,r){return Ar(t.getSeconds(),r.length)},S(t,r){const e=r.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,e-3));return Ar(a,r.length)}},Sl={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},fx={G:function(t,r,e){const n=t.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return e.era(n,{width:"abbreviated"});case"GGGGG":return e.era(n,{width:"narrow"});case"GGGG":default:return e.era(n,{width:"wide"})}},y:function(t,r,e){if(r==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return e.ordinalNumber(a,{unit:"year"})}return Ui.y(t,r)},Y:function(t,r,e,n){const a=vw(t,n),o=a>0?a:1-a;if(r==="YY"){const s=o%100;return Ar(s,2)}return r==="Yo"?e.ordinalNumber(o,{unit:"year"}):Ar(o,r.length)},R:function(t,r){const e=dw(t);return Ar(e,r.length)},u:function(t,r){const e=t.getFullYear();return Ar(e,r.length)},Q:function(t,r,e){const n=Math.ceil((t.getMonth()+1)/3);switch(r){case"Q":return String(n);case"QQ":return Ar(n,2);case"Qo":return e.ordinalNumber(n,{unit:"quarter"});case"QQQ":return e.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return e.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return e.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,r,e){const n=Math.ceil((t.getMonth()+1)/3);switch(r){case"q":return String(n);case"qq":return Ar(n,2);case"qo":return e.ordinalNumber(n,{unit:"quarter"});case"qqq":return e.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return e.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return e.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,r,e){const n=t.getMonth();switch(r){case"M":case"MM":return Ui.M(t,r);case"Mo":return e.ordinalNumber(n+1,{unit:"month"});case"MMM":return e.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return e.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return e.month(n,{width:"wide",context:"formatting"})}},L:function(t,r,e){const n=t.getMonth();switch(r){case"L":return String(n+1);case"LL":return Ar(n+1,2);case"Lo":return e.ordinalNumber(n+1,{unit:"month"});case"LLL":return e.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return e.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return e.month(n,{width:"wide",context:"standalone"})}},w:function(t,r,e,n){const a=Tm(t,n);return r==="wo"?e.ordinalNumber(a,{unit:"week"}):Ar(a,r.length)},I:function(t,r,e){const n=Em(t);return r==="Io"?e.ordinalNumber(n,{unit:"week"}):Ar(n,r.length)},d:function(t,r,e){return r==="do"?e.ordinalNumber(t.getDate(),{unit:"date"}):Ui.d(t,r)},D:function(t,r,e){const n=JE(t);return r==="Do"?e.ordinalNumber(n,{unit:"dayOfYear"}):Ar(n,r.length)},E:function(t,r,e){const n=t.getDay();switch(r){case"E":case"EE":case"EEE":return e.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return e.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return e.day(n,{width:"short",context:"formatting"});case"EEEE":default:return e.day(n,{width:"wide",context:"formatting"})}},e:function(t,r,e,n){const a=t.getDay(),o=(a-n.weekStartsOn+8)%7||7;switch(r){case"e":return String(o);case"ee":return Ar(o,2);case"eo":return e.ordinalNumber(o,{unit:"day"});case"eee":return e.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return e.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return e.day(a,{width:"short",context:"formatting"});case"eeee":default:return e.day(a,{width:"wide",context:"formatting"})}},c:function(t,r,e,n){const a=t.getDay(),o=(a-n.weekStartsOn+8)%7||7;switch(r){case"c":return String(o);case"cc":return Ar(o,r.length);case"co":return e.ordinalNumber(o,{unit:"day"});case"ccc":return e.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return e.day(a,{width:"narrow",context:"standalone"});case"cccccc":return e.day(a,{width:"short",context:"standalone"});case"cccc":default:return e.day(a,{width:"wide",context:"standalone"})}},i:function(t,r,e){const n=t.getDay(),a=n===0?7:n;switch(r){case"i":return String(a);case"ii":return Ar(a,r.length);case"io":return e.ordinalNumber(a,{unit:"day"});case"iii":return e.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return e.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return e.day(n,{width:"short",context:"formatting"});case"iiii":default:return e.day(n,{width:"wide",context:"formatting"})}},a:function(t,r,e){const a=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return e.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return e.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,r,e){const n=t.getHours();let a;switch(n===12?a=Sl.noon:n===0?a=Sl.midnight:a=n/12>=1?"pm":"am",r){case"b":case"bb":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return e.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return e.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,r,e){const n=t.getHours();let a;switch(n>=17?a=Sl.evening:n>=12?a=Sl.afternoon:n>=4?a=Sl.morning:a=Sl.night,r){case"B":case"BB":case"BBB":return e.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return e.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return e.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,r,e){if(r==="ho"){let n=t.getHours()%12;return n===0&&(n=12),e.ordinalNumber(n,{unit:"hour"})}return Ui.h(t,r)},H:function(t,r,e){return r==="Ho"?e.ordinalNumber(t.getHours(),{unit:"hour"}):Ui.H(t,r)},K:function(t,r,e){const n=t.getHours()%12;return r==="Ko"?e.ordinalNumber(n,{unit:"hour"}):Ar(n,r.length)},k:function(t,r,e){let n=t.getHours();return n===0&&(n=24),r==="ko"?e.ordinalNumber(n,{unit:"hour"}):Ar(n,r.length)},m:function(t,r,e){return r==="mo"?e.ordinalNumber(t.getMinutes(),{unit:"minute"}):Ui.m(t,r)},s:function(t,r,e){return r==="so"?e.ordinalNumber(t.getSeconds(),{unit:"second"}):Ui.s(t,r)},S:function(t,r){return Ui.S(t,r)},X:function(t,r,e){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(r){case"X":return px(n);case"XXXX":case"XX":return Co(n);case"XXXXX":case"XXX":default:return Co(n,":")}},x:function(t,r,e){const n=t.getTimezoneOffset();switch(r){case"x":return px(n);case"xxxx":case"xx":return Co(n);case"xxxxx":case"xxx":default:return Co(n,":")}},O:function(t,r,e){const n=t.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+hx(n,":");case"OOOO":default:return"GMT"+Co(n,":")}},z:function(t,r,e){const n=t.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+hx(n,":");case"zzzz":default:return"GMT"+Co(n,":")}},t:function(t,r,e){const n=Math.trunc(+t/1e3);return Ar(n,r.length)},T:function(t,r,e){return Ar(+t,r.length)}};function hx(t,r=""){const e=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),o=n%60;return o===0?e+String(a):e+String(a)+r+Ar(o,2)}function px(t,r){return t%60===0?(t>0?"-":"+")+Ar(Math.abs(t)/60,2):Co(t,r)}function Co(t,r=""){const e=t>0?"-":"+",n=Math.abs(t),a=Ar(Math.trunc(n/60),2),o=Ar(n%60,2);return e+a+r+o}const mx=(t,r)=>{switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},bw=(t,r)=>{switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},eT=(t,r)=>{const e=t.match(/(P+)(p+)?/)||[],n=e[1],a=e[2];if(!a)return mx(t,r);let o;switch(n){case"P":o=r.dateTime({width:"short"});break;case"PP":o=r.dateTime({width:"medium"});break;case"PPP":o=r.dateTime({width:"long"});break;case"PPPP":default:o=r.dateTime({width:"full"});break}return o.replace("{{date}}",mx(n,r)).replace("{{time}}",bw(a,r))},tT={p:bw,P:eT},rT=/^D+$/,nT=/^Y+$/,aT=["D","DD","YY","YYYY"];function sT(t){return rT.test(t)}function iT(t){return nT.test(t)}function oT(t,r,e){const n=lT(t,r,e);if(console.warn(n),aT.includes(t))throw new RangeError(n)}function lT(t,r,e){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${r}\`) for formatting ${n} to the input \`${e}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const cT=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,uT=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,dT=/^'([^]*?)'?$/,fT=/''/g,hT=/[a-zA-Z]/;function Wt(t,r,e){var u,p,f,h,v,b,g,x;const n=$u(),a=(e==null?void 0:e.locale)??n.locale??Fl,o=(e==null?void 0:e.firstWeekContainsDate)??((p=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:p.firstWeekContainsDate)??n.firstWeekContainsDate??((h=(f=n.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,s=(e==null?void 0:e.weekStartsOn)??((b=(v=e==null?void 0:e.locale)==null?void 0:v.options)==null?void 0:b.weekStartsOn)??n.weekStartsOn??((x=(g=n.locale)==null?void 0:g.options)==null?void 0:x.weekStartsOn)??0,l=Sr(t,e==null?void 0:e.in);if(!mE(l))throw new RangeError("Invalid time value");let c=r.match(uT).map(y=>{const k=y[0];if(k==="p"||k==="P"){const N=tT[k];return N(y,a.formatLong)}return y}).join("").match(cT).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const k=y[0];if(k==="'")return{isToken:!1,value:pT(y)};if(fx[k])return{isToken:!0,value:y};if(k.match(hT))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:y}});a.localize.preprocessor&&(c=a.localize.preprocessor(l,c));const i={firstWeekContainsDate:o,weekStartsOn:s,locale:a};return c.map(y=>{if(!y.isToken)return y.value;const k=y.value;(!(e!=null&&e.useAdditionalWeekYearTokens)&&iT(k)||!(e!=null&&e.useAdditionalDayOfYearTokens)&&sT(k))&&oT(k,r,String(t));const N=fx[k[0]];return N(l,k,a.localize,i)}).join("")}function pT(t){const r=t.match(dT);return r?r[1].replace(fT,"'"):t}function mT(t,r){const e=Sr(t,r==null?void 0:r.in),n=e.getFullYear(),a=e.getMonth(),o=fn(e,0);return o.setFullYear(n,a+1,0),o.setHours(0,0,0,0),o.getDate()}function gT(t,r){return Sr(t,r==null?void 0:r.in).getMonth()}function vT(t,r){return Sr(t,r==null?void 0:r.in).getFullYear()}function bT(t,r){return+Sr(t)>+Sr(r)}function xT(t,r){return+Sr(t)<+Sr(r)}function yT(t,r,e){const[n,a]=tc(e==null?void 0:e.in,t,r);return n.getFullYear()===a.getFullYear()&&n.getMonth()===a.getMonth()}function wT(t,r,e){const[n,a]=tc(e==null?void 0:e.in,t,r);return n.getFullYear()===a.getFullYear()}function _T(t,r,e){return wm(t,-1,e)}function ST(t,r,e){const n=Sr(t,e==null?void 0:e.in),a=n.getFullYear(),o=n.getDate(),s=fn(t,0);s.setFullYear(a,r,15),s.setHours(0,0,0,0);const l=mT(s);return n.setMonth(r,Math.min(o,l)),n}function kT(t,r,e){const n=Sr(t,e==null?void 0:e.in);return isNaN(+n)?fn(t,NaN):(n.setFullYear(r),n)}function ET(t,r,e){return _m(t,-1,e)}function TT(t,r,e){return fw(t,-1,e)}const gx=5,AT=4;function CT(t,r){const e=r.startOfMonth(t),n=e.getDay()>0?e.getDay():7,a=r.addDays(t,-n+1),o=r.addDays(a,gx*7-1);return r.getMonth(t)===r.getMonth(o)?gx:AT}function xw(t,r){const e=r.startOfMonth(t),n=e.getDay();return n===1?e:n===0?r.addDays(e,-1*6):r.addDays(e,-1*(n-1))}function NT(t,r){const e=xw(t,r),n=CT(t,r);return r.addDays(e,n*7-1)}const jT={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 ms",other:"cerca de {{count}} meses"},xMonths:{one:"1 ms",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},OT=(t,r,e)=>{let n;const a=jT[t];return typeof a=="string"?n=a:r===1?n=a.one:n=a.other.replace("{{count}}",String(r)),e!=null&&e.addSuffix?e.comparison&&e.comparison>0?"em "+n:"h "+n:n},DT={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},RT={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},MT={full:"{{date}} 's' {{time}}",long:"{{date}} 's' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},FT={date:Hl({formats:DT,defaultWidth:"full"}),time:Hl({formats:RT,defaultWidth:"full"}),dateTime:Hl({formats:MT,defaultWidth:"full"})},IT={lastWeek:t=>{const r=t.getDay();return"'"+(r===0||r===6?"ltimo":"ltima")+"' eeee 's' p"},yesterday:"'ontem s' p",today:"'hoje s' p",tomorrow:"'amanh s' p",nextWeek:"eeee 's' p",other:"P"},PT=(t,r,e,n)=>{const a=IT[t];return typeof a=="function"?a(r):a},LT={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},BT={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},UT={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},zT={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","tera","quarta","quinta","sexta","sbado"],wide:["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"]},$T={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"}},VT={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},HT=(t,r)=>{const e=Number(t);return(r==null?void 0:r.unit)==="week"?e+"":e+""},qT={ordinalNumber:HT,era:ks({values:LT,defaultWidth:"wide"}),quarter:ks({values:BT,defaultWidth:"wide",argumentCallback:t=>t-1}),month:ks({values:UT,defaultWidth:"wide"}),day:ks({values:zT,defaultWidth:"wide"}),dayPeriod:ks({values:$T,defaultWidth:"wide",formattingValues:VT,defaultFormattingWidth:"wide"})},WT=/^(\d+)[o]?/i,GT=/\d+/i,YT={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},XT={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},KT={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},ZT={any:[/1/i,/2/i,/3/i,/4/i]},JT={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|maro|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},QT={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},eA={narrow:/^(dom|[23456]?|s[a]b)/i,short:/^(dom|[23456]?|s[a]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a]b)/i,wide:/^(domingo|(segunda|ter[c]a|quarta|quinta|sexta)([- ]feira)?|s[a]bado)/i},tA={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a]b/i]},rA={narrow:/^(a|p|mn|md|(da) (manh|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh|tarde|noite))/i},nA={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},aA={ordinalNumber:gw({matchPattern:WT,parsePattern:GT,valueCallback:t=>parseInt(t,10)}),era:Es({matchPatterns:YT,defaultMatchWidth:"wide",parsePatterns:XT,defaultParseWidth:"any"}),quarter:Es({matchPatterns:KT,defaultMatchWidth:"wide",parsePatterns:ZT,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Es({matchPatterns:JT,defaultMatchWidth:"wide",parsePatterns:QT,defaultParseWidth:"any"}),day:Es({matchPatterns:eA,defaultMatchWidth:"wide",parsePatterns:tA,defaultParseWidth:"any"}),dayPeriod:Es({matchPatterns:rA,defaultMatchWidth:"any",parsePatterns:nA,defaultParseWidth:"any"})},br={code:"pt-BR",formatDistance:OT,formatLong:FT,formatRelative:PT,localize:qT,match:aA,options:{weekStartsOn:0,firstWeekContainsDate:1}},yw={...Fl,labels:{labelDayButton:(t,r,e,n)=>{let a;n&&typeof n.format=="function"?a=n.format.bind(n):a=(s,l)=>Wt(s,l,{locale:Fl,...e});let o=a(t,"PPPP");return r.today&&(o=`Today, ${o}`),r.selected&&(o=`${o}, selected`),o},labelMonthDropdown:"Choose the Month",labelNext:"Go to the Next Month",labelPrevious:"Go to the Previous Month",labelWeekNumber:t=>`Week ${t}`,labelYearDropdown:"Choose the Year",labelGrid:(t,r,e)=>{let n;return e&&typeof e.format=="function"?n=e.format.bind(e):n=(a,o)=>Wt(a,o,{locale:Fl,...r}),n(t,"LLLL yyyy")},labelGridcell:(t,r,e,n)=>{let a;n&&typeof n.format=="function"?a=n.format.bind(n):a=(s,l)=>Wt(s,l,{locale:Fl,...e});let o=a(t,"PPPP");return r!=null&&r.today&&(o=`Today, ${o}`),o},labelNav:"Navigation bar",labelWeekNumberHeader:"Week Number",labelWeekday:(t,r,e)=>{let n;return e&&typeof e.format=="function"?n=e.format.bind(e):n=(a,o)=>Wt(a,o,{locale:Fl,...r}),n(t,"cccc")}}};class Ea{constructor(r,e){this.Date=Date,this.today=()=>{var n;return(n=this.overrides)!=null&&n.today?this.overrides.today():this.options.timeZone?Ln.tz(this.options.timeZone):new this.Date},this.newDate=(n,a,o)=>{var s;return(s=this.overrides)!=null&&s.newDate?this.overrides.newDate(n,a,o):this.options.timeZone?new Ln(n,a,o,this.options.timeZone):new Date(n,a,o)},this.addDays=(n,a)=>{var o;return(o=this.overrides)!=null&&o.addDays?this.overrides.addDays(n,a):wm(n,a)},this.addMonths=(n,a)=>{var o;return(o=this.overrides)!=null&&o.addMonths?this.overrides.addMonths(n,a):_m(n,a)},this.addWeeks=(n,a)=>{var o;return(o=this.overrides)!=null&&o.addWeeks?this.overrides.addWeeks(n,a):fw(n,a)},this.addYears=(n,a)=>{var o;return(o=this.overrides)!=null&&o.addYears?this.overrides.addYears(n,a):dE(n,a)},this.differenceInCalendarDays=(n,a)=>{var o;return(o=this.overrides)!=null&&o.differenceInCalendarDays?this.overrides.differenceInCalendarDays(n,a):Sm(n,a)},this.differenceInCalendarMonths=(n,a)=>{var o;return(o=this.overrides)!=null&&o.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(n,a):pw(n,a)},this.eachMonthOfInterval=n=>{var a;return(a=this.overrides)!=null&&a.eachMonthOfInterval?this.overrides.eachMonthOfInterval(n):gE(n)},this.eachYearOfInterval=n=>{var l;const a=(l=this.overrides)!=null&&l.eachYearOfInterval?this.overrides.eachYearOfInterval(n):bE(n),o=new Set(a.map(c=>this.getYear(c)));if(o.size===a.length)return a;const s=[];return o.forEach(c=>{s.push(new Date(c,0,1))}),s},this.endOfBroadcastWeek=n=>{var a;return(a=this.overrides)!=null&&a.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(n):NT(n,this)},this.endOfISOWeek=n=>{var a;return(a=this.overrides)!=null&&a.endOfISOWeek?this.overrides.endOfISOWeek(n):xE(n)},this.endOfMonth=n=>{var a;return(a=this.overrides)!=null&&a.endOfMonth?this.overrides.endOfMonth(n):Lp(n)},this.endOfWeek=(n,a)=>{var o;return(o=this.overrides)!=null&&o.endOfWeek?this.overrides.endOfWeek(n,a):kf(n,this.options)},this.endOfYear=n=>{var a;return(a=this.overrides)!=null&&a.endOfYear?this.overrides.endOfYear(n):Up(n)},this.format=(n,a,o)=>{var l;const s=(l=this.overrides)!=null&&l.format?this.overrides.format(n,a,this.options):Wt(n,a,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(s):s},this.getISOWeek=n=>{var a;return(a=this.overrides)!=null&&a.getISOWeek?this.overrides.getISOWeek(n):Em(n)},this.getMonth=(n,a)=>{var o;return(o=this.overrides)!=null&&o.getMonth?this.overrides.getMonth(n,this.options):gT(n,this.options)},this.getYear=(n,a)=>{var o;return(o=this.overrides)!=null&&o.getYear?this.overrides.getYear(n,this.options):vT(n,this.options)},this.getWeek=(n,a)=>{var o;return(o=this.overrides)!=null&&o.getWeek?this.overrides.getWeek(n,this.options):Tm(n,this.options)},this.isAfter=(n,a)=>{var o;return(o=this.overrides)!=null&&o.isAfter?this.overrides.isAfter(n,a):bT(n,a)},this.isBefore=(n,a)=>{var o;return(o=this.overrides)!=null&&o.isBefore?this.overrides.isBefore(n,a):xT(n,a)},this.isDate=n=>{var a;return(a=this.overrides)!=null&&a.isDate?this.overrides.isDate(n):hw(n)},this.isSameDay=(n,a)=>{var o;return(o=this.overrides)!=null&&o.isSameDay?this.overrides.isSameDay(n,a):pE(n,a)},this.isSameMonth=(n,a)=>{var o;return(o=this.overrides)!=null&&o.isSameMonth?this.overrides.isSameMonth(n,a):yT(n,a)},this.isSameYear=(n,a)=>{var o;return(o=this.overrides)!=null&&o.isSameYear?this.overrides.isSameYear(n,a):wT(n,a)},this.max=n=>{var a;return(a=this.overrides)!=null&&a.max?this.overrides.max(n):fE(n)},this.min=n=>{var a;return(a=this.overrides)!=null&&a.min?this.overrides.min(n):hE(n)},this.setMonth=(n,a)=>{var o;return(o=this.overrides)!=null&&o.setMonth?this.overrides.setMonth(n,a):ST(n,a)},this.setYear=(n,a)=>{var o;return(o=this.overrides)!=null&&o.setYear?this.overrides.setYear(n,a):kT(n,a)},this.startOfBroadcastWeek=(n,a)=>{var o;return(o=this.overrides)!=null&&o.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(n,this):xw(n,this)},this.startOfDay=n=>{var a;return(a=this.overrides)!=null&&a.startOfDay?this.overrides.startOfDay(n):Ki(n)},this.startOfISOWeek=n=>{var a;return(a=this.overrides)!=null&&a.startOfISOWeek?this.overrides.startOfISOWeek(n):Su(n)},this.startOfMonth=n=>{var a;return(a=this.overrides)!=null&&a.startOfMonth?this.overrides.startOfMonth(n):Bp(n)},this.startOfWeek=(n,a)=>{var o;return(o=this.overrides)!=null&&o.startOfWeek?this.overrides.startOfWeek(n,this.options):Ji(n,this.options)},this.startOfYear=n=>{var a;return(a=this.overrides)!=null&&a.startOfYear?this.overrides.startOfYear(n):km(n)},this.options={locale:yw,...r},this.overrides=e}getDigitMap(){const{numerals:r="latn"}=this.options,e=new Intl.NumberFormat("en-US",{numberingSystem:r}),n={};for(let a=0;a<10;a++)n[a.toString()]=e.format(a);return n}replaceDigits(r){const e=this.getDigitMap();return r.replace(/\d/g,n=>e[n]||n)}formatNumber(r){return this.replaceDigits(r.toString())}getMonthYearOrder(){var e;const r=(e=this.options.locale)==null?void 0:e.code;return r&&Ea.yearFirstLocales.has(r)?"year-first":"month-first"}formatMonthYear(r){const{locale:e,timeZone:n,numerals:a}=this.options,o=e==null?void 0:e.code;if(o&&Ea.yearFirstLocales.has(o))try{return new Intl.DateTimeFormat(o,{month:"long",year:"numeric",timeZone:n,numberingSystem:a}).format(r)}catch{}const s=this.getMonthYearOrder()==="year-first"?"y LLLL":"LLLL y";return this.format(r,s)}}Ea.yearFirstLocales=new Set(["eu","hu","ja","ja-Hira","ja-JP","ko","ko-KR","lt","lt-LT","lv","lv-LV","mn","mn-MN","zh","zh-CN","zh-HK","zh-TW"]);const Ms=new Ea;class ww{constructor(r,e,n=Ms){this.date=r,this.displayMonth=e,this.outside=!!(e&&!n.isSameMonth(r,e)),this.dateLib=n,this.isoDate=n.format(r,"yyyy-MM-dd"),this.displayMonthId=n.format(e,"yyyy-MM"),this.dateMonthId=n.format(r,"yyyy-MM")}isEqualTo(r){return this.dateLib.isSameDay(r.date,this.date)&&this.dateLib.isSameMonth(r.displayMonth,this.displayMonth)}}class sA{constructor(r,e){this.date=r,this.weeks=e}}class iA{constructor(r,e){this.days=e,this.weekNumber=r}}function oA(t){return Ze.createElement("button",{...t})}function lA(t){return Ze.createElement("span",{...t})}function cA(t){const{size:r=24,orientation:e="left",className:n}=t;return Ze.createElement("svg",{className:n,width:r,height:r,viewBox:"0 0 24 24"},e==="up"&&Ze.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),e==="down"&&Ze.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),e==="left"&&Ze.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),e==="right"&&Ze.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function uA(t){const{day:r,modifiers:e,...n}=t;return Ze.createElement("td",{...n})}function dA(t){const{day:r,modifiers:e,...n}=t,a=Ze.useRef(null);return Ze.useEffect(()=>{var o;e.focused&&((o=a.current)==null||o.focus())},[e.focused]),Ze.createElement("button",{ref:a,...n})}var $t;(function(t){t.Root="root",t.Chevron="chevron",t.Day="day",t.DayButton="day_button",t.CaptionLabel="caption_label",t.Dropdowns="dropdowns",t.Dropdown="dropdown",t.DropdownRoot="dropdown_root",t.Footer="footer",t.MonthGrid="month_grid",t.MonthCaption="month_caption",t.MonthsDropdown="months_dropdown",t.Month="month",t.Months="months",t.Nav="nav",t.NextMonthButton="button_next",t.PreviousMonthButton="button_previous",t.Week="week",t.Weeks="weeks",t.Weekday="weekday",t.Weekdays="weekdays",t.WeekNumber="week_number",t.WeekNumberHeader="week_number_header",t.YearsDropdown="years_dropdown"})($t||($t={}));var Vr;(function(t){t.disabled="disabled",t.hidden="hidden",t.outside="outside",t.focused="focused",t.today="today"})(Vr||(Vr={}));var os;(function(t){t.range_end="range_end",t.range_middle="range_middle",t.range_start="range_start",t.selected="selected"})(os||(os={}));var ba;(function(t){t.weeks_before_enter="weeks_before_enter",t.weeks_before_exit="weeks_before_exit",t.weeks_after_enter="weeks_after_enter",t.weeks_after_exit="weeks_after_exit",t.caption_after_enter="caption_after_enter",t.caption_after_exit="caption_after_exit",t.caption_before_enter="caption_before_enter",t.caption_before_exit="caption_before_exit"})(ba||(ba={}));function fA(t){const{options:r,className:e,components:n,classNames:a,...o}=t,s=[a[$t.Dropdown],e].join(" "),l=r==null?void 0:r.find(({value:c})=>c===o.value);return Ze.createElement("span",{"data-disabled":o.disabled,className:a[$t.DropdownRoot]},Ze.createElement(n.Select,{className:s,...o},r==null?void 0:r.map(({value:c,label:i,disabled:u})=>Ze.createElement(n.Option,{key:c,value:c,disabled:u},i))),Ze.createElement("span",{className:a[$t.CaptionLabel],"aria-hidden":!0},l==null?void 0:l.label,Ze.createElement(n.Chevron,{orientation:"down",size:18,className:a[$t.Chevron]})))}function hA(t){return Ze.createElement("div",{...t})}function pA(t){return Ze.createElement("div",{...t})}function mA(t){const{calendarMonth:r,displayIndex:e,...n}=t;return Ze.createElement("div",{...n},t.children)}function gA(t){const{calendarMonth:r,displayIndex:e,...n}=t;return Ze.createElement("div",{...n})}function vA(t){return Ze.createElement("table",{...t})}function bA(t){return Ze.createElement("div",{...t})}const _w=_e.createContext(void 0);function Vu(){const t=_e.useContext(_w);if(t===void 0)throw new Error("useDayPicker() must be used within a custom component.");return t}function xA(t){const{components:r}=Vu();return Ze.createElement(r.Dropdown,{...t})}function yA(t){const{onPreviousClick:r,onNextClick:e,previousMonth:n,nextMonth:a,...o}=t,{components:s,classNames:l,labels:{labelPrevious:c,labelNext:i}}=Vu(),u=_e.useCallback(f=>{a&&(e==null||e(f))},[a,e]),p=_e.useCallback(f=>{n&&(r==null||r(f))},[n,r]);return Ze.createElement("nav",{...o},Ze.createElement(s.PreviousMonthButton,{type:"button",className:l[$t.PreviousMonthButton],tabIndex:n?void 0:-1,"aria-disabled":n?void 0:!0,"aria-label":c(n),onClick:p},Ze.createElement(s.Chevron,{disabled:n?void 0:!0,className:l[$t.Chevron],orientation:"left"})),Ze.createElement(s.NextMonthButton,{type:"button",className:l[$t.NextMonthButton],tabIndex:a?void 0:-1,"aria-disabled":a?void 0:!0,"aria-label":i(a),onClick:u},Ze.createElement(s.Chevron,{disabled:a?void 0:!0,orientation:"right",className:l[$t.Chevron]})))}function wA(t){const{components:r}=Vu();return Ze.createElement(r.Button,{...t})}function _A(t){return Ze.createElement("option",{...t})}function SA(t){const{components:r}=Vu();return Ze.createElement(r.Button,{...t})}function kA(t){const{rootRef:r,...e}=t;return Ze.createElement("div",{...e,ref:r})}function EA(t){return Ze.createElement("select",{...t})}function TA(t){const{week:r,...e}=t;return Ze.createElement("tr",{...e})}function AA(t){return Ze.createElement("th",{...t})}function CA(t){return Ze.createElement("thead",{"aria-hidden":!0},Ze.createElement("tr",{...t}))}function NA(t){const{week:r,...e}=t;return Ze.createElement("th",{...e})}function jA(t){return Ze.createElement("th",{...t})}function OA(t){return Ze.createElement("tbody",{...t})}function DA(t){const{components:r}=Vu();return Ze.createElement(r.Dropdown,{...t})}const RA=Object.freeze(Object.defineProperty({__proto__:null,Button:oA,CaptionLabel:lA,Chevron:cA,Day:uA,DayButton:dA,Dropdown:fA,DropdownNav:hA,Footer:pA,Month:mA,MonthCaption:gA,MonthGrid:vA,Months:bA,MonthsDropdown:xA,Nav:yA,NextMonthButton:wA,Option:_A,PreviousMonthButton:SA,Root:kA,Select:EA,Week:TA,WeekNumber:NA,WeekNumberHeader:jA,Weekday:AA,Weekdays:CA,Weeks:OA,YearsDropdown:DA},Symbol.toStringTag,{value:"Module"}));function ei(t,r,e=!1,n=Ms){let{from:a,to:o}=t;const{differenceInCalendarDays:s,isSameDay:l}=n;return a&&o?(s(o,a)<0&&([a,o]=[o,a]),s(r,a)>=(e?1:0)&&s(o,r)>=(e?1:0)):!e&&o?l(o,r):!e&&a?l(a,r):!1}function Am(t){return!!(t&&typeof t=="object"&&"before"in t&&"after"in t)}function qf(t){return!!(t&&typeof t=="object"&&"from"in t)}function Cm(t){return!!(t&&typeof t=="object"&&"after"in t)}function Nm(t){return!!(t&&typeof t=="object"&&"before"in t)}function Sw(t){return!!(t&&typeof t=="object"&&"dayOfWeek"in t)}function kw(t,r){return Array.isArray(t)&&t.every(r.isDate)}function ti(t,r,e=Ms){const n=Array.isArray(r)?r:[r],{isSameDay:a,differenceInCalendarDays:o,isAfter:s}=e;return n.some(l=>{if(typeof l=="boolean")return l;if(e.isDate(l))return a(t,l);if(kw(l,e))return l.some(c=>a(t,c));if(qf(l))return ei(l,t,!1,e);if(Sw(l))return Array.isArray(l.dayOfWeek)?l.dayOfWeek.includes(t.getDay()):l.dayOfWeek===t.getDay();if(Am(l)){const c=o(l.before,t),i=o(l.after,t),u=c>0,p=i<0;return s(l.before,l.after)?p&&u:u||p}return Cm(l)?o(t,l.after)>0:Nm(l)?o(l.before,t)>0:typeof l=="function"?l(t):!1})}function MA(t,r,e,n,a){const{disabled:o,hidden:s,modifiers:l,showOutsideDays:c,broadcastCalendar:i,today:u=a.today()}=r,{isSameDay:p,isSameMonth:f,startOfMonth:h,isBefore:v,endOfMonth:b,isAfter:g}=a,x=e&&h(e),y=n&&b(n),k={[Vr.focused]:[],[Vr.outside]:[],[Vr.disabled]:[],[Vr.hidden]:[],[Vr.today]:[]},N={};for(const F of t){const{date:B,displayMonth:W}=F,V=!!(W&&!f(B,W)),q=!!(x&&v(B,x)),X=!!(y&&g(B,y)),I=!!(o&&ti(B,o,a)),H=!!(s&&ti(B,s,a))||q||X||!i&&!c&&V||i&&c===!1&&V,O=p(B,u);V&&k.outside.push(F),I&&k.disabled.push(F),H&&k.hidden.push(F),O&&k.today.push(F),l&&Object.keys(l).forEach(R=>{const C=l==null?void 0:l[R];C&&ti(B,C,a)&&(N[R]?N[R].push(F):N[R]=[F])})}return F=>{const B={[Vr.focused]:!1,[Vr.disabled]:!1,[Vr.hidden]:!1,[Vr.outside]:!1,[Vr.today]:!1},W={};for(const V in k){const q=k[V];B[V]=q.some(X=>X===F)}for(const V in N)W[V]=N[V].some(q=>q===F);return{...B,...W}}}function FA(t,r,e={}){return Object.entries(t).filter(([,a])=>a===!0).reduce((a,[o])=>(e[o]?a.push(e[o]):r[Vr[o]]?a.push(r[Vr[o]]):r[os[o]]&&a.push(r[os[o]]),a),[r[$t.Day]])}function IA(t){return{...RA,...t}}function PA(t){const r={"data-mode":t.mode??void 0,"data-required":"required"in t?t.required:void 0,"data-multiple-months":t.numberOfMonths&&t.numberOfMonths>1||void 0,"data-week-numbers":t.showWeekNumber||void 0,"data-broadcast-calendar":t.broadcastCalendar||void 0,"data-nav-layout":t.navLayout||void 0};return Object.entries(t).forEach(([e,n])=>{e.startsWith("data-")&&(r[e]=n)}),r}function jm(){const t={};for(const r in $t)t[$t[r]]=`rdp-${$t[r]}`;for(const r in Vr)t[Vr[r]]=`rdp-${Vr[r]}`;for(const r in os)t[os[r]]=`rdp-${os[r]}`;for(const r in ba)t[ba[r]]=`rdp-${ba[r]}`;return t}function Ew(t,r,e){return(e??new Ea(r)).formatMonthYear(t)}const LA=Ew;function BA(t,r,e){return(e??new Ea(r)).format(t,"d")}function UA(t,r=Ms){return r.format(t,"LLLL")}function zA(t,r,e){return(e??new Ea(r)).format(t,"cccccc")}function $A(t,r=Ms){return t<10?r.formatNumber(`0${t.toLocaleString()}`):r.formatNumber(`${t.toLocaleString()}`)}function VA(){return""}function Tw(t,r=Ms){return r.format(t,"yyyy")}const HA=Tw,qA=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:Ew,formatDay:BA,formatMonthCaption:LA,formatMonthDropdown:UA,formatWeekNumber:$A,formatWeekNumberHeader:VA,formatWeekdayName:zA,formatYearCaption:HA,formatYearDropdown:Tw},Symbol.toStringTag,{value:"Module"}));function WA(t){return t!=null&&t.formatMonthCaption&&!t.formatCaption&&(t.formatCaption=t.formatMonthCaption),t!=null&&t.formatYearCaption&&!t.formatYearDropdown&&(t.formatYearDropdown=t.formatYearCaption),{...qA,...t}}function Om(t,r,e,n){let a=(n??new Ea(e)).format(t,"PPPP");return r.today&&(a=`Today, ${a}`),r.selected&&(a=`${a}, selected`),a}const GA=Om;function Dm(t,r,e){return(e??new Ea(r)).formatMonthYear(t)}const YA=Dm;function Aw(t,r,e,n){let a=(n??new Ea(e)).format(t,"PPPP");return r!=null&&r.today&&(a=`Today, ${a}`),a}function Cw(t){return"Choose the Month"}function Nw(){return""}const XA="Go to the Next Month";function jw(t,r){return XA}function Ow(t){return"Go to the Previous Month"}function Dw(t,r,e){return(e??new Ea(r)).format(t,"cccc")}function Rw(t,r){return`Week ${t}`}function Mw(t){return"Week Number"}function Fw(t){return"Choose the Year"}const KA=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:YA,labelDay:GA,labelDayButton:Om,labelGrid:Dm,labelGridcell:Aw,labelMonthDropdown:Cw,labelNav:Nw,labelNext:jw,labelPrevious:Ow,labelWeekNumber:Rw,labelWeekNumberHeader:Mw,labelWeekday:Dw,labelYearDropdown:Fw},Symbol.toStringTag,{value:"Module"})),es=(t,r,e)=>r||(e?typeof e=="function"?e:(...n)=>e:t);function ZA(t,r){var n;const e=((n=r.locale)==null?void 0:n.labels)??{};return{...KA,...t??{},labelDayButton:es(Om,t==null?void 0:t.labelDayButton,e.labelDayButton),labelMonthDropdown:es(Cw,t==null?void 0:t.labelMonthDropdown,e.labelMonthDropdown),labelNext:es(jw,t==null?void 0:t.labelNext,e.labelNext),labelPrevious:es(Ow,t==null?void 0:t.labelPrevious,e.labelPrevious),labelWeekNumber:es(Rw,t==null?void 0:t.labelWeekNumber,e.labelWeekNumber),labelYearDropdown:es(Fw,t==null?void 0:t.labelYearDropdown,e.labelYearDropdown),labelGrid:es(Dm,t==null?void 0:t.labelGrid,e.labelGrid),labelGridcell:es(Aw,t==null?void 0:t.labelGridcell,e.labelGridcell),labelNav:es(Nw,t==null?void 0:t.labelNav,e.labelNav),labelWeekNumberHeader:es(Mw,t==null?void 0:t.labelWeekNumberHeader,e.labelWeekNumberHeader),labelWeekday:es(Dw,t==null?void 0:t.labelWeekday,e.labelWeekday)}}function JA(t,r,e,n,a){const{startOfMonth:o,startOfYear:s,endOfYear:l,eachMonthOfInterval:c,getMonth:i}=a;return c({start:s(t),end:l(t)}).map(f=>{const h=n.formatMonthDropdown(f,a),v=i(f),b=r&&f<o(r)||e&&f>o(e)||!1;return{value:v,label:h,disabled:b}})}function QA(t,r={},e={}){let n={...r==null?void 0:r[$t.Day]};return Object.entries(t).filter(([,a])=>a===!0).forEach(([a])=>{n={...n,...e==null?void 0:e[a]}}),n}function e7(t,r,e,n){const a=n??t.today(),o=e?t.startOfBroadcastWeek(a,t):r?t.startOfISOWeek(a):t.startOfWeek(a),s=[];for(let l=0;l<7;l++){const c=t.addDays(o,l);s.push(c)}return s}function t7(t,r,e,n,a=!1){if(!t||!r)return;const{startOfYear:o,endOfYear:s,eachYearOfInterval:l,getYear:c}=n,i=o(t),u=s(r),p=l({start:i,end:u});return a&&p.reverse(),p.map(f=>{const h=e.formatYearDropdown(f,n);return{value:c(f),label:h,disabled:!1}})}function r7(t,r={}){var l;const{weekStartsOn:e,locale:n}=r,a=e??((l=n==null?void 0:n.options)==null?void 0:l.weekStartsOn)??0,o=c=>{const i=typeof c=="number"||typeof c=="string"?new Date(c):c;return new Ln(i.getFullYear(),i.getMonth(),i.getDate(),12,0,0,t)},s=c=>{const i=o(c);return new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0,0)};return{today:()=>o(Ln.tz(t)),newDate:(c,i,u)=>new Ln(c,i,u,12,0,0,t),startOfDay:c=>o(c),startOfWeek:(c,i)=>{const u=o(c),p=(i==null?void 0:i.weekStartsOn)??a,f=(u.getDay()-p+7)%7;return u.setDate(u.getDate()-f),u},startOfISOWeek:c=>{const i=o(c),u=(i.getDay()-1+7)%7;return i.setDate(i.getDate()-u),i},startOfMonth:c=>{const i=o(c);return i.setDate(1),i},startOfYear:c=>{const i=o(c);return i.setMonth(0,1),i},endOfWeek:(c,i)=>{const u=o(c),h=((((i==null?void 0:i.weekStartsOn)??a)+6)%7-u.getDay()+7)%7;return u.setDate(u.getDate()+h),u},endOfISOWeek:c=>{const i=o(c),u=(7-i.getDay())%7;return i.setDate(i.getDate()+u),i},endOfMonth:c=>{const i=o(c);return i.setMonth(i.getMonth()+1,0),i},endOfYear:c=>{const i=o(c);return i.setMonth(11,31),i},eachMonthOfInterval:c=>{const i=o(c.start),u=o(c.end),p=[],f=new Ln(i.getFullYear(),i.getMonth(),1,12,0,0,t),h=u.getFullYear()*12+u.getMonth();for(;f.getFullYear()*12+f.getMonth()<=h;)p.push(new Ln(f,t)),f.setMonth(f.getMonth()+1,1);return p},addDays:(c,i)=>{const u=o(c);return u.setDate(u.getDate()+i),u},addWeeks:(c,i)=>{const u=o(c);return u.setDate(u.getDate()+i*7),u},addMonths:(c,i)=>{const u=o(c);return u.setMonth(u.getMonth()+i),u},addYears:(c,i)=>{const u=o(c);return u.setFullYear(u.getFullYear()+i),u},eachYearOfInterval:c=>{const i=o(c.start),u=o(c.end),p=[],f=new Ln(i.getFullYear(),0,1,12,0,0,t);for(;f.getFullYear()<=u.getFullYear();)p.push(new Ln(f,t)),f.setFullYear(f.getFullYear()+1,0,1);return p},getWeek:(c,i)=>{var p;const u=s(c);return Tm(u,{weekStartsOn:(i==null?void 0:i.weekStartsOn)??a,firstWeekContainsDate:(i==null?void 0:i.firstWeekContainsDate)??((p=n==null?void 0:n.options)==null?void 0:p.firstWeekContainsDate)??1})},getISOWeek:c=>{const i=s(c);return Em(i)},differenceInCalendarDays:(c,i)=>{const u=s(c),p=s(i);return Sm(u,p)},differenceInCalendarMonths:(c,i)=>{const u=s(c),p=s(i);return pw(u,p)}}}const Hu=t=>t instanceof HTMLElement?t:null,sp=t=>[...t.querySelectorAll("[data-animated-month]")??[]],n7=t=>Hu(t.querySelector("[data-animated-month]")),ip=t=>Hu(t.querySelector("[data-animated-caption]")),op=t=>Hu(t.querySelector("[data-animated-weeks]")),a7=t=>Hu(t.querySelector("[data-animated-nav]")),s7=t=>Hu(t.querySelector("[data-animated-weekdays]"));function i7(t,r,{classNames:e,months:n,focused:a,dateLib:o}){const s=_e.useRef(null),l=_e.useRef(n),c=_e.useRef(!1);_e.useLayoutEffect(()=>{const i=l.current;if(l.current=n,!r||!t.current||!(t.current instanceof HTMLElement)||n.length===0||i.length===0||n.length!==i.length)return;const u=o.isSameMonth(n[0].date,i[0].date),p=o.isAfter(n[0].date,i[0].date),f=p?e[ba.caption_after_enter]:e[ba.caption_before_enter],h=p?e[ba.weeks_after_enter]:e[ba.weeks_before_enter],v=s.current,b=t.current.cloneNode(!0);if(b instanceof HTMLElement?(sp(b).forEach(k=>{if(!(k instanceof HTMLElement))return;const N=n7(k);N&&k.contains(N)&&k.removeChild(N);const F=ip(k);F&&F.classList.remove(f);const B=op(k);B&&B.classList.remove(h)}),s.current=b):s.current=null,c.current||u||a)return;const g=v instanceof HTMLElement?sp(v):[],x=sp(t.current);if(x!=null&&x.every(y=>y instanceof HTMLElement)&&g&&g.every(y=>y instanceof HTMLElement)){c.current=!0,t.current.style.isolation="isolate";const y=a7(t.current);y&&(y.style.zIndex="1"),x.forEach((k,N)=>{const F=g[N];if(!F)return;k.style.position="relative",k.style.overflow="hidden";const B=ip(k);B&&B.classList.add(f);const W=op(k);W&&W.classList.add(h);const V=()=>{c.current=!1,t.current&&(t.current.style.isolation=""),y&&(y.style.zIndex=""),B&&B.classList.remove(f),W&&W.classList.remove(h),k.style.position="",k.style.overflow="",k.contains(F)&&k.removeChild(F)};F.style.pointerEvents="none",F.style.position="absolute",F.style.overflow="hidden",F.setAttribute("aria-hidden","true");const q=s7(F);q&&(q.style.opacity="0");const X=ip(F);X&&(X.classList.add(p?e[ba.caption_before_exit]:e[ba.caption_after_exit]),X.addEventListener("animationend",V));const I=op(F);I&&I.classList.add(p?e[ba.weeks_before_exit]:e[ba.weeks_after_exit]),k.insertBefore(F,k.firstChild)})}})}function o7(t,r,e,n){const a=t[0],o=t[t.length-1],{ISOWeek:s,fixedWeeks:l,broadcastCalendar:c}=e??{},{addDays:i,differenceInCalendarDays:u,differenceInCalendarMonths:p,endOfBroadcastWeek:f,endOfISOWeek:h,endOfMonth:v,endOfWeek:b,isAfter:g,startOfBroadcastWeek:x,startOfISOWeek:y,startOfWeek:k}=n,N=c?x(a,n):s?y(a):k(a),F=c?f(o):s?h(v(o)):b(v(o)),B=r&&(c?f(r):s?h(r):b(r)),W=B&&g(F,B)?B:F,V=u(W,N),q=p(o,a)+1,X=[];for(let O=0;O<=V;O++){const R=i(N,O);X.push(R)}const H=(c?35:42)*q;if(l&&X.length<H){const O=H-X.length;for(let R=0;R<O;R++){const C=i(X[X.length-1],1);X.push(C)}}return X}function l7(t){const r=[];return t.reduce((e,n)=>{const a=n.weeks.reduce((o,s)=>o.concat(s.days.slice()),r.slice());return e.concat(a.slice())},r.slice())}function c7(t,r,e,n){const{numberOfMonths:a=1}=e,o=[];for(let s=0;s<a;s++){const l=n.addMonths(t,s);if(r&&l>r)break;o.push(l)}return o}function vx(t,r,e,n){const{month:a,defaultMonth:o,today:s=n.today(),numberOfMonths:l=1}=t;let c=a||o||s;const{differenceInCalendarMonths:i,addMonths:u,startOfMonth:p}=n;if(e&&i(e,c)<l-1){const f=-1*(l-1);c=u(e,f)}return r&&i(c,r)<0&&(c=r),p(c)}function u7(t,r,e,n){const{addDays:a,endOfBroadcastWeek:o,endOfISOWeek:s,endOfMonth:l,endOfWeek:c,getISOWeek:i,getWeek:u,startOfBroadcastWeek:p,startOfISOWeek:f,startOfWeek:h}=n,v=t.reduce((b,g)=>{const x=e.broadcastCalendar?p(g,n):e.ISOWeek?f(g):h(g),y=e.broadcastCalendar?o(g):e.ISOWeek?s(l(g)):c(l(g)),k=r.filter(W=>W>=x&&W<=y),N=e.broadcastCalendar?35:42;if(e.fixedWeeks&&k.length<N){const W=r.filter(V=>{const q=N-k.length;return V>y&&V<=a(y,q)});k.push(...W)}const F=k.reduce((W,V)=>{const q=e.ISOWeek?i(V):u(V),X=W.find(H=>H.weekNumber===q),I=new ww(V,g,n);return X?X.days.push(I):W.push(new iA(q,[I])),W},[]),B=new sA(g,F);return b.push(B),b},[]);return e.reverseMonths?v.reverse():v}function d7(t,r){let{startMonth:e,endMonth:n}=t;const{startOfYear:a,startOfDay:o,startOfMonth:s,endOfMonth:l,addYears:c,endOfYear:i,newDate:u,today:p}=r,{fromYear:f,toYear:h,fromMonth:v,toMonth:b}=t;!e&&v&&(e=v),!e&&f&&(e=r.newDate(f,0,1)),!n&&b&&(n=b),!n&&h&&(n=u(h,11,31));const g=t.captionLayout==="dropdown"||t.captionLayout==="dropdown-years";return e?e=s(e):f?e=u(f,0,1):!e&&g&&(e=a(c(t.today??p(),-100))),n?n=l(n):h?n=u(h,11,31):!n&&g&&(n=i(t.today??p())),[e&&o(e),n&&o(n)]}function f7(t,r,e,n){if(e.disableNavigation)return;const{pagedNavigation:a,numberOfMonths:o=1}=e,{startOfMonth:s,addMonths:l,differenceInCalendarMonths:c}=n,i=a?o:1,u=s(t);if(!r)return l(u,i);if(!(c(r,t)<o))return l(u,i)}function h7(t,r,e,n){if(e.disableNavigation)return;const{pagedNavigation:a,numberOfMonths:o}=e,{startOfMonth:s,addMonths:l,differenceInCalendarMonths:c}=n,i=a?o??1:1,u=s(t);if(!r)return l(u,-i);if(!(c(u,r)<=0))return l(u,-i)}function p7(t){const r=[];return t.reduce((e,n)=>e.concat(n.weeks.slice()),r.slice())}function Wf(t,r){const[e,n]=_e.useState(t);return[r===void 0?e:r,n]}function m7(t,r){var N;const[e,n]=d7(t,r),{startOfMonth:a,endOfMonth:o}=r,s=vx(t,e,n,r),[l,c]=Wf(s,t.month?s:void 0);_e.useEffect(()=>{const F=vx(t,e,n,r);c(F)},[t.timeZone]);const{months:i,weeks:u,days:p,previousMonth:f,nextMonth:h}=_e.useMemo(()=>{const F=c7(l,n,{numberOfMonths:t.numberOfMonths},r),B=o7(F,t.endMonth?o(t.endMonth):void 0,{ISOWeek:t.ISOWeek,fixedWeeks:t.fixedWeeks,broadcastCalendar:t.broadcastCalendar},r),W=u7(F,B,{broadcastCalendar:t.broadcastCalendar,fixedWeeks:t.fixedWeeks,ISOWeek:t.ISOWeek,reverseMonths:t.reverseMonths},r),V=p7(W),q=l7(W),X=h7(l,e,t,r),I=f7(l,n,t,r);return{months:W,weeks:V,days:q,previousMonth:X,nextMonth:I}},[r,l.getTime(),n==null?void 0:n.getTime(),e==null?void 0:e.getTime(),t.disableNavigation,t.broadcastCalendar,(N=t.endMonth)==null?void 0:N.getTime(),t.fixedWeeks,t.ISOWeek,t.numberOfMonths,t.pagedNavigation,t.reverseMonths]),{disableNavigation:v,onMonthChange:b}=t,g=F=>u.some(B=>B.days.some(W=>W.isEqualTo(F))),x=F=>{if(v)return;let B=a(F);e&&B<a(e)&&(B=a(e)),n&&B>a(n)&&(B=a(n)),c(B),b==null||b(B)};return{months:i,weeks:u,days:p,navStart:e,navEnd:n,previousMonth:f,nextMonth:h,goToMonth:x,goToDay:F=>{g(F)||x(F.date)}}}var Ss;(function(t){t[t.Today=0]="Today",t[t.Selected=1]="Selected",t[t.LastFocused=2]="LastFocused",t[t.FocusedModifier=3]="FocusedModifier"})(Ss||(Ss={}));function bx(t){return!t[Vr.disabled]&&!t[Vr.hidden]&&!t[Vr.outside]}function g7(t,r,e,n){let a,o=-1;for(const s of t){const l=r(s);bx(l)&&(l[Vr.focused]&&o<Ss.FocusedModifier?(a=s,o=Ss.FocusedModifier):n!=null&&n.isEqualTo(s)&&o<Ss.LastFocused?(a=s,o=Ss.LastFocused):e(s.date)&&o<Ss.Selected?(a=s,o=Ss.Selected):l[Vr.today]&&o<Ss.Today&&(a=s,o=Ss.Today))}return a||(a=t.find(s=>bx(r(s)))),a}function v7(t,r,e,n,a,o,s){const{ISOWeek:l,broadcastCalendar:c}=o,{addDays:i,addMonths:u,addWeeks:p,addYears:f,endOfBroadcastWeek:h,endOfISOWeek:v,endOfWeek:b,max:g,min:x,startOfBroadcastWeek:y,startOfISOWeek:k,startOfWeek:N}=s;let B={day:i,week:p,month:u,year:f,startOfWeek:W=>c?y(W,s):l?k(W):N(W),endOfWeek:W=>c?h(W):l?v(W):b(W)}[t](e,r==="after"?1:-1);return r==="before"&&n?B=g([n,B]):r==="after"&&a&&(B=x([a,B])),B}function Iw(t,r,e,n,a,o,s,l=0){if(l>365)return;const c=v7(t,r,e.date,n,a,o,s),i=!!(o.disabled&&ti(c,o.disabled,s)),u=!!(o.hidden&&ti(c,o.hidden,s)),p=c,f=new ww(c,p,s);return!i&&!u?f:Iw(t,r,f,n,a,o,s,l+1)}function b7(t,r,e,n,a){const{autoFocus:o}=t,[s,l]=_e.useState(),c=g7(r.days,e,n||(()=>!1),s),[i,u]=_e.useState(o?c:void 0);return{isFocusTarget:b=>!!(c!=null&&c.isEqualTo(b)),setFocused:u,focused:i,blur:()=>{l(i),u(void 0)},moveFocus:(b,g)=>{if(!i)return;const x=Iw(b,g,i,r.navStart,r.navEnd,t,a);x&&(t.disableNavigation&&!r.days.some(k=>k.isEqualTo(x))||(r.goToDay(x),u(x)))}}}function x7(t,r){const{selected:e,required:n,onSelect:a}=t,[o,s]=Wf(e,a?e:void 0),l=a?e:o,{isSameDay:c}=r,i=h=>(l==null?void 0:l.some(v=>c(v,h)))??!1,{min:u,max:p}=t;return{selected:l,select:(h,v,b)=>{let g=[...l??[]];if(i(h)){if((l==null?void 0:l.length)===u||n&&(l==null?void 0:l.length)===1)return;g=l==null?void 0:l.filter(x=>!c(x,h))}else(l==null?void 0:l.length)===p?g=[h]:g=[...g,h];return a||s(g),a==null||a(g,h,v,b),g},isSelected:i}}function y7(t,r,e=0,n=0,a=!1,o=Ms){const{from:s,to:l}=r||{},{isSameDay:c,isAfter:i,isBefore:u}=o;let p;if(!s&&!l)p={from:t,to:e>0?void 0:t};else if(s&&!l)c(s,t)?e===0?p={from:s,to:t}:a?p={from:s,to:void 0}:p=void 0:u(t,s)?p={from:t,to:s}:p={from:s,to:t};else if(s&&l)if(c(s,t)&&c(l,t))a?p={from:s,to:l}:p=void 0;else if(c(s,t))p={from:s,to:e>0?void 0:t};else if(c(l,t))p={from:t,to:e>0?void 0:t};else if(u(t,s))p={from:t,to:l};else if(i(t,s))p={from:s,to:t};else if(i(t,l))p={from:s,to:t};else throw new Error("Invalid range");if(p!=null&&p.from&&(p!=null&&p.to)){const f=o.differenceInCalendarDays(p.to,p.from);n>0&&f>n?p={from:t,to:void 0}:e>1&&f<e&&(p={from:t,to:void 0})}return p}function w7(t,r,e=Ms){const n=Array.isArray(r)?r:[r];let a=t.from;const o=e.differenceInCalendarDays(t.to,t.from),s=Math.min(o,6);for(let l=0;l<=s;l++){if(n.includes(a.getDay()))return!0;a=e.addDays(a,1)}return!1}function xx(t,r,e=Ms){return ei(t,r.from,!1,e)||ei(t,r.to,!1,e)||ei(r,t.from,!1,e)||ei(r,t.to,!1,e)}function _7(t,r,e=Ms){const n=Array.isArray(r)?r:[r];if(n.filter(l=>typeof l!="function").some(l=>typeof l=="boolean"?l:e.isDate(l)?ei(t,l,!1,e):kw(l,e)?l.some(c=>ei(t,c,!1,e)):qf(l)?l.from&&l.to?xx(t,{from:l.from,to:l.to},e):!1:Sw(l)?w7(t,l.dayOfWeek,e):Am(l)?e.isAfter(l.before,l.after)?xx(t,{from:e.addDays(l.after,1),to:e.addDays(l.before,-1)},e):ti(t.from,l,e)||ti(t.to,l,e):Cm(l)||Nm(l)?ti(t.from,l,e)||ti(t.to,l,e):!1))return!0;const s=n.filter(l=>typeof l=="function");if(s.length){let l=t.from;const c=e.differenceInCalendarDays(t.to,t.from);for(let i=0;i<=c;i++){if(s.some(u=>u(l)))return!0;l=e.addDays(l,1)}}return!1}function S7(t,r){const{disabled:e,excludeDisabled:n,selected:a,required:o,onSelect:s}=t,[l,c]=Wf(a,s?a:void 0),i=s?a:l;return{selected:i,select:(f,h,v)=>{const{min:b,max:g}=t,x=f?y7(f,i,b,g,o,r):void 0;return n&&e&&(x!=null&&x.from)&&x.to&&_7({from:x.from,to:x.to},e,r)&&(x.from=f,x.to=void 0),s||c(x),s==null||s(x,f,h,v),x},isSelected:f=>i&&ei(i,f,!1,r)}}function k7(t,r){const{selected:e,required:n,onSelect:a}=t,[o,s]=Wf(e,a?e:void 0),l=a?e:o,{isSameDay:c}=r;return{selected:l,select:(p,f,h)=>{let v=p;return!n&&l&&l&&c(p,l)&&(v=void 0),a||s(v),a==null||a(v,p,f,h),v},isSelected:p=>l?c(l,p):!1}}function E7(t,r){const e=k7(t,r),n=x7(t,r),a=S7(t,r);switch(t.mode){case"single":return e;case"multiple":return n;case"range":return a;default:return}}function Pa(t,r){return t instanceof Ln&&t.timeZone===r?t:new Ln(t,r)}function kl(t,r,e){return Pa(t,r)}function yx(t,r,e){return typeof t=="boolean"||typeof t=="function"?t:t instanceof Date?kl(t,r):Array.isArray(t)?t.map(n=>n instanceof Date?kl(n,r):n):qf(t)?{...t,from:t.from?Pa(t.from,r):t.from,to:t.to?Pa(t.to,r):t.to}:Am(t)?{before:kl(t.before,r),after:kl(t.after,r)}:Cm(t)?{after:kl(t.after,r)}:Nm(t)?{before:kl(t.before,r)}:t}function lp(t,r,e){return t&&(Array.isArray(t)?t.map(n=>yx(n,r)):yx(t,r))}function T7(t){var Ve;let r=t;const e=r.timeZone;if(e&&(r={...t,timeZone:e},r.today&&(r.today=Pa(r.today,e)),r.month&&(r.month=Pa(r.month,e)),r.defaultMonth&&(r.defaultMonth=Pa(r.defaultMonth,e)),r.startMonth&&(r.startMonth=Pa(r.startMonth,e)),r.endMonth&&(r.endMonth=Pa(r.endMonth,e)),r.mode==="single"&&r.selected?r.selected=Pa(r.selected,e):r.mode==="multiple"&&r.selected?r.selected=(Ve=r.selected)==null?void 0:Ve.map($e=>Pa($e,e)):r.mode==="range"&&r.selected&&(r.selected={from:r.selected.from?Pa(r.selected.from,e):r.selected.from,to:r.selected.to?Pa(r.selected.to,e):r.selected.to}),r.disabled!==void 0&&(r.disabled=lp(r.disabled,e)),r.hidden!==void 0&&(r.hidden=lp(r.hidden,e)),r.modifiers)){const $e={};Object.keys(r.modifiers).forEach(xt=>{var nt;$e[xt]=lp((nt=r.modifiers)==null?void 0:nt[xt],e)}),r.modifiers=$e}const{components:n,formatters:a,labels:o,dateLib:s,locale:l,classNames:c}=_e.useMemo(()=>{const $e={...yw,...r.locale},xt=r.broadcastCalendar?1:r.weekStartsOn,nt=r.noonSafe&&r.timeZone?r7(r.timeZone,{weekStartsOn:xt,locale:$e}):void 0,pt=r.dateLib&&nt?{...nt,...r.dateLib}:r.dateLib??nt,Se=new Ea({locale:$e,weekStartsOn:xt,firstWeekContainsDate:r.firstWeekContainsDate,useAdditionalWeekYearTokens:r.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:r.useAdditionalDayOfYearTokens,timeZone:r.timeZone,numerals:r.numerals},pt);return{dateLib:Se,components:IA(r.components),formatters:WA(r.formatters),labels:ZA(r.labels,Se.options),locale:$e,classNames:{...jm(),...r.classNames}}},[r.locale,r.broadcastCalendar,r.weekStartsOn,r.firstWeekContainsDate,r.useAdditionalWeekYearTokens,r.useAdditionalDayOfYearTokens,r.timeZone,r.numerals,r.dateLib,r.noonSafe,r.components,r.formatters,r.labels,r.classNames]);r.today||(r={...r,today:s.today()});const{captionLayout:i,mode:u,navLayout:p,numberOfMonths:f=1,onDayBlur:h,onDayClick:v,onDayFocus:b,onDayKeyDown:g,onDayMouseEnter:x,onDayMouseLeave:y,onNextClick:k,onPrevClick:N,showWeekNumber:F,styles:B}=r,{formatCaption:W,formatDay:V,formatMonthDropdown:q,formatWeekNumber:X,formatWeekNumberHeader:I,formatWeekdayName:H,formatYearDropdown:O}=a,R=m7(r,s),{days:C,months:w,navStart:E,navEnd:A,previousMonth:T,nextMonth:D,goToMonth:U}=R,P=MA(C,r,E,A,s),{isSelected:K,select:Y,selected:re}=E7(r,s)??{},{blur:z,focused:ee,isFocusTarget:L,moveFocus:M,setFocused:Z}=b7(r,R,P,K??(()=>!1),s),{labelDayButton:se,labelGridcell:ae,labelGrid:ne,labelMonthDropdown:Q,labelNav:fe,labelPrevious:le,labelNext:te,labelWeekday:ce,labelWeekNumber:he,labelWeekNumberHeader:Ee,labelYearDropdown:ke}=o,Ce=_e.useMemo(()=>e7(s,r.ISOWeek,r.broadcastCalendar,r.today),[s,r.ISOWeek,r.broadcastCalendar,r.today]),Fe=u!==void 0||v!==void 0,Pe=_e.useCallback(()=>{T&&(U(T),N==null||N(T))},[T,U,N]),Xe=_e.useCallback(()=>{D&&(U(D),k==null||k(D))},[U,D,k]),ct=_e.useCallback(($e,xt)=>nt=>{nt.preventDefault(),nt.stopPropagation(),Z($e),!xt.disabled&&(Y==null||Y($e.date,xt,nt),v==null||v($e.date,xt,nt))},[Y,v,Z]),st=_e.useCallback(($e,xt)=>nt=>{Z($e),b==null||b($e.date,xt,nt)},[b,Z]),lt=_e.useCallback(($e,xt)=>nt=>{z(),h==null||h($e.date,xt,nt)},[z,h]),tt=_e.useCallback(($e,xt)=>nt=>{const pt={ArrowLeft:[nt.shiftKey?"month":"day",r.dir==="rtl"?"after":"before"],ArrowRight:[nt.shiftKey?"month":"day",r.dir==="rtl"?"before":"after"],ArrowDown:[nt.shiftKey?"year":"week","after"],ArrowUp:[nt.shiftKey?"year":"week","before"],PageUp:[nt.shiftKey?"year":"month","before"],PageDown:[nt.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(pt[nt.key]){nt.preventDefault(),nt.stopPropagation();const[Se,je]=pt[nt.key];M(Se,je)}g==null||g($e.date,xt,nt)},[M,g,r.dir]),ot=_e.useCallback(($e,xt)=>nt=>{x==null||x($e.date,xt,nt)},[x]),De=_e.useCallback(($e,xt)=>nt=>{y==null||y($e.date,xt,nt)},[y]),ht=_e.useCallback($e=>xt=>{const nt=Number(xt.target.value),pt=s.setMonth(s.startOfMonth($e),nt);U(pt)},[s,U]),rt=_e.useCallback($e=>xt=>{const nt=Number(xt.target.value),pt=s.setYear(s.startOfMonth($e),nt);U(pt)},[s,U]),{className:it,style:dt}=_e.useMemo(()=>({className:[c[$t.Root],r.className].filter(Boolean).join(" "),style:{...B==null?void 0:B[$t.Root],...r.style}}),[c,r.className,r.style,B]),wt=PA(r),gt=_e.useRef(null);i7(gt,!!r.animate,{classNames:c,months:w,focused:ee,dateLib:s});const vt={dayPickerProps:r,selected:re,select:Y,isSelected:K,months:w,nextMonth:D,previousMonth:T,goToMonth:U,getModifiers:P,components:n,classNames:c,styles:B,labels:o,formatters:a};return Ze.createElement(_w.Provider,{value:vt},Ze.createElement(n.Root,{rootRef:r.animate?gt:void 0,className:it,style:dt,dir:r.dir,id:r.id,lang:r.lang,nonce:r.nonce,title:r.title,role:r.role,"aria-label":r["aria-label"],"aria-labelledby":r["aria-labelledby"],...wt},Ze.createElement(n.Months,{className:c[$t.Months],style:B==null?void 0:B[$t.Months]},!r.hideNavigation&&!p&&Ze.createElement(n.Nav,{"data-animated-nav":r.animate?"true":void 0,className:c[$t.Nav],style:B==null?void 0:B[$t.Nav],"aria-label":fe(),onPreviousClick:Pe,onNextClick:Xe,previousMonth:T,nextMonth:D}),w.map(($e,xt)=>Ze.createElement(n.Month,{"data-animated-month":r.animate?"true":void 0,className:c[$t.Month],style:B==null?void 0:B[$t.Month],key:xt,displayIndex:xt,calendarMonth:$e},p==="around"&&!r.hideNavigation&&xt===0&&Ze.createElement(n.PreviousMonthButton,{type:"button",className:c[$t.PreviousMonthButton],tabIndex:T?void 0:-1,"aria-disabled":T?void 0:!0,"aria-label":le(T),onClick:Pe,"data-animated-button":r.animate?"true":void 0},Ze.createElement(n.Chevron,{disabled:T?void 0:!0,className:c[$t.Chevron],orientation:r.dir==="rtl"?"right":"left"})),Ze.createElement(n.MonthCaption,{"data-animated-caption":r.animate?"true":void 0,className:c[$t.MonthCaption],style:B==null?void 0:B[$t.MonthCaption],calendarMonth:$e,displayIndex:xt},i!=null&&i.startsWith("dropdown")?Ze.createElement(n.DropdownNav,{className:c[$t.Dropdowns],style:B==null?void 0:B[$t.Dropdowns]},(()=>{const nt=i==="dropdown"||i==="dropdown-months"?Ze.createElement(n.MonthsDropdown,{key:"month",className:c[$t.MonthsDropdown],"aria-label":Q(),classNames:c,components:n,disabled:!!r.disableNavigation,onChange:ht($e.date),options:JA($e.date,E,A,a,s),style:B==null?void 0:B[$t.Dropdown],value:s.getMonth($e.date)}):Ze.createElement("span",{key:"month"},q($e.date,s)),pt=i==="dropdown"||i==="dropdown-years"?Ze.createElement(n.YearsDropdown,{key:"year",className:c[$t.YearsDropdown],"aria-label":ke(s.options),classNames:c,components:n,disabled:!!r.disableNavigation,onChange:rt($e.date),options:t7(E,A,a,s,!!r.reverseYears),style:B==null?void 0:B[$t.Dropdown],value:s.getYear($e.date)}):Ze.createElement("span",{key:"year"},O($e.date,s));return s.getMonthYearOrder()==="year-first"?[pt,nt]:[nt,pt]})(),Ze.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},W($e.date,s.options,s))):Ze.createElement(n.CaptionLabel,{className:c[$t.CaptionLabel],role:"status","aria-live":"polite"},W($e.date,s.options,s))),p==="around"&&!r.hideNavigation&&xt===f-1&&Ze.createElement(n.NextMonthButton,{type:"button",className:c[$t.NextMonthButton],tabIndex:D?void 0:-1,"aria-disabled":D?void 0:!0,"aria-label":te(D),onClick:Xe,"data-animated-button":r.animate?"true":void 0},Ze.createElement(n.Chevron,{disabled:D?void 0:!0,className:c[$t.Chevron],orientation:r.dir==="rtl"?"left":"right"})),xt===f-1&&p==="after"&&!r.hideNavigation&&Ze.createElement(n.Nav,{"data-animated-nav":r.animate?"true":void 0,className:c[$t.Nav],style:B==null?void 0:B[$t.Nav],"aria-label":fe(),onPreviousClick:Pe,onNextClick:Xe,previousMonth:T,nextMonth:D}),Ze.createElement(n.MonthGrid,{role:"grid","aria-multiselectable":u==="multiple"||u==="range","aria-label":ne($e.date,s.options,s)||void 0,className:c[$t.MonthGrid],style:B==null?void 0:B[$t.MonthGrid]},!r.hideWeekdays&&Ze.createElement(n.Weekdays,{"data-animated-weekdays":r.animate?"true":void 0,className:c[$t.Weekdays],style:B==null?void 0:B[$t.Weekdays]},F&&Ze.createElement(n.WeekNumberHeader,{"aria-label":Ee(s.options),className:c[$t.WeekNumberHeader],style:B==null?void 0:B[$t.WeekNumberHeader],scope:"col"},I()),Ce.map(nt=>Ze.createElement(n.Weekday,{"aria-label":ce(nt,s.options,s),className:c[$t.Weekday],key:String(nt),style:B==null?void 0:B[$t.Weekday],scope:"col"},H(nt,s.options,s)))),Ze.createElement(n.Weeks,{"data-animated-weeks":r.animate?"true":void 0,className:c[$t.Weeks],style:B==null?void 0:B[$t.Weeks]},$e.weeks.map(nt=>Ze.createElement(n.Week,{className:c[$t.Week],key:nt.weekNumber,style:B==null?void 0:B[$t.Week],week:nt},F&&Ze.createElement(n.WeekNumber,{week:nt,style:B==null?void 0:B[$t.WeekNumber],"aria-label":he(nt.weekNumber,{locale:l}),className:c[$t.WeekNumber],scope:"row",role:"rowheader"},X(nt.weekNumber,s)),nt.days.map(pt=>{const{date:Se}=pt,je=P(pt);if(je[Vr.focused]=!je.hidden&&!!(ee!=null&&ee.isEqualTo(pt)),je[os.selected]=(K==null?void 0:K(Se))||je.selected,qf(re)){const{from:yt,to:Ct}=re;je[os.range_start]=!!(yt&&Ct&&s.isSameDay(Se,yt)),je[os.range_end]=!!(yt&&Ct&&s.isSameDay(Se,Ct)),je[os.range_middle]=ei(re,Se,!0,s)}const Qe=QA(je,B,r.modifiersStyles),At=FA(je,c,r.modifiersClassNames),Vt=!Fe&&!je.hidden?ae(Se,je,s.options,s):void 0;return Ze.createElement(n.Day,{key:`${pt.isoDate}_${pt.displayMonthId}`,day:pt,modifiers:je,className:At.join(" "),style:Qe,role:"gridcell","aria-selected":je.selected||void 0,"aria-label":Vt,"data-day":pt.isoDate,"data-month":pt.outside?pt.dateMonthId:void 0,"data-selected":je.selected||void 0,"data-disabled":je.disabled||void 0,"data-hidden":je.hidden||void 0,"data-outside":pt.outside||void 0,"data-focused":je.focused||void 0,"data-today":je.today||void 0},!je.hidden&&Fe?Ze.createElement(n.DayButton,{className:c[$t.DayButton],style:B==null?void 0:B[$t.DayButton],type:"button",day:pt,modifiers:je,disabled:!je.focused&&je.disabled||void 0,"aria-disabled":je.focused&&je.disabled||void 0,tabIndex:L(pt)?0:-1,"aria-label":se(Se,je,s.options,s),onClick:ct(pt,je),onBlur:lt(pt,je),onFocus:st(pt,je),onKeyDown:tt(pt,je),onMouseEnter:ot(pt,je),onMouseLeave:De(pt,je)},V(Se,s.options,s)):!je.hidden&&V(pt.date,s.options,s))})))))))),r.footer&&Ze.createElement(n.Footer,{className:c[$t.Footer],style:B==null?void 0:B[$t.Footer],role:"status","aria-live":"polite"},r.footer)))}function Pw({className:t,classNames:r,showOutsideDays:e=!0,captionLayout:n="label",buttonVariant:a="ghost",formatters:o,components:s,...l}){const c=jm();return _.jsx(T7,{showOutsideDays:e,className:Et("bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,t),captionLayout:n,formatters:{formatMonthDropdown:i=>i.toLocaleString("default",{month:"short"}),...o},classNames:{root:Et("w-fit",c.root),months:Et("relative flex flex-col gap-4 md:flex-row",c.months),month:Et("flex w-full flex-col gap-4",c.month),nav:Et("absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1",c.nav),button_previous:Et(Op({variant:a}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",c.button_previous),button_next:Et(Op({variant:a}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",c.button_next),month_caption:Et("flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]",c.month_caption),dropdowns:Et("flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium",c.dropdowns),dropdown_root:Et("has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border",c.dropdown_root),dropdown:Et("bg-popover absolute inset-0 opacity-0",c.dropdown),caption_label:Et("select-none font-medium",n==="label"?"text-sm":"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5",c.caption_label),table:"w-full border-collapse",weekdays:Et("flex",c.weekdays),weekday:Et("text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal",c.weekday),week:Et("mt-2 flex w-full",c.week),week_number_header:Et("w-[--cell-size] select-none",c.week_number_header),week_number:Et("text-muted-foreground select-none text-[0.8rem]",c.week_number),day:Et("group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md",c.day),range_start:Et("bg-accent rounded-l-md",c.range_start),range_middle:Et("rounded-none",c.range_middle),range_end:Et("bg-accent rounded-r-md",c.range_end),today:Et("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",c.today),outside:Et("text-muted-foreground aria-selected:text-muted-foreground",c.outside),disabled:Et("text-muted-foreground opacity-50",c.disabled),hidden:Et("invisible",c.hidden),...r},components:{Root:({className:i,rootRef:u,...p})=>_.jsx("div",{"data-slot":"calendar",ref:u,className:Et(i),...p}),Chevron:({className:i,orientation:u,...p})=>u==="left"?_.jsx(yu,{className:Et("size-4",i),...p}):u==="right"?_.jsx(wu,{className:Et("size-4",i),...p}):_.jsx(Uu,{className:Et("size-4",i),...p}),DayButton:A7,WeekNumber:({children:i,...u})=>_.jsx("td",{...u,children:_.jsx("div",{className:"flex size-[--cell-size] items-center justify-center text-center",children:i})}),...s},...l})}function A7({className:t,day:r,modifiers:e,...n}){const a=jm(),o=_e.useRef(null);return _e.useEffect(()=>{var s;e.focused&&((s=o.current)==null||s.focus())},[e.focused]),_.jsx(Nt,{ref:o,variant:"ghost",size:"icon","data-day":r.date.toLocaleDateString(),"data-selected-single":e.selected&&!e.range_start&&!e.range_end&&!e.range_middle,"data-range-start":e.range_start,"data-range-end":e.range_end,"data-range-middle":e.range_middle,className:Et("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70",a.day,t),...n})}const C7=$f("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ua({className:t,variant:r,...e}){return _.jsx("div",{className:Et(C7({variant:r}),t),...e})}const N7=t=>t?(...r)=>t(...r):(...r)=>fetch(...r);class Rm extends Error{constructor(r,e="FunctionsError",n){super(r),this.name=e,this.context=n}}class j7 extends Rm{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class wx extends Rm{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class _x extends Rm{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var zp;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(zp||(zp={}));class O7{constructor(r,{headers:e={},customFetch:n,region:a=zp.Any}={}){this.url=r,this.headers=e,this.region=a,this.fetch=N7(n)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r){return V5(this,arguments,void 0,function*(e,n={}){var a;let o,s;try{const{headers:l,method:c,body:i,signal:u,timeout:p}=n;let f={},{region:h}=n;h||(h=this.region);const v=new URL(`${this.url}/${e}`);h&&h!=="any"&&(f["x-region"]=h,v.searchParams.set("forceFunctionRegion",h));let b;i&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",b=i):typeof i=="string"?(f["Content-Type"]="text/plain",b=i):typeof FormData<"u"&&i instanceof FormData?b=i:(f["Content-Type"]="application/json",b=JSON.stringify(i)):b=i;let g=u;p&&(s=new AbortController,o=setTimeout(()=>s.abort(),p),u?(g=s.signal,u.addEventListener("abort",()=>s.abort())):g=s.signal);const x=yield this.fetch(v.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),l),body:b,signal:g}).catch(F=>{throw new j7(F)}),y=x.headers.get("x-relay-error");if(y&&y==="true")throw new wx(x);if(!x.ok)throw new _x(x);let k=((a=x.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),N;return k==="application/json"?N=yield x.json():k==="application/octet-stream"||k==="application/pdf"?N=yield x.blob():k==="text/event-stream"?N=x:k==="multipart/form-data"?N=yield x.formData():N=yield x.text(),{data:N,error:null,response:x}}catch(l){return{data:null,error:l,response:l instanceof _x||l instanceof wx?l.context:void 0}}finally{o&&clearTimeout(o)}})}}var D7=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},R7=class{constructor(t){var r,e;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(e=t.isMaybeSingle)!==null&&e!==void 0?e:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){var e=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{let s=null,l=null,c=null,i=o.status,u=o.statusText;if(o.ok){var p,f;if(e.method!=="HEAD"){var h;const x=await o.text();x===""||(e.headers.get("Accept")==="text/csv"||e.headers.get("Accept")&&(!((h=e.headers.get("Accept"))===null||h===void 0)&&h.includes("application/vnd.pgrst.plan+text"))?l=x:l=JSON.parse(x))}const b=(p=e.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),g=(f=o.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");b&&g&&g.length>1&&(c=parseInt(g[1])),e.isMaybeSingle&&e.method==="GET"&&Array.isArray(l)&&(l.length>1?(s={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,c=null,i=406,u="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var v;const b=await o.text();try{s=JSON.parse(b),Array.isArray(s)&&o.status===404&&(l=[],s=null,i=200,u="OK")}catch{o.status===404&&b===""?(i=204,u="No Content"):s={message:b}}if(s&&e.isMaybeSingle&&(!(s==null||(v=s.details)===null||v===void 0)&&v.includes("0 rows"))&&(s=null,i=200,u="OK"),s&&e.shouldThrowOnError)throw new D7(s)}return{error:s,data:l,count:c,status:i,statusText:u}});return this.shouldThrowOnError||(a=a.catch(o=>{var s;let l="";const c=o==null?void 0:o.cause;if(c){var i,u,p,f;const v=(i=c==null?void 0:c.message)!==null&&i!==void 0?i:"",b=(u=c==null?void 0:c.code)!==null&&u!==void 0?u:"";l=`${(p=o==null?void 0:o.name)!==null&&p!==void 0?p:"FetchError"}: ${o==null?void 0:o.message}`,l+=`

Caused by: ${(f=c==null?void 0:c.name)!==null&&f!==void 0?f:"Error"}: ${v}`,b&&(l+=` (${b})`),c!=null&&c.stack&&(l+=`
${c.stack}`)}else{var h;l=(h=o==null?void 0:o.stack)!==null&&h!==void 0?h:""}return{error:{message:`${(s=o==null?void 0:o.name)!==null&&s!==void 0?s:"FetchError"}: ${o==null?void 0:o.message}`,details:l,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}},M7=class extends R7{select(t){let r=!1;const e=(t??"*").split("").map(n=>/\s/.test(n)&&!r?"":(n==='"'&&(r=!r),n)).join("");return this.url.searchParams.set("select",e),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:e,foreignTable:n,referencedTable:a=n}={}){const o=a?`${a}.order`:"order",s=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${s?`${s},`:""}${t}.${r?"asc":"desc"}${e===void 0?"":e?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:e=r}={}){const n=typeof e>"u"?"limit":`${e}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,r,{foreignTable:e,referencedTable:n=e}={}){const a=typeof n>"u"?"offset":`${n}.offset`,o=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this.url.searchParams.set(o,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:e=!1,buffers:n=!1,wal:a=!1,format:o="text"}={}){var s;const l=[t?"analyze":null,r?"verbose":null,e?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),c=(s=this.headers.get("Accept"))!==null&&s!==void 0?s:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${c}"; options=${l};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const Sx=new RegExp("[,()]");var Il=class extends M7{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}regexMatch(t,r){return this.url.searchParams.append(t,`match.${r}`),this}regexIMatch(t,r){return this.url.searchParams.append(t,`imatch.${r}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}isDistinct(t,r){return this.url.searchParams.append(t,`isdistinct.${r}`),this}in(t,r){const e=Array.from(new Set(r)).map(n=>typeof n=="string"&&Sx.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`in.(${e})`),this}notIn(t,r){const e=Array.from(new Set(r)).map(n=>typeof n=="string"&&Sx.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(t,`not.in.(${e})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:e,type:n}={}){let a="";n==="plain"?a="pl":n==="phrase"?a="ph":n==="websearch"&&(a="w");const o=e===void 0?"":`(${e})`;return this.url.searchParams.append(t,`${a}fts${o}.${r}`),this}match(t){return Object.entries(t).forEach(([r,e])=>{this.url.searchParams.append(r,`eq.${e}`)}),this}not(t,r,e){return this.url.searchParams.append(t,`not.${r}.${e}`),this}or(t,{foreignTable:r,referencedTable:e=r}={}){const n=e?`${e}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,r,e){return this.url.searchParams.append(t,`${r}.${e}`),this}},F7=class{constructor(t,{headers:r={},schema:e,fetch:n}){this.url=t,this.headers=new Headers(r),this.schema=e,this.fetch=n}select(t,r){const{head:e=!1,count:n}=r??{},a=e?"HEAD":"GET";let o=!1;const s=(t??"*").split("").map(l=>/\s/.test(l)&&!o?"":(l==='"'&&(o=!o),l)).join("");return this.url.searchParams.set("select",s),n&&this.headers.append("Prefer",`count=${n}`),new Il({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:e=!0}={}){var n;const a="POST";if(r&&this.headers.append("Prefer",`count=${r}`),e||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const o=t.reduce((s,l)=>s.concat(Object.keys(l)),[]);if(o.length>0){const s=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",s.join(","))}}return new Il({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:e=!1,count:n,defaultToNull:a=!0}={}){var o;const s="POST";if(this.headers.append("Prefer",`resolution=${e?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),n&&this.headers.append("Prefer",`count=${n}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,i)=>c.concat(Object.keys(i)),[]);if(l.length>0){const c=[...new Set(l)].map(i=>`"${i}"`);this.url.searchParams.set("columns",c.join(","))}}return new Il({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(t,{count:r}={}){var e;const n="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Il({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}delete({count:t}={}){var r;const e="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Il({method:e,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}},I7=class Lw{constructor(r,{headers:e={},schema:n,fetch:a}={}){this.url=r,this.headers=new Headers(e),this.schemaName=n,this.fetch=a}from(r){if(!r||typeof r!="string"||r.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new F7(new URL(`${this.url}/${r}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(r){return new Lw(this.url,{headers:this.headers,schema:r,fetch:this.fetch})}rpc(r,e={},{head:n=!1,get:a=!1,count:o}={}){var s;let l;const c=new URL(`${this.url}/rpc/${r}`);let i;n||a?(l=n?"HEAD":"GET",Object.entries(e).filter(([p,f])=>f!==void 0).map(([p,f])=>[p,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([p,f])=>{c.searchParams.append(p,f)})):(l="POST",i=e);const u=new Headers(this.headers);return o&&u.set("Prefer",`count=${o}`),new Il({method:l,url:c,headers:u,schema:this.schemaName,body:i,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}};class P7{constructor(){}static detectEnvironment(){var r;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((r=navigator.userAgent)===null||r===void 0)&&r.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const e=process.versions;if(e&&e.node){const n=e.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const r=this.detectEnvironment();if(r.constructor)return r.constructor;let e=r.error||"WebSocket not supported in this environment.";throw r.workaround&&(e+=`

Suggested solution: ${r.workaround}`),new Error(e)}static createWebSocket(r,e){const n=this.getWebSocketConstructor();return new n(r,e)}static isWebSocketSupported(){try{const r=this.detectEnvironment();return r.type==="native"||r.type==="ws"}catch{return!1}}}const L7="2.89.0",B7=`realtime-js/${L7}`,Bw="1.0.0",U7="2.0.0",kx=Bw,$p=1e4,z7=1e3,$7=100;var Vi;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Vi||(Vi={}));var gn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(gn||(gn={}));var ss;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ss||(ss={}));var Vp;(function(t){t.websocket="websocket"})(Vp||(Vp={}));var jo;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(jo||(jo={}));class V7{constructor(r){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=r??[]}encode(r,e){if(r.event===this.BROADCAST_EVENT&&!(r.payload instanceof ArrayBuffer)&&typeof r.payload.event=="string")return e(this._binaryEncodeUserBroadcastPush(r));let n=[r.join_ref,r.ref,r.topic,r.event,r.payload];return e(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(r){var e;return this._isArrayBuffer((e=r.payload)===null||e===void 0?void 0:e.payload)?this._encodeBinaryUserBroadcastPush(r):this._encodeJsonUserBroadcastPush(r)}_encodeBinaryUserBroadcastPush(r){var e,n;const a=(n=(e=r.payload)===null||e===void 0?void 0:e.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(r,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(r){var e,n;const a=(n=(e=r.payload)===null||e===void 0?void 0:e.payload)!==null&&n!==void 0?n:{},s=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(r,this.JSON_ENCODING,s)}_encodeUserBroadcastPush(r,e,n){var a,o;const s=r.topic,l=(a=r.ref)!==null&&a!==void 0?a:"",c=(o=r.join_ref)!==null&&o!==void 0?o:"",i=r.payload.event,u=this.allowedMetadataKeys?this._pick(r.payload,this.allowedMetadataKeys):{},p=Object.keys(u).length===0?"":JSON.stringify(u);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(s.length>255)throw new Error(`topic length ${s.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`userEvent length ${i.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`metadata length ${p.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+s.length+i.length+p.length,h=new ArrayBuffer(this.HEADER_LENGTH+f);let v=new DataView(h),b=0;v.setUint8(b++,this.KINDS.userBroadcastPush),v.setUint8(b++,c.length),v.setUint8(b++,l.length),v.setUint8(b++,s.length),v.setUint8(b++,i.length),v.setUint8(b++,p.length),v.setUint8(b++,e),Array.from(c,x=>v.setUint8(b++,x.charCodeAt(0))),Array.from(l,x=>v.setUint8(b++,x.charCodeAt(0))),Array.from(s,x=>v.setUint8(b++,x.charCodeAt(0))),Array.from(i,x=>v.setUint8(b++,x.charCodeAt(0))),Array.from(p,x=>v.setUint8(b++,x.charCodeAt(0)));var g=new Uint8Array(h.byteLength+n.byteLength);return g.set(new Uint8Array(h),0),g.set(new Uint8Array(n),h.byteLength),g.buffer}decode(r,e){if(this._isArrayBuffer(r)){let n=this._binaryDecode(r);return e(n)}if(typeof r=="string"){const n=JSON.parse(r),[a,o,s,l,c]=n;return e({join_ref:a,ref:o,topic:s,event:l,payload:c})}return e({})}_binaryDecode(r){const e=new DataView(r),n=e.getUint8(0),a=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(r,e,a)}}_decodeUserBroadcast(r,e,n){const a=e.getUint8(1),o=e.getUint8(2),s=e.getUint8(3),l=e.getUint8(4);let c=this.HEADER_LENGTH+4;const i=n.decode(r.slice(c,c+a));c=c+a;const u=n.decode(r.slice(c,c+o));c=c+o;const p=n.decode(r.slice(c,c+s));c=c+s;const f=r.slice(c,r.byteLength),h=l===this.JSON_ENCODING?JSON.parse(n.decode(f)):f,v={type:this.BROADCAST_EVENT,event:u,payload:h};return s>0&&(v.meta=JSON.parse(p)),{join_ref:null,ref:null,topic:i,event:this.BROADCAST_EVENT,payload:v}}_isArrayBuffer(r){var e;return r instanceof ArrayBuffer||((e=r==null?void 0:r.constructor)===null||e===void 0?void 0:e.name)==="ArrayBuffer"}_pick(r,e){return!r||typeof r!="object"?{}:Object.fromEntries(Object.entries(r).filter(([n])=>e.includes(n)))}}class Uw{constructor(r,e){this.callback=r,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Fr;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Fr||(Fr={}));const Ex=(t,r,e={})=>{var n;const a=(n=e.skipTypes)!==null&&n!==void 0?n:[];return r?Object.keys(r).reduce((o,s)=>(o[s]=H7(s,t,r,a),o),{}):{}},H7=(t,r,e,n)=>{const a=r.find(l=>l.name===t),o=a==null?void 0:a.type,s=e[t];return o&&!n.includes(o)?zw(o,s):Hp(s)},zw=(t,r)=>{if(t.charAt(0)==="_"){const e=t.slice(1,t.length);return Y7(r,e)}switch(t){case Fr.bool:return q7(r);case Fr.float4:case Fr.float8:case Fr.int2:case Fr.int4:case Fr.int8:case Fr.numeric:case Fr.oid:return W7(r);case Fr.json:case Fr.jsonb:return G7(r);case Fr.timestamp:return X7(r);case Fr.abstime:case Fr.date:case Fr.daterange:case Fr.int4range:case Fr.int8range:case Fr.money:case Fr.reltime:case Fr.text:case Fr.time:case Fr.timestamptz:case Fr.timetz:case Fr.tsrange:case Fr.tstzrange:return Hp(r);default:return Hp(r)}},Hp=t=>t,q7=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},W7=t=>{if(typeof t=="string"){const r=parseFloat(t);if(!Number.isNaN(r))return r}return t},G7=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},Y7=(t,r)=>{if(typeof t!="string")return t;const e=t.length-1,n=t[e];if(t[0]==="{"&&n==="}"){let o;const s=t.slice(1,e);try{o=JSON.parse("["+s+"]")}catch{o=s?s.split(","):[]}return o.map(l=>zw(r,l))}return t},X7=t=>typeof t=="string"?t.replace(" ","T"):t,$w=t=>{const r=new URL(t);return r.protocol=r.protocol.replace(/^ws/i,"http"),r.pathname=r.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),r.pathname===""||r.pathname==="/"?r.pathname="/api/broadcast":r.pathname=r.pathname+"/api/broadcast",r.href};class cp{constructor(r,e,n={},a=$p){this.channel=r,this.event=e,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,e){var n;return this._hasReceived(r)&&e((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:r,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:e}){this.recHooks.filter(n=>n.status===r).forEach(n=>n.callback(e))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var Tx;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Tx||(Tx={}));class lu{constructor(r,e){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(e==null?void 0:e.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:o,onLeave:s,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=lu.syncState(this.state,a,o,s),this.pendingDiffs.forEach(c=>{this.state=lu.syncDiff(this.state,c,o,s)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},a=>{const{onJoin:o,onLeave:s,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=lu.syncDiff(this.state,a,o,s),l())}),this.onJoin((a,o,s)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:o,newPresences:s})}),this.onLeave((a,o,s)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:o,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,e,n,a){const o=this.cloneDeep(r),s=this.transformState(e),l={},c={};return this.map(o,(i,u)=>{s[i]||(c[i]=u)}),this.map(s,(i,u)=>{const p=o[i];if(p){const f=u.map(g=>g.presence_ref),h=p.map(g=>g.presence_ref),v=u.filter(g=>h.indexOf(g.presence_ref)<0),b=p.filter(g=>f.indexOf(g.presence_ref)<0);v.length>0&&(l[i]=v),b.length>0&&(c[i]=b)}else l[i]=u}),this.syncDiff(o,{joins:l,leaves:c},n,a)}static syncDiff(r,e,n,a){const{joins:o,leaves:s}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(o,(l,c)=>{var i;const u=(i=r[l])!==null&&i!==void 0?i:[];if(r[l]=this.cloneDeep(c),u.length>0){const p=r[l].map(h=>h.presence_ref),f=u.filter(h=>p.indexOf(h.presence_ref)<0);r[l].unshift(...f)}n(l,u,c)}),this.map(s,(l,c)=>{let i=r[l];if(!i)return;const u=c.map(p=>p.presence_ref);i=i.filter(p=>u.indexOf(p.presence_ref)<0),r[l]=i,a(l,i,c),i.length===0&&delete r[l]}),r}static map(r,e){return Object.getOwnPropertyNames(r).map(n=>e(n,r[n]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((e,n)=>{const a=r[n];return"metas"in a?e[n]=a.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):e[n]=a,e},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ax;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Ax||(Ax={}));var cu;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(cu||(cu={}));var Qs;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Qs||(Qs={}));class zl{constructor(r,e={config:{}},n){var a,o;if(this.topic=r,this.params=e,this.socket=n,this.bindings={},this.state=gn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new cp(this,ss.join,this.params,this.timeout),this.rejoinTimer=new Uw(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=gn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=gn.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=gn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=gn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=gn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ss.reply,{},(s,l)=>{this._trigger(this._replyEventName(l),s)}),this.presence=new lu(this),this.broadcastEndpointURL=$w(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(r,e=this.timeout){var n,a,o;if(this.socket.isConnected()||this.socket.connect(),this.state==gn.closed){const{config:{broadcast:s,presence:l,private:c}}=this.params,i=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(h=>h.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[cu.PRESENCE]&&this.bindings[cu.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,p={},f={broadcast:s,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:i,private:c};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(h=>r==null?void 0:r(Qs.CHANNEL_ERROR,h)),this._onClose(()=>r==null?void 0:r(Qs.CLOSED)),this.updateJoinPayload(Object.assign({config:f},p)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",async({postgres_changes:h})=>{var v;if(this.socket._isManualToken()||this.socket.setAuth(),h===void 0){r==null||r(Qs.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,g=(v=b==null?void 0:b.length)!==null&&v!==void 0?v:0,x=[];for(let y=0;y<g;y++){const k=b[y],{filter:{event:N,schema:F,table:B,filter:W}}=k,V=h&&h[y];if(V&&V.event===N&&zl.isFilterValueEqual(V.schema,F)&&zl.isFilterValueEqual(V.table,B)&&zl.isFilterValueEqual(V.filter,W))x.push(Object.assign(Object.assign({},k),{id:V.id}));else{this.unsubscribe(),this.state=gn.errored,r==null||r(Qs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,r&&r(Qs.SUBSCRIBED);return}}).receive("error",h=>{this.state=gn.errored,r==null||r(Qs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{r==null||r(Qs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,e={}){return await this.send({type:"presence",event:"track",payload:r},e.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,e,n){return this.state===gn.joined&&r===cu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(r,e,n)}async httpSend(r,e,n={}){var a;if(e==null)return Promise.reject("Payload is required for httpSend()");const o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const s={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:e,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,s,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const i=await l.json();c=i.error||i.message||c}catch{}return Promise.reject(new Error(c))}async send(r,e={}){var n,a;if(!this._canPush()&&r.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:s}=r,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:s,private:this.private}]})};try{const i=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=e.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=i.body)===null||a===void 0?void 0:a.cancel()),i.ok?"ok":"error"}catch(i){return i.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var s,l,c;const i=this._push(r.type,r,e.timeout||this.timeout);r.type==="broadcast"&&!(!((c=(l=(s=this.params)===null||s===void 0?void 0:s.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),i.receive("ok",()=>o("ok")),i.receive("error",()=>o("error")),i.receive("timeout",()=>o("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=gn.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ss.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new cp(this,ss.leave,{},r),n.receive("ok",()=>{e(),a("ok")}).receive("timeout",()=>{e(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(r=>r.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=gn.closed,this.bindings={}}async _fetchWithTimeout(r,e,n){const a=new AbortController,o=setTimeout(()=>a.abort(),n),s=await this.socket.fetch(r,Object.assign(Object.assign({},e),{signal:a.signal}));return clearTimeout(o),s}_push(r,e,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new cp(this,r,e,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(r){if(r.startTimeout(),this.pushBuffer.push(r),this.pushBuffer.length>$7){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(r,e,n){return e}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,e,n){var a,o;const s=r.toLocaleLowerCase(),{close:l,error:c,leave:i,join:u}=ss;if(n&&[l,c,i,u].indexOf(s)>=0&&n!==this._joinRef())return;let f=this._onMessage(s,e,n);if(e&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(h=>{var v,b,g;return((v=h.filter)===null||v===void 0?void 0:v.event)==="*"||((g=(b=h.filter)===null||b===void 0?void 0:b.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===s}).map(h=>h.callback(f,n)):(o=this.bindings[s])===null||o===void 0||o.filter(h=>{var v,b,g,x,y,k;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in h){const N=h.id,F=(v=h.filter)===null||v===void 0?void 0:v.event;return N&&((b=e.ids)===null||b===void 0?void 0:b.includes(N))&&(F==="*"||(F==null?void 0:F.toLocaleLowerCase())===((g=e.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const N=(y=(x=h==null?void 0:h.filter)===null||x===void 0?void 0:x.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return N==="*"||N===((k=e==null?void 0:e.event)===null||k===void 0?void 0:k.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===s}).map(h=>{if(typeof f=="object"&&"ids"in f){const v=f.data,{schema:b,table:g,commit_timestamp:x,type:y,errors:k}=v;f=Object.assign(Object.assign({},{schema:b,table:g,commit_timestamp:x,eventType:y,new:{},old:{},errors:k}),this._getPayloadRecords(v))}h.callback(f,n)})}_isClosed(){return this.state===gn.closed}_isJoined(){return this.state===gn.joined}_isJoining(){return this.state===gn.joining}_isLeaving(){return this.state===gn.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,e,n){const a=r.toLocaleLowerCase(),o={type:a,filter:e,callback:n};return this.bindings[a]?this.bindings[a].push(o):this.bindings[a]=[o],this}_off(r,e){const n=r.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var o;return!(((o=a.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===n&&zl.isEqual(a.filter,e))})),this}static isEqual(r,e){if(Object.keys(r).length!==Object.keys(e).length)return!1;for(const n in r)if(r[n]!==e[n])return!1;return!0}static isFilterValueEqual(r,e){return(r??void 0)===(e??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(ss.close,{},r)}_onError(r){this._on(ss.error,{},e=>r(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=gn.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const e={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(e.new=Ex(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(e.old=Ex(r.columns,r.old_record)),e}}const up=()=>{},of={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},K7=[1e3,2e3,5e3,1e4],Z7=1e4,J7=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Q7{constructor(r,e){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=$p,this.transport=null,this.heartbeatIntervalMs=of.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=up,this.ref=0,this.reconnectTimer=null,this.vsn=kx,this.logger=up,this.conn=null,this.sendBuffer=[],this.serializer=new V7,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...o)=>a(...o):(...o)=>fetch(...o),!(!((n=e==null?void 0:e.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=e.params.apikey,this.endPoint=`${r}/${Vp.websocket}`,this.httpEndpoint=$w(r),this._initializeOptions(e),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(e==null?void 0:e.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=P7.createWebSocket(this.endpointURL())}catch(r){this._setConnectionState("disconnected");const e=r.message;throw e.includes("Node.js")?new Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(r,e){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(r?this.conn.close(r,e??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(r){const e=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),e}async removeAllChannels(){const r=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),r}log(r,e,n){this.logger(r,e,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Vi.connecting:return jo.Connecting;case Vi.open:return jo.Open;case Vi.closing:return jo.Closing;default:return jo.Closed}}isConnected(){return this.connectionState()===jo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(r,e={config:{}}){const n=`realtime:${r}`,a=this.getChannels().find(o=>o.topic===n);if(a)return a;{const o=new zl(`realtime:${r}`,e,this);return this.channels.push(o),o}}push(r){const{topic:e,event:n,payload:a,ref:o}=r,s=()=>{this.encode(r,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${e} ${n} (${o})`,a),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(r=null){this._authPromise=this._performAuth(r);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var r;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,(r=this.conn)===null||r===void 0||r.close(z7,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout()},of.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")}onHeartbeat(r){this.heartbeatCallback=r}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let e=this.channels.find(n=>n.topic===r&&(n._isJoined()||n._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${r}"`),e.unsubscribe())}_remove(r){this.channels=this.channels.filter(e=>e.topic!==r.topic)}_onConnMessage(r){this.decode(r.data,e=>{if(e.topic==="phoenix"&&e.event==="phx_reply")try{this.heartbeatCallback(e.payload.status==="ok"?"ok":"error")}catch(i){this.log("error","error in heartbeat callback",i)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:o,ref:s}=e,l=s?`(${s})`:"",c=o.status||"";this.log("receive",`${c} ${n} ${a} ${l}`.trim(),o),this.channels.filter(i=>i._isMember(n)).forEach(i=>i._trigger(a,o,s)),this._triggerStateCallbacks("message",e)})}_clearTimer(r){var e;r==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):r==="reconnect"&&((e=this.reconnectTimer)===null||e===void 0||e.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r),this.conn.readyState===Vi.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Vi.open||this.conn.readyState===Vi.connecting)try{this.conn.close()}catch(r){this.log("error","Error closing connection",r)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(r=>r.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this._terminateWorker()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(r){var e;this._setConnectionState("disconnected"),this.log("transport","close",r),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout(),this._triggerStateCallbacks("close",r)}_onConnError(r){this._setConnectionState("disconnected"),this.log("transport",`${r}`),this._triggerChanError(),this._triggerStateCallbacks("error",r)}_triggerChanError(){this.channels.forEach(r=>r._trigger(ss.error))}_appendParams(r,e){if(Object.keys(e).length===0)return r;const n=r.match(/\?/)?"&":"?",a=new URLSearchParams(e);return`${r}${n}${a}`}_workerObjectUrl(r){let e;if(r)e=r;else{const n=new Blob([J7],{type:"application/javascript"});e=URL.createObjectURL(n)}return e}_setConnectionState(r,e=!1){this._connectionState=r,r==="connecting"?this._wasManualDisconnect=!1:r==="disconnecting"&&(this._wasManualDisconnect=e)}async _performAuth(r=null){let e,n=!1;if(r)e=r,n=!0;else if(this.accessToken)try{e=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),e=this.accessTokenValue}else e=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(a=>{const o={access_token:e,version:B7};e&&a.updateJoinPayload(o),a.joinedOnce&&a._isJoined()&&a._push(ss.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(r="general"){this._isManualToken()||this.setAuth().catch(e=>{this.log("error",`Error setting auth in ${r}`,e)})}_triggerStateCallbacks(r,e){try{this.stateChangeCallbacks[r].forEach(n=>{try{n(e)}catch(a){this.log("error",`error in ${r} callback`,a)}})}catch(n){this.log("error",`error triggering ${r} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Uw(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},of.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(r){var e,n,a,o,s,l,c,i,u,p,f,h;switch(this.transport=(e=r==null?void 0:r.transport)!==null&&e!==void 0?e:null,this.timeout=(n=r==null?void 0:r.timeout)!==null&&n!==void 0?n:$p,this.heartbeatIntervalMs=(a=r==null?void 0:r.heartbeatIntervalMs)!==null&&a!==void 0?a:of.HEARTBEAT_INTERVAL,this.worker=(o=r==null?void 0:r.worker)!==null&&o!==void 0?o:!1,this.accessToken=(s=r==null?void 0:r.accessToken)!==null&&s!==void 0?s:null,this.heartbeatCallback=(l=r==null?void 0:r.heartbeatCallback)!==null&&l!==void 0?l:up,this.vsn=(c=r==null?void 0:r.vsn)!==null&&c!==void 0?c:kx,r!=null&&r.params&&(this.params=r.params),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(i=r==null?void 0:r.reconnectAfterMs)!==null&&i!==void 0?i:v=>K7[v-1]||Z7,this.vsn){case Bw:this.encode=(u=r==null?void 0:r.encode)!==null&&u!==void 0?u:(v,b)=>b(JSON.stringify(v)),this.decode=(p=r==null?void 0:r.decode)!==null&&p!==void 0?p:(v,b)=>b(JSON.parse(v));break;case U7:this.encode=(f=r==null?void 0:r.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(h=r==null?void 0:r.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=r==null?void 0:r.workerUrl}}}var ku=class extends Error{constructor(t,r){var e;super(t),this.name="IcebergError",this.status=r.status,this.icebergType=r.icebergType,this.icebergCode=r.icebergCode,this.details=r.details,this.isCommitStateUnknown=r.icebergType==="CommitStateUnknownException"||[500,502,504].includes(r.status)&&((e=r.icebergType)==null?void 0:e.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function e9(t,r,e){const n=new URL(r,t);if(e)for(const[a,o]of Object.entries(e))o!==void 0&&n.searchParams.set(a,o);return n.toString()}async function t9(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function r9(t){const r=t.fetchImpl??globalThis.fetch;return{async request({method:e,path:n,query:a,body:o,headers:s}){const l=e9(t.baseUrl,n,a),c=await t9(t.auth),i=await r(l,{method:e,headers:{...o?{"Content-Type":"application/json"}:{},...c,...s},body:o?JSON.stringify(o):void 0}),u=await i.text(),p=(i.headers.get("content-type")||"").includes("application/json"),f=p&&u?JSON.parse(u):u;if(!i.ok){const h=p?f:void 0,v=h==null?void 0:h.error;throw new ku((v==null?void 0:v.message)??`Request failed with status ${i.status}`,{status:i.status,icebergType:v==null?void 0:v.type,icebergCode:v==null?void 0:v.code,details:h})}return{status:i.status,headers:i.headers,data:f}}}}function lf(t){return t.join("")}var n9=class{constructor(t,r=""){this.client=t,this.prefix=r}async listNamespaces(t){const r=t?{parent:lf(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:r})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(t,r){const e={namespace:t.namespace,properties:r==null?void 0:r.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:e})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${lf(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${lf(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${lf(t.namespace)}`}),!0}catch(r){if(r instanceof ku&&r.status===404)return!1;throw r}}async createNamespaceIfNotExists(t,r){try{return await this.createNamespace(t,r)}catch(e){if(e instanceof ku&&e.status===409)return;throw e}}};function El(t){return t.join("")}var a9=class{constructor(t,r="",e){this.client=t,this.prefix=r,this.accessDelegation=e}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables`})).data.identifiers}async createTable(t,r){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables`,body:r,headers:e})).data.metadata}async updateTable(t,r){const e=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables/${t.name}`,body:r});return{"metadata-location":e.data["metadata-location"],metadata:e.data.metadata}}async dropTable(t,r){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String((r==null?void 0:r.purge)??!1)}})}async loadTable(t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables/${t.name}`,headers:r})).data.metadata}async tableExists(t){const r={};this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${El(t.namespace)}/tables/${t.name}`,headers:r}),!0}catch(e){if(e instanceof ku&&e.status===404)return!1;throw e}}async createTableIfNotExists(t,r){try{return await this.createTable(t,r)}catch(e){if(e instanceof ku&&e.status===409)return await this.loadTable({namespace:t.namespace,name:r.name});throw e}}},s9=class{constructor(t){var n;let r="v1";t.catalogName&&(r+=`/${t.catalogName}`);const e=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=r9({baseUrl:e,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=(n=t.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new n9(this.client,r),this.tableOps=new a9(this.client,r,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,r){return this.namespaceOps.createNamespace(t,r)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,r){return this.tableOps.createTable(t,r)}async updateTable(t,r){return this.tableOps.updateTable(t,r)}async dropTable(t,r){await this.tableOps.dropTable(t,r)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,r){return this.namespaceOps.createNamespaceIfNotExists(t,r)}async createTableIfNotExists(t,r){return this.tableOps.createTableIfNotExists(t,r)}},Gf=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function zr(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var i9=class extends Gf{constructor(t,r,e){super(t),this.name="StorageApiError",this.status=r,this.statusCode=e}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},qp=class extends Gf{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}};const Mm=t=>t?(...r)=>t(...r):(...r)=>fetch(...r),o9=()=>Response,Wp=t=>{if(Array.isArray(t))return t.map(e=>Wp(e));if(typeof t=="function"||t!==Object(t))return t;const r={};return Object.entries(t).forEach(([e,n])=>{const a=e.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));r[a]=Wp(n)}),r},l9=t=>{if(typeof t!="object"||t===null)return!1;const r=Object.getPrototypeOf(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},c9=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Eu(t){"@babel/helpers - typeof";return Eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Eu(t)}function u9(t,r){if(Eu(t)!="object"||!t)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var n=e.call(t,r);if(Eu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function d9(t){var r=u9(t,"string");return Eu(r)=="symbol"?r:r+""}function f9(t,r,e){return(r=d9(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function Cx(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function Kt(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?Cx(Object(e),!0).forEach(function(n){f9(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Cx(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}const dp=t=>{var r;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(r=t.error)===null||r===void 0?void 0:r.message)||JSON.stringify(t)},h9=async(t,r,e)=>{t instanceof await o9()&&!(e!=null&&e.noResolveJson)?t.json().then(n=>{const a=t.status||500,o=(n==null?void 0:n.statusCode)||a+"";r(new i9(dp(n),a,o))}).catch(n=>{r(new qp(dp(n),n))}):r(new qp(dp(t),t))},p9=(t,r,e,n)=>{const a={method:t,headers:(r==null?void 0:r.headers)||{}};return t==="GET"||!n?a:(l9(n)?(a.headers=Kt({"Content-Type":"application/json"},r==null?void 0:r.headers),a.body=JSON.stringify(n)):a.body=n,r!=null&&r.duplex&&(a.duplex=r.duplex),Kt(Kt({},a),e))};async function qu(t,r,e,n,a,o){return new Promise((s,l)=>{t(e,p9(r,n,a,o)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>s(c)).catch(c=>h9(c,l,n))})}async function Tu(t,r,e,n){return qu(t,"GET",r,e,n)}async function as(t,r,e,n,a){return qu(t,"POST",r,n,a,e)}async function Gp(t,r,e,n,a){return qu(t,"PUT",r,n,a,e)}async function m9(t,r,e,n){return qu(t,"HEAD",r,Kt(Kt({},e),{},{noResolveJson:!0}),n)}async function Fm(t,r,e,n,a){return qu(t,"DELETE",r,n,a,e)}var g9=class{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(zr(r))return{data:null,error:r};throw r}}};let Vw;Vw=Symbol.toStringTag;var v9=class{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[Vw]="BlobDownloadBuilder",this.promise=null}asStream(){return new g9(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(zr(r))return{data:null,error:r};throw r}}};const b9={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Nx={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var x9=class{constructor(t,r={},e,n){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=e,this.fetch=Mm(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,r,e,n){var a=this;try{let o;const s=Kt(Kt({},Nx),n);let l=Kt(Kt({},a.headers),t==="POST"&&{"x-upsert":String(s.upsert)});const c=s.metadata;typeof Blob<"u"&&e instanceof Blob?(o=new FormData,o.append("cacheControl",s.cacheControl),c&&o.append("metadata",a.encodeMetadata(c)),o.append("",e)):typeof FormData<"u"&&e instanceof FormData?(o=e,o.has("cacheControl")||o.append("cacheControl",s.cacheControl),c&&!o.has("metadata")&&o.append("metadata",a.encodeMetadata(c))):(o=e,l["cache-control"]=`max-age=${s.cacheControl}`,l["content-type"]=s.contentType,c&&(l["x-metadata"]=a.toBase64(a.encodeMetadata(c))),(typeof ReadableStream<"u"&&o instanceof ReadableStream||o&&typeof o=="object"&&"pipe"in o&&typeof o.pipe=="function")&&!s.duplex&&(s.duplex="half")),n!=null&&n.headers&&(l=Kt(Kt({},l),n.headers));const i=a._removeEmptyFolders(r),u=a._getFinalPath(i),p=await(t=="PUT"?Gp:as)(a.fetch,`${a.url}/object/${u}`,o,Kt({headers:l},s!=null&&s.duplex?{duplex:s.duplex}:{}));return{data:{path:i,id:p.Id,fullPath:p.Key},error:null}}catch(o){if(a.shouldThrowOnError)throw o;if(zr(o))return{data:null,error:o};throw o}}async upload(t,r,e){return this.uploadOrUpdate("POST",t,r,e)}async uploadToSignedUrl(t,r,e,n){var a=this;const o=a._removeEmptyFolders(t),s=a._getFinalPath(o),l=new URL(a.url+`/object/upload/sign/${s}`);l.searchParams.set("token",r);try{let c;const i=Kt({upsert:Nx.upsert},n),u=Kt(Kt({},a.headers),{"x-upsert":String(i.upsert)});return typeof Blob<"u"&&e instanceof Blob?(c=new FormData,c.append("cacheControl",i.cacheControl),c.append("",e)):typeof FormData<"u"&&e instanceof FormData?(c=e,c.append("cacheControl",i.cacheControl)):(c=e,u["cache-control"]=`max-age=${i.cacheControl}`,u["content-type"]=i.contentType),{data:{path:o,fullPath:(await Gp(a.fetch,l.toString(),c,{headers:u})).Key},error:null}}catch(c){if(a.shouldThrowOnError)throw c;if(zr(c))return{data:null,error:c};throw c}}async createSignedUploadUrl(t,r){var e=this;try{let n=e._getFinalPath(t);const a=Kt({},e.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const o=await as(e.fetch,`${e.url}/object/upload/sign/${n}`,{},{headers:a}),s=new URL(e.url+o.url),l=s.searchParams.get("token");if(!l)throw new Gf("No token returned by API");return{data:{signedUrl:s.toString(),path:t,token:l},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(zr(n))return{data:null,error:n};throw n}}async update(t,r,e){return this.uploadOrUpdate("PUT",t,r,e)}async move(t,r,e){var n=this;try{return{data:await as(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:t,destinationKey:r,destinationBucket:e==null?void 0:e.destinationBucket},{headers:n.headers}),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(zr(a))return{data:null,error:a};throw a}}async copy(t,r,e){var n=this;try{return{data:{path:(await as(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:t,destinationKey:r,destinationBucket:e==null?void 0:e.destinationBucket},{headers:n.headers})).Key},error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(zr(a))return{data:null,error:a};throw a}}async createSignedUrl(t,r,e){var n=this;try{let a=n._getFinalPath(t),o=await as(n.fetch,`${n.url}/object/sign/${a}`,Kt({expiresIn:r},e!=null&&e.transform?{transform:e.transform}:{}),{headers:n.headers});const s=e!=null&&e.download?`&download=${e.download===!0?"":e.download}`:"";return o={signedUrl:encodeURI(`${n.url}${o.signedURL}${s}`)},{data:o,error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(zr(a))return{data:null,error:a};throw a}}async createSignedUrls(t,r,e){var n=this;try{const a=await as(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:r,paths:t},{headers:n.headers}),o=e!=null&&e.download?`&download=${e.download===!0?"":e.download}`:"";return{data:a.map(s=>Kt(Kt({},s),{},{signedUrl:s.signedURL?encodeURI(`${n.url}${s.signedURL}${o}`):null})),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(zr(a))return{data:null,error:a};throw a}}download(t,r){const e=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=n?`?${n}`:"",o=this._getFinalPath(t),s=()=>Tu(this.fetch,`${this.url}/${e}/${o}${a}`,{headers:this.headers,noResolveJson:!0});return new v9(s,this.shouldThrowOnError)}async info(t){var r=this;const e=r._getFinalPath(t);try{return{data:Wp(await Tu(r.fetch,`${r.url}/object/info/${e}`,{headers:r.headers})),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(zr(n))return{data:null,error:n};throw n}}async exists(t){var r=this;const e=r._getFinalPath(t);try{return await m9(r.fetch,`${r.url}/object/${e}`,{headers:r.headers}),{data:!0,error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(zr(n)&&n instanceof qp){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}}getPublicUrl(t,r){const e=this._getFinalPath(t),n=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&n.push(a);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});s!==""&&n.push(s);let l=n.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${e}${l}`)}}}async remove(t){var r=this;try{return{data:await Fm(r.fetch,`${r.url}/object/${r.bucketId}`,{prefixes:t},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(zr(e))return{data:null,error:e};throw e}}async list(t,r,e){var n=this;try{const a=Kt(Kt(Kt({},b9),r),{},{prefix:t||""});return{data:await as(n.fetch,`${n.url}/object/list/${n.bucketId}`,a,{headers:n.headers},e),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(zr(a))return{data:null,error:a};throw a}}async listV2(t,r){var e=this;try{const n=Kt({},t);return{data:await as(e.fetch,`${e.url}/object/list-v2/${e.bucketId}`,n,{headers:e.headers},r),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(zr(n))return{data:null,error:n};throw n}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}};const Hw="2.89.0",qw={"X-Client-Info":`storage-js/${Hw}`};var y9=class{constructor(t,r={},e,n){this.shouldThrowOnError=!1;const a=new URL(t);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Kt(Kt({},qw),r),this.fetch=Mm(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var r=this;try{const e=r.listBucketOptionsToQueryString(t);return{data:await Tu(r.fetch,`${r.url}/bucket${e}`,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(zr(e))return{data:null,error:e};throw e}}async getBucket(t){var r=this;try{return{data:await Tu(r.fetch,`${r.url}/bucket/${t}`,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(zr(e))return{data:null,error:e};throw e}}async createBucket(t,r={public:!1}){var e=this;try{return{data:await as(e.fetch,`${e.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(zr(n))return{data:null,error:n};throw n}}async updateBucket(t,r){var e=this;try{return{data:await Gp(e.fetch,`${e.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(zr(n))return{data:null,error:n};throw n}}async emptyBucket(t){var r=this;try{return{data:await as(r.fetch,`${r.url}/bucket/${t}/empty`,{},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(zr(e))return{data:null,error:e};throw e}}async deleteBucket(t){var r=this;try{return{data:await Fm(r.fetch,`${r.url}/bucket/${t}`,{},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(zr(e))return{data:null,error:e};throw e}}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}},w9=class{constructor(t,r={},e){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Kt(Kt({},qw),r),this.fetch=Mm(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var r=this;try{return{data:await as(r.fetch,`${r.url}/bucket`,{name:t},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(zr(e))return{data:null,error:e};throw e}}async listBuckets(t){var r=this;try{const e=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&e.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&e.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&e.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&e.set("sortOrder",t.sortOrder),t!=null&&t.search&&e.set("search",t.search);const n=e.toString(),a=n?`${r.url}/bucket?${n}`:`${r.url}/bucket`;return{data:await Tu(r.fetch,a,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(zr(e))return{data:null,error:e};throw e}}async deleteBucket(t){var r=this;try{return{data:await Fm(r.fetch,`${r.url}/bucket/${t}`,{},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(zr(e))return{data:null,error:e};throw e}}from(t){var r=this;if(!c9(t))throw new Gf("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const e=new s9({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>r.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(e,{get(a,o){const s=a[o];return typeof s!="function"?s:async(...l)=>{try{return{data:await s.apply(a,l),error:null}}catch(c){if(n)throw c;return{data:null,error:c}}}}})}};const Im={"X-Client-Info":`storage-js/${Hw}`,"Content-Type":"application/json"};var Ww=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function _a(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var fp=class extends Ww{constructor(t,r,e){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=e}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},_9=class extends Ww{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}};const Pm=t=>t?(...r)=>t(...r):(...r)=>fetch(...r),S9=t=>{if(typeof t!="object"||t===null)return!1;const r=Object.getPrototypeOf(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},jx=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),k9=async(t,r,e)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(e!=null&&e.noResolveJson)){const n=t.status||500,a=t;if(typeof a.json=="function")a.json().then(o=>{const s=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||n+"";r(new fp(jx(o),n,s))}).catch(()=>{const o=n+"";r(new fp(a.statusText||`HTTP ${n} error`,n,o))});else{const o=n+"";r(new fp(a.statusText||`HTTP ${n} error`,n,o))}}else r(new _9(jx(t),t))},E9=(t,r,e,n)=>{const a={method:t,headers:(r==null?void 0:r.headers)||{}};return n?(S9(n)?(a.headers=Kt({"Content-Type":"application/json"},r==null?void 0:r.headers),a.body=JSON.stringify(n)):a.body=n,Kt(Kt({},a),e)):a};async function T9(t,r,e,n,a,o){return new Promise((s,l)=>{t(e,E9(r,n,a,o)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;const i=c.headers.get("content-type");return!i||!i.includes("application/json")?{}:c.json()}).then(c=>s(c)).catch(c=>k9(c,l,n))})}async function Sa(t,r,e,n,a){return T9(t,"POST",r,n,a,e)}var A9=class{constructor(t,r={},e){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Kt(Kt({},Im),r),this.fetch=Pm(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var r=this;try{return{data:await Sa(r.fetch,`${r.url}/CreateIndex`,t,{headers:r.headers})||{},error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_a(e))return{data:null,error:e};throw e}}async getIndex(t,r){var e=this;try{return{data:await Sa(e.fetch,`${e.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:e.headers}),error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(_a(n))return{data:null,error:n};throw n}}async listIndexes(t){var r=this;try{return{data:await Sa(r.fetch,`${r.url}/ListIndexes`,t,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_a(e))return{data:null,error:e};throw e}}async deleteIndex(t,r){var e=this;try{return{data:await Sa(e.fetch,`${e.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:e.headers})||{},error:null}}catch(n){if(e.shouldThrowOnError)throw n;if(_a(n))return{data:null,error:n};throw n}}},C9=class{constructor(t,r={},e){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Kt(Kt({},Im),r),this.fetch=Pm(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var r=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Sa(r.fetch,`${r.url}/PutVectors`,t,{headers:r.headers})||{},error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_a(e))return{data:null,error:e};throw e}}async getVectors(t){var r=this;try{return{data:await Sa(r.fetch,`${r.url}/GetVectors`,t,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_a(e))return{data:null,error:e};throw e}}async listVectors(t){var r=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await Sa(r.fetch,`${r.url}/ListVectors`,t,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_a(e))return{data:null,error:e};throw e}}async queryVectors(t){var r=this;try{return{data:await Sa(r.fetch,`${r.url}/QueryVectors`,t,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_a(e))return{data:null,error:e};throw e}}async deleteVectors(t){var r=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Sa(r.fetch,`${r.url}/DeleteVectors`,t,{headers:r.headers})||{},error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_a(e))return{data:null,error:e};throw e}}},N9=class{constructor(t,r={},e){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Kt(Kt({},Im),r),this.fetch=Pm(e)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var r=this;try{return{data:await Sa(r.fetch,`${r.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:r.headers})||{},error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_a(e))return{data:null,error:e};throw e}}async getBucket(t){var r=this;try{return{data:await Sa(r.fetch,`${r.url}/GetVectorBucket`,{vectorBucketName:t},{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_a(e))return{data:null,error:e};throw e}}async listBuckets(t={}){var r=this;try{return{data:await Sa(r.fetch,`${r.url}/ListVectorBuckets`,t,{headers:r.headers}),error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_a(e))return{data:null,error:e};throw e}}async deleteBucket(t){var r=this;try{return{data:await Sa(r.fetch,`${r.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:r.headers})||{},error:null}}catch(e){if(r.shouldThrowOnError)throw e;if(_a(e))return{data:null,error:e};throw e}}},j9=class extends N9{constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new O9(this.url,this.headers,t,this.fetch)}async createBucket(t){var r=()=>super.createBucket,e=this;return r().call(e,t)}async getBucket(t){var r=()=>super.getBucket,e=this;return r().call(e,t)}async listBuckets(t={}){var r=()=>super.listBuckets,e=this;return r().call(e,t)}async deleteBucket(t){var r=()=>super.deleteBucket,e=this;return r().call(e,t)}},O9=class extends A9{constructor(t,r,e,n){super(t,r,n),this.vectorBucketName=e}async createIndex(t){var r=()=>super.createIndex,e=this;return r().call(e,Kt(Kt({},t),{},{vectorBucketName:e.vectorBucketName}))}async listIndexes(t={}){var r=()=>super.listIndexes,e=this;return r().call(e,Kt(Kt({},t),{},{vectorBucketName:e.vectorBucketName}))}async getIndex(t){var r=()=>super.getIndex,e=this;return r().call(e,e.vectorBucketName,t)}async deleteIndex(t){var r=()=>super.deleteIndex,e=this;return r().call(e,e.vectorBucketName,t)}index(t){return new D9(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},D9=class extends C9{constructor(t,r,e,n,a){super(t,r,a),this.vectorBucketName=e,this.indexName=n}async putVectors(t){var r=()=>super.putVectors,e=this;return r().call(e,Kt(Kt({},t),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}async getVectors(t){var r=()=>super.getVectors,e=this;return r().call(e,Kt(Kt({},t),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}async listVectors(t={}){var r=()=>super.listVectors,e=this;return r().call(e,Kt(Kt({},t),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}async queryVectors(t){var r=()=>super.queryVectors,e=this;return r().call(e,Kt(Kt({},t),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}async deleteVectors(t){var r=()=>super.deleteVectors,e=this;return r().call(e,Kt(Kt({},t),{},{vectorBucketName:e.vectorBucketName,indexName:e.indexName}))}},R9=class extends y9{constructor(t,r={},e,n){super(t,r,e,n)}from(t){return new x9(this.url,this.headers,t,this.fetch)}get vectors(){return new j9(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new w9(this.url+"/iceberg",this.headers,this.fetch)}};const Gw="2.89.0",Pl=30*1e3,Yp=3,hp=Yp*Pl,M9="http://localhost:9999",F9="supabase.auth.token",I9={"X-Client-Info":`gotrue-js/${Gw}`},Xp="X-Supabase-Api-Version",Yw={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},P9=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,L9=10*60*1e3;class Au extends Error{constructor(r,e,n){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=n}}function Ut(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class B9 extends Au{constructor(r,e,n){super(r,e,n),this.name="AuthApiError",this.status=e,this.code=n}}function U9(t){return Ut(t)&&t.name==="AuthApiError"}class Oo extends Au{constructor(r,e){super(r),this.name="AuthUnknownError",this.originalError=e}}class li extends Au{constructor(r,e,n,a){super(r,n,a),this.name=e,this.status=n}}class va extends li{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function z9(t){return Ut(t)&&t.name==="AuthSessionMissingError"}class Tl extends li{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class cf extends li{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class uf extends li{constructor(r,e=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function $9(t){return Ut(t)&&t.name==="AuthImplicitGrantRedirectError"}class Ox extends li{constructor(r,e=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class V9 extends li{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Kp extends li{constructor(r,e){super(r,"AuthRetryableFetchError",e,void 0)}}function pp(t){return Ut(t)&&t.name==="AuthRetryableFetchError"}class Dx extends li{constructor(r,e,n){super(r,"AuthWeakPasswordError",e,"weak_password"),this.reasons=n}}class Zp extends li{constructor(r){super(r,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ef="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Rx=` 	
\r=`.split(""),H9=(()=>{const t=new Array(128);for(let r=0;r<t.length;r+=1)t[r]=-1;for(let r=0;r<Rx.length;r+=1)t[Rx[r].charCodeAt(0)]=-2;for(let r=0;r<Ef.length;r+=1)t[Ef[r].charCodeAt(0)]=r;return t})();function Mx(t,r,e){if(t!==null)for(r.queue=r.queue<<8|t,r.queuedBits+=8;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;e(Ef[n]),r.queuedBits-=6}else if(r.queuedBits>0)for(r.queue=r.queue<<6-r.queuedBits,r.queuedBits=6;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;e(Ef[n]),r.queuedBits-=6}}function Xw(t,r,e){const n=H9[t];if(n>-1)for(r.queue=r.queue<<6|n,r.queuedBits+=6;r.queuedBits>=8;)e(r.queue>>r.queuedBits-8&255),r.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Fx(t){const r=[],e=s=>{r.push(String.fromCodePoint(s))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},o=s=>{G9(s,n,e)};for(let s=0;s<t.length;s+=1)Xw(t.charCodeAt(s),a,o);return r.join("")}function q9(t,r){if(t<=127){r(t);return}else if(t<=2047){r(192|t>>6),r(128|t&63);return}else if(t<=65535){r(224|t>>12),r(128|t>>6&63),r(128|t&63);return}else if(t<=1114111){r(240|t>>18),r(128|t>>12&63),r(128|t>>6&63),r(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function W9(t,r){for(let e=0;e<t.length;e+=1){let n=t.charCodeAt(e);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(t.charCodeAt(e+1)-56320&65535|a)+65536,e+=1}q9(n,r)}}function G9(t,r,e){if(r.utf8seq===0){if(t<=127){e(t);return}for(let n=1;n<6;n+=1)if((t>>7-n&1)===0){r.utf8seq=n;break}if(r.utf8seq===2)r.codepoint=t&31;else if(r.utf8seq===3)r.codepoint=t&15;else if(r.utf8seq===4)r.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");r.utf8seq-=1}else if(r.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");r.codepoint=r.codepoint<<6|t&63,r.utf8seq-=1,r.utf8seq===0&&e(r.codepoint)}}function ql(t){const r=[],e={queue:0,queuedBits:0},n=a=>{r.push(a)};for(let a=0;a<t.length;a+=1)Xw(t.charCodeAt(a),e,n);return new Uint8Array(r)}function Y9(t){const r=[];return W9(t,e=>r.push(e)),new Uint8Array(r)}function Mo(t){const r=[],e={queue:0,queuedBits:0},n=a=>{r.push(a)};return t.forEach(a=>Mx(a,e,n)),Mx(null,e,n),r.join("")}function X9(t){return Math.round(Date.now()/1e3)+t}function K9(){return Symbol("auth-callback")}const Nn=()=>typeof window<"u"&&typeof document<"u",Eo={tested:!1,writable:!1},Kw=()=>{if(!Nn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Eo.tested)return Eo.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Eo.tested=!0,Eo.writable=!0}catch{Eo.tested=!0,Eo.writable=!1}return Eo.writable};function Z9(t){const r={},e=new URL(t);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((a,o)=>{r[o]=a})}catch{}return e.searchParams.forEach((n,a)=>{r[a]=n}),r}const Zw=t=>t?(...r)=>t(...r):(...r)=>fetch(...r),J9=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Ll=async(t,r,e)=>{await t.setItem(r,JSON.stringify(e))},To=async(t,r)=>{const e=await t.getItem(r);if(!e)return null;try{return JSON.parse(e)}catch{return e}},Cn=async(t,r)=>{await t.removeItem(r)};class Yf{constructor(){this.promise=new Yf.promiseConstructor((r,e)=>{this.resolve=r,this.reject=e})}}Yf.promiseConstructor=Promise;function mp(t){const r=t.split(".");if(r.length!==3)throw new Zp("Invalid JWT structure");for(let n=0;n<r.length;n++)if(!P9.test(r[n]))throw new Zp("JWT not in base64url format");return{header:JSON.parse(Fx(r[0])),payload:JSON.parse(Fx(r[1])),signature:ql(r[2]),raw:{header:r[0],payload:r[1]}}}async function Q9(t){return await new Promise(r=>{setTimeout(()=>r(null),t)})}function eC(t,r){return new Promise((n,a)=>{(async()=>{for(let o=0;o<1/0;o++)try{const s=await t(o);if(!r(o,null,s)){n(s);return}}catch(s){if(!r(o,s)){a(s);return}}})()})}function tC(t){return("0"+t.toString(16)).substr(-2)}function rC(){const r=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=e.length;let a="";for(let o=0;o<56;o++)a+=e.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(r),Array.from(r,tC).join("")}async function nC(t){const e=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",e),a=new Uint8Array(n);return Array.from(a).map(o=>String.fromCharCode(o)).join("")}async function aC(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const e=await nC(t);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Al(t,r,e=!1){const n=rC();let a=n;e&&(a+="/PASSWORD_RECOVERY"),await Ll(t,`${r}-code-verifier`,a);const o=await aC(n);return[o,n===o?"plain":"s256"]}const sC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function iC(t){const r=t.headers.get(Xp);if(!r||!r.match(sC))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}function oC(t){if(!t)throw new Error("Missing exp claim");const r=Math.floor(Date.now()/1e3);if(t<=r)throw new Error("JWT has expired")}function lC(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const cC=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Cl(t){if(!cC.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function gp(){const t={};return new Proxy(t,{get:(r,e)=>{if(e==="__isUserNotAvailableProxy")return!0;if(typeof e=="symbol"){const n=e.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${e}" property of the session object is not supported. Please use getUser() instead.`)},set:(r,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(r,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function uC(t,r){return new Proxy(t,{get:(e,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const o=n.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)"||o==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(e,n,a)}return!r.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),r.value=!0),Reflect.get(e,n,a)}})}function Ix(t){return JSON.parse(JSON.stringify(t))}const No=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),dC=[502,503,504];async function Px(t){var r;if(!J9(t))throw new Kp(No(t),0);if(dC.includes(t.status))throw new Kp(No(t),t.status);let e;try{e=await t.json()}catch(o){throw new Oo(No(o),o)}let n;const a=iC(t);if(a&&a.getTime()>=Yw["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?n=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(n=e.error_code),n){if(n==="weak_password")throw new Dx(No(e),t.status,((r=e.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(n==="session_not_found")throw new va}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((o,s)=>o&&typeof s=="string",!0))throw new Dx(No(e),t.status,e.weak_password.reasons);throw new B9(No(e),t.status||500,n)}const fC=(t,r,e,n)=>{const a={method:t,headers:(r==null?void 0:r.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r==null?void 0:r.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),e))};async function Xt(t,r,e,n){var a;const o=Object.assign({},n==null?void 0:n.headers);o[Xp]||(o[Xp]=Yw["2024-01-01"].name),n!=null&&n.jwt&&(o.Authorization=`Bearer ${n.jwt}`);const s=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(s.redirect_to=n.redirectTo);const l=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",c=await hC(t,r,e+l,{headers:o,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function hC(t,r,e,n,a,o){const s=fC(r,n,a,o);let l;try{l=await t(e,Object.assign({},s))}catch(c){throw console.error(c),new Kp(No(c),0)}if(l.ok||await Px(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await Px(c)}}function ns(t){var r;let e=null;gC(t)&&(e=Object.assign({},t),t.expires_at||(e.expires_at=X9(t.expires_in)));const n=(r=t.user)!==null&&r!==void 0?r:t;return{data:{session:e,user:n},error:null}}function Lx(t){const r=ns(t);return!r.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((e,n)=>e&&typeof n=="string",!0)&&(r.data.weak_password=t.weak_password),r}function Hi(t){var r;return{data:{user:(r=t.user)!==null&&r!==void 0?r:t},error:null}}function pC(t){return{data:t,error:null}}function mC(t){const{action_link:r,email_otp:e,hashed_token:n,redirect_to:a,verification_type:o}=t,s=zf(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:r,email_otp:e,hashed_token:n,redirect_to:a,verification_type:o},c=Object.assign({},s);return{data:{properties:l,user:c},error:null}}function Bx(t){return t}function gC(t){return t.access_token&&t.refresh_token&&t.expires_in}const vp=["global","local","others"];class vC{constructor({url:r="",headers:e={},fetch:n}){this.url=r,this.headers=e,this.fetch=Zw(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(r,e=vp[0]){if(vp.indexOf(e)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${vp.join(", ")}`);try{return await Xt(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ut(n))return{data:null,error:n};throw n}}async inviteUserByEmail(r,e={}){try{return await Xt(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:Hi})}catch(n){if(Ut(n))return{data:{user:null},error:n};throw n}}async generateLink(r){try{const{options:e}=r,n=zf(r,["options"]),a=Object.assign(Object.assign({},n),e);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Xt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:mC,redirectTo:e==null?void 0:e.redirectTo})}catch(e){if(Ut(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(r){try{return await Xt(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:Hi})}catch(e){if(Ut(e))return{data:{user:null},error:e};throw e}}async listUsers(r){var e,n,a,o,s,l,c;try{const i={nextPage:null,lastPage:0,total:0},u=await Xt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(e=r==null?void 0:r.page)===null||e===void 0?void 0:e.toString())!==null&&n!==void 0?n:"",per_page:(o=(a=r==null?void 0:r.perPage)===null||a===void 0?void 0:a.toString())!==null&&o!==void 0?o:""},xform:Bx});if(u.error)throw u.error;const p=await u.json(),f=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(v=>{const b=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(v.split(";")[1].split("=")[1]);i[`${g}Page`]=b}),i.total=parseInt(f)),{data:Object.assign(Object.assign({},p),i),error:null}}catch(i){if(Ut(i))return{data:{users:[]},error:i};throw i}}async getUserById(r){Cl(r);try{return await Xt(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:Hi})}catch(e){if(Ut(e))return{data:{user:null},error:e};throw e}}async updateUserById(r,e){Cl(r);try{return await Xt(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:e,headers:this.headers,xform:Hi})}catch(n){if(Ut(n))return{data:{user:null},error:n};throw n}}async deleteUser(r,e=!1){Cl(r);try{return await Xt(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:e},xform:Hi})}catch(n){if(Ut(n))return{data:{user:null},error:n};throw n}}async _listFactors(r){Cl(r.userId);try{const{data:e,error:n}=await Xt(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:e,error:n}}catch(e){if(Ut(e))return{data:null,error:e};throw e}}async _deleteFactor(r){Cl(r.userId),Cl(r.id);try{return{data:await Xt(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(e){if(Ut(e))return{data:null,error:e};throw e}}async _listOAuthClients(r){var e,n,a,o,s,l,c;try{const i={nextPage:null,lastPage:0,total:0},u=await Xt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(e=r==null?void 0:r.page)===null||e===void 0?void 0:e.toString())!==null&&n!==void 0?n:"",per_page:(o=(a=r==null?void 0:r.perPage)===null||a===void 0?void 0:a.toString())!==null&&o!==void 0?o:""},xform:Bx});if(u.error)throw u.error;const p=await u.json(),f=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(v=>{const b=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(v.split(";")[1].split("=")[1]);i[`${g}Page`]=b}),i.total=parseInt(f)),{data:Object.assign(Object.assign({},p),i),error:null}}catch(i){if(Ut(i))return{data:{clients:[]},error:i};throw i}}async _createOAuthClient(r){try{return await Xt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:r,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(Ut(e))return{data:null,error:e};throw e}}async _getOAuthClient(r){try{return await Xt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${r}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(Ut(e))return{data:null,error:e};throw e}}async _updateOAuthClient(r,e){try{return await Xt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${r}`,{body:e,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Ut(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(r){try{return await Xt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${r}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(e){if(Ut(e))return{data:null,error:e};throw e}}async _regenerateOAuthClientSecret(r){try{return await Xt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${r}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(Ut(e))return{data:null,error:e};throw e}}}function Ux(t={}){return{getItem:r=>t[r]||null,setItem:(r,e)=>{t[r]=e},removeItem:r=>{delete t[r]}}}const Nl={debug:!!(globalThis&&Kw()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Jw extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class bC extends Jw{}async function xC(t,r,e){Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,r);const n=new globalThis.AbortController;return r>0&&setTimeout(()=>{n.abort(),Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await e()}finally{Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(r===0)throw Nl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new bC(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Nl.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await e()}}))}function yC(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Qw(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function wC(t){return parseInt(t,16)}function _C(t){const r=new TextEncoder().encode(t);return"0x"+Array.from(r,n=>n.toString(16).padStart(2,"0")).join("")}function SC(t){var r;const{chainId:e,domain:n,expirationTime:a,issuedAt:o=new Date,nonce:s,notBefore:l,requestId:c,resources:i,scheme:u,uri:p,version:f}=t;{if(!Number.isInteger(e))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${e}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(s&&s.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${s}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((r=t.statement)===null||r===void 0)&&r.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const h=Qw(t.address),v=u?`${u}://${n}`:n,b=t.statement?`${t.statement}
`:"",g=`${v} wants you to sign in with your Ethereum account:
${h}

${b}`;let x=`URI: ${p}
Version: ${f}
Chain ID: ${e}${s?`
Nonce: ${s}`:""}
Issued At: ${o.toISOString()}`;if(a&&(x+=`
Expiration Time: ${a.toISOString()}`),l&&(x+=`
Not Before: ${l.toISOString()}`),c&&(x+=`
Request ID: ${c}`),i){let y=`
Resources:`;for(const k of i){if(!k||typeof k!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${k}`);y+=`
- ${k}`}x+=y}return`${g}
${x}`}class cn extends Error{constructor({message:r,code:e,cause:n,name:a}){var o;super(r,{cause:n}),this.__isWebAuthnError=!0,this.name=(o=a??(n instanceof Error?n.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=e}}class Tf extends cn{constructor(r,e){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e,message:r}),this.name="WebAuthnUnknownError",this.originalError=e}}function kC({error:t,options:r}){var e,n,a;const{publicKey:o}=r;if(!o)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(r.signal instanceof AbortSignal)return new cn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((e=o.authenticatorSelection)===null||e===void 0?void 0:e.requireResidentKey)===!0)return new cn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(r.mediation==="conditional"&&((n=o.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new cn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((a=o.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new cn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new cn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new cn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return o.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new cn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new cn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(e_(s)){if(o.rp.id!==s)return new cn({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new cn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new cn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new cn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new cn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function EC({error:t,options:r}){const{publicKey:e}=r;if(!e)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(r.signal instanceof AbortSignal)return new cn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new cn({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const n=window.location.hostname;if(e_(n)){if(e.rpId!==n)return new cn({message:`The RP ID "${e.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new cn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new cn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new cn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class TC{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const r=new AbortController;return this.controller=r,r.signal}cancelCeremony(){if(this.controller){const r=new Error("Manually cancelling existing WebAuthn API call");r.name="AbortError",this.controller.abort(r),this.controller=void 0}}}const AC=new TC;function CC(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:r,user:e,excludeCredentials:n}=t,a=zf(t,["challenge","user","excludeCredentials"]),o=ql(r).buffer,s=Object.assign(Object.assign({},e),{id:ql(e.id).buffer}),l=Object.assign(Object.assign({},a),{challenge:o,user:s});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const i=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},i),{id:ql(i.id).buffer,type:i.type||"public-key",transports:i.transports})}}return l}function NC(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:r,allowCredentials:e}=t,n=zf(t,["challenge","allowCredentials"]),a=ql(r).buffer,o=Object.assign(Object.assign({},n),{challenge:a});if(e&&e.length>0){o.allowCredentials=new Array(e.length);for(let s=0;s<e.length;s++){const l=e[s];o.allowCredentials[s]=Object.assign(Object.assign({},l),{id:ql(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return o}function jC(t){var r;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const e=t;return{id:t.id,rawId:t.id,response:{attestationObject:Mo(new Uint8Array(t.response.attestationObject)),clientDataJSON:Mo(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(r=e.authenticatorAttachment)!==null&&r!==void 0?r:void 0}}function OC(t){var r;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const e=t,n=t.getClientExtensionResults(),a=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Mo(new Uint8Array(a.authenticatorData)),clientDataJSON:Mo(new Uint8Array(a.clientDataJSON)),signature:Mo(new Uint8Array(a.signature)),userHandle:a.userHandle?Mo(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(r=e.authenticatorAttachment)!==null&&r!==void 0?r:void 0}}function e_(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function zx(){var t,r;return!!(Nn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((r=navigator==null?void 0:navigator.credentials)===null||r===void 0?void 0:r.get)=="function")}async function DC(t){try{const r=await navigator.credentials.create(t);return r?r instanceof PublicKeyCredential?{data:r,error:null}:{data:null,error:new Tf("Browser returned unexpected credential type",r)}:{data:null,error:new Tf("Empty credential response",r)}}catch(r){return{data:null,error:kC({error:r,options:t})}}}async function RC(t){try{const r=await navigator.credentials.get(t);return r?r instanceof PublicKeyCredential?{data:r,error:null}:{data:null,error:new Tf("Browser returned unexpected credential type",r)}:{data:null,error:new Tf("Empty credential response",r)}}catch(r){return{data:null,error:EC({error:r,options:t})}}}const MC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},FC={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Af(...t){const r=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),e=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of t)if(a)for(const o in a){const s=a[o];if(s!==void 0)if(Array.isArray(s))n[o]=s;else if(e(s))n[o]=s;else if(r(s)){const l=n[o];r(l)?n[o]=Af(l,s):n[o]=Af(s)}else n[o]=s}return n}function IC(t,r){return Af(MC,t,r||{})}function PC(t,r){return Af(FC,t,r||{})}class LC{constructor(r){this.client=r,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(r){return this.client.mfa.enroll(Object.assign(Object.assign({},r),{factorType:"webauthn"}))}async _challenge({factorId:r,webauthn:e,friendlyName:n,signal:a},o){try{const{data:s,error:l}=await this.client.mfa.challenge({factorId:r,webauthn:e});if(!s)return{data:null,error:l};const c=a??AC.createNewAbortSignal();if(s.webauthn.type==="create"){const{user:i}=s.webauthn.credential_options.publicKey;i.name||(i.name=`${i.id}:${n}`),i.displayName||(i.displayName=i.name)}switch(s.webauthn.type){case"create":{const i=IC(s.webauthn.credential_options.publicKey,o==null?void 0:o.create),{data:u,error:p}=await DC({publicKey:i,signal:c});return u?{data:{factorId:r,challengeId:s.id,webauthn:{type:s.webauthn.type,credential_response:u}},error:null}:{data:null,error:p}}case"request":{const i=PC(s.webauthn.credential_options.publicKey,o==null?void 0:o.request),{data:u,error:p}=await RC(Object.assign(Object.assign({},s.webauthn.credential_options),{publicKey:i,signal:c}));return u?{data:{factorId:r,challengeId:s.id,webauthn:{type:s.webauthn.type,credential_response:u}},error:null}:{data:null,error:p}}}}catch(s){return Ut(s)?{data:null,error:s}:{data:null,error:new Oo("Unexpected error in challenge",s)}}}async _verify({challengeId:r,factorId:e,webauthn:n}){return this.client.mfa.verify({factorId:e,challengeId:r,webauthn:n})}async _authenticate({factorId:r,webauthn:{rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},o){if(!e)return{data:null,error:new Au("rpId is required for WebAuthn authentication")};try{if(!zx())return{data:null,error:new Oo("Browser does not support WebAuthn",null)};const{data:s,error:l}=await this.challenge({factorId:r,webauthn:{rpId:e,rpOrigins:n},signal:a},{request:o});if(!s)return{data:null,error:l};const{webauthn:c}=s;return this._verify({factorId:r,challengeId:s.challengeId,webauthn:{type:c.type,rpId:e,rpOrigins:n,credential_response:c.credential_response}})}catch(s){return Ut(s)?{data:null,error:s}:{data:null,error:new Oo("Unexpected error in authenticate",s)}}}async _register({friendlyName:r,webauthn:{rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},o){if(!e)return{data:null,error:new Au("rpId is required for WebAuthn registration")};try{if(!zx())return{data:null,error:new Oo("Browser does not support WebAuthn",null)};const{data:s,error:l}=await this._enroll({friendlyName:r});if(!s)return await this.client.mfa.listFactors().then(u=>{var p;return(p=u.data)===null||p===void 0?void 0:p.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===r&&f.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:l};const{data:c,error:i}=await this._challenge({factorId:s.id,friendlyName:s.friendly_name,webauthn:{rpId:e,rpOrigins:n},signal:a},{create:o});return c?this._verify({factorId:s.id,challengeId:c.challengeId,webauthn:{rpId:e,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:i}}catch(s){return Ut(s)?{data:null,error:s}:{data:null,error:new Oo("Unexpected error in register",s)}}}}yC();const BC={url:M9,storageKey:F9,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:I9,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function $x(t,r,e){return await e()}const jl={};class Cu{get jwks(){var r,e;return(e=(r=jl[this.storageKey])===null||r===void 0?void 0:r.jwks)!==null&&e!==void 0?e:{keys:[]}}set jwks(r){jl[this.storageKey]=Object.assign(Object.assign({},jl[this.storageKey]),{jwks:r})}get jwks_cached_at(){var r,e;return(e=(r=jl[this.storageKey])===null||r===void 0?void 0:r.cachedAt)!==null&&e!==void 0?e:Number.MIN_SAFE_INTEGER}set jwks_cached_at(r){jl[this.storageKey]=Object.assign(Object.assign({},jl[this.storageKey]),{cachedAt:r})}constructor(r){var e,n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const o=Object.assign(Object.assign({},BC),r);if(this.storageKey=o.storageKey,this.instanceID=(e=Cu.nextInstanceID[this.storageKey])!==null&&e!==void 0?e:0,Cu.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.instanceID>0&&Nn()){const s=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(s),this.logDebugMessages&&console.trace(s)}if(this.persistSession=o.persistSession,this.autoRefreshToken=o.autoRefreshToken,this.admin=new vC({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=Zw(o.fetch),this.lock=o.lock||$x,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,this.throwOnError=o.throwOnError,o.lock?this.lock=o.lock:this.persistSession&&Nn()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=xC:this.lock=$x,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new LC(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:Kw()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ux(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=Ux(this.memoryStorage)),Nn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(r){if(this.throwOnError&&r&&r.error)throw r.error;return r}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Gw}) ${new Date().toISOString()}`}_debug(...r){return this.logDebugMessages&&this.logger(this._logPrefix(),...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{let e={},n="none";if(Nn()&&(e=Z9(window.location.href),this._isImplicitGrantCallback(e)?n="implicit":await this._isPKCECallback(e)&&(n="pkce")),Nn()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:o}=await this._getSessionFromURL(e,n);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),$9(o)){const c=(r=o.details)===null||r===void 0?void 0:r.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:s,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",s,"redirect type",l),await this._saveSession(s),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return Ut(e)?this._returnResult({error:e}):this._returnResult({error:new Oo("Unexpected error during initialization",e)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var e,n,a;try{const o=await Xt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(e=r==null?void 0:r.options)===null||e===void 0?void 0:e.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=r==null?void 0:r.options)===null||a===void 0?void 0:a.captchaToken}},xform:ns}),{data:s,error:l}=o;if(l||!s)return this._returnResult({data:{user:null,session:null},error:l});const c=s.session,i=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:i,session:c},error:null})}catch(o){if(Ut(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signUp(r){var e,n,a;try{let o;if("email"in r){const{email:u,password:p,options:f}=r;let h=null,v=null;this.flowType==="pkce"&&([h,v]=await Al(this.storage,this.storageKey)),o=await Xt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:p,data:(e=f==null?void 0:f.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:h,code_challenge_method:v},xform:ns})}else if("phone"in r){const{phone:u,password:p,options:f}=r;o=await Xt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:p,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(a=f==null?void 0:f.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:ns})}else throw new cf("You must provide either an email or phone number and a password");const{data:s,error:l}=o;if(l||!s)return await Cn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=s.session,i=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:i,session:c},error:null})}catch(o){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),Ut(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithPassword(r){try{let e;if("email"in r){const{email:o,password:s,options:l}=r;e=await Xt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:s,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Lx})}else if("phone"in r){const{phone:o,password:s,options:l}=r;e=await Xt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:s,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Lx})}else throw new cf("You must provide either an email or phone number and a password");const{data:n,error:a}=e;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const o=new Tl;return this._returnResult({data:{user:null,session:null},error:o})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(e){if(Ut(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOAuth(r){var e,n,a,o;return await this._handleProviderSignIn(r.provider,{redirectTo:(e=r.options)===null||e===void 0?void 0:e.redirectTo,scopes:(n=r.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=r.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(o=r.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(r))}async signInWithWeb3(r){const{chain:e}=r;switch(e){case"ethereum":return await this.signInWithEthereum(r);case"solana":return await this.signInWithSolana(r);default:throw new Error(`@supabase/auth-js: Unsupported chain "${e}"`)}}async signInWithEthereum(r){var e,n,a,o,s,l,c,i,u,p,f;let h,v;if("message"in r)h=r.message,v=r.signature;else{const{chain:b,wallet:g,statement:x,options:y}=r;let k;if(Nn())if(typeof g=="object")k=g;else{const q=window;if("ethereum"in q&&typeof q.ethereum=="object"&&"request"in q.ethereum&&typeof q.ethereum.request=="function")k=q.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=g}const N=new URL((e=y==null?void 0:y.url)!==null&&e!==void 0?e:window.location.href),F=await k.request({method:"eth_requestAccounts"}).then(q=>q).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!F||F.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const B=Qw(F[0]);let W=(n=y==null?void 0:y.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!W){const q=await k.request({method:"eth_chainId"});W=wC(q)}const V={domain:N.host,address:B,statement:x,uri:N.href,version:"1",chainId:W,nonce:(a=y==null?void 0:y.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(s=(o=y==null?void 0:y.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&s!==void 0?s:new Date,expirationTime:(l=y==null?void 0:y.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=y==null?void 0:y.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(i=y==null?void 0:y.signInWithEthereum)===null||i===void 0?void 0:i.requestId,resources:(u=y==null?void 0:y.signInWithEthereum)===null||u===void 0?void 0:u.resources};h=SC(V),v=await k.request({method:"personal_sign",params:[_C(h),B]})}try{const{data:b,error:g}=await Xt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:v},!((p=r.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(f=r.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:ns});if(g)throw g;if(!b||!b.session||!b.user){const x=new Tl;return this._returnResult({data:{user:null,session:null},error:x})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:g})}catch(b){if(Ut(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async signInWithSolana(r){var e,n,a,o,s,l,c,i,u,p,f,h;let v,b;if("message"in r)v=r.message,b=r.signature;else{const{chain:g,wallet:x,statement:y,options:k}=r;let N;if(Nn())if(typeof x=="object")N=x;else{const B=window;if("solana"in B&&typeof B.solana=="object"&&("signIn"in B.solana&&typeof B.solana.signIn=="function"||"signMessage"in B.solana&&typeof B.solana.signMessage=="function"))N=B.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(k!=null&&k.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=x}const F=new URL((e=k==null?void 0:k.url)!==null&&e!==void 0?e:window.location.href);if("signIn"in N&&N.signIn){const B=await N.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},k==null?void 0:k.signInWithSolana),{version:"1",domain:F.host,uri:F.href}),y?{statement:y}:null));let W;if(Array.isArray(B)&&B[0]&&typeof B[0]=="object")W=B[0];else if(B&&typeof B=="object"&&"signedMessage"in B&&"signature"in B)W=B;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in W&&"signature"in W&&(typeof W.signedMessage=="string"||W.signedMessage instanceof Uint8Array)&&W.signature instanceof Uint8Array)v=typeof W.signedMessage=="string"?W.signedMessage:new TextDecoder().decode(W.signedMessage),b=W.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in N)||typeof N.signMessage!="function"||!("publicKey"in N)||typeof N!="object"||!N.publicKey||!("toBase58"in N.publicKey)||typeof N.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${F.host} wants you to sign in with your Solana account:`,N.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${F.href}`,`Issued At: ${(a=(n=k==null?void 0:k.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((o=k==null?void 0:k.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${k.signInWithSolana.notBefore}`]:[],...!((s=k==null?void 0:k.signInWithSolana)===null||s===void 0)&&s.expirationTime?[`Expiration Time: ${k.signInWithSolana.expirationTime}`]:[],...!((l=k==null?void 0:k.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${k.signInWithSolana.chainId}`]:[],...!((c=k==null?void 0:k.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${k.signInWithSolana.nonce}`]:[],...!((i=k==null?void 0:k.signInWithSolana)===null||i===void 0)&&i.requestId?[`Request ID: ${k.signInWithSolana.requestId}`]:[],...!((p=(u=k==null?void 0:k.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||p===void 0)&&p.length?["Resources",...k.signInWithSolana.resources.map(W=>`- ${W}`)]:[]].join(`
`);const B=await N.signMessage(new TextEncoder().encode(v),"utf8");if(!B||!(B instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=B}}try{const{data:g,error:x}=await Xt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Mo(b)},!((f=r.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=r.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:ns});if(x)throw x;if(!g||!g.session||!g.user){const y=new Tl;return this._returnResult({data:{user:null,session:null},error:y})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:x})}catch(g){if(Ut(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(r){const e=await To(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(e??"").split("/");try{if(!n&&this.flowType==="pkce")throw new V9;const{data:o,error:s}=await Xt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:n},xform:ns});if(await Cn(this.storage,`${this.storageKey}-code-verifier`),s)throw s;if(!o||!o.session||!o.user){const l=new Tl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign(Object.assign({},o),{redirectType:a??null}),error:s})}catch(o){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),Ut(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}}async signInWithIdToken(r){try{const{options:e,provider:n,token:a,access_token:o,nonce:s}=r,l=await Xt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:o,nonce:s,gotrue_meta_security:{captcha_token:e==null?void 0:e.captchaToken}},xform:ns}),{data:c,error:i}=l;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!c||!c.session||!c.user){const u=new Tl;return this._returnResult({data:{user:null,session:null},error:u})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:i})}catch(e){if(Ut(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOtp(r){var e,n,a,o,s;try{if("email"in r){const{email:l,options:c}=r;let i=null,u=null;this.flowType==="pkce"&&([i,u]=await Al(this.storage,this.storageKey));const{error:p}=await Xt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(e=c==null?void 0:c.data)!==null&&e!==void 0?e:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:i,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in r){const{phone:l,options:c}=r,{data:i,error:u}=await Xt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(o=c==null?void 0:c.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(s=c==null?void 0:c.channel)!==null&&s!==void 0?s:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:u})}throw new cf("You must provide either an email or phone number.")}catch(l){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),Ut(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(r){var e,n;try{let a,o;"options"in r&&(a=(e=r.options)===null||e===void 0?void 0:e.redirectTo,o=(n=r.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:l}=await Xt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:o}}),redirectTo:a,xform:ns});if(l)throw l;if(!s)throw new Error("An error occurred on token verification.");const c=s.session,i=s.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:i,session:c},error:null})}catch(a){if(Ut(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(r){var e,n,a,o,s;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Al(this.storage,this.storageKey));const i=await Xt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(n=(e=r.options)===null||e===void 0?void 0:e.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=r==null?void 0:r.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:pC});return!((o=i.data)===null||o===void 0)&&o.url&&Nn()&&!(!((s=r.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(i.data.url),this._returnResult(i)}catch(l){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),Ut(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:e},error:n}=r;if(n)throw n;if(!e)throw new va;const{error:a}=await Xt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(r){if(Ut(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async resend(r){try{const e=`${this.url}/resend`;if("email"in r){const{email:n,type:a,options:o}=r,{error:s}=await Xt(this.fetch,"POST",e,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:s})}else if("phone"in r){const{phone:n,type:a,options:o}=r,{data:s,error:l}=await Xt(this.fetch,"POST",e,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:l})}throw new cf("You must provide either an email or phone number and a type")}catch(e){if(Ut(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(r,e){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await e()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=e();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const e=await this.__loadSession();return await r(e)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const e=await To(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",e),e!==null&&(this._isValidSession(e)?r=e:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const n=r.expires_at?r.expires_at*1e3-Date.now()<hp:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",r.expires_at),!n){if(this.userStorage){const s=await To(this.userStorage,this.storageKey+"-user");s!=null&&s.user?r.user=s.user:r.user=gp()}if(this.storage.isServer&&r.user&&!r.user.__isUserNotAvailableProxy){const s={value:this.suppressGetSessionWarning};r.user=uC(r.user,s),s.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:r},error:null}}const{data:a,error:o}=await this._callRefreshToken(r.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(r){if(r)return await this._getUser(r);await this.initializePromise;const e=await this._acquireLock(-1,async()=>await this._getUser());return e.data.user&&(this.suppressGetSessionWarning=!0),e}async _getUser(r){try{return r?await Xt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:Hi}):await this._useSession(async e=>{var n,a,o;const{data:s,error:l}=e;if(l)throw l;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new va}:await Xt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&o!==void 0?o:void 0,xform:Hi})})}catch(e){if(Ut(e))return z9(e)&&(await this._removeSession(),await Cn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:e});throw e}}async updateUser(r,e={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,e))}async _updateUser(r,e={}){try{return await this._useSession(async n=>{const{data:a,error:o}=n;if(o)throw o;if(!a.session)throw new va;const s=a.session;let l=null,c=null;this.flowType==="pkce"&&r.email!=null&&([l,c]=await Al(this.storage,this.storageKey));const{data:i,error:u}=await Xt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e==null?void 0:e.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:l,code_challenge_method:c}),jwt:s.access_token,xform:Hi});if(u)throw u;return s.user=i.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),this._returnResult({data:{user:s.user},error:null})})}catch(n){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),Ut(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new va;const e=Date.now()/1e3;let n=e,a=!0,o=null;const{payload:s}=mp(r.access_token);if(s.exp&&(n=s.exp,a=n<=e),a){const{data:l,error:c}=await this._callRefreshToken(r.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};o=l}else{const{data:l,error:c}=await this._getUser(r.access_token);if(c)throw c;o={access_token:r.access_token,refresh_token:r.refresh_token,user:l.user,token_type:"bearer",expires_in:n-e,expires_at:n},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(e){if(Ut(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async e=>{var n;if(!r){const{data:s,error:l}=e;if(l)throw l;r=(n=s.session)!==null&&n!==void 0?n:void 0}if(!(r!=null&&r.refresh_token))throw new va;const{data:a,error:o}=await this._callRefreshToken(r.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(e){if(Ut(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _getSessionFromURL(r,e){try{if(!Nn())throw new uf("No browser detected.");if(r.error||r.error_description||r.error_code)throw new uf(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(e){case"implicit":if(this.flowType==="pkce")throw new Ox("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new uf("Not a valid implicit grant flow url.");break;default:}if(e==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new Ox("No code detected.");const{data:y,error:k}=await this._exchangeCodeForSession(r.code);if(k)throw k;const N=new URL(window.location.href);return N.searchParams.delete("code"),window.history.replaceState(window.history.state,"",N.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:o,refresh_token:s,expires_in:l,expires_at:c,token_type:i}=r;if(!o||!l||!s||!i)throw new uf("No session defined in URL");const u=Math.round(Date.now()/1e3),p=parseInt(l);let f=u+p;c&&(f=parseInt(c));const h=f-u;h*1e3<=Pl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${p}s`);const v=f-p;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,f,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,f,u);const{data:b,error:g}=await this._getUser(o);if(g)throw g;const x={provider_token:n,provider_refresh_token:a,access_token:o,expires_in:p,expires_at:f,refresh_token:s,token_type:i,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:r.type},error:null})}catch(n){if(Ut(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(r){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),r):!!(r.access_token||r.error_description)}async _isPKCECallback(r){const e=await To(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&e)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async e=>{var n;const{data:a,error:o}=e;if(o)return this._returnResult({error:o});const s=(n=a.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:l}=await this.admin.signOut(s,r);if(l&&!(U9(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return r!=="others"&&(await this._removeSession(),await Cn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(r){const e=K9(),n={id:e,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",e),this.stateChangeEmitters.delete(e)}};return this._debug("#onAuthStateChange()","registered callback with id",e),this.stateChangeEmitters.set(e,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(e)})))(),{data:{subscription:n}}}async _emitInitialSession(r){return await this._useSession(async e=>{var n,a;try{const{data:{session:o},error:s}=e;if(s)throw s;await((n=this.stateChangeEmitters.get(r))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",r,"session",o)}catch(o){await((a=this.stateChangeEmitters.get(r))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",o),console.error(o)}})}async resetPasswordForEmail(r,e={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Al(this.storage,this.storageKey,!0));try{return await Xt(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(o){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),Ut(o))return this._returnResult({data:null,error:o});throw o}}async getUserIdentities(){var r;try{const{data:e,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(r=e.user.identities)!==null&&r!==void 0?r:[]},error:null})}catch(e){if(Ut(e))return this._returnResult({data:null,error:e});throw e}}async linkIdentity(r){return"token"in r?this.linkIdentityIdToken(r):this.linkIdentityOAuth(r)}async linkIdentityOAuth(r){var e;try{const{data:n,error:a}=await this._useSession(async o=>{var s,l,c,i,u;const{data:p,error:f}=o;if(f)throw f;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(s=r.options)===null||s===void 0?void 0:s.redirectTo,scopes:(l=r.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=r.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Xt(this.fetch,"GET",h,{headers:this.headers,jwt:(u=(i=p.session)===null||i===void 0?void 0:i.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return Nn()&&!(!((e=r.options)===null||e===void 0)&&e.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:r.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(Ut(n))return this._returnResult({data:{provider:r.provider,url:null},error:n});throw n}}async linkIdentityIdToken(r){return await this._useSession(async e=>{var n;try{const{error:a,data:{session:o}}=e;if(a)throw a;const{options:s,provider:l,token:c,access_token:i,nonce:u}=r,p=await Xt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=o==null?void 0:o.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:i,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:ns}),{data:f,error:h}=p;return h?this._returnResult({data:{user:null,session:null},error:h}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Tl}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:h}))}catch(a){if(await Cn(this.storage,`${this.storageKey}-code-verifier`),Ut(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(r){try{return await this._useSession(async e=>{var n,a;const{data:o,error:s}=e;if(s)throw s;return await Xt(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(a=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(e){if(Ut(e))return this._returnResult({data:null,error:e});throw e}}async _refreshAccessToken(r){const e=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(e,"begin");try{const n=Date.now();return await eC(async a=>(a>0&&await Q9(200*Math.pow(2,a-1)),this._debug(e,"refreshing attempt",a),await Xt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:ns})),(a,o)=>{const s=200*Math.pow(2,a);return o&&pp(o)&&Date.now()+s-n<Pl})}catch(n){if(this._debug(e,"error",n),Ut(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(e,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,e){const n=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",e,"url",n),Nn()&&!e.skipBrowserRedirect&&window.location.assign(n),{data:{provider:r,url:n},error:null}}async _recoverAndRefresh(){var r,e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await To(this.storage,this.storageKey);if(a&&this.userStorage){let s=await To(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!s&&(s={user:a.user},await Ll(this.userStorage,this.storageKey+"-user",s)),a.user=(r=s==null?void 0:s.user)!==null&&r!==void 0?r:gp()}else if(a&&!a.user&&!a.user){const s=await To(this.storage,this.storageKey+"-user");s&&(s!=null&&s.user)?(a.user=s.user,await Cn(this.storage,this.storageKey+"-user"),await Ll(this.storage,this.storageKey,a)):a.user=gp()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const o=((e=a.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<hp;if(this._debug(n,`session has${o?"":" not"} expired with margin of ${hp}s`),o){if(this.autoRefreshToken&&a.refresh_token){const{error:s}=await this._callRefreshToken(a.refresh_token);s&&(console.error(s),pp(s)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:s,error:l}=await this._getUser(a.access_token);!l&&(s!=null&&s.user)?(a.user=s.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(s){console.error("Error getting user data:",s),this._debug(n,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(r){var e,n;if(!r)throw new va;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Yf;const{data:o,error:s}=await this._refreshAccessToken(r);if(s)throw s;if(!o.session)throw new va;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const l={data:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(a,"error",o),Ut(o)){const s={data:null,error:o};return pp(o)||await this._removeSession(),(e=this.refreshingDeferred)===null||e===void 0||e.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(o),o}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(r,e,n=!0){const a=`#_notifyAllSubscribers(${r})`;this._debug(a,"begin",e,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:r,session:e});const o=[],s=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(r,e)}catch(c){o.push(c)}});if(await Promise.all(s),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(a,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0,await Cn(this.storage,`${this.storageKey}-code-verifier`);const e=Object.assign({},r),n=e.user&&e.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&e.user&&await Ll(this.userStorage,this.storageKey+"-user",{user:e.user});const a=Object.assign({},e);delete a.user;const o=Ix(a);await Ll(this.storage,this.storageKey,o)}else{const a=Ix(e);await Ll(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Cn(this.storage,this.storageKey),await Cn(this.storage,this.storageKey+"-code-verifier"),await Cn(this.storage,this.storageKey+"-user"),this.userStorage&&await Cn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&Nn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",r)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),Pl);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async e=>{const{data:{session:n}}=e;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-r)/Pl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Pl}ms, refresh threshold is ${Yp} ticks`),a<=Yp&&await this._callRefreshToken(n.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof Jw)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Nn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const e=`#_onVisibilityChanged(${r})`;this._debug(e,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(e,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,e,n){const a=[`provider=${encodeURIComponent(e)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[o,s]=await Al(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(s)}`});a.push(l.toString())}if(n!=null&&n.queryParams){const o=new URLSearchParams(n.queryParams);a.push(o.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${r}?${a.join("&")}`}async _unenroll(r){try{return await this._useSession(async e=>{var n;const{data:a,error:o}=e;return o?this._returnResult({data:null,error:o}):await Xt(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(e){if(Ut(e))return this._returnResult({data:null,error:e});throw e}}async _enroll(r){try{return await this._useSession(async e=>{var n,a;const{data:o,error:s}=e;if(s)return this._returnResult({data:null,error:s});const l=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:r.factorType==="totp"?{issuer:r.issuer}:{}),{data:c,error:i}=await Xt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=o==null?void 0:o.session)===null||n===void 0?void 0:n.access_token});return i?this._returnResult({data:null,error:i}):(r.factorType==="totp"&&c.type==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(e){if(Ut(e))return this._returnResult({data:null,error:e});throw e}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var n;const{data:a,error:o}=e;if(o)return this._returnResult({data:null,error:o});const s=Object.assign({challenge_id:r.challengeId},"webauthn"in r?{webauthn:Object.assign(Object.assign({},r.webauthn),{credential_response:r.webauthn.type==="create"?jC(r.webauthn.credential_response):OC(r.webauthn.credential_response)})}:{code:r.code}),{data:l,error:c}=await Xt(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:s,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(e){if(Ut(e))return this._returnResult({data:null,error:e});throw e}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var n;const{data:a,error:o}=e;if(o)return this._returnResult({data:null,error:o});const s=await Xt(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:r,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});if(s.error)return s;const{data:l}=s;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:CC(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:NC(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(e){if(Ut(e))return this._returnResult({data:null,error:e});throw e}})}async _challengeAndVerify(r){const{data:e,error:n}=await this._challenge({factorId:r.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:r.factorId,challengeId:e.id,code:r.code})}async _listFactors(){var r;const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const o of(r=e==null?void 0:e.factors)!==null&&r!==void 0?r:[])a.all.push(o),o.status==="verified"&&a[o.factor_type].push(o);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var r,e;const{data:{session:n},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=mp(n.access_token);let s=null;o.aal&&(s=o.aal);let l=s;((e=(r=n.user.factors)===null||r===void 0?void 0:r.filter(u=>u.status==="verified"))!==null&&e!==void 0?e:[]).length>0&&(l="aal2");const i=o.amr||[];return{data:{currentLevel:s,nextLevel:l,currentAuthenticationMethods:i},error:null}}async _getAuthorizationDetails(r){try{return await this._useSession(async e=>{const{data:{session:n},error:a}=e;return a?this._returnResult({data:null,error:a}):n?await Xt(this.fetch,"GET",`${this.url}/oauth/authorizations/${r}`,{headers:this.headers,jwt:n.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new va})})}catch(e){if(Ut(e))return this._returnResult({data:null,error:e});throw e}}async _approveAuthorization(r,e){try{return await this._useSession(async n=>{const{data:{session:a},error:o}=n;if(o)return this._returnResult({data:null,error:o});if(!a)return this._returnResult({data:null,error:new va});const s=await Xt(this.fetch,"POST",`${this.url}/oauth/authorizations/${r}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return s.data&&s.data.redirect_url&&Nn()&&!(e!=null&&e.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(n){if(Ut(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(r,e){try{return await this._useSession(async n=>{const{data:{session:a},error:o}=n;if(o)return this._returnResult({data:null,error:o});if(!a)return this._returnResult({data:null,error:new va});const s=await Xt(this.fetch,"POST",`${this.url}/oauth/authorizations/${r}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return s.data&&s.data.redirect_url&&Nn()&&!(e!=null&&e.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(n){if(Ut(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async r=>{const{data:{session:e},error:n}=r;return n?this._returnResult({data:null,error:n}):e?await Xt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:e.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new va})})}catch(r){if(Ut(r))return this._returnResult({data:null,error:r});throw r}}async _revokeOAuthGrant(r){try{return await this._useSession(async e=>{const{data:{session:n},error:a}=e;return a?this._returnResult({data:null,error:a}):n?(await Xt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:r.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new va})})}catch(e){if(Ut(e))return this._returnResult({data:null,error:e});throw e}}async fetchJwk(r,e={keys:[]}){let n=e.keys.find(l=>l.kid===r);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(l=>l.kid===r),n&&this.jwks_cached_at+L9>a)return n;const{data:o,error:s}=await Xt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=a,n=o.keys.find(l=>l.kid===r),!n)?null:n}async getClaims(r,e={}){try{let n=r;if(!n){const{data:h,error:v}=await this.getSession();if(v||!h.session)return this._returnResult({data:null,error:v});n=h.session.access_token}const{header:a,payload:o,signature:s,raw:{header:l,payload:c}}=mp(n);e!=null&&e.allowExpired||oC(o.exp);const i=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,e!=null&&e.keys?{keys:e.keys}:e==null?void 0:e.jwks);if(!i){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:o,header:a,signature:s},error:null}}const u=lC(a.alg),p=await crypto.subtle.importKey("jwk",i,u,!0,["verify"]);if(!await crypto.subtle.verify(u,p,s,Y9(`${l}.${c}`)))throw new Zp("Invalid JWT signature");return{data:{claims:o,header:a,signature:s},error:null}}catch(n){if(Ut(n))return this._returnResult({data:null,error:n});throw n}}}Cu.nextInstanceID={};const UC=Cu,zC="2.89.0";let nu="";typeof Deno<"u"?nu="deno":typeof document<"u"?nu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?nu="react-native":nu="node";const $C={"X-Client-Info":`supabase-js-${nu}/${zC}`},VC={headers:$C},HC={schema:"public"},qC={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},WC={};function Nu(t){"@babel/helpers - typeof";return Nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Nu(t)}function GC(t,r){if(Nu(t)!="object"||!t)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var n=e.call(t,r);if(Nu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}function YC(t){var r=GC(t,"string");return Nu(r)=="symbol"?r:r+""}function XC(t,r,e){return(r=YC(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function Vx(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function Wr(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?Vx(Object(e),!0).forEach(function(n){XC(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Vx(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}const KC=t=>t?(...r)=>t(...r):(...r)=>fetch(...r),ZC=()=>Headers,JC=(t,r,e)=>{const n=KC(e),a=ZC();return async(o,s)=>{var l;const c=(l=await r())!==null&&l!==void 0?l:t;let i=new a(s==null?void 0:s.headers);return i.has("apikey")||i.set("apikey",t),i.has("Authorization")||i.set("Authorization",`Bearer ${c}`),n(o,Wr(Wr({},s),{},{headers:i}))}};function QC(t){return t.endsWith("/")?t:t+"/"}function eN(t,r){var e,n;const{db:a,auth:o,realtime:s,global:l}=t,{db:c,auth:i,realtime:u,global:p}=r,f={db:Wr(Wr({},c),a),auth:Wr(Wr({},i),o),realtime:Wr(Wr({},u),s),storage:{},global:Wr(Wr(Wr({},p),l),{},{headers:Wr(Wr({},(e=p==null?void 0:p.headers)!==null&&e!==void 0?e:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function tN(t){const r=t==null?void 0:t.trim();if(!r)throw new Error("supabaseUrl is required.");if(!r.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(QC(r))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var rN=class extends UC{constructor(t){super(t)}},nN=class{constructor(t,r,e){var n,a;this.supabaseUrl=t,this.supabaseKey=r;const o=tN(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const s=`sb-${o.hostname.split(".")[0]}-auth-token`,l={db:HC,realtime:WC,auth:Wr(Wr({},qC),{},{storageKey:s}),global:VC},c=eN(e??{},l);if(this.storageKey=(n=c.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=c.global.headers)!==null&&a!==void 0?a:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(u,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}});else{var i;this.auth=this._initSupabaseAuthClient((i=c.auth)!==null&&i!==void 0?i:{},this.headers,c.global.fetch)}this.fetch=JC(r,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Wr({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&this.accessToken().then(u=>this.realtime.setAuth(u)).catch(u=>console.warn("Failed to set initial Realtime auth token:",u)),this.rest=new I7(new URL("rest/v1",o).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new R9(this.storageUrl.href,this.headers,this.fetch,e==null?void 0:e.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new O7(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},e={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,e)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,r,e;if(t.accessToken)return await t.accessToken();const{data:n}=await t.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:e,storage:n,userStorage:a,storageKey:o,flowType:s,lock:l,debug:c,throwOnError:i},u,p){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new rN({url:this.authUrl.href,headers:Wr(Wr({},f),u),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:e,storage:n,userStorage:a,flowType:s,lock:l,debug:c,throwOnError:i,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new Q7(this.realtimeUrl.href,Wr(Wr({},t),{},{params:Wr(Wr({},{apikey:this.supabaseKey}),t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,r,e){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==e?(this.changedAccessToken=e,this.realtime.setAuth(e)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const aN=(t,r,e)=>new nN(t,r,e);function sN(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}sN()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const iN="https://tqelhhitxpahzllngamh.supabase.co",oN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRxZWxoaGl0eHBhaHpsbG5nYW1oIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY2NzMwMjksImV4cCI6MjA4MjI0OTAyOX0.fqtBXBNmMA1yGud_PXNqzXduEmW75kZ9b8CkttymFzI",St=aN(iN,oN),lN=Object.freeze(Object.defineProperty({__proto__:null,supabase:St},Symbol.toStringTag,{value:"Module"}));function Xf(){var h,v,b,g,x,y,k;const{filters:t,setFilters:r,resetFilters:e}=ec(),[n,a]=_e.useState(t.startDate),[o,s]=_e.useState([]),[l,c]=_e.useState([]),[i,u]=_e.useState([]),[p,f]=_e.useState([]);return _e.useEffect(()=>{(async()=>{const[F,B,W,V]=await Promise.all([St.from("setores").select("*").order("nome"),St.from("motivos_devolucao").select("id, nome").order("nome"),St.from("clientes").select("nome").order("nome"),St.from("devolucoes").select("vendedor").not("vendedor","is",null)]);if(F.data&&s(F.data.map(q=>({id:q.id,name:q.nome}))),B.data&&c(B.data),W.data){const q=Array.from(new Set(W.data.map(X=>X.nome))).filter(Boolean);u(q.map(X=>({nome:X})))}if(V.data){const q=Array.from(new Set(V.data.map(X=>X.vendedor))).filter(Boolean);f(q)}})()},[]),_.jsxs("div",{className:"w-full bg-card border-b p-4 space-y-4",children:[_.jsxs("div",{className:"relative w-full",children:[_.jsx(fk,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),_.jsx(_r,{placeholder:"Buscar por cliente, vendedor, cidade...",className:"pl-8",value:t.search||"",onChange:N=>r({search:N.target.value})})]}),_.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-2",children:[_.jsxs($a,{value:((h=t.resultado)==null?void 0:h[0])||"all",onValueChange:N=>r({resultado:N==="all"?void 0:[N]}),children:[_.jsx(xa,{className:"w-full",children:_.jsx(Va,{placeholder:"Resultado"})}),_.jsxs(ya,{children:[_.jsx(sr,{value:"all",children:"Todos os Resultados"}),_.jsx(sr,{value:"PENDENTE VALIDAO",children:"PENDENTE VALIDAO"}),_.jsx(sr,{value:"VALIDADA",children:"VALIDADA"}),_.jsx(sr,{value:"LANADA",children:"LANADA"}),_.jsx(sr,{value:"TRATATIVA DE ANULAO",children:"TRATATIVA DE ANULAO"}),_.jsx(sr,{value:"ANULADA/CANCELADA",children:"ANULADA/CANCELADA"})]})]}),_.jsxs($a,{value:((v=t.motivo)==null?void 0:v[0])||"all",onValueChange:N=>r({motivo:N==="all"?void 0:[N]}),children:[_.jsx(xa,{className:"w-full",children:_.jsx(Va,{placeholder:"Motivo"})}),_.jsxs(ya,{children:[_.jsx(sr,{value:"all",children:"Todos os Motivos"}),l.map(N=>_.jsx(sr,{value:N.id,children:N.nome},N.id))]})]}),_.jsxs($a,{value:((b=t.cliente)==null?void 0:b[0])||"all",onValueChange:N=>r({cliente:N==="all"?void 0:[N]}),children:[_.jsx(xa,{className:"w-full",children:_.jsx(Va,{placeholder:"Cliente"})}),_.jsxs(ya,{children:[_.jsx(sr,{value:"all",children:"Todos os Clientes"}),i.slice(0,100).map((N,F)=>_.jsx(sr,{value:N.nome,children:N.nome},F))]})]}),_.jsxs($a,{value:((g=t.vendedor)==null?void 0:g[0])||"all",onValueChange:N=>r({vendedor:N==="all"?void 0:[N]}),children:[_.jsx(xa,{className:"w-full",children:_.jsx(Va,{placeholder:"Vendedor"})}),_.jsxs(ya,{children:[_.jsx(sr,{value:"all",children:"Todos os Vendedores"}),p.map(N=>_.jsx(sr,{value:N,children:N},N))]})]}),_.jsxs($a,{value:((x=t.setor)==null?void 0:x[0])||"all",onValueChange:N=>r({setor:N==="all"?void 0:[N]}),children:[_.jsxs(xa,{className:"w-full",children:[_.jsx($S,{className:"mr-2 h-4 w-4 text-muted-foreground"}),_.jsx(Va,{placeholder:"Setor"})]}),_.jsxs(ya,{children:[_.jsx(sr,{value:"all",children:"Todos os Setores"}),o.map(N=>_.jsx(sr,{value:N.id,children:N.name},N.id))]})]}),_.jsxs($a,{value:t.period||"all",onValueChange:N=>r({period:N==="all"?void 0:N}),children:[_.jsx(xa,{className:"w-full",children:_.jsx(Va,{placeholder:"Perodo"})}),_.jsxs(ya,{children:[_.jsx(sr,{value:"all",children:"Todos os Perodos"}),_.jsx(sr,{value:"TODAY",children:"Hoje"}),_.jsx(sr,{value:"YESTERDAY",children:"Ontem"}),_.jsx(sr,{value:"THIS_WEEK",children:"Esta Semana"}),_.jsx(sr,{value:"LAST_WEEK",children:"Semana Passada"}),_.jsx(sr,{value:"THIS_MONTH",children:"Ms Atual"}),_.jsx(sr,{value:"LAST_MONTH",children:"Ms Anterior"}),_.jsx(sr,{value:"THIS_QUARTER",children:"Trimestre Atual"}),_.jsx(sr,{value:"THIS_SEMESTER",children:"Semestre Atual"}),_.jsx(sr,{value:"THIS_YEAR",children:"Ano Atual"}),_.jsx(sr,{value:"LAST_YEAR_AND_THIS_YEAR",children:"Ano Anterior + Ano Atual"})]})]})]}),_.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-start sm:items-center justify-between",children:[_.jsxs(nE,{children:[_.jsx(aE,{asChild:!0,children:_.jsxs(Nt,{variant:"outline",className:Et("w-full sm:w-[200px] justify-start text-left font-normal",!n&&"text-muted-foreground"),children:[_.jsx(bS,{className:"mr-2 h-4 w-4"}),n?Wt(n,"dd/MM/yyyy"):_.jsx("span",{children:"Data Especfica"})]})}),_.jsx(lw,{className:"w-auto p-0",align:"start",children:_.jsx(Pw,{mode:"single",selected:n,onSelect:N=>{a(N),r({startDate:N})},initialFocus:!0})})]}),_.jsxs(Nt,{variant:"ghost",size:"sm",onClick:()=>{e(),a(void 0)},className:"w-full sm:w-auto",children:[_.jsx(PS,{className:"mr-2 h-4 w-4"}),"Limpar Filtros"]})]}),_.jsxs("div",{className:"flex gap-2 flex-wrap",children:[t.period&&_.jsxs(Ua,{variant:"secondary",children:["Perodo: ",t.period]}),t.search&&_.jsxs(Ua,{variant:"secondary",children:["Busca: ",t.search]}),t.setor&&t.setor.length>0&&_.jsxs(Ua,{variant:"secondary",children:["Setor: ",((y=o.find(N=>{var F;return N.id===((F=t.setor)==null?void 0:F[0])}))==null?void 0:y.name)||"Selecionado"]}),t.resultado&&t.resultado.length>0&&_.jsxs(Ua,{variant:"secondary",children:["Resultado: ",t.resultado[0]]}),t.motivo&&t.motivo.length>0&&_.jsxs(Ua,{variant:"secondary",children:["Motivo: ",((k=l.find(N=>{var F;return N.id===((F=t.motivo)==null?void 0:F[0])}))==null?void 0:k.nome)||"Selecionado"]}),t.cliente&&t.cliente.length>0&&_.jsxs(Ua,{variant:"secondary",children:["Cliente: ",t.cliente[0]]}),t.vendedor&&t.vendedor.length>0&&_.jsxs(Ua,{variant:"secondary",children:["Vendedor: ",t.vendedor[0]]})]})]})}function Qi({title:t,description:r}){const[e,n]=_e.useState(!1),[a,o]=_e.useState(new Date);_e.useEffect(()=>{const c=()=>{n(document.documentElement.classList.contains("dark"))};c();const i=new MutationObserver(c);return i.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>i.disconnect()},[]),_e.useEffect(()=>{const c=setInterval(()=>{o(new Date)},1e3);return()=>clearInterval(c)},[]);const l=(c=>{const u=c.getTime()+c.getTimezoneOffset()*6e4;return new Date(u+-180*6e4)})(a);return _.jsx("div",{className:`w-full rounded-lg p-6 mb-6 ${e?"bg-gradient-to-r from-blue-600/20 to-blue-800/20 border border-blue-500/30":"bg-gradient-to-r from-green-600/10 to-green-700/10 border border-green-500/30"}`,children:_.jsxs("div",{className:"flex items-start justify-between",children:[_.jsxs("div",{className:"flex-1",children:[_.jsx("h1",{className:`text-3xl font-bold tracking-tight mb-2 ${e?"text-blue-100":"text-green-900"}`,children:t}),_.jsx("p",{className:`text-sm ${e?"text-blue-200/80":"text-green-800/80"}`,children:r})]}),_.jsxs("div",{className:`text-right ml-4 ${e?"text-blue-200":"text-green-800"}`,children:[_.jsx("div",{className:"text-sm font-medium",children:Wt(l,"dd/MM/yyyy",{locale:br})}),_.jsxs("div",{className:"text-xs font-mono",children:[Wt(l,"HH:mm:ss",{locale:br})," (BRT)"]})]})]})})}function cN(t,r){let e=0;const n=new Date(t);n.setHours(0,0,0,0);const a=new Date(r);for(a.setHours(0,0,0,0);n<=a;){const o=n.getDay();o!==0&&o!==6&&e++,n.setDate(n.getDate()+1)}return e}function Kf(t){if(!t)return{};const r=new Date;switch(t){case"TODAY":return{startDate:Ki(r),endDate:ap(r)};case"YESTERDAY":const e=_T(r);return{startDate:Ki(e),endDate:ap(e)};case"THIS_WEEK":return{startDate:Ji(r,{weekStartsOn:1}),endDate:kf(r,{weekStartsOn:1})};case"LAST_WEEK":const n=TT(r);return{startDate:Ji(n,{weekStartsOn:1}),endDate:kf(n,{weekStartsOn:1})};case"THIS_MONTH":return{startDate:Bp(r),endDate:Lp(r)};case"LAST_MONTH":const a=ET(r);return{startDate:Bp(a),endDate:Lp(a)};case"THIS_QUARTER":return{startDate:vE(r),endDate:yE(r)};case"THIS_SEMESTER":const o=r.getMonth()<6?new Date(r.getFullYear(),0,1):new Date(r.getFullYear(),6,1),s=r.getMonth()<6?new Date(r.getFullYear(),5,30):new Date(r.getFullYear(),11,31);return{startDate:Ki(o),endDate:ap(s)};case"THIS_YEAR":return{startDate:km(r),endDate:Up(r)};case"LAST_YEAR_AND_THIS_YEAR":const l=r.getFullYear()-1;return{startDate:new Date(l,0,1),endDate:Up(r)};default:return{}}}function uN(t){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style");e.type="text/css",r.appendChild(e),e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}const dN=t=>{switch(t){case"success":return pN;case"info":return gN;case"warning":return mN;case"error":return vN;default:return null}},fN=Array(12).fill(0),hN=({visible:t,className:r})=>Ze.createElement("div",{className:["sonner-loading-wrapper",r].filter(Boolean).join(" "),"data-visible":t},Ze.createElement("div",{className:"sonner-spinner"},fN.map((e,n)=>Ze.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),pN=Ze.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ze.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),mN=Ze.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Ze.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),gN=Ze.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ze.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),vN=Ze.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ze.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),bN=Ze.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Ze.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Ze.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),xN=()=>{const[t,r]=Ze.useState(document.hidden);return Ze.useEffect(()=>{const e=()=>{r(document.hidden)};return document.addEventListener("visibilitychange",e),()=>window.removeEventListener("visibilitychange",e)},[]),t};let Jp=1;class yN{constructor(){this.subscribe=r=>(this.subscribers.push(r),()=>{const e=this.subscribers.indexOf(r);this.subscribers.splice(e,1)}),this.publish=r=>{this.subscribers.forEach(e=>e(r))},this.addToast=r=>{this.publish(r),this.toasts=[...this.toasts,r]},this.create=r=>{var e;const{message:n,...a}=r,o=typeof(r==null?void 0:r.id)=="number"||((e=r.id)==null?void 0:e.length)>0?r.id:Jp++,s=this.toasts.find(c=>c.id===o),l=r.dismissible===void 0?!0:r.dismissible;return this.dismissedToasts.has(o)&&this.dismissedToasts.delete(o),s?this.toasts=this.toasts.map(c=>c.id===o?(this.publish({...c,...r,id:o,title:n}),{...c,...r,id:o,dismissible:l,title:n}):c):this.addToast({title:n,...a,dismissible:l,id:o}),o},this.dismiss=r=>(r?(this.dismissedToasts.add(r),requestAnimationFrame(()=>this.subscribers.forEach(e=>e({id:r,dismiss:!0})))):this.toasts.forEach(e=>{this.subscribers.forEach(n=>n({id:e.id,dismiss:!0}))}),r),this.message=(r,e)=>this.create({...e,message:r}),this.error=(r,e)=>this.create({...e,message:r,type:"error"}),this.success=(r,e)=>this.create({...e,type:"success",message:r}),this.info=(r,e)=>this.create({...e,type:"info",message:r}),this.warning=(r,e)=>this.create({...e,type:"warning",message:r}),this.loading=(r,e)=>this.create({...e,type:"loading",message:r}),this.promise=(r,e)=>{if(!e)return;let n;e.loading!==void 0&&(n=this.create({...e,promise:r,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));const a=Promise.resolve(r instanceof Function?r():r);let o=n!==void 0,s;const l=a.then(async i=>{if(s=["resolve",i],Ze.isValidElement(i))o=!1,this.create({id:n,type:"default",message:i});else if(_N(i)&&!i.ok){o=!1;const p=typeof e.error=="function"?await e.error(`HTTP error! status: ${i.status}`):e.error,f=typeof e.description=="function"?await e.description(`HTTP error! status: ${i.status}`):e.description,v=typeof p=="object"&&!Ze.isValidElement(p)?p:{message:p};this.create({id:n,type:"error",description:f,...v})}else if(i instanceof Error){o=!1;const p=typeof e.error=="function"?await e.error(i):e.error,f=typeof e.description=="function"?await e.description(i):e.description,v=typeof p=="object"&&!Ze.isValidElement(p)?p:{message:p};this.create({id:n,type:"error",description:f,...v})}else if(e.success!==void 0){o=!1;const p=typeof e.success=="function"?await e.success(i):e.success,f=typeof e.description=="function"?await e.description(i):e.description,v=typeof p=="object"&&!Ze.isValidElement(p)?p:{message:p};this.create({id:n,type:"success",description:f,...v})}}).catch(async i=>{if(s=["reject",i],e.error!==void 0){o=!1;const u=typeof e.error=="function"?await e.error(i):e.error,p=typeof e.description=="function"?await e.description(i):e.description,h=typeof u=="object"&&!Ze.isValidElement(u)?u:{message:u};this.create({id:n,type:"error",description:p,...h})}}).finally(()=>{o&&(this.dismiss(n),n=void 0),e.finally==null||e.finally.call(e)}),c=()=>new Promise((i,u)=>l.then(()=>s[0]==="reject"?u(s[1]):i(s[1])).catch(u));return typeof n!="string"&&typeof n!="number"?{unwrap:c}:Object.assign(n,{unwrap:c})},this.custom=(r,e)=>{const n=(e==null?void 0:e.id)||Jp++;return this.create({jsx:r(n),id:n,...e}),n},this.getActiveToasts=()=>this.toasts.filter(r=>!this.dismissedToasts.has(r.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const oa=new yN,wN=(t,r)=>{const e=(r==null?void 0:r.id)||Jp++;return oa.addToast({title:t,...r,id:e}),e},_N=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",SN=wN,kN=()=>oa.toasts,EN=()=>oa.getActiveToasts(),_t=Object.assign(SN,{success:oa.success,info:oa.info,warning:oa.warning,error:oa.error,custom:oa.custom,message:oa.message,promise:oa.promise,dismiss:oa.dismiss,loading:oa.loading},{getHistory:kN,getToasts:EN});uN("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function df(t){return t.label!==void 0}const TN=3,AN="24px",CN="16px",Hx=4e3,NN=356,jN=14,ON=45,DN=200;function xs(...t){return t.filter(Boolean).join(" ")}function RN(t){const[r,e]=t.split("-"),n=[];return r&&n.push(r),e&&n.push(e),n}const MN=t=>{var r,e,n,a,o,s,l,c,i;const{invert:u,toast:p,unstyled:f,interacting:h,setHeights:v,visibleToasts:b,heights:g,index:x,toasts:y,expanded:k,removeToast:N,defaultRichColors:F,closeButton:B,style:W,cancelButtonStyle:V,actionButtonStyle:q,className:X="",descriptionClassName:I="",duration:H,position:O,gap:R,expandByDefault:C,classNames:w,icons:E,closeButtonAriaLabel:A="Close toast"}=t,[T,D]=Ze.useState(null),[U,P]=Ze.useState(null),[K,Y]=Ze.useState(!1),[re,z]=Ze.useState(!1),[ee,L]=Ze.useState(!1),[M,Z]=Ze.useState(!1),[se,ae]=Ze.useState(!1),[ne,Q]=Ze.useState(0),[fe,le]=Ze.useState(0),te=Ze.useRef(p.duration||H||Hx),ce=Ze.useRef(null),he=Ze.useRef(null),Ee=x===0,ke=x+1<=b,Ce=p.type,Fe=p.dismissible!==!1,Pe=p.className||"",Xe=p.descriptionClassName||"",ct=Ze.useMemo(()=>g.findIndex(Se=>Se.toastId===p.id)||0,[g,p.id]),st=Ze.useMemo(()=>{var Se;return(Se=p.closeButton)!=null?Se:B},[p.closeButton,B]),lt=Ze.useMemo(()=>p.duration||H||Hx,[p.duration,H]),tt=Ze.useRef(0),ot=Ze.useRef(0),De=Ze.useRef(0),ht=Ze.useRef(null),[rt,it]=O.split("-"),dt=Ze.useMemo(()=>g.reduce((Se,je,Qe)=>Qe>=ct?Se:Se+je.height,0),[g,ct]),wt=xN(),gt=p.invert||u,vt=Ce==="loading";ot.current=Ze.useMemo(()=>ct*R+dt,[ct,dt]),Ze.useEffect(()=>{te.current=lt},[lt]),Ze.useEffect(()=>{Y(!0)},[]),Ze.useEffect(()=>{const Se=he.current;if(Se){const je=Se.getBoundingClientRect().height;return le(je),v(Qe=>[{toastId:p.id,height:je,position:p.position},...Qe]),()=>v(Qe=>Qe.filter(At=>At.toastId!==p.id))}},[v,p.id]),Ze.useLayoutEffect(()=>{if(!K)return;const Se=he.current,je=Se.style.height;Se.style.height="auto";const Qe=Se.getBoundingClientRect().height;Se.style.height=je,le(Qe),v(At=>At.find(yt=>yt.toastId===p.id)?At.map(yt=>yt.toastId===p.id?{...yt,height:Qe}:yt):[{toastId:p.id,height:Qe,position:p.position},...At])},[K,p.title,p.description,v,p.id,p.jsx,p.action,p.cancel]);const Ve=Ze.useCallback(()=>{z(!0),Q(ot.current),v(Se=>Se.filter(je=>je.toastId!==p.id)),setTimeout(()=>{N(p)},DN)},[p,N,v,ot]);Ze.useEffect(()=>{if(p.promise&&Ce==="loading"||p.duration===1/0||p.type==="loading")return;let Se;return k||h||wt?(()=>{if(De.current<tt.current){const At=new Date().getTime()-tt.current;te.current=te.current-At}De.current=new Date().getTime()})():(()=>{te.current!==1/0&&(tt.current=new Date().getTime(),Se=setTimeout(()=>{p.onAutoClose==null||p.onAutoClose.call(p,p),Ve()},te.current))})(),()=>clearTimeout(Se)},[k,h,p,Ce,wt,Ve]),Ze.useEffect(()=>{p.delete&&(Ve(),p.onDismiss==null||p.onDismiss.call(p,p))},[Ve,p.delete]);function $e(){var Se;if(E!=null&&E.loading){var je;return Ze.createElement("div",{className:xs(w==null?void 0:w.loader,p==null||(je=p.classNames)==null?void 0:je.loader,"sonner-loader"),"data-visible":Ce==="loading"},E.loading)}return Ze.createElement(hN,{className:xs(w==null?void 0:w.loader,p==null||(Se=p.classNames)==null?void 0:Se.loader),visible:Ce==="loading"})}const xt=p.icon||(E==null?void 0:E[Ce])||dN(Ce);var nt,pt;return Ze.createElement("li",{tabIndex:0,ref:he,className:xs(X,Pe,w==null?void 0:w.toast,p==null||(r=p.classNames)==null?void 0:r.toast,w==null?void 0:w.default,w==null?void 0:w[Ce],p==null||(e=p.classNames)==null?void 0:e[Ce]),"data-sonner-toast":"","data-rich-colors":(nt=p.richColors)!=null?nt:F,"data-styled":!(p.jsx||p.unstyled||f),"data-mounted":K,"data-promise":!!p.promise,"data-swiped":se,"data-removed":re,"data-visible":ke,"data-y-position":rt,"data-x-position":it,"data-index":x,"data-front":Ee,"data-swiping":ee,"data-dismissible":Fe,"data-type":Ce,"data-invert":gt,"data-swipe-out":M,"data-swipe-direction":U,"data-expanded":!!(k||C&&K),"data-testid":p.testId,style:{"--index":x,"--toasts-before":x,"--z-index":y.length-x,"--offset":`${re?ne:ot.current}px`,"--initial-height":C?"auto":`${fe}px`,...W,...p.style},onDragEnd:()=>{L(!1),D(null),ht.current=null},onPointerDown:Se=>{Se.button!==2&&(vt||!Fe||(ce.current=new Date,Q(ot.current),Se.target.setPointerCapture(Se.pointerId),Se.target.tagName!=="BUTTON"&&(L(!0),ht.current={x:Se.clientX,y:Se.clientY})))},onPointerUp:()=>{var Se,je,Qe;if(M||!Fe)return;ht.current=null;const At=Number(((Se=he.current)==null?void 0:Se.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Vt=Number(((je=he.current)==null?void 0:je.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),yt=new Date().getTime()-((Qe=ce.current)==null?void 0:Qe.getTime()),Ct=T==="x"?At:Vt,It=Math.abs(Ct)/yt;if(Math.abs(Ct)>=ON||It>.11){Q(ot.current),p.onDismiss==null||p.onDismiss.call(p,p),P(T==="x"?At>0?"right":"left":Vt>0?"down":"up"),Ve(),Z(!0);return}else{var kt,Ne;(kt=he.current)==null||kt.style.setProperty("--swipe-amount-x","0px"),(Ne=he.current)==null||Ne.style.setProperty("--swipe-amount-y","0px")}ae(!1),L(!1),D(null)},onPointerMove:Se=>{var je,Qe,At;if(!ht.current||!Fe||((je=window.getSelection())==null?void 0:je.toString().length)>0)return;const yt=Se.clientY-ht.current.y,Ct=Se.clientX-ht.current.x;var It;const kt=(It=t.swipeDirections)!=null?It:RN(O);!T&&(Math.abs(Ct)>1||Math.abs(yt)>1)&&D(Math.abs(Ct)>Math.abs(yt)?"x":"y");let Ne={x:0,y:0};const Le=at=>1/(1.5+Math.abs(at)/20);if(T==="y"){if(kt.includes("top")||kt.includes("bottom"))if(kt.includes("top")&&yt<0||kt.includes("bottom")&&yt>0)Ne.y=yt;else{const at=yt*Le(yt);Ne.y=Math.abs(at)<Math.abs(yt)?at:yt}}else if(T==="x"&&(kt.includes("left")||kt.includes("right")))if(kt.includes("left")&&Ct<0||kt.includes("right")&&Ct>0)Ne.x=Ct;else{const at=Ct*Le(Ct);Ne.x=Math.abs(at)<Math.abs(Ct)?at:Ct}(Math.abs(Ne.x)>0||Math.abs(Ne.y)>0)&&ae(!0),(Qe=he.current)==null||Qe.style.setProperty("--swipe-amount-x",`${Ne.x}px`),(At=he.current)==null||At.style.setProperty("--swipe-amount-y",`${Ne.y}px`)}},st&&!p.jsx&&Ce!=="loading"?Ze.createElement("button",{"aria-label":A,"data-disabled":vt,"data-close-button":!0,onClick:vt||!Fe?()=>{}:()=>{Ve(),p.onDismiss==null||p.onDismiss.call(p,p)},className:xs(w==null?void 0:w.closeButton,p==null||(n=p.classNames)==null?void 0:n.closeButton)},(pt=E==null?void 0:E.close)!=null?pt:bN):null,(Ce||p.icon||p.promise)&&p.icon!==null&&((E==null?void 0:E[Ce])!==null||p.icon)?Ze.createElement("div",{"data-icon":"",className:xs(w==null?void 0:w.icon,p==null||(a=p.classNames)==null?void 0:a.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||$e():null,p.type!=="loading"?xt:null):null,Ze.createElement("div",{"data-content":"",className:xs(w==null?void 0:w.content,p==null||(o=p.classNames)==null?void 0:o.content)},Ze.createElement("div",{"data-title":"",className:xs(w==null?void 0:w.title,p==null||(s=p.classNames)==null?void 0:s.title)},p.jsx?p.jsx:typeof p.title=="function"?p.title():p.title),p.description?Ze.createElement("div",{"data-description":"",className:xs(I,Xe,w==null?void 0:w.description,p==null||(l=p.classNames)==null?void 0:l.description)},typeof p.description=="function"?p.description():p.description):null),Ze.isValidElement(p.cancel)?p.cancel:p.cancel&&df(p.cancel)?Ze.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||V,onClick:Se=>{df(p.cancel)&&Fe&&(p.cancel.onClick==null||p.cancel.onClick.call(p.cancel,Se),Ve())},className:xs(w==null?void 0:w.cancelButton,p==null||(c=p.classNames)==null?void 0:c.cancelButton)},p.cancel.label):null,Ze.isValidElement(p.action)?p.action:p.action&&df(p.action)?Ze.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||q,onClick:Se=>{df(p.action)&&(p.action.onClick==null||p.action.onClick.call(p.action,Se),!Se.defaultPrevented&&Ve())},className:xs(w==null?void 0:w.actionButton,p==null||(i=p.classNames)==null?void 0:i.actionButton)},p.action.label):null)};function qx(){if(typeof window>"u"||typeof document>"u")return"ltr";const t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function FN(t,r){const e={};return[t,r].forEach((n,a)=>{const o=a===1,s=o?"--mobile-offset":"--offset",l=o?CN:AN;function c(i){["top","right","bottom","left"].forEach(u=>{e[`${s}-${u}`]=typeof i=="number"?`${i}px`:i})}typeof n=="number"||typeof n=="string"?c(n):typeof n=="object"?["top","right","bottom","left"].forEach(i=>{n[i]===void 0?e[`${s}-${i}`]=l:e[`${s}-${i}`]=typeof n[i]=="number"?`${n[i]}px`:n[i]}):c(l)}),e}const IN=Ze.forwardRef(function(r,e){const{id:n,invert:a,position:o="bottom-right",hotkey:s=["altKey","KeyT"],expand:l,closeButton:c,className:i,offset:u,mobileOffset:p,theme:f="light",richColors:h,duration:v,style:b,visibleToasts:g=TN,toastOptions:x,dir:y=qx(),gap:k=jN,icons:N,containerAriaLabel:F="Notifications"}=r,[B,W]=Ze.useState([]),V=Ze.useMemo(()=>n?B.filter(K=>K.toasterId===n):B.filter(K=>!K.toasterId),[B,n]),q=Ze.useMemo(()=>Array.from(new Set([o].concat(V.filter(K=>K.position).map(K=>K.position)))),[V,o]),[X,I]=Ze.useState([]),[H,O]=Ze.useState(!1),[R,C]=Ze.useState(!1),[w,E]=Ze.useState(f!=="system"?f:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),A=Ze.useRef(null),T=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),D=Ze.useRef(null),U=Ze.useRef(!1),P=Ze.useCallback(K=>{W(Y=>{var re;return(re=Y.find(z=>z.id===K.id))!=null&&re.delete||oa.dismiss(K.id),Y.filter(({id:z})=>z!==K.id)})},[]);return Ze.useEffect(()=>oa.subscribe(K=>{if(K.dismiss){requestAnimationFrame(()=>{W(Y=>Y.map(re=>re.id===K.id?{...re,delete:!0}:re))});return}setTimeout(()=>{t8.flushSync(()=>{W(Y=>{const re=Y.findIndex(z=>z.id===K.id);return re!==-1?[...Y.slice(0,re),{...Y[re],...K},...Y.slice(re+1)]:[K,...Y]})})})}),[B]),Ze.useEffect(()=>{if(f!=="system"){E(f);return}if(f==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?E("dark"):E("light")),typeof window>"u")return;const K=window.matchMedia("(prefers-color-scheme: dark)");try{K.addEventListener("change",({matches:Y})=>{E(Y?"dark":"light")})}catch{K.addListener(({matches:re})=>{try{E(re?"dark":"light")}catch(z){console.error(z)}})}},[f]),Ze.useEffect(()=>{B.length<=1&&O(!1)},[B]),Ze.useEffect(()=>{const K=Y=>{var re;if(s.every(L=>Y[L]||Y.code===L)){var ee;O(!0),(ee=A.current)==null||ee.focus()}Y.code==="Escape"&&(document.activeElement===A.current||(re=A.current)!=null&&re.contains(document.activeElement))&&O(!1)};return document.addEventListener("keydown",K),()=>document.removeEventListener("keydown",K)},[s]),Ze.useEffect(()=>{if(A.current)return()=>{D.current&&(D.current.focus({preventScroll:!0}),D.current=null,U.current=!1)}},[A.current]),Ze.createElement("section",{ref:e,"aria-label":`${F} ${T}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},q.map((K,Y)=>{var re;const[z,ee]=K.split("-");return V.length?Ze.createElement("ol",{key:K,dir:y==="auto"?qx():y,tabIndex:-1,ref:A,className:i,"data-sonner-toaster":!0,"data-sonner-theme":w,"data-y-position":z,"data-x-position":ee,style:{"--front-toast-height":`${((re=X[0])==null?void 0:re.height)||0}px`,"--width":`${NN}px`,"--gap":`${k}px`,...b,...FN(u,p)},onBlur:L=>{U.current&&!L.currentTarget.contains(L.relatedTarget)&&(U.current=!1,D.current&&(D.current.focus({preventScroll:!0}),D.current=null))},onFocus:L=>{L.target instanceof HTMLElement&&L.target.dataset.dismissible==="false"||U.current||(U.current=!0,D.current=L.relatedTarget)},onMouseEnter:()=>O(!0),onMouseMove:()=>O(!0),onMouseLeave:()=>{R||O(!1)},onDragEnd:()=>O(!1),onPointerDown:L=>{L.target instanceof HTMLElement&&L.target.dataset.dismissible==="false"||C(!0)},onPointerUp:()=>C(!1)},V.filter(L=>!L.position&&Y===0||L.position===K).map((L,M)=>{var Z,se;return Ze.createElement(MN,{key:L.id,icons:N,index:M,toast:L,defaultRichColors:h,duration:(Z=x==null?void 0:x.duration)!=null?Z:v,className:x==null?void 0:x.className,descriptionClassName:x==null?void 0:x.descriptionClassName,invert:a,visibleToasts:g,closeButton:(se=x==null?void 0:x.closeButton)!=null?se:c,interacting:R,position:K,style:x==null?void 0:x.style,unstyled:x==null?void 0:x.unstyled,classNames:x==null?void 0:x.classNames,cancelButtonStyle:x==null?void 0:x.cancelButtonStyle,actionButtonStyle:x==null?void 0:x.actionButtonStyle,closeButtonAriaLabel:x==null?void 0:x.closeButtonAriaLabel,removeToast:P,toasts:V.filter(ae=>ae.position==L.position),heights:X.filter(ae=>ae.position==L.position),setHeights:I,expandByDefault:l,gap:k,expanded:H,swipeDirections:r.swipeDirections})})):null}))}),PN=["#17432a","#17432a","#17432a","#17432a","#17432a","#17432a"],LN=["#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7"],Js=({x:t,y:r,payload:e})=>{const a=e.value.split(" ");let o=[],s="";return a.forEach(l=>{(s+l).length<=10?s+=`${l} `:(s.trim()&&o.push(s.trim()),s=`${l} `)}),s.trim()&&o.push(s.trim()),_.jsx("g",{transform:`translate(${t},${r})`,children:_.jsx("text",{x:0,y:0,dy:16,textAnchor:"middle",fill:"currentColor",fontSize:10,fontWeight:"bold",children:o.map((l,c)=>_.jsx("tspan",{x:"0",dy:c===0?0:14,children:l},c))})})};function BN(){const{filters:t}=ec(),{user:r}=Dn(),[e,n]=_e.useState(!0),[a,o]=_e.useState({totalValue:0,totalReturns:0,avgTicket:0,slaBreach:0,totalProducts:0}),[s,l]=_e.useState(0),[c,i]=_e.useState([]),[u,p]=_e.useState([]),[f,h]=_e.useState([]),[v,b]=_e.useState([]),[g,x]=_e.useState([]),[y,k]=_e.useState([]),[N,F]=_e.useState([]),[B,W]=_e.useState([]),[V,q]=_e.useState([]),[X,I]=_e.useState(!1),[H,O]=_e.useState([]),[R,C]=_e.useState([]),[w,E]=_e.useState([]),[A,T]=_e.useState([]),[D,U]=_e.useState([]),[P,K]=_e.useState([]);_e.useEffect(()=>{const M=()=>{I(document.documentElement.classList.contains("dark"))};M();const Z=new MutationObserver(M);return Z.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>Z.disconnect()},[]);const Y=X?LN:PN;_e.useEffect(()=>{re()},[t,r]);const re=async()=>{try{n(!0);const M=(r==null?void 0:r.role)==="VENDEDOR"?r.vendedor:null;let Z=St.from("devolucoes").select(`
          *,
          motivos_devolucao(nome),
          setores(nome),
          itens:itens_devolucao(quantidade, descricao, motivo_id, valor_total_bruto, unidade)
      `);r&&r.role==="VENDEDOR"&&M&&(Z=Z.eq("vendedor",M),console.log(" Dashboard - Filtrando por vendedor:",M));const se=t.period&&!t.startDate&&!t.endDate?Kf(t.period):{},ae=t.startDate||se.startDate,ne=t.endDate||se.endDate;Z=Z.in("resultado",["PENDENTE VALIDAO","TRATATIVA DE ANULAO","VALIDADA"]),t.search&&(Z=Z.or(`nome_cliente.ilike.%${t.search}%,vendedor.ilike.%${t.search}%,numero.ilike.%${t.search}%`)),t.motivo&&t.motivo.length>0&&(Z=Z.in("motivo_id",t.motivo)),t.cliente&&t.cliente.length>0&&(Z=Z.in("nome_cliente",t.cliente)),t.vendedor&&t.vendedor.length>0&&(Z=Z.in("vendedor",t.vendedor)),t.setor&&t.setor.length>0&&(Z=Z.in("setor_id",t.setor)),ae&&(Z=Z.gte("data_emissao",ae.toISOString().split("T")[0])),ne&&(Z=Z.lte("data_emissao",ne.toISOString().split("T")[0]));const{data:Q,error:fe}=await Z;if(fe){console.error(" Erro ao buscar dados do Dashboard:",fe),_t.error("Erro ao carregar dados do Dashboard: "+fe.message),n(!1);return}if(!Q||Q.length===0){console.log(" Nenhuma devoluo encontrada para os filtros selecionados"),o({totalValue:0,totalReturns:0,avgTicket:0,slaBreach:0,totalProducts:0}),l(0),i([]),p([]),h([]),b([]),k([]),F([]),W([]),q([]),x([]),T([]),O([]),C([]),E([]),n(!1);return}if(Q){console.log(` Dashboard: ${Q.length} devolues carregadas`);const le=Q.reduce((be,Te)=>be+(Number(Te.valor_total_nota)||0),0),te=Q.length,ce=te>0?le/te:0,he=Q.reduce((be,Te)=>{const Ge=Te.itens||[];return be+Ge.reduce((ue,Ae)=>ue+(Number(Ae.quantidade)||0),0)},0),Ee=Q.filter(be=>be.prazo==="EM ATRASO").length,ke=Q.filter(be=>be.resultado==="PENDENTE VALIDAO"||be.resultado==="TRATATIVA DE ANULAO").reduce((be,Te)=>be+(Number(Te.valor_total_nota)||0),0);o({totalValue:le,totalReturns:te,avgTicket:ce,slaBreach:Ee,totalProducts:he}),l(ke);const Ce=Q.reduce((be,Te)=>{const Ge=new Date(Te.data_emissao||Te.created_at),ue=Wt(Ge,"dd/MM",{locale:br});return be[ue]||(be[ue]={value:0,count:0}),be[ue].value+=Number(Te.valor_total_nota)||0,be[ue].count+=1,be},{}),Fe=Object.keys(Ce).sort((be,Te)=>{const Ge=new Date(be.split("/").reverse().join("-")),ue=new Date(Te.split("/").reverse().join("-"));return Ge.getTime()-ue.getTime()}).map(be=>({name:be,value:Ce[be].value,count:Ce[be].count}));i(Fe);const Pe={};Q.forEach(be=>{const Te=be.nome_cliente||"Desconhecido",Ge=Number(be.valor_total_nota)||0;Pe[Te]||(Pe[Te]={valor:0,detalhes:[]}),Pe[Te].valor+=Ge,Pe[Te].detalhes.push({cliente:Te,nota:be.numero||"-"})});const Xe=Object.entries(Pe).map(([be,Te])=>({name:be,value:Te.valor,quantidade:Te.detalhes.length,detalhes:Te.detalhes})).sort((be,Te)=>Te.value-be.value).slice(0,10);p(Xe);const ct={};Q.forEach(be=>{const Te=be.vendedor||"Desconhecido",Ge=Number(be.valor_total_nota)||0;ct[Te]||(ct[Te]={valor:0,detalhes:[]}),ct[Te].valor+=Ge,ct[Te].detalhes.push({cliente:be.nome_cliente||"Desconhecido",nota:be.numero||"-"})});const st=Object.entries(ct).map(([be,Te])=>({name:be,value:Te.valor,quantidade:Te.detalhes.length,detalhes:Te.detalhes})).sort((be,Te)=>Te.value-be.value).slice(0,5);h(st);const lt={};Q.forEach(be=>{let Te=be.rede||"Sem rede";Te==="Sem rede"&&be.cnpj_destinatario&&(Te=be.rede||"Sem rede");const Ge=Number(be.valor_total_nota)||0;lt[Te]||(lt[Te]={valor:0,detalhes:[]}),lt[Te].valor+=Ge,lt[Te].detalhes.push({cliente:be.nome_cliente||"Desconhecido",nota:be.numero||"-"})});const tt=Object.entries(lt).map(([be,Te])=>({name:be,value:Te.valor,quantidade:Te.detalhes.length,detalhes:Te.detalhes})).sort((be,Te)=>Te.value-be.value).slice(0,5);b(tt);const ot=Object.entries(Pe).map(([be,Te])=>({name:be,value:Te.valor,detalhes:Te.detalhes})).sort((be,Te)=>Te.value-be.value);let De=0;const ht=ot.reduce((be,Te)=>be+Te.value,0),rt=ot.map((be,Te)=>(De+=be.value,{name:be.name.length>15?be.name.substring(0,15)+"...":be.name,value:be.value,cumulative:De,percentage:De/ht*100,index:Te+1,quantidade:be.detalhes.length,detalhes:be.detalhes})).slice(0,10);k(rt);const it=Q.filter(be=>be.resultado==="PENDENTE VALIDAO"),dt={};it.forEach(be=>{const Te=be.itens||[],Ge=be.rede||"Sem rede";Te.forEach(ue=>{const xe=(ue.descricao||"Desconhecido").split(" ").slice(0,2).join(" ");dt[xe]||(dt[xe]={});const We=Number(ue.quantidade)||0,qe=ue.unidade||"UN";dt[xe][Ge]||(dt[xe][Ge]={quantidade:0,unidade:qe}),dt[xe][Ge].quantidade+=We})});const wt=Object.keys(dt),gt=new Set;it.forEach(be=>{const Te=be.rede||"Sem rede";gt.add(Te)});const vt=Array.from(gt).slice(0,8),Ve=wt.map(be=>{const Te={produto:be};return vt.forEach(Ge=>{var Ae;const ue=(Ae=dt[be])==null?void 0:Ae[Ge];Te[Ge]=ue||{quantidade:0,unidade:"UN"}}),Te});F(Ve);const $e=Q.reduce((be,Te)=>{const Ge=Te.motivos_devolucao,ue=typeof Ge=="object"&&(Ge!=null&&Ge.nome)?Ge.nome:typeof Ge=="string"?Ge:null;return ue&&ue!=="No informado"&&ue!=="no informado"&&ue!=="NO INFORMADO"&&(be[ue]=(be[ue]||0)+1),be},{}),xt=Object.entries($e).map(([be,Te])=>({name:be,value:Te})).sort((be,Te)=>Te.value-be.value).slice(0,5);console.log(" Reasons Chart:",xt),x(xt);const nt=Q.reduce((be,Te)=>{const Ge=Te.cidade_origem||"N/A";return be[Ge]=(be[Ge]||0)+(Number(Te.valor_total_nota)||0),be},{}),pt=Object.entries(nt).map(([be,Te])=>({name:be,value:Te})).sort((be,Te)=>Te.value-be.value).slice(0,6);console.log(" Municpio Chart:",pt),T(pt);const Se={};Q.filter(be=>be.resultado==="TRATATIVA DE ANULAO").forEach(be=>{const Te=new Date(be.data_emissao||be.created_at),Ge=Wt(Te,"dd/MM",{locale:br});Se[Ge]||(Se[Ge]=[]),Se[Ge].push({cliente:be.nome_cliente||"Desconhecido",nota:be.numero||"-"})});const je=Object.keys(Se).sort((be,Te)=>{const Ge=new Date(be.split("/").reverse().join("-")),ue=new Date(Te.split("/").reverse().join("-"));return Ge.getTime()-ue.getTime()}).map(be=>({name:be,quantidade:Se[be].length,detalhes:Se[be]}));O(je);const Qe={};Q.filter(be=>be.resultado==="ANULADA/CANCELADA").forEach(be=>{const Te=new Date(be.data_emissao||be.created_at),Ge=Wt(Te,"dd/MM",{locale:br});Qe[Ge]||(Qe[Ge]=[]),Qe[Ge].push({cliente:be.nome_cliente||"Desconhecido",nota:be.numero||"-"})});const At=Object.keys(Qe).sort((be,Te)=>{const Ge=new Date(be.split("/").reverse().join("-")),ue=new Date(Te.split("/").reverse().join("-"));return Ge.getTime()-ue.getTime()}).map(be=>({name:be,quantidade:Qe[be].length,detalhes:Qe[be]}));C(At);const Vt=be=>{if(!be)return null;const Te=be.toUpperCase().trim();return["CX","CX1","CXI","CX10","CXS","FD"].includes(Te)?"CX":["UN","UND","UN1","UNID","BD","BDJ","KG","KG1","KGS","PTC","PT","PT1","PC","PC1","SC","SC1"].includes(Te)?"UN":null},yt={},Ct={};Q.forEach(be=>{(be.itens||[]).forEach(Ge=>{const ue=Ge.descricao||"Desconhecido",Ae=Number(Ge.quantidade)||0,pe=Ge.unidade||"",xe=Vt(pe);xe==="CX"?(yt[ue]||(yt[ue]={quantidade:0,unidade:pe}),yt[ue].quantidade+=Ae):xe==="UN"&&(Ct[ue]||(Ct[ue]={quantidade:0,unidade:pe}),Ct[ue].quantidade+=Ae)})});const It=Object.entries(yt).map(([be,Te])=>({name:be.split(" ").slice(0,2).join(" "),nameFull:be,quantidade:Te.quantidade,unidade:Te.unidade,tipo:"CX"})).sort((be,Te)=>Te.quantidade-be.quantidade).slice(0,5),kt=Object.entries(Ct).map(([be,Te])=>({name:be.split(" ").slice(0,2).join(" "),nameFull:be,quantidade:Te.quantidade,unidade:Te.unidade,tipo:"UN"})).sort((be,Te)=>Te.quantidade-be.quantidade).slice(0,5),Ne=[...It,...kt];console.log(" Top Produtos:",Ne),E(Ne);const Le={};Q.filter(be=>be.resultado==="TRATATIVA DE ANULAO"||be.resultado==="ANULADA/CANCELADA").forEach(be=>{const Te=be.nome_cliente||"Desconhecido";Le[Te]||(Le[Te]={count:0,detalhes:[]}),Le[Te].count+=1,Le[Te].detalhes.push({cliente:Te,nota:be.numero||"-"})});const at=Object.entries(Le).map(([be,Te])=>({name:be,count:Te.count,quantidade:Te.detalhes.length,detalhes:Te.detalhes})).sort((be,Te)=>Te.count-be.count).slice(0,5);U(at);const ie={};Q.forEach(be=>{var ue;const Te=be.rede||"Sem rede",Ge=(ue=be.motivos_devolucao)==null?void 0:ue.nome;!Ge||Ge==="No informado"||Ge==="no informado"||Ge==="NO INFORMADO"||(ie[Te]||(ie[Te]={}),ie[Te][Ge]||(ie[Te][Ge]={count:0,detalhes:[]}),ie[Te][Ge].count+=1,ie[Te][Ge].detalhes.push({cliente:be.nome_cliente||"Desconhecido",nota:be.numero||"-"}))});const we=[];Object.entries(ie).sort((be,Te)=>{const Ge=Object.values(be[1]).reduce((Ae,pe)=>Ae+pe.count,0);return Object.values(Te[1]).reduce((Ae,pe)=>Ae+pe.count,0)-Ge}).slice(0,5).forEach(([be,Te])=>{const Ge=Object.entries(Te).sort((ue,Ae)=>Ae[1].count-ue[1].count)[0];Ge&&we.push({rede:be.length>15?be.substring(0,15)+"...":be,motivo:Ge[0].length>20?Ge[0].substring(0,20)+"...":Ge[0],count:Ge[1].count,quantidade:Ge[1].detalhes.length,detalhes:Ge[1].detalhes})}),K(we);const de=[];if(te>0&&de.push(` Total de ${te} devoluo(es) no perodo selecionado, totalizando R$ ${le.toLocaleString("pt-BR",{minimumFractionDigits:2})}.`),Xe.length>0&&le>0){const be=Xe[0].value/le*100;be>20&&de.push(` Cliente "${Xe[0].name}" concentra ${be.toFixed(1)}% do valor total de devolues.`)}if(he>0&&te>0){const be=he/te;de.push(` Mdia de ${be.toFixed(1)} produtos por devoluo.`)}if(st.length>0&&de.push(` Vendedor "${st[0].name}" lidera em devolues com R$ ${st[0].value.toLocaleString("pt-BR")}.`),rt.length>0){const be=rt.findIndex(Te=>Te.percentage>=80);be>=0&&be<5&&de.push(` Regra 80/20: ${be+1} clientes concentram 80% do valor de devolues.`)}if(Ne.length>0){const be=Ne[0];de.push(` Produto "${be.name}"  o mais devolvido com ${be.quantidade} unidades.`)}const ge=Q.filter(be=>be.resultado==="TRATATIVA DE ANULAO"||be.resultado==="ANULADA/CANCELADA").length,ve=te>0?ge/te*100:0;if(ve>10?de.push(` Taxa de cancelamento alta: ${ve.toFixed(1)}% das devolues esto em cancelamento.`):ge>0&&de.push(` ${ge} devoluo(es) em processo de cancelamento.`),xt.length>0){const be=xt[0];de.push(` Motivo mais frequente: "${be.name}" com ${be.value} ocorrncia(s).`)}if(ce>0){const be=Q.filter(Te=>Number(Te.valor_total_nota)>ce*1.5).length;be>0&&de.push(` ${be} devoluo(es) com valor acima de 150% do ticket mdio.`)}if(tt.length>0&&le>0){const be=tt[0].value/le*100;be>15&&de.push(` Rede "${tt[0].name}" representa ${be.toFixed(1)}% do valor devolvido.`)}if(Fe.length>=2){const be=Fe[Fe.length-1].value,Te=Fe[Fe.length-2].value;if(Te>0){const Ge=(be-Te)/Te*100;if(Math.abs(Ge)>20){const ue=Ge>0?"aumento":"reduo";de.push(` ${ue.charAt(0).toUpperCase()+ue.slice(1)} de ${Math.abs(Ge).toFixed(1)}% no valor devolvido comparado ao perodo anterior.`)}}}console.log(" Insights:",de),W(de);const ye=[],Me=Q.filter(be=>be.prazo==="EM ATRASO");if(Me.length>0){const be=Me.reduce((Te,Ge)=>Te+(Number(Ge.valor_total_nota)||0),0);ye.push({type:"warning",message:`${Me.length} nota(s) em atraso`,count:Me.length,total:Me.length,value:be})}te>50&&ye.push({type:"info",message:`Total de ${te} notas no perodo (acima de 50)`,count:te,total:te});const Ue=Q.filter(be=>be.resultado==="PENDENTE VALIDAO");if(Ue.length>20){const be=Ue.reduce((Te,Ge)=>Te+(Number(Ge.valor_total_nota)||0),0);ye.push({type:"warning",message:`${Ue.length} nota(s) pendentes de validao (acima de 20)`,count:Ue.length,total:Ue.length,value:be})}const Re=Q.filter(be=>Number(be.valor_total_nota)>1e3);if(Re.length>0){const be=Re.reduce((Te,Ge)=>Te+(Number(Ge.valor_total_nota)||0),0);ye.push({type:"warning",message:`${Re.length} nota(s) com valor acima de R$ 1.000,00`,count:Re.length,total:Re.length,value:be})}const Be={};Ue.forEach(be=>{const Te=be.nome_cliente||"Desconhecido";Be[Te]||(Be[Te]=[]),Be[Te].push(be)}),Object.entries(Be).forEach(([be,Te])=>{if(Te.length>5){const Ge=Te.reduce((ue,Ae)=>ue+(Number(Ae.valor_total_nota)||0),0);ye.push({type:"error",message:`Cliente "${be}" tem ${Te.length} notas pendentes de validao`,cliente:be,count:Te.length,total:Te.length,value:Ge})}});const ze=Q.filter(be=>be.resultado==="TRATATIVA DE ANULAO");if(ze.length>0){const be=ze.reduce((Te,Ge)=>Te+(Number(Ge.valor_total_nota)||0),0);ye.push({type:"error",message:`${ze.length} nota(s) em tratativa de anulao`,detalhes:ze.map(Te=>`NF ${Te.numero} - ${Te.nome_cliente||"Sem cliente"} - R$ ${(Number(Te.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`),count:ze.length,total:ze.length,value:be})}q(ye)}}catch(M){console.error(" Erro ao processar dados do Dashboard:",M),_t.error("Erro ao processar dados: "+(M.message||"Erro desconhecido"))}finally{n(!1)}},z=({value:M})=>{const Q=-90+Math.min(M/4e4,1)*180,le=M<1e4?{color:"#10b981",label:"Normal",icon:"",bg:"bg-green-50"}:M<2e4?{color:"#f59e0b",label:"Ateno",icon:"",bg:"bg-yellow-50"}:{color:"#ef4444",label:"Crtico",icon:"",bg:"bg-red-50"};return _.jsxs("div",{className:"w-full max-w-sm mx-auto",children:[_.jsx("div",{className:"relative w-full",style:{paddingBottom:"50%"},children:_.jsxs("svg",{viewBox:"0 0 200 120",className:"absolute inset-0 w-full h-full",children:[_.jsx("path",{d:"M 20 100 A 80 80 0 0 1 65 35",fill:"none",stroke:"#10b981",strokeWidth:"20",strokeLinecap:"round"}),_.jsx("path",{d:"M 65 35 A 80 80 0 0 1 135 35",fill:"none",stroke:"#f59e0b",strokeWidth:"20",strokeLinecap:"round"}),_.jsx("path",{d:"M 135 35 A 80 80 0 0 1 180 100",fill:"none",stroke:"#ef4444",strokeWidth:"20",strokeLinecap:"round"}),[{val:0,angle:-90,label:"15k"},{val:1e4,angle:-45,label:"20k"},{val:15e3,angle:-22.5,label:"25k"},{val:2e4,angle:0,label:"35k"},{val:4e4,angle:90,label:"40k"}].map((te,ce)=>{const he=te.angle*Math.PI/180,Ee=100+70*Math.cos(he),ke=100+70*Math.sin(he),Ce=100+85*Math.cos(he),Fe=100+85*Math.sin(he),Pe=100+98*Math.cos(he),Xe=100+98*Math.sin(he);return _.jsxs("g",{children:[_.jsx("line",{x1:Ee,y1:ke,x2:Ce,y2:Fe,stroke:"#374151",strokeWidth:"3"}),_.jsx("text",{x:Pe,y:Xe,textAnchor:"middle",dominantBaseline:"middle",className:"text-[9px] fill-gray-700 font-bold",children:te.label})]},ce)}),[5e3,12500,17500,25e3,3e4,35e3].map((te,ce)=>{const ke=(-90+te/4e4*180)*Math.PI/180,Ce=100+75*Math.cos(ke),Fe=100+75*Math.sin(ke),Pe=100+85*Math.cos(ke),Xe=100+85*Math.sin(ke);return _.jsx("line",{x1:Ce,y1:Fe,x2:Pe,y2:Xe,stroke:"#9ca3af",strokeWidth:"1.5"},`minor-${ce}`)}),_.jsxs("g",{transform:`rotate(${Q} 100 100)`,children:[_.jsx("path",{d:"M 100 100 L 96 94 L 98 25 L 100 20 L 102 25 L 104 94 Z",fill:"rgba(0,0,0,0.15)",transform:"translate(2, 2)"}),_.jsx("path",{d:"M 100 100 L 96 94 L 98 25 L 100 20 L 102 25 L 104 94 Z",fill:le.color,stroke:"#fff",strokeWidth:"1.5"}),_.jsx("path",{d:"M 100 20 L 99 25 L 99 70 L 100 70 Z",fill:"rgba(255,255,255,0.3)"})]}),_.jsx("circle",{cx:"101",cy:"101",r:"10",fill:"rgba(0,0,0,0.1)"}),_.jsx("circle",{cx:"100",cy:"100",r:"10",fill:"#fff",stroke:le.color,strokeWidth:"3"}),_.jsx("circle",{cx:"100",cy:"100",r:"5",fill:le.color}),_.jsx("circle",{cx:"98",cy:"98",r:"2",fill:"rgba(255,255,255,0.6)"})]})}),_.jsxs("div",{className:"mt-6 space-y-3",children:[_.jsx("div",{className:`${le.bg} rounded-xl p-5 border-2 shadow-lg`,style:{borderColor:le.color},children:_.jsxs("div",{className:"text-center",children:[_.jsx("div",{className:"text-xs text-gray-600 font-medium mb-1",children:"VALOR TOTAL"}),_.jsxs("div",{className:"text-4xl font-bold tracking-tight",style:{color:le.color},children:["R$ ",M.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),_.jsxs("div",{className:"flex items-center justify-center gap-2 mt-3",children:[_.jsx("span",{className:"text-2xl",children:le.icon}),_.jsx("span",{className:"text-xl font-bold uppercase tracking-wide",style:{color:le.color},children:le.label})]})]})}),_.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[_.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg border-2 border-green-200",children:[_.jsx("div",{className:"font-bold text-green-700 mb-1",children:" Normal"}),_.jsx("div",{className:"text-green-600 font-semibold",children:"0 - 10k"})]}),_.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg border-2 border-yellow-200",children:[_.jsx("div",{className:"font-bold text-yellow-700 mb-1",children:" Ateno"}),_.jsx("div",{className:"text-yellow-600 font-semibold",children:"10k - 20k"})]}),_.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg border-2 border-red-200",children:[_.jsx("div",{className:"font-bold text-red-700 mb-1",children:" Crtico"}),_.jsx("div",{className:"text-red-600 font-semibold",children:"20k - 40k"})]})]})]})]})},ee=({alert:M})=>{const[Z,se]=_e.useState(!1),ne={error:{bg:"bg-gradient-to-r from-red-50 to-red-100/50 dark:from-red-950/20 dark:to-red-900/10",border:"border-red-300 dark:border-red-800/50",iconBg:"bg-red-500",textColor:"text-red-800 dark:text-red-300",icon:Ao,badge:"bg-red-500 text-white"},warning:{bg:"bg-gradient-to-r from-amber-50 to-amber-100/50 dark:from-amber-950/20 dark:to-amber-900/10",border:"border-amber-300 dark:border-amber-800/50",iconBg:"bg-amber-500",textColor:"text-amber-800 dark:text-amber-300",icon:Ml,badge:"bg-amber-500 text-white"},info:{bg:"bg-gradient-to-r from-blue-50 to-blue-100/50 dark:from-blue-950/20 dark:to-blue-900/10",border:"border-blue-300 dark:border-blue-800/50",iconBg:"bg-blue-500",textColor:"text-blue-800 dark:text-blue-300",icon:Qb,badge:"bg-blue-500 text-white"}}[M.type],Q=ne.icon,le=M.detalhes&&M.detalhes.length>0&&M.message.includes("tratativa de anulao");return _.jsx("div",{className:`${ne.bg} rounded-xl border-2 ${ne.border} shadow-sm hover:shadow-md transition-all duration-200`,children:_.jsx("div",{className:"p-4",children:_.jsxs("div",{className:"flex items-start gap-3",children:[_.jsx("div",{className:`${ne.iconBg} rounded-lg p-2 shadow-lg flex-shrink-0`,children:_.jsx(Q,{className:"h-5 w-5 text-white"})}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsxs("div",{className:"flex items-start justify-between gap-2",children:[_.jsx("p",{className:`font-semibold text-sm leading-relaxed ${ne.textColor}`,children:M.message}),M.count&&_.jsx("span",{className:`${ne.badge} px-2.5 py-1 rounded-full text-xs font-bold flex-shrink-0 shadow-sm`,children:M.count})]}),M.value!==void 0&&_.jsx("div",{className:"mt-2 flex items-baseline gap-2",children:_.jsxs("span",{className:`text-2xl font-bold ${ne.textColor}`,children:["R$ ",M.value.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),le&&_.jsxs("div",{className:"mt-3",children:[_.jsx("button",{onClick:()=>se(!Z),className:`flex items-center gap-1 text-xs font-semibold ${ne.textColor} hover:underline`,children:Z?_.jsxs(_.Fragment,{children:[_.jsx(Fy,{className:"h-3 w-3"}),"Ocultar detalhes"]}):_.jsxs(_.Fragment,{children:[_.jsx(Uu,{className:"h-3 w-3"}),"Ver ",M.total," itens"]})}),Z&&_.jsxs("div",{className:"mt-2 space-y-1 pl-4 border-l-2 border-current/20",children:[M.detalhes.slice(0,5).map((te,ce)=>_.jsxs("div",{className:`text-xs ${ne.textColor} opacity-90 flex items-start gap-2`,children:[_.jsx("span",{className:"mt-1",children:""}),_.jsx("span",{children:te})]},ce)),M.total>5&&_.jsxs("div",{className:`text-xs font-semibold ${ne.textColor} mt-2`,children:["... e mais ",M.total-5," itens"]})]})]})]})]})})})},L=({active:M,payload:Z})=>{if(!M||!(Z!=null&&Z.length))return null;const se=Z[0].payload,ae=se.quantidade||se.count||se.value||0,ne=se.detalhes||[],Q=ne&&ne.length>0;return _.jsxs("div",{className:"bg-card border border-border rounded-md p-3 shadow-md",children:[_.jsx("p",{className:"text-sm font-bold text-foreground mb-1",children:"Detalhes"}),se.value&&typeof se.value=="number"&&se.value>1e3?_.jsxs("p",{className:"text-sm font-bold text-primary",children:["R$ ",se.value.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}):_.jsxs("p",{className:"text-sm font-bold text-primary",children:[ae," ",se.count!==void 0?"nota(s)":se.value!==void 0?"ocorrncia(s)":"item(s)"]}),Q&&_.jsx("div",{className:"mt-2 space-y-1 max-h-[200px] overflow-y-auto",children:ne.map((fe,le)=>_.jsxs("p",{className:"text-xs text-muted-foreground",children:[_.jsx("span",{className:"font-medium text-foreground",children:fe.cliente}),_.jsx("span",{className:"mx-1",children:""}),_.jsxs("span",{className:"text-primary",children:["NF: ",fe.nota]})]},le))})]})};return e?_.jsx("div",{className:"flex items-center justify-center min-h-screen",children:_.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"})}):_.jsxs("div",{className:"space-y-6",children:[_.jsx(Qi,{title:"Dashboard Pendncias",description:"Viso geral das devolues pendentes (Pendente Validao, Tratativa de Anulao e Validadas) com KPIs, grficos e insights automticos para anlise estratgica."}),_.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[_.jsx(Xf,{}),_.jsxs(Nt,{variant:"outline",size:"sm",onClick:re,className:"w-full md:w-auto shrink-0",children:[_.jsx(vm,{className:"mr-2 h-4 w-4"}),"Atualizar"]})]}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[V.length>0&&_.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl border-2 border-gray-200 dark:border-gray-700 shadow-lg",children:[_.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-white dark:from-gray-800 dark:to-gray-900 p-6 border-b-2 border-gray-200 dark:border-gray-700",children:_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"bg-gradient-to-br from-orange-500 to-red-500 rounded-xl p-3 shadow-lg",children:_.jsx(Ml,{className:"h-6 w-6 text-white"})}),_.jsxs("div",{children:[_.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-gray-200",children:"Central de Alertas"}),_.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Monitoramento de devolues e pendncias"})]})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[V.filter(M=>M.type==="error").length>0&&_.jsxs("div",{className:"flex items-center gap-1.5 bg-red-100 dark:bg-red-900/30 px-3 py-1.5 rounded-full border border-red-300 dark:border-red-700",children:[_.jsx(Ao,{className:"h-4 w-4 text-red-600 dark:text-red-400"}),_.jsx("span",{className:"text-sm font-bold text-red-700 dark:text-red-300",children:V.filter(M=>M.type==="error").length})]}),V.filter(M=>M.type==="warning").length>0&&_.jsxs("div",{className:"flex items-center gap-1.5 bg-amber-100 dark:bg-amber-900/30 px-3 py-1.5 rounded-full border border-amber-300 dark:border-amber-700",children:[_.jsx(Ml,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}),_.jsx("span",{className:"text-sm font-bold text-amber-700 dark:text-amber-300",children:V.filter(M=>M.type==="warning").length})]}),V.filter(M=>M.type==="info").length>0&&_.jsxs("div",{className:"flex items-center gap-1.5 bg-blue-100 dark:bg-blue-900/30 px-3 py-1.5 rounded-full border border-blue-300 dark:border-blue-700",children:[_.jsx(Qb,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),_.jsx("span",{className:"text-sm font-bold text-blue-700 dark:text-blue-300",children:V.filter(M=>M.type==="info").length})]})]})]})}),_.jsx("div",{className:"p-6",children:_.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:V.map((M,Z)=>_.jsx(ee,{alert:M},Z))})}),_.jsx("style",{children:`
              .custom-scrollbar::-webkit-scrollbar {
                width: 8px;
              }
              .custom-scrollbar::-webkit-scrollbar-track {
                background: #f1f5f9;
                border-radius: 10px;
              }
              .custom-scrollbar::-webkit-scrollbar-thumb {
                background: #cbd5e1;
                border-radius: 10px;
              }
              .custom-scrollbar::-webkit-scrollbar-thumb:hover {
                background: #94a3b8;
              }
            `})]}),_.jsxs(jt,{className:"border-2",children:[_.jsxs(Dt,{className:"pb-3",children:[_.jsx(Rt,{className:"text-center text-sm font-semibold",children:"Status de Validao"}),_.jsx(Or,{className:"text-center text-xs",children:"Valor total de notas pendentes e em tratativa de anulao"})]}),_.jsx(Ot,{className:"pt-0",children:_.jsx(z,{value:s})})]})]}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[_.jsx(Ba,{title:"Valor Total Devolvido",value:`R$ ${a.totalValue.toLocaleString("pt-BR",{maximumFractionDigits:0})}`,icon:Dp,trend:"up",trendValue:"vs perodo anterior"}),_.jsx(Ba,{title:"Total de Devolues",value:a.totalReturns,icon:Py,description:"Neste perodo"}),_.jsx(Ba,{title:"Produtos Devolvidos",value:a.totalProducts.toFixed(2),icon:Ul,description:"Quantidade total"}),_.jsx(Ba,{title:"Ticket Mdio",value:`R$ ${a.avgTicket.toLocaleString("pt-BR",{maximumFractionDigits:0})}`,icon:_u}),_.jsx(Ba,{title:"Fora do SLA",value:a.slaBreach,icon:Ml,description:"Devolues atrasadas",trend:"down",trendValue:"0"})]}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[_.jsxs(jt,{className:"col-span-4",children:[_.jsx(Dt,{children:_.jsx(Rt,{children:"Evoluo no Tempo"})}),_.jsx(Ot,{className:"pl-2",children:_.jsx(Jr,{width:"100%",height:350,children:_.jsxs(xy,{data:c,children:[_.jsx("defs",{children:_.jsxs("linearGradient",{id:"colorValue",x1:"0",y1:"0",x2:"0",y2:"1",children:[_.jsx("stop",{offset:"5%",stopColor:Y[0],stopOpacity:.8}),_.jsx("stop",{offset:"95%",stopColor:Y[0],stopOpacity:0})]})}),_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",height:60,tick:_.jsx(Js,{})}),_.jsx($r,{className:"text-[6px] font-size-6px font-bold",tickFormatter:M=>`R$${M}`}),_.jsx(Qr,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)",color:"var(--foreground)",fontSize:"11px",fontWeight:"bold"},formatter:(M,Z)=>Z==="value"?[`R$ ${(M||0).toFixed(2)}`,"Valor Total"]:Z==="count"?[`${M||0}`,"Qtd de Notas"]:[M,Z||""],labelFormatter:M=>`Data: ${M}`}),_.jsx(yy,{type:"monotone",dataKey:"value",stroke:Y[0],fillOpacity:1,fill:"url(#colorValue)"}),_.jsx(Xl,{type:"monotone",dataKey:"count",stroke:Y[1],strokeWidth:2,dot:{fill:Y[1],r:4}})]})})})]}),_.jsxs(jt,{className:"col-span-4",children:[_.jsx(Dt,{children:_.jsx(Rt,{children:"Top Clientes (Valor)"})}),_.jsx(Ot,{children:_.jsx(Jr,{width:"100%",height:350,children:_.jsxs(Xn,{data:u,children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",height:60,tick:_.jsx(Js,{})}),_.jsx($r,{className:"text-[6px] font-bold",tickFormatter:M=>`R$${M}`}),_.jsx(Qr,{content:_.jsx(L,{})}),_.jsx(jn,{dataKey:"value",fill:Y[0],radius:[8,8,0,0],children:_.jsx(Pn,{dataKey:"value",position:"top",content:({value:M})=>_.jsx("text",{x:0,y:0,dy:-5,fill:X?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(M||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]})]}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[_.jsxs(jt,{children:[_.jsx(Dt,{children:_.jsx(Rt,{children:"Top Vendedores (Valor)"})}),_.jsx(Ot,{children:_.jsx(Jr,{width:"100%",height:300,children:_.jsxs(Xn,{data:f,children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",height:60,tick:_.jsx(Js,{})}),_.jsx($r,{className:"text-[10px] font-bold",tickFormatter:M=>`R$${M}`}),_.jsx(Qr,{content:_.jsx(L,{})}),_.jsx(jn,{dataKey:"value",fill:Y[1],radius:[8,8,0,0],children:_.jsx(Pn,{dataKey:"value",position:"top",content:({value:M})=>_.jsx("text",{x:0,y:0,dy:-5,fill:X?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(M||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]}),_.jsxs(jt,{children:[_.jsx(Dt,{children:_.jsx(Rt,{children:"Top Redes (Valor)"})}),_.jsx(Ot,{children:_.jsx(Jr,{width:"100%",height:300,children:_.jsxs(Xn,{data:v,children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",height:60,tick:_.jsx(Js,{})}),_.jsx($r,{className:"text-[10px] font-bold",tickFormatter:M=>`R$${M}`}),_.jsx(Qr,{content:_.jsx(L,{})}),_.jsx(jn,{dataKey:"value",fill:Y[2],radius:[8,8,0,0],children:_.jsx(Pn,{dataKey:"value",position:"top",content:({value:M})=>_.jsx("text",{x:0,y:0,dy:-5,fill:X?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(M||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]})]}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Top 5 Clientes com Reincidncia"}),_.jsx(Or,{children:"Clientes com mais notas em TRATATIVA DE ANULAO e ANULADA/CANCELADA"})]}),_.jsx(Ot,{children:_.jsx(Jr,{width:"100%",height:300,children:_.jsxs(Xn,{data:D,children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",height:60,tick:_.jsx(Js,{})}),_.jsx($r,{className:"text-[10px] font-bold"}),_.jsx(Qr,{content:_.jsx(L,{})}),_.jsx(jn,{dataKey:"count",fill:Y[3],radius:[8,8,0,0],children:_.jsx(Pn,{dataKey:"count",position:"top",content:({value:M})=>_.jsx("text",{x:0,y:0,dy:-5,fill:X?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`${M||0}`})})})]})})})]}),_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Motivos Mais Recorrentes por Rede"}),_.jsx(Or,{children:"Principais motivos de devoluo por rede (Top 5 redes)"})]}),_.jsx(Ot,{children:_.jsx(Jr,{width:"100%",height:300,children:_.jsxs(Xn,{data:P,layout:"vertical",children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{type:"number",className:"text-[10px] font-bold"}),_.jsx($r,{type:"category",dataKey:"rede",width:100,tick:_.jsx(Js,{})}),_.jsx(Qr,{content:_.jsx(L,{})}),_.jsx(jn,{dataKey:"count",fill:Y[4],radius:[0,8,8,0],children:_.jsx(Pn,{dataKey:"count",position:"right",content:({value:M})=>_.jsx("text",{x:0,y:0,dx:5,fill:X?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"start",children:`${M||0}`})})})]})})})]})]}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[_.jsxs(jt,{children:[_.jsx(Dt,{children:_.jsx(Rt,{children:"Anlise de Pareto (80/20)"})}),_.jsxs(Ot,{children:[_.jsx(Jr,{width:"100%",height:350,children:_.jsxs(wy,{data:y,children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",height:60,tick:_.jsx(Js,{})}),_.jsx($r,{yAxisId:"left",className:"text-[10px] font-bold",tickFormatter:M=>`R$${M}`}),_.jsx($r,{yAxisId:"right",orientation:"right",className:"text-[10px] font-bold",tickFormatter:M=>`${M}%`}),_.jsx(Qr,{content:_.jsx(L,{})}),_.jsx(jn,{yAxisId:"left",dataKey:"value",fill:Y[0],radius:[8,8,0,0],children:_.jsx(Pn,{dataKey:"value",position:"top",content:({value:M})=>_.jsx("text",{x:0,y:0,dy:-5,fill:X?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(M||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})}),_.jsx(Xl,{yAxisId:"right",type:"monotone",dataKey:"percentage",stroke:Y[3],strokeWidth:2})]})}),_.jsx("div",{className:"mt-4 text-xs text-muted-foreground",children:"Linha mostra o percentual acumulado. A regra 80/20 indica que poucos clientes concentram a maioria do valor."})]})]}),_.jsxs(jt,{children:[_.jsx(Dt,{children:_.jsx(Rt,{children:"Insights Automticos"})}),_.jsx(Ot,{children:_.jsx("div",{className:"space-y-3",children:B.length>0?B.map((M,Z)=>_.jsx("div",{className:"p-3 bg-muted/50 rounded-lg text-sm",children:M},Z)):_.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum insight disponvel no momento."})})})]})]}),N.length>0&&_.jsxs(jt,{children:[_.jsx(Dt,{children:_.jsx(Rt,{children:"Heatmap: Produto  Rede"})}),_.jsx(Ot,{children:_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"w-full text-xs border-collapse",children:[_.jsx("thead",{children:_.jsxs("tr",{children:[_.jsx("th",{className:"border p-2 text-left bg-muted text-xs",children:"Produto"}),N[0]&&Object.keys(N[0]).filter(M=>M!=="produto").map(M=>_.jsx("th",{className:"border p-2 bg-muted text-xs",children:M.length>15?M.substring(0,15)+"...":M},M))]})}),_.jsx("tbody",{children:N.map((M,Z)=>_.jsxs("tr",{children:[_.jsx("td",{className:"border p-2 font-medium text-xs",children:M.produto.length>20?M.produto.substring(0,20)+"...":M.produto}),Object.keys(M).filter(se=>se!=="produto").map(se=>{const ae=M[se]||{quantidade:0,unidade:"UN"},ne=typeof ae=="object"?ae.quantidade:ae,Q=typeof ae=="object"?ae.unidade:"UN",fe=Math.max(...N.map(te=>Math.max(...Object.keys(te).filter(ce=>ce!=="produto").map(ce=>{const he=te[ce];return typeof he=="object"?he.quantidade:he||0})))),le=fe>0?ne/fe*100:0;return _.jsx("td",{className:"border p-2 text-center text-xs",style:{backgroundColor:le>0?X?`rgba(210, 248, 247, ${le/100})`:`rgba(23, 67, 42, ${le/100})`:"transparent",color:le>50?X?"#000":"#fff":"inherit"},title:`${ne.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})} ${Q}`,children:ne>0?`${ne.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})} ${Q}`:"-"},se)})]},Z))})]})})})]}),(H.length>0||R.length>0)&&_.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[_.jsxs(jt,{children:[_.jsx(Dt,{children:_.jsxs(Rt,{className:"flex items-center gap-2",children:[_.jsx(Ao,{className:"h-5 w-5 text-orange-500"}),"Notas em Cancelamento"]})}),_.jsx(Ot,{children:H.length>0?_.jsx(Jr,{width:"100%",height:300,children:_.jsxs(Xn,{data:H,children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",height:60,tick:_.jsx(Js,{})}),_.jsx($r,{className:"text-[10px] font-bold"}),_.jsx(Qr,{content:_.jsx(L,{})}),_.jsx(jn,{dataKey:"quantidade",fill:Y[0],radius:[8,8,0,0],children:_.jsx(Pn,{dataKey:"quantidade",position:"inside",fill:"#f1f1e5",fontSize:13,fontWeight:"bold"})})]})}):_.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-muted-foreground text-center p-4",children:[_.jsx(Ao,{className:"h-10 w-10 mb-2 opacity-20"}),_.jsx("p",{className:"text-sm",children:"Nenhuma nota em cancelamento encontrada."})]})})]}),_.jsxs(jt,{children:[_.jsx(Dt,{children:_.jsxs(Rt,{className:"flex items-center gap-2",children:[_.jsx(Ao,{className:"h-5 w-5 text-red-500"}),"Notas Canceladas"]})}),_.jsx(Ot,{children:R.length>0?_.jsx(Jr,{width:"100%",height:300,children:_.jsxs(Xn,{data:R,children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",height:60,tick:_.jsx(Js,{})}),_.jsx($r,{className:"text-[10px] font-bold"}),_.jsx(Qr,{content:_.jsx(L,{})}),_.jsx(jn,{dataKey:"quantidade",fill:Y[1],radius:[8,8,0,0]})]})}):_.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-muted-foreground text-center p-4",children:[_.jsx(Ao,{className:"h-10 w-10 mb-2 opacity-20"}),_.jsx("p",{className:"text-sm",children:"Nenhuma nota cancelada encontrada."})]})})]})]}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[_.jsxs(jt,{className:"col-span-1",children:[_.jsx(Dt,{children:_.jsx(Rt,{className:"text-base",children:"Principais Motivos"})}),_.jsx(Ot,{children:g.length>0?_.jsx("div",{className:"h-[250px]",children:_.jsx(Jr,{width:"100%",height:"100%",children:_.jsxs(o8,{children:[_.jsx(l8,{data:g,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:g.map((M,Z)=>_.jsx(c8,{fill:Y[Z%Y.length]},`cell-${Z}`))}),_.jsx(Qr,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)"}}),_.jsx(_y,{verticalAlign:"bottom",height:60,iconType:"circle",wrapperStyle:{fontSize:"9px",paddingTop:"8px"},formatter:M=>{const se=M.length>20?M.substring(0,20)+"...":M;return _.jsx("span",{style:{fontSize:"9px"},children:se})}})]})})}):_.jsxs("div",{className:"flex flex-col items-center justify-center h-[250px] text-muted-foreground text-center p-4",children:[_.jsx(Ml,{className:"h-10 w-10 mb-2 opacity-20"}),_.jsx("p",{className:"text-sm",children:"Nenhum motivo encontrado para o perodo selecionado."})]})})]}),_.jsxs(jt,{className:"col-span-1",children:[_.jsx(Dt,{children:_.jsx(Rt,{className:"text-base",children:"Distribuio por Municpio"})}),_.jsx(Ot,{children:_.jsx("div",{className:"space-y-4",children:A.length>0?A.map((M,Z)=>_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Mp,{className:"h-4 w-4 text-muted-foreground"}),_.jsx("span",{className:"text-sm font-medium truncate max-w-[120px]",title:M.name,children:M.name})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("div",{className:"h-2 bg-muted rounded-full w-24 overflow-hidden",children:_.jsx("div",{className:"h-full bg-primary",style:{width:`${M.value/(a.totalValue||1)*100}%`}})}),_.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:[(M.value/(a.totalValue||1)*100).toFixed(0),"%"]})]})]},Z)):_.jsx("div",{className:"text-center text-sm text-muted-foreground py-8",children:"Nenhum dado disponvel"})})})]}),_.jsxs(jt,{className:"col-span-1",children:[_.jsx(Dt,{children:_.jsx(Rt,{className:"text-base",children:"Produtos Crticos"})}),_.jsx(Ot,{children:w.length>0?_.jsxs("div",{className:"space-y-4 max-h-[400px] overflow-y-auto",children:[_.jsxs("div",{children:[_.jsx("h4",{className:"text-xs font-bold text-muted-foreground mb-2",children:"Top 5 em CX"}),_.jsx("div",{className:"space-y-2",children:w.filter(M=>M.tipo==="CX").length>0?w.filter(M=>M.tipo==="CX").map((M,Z)=>_.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-muted/50",children:[_.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[_.jsxs("span",{className:"text-xs font-bold text-muted-foreground w-6",children:[Z+1,""]}),_.jsx("span",{className:"text-sm font-medium truncate",title:M.nameFull||M.name,children:M.name})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("span",{className:"text-sm font-bold",children:M.quantidade.toFixed(2)}),_.jsx("span",{className:"text-xs text-muted-foreground",children:M.unidade||"CX"})]})]},`cx-${Z}`)):_.jsx("div",{className:"text-xs text-muted-foreground p-2",children:"Nenhum produto em CX encontrado"})})]}),_.jsxs("div",{children:[_.jsx("h4",{className:"text-xs font-bold text-muted-foreground mb-2",children:"Top 5 em UN"}),_.jsx("div",{className:"space-y-2",children:w.filter(M=>M.tipo==="UN").length>0?w.filter(M=>M.tipo==="UN").map((M,Z)=>_.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-muted/50",children:[_.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[_.jsxs("span",{className:"text-xs font-bold text-muted-foreground w-6",children:[Z+1,""]}),_.jsx("span",{className:"text-sm font-medium truncate",title:M.nameFull||M.name,children:M.name})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("span",{className:"text-sm font-bold",children:M.quantidade.toFixed(2)}),_.jsx("span",{className:"text-xs text-muted-foreground",children:M.unidade||"UN"})]})]},`un-${Z}`)):_.jsx("div",{className:"text-xs text-muted-foreground p-2",children:"Nenhum produto em UN encontrado"})})]})]}):_.jsxs("div",{className:"flex flex-col items-center justify-center h-[250px] text-muted-foreground text-center p-4",children:[_.jsx(Ul,{className:"h-10 w-10 mb-2 opacity-20"}),_.jsx("p",{className:"text-sm",children:"Nenhum produto encontrado para o perodo selecionado."})]})})]})]})]})}var UN=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],zN=UN.reduce((t,r)=>{const e=gm(`Primitive.${r}`),n=_e.forwardRef((a,o)=>{const{asChild:s,...l}=a,c=s?e:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),_.jsx(c,{...l,ref:o})});return n.displayName=`Primitive.${r}`,{...t,[r]:n}},{}),$N="Label",t_=_e.forwardRef((t,r)=>_.jsx(zN.label,{...t,ref:r,onMouseDown:e=>{var a;e.target.closest("button, input, select, textarea")||((a=t.onMouseDown)==null||a.call(t,e),!e.defaultPrevented&&e.detail>1&&e.preventDefault())}}));t_.displayName=$N;var r_=t_;const VN=$f("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),kr=_e.forwardRef(({className:t,...r},e)=>_.jsx(r_,{ref:e,className:Et(VN(),t),...r}));kr.displayName=r_.displayName;const Un=_e.forwardRef(({className:t,...r},e)=>_.jsx("div",{className:"relative w-full overflow-auto",children:_.jsx("table",{ref:e,className:Et("w-full caption-bottom text-sm",t),...r})}));Un.displayName="Table";const Jn=_e.forwardRef(({className:t,...r},e)=>_.jsx("thead",{ref:e,className:Et("[&_tr]:border-b",t),...r}));Jn.displayName="TableHeader";const zn=_e.forwardRef(({className:t,...r},e)=>_.jsx("tbody",{ref:e,className:Et("[&_tr:last-child]:border-0",t),...r}));zn.displayName="TableBody";const HN=_e.forwardRef(({className:t,...r},e)=>_.jsx("tfoot",{ref:e,className:Et("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...r}));HN.displayName="TableFooter";const dr=_e.forwardRef(({className:t,...r},e)=>_.jsx("tr",{ref:e,className:Et("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...r}));dr.displayName="TableRow";const Tt=_e.forwardRef(({className:t,...r},e)=>_.jsx("th",{ref:e,className:Et("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r}));Tt.displayName="TableHead";const Pt=_e.forwardRef(({className:t,...r},e)=>_.jsx("td",{ref:e,className:Et("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r}));Pt.displayName="TableCell";const qN=_e.forwardRef(({className:t,...r},e)=>_.jsx("caption",{ref:e,className:Et("mt-4 text-sm text-muted-foreground",t),...r}));qN.displayName="TableCaption";const WN=["#17432a","#17432a","#17432a","#17432a","#17432a","#17432a"],GN=["#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7","#d2f8f7"],ys=({x:t,y:r,payload:e})=>{const a=e.value.split(" ");let o=[],s="";return a.forEach(l=>{(s+l).length<=10?s+=`${l} `:(s.trim()&&o.push(s.trim()),s=`${l} `)}),s.trim()&&o.push(s.trim()),_.jsx("g",{transform:`translate(${t},${r})`,children:_.jsx("text",{x:0,y:0,dy:16,textAnchor:"middle",fill:"currentColor",fontSize:10,fontWeight:"bold",children:o.map((l,c)=>_.jsx("tspan",{x:"0",dy:c===0?0:14,children:l},c))})})};function YN(){const{filters:t}=ec(),{user:r}=Dn(),[e,n]=_e.useState(!0),[a,o]=_e.useState({totalValue:0,totalReturns:0,avgTicket:0,totalProducts:0,valorTotalLancado:0,notasLancadas:0,valorTotalCancelado:0,notasCanceladas:0}),[s,l]=_e.useState([]),[c,i]=_e.useState([]),[u,p]=_e.useState([]),[f,h]=_e.useState([]),[v,b]=_e.useState([]),[g,x]=_e.useState([]),[y,k]=_e.useState(!1),[N,F]=_e.useState([]),[B,W]=_e.useState([]),[V,q]=_e.useState([]),[X,I]=_e.useState([]),[H,O]=_e.useState([]),[R,C]=_e.useState([]),[w,E]=_e.useState("KG"),[A,T]=_e.useState(""),[D,U]=_e.useState([]),[P,K]=_e.useState([]),[Y,re]=_e.useState([]),[z,ee]=_e.useState([]);_e.useEffect(()=>{const ne=()=>{k(document.documentElement.classList.contains("dark"))};ne();const Q=new MutationObserver(ne);return Q.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>Q.disconnect()},[]);const L=y?GN:WN;_e.useEffect(()=>{M()},[t,r,w]);const M=async()=>{try{n(!0);const ne=(r==null?void 0:r.role)==="VENDEDOR"?r.vendedor:null;let Q=St.from("devolucoes").select(`
          *,
          motivos_devolucao(nome, setores:setores(nome)),
          setores(nome),
          itens:itens_devolucao(quantidade, descricao, motivo_id, valor_total_bruto, unidade)
      `);r&&r.role==="VENDEDOR"&&ne&&(Q=Q.eq("vendedor",ne),console.log(" Dashboard Lanadas - Filtrando por vendedor:",ne));const fe=t.period&&!t.startDate&&!t.endDate?Kf(t.period):{},le=t.startDate||fe.startDate,te=t.endDate||fe.endDate;Q=Q.in("resultado",["LANADA","ANULADA/CANCELADA"]),t.search&&(Q=Q.or(`nome_cliente.ilike.%${t.search}%,vendedor.ilike.%${t.search}%,numero.ilike.%${t.search}%`)),t.motivo&&t.motivo.length>0&&(Q=Q.in("motivo_id",t.motivo)),t.cliente&&t.cliente.length>0&&(Q=Q.in("nome_cliente",t.cliente)),t.vendedor&&t.vendedor.length>0&&(Q=Q.in("vendedor",t.vendedor)),t.setor&&t.setor.length>0&&(Q=Q.in("setor_id",t.setor)),le&&(Q=Q.gte("data_emissao",le.toISOString().split("T")[0])),te&&(Q=Q.lte("data_emissao",te.toISOString().split("T")[0]));const{data:ce,error:he}=await Q;if(he){console.error(" Erro ao buscar dados do Dashboard Lanadas:",he),_t.error("Erro ao carregar dados do Dashboard Lanadas: "+he.message),n(!1);return}if(!ce||ce.length===0){console.log(" Nenhuma devoluo encontrada para os filtros selecionados"),o({totalValue:0,totalReturns:0,avgTicket:0,totalProducts:0,valorTotalLancado:0,notasLancadas:0,valorTotalCancelado:0,notasCanceladas:0}),l([]),i([]),p([]),h([]),b([]),x([]),F([]),I([]),O([]),C([]),U([]),K([]),re([]),ee([]),n(!1);return}if(ce){console.log(` Dashboard Lanadas: ${ce.length} devolues carregadas`);const Ee=ce.reduce((pe,xe)=>pe+(Number(xe.valor_total_nota)||0),0),ke=ce.length,Ce=ke>0?Ee/ke:0,Fe=ce.reduce((pe,xe)=>{const We=xe.itens||[];return pe+We.reduce((qe,ut)=>qe+(Number(ut.quantidade)||0),0)},0),Pe=ce.filter(pe=>pe.resultado==="LANADA"),Xe=ce.filter(pe=>pe.resultado==="ANULADA/CANCELADA"),ct=Pe.reduce((pe,xe)=>pe+(Number(xe.valor_total_nota)||0),0),st=Xe.reduce((pe,xe)=>pe+(Number(xe.valor_total_nota)||0),0);o({totalValue:Ee,totalReturns:ke,avgTicket:Ce,totalProducts:Fe,valorTotalLancado:ct,notasLancadas:Pe.length,valorTotalCancelado:st,notasCanceladas:Xe.length});const lt=ce.reduce((pe,xe)=>{const We=new Date(xe.data_emissao||xe.created_at),qe=Wt(We,"dd/MM",{locale:br});return pe[qe]||(pe[qe]={value:0,count:0}),pe[qe].value+=Number(xe.valor_total_nota)||0,pe[qe].count+=1,pe},{}),tt=Object.keys(lt).sort((pe,xe)=>{const We=new Date(pe.split("/").reverse().join("-")),qe=new Date(xe.split("/").reverse().join("-"));return We.getTime()-qe.getTime()}).map(pe=>({name:pe,value:lt[pe].value,count:lt[pe].count}));l(tt);const ot={};ce.forEach(pe=>{const xe=pe.nome_cliente||"Desconhecido",We=Number(pe.valor_total_nota)||0;ot[xe]||(ot[xe]={valor:0,detalhes:[]}),ot[xe].valor+=We,ot[xe].detalhes.push({cliente:xe,nota:pe.numero||"-"})});const De=Object.entries(ot).map(([pe,xe])=>({name:pe,value:xe.valor,quantidade:xe.detalhes.length,detalhes:xe.detalhes})).sort((pe,xe)=>xe.value-pe.value).slice(0,10);i(De);const ht={};ce.forEach(pe=>{const xe=pe.vendedor||"Desconhecido",We=Number(pe.valor_total_nota)||0;ht[xe]||(ht[xe]={valor:0,detalhes:[]}),ht[xe].valor+=We,ht[xe].detalhes.push({cliente:pe.nome_cliente||"Desconhecido",nota:pe.numero||"-"})});const rt=Object.entries(ht).map(([pe,xe])=>({name:pe,value:xe.valor,quantidade:xe.detalhes.length,detalhes:xe.detalhes})).sort((pe,xe)=>xe.value-pe.value).slice(0,5);p(rt);const it={};ce.forEach(pe=>{let xe=pe.rede||"Sem rede";xe==="Sem rede"&&pe.cnpj_destinatario&&(xe=pe.rede||"Sem rede");const We=Number(pe.valor_total_nota)||0;it[xe]||(it[xe]={valor:0,detalhes:[]}),it[xe].valor+=We,it[xe].detalhes.push({cliente:pe.nome_cliente||"Desconhecido",nota:pe.numero||"-"})});const dt=Object.entries(it).map(([pe,xe])=>({name:pe,value:xe.valor,quantidade:xe.detalhes.length,detalhes:xe.detalhes})).sort((pe,xe)=>xe.value-pe.value).slice(0,5);h(dt);const wt=Object.entries(ot).map(([pe,xe])=>({name:pe,value:xe.valor,detalhes:xe.detalhes})).sort((pe,xe)=>xe.value-pe.value);let gt=0;const vt=wt.reduce((pe,xe)=>pe+xe.value,0),Ve=wt.map((pe,xe)=>(gt+=pe.value,{name:pe.name.length>15?pe.name.substring(0,15)+"...":pe.name,value:pe.value,cumulative:gt,percentage:gt/vt*100,index:xe+1,quantidade:pe.detalhes.length,detalhes:pe.detalhes})).slice(0,10);b(Ve);const $e=ce.reduce((pe,xe)=>{const We=xe.cidade_origem||"N/A";return pe[We]=(pe[We]||0)+(Number(xe.valor_total_nota)||0),pe},{}),xt=Object.entries($e).map(([pe,xe])=>({name:pe,value:xe})).sort((pe,xe)=>xe.value-pe.value).slice(0,6);console.log(" Municpio Chart:",xt),F(xt);const nt={};ce.filter(pe=>pe.resultado==="ANULADA/CANCELADA").forEach(pe=>{const xe=pe.nome_cliente||"Desconhecido";nt[xe]||(nt[xe]={count:0,detalhes:[]}),nt[xe].count+=1,nt[xe].detalhes.push({cliente:xe,nota:pe.numero||"-"})});const pt=Object.entries(nt).map(([pe,xe])=>({name:pe,count:xe.count,quantidade:xe.detalhes.length,detalhes:xe.detalhes})).sort((pe,xe)=>xe.count-pe.count).slice(0,5);W(pt);const Se={};ce.forEach(pe=>{var qe;const xe=pe.rede||"Sem rede",We=(qe=pe.motivos_devolucao)==null?void 0:qe.nome;!We||We==="No informado"||We==="no informado"||We==="NO INFORMADO"||(Se[xe]||(Se[xe]={}),Se[xe][We]||(Se[xe][We]={count:0,detalhes:[]}),Se[xe][We].count+=1,Se[xe][We].detalhes.push({cliente:pe.nome_cliente||"Desconhecido",nota:pe.numero||"-"}))});const je=[];Object.entries(Se).sort((pe,xe)=>{const We=Object.values(pe[1]).reduce((ut,Mt)=>ut+Mt.count,0);return Object.values(xe[1]).reduce((ut,Mt)=>ut+Mt.count,0)-We}).slice(0,5).forEach(([pe,xe])=>{const We=Object.entries(xe).sort((qe,ut)=>ut[1].count-qe[1].count)[0];We&&je.push({rede:pe.length>15?pe.substring(0,15)+"...":pe,motivo:We[0].length>20?We[0].substring(0,20)+"...":We[0],count:We[1].count,quantidade:We[1].detalhes.length,detalhes:We[1].detalhes})}),q(je);const Qe=[];if(ke>0&&Qe.push(` Total de ${ke} devoluo(es) no perodo selecionado, totalizando R$ ${Ee.toLocaleString("pt-BR",{minimumFractionDigits:2})}.`),De.length>0&&Ee>0){const pe=De[0].value/Ee*100;pe>20&&Qe.push(` Cliente "${De[0].name}" concentra ${pe.toFixed(1)}% do valor total de devolues.`)}if(Fe>0&&ke>0){const pe=Fe/ke;Qe.push(` Mdia de ${pe.toFixed(1)} produtos por devoluo.`)}if(rt.length>0&&Qe.push(` Vendedor "${rt[0].name}" lidera em devolues com R$ ${rt[0].value.toLocaleString("pt-BR")}.`),Ve.length>0){const pe=Ve.findIndex(xe=>xe.percentage>=80);pe>=0&&pe<5&&Qe.push(` Regra 80/20: ${pe+1} clientes concentram 80% do valor de devolues.`)}const At=ce.filter(pe=>pe.resultado==="ANULADA/CANCELADA").length,Vt=ke>0?At/ke*100:0;if(Vt>10?Qe.push(` Taxa de cancelamento alta: ${Vt.toFixed(1)}% das devolues esto em cancelamento.`):At>0&&Qe.push(` ${At} devoluo(es) em processo de cancelamento.`),Ce>0){const pe=ce.filter(xe=>Number(xe.valor_total_nota)>Ce*1.5).length;pe>0&&Qe.push(` ${pe} devoluo(es) com valor acima de 150% do ticket mdio.`)}if(dt.length>0&&Ee>0){const pe=dt[0].value/Ee*100;pe>15&&Qe.push(` Rede "${dt[0].name}" representa ${pe.toFixed(1)}% do valor devolvido.`)}if(tt.length>=2){const pe=tt[tt.length-1].value,xe=tt[tt.length-2].value;if(xe>0){const We=(pe-xe)/xe*100;if(Math.abs(We)>20){const qe=We>0?"aumento":"reduo";Qe.push(` ${qe.charAt(0).toUpperCase()+qe.slice(1)} de ${Math.abs(We).toFixed(1)}% no valor devolvido comparado ao perodo anterior.`)}}}console.log(" Insights:",Qe),x(Qe);const yt=[],Ct=ce.filter(pe=>pe.prazo==="EM ATRASO");if(Ct.length>0){const pe=Ct.reduce((xe,We)=>xe+(Number(We.valor_total_nota)||0),0);yt.push({type:"warning",message:`${Ct.length} nota(s) em atraso`,count:Ct.length,total:Ct.length,value:pe})}if(ke>50&&yt.push({type:"info",message:`Total de ${ke} notas no perodo (acima de 50)`,count:ke,total:ke}),Pe.length>20){const pe=Pe.reduce((xe,We)=>xe+(Number(We.valor_total_nota)||0),0);yt.push({type:"info",message:`${Pe.length} nota(s) lanadas (acima de 20)`,count:Pe.length,total:Pe.length,value:pe})}const It=ce.filter(pe=>Number(pe.valor_total_nota)>1e3);if(It.length>0){const pe=It.reduce((xe,We)=>xe+(Number(We.valor_total_nota)||0),0);yt.push({type:"warning",message:`${It.length} nota(s) com valor acima de R$ 1.000,00`,count:It.length,total:It.length,value:pe})}const kt={};Pe.forEach(pe=>{const xe=pe.nome_cliente||"Desconhecido";kt[xe]||(kt[xe]=[]),kt[xe].push(pe)}),Object.entries(kt).forEach(([pe,xe])=>{if(xe.length>5){const We=xe.reduce((qe,ut)=>qe+(Number(ut.valor_total_nota)||0),0);yt.push({type:"info",message:`Cliente "${pe}" tem ${xe.length} notas lanadas`,cliente:pe,count:xe.length,total:xe.length,value:We})}});const Ne=ce.filter(pe=>pe.resultado==="ANULADA/CANCELADA");if(Ne.length>0){const pe=Ne.reduce((xe,We)=>xe+(Number(We.valor_total_nota)||0),0);yt.push({type:"warning",message:`${Ne.length} nota(s) anuladas/canceladas`,detalhes:Ne.map(xe=>`NF ${xe.numero} - ${xe.nome_cliente||"Sem cliente"} - R$ ${(Number(xe.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`),count:Ne.length,total:Ne.length,value:pe})}const Le={};ce.filter(pe=>pe.resultado==="LANADA").forEach(pe=>{var qe;const xe=((qe=pe.motivos_devolucao)==null?void 0:qe.nome)||"Sem motivo",We=Number(pe.valor_total_nota)||0;Le[xe]||(Le[xe]={valorTotal:0,quantidade:0}),Le[xe].valorTotal+=We,Le[xe].quantidade+=1});const at=Object.entries(Le).map(([pe,xe])=>({name:pe,valorTotal:xe.valorTotal,quantidade:xe.quantidade})).sort((pe,xe)=>xe.valorTotal-pe.valorTotal);I(at);const ie={};ce.filter(pe=>pe.resultado==="LANADA").forEach(pe=>{var qe,ut,Mt;const xe=((ut=(qe=pe.motivos_devolucao)==null?void 0:qe.setores)==null?void 0:ut.nome)||((Mt=pe.setores)==null?void 0:Mt.nome)||"Sem setor",We=Number(pe.valor_total_nota)||0;ie[xe]||(ie[xe]={valorTotal:0,quantidade:0}),ie[xe].valorTotal+=We,ie[xe].quantidade+=1});const we=Object.entries(ie).map(([pe,xe])=>({name:pe,valorTotal:xe.valorTotal,quantidade:xe.quantidade})).sort((pe,xe)=>xe.valorTotal-pe.valorTotal);O(we);const de={};ce.forEach(pe=>{(pe.itens||[]).forEach(We=>{const qe=We.descricao||"Desconhecido",ut=Number(We.quantidade)||0,Mt=(We.unidade||"").toUpperCase().trim();de[qe]||(de[qe]={quantidadeKG:0,quantidadeCX:0,descricao:qe}),["KG","KG1","KGS"].includes(Mt)?de[qe].quantidadeKG+=ut:["CX","CX1","CXI","CX10","CXS","FD"].includes(Mt)&&(de[qe].quantidadeCX+=ut)})});const ge=Object.entries(de).map(([pe,xe])=>({name:pe.length>30?pe.substring(0,30)+"...":pe,nameFull:pe,quantidadeKG:xe.quantidadeKG,quantidadeCX:xe.quantidadeCX,quantidade:w==="KG"?xe.quantidadeKG:xe.quantidadeCX})).filter(pe=>pe.quantidade>0).sort((pe,xe)=>xe.quantidade-pe.quantidade).slice(0,20);C(ge);const ve=ce.filter(pe=>pe.resultado==="LANADA"),ye=Object.entries(Le).sort((pe,xe)=>xe[1].valorTotal-pe[1].valorTotal).slice(0,10).map(([pe])=>pe),Me={};ve.forEach(pe=>{var qe;const xe=((qe=pe.motivos_devolucao)==null?void 0:qe.nome)||"Sem motivo";if(!ye.includes(xe))return;(pe.itens||[]).forEach(ut=>{const Mt=ut.descricao||"Desconhecido";Me[Mt]||(Me[Mt]={}),Me[Mt][xe]||(Me[Mt][xe]={quantidade:0,valorTotal:0}),Me[Mt][xe].quantidade+=Number(ut.quantidade)||0,Me[Mt][xe].valorTotal+=Number(ut.valor_total_bruto)||0})});const Ue=Object.entries(de).map(([pe,xe])=>({name:pe,quantidadeTotal:w==="KG"?xe.quantidadeKG:xe.quantidadeCX})).sort((pe,xe)=>xe.quantidadeTotal-pe.quantidadeTotal).slice(0,5).map(pe=>pe.name),Re=[];Ue.forEach(pe=>{if(Me[pe]){const xe=Object.entries(Me[pe]).map(([We,qe])=>({produto:pe,motivo:We,quantidade:qe.quantidade,valorTotal:qe.valorTotal})).sort((We,qe)=>qe.quantidade-We.quantidade).slice(0,5);Re.push(...xe)}}),U(Re);const Be={};ve.forEach(pe=>{var qe;const xe=pe.vendedor||"Desconhecido",We=((qe=pe.motivos_devolucao)==null?void 0:qe.nome)||"Sem motivo";Be[xe]||(Be[xe]={}),Be[xe][We]||(Be[xe][We]={quantidade:0,valorTotal:0}),Be[xe][We].quantidade+=1,Be[xe][We].valorTotal+=Number(pe.valor_total_nota)||0});const ze=[];Object.entries(Be).forEach(([pe,xe])=>{const We=Object.entries(xe).map(([qe,ut])=>({vendedor:pe,motivo:qe,quantidade:ut.quantidade,valorTotal:ut.valorTotal})).sort((qe,ut)=>ut.quantidade-qe.quantidade).slice(0,5);ze.push(...We)}),K(ze);const be={};ve.forEach(pe=>{var qe,ut,Mt,Bt;const xe=((ut=(qe=pe.motivos_devolucao)==null?void 0:qe.setores)==null?void 0:ut.nome)||((Mt=pe.setores)==null?void 0:Mt.nome)||"Sem setor",We=((Bt=pe.motivos_devolucao)==null?void 0:Bt.nome)||"Sem motivo";be[xe]||(be[xe]={}),be[xe][We]||(be[xe][We]={quantidade:0,valorTotal:0}),be[xe][We].quantidade+=1,be[xe][We].valorTotal+=Number(pe.valor_total_nota)||0});const Te=[];Object.entries(be).forEach(([pe,xe])=>{const We=Object.entries(xe).map(([qe,ut])=>({setor:pe,motivo:qe,quantidade:ut.quantidade,valorTotal:ut.valorTotal})).sort((qe,ut)=>ut.quantidade-qe.quantidade).slice(0,5);Te.push(...We)}),re(Te);const Ge=Object.entries(ot).sort((pe,xe)=>xe[1].valor-pe[1].valor).slice(0,10).map(([pe])=>pe),ue={};ve.forEach(pe=>{var qe;const xe=pe.nome_cliente||"Desconhecido";if(!Ge.includes(xe))return;const We=((qe=pe.motivos_devolucao)==null?void 0:qe.nome)||"Sem motivo";ue[xe]||(ue[xe]={}),ue[xe][We]||(ue[xe][We]={quantidade:0,valorTotal:0}),ue[xe][We].quantidade+=1,ue[xe][We].valorTotal+=Number(pe.valor_total_nota)||0});const Ae=[];Object.entries(ue).forEach(([pe,xe])=>{const We=Object.entries(xe).map(([qe,ut])=>({cliente:pe,motivo:qe,quantidade:ut.quantidade,valorTotal:ut.valorTotal})).sort((qe,ut)=>ut.quantidade-qe.quantidade).slice(0,5);Ae.push(...We)}),ee(Ae)}}catch(ne){console.error(" Erro ao processar dados do Dashboard Lanadas:",ne),_t.error("Erro ao processar dados: "+(ne.message||"Erro desconhecido"))}finally{n(!1)}},Z=({active:ne,payload:Q})=>{if(!ne||!(Q!=null&&Q.length))return null;const fe=Q[0].payload,le=fe.quantidade||fe.count||fe.value||0,te=fe.detalhes||[],ce=te&&te.length>0;return _.jsxs("div",{className:"bg-card border border-border rounded-md p-3 shadow-md",children:[_.jsx("p",{className:"text-sm font-bold text-foreground mb-1",children:"Detalhes"}),fe.value&&typeof fe.value=="number"&&fe.value>1e3?_.jsxs("p",{className:"text-sm font-bold text-primary",children:["R$ ",fe.value.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}):_.jsxs("p",{className:"text-sm font-bold text-primary",children:[le," ",fe.count!==void 0?"nota(s)":fe.value!==void 0?"ocorrncia(s)":"item(s)"]}),ce&&_.jsx("div",{className:"mt-2 space-y-1 max-h-[200px] overflow-y-auto",children:te.map((he,Ee)=>_.jsxs("p",{className:"text-xs text-muted-foreground",children:[_.jsx("span",{className:"font-medium text-foreground",children:he.cliente}),_.jsx("span",{className:"mx-1",children:""}),_.jsxs("span",{className:"text-primary",children:["NF: ",he.nota]})]},Ee))})]})},se=()=>{const ne=t.startDate&&t.endDate?`${Wt(t.startDate,"dd/MM/yyyy",{locale:br})} a ${Wt(t.endDate,"dd/MM/yyyy",{locale:br})}`:t.period||"Todos os perodos",Q=[];t.motivo&&t.motivo.length>0&&Q.push(`Motivos: ${t.motivo.length} selecionado(s)`),t.cliente&&t.cliente.length>0&&Q.push(`Clientes: ${t.cliente.length} selecionado(s)`),t.vendedor&&t.vendedor.length>0&&Q.push(`Vendedores: ${t.vendedor.length} selecionado(s)`),t.setor&&t.setor.length>0&&Q.push(`Setores: ${t.setor.length} selecionado(s)`),t.search&&Q.push(`Busca: "${t.search}"`);const fe=`
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Lanadas - Relatrio</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"><\/script>
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
  
  @page {
    size: A4 portrait;
    margin: 15mm;
  }
  
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: white;
    padding: 10px;
    color: #333;
    font-size: 9px;
  }
  
  .page {
    page-break-after: auto;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }
  
  .header {
    background: linear-gradient(135deg, #073e29 0%, #0a4d33 100%);
    color: white;
    padding: 12px;
    border-radius: 6px;
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    gap: 15px;
  }
  
  .header-logo {
    width: 50px;
    height: 50px;
    background: white;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }
  
  .header-logo img {
    width: 100%;
    height: 100%;
    object-fit: contain;
  }
  
  .header-content {
    flex: 1;
  }
  
  .header h1 {
    font-size: 18px;
    margin-bottom: 4px;
  }
  
  .header-info {
    font-size: 9px;
    opacity: 0.95;
    margin-bottom: 3px;
  }
  
  .header-filters {
    font-size: 8px;
    opacity: 0.85;
    margin-top: 4px;
  }
  
  .kpi-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 6px;
    margin-bottom: 12px;
  }
  
  .kpi-card {
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 8px;
    background: #f9fafb;
  }
  
  .kpi-title {
    font-size: 7px;
    color: #666;
    margin-bottom: 3px;
  }
  
  .kpi-value {
    font-size: 13px;
    font-weight: bold;
    color: #073e29;
  }
  
  .kpi-desc {
    font-size: 6px;
    color: #999;
    margin-top: 2px;
  }
  
  .chart-section {
    margin-bottom: 10px;
    page-break-inside: avoid;
    break-inside: avoid;
  }
  
  .chart-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-bottom: 10px;
  }
  
  .chart-title {
    font-size: 11px;
    font-weight: bold;
    margin-bottom: 6px;
    color: #073e29;
    border-bottom: 2px solid #073e29;
    padding-bottom: 3px;
  }

  .chart-container {
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 6px;
    background: white;
    height: 140px;
    position: relative;
    width: 100%;
  }
  
  .insights-container {
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 6px;
    background: white;
    height: 140px;
    position: relative;
    width: 100%;
    overflow-y: auto;
  }
  
  .insight-item {
    font-size: 8px;
    margin-bottom: 4px;
    padding-left: 6px;
    line-height: 1.4;
    color: #333;
  }
  
  .devolucao-vendas-card {
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 10px;
    background: #f9fafb;
    margin-bottom: 12px;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  
  .devolucao-vendas-title {
    font-size: 11px;
    font-weight: bold;
    color: #073e29;
    margin-bottom: 4px;
  }
  
  .devolucao-vendas-content {
    display: flex;
    gap: 12px;
    align-items: flex-end;
  }
  
  .devolucao-vendas-input {
    flex: 1;
  }
  
  .devolucao-vendas-input label {
    font-size: 8px;
    color: #666;
    display: block;
    margin-bottom: 4px;
  }
  
  .devolucao-vendas-input input {
    width: 100%;
    padding: 6px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 10px;
  }
  
  .devolucao-vendas-result {
    flex: 1;
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 8px;
    background: white;
  }
  
  .devolucao-vendas-result-title {
    font-size: 7px;
    color: #666;
    margin-bottom: 3px;
  }
  
  .devolucao-vendas-result-value {
    font-size: 16px;
    font-weight: bold;
    color: #073e29;
  }
  
  .devolucao-vendas-result-desc {
    font-size: 6px;
    color: #999;
    margin-top: 2px;
  }
  
  .tables-section {
    margin-top: 12px;
    margin-bottom: 12px;
  }
  
  .tables-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-bottom: 10px;
  }
  
  .table-card {
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 8px;
    background: white;
    page-break-inside: avoid;
    break-inside: avoid;
  }
  
  .table-title {
    font-size: 10px;
    font-weight: bold;
    color: #073e29;
    margin-bottom: 4px;
    border-bottom: 1px solid #073e29;
    padding-bottom: 3px;
  }
  
  .table-description {
    font-size: 7px;
    color: #666;
    margin-bottom: 6px;
  }
  
  .table-container {
    overflow-x: auto;
  }
  
  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 7px;
  }
  
  table th {
    background: #f9fafb;
    border: 1px solid #ddd;
    padding: 4px;
    text-align: left;
    font-weight: bold;
    color: #073e29;
  }
  
  table td {
    border: 1px solid #ddd;
    padding: 4px;
    color: #333;
  }
  
  table tr:nth-child(even) {
    background: #f9fafb;
  }
  
  .text-right {
    text-align: right;
  }
  
  .footer {
    margin-top: auto;
    padding-top: 12px;
    border-top: 2px solid #073e29;
    text-align: center;
    font-size: 7px;
    color: #666;
  }
  
  @media print {
    body {
      padding: 0;
    }
    .no-print {
      display: none !important;
    }
    .chart-container, .chart-container-full {
      page-break-inside: avoid;
    }
  }
</style>
</head>
<body>
<button class="no-print" onclick="window.print()" style="position: fixed; top: 10px; right: 10px; z-index: 1000; background: #073e29; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold;">
   Imprimir
</button>

<!-- PGINA 1: Header + KPIs + 3 Sees com 2 Grficos -->
<div class="page">
  <div class="header">
    <div class="header-logo">
      <img src="/logo.png" alt="Logo" onerror="this.style.display='none'" style="background-color: #073e29;">
    </div>
    <div class="header-content">
      <h1>Dashboard Lanadas</h1>
      <div class="header-info">Relatrio Gerado em ${Wt(new Date,"dd/MM/yyyy 's' HH:mm",{locale:br})}</div>
      <div class="header-info">Perodo: ${ne}</div>
      ${Q.length>0?`<div class="header-filters">Filtros: ${Q.join(" | ")}</div>`:""}
    </div>
  </div>
  
  <div class="kpi-grid">
    <div class="kpi-card">
      <div class="kpi-title">Valor Total Devolvido</div>
      <div class="kpi-value">R$ ${a.valorTotalLancado.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}</div>
      <div class="kpi-desc">Resultado: LANADA</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">Notas Lanadas</div>
      <div class="kpi-value">${a.notasLancadas}</div>
      <div class="kpi-desc">Resultado: LANADA</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">Valor Total Cancelado</div>
      <div class="kpi-value">R$ ${a.valorTotalCancelado.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}</div>
      <div class="kpi-desc">Resultado: ANULADA/CANCELADA</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">Notas Canceladas</div>
      <div class="kpi-value">${a.notasCanceladas}</div>
      <div class="kpi-desc">Resultado: ANULADA/CANCELADA</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">Produtos Devolvidos</div>
      <div class="kpi-value">${a.totalProducts.toFixed(2)}</div>
      <div class="kpi-desc">Quantidade total</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">Ticket Mdio</div>
      <div class="kpi-value">R$ ${a.avgTicket.toLocaleString("pt-BR",{maximumFractionDigits:0})}</div>
    </div>
  </div>
  
  <!-- Card Devoluo sobre Vendas -->
  <div class="devolucao-vendas-card">
    <div class="devolucao-vendas-title">Devoluo sobre Vendas</div>
    <div class="devolucao-vendas-content">
      <div class="devolucao-vendas-input">
        <label>Valor de Vendas (R$)</label>
        <input type="number" id="valorVendasInput" value="${A||""}" readonly style="background: #f0f0f0; cursor: not-allowed;" />
      </div>
      <div class="devolucao-vendas-result">
        <div class="devolucao-vendas-result-title">Devoluo sobre Vendas</div>
        <div class="devolucao-vendas-result-value">
          ${A&&Number(A)>0?`${(a.valorTotalLancado/Number(A)*100).toFixed(2)}%`:"0.00%"}
        </div>
        <div class="devolucao-vendas-result-desc">Resultado: LANADA</div>
      </div>
    </div>
  </div>
  
  <!-- Seo 1: Evoluo no Tempo | Top Clientes -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Evoluo no Tempo</div>
      <div class="chart-container">
        <canvas id="chartEvolucao"></canvas>
      </div>
    </div>
    <div class="chart-section">
      <div class="chart-title">Top Clientes (Valor)</div>
      <div class="chart-container">
        <canvas id="chartTopClientes"></canvas>
      </div>
    </div>
  </div>
  
  <!-- Seo 2: Top Vendedores | Top Redes -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Top Vendedores (Valor)</div>
      <div class="chart-container">
        <canvas id="chartVendedores"></canvas>
      </div>
    </div>
    <div class="chart-section">
      <div class="chart-title">Top Redes (Valor)</div>
      <div class="chart-container">
        <canvas id="chartRedes"></canvas>
      </div>
    </div>
  </div>
  
  <!-- Seo 3: Anlise de Pareto | Clientes com Reincidncia -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Anlise de Pareto (80/20)</div>
      <div class="chart-container">
        <canvas id="chartPareto"></canvas>
      </div>
    </div>
    <div class="chart-section">
      <div class="chart-title">Clientes com Reincidncia</div>
      <div class="chart-container">
        <canvas id="chartReincidencia"></canvas>
      </div>
    </div>
  </div>
  
  <!-- Seo 4: Devolues Por Motivo | Devolues Por Setores -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Devolues Por Motivo (Apenas LANADA)</div>
      <div class="chart-container">
        <canvas id="chartMotivos"></canvas>
      </div>
    </div>
    <div class="chart-section">
      <div class="chart-title">Devolues Por Setores (Apenas LANADA)</div>
      <div class="chart-container">
        <canvas id="chartSetores"></canvas>
      </div>
    </div>
  </div>
  
  <!-- Seo 5: Top 20 Produtos | Insights -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Top 20 Produtos mais devolvidos (${w})</div>
      <div class="chart-container">
        <canvas id="chartProdutos"></canvas>
      </div>
    </div>
    ${g.length>0?`
    <div class="chart-section">
      <div class="chart-title">Insights Automticos</div>
      <div class="insights-container">
        ${g.map(te=>`
          <div class="insight-item">${te}</div>
        `).join("")}
      </div>
    </div>
    `:'<div class="chart-section"></div>'}
  </div>
  
  <!-- Tabelas de Motivos -->
  <div class="tables-section">
    <div class="tables-grid">
      <!-- Tabela 1: Motivos por Produto -->
      <div class="table-card">
        <div class="table-title">Motivos por Produto</div>
        <div class="table-description">5 produtos mais devolvidos do top 10 maiores motivos (Apenas LANADA)</div>
        <div class="table-container">
          ${D.length>0?`
          <table>
            <thead>
              <tr>
                <th>Produto</th>
                <th>Motivo</th>
                <th class="text-right">Qtd</th>
                <th class="text-right">Valor</th>
              </tr>
            </thead>
            <tbody>
              ${D.map(te=>`
                <tr>
                  <td>${(te.produto||"").length>20?(te.produto||"").substring(0,20)+"...":te.produto||""}</td>
                  <td>${(te.motivo||"").length>20?(te.motivo||"").substring(0,20)+"...":te.motivo||""}</td>
                  <td class="text-right">${(te.quantidade||0).toFixed(2)}</td>
                  <td class="text-right">R$ ${(te.valorTotal||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          `:'<p style="text-align: center; color: #999; font-size: 8px; padding: 10px;">Nenhum dado disponvel</p>'}
        </div>
      </div>
      
      <!-- Tabela 2: Motivos por Vendedor -->
      <div class="table-card">
        <div class="table-title">Motivos por Vendedor</div>
        <div class="table-description">5 motivos mais devolvidos por vendedor (Apenas LANADA)</div>
        <div class="table-container">
          ${P.length>0?`
          <table>
            <thead>
              <tr>
                <th>Vendedor</th>
                <th>Motivo</th>
                <th class="text-right">Qtd</th>
                <th class="text-right">Valor</th>
              </tr>
            </thead>
            <tbody>
              ${P.map(te=>`
                <tr>
                  <td>${(te.vendedor||"").length>15?(te.vendedor||"").substring(0,15)+"...":te.vendedor||""}</td>
                  <td>${(te.motivo||"").length>20?(te.motivo||"").substring(0,20)+"...":te.motivo||""}</td>
                  <td class="text-right">${te.quantidade||0}</td>
                  <td class="text-right">R$ ${(te.valorTotal||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          `:'<p style="text-align: center; color: #999; font-size: 8px; padding: 10px;">Nenhum dado disponvel</p>'}
        </div>
      </div>
      
      <!-- Tabela 3: Motivos por Setor -->
      <div class="table-card">
        <div class="table-title">Motivos por Setor</div>
        <div class="table-description">Top 5 motivos mais devolvidos por setor (Apenas LANADA)</div>
        <div class="table-container">
          ${Y.length>0?`
          <table>
            <thead>
              <tr>
                <th>Setor</th>
                <th>Motivo</th>
                <th class="text-right">Qtd</th>
                <th class="text-right">Valor</th>
              </tr>
            </thead>
            <tbody>
              ${Y.map(te=>`
                <tr>
                  <td>${te.setor||""}</td>
                  <td>${(te.motivo||"").length>20?(te.motivo||"").substring(0,20)+"...":te.motivo||""}</td>
                  <td class="text-right">${te.quantidade||0}</td>
                  <td class="text-right">R$ ${(te.valorTotal||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          `:'<p style="text-align: center; color: #999; font-size: 8px; padding: 10px;">Nenhum dado disponvel</p>'}
        </div>
      </div>
      
      <!-- Tabela 4: Motivos por Cliente -->
      <div class="table-card">
        <div class="table-title">Motivos por Cliente</div>
        <div class="table-description">Top 5 motivos mais devolvidos do top 10 clientes (Apenas LANADA)</div>
        <div class="table-container">
          ${z.length>0?`
          <table>
            <thead>
              <tr>
                <th>Cliente</th>
                <th>Motivo</th>
                <th class="text-right">Qtd</th>
                <th class="text-right">Valor</th>
              </tr>
            </thead>
            <tbody>
              ${z.map(te=>`
                <tr>
                  <td>${(te.cliente||"").length>20?(te.cliente||"").substring(0,20)+"...":te.cliente||""}</td>
                  <td>${(te.motivo||"").length>20?(te.motivo||"").substring(0,20)+"...":te.motivo||""}</td>
                  <td class="text-right">${te.quantidade||0}</td>
                  <td class="text-right">R$ ${(te.valorTotal||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
          `:'<p style="text-align: center; color: #999; font-size: 8px; padding: 10px;">Nenhum dado disponvel</p>'}
        </div>
      </div>
    </div>
  </div>
  
  <div class="footer">
    <p>Relatrio gerado automaticamente pelo Sistema de Devolues - Grupo Doce Mel</p>
    <p>Data de gerao: ${Wt(new Date,"dd/MM/yyyy 's' HH:mm:ss",{locale:br})}</p>
  </div>
</div>

<script>
  Chart.defaults.font.size = 8;
  Chart.defaults.color = '#1f2937';
  Chart.defaults.borderColor = '#e5e7eb';
  
  // Grfico de Evoluo no Tempo
  new Chart(document.getElementById('chartEvolucao'), {
    type: 'line',
    data: {
      labels: ${JSON.stringify(s.map(te=>te.name))},
      datasets: [{
        label: 'Valor Total (R$)',
        data: ${JSON.stringify(s.map(te=>te.value))},
        borderColor: '#17432a',
        backgroundColor: 'rgba(23, 67, 42, 0.15)',
        borderWidth: 2,
        fill: true,
        tension: 0.4
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#17432a',
          borderWidth: 1,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            color: '#1f2937',
            font: { size: 8 },
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR')
          },
          grid: { color: '#e5e7eb' }
        },
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 8 }
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
  
  // Grfico Top Clientes
  new Chart(document.getElementById('chartTopClientes'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(c.map(te=>te.name.length>12?te.name.substring(0,12)+"...":te.name))},
      datasets: [{
        label: 'Valor (R$)',
        data: ${JSON.stringify(c.map(te=>te.value))},
        backgroundColor: '#17432a',
        borderColor: '#0a4d33',
        borderWidth: 1
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      indexAxis: 'y',
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#17432a',
          borderWidth: 1,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.x.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      },
      scales: {
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 8 },
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR')
          },
          grid: { color: '#e5e7eb' }
        },
        y: {
          ticks: {
            color: '#1f2937',
            font: { size: 8 }
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
  
  // Grfico Top Vendedores
  new Chart(document.getElementById('chartVendedores'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(u.map(te=>te.name.length>12?te.name.substring(0,12)+"...":te.name))},
      datasets: [{
        label: 'Valor (R$)',
        data: ${JSON.stringify(u.map(te=>te.value))},
        backgroundColor: '#0a4d33',
        borderColor: '#17432a',
        borderWidth: 1
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#0a4d33',
          borderWidth: 1,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            color: '#1f2937',
            font: { size: 8 },
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR')
          },
          grid: { color: '#e5e7eb' }
        },
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 8 }
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
  
  // Grfico Top Redes
  new Chart(document.getElementById('chartRedes'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(f.map(te=>te.name.length>12?te.name.substring(0,12)+"...":te.name))},
      datasets: [{
        label: 'Valor (R$)',
        data: ${JSON.stringify(f.map(te=>te.value))},
        backgroundColor: '#065f46',
        borderColor: '#0a4d33',
        borderWidth: 1
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#065f46',
          borderWidth: 1,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            color: '#1f2937',
            font: { size: 8 },
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR')
          },
          grid: { color: '#e5e7eb' }
        },
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 8 }
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
  
  // Grfico Pareto
  new Chart(document.getElementById('chartPareto'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(v.map(te=>te.name.length>10?te.name.substring(0,10)+"...":te.name))},
      datasets: [{
        type: 'bar',
        label: 'Valor (R$)',
        data: ${JSON.stringify(v.map(te=>te.value))},
        backgroundColor: '#17432a',
        borderColor: '#0a4d33',
        borderWidth: 1,
        yAxisID: 'y'
      }, {
        type: 'line',
        label: '% Acumulado',
        data: ${JSON.stringify(v.map(te=>te.percentage))},
        borderColor: '#dc2626',
        backgroundColor: 'rgba(220, 38, 38, 0.1)',
        borderWidth: 2,
        yAxisID: 'y1',
        pointRadius: 3,
        pointBackgroundColor: '#dc2626'
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      interaction: {
        mode: 'index',
        intersect: false,
      },
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#17432a',
          borderWidth: 1
        }
      },
      scales: {
        y: {
          type: 'linear',
          display: true,
          position: 'left',
          ticks: {
            color: '#1f2937',
            font: { size: 8 },
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR')
          },
          grid: { color: '#e5e7eb' }
        },
        y1: {
          type: 'linear',
          display: true,
          position: 'right',
          max: 100,
          ticks: {
            color: '#dc2626',
            font: { size: 8 },
            callback: (value) => value + '%'
          },
          grid: {
            drawOnChartArea: false,
          }
        },
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 8 }
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
  
  // Grfico Reincidncia
  new Chart(document.getElementById('chartReincidencia'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(B.map(te=>te.name.length>12?te.name.substring(0,12)+"...":te.name))},
      datasets: [{
        label: 'Notas Canceladas',
        data: ${JSON.stringify(B.map(te=>te.count))},
        backgroundColor: '#dc2626',
        borderColor: '#b91c1c',
        borderWidth: 1
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#dc2626',
          borderWidth: 1
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            color: '#1f2937',
            font: { size: 8 },
            stepSize: 1
          },
          grid: { color: '#e5e7eb' }
        },
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 8 }
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
  
  // Grfico Motivos (Colunas Verticais)
  new Chart(document.getElementById('chartMotivos'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(X.map(te=>te.name.length>20?te.name.substring(0,20)+"...":te.name))},
      datasets: [{
        label: 'Valor Total (R$)',
        data: ${JSON.stringify(X.map(te=>te.valorTotal))},
        backgroundColor: '#17432a',
        borderColor: '#0a4d33',
        borderWidth: 1
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      indexAxis: 'x',
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#17432a',
          borderWidth: 1,
          callbacks: {
            label: (context) => {
              const dataIndex = context.dataIndex;
              const quantidade = ${JSON.stringify(X.map(te=>te.quantidade))}[dataIndex];
              return [
                'Valor: R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 }),
                'Quantidade: ' + quantidade + ' nota(s)'
              ];
            }
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            color: '#1f2937',
            font: { size: 8 },
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR')
          },
          grid: { color: '#e5e7eb' }
        },
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 7 },
            maxRotation: 45,
            minRotation: 45
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
  
  // Grfico Setores (Colunas Verticais)
  new Chart(document.getElementById('chartSetores'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(H.map(te=>te.name))},
      datasets: [{
        label: 'Valor Total (R$)',
        data: ${JSON.stringify(H.map(te=>te.valorTotal))},
        backgroundColor: '#0a4d33',
        borderColor: '#17432a',
        borderWidth: 1
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      indexAxis: 'x',
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#0a4d33',
          borderWidth: 1,
          callbacks: {
            label: (context) => {
              const dataIndex = context.dataIndex;
              const quantidade = ${JSON.stringify(H.map(te=>te.quantidade))}[dataIndex];
              return [
                'Valor: R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 }),
                'Quantidade: ' + quantidade + ' nota(s)'
              ];
            }
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            color: '#1f2937',
            font: { size: 8 },
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR')
          },
          grid: { color: '#e5e7eb' }
        },
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 8 }
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
  
  // Grfico Produtos (Colunas Verticais)
  new Chart(document.getElementById('chartProdutos'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(R.map(te=>(te.nameFull||te.name).length>15?(te.nameFull||te.name).substring(0,15)+"...":te.nameFull||te.name))},
      datasets: [{
        label: 'Quantidade (${w})',
        data: ${JSON.stringify(R.map(te=>te.quantidade))},
        backgroundColor: '#065f46',
        borderColor: '#0a4d33',
        borderWidth: 1
      }]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      indexAxis: 'x',
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0, 0, 0, 0.8)',
          titleColor: '#fff',
          bodyColor: '#fff',
          borderColor: '#065f46',
          borderWidth: 1,
          callbacks: {
            title: (items) => {
              const index = items[0].dataIndex;
              return ${JSON.stringify(R.map(te=>te.nameFull||te.name))}[index] || '';
            },
            label: (context) => context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ' ${w}'
          }
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          ticks: {
            color: '#1f2937',
            font: { size: 8 }
          },
          grid: { color: '#e5e7eb' }
        },
        x: {
          ticks: {
            color: '#1f2937',
            font: { size: 7 },
            maxRotation: 45,
            minRotation: 45
          },
          grid: { color: '#e5e7eb' }
        }
      }
    }
  });
<\/script>
</body>
</html>
  `,le=window.open("","_blank");le&&(le.document.write(fe),le.document.close())},ae=({active:ne,payload:Q})=>{if(!ne||!(Q!=null&&Q.length))return null;const fe=Q[0].payload,le=fe.valorTotal||0,te=fe.quantidade||fe.count||0,ce=fe.name||fe.nameFull||"",he=fe.nameFull||ce,Ee=fe.nameFull?w:fe.unidade||"nota(s)";return _.jsxs("div",{className:"bg-card border border-border rounded-md p-3 shadow-md",children:[_.jsx("p",{className:"text-sm font-bold text-foreground mb-2",children:he}),_.jsxs("div",{className:"space-y-1",children:[le>0&&_.jsxs("p",{className:"text-sm font-bold text-primary",children:["Valor Total: R$ ",le.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),te>0&&_.jsxs("p",{className:"text-sm text-muted-foreground",children:[le>0?"Quantidade: ":"",te.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})," ",Ee]})]})]})};return e?_.jsx("div",{className:"flex items-center justify-center min-h-screen",children:_.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"})}):_.jsxs("div",{className:"space-y-6",children:[_.jsx(Qi,{title:"Dashboard Lanadas",description:"Viso geral das devolues lanadas (Lanadas e Anuladas/Canceladas) com KPIs, grficos e insights automticos para anlise estratgica."}),_.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[_.jsx(Xf,{}),_.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[_.jsxs(Nt,{variant:"outline",size:"sm",onClick:M,className:"w-full md:w-auto shrink-0",children:[_.jsx(vm,{className:"mr-2 h-4 w-4"}),"Atualizar"]}),_.jsxs(Nt,{variant:"outline",size:"sm",onClick:se,className:"w-full md:w-auto shrink-0",children:[_.jsx(ik,{className:"mr-2 h-4 w-4"}),"Imprimir Dashboard"]})]})]}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-6",children:[_.jsx(Ba,{title:"Valor Total Devolvido",value:`R$ ${a.valorTotalLancado.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:Dp,description:"Resultado: LANADA"}),_.jsx(Ba,{title:"Notas Lanadas",value:a.notasLancadas,icon:Py,description:"Resultado: LANADA"}),_.jsx(Ba,{title:"Valor Total Cancelado",value:`R$ ${a.valorTotalCancelado.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:Dp,description:"Resultado: ANULADA/CANCELADA"}),_.jsx(Ba,{title:"Notas Canceladas",value:a.notasCanceladas,icon:Ao,description:"Resultado: ANULADA/CANCELADA"}),_.jsx(Ba,{title:"Produtos Devolvidos",value:a.totalProducts.toFixed(2),icon:Ul,description:"Quantidade total"}),_.jsx(Ba,{title:"Ticket Mdio",value:`R$ ${a.avgTicket.toLocaleString("pt-BR",{maximumFractionDigits:0})}`,icon:_u})]}),_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Devoluo sobre Vendas"}),_.jsx(Or,{children:"Calcule o percentual de devolues sobre o valor de vendas"})]}),_.jsx(Ot,{children:_.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-end",children:[_.jsxs("div",{className:"flex-1",children:[_.jsx(kr,{htmlFor:"valorVendas",children:"Valor de Vendas (R$)"}),_.jsx(_r,{id:"valorVendas",type:"number",placeholder:"Digite o valor de vendas",value:A,onChange:ne=>T(ne.target.value),className:"mt-2"})]}),_.jsx("div",{className:"flex-1",children:_.jsx(Ba,{title:"Devoluo sobre Vendas",value:A&&Number(A)>0?`${(a.valorTotalLancado/Number(A)*100).toFixed(2)}%`:"0.00%",icon:nk,description:"Resultado: LANADA"})})]})})]}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[_.jsxs(jt,{className:"col-span-4",children:[_.jsx(Dt,{children:_.jsx(Rt,{children:"Evoluo no Tempo"})}),_.jsx(Ot,{className:"pl-2",children:_.jsx(Jr,{width:"100%",height:350,children:_.jsxs(xy,{data:s,children:[_.jsx("defs",{children:_.jsxs("linearGradient",{id:"colorValue",x1:"0",y1:"0",x2:"0",y2:"1",children:[_.jsx("stop",{offset:"5%",stopColor:L[0],stopOpacity:.8}),_.jsx("stop",{offset:"95%",stopColor:L[0],stopOpacity:0})]})}),_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",height:60,tick:_.jsx(ys,{})}),_.jsx($r,{className:"text-[6px] font-size-6px font-bold",tickFormatter:ne=>`R$${ne}`}),_.jsx(Qr,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)",color:"var(--foreground)",fontSize:"11px",fontWeight:"bold"},formatter:(ne,Q)=>Q==="value"?[`R$ ${(ne||0).toFixed(2)}`,"Valor Total"]:Q==="count"?[`${ne||0}`,"Qtd de Notas"]:[ne,Q||""],labelFormatter:ne=>`Data: ${ne}`}),_.jsx(yy,{type:"monotone",dataKey:"value",stroke:L[0],fillOpacity:1,fill:"url(#colorValue)"}),_.jsx(Xl,{type:"monotone",dataKey:"count",stroke:L[1],strokeWidth:2,dot:{fill:L[1],r:4}})]})})})]}),_.jsxs(jt,{className:"col-span-4",children:[_.jsx(Dt,{children:_.jsx(Rt,{children:"Top Clientes (Valor)"})}),_.jsx(Ot,{children:_.jsx(Jr,{width:"100%",height:350,children:_.jsxs(Xn,{data:c,children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",height:60,tick:_.jsx(ys,{})}),_.jsx($r,{className:"text-[6px] font-bold",tickFormatter:ne=>`R$${ne}`}),_.jsx(Qr,{content:_.jsx(Z,{})}),_.jsx(jn,{dataKey:"value",fill:L[0],radius:[8,8,0,0],children:_.jsx(Pn,{dataKey:"value",position:"top",content:({value:ne})=>_.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(ne||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]})]}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[_.jsxs(jt,{children:[_.jsx(Dt,{children:_.jsx(Rt,{children:"Top Vendedores (Valor)"})}),_.jsx(Ot,{children:_.jsx(Jr,{width:"100%",height:300,children:_.jsxs(Xn,{data:u,children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",height:60,tick:_.jsx(ys,{})}),_.jsx($r,{className:"text-[10px] font-bold",tickFormatter:ne=>`R$${ne}`}),_.jsx(Qr,{content:_.jsx(Z,{})}),_.jsx(jn,{dataKey:"value",fill:L[1],radius:[8,8,0,0],children:_.jsx(Pn,{dataKey:"value",position:"top",content:({value:ne})=>_.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(ne||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]}),_.jsxs(jt,{children:[_.jsx(Dt,{children:_.jsx(Rt,{children:"Top Redes (Valor)"})}),_.jsx(Ot,{children:_.jsx(Jr,{width:"100%",height:300,children:_.jsxs(Xn,{data:f,children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",height:60,tick:_.jsx(ys,{})}),_.jsx($r,{className:"text-[10px] font-bold",tickFormatter:ne=>`R$${ne}`}),_.jsx(Qr,{content:_.jsx(Z,{})}),_.jsx(jn,{dataKey:"value",fill:L[2],radius:[8,8,0,0],children:_.jsx(Pn,{dataKey:"value",position:"top",content:({value:ne})=>_.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(ne||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})})})]})]}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Top 5 Clientes com Reincidncia"}),_.jsx(Or,{children:"Clientes com mais notas ANULADAS/CANCELADAS"})]}),_.jsx(Ot,{children:_.jsx(Jr,{width:"100%",height:300,children:_.jsxs(Xn,{data:B,children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",height:60,tick:_.jsx(ys,{})}),_.jsx($r,{className:"text-[10px] font-bold"}),_.jsx(Qr,{content:_.jsx(Z,{})}),_.jsx(jn,{dataKey:"count",fill:L[3],radius:[8,8,0,0],children:_.jsx(Pn,{dataKey:"count",position:"top",content:({value:ne})=>_.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`${ne||0}`})})})]})})})]}),_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Motivos Mais Recorrentes por Rede"}),_.jsx(Or,{children:"Principais motivos de devoluo por rede (Top 5 redes)"})]}),_.jsx(Ot,{children:_.jsx(Jr,{width:"100%",height:300,children:_.jsxs(Xn,{data:V,layout:"vertical",children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{type:"number",className:"text-[10px] font-bold"}),_.jsx($r,{type:"category",dataKey:"rede",width:100,tick:_.jsx(ys,{})}),_.jsx(Qr,{content:_.jsx(Z,{})}),_.jsx(jn,{dataKey:"count",fill:L[4],radius:[0,8,8,0],children:_.jsx(Pn,{dataKey:"count",position:"right",content:({value:ne})=>_.jsx("text",{x:0,y:0,dx:5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"start",children:`${ne||0}`})})})]})})})]})]}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[_.jsxs(jt,{children:[_.jsx(Dt,{children:_.jsx(Rt,{children:"Anlise de Pareto (80/20)"})}),_.jsxs(Ot,{children:[_.jsx(Jr,{width:"100%",height:350,children:_.jsxs(wy,{data:v,children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",height:60,tick:_.jsx(ys,{})}),_.jsx($r,{yAxisId:"left",className:"text-[10px] font-bold",tickFormatter:ne=>`R$${ne}`}),_.jsx($r,{yAxisId:"right",orientation:"right",className:"text-[10px] font-bold",tickFormatter:ne=>`${ne}%`}),_.jsx(Qr,{content:_.jsx(Z,{})}),_.jsx(jn,{yAxisId:"left",dataKey:"value",fill:L[0],radius:[8,8,0,0],children:_.jsx(Pn,{dataKey:"value",position:"top",content:({value:ne})=>_.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(ne||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})}),_.jsx(Xl,{yAxisId:"right",type:"monotone",dataKey:"percentage",stroke:L[3],strokeWidth:2})]})}),_.jsx("div",{className:"mt-4 text-xs text-muted-foreground",children:"Linha mostra o percentual acumulado. A regra 80/20 indica que poucos clientes concentram a maioria do valor."})]})]}),_.jsxs(jt,{children:[_.jsx(Dt,{children:_.jsx(Rt,{children:"Insights Automticos"})}),_.jsx(Ot,{children:_.jsx("div",{className:"space-y-3",children:g.length>0?g.map((ne,Q)=>_.jsx("div",{className:"p-3 bg-muted/50 rounded-lg text-sm",children:ne},Q)):_.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum insight disponvel no momento."})})})]})]}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Devolues Por Motivo"}),_.jsx(Or,{children:"Valor total e quantidade de notas por motivo"})]}),_.jsx(Ot,{children:X.length>0?_.jsx(Jr,{width:"100%",height:300,children:_.jsxs(Xn,{data:X,children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",height:60,tick:_.jsx(ys,{})}),_.jsx($r,{className:"text-[10px] font-bold",tickFormatter:ne=>`R$${ne}`}),_.jsx(Qr,{content:_.jsx(ae,{})}),_.jsx(jn,{dataKey:"valorTotal",fill:L[0],radius:[8,8,0,0],children:_.jsx(Pn,{dataKey:"valorTotal",position:"top",content:({value:ne})=>_.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:9,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(ne||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})}):_.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-muted-foreground text-center p-4",children:[_.jsx(Ul,{className:"h-10 w-10 mb-2 opacity-20"}),_.jsx("p",{className:"text-sm",children:"Nenhum dado disponvel."})]})})]}),_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Devolues Por Setores"}),_.jsx(Or,{children:"Valor total e quantidade de notas por setor"})]}),_.jsx(Ot,{children:H.length>0?_.jsx(Jr,{width:"100%",height:300,children:_.jsxs(Xn,{data:H,children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",height:60,tick:_.jsx(ys,{})}),_.jsx($r,{className:"text-[10px] font-bold",tickFormatter:ne=>`R$${ne}`}),_.jsx(Qr,{content:_.jsx(ae,{})}),_.jsx(jn,{dataKey:"valorTotal",fill:L[0],radius:[8,8,0,0],children:_.jsx(Pn,{dataKey:"valorTotal",position:"top",content:({value:ne})=>_.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:9,fontWeight:"bold",textAnchor:"middle",children:`R$ ${(ne||0).toLocaleString("pt-BR",{maximumFractionDigits:0})}`})})})]})}):_.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-muted-foreground text-center p-4",children:[_.jsx(Ul,{className:"h-10 w-10 mb-2 opacity-20"}),_.jsx("p",{className:"text-sm",children:"Nenhum dado disponvel."})]})})]})]}),_.jsxs(jt,{children:[_.jsx(Dt,{children:_.jsx(Rt,{className:"text-base",children:"Distribuio por Municpio"})}),_.jsx(Ot,{children:N.length>0?_.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[_.jsx("div",{className:"space-y-4",children:N.slice(0,10).map((ne,Q)=>_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Mp,{className:"h-4 w-4 text-muted-foreground"}),_.jsx("span",{className:"text-sm font-medium truncate max-w-[120px]",title:ne.name,children:ne.name})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("div",{className:"h-2 bg-muted rounded-full w-24 overflow-hidden",children:_.jsx("div",{className:"h-full bg-primary",style:{width:`${ne.value/(a.totalValue||1)*100}%`}})}),_.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:[(ne.value/(a.totalValue||1)*100).toFixed(0),"%"]})]})]},Q))}),_.jsx("div",{className:"space-y-4",children:N.slice(10,20).map((ne,Q)=>_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Mp,{className:"h-4 w-4 text-muted-foreground"}),_.jsx("span",{className:"text-sm font-medium truncate max-w-[120px]",title:ne.name,children:ne.name})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("div",{className:"h-2 bg-muted rounded-full w-24 overflow-hidden",children:_.jsx("div",{className:"h-full bg-primary",style:{width:`${ne.value/(a.totalValue||1)*100}%`}})}),_.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:[(ne.value/(a.totalValue||1)*100).toFixed(0),"%"]})]})]},Q+10))})]}):_.jsx("div",{className:"text-center text-sm text-muted-foreground py-8",children:"Nenhum dado disponvel"})})]}),_.jsxs(jt,{className:"col-span-4",children:[_.jsx(Dt,{children:_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsx(Rt,{children:"Top 20 Produtos mais devolvidos"}),_.jsxs($a,{value:w,onValueChange:ne=>E(ne),children:[_.jsx(xa,{className:"w-[120px]",children:_.jsx(Va,{})}),_.jsxs(ya,{children:[_.jsx(sr,{value:"KG",children:"KG"}),_.jsx(sr,{value:"CX",children:"CX"})]})]})]})}),_.jsx(Ot,{className:"pl-2",children:R.length>0?_.jsx(Jr,{width:"100%",height:350,children:_.jsxs(Xn,{data:R,children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",height:80,tick:_.jsx(ys,{})}),_.jsx($r,{className:"text-[10px] font-bold"}),_.jsx(Qr,{content:_.jsx(ae,{})}),_.jsx(jn,{dataKey:"quantidade",fill:L[0],radius:[8,8,0,0],children:_.jsx(Pn,{dataKey:"quantidade",position:"top",content:({value:ne})=>_.jsx("text",{x:0,y:0,dy:-5,fill:y?"#d2f8f7":"#17432a",fontSize:10,fontWeight:"bold",textAnchor:"middle",children:`${(ne||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})} ${w}`})})})]})}):_.jsxs("div",{className:"flex flex-col items-center justify-center h-[350px] text-muted-foreground text-center p-4",children:[_.jsx(Ul,{className:"h-10 w-10 mb-2 opacity-20"}),_.jsx("p",{className:"text-sm",children:"Nenhum produto encontrado para o perodo selecionado."})]})})]}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Motivos por Produto"}),_.jsx(Or,{children:"5 produtos mais devolvidos do top 10 maiores motivos (Apenas LANADA)"})]}),_.jsx(Ot,{children:D.length>0?_.jsx("div",{className:"rounded-md border",children:_.jsxs(Un,{children:[_.jsx(Jn,{children:_.jsxs(dr,{children:[_.jsx(Tt,{className:"text-[10px]",children:"Produto"}),_.jsx(Tt,{className:"text-[10px]",children:"Motivo"}),_.jsx(Tt,{className:"text-[10px] text-right",children:"Qtd"}),_.jsx(Tt,{className:"text-[10px] text-right",children:"Valor"})]})}),_.jsx(zn,{children:D.map((ne,Q)=>_.jsxs(dr,{children:[_.jsx(Pt,{className:"text-[10px] font-medium",children:ne.produto.length>20?ne.produto.substring(0,20)+"...":ne.produto}),_.jsx(Pt,{className:"text-[10px]",children:ne.motivo.length>20?ne.motivo.substring(0,20)+"...":ne.motivo}),_.jsx(Pt,{className:"text-[10px] text-right",children:ne.quantidade.toFixed(2)}),_.jsxs(Pt,{className:"text-[10px] text-right",children:["R$ ",ne.valorTotal.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},Q))})]})}):_.jsx("div",{className:"text-center text-sm text-muted-foreground py-8",children:"Nenhum dado disponvel"})})]}),_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Motivos por Vendedor"}),_.jsx(Or,{children:"5 motivos mais devolvidos por vendedor (Apenas LANADA)"})]}),_.jsx(Ot,{children:P.length>0?_.jsx("div",{className:"rounded-md border",children:_.jsxs(Un,{children:[_.jsx(Jn,{children:_.jsxs(dr,{children:[_.jsx(Tt,{className:"text-[10px]",children:"Vendedor"}),_.jsx(Tt,{className:"text-[10px]",children:"Motivo"}),_.jsx(Tt,{className:"text-[10px] text-right",children:"Qtd"}),_.jsx(Tt,{className:"text-[10px] text-right",children:"Valor"})]})}),_.jsx(zn,{children:P.map((ne,Q)=>_.jsxs(dr,{children:[_.jsx(Pt,{className:"text-[10px] font-medium",children:ne.vendedor.length>15?ne.vendedor.substring(0,15)+"...":ne.vendedor}),_.jsx(Pt,{className:"text-[10px]",children:ne.motivo.length>20?ne.motivo.substring(0,20)+"...":ne.motivo}),_.jsx(Pt,{className:"text-[10px] text-right",children:ne.quantidade}),_.jsxs(Pt,{className:"text-[10px] text-right",children:["R$ ",ne.valorTotal.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},Q))})]})}):_.jsx("div",{className:"text-center text-sm text-muted-foreground py-8",children:"Nenhum dado disponvel"})})]}),_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Motivos por Setor"}),_.jsx(Or,{children:"Top 5 motivos mais devolvidos por setor (Apenas LANADA)"})]}),_.jsx(Ot,{children:Y.length>0?_.jsx("div",{className:"rounded-md border",children:_.jsxs(Un,{children:[_.jsx(Jn,{children:_.jsxs(dr,{children:[_.jsx(Tt,{className:"text-[10px]",children:"Setor"}),_.jsx(Tt,{className:"text-[10px]",children:"Motivo"}),_.jsx(Tt,{className:"text-[10px] text-right",children:"Qtd"}),_.jsx(Tt,{className:"text-[10px] text-right",children:"Valor"})]})}),_.jsx(zn,{children:Y.map((ne,Q)=>_.jsxs(dr,{children:[_.jsx(Pt,{className:"text-[10px] font-medium",children:ne.setor}),_.jsx(Pt,{className:"text-[10px]",children:ne.motivo.length>20?ne.motivo.substring(0,20)+"...":ne.motivo}),_.jsx(Pt,{className:"text-[10px] text-right",children:ne.quantidade}),_.jsxs(Pt,{className:"text-[10px] text-right",children:["R$ ",ne.valorTotal.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},Q))})]})}):_.jsx("div",{className:"text-center text-sm text-muted-foreground py-8",children:"Nenhum dado disponvel"})})]}),_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Motivos por Cliente"}),_.jsx(Or,{children:"Top 5 motivos mais devolvidos do top 10 clientes (Apenas LANADA)"})]}),_.jsx(Ot,{children:z.length>0?_.jsx("div",{className:"rounded-md border",children:_.jsxs(Un,{children:[_.jsx(Jn,{children:_.jsxs(dr,{children:[_.jsx(Tt,{className:"text-[10px]",children:"Cliente"}),_.jsx(Tt,{className:"text-[10px]",children:"Motivo"}),_.jsx(Tt,{className:"text-[10px] text-right",children:"Qtd"}),_.jsx(Tt,{className:"text-[10px] text-right",children:"Valor"})]})}),_.jsx(zn,{children:z.map((ne,Q)=>_.jsxs(dr,{children:[_.jsx(Pt,{className:"text-[10px] font-medium",children:ne.cliente.length>20?ne.cliente.substring(0,20)+"...":ne.cliente}),_.jsx(Pt,{className:"text-[10px]",children:ne.motivo.length>20?ne.motivo.substring(0,20)+"...":ne.motivo}),_.jsx(Pt,{className:"text-[10px] text-right",children:ne.quantidade}),_.jsxs(Pt,{className:"text-[10px] text-right",children:["R$ ",ne.valorTotal.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},Q))})]})}):_.jsx("div",{className:"text-center text-sm text-muted-foreground py-8",children:"Nenhum dado disponvel"})})]})]})]})}const XN=$f("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),n_=_e.forwardRef(({className:t,variant:r,...e},n)=>_.jsx("div",{ref:n,role:"alert",className:Et(XN({variant:r}),t),...e}));n_.displayName="Alert";const a_=_e.forwardRef(({className:t,...r},e)=>_.jsx("div",{ref:e,className:Et("text-sm [&_p]:leading-relaxed",t),...r}));a_.displayName="AlertDescription";const KN=_e.forwardRef(({className:t,...r},e)=>_.jsx("h5",{ref:e,className:Et("mb-1 font-medium leading-none tracking-tight",t),...r}));KN.displayName="AlertTitle";function ZN(){const[t,r]=_e.useState(""),[e,n]=_e.useState(""),[a,o]=_e.useState(""),[s,l]=_e.useState(!0),[c,i]=_e.useState(!1),[u,p]=_e.useState(null),f=r8();_e.useEffect(()=>{(async()=>{const{data:{session:b}}=await St.auth.getSession();b!=null&&b.user&&f("/dashboard")})()},[f]);const h=async v=>{v.preventDefault(),i(!0),p(null);const b=t.trim();try{if(s){const{data:g,error:x}=await St.auth.signInWithPassword({email:b,password:e});if(x)throw x;g.user&&(console.log(" Login bem-sucedido!"),_t.success("Login realizado com sucesso!"),i(!1),setTimeout(()=>{f("/dashboard")},300))}else{const{data:g,error:x}=await St.auth.signUp({email:b,password:e,options:{data:{name:a}}});if(x)throw x;g.user&&(_t.success("Conta criada com sucesso! Voc j pode entrar."),g.session?f("/dashboard"):l(!0))}}catch(g){console.error(g);let x=g.message;x.includes("Invalid login credentials")?x="Usurio no encontrado ou senha incorreta.":x.includes("User already registered")&&(x="Este email j est cadastrado. Tente fazer login."),p(x),_t.error("Erro de Autenticao")}finally{i(!1)}};return _.jsxs("div",{className:"flex items-center justify-center min-h-screen bg-background relative overflow-hidden",children:[_.jsx("div",{className:"absolute w-full h-1/2 bg-primary/10 -skew-y-3 origin-top-left z-0"}),_.jsxs(jt,{className:"w-full max-w-md z-10 border-t-4 border-t-primary shadow-2xl bg-card",children:[_.jsxs(Dt,{className:"text-center pb-2",children:[_.jsx("div",{className:"mx-auto mb-6 flex items-center justify-center",children:_.jsx("div",{className:"h-32 w-32 relative flex items-center justify-center bg-white rounded-full shadow-md p-3",children:_.jsx("img",{src:"https://i.ibb.co/zTq5KR0s/Chat-GPT-Image-26-de-dez-de-2025-19-10-20-removebg-preview.png",alt:"Logo Doce Mel",className:"object-contain h-full w-full",style:{backgroundColor:"unset",borderColor:"transparent",background:"unset",borderStyle:"none",borderImage:"none"}})})}),_.jsx("h1",{className:"text-2xl font-bold text-primary font-serif tracking-wide",children:"GRUPO DOCE MEL"}),_.jsx(Rt,{className:"text-lg font-medium text-foreground/80",children:"Gesto de Devolues"}),_.jsx(Or,{children:s?"Entre com suas credenciais.":"Crie sua conta de Administrador."})]}),_.jsxs("form",{onSubmit:h,children:[_.jsxs(Ot,{className:"space-y-4",children:[u&&_.jsxs(n_,{variant:"destructive",children:[_.jsx(Iy,{className:"h-4 w-4"}),_.jsx(a_,{children:u})]}),!s&&_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{htmlFor:"name",children:"Nome Completo"}),_.jsx(_r,{id:"name",placeholder:"Ex: Obedys",value:a,onChange:v=>o(v.target.value),required:!s})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{htmlFor:"email",children:"Email"}),_.jsx(_r,{id:"email",type:"email",placeholder:"email@exemplo.com",value:t,onChange:v=>r(v.target.value),required:!0})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{htmlFor:"password",children:"Senha"}),_.jsx(_r,{id:"password",type:"password",value:e,onChange:v=>n(v.target.value),required:!0})]})]}),_.jsxs(Cy,{className:"flex flex-col gap-4 bg-muted/20 pt-6",children:[_.jsxs(Nt,{type:"submit",className:"w-full font-bold text-md h-11",disabled:c,children:[c&&_.jsx(oi,{className:"mr-2 h-4 w-4 animate-spin"}),s?"ENTRAR":"CRIAR CONTA"]}),_.jsx(Nt,{type:"button",variant:"link",onClick:()=>{l(!s),p(null)},children:s?"No possui acesso? Solicite aqui":"J possui conta? Voltar ao login"})]})]})]}),_.jsx("div",{className:"absolute bottom-4 text-center text-xs text-muted-foreground opacity-50",children:" 2025 Grupo Doce Mel."})]})}const s_=W5,Lm=_e.forwardRef(({className:t,...r},e)=>_.jsx(H5,{ref:e,className:Et("border-b",t),...r}));Lm.displayName="AccordionItem";const Bm=_e.forwardRef(({className:t,children:r,...e},n)=>_.jsx(q5,{className:"flex",children:_.jsxs(uy,{ref:n,className:Et("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180",t),...e,children:[r,_.jsx(Uu,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})}));Bm.displayName=uy.displayName;const Um=_e.forwardRef(({className:t,children:r,...e},n)=>_.jsx(dy,{ref:n,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...e,children:_.jsx("div",{className:Et("pb-4 pt-0",t),children:r})}));Um.displayName=dy.displayName;const ri=X5,JN=K5,QN=G5,i_=_e.forwardRef(({className:t,...r},e)=>_.jsx(fy,{ref:e,className:Et("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r}));i_.displayName=fy.displayName;const As=_e.forwardRef(({className:t,children:r,...e},n)=>_.jsxs(QN,{children:[_.jsx(i_,{}),_.jsxs(hy,{ref:n,className:Et("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e,children:[r,_.jsxs(Y5,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[_.jsx(Vf,{className:"h-4 w-4"}),_.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));As.displayName=hy.displayName;const Cs=({className:t,...r})=>_.jsx("div",{className:Et("flex flex-col space-y-1.5 text-center sm:text-left",t),...r});Cs.displayName="DialogHeader";const Ns=({className:t,...r})=>_.jsx("div",{className:Et("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r});Ns.displayName="DialogFooter";const js=_e.forwardRef(({className:t,...r},e)=>_.jsx(py,{ref:e,className:Et("text-lg font-semibold leading-none tracking-tight",t),...r}));js.displayName=py.displayName;const Os=_e.forwardRef(({className:t,...r},e)=>_.jsx(my,{ref:e,className:Et("text-sm text-muted-foreground",t),...r}));Os.displayName=my.displayName;function ff(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var bp={exports:{}};/*! ExcelJS 19-10-2023 */var Wx;function ej(){return Wx||(Wx=1,function(t,r){(function(e){t.exports=e()})(function(){return function e(n,a,o){function s(i,u){if(!a[i]){if(!n[i]){var p=typeof ff=="function"&&ff;if(!u&&p)return p(i,!0);if(l)return l(i,!0);var f=new Error("Cannot find module '"+i+"'");throw f.code="MODULE_NOT_FOUND",f}var h=a[i]={exports:{}};n[i][0].call(h.exports,function(v){return s(n[i][1][v]||v)},h,h.exports,e,n,a,o)}return a[i].exports}for(var l=typeof ff=="function"&&ff,c=0;c<o.length;c++)s(o[c]);return s}({1:[function(e,n,a){const o=e("fs"),s=e("fast-csv"),l=e("dayjs/plugin/customParseFormat"),c=e("dayjs/plugin/utc"),i=e("dayjs").extend(l).extend(c),u=e("../utils/stream-buf"),{fs:{exists:p}}=e("../utils/utils"),f={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}};n.exports=class{constructor(h){this.workbook=h,this.worksheet=null}async readFile(h,v){if(v=v||{},!await p(h))throw new Error("File not found: "+h);const b=o.createReadStream(h),g=await this.read(b,v);return b.close(),g}read(h,v){return v=v||{},new Promise((b,g)=>{const x=this.workbook.addWorksheet(v.sheetName),y=v.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],k=v.map||function(F){if(F==="")return null;const B=Number(F);if(!Number.isNaN(B)&&B!==1/0)return B;const W=y.reduce((q,X)=>{if(q)return q;const I=i(F,X,!0);return I.isValid()?I:null},null);if(W)return new Date(W.valueOf());const V=f[F];return V!==void 0?V:F},N=s.parse(v.parserOptions).on("data",F=>{x.addRow(F.map(k))}).on("end",()=>{N.emit("worksheet",x)});N.on("worksheet",b).on("error",g),h.pipe(N)})}createInputStream(){throw new Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(h,v){return new Promise((b,g)=>{v=v||{};const x=this.workbook.getWorksheet(v.sheetName||v.sheetId),y=s.format(v.formatterOptions);h.on("finish",()=>{b()}),y.on("error",g),y.pipe(h);const{dateFormat:k,dateUTC:N}=v,F=v.map||(V=>{if(V){if(V.text||V.hyperlink)return V.hyperlink||V.text||"";if(V.formula||V.result)return V.result||"";if(V instanceof Date)return k?N?i.utc(V).format(k):i(V).format(k):N?i.utc(V).format():i(V).format();if(V.error)return V.error;if(typeof V=="object")return JSON.stringify(V)}return V}),B=v.includeEmptyRows===void 0||v.includeEmptyRows;let W=1;x&&x.eachRow((V,q)=>{if(B)for(;W++<q-1;)y.write([]);const{values:X}=V;X.shift(),y.write(X.map(F)),W=q}),y.end()})}writeFile(h,v){const b={encoding:(v=v||{}).encoding||"utf8"},g=o.createWriteStream(h,b);return this.write(g,v)}async writeBuffer(h){const v=new u;return await this.write(v,h),v.read()}}},{"../utils/stream-buf":24,"../utils/utils":27,dayjs:391,"dayjs/plugin/customParseFormat":392,"dayjs/plugin/utc":393,"fast-csv":424,fs:216}],2:[function(e,n,a){const o=e("../utils/col-cache");class s{constructor(c,i){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(this.worksheet=c,i)if(typeof i=="string"){const p=o.decodeAddress(i);this.nativeCol=p.col+u,this.nativeColOff=0,this.nativeRow=p.row+u,this.nativeRowOff=0}else i.nativeCol!==void 0?(this.nativeCol=i.nativeCol||0,this.nativeColOff=i.nativeColOff||0,this.nativeRow=i.nativeRow||0,this.nativeRowOff=i.nativeRowOff||0):i.col!==void 0?(this.col=i.col+u,this.row=i.row+u):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0);else this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0}static asInstance(c){return c instanceof s||c==null?c:new s(c)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(c){this.nativeCol=Math.floor(c),this.nativeColOff=Math.floor((c-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(c){this.nativeRow=Math.floor(c),this.nativeRowOff=Math.floor((c-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(1e4*this.worksheet.getColumn(this.nativeCol+1).width):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(1e4*this.worksheet.getRow(this.nativeRow+1).height):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(c){this.nativeCol=c.nativeCol,this.nativeColOff=c.nativeColOff,this.nativeRow=c.nativeRow,this.nativeRowOff=c.nativeRowOff}}n.exports=s},{"../utils/col-cache":19}],3:[function(e,n,a){const o=e("../utils/col-cache"),s=e("../utils/under-dash"),l=e("./enums"),{slideFormula:c}=e("../utils/shared-formula"),i=e("./note");class u{constructor(h,v,b){if(!h||!v)throw new Error("A Cell needs a Row");this._row=h,this._column=v,o.validateAddress(b),this._address=b,this._value=p.create(u.Types.Null,this),this.style=this._mergeStyle(h.style,v.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(h){this.style.numFmt=h}get font(){return this.style.font}set font(h){this.style.font=h}get alignment(){return this.style.alignment}set alignment(h){this.style.alignment=h}get border(){return this.style.border}set border(h){this.style.border=h}get fill(){return this.style.fill}set fill(h){this.style.fill=h}get protection(){return this.style.protection}set protection(h){this.style.protection=h}_mergeStyle(h,v,b){const g=h&&h.numFmt||v&&v.numFmt;g&&(b.numFmt=g);const x=h&&h.font||v&&v.font;x&&(b.font=x);const y=h&&h.alignment||v&&v.alignment;y&&(b.alignment=y);const k=h&&h.border||v&&v.border;k&&(b.border=k);const N=h&&h.fill||v&&v.fill;N&&(b.fill=N);const F=h&&h.protection||v&&v.protection;return F&&(b.protection=F),b}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return`$${this._column.letter}$${this.row}`}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===u.Types.Merge}merge(h,v){this._value.release(),this._value=p.create(u.Types.Merge,this,h),v||(this.style=h.style)}unmerge(){this.type===u.Types.Merge&&(this._value.release(),this._value=p.create(u.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(h){return this._value.type===u.Types.Merge&&this._value.isMergedTo(h)}get master(){return this.type===u.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===u.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(h){this.type!==u.Types.Merge?(this._value.release(),this._value=p.create(p.getType(h),this,h)):this._value.master.value=h}get note(){return this._comment&&this._comment.note}set note(h){this._comment=new i(h)}get text(){return this._value.toString()}get html(){return s.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(h){this.type===u.Types.String&&(this._value=p.create(u.Types.Hyperlink,this,{text:this._value.value,hyperlink:h}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){const{worksheet:h}=this._row;return{sheetName:h.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(h){this.names=[h]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(h){const{definedNames:v}=this.workbook;v.removeAllNames(this.fullAddress),h.forEach(b=>{v.addEx(this.fullAddress,b)})}addName(h){this.workbook.definedNames.addEx(this.fullAddress,h)}removeName(h){this.workbook.definedNames.removeEx(this.fullAddress,h)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(h){this._dataValidations.add(this.address,h)}get model(){const{model:h}=this._value;return h.style=this.style,this._comment&&(h.comment=this._comment.model),h}set model(h){if(this._value.release(),this._value=p.create(h.type,this),this._value.model=h,h.comment)switch(h.comment.type){case"note":this._comment=i.fromModel(h.comment)}h.style?this.style=h.style:this.style={}}}u.Types=l.ValueType;const p={getType:f=>f==null?u.Types.Null:f instanceof String||typeof f=="string"?u.Types.String:typeof f=="number"?u.Types.Number:typeof f=="boolean"?u.Types.Boolean:f instanceof Date?u.Types.Date:f.text&&f.hyperlink?u.Types.Hyperlink:f.formula||f.sharedFormula?u.Types.Formula:f.richText?u.Types.RichText:f.sharedString?u.Types.SharedString:f.error?u.Types.Error:u.Types.JSON,types:[{t:u.Types.Null,f:class{constructor(f){this.model={address:f.address,type:u.Types.Null}}get value(){return null}set value(f){}get type(){return u.Types.Null}get effectiveType(){return u.Types.Null}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return""}release(){}toString(){return""}}},{t:u.Types.Number,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Number,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Number}get effectiveType(){return u.Types.Number}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.String,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.String,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.String}get effectiveType(){return u.Types.String}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return`"${this.model.value.replace(/"/g,'""')}"`}release(){}toString(){return this.model.value}}},{t:u.Types.Date,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Date,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Date}get effectiveType(){return u.Types.Date}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.Hyperlink,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Hyperlink,text:h?h.text:void 0,hyperlink:h?h.hyperlink:void 0},h&&h.tooltip&&(this.model.tooltip=h.tooltip)}get value(){const f={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(f.tooltip=this.model.tooltip),f}set value(f){this.model={text:f.text,hyperlink:f.hyperlink},f.tooltip&&(this.model.tooltip=f.tooltip)}get text(){return this.model.text}set text(f){this.model.text=f}get hyperlink(){return this.model.hyperlink}set hyperlink(f){this.model.hyperlink=f}get type(){return u.Types.Hyperlink}get effectiveType(){return u.Types.Hyperlink}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}}},{t:u.Types.Formula,f:class{constructor(f,h){this.cell=f,this.model={address:f.address,type:u.Types.Formula,shareType:h?h.shareType:void 0,ref:h?h.ref:void 0,formula:h?h.formula:void 0,sharedFormula:h?h.sharedFormula:void 0,result:h?h.result:void 0}}_copyModel(f){const h={},v=b=>{const g=f[b];g&&(h[b]=g)};return v("formula"),v("result"),v("ref"),v("shareType"),v("sharedFormula"),h}get value(){return this._copyModel(this.model)}set value(f){this.model=this._copyModel(f)}validate(f){switch(p.getType(f)){case u.Types.Null:case u.Types.String:case u.Types.Number:case u.Types.Date:break;case u.Types.Hyperlink:case u.Types.Formula:default:throw new Error("Cannot process that type of result value")}}get dependencies(){return{ranges:this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),cells:this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g)}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(f){this.model.formula=f}get formulaType(){return this.model.formula?l.FormulaType.Master:this.model.sharedFormula?l.FormulaType.Shared:l.FormulaType.None}get result(){return this.model.result}set result(f){this.model.result=f}get type(){return u.Types.Formula}get effectiveType(){const f=this.model.result;return f==null?l.ValueType.Null:f instanceof String||typeof f=="string"?l.ValueType.String:typeof f=="number"?l.ValueType.Number:f instanceof Date?l.ValueType.Date:f.text&&f.hyperlink?l.ValueType.Hyperlink:f.formula?l.ValueType.Formula:l.ValueType.Null}get address(){return this.model.address}set address(f){this.model.address=f}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){const{worksheet:f}=this.cell,h=f.findCell(this.model.sharedFormula);this._translatedFormula=h&&c(h.formula,h.address,this.model.address)}return this._translatedFormula}toCsvString(){return""+(this.model.result||"")}release(){}toString(){return this.model.result?this.model.result.toString():""}}},{t:u.Types.Merge,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Merge,master:h?h.address:void 0},this._master=h,h&&h.addMergeRef()}get value(){return this._master.value}set value(f){f instanceof u?(this._master&&this._master.releaseMergeRef(),f.addMergeRef(),this._master=f):this._master.value=f}isMergedTo(f){return f===this._master}get master(){return this._master}get type(){return u.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}}},{t:u.Types.JSON,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.String,value:JSON.stringify(h),rawValue:h}}get value(){return this.model.rawValue}set value(f){this.model.rawValue=f,this.model.value=JSON.stringify(f)}get type(){return u.Types.String}get effectiveType(){return u.Types.String}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}}},{t:u.Types.SharedString,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.SharedString,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.SharedString}get effectiveType(){return u.Types.SharedString}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.RichText,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.String,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}toString(){return this.model.value.richText.map(f=>f.text).join("")}get type(){return u.Types.RichText}get effectiveType(){return u.Types.RichText}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return`"${this.text.replace(/"/g,'""')}"`}release(){}}},{t:u.Types.Boolean,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Boolean,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Boolean}get effectiveType(){return u.Types.Boolean}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.Error,f:class{constructor(f,h){this.model={address:f.address,type:u.Types.Error,value:h}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Error}get effectiveType(){return u.Types.Error}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}}}].reduce((f,h)=>(f[h.t]=h.f,f),[]),create(f,h,v){const b=this.types[f];if(!b)throw new Error("Could not create Value of type "+f);return new b(h,v)}};n.exports=u},{"../utils/col-cache":19,"../utils/shared-formula":23,"../utils/under-dash":26,"./enums":7,"./note":9}],4:[function(e,n,a){const o=e("../utils/under-dash"),s=e("./enums"),l=e("../utils/col-cache");class c{constructor(u,p,f){this._worksheet=u,this._number=p,f!==!1&&(this.defn=f)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return l.n2l(this._number)}get isCustomWidth(){return this.width!==void 0&&this.width!==9}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(u){u?(this.key=u.key,this.width=u.width!==void 0?u.width:9,this.outlineLevel=u.outlineLevel,u.style?this.style=u.style:this.style={},this.header=u.header,this._hidden=!!u.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(u){u!==void 0?(this._header=u,this.headers.forEach((p,f)=>{this._worksheet.getCell(f+1,this.number).value=p})):this._header=void 0}get key(){return this._key}set key(u){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=u,u&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(u){this._hidden=u}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(u){this._outlineLevel=u}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(u){return this.width===u.width&&this.hidden===u.hidden&&this.outlineLevel===u.outlineLevel&&o.isEqual(this.style,u.style)}get isDefault(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;const u=this.style;return!u||!(u.font||u.numFmt||u.alignment||u.border||u.fill||u.protection)}get headerCount(){return this.headers.length}eachCell(u,p){const f=this.number;p||(p=u,u=null),this._worksheet.eachRow(u,(h,v)=>{p(h.getCell(f),v)})}get values(){const u=[];return this.eachCell((p,f)=>{p&&p.type!==s.ValueType.Null&&(u[f]=p.value)}),u}set values(u){if(!u)return;const p=this.number;let f=0;u.hasOwnProperty("0")&&(f=1),u.forEach((h,v)=>{this._worksheet.getCell(v+f,p).value=h})}_applyStyle(u,p){return this.style[u]=p,this.eachCell(f=>{f[u]=p}),p}get numFmt(){return this.style.numFmt}set numFmt(u){this._applyStyle("numFmt",u)}get font(){return this.style.font}set font(u){this._applyStyle("font",u)}get alignment(){return this.style.alignment}set alignment(u){this._applyStyle("alignment",u)}get protection(){return this.style.protection}set protection(u){this._applyStyle("protection",u)}get border(){return this.style.border}set border(u){this._applyStyle("border",u)}get fill(){return this.style.fill}set fill(u){this._applyStyle("fill",u)}static toModel(u){const p=[];let f=null;return u&&u.forEach((h,v)=>{h.isDefault?f&&(f=null):f&&h.equivalentTo(f)?f.max=v+1:(f={min:v+1,max:v+1,width:h.width!==void 0?h.width:9,style:h.style,isCustomWidth:h.isCustomWidth,hidden:h.hidden,outlineLevel:h.outlineLevel,collapsed:h.collapsed},p.push(f))}),p.length?p:void 0}static fromModel(u,p){const f=[];let h=1,v=0;for(p=(p=p||[]).sort(function(b,g){return b.min-g.min});v<p.length;){const b=p[v++];for(;h<b.min;)f.push(new c(u,h++));for(;h<=b.max;)f.push(new c(u,h++,b))}return f.length?f:null}}n.exports=c},{"../utils/col-cache":19,"../utils/under-dash":26,"./enums":7}],5:[function(e,n,a){n.exports=class{constructor(o){this.model=o||{}}add(o,s){return this.model[o]=s}find(o){return this.model[o]}remove(o){this.model[o]=void 0}}},{}],6:[function(e,n,a){const o=e("../utils/under-dash"),s=e("../utils/col-cache"),l=e("../utils/cell-matrix"),c=e("./range"),i=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/;n.exports=class{constructor(){this.matrixMap={}}getMatrix(u){return this.matrixMap[u]||(this.matrixMap[u]=new l)}add(u,p){const f=s.decodeEx(u);this.addEx(f,p)}addEx(u,p){const f=this.getMatrix(p);if(u.top)for(let h=u.left;h<=u.right;h++)for(let v=u.top;v<=u.bottom;v++){const b={sheetName:u.sheetName,address:s.n2l(h)+v,row:v,col:h};f.addCellEx(b)}else f.addCellEx(u)}remove(u,p){const f=s.decodeEx(u);this.removeEx(f,p)}removeEx(u,p){this.getMatrix(p).removeCellEx(u)}removeAllNames(u){o.each(this.matrixMap,p=>{p.removeCellEx(u)})}forEach(u){o.each(this.matrixMap,(p,f)=>{p.forEach(h=>{u(f,h)})})}getNames(u){return this.getNamesEx(s.decodeEx(u))}getNamesEx(u){return o.map(this.matrixMap,(p,f)=>p.findCellEx(u)&&f).filter(Boolean)}_explore(u,p){p.mark=!1;const{sheetName:f}=p,h=new c(p.row,p.col,p.row,p.col,f);let v,b;function g(y,k){const N=u.findCellAt(f,y,p.col);return!(!N||!N.mark)&&(h[k]=y,N.mark=!1,!0)}for(b=p.row-1;g(b,"top");b--);for(b=p.row+1;g(b,"bottom");b++);function x(y,k){const N=[];for(b=h.top;b<=h.bottom;b++){const F=u.findCellAt(f,b,y);if(!F||!F.mark)return!1;N.push(F)}h[k]=y;for(let F=0;F<N.length;F++)N[F].mark=!1;return!0}for(v=p.col-1;x(v,"left");v--);for(v=p.col+1;x(v,"right");v++);return h}getRanges(u,p){return(p=p||this.matrixMap[u])?(p.forEach(f=>{f.mark=!0}),{name:u,ranges:p.map(f=>f.mark&&this._explore(p,f)).filter(Boolean).map(f=>f.$shortRange)}):{name:u,ranges:[]}}normaliseMatrix(u,p){u.forEachInSheet(p,(f,h,v)=>{f&&(f.row===h&&f.col===v||(f.row=h,f.col=v,f.address=s.n2l(v)+h))})}spliceRows(u,p,f,h){o.each(this.matrixMap,v=>{v.spliceRows(u,p,f,h),this.normaliseMatrix(v,u)})}spliceColumns(u,p,f,h){o.each(this.matrixMap,v=>{v.spliceColumns(u,p,f,h),this.normaliseMatrix(v,u)})}get model(){return o.map(this.matrixMap,(u,p)=>this.getRanges(p,u)).filter(u=>u.ranges.length)}set model(u){const p=this.matrixMap={};u.forEach(f=>{const h=p[f.name]=new l;f.ranges.forEach(v=>{i.test(v.split("!").pop()||"")&&h.addCell(v)})})}}},{"../utils/cell-matrix":18,"../utils/col-cache":19,"../utils/under-dash":26,"./range":10}],7:[function(e,n,a){n.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}},{}],8:[function(e,n,a){const o=e("../utils/col-cache"),s=e("./anchor");n.exports=class{constructor(l,c){this.worksheet=l,this.model=c}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw new Error("Invalid Image Type")}}set model(l){let{type:c,imageId:i,range:u,hyperlinks:p}=l;if(this.type=c,this.imageId=i,c==="image")if(typeof u=="string"){const f=o.decode(u);this.range={tl:new s(this.worksheet,{col:f.left,row:f.top},-1),br:new s(this.worksheet,{col:f.right,row:f.bottom},0),editAs:"oneCell"}}else this.range={tl:new s(this.worksheet,u.tl,0),br:u.br&&new s(this.worksheet,u.br,0),ext:u.ext,editAs:u.editAs,hyperlinks:p||u.hyperlinks}}}},{"../utils/col-cache":19,"./anchor":2}],9:[function(e,n,a){const o=e("../utils/under-dash");class s{constructor(c){this.note=c}get model(){let c=null;switch(typeof this.note){case"string":c={type:"note",note:{texts:[{text:this.note}]}};break;default:c={type:"note",note:this.note}}return o.deepMerge({},s.DEFAULT_CONFIGS,c)}set model(c){const{note:i}=c,{texts:u}=i;u.length===1&&Object.keys(u[0]).length===1?this.note=u[0].text:this.note=i}static fromModel(c){const i=new s;return i.model=c,i}}s.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},n.exports=s},{"../utils/under-dash":26}],10:[function(e,n,a){const o=e("../utils/col-cache");class s{constructor(){this.decode(arguments)}setTLBR(c,i,u,p,f){if(arguments.length<4){const h=o.decodeAddress(c),v=o.decodeAddress(i);this.model={top:Math.min(h.row,v.row),left:Math.min(h.col,v.col),bottom:Math.max(h.row,v.row),right:Math.max(h.col,v.col),sheetName:u},this.setTLBR(h.row,h.col,v.row,v.col,f)}else this.model={top:Math.min(c,u),left:Math.min(i,p),bottom:Math.max(c,u),right:Math.max(i,p),sheetName:f}}decode(c){switch(c.length){case 5:this.setTLBR(c[0],c[1],c[2],c[3],c[4]);break;case 4:this.setTLBR(c[0],c[1],c[2],c[3]);break;case 3:this.setTLBR(c[0],c[1],c[2]);break;case 2:this.setTLBR(c[0],c[1]);break;case 1:{const i=c[0];if(i instanceof s)this.model={top:i.model.top,left:i.model.left,bottom:i.model.bottom,right:i.model.right,sheetName:i.sheetName};else if(i instanceof Array)this.decode(i);else if(i.top&&i.left&&i.bottom&&i.right)this.model={top:i.top,left:i.left,bottom:i.bottom,right:i.right,sheetName:i.sheetName};else{const u=o.decodeEx(i);u.top?this.model={top:u.top,left:u.left,bottom:u.bottom,right:u.right,sheetName:u.sheetName}:this.model={top:u.row,left:u.col,bottom:u.row,right:u.col,sheetName:u.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error("Invalid number of arguments to _getDimensions() - "+c.length)}}get top(){return this.model.top||1}set top(c){this.model.top=c}get left(){return this.model.left||1}set left(c){this.model.left=c}get bottom(){return this.model.bottom||1}set bottom(c){this.model.bottom=c}get right(){return this.model.right||1}set right(c){this.model.right=c}get sheetName(){return this.model.sheetName}set sheetName(c){this.model.sheetName=c}get _serialisedSheetName(){const{sheetName:c}=this.model;return c?/^[a-zA-Z0-9]*$/.test(c)?c+"!":`'${c}'!`:""}expand(c,i,u,p){(!this.model.top||c<this.top)&&(this.top=c),(!this.model.left||i<this.left)&&(this.left=i),(!this.model.bottom||u>this.bottom)&&(this.bottom=u),(!this.model.right||p>this.right)&&(this.right=p)}expandRow(c){if(c){const{dimensions:i,number:u}=c;i&&this.expand(u,i.min,u,i.max)}}expandToAddress(c){const i=o.decodeEx(c);this.expand(i.row,i.col,i.row,i.col)}get tl(){return o.n2l(this.left)+this.top}get $t$l(){return`$${o.n2l(this.left)}$${this.top}`}get br(){return o.n2l(this.right)+this.bottom}get $b$r(){return`$${o.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(c){return(!c.sheetName||!this.sheetName||c.sheetName===this.sheetName)&&!(c.bottom<this.top)&&!(c.top>this.bottom)&&!(c.right<this.left)&&!(c.left>this.right)}contains(c){const i=o.decodeEx(c);return this.containsEx(i)}containsEx(c){return(!c.sheetName||!this.sheetName||c.sheetName===this.sheetName)&&c.row>=this.top&&c.row<=this.bottom&&c.col>=this.left&&c.col<=this.right}forEachAddress(c){for(let i=this.left;i<=this.right;i++)for(let u=this.top;u<=this.bottom;u++)c(o.encodeAddress(u,i),u,i)}}n.exports=s},{"../utils/col-cache":19}],11:[function(e,n,a){const o=e("../utils/under-dash"),s=e("./enums"),l=e("../utils/col-cache"),c=e("./cell");n.exports=class{constructor(i,u){this._worksheet=i,this._number=u,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(i){return this._cells[i-1]}getCellEx(i){let u=this._cells[i.col-1];if(!u){const p=this._worksheet.getColumn(i.col);u=new c(this,p,i.address),this._cells[i.col-1]=u}return u}getCell(i){if(typeof i=="string"){const u=this._worksheet.getColumnKey(i);i=u?u.number:l.l2n(i)}return this._cells[i-1]||this.getCellEx({address:l.encodeAddress(this._number,i),row:this._number,col:i})}splice(i,u){const p=i+u;for(var f=arguments.length,h=new Array(f>2?f-2:0),v=2;v<f;v++)h[v-2]=arguments[v];const b=h.length-u,g=this._cells.length;let x,y,k;if(b<0)for(x=i+h.length;x<=g;x++)k=this._cells[x-1],y=this._cells[x-b-1],y?(k=this.getCell(x),k.value=y.value,k.style=y.style,k._comment=y._comment):k&&(k.value=null,k.style={},k._comment=void 0);else if(b>0)for(x=g;x>=p;x--)y=this._cells[x-1],y?(k=this.getCell(x+b),k.value=y.value,k.style=y.style,k._comment=y._comment):this._cells[x+b-1]=void 0;for(x=0;x<h.length;x++)k=this.getCell(i+x),k.value=h[x],k.style={},k._comment=void 0}eachCell(i,u){if(u||(u=i,i=null),i&&i.includeEmpty){const p=this._cells.length;for(let f=1;f<=p;f++)u(this.getCell(f),f)}else this._cells.forEach((p,f)=>{p&&p.type!==s.ValueType.Null&&u(p,f+1)})}addPageBreak(i,u){const p=this._worksheet,f=Math.max(0,i-1)||0,h=Math.max(0,u-1)||16838,v={id:this._number,max:h,man:1};f&&(v.min=f),p.rowBreaks.push(v)}get values(){const i=[];return this._cells.forEach(u=>{u&&u.type!==s.ValueType.Null&&(i[u.col]=u.value)}),i}set values(i){if(this._cells=[],i)if(i instanceof Array){let u=0;i.hasOwnProperty("0")&&(u=1),i.forEach((p,f)=>{p!==void 0&&(this.getCellEx({address:l.encodeAddress(this._number,f+u),row:this._number,col:f+u}).value=p)})}else this._worksheet.eachColumnKey((u,p)=>{i[p]!==void 0&&(this.getCellEx({address:l.encodeAddress(this._number,u.number),row:this._number,col:u.number}).value=i[p])})}get hasValues(){return o.some(this._cells,i=>i&&i.type!==s.ValueType.Null)}get cellCount(){return this._cells.length}get actualCellCount(){let i=0;return this.eachCell(()=>{i++}),i}get dimensions(){let i=0,u=0;return this._cells.forEach(p=>{p&&p.type!==s.ValueType.Null&&((!i||i>p.col)&&(i=p.col),u<p.col&&(u=p.col))}),i>0?{min:i,max:u}:null}_applyStyle(i,u){return this.style[i]=u,this._cells.forEach(p=>{p&&(p[i]=u)}),u}get numFmt(){return this.style.numFmt}set numFmt(i){this._applyStyle("numFmt",i)}get font(){return this.style.font}set font(i){this._applyStyle("font",i)}get alignment(){return this.style.alignment}set alignment(i){this._applyStyle("alignment",i)}get protection(){return this.style.protection}set protection(i){this._applyStyle("protection",i)}get border(){return this.style.border}set border(i){this._applyStyle("border",i)}get fill(){return this.style.fill}set fill(i){this._applyStyle("fill",i)}get hidden(){return!!this._hidden}set hidden(i){this._hidden=i}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(i){this._outlineLevel=i}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){const i=[];let u=0,p=0;return this._cells.forEach(f=>{if(f){const h=f.model;h&&((!u||u>f.col)&&(u=f.col),p<f.col&&(p=f.col),i.push(h))}}),this.height||i.length?{cells:i,number:this.number,min:u,max:p,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(i){if(i.number!==this._number)throw new Error("Invalid row number in model");let u;this._cells=[],i.cells.forEach(p=>{switch(p.type){case c.Types.Merge:break;default:{let f;if(p.address)f=l.decodeAddress(p.address);else if(u){const{row:h}=u,v=u.col+1;f={row:h,col:v,address:l.encodeAddress(h,v),$col$row:`$${l.n2l(v)}$${h}`}}u=f,this.getCellEx(f).model=p;break}}}),i.height?this.height=i.height:delete this.height,this.hidden=i.hidden,this.outlineLevel=i.outlineLevel||0,this.style=i.style&&JSON.parse(JSON.stringify(i.style))||{}}}},{"../utils/col-cache":19,"../utils/under-dash":26,"./cell":3,"./enums":7}],12:[function(e,n,a){const o=e("../utils/col-cache");class s{constructor(c,i,u){this.table=c,this.column=i,this.index=u}_set(c,i){this.table.cacheState(),this.column[c]=i}get name(){return this.column.name}set name(c){this._set("name",c)}get filterButton(){return this.column.filterButton}set filterButton(c){this.column.filterButton=c}get style(){return this.column.style}set style(c){this.column.style=c}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(c){this._set("totalsRowLabel",c)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(c){this._set("totalsRowFunction",c)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(c){this._set("totalsRowResult",c)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(c){this._set("totalsRowFormula",c)}}n.exports=class{constructor(l,c){this.worksheet=l,c&&(this.table=c,this.validate(),this.store())}getFormula(l){switch(l.totalsRowFunction){case"none":return null;case"average":return`SUBTOTAL(101,${this.table.name}[${l.name}])`;case"countNums":return`SUBTOTAL(102,${this.table.name}[${l.name}])`;case"count":return`SUBTOTAL(103,${this.table.name}[${l.name}])`;case"max":return`SUBTOTAL(104,${this.table.name}[${l.name}])`;case"min":return`SUBTOTAL(105,${this.table.name}[${l.name}])`;case"stdDev":return`SUBTOTAL(106,${this.table.name}[${l.name}])`;case"var":return`SUBTOTAL(107,${this.table.name}[${l.name}])`;case"sum":return`SUBTOTAL(109,${this.table.name}[${l.name}])`;case"custom":return l.totalsRowFormula;default:throw new Error("Invalid Totals Row Function: "+l.totalsRowFunction)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){const{table:l}=this,c=(b,g,x)=>{b[g]===void 0&&(b[g]=x)};c(l,"headerRow",!0),c(l,"totalsRow",!1),c(l,"style",{}),c(l.style,"theme","TableStyleMedium2"),c(l.style,"showFirstColumn",!1),c(l.style,"showLastColumn",!1),c(l.style,"showRowStripes",!1),c(l.style,"showColumnStripes",!1);const i=(b,g)=>{if(!b)throw new Error(g)};i(l.ref,"Table must have ref"),i(l.columns,"Table must have column definitions"),i(l.rows,"Table must have row definitions"),l.tl=o.decodeAddress(l.ref);const{row:u,col:p}=l.tl;i(u>0,"Table must be on valid row"),i(p>0,"Table must be on valid col");const{width:f,filterHeight:h,tableHeight:v}=this;l.autoFilterRef=o.encode(u,p,u+h-1,p+f-1),l.tableRef=o.encode(u,p,u+v-1,p+f-1),l.columns.forEach((b,g)=>{i(b.name,`Column ${g} must have a name`),g===0?c(b,"totalsRowLabel","Total"):(c(b,"totalsRowFunction","none"),b.totalsRowFormula=this.getFormula(b))})}store(){const l=(h,v)=>{v&&Object.keys(v).forEach(b=>{h[b]=v[b]})},{worksheet:c,table:i}=this,{row:u,col:p}=i.tl;let f=0;if(i.headerRow){const h=c.getRow(u+f++);i.columns.forEach((v,b)=>{const{style:g,name:x}=v,y=h.getCell(p+b);y.value=x,l(y,g)})}if(i.rows.forEach(h=>{const v=c.getRow(u+f++);h.forEach((b,g)=>{const x=v.getCell(p+g);x.value=b,l(x,i.columns[g].style)})}),i.totalsRow){const h=c.getRow(u+f++);i.columns.forEach((v,b)=>{const g=h.getCell(p+b);if(b===0)g.value=v.totalsRowLabel;else{const x=this.getFormula(v);g.value=x?{formula:v.totalsRowFormula,result:v.totalsRowResult}:null}l(g,v.style)})}}load(l){const{table:c}=this,{row:i,col:u}=c.tl;let p=0;if(c.headerRow){const f=l.getRow(i+p++);c.columns.forEach((h,v)=>{f.getCell(u+v).value=h.name})}if(c.rows.forEach(f=>{const h=l.getRow(i+p++);f.forEach((v,b)=>{h.getCell(u+b).value=v})}),c.totalsRow){const f=l.getRow(i+p++);c.columns.forEach((h,v)=>{const b=f.getCell(u+v);v===0?b.value=h.totalsRowLabel:this.getFormula(h)&&(b.value={formula:h.totalsRowFormula,result:h.totalsRowResult})})}}get model(){return this.table}set model(l){this.table=l}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();const l=o.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let c=0;c<this._cache.tableHeight;c++){const i=this.worksheet.getRow(l.row+c);for(let u=0;u<this._cache.width;u++)i.getCell(l.col+u).value=null}else{for(let c=this.tableHeight;c<this._cache.tableHeight;c++){const i=this.worksheet.getRow(l.row+c);for(let u=0;u<this._cache.width;u++)i.getCell(l.col+u).value=null}for(let c=0;c<this.tableHeight;c++){const i=this.worksheet.getRow(l.row+c);for(let u=this.width;u<this._cache.width;u++)i.getCell(l.col+u).value=null}}this.store()}addRow(l,c){this.cacheState(),c===void 0?this.table.rows.push(l):this.table.rows.splice(c,0,l)}removeRows(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.rows.splice(l,c)}getColumn(l){const c=this.table.columns[l];return new s(this,c,l)}addColumn(l,c,i){this.cacheState(),i===void 0?(this.table.columns.push(l),this.table.rows.forEach((u,p)=>{u.push(c[p])})):(this.table.columns.splice(i,0,l),this.table.rows.forEach((u,p)=>{u.splice(i,0,c[p])}))}removeColumns(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.columns.splice(l,c),this.table.rows.forEach(i=>{i.splice(l,c)})}_assign(l,c,i){this.cacheState(),l[c]=i}get ref(){return this.table.ref}set ref(l){this._assign(this.table,"ref",l)}get name(){return this.table.name}set name(l){this.table.name=l}get displayName(){return this.table.displyName||this.table.name}set displayNamename(l){this.table.displayName=l}get headerRow(){return this.table.headerRow}set headerRow(l){this._assign(this.table,"headerRow",l)}get totalsRow(){return this.table.totalsRow}set totalsRow(l){this._assign(this.table,"totalsRow",l)}get theme(){return this.table.style.name}set theme(l){this.table.style.name=l}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(l){this.table.style.showFirstColumn=l}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(l){this.table.style.showLastColumn=l}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(l){this.table.style.showRowStripes=l}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(l){this.table.style.showColumnStripes=l}}},{"../utils/col-cache":19}],13:[function(e,n,a){const o=e("./worksheet"),s=e("./defined-names"),l=e("../xlsx/xlsx"),c=e("../csv/csv");n.exports=class{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new s}get xlsx(){return this._xlsx||(this._xlsx=new l(this)),this._xlsx}get csv(){return this._csv||(this._csv=new c(this)),this._csv}get nextId(){for(let i=1;i<this._worksheets.length;i++)if(!this._worksheets[i])return i;return this._worksheets.length||1}addWorksheet(i,u){const p=this.nextId;u&&(typeof u=="string"?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),u={properties:{tabColor:{argb:u}}}):(u.argb||u.theme||u.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),u={properties:{tabColor:u}}));const f=this._worksheets.reduce((b,g)=>(g&&g.orderNo)>b?g.orderNo:b,0),h=Object.assign({},u,{id:p,name:i,orderNo:f+1,workbook:this}),v=new o(h);return this._worksheets[p]=v,v}removeWorksheetEx(i){delete this._worksheets[i.id]}removeWorksheet(i){const u=this.getWorksheet(i);u&&u.destroy()}getWorksheet(i){return i===void 0?this._worksheets.find(Boolean):typeof i=="number"?this._worksheets[i]:typeof i=="string"?this._worksheets.find(u=>u&&u.name===i):void 0}get worksheets(){return this._worksheets.slice(1).sort((i,u)=>i.orderNo-u.orderNo).filter(Boolean)}eachSheet(i){this.worksheets.forEach(u=>{i(u,u.id)})}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(i){const u=this.media.length;return this.media.push(Object.assign({},i,{type:"image"})),u}getImage(i){return this.media[i]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(i=>i.model),sheets:this.worksheets.map(i=>i.model).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(i){this.creator=i.creator,this.lastModifiedBy=i.lastModifiedBy,this.lastPrinted=i.lastPrinted,this.created=i.created,this.modified=i.modified,this.company=i.company,this.manager=i.manager,this.title=i.title,this.subject=i.subject,this.keywords=i.keywords,this.category=i.category,this.description=i.description,this.language=i.language,this.revision=i.revision,this.contentStatus=i.contentStatus,this.properties=i.properties,this.calcProperties=i.calcProperties,this._worksheets=[],i.worksheets.forEach(u=>{const{id:p,name:f,state:h}=u,v=i.sheets&&i.sheets.findIndex(b=>b.id===p);(this._worksheets[p]=new o({id:p,name:f,orderNo:v,state:h,workbook:this})).model=u}),this._definedNames.model=i.definedNames,this.views=i.views,this._themes=i.themes,this.media=i.media||[]}}},{"../csv/csv":1,"../xlsx/xlsx":144,"./defined-names":6,"./worksheet":14}],14:[function(e,n,a){const o=e("../utils/under-dash"),s=e("../utils/col-cache"),l=e("./range"),c=e("./row"),i=e("./column"),u=e("./enums"),p=e("./image"),f=e("./table"),h=e("./data-validations"),v=e("../utils/encryptor"),{copyStyle:b}=e("../utils/copy-style");n.exports=class{constructor(g){g=g||{},this._workbook=g.workbook,this.id=g.id,this.orderNo=g.orderNo,this.name=g.name,this.state=g.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},g.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!(!g.pageSetup||!g.pageSetup.fitToWidth&&!g.pageSetup.fitToHeight||g.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},g.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},g.headerFooter),this.dataValidations=new h,this.views=g.views||[],this.autoFilter=g.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get name(){return this._name}set name(g){if(g===void 0&&(g="sheet"+this.id),this._name!==g){if(typeof g!="string")throw new Error("The name has to be a string.");if(g==="")throw new Error("The name can't be empty.");if(g==="History")throw new Error('The name "History" is protected. Please use a different name.');if(/[*?:/\\[\]]/.test(g))throw new Error(`Worksheet name ${g} cannot include any of the following characters: * ? : \\ / [ ]`);if(/(^')|('$)/.test(g))throw new Error("The first or last character of worksheet name cannot be a single quotation mark: "+g);if(g&&g.length>31&&(console.warn(`Worksheet name ${g} exceeds 31 chars. This will be truncated`),g=g.substring(0,31)),this._workbook._worksheets.find(x=>x&&x.name.toLowerCase()===g.toLowerCase()))throw new Error("Worksheet name already exists: "+g);this._name=g}}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){const g=new l;return this._rows.forEach(x=>{if(x){const y=x.dimensions;y&&g.expand(x.number,y.min,x.number,y.max)}}),g}get columns(){return this._columns}set columns(g){this._headerRowCount=g.reduce((k,N)=>{const F=(N.header?1:N.headers&&N.headers.length)||0;return Math.max(k,F)},0);let x=1;const y=this._columns=[];g.forEach(k=>{const N=new i(this,x++,!1);y.push(N),N.defn=k})}getColumnKey(g){return this._keys[g]}setColumnKey(g,x){this._keys[g]=x}deleteColumnKey(g){delete this._keys[g]}eachColumnKey(g){o.each(this._keys,g)}getColumn(g){if(typeof g=="string"){const x=this._keys[g];if(x)return x;g=s.l2n(g)}if(this._columns||(this._columns=[]),g>this._columns.length){let x=this._columns.length+1;for(;x<=g;)this._columns.push(new i(this,x++))}return this._columns[g-1]}spliceColumns(g,x){const y=this._rows.length;for(var k=arguments.length,N=new Array(k>2?k-2:0),F=2;F<k;F++)N[F-2]=arguments[F];if(N.length>0)for(let q=0;q<y;q++){const X=[g,x];N.forEach(H=>{X.push(H[q]||null)});const I=this.getRow(q+1);I.splice.apply(I,X)}else this._rows.forEach(q=>{q&&q.splice(g,x)});const B=N.length-x,W=g+x,V=this._columns.length;if(B<0)for(let q=g+N.length;q<=V;q++)this.getColumn(q).defn=this.getColumn(q-B).defn;else if(B>0)for(let q=V;q>=W;q--)this.getColumn(q+B).defn=this.getColumn(q).defn;for(let q=g;q<g+N.length;q++)this.getColumn(q).defn=null;this.workbook.definedNames.spliceColumns(this.name,g,x,N.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let g=0;return this.eachRow(x=>{g=Math.max(g,x.cellCount)}),g}get actualColumnCount(){const g=[];let x=0;return this.eachRow(y=>{y.eachCell(k=>{let{col:N}=k;g[N]||(g[N]=!0,x++)})}),x}_commitRow(){}get _lastRowNumber(){const g=this._rows;let x=g.length;for(;x>0&&g[x-1]===void 0;)x--;return x}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(g){return this._rows[g-1]}findRows(g,x){return this._rows.slice(g-1,g-1+x)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let g=0;return this.eachRow(()=>{g++}),g}getRow(g){let x=this._rows[g-1];return x||(x=this._rows[g-1]=new c(this,g)),x}getRows(g,x){if(x<1)return;const y=[];for(let k=g;k<g+x;k++)y.push(this.getRow(k));return y}addRow(g){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const y=this._nextRow,k=this.getRow(y);return k.values=g,this._setStyleOption(y,x[0]==="i"?x:"n"),k}addRows(g){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const y=[];return g.forEach(k=>{y.push(this.addRow(k,x))}),y}insertRow(g,x){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";return this.spliceRows(g,0,x),this._setStyleOption(g,y),this.getRow(g)}insertRows(g,x){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";if(this.spliceRows(g,0,...x),y!=="n")for(let k=0;k<x.length;k++)y[0]==="o"&&this.findRow(x.length+g+k)!==void 0?this._copyStyle(x.length+g+k,g+k,y[1]==="+"):y[0]==="i"&&this.findRow(g-1)!==void 0&&this._copyStyle(g-1,g+k,y[1]==="+");return this.getRows(g,x.length)}_setStyleOption(g){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";x[0]==="o"&&this.findRow(g+1)!==void 0?this._copyStyle(g+1,g,x[1]==="+"):x[0]==="i"&&this.findRow(g-1)!==void 0&&this._copyStyle(g-1,g,x[1]==="+")}_copyStyle(g,x){let y=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const k=this.getRow(g),N=this.getRow(x);N.style=b(k.style),k.eachCell({includeEmpty:y},(F,B)=>{N.getCell(B).style=b(F.style)}),N.height=k.height}duplicateRow(g,x){let y=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const k=this._rows[g-1],N=new Array(x).fill(k.values);this.spliceRows(g+1,y?0:x,...N);for(let F=0;F<x;F++){const B=this._rows[g+F];B.style=k.style,B.height=k.height,k.eachCell({includeEmpty:!0},(W,V)=>{B.getCell(V).style=W.style})}}spliceRows(g,x){const y=g+x;for(var k=arguments.length,N=new Array(k>2?k-2:0),F=2;F<k;F++)N[F-2]=arguments[F];const B=N.length,W=B-x,V=this._rows.length;let q,X;if(W<0)for(g===V&&(this._rows[V-1]=void 0),q=y;q<=V;q++)if(X=this._rows[q-1],X){const I=this.getRow(q+W);I.values=X.values,I.style=X.style,I.height=X.height,X.eachCell({includeEmpty:!0},(H,O)=>{I.getCell(O).style=H.style}),this._rows[q-1]=void 0}else this._rows[q+W-1]=void 0;else if(W>0)for(q=V;q>=y;q--)if(X=this._rows[q-1],X){const I=this.getRow(q+W);I.values=X.values,I.style=X.style,I.height=X.height,X.eachCell({includeEmpty:!0},(H,O)=>{if(I.getCell(O).style=H.style,H._value.constructor.name==="MergeValue"){const R=this.getRow(H._row._number+B).getCell(O),C=H._value._master,w=this.getRow(C._row._number+B).getCell(C._column._number);R.merge(w)}})}else this._rows[q+W-1]=void 0;for(q=0;q<B;q++){const I=this.getRow(g+q);I.style={},I.values=N[q]}this.workbook.definedNames.spliceRows(this.name,g,x,B)}eachRow(g,x){if(x||(x=g,g=void 0),g&&g.includeEmpty){const y=this._rows.length;for(let k=1;k<=y;k++)x(this.getRow(k),k)}else this._rows.forEach(y=>{y&&y.hasValues&&x(y,y.number)})}getSheetValues(){const g=[];return this._rows.forEach(x=>{x&&(g[x.number]=x.values)}),g}findCell(g,x){const y=s.getAddress(g,x),k=this._rows[y.row-1];return k?k.findCell(y.col):void 0}getCell(g,x){const y=s.getAddress(g,x);return this.getRow(y.row).getCellEx(y)}mergeCells(){for(var g=arguments.length,x=new Array(g),y=0;y<g;y++)x[y]=arguments[y];const k=new l(x);this._mergeCellsInternal(k)}mergeCellsWithoutStyle(){for(var g=arguments.length,x=new Array(g),y=0;y<g;y++)x[y]=arguments[y];const k=new l(x);this._mergeCellsInternal(k,!0)}_mergeCellsInternal(g,x){o.each(this._merges,k=>{if(k.intersects(g))throw new Error("Cannot merge already merged cells")});const y=this.getCell(g.top,g.left);for(let k=g.top;k<=g.bottom;k++)for(let N=g.left;N<=g.right;N++)(k>g.top||N>g.left)&&this.getCell(k,N).merge(y,x);this._merges[y.address]=g}_unMergeMaster(g){const x=this._merges[g.address];if(x){for(let y=x.top;y<=x.bottom;y++)for(let k=x.left;k<=x.right;k++)this.getCell(y,k).unmerge();delete this._merges[g.address]}}get hasMerges(){return o.some(this._merges,Boolean)}unMergeCells(){for(var g=arguments.length,x=new Array(g),y=0;y<g;y++)x[y]=arguments[y];const k=new l(x);for(let N=k.top;N<=k.bottom;N++)for(let F=k.left;F<=k.right;F++){const B=this.findCell(N,F);B&&(B.type===u.ValueType.Merge?this._unMergeMaster(B.master):this._merges[B.address]&&this._unMergeMaster(B))}}fillFormula(g,x,y){let k=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"shared";const N=s.decode(g),{top:F,left:B,bottom:W,right:V}=N,q=V-B+1,X=s.encodeAddress(F,B),I=k==="shared";let H;H=typeof y=="function"?y:Array.isArray(y)?Array.isArray(y[0])?(R,C)=>y[R-F][C-B]:(R,C)=>y[(R-F)*q+(C-B)]:()=>{};let O=!0;for(let R=F;R<=W;R++)for(let C=B;C<=V;C++)O?(this.getCell(R,C).value={shareType:k,formula:x,ref:g,result:H(R,C)},O=!1):this.getCell(R,C).value=I?{sharedFormula:X,result:H(R,C)}:H(R,C)}addImage(g,x){const y={type:"image",imageId:g,range:x};this._media.push(new p(this,y))}getImages(){return this._media.filter(g=>g.type==="image")}addBackgroundImage(g){const x={type:"background",imageId:g};this._media.push(new p(this,x))}getBackgroundImageId(){const g=this._media.find(x=>x.type==="background");return g&&g.imageId}protect(g,x){return new Promise(y=>{this.sheetProtection={sheet:!0},x&&"spinCount"in x&&(x.spinCount=Number.isFinite(x.spinCount)?Math.round(Math.max(0,x.spinCount)):1e5),g&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=v.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=x&&"spinCount"in x?x.spinCount:1e5,this.sheetProtection.hashValue=v.convertPasswordToHash(g,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),x&&(this.sheetProtection=Object.assign(this.sheetProtection,x),!g&&"spinCount"in x&&delete this.sheetProtection.spinCount),y()})}unprotect(){this.sheetProtection=null}addTable(g){const x=new f(this,g);return this.tables[g.name]=x,x}getTable(g){return this.tables[g]}removeTable(g){delete this.tables[g]}getTables(){return Object.values(this.tables)}addConditionalFormatting(g){this.conditionalFormattings.push(g)}removeConditionalFormatting(g){typeof g=="number"?this.conditionalFormattings.splice(g,1):this.conditionalFormattings=g instanceof Function?this.conditionalFormattings.filter(g):[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(g){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=g}get model(){const g={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(k=>k.model),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(k=>k.model),conditionalFormattings:this.conditionalFormattings};g.cols=i.toModel(this.columns);const x=g.rows=[],y=g.dimensions=new l;return this._rows.forEach(k=>{const N=k&&k.model;N&&(y.expand(N.number,N.min,N.number,N.max),x.push(N))}),g.merges=[],o.each(this._merges,k=>{g.merges.push(k.range)}),g}_parseRows(g){this._rows=[],g.rows.forEach(x=>{const y=new c(this,x.number);this._rows[y.number-1]=y,y.model=x})}_parseMergeCells(g){o.each(g.mergeCells,x=>{this.mergeCellsWithoutStyle(x)})}set model(g){this.name=g.name,this._columns=i.fromModel(this,g.cols),this._parseRows(g),this._parseMergeCells(g),this.dataValidations=new h(g.dataValidations),this.properties=g.properties,this.pageSetup=g.pageSetup,this.headerFooter=g.headerFooter,this.views=g.views,this.autoFilter=g.autoFilter,this._media=g.media.map(x=>new p(this,x)),this.sheetProtection=g.sheetProtection,this.tables=g.tables.reduce((x,y)=>{const k=new f;return k.model=y,x[y.name]=k,x},{}),this.conditionalFormattings=g.conditionalFormattings}}},{"../utils/col-cache":19,"../utils/copy-style":20,"../utils/encryptor":21,"../utils/under-dash":26,"./column":4,"./data-validations":5,"./enums":7,"./image":8,"./range":10,"./row":11,"./table":12}],15:[function(e,n,a){e("core-js/modules/es.promise"),e("core-js/modules/es.promise.finally"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.values"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.async-iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.find-index"),e("core-js/modules/es.array.find"),e("core-js/modules/es.string.from-code-point"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.number.is-nan"),e("regenerator-runtime/runtime");const o={Workbook:e("./doc/workbook")},s=e("./doc/enums");Object.keys(s).forEach(l=>{o[l]=s[l]}),n.exports=o},{"./doc/enums":7,"./doc/workbook":13,"core-js/modules/es.array.find":359,"core-js/modules/es.array.find-index":358,"core-js/modules/es.array.includes":360,"core-js/modules/es.array.iterator":361,"core-js/modules/es.number.is-nan":363,"core-js/modules/es.object.assign":364,"core-js/modules/es.object.keys":366,"core-js/modules/es.object.values":367,"core-js/modules/es.promise":372,"core-js/modules/es.promise.finally":371,"core-js/modules/es.string.from-code-point":376,"core-js/modules/es.string.includes":377,"core-js/modules/es.symbol":381,"core-js/modules/es.symbol.async-iterator":378,"regenerator-runtime/runtime":492}],16:[function(e,n,a){const o=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");a.bufferToString=function(s){return typeof s=="string"?s:o?o.decode(s):s.toString()}},{}],17:[function(e,n,a){const o=typeof TextEncoder>"u"?null:new TextEncoder("utf-8"),{Buffer:s}=e("buffer");a.stringToBuffer=function(l){return typeof l!="string"?l:o?s.from(o.encode(l).buffer):s.from(l)}},{buffer:220}],18:[function(e,n,a){const o=e("./under-dash"),s=e("./col-cache");n.exports=class{constructor(l){this.template=l,this.sheets={}}addCell(l){this.addCellEx(s.decodeEx(l))}getCell(l){return this.findCellEx(s.decodeEx(l),!0)}findCell(l){return this.findCellEx(s.decodeEx(l),!1)}findCellAt(l,c,i){const u=this.sheets[l],p=u&&u[c];return p&&p[i]}addCellEx(l){if(l.top)for(let c=l.top;c<=l.bottom;c++)for(let i=l.left;i<=l.right;i++)this.getCellAt(l.sheetName,c,i);else this.findCellEx(l,!0)}getCellEx(l){return this.findCellEx(l,!0)}findCellEx(l,c){const i=this.findSheet(l,c),u=this.findSheetRow(i,l,c);return this.findRowCell(u,l,c)}getCellAt(l,c,i){const u=this.sheets[l]||(this.sheets[l]=[]),p=u[c]||(u[c]=[]);return p[i]||(p[i]={sheetName:l,address:s.n2l(i)+c,row:c,col:i})}removeCellEx(l){const c=this.findSheet(l);if(!c)return;const i=this.findSheetRow(c,l);i&&delete i[l.col]}forEachInSheet(l,c){const i=this.sheets[l];i&&i.forEach((u,p)=>{u&&u.forEach((f,h)=>{f&&c(f,p,h)})})}forEach(l){o.each(this.sheets,(c,i)=>{this.forEachInSheet(i,l)})}map(l){const c=[];return this.forEach(i=>{c.push(l(i))}),c}findSheet(l,c){const i=l.sheetName;return this.sheets[i]?this.sheets[i]:c?this.sheets[i]=[]:void 0}findSheetRow(l,c,i){const{row:u}=c;return l&&l[u]?l[u]:i?l[u]=[]:void 0}findRowCell(l,c,i){const{col:u}=c;return l&&l[u]?l[u]:i?l[u]=this.template?Object.assign(c,JSON.parse(JSON.stringify(this.template))):c:void 0}spliceRows(l,c,i,u){const p=this.sheets[l];if(p){const f=[];for(let h=0;h<u;h++)f.push([]);p.splice(c,i,...f)}}spliceColumns(l,c,i,u){const p=this.sheets[l];if(p){const f=[];for(let h=0;h<u;h++)f.push(null);o.each(p,h=>{h.splice(c,i,...f)})}}}},{"./col-cache":19,"./under-dash":26}],19:[function(e,n,a){const o=/^[A-Z]+\d+$/,s={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:l=>l<=26?1:l<=676?2:3,_fill(l){let c,i,u,p,f,h=1;if(l>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&l>=1){for(;h<=26;)c=this._dictionary[h-1],this._n2l[h]=c,this._l2n[c]=h,h++;this._l2nFill=1}if(this._l2nFill<2&&l>=2){for(h=27;h<=702;)i=h-27,u=i%26,p=Math.floor(i/26),c=this._dictionary[p]+this._dictionary[u],this._n2l[h]=c,this._l2n[c]=h,h++;this._l2nFill=2}if(this._l2nFill<3&&l>=3){for(h=703;h<=16384;)i=h-703,u=i%26,p=Math.floor(i/26)%26,f=Math.floor(i/676),c=this._dictionary[f]+this._dictionary[p]+this._dictionary[u],this._n2l[h]=c,this._l2n[c]=h,h++;this._l2nFill=3}},l2n(l){if(this._l2n[l]||this._fill(l.length),!this._l2n[l])throw new Error("Out of bounds. Invalid column letter: "+l);return this._l2n[l]},n2l(l){if(l<1||l>16384)throw new Error(l+" is out of bounds. Excel supports columns from 1 to 16384");return this._n2l[l]||this._fill(this._level(l)),this._n2l[l]},_hash:{},validateAddress(l){if(!o.test(l))throw new Error("Invalid Address: "+l);return!0},decodeAddress(l){const c=l.length<5&&this._hash[l];if(c)return c;let i=!1,u="",p=0,f=!1,h="",v=0;for(let g,x=0;x<l.length;x++)if(g=l.charCodeAt(x),!f&&g>=65&&g<=90)i=!0,u+=l[x],p=26*p+g-64;else if(g>=48&&g<=57)f=!0,h+=l[x],v=10*v+g-48;else if(f&&i&&g!==36)break;if(i){if(p>16384)throw new Error("Out of bounds. Invalid column letter: "+u)}else p=void 0;f||(v=void 0);const b={address:l=u+h,col:p,row:v,$col$row:`$${u}$${h}`};return p<=100&&v<=100&&(this._hash[l]=b,this._hash[b.$col$row]=b),b},getAddress(l,c){if(c){const i=this.n2l(c)+l;return this.decodeAddress(i)}return this.decodeAddress(l)},decode(l){const c=l.split(":");if(c.length===2){const i=this.decodeAddress(c[0]),u=this.decodeAddress(c[1]),p={top:Math.min(i.row,u.row),left:Math.min(i.col,u.col),bottom:Math.max(i.row,u.row),right:Math.max(i.col,u.col)};return p.tl=this.n2l(p.left)+p.top,p.br=this.n2l(p.right)+p.bottom,p.dimensions=`${p.tl}:${p.br}`,p}return this.decodeAddress(l)},decodeEx(l){const c=l.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),i=c[1]||c[2],u=c[3],p=u.split(":");if(p.length>1){let h=this.decodeAddress(p[0]),v=this.decodeAddress(p[1]);const b=Math.min(h.row,v.row),g=Math.min(h.col,v.col),x=Math.max(h.row,v.row),y=Math.max(h.col,v.col);return h=this.n2l(g)+b,v=this.n2l(y)+x,{top:b,left:g,bottom:x,right:y,sheetName:i,tl:{address:h,col:g,row:b,$col$row:`$${this.n2l(g)}$${b}`,sheetName:i},br:{address:v,col:y,row:x,$col$row:`$${this.n2l(y)}$${x}`,sheetName:i},dimensions:`${h}:${v}`}}if(u.startsWith("#"))return i?{sheetName:i,error:u}:{error:u};const f=this.decodeAddress(u);return i?{sheetName:i,...f}:f},encodeAddress:(l,c)=>s.n2l(c)+l,encode(){switch(arguments.length){case 2:return s.encodeAddress(arguments[0],arguments[1]);case 4:return`${s.encodeAddress(arguments[0],arguments[1])}:${s.encodeAddress(arguments[2],arguments[3])}`;default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange(l,c){const[i,u,,p,f]=l,[h,v]=c;return h>=i&&h<=p&&v>=u&&v<=f}};n.exports=s},{}],20:[function(e,n,a){const o=(l,c)=>({...l,...c.reduce((i,u)=>(l[u]&&(i[u]={...l[u]}),i),{})}),s=function(l,c,i){let u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];l[i]&&(c[i]=o(l[i],u))};a.copyStyle=l=>{if(!l)return l;if(c=l,Object.keys(c).length===0)return{};var c;const i={...l};return s(l,i,"font",["color"]),s(l,i,"alignment"),s(l,i,"protection"),l.border&&(s(l,i,"border"),s(l.border,i.border,"top",["color"]),s(l.border,i.border,"left",["color"]),s(l.border,i.border,"bottom",["color"]),s(l.border,i.border,"right",["color"]),s(l.border,i.border,"diagonal",["color"])),l.fill&&(s(l,i,"fill",["fgColor","bgColor","center"]),l.fill.stops&&(i.fill.stops=l.fill.stops.map(u=>o(u,["color"])))),i}},{}],21:[function(e,n,a){(function(o){(function(){const s=e("crypto"),l={hash(c){const i=s.createHash(c);for(var u=arguments.length,p=new Array(u>1?u-1:0),f=1;f<u;f++)p[f-1]=arguments[f];return i.update(o.concat(p)),i.digest()},convertPasswordToHash(c,i,u,p){if(i=i.toLowerCase(),s.getHashes().indexOf(i)<0)throw new Error(`Hash algorithm '${i}' not supported!`);const f=o.from(c,"utf16le");let h=this.hash(i,o.from(u,"base64"),f);for(let v=0;v<p;v++){const b=o.alloc(4);b.writeUInt32LE(v,0),h=this.hash(i,h,b)}return h.toString("base64")},randomBytes:c=>s.randomBytes(c)};n.exports=l}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220,crypto:390}],22:[function(e,n,a){const{SaxesParser:o}=e("saxes"),{PassThrough:s}=e("readable-stream"),{bufferToString:l}=e("./browser-buffer-decode");n.exports=async function*(c){c.pipe&&!c[Symbol.asyncIterator]&&(c=c.pipe(new s));const i=new o;let u;i.on("error",f=>{u=f});let p=[];i.on("opentag",f=>p.push({eventType:"opentag",value:f})),i.on("text",f=>p.push({eventType:"text",value:f})),i.on("closetag",f=>p.push({eventType:"closetag",value:f}));for await(const f of c){if(i.write(l(f)),u)throw u;yield p,p=[]}}},{"./browser-buffer-decode":16,"readable-stream":491,saxes:496}],23:[function(e,n,a){const o=e("./col-cache"),s=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,l=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;n.exports={slideFormula:function(c,i,u){const p=o.decode(i),f=o.decode(u);return c.replace(s,(h,v,b,g,x)=>{if(x)return h;const y=l.exec(g);if(y){const k=y[1],N=y[2].toUpperCase(),F=y[3],B=y[4];if(N.length>3||N.length===3&&N>"XFD")return h;let W=o.l2n(N),V=parseInt(B,10);return k||(W+=f.col-p.col),F||(V+=f.row-p.row),(v||"")+(k||"")+o.n2l(W)+(F||"")+V}return h})}}},{"./col-cache":19}],24:[function(e,n,a){(function(o,s){(function(){const l=e("readable-stream"),c=e("./utils"),i=e("./string-buf");class u{constructor(g,x){this._data=g,this._encoding=x}get length(){return this.toBuffer().length}copy(g,x,y,k){return this.toBuffer().copy(g,x,y,k)}toBuffer(){return this._buffer||(this._buffer=s.from(this._data,this._encoding)),this._buffer}}class p{constructor(g){this._data=g}get length(){return this._data.length}copy(g,x,y,k){return this._data._buf.copy(g,x,y,k)}toBuffer(){return this._data.toBuffer()}}class f{constructor(g){this._data=g}get length(){return this._data.length}copy(g,x,y,k){this._data.copy(g,x,y,k)}toBuffer(){return this._data}}class h{constructor(g){this.size=g,this.buffer=s.alloc(g),this.iRead=0,this.iWrite=0}toBuffer(){if(this.iRead===0&&this.iWrite===this.size)return this.buffer;const g=s.alloc(this.iWrite-this.iRead);return this.buffer.copy(g,0,this.iRead,this.iWrite),g}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(g){let x;return g===0?null:g===void 0||g>=this.length?(x=this.toBuffer(),this.iRead=this.iWrite,x):(x=s.alloc(g),this.buffer.copy(x,0,this.iRead,g),this.iRead+=g,x)}write(g,x,y){const k=Math.min(y,this.size-this.iWrite);return g.copy(this.buffer,this.iWrite,x,x+k),this.iWrite+=k,k}}const v=function(b){b=b||{},this.bufSize=b.bufSize||1048576,this.buffers=[],this.batch=b.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};c.inherits(v,l.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return s.concat(this.buffers.map(b=>b.toBuffer()))}},_getWritableBuffer(){if(this.buffers.length){const g=this.buffers[this.buffers.length-1];if(!g.full)return g}const b=new h(this.bufSize);return this.buffers.push(b),b},async _pipe(b){await Promise.all(this.pipes.map(function(g){return new Promise(x=>{g.write(b.toBuffer(),()=>{x()})})}))},_writeToBuffers(b){let g=0;const x=b.length;for(;g<x;)g+=this._getWritableBuffer().write(b,g,x-g)},async write(b,g,x){let y;if(g instanceof Function&&(x=g,g="utf8"),x=x||c.nop,b instanceof i)y=new p(b);else if(b instanceof s)y=new f(b);else{if(!(typeof b=="string"||b instanceof String||b instanceof ArrayBuffer))throw new Error("Chunk must be one of type String, Buffer or StringBuf.");y=new u(b,g)}if(this.pipes.length)if(this.batch)for(this._writeToBuffers(y);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(y),o.nextTick(x)):(await this._pipe(y),x());else this.paused||this.emit("data",y.toBuffer()),this._writeToBuffers(y),this.emit("readable");return!0},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(b,g,x){const y=k=>{k?x(k):(this._flush(),this.pipes.forEach(N=>{N.end()}),this.emit("finish"))};b?this.write(b,g,y):y()},read(b){let g;if(b){for(g=[];b&&this.buffers.length&&!this.buffers[0].eod;){const x=this.buffers[0],y=x.read(b);b-=y.length,g.push(y),x.eod&&x.full&&this.buffers.shift()}return s.concat(g)}return g=this.buffers.map(x=>x.toBuffer()).filter(Boolean),this.buffers=[],s.concat(g)},setEncoding(b){this.encoding=b},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(b){this.pipes.push(b),!this.paused&&this.buffers.length&&this.end()},unpipe(b){this.pipes=this.pipes.filter(g=>g!==b)},unshift(){throw new Error("Not Implemented")},wrap(){throw new Error("Not Implemented")}}),n.exports=v}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"./string-buf":25,"./utils":27,_process:467,buffer:220,"readable-stream":491}],25:[function(e,n,a){(function(o){(function(){n.exports=class{constructor(s){this._buf=o.alloc(s&&s.size||16384),this._encoding=s&&s.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=o.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(s){s=s||0,this._buffer=void 0,this._inPos=s}_grow(s){let l=2*this._buf.length;for(;l<s;)l*=2;const c=o.alloc(l);this._buf.copy(c,0),this._buf=c}addText(s){this._buffer=void 0;let l=this._inPos+this._buf.write(s,this._inPos,this._encoding);for(;l>=this._buf.length-4;)this._grow(this._inPos+s.length),l=this._inPos+this._buf.write(s,this._inPos,this._encoding);this._inPos=l}addStringBuf(s){s.length&&(this._buffer=void 0,this.length+s.length>this.capacity&&this._grow(this.length+s.length),s._buf.copy(this._buf,this._inPos,0,s.length),this._inPos+=s.length)}}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220}],26:[function(e,n,a){const{toString:o}=Object.prototype,s=/["&<>]/,l={each:function(c,i){c&&(Array.isArray(c)?c.forEach(i):Object.keys(c).forEach(u=>{i(c[u],u)}))},some:function(c,i){return!!c&&(Array.isArray(c)?c.some(i):Object.keys(c).some(u=>i(c[u],u)))},every:function(c,i){return!c||(Array.isArray(c)?c.every(i):Object.keys(c).every(u=>i(c[u],u)))},map:function(c,i){return c?Array.isArray(c)?c.map(i):Object.keys(c).map(u=>i(c[u],u)):[]},keyBy:(c,i)=>c.reduce((u,p)=>(u[p[i]]=p,u),{}),isEqual:function(c,i){const u=typeof c,p=typeof i,f=Array.isArray(c),h=Array.isArray(i);let v;if(u!==p)return!1;switch(typeof c){case"object":if(f||h)return!(!f||!h)&&c.length===i.length&&c.every((b,g)=>{const x=i[g];return l.isEqual(b,x)});if(c===null||i===null)return c===i;if(v=Object.keys(c),Object.keys(i).length!==v.length)return!1;for(const b of v)if(!i.hasOwnProperty(b))return!1;return l.every(c,(b,g)=>{const x=i[g];return l.isEqual(b,x)});default:return c===i}},escapeHtml(c){const i=s.exec(c);if(!i)return c;let u="",p="",f=0,h=i.index;for(;h<c.length;h++){switch(c.charAt(h)){case'"':p="&quot;";break;case"&":p="&amp;";break;case"'":p="&apos;";break;case"<":p="&lt;";break;case">":p="&gt;";break;default:continue}f!==h&&(u+=c.substring(f,h)),f=h+1,u+=p}return f!==h?u+c.substring(f,h):u},strcmp:(c,i)=>c<i?-1:c>i?1:0,isUndefined:c=>o.call(c)==="[object Undefined]",isObject:c=>o.call(c)==="[object Object]",deepMerge(){const c=arguments[0]||{},{length:i}=arguments;let u,p,f;function h(v,b){u=c[b],f=Array.isArray(v),l.isObject(v)||f?(f?(f=!1,p=u&&Array.isArray(u)?u:[]):p=u&&l.isObject(u)?u:{},c[b]=l.deepMerge(p,v)):l.isUndefined(v)||(c[b]=v)}for(let v=0;v<i;v++)l.each(arguments[v],h);return c}};n.exports=l},{}],27:[function(e,n,a){(function(o,s){(function(){const l=e("fs"),c=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,i={nop(){},promiseImmediate:u=>new Promise(p=>{o.setImmediate?s(()=>{p(u)}):setTimeout(()=>{p(u)},1)}),inherits:function(u,p,f,h){u.super_=p,h||(h=f,f=null),f&&Object.keys(f).forEach(b=>{Object.defineProperty(u,b,Object.getOwnPropertyDescriptor(f,b))});const v={constructor:{value:u,enumerable:!1,writable:!1,configurable:!0}};h&&Object.keys(h).forEach(b=>{v[b]=Object.getOwnPropertyDescriptor(h,b)}),u.prototype=Object.create(p.prototype,v)},dateToExcel:(u,p)=>25569+u.getTime()/864e5-(p?1462:0),excelToDate(u,p){const f=Math.round(24*(u-25569+(p?1462:0))*3600*1e3);return new Date(f)},parsePath(u){const p=u.lastIndexOf("/");return{path:u.substring(0,p),name:u.substring(p+1)}},getRelsPath(u){const p=i.parsePath(u);return`${p.path}/_rels/${p.name}.rels`},xmlEncode(u){const p=c.exec(u);if(!p)return u;let f="",h="",v=0,b=p.index;for(;b<u.length;b++){const g=u.charCodeAt(b);switch(g){case 34:h="&quot;";break;case 38:h="&amp;";break;case 39:h="&apos;";break;case 60:h="&lt;";break;case 62:h="&gt;";break;case 127:h="";break;default:if(g<=31&&(g<=8||g>=11&&g!==13)){h="";break}continue}v!==b&&(f+=u.substring(v,b)),v=b+1,h&&(f+=h)}return v!==b?f+u.substring(v,b):f},xmlDecode:u=>u.replace(/&([a-z]*);/g,p=>{switch(p){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return p}}),validInt(u){const p=parseInt(u,10);return Number.isNaN(p)?0:p},isDateFmt(u){return u?(u=(u=u.replace(/\[[^\]]*]/g,"")).replace(/"[^"]*"/g,"")).match(/[ymdhMsb]+/)!==null:!1},fs:{exists:u=>new Promise(p=>{l.access(u,l.constants.F_OK,f=>{p(!f)})})},toIsoDateString:u=>u.toIsoString().subsstr(0,10),parseBoolean:u=>u===!0||u==="true"||u===1||u==="1"};n.exports=i}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{},e("timers").setImmediate)},{fs:216,timers:523}],28:[function(e,n,a){const o=e("./under-dash"),s=e("./utils");function l(u,p,f){u.push(` ${p}="${s.xmlEncode(f.toString())}"`)}function c(u,p){if(p){const f=[];o.each(p,(h,v)=>{h!==void 0&&l(f,v,h)}),u.push(f.join(""))}}class i{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(p){const f=this._xml;f.push("<?xml"),c(f,p),f.push(`?>
`)}openNode(p,f){const h=this.tos,v=this._xml;h&&this.open&&v.push(">"),this._stack.push(p),v.push("<"),v.push(p),c(v,f),this.leaf=!0,this.open=!0}addAttribute(p,f){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");f!==void 0&&l(this._xml,p,f)}addAttributes(p){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");c(this._xml,p)}writeText(p){const f=this._xml;this.open&&(f.push(">"),this.open=!1),this.leaf=!1,f.push(s.xmlEncode(p.toString()))}writeXml(p){this.open&&(this._xml.push(">"),this.open=!1),this.leaf=!1,this._xml.push(p)}closeNode(){const p=this._stack.pop(),f=this._xml;this.leaf?f.push("/>"):(f.push("</"),f.push(p),f.push(">")),this.open=!1,this.leaf=!1}leafNode(p,f,h){this.openNode(p,f),h!==void 0&&this.writeText(h),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){const p=this._rollbacks.pop();this._xml.length>p.xml&&this._xml.splice(p.xml,this._xml.length-p.xml),this._stack.length>p.stack&&this._stack.splice(p.stack,this._stack.length-p.stack),this.leaf=p.leaf,this.open=p.open}get xml(){return this.closeAll(),this._xml.join("")}}i.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},n.exports=i},{"./under-dash":26,"./utils":27}],29:[function(e,n,a){(function(o){(function(){const s=e("events"),l=e("jszip"),c=e("./stream-buf"),{stringToBuffer:i}=e("./browser-buffer-encode");class u extends s.EventEmitter{constructor(f){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},f),this.zip=new l,this.stream=new c}append(f,h){h.hasOwnProperty("base64")&&h.base64?this.zip.file(h.name,f,{base64:!0}):(o.browser&&typeof f=="string"&&(f=i(f)),this.zip.file(h.name,f))}async finalize(){const f=await this.zip.generateAsync(this.options);this.stream.end(f),this.emit("finish")}read(f){return this.stream.read(f)}setEncoding(f){return this.stream.setEncoding(f)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(f,h){return this.stream.pipe(f,h)}unpipe(f){return this.stream.unpipe(f)}unshift(f){return this.stream.unshift(f)}wrap(f){return this.stream.wrap(f)}}n.exports={ZipWriter:u}}).call(this)}).call(this,e("_process"))},{"./browser-buffer-encode":17,"./stream-buf":24,_process:467,events:422,jszip:441}],30:[function(e,n,a){n.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},28:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy""m""d""',"zh-cn":'yyyy""m""d""',"ja-jp":'yyyy""m""d""',"ko-kr":'yyyy"" mm"" dd""'},32:{"zh-tw":'hh""mm""',"zh-cn":'h""mm""',"ja-jp":'h""mm""',"ko-kr":'h"" mm""'},33:{"zh-tw":'hh""mm""ss""',"zh-cn":'h""mm""ss""',"ja-jp":'h""mm""ss""',"ko-kr":'h"" mm"" ss""'},34:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},51:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},52:{"zh-tw":'/ hh""mm""',"zh-cn":'yyyy""m""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'m""d""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},55:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},58:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}},{}],31:[function(e,n,a){n.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}},{}],32:[function(e,n,a){const o=e("../../utils/parse-sax"),s=e("../../utils/xml-stream");class l{prepare(){}render(){}parseOpen(i){}parseText(i){}parseClose(i){}reconcile(i,u){}reset(){this.model=null,this.map&&Object.values(this.map).forEach(i=>{i instanceof l?i.reset():i.xform&&i.xform.reset()})}mergeModel(i){this.model=Object.assign(this.model||{},i)}async parse(i){for await(const u of i)for(const{eventType:p,value:f}of u)if(p==="opentag")this.parseOpen(f);else if(p==="text")this.parseText(f);else if(p==="closetag"&&!this.parseClose(f.name))return this.model;return this.model}async parseStream(i){return this.parse(o(i))}get xml(){return this.toXml(this.model)}toXml(i){const u=new s;return this.render(u,i),u.xml}static toAttribute(i,u){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(i===void 0){if(p)return u}else if(p||i!==u)return i.toString()}static toStringAttribute(i,u){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return l.toAttribute(i,u,p)}static toStringValue(i,u){return i===void 0?u:i}static toBoolAttribute(i,u){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(i===void 0){if(p)return u}else if(p||i!==u)return i?"1":"0"}static toBoolValue(i,u){return i===void 0?u:i==="1"}static toIntAttribute(i,u){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return l.toAttribute(i,u,p)}static toIntValue(i,u){return i===void 0?u:parseInt(i,10)}static toFloatAttribute(i,u){let p=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return l.toAttribute(i,u,p)}static toFloatValue(i,u){return i===void 0?u:parseFloat(i)}}n.exports=l},{"../../utils/parse-sax":22,"../../utils/xml-stream":28}],33:[function(e,n,a){const o=e("../base-xform"),s=e("../../../utils/col-cache");function l(i){try{return s.decodeEx(i),!0}catch{return!1}}function c(i){const u=[];let p=!1,f="";return i.split(",").forEach(h=>{if(!h)return;const v=(h.match(/'/g)||[]).length;if(!v)return void(p?f+=h+",":l(h)&&u.push(h));const b=v%2==0;!p&&b&&l(h)?u.push(h):p&&!b?(p=!1,l(f+h)&&u.push(f+h),f=""):(p=!0,f+=h+",")}),u}n.exports=class extends o{render(i,u){i.openNode("definedName",{name:u.name,localSheetId:u.localSheetId}),i.writeText(u.ranges.join(",")),i.closeNode()}parseOpen(i){switch(i.name){case"definedName":return this._parsedName=i.attributes.name,this._parsedLocalSheetId=i.attributes.localSheetId,this._parsedText=[],!0;default:return!1}}parseText(i){this._parsedText.push(i)}parseClose(){return this.model={name:this._parsedName,ranges:c(this._parsedText.join(""))},this._parsedLocalSheetId!==void 0&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}}},{"../../../utils/col-cache":19,"../base-xform":32}],34:[function(e,n,a){const o=e("../../../utils/utils"),s=e("../base-xform");n.exports=class extends s{render(l,c){l.leafNode("sheet",{sheetId:c.id,name:c.name,state:c.state,"r:id":c.rId})}parseOpen(l){return l.name==="sheet"&&(this.model={name:o.xmlDecode(l.attributes.name),id:parseInt(l.attributes.sheetId,10),state:l.attributes.state,rId:l.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/utils":27,"../base-xform":32}],35:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{render(s,l){s.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:l.fullCalcOnLoad?1:void 0})}parseOpen(s){return s.name==="calcPr"&&(this.model={},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],36:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{render(s,l){s.leafNode("workbookPr",{date1904:l.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(s){return s.name==="workbookPr"&&(this.model={date1904:s.attributes.date1904==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],37:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{render(s,l){const c={xWindow:l.x||0,yWindow:l.y||0,windowWidth:l.width||12e3,windowHeight:l.height||24e3,firstSheet:l.firstSheet,activeTab:l.activeTab};l.visibility&&l.visibility!=="visible"&&(c.visibility=l.visibility),s.leafNode("workbookView",c)}parseOpen(s){if(s.name==="workbookView"){const l=this.model={},c=function(u,p,f){const h=p!==void 0?l[u]=p:f;h!==void 0&&(l[u]=h)},i=function(u,p,f){const h=p!==void 0?l[u]=parseInt(p,10):f;h!==void 0&&(l[u]=h)};return i("x",s.attributes.xWindow,0),i("y",s.attributes.yWindow,0),i("width",s.attributes.windowWidth,25e3),i("height",s.attributes.windowHeight,1e4),c("visibility",s.attributes.visibility,"visible"),i("activeTab",s.attributes.activeTab,void 0),i("firstSheet",s.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],38:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../../../utils/col-cache"),l=e("../../../utils/xml-stream"),c=e("../base-xform"),i=e("../static-xform"),u=e("../list-xform"),p=e("./defined-name-xform"),f=e("./sheet-xform"),h=e("./workbook-view-xform"),v=e("./workbook-properties-xform"),b=e("./workbook-calc-properties-xform");class g extends c{constructor(){super(),this.map={fileVersion:g.STATIC_XFORMS.fileVersion,workbookPr:new v,bookViews:new u({tag:"bookViews",count:!1,childXform:new h}),sheets:new u({tag:"sheets",count:!1,childXform:new f}),definedNames:new u({tag:"definedNames",count:!1,childXform:new p}),calcPr:new b}}prepare(y){y.sheets=y.worksheets;const k=[];let N=0;y.sheets.forEach(F=>{if(F.pageSetup&&F.pageSetup.printArea&&F.pageSetup.printArea.split("&&").forEach(B=>{const W=B.split(":"),V={name:"_xlnm.Print_Area",ranges:[`'${F.name}'!$${W[0]}:$${W[1]}`],localSheetId:N};k.push(V)}),F.pageSetup&&(F.pageSetup.printTitlesRow||F.pageSetup.printTitlesColumn)){const B=[];if(F.pageSetup.printTitlesColumn){const V=F.pageSetup.printTitlesColumn.split(":");B.push(`'${F.name}'!$${V[0]}:$${V[1]}`)}if(F.pageSetup.printTitlesRow){const V=F.pageSetup.printTitlesRow.split(":");B.push(`'${F.name}'!$${V[0]}:$${V[1]}`)}const W={name:"_xlnm.Print_Titles",ranges:B,localSheetId:N};k.push(W)}N++}),k.length&&(y.definedNames=y.definedNames.concat(k)),(y.media||[]).forEach((F,B)=>{F.name=F.type+(B+1)})}render(y,k){y.openXml(l.StdDocAttributes),y.openNode("workbook",g.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(y),this.map.workbookPr.render(y,k.properties),this.map.bookViews.render(y,k.views),this.map.sheets.render(y,k.sheets),this.map.definedNames.render(y,k.definedNames),this.map.calcPr.render(y,k.calcProperties),y.closeNode()}parseOpen(y){if(this.parser)return this.parser.parseOpen(y),!0;switch(y.name){case"workbook":return!0;default:return this.parser=this.map[y.name],this.parser&&this.parser.parseOpen(y),!0}}parseText(y){this.parser&&this.parser.parseText(y)}parseClose(y){if(this.parser)return this.parser.parseClose(y)||(this.parser=void 0),!0;switch(y){case"workbook":return this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1;default:return!0}}reconcile(y){const k=(y.workbookRels||[]).reduce((V,q)=>(V[q.Id]=q,V),{}),N=[];let F,B=0;(y.sheets||[]).forEach(V=>{const q=k[V.rId];q&&(F=y.worksheetHash["xl/"+q.Target.replace(/^(\s|\/xl\/)+/,"")],F&&(F.name=V.name,F.id=V.id,F.state=V.state,N[B++]=F))});const W=[];o.each(y.definedNames,V=>{if(V.name==="_xlnm.Print_Area"){if(F=N[V.localSheetId],F){F.pageSetup||(F.pageSetup={});const q=s.decodeEx(V.ranges[0]);F.pageSetup.printArea=F.pageSetup.printArea?`${F.pageSetup.printArea}&&${q.dimensions}`:q.dimensions}}else if(V.name==="_xlnm.Print_Titles"){if(F=N[V.localSheetId],F){F.pageSetup||(F.pageSetup={});const q=V.ranges.join(","),X=/\$/g,I=/\$\d+:\$\d+/,H=q.match(I);if(H&&H.length){const C=H[0];F.pageSetup.printTitlesRow=C.replace(X,"")}const O=/\$[A-Z]+:\$[A-Z]+/,R=q.match(O);if(R&&R.length){const C=R[0];F.pageSetup.printTitlesColumn=C.replace(X,"")}}}else W.push(V)}),y.definedNames=W,y.media.forEach((V,q)=>{V.index=q})}}g.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},g.STATIC_XFORMS={fileVersion:new i({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})},n.exports=g},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./defined-name-xform":33,"./sheet-xform":34,"./workbook-calc-properties-xform":35,"./workbook-properties-xform":36,"./workbook-view-xform":37}],39:[function(e,n,a){const o=e("../strings/rich-text-xform"),s=e("../../../utils/utils"),l=e("../base-xform"),c=n.exports=function(i){this.model=i};s.inherits(c,l,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new o),this._richTextXform},render(i,u){u=u||this.model,i.openNode("comment",{ref:u.ref,authorId:0}),i.openNode("text"),u&&u.note&&u.note.texts&&u.note.texts.forEach(p=>{this.richTextXform.render(i,p)}),i.closeNode(),i.closeNode()},parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case"comment":return this.model={type:"note",note:{texts:[]},...i.attributes},!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(i),!0;default:return!1}},parseText(i){this.parser&&this.parser.parseText(i)},parseClose(i){switch(i){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(i),!0}}})},{"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],40:[function(e,n,a){const o=e("../../../utils/xml-stream"),s=e("../../../utils/utils"),l=e("../base-xform"),c=e("./comment-xform"),i=n.exports=function(){this.map={comment:new c}};s.inherits(i,l,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(u,p){p=p||this.model,u.openXml(o.StdDocAttributes),u.openNode("comments",i.COMMENTS_ATTRIBUTES),u.openNode("authors"),u.leafNode("author",null,"Author"),u.closeNode(),u.openNode("commentList"),p.comments.forEach(f=>{this.map.comment.render(u,f)}),u.closeNode(),u.closeNode()},parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(u),!0;default:return!1}},parseText(u){this.parser&&this.parser.parseText(u)},parseClose(u){switch(u){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(u),!0}}})},{"../../../utils/utils":27,"../../../utils/xml-stream":28,"../base-xform":32,"./comment-xform":39}],41:[function(e,n,a){const o=e("../../base-xform");n.exports=class extends o{constructor(s){super(),this._model=s}get tag(){return this._model&&this._model.tag}render(s,l,c){(l===c[2]||this.tag==="x:SizeWithCells"&&l===c[1])&&s.leafNode(this.tag)}parseOpen(s){switch(s.name){case this.tag:return this.model={},this.model[this.tag]=!0,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../base-xform":32}],42:[function(e,n,a){const o=e("../../base-xform");n.exports=class extends o{constructor(s){super(),this._model=s}get tag(){return this._model&&this._model.tag}render(s,l){s.leafNode(this.tag,null,l)}parseOpen(s){switch(s.name){case this.tag:return this.text="",!0;default:return!1}}parseText(s){this.text=s}parseClose(){return!1}}},{"../../base-xform":32}],43:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"x:Anchor"}getAnchorRect(s){const l=Math.floor(s.left),c=Math.floor(68*(s.left-l)),i=Math.floor(s.top),u=Math.floor(18*(s.top-i)),p=Math.floor(s.right),f=Math.floor(68*(s.right-p)),h=Math.floor(s.bottom);return[l,c,i,u,p,f,h,Math.floor(18*(s.bottom-h))]}getDefaultRect(s){const l=s.col,c=Math.max(s.row-2,0);return[l,6,c,14,l+2,2,c+4,16]}render(s,l){const c=l.anchor?this.getAnchorRect(l.anchor):this.getDefaultRect(l.refAddress);s.leafNode("x:Anchor",null,c.join(", "))}parseOpen(s){switch(s.name){case this.tag:return this.text="",!0;default:return!1}}parseText(s){this.text=s}parseClose(){return!1}}},{"../base-xform":32}],44:[function(e,n,a){const o=e("../base-xform"),s=e("./vml-anchor-xform"),l=e("./style/vml-protection-xform"),c=e("./style/vml-position-xform"),i=["twoCells","oneCells","absolute"];n.exports=class extends o{constructor(){super(),this.map={"x:Anchor":new s,"x:Locked":new l({tag:"x:Locked"}),"x:LockText":new l({tag:"x:LockText"}),"x:SizeWithCells":new c({tag:"x:SizeWithCells"}),"x:MoveWithCells":new c({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(u,p){const{protection:f,editAs:h}=p.note;u.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(u,h,i),this.map["x:SizeWithCells"].render(u,h,i),this.map["x:Anchor"].render(u,p),this.map["x:Locked"].render(u,f.locked),u.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(u,f.lockText),u.leafNode("x:Row",null,p.refAddress.row-1),u.leafNode("x:Column",null,p.refAddress.col-1),u.closeNode()}parseOpen(u){switch(u.name){case this.tag:this.reset(),this.model={anchor:[],protection:{},editAs:""};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.normalizeModel(),!1;default:return!0}}normalizeModel(){const u=Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model),p=Object.keys(u).length;this.model.editAs=i[p],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}}},{"../base-xform":32,"./style/vml-position-xform":41,"./style/vml-protection-xform":42,"./vml-anchor-xform":43}],45:[function(e,n,a){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("./vml-shape-xform");class c extends s{constructor(){super(),this.map={"v:shape":new l}}get tag(){return"xml"}render(u,p){u.openXml(o.StdDocAttributes),u.openNode(this.tag,c.DRAWING_ATTRIBUTES),u.openNode("o:shapelayout",{"v:ext":"edit"}),u.leafNode("o:idmap",{"v:ext":"edit",data:1}),u.closeNode(),u.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),u.leafNode("v:stroke",{joinstyle:"miter"}),u.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),u.closeNode(),p.comments.forEach((f,h)=>{this.map["v:shape"].render(u,f,h)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset(),this.model={comments:[]};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0;switch(u){case this.tag:return!1;default:return!0}}reconcile(u,p){u.anchors.forEach(f=>{f.br?this.map["xdr:twoCellAnchor"].reconcile(f,p):this.map["xdr:oneCellAnchor"].reconcile(f,p)})}}c.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},n.exports=c},{"../../../utils/xml-stream":28,"../base-xform":32,"./vml-shape-xform":46}],46:[function(e,n,a){const o=e("../base-xform"),s=e("./vml-textbox-xform"),l=e("./vml-client-data-xform");class c extends o{constructor(){super(),this.map={"v:textbox":new s,"x:ClientData":new l}}get tag(){return"v:shape"}render(u,p,f){u.openNode("v:shape",c.V_SHAPE_ATTRIBUTES(p,f)),u.leafNode("v:fill",{color2:"infoBackground [80]"}),u.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),u.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(u,p),this.map["x:ClientData"].render(u,p),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset(),this.model={margins:{insetmode:u.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1;default:return!0}}}c.V_SHAPE_ATTRIBUTES=(i,u)=>({id:"_x0000_s"+(1025+u),type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":i.note.margins&&i.note.margins.insetmode}),n.exports=c},{"../base-xform":32,"./vml-client-data-xform":44,"./vml-textbox-xform":47}],47:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"v:textbox"}conversionUnit(s,l,c){return`${parseFloat(s)*l.toFixed(2)}${c}`}reverseConversionUnit(s){return(s||"").split(",").map(l=>Number(parseFloat(this.conversionUnit(parseFloat(l),.1,"")).toFixed(2)))}render(s,l){const c={style:"mso-direction-alt:auto"};if(l&&l.note){let{inset:i}=l.note&&l.note.margins;Array.isArray(i)&&(i=i.map(u=>this.conversionUnit(u,10,"mm")).join(",")),i&&(c.inset=i)}s.openNode("v:textbox",c),s.leafNode("div",{style:"text-align:left"}),s.closeNode()}parseOpen(s){switch(s.name){case this.tag:return this.model={inset:this.reverseConversionUnit(s.attributes.inset)},!0;default:return!0}}parseText(){}parseClose(s){switch(s){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],48:[function(e,n,a){const o=e("./base-xform");n.exports=class extends o{createNewModel(s){return{}}parseOpen(s){return this.parser=this.parser||this.map[s.name],this.parser?(this.parser.parseOpen(s),!0):s.name===this.tag&&(this.model=this.createNewModel(s),!0)}parseText(s){this.parser&&this.parser.parseText(s)}onParserClose(s,l){this.model[s]=l.model}parseClose(s){return this.parser?(this.parser.parseClose(s)||(this.onParserClose(s,this.parser),this.parser=void 0),!0):s!==this.tag}}},{"./base-xform":32}],49:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{render(s,l){s.openNode("HeadingPairs"),s.openNode("vt:vector",{size:2,baseType:"variant"}),s.openNode("vt:variant"),s.leafNode("vt:lpstr",void 0,"Worksheets"),s.closeNode(),s.openNode("vt:variant"),s.leafNode("vt:i4",void 0,l.length),s.closeNode(),s.closeNode(),s.closeNode()}parseOpen(s){return s.name==="HeadingPairs"}parseText(){}parseClose(s){return s!=="HeadingPairs"}}},{"../base-xform":32}],50:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{render(s,l){s.openNode("TitlesOfParts"),s.openNode("vt:vector",{size:l.length,baseType:"lpstr"}),l.forEach(c=>{s.leafNode("vt:lpstr",void 0,c.name)}),s.closeNode(),s.closeNode()}parseOpen(s){return s.name==="TitlesOfParts"}parseText(){}parseClose(s){return s!=="TitlesOfParts"}}},{"../base-xform":32}],51:[function(e,n,a){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("../simple/string-xform"),c=e("./app-heading-pairs-xform"),i=e("./app-titles-of-parts-xform");class u extends s{constructor(){super(),this.map={Company:new l({tag:"Company"}),Manager:new l({tag:"Manager"}),HeadingPairs:new c,TitleOfParts:new i}}render(f,h){f.openXml(o.StdDocAttributes),f.openNode("Properties",u.PROPERTY_ATTRIBUTES),f.leafNode("Application",void 0,"Microsoft Excel"),f.leafNode("DocSecurity",void 0,"0"),f.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(f,h.worksheets),this.map.TitleOfParts.render(f,h.worksheets),this.map.Company.render(f,h.company||""),this.map.Manager.render(f,h.manager),f.leafNode("LinksUpToDate",void 0,"false"),f.leafNode("SharedDoc",void 0,"false"),f.leafNode("HyperlinksChanged",void 0,"false"),f.leafNode("AppVersion",void 0,"16.0300"),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"Properties":return!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.parser=void 0),!0;switch(f){case"Properties":return this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1;default:return!0}}}u.DateFormat=function(p){return p.toISOString().replace(/[.]\d{3,6}/,"")},u.DateAttrs={"xsi:type":"dcterms:W3CDTF"},u.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},n.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/string-xform":119,"./app-heading-pairs-xform":49,"./app-titles-of-parts-xform":50}],52:[function(e,n,a){const o=e("../../../utils/xml-stream"),s=e("../base-xform");class l extends s{render(i,u){i.openXml(o.StdDocAttributes),i.openNode("Types",l.PROPERTY_ATTRIBUTES);const p={};(u.media||[]).forEach(f=>{if(f.type==="image"){const h=f.extension;p[h]||(p[h]=!0,i.leafNode("Default",{Extension:h,ContentType:"image/"+h}))}}),i.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),i.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),i.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),u.worksheets.forEach(f=>{const h=`/xl/worksheets/sheet${f.id}.xml`;i.leafNode("Override",{PartName:h,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),i.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),i.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),u.sharedStrings&&u.sharedStrings.count&&i.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),u.tables&&u.tables.forEach(f=>{i.leafNode("Override",{PartName:"/xl/tables/"+f.target,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),u.drawings&&u.drawings.forEach(f=>{i.leafNode("Override",{PartName:`/xl/drawings/${f.name}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),u.commentRefs&&(i.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),u.commentRefs.forEach(f=>{let{commentName:h}=f;i.leafNode("Override",{PartName:`/xl/${h}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),i.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),i.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),i.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}}l.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},n.exports=l},{"../../../utils/xml-stream":28,"../base-xform":32}],53:[function(e,n,a){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("../simple/date-xform"),c=e("../simple/string-xform"),i=e("../simple/integer-xform");class u extends s{constructor(){super(),this.map={"dc:creator":new c({tag:"dc:creator"}),"dc:title":new c({tag:"dc:title"}),"dc:subject":new c({tag:"dc:subject"}),"dc:description":new c({tag:"dc:description"}),"dc:identifier":new c({tag:"dc:identifier"}),"dc:language":new c({tag:"dc:language"}),"cp:keywords":new c({tag:"cp:keywords"}),"cp:category":new c({tag:"cp:category"}),"cp:lastModifiedBy":new c({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new l({tag:"cp:lastPrinted",format:u.DateFormat}),"cp:revision":new i({tag:"cp:revision"}),"cp:version":new c({tag:"cp:version"}),"cp:contentStatus":new c({tag:"cp:contentStatus"}),"cp:contentType":new c({tag:"cp:contentType"}),"dcterms:created":new l({tag:"dcterms:created",attrs:u.DateAttrs,format:u.DateFormat}),"dcterms:modified":new l({tag:"dcterms:modified",attrs:u.DateAttrs,format:u.DateFormat})}}render(f,h){f.openXml(o.StdDocAttributes),f.openNode("cp:coreProperties",u.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(f,h.creator),this.map["dc:title"].render(f,h.title),this.map["dc:subject"].render(f,h.subject),this.map["dc:description"].render(f,h.description),this.map["dc:identifier"].render(f,h.identifier),this.map["dc:language"].render(f,h.language),this.map["cp:keywords"].render(f,h.keywords),this.map["cp:category"].render(f,h.category),this.map["cp:lastModifiedBy"].render(f,h.lastModifiedBy),this.map["cp:lastPrinted"].render(f,h.lastPrinted),this.map["cp:revision"].render(f,h.revision),this.map["cp:version"].render(f,h.version),this.map["cp:contentStatus"].render(f,h.contentStatus),this.map["cp:contentType"].render(f,h.contentType),this.map["dcterms:created"].render(f,h.created),this.map["dcterms:modified"].render(f,h.modified),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[f.name],this.parser)return this.parser.parseOpen(f),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(f))}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.parser=void 0),!0;switch(f){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error("Unexpected xml node in parseClose: "+f)}}}u.DateFormat=function(p){return p.toISOString().replace(/[.]\d{3}/,"")},u.DateAttrs={"xsi:type":"dcterms:W3CDTF"},u.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},n.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/date-xform":117,"../simple/integer-xform":118,"../simple/string-xform":119}],54:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{render(s,l){s.leafNode("Relationship",l)}parseOpen(s){switch(s.name){case"Relationship":return this.model=s.attributes,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],55:[function(e,n,a){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("./relationship-xform");class c extends s{constructor(){super(),this.map={Relationship:new l}}render(u,p){p=p||this._values,u.openXml(o.StdDocAttributes),u.openNode("Relationships",c.RELATIONSHIPS_ATTRIBUTES),p.forEach(f=>{this.map.Relationship.render(u,f)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"Relationships":return this.model=[],!0;default:if(this.parser=this.map[u.name],this.parser)return this.parser.parseOpen(u),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(u))}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.push(this.parser.model),this.parser=void 0),!0;switch(u){case"Relationships":return!1;default:throw new Error("Unexpected xml node in parseClose: "+u)}}}c.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},n.exports=c},{"../../../utils/xml-stream":28,"../base-xform":32,"./relationship-xform":54}],56:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{parseOpen(s){if(this.parser)return this.parser.parseOpen(s),!0;switch(s.name){case this.tag:this.reset(),this.model={range:{editAs:s.attributes.editAs||"oneCell"}};break;default:this.parser=this.map[s.name],this.parser&&this.parser.parseOpen(s)}return!0}parseText(s){this.parser&&this.parser.parseText(s)}reconcilePicture(s,l){if(s&&s.rId){const c=l.rels[s.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(c){const i=c[1],u=l.mediaIndex[i];return l.media[u]}}}}},{"../base-xform":32}],57:[function(e,n,a){const o=e("../base-xform"),s=e("./blip-xform");n.exports=class extends o{constructor(){super(),this.map={"a:blip":new s}}get tag(){return"xdr:blipFill"}render(l,c){l.openNode(this.tag),this.map["a:blip"].render(l,c),l.openNode("a:stretch"),l.leafNode("a:fillRect"),l.closeNode(),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:this.reset();break;default:this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)}return!0}parseText(){}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model=this.map["a:blip"].model,!1;default:return!0}}}},{"../base-xform":32,"./blip-xform":58}],58:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"a:blip"}render(s,l){s.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":l.rId,cstate:"print"})}parseOpen(s){switch(s.name){case this.tag:return this.model={rId:s.attributes["r:embed"]},!0;default:return!0}}parseText(){}parseClose(s){switch(s){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],59:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"xdr:cNvPicPr"}render(s){s.openNode(this.tag),s.leafNode("a:picLocks",{noChangeAspect:"1"}),s.closeNode()}parseOpen(s){switch(s.name){case this.tag:default:return!0}}parseText(){}parseClose(s){switch(s){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],60:[function(e,n,a){const o=e("../base-xform"),s=e("./hlink-click-xform"),l=e("./ext-lst-xform");n.exports=class extends o{constructor(){super(),this.map={"a:hlinkClick":new s,"a:extLst":new l}}get tag(){return"xdr:cNvPr"}render(c,i){c.openNode(this.tag,{id:i.index,name:"Picture "+i.index}),this.map["a:hlinkClick"].render(c,i),this.map["a:extLst"].render(c,i),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:this.reset();break;default:this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)}return!0}parseText(){}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;switch(c){case this.tag:return this.model=this.map["a:hlinkClick"].model,!1;default:return!0}}}},{"../base-xform":32,"./ext-lst-xform":63,"./hlink-click-xform":65}],61:[function(e,n,a){const o=e("../base-xform"),s=e("../simple/integer-xform");n.exports=class extends o{constructor(l){super(),this.tag=l.tag,this.map={"xdr:col":new s({tag:"xdr:col",zero:!0}),"xdr:colOff":new s({tag:"xdr:colOff",zero:!0}),"xdr:row":new s({tag:"xdr:row",zero:!0}),"xdr:rowOff":new s({tag:"xdr:rowOff",zero:!0})}}render(l,c){l.openNode(this.tag),this.map["xdr:col"].render(l,c.nativeCol),this.map["xdr:colOff"].render(l,c.nativeColOff),this.map["xdr:row"].render(l,c.nativeRow),this.map["xdr:rowOff"].render(l,c.nativeRowOff),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:this.reset();break;default:this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)}return!0}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1;default:return!0}}}},{"../base-xform":32,"../simple/integer-xform":118}],62:[function(e,n,a){const o=e("../../../utils/col-cache"),s=e("../../../utils/xml-stream"),l=e("../base-xform"),c=e("./two-cell-anchor-xform"),i=e("./one-cell-anchor-xform");class u extends l{constructor(){super(),this.map={"xdr:twoCellAnchor":new c,"xdr:oneCellAnchor":new i}}prepare(f){f.anchors.forEach((h,v)=>{h.anchorType=function(b){return(typeof b.range=="string"?o.decode(b.range):b.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor"}(h),this.map[h.anchorType].prepare(h,{index:v})})}get tag(){return"xdr:wsDr"}render(f,h){f.openXml(s.StdDocAttributes),f.openNode(this.tag,u.DRAWING_ATTRIBUTES),h.anchors.forEach(v=>{this.map[v.anchorType].render(f,v)}),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case this.tag:this.reset(),this.model={anchors:[]};break;default:this.parser=this.map[f.name],this.parser&&this.parser.parseOpen(f)}return!0}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0;switch(f){case this.tag:return!1;default:return!0}}reconcile(f,h){f.anchors.forEach(v=>{v.br?this.map["xdr:twoCellAnchor"].reconcile(v,h):this.map["xdr:oneCellAnchor"].reconcile(v,h)})}}u.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},n.exports=u},{"../../../utils/col-cache":19,"../../../utils/xml-stream":28,"../base-xform":32,"./one-cell-anchor-xform":67,"./two-cell-anchor-xform":70}],63:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"a:extLst"}render(s){s.openNode(this.tag),s.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),s.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),s.closeNode(),s.closeNode()}parseOpen(s){switch(s.name){case this.tag:default:return!0}}parseText(){}parseClose(s){switch(s){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],64:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.map={}}render(s,l){s.openNode(this.tag);const c=Math.floor(9525*l.width),i=Math.floor(9525*l.height);s.addAttribute("cx",c),s.addAttribute("cy",i),s.closeNode()}parseOpen(s){return s.name===this.tag&&(this.model={width:parseInt(s.attributes.cx||"0",10)/9525,height:parseInt(s.attributes.cy||"0",10)/9525},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],65:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"a:hlinkClick"}render(s,l){l.hyperlinks&&l.hyperlinks.rId&&s.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":l.hyperlinks.rId,tooltip:l.hyperlinks.tooltip})}parseOpen(s){switch(s.name){case this.tag:return this.model={hyperlinks:{rId:s.attributes["r:id"],tooltip:s.attributes.tooltip}},!0;default:return!0}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],66:[function(e,n,a){const o=e("../base-xform"),s=e("./c-nv-pr-xform"),l=e("./c-nv-pic-pr-xform");n.exports=class extends o{constructor(){super(),this.map={"xdr:cNvPr":new s,"xdr:cNvPicPr":new l}}get tag(){return"xdr:nvPicPr"}render(c,i){c.openNode(this.tag),this.map["xdr:cNvPr"].render(c,i),this.map["xdr:cNvPicPr"].render(c,i),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:this.reset();break;default:this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)}return!0}parseText(){}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;switch(c){case this.tag:return this.model=this.map["xdr:cNvPr"].model,!1;default:return!0}}}},{"../base-xform":32,"./c-nv-pic-pr-xform":59,"./c-nv-pr-xform":60}],67:[function(e,n,a){const o=e("./base-cell-anchor-xform"),s=e("../static-xform"),l=e("./cell-position-xform"),c=e("./ext-xform"),i=e("./pic-xform");n.exports=class extends o{constructor(){super(),this.map={"xdr:from":new l({tag:"xdr:from"}),"xdr:ext":new c({tag:"xdr:ext"}),"xdr:pic":new i,"xdr:clientData":new s({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(u,p){this.map["xdr:pic"].prepare(u.picture,p)}render(u,p){u.openNode(this.tag,{editAs:p.range.editAs||"oneCell"}),this.map["xdr:from"].render(u,p.range.tl),this.map["xdr:ext"].render(u,p.range.ext),this.map["xdr:pic"].render(u,p.picture),this.map["xdr:clientData"].render(u,{}),u.closeNode()}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(u,p){u.medium=this.reconcilePicture(u.picture,p)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./ext-xform":64,"./pic-xform":68}],68:[function(e,n,a){const o=e("../base-xform"),s=e("../static-xform"),l=e("./blip-fill-xform"),c=e("./nv-pic-pr-xform"),i=e("./sp-pr");n.exports=class extends o{constructor(){super(),this.map={"xdr:nvPicPr":new c,"xdr:blipFill":new l,"xdr:spPr":new s(i)}}get tag(){return"xdr:pic"}prepare(u,p){u.index=p.index+1}render(u,p){u.openNode(this.tag),this.map["xdr:nvPicPr"].render(u,p),this.map["xdr:blipFill"].render(u,p),this.map["xdr:spPr"].render(u,p),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset();break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(){}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.mergeModel(this.parser.model),this.parser=void 0),!0;switch(u){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"../static-xform":120,"./blip-fill-xform":57,"./nv-pic-pr-xform":66,"./sp-pr":69}],69:[function(e,n,a){n.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}},{}],70:[function(e,n,a){const o=e("./base-cell-anchor-xform"),s=e("../static-xform"),l=e("./cell-position-xform"),c=e("./pic-xform");n.exports=class extends o{constructor(){super(),this.map={"xdr:from":new l({tag:"xdr:from"}),"xdr:to":new l({tag:"xdr:to"}),"xdr:pic":new c,"xdr:clientData":new s({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(i,u){this.map["xdr:pic"].prepare(i.picture,u)}render(i,u){i.openNode(this.tag,{editAs:u.range.editAs||"oneCell"}),this.map["xdr:from"].render(i,u.range.tl),this.map["xdr:to"].render(i,u.range.br),this.map["xdr:pic"].render(i,u.picture),this.map["xdr:clientData"].render(i,{}),i.closeNode()}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.parser=void 0),!0;switch(i){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(i,u){i.medium=this.reconcilePicture(i.picture,u)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./pic-xform":68}],71:[function(e,n,a){const o=e("./base-xform");n.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.always=!!s.always,this.count=s.count,this.empty=s.empty,this.$count=s.$count||"count",this.$=s.$,this.childXform=s.childXform,this.maxItems=s.maxItems}prepare(s,l){const{childXform:c}=this;s&&s.forEach((i,u)=>{l.index=u,c.prepare(i,l)})}render(s,l){if(this.always||l&&l.length){s.openNode(this.tag,this.$),this.count&&s.addAttribute(this.$count,l&&l.length||0);const{childXform:c}=this;(l||[]).forEach((i,u)=>{c.render(s,i,u)}),s.closeNode()}else this.empty&&s.leafNode(this.tag)}parseOpen(s){if(this.parser)return this.parser.parseOpen(s),!0;switch(s.name){case this.tag:return this.model=[],!0;default:return!!this.childXform.parseOpen(s)&&(this.parser=this.childXform,!0)}}parseText(s){this.parser&&this.parser.parseText(s)}parseClose(s){if(this.parser){if(!this.parser.parseClose(s)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw new Error(`Max ${this.childXform.tag} count (${this.maxItems}) exceeded`);return!0}return!1}reconcile(s,l){if(s){const{childXform:c}=this;s.forEach(i=>{c.reconcile(i,l)})}}}},{"./base-xform":32}],72:[function(e,n,a){const o=e("../../../utils/col-cache"),s=e("../base-xform");n.exports=class extends s{get tag(){return"autoFilter"}render(l,c){if(c)if(typeof c=="string")l.leafNode("autoFilter",{ref:c});else{const i=function(f){return typeof f=="string"?f:o.getAddress(f.row,f.column).address},u=i(c.from),p=i(c.to);u&&p&&l.leafNode("autoFilter",{ref:`${u}:${p}`})}}parseOpen(l){l.name==="autoFilter"&&(this.model=l.attributes.ref)}}},{"../../../utils/col-cache":19,"../base-xform":32}],73:[function(e,n,a){const o=e("../../../utils/utils"),s=e("../base-xform"),l=e("../../../doc/range"),c=e("../../../doc/enums"),i=e("../strings/rich-text-xform");function u(p){if(p==null)return c.ValueType.Null;if(p instanceof String||typeof p=="string")return c.ValueType.String;if(typeof p=="number")return c.ValueType.Number;if(typeof p=="boolean")return c.ValueType.Boolean;if(p instanceof Date)return c.ValueType.Date;if(p.text&&p.hyperlink)return c.ValueType.Hyperlink;if(p.formula)return c.ValueType.Formula;if(p.error)return c.ValueType.Error;throw new Error("I could not understand type of value")}n.exports=class extends s{constructor(){super(),this.richTextXForm=new i}get tag(){return"c"}prepare(p,f){const h=f.styles.addStyleModel(p.style||{},function(v){switch(v.type){case c.ValueType.Formula:return u(v.result);default:return v.type}}(p));switch(h&&(p.styleId=h),p.comment&&f.comments.push({...p.comment,ref:p.address}),p.type){case c.ValueType.String:case c.ValueType.RichText:f.sharedStrings&&(p.ssId=f.sharedStrings.add(p.value));break;case c.ValueType.Date:f.date1904&&(p.date1904=!0);break;case c.ValueType.Hyperlink:f.sharedStrings&&p.text!==void 0&&p.text!==null&&(p.ssId=f.sharedStrings.add(p.text)),f.hyperlinks.push({address:p.address,target:p.hyperlink,tooltip:p.tooltip});break;case c.ValueType.Merge:f.merges.add(p);break;case c.ValueType.Formula:if(f.date1904&&(p.date1904=!0),p.shareType==="shared"&&(p.si=f.siFormulae++),p.formula)f.formulae[p.address]=p;else if(p.sharedFormula){const v=f.formulae[p.sharedFormula];if(!v)throw new Error("Shared Formula master must exist above and or left of clone for cell "+p.address);v.si===void 0?(v.shareType="shared",v.si=f.siFormulae++,v.range=new l(v.address,p.address)):v.range&&v.range.expandToAddress(p.address),p.si=v.si}}}renderFormula(p,f){let h=null;switch(f.shareType){case"shared":h={t:"shared",ref:f.ref||f.range.range,si:f.si};break;case"array":h={t:"array",ref:f.ref};break;default:f.si!==void 0&&(h={t:"shared",si:f.si})}switch(u(f.result)){case c.ValueType.Null:p.leafNode("f",h,f.formula);break;case c.ValueType.String:p.addAttribute("t","str"),p.leafNode("f",h,f.formula),p.leafNode("v",null,f.result);break;case c.ValueType.Number:p.leafNode("f",h,f.formula),p.leafNode("v",null,f.result);break;case c.ValueType.Boolean:p.addAttribute("t","b"),p.leafNode("f",h,f.formula),p.leafNode("v",null,f.result?1:0);break;case c.ValueType.Error:p.addAttribute("t","e"),p.leafNode("f",h,f.formula),p.leafNode("v",null,f.result.error);break;case c.ValueType.Date:p.leafNode("f",h,f.formula),p.leafNode("v",null,o.dateToExcel(f.result,f.date1904));break;default:throw new Error("I could not understand type of value")}}render(p,f){if(f.type!==c.ValueType.Null||f.styleId){switch(p.openNode("c"),p.addAttribute("r",f.address),f.styleId&&p.addAttribute("s",f.styleId),f.type){case c.ValueType.Null:break;case c.ValueType.Number:p.leafNode("v",null,f.value);break;case c.ValueType.Boolean:p.addAttribute("t","b"),p.leafNode("v",null,f.value?"1":"0");break;case c.ValueType.Error:p.addAttribute("t","e"),p.leafNode("v",null,f.value.error);break;case c.ValueType.String:case c.ValueType.RichText:f.ssId!==void 0?(p.addAttribute("t","s"),p.leafNode("v",null,f.ssId)):f.value&&f.value.richText?(p.addAttribute("t","inlineStr"),p.openNode("is"),f.value.richText.forEach(h=>{this.richTextXForm.render(p,h)}),p.closeNode("is")):(p.addAttribute("t","str"),p.leafNode("v",null,f.value));break;case c.ValueType.Date:p.leafNode("v",null,o.dateToExcel(f.value,f.date1904));break;case c.ValueType.Hyperlink:f.ssId!==void 0?(p.addAttribute("t","s"),p.leafNode("v",null,f.ssId)):(p.addAttribute("t","str"),p.leafNode("v",null,f.text));break;case c.ValueType.Formula:this.renderFormula(p,f);break;case c.ValueType.Merge:}p.closeNode()}}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;switch(p.name){case"c":return this.model={address:p.attributes.r},this.t=p.attributes.t,p.attributes.s&&(this.model.styleId=parseInt(p.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=p.attributes.si,this.model.shareType=p.attributes.t,this.model.ref=p.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(p),!0;default:return!1}}parseText(p){if(this.parser)this.parser.parseText(p);else switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+p:p;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+p:p:this.model.value=this.model.value?this.model.value+p:p}}parseClose(p){switch(p){case"c":{const{model:f}=this;if(f.formula||f.shareType)f.type=c.ValueType.Formula,f.value&&(this.t==="str"?f.result=o.xmlDecode(f.value):this.t==="b"?f.result=parseInt(f.value,10)!==0:this.t==="e"?f.result={error:f.value}:f.result=parseFloat(f.value),f.value=void 0);else if(f.value!==void 0)switch(this.t){case"s":f.type=c.ValueType.String,f.value=parseInt(f.value,10);break;case"str":f.type=c.ValueType.String,f.value=o.xmlDecode(f.value);break;case"inlineStr":f.type=c.ValueType.String;break;case"b":f.type=c.ValueType.Boolean,f.value=parseInt(f.value,10)!==0;break;case"e":f.type=c.ValueType.Error,f.value={error:f.value};break;default:f.type=c.ValueType.Number,f.value=parseFloat(f.value)}else f.styleId?f.type=c.ValueType.Null:f.type=c.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?(this.parser.parseClose(p),!0):(this.currentNode=void 0,!0);case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return!!this.parser&&(this.parser.parseClose(p),!0)}}reconcile(p,f){const h=p.styleId&&f.styles&&f.styles.getStyleModel(p.styleId);switch(h&&(p.style=h),p.styleId!==void 0&&(p.styleId=void 0),p.type){case c.ValueType.String:typeof p.value=="number"&&f.sharedStrings&&(p.value=f.sharedStrings.getString(p.value)),p.value.richText&&(p.type=c.ValueType.RichText);break;case c.ValueType.Number:h&&o.isDateFmt(h.numFmt)&&(p.type=c.ValueType.Date,p.value=o.excelToDate(p.value,f.date1904));break;case c.ValueType.Formula:p.result!==void 0&&h&&o.isDateFmt(h.numFmt)&&(p.result=o.excelToDate(p.result,f.date1904)),p.shareType==="shared"&&(p.ref?f.formulae[p.si]=p.address:(p.sharedFormula=f.formulae[p.si],delete p.shareType),delete p.si)}const v=f.hyperlinkMap[p.address];v&&(p.type===c.ValueType.Formula?(p.text=p.result,p.result=void 0):(p.text=p.value,p.value=void 0),p.type=c.ValueType.Hyperlink,p.hyperlink=v);const b=f.commentsMap&&f.commentsMap[p.address];b&&(p.comment=b)}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],74:[function(e,n,a){const o=e("../../base-xform");n.exports=class extends o{get tag(){return"x14:cfIcon"}render(s,l){s.leafNode(this.tag,{iconSet:l.iconSet,iconId:l.iconId})}parseOpen(s){let{attributes:l}=s;this.model={iconSet:l.iconSet,iconId:o.toIntValue(l.iconId)}}parseClose(s){return s!==this.tag}}},{"../../base-xform":32}],75:[function(e,n,a){const{v4:o}=e("uuid"),s=e("../../base-xform"),l=e("../../composite-xform"),c=e("./databar-ext-xform"),i=e("./icon-set-ext-xform"),u={"3Triangles":!0,"3Stars":!0,"5Boxes":!0};class p extends l{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new c,"x14:iconSet":this.iconSetXform=new i}}get tag(){return"x14:cfRule"}static isExt(h){return h.type==="dataBar"?c.isExt(h):!(h.type!=="iconSet"||!h.custom&&!u[h.iconSet])}prepare(h){p.isExt(h)&&(h.x14Id=`{${o()}}`.toUpperCase())}render(h,v){if(p.isExt(v))switch(v.type){case"dataBar":this.renderDataBar(h,v);break;case"iconSet":this.renderIconSet(h,v)}}renderDataBar(h,v){h.openNode(this.tag,{type:"dataBar",id:v.x14Id}),this.databarXform.render(h,v),h.closeNode()}renderIconSet(h,v){h.openNode(this.tag,{type:"iconSet",priority:v.priority,id:v.x14Id||`{${o()}}`}),this.iconSetXform.render(h,v),h.closeNode()}createNewModel(h){let{attributes:v}=h;return{type:v.type,x14Id:v.id,priority:s.toIntValue(v.priority)}}onParserClose(h,v){Object.assign(this.model,v.model)}}n.exports=p},{"../../base-xform":32,"../../composite-xform":48,"./databar-ext-xform":79,"./icon-set-ext-xform":81,uuid:528}],76:[function(e,n,a){const o=e("../../composite-xform"),s=e("./f-ext-xform");n.exports=class extends o{constructor(){super(),this.map={"xm:f":this.fExtXform=new s}}get tag(){return"x14:cfvo"}render(l,c){l.openNode(this.tag,{type:c.type}),c.value!==void 0&&this.fExtXform.render(l,c.value),l.closeNode()}createNewModel(l){return{type:l.attributes.type}}onParserClose(l,c){switch(l){case"xm:f":this.model.value=c.model?parseFloat(c.model):0}}}},{"../../composite-xform":48,"./f-ext-xform":80}],77:[function(e,n,a){const o=e("../../composite-xform"),s=e("./sqref-ext-xform"),l=e("./cf-rule-ext-xform");n.exports=class extends o{constructor(){super(),this.map={"xm:sqref":this.sqRef=new s,"x14:cfRule":this.cfRule=new l}}get tag(){return"x14:conditionalFormatting"}prepare(c,i){c.rules.forEach(u=>{this.cfRule.prepare(u,i)})}render(c,i){i.rules.some(l.isExt)&&(c.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),i.rules.filter(l.isExt).forEach(u=>this.cfRule.render(c,u)),this.sqRef.render(c,i.ref),c.closeNode())}createNewModel(){return{rules:[]}}onParserClose(c,i){switch(c){case"xm:sqref":this.model.ref=i.model;break;case"x14:cfRule":this.model.rules.push(i.model)}}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./sqref-ext-xform":82}],78:[function(e,n,a){const o=e("../../composite-xform"),s=e("./cf-rule-ext-xform"),l=e("./conditional-formatting-ext-xform");n.exports=class extends o{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new l}}get tag(){return"x14:conditionalFormattings"}hasContent(c){return c.hasExtContent===void 0&&(c.hasExtContent=c.some(i=>i.rules.some(s.isExt))),c.hasExtContent}prepare(c,i){c.forEach(u=>{this.cfXform.prepare(u,i)})}render(c,i){this.hasContent(i)&&(c.openNode(this.tag),i.forEach(u=>this.cfXform.render(c,u)),c.closeNode())}createNewModel(){return[]}onParserClose(c,i){this.model.push(i.model)}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./conditional-formatting-ext-xform":77}],79:[function(e,n,a){const o=e("../../base-xform"),s=e("../../composite-xform"),l=e("../../style/color-xform"),c=e("./cfvo-ext-xform");n.exports=class extends s{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new c,"x14:borderColor":this.borderColorXform=new l("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new l("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new l("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new l("x14:axisColor")}}static isExt(i){return!i.gradient}get tag(){return"x14:dataBar"}render(i,u){i.openNode(this.tag,{minLength:o.toIntAttribute(u.minLength,0,!0),maxLength:o.toIntAttribute(u.maxLength,100,!0),border:o.toBoolAttribute(u.border,!1),gradient:o.toBoolAttribute(u.gradient,!0),negativeBarColorSameAsPositive:o.toBoolAttribute(u.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:o.toBoolAttribute(u.negativeBarBorderColorSameAsPositive,!0),axisPosition:o.toAttribute(u.axisPosition,"auto"),direction:o.toAttribute(u.direction,"leftToRight")}),u.cfvo.forEach(p=>{this.cfvoXform.render(i,p)}),this.borderColorXform.render(i,u.borderColor),this.negativeBorderColorXform.render(i,u.negativeBorderColor),this.negativeFillColorXform.render(i,u.negativeFillColor),this.axisColorXform.render(i,u.axisColor),i.closeNode()}createNewModel(i){let{attributes:u}=i;return{cfvo:[],minLength:o.toIntValue(u.minLength,0),maxLength:o.toIntValue(u.maxLength,100),border:o.toBoolValue(u.border,!1),gradient:o.toBoolValue(u.gradient,!0),negativeBarColorSameAsPositive:o.toBoolValue(u.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:o.toBoolValue(u.negativeBarBorderColorSameAsPositive,!0),axisPosition:o.toStringValue(u.axisPosition,"auto"),direction:o.toStringValue(u.direction,"leftToRight")}}onParserClose(i,u){const[,p]=i.split(":");switch(p){case"cfvo":this.model.cfvo.push(u.model);break;default:this.model[p]=u.model}}}},{"../../base-xform":32,"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-ext-xform":76}],80:[function(e,n,a){const o=e("../../base-xform");n.exports=class extends o{get tag(){return"xm:f"}render(s,l){s.leafNode(this.tag,null,l)}parseOpen(){this.model=""}parseText(s){this.model+=s}parseClose(s){return s!==this.tag}}},{"../../base-xform":32}],81:[function(e,n,a){const o=e("../../base-xform"),s=e("../../composite-xform"),l=e("./cfvo-ext-xform"),c=e("./cf-icon-ext-xform");n.exports=class extends s{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new l,"x14:cfIcon":this.cfIconXform=new c}}get tag(){return"x14:iconSet"}render(i,u){i.openNode(this.tag,{iconSet:o.toStringAttribute(u.iconSet),reverse:o.toBoolAttribute(u.reverse,!1),showValue:o.toBoolAttribute(u.showValue,!0),custom:o.toBoolAttribute(u.icons,!1)}),u.cfvo.forEach(p=>{this.cfvoXform.render(i,p)}),u.icons&&u.icons.forEach((p,f)=>{p.iconId=f,this.cfIconXform.render(i,p)}),i.closeNode()}createNewModel(i){let{attributes:u}=i;return{cfvo:[],iconSet:o.toStringValue(u.iconSet,"3TrafficLights"),reverse:o.toBoolValue(u.reverse,!1),showValue:o.toBoolValue(u.showValue,!0)}}onParserClose(i,u){const[,p]=i.split(":");switch(p){case"cfvo":this.model.cfvo.push(u.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(u.model);break;default:this.model[p]=u.model}}}},{"../../base-xform":32,"../../composite-xform":48,"./cf-icon-ext-xform":74,"./cfvo-ext-xform":76}],82:[function(e,n,a){const o=e("../../base-xform");n.exports=class extends o{get tag(){return"xm:sqref"}render(s,l){s.leafNode(this.tag,null,l)}parseOpen(){this.model=""}parseText(s){this.model+=s}parseClose(s){return s!==this.tag}}},{"../../base-xform":32}],83:[function(e,n,a){const o=e("../../base-xform"),s=e("../../composite-xform"),l=e("../../../../doc/range"),c=e("./databar-xform"),i=e("./ext-lst-ref-xform"),u=e("./formula-xform"),p=e("./color-scale-xform"),f=e("./icon-set-xform"),h={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},v=g=>{const{type:x,operator:y}=g;switch(x){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:x};default:return{type:x,operator:y}}};class b extends s{constructor(){super(),this.map={dataBar:this.databarXform=new c,extLst:this.extLstRefXform=new i,formula:this.formulaXform=new u,colorScale:this.colorScaleXform=new p,iconSet:this.iconSetXform=new f}}get tag(){return"cfRule"}static isPrimitive(x){return x.type!=="iconSet"||!x.custom&&!h[x.iconSet]}render(x,y){switch(y.type){case"expression":this.renderExpression(x,y);break;case"cellIs":this.renderCellIs(x,y);break;case"top10":this.renderTop10(x,y);break;case"aboveAverage":this.renderAboveAverage(x,y);break;case"dataBar":this.renderDataBar(x,y);break;case"colorScale":this.renderColorScale(x,y);break;case"iconSet":this.renderIconSet(x,y);break;case"containsText":this.renderText(x,y);break;case"timePeriod":this.renderTimePeriod(x,y)}}renderExpression(x,y){x.openNode(this.tag,{type:"expression",dxfId:y.dxfId,priority:y.priority}),this.formulaXform.render(x,y.formulae[0]),x.closeNode()}renderCellIs(x,y){x.openNode(this.tag,{type:"cellIs",dxfId:y.dxfId,priority:y.priority,operator:y.operator}),y.formulae.forEach(k=>{this.formulaXform.render(x,k)}),x.closeNode()}renderTop10(x,y){x.leafNode(this.tag,{type:"top10",dxfId:y.dxfId,priority:y.priority,percent:o.toBoolAttribute(y.percent,!1),bottom:o.toBoolAttribute(y.bottom,!1),rank:o.toIntValue(y.rank,10,!0)})}renderAboveAverage(x,y){x.leafNode(this.tag,{type:"aboveAverage",dxfId:y.dxfId,priority:y.priority,aboveAverage:o.toBoolAttribute(y.aboveAverage,!0)})}renderDataBar(x,y){x.openNode(this.tag,{type:"dataBar",priority:y.priority}),this.databarXform.render(x,y),this.extLstRefXform.render(x,y),x.closeNode()}renderColorScale(x,y){x.openNode(this.tag,{type:"colorScale",priority:y.priority}),this.colorScaleXform.render(x,y),x.closeNode()}renderIconSet(x,y){b.isPrimitive(y)&&(x.openNode(this.tag,{type:"iconSet",priority:y.priority}),this.iconSetXform.render(x,y),x.closeNode())}renderText(x,y){x.openNode(this.tag,{type:y.operator,dxfId:y.dxfId,priority:y.priority,operator:o.toStringAttribute(y.operator,"containsText")});const k=(N=>{if(N.formulae&&N.formulae[0])return N.formulae[0];const F=new l(N.ref),{tl:B}=F;switch(N.operator){case"containsText":return`NOT(ISERROR(SEARCH("${N.text}",${B})))`;case"containsBlanks":return`LEN(TRIM(${B}))=0`;case"notContainsBlanks":return`LEN(TRIM(${B}))>0`;case"containsErrors":return`ISERROR(${B})`;case"notContainsErrors":return`NOT(ISERROR(${B}))`;default:return}})(y);k&&this.formulaXform.render(x,k),x.closeNode()}renderTimePeriod(x,y){x.openNode(this.tag,{type:"timePeriod",dxfId:y.dxfId,priority:y.priority,timePeriod:y.timePeriod});const k=(N=>{if(N.formulae&&N.formulae[0])return N.formulae[0];const F=new l(N.ref),{tl:B}=F;switch(N.timePeriod){case"thisWeek":return`AND(TODAY()-ROUNDDOWN(${B},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${B},0)-TODAY()<=7-WEEKDAY(TODAY()))`;case"lastWeek":return`AND(TODAY()-ROUNDDOWN(${B},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${B},0)<(WEEKDAY(TODAY())+7))`;case"nextWeek":return`AND(ROUNDDOWN(${B},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${B},0)-TODAY()<(15-WEEKDAY(TODAY())))`;case"yesterday":return`FLOOR(${B},1)=TODAY()-1`;case"today":return`FLOOR(${B},1)=TODAY()`;case"tomorrow":return`FLOOR(${B},1)=TODAY()+1`;case"last7Days":return`AND(TODAY()-FLOOR(${B},1)<=6,FLOOR(${B},1)<=TODAY())`;case"lastMonth":return`AND(MONTH(${B})=MONTH(EDATE(TODAY(),0-1)),YEAR(${B})=YEAR(EDATE(TODAY(),0-1)))`;case"thisMonth":return`AND(MONTH(${B})=MONTH(TODAY()),YEAR(${B})=YEAR(TODAY()))`;case"nextMonth":return`AND(MONTH(${B})=MONTH(EDATE(TODAY(),0+1)),YEAR(${B})=YEAR(EDATE(TODAY(),0+1)))`;default:return}})(y);k&&this.formulaXform.render(x,k),x.closeNode()}createNewModel(x){let{attributes:y}=x;return{...v(y),dxfId:o.toIntValue(y.dxfId),priority:o.toIntValue(y.priority),timePeriod:y.timePeriod,percent:o.toBoolValue(y.percent),bottom:o.toBoolValue(y.bottom),rank:o.toIntValue(y.rank),aboveAverage:o.toBoolValue(y.aboveAverage)}}onParserClose(x,y){switch(x){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,y.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(y.model)}}}n.exports=b},{"../../../../doc/range":10,"../../base-xform":32,"../../composite-xform":48,"./color-scale-xform":85,"./databar-xform":88,"./ext-lst-ref-xform":89,"./formula-xform":90,"./icon-set-xform":91}],84:[function(e,n,a){const o=e("../../base-xform");n.exports=class extends o{get tag(){return"cfvo"}render(s,l){s.leafNode(this.tag,{type:l.type,val:l.value})}parseOpen(s){this.model={type:s.attributes.type,value:o.toFloatValue(s.attributes.val)}}parseClose(s){return s!==this.tag}}},{"../../base-xform":32}],85:[function(e,n,a){const o=e("../../composite-xform"),s=e("../../style/color-xform"),l=e("./cfvo-xform");n.exports=class extends o{constructor(){super(),this.map={cfvo:this.cfvoXform=new l,color:this.colorXform=new s}}get tag(){return"colorScale"}render(c,i){c.openNode(this.tag),i.cfvo.forEach(u=>{this.cfvoXform.render(c,u)}),i.color.forEach(u=>{this.colorXform.render(c,u)}),c.closeNode()}createNewModel(c){return{cfvo:[],color:[]}}onParserClose(c,i){this.model[c].push(i.model)}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],86:[function(e,n,a){const o=e("../../composite-xform"),s=e("./cf-rule-xform");n.exports=class extends o{constructor(){super(),this.map={cfRule:new s}}get tag(){return"conditionalFormatting"}render(l,c){c.rules.some(s.isPrimitive)&&(l.openNode(this.tag,{sqref:c.ref}),c.rules.forEach(i=>{s.isPrimitive(i)&&(i.ref=c.ref,this.map.cfRule.render(l,i))}),l.closeNode())}createNewModel(l){let{attributes:c}=l;return{ref:c.sqref,rules:[]}}onParserClose(l,c){this.model.rules.push(c.model)}}},{"../../composite-xform":48,"./cf-rule-xform":83}],87:[function(e,n,a){const o=e("../../base-xform"),s=e("./conditional-formatting-xform");n.exports=class extends o{constructor(){super(),this.cfXform=new s}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(l,c){let i=l.reduce((u,p)=>Math.max(u,...p.rules.map(f=>f.priority||0)),1);l.forEach(u=>{u.rules.forEach(p=>{p.priority||(p.priority=i++),p.style&&(p.dxfId=c.styles.addDxfStyle(p.style))})})}render(l,c){c.forEach(i=>{this.cfXform.render(l,i)})}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"conditionalFormatting":return this.parser=this.cfXform,this.parser.parseOpen(l),!0;default:return!1}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){return!!this.parser&&(!!this.parser.parseClose(l)||(this.model.push(this.parser.model),this.parser=void 0,!1))}reconcile(l,c){l.forEach(i=>{i.rules.forEach(u=>{u.dxfId!==void 0&&(u.style=c.styles.getDxfStyle(u.dxfId),delete u.dxfId)})})}}},{"../../base-xform":32,"./conditional-formatting-xform":86}],88:[function(e,n,a){const o=e("../../composite-xform"),s=e("../../style/color-xform"),l=e("./cfvo-xform");n.exports=class extends o{constructor(){super(),this.map={cfvo:this.cfvoXform=new l,color:this.colorXform=new s}}get tag(){return"dataBar"}render(c,i){c.openNode(this.tag),i.cfvo.forEach(u=>{this.cfvoXform.render(c,u)}),this.colorXform.render(c,i.color),c.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(c,i){switch(c){case"cfvo":this.model.cfvo.push(i.model);break;case"color":this.model.color=i.model}}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],89:[function(e,n,a){const o=e("../../base-xform"),s=e("../../composite-xform");class l extends o{get tag(){return"x14:id"}render(u,p){u.leafNode(this.tag,null,p)}parseOpen(){this.model=""}parseText(u){this.model+=u}parseClose(u){return u!==this.tag}}class c extends s{constructor(){super(),this.map={"x14:id":this.idXform=new l}}get tag(){return"ext"}render(u,p){u.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(u,p.x14Id),u.closeNode()}createNewModel(){return{}}onParserClose(u,p){this.model.x14Id=p.model}}n.exports=class extends s{constructor(){super(),this.map={ext:new c}}get tag(){return"extLst"}render(i,u){i.openNode(this.tag),this.map.ext.render(i,u),i.closeNode()}createNewModel(){return{}}onParserClose(i,u){Object.assign(this.model,u.model)}}},{"../../base-xform":32,"../../composite-xform":48}],90:[function(e,n,a){const o=e("../../base-xform");n.exports=class extends o{get tag(){return"formula"}render(s,l){s.leafNode(this.tag,null,l)}parseOpen(){this.model=""}parseText(s){this.model+=s}parseClose(s){return s!==this.tag}}},{"../../base-xform":32}],91:[function(e,n,a){const o=e("../../base-xform"),s=e("../../composite-xform"),l=e("./cfvo-xform");n.exports=class extends s{constructor(){super(),this.map={cfvo:this.cfvoXform=new l}}get tag(){return"iconSet"}render(c,i){c.openNode(this.tag,{iconSet:o.toStringAttribute(i.iconSet,"3TrafficLights"),reverse:o.toBoolAttribute(i.reverse,!1),showValue:o.toBoolAttribute(i.showValue,!0)}),i.cfvo.forEach(u=>{this.cfvoXform.render(c,u)}),c.closeNode()}createNewModel(c){let{attributes:i}=c;return{iconSet:o.toStringValue(i.iconSet,"3TrafficLights"),reverse:o.toBoolValue(i.reverse),showValue:o.toBoolValue(i.showValue),cfvo:[]}}onParserClose(c,i){this.model[c].push(i.model)}}},{"../../base-xform":32,"../../composite-xform":48,"./cfvo-xform":84}],92:[function(e,n,a){const o=e("../../../utils/utils"),s=e("../base-xform");n.exports=class extends s{get tag(){return"col"}prepare(l,c){const i=c.styles.addStyleModel(l.style||{});i&&(l.styleId=i)}render(l,c){l.openNode("col"),l.addAttribute("min",c.min),l.addAttribute("max",c.max),c.width&&l.addAttribute("width",c.width),c.styleId&&l.addAttribute("style",c.styleId),c.hidden&&l.addAttribute("hidden","1"),c.bestFit&&l.addAttribute("bestFit","1"),c.outlineLevel&&l.addAttribute("outlineLevel",c.outlineLevel),c.collapsed&&l.addAttribute("collapsed","1"),l.addAttribute("customWidth","1"),l.closeNode()}parseOpen(l){if(l.name==="col"){const c=this.model={min:parseInt(l.attributes.min||"0",10),max:parseInt(l.attributes.max||"0",10),width:l.attributes.width===void 0?void 0:parseFloat(l.attributes.width||"0")};return l.attributes.style&&(c.styleId=parseInt(l.attributes.style,10)),o.parseBoolean(l.attributes.hidden)&&(c.hidden=!0),o.parseBoolean(l.attributes.bestFit)&&(c.bestFit=!0),l.attributes.outlineLevel&&(c.outlineLevel=parseInt(l.attributes.outlineLevel,10)),o.parseBoolean(l.attributes.collapsed)&&(c.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(l,c){l.styleId&&(l.style=c.styles.getStyleModel(l.styleId))}}},{"../../../utils/utils":27,"../base-xform":32}],93:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../../../utils/utils"),l=e("../../../utils/col-cache"),c=e("../base-xform"),i=e("../../../doc/range");function u(f,h,v,b){const g=h[v];g!==void 0?f[v]=g:b!==void 0&&(f[v]=b)}function p(f,h,v,b){const g=h[v];g!==void 0&&(f[v]=s.parseBoolean(g))}n.exports=class extends c{get tag(){return"dataValidations"}render(f,h){const v=function(b){const g=o.map(b,(k,N)=>({address:N,dataValidation:k,marked:!1})).sort((k,N)=>o.strcmp(k.address,N.address)),x=o.keyBy(g,"address"),y=(k,N,F)=>{for(let B=0;B<N;B++){const W=l.encodeAddress(k.row+B,F);if(!b[W]||!o.isEqual(b[k.address],b[W]))return!1}return!0};return g.map(k=>{if(!k.marked){const N=l.decodeEx(k.address);if(N.dimensions)return x[N.dimensions].marked=!0,{...k.dataValidation,sqref:k.address};let F=1,B=l.encodeAddress(N.row+F,N.col);for(;b[B]&&o.isEqual(k.dataValidation,b[B]);)F++,B=l.encodeAddress(N.row+F,N.col);let W=1;for(;y(N,F,N.col+W);)W++;for(let V=0;V<F;V++)for(let q=0;q<W;q++)B=l.encodeAddress(N.row+V,N.col+q),x[B].marked=!0;if(F>1||W>1){const V=N.row+(F-1),q=N.col+(W-1);return{...k.dataValidation,sqref:`${k.address}:${l.encodeAddress(V,q)}`}}return{...k.dataValidation,sqref:k.address}}return null}).filter(Boolean)}(h);v.length&&(f.openNode("dataValidations",{count:v.length}),v.forEach(b=>{f.openNode("dataValidation"),b.type!=="any"&&(f.addAttribute("type",b.type),b.operator&&b.type!=="list"&&b.operator!=="between"&&f.addAttribute("operator",b.operator),b.allowBlank&&f.addAttribute("allowBlank","1")),b.showInputMessage&&f.addAttribute("showInputMessage","1"),b.promptTitle&&f.addAttribute("promptTitle",b.promptTitle),b.prompt&&f.addAttribute("prompt",b.prompt),b.showErrorMessage&&f.addAttribute("showErrorMessage","1"),b.errorStyle&&f.addAttribute("errorStyle",b.errorStyle),b.errorTitle&&f.addAttribute("errorTitle",b.errorTitle),b.error&&f.addAttribute("error",b.error),f.addAttribute("sqref",b.sqref),(b.formulae||[]).forEach((g,x)=>{f.openNode("formula"+(x+1)),b.type==="date"?f.writeText(s.dateToExcel(new Date(g))):f.writeText(g),f.closeNode()}),f.closeNode()}),f.closeNode())}parseOpen(f){switch(f.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=f.attributes.sqref;const h={type:f.attributes.type||"any",formulae:[]};switch(f.attributes.type&&p(h,f.attributes,"allowBlank"),p(h,f.attributes,"showInputMessage"),p(h,f.attributes,"showErrorMessage"),h.type){case"any":case"list":case"custom":break;default:u(h,f.attributes,"operator","between")}return u(h,f.attributes,"promptTitle"),u(h,f.attributes,"prompt"),u(h,f.attributes,"errorStyle"),u(h,f.attributes,"errorTitle"),u(h,f.attributes,"error"),this._dataValidation=h,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(f){this._formula&&this._formula.push(f)}parseClose(f){switch(f){case"dataValidations":return!1;case"dataValidation":return this._dataValidation.formulae&&this._dataValidation.formulae.length||(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(h=>{h.includes(":")?new i(h).forEachAddress(v=>{this.model[v]=this._dataValidation}):this.model[h]=this._dataValidation}),!0;case"formula1":case"formula2":{let h=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":h=parseInt(h,10);break;case"decimal":h=parseFloat(h);break;case"date":h=s.excelToDate(parseFloat(h))}return this._dataValidation.formulae.push(h),this._formula=void 0,!0}default:return!0}}}},{"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/utils":27,"../base-xform":32}],94:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"dimension"}render(s,l){l&&s.leafNode("dimension",{ref:l})}parseOpen(s){return s.name==="dimension"&&(this.model=s.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],95:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"drawing"}render(s,l){l&&s.leafNode(this.tag,{"r:id":l.rId})}parseOpen(s){switch(s.name){case this.tag:return this.model={rId:s.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],96:[function(e,n,a){const o=e("../composite-xform"),s=e("./cf-ext/conditional-formattings-ext-xform");class l extends o{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new s}}get tag(){return"ext"}hasContent(i){return this.conditionalFormattings.hasContent(i.conditionalFormattings)}prepare(i,u){this.conditionalFormattings.prepare(i.conditionalFormattings,u)}render(i,u){i.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(i,u.conditionalFormattings),i.closeNode()}createNewModel(){return{}}onParserClose(i,u){this.model[i]=u.model}}n.exports=class extends o{constructor(){super(),this.map={ext:this.ext=new l}}get tag(){return"extLst"}prepare(c,i){this.ext.prepare(c,i)}hasContent(c){return this.ext.hasContent(c)}render(c,i){this.hasContent(i)&&(c.openNode("extLst"),this.ext.render(c,i),c.closeNode())}createNewModel(){return{}}onParserClose(c,i){Object.assign(this.model,i.model)}}},{"../composite-xform":48,"./cf-ext/conditional-formattings-ext-xform":78}],97:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"headerFooter"}render(s,l){if(l){s.addRollback();let c=!1;s.openNode("headerFooter"),l.differentFirst&&(s.addAttribute("differentFirst","1"),c=!0),l.differentOddEven&&(s.addAttribute("differentOddEven","1"),c=!0),l.oddHeader&&typeof l.oddHeader=="string"&&(s.leafNode("oddHeader",null,l.oddHeader),c=!0),l.oddFooter&&typeof l.oddFooter=="string"&&(s.leafNode("oddFooter",null,l.oddFooter),c=!0),l.evenHeader&&typeof l.evenHeader=="string"&&(s.leafNode("evenHeader",null,l.evenHeader),c=!0),l.evenFooter&&typeof l.evenFooter=="string"&&(s.leafNode("evenFooter",null,l.evenFooter),c=!0),l.firstHeader&&typeof l.firstHeader=="string"&&(s.leafNode("firstHeader",null,l.firstHeader),c=!0),l.firstFooter&&typeof l.firstFooter=="string"&&(s.leafNode("firstFooter",null,l.firstFooter),c=!0),c?(s.closeNode(),s.commit()):s.rollback()}}parseOpen(s){switch(s.name){case"headerFooter":return this.model={},s.attributes.differentFirst&&(this.model.differentFirst=parseInt(s.attributes.differentFirst,0)===1),s.attributes.differentOddEven&&(this.model.differentOddEven=parseInt(s.attributes.differentOddEven,0)===1),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(s){switch(this.currentNode){case"oddHeader":this.model.oddHeader=s;break;case"oddFooter":this.model.oddFooter=s;break;case"evenHeader":this.model.evenHeader=s;break;case"evenFooter":this.model.evenFooter=s;break;case"firstHeader":this.model.firstHeader=s;break;case"firstFooter":this.model.firstFooter=s}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}}},{"../base-xform":32}],98:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"hyperlink"}render(s,l){this.isInternalLink(l)?s.leafNode("hyperlink",{ref:l.address,"r:id":l.rId,tooltip:l.tooltip,location:l.target}):s.leafNode("hyperlink",{ref:l.address,"r:id":l.rId,tooltip:l.tooltip})}parseOpen(s){return s.name==="hyperlink"&&(this.model={address:s.attributes.ref,rId:s.attributes["r:id"],tooltip:s.attributes.tooltip},s.attributes.location&&(this.model.target=s.attributes.location),!0)}parseText(){}parseClose(){return!1}isInternalLink(s){return s.target&&/^[^!]+![a-zA-Z]+[\d]+$/.test(s.target)}}},{"../base-xform":32}],99:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"mergeCell"}render(s,l){s.leafNode("mergeCell",{ref:l})}parseOpen(s){return s.name==="mergeCell"&&(this.model=s.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],100:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../../../doc/range"),l=e("../../../utils/col-cache"),c=e("../../../doc/enums");n.exports=class{constructor(){this.merges={}}add(i){if(this.merges[i.master])this.merges[i.master].expandToAddress(i.address);else{const u=`${i.master}:${i.address}`;this.merges[i.master]=new s(u)}}get mergeCells(){return o.map(this.merges,i=>i.range)}reconcile(i,u){o.each(i,p=>{const f=l.decode(p);for(let h=f.top;h<=f.bottom;h++){const v=u[h-1];for(let b=f.left;b<=f.right;b++){const g=v.cells[b-1];g?g.type===c.ValueType.Merge&&(g.master=f.tl):v.cells[b]={type:c.ValueType.Null,address:l.encodeAddress(h,b)}}}})}getMasterAddress(i){const u=this.hash[i];return u&&u.tl}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26}],101:[function(e,n,a){const o=e("../base-xform"),s=l=>l!==void 0;n.exports=class extends o{get tag(){return"outlinePr"}render(l,c){return!(!c||!s(c.summaryBelow)&&!s(c.summaryRight))&&(l.leafNode(this.tag,{summaryBelow:s(c.summaryBelow)?Number(c.summaryBelow):void 0,summaryRight:s(c.summaryRight)?Number(c.summaryRight):void 0}),!0)}parseOpen(l){return l.name===this.tag&&(this.model={summaryBelow:s(l.attributes.summaryBelow)?!!Number(l.attributes.summaryBelow):void 0,summaryRight:s(l.attributes.summaryRight)?!!Number(l.attributes.summaryRight):void 0},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],102:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"brk"}render(s,l){s.leafNode("brk",l)}parseOpen(s){return s.name==="brk"&&(this.model=s.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],103:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../base-xform");n.exports=class extends s{get tag(){return"pageMargins"}render(l,c){if(c){const i={left:c.left,right:c.right,top:c.top,bottom:c.bottom,header:c.header,footer:c.footer};o.some(i,u=>u!==void 0)&&l.leafNode(this.tag,i)}}parseOpen(l){switch(l.name){case this.tag:return this.model={left:parseFloat(l.attributes.left||.7),right:parseFloat(l.attributes.right||.7),top:parseFloat(l.attributes.top||.75),bottom:parseFloat(l.attributes.bottom||.75),header:parseFloat(l.attributes.header||.3),footer:parseFloat(l.attributes.footer||.3)},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],104:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"pageSetUpPr"}render(s,l){return!(!l||!l.fitToPage)&&(s.leafNode(this.tag,{fitToPage:l.fitToPage?"1":void 0}),!0)}parseOpen(s){return s.name===this.tag&&(this.model={fitToPage:s.attributes.fitToPage==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],105:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../base-xform");function l(p){return p?"1":void 0}function c(p){switch(p){case"overThenDown":return p;default:return}}function i(p){switch(p){case"atEnd":case"asDisplyed":return p;default:return}}function u(p){switch(p){case"dash":case"blank":case"NA":return p;default:return}}n.exports=class extends s{get tag(){return"pageSetup"}render(p,f){if(f){const h={paperSize:f.paperSize,orientation:f.orientation,horizontalDpi:f.horizontalDpi,verticalDpi:f.verticalDpi,pageOrder:c(f.pageOrder),blackAndWhite:l(f.blackAndWhite),draft:l(f.draft),cellComments:i(f.cellComments),errors:u(f.errors),scale:f.scale,fitToWidth:f.fitToWidth,fitToHeight:f.fitToHeight,firstPageNumber:f.firstPageNumber,useFirstPageNumber:l(f.firstPageNumber),usePrinterDefaults:l(f.usePrinterDefaults),copies:f.copies};o.some(h,v=>v!==void 0)&&p.leafNode(this.tag,h)}}parseOpen(p){switch(p.name){case this.tag:return this.model={paperSize:(f=p.attributes.paperSize,f!==void 0?parseInt(f,10):void 0),orientation:p.attributes.orientation||"portrait",horizontalDpi:parseInt(p.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(p.attributes.verticalDpi||"4294967295",10),pageOrder:p.attributes.pageOrder||"downThenOver",blackAndWhite:p.attributes.blackAndWhite==="1",draft:p.attributes.draft==="1",cellComments:p.attributes.cellComments||"None",errors:p.attributes.errors||"displayed",scale:parseInt(p.attributes.scale||"100",10),fitToWidth:parseInt(p.attributes.fitToWidth||"1",10),fitToHeight:parseInt(p.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(p.attributes.firstPageNumber||"1",10),useFirstPageNumber:p.attributes.useFirstPageNumber==="1",usePrinterDefaults:p.attributes.usePrinterDefaults==="1",copies:parseInt(p.attributes.copies||"1",10)},!0;default:return!1}var f}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],106:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"picture"}render(s,l){l&&s.leafNode(this.tag,{"r:id":l.rId})}parseOpen(s){switch(s.name){case this.tag:return this.model={rId:s.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],107:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../base-xform");function l(c){return c?"1":void 0}n.exports=class extends s{get tag(){return"printOptions"}render(c,i){if(i){const u={headings:l(i.showRowColHeaders),gridLines:l(i.showGridLines),horizontalCentered:l(i.horizontalCentered),verticalCentered:l(i.verticalCentered)};o.some(u,p=>p!==void 0)&&c.leafNode(this.tag,u)}}parseOpen(c){switch(c.name){case this.tag:return this.model={showRowColHeaders:c.attributes.headings==="1",showGridLines:c.attributes.gridLines==="1",horizontalCentered:c.attributes.horizontalCentered==="1",verticalCentered:c.attributes.verticalCentered==="1"},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],108:[function(e,n,a){const o=e("./page-breaks-xform"),s=e("../list-xform");n.exports=class extends s{constructor(){super({tag:"rowBreaks",count:!0,childXform:new o})}render(l,c){if(c&&c.length){l.openNode(this.tag,this.$),this.count&&(l.addAttribute(this.$count,c.length),l.addAttribute("manualBreakCount",c.length));const{childXform:i}=this;c.forEach(u=>{i.render(l,u)}),l.closeNode()}else this.empty&&l.leafNode(this.tag)}}},{"../list-xform":71,"./page-breaks-xform":102}],109:[function(e,n,a){const o=e("../base-xform"),s=e("../../../utils/utils"),l=e("./cell-xform");n.exports=class extends o{constructor(c){super(),this.maxItems=c&&c.maxItems,this.map={c:new l}}get tag(){return"row"}prepare(c,i){const u=i.styles.addStyleModel(c.style);u&&(c.styleId=u);const p=this.map.c;c.cells.forEach(f=>{p.prepare(f,i)})}render(c,i,u){c.openNode("row"),c.addAttribute("r",i.number),i.height&&(c.addAttribute("ht",i.height),c.addAttribute("customHeight","1")),i.hidden&&c.addAttribute("hidden","1"),i.min>0&&i.max>0&&i.min<=i.max&&c.addAttribute("spans",`${i.min}:${i.max}`),i.styleId&&(c.addAttribute("s",i.styleId),c.addAttribute("customFormat","1")),c.addAttribute("x14ac:dyDescent","0.25"),i.outlineLevel&&c.addAttribute("outlineLevel",i.outlineLevel),i.collapsed&&c.addAttribute("collapsed","1");const p=this.map.c;i.cells.forEach(f=>{p.render(c,f,u)}),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;if(c.name==="row"){this.numRowsSeen+=1;const i=c.attributes.spans?c.attributes.spans.split(":").map(p=>parseInt(p,10)):[void 0,void 0],u=this.model={number:parseInt(c.attributes.r,10),min:i[0],max:i[1],cells:[]};return c.attributes.s&&(u.styleId=parseInt(c.attributes.s,10)),s.parseBoolean(c.attributes.hidden)&&(u.hidden=!0),s.parseBoolean(c.attributes.bestFit)&&(u.bestFit=!0),c.attributes.ht&&(u.height=parseFloat(c.attributes.ht)),c.attributes.outlineLevel&&(u.outlineLevel=parseInt(c.attributes.outlineLevel,10)),s.parseBoolean(c.attributes.collapsed)&&(u.collapsed=!0),!0}return this.parser=this.map[c.name],!!this.parser&&(this.parser.parseOpen(c),!0)}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser){if(!this.parser.parseClose(c)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw new Error(`Max column count (${this.maxItems}) exceeded`);this.parser=void 0}return!0}return!1}reconcile(c,i){c.style=c.styleId?i.styles.getStyleModel(c.styleId):{},c.styleId!==void 0&&(c.styleId=void 0);const u=this.map.c;c.cells.forEach(p=>{u.reconcile(p,i)})}}},{"../../../utils/utils":27,"../base-xform":32,"./cell-xform":73}],110:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../base-xform");n.exports=class extends s{get tag(){return"sheetFormatPr"}render(l,c){if(c){const i={defaultRowHeight:c.defaultRowHeight,outlineLevelRow:c.outlineLevelRow,outlineLevelCol:c.outlineLevelCol,"x14ac:dyDescent":c.dyDescent};c.defaultColWidth&&(i.defaultColWidth=c.defaultColWidth),c.defaultRowHeight&&c.defaultRowHeight===15||(i.customHeight="1"),o.some(i,u=>u!==void 0)&&l.leafNode("sheetFormatPr",i)}}parseOpen(l){return l.name==="sheetFormatPr"&&(this.model={defaultRowHeight:parseFloat(l.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(l.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(l.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(l.attributes.outlineLevelCol||"0",10)},l.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(l.attributes.defaultColWidth)),!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],111:[function(e,n,a){const o=e("../base-xform"),s=e("../style/color-xform"),l=e("./page-setup-properties-xform"),c=e("./outline-properties-xform");n.exports=class extends o{constructor(){super(),this.map={tabColor:new s("tabColor"),pageSetUpPr:new l,outlinePr:new c}}get tag(){return"sheetPr"}render(i,u){if(u){i.addRollback(),i.openNode("sheetPr");let p=!1;p=this.map.tabColor.render(i,u.tabColor)||p,p=this.map.pageSetUpPr.render(i,u.pageSetup)||p,p=this.map.outlinePr.render(i,u.outlineProperties)||p,p?(i.closeNode(),i.commit()):i.rollback()}}parseOpen(i){return this.parser?(this.parser.parseOpen(i),!0):i.name===this.tag?(this.reset(),!0):!!this.map[i.name]&&(this.parser=this.map[i.name],this.parser.parseOpen(i),!0)}parseText(i){return!!this.parser&&(this.parser.parseText(i),!0)}parseClose(i){return this.parser?(this.parser.parseClose(i)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}}},{"../base-xform":32,"../style/color-xform":128,"./outline-properties-xform":101,"./page-setup-properties-xform":104}],112:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../base-xform");function l(i,u){return i?u:void 0}function c(i,u){return i===u||void 0}n.exports=class extends s{get tag(){return"sheetProtection"}render(i,u){if(u){const p={sheet:l(u.sheet,"1"),selectLockedCells:u.selectLockedCells===!1?"1":void 0,selectUnlockedCells:u.selectUnlockedCells===!1?"1":void 0,formatCells:l(u.formatCells,"0"),formatColumns:l(u.formatColumns,"0"),formatRows:l(u.formatRows,"0"),insertColumns:l(u.insertColumns,"0"),insertRows:l(u.insertRows,"0"),insertHyperlinks:l(u.insertHyperlinks,"0"),deleteColumns:l(u.deleteColumns,"0"),deleteRows:l(u.deleteRows,"0"),sort:l(u.sort,"0"),autoFilter:l(u.autoFilter,"0"),pivotTables:l(u.pivotTables,"0")};u.sheet&&(p.algorithmName=u.algorithmName,p.hashValue=u.hashValue,p.saltValue=u.saltValue,p.spinCount=u.spinCount,p.objects=l(u.objects===!1,"1"),p.scenarios=l(u.scenarios===!1,"1")),o.some(p,f=>f!==void 0)&&i.leafNode(this.tag,p)}}parseOpen(i){switch(i.name){case this.tag:return this.model={sheet:c(i.attributes.sheet,"1"),objects:i.attributes.objects!=="1"&&void 0,scenarios:i.attributes.scenarios!=="1"&&void 0,selectLockedCells:i.attributes.selectLockedCells!=="1"&&void 0,selectUnlockedCells:i.attributes.selectUnlockedCells!=="1"&&void 0,formatCells:c(i.attributes.formatCells,"0"),formatColumns:c(i.attributes.formatColumns,"0"),formatRows:c(i.attributes.formatRows,"0"),insertColumns:c(i.attributes.insertColumns,"0"),insertRows:c(i.attributes.insertRows,"0"),insertHyperlinks:c(i.attributes.insertHyperlinks,"0"),deleteColumns:c(i.attributes.deleteColumns,"0"),deleteRows:c(i.attributes.deleteRows,"0"),sort:c(i.attributes.sort,"0"),autoFilter:c(i.attributes.autoFilter,"0"),pivotTables:c(i.attributes.pivotTables,"0")},i.attributes.algorithmName&&(this.model.algorithmName=i.attributes.algorithmName,this.model.hashValue=i.attributes.hashValue,this.model.saltValue=i.attributes.saltValue,this.model.spinCount=parseInt(i.attributes.spinCount,10)),!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],113:[function(e,n,a){const o=e("../../../utils/col-cache"),s=e("../base-xform"),l={frozen:"frozen",frozenSplit:"frozen",split:"split"};n.exports=class extends s{get tag(){return"sheetView"}prepare(c){switch(c.state){case"frozen":case"split":break;default:c.state="normal"}}render(c,i){c.openNode("sheetView",{workbookViewId:i.workbookViewId||0});const u=function(b,g,x){x&&c.addAttribute(b,g)};let p,f,h,v;switch(u("rightToLeft","1",i.rightToLeft===!0),u("tabSelected","1",i.tabSelected),u("showRuler","0",i.showRuler===!1),u("showRowColHeaders","0",i.showRowColHeaders===!1),u("showGridLines","0",i.showGridLines===!1),u("zoomScale",i.zoomScale,i.zoomScale),u("zoomScaleNormal",i.zoomScaleNormal,i.zoomScaleNormal),u("view",i.style,i.style),i.state){case"frozen":f=i.xSplit||0,h=i.ySplit||0,p=i.topLeftCell||o.getAddress(h+1,f+1).address,v=(i.xSplit&&i.ySplit?"bottomRight":i.xSplit&&"topRight")||"bottomLeft",c.leafNode("pane",{xSplit:i.xSplit||void 0,ySplit:i.ySplit||void 0,topLeftCell:p,activePane:v,state:"frozen"}),c.leafNode("selection",{pane:v,activeCell:i.activeCell,sqref:i.activeCell});break;case"split":i.activePane==="topLeft"&&(i.activePane=void 0),c.leafNode("pane",{xSplit:i.xSplit||void 0,ySplit:i.ySplit||void 0,topLeftCell:i.topLeftCell,activePane:i.activePane}),c.leafNode("selection",{pane:i.activePane,activeCell:i.activeCell,sqref:i.activeCell});break;case"normal":i.activeCell&&c.leafNode("selection",{activeCell:i.activeCell,sqref:i.activeCell})}c.closeNode()}parseOpen(c){switch(c.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(c.attributes.workbookViewId,10),rightToLeft:c.attributes.rightToLeft==="1",tabSelected:c.attributes.tabSelected==="1",showRuler:c.attributes.showRuler!=="0",showRowColHeaders:c.attributes.showRowColHeaders!=="0",showGridLines:c.attributes.showGridLines!=="0",zoomScale:parseInt(c.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(c.attributes.zoomScaleNormal||"100",10),style:c.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(c.attributes.xSplit||"0",10),ySplit:parseInt(c.attributes.ySplit||"0",10),topLeftCell:c.attributes.topLeftCell,activePane:c.attributes.activePane||"topLeft",state:c.attributes.state},!0;case"selection":{const i=c.attributes.pane||"topLeft";return this.selections[i]={pane:i,activeCell:c.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(c){let i,u;switch(c){case"sheetView":return this.sheetView&&this.pane?(i=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:l[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},this.model.state==="split"&&(i.activePane=this.pane.activePane),u=this.selections[this.pane.activePane],u&&u.activeCell&&(i.activeCell=u.activeCell),this.sheetView.style&&(i.style=this.sheetView.style)):(i=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},u=this.selections.topLeft,u&&u.activeCell&&(i.activeCell=u.activeCell),this.sheetView.style&&(i.style=this.sheetView.style)),!1;default:return!0}}reconcile(){}}},{"../../../utils/col-cache":19,"../base-xform":32}],114:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"tablePart"}render(s,l){l&&s.leafNode(this.tag,{"r:id":l.rId})}parseOpen(s){switch(s.name){case this.tag:return this.model={rId:s.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],115:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../../../utils/col-cache"),l=e("../../../utils/xml-stream"),c=e("../../rel-type"),i=e("./merges"),u=e("../base-xform"),p=e("../list-xform"),f=e("./row-xform"),h=e("./col-xform"),v=e("./dimension-xform"),b=e("./hyperlink-xform"),g=e("./merge-cell-xform"),x=e("./data-validations-xform"),y=e("./sheet-properties-xform"),k=e("./sheet-format-properties-xform"),N=e("./sheet-view-xform"),F=e("./sheet-protection-xform"),B=e("./page-margins-xform"),W=e("./page-setup-xform"),V=e("./print-options-xform"),q=e("./auto-filter-xform"),X=e("./picture-xform"),I=e("./drawing-xform"),H=e("./table-part-xform"),O=e("./row-breaks-xform"),R=e("./header-footer-xform"),C=e("./cf/conditional-formattings-xform"),w=e("./ext-lst-xform"),E=(T,D)=>{if(!D||!D.length)return T;if(!T||!T.length)return D;const U={},P={};return T.forEach(K=>{U[K.ref]=K,K.rules.forEach(Y=>{const{x14Id:re}=Y;re&&(P[re]=Y)})}),D.forEach(K=>{K.rules.forEach(Y=>{const re=P[Y.x14Id];re?((z,ee)=>{Object.keys(ee).forEach(L=>{const M=z[L],Z=ee[L];M===void 0&&Z!==void 0&&(z[L]=Z)})})(re,Y):U[K.ref]?U[K.ref].rules.push(Y):T.push({ref:K.ref,rules:[Y]})})}),T};class A extends u{constructor(D){super();const{maxRows:U,maxCols:P,ignoreNodes:K}=D||{};this.ignoreNodes=K||[],this.map={sheetPr:new y,dimension:new v,sheetViews:new p({tag:"sheetViews",count:!1,childXform:new N}),sheetFormatPr:new k,cols:new p({tag:"cols",count:!1,childXform:new h}),sheetData:new p({tag:"sheetData",count:!1,empty:!0,childXform:new f({maxItems:P}),maxItems:U}),autoFilter:new q,mergeCells:new p({tag:"mergeCells",count:!0,childXform:new g}),rowBreaks:new O,hyperlinks:new p({tag:"hyperlinks",count:!1,childXform:new b}),pageMargins:new B,dataValidations:new x,pageSetup:new W,headerFooter:new R,printOptions:new V,picture:new X,drawing:new I,sheetProtection:new F,tableParts:new p({tag:"tableParts",count:!0,childXform:new H}),conditionalFormatting:new C,extLst:new w}}prepare(D,U){U.merges=new i,D.hyperlinks=U.hyperlinks=[],D.comments=U.comments=[],U.formulae={},U.siFormulae=0,this.map.cols.prepare(D.cols,U),this.map.sheetData.prepare(D.rows,U),this.map.conditionalFormatting.prepare(D.conditionalFormattings,U),D.mergeCells=U.merges.mergeCells;const P=D.rels=[];function K(z){return"rId"+(z.length+1)}if(D.hyperlinks.forEach(z=>{const ee=K(P);z.rId=ee,P.push({Id:ee,Type:c.Hyperlink,Target:z.target,TargetMode:"External"})}),D.comments.length>0){const z={Id:K(P),Type:c.Comments,Target:`../comments${D.id}.xml`};P.push(z);const ee={Id:K(P),Type:c.VmlDrawing,Target:`../drawings/vmlDrawing${D.id}.vml`};P.push(ee),D.comments.forEach(L=>{L.refAddress=s.decodeAddress(L.ref)}),U.commentRefs.push({commentName:"comments"+D.id,vmlDrawing:"vmlDrawing"+D.id})}const Y=[];let re;D.media.forEach(z=>{if(z.type==="background"){const ee=K(P);re=U.media[z.imageId],P.push({Id:ee,Type:c.Image,Target:`../media/${re.name}.${re.extension}`}),D.background={rId:ee},D.image=U.media[z.imageId]}else if(z.type==="image"){let{drawing:ee}=D;re=U.media[z.imageId],ee||(ee=D.drawing={rId:K(P),name:"drawing"+ ++U.drawingsCount,anchors:[],rels:[]},U.drawings.push(ee),P.push({Id:ee.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/${ee.name}.xml`}));let L=this.preImageId===z.imageId?Y[z.imageId]:Y[ee.rels.length];L||(L=K(ee.rels),Y[ee.rels.length]=L,ee.rels.push({Id:L,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/${re.name}.${re.extension}`}));const M={picture:{rId:L},range:z.range};if(z.hyperlinks&&z.hyperlinks.hyperlink){const Z=K(ee.rels);Y[ee.rels.length]=Z,M.picture.hyperlinks={tooltip:z.hyperlinks.tooltip,rId:Z},ee.rels.push({Id:Z,Type:c.Hyperlink,Target:z.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=z.imageId,ee.anchors.push(M)}}),D.tables.forEach(z=>{const ee=K(P);z.rId=ee,P.push({Id:ee,Type:c.Table,Target:"../tables/"+z.target}),z.columns.forEach(L=>{const{style:M}=L;M&&(L.dxfId=U.styles.addDxfStyle(M))})}),this.map.extLst.prepare(D,U)}render(D,U){D.openXml(l.StdDocAttributes),D.openNode("worksheet",A.WORKSHEET_ATTRIBUTES);const P=U.properties?{defaultRowHeight:U.properties.defaultRowHeight,dyDescent:U.properties.dyDescent,outlineLevelCol:U.properties.outlineLevelCol,outlineLevelRow:U.properties.outlineLevelRow}:void 0;U.properties&&U.properties.defaultColWidth&&(P.defaultColWidth=U.properties.defaultColWidth);const K={outlineProperties:U.properties&&U.properties.outlineProperties,tabColor:U.properties&&U.properties.tabColor,pageSetup:U.pageSetup&&U.pageSetup.fitToPage?{fitToPage:U.pageSetup.fitToPage}:void 0},Y=U.pageSetup&&U.pageSetup.margins,re={showRowColHeaders:U.pageSetup&&U.pageSetup.showRowColHeaders,showGridLines:U.pageSetup&&U.pageSetup.showGridLines,horizontalCentered:U.pageSetup&&U.pageSetup.horizontalCentered,verticalCentered:U.pageSetup&&U.pageSetup.verticalCentered},z=U.sheetProtection;this.map.sheetPr.render(D,K),this.map.dimension.render(D,U.dimensions),this.map.sheetViews.render(D,U.views),this.map.sheetFormatPr.render(D,P),this.map.cols.render(D,U.cols),this.map.sheetData.render(D,U.rows),this.map.sheetProtection.render(D,z),this.map.autoFilter.render(D,U.autoFilter),this.map.mergeCells.render(D,U.mergeCells),this.map.conditionalFormatting.render(D,U.conditionalFormattings),this.map.dataValidations.render(D,U.dataValidations),this.map.hyperlinks.render(D,U.hyperlinks),this.map.printOptions.render(D,re),this.map.pageMargins.render(D,Y),this.map.pageSetup.render(D,U.pageSetup),this.map.headerFooter.render(D,U.headerFooter),this.map.rowBreaks.render(D,U.rowBreaks),this.map.drawing.render(D,U.drawing),this.map.picture.render(D,U.background),this.map.tableParts.render(D,U.tables),this.map.extLst.render(D,U),U.rels&&U.rels.forEach(ee=>{ee.Type===c.VmlDrawing&&D.leafNode("legacyDrawing",{"r:id":ee.Id})}),D.closeNode()}parseOpen(D){return this.parser?(this.parser.parseOpen(D),!0):D.name==="worksheet"?(o.each(this.map,U=>{U.reset()}),!0):(this.map[D.name]&&!this.ignoreNodes.includes(D.name)&&(this.parser=this.map[D.name],this.parser.parseOpen(D)),!0)}parseText(D){this.parser&&this.parser.parseText(D)}parseClose(D){if(this.parser)return this.parser.parseClose(D)||(this.parser=void 0),!0;switch(D){case"worksheet":{const U=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(U.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(U.outlineProperties=this.map.sheetPr.model.outlineProperties);const P={fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},K=Object.assign(P,this.map.pageSetup.model,this.map.printOptions.model),Y=E(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:U,views:this.map.sheetViews.model,pageSetup:K,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:Y},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}default:return!0}}reconcile(D,U){const P=(D.relationships||[]).reduce((Y,re)=>{if(Y[re.Id]=re,re.Type===c.Comments&&(D.comments=U.comments[re.Target].comments),re.Type===c.VmlDrawing&&D.comments&&D.comments.length){const z=U.vmlDrawings[re.Target].comments;D.comments.forEach((ee,L)=>{ee.note=Object.assign({},ee.note,z[L])})}return Y},{});if(U.commentsMap=(D.comments||[]).reduce((Y,re)=>(re.ref&&(Y[re.ref]=re),Y),{}),U.hyperlinkMap=(D.hyperlinks||[]).reduce((Y,re)=>(re.rId&&(Y[re.address]=P[re.rId].Target),Y),{}),U.formulae={},D.rows=D.rows&&D.rows.filter(Boolean)||[],D.rows.forEach(Y=>{Y.cells=Y.cells&&Y.cells.filter(Boolean)||[]}),this.map.cols.reconcile(D.cols,U),this.map.sheetData.reconcile(D.rows,U),this.map.conditionalFormatting.reconcile(D.conditionalFormattings,U),D.media=[],D.drawing){const Y=P[D.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(Y){const re=Y[1];U.drawings[re].anchors.forEach(z=>{if(z.medium){const ee={type:"image",imageId:z.medium.index,range:z.range,hyperlinks:z.picture.hyperlinks};D.media.push(ee)}})}}const K=D.background&&P[D.background.rId];if(K){const Y=K.Target.split("/media/")[1],re=U.mediaIndex&&U.mediaIndex[Y];re!==void 0&&D.media.push({type:"background",imageId:re})}D.tables=(D.tables||[]).map(Y=>{const re=P[Y.rId];return U.tables[re.Target]}),delete D.relationships,delete D.hyperlinks,delete D.comments}}A.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},n.exports=A},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../../rel-type":31,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":72,"./cf/conditional-formattings-xform":87,"./col-xform":92,"./data-validations-xform":93,"./dimension-xform":94,"./drawing-xform":95,"./ext-lst-xform":96,"./header-footer-xform":97,"./hyperlink-xform":98,"./merge-cell-xform":99,"./merges":100,"./page-margins-xform":103,"./page-setup-xform":105,"./picture-xform":106,"./print-options-xform":107,"./row-breaks-xform":108,"./row-xform":109,"./sheet-format-properties-xform":110,"./sheet-properties-xform":111,"./sheet-protection-xform":112,"./sheet-view-xform":113,"./table-part-xform":114}],116:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.attr=s.attr}render(s,l){l&&(s.openNode(this.tag),s.closeNode())}parseOpen(s){s.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],117:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.attr=s.attr,this.attrs=s.attrs,this._format=s.format||function(l){try{return Number.isNaN(l.getTime())?"":l.toISOString()}catch{return""}},this._parse=s.parse||function(l){return new Date(l)}}render(s,l){l&&(s.openNode(this.tag),this.attrs&&s.addAttributes(this.attrs),this.attr?s.addAttribute(this.attr,this._format(l)):s.writeText(this._format(l)),s.closeNode())}parseOpen(s){s.name===this.tag&&(this.attr?this.model=this._parse(s.attributes[this.attr]):this.text=[])}parseText(s){this.attr||this.text.push(s)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}}},{"../base-xform":32}],118:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.attr=s.attr,this.attrs=s.attrs,this.zero=s.zero}render(s,l){(l||this.zero)&&(s.openNode(this.tag),this.attrs&&s.addAttributes(this.attrs),this.attr?s.addAttribute(this.attr,l):s.writeText(l),s.closeNode())}parseOpen(s){return s.name===this.tag&&(this.attr?this.model=parseInt(s.attributes[this.attr],10):this.text=[],!0)}parseText(s){this.attr||this.text.push(s)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}}},{"../base-xform":32}],119:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{constructor(s){super(),this.tag=s.tag,this.attr=s.attr,this.attrs=s.attrs}render(s,l){l!==void 0&&(s.openNode(this.tag),this.attrs&&s.addAttributes(this.attrs),this.attr?s.addAttribute(this.attr,l):s.writeText(l),s.closeNode())}parseOpen(s){s.name===this.tag&&(this.attr?this.model=s.attributes[this.attr]:this.text=[])}parseText(s){this.attr||this.text.push(s)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}}},{"../base-xform":32}],120:[function(e,n,a){const o=e("./base-xform"),s=e("../../utils/xml-stream");n.exports=class extends o{constructor(l){super(),this._model=l}render(l){if(!this._xml){const c=new s;(function i(u,p){u.openNode(p.tag,p.$),p.c&&p.c.forEach(f=>{i(u,f)}),p.t&&u.writeText(p.t),u.closeNode()})(c,this._model),this._xml=c.xml}l.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(l){switch(l){case this._model.tag:return!1;default:return!0}}}},{"../../utils/xml-stream":28,"./base-xform":32}],121:[function(e,n,a){const o=e("./text-xform"),s=e("./rich-text-xform"),l=e("../base-xform");n.exports=class extends l{constructor(){super(),this.map={r:new s,t:new o}}get tag(){return"rPh"}render(c,i){if(c.openNode(this.tag,{sb:i.sb||0,eb:i.eb||0}),i&&i.hasOwnProperty("richText")&&i.richText){const{r:u}=this.map;i.richText.forEach(p=>{u.render(c,p)})}else i&&this.map.t.render(c,i.text);c.closeNode()}parseOpen(c){const{name:i}=c;return this.parser?(this.parser.parseOpen(c),!0):i===this.tag?(this.model={sb:parseInt(c.attributes.sb,10),eb:parseInt(c.attributes.eb,10)},!0):(this.parser=this.map[i],!!this.parser&&(this.parser.parseOpen(c),!0))}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser){if(!this.parser.parseClose(c)){switch(c){case"r":{let i=this.model.richText;i||(i=this.model.richText=[]),i.push(this.parser.model);break}case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}switch(c){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./rich-text-xform":122,"./text-xform":125}],122:[function(e,n,a){const o=e("./text-xform"),s=e("../style/font-xform"),l=e("../base-xform");class c extends l{constructor(u){super(),this.model=u}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new o)}get fontXform(){return this._fontXform||(this._fontXform=new s(c.FONT_OPTIONS))}render(u,p){p=p||this.model,u.openNode("r"),p.font&&this.fontXform.render(u,p.font),this.textXform.render(u,p.text),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(u),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){switch(u){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(u),!0}}}c.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},n.exports=c},{"../base-xform":32,"../style/font-xform":131,"./text-xform":125}],123:[function(e,n,a){const o=e("./text-xform"),s=e("./rich-text-xform"),l=e("./phonetic-text-xform"),c=e("../base-xform");n.exports=class extends c{constructor(i){super(),this.model=i,this.map={r:new s,t:new o,rPh:new l}}get tag(){return"si"}render(i,u){i.openNode(this.tag),u&&u.hasOwnProperty("richText")&&u.richText?u.richText.length?u.richText.forEach(p=>{this.map.r.render(i,p)}):this.map.t.render(i,""):u!=null&&this.map.t.render(i,u),i.closeNode()}parseOpen(i){const{name:u}=i;return this.parser?(this.parser.parseOpen(i),!0):u===this.tag?(this.model={},!0):(this.parser=this.map[u],!!this.parser&&(this.parser.parseOpen(i),!0))}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser){if(!this.parser.parseClose(i)){switch(i){case"r":{let u=this.model.richText;u||(u=this.model.richText=[]),u.push(this.parser.model);break}case"t":this.model=this.parser.model}this.parser=void 0}return!0}switch(i){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./phonetic-text-xform":121,"./rich-text-xform":122,"./text-xform":125}],124:[function(e,n,a){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("./shared-string-xform");n.exports=class extends s{constructor(c){super(),this.model=c||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new l)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(c){return this.model.values[c]}add(c){return c.richText?this.addRichText(c):this.addText(c)}addText(c){let i=this.hash[c];return i===void 0&&(i=this.hash[c]=this.model.values.length,this.model.values.push(c)),this.model.count++,i}addRichText(c){const i=this.sharedStringXform.toXml(c);let u=this.rich[i];return u===void 0&&(u=this.rich[i]=this.model.values.length,this.model.values.push(c)),this.model.count++,u}render(c,i){i=i||this._values,c.openXml(o.StdDocAttributes),c.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:i.count,uniqueCount:i.values.length});const u=this.sharedStringXform;i.values.forEach(p=>{u.render(c,p)}),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(c),!0;default:throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(c))}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;switch(c){case"sst":return!1;default:throw new Error("Unexpected xml node in parseClose: "+c)}}}},{"../../../utils/xml-stream":28,"../base-xform":32,"./shared-string-xform":123}],125:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"t"}render(s,l){s.openNode("t"),/^\s|\n|\s$/.test(l)&&s.addAttribute("xml:space","preserve"),s.writeText(l),s.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,(s,l)=>String.fromCharCode(parseInt(l,16)))}parseOpen(s){switch(s.name){case"t":return this._text=[],!0;default:return!1}}parseText(s){this._text.push(s)}parseClose(){return!1}}},{"../base-xform":32}],126:[function(e,n,a){const o=e("../../../doc/enums"),s=e("../../../utils/utils"),l=e("../base-xform"),c={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce((u,p)=>(u[p]=!0,u),{}),horizontal(u){return this.horizontalValues[u]?u:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce((u,p)=>(u[p]=!0,u),{}),vertical(u){return u==="middle"?"center":this.verticalValues[u]?u:void 0},wrapText:u=>!!u||void 0,shrinkToFit:u=>!!u||void 0,textRotation(u){switch(u){case"vertical":return u;default:return(u=s.validInt(u))>=-90&&u<=90?u:void 0}},indent:u=>(u=s.validInt(u),Math.max(0,u)),readingOrder(u){switch(u){case"ltr":return o.ReadingOrder.LeftToRight;case"rtl":return o.ReadingOrder.RightToLeft;default:return}}},i={toXml(u){if(u=c.textRotation(u)){if(u==="vertical")return 255;const p=Math.round(u);if(p>=0&&p<=90)return p;if(p<0&&p>=-90)return 90-p}},toModel(u){const p=s.validInt(u);if(p!==void 0){if(p===255)return"vertical";if(p>=0&&p<=90)return p;if(p>90&&p<=180)return 90-p}}};n.exports=class extends l{get tag(){return"alignment"}render(u,p){u.addRollback(),u.openNode("alignment");let f=!1;function h(v,b){b&&(u.addAttribute(v,b),f=!0)}h("horizontal",c.horizontal(p.horizontal)),h("vertical",c.vertical(p.vertical)),h("wrapText",!!c.wrapText(p.wrapText)&&"1"),h("shrinkToFit",!!c.shrinkToFit(p.shrinkToFit)&&"1"),h("indent",c.indent(p.indent)),h("textRotation",i.toXml(p.textRotation)),h("readingOrder",c.readingOrder(p.readingOrder)),u.closeNode(),f?u.commit():u.rollback()}parseOpen(u){const p={};let f=!1;function h(v,b,g){v&&(p[b]=g,f=!0)}h(u.attributes.horizontal,"horizontal",u.attributes.horizontal),h(u.attributes.vertical,"vertical",u.attributes.vertical==="center"?"middle":u.attributes.vertical),h(u.attributes.wrapText,"wrapText",s.parseBoolean(u.attributes.wrapText)),h(u.attributes.shrinkToFit,"shrinkToFit",s.parseBoolean(u.attributes.shrinkToFit)),h(u.attributes.indent,"indent",parseInt(u.attributes.indent,10)),h(u.attributes.textRotation,"textRotation",i.toModel(u.attributes.textRotation)),h(u.attributes.readingOrder,"readingOrder",u.attributes.readingOrder==="2"?"rtl":"ltr"),this.model=f?p:null}parseText(){}parseClose(){return!1}}},{"../../../doc/enums":7,"../../../utils/utils":27,"../base-xform":32}],127:[function(e,n,a){const o=e("../base-xform"),s=e("../../../utils/utils"),l=e("./color-xform");class c extends o{constructor(u){super(),this.name=u,this.map={color:new l}}get tag(){return this.name}render(u,p,f){const h=p&&p.color||f||this.defaultColor;u.openNode(this.name),p&&p.style&&(u.addAttribute("style",p.style),h&&this.map.color.render(u,h)),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.name:{const{style:p}=u.attributes;return this.model=p?{style:p}:void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.parser=void 0),!0):(u===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(u){return c.validStyleValues[u]}}c.validStyleValues=["thin","dashed","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce((i,u)=>(i[u]=!0,i),{}),n.exports=class extends o{constructor(){super(),this.map={top:new c("top"),left:new c("left"),bottom:new c("bottom"),right:new c("right"),diagonal:new c("diagonal")}}render(i,u){const{color:p}=u;function f(h,v){h&&!h.color&&u.color&&(h={...h,color:u.color}),v.render(i,h,p)}i.openNode("border"),u.diagonal&&u.diagonal.style&&(u.diagonal.up&&i.addAttribute("diagonalUp","1"),u.diagonal.down&&i.addAttribute("diagonalDown","1")),f(u.left,this.map.left),f(u.right,this.map.right),f(u.top,this.map.top),f(u.bottom,this.map.bottom),f(u.diagonal,this.map.diagonal),i.closeNode()}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;switch(i.name){case"border":return this.reset(),this.diagonalUp=s.parseBoolean(i.attributes.diagonalUp),this.diagonalDown=s.parseBoolean(i.attributes.diagonalDown),!0;default:return this.parser=this.map[i.name],!!this.parser&&(this.parser.parseOpen(i),!0)}}parseText(i){this.parser&&this.parser.parseText(i)}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.parser=void 0),!0;if(i==="border"){const u=this.model={},p=function(f,h,v){h&&(v&&Object.assign(h,v),u[f]=h)};p("left",this.map.left.model),p("right",this.map.right.model),p("top",this.map.top.model),p("bottom",this.map.bottom.model),p("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}}},{"../../../utils/utils":27,"../base-xform":32,"./color-xform":128}],128:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{constructor(s){super(),this.name=s||"color"}get tag(){return this.name}render(s,l){return!!l&&(s.openNode(this.name),l.argb?s.addAttribute("rgb",l.argb):l.theme!==void 0?(s.addAttribute("theme",l.theme),l.tint!==void 0&&s.addAttribute("tint",l.tint)):l.indexed!==void 0?s.addAttribute("indexed",l.indexed):s.addAttribute("auto","1"),s.closeNode(),!0)}parseOpen(s){return s.name===this.name&&(s.attributes.rgb?this.model={argb:s.attributes.rgb}:s.attributes.theme?(this.model={theme:parseInt(s.attributes.theme,10)},s.attributes.tint&&(this.model.tint=parseFloat(s.attributes.tint))):s.attributes.indexed?this.model={indexed:parseInt(s.attributes.indexed,10)}:this.model=void 0,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],129:[function(e,n,a){const o=e("../base-xform"),s=e("./alignment-xform"),l=e("./border-xform"),c=e("./fill-xform"),i=e("./font-xform"),u=e("./numfmt-xform"),p=e("./protection-xform");n.exports=class extends o{constructor(){super(),this.map={alignment:new s,border:new l,fill:new c,font:new i,numFmt:new u,protection:new p}}get tag(){return"dxf"}render(f,h){if(f.openNode(this.tag),h.font&&this.map.font.render(f,h.font),h.numFmt&&h.numFmtId){const v={id:h.numFmtId,formatCode:h.numFmt};this.map.numFmt.render(f,v)}h.fill&&this.map.fill.render(f,h.fill),h.alignment&&this.map.alignment.render(f,h.alignment),h.border&&this.map.border.render(f,h.border),h.protection&&this.map.protection.render(f,h.protection),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case this.tag:return this.reset(),!0;default:return this.parser=this.map[f.name],this.parser&&this.parser.parseOpen(f),!0}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return this.parser?(this.parser.parseClose(f)||(this.parser=void 0),!0):f!==this.tag||(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1)}}},{"../base-xform":32,"./alignment-xform":126,"./border-xform":127,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./protection-xform":133}],130:[function(e,n,a){const o=e("../base-xform"),s=e("./color-xform");class l extends o{constructor(){super(),this.map={color:new s}}get tag(){return"stop"}render(f,h){f.openNode("stop"),f.addAttribute("position",h.position),this.map.color.render(f,h.color),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"stop":return this.model={position:parseFloat(f.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(f),!0;default:return!1}}parseText(){}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model.color=this.parser.model,this.parser=void 0),!0)}}class c extends o{constructor(){super(),this.map={fgColor:new s("fgColor"),bgColor:new s("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(f,h){f.openNode("patternFill"),f.addAttribute("patternType",h.pattern),h.fgColor&&this.map.fgColor.render(f,h.fgColor),h.bgColor&&this.map.bgColor.render(f,h.bgColor),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"patternFill":return this.model={type:"pattern",pattern:f.attributes.patternType},!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.parser.model&&(this.model[f]=this.parser.model),this.parser=void 0),!0)}}class i extends o{constructor(){super(),this.map={stop:new l}}get name(){return"gradient"}get tag(){return"gradientFill"}render(f,h){switch(f.openNode("gradientFill"),h.gradient){case"angle":f.addAttribute("degree",h.degree);break;case"path":f.addAttribute("type","path"),h.center.left&&(f.addAttribute("left",h.center.left),h.center.right===void 0&&f.addAttribute("right",h.center.left)),h.center.right&&f.addAttribute("right",h.center.right),h.center.top&&(f.addAttribute("top",h.center.top),h.center.bottom===void 0&&f.addAttribute("bottom",h.center.top)),h.center.bottom&&f.addAttribute("bottom",h.center.bottom)}const v=this.map.stop;h.stops.forEach(b=>{v.render(f,b)}),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"gradientFill":{const h=this.model={stops:[]};return f.attributes.degree?(h.gradient="angle",h.degree=parseInt(f.attributes.degree,10)):f.attributes.type==="path"&&(h.gradient="path",h.center={left:f.attributes.left?parseFloat(f.attributes.left):0,top:f.attributes.top?parseFloat(f.attributes.top):0},f.attributes.right!==f.attributes.left&&(h.center.right=f.attributes.right?parseFloat(f.attributes.right):0),f.attributes.bottom!==f.attributes.top&&(h.center.bottom=f.attributes.bottom?parseFloat(f.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(f),!0;default:return!1}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0)}}class u extends o{constructor(){super(),this.map={patternFill:new c,gradientFill:new i}}get tag(){return"fill"}render(f,h){switch(f.addRollback(),f.openNode("fill"),h.type){case"pattern":this.map.patternFill.render(f,h);break;case"gradient":this.map.gradientFill.render(f,h);break;default:return void f.rollback()}f.closeNode(),f.commit()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"fill":return this.model={},!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0)}validStyle(f){return u.validPatternValues[f]}}u.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce((p,f)=>(p[f]=!0,p),{}),u.StopXform=l,u.PatternFillXform=c,u.GradientFillXform=i,n.exports=u},{"../base-xform":32,"./color-xform":128}],131:[function(e,n,a){const o=e("./color-xform"),s=e("../simple/boolean-xform"),l=e("../simple/integer-xform"),c=e("../simple/string-xform"),i=e("./underline-xform"),u=e("../../../utils/under-dash"),p=e("../base-xform");class f extends p{constructor(v){super(),this.options=v||f.OPTIONS,this.map={b:{prop:"bold",xform:new s({tag:"b",attr:"val"})},i:{prop:"italic",xform:new s({tag:"i",attr:"val"})},u:{prop:"underline",xform:new i},charset:{prop:"charset",xform:new l({tag:"charset",attr:"val"})},color:{prop:"color",xform:new o},condense:{prop:"condense",xform:new s({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new s({tag:"extend",attr:"val"})},family:{prop:"family",xform:new l({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new s({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new c({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new c({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new s({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new s({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new l({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new c({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(v,b){const{map:g}=this;v.openNode(this.options.tagName),u.each(this.map,(x,y)=>{g[y].xform.render(v,b[x.prop])}),v.closeNode()}parseOpen(v){if(this.parser)return this.parser.parseOpen(v),!0;if(this.map[v.name])return this.parser=this.map[v.name].xform,this.parser.parseOpen(v);switch(v.name){case this.options.tagName:return this.model={},!0;default:return!1}}parseText(v){this.parser&&this.parser.parseText(v)}parseClose(v){if(this.parser&&!this.parser.parseClose(v)){const b=this.map[v];return this.parser.model&&(this.model[b.prop]=this.parser.model),this.parser=void 0,!0}switch(v){case this.options.tagName:return!1;default:return!0}}}f.OPTIONS={tagName:"font",fontNameTag:"name"},n.exports=f},{"../../../utils/under-dash":26,"../base-xform":32,"../simple/boolean-xform":116,"../simple/integer-xform":118,"../simple/string-xform":119,"./color-xform":128,"./underline-xform":136}],132:[function(e,n,a){const o=e("../../../utils/under-dash"),s=e("../../defaultnumformats"),l=e("../base-xform"),c=function(){const u={};return o.each(s,(p,f)=>{p.f&&(u[p.f]=parseInt(f,10))}),u}();class i extends l{constructor(p,f){super(),this.id=p,this.formatCode=f}get tag(){return"numFmt"}render(p,f){p.leafNode("numFmt",{numFmtId:f.id,formatCode:f.formatCode})}parseOpen(p){switch(p.name){case"numFmt":return this.model={id:parseInt(p.attributes.numFmtId,10),formatCode:p.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0;default:return!1}}parseText(){}parseClose(){return!1}}i.getDefaultFmtId=function(u){return c[u]},i.getDefaultFmtCode=function(u){return s[u]&&s[u].f},n.exports=i},{"../../../utils/under-dash":26,"../../defaultnumformats":30,"../base-xform":32}],133:[function(e,n,a){const o=e("../base-xform"),s={boolean:(l,c)=>l===void 0?c:l};n.exports=class extends o{get tag(){return"protection"}render(l,c){l.addRollback(),l.openNode("protection");let i=!1;function u(p,f){f!==void 0&&(l.addAttribute(p,f),i=!0)}u("locked",s.boolean(c.locked,!0)?void 0:"0"),u("hidden",s.boolean(c.hidden,!1)?"1":void 0),l.closeNode(),i?l.commit():l.rollback()}parseOpen(l){const c={locked:l.attributes.locked!=="0",hidden:l.attributes.hidden==="1"},i=!c.locked||c.hidden;this.model=i?c:null}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],134:[function(e,n,a){const o=e("../base-xform"),s=e("./alignment-xform"),l=e("./protection-xform");n.exports=class extends o{constructor(c){super(),this.xfId=!(!c||!c.xfId),this.map={alignment:new s,protection:new l}}get tag(){return"xf"}render(c,i){c.openNode("xf",{numFmtId:i.numFmtId||0,fontId:i.fontId||0,fillId:i.fillId||0,borderId:i.borderId||0}),this.xfId&&c.addAttribute("xfId",i.xfId||0),i.numFmtId&&c.addAttribute("applyNumberFormat","1"),i.fontId&&c.addAttribute("applyFont","1"),i.fillId&&c.addAttribute("applyFill","1"),i.borderId&&c.addAttribute("applyBorder","1"),i.alignment&&c.addAttribute("applyAlignment","1"),i.protection&&c.addAttribute("applyProtection","1"),i.alignment&&this.map.alignment.render(c,i.alignment),i.protection&&this.map.protection.render(c,i.protection),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"xf":return this.model={numFmtId:parseInt(c.attributes.numFmtId,10),fontId:parseInt(c.attributes.fontId,10),fillId:parseInt(c.attributes.fillId,10),borderId:parseInt(c.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(c.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(c),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(c),!0;default:return!1}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):c!=="xf"}}},{"../base-xform":32,"./alignment-xform":126,"./protection-xform":133}],135:[function(e,n,a){const o=e("../../../doc/enums"),s=e("../../../utils/xml-stream"),l=e("../base-xform"),c=e("../static-xform"),i=e("../list-xform"),u=e("./font-xform"),p=e("./fill-xform"),f=e("./border-xform"),h=e("./numfmt-xform"),v=e("./style-xform"),b=e("./dxf-xform");class g extends l{constructor(y){super(),this.map={numFmts:new i({tag:"numFmts",count:!0,childXform:new h}),fonts:new i({tag:"fonts",count:!0,childXform:new u,$:{"x14ac:knownFonts":1}}),fills:new i({tag:"fills",count:!0,childXform:new p}),borders:new i({tag:"borders",count:!0,childXform:new f}),cellStyleXfs:new i({tag:"cellStyleXfs",count:!0,childXform:new v}),cellXfs:new i({tag:"cellXfs",count:!0,childXform:new v({xfId:!0})}),dxfs:new i({tag:"dxfs",always:!0,count:!0,childXform:new b}),numFmt:new h,font:new u,fill:new p,border:new f,style:new v({xfId:!0}),cellStyles:g.STATIC_XFORMS.cellStyles,tableStyles:g.STATIC_XFORMS.tableStyles,extLst:g.STATIC_XFORMS.extLst},y&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(y,k){k=k||this.model,y.openXml(s.StdDocAttributes),y.openNode("styleSheet",g.STYLESHEET_ATTRIBUTES),this.index?(k.numFmts&&k.numFmts.length&&(y.openNode("numFmts",{count:k.numFmts.length}),k.numFmts.forEach(N=>{y.writeXml(N)}),y.closeNode()),k.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),y.openNode("fonts",{count:k.fonts.length,"x14ac:knownFonts":1}),k.fonts.forEach(N=>{y.writeXml(N)}),y.closeNode(),y.openNode("fills",{count:k.fills.length}),k.fills.forEach(N=>{y.writeXml(N)}),y.closeNode(),y.openNode("borders",{count:k.borders.length}),k.borders.forEach(N=>{y.writeXml(N)}),y.closeNode(),this.map.cellStyleXfs.render(y,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),y.openNode("cellXfs",{count:k.styles.length}),k.styles.forEach(N=>{y.writeXml(N)}),y.closeNode()):(this.map.numFmts.render(y,k.numFmts),this.map.fonts.render(y,k.fonts),this.map.fills.render(y,k.fills),this.map.borders.render(y,k.borders),this.map.cellStyleXfs.render(y,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(y,k.styles)),g.STATIC_XFORMS.cellStyles.render(y),this.map.dxfs.render(y,k.dxfs),g.STATIC_XFORMS.tableStyles.render(y),g.STATIC_XFORMS.extLst.render(y),y.closeNode()}parseOpen(y){if(this.parser)return this.parser.parseOpen(y),!0;switch(y.name){case"styleSheet":return this.initIndex(),!0;default:return this.parser=this.map[y.name],this.parser&&this.parser.parseOpen(y),!0}}parseText(y){this.parser&&this.parser.parseText(y)}parseClose(y){if(this.parser)return this.parser.parseClose(y)||(this.parser=void 0),!0;switch(y){case"styleSheet":{this.model={};const k=(N,F)=>{F.model&&F.model.length&&(this.model[N]=F.model)};if(k("numFmts",this.map.numFmts),k("fonts",this.map.fonts),k("fills",this.map.fills),k("borders",this.map.borders),k("styles",this.map.cellXfs),k("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){const N=this.index.numFmt;this.model.numFmts.forEach(F=>{N[F.id]=F.formatCode})}return!1}default:return!0}}addStyleModel(y,k){if(!y)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(y))return this.weakMap.get(y);const N={};if(k=k||o.ValueType.Number,y.numFmt)N.numFmtId=this._addNumFmtStr(y.numFmt);else switch(k){case o.ValueType.Number:N.numFmtId=this._addNumFmtStr("General");break;case o.ValueType.Date:N.numFmtId=this._addNumFmtStr("mm-dd-yy")}y.font&&(N.fontId=this._addFont(y.font)),y.border&&(N.borderId=this._addBorder(y.border)),y.fill&&(N.fillId=this._addFill(y.fill)),y.alignment&&(N.alignment=y.alignment),y.protection&&(N.protection=y.protection);const F=this._addStyle(N);return this.weakMap&&this.weakMap.set(y,F),F}getStyleModel(y){const k=this.model.styles[y];if(!k)return null;let N=this.index.model[y];if(N)return N;if(N=this.index.model[y]={},k.numFmtId){const B=this.index.numFmt[k.numFmtId]||h.getDefaultFmtCode(k.numFmtId);B&&(N.numFmt=B)}function F(B,W,V){if(V||V===0){const q=W[V];q&&(N[B]=q)}}return F("font",this.model.fonts,k.fontId),F("border",this.model.borders,k.borderId),F("fill",this.model.fills,k.fillId),k.alignment&&(N.alignment=k.alignment),k.protection&&(N.protection=k.protection),N}addDxfStyle(y){return y.numFmt&&(y.numFmtId=this._addNumFmtStr(y.numFmt)),this.model.dxfs.push(y),this.model.dxfs.length-1}getDxfStyle(y){return this.model.dxfs[y]}_addStyle(y){const k=this.map.style.toXml(y);let N=this.index.style[k];return N===void 0&&(N=this.index.style[k]=this.model.styles.length,this.model.styles.push(k)),N}_addNumFmtStr(y){let k=h.getDefaultFmtId(y);if(k!==void 0||(k=this.index.numFmt[y],k!==void 0))return k;k=this.index.numFmt[y]=164+this.model.numFmts.length;const N=this.map.numFmt.toXml({id:k,formatCode:y});return this.model.numFmts.push(N),k}_addFont(y){const k=this.map.font.toXml(y);let N=this.index.font[k];return N===void 0&&(N=this.index.font[k]=this.model.fonts.length,this.model.fonts.push(k)),N}_addBorder(y){const k=this.map.border.toXml(y);let N=this.index.border[k];return N===void 0&&(N=this.index.border[k]=this.model.borders.length,this.model.borders.push(k)),N}_addFill(y){const k=this.map.fill.toXml(y);let N=this.index.fill[k];return N===void 0&&(N=this.index.fill[k]=this.model.fills.length,this.model.fills.push(k)),N}}g.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"},g.STATIC_XFORMS={cellStyles:new c({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new c({tag:"dxfs",$:{count:0}}),tableStyles:new c({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new c({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})},g.Mock=class extends g{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(x){return x.autodrain(),Promise.resolve()}addStyleModel(x,y){switch(y){case o.ValueType.Date:return this.dateStyleId;default:return 0}}get dateStyleId(){if(!this._dateStyleId){const x={numFmtId:h.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(x)}return this._dateStyleId}getStyleModel(){return{}}},n.exports=g},{"../../../doc/enums":7,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./border-xform":127,"./dxf-xform":129,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./style-xform":134}],136:[function(e,n,a){const o=e("../base-xform");class s extends o{constructor(c){super(),this.model=c}get tag(){return"u"}render(c,i){if((i=i||this.model)===!0)c.leafNode("u");else{const u=s.Attributes[i];u&&c.leafNode("u",u)}}parseOpen(c){c.name==="u"&&(this.model=c.attributes.val||!0)}parseText(){}parseClose(){return!1}}s.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},n.exports=s},{"../base-xform":32}],137:[function(e,n,a){const o=e("../base-xform"),s=e("./filter-column-xform");n.exports=class extends o{constructor(){super(),this.map={filterColumn:new s}}get tag(){return"autoFilter"}prepare(l){l.columns.forEach((c,i)=>{this.map.filterColumn.prepare(c,{index:i})})}render(l,c){return l.openNode(this.tag,{ref:c.autoFilterRef}),c.columns.forEach(i=>{this.map.filterColumn.render(l,i)}),l.closeNode(),!0}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:return this.model={autoFilterRef:l.attributes.ref,columns:[]},!0;default:if(this.parser=this.map[l.name],this.parser)return this.parseOpen(l),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(l))}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;switch(l){case this.tag:return!1;default:throw new Error("Unexpected xml node in parseClose: "+l)}}}},{"../base-xform":32,"./filter-column-xform":139}],138:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"customFilter"}render(s,l){s.leafNode(this.tag,{val:l.val,operator:l.operator})}parseOpen(s){return s.name===this.tag&&(this.model={val:s.attributes.val,operator:s.attributes.operator},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],139:[function(e,n,a){const o=e("../base-xform"),s=e("../list-xform"),l=e("./custom-filter-xform"),c=e("./filter-xform");n.exports=class extends o{constructor(){super(),this.map={customFilters:new s({tag:"customFilters",count:!1,empty:!0,childXform:new l}),filters:new s({tag:"filters",count:!1,empty:!0,childXform:new c})}}get tag(){return"filterColumn"}prepare(i,u){i.colId=u.index.toString()}render(i,u){return u.customFilters?(i.openNode(this.tag,{colId:u.colId,hiddenButton:u.filterButton?"0":"1"}),this.map.customFilters.render(i,u.customFilters),i.closeNode(),!0):(i.leafNode(this.tag,{colId:u.colId,hiddenButton:u.filterButton?"0":"1"}),!0)}parseOpen(i){if(this.parser)return this.parser.parseOpen(i),!0;const{attributes:u}=i;switch(i.name){case this.tag:return this.model={filterButton:u.hiddenButton==="0"},!0;default:if(this.parser=this.map[i.name],this.parser)return this.parseOpen(i),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(i))}}parseText(){}parseClose(i){if(this.parser)return this.parser.parseClose(i)||(this.parser=void 0),!0;switch(i){case this.tag:return this.model.customFilters=this.map.customFilters.model,!1;default:return!0}}}},{"../base-xform":32,"../list-xform":71,"./custom-filter-xform":138,"./filter-xform":140}],140:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"filter"}render(s,l){s.leafNode(this.tag,{val:l.val})}parseOpen(s){return s.name===this.tag&&(this.model={val:s.attributes.val},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],141:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"tableColumn"}prepare(s,l){s.id=l.index+1}render(s,l){return s.leafNode(this.tag,{id:l.id.toString(),name:l.name,totalsRowLabel:l.totalsRowLabel,totalsRowFunction:l.totalsRowFunction,dxfId:l.dxfId}),!0}parseOpen(s){if(s.name===this.tag){const{attributes:l}=s;return this.model={name:l.name,totalsRowLabel:l.totalsRowLabel,totalsRowFunction:l.totalsRowFunction,dxfId:l.dxfId},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],142:[function(e,n,a){const o=e("../base-xform");n.exports=class extends o{get tag(){return"tableStyleInfo"}render(s,l){return s.leafNode(this.tag,{name:l.theme?l.theme:void 0,showFirstColumn:l.showFirstColumn?"1":"0",showLastColumn:l.showLastColumn?"1":"0",showRowStripes:l.showRowStripes?"1":"0",showColumnStripes:l.showColumnStripes?"1":"0"}),!0}parseOpen(s){if(s.name===this.tag){const{attributes:l}=s;return this.model={theme:l.name?l.name:null,showFirstColumn:l.showFirstColumn==="1",showLastColumn:l.showLastColumn==="1",showRowStripes:l.showRowStripes==="1",showColumnStripes:l.showColumnStripes==="1"},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],143:[function(e,n,a){const o=e("../../../utils/xml-stream"),s=e("../base-xform"),l=e("../list-xform"),c=e("./auto-filter-xform"),i=e("./table-column-xform"),u=e("./table-style-info-xform");class p extends s{constructor(){super(),this.map={autoFilter:new c,tableColumns:new l({tag:"tableColumns",count:!0,empty:!0,childXform:new i}),tableStyleInfo:new u}}prepare(h,v){this.map.autoFilter.prepare(h),this.map.tableColumns.prepare(h.columns,v)}get tag(){return"table"}render(h,v){h.openXml(o.StdDocAttributes),h.openNode(this.tag,{...p.TABLE_ATTRIBUTES,id:v.id,name:v.name,displayName:v.displayName||v.name,ref:v.tableRef,totalsRowCount:v.totalsRow?"1":void 0,totalsRowShown:v.totalsRow?void 0:"1",headerRowCount:v.headerRow?"1":"0"}),this.map.autoFilter.render(h,v),this.map.tableColumns.render(h,v.columns),this.map.tableStyleInfo.render(h,v.style),h.closeNode()}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;const{name:v,attributes:b}=h;switch(v){case this.tag:this.reset(),this.model={name:b.name,displayName:b.displayName||b.name,tableRef:b.ref,totalsRow:b.totalsRowCount==="1",headerRow:b.headerRowCount==="1"};break;default:this.parser=this.map[h.name],this.parser&&this.parser.parseOpen(h)}return!0}parseText(h){this.parser&&this.parser.parseText(h)}parseClose(h){if(this.parser)return this.parser.parseClose(h)||(this.parser=void 0),!0;switch(h){case this.tag:return this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach((v,b)=>{this.model.columns[b].filterButton=v.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1;default:return!0}}reconcile(h,v){h.columns.forEach(b=>{b.dxfId!==void 0&&(b.style=v.styles.getDxfStyle(b.dxfId))})}}p.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},n.exports=p},{"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":137,"./table-column-xform":141,"./table-style-info-xform":142}],144:[function(e,n,a){(function(o,s){(function(){const l=e("fs"),c=e("jszip"),{PassThrough:i}=e("readable-stream"),u=e("../utils/zip-stream"),p=e("../utils/stream-buf"),f=e("../utils/utils"),h=e("../utils/xml-stream"),{bufferToString:v}=e("../utils/browser-buffer-decode"),b=e("./xform/style/styles-xform"),g=e("./xform/core/core-xform"),x=e("./xform/strings/shared-strings-xform"),y=e("./xform/core/relationships-xform"),k=e("./xform/core/content-types-xform"),N=e("./xform/core/app-xform"),F=e("./xform/book/workbook-xform"),B=e("./xform/sheet/worksheet-xform"),W=e("./xform/drawing/drawing-xform"),V=e("./xform/table/table-xform"),q=e("./xform/comment/comments-xform"),X=e("./xform/comment/vml-notes-xform"),I=e("./xml/theme1");class H{constructor(R){this.workbook=R}async readFile(R,C){if(!await f.fs.exists(R))throw new Error("File not found: "+R);const w=l.createReadStream(R);try{const E=await this.read(w,C);return w.close(),E}catch(E){throw w.close(),E}}parseRels(R){return new y().parseStream(R)}parseWorkbook(R){return new F().parseStream(R)}parseSharedStrings(R){return new x().parseStream(R)}reconcile(R,C){const w=new F,E=new B(C),A=new W,T=new V;w.reconcile(R);const D={media:R.media,mediaIndex:R.mediaIndex};Object.keys(R.drawings).forEach(K=>{const Y=R.drawings[K],re=R.drawingRels[K];re&&(D.rels=re.reduce((z,ee)=>(z[ee.Id]=ee,z),{}),(Y.anchors||[]).forEach(z=>{const ee=z.picture&&z.picture.hyperlinks;ee&&D.rels[ee.rId]&&(ee.hyperlink=D.rels[ee.rId].Target,delete ee.rId)}),A.reconcile(Y,D))});const U={styles:R.styles};Object.values(R.tables).forEach(K=>{T.reconcile(K,U)});const P={styles:R.styles,sharedStrings:R.sharedStrings,media:R.media,mediaIndex:R.mediaIndex,date1904:R.properties&&R.properties.date1904,drawings:R.drawings,comments:R.comments,tables:R.tables,vmlDrawings:R.vmlDrawings};R.worksheets.forEach(K=>{K.relationships=R.worksheetRels[K.sheetNo],E.reconcile(K,P)}),delete R.worksheetHash,delete R.worksheetRels,delete R.globalRels,delete R.sharedStrings,delete R.workbookRels,delete R.sheetDefs,delete R.styles,delete R.mediaIndex,delete R.drawings,delete R.drawingRels,delete R.vmlDrawings}async _processWorksheetEntry(R,C,w,E,A){const T=new B(E),D=await T.parseStream(R);D.sheetNo=w,C.worksheetHash[A]=D,C.worksheets.push(D)}async _processCommentEntry(R,C,w){const E=new q,A=await E.parseStream(R);C.comments[`../${w}.xml`]=A}async _processTableEntry(R,C,w){const E=new V,A=await E.parseStream(R);C.tables[`../tables/${w}.xml`]=A}async _processWorksheetRelsEntry(R,C,w){const E=new y,A=await E.parseStream(R);C.worksheetRels[w]=A}async _processMediaEntry(R,C,w){const E=w.lastIndexOf(".");if(E>=1){const A=w.substr(E+1),T=w.substr(0,E);await new Promise((D,U)=>{const P=new p;P.on("finish",()=>{C.mediaIndex[w]=C.media.length,C.mediaIndex[T]=C.media.length;const K={type:"image",name:T,extension:A,buffer:P.toBuffer()};C.media.push(K),D()}),R.on("error",K=>{U(K)}),R.pipe(P)})}}async _processDrawingEntry(R,C,w){const E=new W,A=await E.parseStream(R);C.drawings[w]=A}async _processDrawingRelsEntry(R,C,w){const E=new y,A=await E.parseStream(R);C.drawingRels[w]=A}async _processVmlDrawingEntry(R,C,w){const E=new X,A=await E.parseStream(R);C.vmlDrawings[`../drawings/${w}.vml`]=A}async _processThemeEntry(R,C,w){await new Promise((E,A)=>{const T=new p;R.on("error",A),T.on("error",A),T.on("finish",()=>{C.themes[w]=T.read().toString(),E()}),R.pipe(T)})}createInputStream(){throw new Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}async read(R,C){!R[Symbol.asyncIterator]&&R.pipe&&(R=R.pipe(new i));const w=[];for await(const E of R)w.push(E);return this.load(s.concat(w),C)}async load(R,C){let w;w=C&&C.base64?s.from(R.toString(),"base64"):R;const E={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}},A=await c.loadAsync(w);for(const T of Object.values(A.files))if(!T.dir){let D,U=T.name;if(U[0]==="/"&&(U=U.substr(1)),U.match(/xl\/media\//)||U.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))D=new i,D.write(await T.async("nodebuffer"));else{let P;D=new i({writableObjectMode:!0,readableObjectMode:!0}),P=o.browser?v(await T.async("nodebuffer")):await T.async("string");const K=16384;for(let Y=0;Y<P.length;Y+=K)D.write(P.substring(Y,Y+K))}switch(D.end(),U){case"_rels/.rels":E.globalRels=await this.parseRels(D);break;case"xl/workbook.xml":{const P=await this.parseWorkbook(D);E.sheets=P.sheets,E.definedNames=P.definedNames,E.views=P.views,E.properties=P.properties,E.calcProperties=P.calcProperties;break}case"xl/_rels/workbook.xml.rels":E.workbookRels=await this.parseRels(D);break;case"xl/sharedStrings.xml":E.sharedStrings=new x,await E.sharedStrings.parseStream(D);break;case"xl/styles.xml":E.styles=new b,await E.styles.parseStream(D);break;case"docProps/app.xml":{const P=new N,K=await P.parseStream(D);E.company=K.company,E.manager=K.manager;break}case"docProps/core.xml":{const P=new g,K=await P.parseStream(D);Object.assign(E,K);break}default:{let P=U.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if(P){await this._processWorksheetEntry(D,E,P[1],C,U);break}if(P=U.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),P){await this._processWorksheetRelsEntry(D,E,P[1]);break}if(P=U.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/),P){await this._processThemeEntry(D,E,P[1]);break}if(P=U.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/),P){await this._processMediaEntry(D,E,P[1]);break}if(P=U.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/),P){await this._processDrawingEntry(D,E,P[1]);break}if(P=U.match(/xl\/(comments\d+)[.]xml/),P){await this._processCommentEntry(D,E,P[1]);break}if(P=U.match(/xl\/tables\/(table\d+)[.]xml/),P){await this._processTableEntry(D,E,P[1]);break}if(P=U.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/),P){await this._processDrawingRelsEntry(D,E,P[1]);break}if(P=U.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/),P){await this._processVmlDrawingEntry(D,E,P[1]);break}}}}return this.reconcile(E,C),this.workbook.model=E,this.workbook}async addMedia(R,C){await Promise.all(C.media.map(async w=>{if(w.type==="image"){const E=`xl/media/${w.name}.${w.extension}`;if(w.filename){const A=await function(T,D){return new Promise((U,P)=>{l.readFile(T,D,(K,Y)=>{K?P(K):U(Y)})})}(w.filename);return R.append(A,{name:E})}if(w.buffer)return R.append(w.buffer,{name:E});if(w.base64){const A=w.base64,T=A.substring(A.indexOf(",")+1);return R.append(T,{name:E,base64:!0})}}throw new Error("Unsupported media")}))}addDrawings(R,C){const w=new W,E=new y;C.worksheets.forEach(A=>{const{drawing:T}=A;if(T){w.prepare(T,{});let D=w.toXml(T);R.append(D,{name:`xl/drawings/${T.name}.xml`}),D=E.toXml(T.rels),R.append(D,{name:`xl/drawings/_rels/${T.name}.xml.rels`})}})}addTables(R,C){const w=new V;C.worksheets.forEach(E=>{const{tables:A}=E;A.forEach(T=>{w.prepare(T,{});const D=w.toXml(T);R.append(D,{name:"xl/tables/"+T.target})})})}async addContentTypes(R,C){const w=new k().toXml(C);R.append(w,{name:"[Content_Types].xml"})}async addApp(R,C){const w=new N().toXml(C);R.append(w,{name:"docProps/app.xml"})}async addCore(R,C){const w=new g;R.append(w.toXml(C),{name:"docProps/core.xml"})}async addThemes(R,C){const w=C.themes||{theme1:I};Object.keys(w).forEach(E=>{const A=w[E],T=`xl/theme/${E}.xml`;R.append(A,{name:T})})}async addOfficeRels(R){const C=new y().toXml([{Id:"rId1",Type:H.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:H.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:H.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);R.append(C,{name:"_rels/.rels"})}async addWorkbookRels(R,C){let w=1;const E=[{Id:"rId"+w++,Type:H.RelType.Styles,Target:"styles.xml"},{Id:"rId"+w++,Type:H.RelType.Theme,Target:"theme/theme1.xml"}];C.sharedStrings.count&&E.push({Id:"rId"+w++,Type:H.RelType.SharedStrings,Target:"sharedStrings.xml"}),C.worksheets.forEach(T=>{T.rId="rId"+w++,E.push({Id:T.rId,Type:H.RelType.Worksheet,Target:`worksheets/sheet${T.id}.xml`})});const A=new y().toXml(E);R.append(A,{name:"xl/_rels/workbook.xml.rels"})}async addSharedStrings(R,C){C.sharedStrings&&C.sharedStrings.count&&R.append(C.sharedStrings.xml,{name:"xl/sharedStrings.xml"})}async addStyles(R,C){const{xml:w}=C.styles;w&&R.append(w,{name:"xl/styles.xml"})}async addWorkbook(R,C){const w=new F;R.append(w.toXml(C),{name:"xl/workbook.xml"})}async addWorksheets(R,C){const w=new B,E=new y,A=new q,T=new X;C.worksheets.forEach(D=>{let U=new h;w.render(U,D),R.append(U.xml,{name:`xl/worksheets/sheet${D.id}.xml`}),D.rels&&D.rels.length&&(U=new h,E.render(U,D.rels),R.append(U.xml,{name:`xl/worksheets/_rels/sheet${D.id}.xml.rels`})),D.comments.length>0&&(U=new h,A.render(U,D),R.append(U.xml,{name:`xl/comments${D.id}.xml`}),U=new h,T.render(U,D),R.append(U.xml,{name:`xl/drawings/vmlDrawing${D.id}.vml`}))})}_finalize(R){return new Promise((C,w)=>{R.on("finish",()=>{C(this)}),R.on("error",w),R.finalize()})}prepareModel(R,C){R.creator=R.creator||"ExcelJS",R.lastModifiedBy=R.lastModifiedBy||"ExcelJS",R.created=R.created||new Date,R.modified=R.modified||new Date,R.useSharedStrings=C.useSharedStrings===void 0||C.useSharedStrings,R.useStyles=C.useStyles===void 0||C.useStyles,R.sharedStrings=new x,R.styles=R.useStyles?new b(!0):new b.Mock;const w=new F,E=new B;w.prepare(R);const A={sharedStrings:R.sharedStrings,styles:R.styles,date1904:R.properties.date1904,drawingsCount:0,media:R.media};A.drawings=R.drawings=[],A.commentRefs=R.commentRefs=[];let T=0;R.tables=[],R.worksheets.forEach(D=>{D.tables.forEach(U=>{T++,U.target=`table${T}.xml`,U.id=T,R.tables.push(U)}),E.prepare(D,A)})}async write(R,C){C=C||{};const{model:w}=this.workbook,E=new u.ZipWriter(C.zip);return E.pipe(R),this.prepareModel(w,C),await this.addContentTypes(E,w),await this.addOfficeRels(E,w),await this.addWorkbookRels(E,w),await this.addWorksheets(E,w),await this.addSharedStrings(E,w),await this.addDrawings(E,w),await this.addTables(E,w),await Promise.all([this.addThemes(E,w),this.addStyles(E,w)]),await this.addMedia(E,w),await Promise.all([this.addApp(E,w),this.addCore(E,w)]),await this.addWorkbook(E,w),this._finalize(E)}writeFile(R,C){const w=l.createWriteStream(R);return new Promise((E,A)=>{w.on("finish",()=>{E()}),w.on("error",T=>{A(T)}),this.write(w,C).then(()=>{w.end()}).catch(T=>{A(T)})})}async writeBuffer(R){const C=new p;return await this.write(C,R),C.read()}}H.RelType=e("./rel-type"),n.exports=H}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"../utils/browser-buffer-decode":16,"../utils/stream-buf":24,"../utils/utils":27,"../utils/xml-stream":28,"../utils/zip-stream":29,"./rel-type":31,"./xform/book/workbook-xform":38,"./xform/comment/comments-xform":40,"./xform/comment/vml-notes-xform":45,"./xform/core/app-xform":51,"./xform/core/content-types-xform":52,"./xform/core/core-xform":53,"./xform/core/relationships-xform":55,"./xform/drawing/drawing-xform":62,"./xform/sheet/worksheet-xform":115,"./xform/strings/shared-strings-xform":124,"./xform/style/styles-xform":135,"./xform/table/table-xform":143,"./xml/theme1":145,_process:467,buffer:220,fs:216,jszip:441,"readable-stream":491}],145:[function(e,n,a){n.exports=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>`},{}],146:[function(e,n,a){(function(o){(function(){Object.defineProperty(a,"__esModule",{value:!0}),a.CsvFormatterStream=void 0;const s=e("stream"),l=e("./formatter");class c extends s.Transform{constructor(u){super({writableObjectMode:u.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=u,this.rowFormatter=new l.RowFormatter(u),this.hasWrittenBOM=!u.writeBOM}transform(u){return this.rowFormatter.rowTransform=u,this}_transform(u,p,f){let h=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(u,(v,b)=>v?(h=!0,f(v)):(b&&b.forEach(g=>{this.push(o.from(g,"utf8"))}),h=!0,f()))}catch(v){if(h)throw v;f(v)}}_flush(u){this.rowFormatter.finish((p,f)=>p?u(p):(f&&f.forEach(h=>{this.push(o.from(h,"utf8"))}),u()))}}a.CsvFormatterStream=c}).call(this)}).call(this,e("buffer").Buffer)},{"./formatter":150,buffer:220,stream:505}],147:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.FormatterOptions=void 0,a.FormatterOptions=class{constructor(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var s;this.objectMode=!0,this.delimiter=",",this.rowDelimiter=`
`,this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,o||{}),(o==null?void 0:o.quoteHeaders)===void 0&&(this.quoteHeaders=this.quoteColumns),(o==null?void 0:o.quote)===!0?this.quote='"':(o==null?void 0:o.quote)===!1&&(this.quote=""),typeof(o==null?void 0:o.escape)!="string"&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&((s=o.writeHeaders)===null||s===void 0||s),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote=`${this.escape}${this.quote}`}}},{}],148:[function(e,n,a){var o=function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(a,"__esModule",{value:!0}),a.FieldFormatter=void 0;const s=o(e("lodash.isboolean")),l=o(e("lodash.isnil")),c=o(e("lodash.escaperegexp"));a.FieldFormatter=class{constructor(i){this._headers=null,this.formatterOptions=i,i.headers!==null&&(this.headers=i.headers),this.REPLACE_REGEXP=new RegExp(i.quote,"g");const u=`[${i.delimiter}${c.default(i.rowDelimiter)}|\r|
]`;this.ESCAPE_REGEXP=new RegExp(u)}set headers(i){this._headers=i}shouldQuote(i,u){const p=u?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return s.default(p)?p:Array.isArray(p)?p[i]:this._headers!==null&&p[this._headers[i]]}format(i,u,p){const f=(""+(l.default(i)?"":i)).replace(/\0/g,""),{formatterOptions:h}=this;return h.quote!==""&&f.indexOf(h.quote)!==-1?this.quoteField(f.replace(this.REPLACE_REGEXP,h.escapedQuote)):f.search(this.ESCAPE_REGEXP)!==-1||this.shouldQuote(u,p)?this.quoteField(f):f}quoteField(i){const{quote:u}=this.formatterOptions;return`${u}${i}${u}`}}},{"lodash.escaperegexp":442,"lodash.isboolean":444,"lodash.isnil":447}],149:[function(e,n,a){var o=function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(a,"__esModule",{value:!0}),a.RowFormatter=void 0;const s=o(e("lodash.isfunction")),l=o(e("lodash.isequal")),c=e("./FieldFormatter"),i=e("../types");class u{constructor(f){this.rowCount=0,this.formatterOptions=f,this.fieldFormatter=new c.FieldFormatter(f),this.headers=f.headers,this.shouldWriteHeaders=f.shouldWriteHeaders,this.hasWrittenHeaders=!1,this.headers!==null&&(this.fieldFormatter.headers=this.headers),f.transform&&(this.rowTransform=f.transform)}static isRowHashArray(f){return!!Array.isArray(f)&&Array.isArray(f[0])&&f[0].length===2}static isRowArray(f){return Array.isArray(f)&&!this.isRowHashArray(f)}static gatherHeaders(f){return u.isRowHashArray(f)?f.map(h=>h[0]):Array.isArray(f)?f:Object.keys(f)}static createTransform(f){return i.isSyncTransform(f)?(h,v)=>{let b=null;try{b=f(h)}catch(g){return v(g)}return v(null,b)}:(h,v)=>{f(h,v)}}set rowTransform(f){if(!s.default(f))throw new TypeError("The transform should be a function");this._rowTransform=u.createTransform(f)}format(f,h){this.callTransformer(f,(v,b)=>{if(v)return h(v);if(!f)return h(null);const g=[];if(b){const{shouldFormatColumns:x,headers:y}=this.checkHeaders(b);if(this.shouldWriteHeaders&&y&&!this.hasWrittenHeaders&&(g.push(this.formatColumns(y,!0)),this.hasWrittenHeaders=!0),x){const k=this.gatherColumns(b);g.push(this.formatColumns(k,!1))}}return h(null,g)})}finish(f){const h=[];if(this.formatterOptions.alwaysWriteHeaders&&this.rowCount===0){if(!this.headers)return f(new Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));h.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&h.push(this.formatterOptions.rowDelimiter),f(null,h)}checkHeaders(f){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};const h=u.gatherHeaders(f);return this.headers=h,this.fieldFormatter.headers=h,this.shouldWriteHeaders?{shouldFormatColumns:!l.default(h,f),headers:h}:{shouldFormatColumns:!0,headers:null}}gatherColumns(f){if(this.headers===null)throw new Error("Headers is currently null");return Array.isArray(f)?u.isRowHashArray(f)?this.headers.map((h,v)=>{const b=f[v];return b?b[1]:""}):u.isRowArray(f)&&!this.shouldWriteHeaders?f:this.headers.map((h,v)=>f[v]):this.headers.map(h=>f[h])}callTransformer(f,h){return this._rowTransform?this._rowTransform(f,h):h(null,f)}formatColumns(f,h){const v=f.map((g,x)=>this.fieldFormatter.format(g,x,h)).join(this.formatterOptions.delimiter),{rowCount:b}=this;return this.rowCount+=1,b?[this.formatterOptions.rowDelimiter,v].join(""):v}}a.RowFormatter=u},{"../types":152,"./FieldFormatter":148,"lodash.isequal":445,"lodash.isfunction":446}],150:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.FieldFormatter=a.RowFormatter=void 0;var o=e("./RowFormatter");Object.defineProperty(a,"RowFormatter",{enumerable:!0,get:function(){return o.RowFormatter}});var s=e("./FieldFormatter");Object.defineProperty(a,"FieldFormatter",{enumerable:!0,get:function(){return s.FieldFormatter}})},{"./FieldFormatter":148,"./RowFormatter":149}],151:[function(e,n,a){(function(o){(function(){var s=Object.create?function(x,y,k,N){N===void 0&&(N=k),Object.defineProperty(x,N,{enumerable:!0,get:function(){return y[k]}})}:function(x,y,k,N){N===void 0&&(N=k),x[N]=y[k]},l=Object.create?function(x,y){Object.defineProperty(x,"default",{enumerable:!0,value:y})}:function(x,y){x.default=y},c=function(x){if(x&&x.__esModule)return x;var y={};if(x!=null)for(var k in x)k!=="default"&&Object.prototype.hasOwnProperty.call(x,k)&&s(y,x,k);return l(y,x),y},i=function(x,y){for(var k in x)k==="default"||Object.prototype.hasOwnProperty.call(y,k)||s(y,x,k)};Object.defineProperty(a,"__esModule",{value:!0}),a.writeToPath=a.writeToString=a.writeToBuffer=a.writeToStream=a.write=a.format=a.FormatterOptions=a.CsvFormatterStream=void 0;const u=e("util"),p=e("stream"),f=c(e("fs")),h=e("./FormatterOptions"),v=e("./CsvFormatterStream");i(e("./types"),a);var b=e("./CsvFormatterStream");Object.defineProperty(a,"CsvFormatterStream",{enumerable:!0,get:function(){return b.CsvFormatterStream}});var g=e("./FormatterOptions");Object.defineProperty(a,"FormatterOptions",{enumerable:!0,get:function(){return g.FormatterOptions}}),a.format=x=>new v.CsvFormatterStream(new h.FormatterOptions(x)),a.write=(x,y)=>{const k=a.format(y),N=u.promisify((F,B)=>{k.write(F,void 0,B)});return x.reduce((F,B)=>F.then(()=>N(B)),Promise.resolve()).then(()=>k.end()).catch(F=>{k.emit("error",F)}),k},a.writeToStream=(x,y,k)=>a.write(y,k).pipe(x),a.writeToBuffer=function(x){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const k=[],N=new p.Writable({write(F,B,W){k.push(F),W()}});return new Promise((F,B)=>{N.on("error",B).on("finish",()=>F(o.concat(k))),a.write(x,y).pipe(N)})},a.writeToString=(x,y)=>a.writeToBuffer(x,y).then(k=>k.toString()),a.writeToPath=(x,y,k)=>{const N=f.createWriteStream(x,{encoding:"utf8"});return a.write(y,k).pipe(N)}}).call(this)}).call(this,e("buffer").Buffer)},{"./CsvFormatterStream":146,"./FormatterOptions":147,"./types":152,buffer:220,fs:216,stream:505,util:527}],152:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.isSyncTransform=void 0,a.isSyncTransform=o=>o.length===1},{}],153:[function(e,n,a){(function(o){(function(){Object.defineProperty(a,"__esModule",{value:!0}),a.CsvParserStream=void 0;const s=e("string_decoder"),l=e("stream"),c=e("./transforms"),i=e("./parser");class u extends l.Transform{constructor(f){super({objectMode:f.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=f,this.parser=new i.Parser(f),this.headerTransformer=new c.HeaderTransformer(f),this.decoder=new s.StringDecoder(f.encoding),this.rowTransformerValidator=new c.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(f){return this.rowTransformerValidator.rowTransform=f,this}validate(f){return this.rowTransformerValidator.rowValidator=f,this}emit(f){if(f==="end")return this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1;for(var h=arguments.length,v=new Array(h>1?h-1:0),b=1;b<h;b++)v[b-1]=arguments[b];return super.emit(f,...v)}_transform(f,h,v){if(this.hasHitRowLimit)return v();const b=u.wrapDoneCallback(v);try{const{lines:g}=this,x=g+this.decoder.write(f),y=this.parse(x,!0);return this.processRows(y,b)}catch(g){return b(g)}}_flush(f){const h=u.wrapDoneCallback(f);if(this.hasHitRowLimit)return h();try{const v=this.lines+this.decoder.end(),b=this.parse(v,!1);return this.processRows(b,h)}catch(v){return h(v)}}parse(f,h){if(!f)return[];const{line:v,rows:b}=this.parser.parse(f,h);return this.lines=v,b}processRows(f,h){const v=f.length,b=g=>{const x=N=>N?h(N):g%100!=0?b(g+1):void o(()=>b(g+1));if(this.checkAndEmitHeaders(),g>=v||this.hasHitRowLimit)return h();if(this.parsedLineCount+=1,this.shouldSkipLine)return x();const y=f[g];this.rowCount+=1,this.parsedRowCount+=1;const k=this.rowCount;return this.transformRow(y,(N,F)=>{if(N)return this.rowCount-=1,x(N);if(!F)return x(new Error("expected transform result"));if(F.isValid){if(F.row)return this.pushRow(F.row,x)}else this.emit("data-invalid",F.row,k,F.reason);return x()})};b(0)}transformRow(f,h){try{this.headerTransformer.transform(f,(v,b)=>v?h(v):b?b.isValid?b.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(b.row,h):this.skipRow(h):(this.rowCount-=1,this.parsedRowCount-=1,h(null,{row:null,isValid:!0})):this.shouldEmitRows?h(null,{isValid:!1,row:f}):this.skipRow(h):h(new Error("Expected result from header transform")))}catch(v){h(v)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(f){return this.rowCount-=1,f(null,{row:null,isValid:!0})}pushRow(f,h){try{this.parserOptions.objectMode?this.push(f):this.push(JSON.stringify(f)),h()}catch(v){h(v)}}static wrapDoneCallback(f){let h=!1;return function(v){if(v){if(h)throw v;return h=!0,void f(v)}for(var b=arguments.length,g=new Array(b>1?b-1:0),x=1;x<b;x++)g[x-1]=arguments[x];f(...g)}}}a.CsvParserStream=u}).call(this)}).call(this,e("timers").setImmediate)},{"./parser":165,"./transforms":168,stream:505,string_decoder:218,timers:523}],154:[function(e,n,a){var o=function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(a,"__esModule",{value:!0}),a.ParserOptions=void 0;const s=o(e("lodash.escaperegexp")),l=o(e("lodash.isnil"));a.ParserOptions=class{constructor(c){var i;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,c||{}),this.delimiter.length>1)throw new Error("delimiter option must be one character long");this.escapedDelimiter=s.default(this.delimiter),this.escapeChar=(i=this.escape)!==null&&i!==void 0?i:this.quote,this.supportsComments=!l.default(this.comment),this.NEXT_TOKEN_REGEXP=new RegExp(`([^\\s]|\\r\\n|\\n|\\r|${this.escapedDelimiter})`),this.maxRows>0&&(this.limitRows=!0)}}},{"lodash.escaperegexp":442,"lodash.isnil":447}],155:[function(e,n,a){var o=Object.create?function(b,g,x,y){y===void 0&&(y=x),Object.defineProperty(b,y,{enumerable:!0,get:function(){return g[x]}})}:function(b,g,x,y){y===void 0&&(y=x),b[y]=g[x]},s=Object.create?function(b,g){Object.defineProperty(b,"default",{enumerable:!0,value:g})}:function(b,g){b.default=g},l=function(b){if(b&&b.__esModule)return b;var g={};if(b!=null)for(var x in b)x!=="default"&&Object.prototype.hasOwnProperty.call(b,x)&&o(g,b,x);return s(g,b),g},c=function(b,g){for(var x in b)x==="default"||Object.prototype.hasOwnProperty.call(g,x)||o(g,b,x)};Object.defineProperty(a,"__esModule",{value:!0}),a.parseString=a.parseFile=a.parseStream=a.parse=a.ParserOptions=a.CsvParserStream=void 0;const i=l(e("fs")),u=e("stream"),p=e("./ParserOptions"),f=e("./CsvParserStream");c(e("./types"),a);var h=e("./CsvParserStream");Object.defineProperty(a,"CsvParserStream",{enumerable:!0,get:function(){return h.CsvParserStream}});var v=e("./ParserOptions");Object.defineProperty(a,"ParserOptions",{enumerable:!0,get:function(){return v.ParserOptions}}),a.parse=b=>new f.CsvParserStream(new p.ParserOptions(b)),a.parseStream=(b,g)=>b.pipe(new f.CsvParserStream(new p.ParserOptions(g))),a.parseFile=function(b){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return i.createReadStream(b).pipe(new f.CsvParserStream(new p.ParserOptions(g)))},a.parseString=(b,g)=>{const x=new u.Readable;return x.push(b),x.push(null),x.pipe(new f.CsvParserStream(new p.ParserOptions(g)))}},{"./CsvParserStream":153,"./ParserOptions":154,"./types":169,fs:216,stream:505}],156:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.Parser=void 0;const o=e("./Scanner"),s=e("./RowParser"),l=e("./Token");class c{constructor(u){this.parserOptions=u,this.rowParser=new s.RowParser(this.parserOptions)}static removeBOM(u){return u&&u.charCodeAt(0)===65279?u.slice(1):u}parse(u,p){const f=new o.Scanner({line:c.removeBOM(u),parserOptions:this.parserOptions,hasMoreData:p});return this.parserOptions.supportsComments?this.parseWithComments(f):this.parseWithoutComments(f)}parseWithoutComments(u){const p=[];let f=!0;for(;f;)f=this.parseRow(u,p);return{line:u.line,rows:p}}parseWithComments(u){const{parserOptions:p}=this,f=[];for(let h=u.nextCharacterToken;h!==null;h=u.nextCharacterToken)if(l.Token.isTokenComment(h,p)){if(u.advancePastLine()===null)return{line:u.lineFromCursor,rows:f};if(!u.hasMoreCharacters)return{line:u.lineFromCursor,rows:f};u.truncateToCursor()}else if(!this.parseRow(u,f))break;return{line:u.line,rows:f}}parseRow(u,p){if(!u.nextNonSpaceToken)return!1;const f=this.rowParser.parse(u);return f!==null&&(this.parserOptions.ignoreEmpty&&s.RowParser.isEmptyRow(f)||p.push(f),!0)}}a.Parser=c},{"./RowParser":157,"./Scanner":158,"./Token":159}],157:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.RowParser=void 0;const o=e("./column"),s=e("./Token");a.RowParser=class{constructor(l){this.parserOptions=l,this.columnParser=new o.ColumnParser(l)}static isEmptyRow(l){return l.join("").replace(/\s+/g,"")===""}parse(l){const{parserOptions:c}=this,{hasMoreData:i}=l,u=l,p=[];let f=this.getStartToken(u,p);for(;f;){if(s.Token.isTokenRowDelimiter(f))return u.advancePastToken(f),!u.hasMoreCharacters&&s.Token.isTokenCarriageReturn(f,c)&&i?null:(u.truncateToCursor(),p);if(!this.shouldSkipColumnParse(u,f,p)){const h=this.columnParser.parse(u);if(h===null)return null;p.push(h)}f=u.nextNonSpaceToken}return i?null:(u.truncateToCursor(),p)}getStartToken(l,c){const i=l.nextNonSpaceToken;return i!==null&&s.Token.isTokenDelimiter(i,this.parserOptions)?(c.push(""),l.nextNonSpaceToken):i}shouldSkipColumnParse(l,c,i){const{parserOptions:u}=this;if(s.Token.isTokenDelimiter(c,u)){l.advancePastToken(c);const p=l.nextCharacterToken;if(!l.hasMoreCharacters||p!==null&&s.Token.isTokenRowDelimiter(p)||p!==null&&s.Token.isTokenDelimiter(p,u))return i.push(""),!0}return!1}}},{"./Token":159,"./column":164}],158:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.Scanner=void 0;const o=e("./Token"),s=/((?:\r\n)|\n|\r)/;a.Scanner=class{constructor(l){this.cursor=0,this.line=l.line,this.lineLength=this.line.length,this.parserOptions=l.parserOptions,this.hasMoreData=l.hasMoreData,this.cursor=l.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){const{lineFromCursor:l}=this,c=this.parserOptions.NEXT_TOKEN_REGEXP;if(l.search(c)===-1)return null;const i=c.exec(l);if(i==null)return null;const u=i[1],p=this.cursor+(i.index||0);return new o.Token({token:u,startCursor:p,endCursor:p+u.length-1})}get nextCharacterToken(){const{cursor:l,lineLength:c}=this;return c<=l?null:new o.Token({token:this.line[l],startCursor:l,endCursor:l})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){const l=s.exec(this.lineFromCursor);return l?(this.cursor+=(l.index||0)+l[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(l){return this.cursor=l,this}advanceToToken(l){return this.cursor=l.startCursor,this}advancePastToken(l){return this.cursor=l.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}}},{"./Token":159}],159:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.Token=void 0,a.Token=class{constructor(o){this.token=o.token,this.startCursor=o.startCursor,this.endCursor=o.endCursor}static isTokenRowDelimiter(o){const s=o.token;return s==="\r"||s===`
`||s===`\r
`}static isTokenCarriageReturn(o,s){return o.token===s.carriageReturn}static isTokenComment(o,s){return s.supportsComments&&!!o&&o.token===s.comment}static isTokenEscapeCharacter(o,s){return o.token===s.escapeChar}static isTokenQuote(o,s){return o.token===s.quote}static isTokenDelimiter(o,s){return o.token===s.delimiter}}},{}],160:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.ColumnFormatter=void 0,a.ColumnFormatter=class{constructor(o){o.trim?this.format=s=>s.trim():o.ltrim?this.format=s=>s.trimLeft():o.rtrim?this.format=s=>s.trimRight():this.format=s=>s}}},{}],161:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.ColumnParser=void 0;const o=e("./NonQuotedColumnParser"),s=e("./QuotedColumnParser"),l=e("../Token");a.ColumnParser=class{constructor(c){this.parserOptions=c,this.quotedColumnParser=new s.QuotedColumnParser(c),this.nonQuotedColumnParser=new o.NonQuotedColumnParser(c)}parse(c){const{nextNonSpaceToken:i}=c;return i!==null&&l.Token.isTokenQuote(i,this.parserOptions)?(c.advanceToToken(i),this.quotedColumnParser.parse(c)):this.nonQuotedColumnParser.parse(c)}}},{"../Token":159,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],162:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.NonQuotedColumnParser=void 0;const o=e("./ColumnFormatter"),s=e("../Token");a.NonQuotedColumnParser=class{constructor(l){this.parserOptions=l,this.columnFormatter=new o.ColumnFormatter(l)}parse(l){if(!l.hasMoreCharacters)return null;const{parserOptions:c}=this,i=[];let u=l.nextCharacterToken;for(;u&&!s.Token.isTokenDelimiter(u,c)&&!s.Token.isTokenRowDelimiter(u);u=l.nextCharacterToken)i.push(u.token),l.advancePastToken(u);return this.columnFormatter.format(i.join(""))}}},{"../Token":159,"./ColumnFormatter":160}],163:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.QuotedColumnParser=void 0;const o=e("./ColumnFormatter"),s=e("../Token");a.QuotedColumnParser=class{constructor(l){this.parserOptions=l,this.columnFormatter=new o.ColumnFormatter(l)}parse(l){if(!l.hasMoreCharacters)return null;const c=l.cursor,{foundClosingQuote:i,col:u}=this.gatherDataBetweenQuotes(l);if(!i){if(l.advanceTo(c),!l.hasMoreData)throw new Error(`Parse Error: missing closing: '${this.parserOptions.quote||""}' in line: at '${l.lineFromCursor.replace(/[\r\n]/g,"\\n'")}'`);return null}return this.checkForMalformedColumn(l),u}gatherDataBetweenQuotes(l){const{parserOptions:c}=this;let i=!1,u=!1;const p=[];let f=l.nextCharacterToken;for(;!u&&f!==null;f=l.nextCharacterToken){const h=s.Token.isTokenQuote(f,c);if(!i&&h)i=!0;else if(i)if(s.Token.isTokenEscapeCharacter(f,c)){l.advancePastToken(f);const v=l.nextCharacterToken;v!==null&&(s.Token.isTokenQuote(v,c)||s.Token.isTokenEscapeCharacter(v,c))?(p.push(v.token),f=v):h?u=!0:p.push(f.token)}else h?u=!0:p.push(f.token);l.advancePastToken(f)}return{col:this.columnFormatter.format(p.join("")),foundClosingQuote:u}}checkForMalformedColumn(l){const{parserOptions:c}=this,{nextNonSpaceToken:i}=l;if(i){const u=s.Token.isTokenDelimiter(i,c),p=s.Token.isTokenRowDelimiter(i);if(!u&&!p){const f=l.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw new Error(`Parse Error: expected: '${c.escapedDelimiter}' OR new line got: '${i.token}'. at '${f}`)}l.advanceToToken(i)}else l.hasMoreData||l.advancePastLine()}}},{"../Token":159,"./ColumnFormatter":160}],164:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.ColumnFormatter=a.QuotedColumnParser=a.NonQuotedColumnParser=a.ColumnParser=void 0;var o=e("./ColumnParser");Object.defineProperty(a,"ColumnParser",{enumerable:!0,get:function(){return o.ColumnParser}});var s=e("./NonQuotedColumnParser");Object.defineProperty(a,"NonQuotedColumnParser",{enumerable:!0,get:function(){return s.NonQuotedColumnParser}});var l=e("./QuotedColumnParser");Object.defineProperty(a,"QuotedColumnParser",{enumerable:!0,get:function(){return l.QuotedColumnParser}});var c=e("./ColumnFormatter");Object.defineProperty(a,"ColumnFormatter",{enumerable:!0,get:function(){return c.ColumnFormatter}})},{"./ColumnFormatter":160,"./ColumnParser":161,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],165:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.QuotedColumnParser=a.NonQuotedColumnParser=a.ColumnParser=a.Token=a.Scanner=a.RowParser=a.Parser=void 0;var o=e("./Parser");Object.defineProperty(a,"Parser",{enumerable:!0,get:function(){return o.Parser}});var s=e("./RowParser");Object.defineProperty(a,"RowParser",{enumerable:!0,get:function(){return s.RowParser}});var l=e("./Scanner");Object.defineProperty(a,"Scanner",{enumerable:!0,get:function(){return l.Scanner}});var c=e("./Token");Object.defineProperty(a,"Token",{enumerable:!0,get:function(){return c.Token}});var i=e("./column");Object.defineProperty(a,"ColumnParser",{enumerable:!0,get:function(){return i.ColumnParser}}),Object.defineProperty(a,"NonQuotedColumnParser",{enumerable:!0,get:function(){return i.NonQuotedColumnParser}}),Object.defineProperty(a,"QuotedColumnParser",{enumerable:!0,get:function(){return i.QuotedColumnParser}})},{"./Parser":156,"./RowParser":157,"./Scanner":158,"./Token":159,"./column":164}],166:[function(e,n,a){var o=function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(a,"__esModule",{value:!0}),a.HeaderTransformer=void 0;const s=o(e("lodash.isundefined")),l=o(e("lodash.isfunction")),c=o(e("lodash.uniq")),i=o(e("lodash.groupby"));a.HeaderTransformer=class{constructor(u){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=u,u.headers===!0?this.shouldUseFirstRow=!0:Array.isArray(u.headers)?this.setHeaders(u.headers):l.default(u.headers)&&(this.headersTransform=u.headers)}transform(u,p){return this.shouldMapRow(u)?p(null,this.processRow(u)):p(null,{row:null,isValid:!0})}shouldMapRow(u){const{parserOptions:p}=this;if(!this.headersTransform&&p.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw new Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(u)){if(this.headersTransform)this.setHeaders(this.headersTransform(u));else{if(!this.shouldUseFirstRow)return!0;this.setHeaders(u)}return!1}return!0}processRow(u){if(!this.headers)return{row:u,isValid:!0};const{parserOptions:p}=this;if(!p.discardUnmappedColumns&&u.length>this.headersLength){if(!p.strictColumnHandling)throw new Error(`Unexpected Error: column header mismatch expected: ${this.headersLength} columns got: ${u.length}`);return{row:u,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${u.length}`}}return p.strictColumnHandling&&u.length<this.headersLength?{row:u,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${u.length}`}:{row:this.mapHeaders(u),isValid:!0}}mapHeaders(u){const p={},{headers:f,headersLength:h}=this;for(let v=0;v<h;v+=1){const b=f[v];if(!s.default(b)){const g=u[v];s.default(g)?p[b]="":p[b]=g}}return p}setHeaders(u){var p;const f=u.filter(h=>!!h);if(c.default(f).length!==f.length){const h=i.default(f),v=Object.keys(h).filter(b=>h[b].length>1);throw new Error("Duplicate headers found "+JSON.stringify(v))}this.headers=u,this.receivedHeaders=!0,this.headersLength=((p=this.headers)===null||p===void 0?void 0:p.length)||0}}},{"lodash.groupby":443,"lodash.isfunction":446,"lodash.isundefined":448,"lodash.uniq":449}],167:[function(e,n,a){var o=function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(a,"__esModule",{value:!0}),a.RowTransformerValidator=void 0;const s=o(e("lodash.isfunction")),l=e("../types");class c{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(u){return l.isSyncTransform(u)?(p,f)=>{let h=null;try{h=u(p)}catch(v){return f(v)}return f(null,h)}:u}static createValidator(u){return l.isSyncValidate(u)?(p,f)=>{f(null,{row:p,isValid:u(p)})}:(p,f)=>{u(p,(h,v,b)=>h?f(h):f(null,v?{row:p,isValid:v,reason:b}:{row:p,isValid:!1,reason:b}))}}set rowTransform(u){if(!s.default(u))throw new TypeError("The transform should be a function");this._rowTransform=c.createTransform(u)}set rowValidator(u){if(!s.default(u))throw new TypeError("The validate should be a function");this._rowValidator=c.createValidator(u)}transformAndValidate(u,p){return this.callTransformer(u,(f,h)=>f?p(f):h?this.callValidator(h,(v,b)=>v?p(v):b&&!b.isValid?p(null,{row:h,isValid:!1,reason:b.reason}):p(null,{row:h,isValid:!0})):p(null,{row:null,isValid:!0}))}callTransformer(u,p){return this._rowTransform?this._rowTransform(u,p):p(null,u)}callValidator(u,p){return this._rowValidator?this._rowValidator(u,p):p(null,{row:u,isValid:!0})}}a.RowTransformerValidator=c},{"../types":169,"lodash.isfunction":446}],168:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.HeaderTransformer=a.RowTransformerValidator=void 0;var o=e("./RowTransformerValidator");Object.defineProperty(a,"RowTransformerValidator",{enumerable:!0,get:function(){return o.RowTransformerValidator}});var s=e("./HeaderTransformer");Object.defineProperty(a,"HeaderTransformer",{enumerable:!0,get:function(){return s.HeaderTransformer}})},{"./HeaderTransformer":166,"./RowTransformerValidator":167}],169:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.isSyncValidate=a.isSyncTransform=void 0,a.isSyncTransform=o=>o.length===1,a.isSyncValidate=o=>o.length===1},{}],170:[function(e,n,a){const o=a;o.bignum=e("bn.js"),o.define=e("./asn1/api").define,o.base=e("./asn1/base"),o.constants=e("./asn1/constants"),o.decoders=e("./asn1/decoders"),o.encoders=e("./asn1/encoders")},{"./asn1/api":171,"./asn1/base":173,"./asn1/constants":177,"./asn1/decoders":179,"./asn1/encoders":182,"bn.js":184}],171:[function(e,n,a){const o=e("./encoders"),s=e("./decoders"),l=e("inherits");function c(i,u){this.name=i,this.body=u,this.decoders={},this.encoders={}}a.define=function(i,u){return new c(i,u)},c.prototype._createNamed=function(i){const u=this.name;function p(f){this._initNamed(f,u)}return l(p,i),p.prototype._initNamed=function(f,h){i.call(this,f,h)},new p(this)},c.prototype._getDecoder=function(i){return i=i||"der",this.decoders.hasOwnProperty(i)||(this.decoders[i]=this._createNamed(s[i])),this.decoders[i]},c.prototype.decode=function(i,u,p){return this._getDecoder(u).decode(i,p)},c.prototype._getEncoder=function(i){return i=i||"der",this.encoders.hasOwnProperty(i)||(this.encoders[i]=this._createNamed(o[i])),this.encoders[i]},c.prototype.encode=function(i,u,p){return this._getEncoder(u).encode(i,p)}},{"./decoders":179,"./encoders":182,inherits:440}],172:[function(e,n,a){const o=e("inherits"),s=e("../base/reporter").Reporter,l=e("safer-buffer").Buffer;function c(u,p){s.call(this,p),l.isBuffer(u)?(this.base=u,this.offset=0,this.length=u.length):this.error("Input not Buffer")}function i(u,p){if(Array.isArray(u))this.length=0,this.value=u.map(function(f){return i.isEncoderBuffer(f)||(f=new i(f,p)),this.length+=f.length,f},this);else if(typeof u=="number"){if(!(0<=u&&u<=255))return p.error("non-byte EncoderBuffer value");this.value=u,this.length=1}else if(typeof u=="string")this.value=u,this.length=l.byteLength(u);else{if(!l.isBuffer(u))return p.error("Unsupported type: "+typeof u);this.value=u,this.length=u.length}}o(c,s),a.DecoderBuffer=c,c.isDecoderBuffer=function(u){return u instanceof c?!0:typeof u=="object"&&l.isBuffer(u.base)&&u.constructor.name==="DecoderBuffer"&&typeof u.offset=="number"&&typeof u.length=="number"&&typeof u.save=="function"&&typeof u.restore=="function"&&typeof u.isEmpty=="function"&&typeof u.readUInt8=="function"&&typeof u.skip=="function"&&typeof u.raw=="function"},c.prototype.save=function(){return{offset:this.offset,reporter:s.prototype.save.call(this)}},c.prototype.restore=function(u){const p=new c(this.base);return p.offset=u.offset,p.length=this.offset,this.offset=u.offset,s.prototype.restore.call(this,u.reporter),p},c.prototype.isEmpty=function(){return this.offset===this.length},c.prototype.readUInt8=function(u){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(u||"DecoderBuffer overrun")},c.prototype.skip=function(u,p){if(!(this.offset+u<=this.length))return this.error(p||"DecoderBuffer overrun");const f=new c(this.base);return f._reporterState=this._reporterState,f.offset=this.offset,f.length=this.offset+u,this.offset+=u,f},c.prototype.raw=function(u){return this.base.slice(u?u.offset:this.offset,this.length)},a.EncoderBuffer=i,i.isEncoderBuffer=function(u){return u instanceof i?!0:typeof u=="object"&&u.constructor.name==="EncoderBuffer"&&typeof u.length=="number"&&typeof u.join=="function"},i.prototype.join=function(u,p){return u||(u=l.alloc(this.length)),p||(p=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(f){f.join(u,p),p+=f.length}):(typeof this.value=="number"?u[p]=this.value:typeof this.value=="string"?u.write(this.value,p):l.isBuffer(this.value)&&this.value.copy(u,p),p+=this.length)),u}},{"../base/reporter":175,inherits:440,"safer-buffer":495}],173:[function(e,n,a){const o=a;o.Reporter=e("./reporter").Reporter,o.DecoderBuffer=e("./buffer").DecoderBuffer,o.EncoderBuffer=e("./buffer").EncoderBuffer,o.Node=e("./node")},{"./buffer":172,"./node":174,"./reporter":175}],174:[function(e,n,a){const o=e("../base/reporter").Reporter,s=e("../base/buffer").EncoderBuffer,l=e("../base/buffer").DecoderBuffer,c=e("minimalistic-assert"),i=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],u=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(i);function p(h,v,b){const g={};this._baseState=g,g.name=b,g.enc=h,g.parent=v||null,g.children=null,g.tag=null,g.args=null,g.reverseArgs=null,g.choice=null,g.optional=!1,g.any=!1,g.obj=!1,g.use=null,g.useDecoder=null,g.key=null,g.default=null,g.explicit=null,g.implicit=null,g.contains=null,g.parent||(g.children=[],this._wrap())}n.exports=p;const f=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];p.prototype.clone=function(){const h=this._baseState,v={};f.forEach(function(g){v[g]=h[g]});const b=new this.constructor(v.parent);return b._baseState=v,b},p.prototype._wrap=function(){const h=this._baseState;u.forEach(function(v){this[v]=function(){const b=new this.constructor(this);return h.children.push(b),b[v].apply(b,arguments)}},this)},p.prototype._init=function(h){const v=this._baseState;c(v.parent===null),h.call(this),v.children=v.children.filter(function(b){return b._baseState.parent===this},this),c.equal(v.children.length,1,"Root node can have only one child")},p.prototype._useArgs=function(h){const v=this._baseState,b=h.filter(function(g){return g instanceof this.constructor},this);h=h.filter(function(g){return!(g instanceof this.constructor)},this),b.length!==0&&(c(v.children===null),v.children=b,b.forEach(function(g){g._baseState.parent=this},this)),h.length!==0&&(c(v.args===null),v.args=h,v.reverseArgs=h.map(function(g){if(typeof g!="object"||g.constructor!==Object)return g;const x={};return Object.keys(g).forEach(function(y){y==(0|y)&&(y|=0);const k=g[y];x[k]=y}),x}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(h){p.prototype[h]=function(){const v=this._baseState;throw new Error(h+" not implemented for encoding: "+v.enc)}}),i.forEach(function(h){p.prototype[h]=function(){const v=this._baseState,b=Array.prototype.slice.call(arguments);return c(v.tag===null),v.tag=h,this._useArgs(b),this}}),p.prototype.use=function(h){c(h);const v=this._baseState;return c(v.use===null),v.use=h,this},p.prototype.optional=function(){return this._baseState.optional=!0,this},p.prototype.def=function(h){const v=this._baseState;return c(v.default===null),v.default=h,v.optional=!0,this},p.prototype.explicit=function(h){const v=this._baseState;return c(v.explicit===null&&v.implicit===null),v.explicit=h,this},p.prototype.implicit=function(h){const v=this._baseState;return c(v.explicit===null&&v.implicit===null),v.implicit=h,this},p.prototype.obj=function(){const h=this._baseState,v=Array.prototype.slice.call(arguments);return h.obj=!0,v.length!==0&&this._useArgs(v),this},p.prototype.key=function(h){const v=this._baseState;return c(v.key===null),v.key=h,this},p.prototype.any=function(){return this._baseState.any=!0,this},p.prototype.choice=function(h){const v=this._baseState;return c(v.choice===null),v.choice=h,this._useArgs(Object.keys(h).map(function(b){return h[b]})),this},p.prototype.contains=function(h){const v=this._baseState;return c(v.use===null),v.contains=h,this},p.prototype._decode=function(h,v){const b=this._baseState;if(b.parent===null)return h.wrapResult(b.children[0]._decode(h,v));let g,x=b.default,y=!0,k=null;if(b.key!==null&&(k=h.enterKey(b.key)),b.optional){let N=null;if(b.explicit!==null?N=b.explicit:b.implicit!==null?N=b.implicit:b.tag!==null&&(N=b.tag),N!==null||b.any){if(y=this._peekTag(h,N,b.any),h.isError(y))return y}else{const F=h.save();try{b.choice===null?this._decodeGeneric(b.tag,h,v):this._decodeChoice(h,v),y=!0}catch{y=!1}h.restore(F)}}if(b.obj&&y&&(g=h.enterObject()),y){if(b.explicit!==null){const F=this._decodeTag(h,b.explicit);if(h.isError(F))return F;h=F}const N=h.offset;if(b.use===null&&b.choice===null){let F;b.any&&(F=h.save());const B=this._decodeTag(h,b.implicit!==null?b.implicit:b.tag,b.any);if(h.isError(B))return B;b.any?x=h.raw(F):h=B}if(v&&v.track&&b.tag!==null&&v.track(h.path(),N,h.length,"tagged"),v&&v.track&&b.tag!==null&&v.track(h.path(),h.offset,h.length,"content"),b.any||(x=b.choice===null?this._decodeGeneric(b.tag,h,v):this._decodeChoice(h,v)),h.isError(x))return x;if(b.any||b.choice!==null||b.children===null||b.children.forEach(function(F){F._decode(h,v)}),b.contains&&(b.tag==="octstr"||b.tag==="bitstr")){const F=new l(x);x=this._getUse(b.contains,h._reporterState.obj)._decode(F,v)}}return b.obj&&y&&(x=h.leaveObject(g)),b.key===null||x===null&&y!==!0?k!==null&&h.exitKey(k):h.leaveKey(k,b.key,x),x},p.prototype._decodeGeneric=function(h,v,b){const g=this._baseState;return h==="seq"||h==="set"?null:h==="seqof"||h==="setof"?this._decodeList(v,h,g.args[0],b):/str$/.test(h)?this._decodeStr(v,h,b):h==="objid"&&g.args?this._decodeObjid(v,g.args[0],g.args[1],b):h==="objid"?this._decodeObjid(v,null,null,b):h==="gentime"||h==="utctime"?this._decodeTime(v,h,b):h==="null_"?this._decodeNull(v,b):h==="bool"?this._decodeBool(v,b):h==="objDesc"?this._decodeStr(v,h,b):h==="int"||h==="enum"?this._decodeInt(v,g.args&&g.args[0],b):g.use!==null?this._getUse(g.use,v._reporterState.obj)._decode(v,b):v.error("unknown tag: "+h)},p.prototype._getUse=function(h,v){const b=this._baseState;return b.useDecoder=this._use(h,v),c(b.useDecoder._baseState.parent===null),b.useDecoder=b.useDecoder._baseState.children[0],b.implicit!==b.useDecoder._baseState.implicit&&(b.useDecoder=b.useDecoder.clone(),b.useDecoder._baseState.implicit=b.implicit),b.useDecoder},p.prototype._decodeChoice=function(h,v){const b=this._baseState;let g=null,x=!1;return Object.keys(b.choice).some(function(y){const k=h.save(),N=b.choice[y];try{const F=N._decode(h,v);if(h.isError(F))return!1;g={type:y,value:F},x=!0}catch{return h.restore(k),!1}return!0},this),x?g:h.error("Choice not matched")},p.prototype._createEncoderBuffer=function(h){return new s(h,this.reporter)},p.prototype._encode=function(h,v,b){const g=this._baseState;if(g.default!==null&&g.default===h)return;const x=this._encodeValue(h,v,b);return x===void 0||this._skipDefault(x,v,b)?void 0:x},p.prototype._encodeValue=function(h,v,b){const g=this._baseState;if(g.parent===null)return g.children[0]._encode(h,v||new o);let x=null;if(this.reporter=v,g.optional&&h===void 0){if(g.default===null)return;h=g.default}let y=null,k=!1;if(g.any)x=this._createEncoderBuffer(h);else if(g.choice)x=this._encodeChoice(h,v);else if(g.contains)y=this._getUse(g.contains,b)._encode(h,v),k=!0;else if(g.children)y=g.children.map(function(N){if(N._baseState.tag==="null_")return N._encode(null,v,h);if(N._baseState.key===null)return v.error("Child should have a key");const F=v.enterKey(N._baseState.key);if(typeof h!="object")return v.error("Child expected, but input is not object");const B=N._encode(h[N._baseState.key],v,h);return v.leaveKey(F),B},this).filter(function(N){return N}),y=this._createEncoderBuffer(y);else if(g.tag==="seqof"||g.tag==="setof"){if(!g.args||g.args.length!==1)return v.error("Too many args for : "+g.tag);if(!Array.isArray(h))return v.error("seqof/setof, but data is not Array");const N=this.clone();N._baseState.implicit=null,y=this._createEncoderBuffer(h.map(function(F){const B=this._baseState;return this._getUse(B.args[0],h)._encode(F,v)},N))}else g.use!==null?x=this._getUse(g.use,b)._encode(h,v):(y=this._encodePrimitive(g.tag,h),k=!0);if(!g.any&&g.choice===null){const N=g.implicit!==null?g.implicit:g.tag,F=g.implicit===null?"universal":"context";N===null?g.use===null&&v.error("Tag could be omitted only for .use()"):g.use===null&&(x=this._encodeComposite(N,k,F,y))}return g.explicit!==null&&(x=this._encodeComposite(g.explicit,!1,"context",x)),x},p.prototype._encodeChoice=function(h,v){const b=this._baseState,g=b.choice[h.type];return g||c(!1,h.type+" not found in "+JSON.stringify(Object.keys(b.choice))),g._encode(h.value,v)},p.prototype._encodePrimitive=function(h,v){const b=this._baseState;if(/str$/.test(h))return this._encodeStr(v,h);if(h==="objid"&&b.args)return this._encodeObjid(v,b.reverseArgs[0],b.args[1]);if(h==="objid")return this._encodeObjid(v,null,null);if(h==="gentime"||h==="utctime")return this._encodeTime(v,h);if(h==="null_")return this._encodeNull();if(h==="int"||h==="enum")return this._encodeInt(v,b.args&&b.reverseArgs[0]);if(h==="bool")return this._encodeBool(v);if(h==="objDesc")return this._encodeStr(v,h);throw new Error("Unsupported tag: "+h)},p.prototype._isNumstr=function(h){return/^[0-9 ]*$/.test(h)},p.prototype._isPrintstr=function(h){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(h)}},{"../base/buffer":172,"../base/reporter":175,"minimalistic-assert":453}],175:[function(e,n,a){const o=e("inherits");function s(c){this._reporterState={obj:null,path:[],options:c||{},errors:[]}}function l(c,i){this.path=c,this.rethrow(i)}a.Reporter=s,s.prototype.isError=function(c){return c instanceof l},s.prototype.save=function(){const c=this._reporterState;return{obj:c.obj,pathLen:c.path.length}},s.prototype.restore=function(c){const i=this._reporterState;i.obj=c.obj,i.path=i.path.slice(0,c.pathLen)},s.prototype.enterKey=function(c){return this._reporterState.path.push(c)},s.prototype.exitKey=function(c){const i=this._reporterState;i.path=i.path.slice(0,c-1)},s.prototype.leaveKey=function(c,i,u){const p=this._reporterState;this.exitKey(c),p.obj!==null&&(p.obj[i]=u)},s.prototype.path=function(){return this._reporterState.path.join("/")},s.prototype.enterObject=function(){const c=this._reporterState,i=c.obj;return c.obj={},i},s.prototype.leaveObject=function(c){const i=this._reporterState,u=i.obj;return i.obj=c,u},s.prototype.error=function(c){let i;const u=this._reporterState,p=c instanceof l;if(i=p?c:new l(u.path.map(function(f){return"["+JSON.stringify(f)+"]"}).join(""),c.message||c,c.stack),!u.options.partial)throw i;return p||u.errors.push(i),i},s.prototype.wrapResult=function(c){const i=this._reporterState;return i.options.partial?{result:this.isError(c)?null:c,errors:i.errors}:c},o(l,Error),l.prototype.rethrow=function(c){if(this.message=c+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,l),!this.stack)try{throw new Error(this.message)}catch(i){this.stack=i.stack}return this}},{inherits:440}],176:[function(e,n,a){function o(s){const l={};return Object.keys(s).forEach(function(c){(0|c)==c&&(c|=0);const i=s[c];l[i]=c}),l}a.tagClass={0:"universal",1:"application",2:"context",3:"private"},a.tagClassByName=o(a.tagClass),a.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},a.tagByName=o(a.tag)},{}],177:[function(e,n,a){const o=a;o._reverse=function(s){const l={};return Object.keys(s).forEach(function(c){(0|c)==c&&(c|=0);const i=s[c];l[i]=c}),l},o.der=e("./der")},{"./der":176}],178:[function(e,n,a){const o=e("inherits"),s=e("bn.js"),l=e("../base/buffer").DecoderBuffer,c=e("../base/node"),i=e("../constants/der");function u(v){this.enc="der",this.name=v.name,this.entity=v,this.tree=new p,this.tree._init(v.body)}function p(v){c.call(this,"der",v)}function f(v,b){let g=v.readUInt8(b);if(v.isError(g))return g;const x=i.tagClass[g>>6],y=(32&g)==0;if((31&g)==31){let k=g;for(g=0;(128&k)==128;){if(k=v.readUInt8(b),v.isError(k))return k;g<<=7,g|=127&k}}else g&=31;return{cls:x,primitive:y,tag:g,tagStr:i.tag[g]}}function h(v,b,g){let x=v.readUInt8(g);if(v.isError(x))return x;if(!b&&x===128)return null;if((128&x)==0)return x;const y=127&x;if(y>4)return v.error("length octect is too long");x=0;for(let k=0;k<y;k++){x<<=8;const N=v.readUInt8(g);if(v.isError(N))return N;x|=N}return x}n.exports=u,u.prototype.decode=function(v,b){return l.isDecoderBuffer(v)||(v=new l(v,b)),this.tree._decode(v,b)},o(p,c),p.prototype._peekTag=function(v,b,g){if(v.isEmpty())return!1;const x=v.save(),y=f(v,'Failed to peek tag: "'+b+'"');return v.isError(y)?y:(v.restore(x),y.tag===b||y.tagStr===b||y.tagStr+"of"===b||g)},p.prototype._decodeTag=function(v,b,g){const x=f(v,'Failed to decode tag of "'+b+'"');if(v.isError(x))return x;let y=h(v,x.primitive,'Failed to get length of "'+b+'"');if(v.isError(y))return y;if(!g&&x.tag!==b&&x.tagStr!==b&&x.tagStr+"of"!==b)return v.error('Failed to match tag: "'+b+'"');if(x.primitive||y!==null)return v.skip(y,'Failed to match body of: "'+b+'"');const k=v.save(),N=this._skipUntilEnd(v,'Failed to skip indefinite length body: "'+this.tag+'"');return v.isError(N)?N:(y=v.offset-k.offset,v.restore(k),v.skip(y,'Failed to match body of: "'+b+'"'))},p.prototype._skipUntilEnd=function(v,b){for(;;){const g=f(v,b);if(v.isError(g))return g;const x=h(v,g.primitive,b);if(v.isError(x))return x;let y;if(y=g.primitive||x!==null?v.skip(x):this._skipUntilEnd(v,b),v.isError(y))return y;if(g.tagStr==="end")break}},p.prototype._decodeList=function(v,b,g,x){const y=[];for(;!v.isEmpty();){const k=this._peekTag(v,"end");if(v.isError(k))return k;const N=g.decode(v,"der",x);if(v.isError(N)&&k)break;y.push(N)}return y},p.prototype._decodeStr=function(v,b){if(b==="bitstr"){const g=v.readUInt8();return v.isError(g)?g:{unused:g,data:v.raw()}}if(b==="bmpstr"){const g=v.raw();if(g.length%2==1)return v.error("Decoding of string type: bmpstr length mismatch");let x="";for(let y=0;y<g.length/2;y++)x+=String.fromCharCode(g.readUInt16BE(2*y));return x}if(b==="numstr"){const g=v.raw().toString("ascii");return this._isNumstr(g)?g:v.error("Decoding of string type: numstr unsupported characters")}if(b==="octstr"||b==="objDesc")return v.raw();if(b==="printstr"){const g=v.raw().toString("ascii");return this._isPrintstr(g)?g:v.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(b)?v.raw().toString():v.error("Decoding of string type: "+b+" unsupported")},p.prototype._decodeObjid=function(v,b,g){let x;const y=[];let k=0,N=0;for(;!v.isEmpty();)N=v.readUInt8(),k<<=7,k|=127&N,(128&N)==0&&(y.push(k),k=0);128&N&&y.push(k);const F=y[0]/40|0,B=y[0]%40;if(x=g?y:[F,B].concat(y.slice(1)),b){let W=b[x.join(" ")];W===void 0&&(W=b[x.join(".")]),W!==void 0&&(x=W)}return x},p.prototype._decodeTime=function(v,b){const g=v.raw().toString();let x,y,k,N,F,B;if(b==="gentime")x=0|g.slice(0,4),y=0|g.slice(4,6),k=0|g.slice(6,8),N=0|g.slice(8,10),F=0|g.slice(10,12),B=0|g.slice(12,14);else{if(b!=="utctime")return v.error("Decoding "+b+" time is not supported yet");x=0|g.slice(0,2),y=0|g.slice(2,4),k=0|g.slice(4,6),N=0|g.slice(6,8),F=0|g.slice(8,10),B=0|g.slice(10,12),x=x<70?2e3+x:1900+x}return Date.UTC(x,y-1,k,N,F,B,0)},p.prototype._decodeNull=function(){return null},p.prototype._decodeBool=function(v){const b=v.readUInt8();return v.isError(b)?b:b!==0},p.prototype._decodeInt=function(v,b){const g=v.raw();let x=new s(g);return b&&(x=b[x.toString(10)]||x),x},p.prototype._use=function(v,b){return typeof v=="function"&&(v=v(b)),v._getDecoder("der").tree}},{"../base/buffer":172,"../base/node":174,"../constants/der":176,"bn.js":184,inherits:440}],179:[function(e,n,a){const o=a;o.der=e("./der"),o.pem=e("./pem")},{"./der":178,"./pem":180}],180:[function(e,n,a){const o=e("inherits"),s=e("safer-buffer").Buffer,l=e("./der");function c(i){l.call(this,i),this.enc="pem"}o(c,l),n.exports=c,c.prototype.decode=function(i,u){const p=i.toString().split(/[\r\n]+/g),f=u.label.toUpperCase(),h=/^-----(BEGIN|END) ([^-]+)-----$/;let v=-1,b=-1;for(let y=0;y<p.length;y++){const k=p[y].match(h);if(k!==null&&k[2]===f){if(v!==-1){if(k[1]!=="END")break;b=y;break}if(k[1]!=="BEGIN")break;v=y}}if(v===-1||b===-1)throw new Error("PEM section not found for: "+f);const g=p.slice(v+1,b).join("");g.replace(/[^a-z0-9+/=]+/gi,"");const x=s.from(g,"base64");return l.prototype.decode.call(this,x,u)}},{"./der":178,inherits:440,"safer-buffer":495}],181:[function(e,n,a){const o=e("inherits"),s=e("safer-buffer").Buffer,l=e("../base/node"),c=e("../constants/der");function i(f){this.enc="der",this.name=f.name,this.entity=f,this.tree=new u,this.tree._init(f.body)}function u(f){l.call(this,"der",f)}function p(f){return f<10?"0"+f:f}n.exports=i,i.prototype.encode=function(f,h){return this.tree._encode(f,h).join()},o(u,l),u.prototype._encodeComposite=function(f,h,v,b){const g=function(k,N,F,B){let W;if(k==="seqof"?k="seq":k==="setof"&&(k="set"),c.tagByName.hasOwnProperty(k))W=c.tagByName[k];else{if(typeof k!="number"||(0|k)!==k)return B.error("Unknown tag: "+k);W=k}return W>=31?B.error("Multi-octet tag encoding unsupported"):(N||(W|=32),W|=c.tagClassByName[F||"universal"]<<6,W)}(f,h,v,this.reporter);if(b.length<128){const k=s.alloc(2);return k[0]=g,k[1]=b.length,this._createEncoderBuffer([k,b])}let x=1;for(let k=b.length;k>=256;k>>=8)x++;const y=s.alloc(2+x);y[0]=g,y[1]=128|x;for(let k=1+x,N=b.length;N>0;k--,N>>=8)y[k]=255&N;return this._createEncoderBuffer([y,b])},u.prototype._encodeStr=function(f,h){if(h==="bitstr")return this._createEncoderBuffer([0|f.unused,f.data]);if(h==="bmpstr"){const v=s.alloc(2*f.length);for(let b=0;b<f.length;b++)v.writeUInt16BE(f.charCodeAt(b),2*b);return this._createEncoderBuffer(v)}return h==="numstr"?this._isNumstr(f)?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: numstr supports only digits and space"):h==="printstr"?this._isPrintstr(f)?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(h)||h==="objDesc"?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: "+h+" unsupported")},u.prototype._encodeObjid=function(f,h,v){if(typeof f=="string"){if(!h)return this.reporter.error("string objid given, but no values map found");if(!h.hasOwnProperty(f))return this.reporter.error("objid not found in values map");f=h[f].split(/[\s.]+/g);for(let y=0;y<f.length;y++)f[y]|=0}else if(Array.isArray(f)){f=f.slice();for(let y=0;y<f.length;y++)f[y]|=0}if(!Array.isArray(f))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(f));if(!v){if(f[1]>=40)return this.reporter.error("Second objid identifier OOB");f.splice(0,2,40*f[0]+f[1])}let b=0;for(let y=0;y<f.length;y++){let k=f[y];for(b++;k>=128;k>>=7)b++}const g=s.alloc(b);let x=g.length-1;for(let y=f.length-1;y>=0;y--){let k=f[y];for(g[x--]=127&k;(k>>=7)>0;)g[x--]=128|127&k}return this._createEncoderBuffer(g)},u.prototype._encodeTime=function(f,h){let v;const b=new Date(f);return h==="gentime"?v=[p(b.getUTCFullYear()),p(b.getUTCMonth()+1),p(b.getUTCDate()),p(b.getUTCHours()),p(b.getUTCMinutes()),p(b.getUTCSeconds()),"Z"].join(""):h==="utctime"?v=[p(b.getUTCFullYear()%100),p(b.getUTCMonth()+1),p(b.getUTCDate()),p(b.getUTCHours()),p(b.getUTCMinutes()),p(b.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+h+" time is not supported yet"),this._encodeStr(v,"octstr")},u.prototype._encodeNull=function(){return this._createEncoderBuffer("")},u.prototype._encodeInt=function(f,h){if(typeof f=="string"){if(!h)return this.reporter.error("String int or enum given, but no values map");if(!h.hasOwnProperty(f))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(f));f=h[f]}if(typeof f!="number"&&!s.isBuffer(f)){const g=f.toArray();!f.sign&&128&g[0]&&g.unshift(0),f=s.from(g)}if(s.isBuffer(f)){let g=f.length;f.length===0&&g++;const x=s.alloc(g);return f.copy(x),f.length===0&&(x[0]=0),this._createEncoderBuffer(x)}if(f<128)return this._createEncoderBuffer(f);if(f<256)return this._createEncoderBuffer([0,f]);let v=1;for(let g=f;g>=256;g>>=8)v++;const b=new Array(v);for(let g=b.length-1;g>=0;g--)b[g]=255&f,f>>=8;return 128&b[0]&&b.unshift(0),this._createEncoderBuffer(s.from(b))},u.prototype._encodeBool=function(f){return this._createEncoderBuffer(f?255:0)},u.prototype._use=function(f,h){return typeof f=="function"&&(f=f(h)),f._getEncoder("der").tree},u.prototype._skipDefault=function(f,h,v){const b=this._baseState;let g;if(b.default===null)return!1;const x=f.join();if(b.defaultBuffer===void 0&&(b.defaultBuffer=this._encodeValue(b.default,h,v).join()),x.length!==b.defaultBuffer.length)return!1;for(g=0;g<x.length;g++)if(x[g]!==b.defaultBuffer[g])return!1;return!0}},{"../base/node":174,"../constants/der":176,inherits:440,"safer-buffer":495}],182:[function(e,n,a){const o=a;o.der=e("./der"),o.pem=e("./pem")},{"./der":181,"./pem":183}],183:[function(e,n,a){const o=e("inherits"),s=e("./der");function l(c){s.call(this,c),this.enc="pem"}o(l,s),n.exports=l,l.prototype.encode=function(c,i){const u=s.prototype.encode.call(this,c).toString("base64"),p=["-----BEGIN "+i.label+"-----"];for(let f=0;f<u.length;f+=64)p.push(u.slice(f,f+64));return p.push("-----END "+i.label+"-----"),p.join(`
`)}},{"./der":181,inherits:440}],184:[function(e,n,a){(function(o,s){function l(O,R){if(!O)throw new Error(R||"Assertion failed")}function c(O,R){O.super_=R;var C=function(){};C.prototype=R.prototype,O.prototype=new C,O.prototype.constructor=O}function i(O,R,C){if(i.isBN(O))return O;this.negative=0,this.words=null,this.length=0,this.red=null,O!==null&&(R!=="le"&&R!=="be"||(C=R,R=10),this._init(O||0,R||10,C||"be"))}var u;typeof o=="object"?o.exports=i:(void 0).BN=i,i.BN=i,i.wordSize=26;try{u=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:e("buffer").Buffer}catch{}function p(O,R){var C=O.charCodeAt(R);return C>=65&&C<=70?C-55:C>=97&&C<=102?C-87:C-48&15}function f(O,R,C){var w=p(O,C);return C-1>=R&&(w|=p(O,C-1)<<4),w}function h(O,R,C,w){for(var E=0,A=Math.min(O.length,C),T=R;T<A;T++){var D=O.charCodeAt(T)-48;E*=w,E+=D>=49?D-49+10:D>=17?D-17+10:D}return E}i.isBN=function(O){return O instanceof i||O!==null&&typeof O=="object"&&O.constructor.wordSize===i.wordSize&&Array.isArray(O.words)},i.max=function(O,R){return O.cmp(R)>0?O:R},i.min=function(O,R){return O.cmp(R)<0?O:R},i.prototype._init=function(O,R,C){if(typeof O=="number")return this._initNumber(O,R,C);if(typeof O=="object")return this._initArray(O,R,C);R==="hex"&&(R=16),l(R===(0|R)&&R>=2&&R<=36);var w=0;(O=O.toString().replace(/\s+/g,""))[0]==="-"&&(w++,this.negative=1),w<O.length&&(R===16?this._parseHex(O,w,C):(this._parseBase(O,R,w),C==="le"&&this._initArray(this.toArray(),R,C)))},i.prototype._initNumber=function(O,R,C){O<0&&(this.negative=1,O=-O),O<67108864?(this.words=[67108863&O],this.length=1):O<4503599627370496?(this.words=[67108863&O,O/67108864&67108863],this.length=2):(l(O<9007199254740992),this.words=[67108863&O,O/67108864&67108863,1],this.length=3),C==="le"&&this._initArray(this.toArray(),R,C)},i.prototype._initArray=function(O,R,C){if(l(typeof O.length=="number"),O.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(O.length/3),this.words=new Array(this.length);for(var w=0;w<this.length;w++)this.words[w]=0;var E,A,T=0;if(C==="be")for(w=O.length-1,E=0;w>=0;w-=3)A=O[w]|O[w-1]<<8|O[w-2]<<16,this.words[E]|=A<<T&67108863,this.words[E+1]=A>>>26-T&67108863,(T+=24)>=26&&(T-=26,E++);else if(C==="le")for(w=0,E=0;w<O.length;w+=3)A=O[w]|O[w+1]<<8|O[w+2]<<16,this.words[E]|=A<<T&67108863,this.words[E+1]=A>>>26-T&67108863,(T+=24)>=26&&(T-=26,E++);return this.strip()},i.prototype._parseHex=function(O,R,C){this.length=Math.ceil((O.length-R)/6),this.words=new Array(this.length);for(var w=0;w<this.length;w++)this.words[w]=0;var E,A=0,T=0;if(C==="be")for(w=O.length-1;w>=R;w-=2)E=f(O,R,w)<<A,this.words[T]|=67108863&E,A>=18?(A-=18,T+=1,this.words[T]|=E>>>26):A+=8;else for(w=(O.length-R)%2==0?R+1:R;w<O.length;w+=2)E=f(O,R,w)<<A,this.words[T]|=67108863&E,A>=18?(A-=18,T+=1,this.words[T]|=E>>>26):A+=8;this.strip()},i.prototype._parseBase=function(O,R,C){this.words=[0],this.length=1;for(var w=0,E=1;E<=67108863;E*=R)w++;w--,E=E/R|0;for(var A=O.length-C,T=A%w,D=Math.min(A,A-T)+C,U=0,P=C;P<D;P+=w)U=h(O,P,P+w,R),this.imuln(E),this.words[0]+U<67108864?this.words[0]+=U:this._iaddn(U);if(T!==0){var K=1;for(U=h(O,P,O.length,R),P=0;P<T;P++)K*=R;this.imuln(K),this.words[0]+U<67108864?this.words[0]+=U:this._iaddn(U)}this.strip()},i.prototype.copy=function(O){O.words=new Array(this.length);for(var R=0;R<this.length;R++)O.words[R]=this.words[R];O.length=this.length,O.negative=this.negative,O.red=this.red},i.prototype.clone=function(){var O=new i(null);return this.copy(O),O},i.prototype._expand=function(O){for(;this.length<O;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var v=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],b=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],g=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function x(O,R,C){C.negative=R.negative^O.negative;var w=O.length+R.length|0;C.length=w,w=w-1|0;var E=0|O.words[0],A=0|R.words[0],T=E*A,D=67108863&T,U=T/67108864|0;C.words[0]=D;for(var P=1;P<w;P++){for(var K=U>>>26,Y=67108863&U,re=Math.min(P,R.length-1),z=Math.max(0,P-O.length+1);z<=re;z++){var ee=P-z|0;K+=(T=(E=0|O.words[ee])*(A=0|R.words[z])+Y)/67108864|0,Y=67108863&T}C.words[P]=0|Y,U=0|K}return U!==0?C.words[P]=0|U:C.length--,C.strip()}i.prototype.toString=function(O,R){var C;if(R=0|R||1,(O=O||10)===16||O==="hex"){C="";for(var w=0,E=0,A=0;A<this.length;A++){var T=this.words[A],D=(16777215&(T<<w|E)).toString(16);C=(E=T>>>24-w&16777215)!==0||A!==this.length-1?v[6-D.length]+D+C:D+C,(w+=2)>=26&&(w-=26,A--)}for(E!==0&&(C=E.toString(16)+C);C.length%R!=0;)C="0"+C;return this.negative!==0&&(C="-"+C),C}if(O===(0|O)&&O>=2&&O<=36){var U=b[O],P=g[O];C="";var K=this.clone();for(K.negative=0;!K.isZero();){var Y=K.modn(P).toString(O);C=(K=K.idivn(P)).isZero()?Y+C:v[U-Y.length]+Y+C}for(this.isZero()&&(C="0"+C);C.length%R!=0;)C="0"+C;return this.negative!==0&&(C="-"+C),C}l(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var O=this.words[0];return this.length===2?O+=67108864*this.words[1]:this.length===3&&this.words[2]===1?O+=4503599627370496+67108864*this.words[1]:this.length>2&&l(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-O:O},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(O,R){return l(u!==void 0),this.toArrayLike(u,O,R)},i.prototype.toArray=function(O,R){return this.toArrayLike(Array,O,R)},i.prototype.toArrayLike=function(O,R,C){var w=this.byteLength(),E=C||Math.max(1,w);l(w<=E,"byte array longer than desired length"),l(E>0,"Requested array length <= 0"),this.strip();var A,T,D=R==="le",U=new O(E),P=this.clone();if(D){for(T=0;!P.isZero();T++)A=P.andln(255),P.iushrn(8),U[T]=A;for(;T<E;T++)U[T]=0}else{for(T=0;T<E-w;T++)U[T]=0;for(T=0;!P.isZero();T++)A=P.andln(255),P.iushrn(8),U[E-T-1]=A}return U},Math.clz32?i.prototype._countBits=function(O){return 32-Math.clz32(O)}:i.prototype._countBits=function(O){var R=O,C=0;return R>=4096&&(C+=13,R>>>=13),R>=64&&(C+=7,R>>>=7),R>=8&&(C+=4,R>>>=4),R>=2&&(C+=2,R>>>=2),C+R},i.prototype._zeroBits=function(O){if(O===0)return 26;var R=O,C=0;return(8191&R)==0&&(C+=13,R>>>=13),(127&R)==0&&(C+=7,R>>>=7),(15&R)==0&&(C+=4,R>>>=4),(3&R)==0&&(C+=2,R>>>=2),(1&R)==0&&C++,C},i.prototype.bitLength=function(){var O=this.words[this.length-1],R=this._countBits(O);return 26*(this.length-1)+R},i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var O=0,R=0;R<this.length;R++){var C=this._zeroBits(this.words[R]);if(O+=C,C!==26)break}return O},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(O){return this.negative!==0?this.abs().inotn(O).iaddn(1):this.clone()},i.prototype.fromTwos=function(O){return this.testn(O-1)?this.notn(O).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(O){for(;this.length<O.length;)this.words[this.length++]=0;for(var R=0;R<O.length;R++)this.words[R]=this.words[R]|O.words[R];return this.strip()},i.prototype.ior=function(O){return l((this.negative|O.negative)==0),this.iuor(O)},i.prototype.or=function(O){return this.length>O.length?this.clone().ior(O):O.clone().ior(this)},i.prototype.uor=function(O){return this.length>O.length?this.clone().iuor(O):O.clone().iuor(this)},i.prototype.iuand=function(O){var R;R=this.length>O.length?O:this;for(var C=0;C<R.length;C++)this.words[C]=this.words[C]&O.words[C];return this.length=R.length,this.strip()},i.prototype.iand=function(O){return l((this.negative|O.negative)==0),this.iuand(O)},i.prototype.and=function(O){return this.length>O.length?this.clone().iand(O):O.clone().iand(this)},i.prototype.uand=function(O){return this.length>O.length?this.clone().iuand(O):O.clone().iuand(this)},i.prototype.iuxor=function(O){var R,C;this.length>O.length?(R=this,C=O):(R=O,C=this);for(var w=0;w<C.length;w++)this.words[w]=R.words[w]^C.words[w];if(this!==R)for(;w<R.length;w++)this.words[w]=R.words[w];return this.length=R.length,this.strip()},i.prototype.ixor=function(O){return l((this.negative|O.negative)==0),this.iuxor(O)},i.prototype.xor=function(O){return this.length>O.length?this.clone().ixor(O):O.clone().ixor(this)},i.prototype.uxor=function(O){return this.length>O.length?this.clone().iuxor(O):O.clone().iuxor(this)},i.prototype.inotn=function(O){l(typeof O=="number"&&O>=0);var R=0|Math.ceil(O/26),C=O%26;this._expand(R),C>0&&R--;for(var w=0;w<R;w++)this.words[w]=67108863&~this.words[w];return C>0&&(this.words[w]=~this.words[w]&67108863>>26-C),this.strip()},i.prototype.notn=function(O){return this.clone().inotn(O)},i.prototype.setn=function(O,R){l(typeof O=="number"&&O>=0);var C=O/26|0,w=O%26;return this._expand(C+1),this.words[C]=R?this.words[C]|1<<w:this.words[C]&~(1<<w),this.strip()},i.prototype.iadd=function(O){var R,C,w;if(this.negative!==0&&O.negative===0)return this.negative=0,R=this.isub(O),this.negative^=1,this._normSign();if(this.negative===0&&O.negative!==0)return O.negative=0,R=this.isub(O),O.negative=1,R._normSign();this.length>O.length?(C=this,w=O):(C=O,w=this);for(var E=0,A=0;A<w.length;A++)R=(0|C.words[A])+(0|w.words[A])+E,this.words[A]=67108863&R,E=R>>>26;for(;E!==0&&A<C.length;A++)R=(0|C.words[A])+E,this.words[A]=67108863&R,E=R>>>26;if(this.length=C.length,E!==0)this.words[this.length]=E,this.length++;else if(C!==this)for(;A<C.length;A++)this.words[A]=C.words[A];return this},i.prototype.add=function(O){var R;return O.negative!==0&&this.negative===0?(O.negative=0,R=this.sub(O),O.negative^=1,R):O.negative===0&&this.negative!==0?(this.negative=0,R=O.sub(this),this.negative=1,R):this.length>O.length?this.clone().iadd(O):O.clone().iadd(this)},i.prototype.isub=function(O){if(O.negative!==0){O.negative=0;var R=this.iadd(O);return O.negative=1,R._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(O),this.negative=1,this._normSign();var C,w,E=this.cmp(O);if(E===0)return this.negative=0,this.length=1,this.words[0]=0,this;E>0?(C=this,w=O):(C=O,w=this);for(var A=0,T=0;T<w.length;T++)A=(R=(0|C.words[T])-(0|w.words[T])+A)>>26,this.words[T]=67108863&R;for(;A!==0&&T<C.length;T++)A=(R=(0|C.words[T])+A)>>26,this.words[T]=67108863&R;if(A===0&&T<C.length&&C!==this)for(;T<C.length;T++)this.words[T]=C.words[T];return this.length=Math.max(this.length,T),C!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(O){return this.clone().isub(O)};var y=function(O,R,C){var w,E,A,T=O.words,D=R.words,U=C.words,P=0,K=0|T[0],Y=8191&K,re=K>>>13,z=0|T[1],ee=8191&z,L=z>>>13,M=0|T[2],Z=8191&M,se=M>>>13,ae=0|T[3],ne=8191&ae,Q=ae>>>13,fe=0|T[4],le=8191&fe,te=fe>>>13,ce=0|T[5],he=8191&ce,Ee=ce>>>13,ke=0|T[6],Ce=8191&ke,Fe=ke>>>13,Pe=0|T[7],Xe=8191&Pe,ct=Pe>>>13,st=0|T[8],lt=8191&st,tt=st>>>13,ot=0|T[9],De=8191&ot,ht=ot>>>13,rt=0|D[0],it=8191&rt,dt=rt>>>13,wt=0|D[1],gt=8191&wt,vt=wt>>>13,Ve=0|D[2],$e=8191&Ve,xt=Ve>>>13,nt=0|D[3],pt=8191&nt,Se=nt>>>13,je=0|D[4],Qe=8191&je,At=je>>>13,Vt=0|D[5],yt=8191&Vt,Ct=Vt>>>13,It=0|D[6],kt=8191&It,Ne=It>>>13,Le=0|D[7],at=8191&Le,ie=Le>>>13,we=0|D[8],de=8191&we,ge=we>>>13,ve=0|D[9],ye=8191&ve,Me=ve>>>13;C.negative=O.negative^R.negative,C.length=19;var Ue=(P+(w=Math.imul(Y,it))|0)+((8191&(E=(E=Math.imul(Y,dt))+Math.imul(re,it)|0))<<13)|0;P=((A=Math.imul(re,dt))+(E>>>13)|0)+(Ue>>>26)|0,Ue&=67108863,w=Math.imul(ee,it),E=(E=Math.imul(ee,dt))+Math.imul(L,it)|0,A=Math.imul(L,dt);var Re=(P+(w=w+Math.imul(Y,gt)|0)|0)+((8191&(E=(E=E+Math.imul(Y,vt)|0)+Math.imul(re,gt)|0))<<13)|0;P=((A=A+Math.imul(re,vt)|0)+(E>>>13)|0)+(Re>>>26)|0,Re&=67108863,w=Math.imul(Z,it),E=(E=Math.imul(Z,dt))+Math.imul(se,it)|0,A=Math.imul(se,dt),w=w+Math.imul(ee,gt)|0,E=(E=E+Math.imul(ee,vt)|0)+Math.imul(L,gt)|0,A=A+Math.imul(L,vt)|0;var Be=(P+(w=w+Math.imul(Y,$e)|0)|0)+((8191&(E=(E=E+Math.imul(Y,xt)|0)+Math.imul(re,$e)|0))<<13)|0;P=((A=A+Math.imul(re,xt)|0)+(E>>>13)|0)+(Be>>>26)|0,Be&=67108863,w=Math.imul(ne,it),E=(E=Math.imul(ne,dt))+Math.imul(Q,it)|0,A=Math.imul(Q,dt),w=w+Math.imul(Z,gt)|0,E=(E=E+Math.imul(Z,vt)|0)+Math.imul(se,gt)|0,A=A+Math.imul(se,vt)|0,w=w+Math.imul(ee,$e)|0,E=(E=E+Math.imul(ee,xt)|0)+Math.imul(L,$e)|0,A=A+Math.imul(L,xt)|0;var ze=(P+(w=w+Math.imul(Y,pt)|0)|0)+((8191&(E=(E=E+Math.imul(Y,Se)|0)+Math.imul(re,pt)|0))<<13)|0;P=((A=A+Math.imul(re,Se)|0)+(E>>>13)|0)+(ze>>>26)|0,ze&=67108863,w=Math.imul(le,it),E=(E=Math.imul(le,dt))+Math.imul(te,it)|0,A=Math.imul(te,dt),w=w+Math.imul(ne,gt)|0,E=(E=E+Math.imul(ne,vt)|0)+Math.imul(Q,gt)|0,A=A+Math.imul(Q,vt)|0,w=w+Math.imul(Z,$e)|0,E=(E=E+Math.imul(Z,xt)|0)+Math.imul(se,$e)|0,A=A+Math.imul(se,xt)|0,w=w+Math.imul(ee,pt)|0,E=(E=E+Math.imul(ee,Se)|0)+Math.imul(L,pt)|0,A=A+Math.imul(L,Se)|0;var be=(P+(w=w+Math.imul(Y,Qe)|0)|0)+((8191&(E=(E=E+Math.imul(Y,At)|0)+Math.imul(re,Qe)|0))<<13)|0;P=((A=A+Math.imul(re,At)|0)+(E>>>13)|0)+(be>>>26)|0,be&=67108863,w=Math.imul(he,it),E=(E=Math.imul(he,dt))+Math.imul(Ee,it)|0,A=Math.imul(Ee,dt),w=w+Math.imul(le,gt)|0,E=(E=E+Math.imul(le,vt)|0)+Math.imul(te,gt)|0,A=A+Math.imul(te,vt)|0,w=w+Math.imul(ne,$e)|0,E=(E=E+Math.imul(ne,xt)|0)+Math.imul(Q,$e)|0,A=A+Math.imul(Q,xt)|0,w=w+Math.imul(Z,pt)|0,E=(E=E+Math.imul(Z,Se)|0)+Math.imul(se,pt)|0,A=A+Math.imul(se,Se)|0,w=w+Math.imul(ee,Qe)|0,E=(E=E+Math.imul(ee,At)|0)+Math.imul(L,Qe)|0,A=A+Math.imul(L,At)|0;var Te=(P+(w=w+Math.imul(Y,yt)|0)|0)+((8191&(E=(E=E+Math.imul(Y,Ct)|0)+Math.imul(re,yt)|0))<<13)|0;P=((A=A+Math.imul(re,Ct)|0)+(E>>>13)|0)+(Te>>>26)|0,Te&=67108863,w=Math.imul(Ce,it),E=(E=Math.imul(Ce,dt))+Math.imul(Fe,it)|0,A=Math.imul(Fe,dt),w=w+Math.imul(he,gt)|0,E=(E=E+Math.imul(he,vt)|0)+Math.imul(Ee,gt)|0,A=A+Math.imul(Ee,vt)|0,w=w+Math.imul(le,$e)|0,E=(E=E+Math.imul(le,xt)|0)+Math.imul(te,$e)|0,A=A+Math.imul(te,xt)|0,w=w+Math.imul(ne,pt)|0,E=(E=E+Math.imul(ne,Se)|0)+Math.imul(Q,pt)|0,A=A+Math.imul(Q,Se)|0,w=w+Math.imul(Z,Qe)|0,E=(E=E+Math.imul(Z,At)|0)+Math.imul(se,Qe)|0,A=A+Math.imul(se,At)|0,w=w+Math.imul(ee,yt)|0,E=(E=E+Math.imul(ee,Ct)|0)+Math.imul(L,yt)|0,A=A+Math.imul(L,Ct)|0;var Ge=(P+(w=w+Math.imul(Y,kt)|0)|0)+((8191&(E=(E=E+Math.imul(Y,Ne)|0)+Math.imul(re,kt)|0))<<13)|0;P=((A=A+Math.imul(re,Ne)|0)+(E>>>13)|0)+(Ge>>>26)|0,Ge&=67108863,w=Math.imul(Xe,it),E=(E=Math.imul(Xe,dt))+Math.imul(ct,it)|0,A=Math.imul(ct,dt),w=w+Math.imul(Ce,gt)|0,E=(E=E+Math.imul(Ce,vt)|0)+Math.imul(Fe,gt)|0,A=A+Math.imul(Fe,vt)|0,w=w+Math.imul(he,$e)|0,E=(E=E+Math.imul(he,xt)|0)+Math.imul(Ee,$e)|0,A=A+Math.imul(Ee,xt)|0,w=w+Math.imul(le,pt)|0,E=(E=E+Math.imul(le,Se)|0)+Math.imul(te,pt)|0,A=A+Math.imul(te,Se)|0,w=w+Math.imul(ne,Qe)|0,E=(E=E+Math.imul(ne,At)|0)+Math.imul(Q,Qe)|0,A=A+Math.imul(Q,At)|0,w=w+Math.imul(Z,yt)|0,E=(E=E+Math.imul(Z,Ct)|0)+Math.imul(se,yt)|0,A=A+Math.imul(se,Ct)|0,w=w+Math.imul(ee,kt)|0,E=(E=E+Math.imul(ee,Ne)|0)+Math.imul(L,kt)|0,A=A+Math.imul(L,Ne)|0;var ue=(P+(w=w+Math.imul(Y,at)|0)|0)+((8191&(E=(E=E+Math.imul(Y,ie)|0)+Math.imul(re,at)|0))<<13)|0;P=((A=A+Math.imul(re,ie)|0)+(E>>>13)|0)+(ue>>>26)|0,ue&=67108863,w=Math.imul(lt,it),E=(E=Math.imul(lt,dt))+Math.imul(tt,it)|0,A=Math.imul(tt,dt),w=w+Math.imul(Xe,gt)|0,E=(E=E+Math.imul(Xe,vt)|0)+Math.imul(ct,gt)|0,A=A+Math.imul(ct,vt)|0,w=w+Math.imul(Ce,$e)|0,E=(E=E+Math.imul(Ce,xt)|0)+Math.imul(Fe,$e)|0,A=A+Math.imul(Fe,xt)|0,w=w+Math.imul(he,pt)|0,E=(E=E+Math.imul(he,Se)|0)+Math.imul(Ee,pt)|0,A=A+Math.imul(Ee,Se)|0,w=w+Math.imul(le,Qe)|0,E=(E=E+Math.imul(le,At)|0)+Math.imul(te,Qe)|0,A=A+Math.imul(te,At)|0,w=w+Math.imul(ne,yt)|0,E=(E=E+Math.imul(ne,Ct)|0)+Math.imul(Q,yt)|0,A=A+Math.imul(Q,Ct)|0,w=w+Math.imul(Z,kt)|0,E=(E=E+Math.imul(Z,Ne)|0)+Math.imul(se,kt)|0,A=A+Math.imul(se,Ne)|0,w=w+Math.imul(ee,at)|0,E=(E=E+Math.imul(ee,ie)|0)+Math.imul(L,at)|0,A=A+Math.imul(L,ie)|0;var Ae=(P+(w=w+Math.imul(Y,de)|0)|0)+((8191&(E=(E=E+Math.imul(Y,ge)|0)+Math.imul(re,de)|0))<<13)|0;P=((A=A+Math.imul(re,ge)|0)+(E>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,w=Math.imul(De,it),E=(E=Math.imul(De,dt))+Math.imul(ht,it)|0,A=Math.imul(ht,dt),w=w+Math.imul(lt,gt)|0,E=(E=E+Math.imul(lt,vt)|0)+Math.imul(tt,gt)|0,A=A+Math.imul(tt,vt)|0,w=w+Math.imul(Xe,$e)|0,E=(E=E+Math.imul(Xe,xt)|0)+Math.imul(ct,$e)|0,A=A+Math.imul(ct,xt)|0,w=w+Math.imul(Ce,pt)|0,E=(E=E+Math.imul(Ce,Se)|0)+Math.imul(Fe,pt)|0,A=A+Math.imul(Fe,Se)|0,w=w+Math.imul(he,Qe)|0,E=(E=E+Math.imul(he,At)|0)+Math.imul(Ee,Qe)|0,A=A+Math.imul(Ee,At)|0,w=w+Math.imul(le,yt)|0,E=(E=E+Math.imul(le,Ct)|0)+Math.imul(te,yt)|0,A=A+Math.imul(te,Ct)|0,w=w+Math.imul(ne,kt)|0,E=(E=E+Math.imul(ne,Ne)|0)+Math.imul(Q,kt)|0,A=A+Math.imul(Q,Ne)|0,w=w+Math.imul(Z,at)|0,E=(E=E+Math.imul(Z,ie)|0)+Math.imul(se,at)|0,A=A+Math.imul(se,ie)|0,w=w+Math.imul(ee,de)|0,E=(E=E+Math.imul(ee,ge)|0)+Math.imul(L,de)|0,A=A+Math.imul(L,ge)|0;var pe=(P+(w=w+Math.imul(Y,ye)|0)|0)+((8191&(E=(E=E+Math.imul(Y,Me)|0)+Math.imul(re,ye)|0))<<13)|0;P=((A=A+Math.imul(re,Me)|0)+(E>>>13)|0)+(pe>>>26)|0,pe&=67108863,w=Math.imul(De,gt),E=(E=Math.imul(De,vt))+Math.imul(ht,gt)|0,A=Math.imul(ht,vt),w=w+Math.imul(lt,$e)|0,E=(E=E+Math.imul(lt,xt)|0)+Math.imul(tt,$e)|0,A=A+Math.imul(tt,xt)|0,w=w+Math.imul(Xe,pt)|0,E=(E=E+Math.imul(Xe,Se)|0)+Math.imul(ct,pt)|0,A=A+Math.imul(ct,Se)|0,w=w+Math.imul(Ce,Qe)|0,E=(E=E+Math.imul(Ce,At)|0)+Math.imul(Fe,Qe)|0,A=A+Math.imul(Fe,At)|0,w=w+Math.imul(he,yt)|0,E=(E=E+Math.imul(he,Ct)|0)+Math.imul(Ee,yt)|0,A=A+Math.imul(Ee,Ct)|0,w=w+Math.imul(le,kt)|0,E=(E=E+Math.imul(le,Ne)|0)+Math.imul(te,kt)|0,A=A+Math.imul(te,Ne)|0,w=w+Math.imul(ne,at)|0,E=(E=E+Math.imul(ne,ie)|0)+Math.imul(Q,at)|0,A=A+Math.imul(Q,ie)|0,w=w+Math.imul(Z,de)|0,E=(E=E+Math.imul(Z,ge)|0)+Math.imul(se,de)|0,A=A+Math.imul(se,ge)|0;var xe=(P+(w=w+Math.imul(ee,ye)|0)|0)+((8191&(E=(E=E+Math.imul(ee,Me)|0)+Math.imul(L,ye)|0))<<13)|0;P=((A=A+Math.imul(L,Me)|0)+(E>>>13)|0)+(xe>>>26)|0,xe&=67108863,w=Math.imul(De,$e),E=(E=Math.imul(De,xt))+Math.imul(ht,$e)|0,A=Math.imul(ht,xt),w=w+Math.imul(lt,pt)|0,E=(E=E+Math.imul(lt,Se)|0)+Math.imul(tt,pt)|0,A=A+Math.imul(tt,Se)|0,w=w+Math.imul(Xe,Qe)|0,E=(E=E+Math.imul(Xe,At)|0)+Math.imul(ct,Qe)|0,A=A+Math.imul(ct,At)|0,w=w+Math.imul(Ce,yt)|0,E=(E=E+Math.imul(Ce,Ct)|0)+Math.imul(Fe,yt)|0,A=A+Math.imul(Fe,Ct)|0,w=w+Math.imul(he,kt)|0,E=(E=E+Math.imul(he,Ne)|0)+Math.imul(Ee,kt)|0,A=A+Math.imul(Ee,Ne)|0,w=w+Math.imul(le,at)|0,E=(E=E+Math.imul(le,ie)|0)+Math.imul(te,at)|0,A=A+Math.imul(te,ie)|0,w=w+Math.imul(ne,de)|0,E=(E=E+Math.imul(ne,ge)|0)+Math.imul(Q,de)|0,A=A+Math.imul(Q,ge)|0;var We=(P+(w=w+Math.imul(Z,ye)|0)|0)+((8191&(E=(E=E+Math.imul(Z,Me)|0)+Math.imul(se,ye)|0))<<13)|0;P=((A=A+Math.imul(se,Me)|0)+(E>>>13)|0)+(We>>>26)|0,We&=67108863,w=Math.imul(De,pt),E=(E=Math.imul(De,Se))+Math.imul(ht,pt)|0,A=Math.imul(ht,Se),w=w+Math.imul(lt,Qe)|0,E=(E=E+Math.imul(lt,At)|0)+Math.imul(tt,Qe)|0,A=A+Math.imul(tt,At)|0,w=w+Math.imul(Xe,yt)|0,E=(E=E+Math.imul(Xe,Ct)|0)+Math.imul(ct,yt)|0,A=A+Math.imul(ct,Ct)|0,w=w+Math.imul(Ce,kt)|0,E=(E=E+Math.imul(Ce,Ne)|0)+Math.imul(Fe,kt)|0,A=A+Math.imul(Fe,Ne)|0,w=w+Math.imul(he,at)|0,E=(E=E+Math.imul(he,ie)|0)+Math.imul(Ee,at)|0,A=A+Math.imul(Ee,ie)|0,w=w+Math.imul(le,de)|0,E=(E=E+Math.imul(le,ge)|0)+Math.imul(te,de)|0,A=A+Math.imul(te,ge)|0;var qe=(P+(w=w+Math.imul(ne,ye)|0)|0)+((8191&(E=(E=E+Math.imul(ne,Me)|0)+Math.imul(Q,ye)|0))<<13)|0;P=((A=A+Math.imul(Q,Me)|0)+(E>>>13)|0)+(qe>>>26)|0,qe&=67108863,w=Math.imul(De,Qe),E=(E=Math.imul(De,At))+Math.imul(ht,Qe)|0,A=Math.imul(ht,At),w=w+Math.imul(lt,yt)|0,E=(E=E+Math.imul(lt,Ct)|0)+Math.imul(tt,yt)|0,A=A+Math.imul(tt,Ct)|0,w=w+Math.imul(Xe,kt)|0,E=(E=E+Math.imul(Xe,Ne)|0)+Math.imul(ct,kt)|0,A=A+Math.imul(ct,Ne)|0,w=w+Math.imul(Ce,at)|0,E=(E=E+Math.imul(Ce,ie)|0)+Math.imul(Fe,at)|0,A=A+Math.imul(Fe,ie)|0,w=w+Math.imul(he,de)|0,E=(E=E+Math.imul(he,ge)|0)+Math.imul(Ee,de)|0,A=A+Math.imul(Ee,ge)|0;var ut=(P+(w=w+Math.imul(le,ye)|0)|0)+((8191&(E=(E=E+Math.imul(le,Me)|0)+Math.imul(te,ye)|0))<<13)|0;P=((A=A+Math.imul(te,Me)|0)+(E>>>13)|0)+(ut>>>26)|0,ut&=67108863,w=Math.imul(De,yt),E=(E=Math.imul(De,Ct))+Math.imul(ht,yt)|0,A=Math.imul(ht,Ct),w=w+Math.imul(lt,kt)|0,E=(E=E+Math.imul(lt,Ne)|0)+Math.imul(tt,kt)|0,A=A+Math.imul(tt,Ne)|0,w=w+Math.imul(Xe,at)|0,E=(E=E+Math.imul(Xe,ie)|0)+Math.imul(ct,at)|0,A=A+Math.imul(ct,ie)|0,w=w+Math.imul(Ce,de)|0,E=(E=E+Math.imul(Ce,ge)|0)+Math.imul(Fe,de)|0,A=A+Math.imul(Fe,ge)|0;var Mt=(P+(w=w+Math.imul(he,ye)|0)|0)+((8191&(E=(E=E+Math.imul(he,Me)|0)+Math.imul(Ee,ye)|0))<<13)|0;P=((A=A+Math.imul(Ee,Me)|0)+(E>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,w=Math.imul(De,kt),E=(E=Math.imul(De,Ne))+Math.imul(ht,kt)|0,A=Math.imul(ht,Ne),w=w+Math.imul(lt,at)|0,E=(E=E+Math.imul(lt,ie)|0)+Math.imul(tt,at)|0,A=A+Math.imul(tt,ie)|0,w=w+Math.imul(Xe,de)|0,E=(E=E+Math.imul(Xe,ge)|0)+Math.imul(ct,de)|0,A=A+Math.imul(ct,ge)|0;var Bt=(P+(w=w+Math.imul(Ce,ye)|0)|0)+((8191&(E=(E=E+Math.imul(Ce,Me)|0)+Math.imul(Fe,ye)|0))<<13)|0;P=((A=A+Math.imul(Fe,Me)|0)+(E>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,w=Math.imul(De,at),E=(E=Math.imul(De,ie))+Math.imul(ht,at)|0,A=Math.imul(ht,ie),w=w+Math.imul(lt,de)|0,E=(E=E+Math.imul(lt,ge)|0)+Math.imul(tt,de)|0,A=A+Math.imul(tt,ge)|0;var Ht=(P+(w=w+Math.imul(Xe,ye)|0)|0)+((8191&(E=(E=E+Math.imul(Xe,Me)|0)+Math.imul(ct,ye)|0))<<13)|0;P=((A=A+Math.imul(ct,Me)|0)+(E>>>13)|0)+(Ht>>>26)|0,Ht&=67108863,w=Math.imul(De,de),E=(E=Math.imul(De,ge))+Math.imul(ht,de)|0,A=Math.imul(ht,ge);var Lt=(P+(w=w+Math.imul(lt,ye)|0)|0)+((8191&(E=(E=E+Math.imul(lt,Me)|0)+Math.imul(tt,ye)|0))<<13)|0;P=((A=A+Math.imul(tt,Me)|0)+(E>>>13)|0)+(Lt>>>26)|0,Lt&=67108863;var er=(P+(w=Math.imul(De,ye))|0)+((8191&(E=(E=Math.imul(De,Me))+Math.imul(ht,ye)|0))<<13)|0;return P=((A=Math.imul(ht,Me))+(E>>>13)|0)+(er>>>26)|0,er&=67108863,U[0]=Ue,U[1]=Re,U[2]=Be,U[3]=ze,U[4]=be,U[5]=Te,U[6]=Ge,U[7]=ue,U[8]=Ae,U[9]=pe,U[10]=xe,U[11]=We,U[12]=qe,U[13]=ut,U[14]=Mt,U[15]=Bt,U[16]=Ht,U[17]=Lt,U[18]=er,P!==0&&(U[19]=P,C.length++),C};function k(O,R,C){return new N().mulp(O,R,C)}function N(O,R){this.x=O,this.y=R}Math.imul||(y=x),i.prototype.mulTo=function(O,R){var C=this.length+O.length;return this.length===10&&O.length===10?y(this,O,R):C<63?x(this,O,R):C<1024?function(w,E,A){A.negative=E.negative^w.negative,A.length=w.length+E.length;for(var T=0,D=0,U=0;U<A.length-1;U++){var P=D;D=0;for(var K=67108863&T,Y=Math.min(U,E.length-1),re=Math.max(0,U-w.length+1);re<=Y;re++){var z=U-re,ee=(0|w.words[z])*(0|E.words[re]),L=67108863&ee;K=67108863&(L=L+K|0),D+=(P=(P=P+(ee/67108864|0)|0)+(L>>>26)|0)>>>26,P&=67108863}A.words[U]=K,T=P,P=D}return T!==0?A.words[U]=T:A.length--,A.strip()}(this,O,R):k(this,O,R)},N.prototype.makeRBT=function(O){for(var R=new Array(O),C=i.prototype._countBits(O)-1,w=0;w<O;w++)R[w]=this.revBin(w,C,O);return R},N.prototype.revBin=function(O,R,C){if(O===0||O===C-1)return O;for(var w=0,E=0;E<R;E++)w|=(1&O)<<R-E-1,O>>=1;return w},N.prototype.permute=function(O,R,C,w,E,A){for(var T=0;T<A;T++)w[T]=R[O[T]],E[T]=C[O[T]]},N.prototype.transform=function(O,R,C,w,E,A){this.permute(A,O,R,C,w,E);for(var T=1;T<E;T<<=1)for(var D=T<<1,U=Math.cos(2*Math.PI/D),P=Math.sin(2*Math.PI/D),K=0;K<E;K+=D)for(var Y=U,re=P,z=0;z<T;z++){var ee=C[K+z],L=w[K+z],M=C[K+z+T],Z=w[K+z+T],se=Y*M-re*Z;Z=Y*Z+re*M,M=se,C[K+z]=ee+M,w[K+z]=L+Z,C[K+z+T]=ee-M,w[K+z+T]=L-Z,z!==D&&(se=U*Y-P*re,re=U*re+P*Y,Y=se)}},N.prototype.guessLen13b=function(O,R){var C=1|Math.max(R,O),w=1&C,E=0;for(C=C/2|0;C;C>>>=1)E++;return 1<<E+1+w},N.prototype.conjugate=function(O,R,C){if(!(C<=1))for(var w=0;w<C/2;w++){var E=O[w];O[w]=O[C-w-1],O[C-w-1]=E,E=R[w],R[w]=-R[C-w-1],R[C-w-1]=-E}},N.prototype.normalize13b=function(O,R){for(var C=0,w=0;w<R/2;w++){var E=8192*Math.round(O[2*w+1]/R)+Math.round(O[2*w]/R)+C;O[w]=67108863&E,C=E<67108864?0:E/67108864|0}return O},N.prototype.convert13b=function(O,R,C,w){for(var E=0,A=0;A<R;A++)E+=0|O[A],C[2*A]=8191&E,E>>>=13,C[2*A+1]=8191&E,E>>>=13;for(A=2*R;A<w;++A)C[A]=0;l(E===0),l((-8192&E)==0)},N.prototype.stub=function(O){for(var R=new Array(O),C=0;C<O;C++)R[C]=0;return R},N.prototype.mulp=function(O,R,C){var w=2*this.guessLen13b(O.length,R.length),E=this.makeRBT(w),A=this.stub(w),T=new Array(w),D=new Array(w),U=new Array(w),P=new Array(w),K=new Array(w),Y=new Array(w),re=C.words;re.length=w,this.convert13b(O.words,O.length,T,w),this.convert13b(R.words,R.length,P,w),this.transform(T,A,D,U,w,E),this.transform(P,A,K,Y,w,E);for(var z=0;z<w;z++){var ee=D[z]*K[z]-U[z]*Y[z];U[z]=D[z]*Y[z]+U[z]*K[z],D[z]=ee}return this.conjugate(D,U,w),this.transform(D,U,re,A,w,E),this.conjugate(re,A,w),this.normalize13b(re,w),C.negative=O.negative^R.negative,C.length=O.length+R.length,C.strip()},i.prototype.mul=function(O){var R=new i(null);return R.words=new Array(this.length+O.length),this.mulTo(O,R)},i.prototype.mulf=function(O){var R=new i(null);return R.words=new Array(this.length+O.length),k(this,O,R)},i.prototype.imul=function(O){return this.clone().mulTo(O,this)},i.prototype.imuln=function(O){l(typeof O=="number"),l(O<67108864);for(var R=0,C=0;C<this.length;C++){var w=(0|this.words[C])*O,E=(67108863&w)+(67108863&R);R>>=26,R+=w/67108864|0,R+=E>>>26,this.words[C]=67108863&E}return R!==0&&(this.words[C]=R,this.length++),this},i.prototype.muln=function(O){return this.clone().imuln(O)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(O){var R=function(A){for(var T=new Array(A.bitLength()),D=0;D<T.length;D++){var U=D/26|0,P=D%26;T[D]=(A.words[U]&1<<P)>>>P}return T}(O);if(R.length===0)return new i(1);for(var C=this,w=0;w<R.length&&R[w]===0;w++,C=C.sqr());if(++w<R.length)for(var E=C.sqr();w<R.length;w++,E=E.sqr())R[w]!==0&&(C=C.mul(E));return C},i.prototype.iushln=function(O){l(typeof O=="number"&&O>=0);var R,C=O%26,w=(O-C)/26,E=67108863>>>26-C<<26-C;if(C!==0){var A=0;for(R=0;R<this.length;R++){var T=this.words[R]&E,D=(0|this.words[R])-T<<C;this.words[R]=D|A,A=T>>>26-C}A&&(this.words[R]=A,this.length++)}if(w!==0){for(R=this.length-1;R>=0;R--)this.words[R+w]=this.words[R];for(R=0;R<w;R++)this.words[R]=0;this.length+=w}return this.strip()},i.prototype.ishln=function(O){return l(this.negative===0),this.iushln(O)},i.prototype.iushrn=function(O,R,C){var w;l(typeof O=="number"&&O>=0),w=R?(R-R%26)/26:0;var E=O%26,A=Math.min((O-E)/26,this.length),T=67108863^67108863>>>E<<E,D=C;if(w-=A,w=Math.max(0,w),D){for(var U=0;U<A;U++)D.words[U]=this.words[U];D.length=A}if(A!==0)if(this.length>A)for(this.length-=A,U=0;U<this.length;U++)this.words[U]=this.words[U+A];else this.words[0]=0,this.length=1;var P=0;for(U=this.length-1;U>=0&&(P!==0||U>=w);U--){var K=0|this.words[U];this.words[U]=P<<26-E|K>>>E,P=K&T}return D&&P!==0&&(D.words[D.length++]=P),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(O,R,C){return l(this.negative===0),this.iushrn(O,R,C)},i.prototype.shln=function(O){return this.clone().ishln(O)},i.prototype.ushln=function(O){return this.clone().iushln(O)},i.prototype.shrn=function(O){return this.clone().ishrn(O)},i.prototype.ushrn=function(O){return this.clone().iushrn(O)},i.prototype.testn=function(O){l(typeof O=="number"&&O>=0);var R=O%26,C=(O-R)/26,w=1<<R;return!(this.length<=C)&&!!(this.words[C]&w)},i.prototype.imaskn=function(O){l(typeof O=="number"&&O>=0);var R=O%26,C=(O-R)/26;if(l(this.negative===0,"imaskn works only with positive numbers"),this.length<=C)return this;if(R!==0&&C++,this.length=Math.min(C,this.length),R!==0){var w=67108863^67108863>>>R<<R;this.words[this.length-1]&=w}return this.strip()},i.prototype.maskn=function(O){return this.clone().imaskn(O)},i.prototype.iaddn=function(O){return l(typeof O=="number"),l(O<67108864),O<0?this.isubn(-O):this.negative!==0?this.length===1&&(0|this.words[0])<O?(this.words[0]=O-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(O),this.negative=1,this):this._iaddn(O)},i.prototype._iaddn=function(O){this.words[0]+=O;for(var R=0;R<this.length&&this.words[R]>=67108864;R++)this.words[R]-=67108864,R===this.length-1?this.words[R+1]=1:this.words[R+1]++;return this.length=Math.max(this.length,R+1),this},i.prototype.isubn=function(O){if(l(typeof O=="number"),l(O<67108864),O<0)return this.iaddn(-O);if(this.negative!==0)return this.negative=0,this.iaddn(O),this.negative=1,this;if(this.words[0]-=O,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var R=0;R<this.length&&this.words[R]<0;R++)this.words[R]+=67108864,this.words[R+1]-=1;return this.strip()},i.prototype.addn=function(O){return this.clone().iaddn(O)},i.prototype.subn=function(O){return this.clone().isubn(O)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(O,R,C){var w,E,A=O.length+C;this._expand(A);var T=0;for(w=0;w<O.length;w++){E=(0|this.words[w+C])+T;var D=(0|O.words[w])*R;T=((E-=67108863&D)>>26)-(D/67108864|0),this.words[w+C]=67108863&E}for(;w<this.length-C;w++)T=(E=(0|this.words[w+C])+T)>>26,this.words[w+C]=67108863&E;if(T===0)return this.strip();for(l(T===-1),T=0,w=0;w<this.length;w++)T=(E=-(0|this.words[w])+T)>>26,this.words[w]=67108863&E;return this.negative=1,this.strip()},i.prototype._wordDiv=function(O,R){var C=(this.length,O.length),w=this.clone(),E=O,A=0|E.words[E.length-1];(C=26-this._countBits(A))!==0&&(E=E.ushln(C),w.iushln(C),A=0|E.words[E.length-1]);var T,D=w.length-E.length;if(R!=="mod"){(T=new i(null)).length=D+1,T.words=new Array(T.length);for(var U=0;U<T.length;U++)T.words[U]=0}var P=w.clone()._ishlnsubmul(E,1,D);P.negative===0&&(w=P,T&&(T.words[D]=1));for(var K=D-1;K>=0;K--){var Y=67108864*(0|w.words[E.length+K])+(0|w.words[E.length+K-1]);for(Y=Math.min(Y/A|0,67108863),w._ishlnsubmul(E,Y,K);w.negative!==0;)Y--,w.negative=0,w._ishlnsubmul(E,1,K),w.isZero()||(w.negative^=1);T&&(T.words[K]=Y)}return T&&T.strip(),w.strip(),R!=="div"&&C!==0&&w.iushrn(C),{div:T||null,mod:w}},i.prototype.divmod=function(O,R,C){return l(!O.isZero()),this.isZero()?{div:new i(0),mod:new i(0)}:this.negative!==0&&O.negative===0?(A=this.neg().divmod(O,R),R!=="mod"&&(w=A.div.neg()),R!=="div"&&(E=A.mod.neg(),C&&E.negative!==0&&E.iadd(O)),{div:w,mod:E}):this.negative===0&&O.negative!==0?(A=this.divmod(O.neg(),R),R!=="mod"&&(w=A.div.neg()),{div:w,mod:A.mod}):(this.negative&O.negative)!=0?(A=this.neg().divmod(O.neg(),R),R!=="div"&&(E=A.mod.neg(),C&&E.negative!==0&&E.isub(O)),{div:A.div,mod:E}):O.length>this.length||this.cmp(O)<0?{div:new i(0),mod:this}:O.length===1?R==="div"?{div:this.divn(O.words[0]),mod:null}:R==="mod"?{div:null,mod:new i(this.modn(O.words[0]))}:{div:this.divn(O.words[0]),mod:new i(this.modn(O.words[0]))}:this._wordDiv(O,R);var w,E,A},i.prototype.div=function(O){return this.divmod(O,"div",!1).div},i.prototype.mod=function(O){return this.divmod(O,"mod",!1).mod},i.prototype.umod=function(O){return this.divmod(O,"mod",!0).mod},i.prototype.divRound=function(O){var R=this.divmod(O);if(R.mod.isZero())return R.div;var C=R.div.negative!==0?R.mod.isub(O):R.mod,w=O.ushrn(1),E=O.andln(1),A=C.cmp(w);return A<0||E===1&&A===0?R.div:R.div.negative!==0?R.div.isubn(1):R.div.iaddn(1)},i.prototype.modn=function(O){l(O<=67108863);for(var R=(1<<26)%O,C=0,w=this.length-1;w>=0;w--)C=(R*C+(0|this.words[w]))%O;return C},i.prototype.idivn=function(O){l(O<=67108863);for(var R=0,C=this.length-1;C>=0;C--){var w=(0|this.words[C])+67108864*R;this.words[C]=w/O|0,R=w%O}return this.strip()},i.prototype.divn=function(O){return this.clone().idivn(O)},i.prototype.egcd=function(O){l(O.negative===0),l(!O.isZero());var R=this,C=O.clone();R=R.negative!==0?R.umod(O):R.clone();for(var w=new i(1),E=new i(0),A=new i(0),T=new i(1),D=0;R.isEven()&&C.isEven();)R.iushrn(1),C.iushrn(1),++D;for(var U=C.clone(),P=R.clone();!R.isZero();){for(var K=0,Y=1;(R.words[0]&Y)==0&&K<26;++K,Y<<=1);if(K>0)for(R.iushrn(K);K-- >0;)(w.isOdd()||E.isOdd())&&(w.iadd(U),E.isub(P)),w.iushrn(1),E.iushrn(1);for(var re=0,z=1;(C.words[0]&z)==0&&re<26;++re,z<<=1);if(re>0)for(C.iushrn(re);re-- >0;)(A.isOdd()||T.isOdd())&&(A.iadd(U),T.isub(P)),A.iushrn(1),T.iushrn(1);R.cmp(C)>=0?(R.isub(C),w.isub(A),E.isub(T)):(C.isub(R),A.isub(w),T.isub(E))}return{a:A,b:T,gcd:C.iushln(D)}},i.prototype._invmp=function(O){l(O.negative===0),l(!O.isZero());var R=this,C=O.clone();R=R.negative!==0?R.umod(O):R.clone();for(var w,E=new i(1),A=new i(0),T=C.clone();R.cmpn(1)>0&&C.cmpn(1)>0;){for(var D=0,U=1;(R.words[0]&U)==0&&D<26;++D,U<<=1);if(D>0)for(R.iushrn(D);D-- >0;)E.isOdd()&&E.iadd(T),E.iushrn(1);for(var P=0,K=1;(C.words[0]&K)==0&&P<26;++P,K<<=1);if(P>0)for(C.iushrn(P);P-- >0;)A.isOdd()&&A.iadd(T),A.iushrn(1);R.cmp(C)>=0?(R.isub(C),E.isub(A)):(C.isub(R),A.isub(E))}return(w=R.cmpn(1)===0?E:A).cmpn(0)<0&&w.iadd(O),w},i.prototype.gcd=function(O){if(this.isZero())return O.abs();if(O.isZero())return this.abs();var R=this.clone(),C=O.clone();R.negative=0,C.negative=0;for(var w=0;R.isEven()&&C.isEven();w++)R.iushrn(1),C.iushrn(1);for(;;){for(;R.isEven();)R.iushrn(1);for(;C.isEven();)C.iushrn(1);var E=R.cmp(C);if(E<0){var A=R;R=C,C=A}else if(E===0||C.cmpn(1)===0)break;R.isub(C)}return C.iushln(w)},i.prototype.invm=function(O){return this.egcd(O).a.umod(O)},i.prototype.isEven=function(){return(1&this.words[0])==0},i.prototype.isOdd=function(){return(1&this.words[0])==1},i.prototype.andln=function(O){return this.words[0]&O},i.prototype.bincn=function(O){l(typeof O=="number");var R=O%26,C=(O-R)/26,w=1<<R;if(this.length<=C)return this._expand(C+1),this.words[C]|=w,this;for(var E=w,A=C;E!==0&&A<this.length;A++){var T=0|this.words[A];E=(T+=E)>>>26,T&=67108863,this.words[A]=T}return E!==0&&(this.words[A]=E,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(O){var R,C=O<0;if(this.negative!==0&&!C)return-1;if(this.negative===0&&C)return 1;if(this.strip(),this.length>1)R=1;else{C&&(O=-O),l(O<=67108863,"Number is too big");var w=0|this.words[0];R=w===O?0:w<O?-1:1}return this.negative!==0?0|-R:R},i.prototype.cmp=function(O){if(this.negative!==0&&O.negative===0)return-1;if(this.negative===0&&O.negative!==0)return 1;var R=this.ucmp(O);return this.negative!==0?0|-R:R},i.prototype.ucmp=function(O){if(this.length>O.length)return 1;if(this.length<O.length)return-1;for(var R=0,C=this.length-1;C>=0;C--){var w=0|this.words[C],E=0|O.words[C];if(w!==E){w<E?R=-1:w>E&&(R=1);break}}return R},i.prototype.gtn=function(O){return this.cmpn(O)===1},i.prototype.gt=function(O){return this.cmp(O)===1},i.prototype.gten=function(O){return this.cmpn(O)>=0},i.prototype.gte=function(O){return this.cmp(O)>=0},i.prototype.ltn=function(O){return this.cmpn(O)===-1},i.prototype.lt=function(O){return this.cmp(O)===-1},i.prototype.lten=function(O){return this.cmpn(O)<=0},i.prototype.lte=function(O){return this.cmp(O)<=0},i.prototype.eqn=function(O){return this.cmpn(O)===0},i.prototype.eq=function(O){return this.cmp(O)===0},i.red=function(O){return new I(O)},i.prototype.toRed=function(O){return l(!this.red,"Already a number in reduction context"),l(this.negative===0,"red works only with positives"),O.convertTo(this)._forceRed(O)},i.prototype.fromRed=function(){return l(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(O){return this.red=O,this},i.prototype.forceRed=function(O){return l(!this.red,"Already a number in reduction context"),this._forceRed(O)},i.prototype.redAdd=function(O){return l(this.red,"redAdd works only with red numbers"),this.red.add(this,O)},i.prototype.redIAdd=function(O){return l(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,O)},i.prototype.redSub=function(O){return l(this.red,"redSub works only with red numbers"),this.red.sub(this,O)},i.prototype.redISub=function(O){return l(this.red,"redISub works only with red numbers"),this.red.isub(this,O)},i.prototype.redShl=function(O){return l(this.red,"redShl works only with red numbers"),this.red.shl(this,O)},i.prototype.redMul=function(O){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,O),this.red.mul(this,O)},i.prototype.redIMul=function(O){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,O),this.red.imul(this,O)},i.prototype.redSqr=function(){return l(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return l(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return l(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return l(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return l(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(O){return l(this.red&&!O.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,O)};var F={k256:null,p224:null,p192:null,p25519:null};function B(O,R){this.name=O,this.p=new i(R,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function W(){B.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function V(){B.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function q(){B.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function X(){B.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function I(O){if(typeof O=="string"){var R=i._prime(O);this.m=R.p,this.prime=R}else l(O.gtn(1),"modulus must be greater than 1"),this.m=O,this.prime=null}function H(O){I.call(this,O),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}B.prototype._tmp=function(){var O=new i(null);return O.words=new Array(Math.ceil(this.n/13)),O},B.prototype.ireduce=function(O){var R,C=O;do this.split(C,this.tmp),R=(C=(C=this.imulK(C)).iadd(this.tmp)).bitLength();while(R>this.n);var w=R<this.n?-1:C.ucmp(this.p);return w===0?(C.words[0]=0,C.length=1):w>0?C.isub(this.p):C.strip!==void 0?C.strip():C._strip(),C},B.prototype.split=function(O,R){O.iushrn(this.n,0,R)},B.prototype.imulK=function(O){return O.imul(this.k)},c(W,B),W.prototype.split=function(O,R){for(var C=Math.min(O.length,9),w=0;w<C;w++)R.words[w]=O.words[w];if(R.length=C,O.length<=9)return O.words[0]=0,void(O.length=1);var E=O.words[9];for(R.words[R.length++]=4194303&E,w=10;w<O.length;w++){var A=0|O.words[w];O.words[w-10]=(4194303&A)<<4|E>>>22,E=A}E>>>=22,O.words[w-10]=E,E===0&&O.length>10?O.length-=10:O.length-=9},W.prototype.imulK=function(O){O.words[O.length]=0,O.words[O.length+1]=0,O.length+=2;for(var R=0,C=0;C<O.length;C++){var w=0|O.words[C];R+=977*w,O.words[C]=67108863&R,R=64*w+(R/67108864|0)}return O.words[O.length-1]===0&&(O.length--,O.words[O.length-1]===0&&O.length--),O},c(V,B),c(q,B),c(X,B),X.prototype.imulK=function(O){for(var R=0,C=0;C<O.length;C++){var w=19*(0|O.words[C])+R,E=67108863&w;w>>>=26,O.words[C]=E,R=w}return R!==0&&(O.words[O.length++]=R),O},i._prime=function(O){if(F[O])return F[O];var R;if(O==="k256")R=new W;else if(O==="p224")R=new V;else if(O==="p192")R=new q;else{if(O!=="p25519")throw new Error("Unknown prime "+O);R=new X}return F[O]=R,R},I.prototype._verify1=function(O){l(O.negative===0,"red works only with positives"),l(O.red,"red works only with red numbers")},I.prototype._verify2=function(O,R){l((O.negative|R.negative)==0,"red works only with positives"),l(O.red&&O.red===R.red,"red works only with red numbers")},I.prototype.imod=function(O){return this.prime?this.prime.ireduce(O)._forceRed(this):O.umod(this.m)._forceRed(this)},I.prototype.neg=function(O){return O.isZero()?O.clone():this.m.sub(O)._forceRed(this)},I.prototype.add=function(O,R){this._verify2(O,R);var C=O.add(R);return C.cmp(this.m)>=0&&C.isub(this.m),C._forceRed(this)},I.prototype.iadd=function(O,R){this._verify2(O,R);var C=O.iadd(R);return C.cmp(this.m)>=0&&C.isub(this.m),C},I.prototype.sub=function(O,R){this._verify2(O,R);var C=O.sub(R);return C.cmpn(0)<0&&C.iadd(this.m),C._forceRed(this)},I.prototype.isub=function(O,R){this._verify2(O,R);var C=O.isub(R);return C.cmpn(0)<0&&C.iadd(this.m),C},I.prototype.shl=function(O,R){return this._verify1(O),this.imod(O.ushln(R))},I.prototype.imul=function(O,R){return this._verify2(O,R),this.imod(O.imul(R))},I.prototype.mul=function(O,R){return this._verify2(O,R),this.imod(O.mul(R))},I.prototype.isqr=function(O){return this.imul(O,O.clone())},I.prototype.sqr=function(O){return this.mul(O,O)},I.prototype.sqrt=function(O){if(O.isZero())return O.clone();var R=this.m.andln(3);if(l(R%2==1),R===3){var C=this.m.add(new i(1)).iushrn(2);return this.pow(O,C)}for(var w=this.m.subn(1),E=0;!w.isZero()&&w.andln(1)===0;)E++,w.iushrn(1);l(!w.isZero());var A=new i(1).toRed(this),T=A.redNeg(),D=this.m.subn(1).iushrn(1),U=this.m.bitLength();for(U=new i(2*U*U).toRed(this);this.pow(U,D).cmp(T)!==0;)U.redIAdd(T);for(var P=this.pow(U,w),K=this.pow(O,w.addn(1).iushrn(1)),Y=this.pow(O,w),re=E;Y.cmp(A)!==0;){for(var z=Y,ee=0;z.cmp(A)!==0;ee++)z=z.redSqr();l(ee<re);var L=this.pow(P,new i(1).iushln(re-ee-1));K=K.redMul(L),P=L.redSqr(),Y=Y.redMul(P),re=ee}return K},I.prototype.invm=function(O){var R=O._invmp(this.m);return R.negative!==0?(R.negative=0,this.imod(R).redNeg()):this.imod(R)},I.prototype.pow=function(O,R){if(R.isZero())return new i(1).toRed(this);if(R.cmpn(1)===0)return O.clone();var C=new Array(16);C[0]=new i(1).toRed(this),C[1]=O;for(var w=2;w<C.length;w++)C[w]=this.mul(C[w-1],O);var E=C[0],A=0,T=0,D=R.bitLength()%26;for(D===0&&(D=26),w=R.length-1;w>=0;w--){for(var U=R.words[w],P=D-1;P>=0;P--){var K=U>>P&1;E!==C[0]&&(E=this.sqr(E)),K!==0||A!==0?(A<<=1,A|=K,(++T===4||w===0&&P===0)&&(E=this.mul(E,C[A]),T=0,A=0)):T=0}D=26}return E},I.prototype.convertTo=function(O){var R=O.umod(this.m);return R===O?R.clone():R},I.prototype.convertFrom=function(O){var R=O.clone();return R.red=null,R},i.mont=function(O){return new H(O)},c(H,I),H.prototype.convertTo=function(O){return this.imod(O.ushln(this.shift))},H.prototype.convertFrom=function(O){var R=this.imod(O.mul(this.rinv));return R.red=null,R},H.prototype.imul=function(O,R){if(O.isZero()||R.isZero())return O.words[0]=0,O.length=1,O;var C=O.imul(R),w=C.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),E=C.isub(w).iushrn(this.shift),A=E;return E.cmp(this.m)>=0?A=E.isub(this.m):E.cmpn(0)<0&&(A=E.iadd(this.m)),A._forceRed(this)},H.prototype.mul=function(O,R){if(O.isZero()||R.isZero())return new i(0)._forceRed(this);var C=O.mul(R),w=C.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),E=C.isub(w).iushrn(this.shift),A=E;return E.cmp(this.m)>=0?A=E.isub(this.m):E.cmpn(0)<0&&(A=E.iadd(this.m)),A._forceRed(this)},H.prototype.invm=function(O){return this.imod(O._invmp(this.m).mul(this.r2))._forceRed(this)}})(n===void 0||n)},{buffer:188}],185:[function(e,n,a){a.byteLength=function(h){var v=p(h),b=v[0],g=v[1];return 3*(b+g)/4-g},a.toByteArray=function(h){var v,b,g=p(h),x=g[0],y=g[1],k=new l(function(B,W,V){return 3*(W+V)/4-V}(0,x,y)),N=0,F=y>0?x-4:x;for(b=0;b<F;b+=4)v=s[h.charCodeAt(b)]<<18|s[h.charCodeAt(b+1)]<<12|s[h.charCodeAt(b+2)]<<6|s[h.charCodeAt(b+3)],k[N++]=v>>16&255,k[N++]=v>>8&255,k[N++]=255&v;return y===2&&(v=s[h.charCodeAt(b)]<<2|s[h.charCodeAt(b+1)]>>4,k[N++]=255&v),y===1&&(v=s[h.charCodeAt(b)]<<10|s[h.charCodeAt(b+1)]<<4|s[h.charCodeAt(b+2)]>>2,k[N++]=v>>8&255,k[N++]=255&v),k},a.fromByteArray=function(h){for(var v,b=h.length,g=b%3,x=[],y=0,k=b-g;y<k;y+=16383)x.push(f(h,y,y+16383>k?k:y+16383));return g===1?(v=h[b-1],x.push(o[v>>2]+o[v<<4&63]+"==")):g===2&&(v=(h[b-2]<<8)+h[b-1],x.push(o[v>>10]+o[v>>4&63]+o[v<<2&63]+"=")),x.join("")};for(var o=[],s=[],l=typeof Uint8Array<"u"?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,u=c.length;i<u;++i)o[i]=c[i],s[c.charCodeAt(i)]=i;function p(h){var v=h.length;if(v%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var b=h.indexOf("=");return b===-1&&(b=v),[b,b===v?0:4-b%4]}function f(h,v,b){for(var g,x,y=[],k=v;k<b;k+=3)g=(h[k]<<16&16711680)+(h[k+1]<<8&65280)+(255&h[k+2]),y.push(o[(x=g)>>18&63]+o[x>>12&63]+o[x>>6&63]+o[63&x]);return y.join("")}s[45]=62,s[95]=63},{}],186:[function(e,n,a){(function(o,s){function l(C,w){if(!C)throw new Error(w||"Assertion failed")}function c(C,w){C.super_=w;var E=function(){};E.prototype=w.prototype,C.prototype=new E,C.prototype.constructor=C}function i(C,w,E){if(i.isBN(C))return C;this.negative=0,this.words=null,this.length=0,this.red=null,C!==null&&(w!=="le"&&w!=="be"||(E=w,w=10),this._init(C||0,w||10,E||"be"))}var u;typeof o=="object"?o.exports=i:(void 0).BN=i,i.BN=i,i.wordSize=26;try{u=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:e("buffer").Buffer}catch{}function p(C,w){var E=C.charCodeAt(w);return E>=48&&E<=57?E-48:E>=65&&E<=70?E-55:E>=97&&E<=102?E-87:void l(!1,"Invalid character in "+C)}function f(C,w,E){var A=p(C,E);return E-1>=w&&(A|=p(C,E-1)<<4),A}function h(C,w,E,A){for(var T=0,D=0,U=Math.min(C.length,E),P=w;P<U;P++){var K=C.charCodeAt(P)-48;T*=A,D=K>=49?K-49+10:K>=17?K-17+10:K,l(K>=0&&D<A,"Invalid character"),T+=D}return T}function v(C,w){C.words=w.words,C.length=w.length,C.negative=w.negative,C.red=w.red}if(i.isBN=function(C){return C instanceof i||C!==null&&typeof C=="object"&&C.constructor.wordSize===i.wordSize&&Array.isArray(C.words)},i.max=function(C,w){return C.cmp(w)>0?C:w},i.min=function(C,w){return C.cmp(w)<0?C:w},i.prototype._init=function(C,w,E){if(typeof C=="number")return this._initNumber(C,w,E);if(typeof C=="object")return this._initArray(C,w,E);w==="hex"&&(w=16),l(w===(0|w)&&w>=2&&w<=36);var A=0;(C=C.toString().replace(/\s+/g,""))[0]==="-"&&(A++,this.negative=1),A<C.length&&(w===16?this._parseHex(C,A,E):(this._parseBase(C,w,A),E==="le"&&this._initArray(this.toArray(),w,E)))},i.prototype._initNumber=function(C,w,E){C<0&&(this.negative=1,C=-C),C<67108864?(this.words=[67108863&C],this.length=1):C<4503599627370496?(this.words=[67108863&C,C/67108864&67108863],this.length=2):(l(C<9007199254740992),this.words=[67108863&C,C/67108864&67108863,1],this.length=3),E==="le"&&this._initArray(this.toArray(),w,E)},i.prototype._initArray=function(C,w,E){if(l(typeof C.length=="number"),C.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(C.length/3),this.words=new Array(this.length);for(var A=0;A<this.length;A++)this.words[A]=0;var T,D,U=0;if(E==="be")for(A=C.length-1,T=0;A>=0;A-=3)D=C[A]|C[A-1]<<8|C[A-2]<<16,this.words[T]|=D<<U&67108863,this.words[T+1]=D>>>26-U&67108863,(U+=24)>=26&&(U-=26,T++);else if(E==="le")for(A=0,T=0;A<C.length;A+=3)D=C[A]|C[A+1]<<8|C[A+2]<<16,this.words[T]|=D<<U&67108863,this.words[T+1]=D>>>26-U&67108863,(U+=24)>=26&&(U-=26,T++);return this._strip()},i.prototype._parseHex=function(C,w,E){this.length=Math.ceil((C.length-w)/6),this.words=new Array(this.length);for(var A=0;A<this.length;A++)this.words[A]=0;var T,D=0,U=0;if(E==="be")for(A=C.length-1;A>=w;A-=2)T=f(C,w,A)<<D,this.words[U]|=67108863&T,D>=18?(D-=18,U+=1,this.words[U]|=T>>>26):D+=8;else for(A=(C.length-w)%2==0?w+1:w;A<C.length;A+=2)T=f(C,w,A)<<D,this.words[U]|=67108863&T,D>=18?(D-=18,U+=1,this.words[U]|=T>>>26):D+=8;this._strip()},i.prototype._parseBase=function(C,w,E){this.words=[0],this.length=1;for(var A=0,T=1;T<=67108863;T*=w)A++;A--,T=T/w|0;for(var D=C.length-E,U=D%A,P=Math.min(D,D-U)+E,K=0,Y=E;Y<P;Y+=A)K=h(C,Y,Y+A,w),this.imuln(T),this.words[0]+K<67108864?this.words[0]+=K:this._iaddn(K);if(U!==0){var re=1;for(K=h(C,Y,C.length,w),Y=0;Y<U;Y++)re*=w;this.imuln(re),this.words[0]+K<67108864?this.words[0]+=K:this._iaddn(K)}this._strip()},i.prototype.copy=function(C){C.words=new Array(this.length);for(var w=0;w<this.length;w++)C.words[w]=this.words[w];C.length=this.length,C.negative=this.negative,C.red=this.red},i.prototype._move=function(C){v(C,this)},i.prototype.clone=function(){var C=new i(null);return this.copy(C),C},i.prototype._expand=function(C){for(;this.length<C;)this.words[this.length++]=0;return this},i.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{i.prototype[Symbol.for("nodejs.util.inspect.custom")]=b}catch{i.prototype.inspect=b}else i.prototype.inspect=b;function b(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var g=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],x=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(C,w){var E;if(w=0|w||1,(C=C||10)===16||C==="hex"){E="";for(var A=0,T=0,D=0;D<this.length;D++){var U=this.words[D],P=(16777215&(U<<A|T)).toString(16);T=U>>>24-A&16777215,(A+=2)>=26&&(A-=26,D--),E=T!==0||D!==this.length-1?g[6-P.length]+P+E:P+E}for(T!==0&&(E=T.toString(16)+E);E.length%w!=0;)E="0"+E;return this.negative!==0&&(E="-"+E),E}if(C===(0|C)&&C>=2&&C<=36){var K=x[C],Y=y[C];E="";var re=this.clone();for(re.negative=0;!re.isZero();){var z=re.modrn(Y).toString(C);E=(re=re.idivn(Y)).isZero()?z+E:g[K-z.length]+z+E}for(this.isZero()&&(E="0"+E);E.length%w!=0;)E="0"+E;return this.negative!==0&&(E="-"+E),E}l(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var C=this.words[0];return this.length===2?C+=67108864*this.words[1]:this.length===3&&this.words[2]===1?C+=4503599627370496+67108864*this.words[1]:this.length>2&&l(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-C:C},i.prototype.toJSON=function(){return this.toString(16,2)},u&&(i.prototype.toBuffer=function(C,w){return this.toArrayLike(u,C,w)}),i.prototype.toArray=function(C,w){return this.toArrayLike(Array,C,w)};function k(C,w,E){E.negative=w.negative^C.negative;var A=C.length+w.length|0;E.length=A,A=A-1|0;var T=0|C.words[0],D=0|w.words[0],U=T*D,P=67108863&U,K=U/67108864|0;E.words[0]=P;for(var Y=1;Y<A;Y++){for(var re=K>>>26,z=67108863&K,ee=Math.min(Y,w.length-1),L=Math.max(0,Y-C.length+1);L<=ee;L++){var M=Y-L|0;re+=(U=(T=0|C.words[M])*(D=0|w.words[L])+z)/67108864|0,z=67108863&U}E.words[Y]=0|z,K=0|re}return K!==0?E.words[Y]=0|K:E.length--,E._strip()}i.prototype.toArrayLike=function(C,w,E){this._strip();var A=this.byteLength(),T=E||Math.max(1,A);l(A<=T,"byte array longer than desired length"),l(T>0,"Requested array length <= 0");var D=function(U,P){return U.allocUnsafe?U.allocUnsafe(P):new U(P)}(C,T);return this["_toArrayLike"+(w==="le"?"LE":"BE")](D,A),D},i.prototype._toArrayLikeLE=function(C,w){for(var E=0,A=0,T=0,D=0;T<this.length;T++){var U=this.words[T]<<D|A;C[E++]=255&U,E<C.length&&(C[E++]=U>>8&255),E<C.length&&(C[E++]=U>>16&255),D===6?(E<C.length&&(C[E++]=U>>24&255),A=0,D=0):(A=U>>>24,D+=2)}if(E<C.length)for(C[E++]=A;E<C.length;)C[E++]=0},i.prototype._toArrayLikeBE=function(C,w){for(var E=C.length-1,A=0,T=0,D=0;T<this.length;T++){var U=this.words[T]<<D|A;C[E--]=255&U,E>=0&&(C[E--]=U>>8&255),E>=0&&(C[E--]=U>>16&255),D===6?(E>=0&&(C[E--]=U>>24&255),A=0,D=0):(A=U>>>24,D+=2)}if(E>=0)for(C[E--]=A;E>=0;)C[E--]=0},Math.clz32?i.prototype._countBits=function(C){return 32-Math.clz32(C)}:i.prototype._countBits=function(C){var w=C,E=0;return w>=4096&&(E+=13,w>>>=13),w>=64&&(E+=7,w>>>=7),w>=8&&(E+=4,w>>>=4),w>=2&&(E+=2,w>>>=2),E+w},i.prototype._zeroBits=function(C){if(C===0)return 26;var w=C,E=0;return(8191&w)==0&&(E+=13,w>>>=13),(127&w)==0&&(E+=7,w>>>=7),(15&w)==0&&(E+=4,w>>>=4),(3&w)==0&&(E+=2,w>>>=2),(1&w)==0&&E++,E},i.prototype.bitLength=function(){var C=this.words[this.length-1],w=this._countBits(C);return 26*(this.length-1)+w},i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var C=0,w=0;w<this.length;w++){var E=this._zeroBits(this.words[w]);if(C+=E,E!==26)break}return C},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(C){return this.negative!==0?this.abs().inotn(C).iaddn(1):this.clone()},i.prototype.fromTwos=function(C){return this.testn(C-1)?this.notn(C).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(C){for(;this.length<C.length;)this.words[this.length++]=0;for(var w=0;w<C.length;w++)this.words[w]=this.words[w]|C.words[w];return this._strip()},i.prototype.ior=function(C){return l((this.negative|C.negative)==0),this.iuor(C)},i.prototype.or=function(C){return this.length>C.length?this.clone().ior(C):C.clone().ior(this)},i.prototype.uor=function(C){return this.length>C.length?this.clone().iuor(C):C.clone().iuor(this)},i.prototype.iuand=function(C){var w;w=this.length>C.length?C:this;for(var E=0;E<w.length;E++)this.words[E]=this.words[E]&C.words[E];return this.length=w.length,this._strip()},i.prototype.iand=function(C){return l((this.negative|C.negative)==0),this.iuand(C)},i.prototype.and=function(C){return this.length>C.length?this.clone().iand(C):C.clone().iand(this)},i.prototype.uand=function(C){return this.length>C.length?this.clone().iuand(C):C.clone().iuand(this)},i.prototype.iuxor=function(C){var w,E;this.length>C.length?(w=this,E=C):(w=C,E=this);for(var A=0;A<E.length;A++)this.words[A]=w.words[A]^E.words[A];if(this!==w)for(;A<w.length;A++)this.words[A]=w.words[A];return this.length=w.length,this._strip()},i.prototype.ixor=function(C){return l((this.negative|C.negative)==0),this.iuxor(C)},i.prototype.xor=function(C){return this.length>C.length?this.clone().ixor(C):C.clone().ixor(this)},i.prototype.uxor=function(C){return this.length>C.length?this.clone().iuxor(C):C.clone().iuxor(this)},i.prototype.inotn=function(C){l(typeof C=="number"&&C>=0);var w=0|Math.ceil(C/26),E=C%26;this._expand(w),E>0&&w--;for(var A=0;A<w;A++)this.words[A]=67108863&~this.words[A];return E>0&&(this.words[A]=~this.words[A]&67108863>>26-E),this._strip()},i.prototype.notn=function(C){return this.clone().inotn(C)},i.prototype.setn=function(C,w){l(typeof C=="number"&&C>=0);var E=C/26|0,A=C%26;return this._expand(E+1),this.words[E]=w?this.words[E]|1<<A:this.words[E]&~(1<<A),this._strip()},i.prototype.iadd=function(C){var w,E,A;if(this.negative!==0&&C.negative===0)return this.negative=0,w=this.isub(C),this.negative^=1,this._normSign();if(this.negative===0&&C.negative!==0)return C.negative=0,w=this.isub(C),C.negative=1,w._normSign();this.length>C.length?(E=this,A=C):(E=C,A=this);for(var T=0,D=0;D<A.length;D++)w=(0|E.words[D])+(0|A.words[D])+T,this.words[D]=67108863&w,T=w>>>26;for(;T!==0&&D<E.length;D++)w=(0|E.words[D])+T,this.words[D]=67108863&w,T=w>>>26;if(this.length=E.length,T!==0)this.words[this.length]=T,this.length++;else if(E!==this)for(;D<E.length;D++)this.words[D]=E.words[D];return this},i.prototype.add=function(C){var w;return C.negative!==0&&this.negative===0?(C.negative=0,w=this.sub(C),C.negative^=1,w):C.negative===0&&this.negative!==0?(this.negative=0,w=C.sub(this),this.negative=1,w):this.length>C.length?this.clone().iadd(C):C.clone().iadd(this)},i.prototype.isub=function(C){if(C.negative!==0){C.negative=0;var w=this.iadd(C);return C.negative=1,w._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(C),this.negative=1,this._normSign();var E,A,T=this.cmp(C);if(T===0)return this.negative=0,this.length=1,this.words[0]=0,this;T>0?(E=this,A=C):(E=C,A=this);for(var D=0,U=0;U<A.length;U++)D=(w=(0|E.words[U])-(0|A.words[U])+D)>>26,this.words[U]=67108863&w;for(;D!==0&&U<E.length;U++)D=(w=(0|E.words[U])+D)>>26,this.words[U]=67108863&w;if(D===0&&U<E.length&&E!==this)for(;U<E.length;U++)this.words[U]=E.words[U];return this.length=Math.max(this.length,U),E!==this&&(this.negative=1),this._strip()},i.prototype.sub=function(C){return this.clone().isub(C)};var N=function(C,w,E){var A,T,D,U=C.words,P=w.words,K=E.words,Y=0,re=0|U[0],z=8191&re,ee=re>>>13,L=0|U[1],M=8191&L,Z=L>>>13,se=0|U[2],ae=8191&se,ne=se>>>13,Q=0|U[3],fe=8191&Q,le=Q>>>13,te=0|U[4],ce=8191&te,he=te>>>13,Ee=0|U[5],ke=8191&Ee,Ce=Ee>>>13,Fe=0|U[6],Pe=8191&Fe,Xe=Fe>>>13,ct=0|U[7],st=8191&ct,lt=ct>>>13,tt=0|U[8],ot=8191&tt,De=tt>>>13,ht=0|U[9],rt=8191&ht,it=ht>>>13,dt=0|P[0],wt=8191&dt,gt=dt>>>13,vt=0|P[1],Ve=8191&vt,$e=vt>>>13,xt=0|P[2],nt=8191&xt,pt=xt>>>13,Se=0|P[3],je=8191&Se,Qe=Se>>>13,At=0|P[4],Vt=8191&At,yt=At>>>13,Ct=0|P[5],It=8191&Ct,kt=Ct>>>13,Ne=0|P[6],Le=8191&Ne,at=Ne>>>13,ie=0|P[7],we=8191&ie,de=ie>>>13,ge=0|P[8],ve=8191&ge,ye=ge>>>13,Me=0|P[9],Ue=8191&Me,Re=Me>>>13;E.negative=C.negative^w.negative,E.length=19;var Be=(Y+(A=Math.imul(z,wt))|0)+((8191&(T=(T=Math.imul(z,gt))+Math.imul(ee,wt)|0))<<13)|0;Y=((D=Math.imul(ee,gt))+(T>>>13)|0)+(Be>>>26)|0,Be&=67108863,A=Math.imul(M,wt),T=(T=Math.imul(M,gt))+Math.imul(Z,wt)|0,D=Math.imul(Z,gt);var ze=(Y+(A=A+Math.imul(z,Ve)|0)|0)+((8191&(T=(T=T+Math.imul(z,$e)|0)+Math.imul(ee,Ve)|0))<<13)|0;Y=((D=D+Math.imul(ee,$e)|0)+(T>>>13)|0)+(ze>>>26)|0,ze&=67108863,A=Math.imul(ae,wt),T=(T=Math.imul(ae,gt))+Math.imul(ne,wt)|0,D=Math.imul(ne,gt),A=A+Math.imul(M,Ve)|0,T=(T=T+Math.imul(M,$e)|0)+Math.imul(Z,Ve)|0,D=D+Math.imul(Z,$e)|0;var be=(Y+(A=A+Math.imul(z,nt)|0)|0)+((8191&(T=(T=T+Math.imul(z,pt)|0)+Math.imul(ee,nt)|0))<<13)|0;Y=((D=D+Math.imul(ee,pt)|0)+(T>>>13)|0)+(be>>>26)|0,be&=67108863,A=Math.imul(fe,wt),T=(T=Math.imul(fe,gt))+Math.imul(le,wt)|0,D=Math.imul(le,gt),A=A+Math.imul(ae,Ve)|0,T=(T=T+Math.imul(ae,$e)|0)+Math.imul(ne,Ve)|0,D=D+Math.imul(ne,$e)|0,A=A+Math.imul(M,nt)|0,T=(T=T+Math.imul(M,pt)|0)+Math.imul(Z,nt)|0,D=D+Math.imul(Z,pt)|0;var Te=(Y+(A=A+Math.imul(z,je)|0)|0)+((8191&(T=(T=T+Math.imul(z,Qe)|0)+Math.imul(ee,je)|0))<<13)|0;Y=((D=D+Math.imul(ee,Qe)|0)+(T>>>13)|0)+(Te>>>26)|0,Te&=67108863,A=Math.imul(ce,wt),T=(T=Math.imul(ce,gt))+Math.imul(he,wt)|0,D=Math.imul(he,gt),A=A+Math.imul(fe,Ve)|0,T=(T=T+Math.imul(fe,$e)|0)+Math.imul(le,Ve)|0,D=D+Math.imul(le,$e)|0,A=A+Math.imul(ae,nt)|0,T=(T=T+Math.imul(ae,pt)|0)+Math.imul(ne,nt)|0,D=D+Math.imul(ne,pt)|0,A=A+Math.imul(M,je)|0,T=(T=T+Math.imul(M,Qe)|0)+Math.imul(Z,je)|0,D=D+Math.imul(Z,Qe)|0;var Ge=(Y+(A=A+Math.imul(z,Vt)|0)|0)+((8191&(T=(T=T+Math.imul(z,yt)|0)+Math.imul(ee,Vt)|0))<<13)|0;Y=((D=D+Math.imul(ee,yt)|0)+(T>>>13)|0)+(Ge>>>26)|0,Ge&=67108863,A=Math.imul(ke,wt),T=(T=Math.imul(ke,gt))+Math.imul(Ce,wt)|0,D=Math.imul(Ce,gt),A=A+Math.imul(ce,Ve)|0,T=(T=T+Math.imul(ce,$e)|0)+Math.imul(he,Ve)|0,D=D+Math.imul(he,$e)|0,A=A+Math.imul(fe,nt)|0,T=(T=T+Math.imul(fe,pt)|0)+Math.imul(le,nt)|0,D=D+Math.imul(le,pt)|0,A=A+Math.imul(ae,je)|0,T=(T=T+Math.imul(ae,Qe)|0)+Math.imul(ne,je)|0,D=D+Math.imul(ne,Qe)|0,A=A+Math.imul(M,Vt)|0,T=(T=T+Math.imul(M,yt)|0)+Math.imul(Z,Vt)|0,D=D+Math.imul(Z,yt)|0;var ue=(Y+(A=A+Math.imul(z,It)|0)|0)+((8191&(T=(T=T+Math.imul(z,kt)|0)+Math.imul(ee,It)|0))<<13)|0;Y=((D=D+Math.imul(ee,kt)|0)+(T>>>13)|0)+(ue>>>26)|0,ue&=67108863,A=Math.imul(Pe,wt),T=(T=Math.imul(Pe,gt))+Math.imul(Xe,wt)|0,D=Math.imul(Xe,gt),A=A+Math.imul(ke,Ve)|0,T=(T=T+Math.imul(ke,$e)|0)+Math.imul(Ce,Ve)|0,D=D+Math.imul(Ce,$e)|0,A=A+Math.imul(ce,nt)|0,T=(T=T+Math.imul(ce,pt)|0)+Math.imul(he,nt)|0,D=D+Math.imul(he,pt)|0,A=A+Math.imul(fe,je)|0,T=(T=T+Math.imul(fe,Qe)|0)+Math.imul(le,je)|0,D=D+Math.imul(le,Qe)|0,A=A+Math.imul(ae,Vt)|0,T=(T=T+Math.imul(ae,yt)|0)+Math.imul(ne,Vt)|0,D=D+Math.imul(ne,yt)|0,A=A+Math.imul(M,It)|0,T=(T=T+Math.imul(M,kt)|0)+Math.imul(Z,It)|0,D=D+Math.imul(Z,kt)|0;var Ae=(Y+(A=A+Math.imul(z,Le)|0)|0)+((8191&(T=(T=T+Math.imul(z,at)|0)+Math.imul(ee,Le)|0))<<13)|0;Y=((D=D+Math.imul(ee,at)|0)+(T>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,A=Math.imul(st,wt),T=(T=Math.imul(st,gt))+Math.imul(lt,wt)|0,D=Math.imul(lt,gt),A=A+Math.imul(Pe,Ve)|0,T=(T=T+Math.imul(Pe,$e)|0)+Math.imul(Xe,Ve)|0,D=D+Math.imul(Xe,$e)|0,A=A+Math.imul(ke,nt)|0,T=(T=T+Math.imul(ke,pt)|0)+Math.imul(Ce,nt)|0,D=D+Math.imul(Ce,pt)|0,A=A+Math.imul(ce,je)|0,T=(T=T+Math.imul(ce,Qe)|0)+Math.imul(he,je)|0,D=D+Math.imul(he,Qe)|0,A=A+Math.imul(fe,Vt)|0,T=(T=T+Math.imul(fe,yt)|0)+Math.imul(le,Vt)|0,D=D+Math.imul(le,yt)|0,A=A+Math.imul(ae,It)|0,T=(T=T+Math.imul(ae,kt)|0)+Math.imul(ne,It)|0,D=D+Math.imul(ne,kt)|0,A=A+Math.imul(M,Le)|0,T=(T=T+Math.imul(M,at)|0)+Math.imul(Z,Le)|0,D=D+Math.imul(Z,at)|0;var pe=(Y+(A=A+Math.imul(z,we)|0)|0)+((8191&(T=(T=T+Math.imul(z,de)|0)+Math.imul(ee,we)|0))<<13)|0;Y=((D=D+Math.imul(ee,de)|0)+(T>>>13)|0)+(pe>>>26)|0,pe&=67108863,A=Math.imul(ot,wt),T=(T=Math.imul(ot,gt))+Math.imul(De,wt)|0,D=Math.imul(De,gt),A=A+Math.imul(st,Ve)|0,T=(T=T+Math.imul(st,$e)|0)+Math.imul(lt,Ve)|0,D=D+Math.imul(lt,$e)|0,A=A+Math.imul(Pe,nt)|0,T=(T=T+Math.imul(Pe,pt)|0)+Math.imul(Xe,nt)|0,D=D+Math.imul(Xe,pt)|0,A=A+Math.imul(ke,je)|0,T=(T=T+Math.imul(ke,Qe)|0)+Math.imul(Ce,je)|0,D=D+Math.imul(Ce,Qe)|0,A=A+Math.imul(ce,Vt)|0,T=(T=T+Math.imul(ce,yt)|0)+Math.imul(he,Vt)|0,D=D+Math.imul(he,yt)|0,A=A+Math.imul(fe,It)|0,T=(T=T+Math.imul(fe,kt)|0)+Math.imul(le,It)|0,D=D+Math.imul(le,kt)|0,A=A+Math.imul(ae,Le)|0,T=(T=T+Math.imul(ae,at)|0)+Math.imul(ne,Le)|0,D=D+Math.imul(ne,at)|0,A=A+Math.imul(M,we)|0,T=(T=T+Math.imul(M,de)|0)+Math.imul(Z,we)|0,D=D+Math.imul(Z,de)|0;var xe=(Y+(A=A+Math.imul(z,ve)|0)|0)+((8191&(T=(T=T+Math.imul(z,ye)|0)+Math.imul(ee,ve)|0))<<13)|0;Y=((D=D+Math.imul(ee,ye)|0)+(T>>>13)|0)+(xe>>>26)|0,xe&=67108863,A=Math.imul(rt,wt),T=(T=Math.imul(rt,gt))+Math.imul(it,wt)|0,D=Math.imul(it,gt),A=A+Math.imul(ot,Ve)|0,T=(T=T+Math.imul(ot,$e)|0)+Math.imul(De,Ve)|0,D=D+Math.imul(De,$e)|0,A=A+Math.imul(st,nt)|0,T=(T=T+Math.imul(st,pt)|0)+Math.imul(lt,nt)|0,D=D+Math.imul(lt,pt)|0,A=A+Math.imul(Pe,je)|0,T=(T=T+Math.imul(Pe,Qe)|0)+Math.imul(Xe,je)|0,D=D+Math.imul(Xe,Qe)|0,A=A+Math.imul(ke,Vt)|0,T=(T=T+Math.imul(ke,yt)|0)+Math.imul(Ce,Vt)|0,D=D+Math.imul(Ce,yt)|0,A=A+Math.imul(ce,It)|0,T=(T=T+Math.imul(ce,kt)|0)+Math.imul(he,It)|0,D=D+Math.imul(he,kt)|0,A=A+Math.imul(fe,Le)|0,T=(T=T+Math.imul(fe,at)|0)+Math.imul(le,Le)|0,D=D+Math.imul(le,at)|0,A=A+Math.imul(ae,we)|0,T=(T=T+Math.imul(ae,de)|0)+Math.imul(ne,we)|0,D=D+Math.imul(ne,de)|0,A=A+Math.imul(M,ve)|0,T=(T=T+Math.imul(M,ye)|0)+Math.imul(Z,ve)|0,D=D+Math.imul(Z,ye)|0;var We=(Y+(A=A+Math.imul(z,Ue)|0)|0)+((8191&(T=(T=T+Math.imul(z,Re)|0)+Math.imul(ee,Ue)|0))<<13)|0;Y=((D=D+Math.imul(ee,Re)|0)+(T>>>13)|0)+(We>>>26)|0,We&=67108863,A=Math.imul(rt,Ve),T=(T=Math.imul(rt,$e))+Math.imul(it,Ve)|0,D=Math.imul(it,$e),A=A+Math.imul(ot,nt)|0,T=(T=T+Math.imul(ot,pt)|0)+Math.imul(De,nt)|0,D=D+Math.imul(De,pt)|0,A=A+Math.imul(st,je)|0,T=(T=T+Math.imul(st,Qe)|0)+Math.imul(lt,je)|0,D=D+Math.imul(lt,Qe)|0,A=A+Math.imul(Pe,Vt)|0,T=(T=T+Math.imul(Pe,yt)|0)+Math.imul(Xe,Vt)|0,D=D+Math.imul(Xe,yt)|0,A=A+Math.imul(ke,It)|0,T=(T=T+Math.imul(ke,kt)|0)+Math.imul(Ce,It)|0,D=D+Math.imul(Ce,kt)|0,A=A+Math.imul(ce,Le)|0,T=(T=T+Math.imul(ce,at)|0)+Math.imul(he,Le)|0,D=D+Math.imul(he,at)|0,A=A+Math.imul(fe,we)|0,T=(T=T+Math.imul(fe,de)|0)+Math.imul(le,we)|0,D=D+Math.imul(le,de)|0,A=A+Math.imul(ae,ve)|0,T=(T=T+Math.imul(ae,ye)|0)+Math.imul(ne,ve)|0,D=D+Math.imul(ne,ye)|0;var qe=(Y+(A=A+Math.imul(M,Ue)|0)|0)+((8191&(T=(T=T+Math.imul(M,Re)|0)+Math.imul(Z,Ue)|0))<<13)|0;Y=((D=D+Math.imul(Z,Re)|0)+(T>>>13)|0)+(qe>>>26)|0,qe&=67108863,A=Math.imul(rt,nt),T=(T=Math.imul(rt,pt))+Math.imul(it,nt)|0,D=Math.imul(it,pt),A=A+Math.imul(ot,je)|0,T=(T=T+Math.imul(ot,Qe)|0)+Math.imul(De,je)|0,D=D+Math.imul(De,Qe)|0,A=A+Math.imul(st,Vt)|0,T=(T=T+Math.imul(st,yt)|0)+Math.imul(lt,Vt)|0,D=D+Math.imul(lt,yt)|0,A=A+Math.imul(Pe,It)|0,T=(T=T+Math.imul(Pe,kt)|0)+Math.imul(Xe,It)|0,D=D+Math.imul(Xe,kt)|0,A=A+Math.imul(ke,Le)|0,T=(T=T+Math.imul(ke,at)|0)+Math.imul(Ce,Le)|0,D=D+Math.imul(Ce,at)|0,A=A+Math.imul(ce,we)|0,T=(T=T+Math.imul(ce,de)|0)+Math.imul(he,we)|0,D=D+Math.imul(he,de)|0,A=A+Math.imul(fe,ve)|0,T=(T=T+Math.imul(fe,ye)|0)+Math.imul(le,ve)|0,D=D+Math.imul(le,ye)|0;var ut=(Y+(A=A+Math.imul(ae,Ue)|0)|0)+((8191&(T=(T=T+Math.imul(ae,Re)|0)+Math.imul(ne,Ue)|0))<<13)|0;Y=((D=D+Math.imul(ne,Re)|0)+(T>>>13)|0)+(ut>>>26)|0,ut&=67108863,A=Math.imul(rt,je),T=(T=Math.imul(rt,Qe))+Math.imul(it,je)|0,D=Math.imul(it,Qe),A=A+Math.imul(ot,Vt)|0,T=(T=T+Math.imul(ot,yt)|0)+Math.imul(De,Vt)|0,D=D+Math.imul(De,yt)|0,A=A+Math.imul(st,It)|0,T=(T=T+Math.imul(st,kt)|0)+Math.imul(lt,It)|0,D=D+Math.imul(lt,kt)|0,A=A+Math.imul(Pe,Le)|0,T=(T=T+Math.imul(Pe,at)|0)+Math.imul(Xe,Le)|0,D=D+Math.imul(Xe,at)|0,A=A+Math.imul(ke,we)|0,T=(T=T+Math.imul(ke,de)|0)+Math.imul(Ce,we)|0,D=D+Math.imul(Ce,de)|0,A=A+Math.imul(ce,ve)|0,T=(T=T+Math.imul(ce,ye)|0)+Math.imul(he,ve)|0,D=D+Math.imul(he,ye)|0;var Mt=(Y+(A=A+Math.imul(fe,Ue)|0)|0)+((8191&(T=(T=T+Math.imul(fe,Re)|0)+Math.imul(le,Ue)|0))<<13)|0;Y=((D=D+Math.imul(le,Re)|0)+(T>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,A=Math.imul(rt,Vt),T=(T=Math.imul(rt,yt))+Math.imul(it,Vt)|0,D=Math.imul(it,yt),A=A+Math.imul(ot,It)|0,T=(T=T+Math.imul(ot,kt)|0)+Math.imul(De,It)|0,D=D+Math.imul(De,kt)|0,A=A+Math.imul(st,Le)|0,T=(T=T+Math.imul(st,at)|0)+Math.imul(lt,Le)|0,D=D+Math.imul(lt,at)|0,A=A+Math.imul(Pe,we)|0,T=(T=T+Math.imul(Pe,de)|0)+Math.imul(Xe,we)|0,D=D+Math.imul(Xe,de)|0,A=A+Math.imul(ke,ve)|0,T=(T=T+Math.imul(ke,ye)|0)+Math.imul(Ce,ve)|0,D=D+Math.imul(Ce,ye)|0;var Bt=(Y+(A=A+Math.imul(ce,Ue)|0)|0)+((8191&(T=(T=T+Math.imul(ce,Re)|0)+Math.imul(he,Ue)|0))<<13)|0;Y=((D=D+Math.imul(he,Re)|0)+(T>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,A=Math.imul(rt,It),T=(T=Math.imul(rt,kt))+Math.imul(it,It)|0,D=Math.imul(it,kt),A=A+Math.imul(ot,Le)|0,T=(T=T+Math.imul(ot,at)|0)+Math.imul(De,Le)|0,D=D+Math.imul(De,at)|0,A=A+Math.imul(st,we)|0,T=(T=T+Math.imul(st,de)|0)+Math.imul(lt,we)|0,D=D+Math.imul(lt,de)|0,A=A+Math.imul(Pe,ve)|0,T=(T=T+Math.imul(Pe,ye)|0)+Math.imul(Xe,ve)|0,D=D+Math.imul(Xe,ye)|0;var Ht=(Y+(A=A+Math.imul(ke,Ue)|0)|0)+((8191&(T=(T=T+Math.imul(ke,Re)|0)+Math.imul(Ce,Ue)|0))<<13)|0;Y=((D=D+Math.imul(Ce,Re)|0)+(T>>>13)|0)+(Ht>>>26)|0,Ht&=67108863,A=Math.imul(rt,Le),T=(T=Math.imul(rt,at))+Math.imul(it,Le)|0,D=Math.imul(it,at),A=A+Math.imul(ot,we)|0,T=(T=T+Math.imul(ot,de)|0)+Math.imul(De,we)|0,D=D+Math.imul(De,de)|0,A=A+Math.imul(st,ve)|0,T=(T=T+Math.imul(st,ye)|0)+Math.imul(lt,ve)|0,D=D+Math.imul(lt,ye)|0;var Lt=(Y+(A=A+Math.imul(Pe,Ue)|0)|0)+((8191&(T=(T=T+Math.imul(Pe,Re)|0)+Math.imul(Xe,Ue)|0))<<13)|0;Y=((D=D+Math.imul(Xe,Re)|0)+(T>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,A=Math.imul(rt,we),T=(T=Math.imul(rt,de))+Math.imul(it,we)|0,D=Math.imul(it,de),A=A+Math.imul(ot,ve)|0,T=(T=T+Math.imul(ot,ye)|0)+Math.imul(De,ve)|0,D=D+Math.imul(De,ye)|0;var er=(Y+(A=A+Math.imul(st,Ue)|0)|0)+((8191&(T=(T=T+Math.imul(st,Re)|0)+Math.imul(lt,Ue)|0))<<13)|0;Y=((D=D+Math.imul(lt,Re)|0)+(T>>>13)|0)+(er>>>26)|0,er&=67108863,A=Math.imul(rt,ve),T=(T=Math.imul(rt,ye))+Math.imul(it,ve)|0,D=Math.imul(it,ye);var gr=(Y+(A=A+Math.imul(ot,Ue)|0)|0)+((8191&(T=(T=T+Math.imul(ot,Re)|0)+Math.imul(De,Ue)|0))<<13)|0;Y=((D=D+Math.imul(De,Re)|0)+(T>>>13)|0)+(gr>>>26)|0,gr&=67108863;var tr=(Y+(A=Math.imul(rt,Ue))|0)+((8191&(T=(T=Math.imul(rt,Re))+Math.imul(it,Ue)|0))<<13)|0;return Y=((D=Math.imul(it,Re))+(T>>>13)|0)+(tr>>>26)|0,tr&=67108863,K[0]=Be,K[1]=ze,K[2]=be,K[3]=Te,K[4]=Ge,K[5]=ue,K[6]=Ae,K[7]=pe,K[8]=xe,K[9]=We,K[10]=qe,K[11]=ut,K[12]=Mt,K[13]=Bt,K[14]=Ht,K[15]=Lt,K[16]=er,K[17]=gr,K[18]=tr,Y!==0&&(K[19]=Y,E.length++),E};function F(C,w,E){E.negative=w.negative^C.negative,E.length=C.length+w.length;for(var A=0,T=0,D=0;D<E.length-1;D++){var U=T;T=0;for(var P=67108863&A,K=Math.min(D,w.length-1),Y=Math.max(0,D-C.length+1);Y<=K;Y++){var re=D-Y,z=(0|C.words[re])*(0|w.words[Y]),ee=67108863&z;P=67108863&(ee=ee+P|0),T+=(U=(U=U+(z/67108864|0)|0)+(ee>>>26)|0)>>>26,U&=67108863}E.words[D]=P,A=U,U=T}return A!==0?E.words[D]=A:E.length--,E._strip()}function B(C,w,E){return F(C,w,E)}Math.imul||(N=k),i.prototype.mulTo=function(C,w){var E=this.length+C.length;return this.length===10&&C.length===10?N(this,C,w):E<63?k(this,C,w):E<1024?F(this,C,w):B(this,C,w)},i.prototype.mul=function(C){var w=new i(null);return w.words=new Array(this.length+C.length),this.mulTo(C,w)},i.prototype.mulf=function(C){var w=new i(null);return w.words=new Array(this.length+C.length),B(this,C,w)},i.prototype.imul=function(C){return this.clone().mulTo(C,this)},i.prototype.imuln=function(C){var w=C<0;w&&(C=-C),l(typeof C=="number"),l(C<67108864);for(var E=0,A=0;A<this.length;A++){var T=(0|this.words[A])*C,D=(67108863&T)+(67108863&E);E>>=26,E+=T/67108864|0,E+=D>>>26,this.words[A]=67108863&D}return E!==0&&(this.words[A]=E,this.length++),w?this.ineg():this},i.prototype.muln=function(C){return this.clone().imuln(C)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(C){var w=function(D){for(var U=new Array(D.bitLength()),P=0;P<U.length;P++){var K=P/26|0,Y=P%26;U[P]=D.words[K]>>>Y&1}return U}(C);if(w.length===0)return new i(1);for(var E=this,A=0;A<w.length&&w[A]===0;A++,E=E.sqr());if(++A<w.length)for(var T=E.sqr();A<w.length;A++,T=T.sqr())w[A]!==0&&(E=E.mul(T));return E},i.prototype.iushln=function(C){l(typeof C=="number"&&C>=0);var w,E=C%26,A=(C-E)/26,T=67108863>>>26-E<<26-E;if(E!==0){var D=0;for(w=0;w<this.length;w++){var U=this.words[w]&T,P=(0|this.words[w])-U<<E;this.words[w]=P|D,D=U>>>26-E}D&&(this.words[w]=D,this.length++)}if(A!==0){for(w=this.length-1;w>=0;w--)this.words[w+A]=this.words[w];for(w=0;w<A;w++)this.words[w]=0;this.length+=A}return this._strip()},i.prototype.ishln=function(C){return l(this.negative===0),this.iushln(C)},i.prototype.iushrn=function(C,w,E){var A;l(typeof C=="number"&&C>=0),A=w?(w-w%26)/26:0;var T=C%26,D=Math.min((C-T)/26,this.length),U=67108863^67108863>>>T<<T,P=E;if(A-=D,A=Math.max(0,A),P){for(var K=0;K<D;K++)P.words[K]=this.words[K];P.length=D}if(D!==0)if(this.length>D)for(this.length-=D,K=0;K<this.length;K++)this.words[K]=this.words[K+D];else this.words[0]=0,this.length=1;var Y=0;for(K=this.length-1;K>=0&&(Y!==0||K>=A);K--){var re=0|this.words[K];this.words[K]=Y<<26-T|re>>>T,Y=re&U}return P&&Y!==0&&(P.words[P.length++]=Y),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},i.prototype.ishrn=function(C,w,E){return l(this.negative===0),this.iushrn(C,w,E)},i.prototype.shln=function(C){return this.clone().ishln(C)},i.prototype.ushln=function(C){return this.clone().iushln(C)},i.prototype.shrn=function(C){return this.clone().ishrn(C)},i.prototype.ushrn=function(C){return this.clone().iushrn(C)},i.prototype.testn=function(C){l(typeof C=="number"&&C>=0);var w=C%26,E=(C-w)/26,A=1<<w;return!(this.length<=E)&&!!(this.words[E]&A)},i.prototype.imaskn=function(C){l(typeof C=="number"&&C>=0);var w=C%26,E=(C-w)/26;if(l(this.negative===0,"imaskn works only with positive numbers"),this.length<=E)return this;if(w!==0&&E++,this.length=Math.min(E,this.length),w!==0){var A=67108863^67108863>>>w<<w;this.words[this.length-1]&=A}return this._strip()},i.prototype.maskn=function(C){return this.clone().imaskn(C)},i.prototype.iaddn=function(C){return l(typeof C=="number"),l(C<67108864),C<0?this.isubn(-C):this.negative!==0?this.length===1&&(0|this.words[0])<=C?(this.words[0]=C-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(C),this.negative=1,this):this._iaddn(C)},i.prototype._iaddn=function(C){this.words[0]+=C;for(var w=0;w<this.length&&this.words[w]>=67108864;w++)this.words[w]-=67108864,w===this.length-1?this.words[w+1]=1:this.words[w+1]++;return this.length=Math.max(this.length,w+1),this},i.prototype.isubn=function(C){if(l(typeof C=="number"),l(C<67108864),C<0)return this.iaddn(-C);if(this.negative!==0)return this.negative=0,this.iaddn(C),this.negative=1,this;if(this.words[0]-=C,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var w=0;w<this.length&&this.words[w]<0;w++)this.words[w]+=67108864,this.words[w+1]-=1;return this._strip()},i.prototype.addn=function(C){return this.clone().iaddn(C)},i.prototype.subn=function(C){return this.clone().isubn(C)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(C,w,E){var A,T,D=C.length+E;this._expand(D);var U=0;for(A=0;A<C.length;A++){T=(0|this.words[A+E])+U;var P=(0|C.words[A])*w;U=((T-=67108863&P)>>26)-(P/67108864|0),this.words[A+E]=67108863&T}for(;A<this.length-E;A++)U=(T=(0|this.words[A+E])+U)>>26,this.words[A+E]=67108863&T;if(U===0)return this._strip();for(l(U===-1),U=0,A=0;A<this.length;A++)U=(T=-(0|this.words[A])+U)>>26,this.words[A]=67108863&T;return this.negative=1,this._strip()},i.prototype._wordDiv=function(C,w){var E=(this.length,C.length),A=this.clone(),T=C,D=0|T.words[T.length-1];(E=26-this._countBits(D))!==0&&(T=T.ushln(E),A.iushln(E),D=0|T.words[T.length-1]);var U,P=A.length-T.length;if(w!=="mod"){(U=new i(null)).length=P+1,U.words=new Array(U.length);for(var K=0;K<U.length;K++)U.words[K]=0}var Y=A.clone()._ishlnsubmul(T,1,P);Y.negative===0&&(A=Y,U&&(U.words[P]=1));for(var re=P-1;re>=0;re--){var z=67108864*(0|A.words[T.length+re])+(0|A.words[T.length+re-1]);for(z=Math.min(z/D|0,67108863),A._ishlnsubmul(T,z,re);A.negative!==0;)z--,A.negative=0,A._ishlnsubmul(T,1,re),A.isZero()||(A.negative^=1);U&&(U.words[re]=z)}return U&&U._strip(),A._strip(),w!=="div"&&E!==0&&A.iushrn(E),{div:U||null,mod:A}},i.prototype.divmod=function(C,w,E){return l(!C.isZero()),this.isZero()?{div:new i(0),mod:new i(0)}:this.negative!==0&&C.negative===0?(D=this.neg().divmod(C,w),w!=="mod"&&(A=D.div.neg()),w!=="div"&&(T=D.mod.neg(),E&&T.negative!==0&&T.iadd(C)),{div:A,mod:T}):this.negative===0&&C.negative!==0?(D=this.divmod(C.neg(),w),w!=="mod"&&(A=D.div.neg()),{div:A,mod:D.mod}):(this.negative&C.negative)!=0?(D=this.neg().divmod(C.neg(),w),w!=="div"&&(T=D.mod.neg(),E&&T.negative!==0&&T.isub(C)),{div:D.div,mod:T}):C.length>this.length||this.cmp(C)<0?{div:new i(0),mod:this}:C.length===1?w==="div"?{div:this.divn(C.words[0]),mod:null}:w==="mod"?{div:null,mod:new i(this.modrn(C.words[0]))}:{div:this.divn(C.words[0]),mod:new i(this.modrn(C.words[0]))}:this._wordDiv(C,w);var A,T,D},i.prototype.div=function(C){return this.divmod(C,"div",!1).div},i.prototype.mod=function(C){return this.divmod(C,"mod",!1).mod},i.prototype.umod=function(C){return this.divmod(C,"mod",!0).mod},i.prototype.divRound=function(C){var w=this.divmod(C);if(w.mod.isZero())return w.div;var E=w.div.negative!==0?w.mod.isub(C):w.mod,A=C.ushrn(1),T=C.andln(1),D=E.cmp(A);return D<0||T===1&&D===0?w.div:w.div.negative!==0?w.div.isubn(1):w.div.iaddn(1)},i.prototype.modrn=function(C){var w=C<0;w&&(C=-C),l(C<=67108863);for(var E=(1<<26)%C,A=0,T=this.length-1;T>=0;T--)A=(E*A+(0|this.words[T]))%C;return w?-A:A},i.prototype.modn=function(C){return this.modrn(C)},i.prototype.idivn=function(C){var w=C<0;w&&(C=-C),l(C<=67108863);for(var E=0,A=this.length-1;A>=0;A--){var T=(0|this.words[A])+67108864*E;this.words[A]=T/C|0,E=T%C}return this._strip(),w?this.ineg():this},i.prototype.divn=function(C){return this.clone().idivn(C)},i.prototype.egcd=function(C){l(C.negative===0),l(!C.isZero());var w=this,E=C.clone();w=w.negative!==0?w.umod(C):w.clone();for(var A=new i(1),T=new i(0),D=new i(0),U=new i(1),P=0;w.isEven()&&E.isEven();)w.iushrn(1),E.iushrn(1),++P;for(var K=E.clone(),Y=w.clone();!w.isZero();){for(var re=0,z=1;(w.words[0]&z)==0&&re<26;++re,z<<=1);if(re>0)for(w.iushrn(re);re-- >0;)(A.isOdd()||T.isOdd())&&(A.iadd(K),T.isub(Y)),A.iushrn(1),T.iushrn(1);for(var ee=0,L=1;(E.words[0]&L)==0&&ee<26;++ee,L<<=1);if(ee>0)for(E.iushrn(ee);ee-- >0;)(D.isOdd()||U.isOdd())&&(D.iadd(K),U.isub(Y)),D.iushrn(1),U.iushrn(1);w.cmp(E)>=0?(w.isub(E),A.isub(D),T.isub(U)):(E.isub(w),D.isub(A),U.isub(T))}return{a:D,b:U,gcd:E.iushln(P)}},i.prototype._invmp=function(C){l(C.negative===0),l(!C.isZero());var w=this,E=C.clone();w=w.negative!==0?w.umod(C):w.clone();for(var A,T=new i(1),D=new i(0),U=E.clone();w.cmpn(1)>0&&E.cmpn(1)>0;){for(var P=0,K=1;(w.words[0]&K)==0&&P<26;++P,K<<=1);if(P>0)for(w.iushrn(P);P-- >0;)T.isOdd()&&T.iadd(U),T.iushrn(1);for(var Y=0,re=1;(E.words[0]&re)==0&&Y<26;++Y,re<<=1);if(Y>0)for(E.iushrn(Y);Y-- >0;)D.isOdd()&&D.iadd(U),D.iushrn(1);w.cmp(E)>=0?(w.isub(E),T.isub(D)):(E.isub(w),D.isub(T))}return(A=w.cmpn(1)===0?T:D).cmpn(0)<0&&A.iadd(C),A},i.prototype.gcd=function(C){if(this.isZero())return C.abs();if(C.isZero())return this.abs();var w=this.clone(),E=C.clone();w.negative=0,E.negative=0;for(var A=0;w.isEven()&&E.isEven();A++)w.iushrn(1),E.iushrn(1);for(;;){for(;w.isEven();)w.iushrn(1);for(;E.isEven();)E.iushrn(1);var T=w.cmp(E);if(T<0){var D=w;w=E,E=D}else if(T===0||E.cmpn(1)===0)break;w.isub(E)}return E.iushln(A)},i.prototype.invm=function(C){return this.egcd(C).a.umod(C)},i.prototype.isEven=function(){return(1&this.words[0])==0},i.prototype.isOdd=function(){return(1&this.words[0])==1},i.prototype.andln=function(C){return this.words[0]&C},i.prototype.bincn=function(C){l(typeof C=="number");var w=C%26,E=(C-w)/26,A=1<<w;if(this.length<=E)return this._expand(E+1),this.words[E]|=A,this;for(var T=A,D=E;T!==0&&D<this.length;D++){var U=0|this.words[D];T=(U+=T)>>>26,U&=67108863,this.words[D]=U}return T!==0&&(this.words[D]=T,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(C){var w,E=C<0;if(this.negative!==0&&!E)return-1;if(this.negative===0&&E)return 1;if(this._strip(),this.length>1)w=1;else{E&&(C=-C),l(C<=67108863,"Number is too big");var A=0|this.words[0];w=A===C?0:A<C?-1:1}return this.negative!==0?0|-w:w},i.prototype.cmp=function(C){if(this.negative!==0&&C.negative===0)return-1;if(this.negative===0&&C.negative!==0)return 1;var w=this.ucmp(C);return this.negative!==0?0|-w:w},i.prototype.ucmp=function(C){if(this.length>C.length)return 1;if(this.length<C.length)return-1;for(var w=0,E=this.length-1;E>=0;E--){var A=0|this.words[E],T=0|C.words[E];if(A!==T){A<T?w=-1:A>T&&(w=1);break}}return w},i.prototype.gtn=function(C){return this.cmpn(C)===1},i.prototype.gt=function(C){return this.cmp(C)===1},i.prototype.gten=function(C){return this.cmpn(C)>=0},i.prototype.gte=function(C){return this.cmp(C)>=0},i.prototype.ltn=function(C){return this.cmpn(C)===-1},i.prototype.lt=function(C){return this.cmp(C)===-1},i.prototype.lten=function(C){return this.cmpn(C)<=0},i.prototype.lte=function(C){return this.cmp(C)<=0},i.prototype.eqn=function(C){return this.cmpn(C)===0},i.prototype.eq=function(C){return this.cmp(C)===0},i.red=function(C){return new O(C)},i.prototype.toRed=function(C){return l(!this.red,"Already a number in reduction context"),l(this.negative===0,"red works only with positives"),C.convertTo(this)._forceRed(C)},i.prototype.fromRed=function(){return l(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(C){return this.red=C,this},i.prototype.forceRed=function(C){return l(!this.red,"Already a number in reduction context"),this._forceRed(C)},i.prototype.redAdd=function(C){return l(this.red,"redAdd works only with red numbers"),this.red.add(this,C)},i.prototype.redIAdd=function(C){return l(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,C)},i.prototype.redSub=function(C){return l(this.red,"redSub works only with red numbers"),this.red.sub(this,C)},i.prototype.redISub=function(C){return l(this.red,"redISub works only with red numbers"),this.red.isub(this,C)},i.prototype.redShl=function(C){return l(this.red,"redShl works only with red numbers"),this.red.shl(this,C)},i.prototype.redMul=function(C){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,C),this.red.mul(this,C)},i.prototype.redIMul=function(C){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,C),this.red.imul(this,C)},i.prototype.redSqr=function(){return l(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return l(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return l(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return l(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return l(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(C){return l(this.red&&!C.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,C)};var W={k256:null,p224:null,p192:null,p25519:null};function V(C,w){this.name=C,this.p=new i(w,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function q(){V.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function X(){V.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function I(){V.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function H(){V.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function O(C){if(typeof C=="string"){var w=i._prime(C);this.m=w.p,this.prime=w}else l(C.gtn(1),"modulus must be greater than 1"),this.m=C,this.prime=null}function R(C){O.call(this,C),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}V.prototype._tmp=function(){var C=new i(null);return C.words=new Array(Math.ceil(this.n/13)),C},V.prototype.ireduce=function(C){var w,E=C;do this.split(E,this.tmp),w=(E=(E=this.imulK(E)).iadd(this.tmp)).bitLength();while(w>this.n);var A=w<this.n?-1:E.ucmp(this.p);return A===0?(E.words[0]=0,E.length=1):A>0?E.isub(this.p):E.strip!==void 0?E.strip():E._strip(),E},V.prototype.split=function(C,w){C.iushrn(this.n,0,w)},V.prototype.imulK=function(C){return C.imul(this.k)},c(q,V),q.prototype.split=function(C,w){for(var E=Math.min(C.length,9),A=0;A<E;A++)w.words[A]=C.words[A];if(w.length=E,C.length<=9)return C.words[0]=0,void(C.length=1);var T=C.words[9];for(w.words[w.length++]=4194303&T,A=10;A<C.length;A++){var D=0|C.words[A];C.words[A-10]=(4194303&D)<<4|T>>>22,T=D}T>>>=22,C.words[A-10]=T,T===0&&C.length>10?C.length-=10:C.length-=9},q.prototype.imulK=function(C){C.words[C.length]=0,C.words[C.length+1]=0,C.length+=2;for(var w=0,E=0;E<C.length;E++){var A=0|C.words[E];w+=977*A,C.words[E]=67108863&w,w=64*A+(w/67108864|0)}return C.words[C.length-1]===0&&(C.length--,C.words[C.length-1]===0&&C.length--),C},c(X,V),c(I,V),c(H,V),H.prototype.imulK=function(C){for(var w=0,E=0;E<C.length;E++){var A=19*(0|C.words[E])+w,T=67108863&A;A>>>=26,C.words[E]=T,w=A}return w!==0&&(C.words[C.length++]=w),C},i._prime=function(C){if(W[C])return W[C];var w;if(C==="k256")w=new q;else if(C==="p224")w=new X;else if(C==="p192")w=new I;else{if(C!=="p25519")throw new Error("Unknown prime "+C);w=new H}return W[C]=w,w},O.prototype._verify1=function(C){l(C.negative===0,"red works only with positives"),l(C.red,"red works only with red numbers")},O.prototype._verify2=function(C,w){l((C.negative|w.negative)==0,"red works only with positives"),l(C.red&&C.red===w.red,"red works only with red numbers")},O.prototype.imod=function(C){return this.prime?this.prime.ireduce(C)._forceRed(this):(v(C,C.umod(this.m)._forceRed(this)),C)},O.prototype.neg=function(C){return C.isZero()?C.clone():this.m.sub(C)._forceRed(this)},O.prototype.add=function(C,w){this._verify2(C,w);var E=C.add(w);return E.cmp(this.m)>=0&&E.isub(this.m),E._forceRed(this)},O.prototype.iadd=function(C,w){this._verify2(C,w);var E=C.iadd(w);return E.cmp(this.m)>=0&&E.isub(this.m),E},O.prototype.sub=function(C,w){this._verify2(C,w);var E=C.sub(w);return E.cmpn(0)<0&&E.iadd(this.m),E._forceRed(this)},O.prototype.isub=function(C,w){this._verify2(C,w);var E=C.isub(w);return E.cmpn(0)<0&&E.iadd(this.m),E},O.prototype.shl=function(C,w){return this._verify1(C),this.imod(C.ushln(w))},O.prototype.imul=function(C,w){return this._verify2(C,w),this.imod(C.imul(w))},O.prototype.mul=function(C,w){return this._verify2(C,w),this.imod(C.mul(w))},O.prototype.isqr=function(C){return this.imul(C,C.clone())},O.prototype.sqr=function(C){return this.mul(C,C)},O.prototype.sqrt=function(C){if(C.isZero())return C.clone();var w=this.m.andln(3);if(l(w%2==1),w===3){var E=this.m.add(new i(1)).iushrn(2);return this.pow(C,E)}for(var A=this.m.subn(1),T=0;!A.isZero()&&A.andln(1)===0;)T++,A.iushrn(1);l(!A.isZero());var D=new i(1).toRed(this),U=D.redNeg(),P=this.m.subn(1).iushrn(1),K=this.m.bitLength();for(K=new i(2*K*K).toRed(this);this.pow(K,P).cmp(U)!==0;)K.redIAdd(U);for(var Y=this.pow(K,A),re=this.pow(C,A.addn(1).iushrn(1)),z=this.pow(C,A),ee=T;z.cmp(D)!==0;){for(var L=z,M=0;L.cmp(D)!==0;M++)L=L.redSqr();l(M<ee);var Z=this.pow(Y,new i(1).iushln(ee-M-1));re=re.redMul(Z),Y=Z.redSqr(),z=z.redMul(Y),ee=M}return re},O.prototype.invm=function(C){var w=C._invmp(this.m);return w.negative!==0?(w.negative=0,this.imod(w).redNeg()):this.imod(w)},O.prototype.pow=function(C,w){if(w.isZero())return new i(1).toRed(this);if(w.cmpn(1)===0)return C.clone();var E=new Array(16);E[0]=new i(1).toRed(this),E[1]=C;for(var A=2;A<E.length;A++)E[A]=this.mul(E[A-1],C);var T=E[0],D=0,U=0,P=w.bitLength()%26;for(P===0&&(P=26),A=w.length-1;A>=0;A--){for(var K=w.words[A],Y=P-1;Y>=0;Y--){var re=K>>Y&1;T!==E[0]&&(T=this.sqr(T)),re!==0||D!==0?(D<<=1,D|=re,(++U===4||A===0&&Y===0)&&(T=this.mul(T,E[D]),U=0,D=0)):U=0}P=26}return T},O.prototype.convertTo=function(C){var w=C.umod(this.m);return w===C?w.clone():w},O.prototype.convertFrom=function(C){var w=C.clone();return w.red=null,w},i.mont=function(C){return new R(C)},c(R,O),R.prototype.convertTo=function(C){return this.imod(C.ushln(this.shift))},R.prototype.convertFrom=function(C){var w=this.imod(C.mul(this.rinv));return w.red=null,w},R.prototype.imul=function(C,w){if(C.isZero()||w.isZero())return C.words[0]=0,C.length=1,C;var E=C.imul(w),A=E.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),T=E.isub(A).iushrn(this.shift),D=T;return T.cmp(this.m)>=0?D=T.isub(this.m):T.cmpn(0)<0&&(D=T.iadd(this.m)),D._forceRed(this)},R.prototype.mul=function(C,w){if(C.isZero()||w.isZero())return new i(0)._forceRed(this);var E=C.mul(w),A=E.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),T=E.isub(A).iushrn(this.shift),D=T;return T.cmp(this.m)>=0?D=T.isub(this.m):T.cmpn(0)<0&&(D=T.iadd(this.m)),D._forceRed(this)},R.prototype.invm=function(C){return this.imod(C._invmp(this.m).mul(this.r2))._forceRed(this)}})(n===void 0||n)},{buffer:188}],187:[function(e,n,a){var o;function s(c){this.rand=c}if(n.exports=function(c){return o||(o=new s(null)),o.generate(c)},n.exports.Rand=s,s.prototype.generate=function(c){return this._rand(c)},s.prototype._rand=function(c){if(this.rand.getBytes)return this.rand.getBytes(c);for(var i=new Uint8Array(c),u=0;u<i.length;u++)i[u]=this.rand.getByte();return i},typeof self=="object")self.crypto&&self.crypto.getRandomValues?s.prototype._rand=function(c){var i=new Uint8Array(c);return self.crypto.getRandomValues(i),i}:self.msCrypto&&self.msCrypto.getRandomValues?s.prototype._rand=function(c){var i=new Uint8Array(c);return self.msCrypto.getRandomValues(i),i}:typeof window=="object"&&(s.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var l=e("crypto");if(typeof l.randomBytes!="function")throw new Error("Not supported");s.prototype._rand=function(c){return l.randomBytes(c)}}catch{}},{crypto:188}],188:[function(e,n,a){},{}],189:[function(e,n,a){var o=e("safe-buffer").Buffer;function s(f){o.isBuffer(f)||(f=o.from(f));for(var h=f.length/4|0,v=new Array(h),b=0;b<h;b++)v[b]=f.readUInt32BE(4*b);return v}function l(f){for(;0<f.length;f++)f[0]=0}function c(f,h,v,b,g){for(var x,y,k,N,F=v[0],B=v[1],W=v[2],V=v[3],q=f[0]^h[0],X=f[1]^h[1],I=f[2]^h[2],H=f[3]^h[3],O=4,R=1;R<g;R++)x=F[q>>>24]^B[X>>>16&255]^W[I>>>8&255]^V[255&H]^h[O++],y=F[X>>>24]^B[I>>>16&255]^W[H>>>8&255]^V[255&q]^h[O++],k=F[I>>>24]^B[H>>>16&255]^W[q>>>8&255]^V[255&X]^h[O++],N=F[H>>>24]^B[q>>>16&255]^W[X>>>8&255]^V[255&I]^h[O++],q=x,X=y,I=k,H=N;return x=(b[q>>>24]<<24|b[X>>>16&255]<<16|b[I>>>8&255]<<8|b[255&H])^h[O++],y=(b[X>>>24]<<24|b[I>>>16&255]<<16|b[H>>>8&255]<<8|b[255&q])^h[O++],k=(b[I>>>24]<<24|b[H>>>16&255]<<16|b[q>>>8&255]<<8|b[255&X])^h[O++],N=(b[H>>>24]<<24|b[q>>>16&255]<<16|b[X>>>8&255]<<8|b[255&I])^h[O++],[x>>>=0,y>>>=0,k>>>=0,N>>>=0]}var i=[0,1,2,4,8,16,32,64,128,27,54],u=function(){for(var f=new Array(256),h=0;h<256;h++)f[h]=h<128?h<<1:h<<1^283;for(var v=[],b=[],g=[[],[],[],[]],x=[[],[],[],[]],y=0,k=0,N=0;N<256;++N){var F=k^k<<1^k<<2^k<<3^k<<4;F=F>>>8^255&F^99,v[y]=F,b[F]=y;var B=f[y],W=f[B],V=f[W],q=257*f[F]^16843008*F;g[0][y]=q<<24|q>>>8,g[1][y]=q<<16|q>>>16,g[2][y]=q<<8|q>>>24,g[3][y]=q,q=16843009*V^65537*W^257*B^16843008*y,x[0][F]=q<<24|q>>>8,x[1][F]=q<<16|q>>>16,x[2][F]=q<<8|q>>>24,x[3][F]=q,y===0?y=k=1:(y=B^f[f[f[V^B]]],k^=f[f[k]])}return{SBOX:v,INV_SBOX:b,SUB_MIX:g,INV_SUB_MIX:x}}();function p(f){this._key=s(f),this._reset()}p.blockSize=16,p.keySize=32,p.prototype.blockSize=p.blockSize,p.prototype.keySize=p.keySize,p.prototype._reset=function(){for(var f=this._key,h=f.length,v=h+6,b=4*(v+1),g=[],x=0;x<h;x++)g[x]=f[x];for(x=h;x<b;x++){var y=g[x-1];x%h==0?(y=y<<8|y>>>24,y=u.SBOX[y>>>24]<<24|u.SBOX[y>>>16&255]<<16|u.SBOX[y>>>8&255]<<8|u.SBOX[255&y],y^=i[x/h|0]<<24):h>6&&x%h==4&&(y=u.SBOX[y>>>24]<<24|u.SBOX[y>>>16&255]<<16|u.SBOX[y>>>8&255]<<8|u.SBOX[255&y]),g[x]=g[x-h]^y}for(var k=[],N=0;N<b;N++){var F=b-N,B=g[F-(N%4?0:4)];k[N]=N<4||F<=4?B:u.INV_SUB_MIX[0][u.SBOX[B>>>24]]^u.INV_SUB_MIX[1][u.SBOX[B>>>16&255]]^u.INV_SUB_MIX[2][u.SBOX[B>>>8&255]]^u.INV_SUB_MIX[3][u.SBOX[255&B]]}this._nRounds=v,this._keySchedule=g,this._invKeySchedule=k},p.prototype.encryptBlockRaw=function(f){return c(f=s(f),this._keySchedule,u.SUB_MIX,u.SBOX,this._nRounds)},p.prototype.encryptBlock=function(f){var h=this.encryptBlockRaw(f),v=o.allocUnsafe(16);return v.writeUInt32BE(h[0],0),v.writeUInt32BE(h[1],4),v.writeUInt32BE(h[2],8),v.writeUInt32BE(h[3],12),v},p.prototype.decryptBlock=function(f){var h=(f=s(f))[1];f[1]=f[3],f[3]=h;var v=c(f,this._invKeySchedule,u.INV_SUB_MIX,u.INV_SBOX,this._nRounds),b=o.allocUnsafe(16);return b.writeUInt32BE(v[0],0),b.writeUInt32BE(v[3],4),b.writeUInt32BE(v[2],8),b.writeUInt32BE(v[1],12),b},p.prototype.scrub=function(){l(this._keySchedule),l(this._invKeySchedule),l(this._key)},n.exports.AES=p},{"safe-buffer":494}],190:[function(e,n,a){var o=e("./aes"),s=e("safe-buffer").Buffer,l=e("cipher-base"),c=e("inherits"),i=e("./ghash"),u=e("buffer-xor"),p=e("./incr32");function f(h,v,b,g){l.call(this);var x=s.alloc(4,0);this._cipher=new o.AES(v);var y=this._cipher.encryptBlock(x);this._ghash=new i(y),b=function(k,N,F){if(N.length===12)return k._finID=s.concat([N,s.from([0,0,0,1])]),s.concat([N,s.from([0,0,0,2])]);var B=new i(F),W=N.length,V=W%16;B.update(N),V&&(V=16-V,B.update(s.alloc(V,0))),B.update(s.alloc(8,0));var q=8*W,X=s.alloc(8);X.writeUIntBE(q,0,8),B.update(X),k._finID=B.state;var I=s.from(k._finID);return p(I),I}(this,b,y),this._prev=s.from(b),this._cache=s.allocUnsafe(0),this._secCache=s.allocUnsafe(0),this._decrypt=g,this._alen=0,this._len=0,this._mode=h,this._authTag=null,this._called=!1}c(f,l),f.prototype._update=function(h){if(!this._called&&this._alen){var v=16-this._alen%16;v<16&&(v=s.alloc(v,0),this._ghash.update(v))}this._called=!0;var b=this._mode.encrypt(this,h);return this._decrypt?this._ghash.update(h):this._ghash.update(b),this._len+=h.length,b},f.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var h=u(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(v,b){var g=0;v.length!==b.length&&g++;for(var x=Math.min(v.length,b.length),y=0;y<x;++y)g+=v[y]^b[y];return g}(h,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=h,this._cipher.scrub()},f.prototype.getAuthTag=function(){if(this._decrypt||!s.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},f.prototype.setAuthTag=function(h){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=h},f.prototype.setAAD=function(h){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(h),this._alen+=h.length},n.exports=f},{"./aes":189,"./ghash":194,"./incr32":195,"buffer-xor":219,"cipher-base":221,inherits:440,"safe-buffer":494}],191:[function(e,n,a){var o=e("./encrypter"),s=e("./decrypter"),l=e("./modes/list.json");a.createCipher=a.Cipher=o.createCipher,a.createCipheriv=a.Cipheriv=o.createCipheriv,a.createDecipher=a.Decipher=s.createDecipher,a.createDecipheriv=a.Decipheriv=s.createDecipheriv,a.listCiphers=a.getCiphers=function(){return Object.keys(l)}},{"./decrypter":192,"./encrypter":193,"./modes/list.json":203}],192:[function(e,n,a){var o=e("./authCipher"),s=e("safe-buffer").Buffer,l=e("./modes"),c=e("./streamCipher"),i=e("cipher-base"),u=e("./aes"),p=e("evp_bytestokey");function f(b,g,x){i.call(this),this._cache=new h,this._last=void 0,this._cipher=new u.AES(g),this._prev=s.from(x),this._mode=b,this._autopadding=!0}function h(){this.cache=s.allocUnsafe(0)}function v(b,g,x){var y=l[b.toLowerCase()];if(!y)throw new TypeError("invalid suite type");if(typeof x=="string"&&(x=s.from(x)),y.mode!=="GCM"&&x.length!==y.iv)throw new TypeError("invalid iv length "+x.length);if(typeof g=="string"&&(g=s.from(g)),g.length!==y.key/8)throw new TypeError("invalid key length "+g.length);return y.type==="stream"?new c(y.module,g,x,!0):y.type==="auth"?new o(y.module,g,x,!0):new f(y.module,g,x)}e("inherits")(f,i),f.prototype._update=function(b){var g,x;this._cache.add(b);for(var y=[];g=this._cache.get(this._autopadding);)x=this._mode.decrypt(this,g),y.push(x);return s.concat(y)},f.prototype._final=function(){var b=this._cache.flush();if(this._autopadding)return function(g){var x=g[15];if(x<1||x>16)throw new Error("unable to decrypt data");for(var y=-1;++y<x;)if(g[y+(16-x)]!==x)throw new Error("unable to decrypt data");if(x!==16)return g.slice(0,16-x)}(this._mode.decrypt(this,b));if(b)throw new Error("data not multiple of block length")},f.prototype.setAutoPadding=function(b){return this._autopadding=!!b,this},h.prototype.add=function(b){this.cache=s.concat([this.cache,b])},h.prototype.get=function(b){var g;if(b){if(this.cache.length>16)return g=this.cache.slice(0,16),this.cache=this.cache.slice(16),g}else if(this.cache.length>=16)return g=this.cache.slice(0,16),this.cache=this.cache.slice(16),g;return null},h.prototype.flush=function(){if(this.cache.length)return this.cache},a.createDecipher=function(b,g){var x=l[b.toLowerCase()];if(!x)throw new TypeError("invalid suite type");var y=p(g,!1,x.key,x.iv);return v(b,y.key,y.iv)},a.createDecipheriv=v},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],193:[function(e,n,a){var o=e("./modes"),s=e("./authCipher"),l=e("safe-buffer").Buffer,c=e("./streamCipher"),i=e("cipher-base"),u=e("./aes"),p=e("evp_bytestokey");function f(g,x,y){i.call(this),this._cache=new v,this._cipher=new u.AES(x),this._prev=l.from(y),this._mode=g,this._autopadding=!0}e("inherits")(f,i),f.prototype._update=function(g){var x,y;this._cache.add(g);for(var k=[];x=this._cache.get();)y=this._mode.encrypt(this,x),k.push(y);return l.concat(k)};var h=l.alloc(16,16);function v(){this.cache=l.allocUnsafe(0)}function b(g,x,y){var k=o[g.toLowerCase()];if(!k)throw new TypeError("invalid suite type");if(typeof x=="string"&&(x=l.from(x)),x.length!==k.key/8)throw new TypeError("invalid key length "+x.length);if(typeof y=="string"&&(y=l.from(y)),k.mode!=="GCM"&&y.length!==k.iv)throw new TypeError("invalid iv length "+y.length);return k.type==="stream"?new c(k.module,x,y):k.type==="auth"?new s(k.module,x,y):new f(k.module,x,y)}f.prototype._final=function(){var g=this._cache.flush();if(this._autopadding)return g=this._mode.encrypt(this,g),this._cipher.scrub(),g;if(!g.equals(h))throw this._cipher.scrub(),new Error("data not multiple of block length")},f.prototype.setAutoPadding=function(g){return this._autopadding=!!g,this},v.prototype.add=function(g){this.cache=l.concat([this.cache,g])},v.prototype.get=function(){if(this.cache.length>15){var g=this.cache.slice(0,16);return this.cache=this.cache.slice(16),g}return null},v.prototype.flush=function(){for(var g=16-this.cache.length,x=l.allocUnsafe(g),y=-1;++y<g;)x.writeUInt8(g,y);return l.concat([this.cache,x])},a.createCipheriv=b,a.createCipher=function(g,x){var y=o[g.toLowerCase()];if(!y)throw new TypeError("invalid suite type");var k=p(x,!1,y.key,y.iv);return b(g,k.key,k.iv)}},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],194:[function(e,n,a){var o=e("safe-buffer").Buffer,s=o.alloc(16,0);function l(i){var u=o.allocUnsafe(16);return u.writeUInt32BE(i[0]>>>0,0),u.writeUInt32BE(i[1]>>>0,4),u.writeUInt32BE(i[2]>>>0,8),u.writeUInt32BE(i[3]>>>0,12),u}function c(i){this.h=i,this.state=o.alloc(16,0),this.cache=o.allocUnsafe(0)}c.prototype.ghash=function(i){for(var u=-1;++u<i.length;)this.state[u]^=i[u];this._multiply()},c.prototype._multiply=function(){for(var i,u,p,f=[(i=this.h).readUInt32BE(0),i.readUInt32BE(4),i.readUInt32BE(8),i.readUInt32BE(12)],h=[0,0,0,0],v=-1;++v<128;){for((this.state[~~(v/8)]&1<<7-v%8)!=0&&(h[0]^=f[0],h[1]^=f[1],h[2]^=f[2],h[3]^=f[3]),p=(1&f[3])!=0,u=3;u>0;u--)f[u]=f[u]>>>1|(1&f[u-1])<<31;f[0]=f[0]>>>1,p&&(f[0]=f[0]^225<<24)}this.state=l(h)},c.prototype.update=function(i){var u;for(this.cache=o.concat([this.cache,i]);this.cache.length>=16;)u=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(u)},c.prototype.final=function(i,u){return this.cache.length&&this.ghash(o.concat([this.cache,s],16)),this.ghash(l([0,i,0,u])),this.state},n.exports=c},{"safe-buffer":494}],195:[function(e,n,a){n.exports=function(o){for(var s,l=o.length;l--;){if((s=o.readUInt8(l))!==255){s++,o.writeUInt8(s,l);break}o.writeUInt8(0,l)}}},{}],196:[function(e,n,a){var o=e("buffer-xor");a.encrypt=function(s,l){var c=o(l,s._prev);return s._prev=s._cipher.encryptBlock(c),s._prev},a.decrypt=function(s,l){var c=s._prev;s._prev=l;var i=s._cipher.decryptBlock(l);return o(i,c)}},{"buffer-xor":219}],197:[function(e,n,a){var o=e("safe-buffer").Buffer,s=e("buffer-xor");function l(c,i,u){var p=i.length,f=s(i,c._cache);return c._cache=c._cache.slice(p),c._prev=o.concat([c._prev,u?i:f]),f}a.encrypt=function(c,i,u){for(var p,f=o.allocUnsafe(0);i.length;){if(c._cache.length===0&&(c._cache=c._cipher.encryptBlock(c._prev),c._prev=o.allocUnsafe(0)),!(c._cache.length<=i.length)){f=o.concat([f,l(c,i,u)]);break}p=c._cache.length,f=o.concat([f,l(c,i.slice(0,p),u)]),i=i.slice(p)}return f}},{"buffer-xor":219,"safe-buffer":494}],198:[function(e,n,a){var o=e("safe-buffer").Buffer;function s(c,i,u){for(var p,f,h=-1,v=0;++h<8;)p=i&1<<7-h?128:0,v+=(128&(f=c._cipher.encryptBlock(c._prev)[0]^p))>>h%8,c._prev=l(c._prev,u?p:f);return v}function l(c,i){var u=c.length,p=-1,f=o.allocUnsafe(c.length);for(c=o.concat([c,o.from([i])]);++p<u;)f[p]=c[p]<<1|c[p+1]>>7;return f}a.encrypt=function(c,i,u){for(var p=i.length,f=o.allocUnsafe(p),h=-1;++h<p;)f[h]=s(c,i[h],u);return f}},{"safe-buffer":494}],199:[function(e,n,a){var o=e("safe-buffer").Buffer;function s(l,c,i){var u=l._cipher.encryptBlock(l._prev)[0]^c;return l._prev=o.concat([l._prev.slice(1),o.from([i?c:u])]),u}a.encrypt=function(l,c,i){for(var u=c.length,p=o.allocUnsafe(u),f=-1;++f<u;)p[f]=s(l,c[f],i);return p}},{"safe-buffer":494}],200:[function(e,n,a){var o=e("buffer-xor"),s=e("safe-buffer").Buffer,l=e("../incr32");function c(i){var u=i._cipher.encryptBlockRaw(i._prev);return l(i._prev),u}a.encrypt=function(i,u){var p=Math.ceil(u.length/16),f=i._cache.length;i._cache=s.concat([i._cache,s.allocUnsafe(16*p)]);for(var h=0;h<p;h++){var v=c(i),b=f+16*h;i._cache.writeUInt32BE(v[0],b+0),i._cache.writeUInt32BE(v[1],b+4),i._cache.writeUInt32BE(v[2],b+8),i._cache.writeUInt32BE(v[3],b+12)}var g=i._cache.slice(0,u.length);return i._cache=i._cache.slice(u.length),o(u,g)}},{"../incr32":195,"buffer-xor":219,"safe-buffer":494}],201:[function(e,n,a){a.encrypt=function(o,s){return o._cipher.encryptBlock(s)},a.decrypt=function(o,s){return o._cipher.decryptBlock(s)}},{}],202:[function(e,n,a){var o={ECB:e("./ecb"),CBC:e("./cbc"),CFB:e("./cfb"),CFB8:e("./cfb8"),CFB1:e("./cfb1"),OFB:e("./ofb"),CTR:e("./ctr"),GCM:e("./ctr")},s=e("./list.json");for(var l in s)s[l].module=o[s[l].mode];n.exports=s},{"./cbc":196,"./cfb":197,"./cfb1":198,"./cfb8":199,"./ctr":200,"./ecb":201,"./list.json":203,"./ofb":204}],203:[function(e,n,a){n.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],204:[function(e,n,a){(function(o){(function(){var s=e("buffer-xor");function l(c){return c._prev=c._cipher.encryptBlock(c._prev),c._prev}a.encrypt=function(c,i){for(;c._cache.length<i.length;)c._cache=o.concat([c._cache,l(c)]);var u=c._cache.slice(0,i.length);return c._cache=c._cache.slice(i.length),s(i,u)}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220,"buffer-xor":219}],205:[function(e,n,a){var o=e("./aes"),s=e("safe-buffer").Buffer,l=e("cipher-base");function c(i,u,p,f){l.call(this),this._cipher=new o.AES(u),this._prev=s.from(p),this._cache=s.allocUnsafe(0),this._secCache=s.allocUnsafe(0),this._decrypt=f,this._mode=i}e("inherits")(c,l),c.prototype._update=function(i){return this._mode.encrypt(this,i,this._decrypt)},c.prototype._final=function(){this._cipher.scrub()},n.exports=c},{"./aes":189,"cipher-base":221,inherits:440,"safe-buffer":494}],206:[function(e,n,a){var o=e("browserify-des"),s=e("browserify-aes/browser"),l=e("browserify-aes/modes"),c=e("browserify-des/modes"),i=e("evp_bytestokey");function u(f,h,v){if(f=f.toLowerCase(),l[f])return s.createCipheriv(f,h,v);if(c[f])return new o({key:h,iv:v,mode:f});throw new TypeError("invalid suite type")}function p(f,h,v){if(f=f.toLowerCase(),l[f])return s.createDecipheriv(f,h,v);if(c[f])return new o({key:h,iv:v,mode:f,decrypt:!0});throw new TypeError("invalid suite type")}a.createCipher=a.Cipher=function(f,h){var v,b;if(f=f.toLowerCase(),l[f])v=l[f].key,b=l[f].iv;else{if(!c[f])throw new TypeError("invalid suite type");v=8*c[f].key,b=c[f].iv}var g=i(h,!1,v,b);return u(f,g.key,g.iv)},a.createCipheriv=a.Cipheriv=u,a.createDecipher=a.Decipher=function(f,h){var v,b;if(f=f.toLowerCase(),l[f])v=l[f].key,b=l[f].iv;else{if(!c[f])throw new TypeError("invalid suite type");v=8*c[f].key,b=c[f].iv}var g=i(h,!1,v,b);return p(f,g.key,g.iv)},a.createDecipheriv=a.Decipheriv=p,a.listCiphers=a.getCiphers=function(){return Object.keys(c).concat(s.getCiphers())}},{"browserify-aes/browser":191,"browserify-aes/modes":202,"browserify-des":207,"browserify-des/modes":208,evp_bytestokey:423}],207:[function(e,n,a){var o=e("cipher-base"),s=e("des.js"),l=e("inherits"),c=e("safe-buffer").Buffer,i={"des-ede3-cbc":s.CBC.instantiate(s.EDE),"des-ede3":s.EDE,"des-ede-cbc":s.CBC.instantiate(s.EDE),"des-ede":s.EDE,"des-cbc":s.CBC.instantiate(s.DES),"des-ecb":s.DES};function u(p){o.call(this);var f,h=p.mode.toLowerCase(),v=i[h];f=p.decrypt?"decrypt":"encrypt";var b=p.key;c.isBuffer(b)||(b=c.from(b)),h!=="des-ede"&&h!=="des-ede-cbc"||(b=c.concat([b,b.slice(0,8)]));var g=p.iv;c.isBuffer(g)||(g=c.from(g)),this._des=v.create({key:b,iv:g,type:f})}i.des=i["des-cbc"],i.des3=i["des-ede3-cbc"],n.exports=u,l(u,o),u.prototype._update=function(p){return c.from(this._des.update(p))},u.prototype._final=function(){return c.from(this._des.final())}},{"cipher-base":221,"des.js":394,inherits:440,"safe-buffer":494}],208:[function(e,n,a){a["des-ecb"]={key:8,iv:0},a["des-cbc"]=a.des={key:8,iv:8},a["des-ede3-cbc"]=a.des3={key:24,iv:8},a["des-ede3"]={key:24,iv:0},a["des-ede-cbc"]={key:16,iv:8},a["des-ede"]={key:16,iv:0}},{}],209:[function(e,n,a){(function(o){(function(){var s=e("bn.js"),l=e("randombytes");function c(u){var p,f=u.modulus.byteLength();do p=new s(l(f));while(p.cmp(u.modulus)>=0||!p.umod(u.prime1)||!p.umod(u.prime2));return p}function i(u,p){var f=function(W){var V=c(W);return{blinder:V.toRed(s.mont(W.modulus)).redPow(new s(W.publicExponent)).fromRed(),unblinder:V.invm(W.modulus)}}(p),h=p.modulus.byteLength(),v=new s(u).mul(f.blinder).umod(p.modulus),b=v.toRed(s.mont(p.prime1)),g=v.toRed(s.mont(p.prime2)),x=p.coefficient,y=p.prime1,k=p.prime2,N=b.redPow(p.exponent1).fromRed(),F=g.redPow(p.exponent2).fromRed(),B=N.isub(F).imul(x).umod(y).imul(k);return F.iadd(B).imul(f.unblinder).umod(p.modulus).toArrayLike(o,"be",h)}i.getr=c,n.exports=i}).call(this)}).call(this,e("buffer").Buffer)},{"bn.js":186,buffer:220,randombytes:475}],210:[function(e,n,a){n.exports=e("./browser/algorithms.json")},{"./browser/algorithms.json":211}],211:[function(e,n,a){n.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],212:[function(e,n,a){n.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],213:[function(e,n,a){var o=e("safe-buffer").Buffer,s=e("create-hash"),l=e("readable-stream"),c=e("inherits"),i=e("./sign"),u=e("./verify"),p=e("./algorithms.json");function f(g){l.Writable.call(this);var x=p[g];if(!x)throw new Error("Unknown message digest");this._hashType=x.hash,this._hash=s(x.hash),this._tag=x.id,this._signType=x.sign}function h(g){l.Writable.call(this);var x=p[g];if(!x)throw new Error("Unknown message digest");this._hash=s(x.hash),this._tag=x.id,this._signType=x.sign}function v(g){return new f(g)}function b(g){return new h(g)}Object.keys(p).forEach(function(g){p[g].id=o.from(p[g].id,"hex"),p[g.toLowerCase()]=p[g]}),c(f,l.Writable),f.prototype._write=function(g,x,y){this._hash.update(g),y()},f.prototype.update=function(g,x){return typeof g=="string"&&(g=o.from(g,x)),this._hash.update(g),this},f.prototype.sign=function(g,x){this.end();var y=this._hash.digest(),k=i(y,g,this._hashType,this._signType,this._tag);return x?k.toString(x):k},c(h,l.Writable),h.prototype._write=function(g,x,y){this._hash.update(g),y()},h.prototype.update=function(g,x){return typeof g=="string"&&(g=o.from(g,x)),this._hash.update(g),this},h.prototype.verify=function(g,x,y){typeof x=="string"&&(x=o.from(x,y)),this.end();var k=this._hash.digest();return u(x,k,g,this._signType,this._tag)},n.exports={Sign:v,Verify:b,createSign:v,createVerify:b}},{"./algorithms.json":211,"./sign":214,"./verify":215,"create-hash":386,inherits:440,"readable-stream":491,"safe-buffer":494}],214:[function(e,n,a){var o=e("safe-buffer").Buffer,s=e("create-hmac"),l=e("browserify-rsa"),c=e("elliptic").ec,i=e("bn.js"),u=e("parse-asn1"),p=e("./curves.json");function f(g,x,y,k){if((g=o.from(g.toArray())).length<x.byteLength()){var N=o.alloc(x.byteLength()-g.length);g=o.concat([N,g])}var F=y.length,B=function(q,X){q=(q=h(q,X)).mod(X);var I=o.from(q.toArray());if(I.length<X.byteLength()){var H=o.alloc(X.byteLength()-I.length);I=o.concat([H,I])}return I}(y,x),W=o.alloc(F);W.fill(1);var V=o.alloc(F);return V=s(k,V).update(W).update(o.from([0])).update(g).update(B).digest(),W=s(k,V).update(W).digest(),{k:V=s(k,V).update(W).update(o.from([1])).update(g).update(B).digest(),v:W=s(k,V).update(W).digest()}}function h(g,x){var y=new i(g),k=(g.length<<3)-x.bitLength();return k>0&&y.ishrn(k),y}function v(g,x,y){var k,N;do{for(k=o.alloc(0);8*k.length<g.bitLength();)x.v=s(y,x.k).update(x.v).digest(),k=o.concat([k,x.v]);N=h(k,g),x.k=s(y,x.k).update(x.v).update(o.from([0])).digest(),x.v=s(y,x.k).update(x.v).digest()}while(N.cmp(g)!==-1);return N}function b(g,x,y,k){return g.toRed(i.mont(y)).redPow(x).fromRed().mod(k)}n.exports=function(g,x,y,k,N){var F=u(x);if(F.curve){if(k!=="ecdsa"&&k!=="ecdsa/rsa")throw new Error("wrong private key type");return function(q,X){var I=p[X.curve.join(".")];if(!I)throw new Error("unknown curve "+X.curve.join("."));var H=new c(I).keyFromPrivate(X.privateKey).sign(q);return o.from(H.toDER())}(g,F)}if(F.type==="dsa"){if(k!=="dsa")throw new Error("wrong private key type");return function(q,X,I){for(var H,O=X.params.priv_key,R=X.params.p,C=X.params.q,w=X.params.g,E=new i(0),A=h(q,C).mod(C),T=!1,D=f(O,C,q,I);T===!1;)H=v(C,D,I),E=b(w,H,R,C),(T=H.invm(C).imul(A.add(O.mul(E))).mod(C)).cmpn(0)===0&&(T=!1,E=new i(0));return function(U,P){U=U.toArray(),P=P.toArray(),128&U[0]&&(U=[0].concat(U)),128&P[0]&&(P=[0].concat(P));var K=[48,U.length+P.length+4,2,U.length];return K=K.concat(U,[2,P.length],P),o.from(K)}(E,T)}(g,F,y)}if(k!=="rsa"&&k!=="ecdsa/rsa")throw new Error("wrong private key type");g=o.concat([N,g]);for(var B=F.modulus.byteLength(),W=[0,1];g.length+W.length+1<B;)W.push(255);W.push(0);for(var V=-1;++V<g.length;)W.push(g[V]);return l(W,F)},n.exports.getKey=f,n.exports.makeKey=v},{"./curves.json":212,"bn.js":186,"browserify-rsa":209,"create-hmac":388,elliptic:405,"parse-asn1":459,"safe-buffer":494}],215:[function(e,n,a){var o=e("safe-buffer").Buffer,s=e("bn.js"),l=e("elliptic").ec,c=e("parse-asn1"),i=e("./curves.json");function u(p,f){if(p.cmpn(0)<=0)throw new Error("invalid sig");if(p.cmp(f)>=f)throw new Error("invalid sig")}n.exports=function(p,f,h,v,b){var g=c(h);if(g.type==="ec"){if(v!=="ecdsa"&&v!=="ecdsa/rsa")throw new Error("wrong public key type");return function(W,V,q){var X=i[q.data.algorithm.curve.join(".")];if(!X)throw new Error("unknown curve "+q.data.algorithm.curve.join("."));var I=new l(X),H=q.data.subjectPrivateKey.data;return I.verify(V,W,H)}(p,f,g)}if(g.type==="dsa"){if(v!=="dsa")throw new Error("wrong public key type");return function(W,V,q){var X=q.data.p,I=q.data.q,H=q.data.g,O=q.data.pub_key,R=c.signature.decode(W,"der"),C=R.s,w=R.r;u(C,I),u(w,I);var E=s.mont(X),A=C.invm(I);return H.toRed(E).redPow(new s(V).mul(A).mod(I)).fromRed().mul(O.toRed(E).redPow(w.mul(A).mod(I)).fromRed()).mod(X).mod(I).cmp(w)===0}(p,f,g)}if(v!=="rsa"&&v!=="ecdsa/rsa")throw new Error("wrong public key type");f=o.concat([b,f]);for(var x=g.modulus.byteLength(),y=[1],k=0;f.length+y.length+2<x;)y.push(255),k++;y.push(0);for(var N=-1;++N<f.length;)y.push(f[N]);y=o.from(y);var F=s.mont(g.modulus);p=(p=new s(p).toRed(F)).redPow(new s(g.publicExponent)),p=o.from(p.fromRed().toArray());var B=k<8?1:0;for(x=Math.min(p.length,y.length),p.length!==y.length&&(B=1),N=-1;++N<x;)B|=p[N]^y[N];return B===0}},{"./curves.json":212,"bn.js":186,elliptic:405,"parse-asn1":459,"safe-buffer":494}],216:[function(e,n,a){},{}],217:[function(e,n,a){var o=e("buffer"),s=o.Buffer;function l(i,u){for(var p in i)u[p]=i[p]}function c(i,u,p){return s(i,u,p)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?n.exports=o:(l(o,a),a.Buffer=c),l(s,c),c.from=function(i,u,p){if(typeof i=="number")throw new TypeError("Argument must not be a number");return s(i,u,p)},c.alloc=function(i,u,p){if(typeof i!="number")throw new TypeError("Argument must be a number");var f=s(i);return u!==void 0?typeof p=="string"?f.fill(u,p):f.fill(u):f.fill(0),f},c.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return s(i)},c.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return o.SlowBuffer(i)}},{buffer:220}],218:[function(e,n,a){var o=e("safe-buffer").Buffer,s=o.isEncoding||function(g){switch((g=""+g)&&g.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function l(g){var x;switch(this.encoding=function(y){var k=function(N){if(!N)return"utf8";for(var F;;)switch(N){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return N;default:if(F)return;N=(""+N).toLowerCase(),F=!0}}(y);if(typeof k!="string"&&(o.isEncoding===s||!s(y)))throw new Error("Unknown encoding: "+y);return k||y}(g),this.encoding){case"utf16le":this.text=u,this.end=p,x=4;break;case"utf8":this.fillLast=i,x=4;break;case"base64":this.text=f,this.end=h,x=3;break;default:return this.write=v,void(this.end=b)}this.lastNeed=0,this.lastTotal=0,this.lastChar=o.allocUnsafe(x)}function c(g){return g<=127?0:g>>5==6?2:g>>4==14?3:g>>3==30?4:g>>6==2?-1:-2}function i(g){var x=this.lastTotal-this.lastNeed,y=function(k,N,F){if((192&N[0])!=128)return k.lastNeed=0,"";if(k.lastNeed>1&&N.length>1){if((192&N[1])!=128)return k.lastNeed=1,"";if(k.lastNeed>2&&N.length>2&&(192&N[2])!=128)return k.lastNeed=2,""}}(this,g);return y!==void 0?y:this.lastNeed<=g.length?(g.copy(this.lastChar,x,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(g.copy(this.lastChar,x,0,g.length),void(this.lastNeed-=g.length))}function u(g,x){if((g.length-x)%2==0){var y=g.toString("utf16le",x);if(y){var k=y.charCodeAt(y.length-1);if(k>=55296&&k<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=g[g.length-2],this.lastChar[1]=g[g.length-1],y.slice(0,-1)}return y}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=g[g.length-1],g.toString("utf16le",x,g.length-1)}function p(g){var x=g&&g.length?this.write(g):"";if(this.lastNeed){var y=this.lastTotal-this.lastNeed;return x+this.lastChar.toString("utf16le",0,y)}return x}function f(g,x){var y=(g.length-x)%3;return y===0?g.toString("base64",x):(this.lastNeed=3-y,this.lastTotal=3,y===1?this.lastChar[0]=g[g.length-1]:(this.lastChar[0]=g[g.length-2],this.lastChar[1]=g[g.length-1]),g.toString("base64",x,g.length-y))}function h(g){var x=g&&g.length?this.write(g):"";return this.lastNeed?x+this.lastChar.toString("base64",0,3-this.lastNeed):x}function v(g){return g.toString(this.encoding)}function b(g){return g&&g.length?this.write(g):""}a.StringDecoder=l,l.prototype.write=function(g){if(g.length===0)return"";var x,y;if(this.lastNeed){if((x=this.fillLast(g))===void 0)return"";y=this.lastNeed,this.lastNeed=0}else y=0;return y<g.length?x?x+this.text(g,y):this.text(g,y):x||""},l.prototype.end=function(g){var x=g&&g.length?this.write(g):"";return this.lastNeed?x+"":x},l.prototype.text=function(g,x){var y=function(N,F,B){var W=F.length-1;if(W<B)return 0;var V=c(F[W]);return V>=0?(V>0&&(N.lastNeed=V-1),V):--W<B||V===-2?0:(V=c(F[W]))>=0?(V>0&&(N.lastNeed=V-2),V):--W<B||V===-2?0:(V=c(F[W]))>=0?(V>0&&(V===2?V=0:N.lastNeed=V-3),V):0}(this,g,x);if(!this.lastNeed)return g.toString("utf8",x);this.lastTotal=y;var k=g.length-(y-this.lastNeed);return g.copy(this.lastChar,0,k),g.toString("utf8",x,k)},l.prototype.fillLast=function(g){if(this.lastNeed<=g.length)return g.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);g.copy(this.lastChar,this.lastTotal-this.lastNeed,0,g.length),this.lastNeed-=g.length}},{"safe-buffer":217}],219:[function(e,n,a){(function(o){(function(){n.exports=function(s,l){for(var c=Math.min(s.length,l.length),i=new o(c),u=0;u<c;++u)i[u]=s[u]^l[u];return i}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:220}],220:[function(e,n,a){(function(o){(function(){var s=e("base64-js"),l=e("ieee754");a.Buffer=i,a.SlowBuffer=function(L){return+L!=L&&(L=0),i.alloc(+L)},a.INSPECT_MAX_BYTES=50;function c(L){if(L>2147483647)throw new RangeError('The value "'+L+'" is invalid for option "size"');var M=new Uint8Array(L);return M.__proto__=i.prototype,M}function i(L,M,Z){if(typeof L=="number"){if(typeof M=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(L)}return u(L,M,Z)}function u(L,M,Z){if(typeof L=="string")return function(ne,Q){if(typeof Q=="string"&&Q!==""||(Q="utf8"),!i.isEncoding(Q))throw new TypeError("Unknown encoding: "+Q);var fe=0|b(ne,Q),le=c(fe),te=le.write(ne,Q);return te!==fe&&(le=le.slice(0,te)),le}(L,M);if(ArrayBuffer.isView(L))return h(L);if(L==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L);if(z(L,ArrayBuffer)||L&&z(L.buffer,ArrayBuffer))return function(ne,Q,fe){if(Q<0||ne.byteLength<Q)throw new RangeError('"offset" is outside of buffer bounds');if(ne.byteLength<Q+(fe||0))throw new RangeError('"length" is outside of buffer bounds');var le;return le=Q===void 0&&fe===void 0?new Uint8Array(ne):fe===void 0?new Uint8Array(ne,Q):new Uint8Array(ne,Q,fe),le.__proto__=i.prototype,le}(L,M,Z);if(typeof L=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var se=L.valueOf&&L.valueOf();if(se!=null&&se!==L)return i.from(se,M,Z);var ae=function(ne){if(i.isBuffer(ne)){var Q=0|v(ne.length),fe=c(Q);return fe.length===0||ne.copy(fe,0,0,Q),fe}if(ne.length!==void 0)return typeof ne.length!="number"||ee(ne.length)?c(0):h(ne);if(ne.type==="Buffer"&&Array.isArray(ne.data))return h(ne.data)}(L);if(ae)return ae;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof L[Symbol.toPrimitive]=="function")return i.from(L[Symbol.toPrimitive]("string"),M,Z);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof L)}function p(L){if(typeof L!="number")throw new TypeError('"size" argument must be of type number');if(L<0)throw new RangeError('The value "'+L+'" is invalid for option "size"')}function f(L){return p(L),c(L<0?0:0|v(L))}function h(L){for(var M=L.length<0?0:0|v(L.length),Z=c(M),se=0;se<M;se+=1)Z[se]=255&L[se];return Z}function v(L){if(L>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|L}function b(L,M){if(i.isBuffer(L))return L.length;if(ArrayBuffer.isView(L)||z(L,ArrayBuffer))return L.byteLength;if(typeof L!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof L);var Z=L.length,se=arguments.length>2&&arguments[2]===!0;if(!se&&Z===0)return 0;for(var ae=!1;;)switch(M){case"ascii":case"latin1":case"binary":return Z;case"utf8":case"utf-8":return K(L).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*Z;case"hex":return Z>>>1;case"base64":return Y(L).length;default:if(ae)return se?-1:K(L).length;M=(""+M).toLowerCase(),ae=!0}}function g(L,M,Z){var se=!1;if((M===void 0||M<0)&&(M=0),M>this.length||((Z===void 0||Z>this.length)&&(Z=this.length),Z<=0)||(Z>>>=0)<=(M>>>=0))return"";for(L||(L="utf8");;)switch(L){case"hex":return R(this,M,Z);case"utf8":case"utf-8":return I(this,M,Z);case"ascii":return H(this,M,Z);case"latin1":case"binary":return O(this,M,Z);case"base64":return X(this,M,Z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,M,Z);default:if(se)throw new TypeError("Unknown encoding: "+L);L=(L+"").toLowerCase(),se=!0}}function x(L,M,Z){var se=L[M];L[M]=L[Z],L[Z]=se}function y(L,M,Z,se,ae){if(L.length===0)return-1;if(typeof Z=="string"?(se=Z,Z=0):Z>2147483647?Z=2147483647:Z<-2147483648&&(Z=-2147483648),ee(Z=+Z)&&(Z=ae?0:L.length-1),Z<0&&(Z=L.length+Z),Z>=L.length){if(ae)return-1;Z=L.length-1}else if(Z<0){if(!ae)return-1;Z=0}if(typeof M=="string"&&(M=i.from(M,se)),i.isBuffer(M))return M.length===0?-1:k(L,M,Z,se,ae);if(typeof M=="number")return M&=255,typeof Uint8Array.prototype.indexOf=="function"?ae?Uint8Array.prototype.indexOf.call(L,M,Z):Uint8Array.prototype.lastIndexOf.call(L,M,Z):k(L,[M],Z,se,ae);throw new TypeError("val must be string, number or Buffer")}function k(L,M,Z,se,ae){var ne,Q=1,fe=L.length,le=M.length;if(se!==void 0&&((se=String(se).toLowerCase())==="ucs2"||se==="ucs-2"||se==="utf16le"||se==="utf-16le")){if(L.length<2||M.length<2)return-1;Q=2,fe/=2,le/=2,Z/=2}function te(ke,Ce){return Q===1?ke[Ce]:ke.readUInt16BE(Ce*Q)}if(ae){var ce=-1;for(ne=Z;ne<fe;ne++)if(te(L,ne)===te(M,ce===-1?0:ne-ce)){if(ce===-1&&(ce=ne),ne-ce+1===le)return ce*Q}else ce!==-1&&(ne-=ne-ce),ce=-1}else for(Z+le>fe&&(Z=fe-le),ne=Z;ne>=0;ne--){for(var he=!0,Ee=0;Ee<le;Ee++)if(te(L,ne+Ee)!==te(M,Ee)){he=!1;break}if(he)return ne}return-1}function N(L,M,Z,se){Z=Number(Z)||0;var ae=L.length-Z;se?(se=Number(se))>ae&&(se=ae):se=ae;var ne=M.length;se>ne/2&&(se=ne/2);for(var Q=0;Q<se;++Q){var fe=parseInt(M.substr(2*Q,2),16);if(ee(fe))return Q;L[Z+Q]=fe}return Q}function F(L,M,Z,se){return re(K(M,L.length-Z),L,Z,se)}function B(L,M,Z,se){return re(function(ae){for(var ne=[],Q=0;Q<ae.length;++Q)ne.push(255&ae.charCodeAt(Q));return ne}(M),L,Z,se)}function W(L,M,Z,se){return B(L,M,Z,se)}function V(L,M,Z,se){return re(Y(M),L,Z,se)}function q(L,M,Z,se){return re(function(ae,ne){for(var Q,fe,le,te=[],ce=0;ce<ae.length&&!((ne-=2)<0);++ce)Q=ae.charCodeAt(ce),fe=Q>>8,le=Q%256,te.push(le),te.push(fe);return te}(M,L.length-Z),L,Z,se)}function X(L,M,Z){return M===0&&Z===L.length?s.fromByteArray(L):s.fromByteArray(L.slice(M,Z))}function I(L,M,Z){Z=Math.min(L.length,Z);for(var se=[],ae=M;ae<Z;){var ne,Q,fe,le,te=L[ae],ce=null,he=te>239?4:te>223?3:te>191?2:1;if(ae+he<=Z)switch(he){case 1:te<128&&(ce=te);break;case 2:(192&(ne=L[ae+1]))==128&&(le=(31&te)<<6|63&ne)>127&&(ce=le);break;case 3:ne=L[ae+1],Q=L[ae+2],(192&ne)==128&&(192&Q)==128&&(le=(15&te)<<12|(63&ne)<<6|63&Q)>2047&&(le<55296||le>57343)&&(ce=le);break;case 4:ne=L[ae+1],Q=L[ae+2],fe=L[ae+3],(192&ne)==128&&(192&Q)==128&&(192&fe)==128&&(le=(15&te)<<18|(63&ne)<<12|(63&Q)<<6|63&fe)>65535&&le<1114112&&(ce=le)}ce===null?(ce=65533,he=1):ce>65535&&(ce-=65536,se.push(ce>>>10&1023|55296),ce=56320|1023&ce),se.push(ce),ae+=he}return function(Ee){var ke=Ee.length;if(ke<=4096)return String.fromCharCode.apply(String,Ee);for(var Ce="",Fe=0;Fe<ke;)Ce+=String.fromCharCode.apply(String,Ee.slice(Fe,Fe+=4096));return Ce}(se)}a.kMaxLength=2147483647,i.TYPED_ARRAY_SUPPORT=function(){try{var L=new Uint8Array(1);return L.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},L.foo()===42}catch{return!1}}(),i.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(i.prototype,"parent",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.buffer}}),Object.defineProperty(i.prototype,"offset",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),i.poolSize=8192,i.from=function(L,M,Z){return u(L,M,Z)},i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,i.alloc=function(L,M,Z){return function(se,ae,ne){return p(se),se<=0?c(se):ae!==void 0?typeof ne=="string"?c(se).fill(ae,ne):c(se).fill(ae):c(se)}(L,M,Z)},i.allocUnsafe=function(L){return f(L)},i.allocUnsafeSlow=function(L){return f(L)},i.isBuffer=function(L){return L!=null&&L._isBuffer===!0&&L!==i.prototype},i.compare=function(L,M){if(z(L,Uint8Array)&&(L=i.from(L,L.offset,L.byteLength)),z(M,Uint8Array)&&(M=i.from(M,M.offset,M.byteLength)),!i.isBuffer(L)||!i.isBuffer(M))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(L===M)return 0;for(var Z=L.length,se=M.length,ae=0,ne=Math.min(Z,se);ae<ne;++ae)if(L[ae]!==M[ae]){Z=L[ae],se=M[ae];break}return Z<se?-1:se<Z?1:0},i.isEncoding=function(L){switch(String(L).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(L,M){if(!Array.isArray(L))throw new TypeError('"list" argument must be an Array of Buffers');if(L.length===0)return i.alloc(0);var Z;if(M===void 0)for(M=0,Z=0;Z<L.length;++Z)M+=L[Z].length;var se=i.allocUnsafe(M),ae=0;for(Z=0;Z<L.length;++Z){var ne=L[Z];if(z(ne,Uint8Array)&&(ne=i.from(ne)),!i.isBuffer(ne))throw new TypeError('"list" argument must be an Array of Buffers');ne.copy(se,ae),ae+=ne.length}return se},i.byteLength=b,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var L=this.length;if(L%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var M=0;M<L;M+=2)x(this,M,M+1);return this},i.prototype.swap32=function(){var L=this.length;if(L%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var M=0;M<L;M+=4)x(this,M,M+3),x(this,M+1,M+2);return this},i.prototype.swap64=function(){var L=this.length;if(L%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var M=0;M<L;M+=8)x(this,M,M+7),x(this,M+1,M+6),x(this,M+2,M+5),x(this,M+3,M+4);return this},i.prototype.toString=function(){var L=this.length;return L===0?"":arguments.length===0?I(this,0,L):g.apply(this,arguments)},i.prototype.toLocaleString=i.prototype.toString,i.prototype.equals=function(L){if(!i.isBuffer(L))throw new TypeError("Argument must be a Buffer");return this===L||i.compare(this,L)===0},i.prototype.inspect=function(){var L="",M=a.INSPECT_MAX_BYTES;return L=this.toString("hex",0,M).replace(/(.{2})/g,"$1 ").trim(),this.length>M&&(L+=" ... "),"<Buffer "+L+">"},i.prototype.compare=function(L,M,Z,se,ae){if(z(L,Uint8Array)&&(L=i.from(L,L.offset,L.byteLength)),!i.isBuffer(L))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof L);if(M===void 0&&(M=0),Z===void 0&&(Z=L?L.length:0),se===void 0&&(se=0),ae===void 0&&(ae=this.length),M<0||Z>L.length||se<0||ae>this.length)throw new RangeError("out of range index");if(se>=ae&&M>=Z)return 0;if(se>=ae)return-1;if(M>=Z)return 1;if(this===L)return 0;for(var ne=(ae>>>=0)-(se>>>=0),Q=(Z>>>=0)-(M>>>=0),fe=Math.min(ne,Q),le=this.slice(se,ae),te=L.slice(M,Z),ce=0;ce<fe;++ce)if(le[ce]!==te[ce]){ne=le[ce],Q=te[ce];break}return ne<Q?-1:Q<ne?1:0},i.prototype.includes=function(L,M,Z){return this.indexOf(L,M,Z)!==-1},i.prototype.indexOf=function(L,M,Z){return y(this,L,M,Z,!0)},i.prototype.lastIndexOf=function(L,M,Z){return y(this,L,M,Z,!1)},i.prototype.write=function(L,M,Z,se){if(M===void 0)se="utf8",Z=this.length,M=0;else if(Z===void 0&&typeof M=="string")se=M,Z=this.length,M=0;else{if(!isFinite(M))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");M>>>=0,isFinite(Z)?(Z>>>=0,se===void 0&&(se="utf8")):(se=Z,Z=void 0)}var ae=this.length-M;if((Z===void 0||Z>ae)&&(Z=ae),L.length>0&&(Z<0||M<0)||M>this.length)throw new RangeError("Attempt to write outside buffer bounds");se||(se="utf8");for(var ne=!1;;)switch(se){case"hex":return N(this,L,M,Z);case"utf8":case"utf-8":return F(this,L,M,Z);case"ascii":return B(this,L,M,Z);case"latin1":case"binary":return W(this,L,M,Z);case"base64":return V(this,L,M,Z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,L,M,Z);default:if(ne)throw new TypeError("Unknown encoding: "+se);se=(""+se).toLowerCase(),ne=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function H(L,M,Z){var se="";Z=Math.min(L.length,Z);for(var ae=M;ae<Z;++ae)se+=String.fromCharCode(127&L[ae]);return se}function O(L,M,Z){var se="";Z=Math.min(L.length,Z);for(var ae=M;ae<Z;++ae)se+=String.fromCharCode(L[ae]);return se}function R(L,M,Z){var se=L.length;(!M||M<0)&&(M=0),(!Z||Z<0||Z>se)&&(Z=se);for(var ae="",ne=M;ne<Z;++ne)ae+=P(L[ne]);return ae}function C(L,M,Z){for(var se=L.slice(M,Z),ae="",ne=0;ne<se.length;ne+=2)ae+=String.fromCharCode(se[ne]+256*se[ne+1]);return ae}function w(L,M,Z){if(L%1!=0||L<0)throw new RangeError("offset is not uint");if(L+M>Z)throw new RangeError("Trying to access beyond buffer length")}function E(L,M,Z,se,ae,ne){if(!i.isBuffer(L))throw new TypeError('"buffer" argument must be a Buffer instance');if(M>ae||M<ne)throw new RangeError('"value" argument is out of bounds');if(Z+se>L.length)throw new RangeError("Index out of range")}function A(L,M,Z,se,ae,ne){if(Z+se>L.length)throw new RangeError("Index out of range");if(Z<0)throw new RangeError("Index out of range")}function T(L,M,Z,se,ae){return M=+M,Z>>>=0,ae||A(L,0,Z,4),l.write(L,M,Z,se,23,4),Z+4}function D(L,M,Z,se,ae){return M=+M,Z>>>=0,ae||A(L,0,Z,8),l.write(L,M,Z,se,52,8),Z+8}i.prototype.slice=function(L,M){var Z=this.length;(L=~~L)<0?(L+=Z)<0&&(L=0):L>Z&&(L=Z),(M=M===void 0?Z:~~M)<0?(M+=Z)<0&&(M=0):M>Z&&(M=Z),M<L&&(M=L);var se=this.subarray(L,M);return se.__proto__=i.prototype,se},i.prototype.readUIntLE=function(L,M,Z){L>>>=0,M>>>=0,Z||w(L,M,this.length);for(var se=this[L],ae=1,ne=0;++ne<M&&(ae*=256);)se+=this[L+ne]*ae;return se},i.prototype.readUIntBE=function(L,M,Z){L>>>=0,M>>>=0,Z||w(L,M,this.length);for(var se=this[L+--M],ae=1;M>0&&(ae*=256);)se+=this[L+--M]*ae;return se},i.prototype.readUInt8=function(L,M){return L>>>=0,M||w(L,1,this.length),this[L]},i.prototype.readUInt16LE=function(L,M){return L>>>=0,M||w(L,2,this.length),this[L]|this[L+1]<<8},i.prototype.readUInt16BE=function(L,M){return L>>>=0,M||w(L,2,this.length),this[L]<<8|this[L+1]},i.prototype.readUInt32LE=function(L,M){return L>>>=0,M||w(L,4,this.length),(this[L]|this[L+1]<<8|this[L+2]<<16)+16777216*this[L+3]},i.prototype.readUInt32BE=function(L,M){return L>>>=0,M||w(L,4,this.length),16777216*this[L]+(this[L+1]<<16|this[L+2]<<8|this[L+3])},i.prototype.readIntLE=function(L,M,Z){L>>>=0,M>>>=0,Z||w(L,M,this.length);for(var se=this[L],ae=1,ne=0;++ne<M&&(ae*=256);)se+=this[L+ne]*ae;return se>=(ae*=128)&&(se-=Math.pow(2,8*M)),se},i.prototype.readIntBE=function(L,M,Z){L>>>=0,M>>>=0,Z||w(L,M,this.length);for(var se=M,ae=1,ne=this[L+--se];se>0&&(ae*=256);)ne+=this[L+--se]*ae;return ne>=(ae*=128)&&(ne-=Math.pow(2,8*M)),ne},i.prototype.readInt8=function(L,M){return L>>>=0,M||w(L,1,this.length),128&this[L]?-1*(255-this[L]+1):this[L]},i.prototype.readInt16LE=function(L,M){L>>>=0,M||w(L,2,this.length);var Z=this[L]|this[L+1]<<8;return 32768&Z?4294901760|Z:Z},i.prototype.readInt16BE=function(L,M){L>>>=0,M||w(L,2,this.length);var Z=this[L+1]|this[L]<<8;return 32768&Z?4294901760|Z:Z},i.prototype.readInt32LE=function(L,M){return L>>>=0,M||w(L,4,this.length),this[L]|this[L+1]<<8|this[L+2]<<16|this[L+3]<<24},i.prototype.readInt32BE=function(L,M){return L>>>=0,M||w(L,4,this.length),this[L]<<24|this[L+1]<<16|this[L+2]<<8|this[L+3]},i.prototype.readFloatLE=function(L,M){return L>>>=0,M||w(L,4,this.length),l.read(this,L,!0,23,4)},i.prototype.readFloatBE=function(L,M){return L>>>=0,M||w(L,4,this.length),l.read(this,L,!1,23,4)},i.prototype.readDoubleLE=function(L,M){return L>>>=0,M||w(L,8,this.length),l.read(this,L,!0,52,8)},i.prototype.readDoubleBE=function(L,M){return L>>>=0,M||w(L,8,this.length),l.read(this,L,!1,52,8)},i.prototype.writeUIntLE=function(L,M,Z,se){L=+L,M>>>=0,Z>>>=0,se||E(this,L,M,Z,Math.pow(2,8*Z)-1,0);var ae=1,ne=0;for(this[M]=255&L;++ne<Z&&(ae*=256);)this[M+ne]=L/ae&255;return M+Z},i.prototype.writeUIntBE=function(L,M,Z,se){L=+L,M>>>=0,Z>>>=0,se||E(this,L,M,Z,Math.pow(2,8*Z)-1,0);var ae=Z-1,ne=1;for(this[M+ae]=255&L;--ae>=0&&(ne*=256);)this[M+ae]=L/ne&255;return M+Z},i.prototype.writeUInt8=function(L,M,Z){return L=+L,M>>>=0,Z||E(this,L,M,1,255,0),this[M]=255&L,M+1},i.prototype.writeUInt16LE=function(L,M,Z){return L=+L,M>>>=0,Z||E(this,L,M,2,65535,0),this[M]=255&L,this[M+1]=L>>>8,M+2},i.prototype.writeUInt16BE=function(L,M,Z){return L=+L,M>>>=0,Z||E(this,L,M,2,65535,0),this[M]=L>>>8,this[M+1]=255&L,M+2},i.prototype.writeUInt32LE=function(L,M,Z){return L=+L,M>>>=0,Z||E(this,L,M,4,4294967295,0),this[M+3]=L>>>24,this[M+2]=L>>>16,this[M+1]=L>>>8,this[M]=255&L,M+4},i.prototype.writeUInt32BE=function(L,M,Z){return L=+L,M>>>=0,Z||E(this,L,M,4,4294967295,0),this[M]=L>>>24,this[M+1]=L>>>16,this[M+2]=L>>>8,this[M+3]=255&L,M+4},i.prototype.writeIntLE=function(L,M,Z,se){if(L=+L,M>>>=0,!se){var ae=Math.pow(2,8*Z-1);E(this,L,M,Z,ae-1,-ae)}var ne=0,Q=1,fe=0;for(this[M]=255&L;++ne<Z&&(Q*=256);)L<0&&fe===0&&this[M+ne-1]!==0&&(fe=1),this[M+ne]=(L/Q>>0)-fe&255;return M+Z},i.prototype.writeIntBE=function(L,M,Z,se){if(L=+L,M>>>=0,!se){var ae=Math.pow(2,8*Z-1);E(this,L,M,Z,ae-1,-ae)}var ne=Z-1,Q=1,fe=0;for(this[M+ne]=255&L;--ne>=0&&(Q*=256);)L<0&&fe===0&&this[M+ne+1]!==0&&(fe=1),this[M+ne]=(L/Q>>0)-fe&255;return M+Z},i.prototype.writeInt8=function(L,M,Z){return L=+L,M>>>=0,Z||E(this,L,M,1,127,-128),L<0&&(L=255+L+1),this[M]=255&L,M+1},i.prototype.writeInt16LE=function(L,M,Z){return L=+L,M>>>=0,Z||E(this,L,M,2,32767,-32768),this[M]=255&L,this[M+1]=L>>>8,M+2},i.prototype.writeInt16BE=function(L,M,Z){return L=+L,M>>>=0,Z||E(this,L,M,2,32767,-32768),this[M]=L>>>8,this[M+1]=255&L,M+2},i.prototype.writeInt32LE=function(L,M,Z){return L=+L,M>>>=0,Z||E(this,L,M,4,2147483647,-2147483648),this[M]=255&L,this[M+1]=L>>>8,this[M+2]=L>>>16,this[M+3]=L>>>24,M+4},i.prototype.writeInt32BE=function(L,M,Z){return L=+L,M>>>=0,Z||E(this,L,M,4,2147483647,-2147483648),L<0&&(L=4294967295+L+1),this[M]=L>>>24,this[M+1]=L>>>16,this[M+2]=L>>>8,this[M+3]=255&L,M+4},i.prototype.writeFloatLE=function(L,M,Z){return T(this,L,M,!0,Z)},i.prototype.writeFloatBE=function(L,M,Z){return T(this,L,M,!1,Z)},i.prototype.writeDoubleLE=function(L,M,Z){return D(this,L,M,!0,Z)},i.prototype.writeDoubleBE=function(L,M,Z){return D(this,L,M,!1,Z)},i.prototype.copy=function(L,M,Z,se){if(!i.isBuffer(L))throw new TypeError("argument should be a Buffer");if(Z||(Z=0),se||se===0||(se=this.length),M>=L.length&&(M=L.length),M||(M=0),se>0&&se<Z&&(se=Z),se===Z||L.length===0||this.length===0)return 0;if(M<0)throw new RangeError("targetStart out of bounds");if(Z<0||Z>=this.length)throw new RangeError("Index out of range");if(se<0)throw new RangeError("sourceEnd out of bounds");se>this.length&&(se=this.length),L.length-M<se-Z&&(se=L.length-M+Z);var ae=se-Z;if(this===L&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(M,Z,se);else if(this===L&&Z<M&&M<se)for(var ne=ae-1;ne>=0;--ne)L[ne+M]=this[ne+Z];else Uint8Array.prototype.set.call(L,this.subarray(Z,se),M);return ae},i.prototype.fill=function(L,M,Z,se){if(typeof L=="string"){if(typeof M=="string"?(se=M,M=0,Z=this.length):typeof Z=="string"&&(se=Z,Z=this.length),se!==void 0&&typeof se!="string")throw new TypeError("encoding must be a string");if(typeof se=="string"&&!i.isEncoding(se))throw new TypeError("Unknown encoding: "+se);if(L.length===1){var ae=L.charCodeAt(0);(se==="utf8"&&ae<128||se==="latin1")&&(L=ae)}}else typeof L=="number"&&(L&=255);if(M<0||this.length<M||this.length<Z)throw new RangeError("Out of range index");if(Z<=M)return this;var ne;if(M>>>=0,Z=Z===void 0?this.length:Z>>>0,L||(L=0),typeof L=="number")for(ne=M;ne<Z;++ne)this[ne]=L;else{var Q=i.isBuffer(L)?L:i.from(L,se),fe=Q.length;if(fe===0)throw new TypeError('The value "'+L+'" is invalid for argument "value"');for(ne=0;ne<Z-M;++ne)this[ne+M]=Q[ne%fe]}return this};var U=/[^+/0-9A-Za-z-_]/g;function P(L){return L<16?"0"+L.toString(16):L.toString(16)}function K(L,M){var Z;M=M||1/0;for(var se=L.length,ae=null,ne=[],Q=0;Q<se;++Q){if((Z=L.charCodeAt(Q))>55295&&Z<57344){if(!ae){if(Z>56319){(M-=3)>-1&&ne.push(239,191,189);continue}if(Q+1===se){(M-=3)>-1&&ne.push(239,191,189);continue}ae=Z;continue}if(Z<56320){(M-=3)>-1&&ne.push(239,191,189),ae=Z;continue}Z=65536+(ae-55296<<10|Z-56320)}else ae&&(M-=3)>-1&&ne.push(239,191,189);if(ae=null,Z<128){if((M-=1)<0)break;ne.push(Z)}else if(Z<2048){if((M-=2)<0)break;ne.push(Z>>6|192,63&Z|128)}else if(Z<65536){if((M-=3)<0)break;ne.push(Z>>12|224,Z>>6&63|128,63&Z|128)}else{if(!(Z<1114112))throw new Error("Invalid code point");if((M-=4)<0)break;ne.push(Z>>18|240,Z>>12&63|128,Z>>6&63|128,63&Z|128)}}return ne}function Y(L){return s.toByteArray(function(M){if((M=(M=M.split("=")[0]).trim().replace(U,"")).length<2)return"";for(;M.length%4!=0;)M+="=";return M}(L))}function re(L,M,Z,se){for(var ae=0;ae<se&&!(ae+Z>=M.length||ae>=L.length);++ae)M[ae+Z]=L[ae];return ae}function z(L,M){return L instanceof M||L!=null&&L.constructor!=null&&L.constructor.name!=null&&L.constructor.name===M.name}function ee(L){return L!=L}}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":185,buffer:220,ieee754:439}],221:[function(e,n,a){var o=e("safe-buffer").Buffer,s=e("stream").Transform,l=e("string_decoder").StringDecoder;function c(i){s.call(this),this.hashMode=typeof i=="string",this.hashMode?this[i]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}e("inherits")(c,s),c.prototype.update=function(i,u,p){typeof i=="string"&&(i=o.from(i,u));var f=this._update(i);return this.hashMode?this:(p&&(f=this._toString(f,p)),f)},c.prototype.setAutoPadding=function(){},c.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},c.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},c.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},c.prototype._transform=function(i,u,p){var f;try{this.hashMode?this._update(i):this.push(this._update(i))}catch(h){f=h}finally{p(f)}},c.prototype._flush=function(i){var u;try{this.push(this.__final())}catch(p){u=p}i(u)},c.prototype._finalOrDigest=function(i){var u=this.__final()||o.alloc(0);return i&&(u=this._toString(u,i,!0)),u},c.prototype._toString=function(i,u,p){if(this._decoder||(this._decoder=new l(u),this._encoding=u),this._encoding!==u)throw new Error("can't switch encodings");var f=this._decoder.write(i);return p&&(f+=this._decoder.end()),f},n.exports=c},{inherits:440,"safe-buffer":494,stream:505,string_decoder:218}],222:[function(e,n,a){var o=e("../internals/is-callable"),s=e("../internals/try-to-string"),l=TypeError;n.exports=function(c){if(o(c))return c;throw new l(s(c)+" is not a function")}},{"../internals/is-callable":285,"../internals/try-to-string":349}],223:[function(e,n,a){var o=e("../internals/is-constructor"),s=e("../internals/try-to-string"),l=TypeError;n.exports=function(c){if(o(c))return c;throw new l(s(c)+" is not a constructor")}},{"../internals/is-constructor":286,"../internals/try-to-string":349}],224:[function(e,n,a){var o=e("../internals/is-callable"),s=String,l=TypeError;n.exports=function(c){if(typeof c=="object"||o(c))return c;throw new l("Can't set "+s(c)+" as a prototype")}},{"../internals/is-callable":285}],225:[function(e,n,a){var o=e("../internals/well-known-symbol"),s=e("../internals/object-create"),l=e("../internals/object-define-property").f,c=o("unscopables"),i=Array.prototype;i[c]===void 0&&l(i,c,{configurable:!0,value:s(null)}),n.exports=function(u){i[c][u]=!0}},{"../internals/object-create":306,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],226:[function(e,n,a){var o=e("../internals/object-is-prototype-of"),s=TypeError;n.exports=function(l,c){if(o(c,l))return l;throw new s("Incorrect invocation")}},{"../internals/object-is-prototype-of":314}],227:[function(e,n,a){var o=e("../internals/is-object"),s=String,l=TypeError;n.exports=function(c){if(o(c))return c;throw new l(s(c)+" is not an object")}},{"../internals/is-object":289}],228:[function(e,n,a){var o=e("../internals/to-indexed-object"),s=e("../internals/to-absolute-index"),l=e("../internals/length-of-array-like"),c=function(i){return function(u,p,f){var h,v=o(u),b=l(v),g=s(f,b);if(i&&p!=p){for(;b>g;)if((h=v[g++])!=h)return!0}else for(;b>g;g++)if((i||g in v)&&v[g]===p)return i||g||0;return!i&&-1}};n.exports={includes:c(!0),indexOf:c(!1)}},{"../internals/length-of-array-like":299,"../internals/to-absolute-index":340,"../internals/to-indexed-object":341}],229:[function(e,n,a){var o=e("../internals/function-bind-context"),s=e("../internals/function-uncurry-this"),l=e("../internals/indexed-object"),c=e("../internals/to-object"),i=e("../internals/length-of-array-like"),u=e("../internals/array-species-create"),p=s([].push),f=function(h){var v=h===1,b=h===2,g=h===3,x=h===4,y=h===6,k=h===7,N=h===5||y;return function(F,B,W,V){for(var q,X,I=c(F),H=l(I),O=o(B,W),R=i(H),C=0,w=V||u,E=v?w(F,R):b||k?w(F,0):void 0;R>C;C++)if((N||C in H)&&(X=O(q=H[C],C,I),h))if(v)E[C]=X;else if(X)switch(h){case 3:return!0;case 5:return q;case 6:return C;case 2:p(E,q)}else switch(h){case 4:return!1;case 7:p(E,q)}return y?-1:g||x?x:E}};n.exports={forEach:f(0),map:f(1),filter:f(2),some:f(3),every:f(4),find:f(5),findIndex:f(6),filterReject:f(7)}},{"../internals/array-species-create":233,"../internals/function-bind-context":262,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/length-of-array-like":299,"../internals/to-object":344}],230:[function(e,n,a){var o=e("../internals/to-absolute-index"),s=e("../internals/length-of-array-like"),l=e("../internals/create-property"),c=Array,i=Math.max;n.exports=function(u,p,f){for(var h=s(u),v=o(p,h),b=o(f===void 0?h:f,h),g=c(i(b-v,0)),x=0;v<b;v++,x++)l(g,x,u[v]);return g.length=x,g}},{"../internals/create-property":243,"../internals/length-of-array-like":299,"../internals/to-absolute-index":340}],231:[function(e,n,a){var o=e("../internals/function-uncurry-this");n.exports=o([].slice)},{"../internals/function-uncurry-this":268}],232:[function(e,n,a){var o=e("../internals/is-array"),s=e("../internals/is-constructor"),l=e("../internals/is-object"),c=e("../internals/well-known-symbol")("species"),i=Array;n.exports=function(u){var p;return o(u)&&(p=u.constructor,(s(p)&&(p===i||o(p.prototype))||l(p)&&(p=p[c])===null)&&(p=void 0)),p===void 0?i:p}},{"../internals/is-array":284,"../internals/is-constructor":286,"../internals/is-object":289,"../internals/well-known-symbol":357}],233:[function(e,n,a){var o=e("../internals/array-species-constructor");n.exports=function(s,l){return new(o(s))(l===0?0:l)}},{"../internals/array-species-constructor":232}],234:[function(e,n,a){var o=e("../internals/well-known-symbol")("iterator"),s=!1;try{var l=0,c={next:function(){return{done:!!l++}},return:function(){s=!0}};c[o]=function(){return this},Array.from(c,function(){throw 2})}catch{}n.exports=function(i,u){try{if(!u&&!s)return!1}catch{return!1}var p=!1;try{var f={};f[o]=function(){return{next:function(){return{done:p=!0}}}},i(f)}catch{}return p}},{"../internals/well-known-symbol":357}],235:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=o({}.toString),l=o("".slice);n.exports=function(c){return l(s(c),8,-1)}},{"../internals/function-uncurry-this":268}],236:[function(e,n,a){var o=e("../internals/to-string-tag-support"),s=e("../internals/is-callable"),l=e("../internals/classof-raw"),c=e("../internals/well-known-symbol")("toStringTag"),i=Object,u=l(function(){return arguments}())==="Arguments";n.exports=o?l:function(p){var f,h,v;return p===void 0?"Undefined":p===null?"Null":typeof(h=function(b,g){try{return b[g]}catch{}}(f=i(p),c))=="string"?h:u?l(f):(v=l(f))==="Object"&&s(f.callee)?"Arguments":v}},{"../internals/classof-raw":235,"../internals/is-callable":285,"../internals/to-string-tag-support":347,"../internals/well-known-symbol":357}],237:[function(e,n,a){var o=e("../internals/has-own-property"),s=e("../internals/own-keys"),l=e("../internals/object-get-own-property-descriptor"),c=e("../internals/object-define-property");n.exports=function(i,u,p){for(var f=s(u),h=c.f,v=l.f,b=0;b<f.length;b++){var g=f[b];o(i,g)||p&&o(p,g)||h(i,g,v(u,g))}}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/own-keys":321}],238:[function(e,n,a){var o=e("../internals/well-known-symbol")("match");n.exports=function(s){var l=/./;try{"/./"[s](l)}catch{try{return l[o]=!1,"/./"[s](l)}catch{}}return!1}},{"../internals/well-known-symbol":357}],239:[function(e,n,a){var o=e("../internals/fails");n.exports=!o(function(){function s(){}return s.prototype.constructor=null,Object.getPrototypeOf(new s)!==s.prototype})},{"../internals/fails":260}],240:[function(e,n,a){n.exports=function(o,s){return{value:o,done:s}}},{}],241:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/object-define-property"),l=e("../internals/create-property-descriptor");n.exports=o?function(c,i,u){return s.f(c,i,l(1,u))}:function(c,i,u){return c[i]=u,c}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/object-define-property":308}],242:[function(e,n,a){n.exports=function(o,s){return{enumerable:!(1&o),configurable:!(2&o),writable:!(4&o),value:s}}},{}],243:[function(e,n,a){var o=e("../internals/to-property-key"),s=e("../internals/object-define-property"),l=e("../internals/create-property-descriptor");n.exports=function(c,i,u){var p=o(i);p in c?s.f(c,p,l(0,u)):c[p]=u}},{"../internals/create-property-descriptor":242,"../internals/object-define-property":308,"../internals/to-property-key":346}],244:[function(e,n,a){var o=e("../internals/make-built-in"),s=e("../internals/object-define-property");n.exports=function(l,c,i){return i.get&&o(i.get,c,{getter:!0}),i.set&&o(i.set,c,{setter:!0}),s.f(l,c,i)}},{"../internals/make-built-in":300,"../internals/object-define-property":308}],245:[function(e,n,a){var o=e("../internals/is-callable"),s=e("../internals/object-define-property"),l=e("../internals/make-built-in"),c=e("../internals/define-global-property");n.exports=function(i,u,p,f){f||(f={});var h=f.enumerable,v=f.name!==void 0?f.name:u;if(o(p)&&l(p,v,f),f.global)h?i[u]=p:c(u,p);else{try{f.unsafe?i[u]&&(h=!0):delete i[u]}catch{}h?i[u]=p:s.f(i,u,{value:p,enumerable:!1,configurable:!f.nonConfigurable,writable:!f.nonWritable})}return i}},{"../internals/define-global-property":246,"../internals/is-callable":285,"../internals/make-built-in":300,"../internals/object-define-property":308}],246:[function(e,n,a){var o=e("../internals/global"),s=Object.defineProperty;n.exports=function(l,c){try{s(o,l,{value:c,configurable:!0,writable:!0})}catch{o[l]=c}return c}},{"../internals/global":274}],247:[function(e,n,a){var o=e("../internals/fails");n.exports=!o(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},{"../internals/fails":260}],248:[function(e,n,a){var o=typeof document=="object"&&document.all,s=o===void 0&&o!==void 0;n.exports={all:o,IS_HTMLDDA:s}},{}],249:[function(e,n,a){var o=e("../internals/global"),s=e("../internals/is-object"),l=o.document,c=s(l)&&s(l.createElement);n.exports=function(i){return c?l.createElement(i):{}}},{"../internals/global":274,"../internals/is-object":289}],250:[function(e,n,a){var o=e("../internals/engine-is-deno"),s=e("../internals/engine-is-node");n.exports=!o&&!s&&typeof window=="object"&&typeof document=="object"},{"../internals/engine-is-deno":251,"../internals/engine-is-node":254}],251:[function(e,n,a){n.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},{}],252:[function(e,n,a){var o=e("../internals/engine-user-agent");n.exports=/ipad|iphone|ipod/i.test(o)&&typeof Pebble<"u"},{"../internals/engine-user-agent":256}],253:[function(e,n,a){var o=e("../internals/engine-user-agent");n.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(o)},{"../internals/engine-user-agent":256}],254:[function(e,n,a){var o=e("../internals/global"),s=e("../internals/classof-raw");n.exports=s(o.process)==="process"},{"../internals/classof-raw":235,"../internals/global":274}],255:[function(e,n,a){var o=e("../internals/engine-user-agent");n.exports=/web0s(?!.*chrome)/i.test(o)},{"../internals/engine-user-agent":256}],256:[function(e,n,a){n.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},{}],257:[function(e,n,a){var o,s,l=e("../internals/global"),c=e("../internals/engine-user-agent"),i=l.process,u=l.Deno,p=i&&i.versions||u&&u.version,f=p&&p.v8;f&&(s=(o=f.split("."))[0]>0&&o[0]<4?1:+(o[0]+o[1])),!s&&c&&(!(o=c.match(/Edge\/(\d+)/))||o[1]>=74)&&(o=c.match(/Chrome\/(\d+)/))&&(s=+o[1]),n.exports=s},{"../internals/engine-user-agent":256,"../internals/global":274}],258:[function(e,n,a){n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],259:[function(e,n,a){var o=e("../internals/global"),s=e("../internals/object-get-own-property-descriptor").f,l=e("../internals/create-non-enumerable-property"),c=e("../internals/define-built-in"),i=e("../internals/define-global-property"),u=e("../internals/copy-constructor-properties"),p=e("../internals/is-forced");n.exports=function(f,h){var v,b,g,x,y,k=f.target,N=f.global,F=f.stat;if(v=N?o:F?o[k]||i(k,{}):(o[k]||{}).prototype)for(b in h){if(x=h[b],g=f.dontCallGetSet?(y=s(v,b))&&y.value:v[b],!p(N?b:k+(F?".":"#")+b,f.forced)&&g!==void 0){if(typeof x==typeof g)continue;u(x,g)}(f.sham||g&&g.sham)&&l(x,"sham",!0),c(v,b,x,f)}}},{"../internals/copy-constructor-properties":237,"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/define-global-property":246,"../internals/global":274,"../internals/is-forced":287,"../internals/object-get-own-property-descriptor":309}],260:[function(e,n,a){n.exports=function(o){try{return!!o()}catch{return!0}}},{}],261:[function(e,n,a){var o=e("../internals/function-bind-native"),s=Function.prototype,l=s.apply,c=s.call;n.exports=typeof Reflect=="object"&&Reflect.apply||(o?c.bind(l):function(){return c.apply(l,arguments)})},{"../internals/function-bind-native":263}],262:[function(e,n,a){var o=e("../internals/function-uncurry-this-clause"),s=e("../internals/a-callable"),l=e("../internals/function-bind-native"),c=o(o.bind);n.exports=function(i,u){return s(i),u===void 0?i:l?c(i,u):function(){return i.apply(u,arguments)}}},{"../internals/a-callable":222,"../internals/function-bind-native":263,"../internals/function-uncurry-this-clause":267}],263:[function(e,n,a){var o=e("../internals/fails");n.exports=!o(function(){var s=(function(){}).bind();return typeof s!="function"||s.hasOwnProperty("prototype")})},{"../internals/fails":260}],264:[function(e,n,a){var o=e("../internals/function-bind-native"),s=Function.prototype.call;n.exports=o?s.bind(s):function(){return s.apply(s,arguments)}},{"../internals/function-bind-native":263}],265:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/has-own-property"),l=Function.prototype,c=o&&Object.getOwnPropertyDescriptor,i=s(l,"name"),u=i&&(function(){}).name==="something",p=i&&(!o||o&&c(l,"name").configurable);n.exports={EXISTS:i,PROPER:u,CONFIGURABLE:p}},{"../internals/descriptors":247,"../internals/has-own-property":275}],266:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=e("../internals/a-callable");n.exports=function(l,c,i){try{return o(s(Object.getOwnPropertyDescriptor(l,c)[i]))}catch{}}},{"../internals/a-callable":222,"../internals/function-uncurry-this":268}],267:[function(e,n,a){var o=e("../internals/classof-raw"),s=e("../internals/function-uncurry-this");n.exports=function(l){if(o(l)==="Function")return s(l)}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268}],268:[function(e,n,a){var o=e("../internals/function-bind-native"),s=Function.prototype,l=s.call,c=o&&s.bind.bind(l,l);n.exports=o?c:function(i){return function(){return l.apply(i,arguments)}}},{"../internals/function-bind-native":263}],269:[function(e,n,a){var o=e("../internals/global"),s=e("../internals/is-callable"),l=function(c){return s(c)?c:void 0};n.exports=function(c,i){return arguments.length<2?l(o[c]):o[c]&&o[c][i]}},{"../internals/global":274,"../internals/is-callable":285}],270:[function(e,n,a){var o=e("../internals/classof"),s=e("../internals/get-method"),l=e("../internals/is-null-or-undefined"),c=e("../internals/iterators"),i=e("../internals/well-known-symbol")("iterator");n.exports=function(u){if(!l(u))return s(u,i)||s(u,"@@iterator")||c[o(u)]}},{"../internals/classof":236,"../internals/get-method":273,"../internals/is-null-or-undefined":288,"../internals/iterators":298,"../internals/well-known-symbol":357}],271:[function(e,n,a){var o=e("../internals/function-call"),s=e("../internals/a-callable"),l=e("../internals/an-object"),c=e("../internals/try-to-string"),i=e("../internals/get-iterator-method"),u=TypeError;n.exports=function(p,f){var h=arguments.length<2?i(p):f;if(s(h))return l(o(h,p));throw new u(c(p)+" is not iterable")}},{"../internals/a-callable":222,"../internals/an-object":227,"../internals/function-call":264,"../internals/get-iterator-method":270,"../internals/try-to-string":349}],272:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=e("../internals/is-array"),l=e("../internals/is-callable"),c=e("../internals/classof-raw"),i=e("../internals/to-string"),u=o([].push);n.exports=function(p){if(l(p))return p;if(s(p)){for(var f=p.length,h=[],v=0;v<f;v++){var b=p[v];typeof b=="string"?u(h,b):typeof b!="number"&&c(b)!=="Number"&&c(b)!=="String"||u(h,i(b))}var g=h.length,x=!0;return function(y,k){if(x)return x=!1,k;if(s(this))return k;for(var N=0;N<g;N++)if(h[N]===y)return k}}}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268,"../internals/is-array":284,"../internals/is-callable":285,"../internals/to-string":348}],273:[function(e,n,a){var o=e("../internals/a-callable"),s=e("../internals/is-null-or-undefined");n.exports=function(l,c){var i=l[c];return s(i)?void 0:o(i)}},{"../internals/a-callable":222,"../internals/is-null-or-undefined":288}],274:[function(e,n,a){(function(o){(function(){var s=function(l){return l&&l.Math===Math&&l};n.exports=s(typeof globalThis=="object"&&globalThis)||s(typeof window=="object"&&window)||s(typeof self=="object"&&self)||s(typeof o=="object"&&o)||function(){return this}()||this||Function("return this")()}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],275:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=e("../internals/to-object"),l=o({}.hasOwnProperty);n.exports=Object.hasOwn||function(c,i){return l(s(c),i)}},{"../internals/function-uncurry-this":268,"../internals/to-object":344}],276:[function(e,n,a){n.exports={}},{}],277:[function(e,n,a){n.exports=function(o,s){try{arguments.length===1?console.error(o):console.error(o,s)}catch{}}},{}],278:[function(e,n,a){var o=e("../internals/get-built-in");n.exports=o("document","documentElement")},{"../internals/get-built-in":269}],279:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/fails"),l=e("../internals/document-create-element");n.exports=!o&&!s(function(){return Object.defineProperty(l("div"),"a",{get:function(){return 7}}).a!==7})},{"../internals/descriptors":247,"../internals/document-create-element":249,"../internals/fails":260}],280:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=e("../internals/fails"),l=e("../internals/classof-raw"),c=Object,i=o("".split);n.exports=s(function(){return!c("z").propertyIsEnumerable(0)})?function(u){return l(u)==="String"?i(u,""):c(u)}:c},{"../internals/classof-raw":235,"../internals/fails":260,"../internals/function-uncurry-this":268}],281:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=e("../internals/is-callable"),l=e("../internals/shared-store"),c=o(Function.toString);s(l.inspectSource)||(l.inspectSource=function(i){return c(i)}),n.exports=l.inspectSource},{"../internals/function-uncurry-this":268,"../internals/is-callable":285,"../internals/shared-store":333}],282:[function(e,n,a){var o,s,l,c=e("../internals/weak-map-basic-detection"),i=e("../internals/global"),u=e("../internals/is-object"),p=e("../internals/create-non-enumerable-property"),f=e("../internals/has-own-property"),h=e("../internals/shared-store"),v=e("../internals/shared-key"),b=e("../internals/hidden-keys"),g=i.TypeError,x=i.WeakMap;if(c||h.state){var y=h.state||(h.state=new x);y.get=y.get,y.has=y.has,y.set=y.set,o=function(N,F){if(y.has(N))throw new g("Object already initialized");return F.facade=N,y.set(N,F),F},s=function(N){return y.get(N)||{}},l=function(N){return y.has(N)}}else{var k=v("state");b[k]=!0,o=function(N,F){if(f(N,k))throw new g("Object already initialized");return F.facade=N,p(N,k,F),F},s=function(N){return f(N,k)?N[k]:{}},l=function(N){return f(N,k)}}n.exports={set:o,get:s,has:l,enforce:function(N){return l(N)?s(N):o(N,{})},getterFor:function(N){return function(F){var B;if(!u(F)||(B=s(F)).type!==N)throw new g("Incompatible receiver, "+N+" required");return B}}}},{"../internals/create-non-enumerable-property":241,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/is-object":289,"../internals/shared-key":332,"../internals/shared-store":333,"../internals/weak-map-basic-detection":354}],283:[function(e,n,a){var o=e("../internals/well-known-symbol"),s=e("../internals/iterators"),l=o("iterator"),c=Array.prototype;n.exports=function(i){return i!==void 0&&(s.Array===i||c[l]===i)}},{"../internals/iterators":298,"../internals/well-known-symbol":357}],284:[function(e,n,a){var o=e("../internals/classof-raw");n.exports=Array.isArray||function(s){return o(s)==="Array"}},{"../internals/classof-raw":235}],285:[function(e,n,a){var o=e("../internals/document-all"),s=o.all;n.exports=o.IS_HTMLDDA?function(l){return typeof l=="function"||l===s}:function(l){return typeof l=="function"}},{"../internals/document-all":248}],286:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=e("../internals/fails"),l=e("../internals/is-callable"),c=e("../internals/classof"),i=e("../internals/get-built-in"),u=e("../internals/inspect-source"),p=function(){},f=[],h=i("Reflect","construct"),v=/^\s*(?:class|function)\b/,b=o(v.exec),g=!v.test(p),x=function(k){if(!l(k))return!1;try{return h(p,f,k),!0}catch{return!1}},y=function(k){if(!l(k))return!1;switch(c(k)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return g||!!b(v,u(k))}catch{return!0}};y.sham=!0,n.exports=!h||s(function(){var k;return x(x.call)||!x(Object)||!x(function(){k=!0})||k})?y:x},{"../internals/classof":236,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/inspect-source":281,"../internals/is-callable":285}],287:[function(e,n,a){var o=e("../internals/fails"),s=e("../internals/is-callable"),l=/#|\.prototype\./,c=function(h,v){var b=u[i(h)];return b===f||b!==p&&(s(v)?o(v):!!v)},i=c.normalize=function(h){return String(h).replace(l,".").toLowerCase()},u=c.data={},p=c.NATIVE="N",f=c.POLYFILL="P";n.exports=c},{"../internals/fails":260,"../internals/is-callable":285}],288:[function(e,n,a){n.exports=function(o){return o==null}},{}],289:[function(e,n,a){var o=e("../internals/is-callable"),s=e("../internals/document-all"),l=s.all;n.exports=s.IS_HTMLDDA?function(c){return typeof c=="object"?c!==null:o(c)||c===l}:function(c){return typeof c=="object"?c!==null:o(c)}},{"../internals/document-all":248,"../internals/is-callable":285}],290:[function(e,n,a){n.exports=!1},{}],291:[function(e,n,a){var o=e("../internals/is-object"),s=e("../internals/classof-raw"),l=e("../internals/well-known-symbol")("match");n.exports=function(c){var i;return o(c)&&((i=c[l])!==void 0?!!i:s(c)==="RegExp")}},{"../internals/classof-raw":235,"../internals/is-object":289,"../internals/well-known-symbol":357}],292:[function(e,n,a){var o=e("../internals/get-built-in"),s=e("../internals/is-callable"),l=e("../internals/object-is-prototype-of"),c=e("../internals/use-symbol-as-uid"),i=Object;n.exports=c?function(u){return typeof u=="symbol"}:function(u){var p=o("Symbol");return s(p)&&l(p.prototype,i(u))}},{"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/object-is-prototype-of":314,"../internals/use-symbol-as-uid":351}],293:[function(e,n,a){var o=e("../internals/function-bind-context"),s=e("../internals/function-call"),l=e("../internals/an-object"),c=e("../internals/try-to-string"),i=e("../internals/is-array-iterator-method"),u=e("../internals/length-of-array-like"),p=e("../internals/object-is-prototype-of"),f=e("../internals/get-iterator"),h=e("../internals/get-iterator-method"),v=e("../internals/iterator-close"),b=TypeError,g=function(y,k){this.stopped=y,this.result=k},x=g.prototype;n.exports=function(y,k,N){var F,B,W,V,q,X,I,H=N&&N.that,O=!(!N||!N.AS_ENTRIES),R=!(!N||!N.IS_RECORD),C=!(!N||!N.IS_ITERATOR),w=!(!N||!N.INTERRUPTED),E=o(k,H),A=function(D){return F&&v(F,"normal",D),new g(!0,D)},T=function(D){return O?(l(D),w?E(D[0],D[1],A):E(D[0],D[1])):w?E(D,A):E(D)};if(R)F=y.iterator;else if(C)F=y;else{if(!(B=h(y)))throw new b(c(y)+" is not iterable");if(i(B)){for(W=0,V=u(y);V>W;W++)if((q=T(y[W]))&&p(x,q))return q;return new g(!1)}F=f(y,B)}for(X=R?y.next:F.next;!(I=s(X,F)).done;){try{q=T(I.value)}catch(D){v(F,"throw",D)}if(typeof q=="object"&&q&&p(x,q))return q}return new g(!1)}},{"../internals/an-object":227,"../internals/function-bind-context":262,"../internals/function-call":264,"../internals/get-iterator":271,"../internals/get-iterator-method":270,"../internals/is-array-iterator-method":283,"../internals/iterator-close":294,"../internals/length-of-array-like":299,"../internals/object-is-prototype-of":314,"../internals/try-to-string":349}],294:[function(e,n,a){var o=e("../internals/function-call"),s=e("../internals/an-object"),l=e("../internals/get-method");n.exports=function(c,i,u){var p,f;s(c);try{if(!(p=l(c,"return"))){if(i==="throw")throw u;return u}p=o(p,c)}catch(h){f=!0,p=h}if(i==="throw")throw u;if(f)throw p;return s(p),u}},{"../internals/an-object":227,"../internals/function-call":264,"../internals/get-method":273}],295:[function(e,n,a){var o=e("../internals/iterators-core").IteratorPrototype,s=e("../internals/object-create"),l=e("../internals/create-property-descriptor"),c=e("../internals/set-to-string-tag"),i=e("../internals/iterators"),u=function(){return this};n.exports=function(p,f,h,v){var b=f+" Iterator";return p.prototype=s(o,{next:l(+!v,h)}),c(p,b,!1,!0),i[b]=u,p}},{"../internals/create-property-descriptor":242,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-create":306,"../internals/set-to-string-tag":331}],296:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/function-call"),l=e("../internals/is-pure"),c=e("../internals/function-name"),i=e("../internals/is-callable"),u=e("../internals/iterator-create-constructor"),p=e("../internals/object-get-prototype-of"),f=e("../internals/object-set-prototype-of"),h=e("../internals/set-to-string-tag"),v=e("../internals/create-non-enumerable-property"),b=e("../internals/define-built-in"),g=e("../internals/well-known-symbol"),x=e("../internals/iterators"),y=e("../internals/iterators-core"),k=c.PROPER,N=c.CONFIGURABLE,F=y.IteratorPrototype,B=y.BUGGY_SAFARI_ITERATORS,W=g("iterator"),V=function(){return this};n.exports=function(q,X,I,H,O,R,C){u(I,X,H);var w,E,A,T=function(z){if(z===O&&Y)return Y;if(!B&&z&&z in P)return P[z];switch(z){case"keys":case"values":case"entries":return function(){return new I(this,z)}}return function(){return new I(this)}},D=X+" Iterator",U=!1,P=q.prototype,K=P[W]||P["@@iterator"]||O&&P[O],Y=!B&&K||T(O),re=X==="Array"&&P.entries||K;if(re&&(w=p(re.call(new q)))!==Object.prototype&&w.next&&(l||p(w)===F||(f?f(w,F):i(w[W])||b(w,W,V)),h(w,D,!0,!0),l&&(x[D]=V)),k&&O==="values"&&K&&K.name!=="values"&&(!l&&N?v(P,"name","values"):(U=!0,Y=function(){return s(K,this)})),O)if(E={values:T("values"),keys:R?Y:T("keys"),entries:T("entries")},C)for(A in E)(B||U||!(A in P))&&b(P,A,E[A]);else o({target:X,proto:!0,forced:B||U},E);return l&&!C||P[W]===Y||b(P,W,Y,{name:O}),x[X]=Y,E}},{"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/export":259,"../internals/function-call":264,"../internals/function-name":265,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/iterator-create-constructor":295,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-get-prototype-of":313,"../internals/object-set-prototype-of":318,"../internals/set-to-string-tag":331,"../internals/well-known-symbol":357}],297:[function(e,n,a){var o,s,l,c=e("../internals/fails"),i=e("../internals/is-callable"),u=e("../internals/is-object"),p=e("../internals/object-create"),f=e("../internals/object-get-prototype-of"),h=e("../internals/define-built-in"),v=e("../internals/well-known-symbol"),b=e("../internals/is-pure"),g=v("iterator"),x=!1;[].keys&&("next"in(l=[].keys())?(s=f(f(l)))!==Object.prototype&&(o=s):x=!0),!u(o)||c(function(){var y={};return o[g].call(y)!==y})?o={}:b&&(o=p(o)),i(o[g])||h(o,g,function(){return this}),n.exports={IteratorPrototype:o,BUGGY_SAFARI_ITERATORS:x}},{"../internals/define-built-in":245,"../internals/fails":260,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-get-prototype-of":313,"../internals/well-known-symbol":357}],298:[function(e,n,a){arguments[4][276][0].apply(a,arguments)},{dup:276}],299:[function(e,n,a){var o=e("../internals/to-length");n.exports=function(s){return o(s.length)}},{"../internals/to-length":343}],300:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=e("../internals/fails"),l=e("../internals/is-callable"),c=e("../internals/has-own-property"),i=e("../internals/descriptors"),u=e("../internals/function-name").CONFIGURABLE,p=e("../internals/inspect-source"),f=e("../internals/internal-state"),h=f.enforce,v=f.get,b=String,g=Object.defineProperty,x=o("".slice),y=o("".replace),k=o([].join),N=i&&!s(function(){return g(function(){},"length",{value:8}).length!==8}),F=String(String).split("String"),B=n.exports=function(W,V,q){x(b(V),0,7)==="Symbol("&&(V="["+y(b(V),/^Symbol\(([^)]*)\)/,"$1")+"]"),q&&q.getter&&(V="get "+V),q&&q.setter&&(V="set "+V),(!c(W,"name")||u&&W.name!==V)&&(i?g(W,"name",{value:V,configurable:!0}):W.name=V),N&&q&&c(q,"arity")&&W.length!==q.arity&&g(W,"length",{value:q.arity});try{q&&c(q,"constructor")&&q.constructor?i&&g(W,"prototype",{writable:!1}):W.prototype&&(W.prototype=void 0)}catch{}var X=h(W);return c(X,"source")||(X.source=k(F,typeof V=="string"?V:"")),W};Function.prototype.toString=B(function(){return l(this)&&v(this).source||p(this)},"toString")},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-name":265,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/inspect-source":281,"../internals/internal-state":282,"../internals/is-callable":285}],301:[function(e,n,a){var o=Math.ceil,s=Math.floor;n.exports=Math.trunc||function(l){var c=+l;return(c>0?s:o)(c)}},{}],302:[function(e,n,a){var o,s,l,c,i,u=e("../internals/global"),p=e("../internals/function-bind-context"),f=e("../internals/object-get-own-property-descriptor").f,h=e("../internals/task").set,v=e("../internals/queue"),b=e("../internals/engine-is-ios"),g=e("../internals/engine-is-ios-pebble"),x=e("../internals/engine-is-webos-webkit"),y=e("../internals/engine-is-node"),k=u.MutationObserver||u.WebKitMutationObserver,N=u.document,F=u.process,B=u.Promise,W=f(u,"queueMicrotask"),V=W&&W.value;if(!V){var q=new v,X=function(){var I,H;for(y&&(I=F.domain)&&I.exit();H=q.get();)try{H()}catch(O){throw q.head&&o(),O}I&&I.enter()};b||y||x||!k||!N?!g&&B&&B.resolve?((c=B.resolve(void 0)).constructor=B,i=p(c.then,c),o=function(){i(X)}):y?o=function(){F.nextTick(X)}:(h=p(h,u),o=function(){h(X)}):(s=!0,l=N.createTextNode(""),new k(X).observe(l,{characterData:!0}),o=function(){l.data=s=!s}),V=function(I){q.head||o(),q.add(I)}}n.exports=V},{"../internals/engine-is-ios":253,"../internals/engine-is-ios-pebble":252,"../internals/engine-is-node":254,"../internals/engine-is-webos-webkit":255,"../internals/function-bind-context":262,"../internals/global":274,"../internals/object-get-own-property-descriptor":309,"../internals/queue":328,"../internals/task":339}],303:[function(e,n,a){var o=e("../internals/a-callable"),s=TypeError,l=function(c){var i,u;this.promise=new c(function(p,f){if(i!==void 0||u!==void 0)throw new s("Bad Promise constructor");i=p,u=f}),this.resolve=o(i),this.reject=o(u)};n.exports.f=function(c){return new l(c)}},{"../internals/a-callable":222}],304:[function(e,n,a){var o=e("../internals/is-regexp"),s=TypeError;n.exports=function(l){if(o(l))throw new s("The method doesn't accept regular expressions");return l}},{"../internals/is-regexp":291}],305:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/function-uncurry-this"),l=e("../internals/function-call"),c=e("../internals/fails"),i=e("../internals/object-keys"),u=e("../internals/object-get-own-property-symbols"),p=e("../internals/object-property-is-enumerable"),f=e("../internals/to-object"),h=e("../internals/indexed-object"),v=Object.assign,b=Object.defineProperty,g=s([].concat);n.exports=!v||c(function(){if(o&&v({b:1},v(b({},"a",{enumerable:!0,get:function(){b(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var x={},y={},k=Symbol("assign detection");return x[k]=7,"abcdefghijklmnopqrst".split("").forEach(function(N){y[N]=N}),v({},x)[k]!==7||i(v({},y)).join("")!=="abcdefghijklmnopqrst"})?function(x,y){for(var k=f(x),N=arguments.length,F=1,B=u.f,W=p.f;N>F;)for(var V,q=h(arguments[F++]),X=B?g(i(q),B(q)):i(q),I=X.length,H=0;I>H;)V=X[H++],o&&!l(W,q,V)||(k[V]=q[V]);return k}:v},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/object-get-own-property-symbols":312,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-object":344}],306:[function(e,n,a){var o,s=e("../internals/an-object"),l=e("../internals/object-define-properties"),c=e("../internals/enum-bug-keys"),i=e("../internals/hidden-keys"),u=e("../internals/html"),p=e("../internals/document-create-element"),f=e("../internals/shared-key"),h=f("IE_PROTO"),v=function(){},b=function(y){return"<script>"+y+"<\/script>"},g=function(y){y.write(b("")),y.close();var k=y.parentWindow.Object;return y=null,k},x=function(){try{o=new ActiveXObject("htmlfile")}catch{}var y,k;x=typeof document<"u"?document.domain&&o?g(o):((k=p("iframe")).style.display="none",u.appendChild(k),k.src="javascript:",(y=k.contentWindow.document).open(),y.write(b("document.F=Object")),y.close(),y.F):g(o);for(var N=c.length;N--;)delete x.prototype[c[N]];return x()};i[h]=!0,n.exports=Object.create||function(y,k){var N;return y!==null?(v.prototype=s(y),N=new v,v.prototype=null,N[h]=y):N=x(),k===void 0?N:l.f(N,k)}},{"../internals/an-object":227,"../internals/document-create-element":249,"../internals/enum-bug-keys":258,"../internals/hidden-keys":276,"../internals/html":278,"../internals/object-define-properties":307,"../internals/shared-key":332}],307:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/v8-prototype-define-bug"),l=e("../internals/object-define-property"),c=e("../internals/an-object"),i=e("../internals/to-indexed-object"),u=e("../internals/object-keys");a.f=o&&!s?Object.defineProperties:function(p,f){c(p);for(var h,v=i(f),b=u(f),g=b.length,x=0;g>x;)l.f(p,h=b[x++],v[h]);return p}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/object-define-property":308,"../internals/object-keys":316,"../internals/to-indexed-object":341,"../internals/v8-prototype-define-bug":352}],308:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/ie8-dom-define"),l=e("../internals/v8-prototype-define-bug"),c=e("../internals/an-object"),i=e("../internals/to-property-key"),u=TypeError,p=Object.defineProperty,f=Object.getOwnPropertyDescriptor;a.f=o?l?function(h,v,b){if(c(h),v=i(v),c(b),typeof h=="function"&&v==="prototype"&&"value"in b&&"writable"in b&&!b.writable){var g=f(h,v);g&&g.writable&&(h[v]=b.value,b={configurable:"configurable"in b?b.configurable:g.configurable,enumerable:"enumerable"in b?b.enumerable:g.enumerable,writable:!1})}return p(h,v,b)}:p:function(h,v,b){if(c(h),v=i(v),c(b),s)try{return p(h,v,b)}catch{}if("get"in b||"set"in b)throw new u("Accessors not supported");return"value"in b&&(h[v]=b.value),h}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/ie8-dom-define":279,"../internals/to-property-key":346,"../internals/v8-prototype-define-bug":352}],309:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/function-call"),l=e("../internals/object-property-is-enumerable"),c=e("../internals/create-property-descriptor"),i=e("../internals/to-indexed-object"),u=e("../internals/to-property-key"),p=e("../internals/has-own-property"),f=e("../internals/ie8-dom-define"),h=Object.getOwnPropertyDescriptor;a.f=o?h:function(v,b){if(v=i(v),b=u(b),f)try{return h(v,b)}catch{}if(p(v,b))return c(!s(l.f,v,b),v[b])}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/function-call":264,"../internals/has-own-property":275,"../internals/ie8-dom-define":279,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341,"../internals/to-property-key":346}],310:[function(e,n,a){var o=e("../internals/classof-raw"),s=e("../internals/to-indexed-object"),l=e("../internals/object-get-own-property-names").f,c=e("../internals/array-slice-simple"),i=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];n.exports.f=function(u){return i&&o(u)==="Window"?function(p){try{return l(p)}catch{return c(i)}}(u):l(s(u))}},{"../internals/array-slice-simple":230,"../internals/classof-raw":235,"../internals/object-get-own-property-names":311,"../internals/to-indexed-object":341}],311:[function(e,n,a){var o=e("../internals/object-keys-internal"),s=e("../internals/enum-bug-keys").concat("length","prototype");a.f=Object.getOwnPropertyNames||function(l){return o(l,s)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],312:[function(e,n,a){a.f=Object.getOwnPropertySymbols},{}],313:[function(e,n,a){var o=e("../internals/has-own-property"),s=e("../internals/is-callable"),l=e("../internals/to-object"),c=e("../internals/shared-key"),i=e("../internals/correct-prototype-getter"),u=c("IE_PROTO"),p=Object,f=p.prototype;n.exports=i?p.getPrototypeOf:function(h){var v=l(h);if(o(v,u))return v[u];var b=v.constructor;return s(b)&&v instanceof b?b.prototype:v instanceof p?f:null}},{"../internals/correct-prototype-getter":239,"../internals/has-own-property":275,"../internals/is-callable":285,"../internals/shared-key":332,"../internals/to-object":344}],314:[function(e,n,a){var o=e("../internals/function-uncurry-this");n.exports=o({}.isPrototypeOf)},{"../internals/function-uncurry-this":268}],315:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=e("../internals/has-own-property"),l=e("../internals/to-indexed-object"),c=e("../internals/array-includes").indexOf,i=e("../internals/hidden-keys"),u=o([].push);n.exports=function(p,f){var h,v=l(p),b=0,g=[];for(h in v)!s(i,h)&&s(v,h)&&u(g,h);for(;f.length>b;)s(v,h=f[b++])&&(~c(g,h)||u(g,h));return g}},{"../internals/array-includes":228,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/to-indexed-object":341}],316:[function(e,n,a){var o=e("../internals/object-keys-internal"),s=e("../internals/enum-bug-keys");n.exports=Object.keys||function(l){return o(l,s)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],317:[function(e,n,a){var o={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,l=s&&!o.call({1:2},1);a.f=l?function(c){var i=s(this,c);return!!i&&i.enumerable}:o},{}],318:[function(e,n,a){var o=e("../internals/function-uncurry-this-accessor"),s=e("../internals/an-object"),l=e("../internals/a-possible-prototype");n.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var c,i=!1,u={};try{(c=o(Object.prototype,"__proto__","set"))(u,[]),i=u instanceof Array}catch{}return function(p,f){return s(p),l(f),i?c(p,f):p.__proto__=f,p}}():void 0)},{"../internals/a-possible-prototype":224,"../internals/an-object":227,"../internals/function-uncurry-this-accessor":266}],319:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/fails"),l=e("../internals/function-uncurry-this"),c=e("../internals/object-get-prototype-of"),i=e("../internals/object-keys"),u=e("../internals/to-indexed-object"),p=l(e("../internals/object-property-is-enumerable").f),f=l([].push),h=o&&s(function(){var b=Object.create(null);return b[2]=2,!p(b,2)}),v=function(b){return function(g){for(var x,y=u(g),k=i(y),N=h&&c(y)===null,F=k.length,B=0,W=[];F>B;)x=k[B++],o&&!(N?x in y:p(y,x))||f(W,b?[x,y[x]]:y[x]);return W}};n.exports={entries:v(!0),values:v(!1)}},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/object-get-prototype-of":313,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341}],320:[function(e,n,a){var o=e("../internals/function-call"),s=e("../internals/is-callable"),l=e("../internals/is-object"),c=TypeError;n.exports=function(i,u){var p,f;if(u==="string"&&s(p=i.toString)&&!l(f=o(p,i))||s(p=i.valueOf)&&!l(f=o(p,i))||u!=="string"&&s(p=i.toString)&&!l(f=o(p,i)))return f;throw new c("Can't convert object to primitive value")}},{"../internals/function-call":264,"../internals/is-callable":285,"../internals/is-object":289}],321:[function(e,n,a){var o=e("../internals/get-built-in"),s=e("../internals/function-uncurry-this"),l=e("../internals/object-get-own-property-names"),c=e("../internals/object-get-own-property-symbols"),i=e("../internals/an-object"),u=s([].concat);n.exports=o("Reflect","ownKeys")||function(p){var f=l.f(i(p)),h=c.f;return h?u(f,h(p)):f}},{"../internals/an-object":227,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-symbols":312}],322:[function(e,n,a){var o=e("../internals/global");n.exports=o},{"../internals/global":274}],323:[function(e,n,a){n.exports=function(o){try{return{error:!1,value:o()}}catch(s){return{error:!0,value:s}}}},{}],324:[function(e,n,a){var o=e("../internals/global"),s=e("../internals/promise-native-constructor"),l=e("../internals/is-callable"),c=e("../internals/is-forced"),i=e("../internals/inspect-source"),u=e("../internals/well-known-symbol"),p=e("../internals/engine-is-browser"),f=e("../internals/engine-is-deno"),h=e("../internals/is-pure"),v=e("../internals/engine-v8-version"),b=s&&s.prototype,g=u("species"),x=!1,y=l(o.PromiseRejectionEvent),k=c("Promise",function(){var N=i(s),F=N!==String(s);if(!F&&v===66||h&&(!b.catch||!b.finally))return!0;if(!v||v<51||!/native code/.test(N)){var B=new s(function(V){V(1)}),W=function(V){V(function(){},function(){})};if((B.constructor={})[g]=W,!(x=B.then(function(){})instanceof W))return!0}return!F&&(p||f)&&!y});n.exports={CONSTRUCTOR:k,REJECTION_EVENT:y,SUBCLASSING:x}},{"../internals/engine-is-browser":250,"../internals/engine-is-deno":251,"../internals/engine-v8-version":257,"../internals/global":274,"../internals/inspect-source":281,"../internals/is-callable":285,"../internals/is-forced":287,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/well-known-symbol":357}],325:[function(e,n,a){var o=e("../internals/global");n.exports=o.Promise},{"../internals/global":274}],326:[function(e,n,a){var o=e("../internals/an-object"),s=e("../internals/is-object"),l=e("../internals/new-promise-capability");n.exports=function(c,i){if(o(c),s(i)&&i.constructor===c)return i;var u=l.f(c);return(0,u.resolve)(i),u.promise}},{"../internals/an-object":227,"../internals/is-object":289,"../internals/new-promise-capability":303}],327:[function(e,n,a){var o=e("../internals/promise-native-constructor"),s=e("../internals/check-correctness-of-iteration"),l=e("../internals/promise-constructor-detection").CONSTRUCTOR;n.exports=l||!s(function(c){o.all(c).then(void 0,function(){})})},{"../internals/check-correctness-of-iteration":234,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],328:[function(e,n,a){var o=function(){this.head=null,this.tail=null};o.prototype={add:function(s){var l={item:s,next:null},c=this.tail;c?c.next=l:this.head=l,this.tail=l},get:function(){var s=this.head;if(s)return(this.head=s.next)===null&&(this.tail=null),s.item}},n.exports=o},{}],329:[function(e,n,a){var o=e("../internals/is-null-or-undefined"),s=TypeError;n.exports=function(l){if(o(l))throw new s("Can't call method on "+l);return l}},{"../internals/is-null-or-undefined":288}],330:[function(e,n,a){var o=e("../internals/get-built-in"),s=e("../internals/define-built-in-accessor"),l=e("../internals/well-known-symbol"),c=e("../internals/descriptors"),i=l("species");n.exports=function(u){var p=o(u);c&&p&&!p[i]&&s(p,i,{configurable:!0,get:function(){return this}})}},{"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],331:[function(e,n,a){var o=e("../internals/object-define-property").f,s=e("../internals/has-own-property"),l=e("../internals/well-known-symbol")("toStringTag");n.exports=function(c,i,u){c&&!u&&(c=c.prototype),c&&!s(c,l)&&o(c,l,{configurable:!0,value:i})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],332:[function(e,n,a){var o=e("../internals/shared"),s=e("../internals/uid"),l=o("keys");n.exports=function(c){return l[c]||(l[c]=s(c))}},{"../internals/shared":334,"../internals/uid":350}],333:[function(e,n,a){var o=e("../internals/global"),s=e("../internals/define-global-property"),l=o["__core-js_shared__"]||s("__core-js_shared__",{});n.exports=l},{"../internals/define-global-property":246,"../internals/global":274}],334:[function(e,n,a){var o=e("../internals/is-pure"),s=e("../internals/shared-store");(n.exports=function(l,c){return s[l]||(s[l]=c!==void 0?c:{})})("versions",[]).push({version:"3.33.0",mode:o?"pure":"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})},{"../internals/is-pure":290,"../internals/shared-store":333}],335:[function(e,n,a){var o=e("../internals/an-object"),s=e("../internals/a-constructor"),l=e("../internals/is-null-or-undefined"),c=e("../internals/well-known-symbol")("species");n.exports=function(i,u){var p,f=o(i).constructor;return f===void 0||l(p=o(f)[c])?u:s(p)}},{"../internals/a-constructor":223,"../internals/an-object":227,"../internals/is-null-or-undefined":288,"../internals/well-known-symbol":357}],336:[function(e,n,a){var o=e("../internals/engine-v8-version"),s=e("../internals/fails"),l=e("../internals/global").String;n.exports=!!Object.getOwnPropertySymbols&&!s(function(){var c=Symbol("symbol detection");return!l(c)||!(Object(c)instanceof Symbol)||!Symbol.sham&&o&&o<41})},{"../internals/engine-v8-version":257,"../internals/fails":260,"../internals/global":274}],337:[function(e,n,a){var o=e("../internals/function-call"),s=e("../internals/get-built-in"),l=e("../internals/well-known-symbol"),c=e("../internals/define-built-in");n.exports=function(){var i=s("Symbol"),u=i&&i.prototype,p=u&&u.valueOf,f=l("toPrimitive");u&&!u[f]&&c(u,f,function(h){return o(p,this)},{arity:1})}},{"../internals/define-built-in":245,"../internals/function-call":264,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],338:[function(e,n,a){var o=e("../internals/symbol-constructor-detection");n.exports=o&&!!Symbol.for&&!!Symbol.keyFor},{"../internals/symbol-constructor-detection":336}],339:[function(e,n,a){var o,s,l,c,i=e("../internals/global"),u=e("../internals/function-apply"),p=e("../internals/function-bind-context"),f=e("../internals/is-callable"),h=e("../internals/has-own-property"),v=e("../internals/fails"),b=e("../internals/html"),g=e("../internals/array-slice"),x=e("../internals/document-create-element"),y=e("../internals/validate-arguments-length"),k=e("../internals/engine-is-ios"),N=e("../internals/engine-is-node"),F=i.setImmediate,B=i.clearImmediate,W=i.process,V=i.Dispatch,q=i.Function,X=i.MessageChannel,I=i.String,H=0,O={};v(function(){o=i.location});var R=function(A){if(h(O,A)){var T=O[A];delete O[A],T()}},C=function(A){return function(){R(A)}},w=function(A){R(A.data)},E=function(A){i.postMessage(I(A),o.protocol+"//"+o.host)};F&&B||(F=function(A){y(arguments.length,1);var T=f(A)?A:q(A),D=g(arguments,1);return O[++H]=function(){u(T,void 0,D)},s(H),H},B=function(A){delete O[A]},N?s=function(A){W.nextTick(C(A))}:V&&V.now?s=function(A){V.now(C(A))}:X&&!k?(c=(l=new X).port2,l.port1.onmessage=w,s=p(c.postMessage,c)):i.addEventListener&&f(i.postMessage)&&!i.importScripts&&o&&o.protocol!=="file:"&&!v(E)?(s=E,i.addEventListener("message",w,!1)):s="onreadystatechange"in x("script")?function(A){b.appendChild(x("script")).onreadystatechange=function(){b.removeChild(this),R(A)}}:function(A){setTimeout(C(A),0)}),n.exports={set:F,clear:B}},{"../internals/array-slice":231,"../internals/document-create-element":249,"../internals/engine-is-ios":253,"../internals/engine-is-node":254,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-bind-context":262,"../internals/global":274,"../internals/has-own-property":275,"../internals/html":278,"../internals/is-callable":285,"../internals/validate-arguments-length":353}],340:[function(e,n,a){var o=e("../internals/to-integer-or-infinity"),s=Math.max,l=Math.min;n.exports=function(c,i){var u=o(c);return u<0?s(u+i,0):l(u,i)}},{"../internals/to-integer-or-infinity":342}],341:[function(e,n,a){var o=e("../internals/indexed-object"),s=e("../internals/require-object-coercible");n.exports=function(l){return o(s(l))}},{"../internals/indexed-object":280,"../internals/require-object-coercible":329}],342:[function(e,n,a){var o=e("../internals/math-trunc");n.exports=function(s){var l=+s;return l!=l||l===0?0:o(l)}},{"../internals/math-trunc":301}],343:[function(e,n,a){var o=e("../internals/to-integer-or-infinity"),s=Math.min;n.exports=function(l){return l>0?s(o(l),9007199254740991):0}},{"../internals/to-integer-or-infinity":342}],344:[function(e,n,a){var o=e("../internals/require-object-coercible"),s=Object;n.exports=function(l){return s(o(l))}},{"../internals/require-object-coercible":329}],345:[function(e,n,a){var o=e("../internals/function-call"),s=e("../internals/is-object"),l=e("../internals/is-symbol"),c=e("../internals/get-method"),i=e("../internals/ordinary-to-primitive"),u=e("../internals/well-known-symbol"),p=TypeError,f=u("toPrimitive");n.exports=function(h,v){if(!s(h)||l(h))return h;var b,g=c(h,f);if(g){if(v===void 0&&(v="default"),b=o(g,h,v),!s(b)||l(b))return b;throw new p("Can't convert object to primitive value")}return v===void 0&&(v="number"),i(h,v)}},{"../internals/function-call":264,"../internals/get-method":273,"../internals/is-object":289,"../internals/is-symbol":292,"../internals/ordinary-to-primitive":320,"../internals/well-known-symbol":357}],346:[function(e,n,a){var o=e("../internals/to-primitive"),s=e("../internals/is-symbol");n.exports=function(l){var c=o(l,"string");return s(c)?c:c+""}},{"../internals/is-symbol":292,"../internals/to-primitive":345}],347:[function(e,n,a){var o={};o[e("../internals/well-known-symbol")("toStringTag")]="z",n.exports=String(o)==="[object z]"},{"../internals/well-known-symbol":357}],348:[function(e,n,a){var o=e("../internals/classof"),s=String;n.exports=function(l){if(o(l)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return s(l)}},{"../internals/classof":236}],349:[function(e,n,a){var o=String;n.exports=function(s){try{return o(s)}catch{return"Object"}}},{}],350:[function(e,n,a){var o=e("../internals/function-uncurry-this"),s=0,l=Math.random(),c=o(1 .toString);n.exports=function(i){return"Symbol("+(i===void 0?"":i)+")_"+c(++s+l,36)}},{"../internals/function-uncurry-this":268}],351:[function(e,n,a){var o=e("../internals/symbol-constructor-detection");n.exports=o&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/symbol-constructor-detection":336}],352:[function(e,n,a){var o=e("../internals/descriptors"),s=e("../internals/fails");n.exports=o&&s(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},{"../internals/descriptors":247,"../internals/fails":260}],353:[function(e,n,a){var o=TypeError;n.exports=function(s,l){if(s<l)throw new o("Not enough arguments");return s}},{}],354:[function(e,n,a){var o=e("../internals/global"),s=e("../internals/is-callable"),l=o.WeakMap;n.exports=s(l)&&/native code/.test(String(l))},{"../internals/global":274,"../internals/is-callable":285}],355:[function(e,n,a){var o=e("../internals/path"),s=e("../internals/has-own-property"),l=e("../internals/well-known-symbol-wrapped"),c=e("../internals/object-define-property").f;n.exports=function(i){var u=o.Symbol||(o.Symbol={});s(u,i)||c(u,i,{value:l.f(i)})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/path":322,"../internals/well-known-symbol-wrapped":356}],356:[function(e,n,a){var o=e("../internals/well-known-symbol");a.f=o},{"../internals/well-known-symbol":357}],357:[function(e,n,a){var o=e("../internals/global"),s=e("../internals/shared"),l=e("../internals/has-own-property"),c=e("../internals/uid"),i=e("../internals/symbol-constructor-detection"),u=e("../internals/use-symbol-as-uid"),p=o.Symbol,f=s("wks"),h=u?p.for||p:p&&p.withoutSetter||c;n.exports=function(v){return l(f,v)||(f[v]=i&&l(p,v)?p[v]:h("Symbol."+v)),f[v]}},{"../internals/global":274,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-constructor-detection":336,"../internals/uid":350,"../internals/use-symbol-as-uid":351}],358:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/array-iteration").findIndex,l=e("../internals/add-to-unscopables"),c=!0;"findIndex"in[]&&Array(1).findIndex(function(){c=!1}),o({target:"Array",proto:!0,forced:c},{findIndex:function(i){return s(this,i,arguments.length>1?arguments[1]:void 0)}}),l("findIndex")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],359:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/array-iteration").find,l=e("../internals/add-to-unscopables"),c=!0;"find"in[]&&Array(1).find(function(){c=!1}),o({target:"Array",proto:!0,forced:c},{find:function(i){return s(this,i,arguments.length>1?arguments[1]:void 0)}}),l("find")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],360:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/array-includes").includes,l=e("../internals/fails"),c=e("../internals/add-to-unscopables");o({target:"Array",proto:!0,forced:l(function(){return!Array(1).includes()})},{includes:function(i){return s(this,i,arguments.length>1?arguments[1]:void 0)}}),c("includes")},{"../internals/add-to-unscopables":225,"../internals/array-includes":228,"../internals/export":259,"../internals/fails":260}],361:[function(e,n,a){var o=e("../internals/to-indexed-object"),s=e("../internals/add-to-unscopables"),l=e("../internals/iterators"),c=e("../internals/internal-state"),i=e("../internals/object-define-property").f,u=e("../internals/iterator-define"),p=e("../internals/create-iter-result-object"),f=e("../internals/is-pure"),h=e("../internals/descriptors"),v=c.set,b=c.getterFor("Array Iterator");n.exports=u(Array,"Array",function(x,y){v(this,{type:"Array Iterator",target:o(x),index:0,kind:y})},function(){var x=b(this),y=x.target,k=x.kind,N=x.index++;if(!y||N>=y.length)return x.target=void 0,p(void 0,!0);switch(k){case"keys":return p(N,!1);case"values":return p(y[N],!1)}return p([N,y[N]],!1)},"values");var g=l.Arguments=l.Array;if(s("keys"),s("values"),s("entries"),!f&&h&&g.name!=="values")try{i(g,"name",{value:"values"})}catch{}},{"../internals/add-to-unscopables":225,"../internals/create-iter-result-object":240,"../internals/descriptors":247,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/iterator-define":296,"../internals/iterators":298,"../internals/object-define-property":308,"../internals/to-indexed-object":341}],362:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/get-built-in"),l=e("../internals/function-apply"),c=e("../internals/function-call"),i=e("../internals/function-uncurry-this"),u=e("../internals/fails"),p=e("../internals/is-callable"),f=e("../internals/is-symbol"),h=e("../internals/array-slice"),v=e("../internals/get-json-replacer-function"),b=e("../internals/symbol-constructor-detection"),g=String,x=s("JSON","stringify"),y=i(/./.exec),k=i("".charAt),N=i("".charCodeAt),F=i("".replace),B=i(1 .toString),W=/[\uD800-\uDFFF]/g,V=/^[\uD800-\uDBFF]$/,q=/^[\uDC00-\uDFFF]$/,X=!b||u(function(){var R=s("Symbol")("stringify detection");return x([R])!=="[null]"||x({a:R})!=="{}"||x(Object(R))!=="{}"}),I=u(function(){return x("\uDF06\uD834")!=='"\\udf06\\ud834"'||x("\uDEAD")!=='"\\udead"'}),H=function(R,C){var w=h(arguments),E=v(C);if(p(E)||R!==void 0&&!f(R))return w[1]=function(A,T){if(p(E)&&(T=c(E,this,g(A),T)),!f(T))return T},l(x,null,w)},O=function(R,C,w){var E=k(w,C-1),A=k(w,C+1);return y(V,R)&&!y(q,A)||y(q,R)&&!y(V,E)?"\\u"+B(N(R,0),16):R};x&&o({target:"JSON",stat:!0,arity:3,forced:X||I},{stringify:function(R,C,w){var E=h(arguments),A=l(X?H:x,null,E);return I&&typeof A=="string"?F(A,W,O):A}})},{"../internals/array-slice":231,"../internals/export":259,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/get-json-replacer-function":272,"../internals/is-callable":285,"../internals/is-symbol":292,"../internals/symbol-constructor-detection":336}],363:[function(e,n,a){e("../internals/export")({target:"Number",stat:!0},{isNaN:function(o){return o!=o}})},{"../internals/export":259}],364:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/object-assign");o({target:"Object",stat:!0,arity:2,forced:Object.assign!==s},{assign:s})},{"../internals/export":259,"../internals/object-assign":305}],365:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/symbol-constructor-detection"),l=e("../internals/fails"),c=e("../internals/object-get-own-property-symbols"),i=e("../internals/to-object");o({target:"Object",stat:!0,forced:!s||l(function(){c.f(1)})},{getOwnPropertySymbols:function(u){var p=c.f;return p?p(i(u)):[]}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-get-own-property-symbols":312,"../internals/symbol-constructor-detection":336,"../internals/to-object":344}],366:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/to-object"),l=e("../internals/object-keys");o({target:"Object",stat:!0,forced:e("../internals/fails")(function(){l(1)})},{keys:function(c){return l(s(c))}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-keys":316,"../internals/to-object":344}],367:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/object-to-array").values;o({target:"Object",stat:!0},{values:function(l){return s(l)}})},{"../internals/export":259,"../internals/object-to-array":319}],368:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/function-call"),l=e("../internals/a-callable"),c=e("../internals/new-promise-capability"),i=e("../internals/perform"),u=e("../internals/iterate");o({target:"Promise",stat:!0,forced:e("../internals/promise-statics-incorrect-iteration")},{all:function(p){var f=this,h=c.f(f),v=h.resolve,b=h.reject,g=i(function(){var x=l(f.resolve),y=[],k=0,N=1;u(p,function(F){var B=k++,W=!1;N++,s(x,f,F).then(function(V){W||(W=!0,y[B]=V,--N||v(y))},b)}),--N||v(y)});return g.error&&b(g.value),h.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],369:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/is-pure"),l=e("../internals/promise-constructor-detection").CONSTRUCTOR,c=e("../internals/promise-native-constructor"),i=e("../internals/get-built-in"),u=e("../internals/is-callable"),p=e("../internals/define-built-in"),f=c&&c.prototype;if(o({target:"Promise",proto:!0,forced:l,real:!0},{catch:function(v){return this.then(void 0,v)}}),!s&&u(c)){var h=i("Promise").prototype.catch;f.catch!==h&&p(f,"catch",h,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],370:[function(e,n,a){var o,s,l,c=e("../internals/export"),i=e("../internals/is-pure"),u=e("../internals/engine-is-node"),p=e("../internals/global"),f=e("../internals/function-call"),h=e("../internals/define-built-in"),v=e("../internals/object-set-prototype-of"),b=e("../internals/set-to-string-tag"),g=e("../internals/set-species"),x=e("../internals/a-callable"),y=e("../internals/is-callable"),k=e("../internals/is-object"),N=e("../internals/an-instance"),F=e("../internals/species-constructor"),B=e("../internals/task").set,W=e("../internals/microtask"),V=e("../internals/host-report-errors"),q=e("../internals/perform"),X=e("../internals/queue"),I=e("../internals/internal-state"),H=e("../internals/promise-native-constructor"),O=e("../internals/promise-constructor-detection"),R=e("../internals/new-promise-capability"),C=O.CONSTRUCTOR,w=O.REJECTION_EVENT,E=O.SUBCLASSING,A=I.getterFor("Promise"),T=I.set,D=H&&H.prototype,U=H,P=D,K=p.TypeError,Y=p.document,re=p.process,z=R.f,ee=z,L=!!(Y&&Y.createEvent&&p.dispatchEvent),M=function(he){var Ee;return!(!k(he)||!y(Ee=he.then))&&Ee},Z=function(he,Ee){var ke,Ce,Fe,Pe=Ee.value,Xe=Ee.state===1,ct=Xe?he.ok:he.fail,st=he.resolve,lt=he.reject,tt=he.domain;try{ct?(Xe||(Ee.rejection===2&&fe(Ee),Ee.rejection=1),ct===!0?ke=Pe:(tt&&tt.enter(),ke=ct(Pe),tt&&(tt.exit(),Fe=!0)),ke===he.promise?lt(new K("Promise-chain cycle")):(Ce=M(ke))?f(Ce,ke,st,lt):st(ke)):lt(Pe)}catch(ot){tt&&!Fe&&tt.exit(),lt(ot)}},se=function(he,Ee){he.notified||(he.notified=!0,W(function(){for(var ke,Ce=he.reactions;ke=Ce.get();)Z(ke,he);he.notified=!1,Ee&&!he.rejection&&ne(he)}))},ae=function(he,Ee,ke){var Ce,Fe;L?((Ce=Y.createEvent("Event")).promise=Ee,Ce.reason=ke,Ce.initEvent(he,!1,!0),p.dispatchEvent(Ce)):Ce={promise:Ee,reason:ke},!w&&(Fe=p["on"+he])?Fe(Ce):he==="unhandledrejection"&&V("Unhandled promise rejection",ke)},ne=function(he){f(B,p,function(){var Ee,ke=he.facade,Ce=he.value;if(Q(he)&&(Ee=q(function(){u?re.emit("unhandledRejection",Ce,ke):ae("unhandledrejection",ke,Ce)}),he.rejection=u||Q(he)?2:1,Ee.error))throw Ee.value})},Q=function(he){return he.rejection!==1&&!he.parent},fe=function(he){f(B,p,function(){var Ee=he.facade;u?re.emit("rejectionHandled",Ee):ae("rejectionhandled",Ee,he.value)})},le=function(he,Ee,ke){return function(Ce){he(Ee,Ce,ke)}},te=function(he,Ee,ke){he.done||(he.done=!0,ke&&(he=ke),he.value=Ee,he.state=2,se(he,!0))},ce=function(he,Ee,ke){if(!he.done){he.done=!0,ke&&(he=ke);try{if(he.facade===Ee)throw new K("Promise can't be resolved itself");var Ce=M(Ee);Ce?W(function(){var Fe={done:!1};try{f(Ce,Ee,le(ce,Fe,he),le(te,Fe,he))}catch(Pe){te(Fe,Pe,he)}}):(he.value=Ee,he.state=1,se(he,!1))}catch(Fe){te({done:!1},Fe,he)}}};if(C&&(P=(U=function(he){N(this,P),x(he),f(o,this);var Ee=A(this);try{he(le(ce,Ee),le(te,Ee))}catch(ke){te(Ee,ke)}}).prototype,(o=function(he){T(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new X,rejection:!1,state:0,value:void 0})}).prototype=h(P,"then",function(he,Ee){var ke=A(this),Ce=z(F(this,U));return ke.parent=!0,Ce.ok=!y(he)||he,Ce.fail=y(Ee)&&Ee,Ce.domain=u?re.domain:void 0,ke.state===0?ke.reactions.add(Ce):W(function(){Z(Ce,ke)}),Ce.promise}),s=function(){var he=new o,Ee=A(he);this.promise=he,this.resolve=le(ce,Ee),this.reject=le(te,Ee)},R.f=z=function(he){return he===U||he===void 0?new s(he):ee(he)},!i&&y(H)&&D!==Object.prototype)){l=D.then,E||h(D,"then",function(he,Ee){var ke=this;return new U(function(Ce,Fe){f(l,ke,Ce,Fe)}).then(he,Ee)},{unsafe:!0});try{delete D.constructor}catch{}v&&v(D,P)}c({global:!0,constructor:!0,wrap:!0,forced:C},{Promise:U}),b(U,"Promise",!1,!0),g("Promise")},{"../internals/a-callable":222,"../internals/an-instance":226,"../internals/define-built-in":245,"../internals/engine-is-node":254,"../internals/export":259,"../internals/function-call":264,"../internals/global":274,"../internals/host-report-errors":277,"../internals/internal-state":282,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/microtask":302,"../internals/new-promise-capability":303,"../internals/object-set-prototype-of":318,"../internals/perform":323,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/queue":328,"../internals/set-species":330,"../internals/set-to-string-tag":331,"../internals/species-constructor":335,"../internals/task":339}],371:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/is-pure"),l=e("../internals/promise-native-constructor"),c=e("../internals/fails"),i=e("../internals/get-built-in"),u=e("../internals/is-callable"),p=e("../internals/species-constructor"),f=e("../internals/promise-resolve"),h=e("../internals/define-built-in"),v=l&&l.prototype;if(o({target:"Promise",proto:!0,real:!0,forced:!!l&&c(function(){v.finally.call({then:function(){}},function(){})})},{finally:function(g){var x=p(this,i("Promise")),y=u(g);return this.then(y?function(k){return f(x,g()).then(function(){return k})}:g,y?function(k){return f(x,g()).then(function(){throw k})}:g)}}),!s&&u(l)){var b=i("Promise").prototype.finally;v.finally!==b&&h(v,"finally",b,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/fails":260,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326,"../internals/species-constructor":335}],372:[function(e,n,a){e("../modules/es.promise.constructor"),e("../modules/es.promise.all"),e("../modules/es.promise.catch"),e("../modules/es.promise.race"),e("../modules/es.promise.reject"),e("../modules/es.promise.resolve")},{"../modules/es.promise.all":368,"../modules/es.promise.catch":369,"../modules/es.promise.constructor":370,"../modules/es.promise.race":373,"../modules/es.promise.reject":374,"../modules/es.promise.resolve":375}],373:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/function-call"),l=e("../internals/a-callable"),c=e("../internals/new-promise-capability"),i=e("../internals/perform"),u=e("../internals/iterate");o({target:"Promise",stat:!0,forced:e("../internals/promise-statics-incorrect-iteration")},{race:function(p){var f=this,h=c.f(f),v=h.reject,b=i(function(){var g=l(f.resolve);u(p,function(x){s(g,f,x).then(h.resolve,v)})});return b.error&&v(b.value),h.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],374:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/function-call"),l=e("../internals/new-promise-capability");o({target:"Promise",stat:!0,forced:e("../internals/promise-constructor-detection").CONSTRUCTOR},{reject:function(c){var i=l.f(this);return s(i.reject,void 0,c),i.promise}})},{"../internals/export":259,"../internals/function-call":264,"../internals/new-promise-capability":303,"../internals/promise-constructor-detection":324}],375:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/get-built-in"),l=e("../internals/is-pure"),c=e("../internals/promise-native-constructor"),i=e("../internals/promise-constructor-detection").CONSTRUCTOR,u=e("../internals/promise-resolve"),p=s("Promise"),f=l&&!i;o({target:"Promise",stat:!0,forced:l||i},{resolve:function(h){return u(f&&this===p?c:this,h)}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326}],376:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/function-uncurry-this"),l=e("../internals/to-absolute-index"),c=RangeError,i=String.fromCharCode,u=String.fromCodePoint,p=s([].join);o({target:"String",stat:!0,arity:1,forced:!!u&&u.length!==1},{fromCodePoint:function(f){for(var h,v=[],b=arguments.length,g=0;b>g;){if(h=+arguments[g++],l(h,1114111)!==h)throw new c(h+" is not a valid code point");v[g]=h<65536?i(h):i(55296+((h-=65536)>>10),h%1024+56320)}return p(v,"")}})},{"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/to-absolute-index":340}],377:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/function-uncurry-this"),l=e("../internals/not-a-regexp"),c=e("../internals/require-object-coercible"),i=e("../internals/to-string"),u=e("../internals/correct-is-regexp-logic"),p=s("".indexOf);o({target:"String",proto:!0,forced:!u("includes")},{includes:function(f){return!!~p(i(c(this)),i(l(f)),arguments.length>1?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":238,"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/not-a-regexp":304,"../internals/require-object-coercible":329,"../internals/to-string":348}],378:[function(e,n,a){e("../internals/well-known-symbol-define")("asyncIterator")},{"../internals/well-known-symbol-define":355}],379:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/global"),l=e("../internals/function-call"),c=e("../internals/function-uncurry-this"),i=e("../internals/is-pure"),u=e("../internals/descriptors"),p=e("../internals/symbol-constructor-detection"),f=e("../internals/fails"),h=e("../internals/has-own-property"),v=e("../internals/object-is-prototype-of"),b=e("../internals/an-object"),g=e("../internals/to-indexed-object"),x=e("../internals/to-property-key"),y=e("../internals/to-string"),k=e("../internals/create-property-descriptor"),N=e("../internals/object-create"),F=e("../internals/object-keys"),B=e("../internals/object-get-own-property-names"),W=e("../internals/object-get-own-property-names-external"),V=e("../internals/object-get-own-property-symbols"),q=e("../internals/object-get-own-property-descriptor"),X=e("../internals/object-define-property"),I=e("../internals/object-define-properties"),H=e("../internals/object-property-is-enumerable"),O=e("../internals/define-built-in"),R=e("../internals/define-built-in-accessor"),C=e("../internals/shared"),w=e("../internals/shared-key"),E=e("../internals/hidden-keys"),A=e("../internals/uid"),T=e("../internals/well-known-symbol"),D=e("../internals/well-known-symbol-wrapped"),U=e("../internals/well-known-symbol-define"),P=e("../internals/symbol-define-to-primitive"),K=e("../internals/set-to-string-tag"),Y=e("../internals/internal-state"),re=e("../internals/array-iteration").forEach,z=w("hidden"),ee=Y.set,L=Y.getterFor("Symbol"),M=Object.prototype,Z=s.Symbol,se=Z&&Z.prototype,ae=s.RangeError,ne=s.TypeError,Q=s.QObject,fe=q.f,le=X.f,te=W.f,ce=H.f,he=c([].push),Ee=C("symbols"),ke=C("op-symbols"),Ce=C("wks"),Fe=!Q||!Q.prototype||!Q.prototype.findChild,Pe=function(rt,it,dt){var wt=fe(M,it);wt&&delete M[it],le(rt,it,dt),wt&&rt!==M&&le(M,it,wt)},Xe=u&&f(function(){return N(le({},"a",{get:function(){return le(this,"a",{value:7}).a}})).a!==7})?Pe:le,ct=function(rt,it){var dt=Ee[rt]=N(se);return ee(dt,{type:"Symbol",tag:rt,description:it}),u||(dt.description=it),dt},st=function(rt,it,dt){rt===M&&st(ke,it,dt),b(rt);var wt=x(it);return b(dt),h(Ee,wt)?(dt.enumerable?(h(rt,z)&&rt[z][wt]&&(rt[z][wt]=!1),dt=N(dt,{enumerable:k(0,!1)})):(h(rt,z)||le(rt,z,k(1,{})),rt[z][wt]=!0),Xe(rt,wt,dt)):le(rt,wt,dt)},lt=function(rt,it){b(rt);var dt=g(it),wt=F(dt).concat(ht(dt));return re(wt,function(gt){u&&!l(tt,dt,gt)||st(rt,gt,dt[gt])}),rt},tt=function(rt){var it=x(rt),dt=l(ce,this,it);return!(this===M&&h(Ee,it)&&!h(ke,it))&&(!(dt||!h(this,it)||!h(Ee,it)||h(this,z)&&this[z][it])||dt)},ot=function(rt,it){var dt=g(rt),wt=x(it);if(dt!==M||!h(Ee,wt)||h(ke,wt)){var gt=fe(dt,wt);return!gt||!h(Ee,wt)||h(dt,z)&&dt[z][wt]||(gt.enumerable=!0),gt}},De=function(rt){var it=te(g(rt)),dt=[];return re(it,function(wt){h(Ee,wt)||h(E,wt)||he(dt,wt)}),dt},ht=function(rt){var it=rt===M,dt=te(it?ke:g(rt)),wt=[];return re(dt,function(gt){!h(Ee,gt)||it&&!h(M,gt)||he(wt,Ee[gt])}),wt};p||(O(se=(Z=function(){if(v(se,this))throw new ne("Symbol is not a constructor");var rt=arguments.length&&arguments[0]!==void 0?y(arguments[0]):void 0,it=A(rt),dt=function(wt){this===M&&l(dt,ke,wt),h(this,z)&&h(this[z],it)&&(this[z][it]=!1);var gt=k(1,wt);try{Xe(this,it,gt)}catch(vt){if(!(vt instanceof ae))throw vt;Pe(this,it,gt)}};return u&&Fe&&Xe(M,it,{configurable:!0,set:dt}),ct(it,rt)}).prototype,"toString",function(){return L(this).tag}),O(Z,"withoutSetter",function(rt){return ct(A(rt),rt)}),H.f=tt,X.f=st,I.f=lt,q.f=ot,B.f=W.f=De,V.f=ht,D.f=function(rt){return ct(T(rt),rt)},u&&(R(se,"description",{configurable:!0,get:function(){return L(this).description}}),i||O(M,"propertyIsEnumerable",tt,{unsafe:!0}))),o({global:!0,constructor:!0,wrap:!0,forced:!p,sham:!p},{Symbol:Z}),re(F(Ce),function(rt){U(rt)}),o({target:"Symbol",stat:!0,forced:!p},{useSetter:function(){Fe=!0},useSimple:function(){Fe=!1}}),o({target:"Object",stat:!0,forced:!p,sham:!u},{create:function(rt,it){return it===void 0?N(rt):lt(N(rt),it)},defineProperty:st,defineProperties:lt,getOwnPropertyDescriptor:ot}),o({target:"Object",stat:!0,forced:!p},{getOwnPropertyNames:De}),P(),K(Z,"Symbol"),E[z]=!0},{"../internals/an-object":227,"../internals/array-iteration":229,"../internals/create-property-descriptor":242,"../internals/define-built-in":245,"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/export":259,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-define-properties":307,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-names-external":310,"../internals/object-get-own-property-symbols":312,"../internals/object-is-prototype-of":314,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/set-to-string-tag":331,"../internals/shared":334,"../internals/shared-key":332,"../internals/symbol-constructor-detection":336,"../internals/symbol-define-to-primitive":337,"../internals/to-indexed-object":341,"../internals/to-property-key":346,"../internals/to-string":348,"../internals/uid":350,"../internals/well-known-symbol":357,"../internals/well-known-symbol-define":355,"../internals/well-known-symbol-wrapped":356}],380:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/get-built-in"),l=e("../internals/has-own-property"),c=e("../internals/to-string"),i=e("../internals/shared"),u=e("../internals/symbol-registry-detection"),p=i("string-to-symbol-registry"),f=i("symbol-to-string-registry");o({target:"Symbol",stat:!0,forced:!u},{for:function(h){var v=c(h);if(l(p,v))return p[v];var b=s("Symbol")(v);return p[v]=b,f[b]=v,b}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/to-string":348}],381:[function(e,n,a){e("../modules/es.symbol.constructor"),e("../modules/es.symbol.for"),e("../modules/es.symbol.key-for"),e("../modules/es.json.stringify"),e("../modules/es.object.get-own-property-symbols")},{"../modules/es.json.stringify":362,"../modules/es.object.get-own-property-symbols":365,"../modules/es.symbol.constructor":379,"../modules/es.symbol.for":380,"../modules/es.symbol.key-for":382}],382:[function(e,n,a){var o=e("../internals/export"),s=e("../internals/has-own-property"),l=e("../internals/is-symbol"),c=e("../internals/try-to-string"),i=e("../internals/shared"),u=e("../internals/symbol-registry-detection"),p=i("symbol-to-string-registry");o({target:"Symbol",stat:!0,forced:!u},{keyFor:function(f){if(!l(f))throw new TypeError(c(f)+" is not a symbol");if(s(p,f))return p[f]}})},{"../internals/export":259,"../internals/has-own-property":275,"../internals/is-symbol":292,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/try-to-string":349}],383:[function(e,n,a){function o(s){return Object.prototype.toString.call(s)}a.isArray=function(s){return Array.isArray?Array.isArray(s):o(s)==="[object Array]"},a.isBoolean=function(s){return typeof s=="boolean"},a.isNull=function(s){return s===null},a.isNullOrUndefined=function(s){return s==null},a.isNumber=function(s){return typeof s=="number"},a.isString=function(s){return typeof s=="string"},a.isSymbol=function(s){return typeof s=="symbol"},a.isUndefined=function(s){return s===void 0},a.isRegExp=function(s){return o(s)==="[object RegExp]"},a.isObject=function(s){return typeof s=="object"&&s!==null},a.isDate=function(s){return o(s)==="[object Date]"},a.isError=function(s){return o(s)==="[object Error]"||s instanceof Error},a.isFunction=function(s){return typeof s=="function"},a.isPrimitive=function(s){return s===null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||typeof s=="symbol"||s===void 0},a.isBuffer=e("buffer").Buffer.isBuffer},{buffer:220}],384:[function(e,n,a){(function(o){(function(){var s=e("elliptic"),l=e("bn.js");n.exports=function(p){return new i(p)};var c={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function i(p){this.curveType=c[p],this.curveType||(this.curveType={name:p}),this.curve=new s.ec(this.curveType.name),this.keys=void 0}function u(p,f,h){Array.isArray(p)||(p=p.toArray());var v=new o(p);if(h&&v.length<h){var b=new o(h-v.length);b.fill(0),v=o.concat([b,v])}return f?v.toString(f):v}c.p224=c.secp224r1,c.p256=c.secp256r1=c.prime256v1,c.p192=c.secp192r1=c.prime192v1,c.p384=c.secp384r1,c.p521=c.secp521r1,i.prototype.generateKeys=function(p,f){return this.keys=this.curve.genKeyPair(),this.getPublicKey(p,f)},i.prototype.computeSecret=function(p,f,h){return f=f||"utf8",o.isBuffer(p)||(p=new o(p,f)),u(this.curve.keyFromPublic(p).getPublic().mul(this.keys.getPrivate()).getX(),h,this.curveType.byteLength)},i.prototype.getPublicKey=function(p,f){var h=this.keys.getPublic(f==="compressed",!0);return f==="hybrid"&&(h[h.length-1]%2?h[0]=7:h[0]=6),u(h,p)},i.prototype.getPrivateKey=function(p){return u(this.keys.getPrivate(),p)},i.prototype.setPublicKey=function(p,f){return f=f||"utf8",o.isBuffer(p)||(p=new o(p,f)),this.keys._importPublic(p),this},i.prototype.setPrivateKey=function(p,f){f=f||"utf8",o.isBuffer(p)||(p=new o(p,f));var h=new l(p);return h=h.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(h),this}}).call(this)}).call(this,e("buffer").Buffer)},{"bn.js":385,buffer:220,elliptic:405}],385:[function(e,n,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],386:[function(e,n,a){var o=e("inherits"),s=e("md5.js"),l=e("ripemd160"),c=e("sha.js"),i=e("cipher-base");function u(p){i.call(this,"digest"),this._hash=p}o(u,i),u.prototype._update=function(p){this._hash.update(p)},u.prototype._final=function(){return this._hash.digest()},n.exports=function(p){return(p=p.toLowerCase())==="md5"?new s:p==="rmd160"||p==="ripemd160"?new l:new u(c(p))}},{"cipher-base":221,inherits:440,"md5.js":450,ripemd160:493,"sha.js":498}],387:[function(e,n,a){var o=e("md5.js");n.exports=function(s){return new o().update(s).digest()}},{"md5.js":450}],388:[function(e,n,a){var o=e("inherits"),s=e("./legacy"),l=e("cipher-base"),c=e("safe-buffer").Buffer,i=e("create-hash/md5"),u=e("ripemd160"),p=e("sha.js"),f=c.alloc(128);function h(v,b){l.call(this,"digest"),typeof b=="string"&&(b=c.from(b));var g=v==="sha512"||v==="sha384"?128:64;this._alg=v,this._key=b,b.length>g?b=(v==="rmd160"?new u:p(v)).update(b).digest():b.length<g&&(b=c.concat([b,f],g));for(var x=this._ipad=c.allocUnsafe(g),y=this._opad=c.allocUnsafe(g),k=0;k<g;k++)x[k]=54^b[k],y[k]=92^b[k];this._hash=v==="rmd160"?new u:p(v),this._hash.update(x)}o(h,l),h.prototype._update=function(v){this._hash.update(v)},h.prototype._final=function(){var v=this._hash.digest();return(this._alg==="rmd160"?new u:p(this._alg)).update(this._opad).update(v).digest()},n.exports=function(v,b){return(v=v.toLowerCase())==="rmd160"||v==="ripemd160"?new h("rmd160",b):v==="md5"?new s(i,b):new h(v,b)}},{"./legacy":389,"cipher-base":221,"create-hash/md5":387,inherits:440,ripemd160:493,"safe-buffer":494,"sha.js":498}],389:[function(e,n,a){var o=e("inherits"),s=e("safe-buffer").Buffer,l=e("cipher-base"),c=s.alloc(128);function i(u,p){l.call(this,"digest"),typeof p=="string"&&(p=s.from(p)),this._alg=u,this._key=p,p.length>64?p=u(p):p.length<64&&(p=s.concat([p,c],64));for(var f=this._ipad=s.allocUnsafe(64),h=this._opad=s.allocUnsafe(64),v=0;v<64;v++)f[v]=54^p[v],h[v]=92^p[v];this._hash=[f]}o(i,l),i.prototype._update=function(u){this._hash.push(u)},i.prototype._final=function(){var u=this._alg(s.concat(this._hash));return this._alg(s.concat([this._opad,u]))},n.exports=i},{"cipher-base":221,inherits:440,"safe-buffer":494}],390:[function(e,n,a){a.randomBytes=a.rng=a.pseudoRandomBytes=a.prng=e("randombytes"),a.createHash=a.Hash=e("create-hash"),a.createHmac=a.Hmac=e("create-hmac");var o=e("browserify-sign/algos"),s=Object.keys(o),l=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(s);a.getHashes=function(){return l};var c=e("pbkdf2");a.pbkdf2=c.pbkdf2,a.pbkdf2Sync=c.pbkdf2Sync;var i=e("browserify-cipher");a.Cipher=i.Cipher,a.createCipher=i.createCipher,a.Cipheriv=i.Cipheriv,a.createCipheriv=i.createCipheriv,a.Decipher=i.Decipher,a.createDecipher=i.createDecipher,a.Decipheriv=i.Decipheriv,a.createDecipheriv=i.createDecipheriv,a.getCiphers=i.getCiphers,a.listCiphers=i.listCiphers;var u=e("diffie-hellman");a.DiffieHellmanGroup=u.DiffieHellmanGroup,a.createDiffieHellmanGroup=u.createDiffieHellmanGroup,a.getDiffieHellman=u.getDiffieHellman,a.createDiffieHellman=u.createDiffieHellman,a.DiffieHellman=u.DiffieHellman;var p=e("browserify-sign");a.createSign=p.createSign,a.Sign=p.Sign,a.createVerify=p.createVerify,a.Verify=p.Verify,a.createECDH=e("create-ecdh");var f=e("public-encrypt");a.publicEncrypt=f.publicEncrypt,a.privateEncrypt=f.privateEncrypt,a.publicDecrypt=f.publicDecrypt,a.privateDecrypt=f.privateDecrypt;var h=e("randomfill");a.randomFill=h.randomFill,a.randomFillSync=h.randomFillSync,a.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},a.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":206,"browserify-sign":213,"browserify-sign/algos":210,"create-ecdh":384,"create-hash":386,"create-hmac":388,"diffie-hellman":400,pbkdf2:460,"public-encrypt":468,randombytes:475,randomfill:476}],391:[function(e,n,a){(function(o,s){typeof a=="object"&&n!==void 0?n.exports=s():(o=typeof globalThis<"u"?globalThis:o||self).dayjs=s()})(void 0,function(){var o=6e4,s=36e5,l="millisecond",c="second",i="minute",u="hour",p="day",f="week",h="month",v="quarter",b="year",g="date",x="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,k=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,N={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(w){var E=["th","st","nd","rd"],A=w%100;return"["+w+(E[(A-20)%10]||E[A]||E[0])+"]"}},F=function(w,E,A){var T=String(w);return!T||T.length>=E?w:""+Array(E+1-T.length).join(A)+w},B={s:F,z:function(w){var E=-w.utcOffset(),A=Math.abs(E),T=Math.floor(A/60),D=A%60;return(E<=0?"+":"-")+F(T,2,"0")+":"+F(D,2,"0")},m:function w(E,A){if(E.date()<A.date())return-w(A,E);var T=12*(A.year()-E.year())+(A.month()-E.month()),D=E.clone().add(T,h),U=A-D<0,P=E.clone().add(T+(U?-1:1),h);return+(-(T+(A-D)/(U?D-P:P-D))||0)},a:function(w){return w<0?Math.ceil(w)||0:Math.floor(w)},p:function(w){return{M:h,y:b,w:f,d:p,D:g,h:u,m:i,s:c,ms:l,Q:v}[w]||String(w||"").toLowerCase().replace(/s$/,"")},u:function(w){return w===void 0}},W="en",V={};V[W]=N;var q="$isDayjsObject",X=function(w){return w instanceof R||!(!w||!w[q])},I=function w(E,A,T){var D;if(!E)return W;if(typeof E=="string"){var U=E.toLowerCase();V[U]&&(D=U),A&&(V[U]=A,D=U);var P=E.split("-");if(!D&&P.length>1)return w(P[0])}else{var K=E.name;V[K]=E,D=K}return!T&&D&&(W=D),D||!T&&W},H=function(w,E){if(X(w))return w.clone();var A=typeof E=="object"?E:{};return A.date=w,A.args=arguments,new R(A)},O=B;O.l=I,O.i=X,O.w=function(w,E){return H(w,{locale:E.$L,utc:E.$u,x:E.$x,$offset:E.$offset})};var R=function(){function w(A){this.$L=I(A.locale,null,!0),this.parse(A),this.$x=this.$x||A.x||{},this[q]=!0}var E=w.prototype;return E.parse=function(A){this.$d=function(T){var D=T.date,U=T.utc;if(D===null)return new Date(NaN);if(O.u(D))return new Date;if(D instanceof Date)return new Date(D);if(typeof D=="string"&&!/Z$/i.test(D)){var P=D.match(y);if(P){var K=P[2]-1||0,Y=(P[7]||"0").substring(0,3);return U?new Date(Date.UTC(P[1],K,P[3]||1,P[4]||0,P[5]||0,P[6]||0,Y)):new Date(P[1],K,P[3]||1,P[4]||0,P[5]||0,P[6]||0,Y)}}return new Date(D)}(A),this.init()},E.init=function(){var A=this.$d;this.$y=A.getFullYear(),this.$M=A.getMonth(),this.$D=A.getDate(),this.$W=A.getDay(),this.$H=A.getHours(),this.$m=A.getMinutes(),this.$s=A.getSeconds(),this.$ms=A.getMilliseconds()},E.$utils=function(){return O},E.isValid=function(){return this.$d.toString()!==x},E.isSame=function(A,T){var D=H(A);return this.startOf(T)<=D&&D<=this.endOf(T)},E.isAfter=function(A,T){return H(A)<this.startOf(T)},E.isBefore=function(A,T){return this.endOf(T)<H(A)},E.$g=function(A,T,D){return O.u(A)?this[T]:this.set(D,A)},E.unix=function(){return Math.floor(this.valueOf()/1e3)},E.valueOf=function(){return this.$d.getTime()},E.startOf=function(A,T){var D=this,U=!!O.u(T)||T,P=O.p(A),K=function(se,ae){var ne=O.w(D.$u?Date.UTC(D.$y,ae,se):new Date(D.$y,ae,se),D);return U?ne:ne.endOf(p)},Y=function(se,ae){return O.w(D.toDate()[se].apply(D.toDate("s"),(U?[0,0,0,0]:[23,59,59,999]).slice(ae)),D)},re=this.$W,z=this.$M,ee=this.$D,L="set"+(this.$u?"UTC":"");switch(P){case b:return U?K(1,0):K(31,11);case h:return U?K(1,z):K(0,z+1);case f:var M=this.$locale().weekStart||0,Z=(re<M?re+7:re)-M;return K(U?ee-Z:ee+(6-Z),z);case p:case g:return Y(L+"Hours",0);case u:return Y(L+"Minutes",1);case i:return Y(L+"Seconds",2);case c:return Y(L+"Milliseconds",3);default:return this.clone()}},E.endOf=function(A){return this.startOf(A,!1)},E.$set=function(A,T){var D,U=O.p(A),P="set"+(this.$u?"UTC":""),K=(D={},D[p]=P+"Date",D[g]=P+"Date",D[h]=P+"Month",D[b]=P+"FullYear",D[u]=P+"Hours",D[i]=P+"Minutes",D[c]=P+"Seconds",D[l]=P+"Milliseconds",D)[U],Y=U===p?this.$D+(T-this.$W):T;if(U===h||U===b){var re=this.clone().set(g,1);re.$d[K](Y),re.init(),this.$d=re.set(g,Math.min(this.$D,re.daysInMonth())).$d}else K&&this.$d[K](Y);return this.init(),this},E.set=function(A,T){return this.clone().$set(A,T)},E.get=function(A){return this[O.p(A)]()},E.add=function(A,T){var D,U=this;A=Number(A);var P=O.p(T),K=function(z){var ee=H(U);return O.w(ee.date(ee.date()+Math.round(z*A)),U)};if(P===h)return this.set(h,this.$M+A);if(P===b)return this.set(b,this.$y+A);if(P===p)return K(1);if(P===f)return K(7);var Y=(D={},D[i]=o,D[u]=s,D[c]=1e3,D)[P]||1,re=this.$d.getTime()+A*Y;return O.w(re,this)},E.subtract=function(A,T){return this.add(-1*A,T)},E.format=function(A){var T=this,D=this.$locale();if(!this.isValid())return D.invalidDate||x;var U=A||"YYYY-MM-DDTHH:mm:ssZ",P=O.z(this),K=this.$H,Y=this.$m,re=this.$M,z=D.weekdays,ee=D.months,L=D.meridiem,M=function(ae,ne,Q,fe){return ae&&(ae[ne]||ae(T,U))||Q[ne].slice(0,fe)},Z=function(ae){return O.s(K%12||12,ae,"0")},se=L||function(ae,ne,Q){var fe=ae<12?"AM":"PM";return Q?fe.toLowerCase():fe};return U.replace(k,function(ae,ne){return ne||function(Q){switch(Q){case"YY":return String(T.$y).slice(-2);case"YYYY":return O.s(T.$y,4,"0");case"M":return re+1;case"MM":return O.s(re+1,2,"0");case"MMM":return M(D.monthsShort,re,ee,3);case"MMMM":return M(ee,re);case"D":return T.$D;case"DD":return O.s(T.$D,2,"0");case"d":return String(T.$W);case"dd":return M(D.weekdaysMin,T.$W,z,2);case"ddd":return M(D.weekdaysShort,T.$W,z,3);case"dddd":return z[T.$W];case"H":return String(K);case"HH":return O.s(K,2,"0");case"h":return Z(1);case"hh":return Z(2);case"a":return se(K,Y,!0);case"A":return se(K,Y,!1);case"m":return String(Y);case"mm":return O.s(Y,2,"0");case"s":return String(T.$s);case"ss":return O.s(T.$s,2,"0");case"SSS":return O.s(T.$ms,3,"0");case"Z":return P}return null}(ae)||P.replace(":","")})},E.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},E.diff=function(A,T,D){var U,P=this,K=O.p(T),Y=H(A),re=(Y.utcOffset()-this.utcOffset())*o,z=this-Y,ee=function(){return O.m(P,Y)};switch(K){case b:U=ee()/12;break;case h:U=ee();break;case v:U=ee()/3;break;case f:U=(z-re)/6048e5;break;case p:U=(z-re)/864e5;break;case u:U=z/s;break;case i:U=z/o;break;case c:U=z/1e3;break;default:U=z}return D?U:O.a(U)},E.daysInMonth=function(){return this.endOf(h).$D},E.$locale=function(){return V[this.$L]},E.locale=function(A,T){if(!A)return this.$L;var D=this.clone(),U=I(A,T,!0);return U&&(D.$L=U),D},E.clone=function(){return O.w(this.$d,this)},E.toDate=function(){return new Date(this.valueOf())},E.toJSON=function(){return this.isValid()?this.toISOString():null},E.toISOString=function(){return this.$d.toISOString()},E.toString=function(){return this.$d.toUTCString()},w}(),C=R.prototype;return H.prototype=C,[["$ms",l],["$s",c],["$m",i],["$H",u],["$W",p],["$M",h],["$y",b],["$D",g]].forEach(function(w){C[w[1]]=function(E){return this.$g(E,w[0],w[1])}}),H.extend=function(w,E){return w.$i||(w(E,R,H),w.$i=!0),H},H.locale=I,H.isDayjs=X,H.unix=function(w){return H(1e3*w)},H.en=V[W],H.Ls=V,H.p={},H})},{}],392:[function(e,n,a){(function(o,s){typeof a=="object"&&n!==void 0?n.exports=s():(o=typeof globalThis<"u"?globalThis:o||self).dayjs_plugin_customParseFormat=s()})(void 0,function(){var o={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},s=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,l=/\d\d/,c=/\d\d?/,i=/\d*[^-_:/,()\s\d]+/,u={},p=function(y){return(y=+y)+(y>68?1900:2e3)},f=function(y){return function(k){this[y]=+k}},h=[/[+-]\d\d:?(\d\d)?|Z/,function(y){(this.zone||(this.zone={})).offset=function(k){if(!k||k==="Z")return 0;var N=k.match(/([+-]|\d\d)/g),F=60*N[1]+(+N[2]||0);return F===0?0:N[0]==="+"?-F:F}(y)}],v=function(y){var k=u[y];return k&&(k.indexOf?k:k.s.concat(k.f))},b=function(y,k){var N,F=u.meridiem;if(F){for(var B=1;B<=24;B+=1)if(y.indexOf(F(B,0,k))>-1){N=B>12;break}}else N=y===(k?"pm":"PM");return N},g={A:[i,function(y){this.afternoon=b(y,!1)}],a:[i,function(y){this.afternoon=b(y,!0)}],S:[/\d/,function(y){this.milliseconds=100*+y}],SS:[l,function(y){this.milliseconds=10*+y}],SSS:[/\d{3}/,function(y){this.milliseconds=+y}],s:[c,f("seconds")],ss:[c,f("seconds")],m:[c,f("minutes")],mm:[c,f("minutes")],H:[c,f("hours")],h:[c,f("hours")],HH:[c,f("hours")],hh:[c,f("hours")],D:[c,f("day")],DD:[l,f("day")],Do:[i,function(y){var k=u.ordinal,N=y.match(/\d+/);if(this.day=N[0],k)for(var F=1;F<=31;F+=1)k(F).replace(/\[|\]/g,"")===y&&(this.day=F)}],M:[c,f("month")],MM:[l,f("month")],MMM:[i,function(y){var k=v("months"),N=(v("monthsShort")||k.map(function(F){return F.slice(0,3)})).indexOf(y)+1;if(N<1)throw new Error;this.month=N%12||N}],MMMM:[i,function(y){var k=v("months").indexOf(y)+1;if(k<1)throw new Error;this.month=k%12||k}],Y:[/[+-]?\d+/,f("year")],YY:[l,function(y){this.year=p(y)}],YYYY:[/\d{4}/,f("year")],Z:h,ZZ:h};function x(y){var k,N;k=y,N=u&&u.formats;for(var F=(y=k.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(H,O,R){var C=R&&R.toUpperCase();return O||N[R]||o[R]||N[C].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(w,E,A){return E||A.slice(1)})})).match(s),B=F.length,W=0;W<B;W+=1){var V=F[W],q=g[V],X=q&&q[0],I=q&&q[1];F[W]=I?{regex:X,parser:I}:V.replace(/^\[|\]$/g,"")}return function(H){for(var O={},R=0,C=0;R<B;R+=1){var w=F[R];if(typeof w=="string")C+=w.length;else{var E=w.regex,A=w.parser,T=H.slice(C),D=E.exec(T)[0];A.call(O,D),H=H.replace(D,"")}}return function(U){var P=U.afternoon;if(P!==void 0){var K=U.hours;P?K<12&&(U.hours+=12):K===12&&(U.hours=0),delete U.afternoon}}(O),O}}return function(y,k,N){N.p.customParseFormat=!0,y&&y.parseTwoDigitYear&&(p=y.parseTwoDigitYear);var F=k.prototype,B=F.parse;F.parse=function(W){var V=W.date,q=W.utc,X=W.args;this.$u=q;var I=X[1];if(typeof I=="string"){var H=X[2]===!0,O=X[3]===!0,R=H||O,C=X[2];O&&(C=X[2]),u=this.$locale(),!H&&C&&(u=N.Ls[C]),this.$d=function(T,D,U){try{if(["x","X"].indexOf(D)>-1)return new Date((D==="X"?1e3:1)*T);var P=x(D)(T),K=P.year,Y=P.month,re=P.day,z=P.hours,ee=P.minutes,L=P.seconds,M=P.milliseconds,Z=P.zone,se=new Date,ae=re||(K||Y?1:se.getDate()),ne=K||se.getFullYear(),Q=0;K&&!Y||(Q=Y>0?Y-1:se.getMonth());var fe=z||0,le=ee||0,te=L||0,ce=M||0;return Z?new Date(Date.UTC(ne,Q,ae,fe,le,te,ce+60*Z.offset*1e3)):U?new Date(Date.UTC(ne,Q,ae,fe,le,te,ce)):new Date(ne,Q,ae,fe,le,te,ce)}catch{return new Date("")}}(V,I,q),this.init(),C&&C!==!0&&(this.$L=this.locale(C).$L),R&&V!=this.format(I)&&(this.$d=new Date("")),u={}}else if(I instanceof Array)for(var w=I.length,E=1;E<=w;E+=1){X[1]=I[E-1];var A=N.apply(this,X);if(A.isValid()){this.$d=A.$d,this.$L=A.$L,this.init();break}E===w&&(this.$d=new Date(""))}else B.call(this,W)}}})},{}],393:[function(e,n,a){(function(o,s){typeof a=="object"&&n!==void 0?n.exports=s():(o=typeof globalThis<"u"?globalThis:o||self).dayjs_plugin_utc=s()})(void 0,function(){var o="minute",s=/[+-]\d\d(?::?\d\d)?/g,l=/([+-]|\d\d)/g;return function(c,i,u){var p=i.prototype;u.utc=function(y){var k={date:y,utc:!0,args:arguments};return new i(k)},p.utc=function(y){var k=u(this.toDate(),{locale:this.$L,utc:!0});return y?k.add(this.utcOffset(),o):k},p.local=function(){return u(this.toDate(),{locale:this.$L,utc:!1})};var f=p.parse;p.parse=function(y){y.utc&&(this.$u=!0),this.$utils().u(y.$offset)||(this.$offset=y.$offset),f.call(this,y)};var h=p.init;p.init=function(){if(this.$u){var y=this.$d;this.$y=y.getUTCFullYear(),this.$M=y.getUTCMonth(),this.$D=y.getUTCDate(),this.$W=y.getUTCDay(),this.$H=y.getUTCHours(),this.$m=y.getUTCMinutes(),this.$s=y.getUTCSeconds(),this.$ms=y.getUTCMilliseconds()}else h.call(this)};var v=p.utcOffset;p.utcOffset=function(y,k){var N=this.$utils().u;if(N(y))return this.$u?0:N(this.$offset)?v.call(this):this.$offset;if(typeof y=="string"&&(y=function(V){V===void 0&&(V="");var q=V.match(s);if(!q)return null;var X=(""+q[0]).match(l)||["-",0,0],I=X[0],H=60*+X[1]+ +X[2];return H===0?0:I==="+"?H:-H}(y))===null)return this;var F=Math.abs(y)<=16?60*y:y,B=this;if(k)return B.$offset=F,B.$u=y===0,B;if(y!==0){var W=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(B=this.local().add(F+W,o)).$offset=F,B.$x.$localOffset=W}else B=this.utc();return B};var b=p.format;p.format=function(y){var k=y||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return b.call(this,k)},p.valueOf=function(){var y=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*y},p.isUTC=function(){return!!this.$u},p.toISOString=function(){return this.toDate().toISOString()},p.toString=function(){return this.toDate().toUTCString()};var g=p.toDate;p.toDate=function(y){return y==="s"&&this.$offset?u(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():g.call(this)};var x=p.diff;p.diff=function(y,k,N){if(y&&this.$u===y.$u)return x.call(this,y,k,N);var F=this.local(),B=u(y).local();return x.call(F,B,k,N)}}})},{}],394:[function(e,n,a){a.utils=e("./des/utils"),a.Cipher=e("./des/cipher"),a.DES=e("./des/des"),a.CBC=e("./des/cbc"),a.EDE=e("./des/ede")},{"./des/cbc":395,"./des/cipher":396,"./des/des":397,"./des/ede":398,"./des/utils":399}],395:[function(e,n,a){var o=e("minimalistic-assert"),s=e("inherits"),l={};function c(i){o.equal(i.length,8,"Invalid IV length"),this.iv=new Array(8);for(var u=0;u<this.iv.length;u++)this.iv[u]=i[u]}a.instantiate=function(i){function u(v){i.call(this,v),this._cbcInit()}s(u,i);for(var p=Object.keys(l),f=0;f<p.length;f++){var h=p[f];u.prototype[h]=l[h]}return u.create=function(v){return new u(v)},u},l._cbcInit=function(){var i=new c(this.options.iv);this._cbcState=i},l._update=function(i,u,p,f){var h=this._cbcState,v=this.constructor.super_.prototype,b=h.iv;if(this.type==="encrypt"){for(var g=0;g<this.blockSize;g++)b[g]^=i[u+g];for(v._update.call(this,b,0,p,f),g=0;g<this.blockSize;g++)b[g]=p[f+g]}else{for(v._update.call(this,i,u,p,f),g=0;g<this.blockSize;g++)p[f+g]^=b[g];for(g=0;g<this.blockSize;g++)b[g]=i[u+g]}}},{inherits:440,"minimalistic-assert":453}],396:[function(e,n,a){var o=e("minimalistic-assert");function s(l){this.options=l,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=l.padding!==!1}n.exports=s,s.prototype._init=function(){},s.prototype.update=function(l){return l.length===0?[]:this.type==="decrypt"?this._updateDecrypt(l):this._updateEncrypt(l)},s.prototype._buffer=function(l,c){for(var i=Math.min(this.buffer.length-this.bufferOff,l.length-c),u=0;u<i;u++)this.buffer[this.bufferOff+u]=l[c+u];return this.bufferOff+=i,i},s.prototype._flushBuffer=function(l,c){return this._update(this.buffer,0,l,c),this.bufferOff=0,this.blockSize},s.prototype._updateEncrypt=function(l){var c=0,i=0,u=(this.bufferOff+l.length)/this.blockSize|0,p=new Array(u*this.blockSize);this.bufferOff!==0&&(c+=this._buffer(l,c),this.bufferOff===this.buffer.length&&(i+=this._flushBuffer(p,i)));for(var f=l.length-(l.length-c)%this.blockSize;c<f;c+=this.blockSize)this._update(l,c,p,i),i+=this.blockSize;for(;c<l.length;c++,this.bufferOff++)this.buffer[this.bufferOff]=l[c];return p},s.prototype._updateDecrypt=function(l){for(var c=0,i=0,u=Math.ceil((this.bufferOff+l.length)/this.blockSize)-1,p=new Array(u*this.blockSize);u>0;u--)c+=this._buffer(l,c),i+=this._flushBuffer(p,i);return c+=this._buffer(l,c),p},s.prototype.final=function(l){var c,i;return l&&(c=this.update(l)),i=this.type==="encrypt"?this._finalEncrypt():this._finalDecrypt(),c?c.concat(i):i},s.prototype._pad=function(l,c){if(c===0)return!1;for(;c<l.length;)l[c++]=0;return!0},s.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var l=new Array(this.blockSize);return this._update(this.buffer,0,l,0),l},s.prototype._unpad=function(l){return l},s.prototype._finalDecrypt=function(){o.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var l=new Array(this.blockSize);return this._flushBuffer(l,0),this._unpad(l)}},{"minimalistic-assert":453}],397:[function(e,n,a){var o=e("minimalistic-assert"),s=e("inherits"),l=e("./utils"),c=e("./cipher");function i(){this.tmp=new Array(2),this.keys=null}function u(f){c.call(this,f);var h=new i;this._desState=h,this.deriveKeys(h,f.key)}s(u,c),n.exports=u,u.create=function(f){return new u(f)};var p=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];u.prototype.deriveKeys=function(f,h){f.keys=new Array(32),o.equal(h.length,this.blockSize,"Invalid key length");var v=l.readUInt32BE(h,0),b=l.readUInt32BE(h,4);l.pc1(v,b,f.tmp,0),v=f.tmp[0],b=f.tmp[1];for(var g=0;g<f.keys.length;g+=2){var x=p[g>>>1];v=l.r28shl(v,x),b=l.r28shl(b,x),l.pc2(v,b,f.keys,g)}},u.prototype._update=function(f,h,v,b){var g=this._desState,x=l.readUInt32BE(f,h),y=l.readUInt32BE(f,h+4);l.ip(x,y,g.tmp,0),x=g.tmp[0],y=g.tmp[1],this.type==="encrypt"?this._encrypt(g,x,y,g.tmp,0):this._decrypt(g,x,y,g.tmp,0),x=g.tmp[0],y=g.tmp[1],l.writeUInt32BE(v,x,b),l.writeUInt32BE(v,y,b+4)},u.prototype._pad=function(f,h){if(this.padding===!1)return!1;for(var v=f.length-h,b=h;b<f.length;b++)f[b]=v;return!0},u.prototype._unpad=function(f){if(this.padding===!1)return f;for(var h=f[f.length-1],v=f.length-h;v<f.length;v++)o.equal(f[v],h);return f.slice(0,f.length-h)},u.prototype._encrypt=function(f,h,v,b,g){for(var x=h,y=v,k=0;k<f.keys.length;k+=2){var N=f.keys[k],F=f.keys[k+1];l.expand(y,f.tmp,0),N^=f.tmp[0],F^=f.tmp[1];var B=l.substitute(N,F),W=y;y=(x^l.permute(B))>>>0,x=W}l.rip(y,x,b,g)},u.prototype._decrypt=function(f,h,v,b,g){for(var x=v,y=h,k=f.keys.length-2;k>=0;k-=2){var N=f.keys[k],F=f.keys[k+1];l.expand(x,f.tmp,0),N^=f.tmp[0],F^=f.tmp[1];var B=l.substitute(N,F),W=x;x=(y^l.permute(B))>>>0,y=W}l.rip(x,y,b,g)}},{"./cipher":396,"./utils":399,inherits:440,"minimalistic-assert":453}],398:[function(e,n,a){var o=e("minimalistic-assert"),s=e("inherits"),l=e("./cipher"),c=e("./des");function i(p,f){o.equal(f.length,24,"Invalid key length");var h=f.slice(0,8),v=f.slice(8,16),b=f.slice(16,24);this.ciphers=p==="encrypt"?[c.create({type:"encrypt",key:h}),c.create({type:"decrypt",key:v}),c.create({type:"encrypt",key:b})]:[c.create({type:"decrypt",key:b}),c.create({type:"encrypt",key:v}),c.create({type:"decrypt",key:h})]}function u(p){l.call(this,p);var f=new i(this.type,this.options.key);this._edeState=f}s(u,l),n.exports=u,u.create=function(p){return new u(p)},u.prototype._update=function(p,f,h,v){var b=this._edeState;b.ciphers[0]._update(p,f,h,v),b.ciphers[1]._update(h,v,h,v),b.ciphers[2]._update(h,v,h,v)},u.prototype._pad=c.prototype._pad,u.prototype._unpad=c.prototype._unpad},{"./cipher":396,"./des":397,inherits:440,"minimalistic-assert":453}],399:[function(e,n,a){a.readUInt32BE=function(c,i){return(c[0+i]<<24|c[1+i]<<16|c[2+i]<<8|c[3+i])>>>0},a.writeUInt32BE=function(c,i,u){c[0+u]=i>>>24,c[1+u]=i>>>16&255,c[2+u]=i>>>8&255,c[3+u]=255&i},a.ip=function(c,i,u,p){for(var f=0,h=0,v=6;v>=0;v-=2){for(var b=0;b<=24;b+=8)f<<=1,f|=i>>>b+v&1;for(b=0;b<=24;b+=8)f<<=1,f|=c>>>b+v&1}for(v=6;v>=0;v-=2){for(b=1;b<=25;b+=8)h<<=1,h|=i>>>b+v&1;for(b=1;b<=25;b+=8)h<<=1,h|=c>>>b+v&1}u[p+0]=f>>>0,u[p+1]=h>>>0},a.rip=function(c,i,u,p){for(var f=0,h=0,v=0;v<4;v++)for(var b=24;b>=0;b-=8)f<<=1,f|=i>>>b+v&1,f<<=1,f|=c>>>b+v&1;for(v=4;v<8;v++)for(b=24;b>=0;b-=8)h<<=1,h|=i>>>b+v&1,h<<=1,h|=c>>>b+v&1;u[p+0]=f>>>0,u[p+1]=h>>>0},a.pc1=function(c,i,u,p){for(var f=0,h=0,v=7;v>=5;v--){for(var b=0;b<=24;b+=8)f<<=1,f|=i>>b+v&1;for(b=0;b<=24;b+=8)f<<=1,f|=c>>b+v&1}for(b=0;b<=24;b+=8)f<<=1,f|=i>>b+v&1;for(v=1;v<=3;v++){for(b=0;b<=24;b+=8)h<<=1,h|=i>>b+v&1;for(b=0;b<=24;b+=8)h<<=1,h|=c>>b+v&1}for(b=0;b<=24;b+=8)h<<=1,h|=c>>b+v&1;u[p+0]=f>>>0,u[p+1]=h>>>0},a.r28shl=function(c,i){return c<<i&268435455|c>>>28-i};var o=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];a.pc2=function(c,i,u,p){for(var f=0,h=0,v=o.length>>>1,b=0;b<v;b++)f<<=1,f|=c>>>o[b]&1;for(b=v;b<o.length;b++)h<<=1,h|=i>>>o[b]&1;u[p+0]=f>>>0,u[p+1]=h>>>0},a.expand=function(c,i,u){var p=0,f=0;p=(1&c)<<5|c>>>27;for(var h=23;h>=15;h-=4)p<<=6,p|=c>>>h&63;for(h=11;h>=3;h-=4)f|=c>>>h&63,f<<=6;f|=(31&c)<<1|c>>>31,i[u+0]=p>>>0,i[u+1]=f>>>0};var s=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];a.substitute=function(c,i){for(var u=0,p=0;p<4;p++)u<<=4,u|=s[64*p+(c>>>18-6*p&63)];for(p=0;p<4;p++)u<<=4,u|=s[256+64*p+(i>>>18-6*p&63)];return u>>>0};var l=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];a.permute=function(c){for(var i=0,u=0;u<l.length;u++)i<<=1,i|=c>>>l[u]&1;return i>>>0},a.padSplit=function(c,i,u){for(var p=c.toString(2);p.length<i;)p="0"+p;for(var f=[],h=0;h<i;h+=u)f.push(p.slice(h,h+u));return f.join(" ")}},{}],400:[function(e,n,a){(function(o){(function(){var s=e("./lib/generatePrime"),l=e("./lib/primes.json"),c=e("./lib/dh"),i={binary:!0,hex:!0,base64:!0};a.DiffieHellmanGroup=a.createDiffieHellmanGroup=a.getDiffieHellman=function(u){var p=new o(l[u].prime,"hex"),f=new o(l[u].gen,"hex");return new c(p,f)},a.createDiffieHellman=a.DiffieHellman=function u(p,f,h,v){return o.isBuffer(f)||i[f]===void 0?u(p,"binary",f,h):(f=f||"binary",v=v||"binary",h=h||new o([2]),o.isBuffer(h)||(h=new o(h,v)),typeof p=="number"?new c(s(p,h),h,!0):(o.isBuffer(p)||(p=new o(p,f)),new c(p,h,!0)))}}).call(this)}).call(this,e("buffer").Buffer)},{"./lib/dh":401,"./lib/generatePrime":402,"./lib/primes.json":403,buffer:220}],401:[function(e,n,a){(function(o){(function(){var s=e("bn.js"),l=new(e("miller-rabin")),c=new s(24),i=new s(11),u=new s(10),p=new s(3),f=new s(7),h=e("./generatePrime"),v=e("randombytes");function b(N,F){return F=F||"utf8",o.isBuffer(N)||(N=new o(N,F)),this._pub=new s(N),this}function g(N,F){return F=F||"utf8",o.isBuffer(N)||(N=new o(N,F)),this._priv=new s(N),this}n.exports=y;var x={};function y(N,F,B){this.setGenerator(F),this.__prime=new s(N),this._prime=s.mont(this.__prime),this._primeLen=N.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,B?(this.setPublicKey=b,this.setPrivateKey=g):this._primeCode=8}function k(N,F){var B=new o(N.toArray());return F?B.toString(F):B}Object.defineProperty(y.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=function(N,F){var B=F.toString("hex"),W=[B,N.toString(16)].join("_");if(W in x)return x[W];var V,q=0;if(N.isEven()||!h.simpleSieve||!h.fermatTest(N)||!l.test(N))return q+=1,q+=B==="02"||B==="05"?8:4,x[W]=q,q;switch(l.test(N.shrn(1))||(q+=2),B){case"02":N.mod(c).cmp(i)&&(q+=8);break;case"05":(V=N.mod(u)).cmp(p)&&V.cmp(f)&&(q+=8);break;default:q+=4}return x[W]=q,q}(this.__prime,this.__gen)),this._primeCode}}),y.prototype.generateKeys=function(){return this._priv||(this._priv=new s(v(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},y.prototype.computeSecret=function(N){var F=(N=(N=new s(N)).toRed(this._prime)).redPow(this._priv).fromRed(),B=new o(F.toArray()),W=this.getPrime();if(B.length<W.length){var V=new o(W.length-B.length);V.fill(0),B=o.concat([V,B])}return B},y.prototype.getPublicKey=function(N){return k(this._pub,N)},y.prototype.getPrivateKey=function(N){return k(this._priv,N)},y.prototype.getPrime=function(N){return k(this.__prime,N)},y.prototype.getGenerator=function(N){return k(this._gen,N)},y.prototype.setGenerator=function(N,F){return F=F||"utf8",o.isBuffer(N)||(N=new o(N,F)),this.__gen=N,this._gen=new s(N),this}}).call(this)}).call(this,e("buffer").Buffer)},{"./generatePrime":402,"bn.js":404,buffer:220,"miller-rabin":451,randombytes:475}],402:[function(e,n,a){var o=e("randombytes");n.exports=N,N.simpleSieve=y,N.fermatTest=k;var s=e("bn.js"),l=new s(24),c=new(e("miller-rabin")),i=new s(1),u=new s(2),p=new s(5),f=(new s(16),new s(8),new s(10)),h=new s(3),v=(new s(7),new s(11)),b=new s(4),g=(new s(12),null);function x(){if(g!==null)return g;var F=[];F[0]=2;for(var B=1,W=3;W<1048576;W+=2){for(var V=Math.ceil(Math.sqrt(W)),q=0;q<B&&F[q]<=V&&W%F[q]!=0;q++);B!==q&&F[q]<=V||(F[B++]=W)}return g=F,F}function y(F){for(var B=x(),W=0;W<B.length;W++)if(F.modn(B[W])===0)return F.cmpn(B[W])===0;return!0}function k(F){var B=s.mont(F);return u.toRed(B).redPow(F.subn(1)).fromRed().cmpn(1)===0}function N(F,B){if(F<16)return new s(B===2||B===5?[140,123]:[140,39]);var W,V;for(B=new s(B);;){for(W=new s(o(Math.ceil(F/8)));W.bitLength()>F;)W.ishrn(1);if(W.isEven()&&W.iadd(i),W.testn(1)||W.iadd(u),B.cmp(u)){if(!B.cmp(p))for(;W.mod(f).cmp(h);)W.iadd(b)}else for(;W.mod(l).cmp(v);)W.iadd(b);if(y(V=W.shrn(1))&&y(W)&&k(V)&&k(W)&&c.test(V)&&c.test(W))return W}}},{"bn.js":404,"miller-rabin":451,randombytes:475}],403:[function(e,n,a){n.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],404:[function(e,n,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],405:[function(e,n,a){var o=a;o.version=e("../package.json").version,o.utils=e("./elliptic/utils"),o.rand=e("brorand"),o.curve=e("./elliptic/curve"),o.curves=e("./elliptic/curves"),o.ec=e("./elliptic/ec"),o.eddsa=e("./elliptic/eddsa")},{"../package.json":421,"./elliptic/curve":408,"./elliptic/curves":411,"./elliptic/ec":412,"./elliptic/eddsa":415,"./elliptic/utils":419,brorand:187}],406:[function(e,n,a){var o=e("bn.js"),s=e("../utils"),l=s.getNAF,c=s.getJSF,i=s.assert;function u(f,h){this.type=f,this.p=new o(h.p,16),this.red=h.prime?o.red(h.prime):o.mont(this.p),this.zero=new o(0).toRed(this.red),this.one=new o(1).toRed(this.red),this.two=new o(2).toRed(this.red),this.n=h.n&&new o(h.n,16),this.g=h.g&&this.pointFromJSON(h.g,h.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var v=this.n&&this.p.div(this.n);!v||v.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function p(f,h){this.curve=f,this.type=h,this.precomputed=null}n.exports=u,u.prototype.point=function(){throw new Error("Not implemented")},u.prototype.validate=function(){throw new Error("Not implemented")},u.prototype._fixedNafMul=function(f,h){i(f.precomputed);var v=f._getDoubles(),b=l(h,1,this._bitLength),g=(1<<v.step+1)-(v.step%2==0?2:1);g/=3;var x,y,k=[];for(x=0;x<b.length;x+=v.step){y=0;for(var N=x+v.step-1;N>=x;N--)y=(y<<1)+b[N];k.push(y)}for(var F=this.jpoint(null,null,null),B=this.jpoint(null,null,null),W=g;W>0;W--){for(x=0;x<k.length;x++)(y=k[x])===W?B=B.mixedAdd(v.points[x]):y===-W&&(B=B.mixedAdd(v.points[x].neg()));F=F.add(B)}return F.toP()},u.prototype._wnafMul=function(f,h){var v=4,b=f._getNAFPoints(v);v=b.wnd;for(var g=b.points,x=l(h,v,this._bitLength),y=this.jpoint(null,null,null),k=x.length-1;k>=0;k--){for(var N=0;k>=0&&x[k]===0;k--)N++;if(k>=0&&N++,y=y.dblp(N),k<0)break;var F=x[k];i(F!==0),y=f.type==="affine"?F>0?y.mixedAdd(g[F-1>>1]):y.mixedAdd(g[-F-1>>1].neg()):F>0?y.add(g[F-1>>1]):y.add(g[-F-1>>1].neg())}return f.type==="affine"?y.toP():y},u.prototype._wnafMulAdd=function(f,h,v,b,g){var x,y,k,N=this._wnafT1,F=this._wnafT2,B=this._wnafT3,W=0;for(x=0;x<b;x++){var V=(k=h[x])._getNAFPoints(f);N[x]=V.wnd,F[x]=V.points}for(x=b-1;x>=1;x-=2){var q=x-1,X=x;if(N[q]===1&&N[X]===1){var I=[h[q],null,null,h[X]];h[q].y.cmp(h[X].y)===0?(I[1]=h[q].add(h[X]),I[2]=h[q].toJ().mixedAdd(h[X].neg())):h[q].y.cmp(h[X].y.redNeg())===0?(I[1]=h[q].toJ().mixedAdd(h[X]),I[2]=h[q].add(h[X].neg())):(I[1]=h[q].toJ().mixedAdd(h[X]),I[2]=h[q].toJ().mixedAdd(h[X].neg()));var H=[-3,-1,-5,-7,0,7,5,1,3],O=c(v[q],v[X]);for(W=Math.max(O[0].length,W),B[q]=new Array(W),B[X]=new Array(W),y=0;y<W;y++){var R=0|O[0][y],C=0|O[1][y];B[q][y]=H[3*(R+1)+(C+1)],B[X][y]=0,F[q]=I}}else B[q]=l(v[q],N[q],this._bitLength),B[X]=l(v[X],N[X],this._bitLength),W=Math.max(B[q].length,W),W=Math.max(B[X].length,W)}var w=this.jpoint(null,null,null),E=this._wnafT4;for(x=W;x>=0;x--){for(var A=0;x>=0;){var T=!0;for(y=0;y<b;y++)E[y]=0|B[y][x],E[y]!==0&&(T=!1);if(!T)break;A++,x--}if(x>=0&&A++,w=w.dblp(A),x<0)break;for(y=0;y<b;y++){var D=E[y];D!==0&&(D>0?k=F[y][D-1>>1]:D<0&&(k=F[y][-D-1>>1].neg()),w=k.type==="affine"?w.mixedAdd(k):w.add(k))}}for(x=0;x<b;x++)F[x]=null;return g?w:w.toP()},u.BasePoint=p,p.prototype.eq=function(){throw new Error("Not implemented")},p.prototype.validate=function(){return this.curve.validate(this)},u.prototype.decodePoint=function(f,h){f=s.toArray(f,h);var v=this.p.byteLength();if((f[0]===4||f[0]===6||f[0]===7)&&f.length-1==2*v)return f[0]===6?i(f[f.length-1]%2==0):f[0]===7&&i(f[f.length-1]%2==1),this.point(f.slice(1,1+v),f.slice(1+v,1+2*v));if((f[0]===2||f[0]===3)&&f.length-1===v)return this.pointFromX(f.slice(1,1+v),f[0]===3);throw new Error("Unknown point format")},p.prototype.encodeCompressed=function(f){return this.encode(f,!0)},p.prototype._encode=function(f){var h=this.curve.p.byteLength(),v=this.getX().toArray("be",h);return f?[this.getY().isEven()?2:3].concat(v):[4].concat(v,this.getY().toArray("be",h))},p.prototype.encode=function(f,h){return s.encode(this._encode(h),f)},p.prototype.precompute=function(f){if(this.precomputed)return this;var h={doubles:null,naf:null,beta:null};return h.naf=this._getNAFPoints(8),h.doubles=this._getDoubles(4,f),h.beta=this._getBeta(),this.precomputed=h,this},p.prototype._hasDoubles=function(f){if(!this.precomputed)return!1;var h=this.precomputed.doubles;return!!h&&h.points.length>=Math.ceil((f.bitLength()+1)/h.step)},p.prototype._getDoubles=function(f,h){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var v=[this],b=this,g=0;g<h;g+=f){for(var x=0;x<f;x++)b=b.dbl();v.push(b)}return{step:f,points:v}},p.prototype._getNAFPoints=function(f){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var h=[this],v=(1<<f)-1,b=v===1?null:this.dbl(),g=1;g<v;g++)h[g]=h[g-1].add(b);return{wnd:f,points:h}},p.prototype._getBeta=function(){return null},p.prototype.dblp=function(f){for(var h=this,v=0;v<f;v++)h=h.dbl();return h}},{"../utils":419,"bn.js":420}],407:[function(e,n,a){var o=e("../utils"),s=e("bn.js"),l=e("inherits"),c=e("./base"),i=o.assert;function u(f){this.twisted=(0|f.a)!=1,this.mOneA=this.twisted&&(0|f.a)==-1,this.extended=this.mOneA,c.call(this,"edwards",f),this.a=new s(f.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new s(f.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new s(f.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),i(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(0|f.c)==1}function p(f,h,v,b,g){c.BasePoint.call(this,f,"projective"),h===null&&v===null&&b===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new s(h,16),this.y=new s(v,16),this.z=b?new s(b,16):this.curve.one,this.t=g&&new s(g,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}l(u,c),n.exports=u,u.prototype._mulA=function(f){return this.mOneA?f.redNeg():this.a.redMul(f)},u.prototype._mulC=function(f){return this.oneC?f:this.c.redMul(f)},u.prototype.jpoint=function(f,h,v,b){return this.point(f,h,v,b)},u.prototype.pointFromX=function(f,h){(f=new s(f,16)).red||(f=f.toRed(this.red));var v=f.redSqr(),b=this.c2.redSub(this.a.redMul(v)),g=this.one.redSub(this.c2.redMul(this.d).redMul(v)),x=b.redMul(g.redInvm()),y=x.redSqrt();if(y.redSqr().redSub(x).cmp(this.zero)!==0)throw new Error("invalid point");var k=y.fromRed().isOdd();return(h&&!k||!h&&k)&&(y=y.redNeg()),this.point(f,y)},u.prototype.pointFromY=function(f,h){(f=new s(f,16)).red||(f=f.toRed(this.red));var v=f.redSqr(),b=v.redSub(this.c2),g=v.redMul(this.d).redMul(this.c2).redSub(this.a),x=b.redMul(g.redInvm());if(x.cmp(this.zero)===0){if(h)throw new Error("invalid point");return this.point(this.zero,f)}var y=x.redSqrt();if(y.redSqr().redSub(x).cmp(this.zero)!==0)throw new Error("invalid point");return y.fromRed().isOdd()!==h&&(y=y.redNeg()),this.point(y,f)},u.prototype.validate=function(f){if(f.isInfinity())return!0;f.normalize();var h=f.x.redSqr(),v=f.y.redSqr(),b=h.redMul(this.a).redAdd(v),g=this.c2.redMul(this.one.redAdd(this.d.redMul(h).redMul(v)));return b.cmp(g)===0},l(p,c.BasePoint),u.prototype.pointFromJSON=function(f){return p.fromJSON(this,f)},u.prototype.point=function(f,h,v,b){return new p(this,f,h,v,b)},p.fromJSON=function(f,h){return new p(f,h[0],h[1],h[2])},p.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},p.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},p.prototype._extDbl=function(){var f=this.x.redSqr(),h=this.y.redSqr(),v=this.z.redSqr();v=v.redIAdd(v);var b=this.curve._mulA(f),g=this.x.redAdd(this.y).redSqr().redISub(f).redISub(h),x=b.redAdd(h),y=x.redSub(v),k=b.redSub(h),N=g.redMul(y),F=x.redMul(k),B=g.redMul(k),W=y.redMul(x);return this.curve.point(N,F,W,B)},p.prototype._projDbl=function(){var f,h,v,b,g,x,y=this.x.redAdd(this.y).redSqr(),k=this.x.redSqr(),N=this.y.redSqr();if(this.curve.twisted){var F=(b=this.curve._mulA(k)).redAdd(N);this.zOne?(f=y.redSub(k).redSub(N).redMul(F.redSub(this.curve.two)),h=F.redMul(b.redSub(N)),v=F.redSqr().redSub(F).redSub(F)):(g=this.z.redSqr(),x=F.redSub(g).redISub(g),f=y.redSub(k).redISub(N).redMul(x),h=F.redMul(b.redSub(N)),v=F.redMul(x))}else b=k.redAdd(N),g=this.curve._mulC(this.z).redSqr(),x=b.redSub(g).redSub(g),f=this.curve._mulC(y.redISub(b)).redMul(x),h=this.curve._mulC(b).redMul(k.redISub(N)),v=b.redMul(x);return this.curve.point(f,h,v)},p.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},p.prototype._extAdd=function(f){var h=this.y.redSub(this.x).redMul(f.y.redSub(f.x)),v=this.y.redAdd(this.x).redMul(f.y.redAdd(f.x)),b=this.t.redMul(this.curve.dd).redMul(f.t),g=this.z.redMul(f.z.redAdd(f.z)),x=v.redSub(h),y=g.redSub(b),k=g.redAdd(b),N=v.redAdd(h),F=x.redMul(y),B=k.redMul(N),W=x.redMul(N),V=y.redMul(k);return this.curve.point(F,B,V,W)},p.prototype._projAdd=function(f){var h,v,b=this.z.redMul(f.z),g=b.redSqr(),x=this.x.redMul(f.x),y=this.y.redMul(f.y),k=this.curve.d.redMul(x).redMul(y),N=g.redSub(k),F=g.redAdd(k),B=this.x.redAdd(this.y).redMul(f.x.redAdd(f.y)).redISub(x).redISub(y),W=b.redMul(N).redMul(B);return this.curve.twisted?(h=b.redMul(F).redMul(y.redSub(this.curve._mulA(x))),v=N.redMul(F)):(h=b.redMul(F).redMul(y.redSub(x)),v=this.curve._mulC(N).redMul(F)),this.curve.point(W,h,v)},p.prototype.add=function(f){return this.isInfinity()?f:f.isInfinity()?this:this.curve.extended?this._extAdd(f):this._projAdd(f)},p.prototype.mul=function(f){return this._hasDoubles(f)?this.curve._fixedNafMul(this,f):this.curve._wnafMul(this,f)},p.prototype.mulAdd=function(f,h,v){return this.curve._wnafMulAdd(1,[this,h],[f,v],2,!1)},p.prototype.jmulAdd=function(f,h,v){return this.curve._wnafMulAdd(1,[this,h],[f,v],2,!0)},p.prototype.normalize=function(){if(this.zOne)return this;var f=this.z.redInvm();return this.x=this.x.redMul(f),this.y=this.y.redMul(f),this.t&&(this.t=this.t.redMul(f)),this.z=this.curve.one,this.zOne=!0,this},p.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},p.prototype.getX=function(){return this.normalize(),this.x.fromRed()},p.prototype.getY=function(){return this.normalize(),this.y.fromRed()},p.prototype.eq=function(f){return this===f||this.getX().cmp(f.getX())===0&&this.getY().cmp(f.getY())===0},p.prototype.eqXToP=function(f){var h=f.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(h)===0)return!0;for(var v=f.clone(),b=this.curve.redN.redMul(this.z);;){if(v.iadd(this.curve.n),v.cmp(this.curve.p)>=0)return!1;if(h.redIAdd(b),this.x.cmp(h)===0)return!0}},p.prototype.toP=p.prototype.normalize,p.prototype.mixedAdd=p.prototype.add},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],408:[function(e,n,a){var o=a;o.base=e("./base"),o.short=e("./short"),o.mont=e("./mont"),o.edwards=e("./edwards")},{"./base":406,"./edwards":407,"./mont":409,"./short":410}],409:[function(e,n,a){var o=e("bn.js"),s=e("inherits"),l=e("./base"),c=e("../utils");function i(p){l.call(this,"mont",p),this.a=new o(p.a,16).toRed(this.red),this.b=new o(p.b,16).toRed(this.red),this.i4=new o(4).toRed(this.red).redInvm(),this.two=new o(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function u(p,f,h){l.BasePoint.call(this,p,"projective"),f===null&&h===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new o(f,16),this.z=new o(h,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}s(i,l),n.exports=i,i.prototype.validate=function(p){var f=p.normalize().x,h=f.redSqr(),v=h.redMul(f).redAdd(h.redMul(this.a)).redAdd(f);return v.redSqrt().redSqr().cmp(v)===0},s(u,l.BasePoint),i.prototype.decodePoint=function(p,f){return this.point(c.toArray(p,f),1)},i.prototype.point=function(p,f){return new u(this,p,f)},i.prototype.pointFromJSON=function(p){return u.fromJSON(this,p)},u.prototype.precompute=function(){},u.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},u.fromJSON=function(p,f){return new u(p,f[0],f[1]||p.one)},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return this.z.cmpn(0)===0},u.prototype.dbl=function(){var p=this.x.redAdd(this.z).redSqr(),f=this.x.redSub(this.z).redSqr(),h=p.redSub(f),v=p.redMul(f),b=h.redMul(f.redAdd(this.curve.a24.redMul(h)));return this.curve.point(v,b)},u.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.diffAdd=function(p,f){var h=this.x.redAdd(this.z),v=this.x.redSub(this.z),b=p.x.redAdd(p.z),g=p.x.redSub(p.z).redMul(h),x=b.redMul(v),y=f.z.redMul(g.redAdd(x).redSqr()),k=f.x.redMul(g.redISub(x).redSqr());return this.curve.point(y,k)},u.prototype.mul=function(p){for(var f=p.clone(),h=this,v=this.curve.point(null,null),b=[];f.cmpn(0)!==0;f.iushrn(1))b.push(f.andln(1));for(var g=b.length-1;g>=0;g--)b[g]===0?(h=h.diffAdd(v,this),v=v.dbl()):(v=h.diffAdd(v,this),h=h.dbl());return v},u.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.eq=function(p){return this.getX().cmp(p.getX())===0},u.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},u.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],410:[function(e,n,a){var o=e("../utils"),s=e("bn.js"),l=e("inherits"),c=e("./base"),i=o.assert;function u(h){c.call(this,"short",h),this.a=new s(h.a,16).toRed(this.red),this.b=new s(h.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(h),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function p(h,v,b,g){c.BasePoint.call(this,h,"affine"),v===null&&b===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new s(v,16),this.y=new s(b,16),g&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function f(h,v,b,g){c.BasePoint.call(this,h,"jacobian"),v===null&&b===null&&g===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new s(0)):(this.x=new s(v,16),this.y=new s(b,16),this.z=new s(g,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}l(u,c),n.exports=u,u.prototype._getEndomorphism=function(h){if(this.zeroA&&this.g&&this.n&&this.p.modn(3)===1){var v,b;if(h.beta)v=new s(h.beta,16).toRed(this.red);else{var g=this._getEndoRoots(this.p);v=(v=g[0].cmp(g[1])<0?g[0]:g[1]).toRed(this.red)}if(h.lambda)b=new s(h.lambda,16);else{var x=this._getEndoRoots(this.n);this.g.mul(x[0]).x.cmp(this.g.x.redMul(v))===0?b=x[0]:(b=x[1],i(this.g.mul(b).x.cmp(this.g.x.redMul(v))===0))}return{beta:v,lambda:b,basis:h.basis?h.basis.map(function(y){return{a:new s(y.a,16),b:new s(y.b,16)}}):this._getEndoBasis(b)}}},u.prototype._getEndoRoots=function(h){var v=h===this.p?this.red:s.mont(h),b=new s(2).toRed(v).redInvm(),g=b.redNeg(),x=new s(3).toRed(v).redNeg().redSqrt().redMul(b);return[g.redAdd(x).fromRed(),g.redSub(x).fromRed()]},u.prototype._getEndoBasis=function(h){for(var v,b,g,x,y,k,N,F,B,W=this.n.ushrn(Math.floor(this.n.bitLength()/2)),V=h,q=this.n.clone(),X=new s(1),I=new s(0),H=new s(0),O=new s(1),R=0;V.cmpn(0)!==0;){var C=q.div(V);F=q.sub(C.mul(V)),B=H.sub(C.mul(X));var w=O.sub(C.mul(I));if(!g&&F.cmp(W)<0)v=N.neg(),b=X,g=F.neg(),x=B;else if(g&&++R==2)break;N=F,q=V,V=F,H=X,X=B,O=I,I=w}y=F.neg(),k=B;var E=g.sqr().add(x.sqr());return y.sqr().add(k.sqr()).cmp(E)>=0&&(y=v,k=b),g.negative&&(g=g.neg(),x=x.neg()),y.negative&&(y=y.neg(),k=k.neg()),[{a:g,b:x},{a:y,b:k}]},u.prototype._endoSplit=function(h){var v=this.endo.basis,b=v[0],g=v[1],x=g.b.mul(h).divRound(this.n),y=b.b.neg().mul(h).divRound(this.n),k=x.mul(b.a),N=y.mul(g.a),F=x.mul(b.b),B=y.mul(g.b);return{k1:h.sub(k).sub(N),k2:F.add(B).neg()}},u.prototype.pointFromX=function(h,v){(h=new s(h,16)).red||(h=h.toRed(this.red));var b=h.redSqr().redMul(h).redIAdd(h.redMul(this.a)).redIAdd(this.b),g=b.redSqrt();if(g.redSqr().redSub(b).cmp(this.zero)!==0)throw new Error("invalid point");var x=g.fromRed().isOdd();return(v&&!x||!v&&x)&&(g=g.redNeg()),this.point(h,g)},u.prototype.validate=function(h){if(h.inf)return!0;var v=h.x,b=h.y,g=this.a.redMul(v),x=v.redSqr().redMul(v).redIAdd(g).redIAdd(this.b);return b.redSqr().redISub(x).cmpn(0)===0},u.prototype._endoWnafMulAdd=function(h,v,b){for(var g=this._endoWnafT1,x=this._endoWnafT2,y=0;y<h.length;y++){var k=this._endoSplit(v[y]),N=h[y],F=N._getBeta();k.k1.negative&&(k.k1.ineg(),N=N.neg(!0)),k.k2.negative&&(k.k2.ineg(),F=F.neg(!0)),g[2*y]=N,g[2*y+1]=F,x[2*y]=k.k1,x[2*y+1]=k.k2}for(var B=this._wnafMulAdd(1,g,x,2*y,b),W=0;W<2*y;W++)g[W]=null,x[W]=null;return B},l(p,c.BasePoint),u.prototype.point=function(h,v,b){return new p(this,h,v,b)},u.prototype.pointFromJSON=function(h,v){return p.fromJSON(this,h,v)},p.prototype._getBeta=function(){if(this.curve.endo){var h=this.precomputed;if(h&&h.beta)return h.beta;var v=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(h){var b=this.curve,g=function(x){return b.point(x.x.redMul(b.endo.beta),x.y)};h.beta=v,v.precomputed={beta:null,naf:h.naf&&{wnd:h.naf.wnd,points:h.naf.points.map(g)},doubles:h.doubles&&{step:h.doubles.step,points:h.doubles.points.map(g)}}}return v}},p.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},p.fromJSON=function(h,v,b){typeof v=="string"&&(v=JSON.parse(v));var g=h.point(v[0],v[1],b);if(!v[2])return g;function x(k){return h.point(k[0],k[1],b)}var y=v[2];return g.precomputed={beta:null,doubles:y.doubles&&{step:y.doubles.step,points:[g].concat(y.doubles.points.map(x))},naf:y.naf&&{wnd:y.naf.wnd,points:[g].concat(y.naf.points.map(x))}},g},p.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},p.prototype.isInfinity=function(){return this.inf},p.prototype.add=function(h){if(this.inf)return h;if(h.inf)return this;if(this.eq(h))return this.dbl();if(this.neg().eq(h))return this.curve.point(null,null);if(this.x.cmp(h.x)===0)return this.curve.point(null,null);var v=this.y.redSub(h.y);v.cmpn(0)!==0&&(v=v.redMul(this.x.redSub(h.x).redInvm()));var b=v.redSqr().redISub(this.x).redISub(h.x),g=v.redMul(this.x.redSub(b)).redISub(this.y);return this.curve.point(b,g)},p.prototype.dbl=function(){if(this.inf)return this;var h=this.y.redAdd(this.y);if(h.cmpn(0)===0)return this.curve.point(null,null);var v=this.curve.a,b=this.x.redSqr(),g=h.redInvm(),x=b.redAdd(b).redIAdd(b).redIAdd(v).redMul(g),y=x.redSqr().redISub(this.x.redAdd(this.x)),k=x.redMul(this.x.redSub(y)).redISub(this.y);return this.curve.point(y,k)},p.prototype.getX=function(){return this.x.fromRed()},p.prototype.getY=function(){return this.y.fromRed()},p.prototype.mul=function(h){return h=new s(h,16),this.isInfinity()?this:this._hasDoubles(h)?this.curve._fixedNafMul(this,h):this.curve.endo?this.curve._endoWnafMulAdd([this],[h]):this.curve._wnafMul(this,h)},p.prototype.mulAdd=function(h,v,b){var g=[this,v],x=[h,b];return this.curve.endo?this.curve._endoWnafMulAdd(g,x):this.curve._wnafMulAdd(1,g,x,2)},p.prototype.jmulAdd=function(h,v,b){var g=[this,v],x=[h,b];return this.curve.endo?this.curve._endoWnafMulAdd(g,x,!0):this.curve._wnafMulAdd(1,g,x,2,!0)},p.prototype.eq=function(h){return this===h||this.inf===h.inf&&(this.inf||this.x.cmp(h.x)===0&&this.y.cmp(h.y)===0)},p.prototype.neg=function(h){if(this.inf)return this;var v=this.curve.point(this.x,this.y.redNeg());if(h&&this.precomputed){var b=this.precomputed,g=function(x){return x.neg()};v.precomputed={naf:b.naf&&{wnd:b.naf.wnd,points:b.naf.points.map(g)},doubles:b.doubles&&{step:b.doubles.step,points:b.doubles.points.map(g)}}}return v},p.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},l(f,c.BasePoint),u.prototype.jpoint=function(h,v,b){return new f(this,h,v,b)},f.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var h=this.z.redInvm(),v=h.redSqr(),b=this.x.redMul(v),g=this.y.redMul(v).redMul(h);return this.curve.point(b,g)},f.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},f.prototype.add=function(h){if(this.isInfinity())return h;if(h.isInfinity())return this;var v=h.z.redSqr(),b=this.z.redSqr(),g=this.x.redMul(v),x=h.x.redMul(b),y=this.y.redMul(v.redMul(h.z)),k=h.y.redMul(b.redMul(this.z)),N=g.redSub(x),F=y.redSub(k);if(N.cmpn(0)===0)return F.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var B=N.redSqr(),W=B.redMul(N),V=g.redMul(B),q=F.redSqr().redIAdd(W).redISub(V).redISub(V),X=F.redMul(V.redISub(q)).redISub(y.redMul(W)),I=this.z.redMul(h.z).redMul(N);return this.curve.jpoint(q,X,I)},f.prototype.mixedAdd=function(h){if(this.isInfinity())return h.toJ();if(h.isInfinity())return this;var v=this.z.redSqr(),b=this.x,g=h.x.redMul(v),x=this.y,y=h.y.redMul(v).redMul(this.z),k=b.redSub(g),N=x.redSub(y);if(k.cmpn(0)===0)return N.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var F=k.redSqr(),B=F.redMul(k),W=b.redMul(F),V=N.redSqr().redIAdd(B).redISub(W).redISub(W),q=N.redMul(W.redISub(V)).redISub(x.redMul(B)),X=this.z.redMul(k);return this.curve.jpoint(V,q,X)},f.prototype.dblp=function(h){if(h===0)return this;if(this.isInfinity())return this;if(!h)return this.dbl();var v;if(this.curve.zeroA||this.curve.threeA){var b=this;for(v=0;v<h;v++)b=b.dbl();return b}var g=this.curve.a,x=this.curve.tinv,y=this.x,k=this.y,N=this.z,F=N.redSqr().redSqr(),B=k.redAdd(k);for(v=0;v<h;v++){var W=y.redSqr(),V=B.redSqr(),q=V.redSqr(),X=W.redAdd(W).redIAdd(W).redIAdd(g.redMul(F)),I=y.redMul(V),H=X.redSqr().redISub(I.redAdd(I)),O=I.redISub(H),R=X.redMul(O);R=R.redIAdd(R).redISub(q);var C=B.redMul(N);v+1<h&&(F=F.redMul(q)),y=H,N=C,B=R}return this.curve.jpoint(y,B.redMul(x),N)},f.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},f.prototype._zeroDbl=function(){var h,v,b;if(this.zOne){var g=this.x.redSqr(),x=this.y.redSqr(),y=x.redSqr(),k=this.x.redAdd(x).redSqr().redISub(g).redISub(y);k=k.redIAdd(k);var N=g.redAdd(g).redIAdd(g),F=N.redSqr().redISub(k).redISub(k),B=y.redIAdd(y);B=(B=B.redIAdd(B)).redIAdd(B),h=F,v=N.redMul(k.redISub(F)).redISub(B),b=this.y.redAdd(this.y)}else{var W=this.x.redSqr(),V=this.y.redSqr(),q=V.redSqr(),X=this.x.redAdd(V).redSqr().redISub(W).redISub(q);X=X.redIAdd(X);var I=W.redAdd(W).redIAdd(W),H=I.redSqr(),O=q.redIAdd(q);O=(O=O.redIAdd(O)).redIAdd(O),h=H.redISub(X).redISub(X),v=I.redMul(X.redISub(h)).redISub(O),b=(b=this.y.redMul(this.z)).redIAdd(b)}return this.curve.jpoint(h,v,b)},f.prototype._threeDbl=function(){var h,v,b;if(this.zOne){var g=this.x.redSqr(),x=this.y.redSqr(),y=x.redSqr(),k=this.x.redAdd(x).redSqr().redISub(g).redISub(y);k=k.redIAdd(k);var N=g.redAdd(g).redIAdd(g).redIAdd(this.curve.a),F=N.redSqr().redISub(k).redISub(k);h=F;var B=y.redIAdd(y);B=(B=B.redIAdd(B)).redIAdd(B),v=N.redMul(k.redISub(F)).redISub(B),b=this.y.redAdd(this.y)}else{var W=this.z.redSqr(),V=this.y.redSqr(),q=this.x.redMul(V),X=this.x.redSub(W).redMul(this.x.redAdd(W));X=X.redAdd(X).redIAdd(X);var I=q.redIAdd(q),H=(I=I.redIAdd(I)).redAdd(I);h=X.redSqr().redISub(H),b=this.y.redAdd(this.z).redSqr().redISub(V).redISub(W);var O=V.redSqr();O=(O=(O=O.redIAdd(O)).redIAdd(O)).redIAdd(O),v=X.redMul(I.redISub(h)).redISub(O)}return this.curve.jpoint(h,v,b)},f.prototype._dbl=function(){var h=this.curve.a,v=this.x,b=this.y,g=this.z,x=g.redSqr().redSqr(),y=v.redSqr(),k=b.redSqr(),N=y.redAdd(y).redIAdd(y).redIAdd(h.redMul(x)),F=v.redAdd(v),B=(F=F.redIAdd(F)).redMul(k),W=N.redSqr().redISub(B.redAdd(B)),V=B.redISub(W),q=k.redSqr();q=(q=(q=q.redIAdd(q)).redIAdd(q)).redIAdd(q);var X=N.redMul(V).redISub(q),I=b.redAdd(b).redMul(g);return this.curve.jpoint(W,X,I)},f.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var h=this.x.redSqr(),v=this.y.redSqr(),b=this.z.redSqr(),g=v.redSqr(),x=h.redAdd(h).redIAdd(h),y=x.redSqr(),k=this.x.redAdd(v).redSqr().redISub(h).redISub(g),N=(k=(k=(k=k.redIAdd(k)).redAdd(k).redIAdd(k)).redISub(y)).redSqr(),F=g.redIAdd(g);F=(F=(F=F.redIAdd(F)).redIAdd(F)).redIAdd(F);var B=x.redIAdd(k).redSqr().redISub(y).redISub(N).redISub(F),W=v.redMul(B);W=(W=W.redIAdd(W)).redIAdd(W);var V=this.x.redMul(N).redISub(W);V=(V=V.redIAdd(V)).redIAdd(V);var q=this.y.redMul(B.redMul(F.redISub(B)).redISub(k.redMul(N)));q=(q=(q=q.redIAdd(q)).redIAdd(q)).redIAdd(q);var X=this.z.redAdd(k).redSqr().redISub(b).redISub(N);return this.curve.jpoint(V,q,X)},f.prototype.mul=function(h,v){return h=new s(h,v),this.curve._wnafMul(this,h)},f.prototype.eq=function(h){if(h.type==="affine")return this.eq(h.toJ());if(this===h)return!0;var v=this.z.redSqr(),b=h.z.redSqr();if(this.x.redMul(b).redISub(h.x.redMul(v)).cmpn(0)!==0)return!1;var g=v.redMul(this.z),x=b.redMul(h.z);return this.y.redMul(x).redISub(h.y.redMul(g)).cmpn(0)===0},f.prototype.eqXToP=function(h){var v=this.z.redSqr(),b=h.toRed(this.curve.red).redMul(v);if(this.x.cmp(b)===0)return!0;for(var g=h.clone(),x=this.curve.redN.redMul(v);;){if(g.iadd(this.curve.n),g.cmp(this.curve.p)>=0)return!1;if(b.redIAdd(x),this.x.cmp(b)===0)return!0}},f.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},f.prototype.isInfinity=function(){return this.z.cmpn(0)===0}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],411:[function(e,n,a){var o,s=a,l=e("hash.js"),c=e("./curve"),i=e("./utils").assert;function u(f){f.type==="short"?this.curve=new c.short(f):f.type==="edwards"?this.curve=new c.edwards(f):this.curve=new c.mont(f),this.g=this.curve.g,this.n=this.curve.n,this.hash=f.hash,i(this.g.validate(),"Invalid curve"),i(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function p(f,h){Object.defineProperty(s,f,{configurable:!0,enumerable:!0,get:function(){var v=new u(h);return Object.defineProperty(s,f,{configurable:!0,enumerable:!0,value:v}),v}})}s.PresetCurve=u,p("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:l.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),p("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:l.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),p("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:l.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),p("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:l.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),p("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:l.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),p("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:l.sha256,gRed:!1,g:["9"]}),p("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:l.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{o=e("./precomputed/secp256k1")}catch{o=void 0}p("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:l.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",o]})},{"./curve":408,"./precomputed/secp256k1":418,"./utils":419,"hash.js":426}],412:[function(e,n,a){var o=e("bn.js"),s=e("hmac-drbg"),l=e("../utils"),c=e("../curves"),i=e("brorand"),u=l.assert,p=e("./key"),f=e("./signature");function h(v){if(!(this instanceof h))return new h(v);typeof v=="string"&&(u(Object.prototype.hasOwnProperty.call(c,v),"Unknown curve "+v),v=c[v]),v instanceof c.PresetCurve&&(v={curve:v}),this.curve=v.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=v.curve.g,this.g.precompute(v.curve.n.bitLength()+1),this.hash=v.hash||v.curve.hash}n.exports=h,h.prototype.keyPair=function(v){return new p(this,v)},h.prototype.keyFromPrivate=function(v,b){return p.fromPrivate(this,v,b)},h.prototype.keyFromPublic=function(v,b){return p.fromPublic(this,v,b)},h.prototype.genKeyPair=function(v){v||(v={});for(var b=new s({hash:this.hash,pers:v.pers,persEnc:v.persEnc||"utf8",entropy:v.entropy||i(this.hash.hmacStrength),entropyEnc:v.entropy&&v.entropyEnc||"utf8",nonce:this.n.toArray()}),g=this.n.byteLength(),x=this.n.sub(new o(2));;){var y=new o(b.generate(g));if(!(y.cmp(x)>0))return y.iaddn(1),this.keyFromPrivate(y)}},h.prototype._truncateToN=function(v,b){var g=8*v.byteLength()-this.n.bitLength();return g>0&&(v=v.ushrn(g)),!b&&v.cmp(this.n)>=0?v.sub(this.n):v},h.prototype.sign=function(v,b,g,x){typeof g=="object"&&(x=g,g=null),x||(x={}),b=this.keyFromPrivate(b,g),v=this._truncateToN(new o(v,16));for(var y=this.n.byteLength(),k=b.getPrivate().toArray("be",y),N=v.toArray("be",y),F=new s({hash:this.hash,entropy:k,nonce:N,pers:x.pers,persEnc:x.persEnc||"utf8"}),B=this.n.sub(new o(1)),W=0;;W++){var V=x.k?x.k(W):new o(F.generate(this.n.byteLength()));if(!((V=this._truncateToN(V,!0)).cmpn(1)<=0||V.cmp(B)>=0)){var q=this.g.mul(V);if(!q.isInfinity()){var X=q.getX(),I=X.umod(this.n);if(I.cmpn(0)!==0){var H=V.invm(this.n).mul(I.mul(b.getPrivate()).iadd(v));if((H=H.umod(this.n)).cmpn(0)!==0){var O=(q.getY().isOdd()?1:0)|(X.cmp(I)!==0?2:0);return x.canonical&&H.cmp(this.nh)>0&&(H=this.n.sub(H),O^=1),new f({r:I,s:H,recoveryParam:O})}}}}}},h.prototype.verify=function(v,b,g,x){v=this._truncateToN(new o(v,16)),g=this.keyFromPublic(g,x);var y=(b=new f(b,"hex")).r,k=b.s;if(y.cmpn(1)<0||y.cmp(this.n)>=0||k.cmpn(1)<0||k.cmp(this.n)>=0)return!1;var N,F=k.invm(this.n),B=F.mul(v).umod(this.n),W=F.mul(y).umod(this.n);return this.curve._maxwellTrick?!(N=this.g.jmulAdd(B,g.getPublic(),W)).isInfinity()&&N.eqXToP(y):!(N=this.g.mulAdd(B,g.getPublic(),W)).isInfinity()&&N.getX().umod(this.n).cmp(y)===0},h.prototype.recoverPubKey=function(v,b,g,x){u((3&g)===g,"The recovery param is more than two bits"),b=new f(b,x);var y=this.n,k=new o(v),N=b.r,F=b.s,B=1&g,W=g>>1;if(N.cmp(this.curve.p.umod(this.curve.n))>=0&&W)throw new Error("Unable to find sencond key candinate");N=W?this.curve.pointFromX(N.add(this.curve.n),B):this.curve.pointFromX(N,B);var V=b.r.invm(y),q=y.sub(k).mul(V).umod(y),X=F.mul(V).umod(y);return this.g.mulAdd(q,N,X)},h.prototype.getKeyRecoveryParam=function(v,b,g,x){if((b=new f(b,x)).recoveryParam!==null)return b.recoveryParam;for(var y=0;y<4;y++){var k;try{k=this.recoverPubKey(v,b,y)}catch{continue}if(k.eq(g))return y}throw new Error("Unable to find valid recovery factor")}},{"../curves":411,"../utils":419,"./key":413,"./signature":414,"bn.js":420,brorand:187,"hmac-drbg":438}],413:[function(e,n,a){var o=e("bn.js"),s=e("../utils").assert;function l(c,i){this.ec=c,this.priv=null,this.pub=null,i.priv&&this._importPrivate(i.priv,i.privEnc),i.pub&&this._importPublic(i.pub,i.pubEnc)}n.exports=l,l.fromPublic=function(c,i,u){return i instanceof l?i:new l(c,{pub:i,pubEnc:u})},l.fromPrivate=function(c,i,u){return i instanceof l?i:new l(c,{priv:i,privEnc:u})},l.prototype.validate=function(){var c=this.getPublic();return c.isInfinity()?{result:!1,reason:"Invalid public key"}:c.validate()?c.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},l.prototype.getPublic=function(c,i){return typeof c=="string"&&(i=c,c=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),i?this.pub.encode(i,c):this.pub},l.prototype.getPrivate=function(c){return c==="hex"?this.priv.toString(16,2):this.priv},l.prototype._importPrivate=function(c,i){this.priv=new o(c,i||16),this.priv=this.priv.umod(this.ec.curve.n)},l.prototype._importPublic=function(c,i){if(c.x||c.y)return this.ec.curve.type==="mont"?s(c.x,"Need x coordinate"):this.ec.curve.type!=="short"&&this.ec.curve.type!=="edwards"||s(c.x&&c.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(c.x,c.y));this.pub=this.ec.curve.decodePoint(c,i)},l.prototype.derive=function(c){return c.validate()||s(c.validate(),"public point not validated"),c.mul(this.priv).getX()},l.prototype.sign=function(c,i,u){return this.ec.sign(c,this,i,u)},l.prototype.verify=function(c,i){return this.ec.verify(c,i,this)},l.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":419,"bn.js":420}],414:[function(e,n,a){var o=e("bn.js"),s=e("../utils"),l=s.assert;function c(h,v){if(h instanceof c)return h;this._importDER(h,v)||(l(h.r&&h.s,"Signature without r or s"),this.r=new o(h.r,16),this.s=new o(h.s,16),h.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=h.recoveryParam)}function i(){this.place=0}function u(h,v){var b=h[v.place++];if(!(128&b))return b;var g=15&b;if(g===0||g>4)return!1;for(var x=0,y=0,k=v.place;y<g;y++,k++)x<<=8,x|=h[k],x>>>=0;return!(x<=127)&&(v.place=k,x)}function p(h){for(var v=0,b=h.length-1;!h[v]&&!(128&h[v+1])&&v<b;)v++;return v===0?h:h.slice(v)}function f(h,v){if(v<128)h.push(v);else{var b=1+(Math.log(v)/Math.LN2>>>3);for(h.push(128|b);--b;)h.push(v>>>(b<<3)&255);h.push(v)}}n.exports=c,c.prototype._importDER=function(h,v){h=s.toArray(h,v);var b=new i;if(h[b.place++]!==48)return!1;var g=u(h,b);if(g===!1||g+b.place!==h.length||h[b.place++]!==2)return!1;var x=u(h,b);if(x===!1)return!1;var y=h.slice(b.place,x+b.place);if(b.place+=x,h[b.place++]!==2)return!1;var k=u(h,b);if(k===!1||h.length!==k+b.place)return!1;var N=h.slice(b.place,k+b.place);if(y[0]===0){if(!(128&y[1]))return!1;y=y.slice(1)}if(N[0]===0){if(!(128&N[1]))return!1;N=N.slice(1)}return this.r=new o(y),this.s=new o(N),this.recoveryParam=null,!0},c.prototype.toDER=function(h){var v=this.r.toArray(),b=this.s.toArray();for(128&v[0]&&(v=[0].concat(v)),128&b[0]&&(b=[0].concat(b)),v=p(v),b=p(b);!(b[0]||128&b[1]);)b=b.slice(1);var g=[2];f(g,v.length),(g=g.concat(v)).push(2),f(g,b.length);var x=g.concat(b),y=[48];return f(y,x.length),y=y.concat(x),s.encode(y,h)}},{"../utils":419,"bn.js":420}],415:[function(e,n,a){var o=e("hash.js"),s=e("../curves"),l=e("../utils"),c=l.assert,i=l.parseBytes,u=e("./key"),p=e("./signature");function f(h){if(c(h==="ed25519","only tested with ed25519 so far"),!(this instanceof f))return new f(h);h=s[h].curve,this.curve=h,this.g=h.g,this.g.precompute(h.n.bitLength()+1),this.pointClass=h.point().constructor,this.encodingLength=Math.ceil(h.n.bitLength()/8),this.hash=o.sha512}n.exports=f,f.prototype.sign=function(h,v){h=i(h);var b=this.keyFromSecret(v),g=this.hashInt(b.messagePrefix(),h),x=this.g.mul(g),y=this.encodePoint(x),k=this.hashInt(y,b.pubBytes(),h).mul(b.priv()),N=g.add(k).umod(this.curve.n);return this.makeSignature({R:x,S:N,Rencoded:y})},f.prototype.verify=function(h,v,b){h=i(h),v=this.makeSignature(v);var g=this.keyFromPublic(b),x=this.hashInt(v.Rencoded(),g.pubBytes(),h),y=this.g.mul(v.S());return v.R().add(g.pub().mul(x)).eq(y)},f.prototype.hashInt=function(){for(var h=this.hash(),v=0;v<arguments.length;v++)h.update(arguments[v]);return l.intFromLE(h.digest()).umod(this.curve.n)},f.prototype.keyFromPublic=function(h){return u.fromPublic(this,h)},f.prototype.keyFromSecret=function(h){return u.fromSecret(this,h)},f.prototype.makeSignature=function(h){return h instanceof p?h:new p(this,h)},f.prototype.encodePoint=function(h){var v=h.getY().toArray("le",this.encodingLength);return v[this.encodingLength-1]|=h.getX().isOdd()?128:0,v},f.prototype.decodePoint=function(h){var v=(h=l.parseBytes(h)).length-1,b=h.slice(0,v).concat(-129&h[v]),g=(128&h[v])!=0,x=l.intFromLE(b);return this.curve.pointFromY(x,g)},f.prototype.encodeInt=function(h){return h.toArray("le",this.encodingLength)},f.prototype.decodeInt=function(h){return l.intFromLE(h)},f.prototype.isPoint=function(h){return h instanceof this.pointClass}},{"../curves":411,"../utils":419,"./key":416,"./signature":417,"hash.js":426}],416:[function(e,n,a){var o=e("../utils"),s=o.assert,l=o.parseBytes,c=o.cachedProperty;function i(u,p){this.eddsa=u,this._secret=l(p.secret),u.isPoint(p.pub)?this._pub=p.pub:this._pubBytes=l(p.pub)}i.fromPublic=function(u,p){return p instanceof i?p:new i(u,{pub:p})},i.fromSecret=function(u,p){return p instanceof i?p:new i(u,{secret:p})},i.prototype.secret=function(){return this._secret},c(i,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),c(i,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),c(i,"privBytes",function(){var u=this.eddsa,p=this.hash(),f=u.encodingLength-1,h=p.slice(0,u.encodingLength);return h[0]&=248,h[f]&=127,h[f]|=64,h}),c(i,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),c(i,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),c(i,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),i.prototype.sign=function(u){return s(this._secret,"KeyPair can only verify"),this.eddsa.sign(u,this)},i.prototype.verify=function(u,p){return this.eddsa.verify(u,p,this)},i.prototype.getSecret=function(u){return s(this._secret,"KeyPair is public only"),o.encode(this.secret(),u)},i.prototype.getPublic=function(u){return o.encode(this.pubBytes(),u)},n.exports=i},{"../utils":419}],417:[function(e,n,a){var o=e("bn.js"),s=e("../utils"),l=s.assert,c=s.cachedProperty,i=s.parseBytes;function u(p,f){this.eddsa=p,typeof f!="object"&&(f=i(f)),Array.isArray(f)&&(f={R:f.slice(0,p.encodingLength),S:f.slice(p.encodingLength)}),l(f.R&&f.S,"Signature without R or S"),p.isPoint(f.R)&&(this._R=f.R),f.S instanceof o&&(this._S=f.S),this._Rencoded=Array.isArray(f.R)?f.R:f.Rencoded,this._Sencoded=Array.isArray(f.S)?f.S:f.Sencoded}c(u,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),c(u,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),c(u,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),c(u,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),u.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},u.prototype.toHex=function(){return s.encode(this.toBytes(),"hex").toUpperCase()},n.exports=u},{"../utils":419,"bn.js":420}],418:[function(e,n,a){n.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],419:[function(e,n,a){var o=a,s=e("bn.js"),l=e("minimalistic-assert"),c=e("minimalistic-crypto-utils");o.assert=l,o.toArray=c.toArray,o.zero2=c.zero2,o.toHex=c.toHex,o.encode=c.encode,o.getNAF=function(i,u,p){var f=new Array(Math.max(i.bitLength(),p)+1);f.fill(0);for(var h=1<<u+1,v=i.clone(),b=0;b<f.length;b++){var g,x=v.andln(h-1);v.isOdd()?(g=x>(h>>1)-1?(h>>1)-x:x,v.isubn(g)):g=0,f[b]=g,v.iushrn(1)}return f},o.getJSF=function(i,u){var p=[[],[]];i=i.clone(),u=u.clone();for(var f,h=0,v=0;i.cmpn(-h)>0||u.cmpn(-v)>0;){var b,g,x=i.andln(3)+h&3,y=u.andln(3)+v&3;x===3&&(x=-1),y===3&&(y=-1),b=(1&x)==0?0:(f=i.andln(7)+h&7)!==3&&f!==5||y!==2?x:-x,p[0].push(b),g=(1&y)==0?0:(f=u.andln(7)+v&7)!==3&&f!==5||x!==2?y:-y,p[1].push(g),2*h===b+1&&(h=1-h),2*v===g+1&&(v=1-v),i.iushrn(1),u.iushrn(1)}return p},o.cachedProperty=function(i,u,p){var f="_"+u;i.prototype[u]=function(){return this[f]!==void 0?this[f]:this[f]=p.call(this)}},o.parseBytes=function(i){return typeof i=="string"?o.toArray(i,"hex"):i},o.intFromLE=function(i){return new s(i,"hex","le")}},{"bn.js":420,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],420:[function(e,n,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],421:[function(e,n,a){n.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}],422:[function(e,n,a){var o=Object.create||function(V){var q=function(){};return q.prototype=V,new q},s=Object.keys||function(V){var q=[];for(var X in V)Object.prototype.hasOwnProperty.call(V,X)&&q.push(X);return X},l=Function.prototype.bind||function(V){var q=this;return function(){return q.apply(V,arguments)}};function c(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=o(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}n.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0;var i,u=10;try{var p={};Object.defineProperty&&Object.defineProperty(p,"x",{value:0}),i=p.x===0}catch{i=!1}function f(V){return V._maxListeners===void 0?c.defaultMaxListeners:V._maxListeners}function h(V,q,X){if(q)V.call(X);else for(var I=V.length,H=W(V,I),O=0;O<I;++O)H[O].call(X)}function v(V,q,X,I){if(q)V.call(X,I);else for(var H=V.length,O=W(V,H),R=0;R<H;++R)O[R].call(X,I)}function b(V,q,X,I,H){if(q)V.call(X,I,H);else for(var O=V.length,R=W(V,O),C=0;C<O;++C)R[C].call(X,I,H)}function g(V,q,X,I,H,O){if(q)V.call(X,I,H,O);else for(var R=V.length,C=W(V,R),w=0;w<R;++w)C[w].call(X,I,H,O)}function x(V,q,X,I){if(q)V.apply(X,I);else for(var H=V.length,O=W(V,H),R=0;R<H;++R)O[R].apply(X,I)}function y(V,q,X,I){var H,O,R;if(typeof X!="function")throw new TypeError('"listener" argument must be a function');if((O=V._events)?(O.newListener&&(V.emit("newListener",q,X.listener?X.listener:X),O=V._events),R=O[q]):(O=V._events=o(null),V._eventsCount=0),R){if(typeof R=="function"?R=O[q]=I?[X,R]:[R,X]:I?R.unshift(X):R.push(X),!R.warned&&(H=f(V))&&H>0&&R.length>H){R.warned=!0;var C=new Error("Possible EventEmitter memory leak detected. "+R.length+' "'+String(q)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');C.name="MaxListenersExceededWarning",C.emitter=V,C.type=q,C.count=R.length,typeof console=="object"&&console.warn&&console.warn("%s: %s",C.name,C.message)}}else R=O[q]=X,++V._eventsCount;return V}function k(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var V=new Array(arguments.length),q=0;q<V.length;++q)V[q]=arguments[q];this.listener.apply(this.target,V)}}function N(V,q,X){var I={fired:!1,wrapFn:void 0,target:V,type:q,listener:X},H=l.call(k,I);return H.listener=X,I.wrapFn=H,H}function F(V,q,X){var I=V._events;if(!I)return[];var H=I[q];return H?typeof H=="function"?X?[H.listener||H]:[H]:X?function(O){for(var R=new Array(O.length),C=0;C<R.length;++C)R[C]=O[C].listener||O[C];return R}(H):W(H,H.length):[]}function B(V){var q=this._events;if(q){var X=q[V];if(typeof X=="function")return 1;if(X)return X.length}return 0}function W(V,q){for(var X=new Array(q),I=0;I<q;++I)X[I]=V[I];return X}i?Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(V){if(typeof V!="number"||V<0||V!=V)throw new TypeError('"defaultMaxListeners" must be a positive number');u=V}}):c.defaultMaxListeners=u,c.prototype.setMaxListeners=function(V){if(typeof V!="number"||V<0||isNaN(V))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=V,this},c.prototype.getMaxListeners=function(){return f(this)},c.prototype.emit=function(V){var q,X,I,H,O,R,C=V==="error";if(R=this._events)C=C&&R.error==null;else if(!C)return!1;if(C){if(arguments.length>1&&(q=arguments[1]),q instanceof Error)throw q;var w=new Error('Unhandled "error" event. ('+q+")");throw w.context=q,w}if(!(X=R[V]))return!1;var E=typeof X=="function";switch(I=arguments.length){case 1:h(X,E,this);break;case 2:v(X,E,this,arguments[1]);break;case 3:b(X,E,this,arguments[1],arguments[2]);break;case 4:g(X,E,this,arguments[1],arguments[2],arguments[3]);break;default:for(H=new Array(I-1),O=1;O<I;O++)H[O-1]=arguments[O];x(X,E,this,H)}return!0},c.prototype.addListener=function(V,q){return y(this,V,q,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(V,q){return y(this,V,q,!0)},c.prototype.once=function(V,q){if(typeof q!="function")throw new TypeError('"listener" argument must be a function');return this.on(V,N(this,V,q)),this},c.prototype.prependOnceListener=function(V,q){if(typeof q!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(V,N(this,V,q)),this},c.prototype.removeListener=function(V,q){var X,I,H,O,R;if(typeof q!="function")throw new TypeError('"listener" argument must be a function');if(!(I=this._events))return this;if(!(X=I[V]))return this;if(X===q||X.listener===q)--this._eventsCount==0?this._events=o(null):(delete I[V],I.removeListener&&this.emit("removeListener",V,X.listener||q));else if(typeof X!="function"){for(H=-1,O=X.length-1;O>=0;O--)if(X[O]===q||X[O].listener===q){R=X[O].listener,H=O;break}if(H<0)return this;H===0?X.shift():function(C,w){for(var E=w,A=E+1,T=C.length;A<T;E+=1,A+=1)C[E]=C[A];C.pop()}(X,H),X.length===1&&(I[V]=X[0]),I.removeListener&&this.emit("removeListener",V,R||q)}return this},c.prototype.removeAllListeners=function(V){var q,X,I;if(!(X=this._events))return this;if(!X.removeListener)return arguments.length===0?(this._events=o(null),this._eventsCount=0):X[V]&&(--this._eventsCount==0?this._events=o(null):delete X[V]),this;if(arguments.length===0){var H,O=s(X);for(I=0;I<O.length;++I)(H=O[I])!=="removeListener"&&this.removeAllListeners(H);return this.removeAllListeners("removeListener"),this._events=o(null),this._eventsCount=0,this}if(typeof(q=X[V])=="function")this.removeListener(V,q);else if(q)for(I=q.length-1;I>=0;I--)this.removeListener(V,q[I]);return this},c.prototype.listeners=function(V){return F(this,V,!0)},c.prototype.rawListeners=function(V){return F(this,V,!1)},c.listenerCount=function(V,q){return typeof V.listenerCount=="function"?V.listenerCount(q):B.call(V,q)},c.prototype.listenerCount=B,c.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],423:[function(e,n,a){var o=e("safe-buffer").Buffer,s=e("md5.js");n.exports=function(l,c,i,u){if(o.isBuffer(l)||(l=o.from(l,"binary")),c&&(o.isBuffer(c)||(c=o.from(c,"binary")),c.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var p=i/8,f=o.alloc(p),h=o.alloc(u||0),v=o.alloc(0);p>0||u>0;){var b=new s;b.update(v),b.update(l),c&&b.update(c),v=b.digest();var g=0;if(p>0){var x=f.length-p;g=Math.min(p,v.length),v.copy(f,x,0,g),p-=g}if(g<v.length&&u>0){var y=h.length-u,k=Math.min(u,v.length-g);v.copy(h,y,g,g+k),u-=k}}return v.fill(0),{key:f,iv:h}}},{"md5.js":450,"safe-buffer":494}],424:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.CsvParserStream=a.ParserOptions=a.parseFile=a.parseStream=a.parseString=a.parse=a.FormatterOptions=a.CsvFormatterStream=a.writeToPath=a.writeToString=a.writeToBuffer=a.writeToStream=a.write=a.format=void 0;var o=e("@fast-csv/format");Object.defineProperty(a,"format",{enumerable:!0,get:function(){return o.format}}),Object.defineProperty(a,"write",{enumerable:!0,get:function(){return o.write}}),Object.defineProperty(a,"writeToStream",{enumerable:!0,get:function(){return o.writeToStream}}),Object.defineProperty(a,"writeToBuffer",{enumerable:!0,get:function(){return o.writeToBuffer}}),Object.defineProperty(a,"writeToString",{enumerable:!0,get:function(){return o.writeToString}}),Object.defineProperty(a,"writeToPath",{enumerable:!0,get:function(){return o.writeToPath}}),Object.defineProperty(a,"CsvFormatterStream",{enumerable:!0,get:function(){return o.CsvFormatterStream}}),Object.defineProperty(a,"FormatterOptions",{enumerable:!0,get:function(){return o.FormatterOptions}});var s=e("@fast-csv/parse");Object.defineProperty(a,"parse",{enumerable:!0,get:function(){return s.parse}}),Object.defineProperty(a,"parseString",{enumerable:!0,get:function(){return s.parseString}}),Object.defineProperty(a,"parseStream",{enumerable:!0,get:function(){return s.parseStream}}),Object.defineProperty(a,"parseFile",{enumerable:!0,get:function(){return s.parseFile}}),Object.defineProperty(a,"ParserOptions",{enumerable:!0,get:function(){return s.ParserOptions}}),Object.defineProperty(a,"CsvParserStream",{enumerable:!0,get:function(){return s.CsvParserStream}})},{"@fast-csv/format":151,"@fast-csv/parse":155}],425:[function(e,n,a){var o=e("safe-buffer").Buffer,s=e("readable-stream").Transform;function l(c){s.call(this),this._block=o.allocUnsafe(c),this._blockSize=c,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}e("inherits")(l,s),l.prototype._transform=function(c,i,u){var p=null;try{this.update(c,i)}catch(f){p=f}u(p)},l.prototype._flush=function(c){var i=null;try{this.push(this.digest())}catch(u){i=u}c(i)},l.prototype.update=function(c,i){if(function(b,g){if(!o.isBuffer(b)&&typeof b!="string")throw new TypeError(g+" must be a string or a buffer")}(c,"Data"),this._finalized)throw new Error("Digest already called");o.isBuffer(c)||(c=o.from(c,i));for(var u=this._block,p=0;this._blockOffset+c.length-p>=this._blockSize;){for(var f=this._blockOffset;f<this._blockSize;)u[f++]=c[p++];this._update(),this._blockOffset=0}for(;p<c.length;)u[this._blockOffset++]=c[p++];for(var h=0,v=8*c.length;v>0;++h)this._length[h]+=v,(v=this._length[h]/4294967296|0)>0&&(this._length[h]-=4294967296*v);return this},l.prototype._update=function(){throw new Error("_update is not implemented")},l.prototype.digest=function(c){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var i=this._digest();c!==void 0&&(i=i.toString(c)),this._block.fill(0),this._blockOffset=0;for(var u=0;u<4;++u)this._length[u]=0;return i},l.prototype._digest=function(){throw new Error("_digest is not implemented")},n.exports=l},{inherits:440,"readable-stream":491,"safe-buffer":494}],426:[function(e,n,a){var o=a;o.utils=e("./hash/utils"),o.common=e("./hash/common"),o.sha=e("./hash/sha"),o.ripemd=e("./hash/ripemd"),o.hmac=e("./hash/hmac"),o.sha1=o.sha.sha1,o.sha256=o.sha.sha256,o.sha224=o.sha.sha224,o.sha384=o.sha.sha384,o.sha512=o.sha.sha512,o.ripemd160=o.ripemd.ripemd160},{"./hash/common":427,"./hash/hmac":428,"./hash/ripemd":429,"./hash/sha":430,"./hash/utils":437}],427:[function(e,n,a){var o=e("./utils"),s=e("minimalistic-assert");function l(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}a.BlockHash=l,l.prototype.update=function(c,i){if(c=o.toArray(c,i),this.pending?this.pending=this.pending.concat(c):this.pending=c,this.pendingTotal+=c.length,this.pending.length>=this._delta8){var u=(c=this.pending).length%this._delta8;this.pending=c.slice(c.length-u,c.length),this.pending.length===0&&(this.pending=null),c=o.join32(c,0,c.length-u,this.endian);for(var p=0;p<c.length;p+=this._delta32)this._update(c,p,p+this._delta32)}return this},l.prototype.digest=function(c){return this.update(this._pad()),s(this.pending===null),this._digest(c)},l.prototype._pad=function(){var c=this.pendingTotal,i=this._delta8,u=i-(c+this.padLength)%i,p=new Array(u+this.padLength);p[0]=128;for(var f=1;f<u;f++)p[f]=0;if(c<<=3,this.endian==="big"){for(var h=8;h<this.padLength;h++)p[f++]=0;p[f++]=0,p[f++]=0,p[f++]=0,p[f++]=0,p[f++]=c>>>24&255,p[f++]=c>>>16&255,p[f++]=c>>>8&255,p[f++]=255&c}else for(p[f++]=255&c,p[f++]=c>>>8&255,p[f++]=c>>>16&255,p[f++]=c>>>24&255,p[f++]=0,p[f++]=0,p[f++]=0,p[f++]=0,h=8;h<this.padLength;h++)p[f++]=0;return p}},{"./utils":437,"minimalistic-assert":453}],428:[function(e,n,a){var o=e("./utils"),s=e("minimalistic-assert");function l(c,i,u){if(!(this instanceof l))return new l(c,i,u);this.Hash=c,this.blockSize=c.blockSize/8,this.outSize=c.outSize/8,this.inner=null,this.outer=null,this._init(o.toArray(i,u))}n.exports=l,l.prototype._init=function(c){c.length>this.blockSize&&(c=new this.Hash().update(c).digest()),s(c.length<=this.blockSize);for(var i=c.length;i<this.blockSize;i++)c.push(0);for(i=0;i<c.length;i++)c[i]^=54;for(this.inner=new this.Hash().update(c),i=0;i<c.length;i++)c[i]^=106;this.outer=new this.Hash().update(c)},l.prototype.update=function(c,i){return this.inner.update(c,i),this},l.prototype.digest=function(c){return this.outer.update(this.inner.digest()),this.outer.digest(c)}},{"./utils":437,"minimalistic-assert":453}],429:[function(e,n,a){var o=e("./utils"),s=e("./common"),l=o.rotl32,c=o.sum32,i=o.sum32_3,u=o.sum32_4,p=s.BlockHash;function f(){if(!(this instanceof f))return new f;p.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function h(N,F,B,W){return N<=15?F^B^W:N<=31?F&B|~F&W:N<=47?(F|~B)^W:N<=63?F&W|B&~W:F^(B|~W)}function v(N){return N<=15?0:N<=31?1518500249:N<=47?1859775393:N<=63?2400959708:2840853838}function b(N){return N<=15?1352829926:N<=31?1548603684:N<=47?1836072691:N<=63?2053994217:0}o.inherits(f,p),a.ripemd160=f,f.blockSize=512,f.outSize=160,f.hmacStrength=192,f.padLength=64,f.prototype._update=function(N,F){for(var B=this.h[0],W=this.h[1],V=this.h[2],q=this.h[3],X=this.h[4],I=B,H=W,O=V,R=q,C=X,w=0;w<80;w++){var E=c(l(u(B,h(w,W,V,q),N[g[w]+F],v(w)),y[w]),X);B=X,X=q,q=l(V,10),V=W,W=E,E=c(l(u(I,h(79-w,H,O,R),N[x[w]+F],b(w)),k[w]),C),I=C,C=R,R=l(O,10),O=H,H=E}E=i(this.h[1],V,R),this.h[1]=i(this.h[2],q,C),this.h[2]=i(this.h[3],X,I),this.h[3]=i(this.h[4],B,H),this.h[4]=i(this.h[0],W,O),this.h[0]=E},f.prototype._digest=function(N){return N==="hex"?o.toHex32(this.h,"little"):o.split32(this.h,"little")};var g=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],x=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],y=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],k=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":427,"./utils":437}],430:[function(e,n,a){a.sha1=e("./sha/1"),a.sha224=e("./sha/224"),a.sha256=e("./sha/256"),a.sha384=e("./sha/384"),a.sha512=e("./sha/512")},{"./sha/1":431,"./sha/224":432,"./sha/256":433,"./sha/384":434,"./sha/512":435}],431:[function(e,n,a){var o=e("../utils"),s=e("../common"),l=e("./common"),c=o.rotl32,i=o.sum32,u=o.sum32_5,p=l.ft_1,f=s.BlockHash,h=[1518500249,1859775393,2400959708,3395469782];function v(){if(!(this instanceof v))return new v;f.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}o.inherits(v,f),n.exports=v,v.blockSize=512,v.outSize=160,v.hmacStrength=80,v.padLength=64,v.prototype._update=function(b,g){for(var x=this.W,y=0;y<16;y++)x[y]=b[g+y];for(;y<x.length;y++)x[y]=c(x[y-3]^x[y-8]^x[y-14]^x[y-16],1);var k=this.h[0],N=this.h[1],F=this.h[2],B=this.h[3],W=this.h[4];for(y=0;y<x.length;y++){var V=~~(y/20),q=u(c(k,5),p(V,N,F,B),W,x[y],h[V]);W=B,B=F,F=c(N,30),N=k,k=q}this.h[0]=i(this.h[0],k),this.h[1]=i(this.h[1],N),this.h[2]=i(this.h[2],F),this.h[3]=i(this.h[3],B),this.h[4]=i(this.h[4],W)},v.prototype._digest=function(b){return b==="hex"?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436}],432:[function(e,n,a){var o=e("../utils"),s=e("./256");function l(){if(!(this instanceof l))return new l;s.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}o.inherits(l,s),n.exports=l,l.blockSize=512,l.outSize=224,l.hmacStrength=192,l.padLength=64,l.prototype._digest=function(c){return c==="hex"?o.toHex32(this.h.slice(0,7),"big"):o.split32(this.h.slice(0,7),"big")}},{"../utils":437,"./256":433}],433:[function(e,n,a){var o=e("../utils"),s=e("../common"),l=e("./common"),c=e("minimalistic-assert"),i=o.sum32,u=o.sum32_4,p=o.sum32_5,f=l.ch32,h=l.maj32,v=l.s0_256,b=l.s1_256,g=l.g0_256,x=l.g1_256,y=s.BlockHash,k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function N(){if(!(this instanceof N))return new N;y.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=k,this.W=new Array(64)}o.inherits(N,y),n.exports=N,N.blockSize=512,N.outSize=256,N.hmacStrength=192,N.padLength=64,N.prototype._update=function(F,B){for(var W=this.W,V=0;V<16;V++)W[V]=F[B+V];for(;V<W.length;V++)W[V]=u(x(W[V-2]),W[V-7],g(W[V-15]),W[V-16]);var q=this.h[0],X=this.h[1],I=this.h[2],H=this.h[3],O=this.h[4],R=this.h[5],C=this.h[6],w=this.h[7];for(c(this.k.length===W.length),V=0;V<W.length;V++){var E=p(w,b(O),f(O,R,C),this.k[V],W[V]),A=i(v(q),h(q,X,I));w=C,C=R,R=O,O=i(H,E),H=I,I=X,X=q,q=i(E,A)}this.h[0]=i(this.h[0],q),this.h[1]=i(this.h[1],X),this.h[2]=i(this.h[2],I),this.h[3]=i(this.h[3],H),this.h[4]=i(this.h[4],O),this.h[5]=i(this.h[5],R),this.h[6]=i(this.h[6],C),this.h[7]=i(this.h[7],w)},N.prototype._digest=function(F){return F==="hex"?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436,"minimalistic-assert":453}],434:[function(e,n,a){var o=e("../utils"),s=e("./512");function l(){if(!(this instanceof l))return new l;s.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}o.inherits(l,s),n.exports=l,l.blockSize=1024,l.outSize=384,l.hmacStrength=192,l.padLength=128,l.prototype._digest=function(c){return c==="hex"?o.toHex32(this.h.slice(0,12),"big"):o.split32(this.h.slice(0,12),"big")}},{"../utils":437,"./512":435}],435:[function(e,n,a){var o=e("../utils"),s=e("../common"),l=e("minimalistic-assert"),c=o.rotr64_hi,i=o.rotr64_lo,u=o.shr64_hi,p=o.shr64_lo,f=o.sum64,h=o.sum64_hi,v=o.sum64_lo,b=o.sum64_4_hi,g=o.sum64_4_lo,x=o.sum64_5_hi,y=o.sum64_5_lo,k=s.BlockHash,N=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function F(){if(!(this instanceof F))return new F;k.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=N,this.W=new Array(160)}function B(A,T,D,U,P){var K=A&D^~A&P;return K<0&&(K+=4294967296),K}function W(A,T,D,U,P,K){var Y=T&U^~T&K;return Y<0&&(Y+=4294967296),Y}function V(A,T,D,U,P){var K=A&D^A&P^D&P;return K<0&&(K+=4294967296),K}function q(A,T,D,U,P,K){var Y=T&U^T&K^U&K;return Y<0&&(Y+=4294967296),Y}function X(A,T){var D=c(A,T,28)^c(T,A,2)^c(T,A,7);return D<0&&(D+=4294967296),D}function I(A,T){var D=i(A,T,28)^i(T,A,2)^i(T,A,7);return D<0&&(D+=4294967296),D}function H(A,T){var D=c(A,T,14)^c(A,T,18)^c(T,A,9);return D<0&&(D+=4294967296),D}function O(A,T){var D=i(A,T,14)^i(A,T,18)^i(T,A,9);return D<0&&(D+=4294967296),D}function R(A,T){var D=c(A,T,1)^c(A,T,8)^u(A,T,7);return D<0&&(D+=4294967296),D}function C(A,T){var D=i(A,T,1)^i(A,T,8)^p(A,T,7);return D<0&&(D+=4294967296),D}function w(A,T){var D=c(A,T,19)^c(T,A,29)^u(A,T,6);return D<0&&(D+=4294967296),D}function E(A,T){var D=i(A,T,19)^i(T,A,29)^p(A,T,6);return D<0&&(D+=4294967296),D}o.inherits(F,k),n.exports=F,F.blockSize=1024,F.outSize=512,F.hmacStrength=192,F.padLength=128,F.prototype._prepareBlock=function(A,T){for(var D=this.W,U=0;U<32;U++)D[U]=A[T+U];for(;U<D.length;U+=2){var P=w(D[U-4],D[U-3]),K=E(D[U-4],D[U-3]),Y=D[U-14],re=D[U-13],z=R(D[U-30],D[U-29]),ee=C(D[U-30],D[U-29]),L=D[U-32],M=D[U-31];D[U]=b(P,K,Y,re,z,ee,L,M),D[U+1]=g(P,K,Y,re,z,ee,L,M)}},F.prototype._update=function(A,T){this._prepareBlock(A,T);var D=this.W,U=this.h[0],P=this.h[1],K=this.h[2],Y=this.h[3],re=this.h[4],z=this.h[5],ee=this.h[6],L=this.h[7],M=this.h[8],Z=this.h[9],se=this.h[10],ae=this.h[11],ne=this.h[12],Q=this.h[13],fe=this.h[14],le=this.h[15];l(this.k.length===D.length);for(var te=0;te<D.length;te+=2){var ce=fe,he=le,Ee=H(M,Z),ke=O(M,Z),Ce=B(M,Z,se,ae,ne),Fe=W(M,Z,se,ae,ne,Q),Pe=this.k[te],Xe=this.k[te+1],ct=D[te],st=D[te+1],lt=x(ce,he,Ee,ke,Ce,Fe,Pe,Xe,ct,st),tt=y(ce,he,Ee,ke,Ce,Fe,Pe,Xe,ct,st);ce=X(U,P),he=I(U,P),Ee=V(U,P,K,Y,re),ke=q(U,P,K,Y,re,z);var ot=h(ce,he,Ee,ke),De=v(ce,he,Ee,ke);fe=ne,le=Q,ne=se,Q=ae,se=M,ae=Z,M=h(ee,L,lt,tt),Z=v(L,L,lt,tt),ee=re,L=z,re=K,z=Y,K=U,Y=P,U=h(lt,tt,ot,De),P=v(lt,tt,ot,De)}f(this.h,0,U,P),f(this.h,2,K,Y),f(this.h,4,re,z),f(this.h,6,ee,L),f(this.h,8,M,Z),f(this.h,10,se,ae),f(this.h,12,ne,Q),f(this.h,14,fe,le)},F.prototype._digest=function(A){return A==="hex"?o.toHex32(this.h,"big"):o.split32(this.h,"big")}},{"../common":427,"../utils":437,"minimalistic-assert":453}],436:[function(e,n,a){var o=e("../utils").rotr32;function s(i,u,p){return i&u^~i&p}function l(i,u,p){return i&u^i&p^u&p}function c(i,u,p){return i^u^p}a.ft_1=function(i,u,p,f){return i===0?s(u,p,f):i===1||i===3?c(u,p,f):i===2?l(u,p,f):void 0},a.ch32=s,a.maj32=l,a.p32=c,a.s0_256=function(i){return o(i,2)^o(i,13)^o(i,22)},a.s1_256=function(i){return o(i,6)^o(i,11)^o(i,25)},a.g0_256=function(i){return o(i,7)^o(i,18)^i>>>3},a.g1_256=function(i){return o(i,17)^o(i,19)^i>>>10}},{"../utils":437}],437:[function(e,n,a){var o=e("minimalistic-assert"),s=e("inherits");function l(p,f){return(64512&p.charCodeAt(f))==55296&&!(f<0||f+1>=p.length)&&(64512&p.charCodeAt(f+1))==56320}function c(p){return(p>>>24|p>>>8&65280|p<<8&16711680|(255&p)<<24)>>>0}function i(p){return p.length===1?"0"+p:p}function u(p){return p.length===7?"0"+p:p.length===6?"00"+p:p.length===5?"000"+p:p.length===4?"0000"+p:p.length===3?"00000"+p:p.length===2?"000000"+p:p.length===1?"0000000"+p:p}a.inherits=s,a.toArray=function(p,f){if(Array.isArray(p))return p.slice();if(!p)return[];var h=[];if(typeof p=="string")if(f){if(f==="hex")for((p=p.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(p="0"+p),b=0;b<p.length;b+=2)h.push(parseInt(p[b]+p[b+1],16))}else for(var v=0,b=0;b<p.length;b++){var g=p.charCodeAt(b);g<128?h[v++]=g:g<2048?(h[v++]=g>>6|192,h[v++]=63&g|128):l(p,b)?(g=65536+((1023&g)<<10)+(1023&p.charCodeAt(++b)),h[v++]=g>>18|240,h[v++]=g>>12&63|128,h[v++]=g>>6&63|128,h[v++]=63&g|128):(h[v++]=g>>12|224,h[v++]=g>>6&63|128,h[v++]=63&g|128)}else for(b=0;b<p.length;b++)h[b]=0|p[b];return h},a.toHex=function(p){for(var f="",h=0;h<p.length;h++)f+=i(p[h].toString(16));return f},a.htonl=c,a.toHex32=function(p,f){for(var h="",v=0;v<p.length;v++){var b=p[v];f==="little"&&(b=c(b)),h+=u(b.toString(16))}return h},a.zero2=i,a.zero8=u,a.join32=function(p,f,h,v){var b=h-f;o(b%4==0);for(var g=new Array(b/4),x=0,y=f;x<g.length;x++,y+=4){var k;k=v==="big"?p[y]<<24|p[y+1]<<16|p[y+2]<<8|p[y+3]:p[y+3]<<24|p[y+2]<<16|p[y+1]<<8|p[y],g[x]=k>>>0}return g},a.split32=function(p,f){for(var h=new Array(4*p.length),v=0,b=0;v<p.length;v++,b+=4){var g=p[v];f==="big"?(h[b]=g>>>24,h[b+1]=g>>>16&255,h[b+2]=g>>>8&255,h[b+3]=255&g):(h[b+3]=g>>>24,h[b+2]=g>>>16&255,h[b+1]=g>>>8&255,h[b]=255&g)}return h},a.rotr32=function(p,f){return p>>>f|p<<32-f},a.rotl32=function(p,f){return p<<f|p>>>32-f},a.sum32=function(p,f){return p+f>>>0},a.sum32_3=function(p,f,h){return p+f+h>>>0},a.sum32_4=function(p,f,h,v){return p+f+h+v>>>0},a.sum32_5=function(p,f,h,v,b){return p+f+h+v+b>>>0},a.sum64=function(p,f,h,v){var b=p[f],g=v+p[f+1]>>>0,x=(g<v?1:0)+h+b;p[f]=x>>>0,p[f+1]=g},a.sum64_hi=function(p,f,h,v){return(f+v>>>0<f?1:0)+p+h>>>0},a.sum64_lo=function(p,f,h,v){return f+v>>>0},a.sum64_4_hi=function(p,f,h,v,b,g,x,y){var k=0,N=f;return k+=(N=N+v>>>0)<f?1:0,k+=(N=N+g>>>0)<g?1:0,p+h+b+x+(k+=(N=N+y>>>0)<y?1:0)>>>0},a.sum64_4_lo=function(p,f,h,v,b,g,x,y){return f+v+g+y>>>0},a.sum64_5_hi=function(p,f,h,v,b,g,x,y,k,N){var F=0,B=f;return F+=(B=B+v>>>0)<f?1:0,F+=(B=B+g>>>0)<g?1:0,F+=(B=B+y>>>0)<y?1:0,p+h+b+x+k+(F+=(B=B+N>>>0)<N?1:0)>>>0},a.sum64_5_lo=function(p,f,h,v,b,g,x,y,k,N){return f+v+g+y+N>>>0},a.rotr64_hi=function(p,f,h){return(f<<32-h|p>>>h)>>>0},a.rotr64_lo=function(p,f,h){return(p<<32-h|f>>>h)>>>0},a.shr64_hi=function(p,f,h){return p>>>h},a.shr64_lo=function(p,f,h){return(p<<32-h|f>>>h)>>>0}},{inherits:440,"minimalistic-assert":453}],438:[function(e,n,a){var o=e("hash.js"),s=e("minimalistic-crypto-utils"),l=e("minimalistic-assert");function c(i){if(!(this instanceof c))return new c(i);this.hash=i.hash,this.predResist=!!i.predResist,this.outLen=this.hash.outSize,this.minEntropy=i.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var u=s.toArray(i.entropy,i.entropyEnc||"hex"),p=s.toArray(i.nonce,i.nonceEnc||"hex"),f=s.toArray(i.pers,i.persEnc||"hex");l(u.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(u,p,f)}n.exports=c,c.prototype._init=function(i,u,p){var f=i.concat(u).concat(p);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var h=0;h<this.V.length;h++)this.K[h]=0,this.V[h]=1;this._update(f),this._reseed=1,this.reseedInterval=281474976710656},c.prototype._hmac=function(){return new o.hmac(this.hash,this.K)},c.prototype._update=function(i){var u=this._hmac().update(this.V).update([0]);i&&(u=u.update(i)),this.K=u.digest(),this.V=this._hmac().update(this.V).digest(),i&&(this.K=this._hmac().update(this.V).update([1]).update(i).digest(),this.V=this._hmac().update(this.V).digest())},c.prototype.reseed=function(i,u,p,f){typeof u!="string"&&(f=p,p=u,u=null),i=s.toArray(i,u),p=s.toArray(p,f),l(i.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(i.concat(p||[])),this._reseed=1},c.prototype.generate=function(i,u,p,f){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof u!="string"&&(f=p,p=u,u=null),p&&(p=s.toArray(p,f||"hex"),this._update(p));for(var h=[];h.length<i;)this.V=this._hmac().update(this.V).digest(),h=h.concat(this.V);var v=h.slice(0,i);return this._update(p),this._reseed++,s.encode(v,u)}},{"hash.js":426,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],439:[function(e,n,a){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */a.read=function(o,s,l,c,i){var u,p,f=8*i-c-1,h=(1<<f)-1,v=h>>1,b=-7,g=l?i-1:0,x=l?-1:1,y=o[s+g];for(g+=x,u=y&(1<<-b)-1,y>>=-b,b+=f;b>0;u=256*u+o[s+g],g+=x,b-=8);for(p=u&(1<<-b)-1,u>>=-b,b+=c;b>0;p=256*p+o[s+g],g+=x,b-=8);if(u===0)u=1-v;else{if(u===h)return p?NaN:1/0*(y?-1:1);p+=Math.pow(2,c),u-=v}return(y?-1:1)*p*Math.pow(2,u-c)},a.write=function(o,s,l,c,i,u){var p,f,h,v=8*u-i-1,b=(1<<v)-1,g=b>>1,x=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=c?0:u-1,k=c?1:-1,N=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(f=isNaN(s)?1:0,p=b):(p=Math.floor(Math.log(s)/Math.LN2),s*(h=Math.pow(2,-p))<1&&(p--,h*=2),(s+=p+g>=1?x/h:x*Math.pow(2,1-g))*h>=2&&(p++,h/=2),p+g>=b?(f=0,p=b):p+g>=1?(f=(s*h-1)*Math.pow(2,i),p+=g):(f=s*Math.pow(2,g-1)*Math.pow(2,i),p=0));i>=8;o[l+y]=255&f,y+=k,f/=256,i-=8);for(p=p<<i|f,v+=i;v>0;o[l+y]=255&p,y+=k,p/=256,v-=8);o[l+y-k]|=128*N}},{}],440:[function(e,n,a){typeof Object.create=="function"?n.exports=function(o,s){s&&(o.super_=s,o.prototype=Object.create(s.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}))}:n.exports=function(o,s){if(s){o.super_=s;var l=function(){};l.prototype=s.prototype,o.prototype=new l,o.prototype.constructor=o}}},{}],441:[function(e,n,a){(function(o,s,l,c,i,u,p,f){(function(){/*!

		JSZip v3.10.1 - A JavaScript class for generating and reading zip files
		<http://stuartk.com/jszip>

		(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
		Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

		JSZip uses the library pako released under the MIT license :
		https://github.com/nodeca/pako/blob/main/LICENSE
		*/(function(h){typeof a=="object"&&n!==void 0?n.exports=h():(typeof window<"u"?window:s!==void 0?s:typeof self<"u"?self:this).JSZip=h()})(function(){return function h(v,b,g){function x(N,F){if(!b[N]){if(!v[N]){var B=typeof e=="function"&&e;if(!F&&B)return B(N,!0);if(y)return y(N,!0);var W=new Error("Cannot find module '"+N+"'");throw W.code="MODULE_NOT_FOUND",W}var V=b[N]={exports:{}};v[N][0].call(V.exports,function(q){return x(v[N][1][q]||q)},V,V.exports,h,v,b,g)}return b[N].exports}for(var y=typeof e=="function"&&e,k=0;k<g.length;k++)x(g[k]);return x}({1:[function(h,v,b){var g=h("./utils"),x=h("./support"),y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";b.encode=function(k){for(var N,F,B,W,V,q,X,I=[],H=0,O=k.length,R=O,C=g.getTypeOf(k)!=="string";H<k.length;)R=O-H,B=C?(N=k[H++],F=H<O?k[H++]:0,H<O?k[H++]:0):(N=k.charCodeAt(H++),F=H<O?k.charCodeAt(H++):0,H<O?k.charCodeAt(H++):0),W=N>>2,V=(3&N)<<4|F>>4,q=1<R?(15&F)<<2|B>>6:64,X=2<R?63&B:64,I.push(y.charAt(W)+y.charAt(V)+y.charAt(q)+y.charAt(X));return I.join("")},b.decode=function(k){var N,F,B,W,V,q,X=0,I=0,H="data:";if(k.substr(0,H.length)===H)throw new Error("Invalid base64 input, it looks like a data url.");var O,R=3*(k=k.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(k.charAt(k.length-1)===y.charAt(64)&&R--,k.charAt(k.length-2)===y.charAt(64)&&R--,R%1!=0)throw new Error("Invalid base64 input, bad content length.");for(O=x.uint8array?new Uint8Array(0|R):new Array(0|R);X<k.length;)N=y.indexOf(k.charAt(X++))<<2|(W=y.indexOf(k.charAt(X++)))>>4,F=(15&W)<<4|(V=y.indexOf(k.charAt(X++)))>>2,B=(3&V)<<6|(q=y.indexOf(k.charAt(X++))),O[I++]=N,V!==64&&(O[I++]=F),q!==64&&(O[I++]=B);return O}},{"./support":30,"./utils":32}],2:[function(h,v,b){var g=h("./external"),x=h("./stream/DataWorker"),y=h("./stream/Crc32Probe"),k=h("./stream/DataLengthProbe");function N(F,B,W,V,q){this.compressedSize=F,this.uncompressedSize=B,this.crc32=W,this.compression=V,this.compressedContent=q}N.prototype={getContentWorker:function(){var F=new x(g.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new k("data_length")),B=this;return F.on("end",function(){if(this.streamInfo.data_length!==B.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),F},getCompressedWorker:function(){return new x(g.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},N.createWorkerFrom=function(F,B,W){return F.pipe(new y).pipe(new k("uncompressedSize")).pipe(B.compressWorker(W)).pipe(new k("compressedSize")).withStreamInfo("compression",B)},v.exports=N},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(h,v,b){var g=h("./stream/GenericWorker");b.STORE={magic:"\0\0",compressWorker:function(){return new g("STORE compression")},uncompressWorker:function(){return new g("STORE decompression")}},b.DEFLATE=h("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(h,v,b){var g=h("./utils"),x=function(){for(var y,k=[],N=0;N<256;N++){y=N;for(var F=0;F<8;F++)y=1&y?3988292384^y>>>1:y>>>1;k[N]=y}return k}();v.exports=function(y,k){return y!==void 0&&y.length?g.getTypeOf(y)!=="string"?function(N,F,B,W){var V=x,q=0+B;N^=-1;for(var X=0;X<q;X++)N=N>>>8^V[255&(N^F[X])];return-1^N}(0|k,y,y.length):function(N,F,B,W){var V=x,q=0+B;N^=-1;for(var X=0;X<q;X++)N=N>>>8^V[255&(N^F.charCodeAt(X))];return-1^N}(0|k,y,y.length):0}},{"./utils":32}],5:[function(h,v,b){b.base64=!1,b.binary=!1,b.dir=!1,b.createFolders=!0,b.date=null,b.compression=null,b.compressionOptions=null,b.comment=null,b.unixPermissions=null,b.dosPermissions=null},{}],6:[function(h,v,b){var g;g=typeof Promise<"u"?Promise:h("lie"),v.exports={Promise:g}},{lie:37}],7:[function(h,v,b){var g=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",x=h("pako"),y=h("./utils"),k=h("./stream/GenericWorker"),N=g?"uint8array":"array";function F(B,W){k.call(this,"FlateWorker/"+B),this._pako=null,this._pakoAction=B,this._pakoOptions=W,this.meta={}}b.magic="\b\0",y.inherits(F,k),F.prototype.processChunk=function(B){this.meta=B.meta,this._pako===null&&this._createPako(),this._pako.push(y.transformTo(N,B.data),!1)},F.prototype.flush=function(){k.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},F.prototype.cleanUp=function(){k.prototype.cleanUp.call(this),this._pako=null},F.prototype._createPako=function(){this._pako=new x[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var B=this;this._pako.onData=function(W){B.push({data:W,meta:B.meta})}},b.compressWorker=function(B){return new F("Deflate",B)},b.uncompressWorker=function(){return new F("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(h,v,b){function g(V,q){var X,I="";for(X=0;X<q;X++)I+=String.fromCharCode(255&V),V>>>=8;return I}function x(V,q,X,I,H,O){var R,C,w=V.file,E=V.compression,A=O!==N.utf8encode,T=y.transformTo("string",O(w.name)),D=y.transformTo("string",N.utf8encode(w.name)),U=w.comment,P=y.transformTo("string",O(U)),K=y.transformTo("string",N.utf8encode(U)),Y=D.length!==w.name.length,re=K.length!==U.length,z="",ee="",L="",M=w.dir,Z=w.date,se={crc32:0,compressedSize:0,uncompressedSize:0};q&&!X||(se.crc32=V.crc32,se.compressedSize=V.compressedSize,se.uncompressedSize=V.uncompressedSize);var ae=0;q&&(ae|=8),A||!Y&&!re||(ae|=2048);var ne=0,Q=0;M&&(ne|=16),H==="UNIX"?(Q=798,ne|=function(le,te){var ce=le;return le||(ce=te?16893:33204),(65535&ce)<<16}(w.unixPermissions,M)):(Q=20,ne|=function(le){return 63&(le||0)}(w.dosPermissions)),R=Z.getUTCHours(),R<<=6,R|=Z.getUTCMinutes(),R<<=5,R|=Z.getUTCSeconds()/2,C=Z.getUTCFullYear()-1980,C<<=4,C|=Z.getUTCMonth()+1,C<<=5,C|=Z.getUTCDate(),Y&&(ee=g(1,1)+g(F(T),4)+D,z+="up"+g(ee.length,2)+ee),re&&(L=g(1,1)+g(F(P),4)+K,z+="uc"+g(L.length,2)+L);var fe="";return fe+=`
\0`,fe+=g(ae,2),fe+=E.magic,fe+=g(R,2),fe+=g(C,2),fe+=g(se.crc32,4),fe+=g(se.compressedSize,4),fe+=g(se.uncompressedSize,4),fe+=g(T.length,2),fe+=g(z.length,2),{fileRecord:B.LOCAL_FILE_HEADER+fe+T+z,dirRecord:B.CENTRAL_FILE_HEADER+g(Q,2)+fe+g(P.length,2)+"\0\0\0\0"+g(ne,4)+g(I,4)+T+z+P}}var y=h("../utils"),k=h("../stream/GenericWorker"),N=h("../utf8"),F=h("../crc32"),B=h("../signature");function W(V,q,X,I){k.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=q,this.zipPlatform=X,this.encodeFileName=I,this.streamFiles=V,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}y.inherits(W,k),W.prototype.push=function(V){var q=V.meta.percent||0,X=this.entriesCount,I=this._sources.length;this.accumulate?this.contentBuffer.push(V):(this.bytesWritten+=V.data.length,k.prototype.push.call(this,{data:V.data,meta:{currentFile:this.currentFile,percent:X?(q+100*(X-I-1))/X:100}}))},W.prototype.openedSource=function(V){this.currentSourceOffset=this.bytesWritten,this.currentFile=V.file.name;var q=this.streamFiles&&!V.file.dir;if(q){var X=x(V,q,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:X.fileRecord,meta:{percent:0}})}else this.accumulate=!0},W.prototype.closedSource=function(V){this.accumulate=!1;var q=this.streamFiles&&!V.file.dir,X=x(V,q,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(X.dirRecord),q)this.push({data:function(I){return B.DATA_DESCRIPTOR+g(I.crc32,4)+g(I.compressedSize,4)+g(I.uncompressedSize,4)}(V),meta:{percent:100}});else for(this.push({data:X.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},W.prototype.flush=function(){for(var V=this.bytesWritten,q=0;q<this.dirRecords.length;q++)this.push({data:this.dirRecords[q],meta:{percent:100}});var X=this.bytesWritten-V,I=function(H,O,R,C,w){var E=y.transformTo("string",w(C));return B.CENTRAL_DIRECTORY_END+"\0\0\0\0"+g(H,2)+g(H,2)+g(O,4)+g(R,4)+g(E.length,2)+E}(this.dirRecords.length,X,V,this.zipComment,this.encodeFileName);this.push({data:I,meta:{percent:100}})},W.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},W.prototype.registerPrevious=function(V){this._sources.push(V);var q=this;return V.on("data",function(X){q.processChunk(X)}),V.on("end",function(){q.closedSource(q.previous.streamInfo),q._sources.length?q.prepareNextSource():q.end()}),V.on("error",function(X){q.error(X)}),this},W.prototype.resume=function(){return!!k.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},W.prototype.error=function(V){var q=this._sources;if(!k.prototype.error.call(this,V))return!1;for(var X=0;X<q.length;X++)try{q[X].error(V)}catch{}return!0},W.prototype.lock=function(){k.prototype.lock.call(this);for(var V=this._sources,q=0;q<V.length;q++)V[q].lock()},v.exports=W},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(h,v,b){var g=h("../compressions"),x=h("./ZipFileWorker");b.generateWorker=function(y,k,N){var F=new x(k.streamFiles,N,k.platform,k.encodeFileName),B=0;try{y.forEach(function(W,V){B++;var q=function(O,R){var C=O||R,w=g[C];if(!w)throw new Error(C+" is not a valid compression method !");return w}(V.options.compression,k.compression),X=V.options.compressionOptions||k.compressionOptions||{},I=V.dir,H=V.date;V._compressWorker(q,X).withStreamInfo("file",{name:W,dir:I,date:H,comment:V.comment||"",unixPermissions:V.unixPermissions,dosPermissions:V.dosPermissions}).pipe(F)}),F.entriesCount=B}catch(W){F.error(W)}return F}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(h,v,b){function g(){if(!(this instanceof g))return new g;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var x=new g;for(var y in this)typeof this[y]!="function"&&(x[y]=this[y]);return x}}(g.prototype=h("./object")).loadAsync=h("./load"),g.support=h("./support"),g.defaults=h("./defaults"),g.version="3.10.1",g.loadAsync=function(x,y){return new g().loadAsync(x,y)},g.external=h("./external"),v.exports=g},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(h,v,b){var g=h("./utils"),x=h("./external"),y=h("./utf8"),k=h("./zipEntries"),N=h("./stream/Crc32Probe"),F=h("./nodejsUtils");function B(W){return new x.Promise(function(V,q){var X=W.decompressed.getContentWorker().pipe(new N);X.on("error",function(I){q(I)}).on("end",function(){X.streamInfo.crc32!==W.decompressed.crc32?q(new Error("Corrupted zip : CRC32 mismatch")):V()}).resume()})}v.exports=function(W,V){var q=this;return V=g.extend(V||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:y.utf8decode}),F.isNode&&F.isStream(W)?x.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):g.prepareContent("the loaded zip file",W,!0,V.optimizedBinaryString,V.base64).then(function(X){var I=new k(V);return I.load(X),I}).then(function(X){var I=[x.Promise.resolve(X)],H=X.files;if(V.checkCRC32)for(var O=0;O<H.length;O++)I.push(B(H[O]));return x.Promise.all(I)}).then(function(X){for(var I=X.shift(),H=I.files,O=0;O<H.length;O++){var R=H[O],C=R.fileNameStr,w=g.resolve(R.fileNameStr);q.file(w,R.decompressed,{binary:!0,optimizedBinaryString:!0,date:R.date,dir:R.dir,comment:R.fileCommentStr.length?R.fileCommentStr:null,unixPermissions:R.unixPermissions,dosPermissions:R.dosPermissions,createFolders:V.createFolders}),R.dir||(q.file(w).unsafeOriginalName=C)}return I.zipComment.length&&(q.comment=I.zipComment),q})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(h,v,b){var g=h("../utils"),x=h("../stream/GenericWorker");function y(k,N){x.call(this,"Nodejs stream input adapter for "+k),this._upstreamEnded=!1,this._bindStream(N)}g.inherits(y,x),y.prototype._bindStream=function(k){var N=this;(this._stream=k).pause(),k.on("data",function(F){N.push({data:F,meta:{percent:0}})}).on("error",function(F){N.isPaused?this.generatedError=F:N.error(F)}).on("end",function(){N.isPaused?N._upstreamEnded=!0:N.end()})},y.prototype.pause=function(){return!!x.prototype.pause.call(this)&&(this._stream.pause(),!0)},y.prototype.resume=function(){return!!x.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},v.exports=y},{"../stream/GenericWorker":28,"../utils":32}],13:[function(h,v,b){var g=h("readable-stream").Readable;function x(y,k,N){g.call(this,k),this._helper=y;var F=this;y.on("data",function(B,W){F.push(B)||F._helper.pause(),N&&N(W)}).on("error",function(B){F.emit("error",B)}).on("end",function(){F.push(null)})}h("../utils").inherits(x,g),x.prototype._read=function(){this._helper.resume()},v.exports=x},{"../utils":32,"readable-stream":16}],14:[function(h,v,b){v.exports={isNode:l!==void 0,newBufferFrom:function(g,x){if(l.from&&l.from!==Uint8Array.from)return l.from(g,x);if(typeof g=="number")throw new Error('The "data" argument must not be a number');return new l(g,x)},allocBuffer:function(g){if(l.alloc)return l.alloc(g);var x=new l(g);return x.fill(0),x},isBuffer:function(g){return l.isBuffer(g)},isStream:function(g){return g&&typeof g.on=="function"&&typeof g.pause=="function"&&typeof g.resume=="function"}}},{}],15:[function(h,v,b){function g(w,E,A){var T,D=y.getTypeOf(E),U=y.extend(A||{},F);U.date=U.date||new Date,U.compression!==null&&(U.compression=U.compression.toUpperCase()),typeof U.unixPermissions=="string"&&(U.unixPermissions=parseInt(U.unixPermissions,8)),U.unixPermissions&&16384&U.unixPermissions&&(U.dir=!0),U.dosPermissions&&16&U.dosPermissions&&(U.dir=!0),U.dir&&(w=H(w)),U.createFolders&&(T=I(w))&&O.call(this,T,!0);var P=D==="string"&&U.binary===!1&&U.base64===!1;A&&A.binary!==void 0||(U.binary=!P),(E instanceof B&&E.uncompressedSize===0||U.dir||!E||E.length===0)&&(U.base64=!1,U.binary=!0,E="",U.compression="STORE",D="string");var K;K=E instanceof B||E instanceof k?E:q.isNode&&q.isStream(E)?new X(w,E):y.prepareContent(w,E,U.binary,U.optimizedBinaryString,U.base64);var Y=new W(w,K,U);this.files[w]=Y}var x=h("./utf8"),y=h("./utils"),k=h("./stream/GenericWorker"),N=h("./stream/StreamHelper"),F=h("./defaults"),B=h("./compressedObject"),W=h("./zipObject"),V=h("./generate"),q=h("./nodejsUtils"),X=h("./nodejs/NodejsStreamInputAdapter"),I=function(w){w.slice(-1)==="/"&&(w=w.substring(0,w.length-1));var E=w.lastIndexOf("/");return 0<E?w.substring(0,E):""},H=function(w){return w.slice(-1)!=="/"&&(w+="/"),w},O=function(w,E){return E=E!==void 0?E:F.createFolders,w=H(w),this.files[w]||g.call(this,w,null,{dir:!0,createFolders:E}),this.files[w]};function R(w){return Object.prototype.toString.call(w)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(w){var E,A,T;for(E in this.files)T=this.files[E],(A=E.slice(this.root.length,E.length))&&E.slice(0,this.root.length)===this.root&&w(A,T)},filter:function(w){var E=[];return this.forEach(function(A,T){w(A,T)&&E.push(T)}),E},file:function(w,E,A){if(arguments.length!==1)return w=this.root+w,g.call(this,w,E,A),this;if(R(w)){var T=w;return this.filter(function(U,P){return!P.dir&&T.test(U)})}var D=this.files[this.root+w];return D&&!D.dir?D:null},folder:function(w){if(!w)return this;if(R(w))return this.filter(function(D,U){return U.dir&&w.test(D)});var E=this.root+w,A=O.call(this,E),T=this.clone();return T.root=A.name,T},remove:function(w){w=this.root+w;var E=this.files[w];if(E||(w.slice(-1)!=="/"&&(w+="/"),E=this.files[w]),E&&!E.dir)delete this.files[w];else for(var A=this.filter(function(D,U){return U.name.slice(0,w.length)===w}),T=0;T<A.length;T++)delete this.files[A[T].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(w){var E,A={};try{if((A=y.extend(w||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:x.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");y.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var T=A.comment||this.comment||"";E=V.generateWorker(this,A,T)}catch(D){(E=new k("error")).error(D)}return new N(E,A.type||"string",A.mimeType)},generateAsync:function(w,E){return this.generateInternalStream(w).accumulate(E)},generateNodeStream:function(w,E){return(w=w||{}).type||(w.type="nodebuffer"),this.generateInternalStream(w).toNodejsStream(E)}};v.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(h,v,b){v.exports=h("stream")},{stream:void 0}],17:[function(h,v,b){var g=h("./DataReader");function x(y){g.call(this,y);for(var k=0;k<this.data.length;k++)y[k]=255&y[k]}h("../utils").inherits(x,g),x.prototype.byteAt=function(y){return this.data[this.zero+y]},x.prototype.lastIndexOfSignature=function(y){for(var k=y.charCodeAt(0),N=y.charCodeAt(1),F=y.charCodeAt(2),B=y.charCodeAt(3),W=this.length-4;0<=W;--W)if(this.data[W]===k&&this.data[W+1]===N&&this.data[W+2]===F&&this.data[W+3]===B)return W-this.zero;return-1},x.prototype.readAndCheckSignature=function(y){var k=y.charCodeAt(0),N=y.charCodeAt(1),F=y.charCodeAt(2),B=y.charCodeAt(3),W=this.readData(4);return k===W[0]&&N===W[1]&&F===W[2]&&B===W[3]},x.prototype.readData=function(y){if(this.checkOffset(y),y===0)return[];var k=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,k},v.exports=x},{"../utils":32,"./DataReader":18}],18:[function(h,v,b){var g=h("../utils");function x(y){this.data=y,this.length=y.length,this.index=0,this.zero=0}x.prototype={checkOffset:function(y){this.checkIndex(this.index+y)},checkIndex:function(y){if(this.length<this.zero+y||y<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+y+"). Corrupted zip ?")},setIndex:function(y){this.checkIndex(y),this.index=y},skip:function(y){this.setIndex(this.index+y)},byteAt:function(){},readInt:function(y){var k,N=0;for(this.checkOffset(y),k=this.index+y-1;k>=this.index;k--)N=(N<<8)+this.byteAt(k);return this.index+=y,N},readString:function(y){return g.transformTo("string",this.readData(y))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var y=this.readInt(4);return new Date(Date.UTC(1980+(y>>25&127),(y>>21&15)-1,y>>16&31,y>>11&31,y>>5&63,(31&y)<<1))}},v.exports=x},{"../utils":32}],19:[function(h,v,b){var g=h("./Uint8ArrayReader");function x(y){g.call(this,y)}h("../utils").inherits(x,g),x.prototype.readData=function(y){this.checkOffset(y);var k=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,k},v.exports=x},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(h,v,b){var g=h("./DataReader");function x(y){g.call(this,y)}h("../utils").inherits(x,g),x.prototype.byteAt=function(y){return this.data.charCodeAt(this.zero+y)},x.prototype.lastIndexOfSignature=function(y){return this.data.lastIndexOf(y)-this.zero},x.prototype.readAndCheckSignature=function(y){return y===this.readData(4)},x.prototype.readData=function(y){this.checkOffset(y);var k=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,k},v.exports=x},{"../utils":32,"./DataReader":18}],21:[function(h,v,b){var g=h("./ArrayReader");function x(y){g.call(this,y)}h("../utils").inherits(x,g),x.prototype.readData=function(y){if(this.checkOffset(y),y===0)return new Uint8Array(0);var k=this.data.subarray(this.zero+this.index,this.zero+this.index+y);return this.index+=y,k},v.exports=x},{"../utils":32,"./ArrayReader":17}],22:[function(h,v,b){var g=h("../utils"),x=h("../support"),y=h("./ArrayReader"),k=h("./StringReader"),N=h("./NodeBufferReader"),F=h("./Uint8ArrayReader");v.exports=function(B){var W=g.getTypeOf(B);return g.checkSupport(W),W!=="string"||x.uint8array?W==="nodebuffer"?new N(B):x.uint8array?new F(g.transformTo("uint8array",B)):new y(g.transformTo("array",B)):new k(B)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(h,v,b){b.LOCAL_FILE_HEADER="PK",b.CENTRAL_FILE_HEADER="PK",b.CENTRAL_DIRECTORY_END="PK",b.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",b.ZIP64_CENTRAL_DIRECTORY_END="PK",b.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(h,v,b){var g=h("./GenericWorker"),x=h("../utils");function y(k){g.call(this,"ConvertWorker to "+k),this.destType=k}x.inherits(y,g),y.prototype.processChunk=function(k){this.push({data:x.transformTo(this.destType,k.data),meta:k.meta})},v.exports=y},{"../utils":32,"./GenericWorker":28}],25:[function(h,v,b){var g=h("./GenericWorker"),x=h("../crc32");function y(){g.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}h("../utils").inherits(y,g),y.prototype.processChunk=function(k){this.streamInfo.crc32=x(k.data,this.streamInfo.crc32||0),this.push(k)},v.exports=y},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(h,v,b){var g=h("../utils"),x=h("./GenericWorker");function y(k){x.call(this,"DataLengthProbe for "+k),this.propName=k,this.withStreamInfo(k,0)}g.inherits(y,x),y.prototype.processChunk=function(k){if(k){var N=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=N+k.data.length}x.prototype.processChunk.call(this,k)},v.exports=y},{"../utils":32,"./GenericWorker":28}],27:[function(h,v,b){var g=h("../utils"),x=h("./GenericWorker");function y(k){x.call(this,"DataWorker");var N=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,k.then(function(F){N.dataIsReady=!0,N.data=F,N.max=F&&F.length||0,N.type=g.getTypeOf(F),N.isPaused||N._tickAndRepeat()},function(F){N.error(F)})}g.inherits(y,x),y.prototype.cleanUp=function(){x.prototype.cleanUp.call(this),this.data=null},y.prototype.resume=function(){return!!x.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,g.delay(this._tickAndRepeat,[],this)),!0)},y.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(g.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},y.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var k=null,N=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":k=this.data.substring(this.index,N);break;case"uint8array":k=this.data.subarray(this.index,N);break;case"array":case"nodebuffer":k=this.data.slice(this.index,N)}return this.index=N,this.push({data:k,meta:{percent:this.max?this.index/this.max*100:0}})},v.exports=y},{"../utils":32,"./GenericWorker":28}],28:[function(h,v,b){function g(x){this.name=x||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}g.prototype={push:function(x){this.emit("data",x)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(x){this.emit("error",x)}return!0},error:function(x){return!this.isFinished&&(this.isPaused?this.generatedError=x:(this.isFinished=!0,this.emit("error",x),this.previous&&this.previous.error(x),this.cleanUp()),!0)},on:function(x,y){return this._listeners[x].push(y),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(x,y){if(this._listeners[x])for(var k=0;k<this._listeners[x].length;k++)this._listeners[x][k].call(this,y)},pipe:function(x){return x.registerPrevious(this)},registerPrevious:function(x){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=x.streamInfo,this.mergeStreamInfo(),this.previous=x;var y=this;return x.on("data",function(k){y.processChunk(k)}),x.on("end",function(){y.end()}),x.on("error",function(k){y.error(k)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var x=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),x=!0),this.previous&&this.previous.resume(),!x},flush:function(){},processChunk:function(x){this.push(x)},withStreamInfo:function(x,y){return this.extraStreamInfo[x]=y,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var x in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,x)&&(this.streamInfo[x]=this.extraStreamInfo[x])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var x="Worker "+this.name;return this.previous?this.previous+" -> "+x:x}},v.exports=g},{}],29:[function(h,v,b){var g=h("../utils"),x=h("./ConvertWorker"),y=h("./GenericWorker"),k=h("../base64"),N=h("../support"),F=h("../external"),B=null;if(N.nodestream)try{B=h("../nodejs/NodejsStreamOutputAdapter")}catch{}function W(V,q,X){var I=q;switch(q){case"blob":case"arraybuffer":I="uint8array";break;case"base64":I="string"}try{this._internalType=I,this._outputType=q,this._mimeType=X,g.checkSupport(I),this._worker=V.pipe(new x(I)),V.lock()}catch(H){this._worker=new y("error"),this._worker.error(H)}}W.prototype={accumulate:function(V){return function(q,X){return new F.Promise(function(I,H){var O=[],R=q._internalType,C=q._outputType,w=q._mimeType;q.on("data",function(E,A){O.push(E),X&&X(A)}).on("error",function(E){O=[],H(E)}).on("end",function(){try{var E=function(A,T,D){switch(A){case"blob":return g.newBlob(g.transformTo("arraybuffer",T),D);case"base64":return k.encode(T);default:return g.transformTo(A,T)}}(C,function(A,T){var D,U=0,P=null,K=0;for(D=0;D<T.length;D++)K+=T[D].length;switch(A){case"string":return T.join("");case"array":return Array.prototype.concat.apply([],T);case"uint8array":for(P=new Uint8Array(K),D=0;D<T.length;D++)P.set(T[D],U),U+=T[D].length;return P;case"nodebuffer":return l.concat(T);default:throw new Error("concat : unsupported type '"+A+"'")}}(R,O),w);I(E)}catch(A){H(A)}O=[]}).resume()})}(this,V)},on:function(V,q){var X=this;return V==="data"?this._worker.on(V,function(I){q.call(X,I.data,I.meta)}):this._worker.on(V,function(){g.delay(q,arguments,X)}),this},resume:function(){return g.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(V){if(g.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new B(this,{objectMode:this._outputType!=="nodebuffer"},V)}},v.exports=W},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(h,v,b){if(b.base64=!0,b.array=!0,b.string=!0,b.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",b.nodebuffer=l!==void 0,b.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")b.blob=!1;else{var g=new ArrayBuffer(0);try{b.blob=new Blob([g],{type:"application/zip"}).size===0}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);x.append(g),b.blob=x.getBlob("application/zip").size===0}catch{b.blob=!1}}}try{b.nodestream=!!h("readable-stream").Readable}catch{b.nodestream=!1}},{"readable-stream":16}],31:[function(h,v,b){for(var g=h("./utils"),x=h("./support"),y=h("./nodejsUtils"),k=h("./stream/GenericWorker"),N=new Array(256),F=0;F<256;F++)N[F]=252<=F?6:248<=F?5:240<=F?4:224<=F?3:192<=F?2:1;function B(){k.call(this,"utf-8 decode"),this.leftOver=null}function W(){k.call(this,"utf-8 encode")}N[254]=N[254]=1,b.utf8encode=function(V){return x.nodebuffer?y.newBufferFrom(V,"utf-8"):function(q){var X,I,H,O,R,C=q.length,w=0;for(O=0;O<C;O++)(64512&(I=q.charCodeAt(O)))==55296&&O+1<C&&(64512&(H=q.charCodeAt(O+1)))==56320&&(I=65536+(I-55296<<10)+(H-56320),O++),w+=I<128?1:I<2048?2:I<65536?3:4;for(X=x.uint8array?new Uint8Array(w):new Array(w),O=R=0;R<w;O++)(64512&(I=q.charCodeAt(O)))==55296&&O+1<C&&(64512&(H=q.charCodeAt(O+1)))==56320&&(I=65536+(I-55296<<10)+(H-56320),O++),I<128?X[R++]=I:(I<2048?X[R++]=192|I>>>6:(I<65536?X[R++]=224|I>>>12:(X[R++]=240|I>>>18,X[R++]=128|I>>>12&63),X[R++]=128|I>>>6&63),X[R++]=128|63&I);return X}(V)},b.utf8decode=function(V){return x.nodebuffer?g.transformTo("nodebuffer",V).toString("utf-8"):function(q){var X,I,H,O,R=q.length,C=new Array(2*R);for(X=I=0;X<R;)if((H=q[X++])<128)C[I++]=H;else if(4<(O=N[H]))C[I++]=65533,X+=O-1;else{for(H&=O===2?31:O===3?15:7;1<O&&X<R;)H=H<<6|63&q[X++],O--;1<O?C[I++]=65533:H<65536?C[I++]=H:(H-=65536,C[I++]=55296|H>>10&1023,C[I++]=56320|1023&H)}return C.length!==I&&(C.subarray?C=C.subarray(0,I):C.length=I),g.applyFromCharCode(C)}(V=g.transformTo(x.uint8array?"uint8array":"array",V))},g.inherits(B,k),B.prototype.processChunk=function(V){var q=g.transformTo(x.uint8array?"uint8array":"array",V.data);if(this.leftOver&&this.leftOver.length){if(x.uint8array){var X=q;(q=new Uint8Array(X.length+this.leftOver.length)).set(this.leftOver,0),q.set(X,this.leftOver.length)}else q=this.leftOver.concat(q);this.leftOver=null}var I=function(O,R){var C;for((R=R||O.length)>O.length&&(R=O.length),C=R-1;0<=C&&(192&O[C])==128;)C--;return C<0||C===0?R:C+N[O[C]]>R?C:R}(q),H=q;I!==q.length&&(x.uint8array?(H=q.subarray(0,I),this.leftOver=q.subarray(I,q.length)):(H=q.slice(0,I),this.leftOver=q.slice(I,q.length))),this.push({data:b.utf8decode(H),meta:V.meta})},B.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:b.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},b.Utf8DecodeWorker=B,g.inherits(W,k),W.prototype.processChunk=function(V){this.push({data:b.utf8encode(V.data),meta:V.meta})},b.Utf8EncodeWorker=W},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(h,v,b){var g=h("./support"),x=h("./base64"),y=h("./nodejsUtils"),k=h("./external");function N(X){return X}function F(X,I){for(var H=0;H<X.length;++H)I[H]=255&X.charCodeAt(H);return I}h("setimmediate"),b.newBlob=function(X,I){b.checkSupport("blob");try{return new Blob([X],{type:I})}catch{try{var H=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return H.append(X),H.getBlob(I)}catch{throw new Error("Bug : can't construct the Blob.")}}};var B={stringifyByChunk:function(X,I,H){var O=[],R=0,C=X.length;if(C<=H)return String.fromCharCode.apply(null,X);for(;R<C;)I==="array"||I==="nodebuffer"?O.push(String.fromCharCode.apply(null,X.slice(R,Math.min(R+H,C)))):O.push(String.fromCharCode.apply(null,X.subarray(R,Math.min(R+H,C)))),R+=H;return O.join("")},stringifyByChar:function(X){for(var I="",H=0;H<X.length;H++)I+=String.fromCharCode(X[H]);return I},applyCanBeUsed:{uint8array:function(){try{return g.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return g.nodebuffer&&String.fromCharCode.apply(null,y.allocBuffer(1)).length===1}catch{return!1}}()}};function W(X){var I=65536,H=b.getTypeOf(X),O=!0;if(H==="uint8array"?O=B.applyCanBeUsed.uint8array:H==="nodebuffer"&&(O=B.applyCanBeUsed.nodebuffer),O)for(;1<I;)try{return B.stringifyByChunk(X,H,I)}catch{I=Math.floor(I/2)}return B.stringifyByChar(X)}function V(X,I){for(var H=0;H<X.length;H++)I[H]=X[H];return I}b.applyFromCharCode=W;var q={};q.string={string:N,array:function(X){return F(X,new Array(X.length))},arraybuffer:function(X){return q.string.uint8array(X).buffer},uint8array:function(X){return F(X,new Uint8Array(X.length))},nodebuffer:function(X){return F(X,y.allocBuffer(X.length))}},q.array={string:W,array:N,arraybuffer:function(X){return new Uint8Array(X).buffer},uint8array:function(X){return new Uint8Array(X)},nodebuffer:function(X){return y.newBufferFrom(X)}},q.arraybuffer={string:function(X){return W(new Uint8Array(X))},array:function(X){return V(new Uint8Array(X),new Array(X.byteLength))},arraybuffer:N,uint8array:function(X){return new Uint8Array(X)},nodebuffer:function(X){return y.newBufferFrom(new Uint8Array(X))}},q.uint8array={string:W,array:function(X){return V(X,new Array(X.length))},arraybuffer:function(X){return X.buffer},uint8array:N,nodebuffer:function(X){return y.newBufferFrom(X)}},q.nodebuffer={string:W,array:function(X){return V(X,new Array(X.length))},arraybuffer:function(X){return q.nodebuffer.uint8array(X).buffer},uint8array:function(X){return V(X,new Uint8Array(X.length))},nodebuffer:N},b.transformTo=function(X,I){if(I=I||"",!X)return I;b.checkSupport(X);var H=b.getTypeOf(I);return q[H][X](I)},b.resolve=function(X){for(var I=X.split("/"),H=[],O=0;O<I.length;O++){var R=I[O];R==="."||R===""&&O!==0&&O!==I.length-1||(R===".."?H.pop():H.push(R))}return H.join("/")},b.getTypeOf=function(X){return typeof X=="string"?"string":Object.prototype.toString.call(X)==="[object Array]"?"array":g.nodebuffer&&y.isBuffer(X)?"nodebuffer":g.uint8array&&X instanceof Uint8Array?"uint8array":g.arraybuffer&&X instanceof ArrayBuffer?"arraybuffer":void 0},b.checkSupport=function(X){if(!g[X.toLowerCase()])throw new Error(X+" is not supported by this platform")},b.MAX_VALUE_16BITS=65535,b.MAX_VALUE_32BITS=-1,b.pretty=function(X){var I,H,O="";for(H=0;H<(X||"").length;H++)O+="\\x"+((I=X.charCodeAt(H))<16?"0":"")+I.toString(16).toUpperCase();return O},b.delay=function(X,I,H){f(function(){X.apply(H||null,I||[])})},b.inherits=function(X,I){function H(){}H.prototype=I.prototype,X.prototype=new H},b.extend=function(){var X,I,H={};for(X=0;X<arguments.length;X++)for(I in arguments[X])Object.prototype.hasOwnProperty.call(arguments[X],I)&&H[I]===void 0&&(H[I]=arguments[X][I]);return H},b.prepareContent=function(X,I,H,O,R){return k.Promise.resolve(I).then(function(C){return g.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new k.Promise(function(w,E){var A=new FileReader;A.onload=function(T){w(T.target.result)},A.onerror=function(T){E(T.target.error)},A.readAsArrayBuffer(C)}):C}).then(function(C){var w=b.getTypeOf(C);return w?(w==="arraybuffer"?C=b.transformTo("uint8array",C):w==="string"&&(R?C=x.decode(C):H&&O!==!0&&(C=function(E){return F(E,g.uint8array?new Uint8Array(E.length):new Array(E.length))}(C))),C):k.Promise.reject(new Error("Can't read the data of '"+X+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(h,v,b){var g=h("./reader/readerFor"),x=h("./utils"),y=h("./signature"),k=h("./zipEntry"),N=h("./support");function F(B){this.files=[],this.loadOptions=B}F.prototype={checkSignature:function(B){if(!this.reader.readAndCheckSignature(B)){this.reader.index-=4;var W=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+x.pretty(W)+", expected "+x.pretty(B)+")")}},isSignature:function(B,W){var V=this.reader.index;this.reader.setIndex(B);var q=this.reader.readString(4)===W;return this.reader.setIndex(V),q},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var B=this.reader.readData(this.zipCommentLength),W=N.uint8array?"uint8array":"array",V=x.transformTo(W,B);this.zipComment=this.loadOptions.decodeFileName(V)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var B,W,V,q=this.zip64EndOfCentralSize-44;0<q;)B=this.reader.readInt(2),W=this.reader.readInt(4),V=this.reader.readData(W),this.zip64ExtensibleData[B]={id:B,length:W,value:V}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var B,W;for(B=0;B<this.files.length;B++)W=this.files[B],this.reader.setIndex(W.localHeaderOffset),this.checkSignature(y.LOCAL_FILE_HEADER),W.readLocalPart(this.reader),W.handleUTF8(),W.processAttributes()},readCentralDir:function(){var B;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(y.CENTRAL_FILE_HEADER);)(B=new k({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(B);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var B=this.reader.lastIndexOfSignature(y.CENTRAL_DIRECTORY_END);if(B<0)throw this.isSignature(0,y.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(B);var W=B;if(this.checkSignature(y.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===x.MAX_VALUE_16BITS||this.diskWithCentralDirStart===x.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===x.MAX_VALUE_16BITS||this.centralDirRecords===x.MAX_VALUE_16BITS||this.centralDirSize===x.MAX_VALUE_32BITS||this.centralDirOffset===x.MAX_VALUE_32BITS){if(this.zip64=!0,(B=this.reader.lastIndexOfSignature(y.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(B),this.checkSignature(y.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,y.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(y.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(y.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var V=this.centralDirOffset+this.centralDirSize;this.zip64&&(V+=20,V+=12+this.zip64EndOfCentralSize);var q=W-V;if(0<q)this.isSignature(W,y.CENTRAL_FILE_HEADER)||(this.reader.zero=q);else if(q<0)throw new Error("Corrupted zip: missing "+Math.abs(q)+" bytes.")},prepareReader:function(B){this.reader=g(B)},load:function(B){this.prepareReader(B),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},v.exports=F},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(h,v,b){var g=h("./reader/readerFor"),x=h("./utils"),y=h("./compressedObject"),k=h("./crc32"),N=h("./utf8"),F=h("./compressions"),B=h("./support");function W(V,q){this.options=V,this.loadOptions=q}W.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(V){var q,X;if(V.skip(22),this.fileNameLength=V.readInt(2),X=V.readInt(2),this.fileName=V.readData(this.fileNameLength),V.skip(X),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((q=function(I){for(var H in F)if(Object.prototype.hasOwnProperty.call(F,H)&&F[H].magic===I)return F[H];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+x.pretty(this.compressionMethod)+" unknown (inner file : "+x.transformTo("string",this.fileName)+")");this.decompressed=new y(this.compressedSize,this.uncompressedSize,this.crc32,q,V.readData(this.compressedSize))},readCentralPart:function(V){this.versionMadeBy=V.readInt(2),V.skip(2),this.bitFlag=V.readInt(2),this.compressionMethod=V.readString(2),this.date=V.readDate(),this.crc32=V.readInt(4),this.compressedSize=V.readInt(4),this.uncompressedSize=V.readInt(4);var q=V.readInt(2);if(this.extraFieldsLength=V.readInt(2),this.fileCommentLength=V.readInt(2),this.diskNumberStart=V.readInt(2),this.internalFileAttributes=V.readInt(2),this.externalFileAttributes=V.readInt(4),this.localHeaderOffset=V.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");V.skip(q),this.readExtraFields(V),this.parseZIP64ExtraField(V),this.fileComment=V.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var V=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),V==0&&(this.dosPermissions=63&this.externalFileAttributes),V==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var V=g(this.extraFields[1].value);this.uncompressedSize===x.MAX_VALUE_32BITS&&(this.uncompressedSize=V.readInt(8)),this.compressedSize===x.MAX_VALUE_32BITS&&(this.compressedSize=V.readInt(8)),this.localHeaderOffset===x.MAX_VALUE_32BITS&&(this.localHeaderOffset=V.readInt(8)),this.diskNumberStart===x.MAX_VALUE_32BITS&&(this.diskNumberStart=V.readInt(4))}},readExtraFields:function(V){var q,X,I,H=V.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});V.index+4<H;)q=V.readInt(2),X=V.readInt(2),I=V.readData(X),this.extraFields[q]={id:q,length:X,value:I};V.setIndex(H)},handleUTF8:function(){var V=B.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=N.utf8decode(this.fileName),this.fileCommentStr=N.utf8decode(this.fileComment);else{var q=this.findExtraFieldUnicodePath();if(q!==null)this.fileNameStr=q;else{var X=x.transformTo(V,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(X)}var I=this.findExtraFieldUnicodeComment();if(I!==null)this.fileCommentStr=I;else{var H=x.transformTo(V,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(H)}}},findExtraFieldUnicodePath:function(){var V=this.extraFields[28789];if(V){var q=g(V.value);return q.readInt(1)!==1||k(this.fileName)!==q.readInt(4)?null:N.utf8decode(q.readData(V.length-5))}return null},findExtraFieldUnicodeComment:function(){var V=this.extraFields[25461];if(V){var q=g(V.value);return q.readInt(1)!==1||k(this.fileComment)!==q.readInt(4)?null:N.utf8decode(q.readData(V.length-5))}return null}},v.exports=W},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(h,v,b){function g(q,X,I){this.name=q,this.dir=I.dir,this.date=I.date,this.comment=I.comment,this.unixPermissions=I.unixPermissions,this.dosPermissions=I.dosPermissions,this._data=X,this._dataBinary=I.binary,this.options={compression:I.compression,compressionOptions:I.compressionOptions}}var x=h("./stream/StreamHelper"),y=h("./stream/DataWorker"),k=h("./utf8"),N=h("./compressedObject"),F=h("./stream/GenericWorker");g.prototype={internalStream:function(q){var X=null,I="string";try{if(!q)throw new Error("No output type specified.");var H=(I=q.toLowerCase())==="string"||I==="text";I!=="binarystring"&&I!=="text"||(I="string"),X=this._decompressWorker();var O=!this._dataBinary;O&&!H&&(X=X.pipe(new k.Utf8EncodeWorker)),!O&&H&&(X=X.pipe(new k.Utf8DecodeWorker))}catch(R){(X=new F("error")).error(R)}return new x(X,I,"")},async:function(q,X){return this.internalStream(q).accumulate(X)},nodeStream:function(q,X){return this.internalStream(q||"nodebuffer").toNodejsStream(X)},_compressWorker:function(q,X){if(this._data instanceof N&&this._data.compression.magic===q.magic)return this._data.getCompressedWorker();var I=this._decompressWorker();return this._dataBinary||(I=I.pipe(new k.Utf8EncodeWorker)),N.createWorkerFrom(I,q,X)},_decompressWorker:function(){return this._data instanceof N?this._data.getContentWorker():this._data instanceof F?this._data:new y(this._data)}};for(var B=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],W=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},V=0;V<B.length;V++)g.prototype[B[V]]=W;v.exports=g},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(h,v,b){(function(g){var x,y,k=g.MutationObserver||g.WebKitMutationObserver;if(k){var N=0,F=new k(q),B=g.document.createTextNode("");F.observe(B,{characterData:!0}),x=function(){B.data=N=++N%2}}else if(g.setImmediate||g.MessageChannel===void 0)x="document"in g&&"onreadystatechange"in g.document.createElement("script")?function(){var X=g.document.createElement("script");X.onreadystatechange=function(){q(),X.onreadystatechange=null,X.parentNode.removeChild(X),X=null},g.document.documentElement.appendChild(X)}:function(){setTimeout(q,0)};else{var W=new g.MessageChannel;W.port1.onmessage=q,x=function(){W.port2.postMessage(0)}}var V=[];function q(){var X,I;y=!0;for(var H=V.length;H;){for(I=V,V=[],X=-1;++X<H;)I[X]();H=V.length}y=!1}v.exports=function(X){V.push(X)!==1||y||x()}}).call(this,s!==void 0?s:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(h,v,b){var g=h("immediate");function x(){}var y={},k=["REJECTED"],N=["FULFILLED"],F=["PENDING"];function B(H){if(typeof H!="function")throw new TypeError("resolver must be a function");this.state=F,this.queue=[],this.outcome=void 0,H!==x&&X(this,H)}function W(H,O,R){this.promise=H,typeof O=="function"&&(this.onFulfilled=O,this.callFulfilled=this.otherCallFulfilled),typeof R=="function"&&(this.onRejected=R,this.callRejected=this.otherCallRejected)}function V(H,O,R){g(function(){var C;try{C=O(R)}catch(w){return y.reject(H,w)}C===H?y.reject(H,new TypeError("Cannot resolve promise with itself")):y.resolve(H,C)})}function q(H){var O=H&&H.then;if(H&&(typeof H=="object"||typeof H=="function")&&typeof O=="function")return function(){O.apply(H,arguments)}}function X(H,O){var R=!1;function C(A){R||(R=!0,y.reject(H,A))}function w(A){R||(R=!0,y.resolve(H,A))}var E=I(function(){O(w,C)});E.status==="error"&&C(E.value)}function I(H,O){var R={};try{R.value=H(O),R.status="success"}catch(C){R.status="error",R.value=C}return R}(v.exports=B).prototype.finally=function(H){if(typeof H!="function")return this;var O=this.constructor;return this.then(function(R){return O.resolve(H()).then(function(){return R})},function(R){return O.resolve(H()).then(function(){throw R})})},B.prototype.catch=function(H){return this.then(null,H)},B.prototype.then=function(H,O){if(typeof H!="function"&&this.state===N||typeof O!="function"&&this.state===k)return this;var R=new this.constructor(x);return this.state!==F?V(R,this.state===N?H:O,this.outcome):this.queue.push(new W(R,H,O)),R},W.prototype.callFulfilled=function(H){y.resolve(this.promise,H)},W.prototype.otherCallFulfilled=function(H){V(this.promise,this.onFulfilled,H)},W.prototype.callRejected=function(H){y.reject(this.promise,H)},W.prototype.otherCallRejected=function(H){V(this.promise,this.onRejected,H)},y.resolve=function(H,O){var R=I(q,O);if(R.status==="error")return y.reject(H,R.value);var C=R.value;if(C)X(H,C);else{H.state=N,H.outcome=O;for(var w=-1,E=H.queue.length;++w<E;)H.queue[w].callFulfilled(O)}return H},y.reject=function(H,O){H.state=k,H.outcome=O;for(var R=-1,C=H.queue.length;++R<C;)H.queue[R].callRejected(O);return H},B.resolve=function(H){return H instanceof this?H:y.resolve(new this(x),H)},B.reject=function(H){var O=new this(x);return y.reject(O,H)},B.all=function(H){var O=this;if(Object.prototype.toString.call(H)!=="[object Array]")return this.reject(new TypeError("must be an array"));var R=H.length,C=!1;if(!R)return this.resolve([]);for(var w=new Array(R),E=0,A=-1,T=new this(x);++A<R;)D(H[A],A);return T;function D(U,P){O.resolve(U).then(function(K){w[P]=K,++E!==R||C||(C=!0,y.resolve(T,w))},function(K){C||(C=!0,y.reject(T,K))})}},B.race=function(H){if(Object.prototype.toString.call(H)!=="[object Array]")return this.reject(new TypeError("must be an array"));var O=H.length,R=!1;if(!O)return this.resolve([]);for(var C,w=-1,E=new this(x);++w<O;)C=H[w],this.resolve(C).then(function(A){R||(R=!0,y.resolve(E,A))},function(A){R||(R=!0,y.reject(E,A))});return E}},{immediate:36}],38:[function(h,v,b){var g={};(0,h("./lib/utils/common").assign)(g,h("./lib/deflate"),h("./lib/inflate"),h("./lib/zlib/constants")),v.exports=g},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(h,v,b){var g=h("./zlib/deflate"),x=h("./utils/common"),y=h("./utils/strings"),k=h("./zlib/messages"),N=h("./zlib/zstream"),F=Object.prototype.toString;function B(V){if(!(this instanceof B))return new B(V);this.options=x.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},V||{});var q=this.options;q.raw&&0<q.windowBits?q.windowBits=-q.windowBits:q.gzip&&0<q.windowBits&&q.windowBits<16&&(q.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new N,this.strm.avail_out=0;var X=g.deflateInit2(this.strm,q.level,q.method,q.windowBits,q.memLevel,q.strategy);if(X!==0)throw new Error(k[X]);if(q.header&&g.deflateSetHeader(this.strm,q.header),q.dictionary){var I;if(I=typeof q.dictionary=="string"?y.string2buf(q.dictionary):F.call(q.dictionary)==="[object ArrayBuffer]"?new Uint8Array(q.dictionary):q.dictionary,(X=g.deflateSetDictionary(this.strm,I))!==0)throw new Error(k[X]);this._dict_set=!0}}function W(V,q){var X=new B(q);if(X.push(V,!0),X.err)throw X.msg||k[X.err];return X.result}B.prototype.push=function(V,q){var X,I,H=this.strm,O=this.options.chunkSize;if(this.ended)return!1;I=q===~~q?q:q===!0?4:0,typeof V=="string"?H.input=y.string2buf(V):F.call(V)==="[object ArrayBuffer]"?H.input=new Uint8Array(V):H.input=V,H.next_in=0,H.avail_in=H.input.length;do{if(H.avail_out===0&&(H.output=new x.Buf8(O),H.next_out=0,H.avail_out=O),(X=g.deflate(H,I))!==1&&X!==0)return this.onEnd(X),!(this.ended=!0);H.avail_out!==0&&(H.avail_in!==0||I!==4&&I!==2)||(this.options.to==="string"?this.onData(y.buf2binstring(x.shrinkBuf(H.output,H.next_out))):this.onData(x.shrinkBuf(H.output,H.next_out)))}while((0<H.avail_in||H.avail_out===0)&&X!==1);return I===4?(X=g.deflateEnd(this.strm),this.onEnd(X),this.ended=!0,X===0):I!==2||(this.onEnd(0),!(H.avail_out=0))},B.prototype.onData=function(V){this.chunks.push(V)},B.prototype.onEnd=function(V){V===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=x.flattenChunks(this.chunks)),this.chunks=[],this.err=V,this.msg=this.strm.msg},b.Deflate=B,b.deflate=W,b.deflateRaw=function(V,q){return(q=q||{}).raw=!0,W(V,q)},b.gzip=function(V,q){return(q=q||{}).gzip=!0,W(V,q)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(h,v,b){var g=h("./zlib/inflate"),x=h("./utils/common"),y=h("./utils/strings"),k=h("./zlib/constants"),N=h("./zlib/messages"),F=h("./zlib/zstream"),B=h("./zlib/gzheader"),W=Object.prototype.toString;function V(X){if(!(this instanceof V))return new V(X);this.options=x.assign({chunkSize:16384,windowBits:0,to:""},X||{});var I=this.options;I.raw&&0<=I.windowBits&&I.windowBits<16&&(I.windowBits=-I.windowBits,I.windowBits===0&&(I.windowBits=-15)),!(0<=I.windowBits&&I.windowBits<16)||X&&X.windowBits||(I.windowBits+=32),15<I.windowBits&&I.windowBits<48&&(15&I.windowBits)==0&&(I.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new F,this.strm.avail_out=0;var H=g.inflateInit2(this.strm,I.windowBits);if(H!==k.Z_OK)throw new Error(N[H]);this.header=new B,g.inflateGetHeader(this.strm,this.header)}function q(X,I){var H=new V(I);if(H.push(X,!0),H.err)throw H.msg||N[H.err];return H.result}V.prototype.push=function(X,I){var H,O,R,C,w,E,A=this.strm,T=this.options.chunkSize,D=this.options.dictionary,U=!1;if(this.ended)return!1;O=I===~~I?I:I===!0?k.Z_FINISH:k.Z_NO_FLUSH,typeof X=="string"?A.input=y.binstring2buf(X):W.call(X)==="[object ArrayBuffer]"?A.input=new Uint8Array(X):A.input=X,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new x.Buf8(T),A.next_out=0,A.avail_out=T),(H=g.inflate(A,k.Z_NO_FLUSH))===k.Z_NEED_DICT&&D&&(E=typeof D=="string"?y.string2buf(D):W.call(D)==="[object ArrayBuffer]"?new Uint8Array(D):D,H=g.inflateSetDictionary(this.strm,E)),H===k.Z_BUF_ERROR&&U===!0&&(H=k.Z_OK,U=!1),H!==k.Z_STREAM_END&&H!==k.Z_OK)return this.onEnd(H),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&H!==k.Z_STREAM_END&&(A.avail_in!==0||O!==k.Z_FINISH&&O!==k.Z_SYNC_FLUSH)||(this.options.to==="string"?(R=y.utf8border(A.output,A.next_out),C=A.next_out-R,w=y.buf2string(A.output,R),A.next_out=C,A.avail_out=T-C,C&&x.arraySet(A.output,A.output,R,C,0),this.onData(w)):this.onData(x.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(U=!0)}while((0<A.avail_in||A.avail_out===0)&&H!==k.Z_STREAM_END);return H===k.Z_STREAM_END&&(O=k.Z_FINISH),O===k.Z_FINISH?(H=g.inflateEnd(this.strm),this.onEnd(H),this.ended=!0,H===k.Z_OK):O!==k.Z_SYNC_FLUSH||(this.onEnd(k.Z_OK),!(A.avail_out=0))},V.prototype.onData=function(X){this.chunks.push(X)},V.prototype.onEnd=function(X){X===k.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=x.flattenChunks(this.chunks)),this.chunks=[],this.err=X,this.msg=this.strm.msg},b.Inflate=V,b.inflate=q,b.inflateRaw=function(X,I){return(I=I||{}).raw=!0,q(X,I)},b.ungzip=q},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(h,v,b){var g=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";b.assign=function(k){for(var N=Array.prototype.slice.call(arguments,1);N.length;){var F=N.shift();if(F){if(typeof F!="object")throw new TypeError(F+"must be non-object");for(var B in F)F.hasOwnProperty(B)&&(k[B]=F[B])}}return k},b.shrinkBuf=function(k,N){return k.length===N?k:k.subarray?k.subarray(0,N):(k.length=N,k)};var x={arraySet:function(k,N,F,B,W){if(N.subarray&&k.subarray)k.set(N.subarray(F,F+B),W);else for(var V=0;V<B;V++)k[W+V]=N[F+V]},flattenChunks:function(k){var N,F,B,W,V,q;for(N=B=0,F=k.length;N<F;N++)B+=k[N].length;for(q=new Uint8Array(B),N=W=0,F=k.length;N<F;N++)V=k[N],q.set(V,W),W+=V.length;return q}},y={arraySet:function(k,N,F,B,W){for(var V=0;V<B;V++)k[W+V]=N[F+V]},flattenChunks:function(k){return[].concat.apply([],k)}};b.setTyped=function(k){k?(b.Buf8=Uint8Array,b.Buf16=Uint16Array,b.Buf32=Int32Array,b.assign(b,x)):(b.Buf8=Array,b.Buf16=Array,b.Buf32=Array,b.assign(b,y))},b.setTyped(g)},{}],42:[function(h,v,b){var g=h("./common"),x=!0,y=!0;try{String.fromCharCode.apply(null,[0])}catch{x=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{y=!1}for(var k=new g.Buf8(256),N=0;N<256;N++)k[N]=252<=N?6:248<=N?5:240<=N?4:224<=N?3:192<=N?2:1;function F(B,W){if(W<65537&&(B.subarray&&y||!B.subarray&&x))return String.fromCharCode.apply(null,g.shrinkBuf(B,W));for(var V="",q=0;q<W;q++)V+=String.fromCharCode(B[q]);return V}k[254]=k[254]=1,b.string2buf=function(B){var W,V,q,X,I,H=B.length,O=0;for(X=0;X<H;X++)(64512&(V=B.charCodeAt(X)))==55296&&X+1<H&&(64512&(q=B.charCodeAt(X+1)))==56320&&(V=65536+(V-55296<<10)+(q-56320),X++),O+=V<128?1:V<2048?2:V<65536?3:4;for(W=new g.Buf8(O),X=I=0;I<O;X++)(64512&(V=B.charCodeAt(X)))==55296&&X+1<H&&(64512&(q=B.charCodeAt(X+1)))==56320&&(V=65536+(V-55296<<10)+(q-56320),X++),V<128?W[I++]=V:(V<2048?W[I++]=192|V>>>6:(V<65536?W[I++]=224|V>>>12:(W[I++]=240|V>>>18,W[I++]=128|V>>>12&63),W[I++]=128|V>>>6&63),W[I++]=128|63&V);return W},b.buf2binstring=function(B){return F(B,B.length)},b.binstring2buf=function(B){for(var W=new g.Buf8(B.length),V=0,q=W.length;V<q;V++)W[V]=B.charCodeAt(V);return W},b.buf2string=function(B,W){var V,q,X,I,H=W||B.length,O=new Array(2*H);for(V=q=0;V<H;)if((X=B[V++])<128)O[q++]=X;else if(4<(I=k[X]))O[q++]=65533,V+=I-1;else{for(X&=I===2?31:I===3?15:7;1<I&&V<H;)X=X<<6|63&B[V++],I--;1<I?O[q++]=65533:X<65536?O[q++]=X:(X-=65536,O[q++]=55296|X>>10&1023,O[q++]=56320|1023&X)}return F(O,q)},b.utf8border=function(B,W){var V;for((W=W||B.length)>B.length&&(W=B.length),V=W-1;0<=V&&(192&B[V])==128;)V--;return V<0||V===0?W:V+k[B[V]]>W?V:W}},{"./common":41}],43:[function(h,v,b){v.exports=function(g,x,y,k){for(var N=65535&g|0,F=g>>>16&65535|0,B=0;y!==0;){for(y-=B=2e3<y?2e3:y;F=F+(N=N+x[k++]|0)|0,--B;);N%=65521,F%=65521}return N|F<<16|0}},{}],44:[function(h,v,b){v.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(h,v,b){var g=function(){for(var x,y=[],k=0;k<256;k++){x=k;for(var N=0;N<8;N++)x=1&x?3988292384^x>>>1:x>>>1;y[k]=x}return y}();v.exports=function(x,y,k,N){var F=g,B=N+k;x^=-1;for(var W=N;W<B;W++)x=x>>>8^F[255&(x^y[W])];return-1^x}},{}],46:[function(h,v,b){var g,x=h("../utils/common"),y=h("./trees"),k=h("./adler32"),N=h("./crc32"),F=h("./messages"),B=-2,W=258,V=262,q=113;function X(z,ee){return z.msg=F[ee],ee}function I(z){return(z<<1)-(4<z?9:0)}function H(z){for(var ee=z.length;0<=--ee;)z[ee]=0}function O(z){var ee=z.state,L=ee.pending;L>z.avail_out&&(L=z.avail_out),L!==0&&(x.arraySet(z.output,ee.pending_buf,ee.pending_out,L,z.next_out),z.next_out+=L,ee.pending_out+=L,z.total_out+=L,z.avail_out-=L,ee.pending-=L,ee.pending===0&&(ee.pending_out=0))}function R(z,ee){y._tr_flush_block(z,0<=z.block_start?z.block_start:-1,z.strstart-z.block_start,ee),z.block_start=z.strstart,O(z.strm)}function C(z,ee){z.pending_buf[z.pending++]=ee}function w(z,ee){z.pending_buf[z.pending++]=ee>>>8&255,z.pending_buf[z.pending++]=255&ee}function E(z,ee){var L,M,Z=z.max_chain_length,se=z.strstart,ae=z.prev_length,ne=z.nice_match,Q=z.strstart>z.w_size-V?z.strstart-(z.w_size-V):0,fe=z.window,le=z.w_mask,te=z.prev,ce=z.strstart+W,he=fe[se+ae-1],Ee=fe[se+ae];z.prev_length>=z.good_match&&(Z>>=2),ne>z.lookahead&&(ne=z.lookahead);do if(fe[(L=ee)+ae]===Ee&&fe[L+ae-1]===he&&fe[L]===fe[se]&&fe[++L]===fe[se+1]){se+=2,L++;do;while(fe[++se]===fe[++L]&&fe[++se]===fe[++L]&&fe[++se]===fe[++L]&&fe[++se]===fe[++L]&&fe[++se]===fe[++L]&&fe[++se]===fe[++L]&&fe[++se]===fe[++L]&&fe[++se]===fe[++L]&&se<ce);if(M=W-(ce-se),se=ce-W,ae<M){if(z.match_start=ee,ne<=(ae=M))break;he=fe[se+ae-1],Ee=fe[se+ae]}}while((ee=te[ee&le])>Q&&--Z!=0);return ae<=z.lookahead?ae:z.lookahead}function A(z){var ee,L,M,Z,se,ae,ne,Q,fe,le,te=z.w_size;do{if(Z=z.window_size-z.lookahead-z.strstart,z.strstart>=te+(te-V)){for(x.arraySet(z.window,z.window,te,te,0),z.match_start-=te,z.strstart-=te,z.block_start-=te,ee=L=z.hash_size;M=z.head[--ee],z.head[ee]=te<=M?M-te:0,--L;);for(ee=L=te;M=z.prev[--ee],z.prev[ee]=te<=M?M-te:0,--L;);Z+=te}if(z.strm.avail_in===0)break;if(ae=z.strm,ne=z.window,Q=z.strstart+z.lookahead,le=void 0,(fe=Z)<(le=ae.avail_in)&&(le=fe),L=le===0?0:(ae.avail_in-=le,x.arraySet(ne,ae.input,ae.next_in,le,Q),ae.state.wrap===1?ae.adler=k(ae.adler,ne,le,Q):ae.state.wrap===2&&(ae.adler=N(ae.adler,ne,le,Q)),ae.next_in+=le,ae.total_in+=le,le),z.lookahead+=L,z.lookahead+z.insert>=3)for(se=z.strstart-z.insert,z.ins_h=z.window[se],z.ins_h=(z.ins_h<<z.hash_shift^z.window[se+1])&z.hash_mask;z.insert&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[se+3-1])&z.hash_mask,z.prev[se&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=se,se++,z.insert--,!(z.lookahead+z.insert<3)););}while(z.lookahead<V&&z.strm.avail_in!==0)}function T(z,ee){for(var L,M;;){if(z.lookahead<V){if(A(z),z.lookahead<V&&ee===0)return 1;if(z.lookahead===0)break}if(L=0,z.lookahead>=3&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+3-1])&z.hash_mask,L=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),L!==0&&z.strstart-L<=z.w_size-V&&(z.match_length=E(z,L)),z.match_length>=3)if(M=y._tr_tally(z,z.strstart-z.match_start,z.match_length-3),z.lookahead-=z.match_length,z.match_length<=z.max_lazy_match&&z.lookahead>=3){for(z.match_length--;z.strstart++,z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+3-1])&z.hash_mask,L=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart,--z.match_length!=0;);z.strstart++}else z.strstart+=z.match_length,z.match_length=0,z.ins_h=z.window[z.strstart],z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+1])&z.hash_mask;else M=y._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++;if(M&&(R(z,!1),z.strm.avail_out===0))return 1}return z.insert=z.strstart<2?z.strstart:2,ee===4?(R(z,!0),z.strm.avail_out===0?3:4):z.last_lit&&(R(z,!1),z.strm.avail_out===0)?1:2}function D(z,ee){for(var L,M,Z;;){if(z.lookahead<V){if(A(z),z.lookahead<V&&ee===0)return 1;if(z.lookahead===0)break}if(L=0,z.lookahead>=3&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+3-1])&z.hash_mask,L=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),z.prev_length=z.match_length,z.prev_match=z.match_start,z.match_length=2,L!==0&&z.prev_length<z.max_lazy_match&&z.strstart-L<=z.w_size-V&&(z.match_length=E(z,L),z.match_length<=5&&(z.strategy===1||z.match_length===3&&4096<z.strstart-z.match_start)&&(z.match_length=2)),z.prev_length>=3&&z.match_length<=z.prev_length){for(Z=z.strstart+z.lookahead-3,M=y._tr_tally(z,z.strstart-1-z.prev_match,z.prev_length-3),z.lookahead-=z.prev_length-1,z.prev_length-=2;++z.strstart<=Z&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+3-1])&z.hash_mask,L=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),--z.prev_length!=0;);if(z.match_available=0,z.match_length=2,z.strstart++,M&&(R(z,!1),z.strm.avail_out===0))return 1}else if(z.match_available){if((M=y._tr_tally(z,0,z.window[z.strstart-1]))&&R(z,!1),z.strstart++,z.lookahead--,z.strm.avail_out===0)return 1}else z.match_available=1,z.strstart++,z.lookahead--}return z.match_available&&(M=y._tr_tally(z,0,z.window[z.strstart-1]),z.match_available=0),z.insert=z.strstart<2?z.strstart:2,ee===4?(R(z,!0),z.strm.avail_out===0?3:4):z.last_lit&&(R(z,!1),z.strm.avail_out===0)?1:2}function U(z,ee,L,M,Z){this.good_length=z,this.max_lazy=ee,this.nice_length=L,this.max_chain=M,this.func=Z}function P(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new x.Buf16(1146),this.dyn_dtree=new x.Buf16(122),this.bl_tree=new x.Buf16(78),H(this.dyn_ltree),H(this.dyn_dtree),H(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new x.Buf16(16),this.heap=new x.Buf16(573),H(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new x.Buf16(573),H(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function K(z){var ee;return z&&z.state?(z.total_in=z.total_out=0,z.data_type=2,(ee=z.state).pending=0,ee.pending_out=0,ee.wrap<0&&(ee.wrap=-ee.wrap),ee.status=ee.wrap?42:q,z.adler=ee.wrap===2?0:1,ee.last_flush=0,y._tr_init(ee),0):X(z,B)}function Y(z){var ee=K(z);return ee===0&&function(L){L.window_size=2*L.w_size,H(L.head),L.max_lazy_match=g[L.level].max_lazy,L.good_match=g[L.level].good_length,L.nice_match=g[L.level].nice_length,L.max_chain_length=g[L.level].max_chain,L.strstart=0,L.block_start=0,L.lookahead=0,L.insert=0,L.match_length=L.prev_length=2,L.match_available=0,L.ins_h=0}(z.state),ee}function re(z,ee,L,M,Z,se){if(!z)return B;var ae=1;if(ee===-1&&(ee=6),M<0?(ae=0,M=-M):15<M&&(ae=2,M-=16),Z<1||9<Z||L!==8||M<8||15<M||ee<0||9<ee||se<0||4<se)return X(z,B);M===8&&(M=9);var ne=new P;return(z.state=ne).strm=z,ne.wrap=ae,ne.gzhead=null,ne.w_bits=M,ne.w_size=1<<ne.w_bits,ne.w_mask=ne.w_size-1,ne.hash_bits=Z+7,ne.hash_size=1<<ne.hash_bits,ne.hash_mask=ne.hash_size-1,ne.hash_shift=~~((ne.hash_bits+3-1)/3),ne.window=new x.Buf8(2*ne.w_size),ne.head=new x.Buf16(ne.hash_size),ne.prev=new x.Buf16(ne.w_size),ne.lit_bufsize=1<<Z+6,ne.pending_buf_size=4*ne.lit_bufsize,ne.pending_buf=new x.Buf8(ne.pending_buf_size),ne.d_buf=1*ne.lit_bufsize,ne.l_buf=3*ne.lit_bufsize,ne.level=ee,ne.strategy=se,ne.method=L,Y(z)}g=[new U(0,0,0,0,function(z,ee){var L=65535;for(L>z.pending_buf_size-5&&(L=z.pending_buf_size-5);;){if(z.lookahead<=1){if(A(z),z.lookahead===0&&ee===0)return 1;if(z.lookahead===0)break}z.strstart+=z.lookahead,z.lookahead=0;var M=z.block_start+L;if((z.strstart===0||z.strstart>=M)&&(z.lookahead=z.strstart-M,z.strstart=M,R(z,!1),z.strm.avail_out===0)||z.strstart-z.block_start>=z.w_size-V&&(R(z,!1),z.strm.avail_out===0))return 1}return z.insert=0,ee===4?(R(z,!0),z.strm.avail_out===0?3:4):(z.strstart>z.block_start&&(R(z,!1),z.strm.avail_out),1)}),new U(4,4,8,4,T),new U(4,5,16,8,T),new U(4,6,32,32,T),new U(4,4,16,16,D),new U(8,16,32,32,D),new U(8,16,128,128,D),new U(8,32,128,256,D),new U(32,128,258,1024,D),new U(32,258,258,4096,D)],b.deflateInit=function(z,ee){return re(z,ee,8,15,8,0)},b.deflateInit2=re,b.deflateReset=Y,b.deflateResetKeep=K,b.deflateSetHeader=function(z,ee){return z&&z.state?z.state.wrap!==2?B:(z.state.gzhead=ee,0):B},b.deflate=function(z,ee){var L,M,Z,se;if(!z||!z.state||5<ee||ee<0)return z?X(z,B):B;if(M=z.state,!z.output||!z.input&&z.avail_in!==0||M.status===666&&ee!==4)return X(z,z.avail_out===0?-5:B);if(M.strm=z,L=M.last_flush,M.last_flush=ee,M.status===42)if(M.wrap===2)z.adler=0,C(M,31),C(M,139),C(M,8),M.gzhead?(C(M,(M.gzhead.text?1:0)+(M.gzhead.hcrc?2:0)+(M.gzhead.extra?4:0)+(M.gzhead.name?8:0)+(M.gzhead.comment?16:0)),C(M,255&M.gzhead.time),C(M,M.gzhead.time>>8&255),C(M,M.gzhead.time>>16&255),C(M,M.gzhead.time>>24&255),C(M,M.level===9?2:2<=M.strategy||M.level<2?4:0),C(M,255&M.gzhead.os),M.gzhead.extra&&M.gzhead.extra.length&&(C(M,255&M.gzhead.extra.length),C(M,M.gzhead.extra.length>>8&255)),M.gzhead.hcrc&&(z.adler=N(z.adler,M.pending_buf,M.pending,0)),M.gzindex=0,M.status=69):(C(M,0),C(M,0),C(M,0),C(M,0),C(M,0),C(M,M.level===9?2:2<=M.strategy||M.level<2?4:0),C(M,3),M.status=q);else{var ae=8+(M.w_bits-8<<4)<<8;ae|=(2<=M.strategy||M.level<2?0:M.level<6?1:M.level===6?2:3)<<6,M.strstart!==0&&(ae|=32),ae+=31-ae%31,M.status=q,w(M,ae),M.strstart!==0&&(w(M,z.adler>>>16),w(M,65535&z.adler)),z.adler=1}if(M.status===69)if(M.gzhead.extra){for(Z=M.pending;M.gzindex<(65535&M.gzhead.extra.length)&&(M.pending!==M.pending_buf_size||(M.gzhead.hcrc&&M.pending>Z&&(z.adler=N(z.adler,M.pending_buf,M.pending-Z,Z)),O(z),Z=M.pending,M.pending!==M.pending_buf_size));)C(M,255&M.gzhead.extra[M.gzindex]),M.gzindex++;M.gzhead.hcrc&&M.pending>Z&&(z.adler=N(z.adler,M.pending_buf,M.pending-Z,Z)),M.gzindex===M.gzhead.extra.length&&(M.gzindex=0,M.status=73)}else M.status=73;if(M.status===73)if(M.gzhead.name){Z=M.pending;do{if(M.pending===M.pending_buf_size&&(M.gzhead.hcrc&&M.pending>Z&&(z.adler=N(z.adler,M.pending_buf,M.pending-Z,Z)),O(z),Z=M.pending,M.pending===M.pending_buf_size)){se=1;break}se=M.gzindex<M.gzhead.name.length?255&M.gzhead.name.charCodeAt(M.gzindex++):0,C(M,se)}while(se!==0);M.gzhead.hcrc&&M.pending>Z&&(z.adler=N(z.adler,M.pending_buf,M.pending-Z,Z)),se===0&&(M.gzindex=0,M.status=91)}else M.status=91;if(M.status===91)if(M.gzhead.comment){Z=M.pending;do{if(M.pending===M.pending_buf_size&&(M.gzhead.hcrc&&M.pending>Z&&(z.adler=N(z.adler,M.pending_buf,M.pending-Z,Z)),O(z),Z=M.pending,M.pending===M.pending_buf_size)){se=1;break}se=M.gzindex<M.gzhead.comment.length?255&M.gzhead.comment.charCodeAt(M.gzindex++):0,C(M,se)}while(se!==0);M.gzhead.hcrc&&M.pending>Z&&(z.adler=N(z.adler,M.pending_buf,M.pending-Z,Z)),se===0&&(M.status=103)}else M.status=103;if(M.status===103&&(M.gzhead.hcrc?(M.pending+2>M.pending_buf_size&&O(z),M.pending+2<=M.pending_buf_size&&(C(M,255&z.adler),C(M,z.adler>>8&255),z.adler=0,M.status=q)):M.status=q),M.pending!==0){if(O(z),z.avail_out===0)return M.last_flush=-1,0}else if(z.avail_in===0&&I(ee)<=I(L)&&ee!==4)return X(z,-5);if(M.status===666&&z.avail_in!==0)return X(z,-5);if(z.avail_in!==0||M.lookahead!==0||ee!==0&&M.status!==666){var ne=M.strategy===2?function(Q,fe){for(var le;;){if(Q.lookahead===0&&(A(Q),Q.lookahead===0)){if(fe===0)return 1;break}if(Q.match_length=0,le=y._tr_tally(Q,0,Q.window[Q.strstart]),Q.lookahead--,Q.strstart++,le&&(R(Q,!1),Q.strm.avail_out===0))return 1}return Q.insert=0,fe===4?(R(Q,!0),Q.strm.avail_out===0?3:4):Q.last_lit&&(R(Q,!1),Q.strm.avail_out===0)?1:2}(M,ee):M.strategy===3?function(Q,fe){for(var le,te,ce,he,Ee=Q.window;;){if(Q.lookahead<=W){if(A(Q),Q.lookahead<=W&&fe===0)return 1;if(Q.lookahead===0)break}if(Q.match_length=0,Q.lookahead>=3&&0<Q.strstart&&(te=Ee[ce=Q.strstart-1])===Ee[++ce]&&te===Ee[++ce]&&te===Ee[++ce]){he=Q.strstart+W;do;while(te===Ee[++ce]&&te===Ee[++ce]&&te===Ee[++ce]&&te===Ee[++ce]&&te===Ee[++ce]&&te===Ee[++ce]&&te===Ee[++ce]&&te===Ee[++ce]&&ce<he);Q.match_length=W-(he-ce),Q.match_length>Q.lookahead&&(Q.match_length=Q.lookahead)}if(Q.match_length>=3?(le=y._tr_tally(Q,1,Q.match_length-3),Q.lookahead-=Q.match_length,Q.strstart+=Q.match_length,Q.match_length=0):(le=y._tr_tally(Q,0,Q.window[Q.strstart]),Q.lookahead--,Q.strstart++),le&&(R(Q,!1),Q.strm.avail_out===0))return 1}return Q.insert=0,fe===4?(R(Q,!0),Q.strm.avail_out===0?3:4):Q.last_lit&&(R(Q,!1),Q.strm.avail_out===0)?1:2}(M,ee):g[M.level].func(M,ee);if(ne!==3&&ne!==4||(M.status=666),ne===1||ne===3)return z.avail_out===0&&(M.last_flush=-1),0;if(ne===2&&(ee===1?y._tr_align(M):ee!==5&&(y._tr_stored_block(M,0,0,!1),ee===3&&(H(M.head),M.lookahead===0&&(M.strstart=0,M.block_start=0,M.insert=0))),O(z),z.avail_out===0))return M.last_flush=-1,0}return ee!==4?0:M.wrap<=0?1:(M.wrap===2?(C(M,255&z.adler),C(M,z.adler>>8&255),C(M,z.adler>>16&255),C(M,z.adler>>24&255),C(M,255&z.total_in),C(M,z.total_in>>8&255),C(M,z.total_in>>16&255),C(M,z.total_in>>24&255)):(w(M,z.adler>>>16),w(M,65535&z.adler)),O(z),0<M.wrap&&(M.wrap=-M.wrap),M.pending!==0?0:1)},b.deflateEnd=function(z){var ee;return z&&z.state?(ee=z.state.status)!==42&&ee!==69&&ee!==73&&ee!==91&&ee!==103&&ee!==q&&ee!==666?X(z,B):(z.state=null,ee===q?X(z,-3):0):B},b.deflateSetDictionary=function(z,ee){var L,M,Z,se,ae,ne,Q,fe,le=ee.length;if(!z||!z.state||(se=(L=z.state).wrap)===2||se===1&&L.status!==42||L.lookahead)return B;for(se===1&&(z.adler=k(z.adler,ee,le,0)),L.wrap=0,le>=L.w_size&&(se===0&&(H(L.head),L.strstart=0,L.block_start=0,L.insert=0),fe=new x.Buf8(L.w_size),x.arraySet(fe,ee,le-L.w_size,L.w_size,0),ee=fe,le=L.w_size),ae=z.avail_in,ne=z.next_in,Q=z.input,z.avail_in=le,z.next_in=0,z.input=ee,A(L);L.lookahead>=3;){for(M=L.strstart,Z=L.lookahead-2;L.ins_h=(L.ins_h<<L.hash_shift^L.window[M+3-1])&L.hash_mask,L.prev[M&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=M,M++,--Z;);L.strstart=M,L.lookahead=2,A(L)}return L.strstart+=L.lookahead,L.block_start=L.strstart,L.insert=L.lookahead,L.lookahead=0,L.match_length=L.prev_length=2,L.match_available=0,z.next_in=ne,z.input=Q,z.avail_in=ae,L.wrap=se,0},b.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(h,v,b){v.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(h,v,b){v.exports=function(g,x){var y,k,N,F,B,W,V,q,X,I,H,O,R,C,w,E,A,T,D,U,P,K,Y,re,z;y=g.state,k=g.next_in,re=g.input,N=k+(g.avail_in-5),F=g.next_out,z=g.output,B=F-(x-g.avail_out),W=F+(g.avail_out-257),V=y.dmax,q=y.wsize,X=y.whave,I=y.wnext,H=y.window,O=y.hold,R=y.bits,C=y.lencode,w=y.distcode,E=(1<<y.lenbits)-1,A=(1<<y.distbits)-1;e:do{R<15&&(O+=re[k++]<<R,R+=8,O+=re[k++]<<R,R+=8),T=C[O&E];t:for(;;){if(O>>>=D=T>>>24,R-=D,(D=T>>>16&255)==0)z[F++]=65535&T;else{if(!(16&D)){if((64&D)==0){T=C[(65535&T)+(O&(1<<D)-1)];continue t}if(32&D){y.mode=12;break e}g.msg="invalid literal/length code",y.mode=30;break e}U=65535&T,(D&=15)&&(R<D&&(O+=re[k++]<<R,R+=8),U+=O&(1<<D)-1,O>>>=D,R-=D),R<15&&(O+=re[k++]<<R,R+=8,O+=re[k++]<<R,R+=8),T=w[O&A];r:for(;;){if(O>>>=D=T>>>24,R-=D,!(16&(D=T>>>16&255))){if((64&D)==0){T=w[(65535&T)+(O&(1<<D)-1)];continue r}g.msg="invalid distance code",y.mode=30;break e}if(P=65535&T,R<(D&=15)&&(O+=re[k++]<<R,(R+=8)<D&&(O+=re[k++]<<R,R+=8)),V<(P+=O&(1<<D)-1)){g.msg="invalid distance too far back",y.mode=30;break e}if(O>>>=D,R-=D,(D=F-B)<P){if(X<(D=P-D)&&y.sane){g.msg="invalid distance too far back",y.mode=30;break e}if(Y=H,(K=0)===I){if(K+=q-D,D<U){for(U-=D;z[F++]=H[K++],--D;);K=F-P,Y=z}}else if(I<D){if(K+=q+I-D,(D-=I)<U){for(U-=D;z[F++]=H[K++],--D;);if(K=0,I<U){for(U-=D=I;z[F++]=H[K++],--D;);K=F-P,Y=z}}}else if(K+=I-D,D<U){for(U-=D;z[F++]=H[K++],--D;);K=F-P,Y=z}for(;2<U;)z[F++]=Y[K++],z[F++]=Y[K++],z[F++]=Y[K++],U-=3;U&&(z[F++]=Y[K++],1<U&&(z[F++]=Y[K++]))}else{for(K=F-P;z[F++]=z[K++],z[F++]=z[K++],z[F++]=z[K++],2<(U-=3););U&&(z[F++]=z[K++],1<U&&(z[F++]=z[K++]))}break}}break}}while(k<N&&F<W);k-=U=R>>3,O&=(1<<(R-=U<<3))-1,g.next_in=k,g.next_out=F,g.avail_in=k<N?N-k+5:5-(k-N),g.avail_out=F<W?W-F+257:257-(F-W),y.hold=O,y.bits=R}},{}],49:[function(h,v,b){var g=h("../utils/common"),x=h("./adler32"),y=h("./crc32"),k=h("./inffast"),N=h("./inftrees"),F=-2;function B(E){return(E>>>24&255)+(E>>>8&65280)+((65280&E)<<8)+((255&E)<<24)}function W(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new g.Buf16(320),this.work=new g.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function V(E){var A;return E&&E.state?(A=E.state,E.total_in=E.total_out=A.total=0,E.msg="",A.wrap&&(E.adler=1&A.wrap),A.mode=1,A.last=0,A.havedict=0,A.dmax=32768,A.head=null,A.hold=0,A.bits=0,A.lencode=A.lendyn=new g.Buf32(852),A.distcode=A.distdyn=new g.Buf32(592),A.sane=1,A.back=-1,0):F}function q(E){var A;return E&&E.state?((A=E.state).wsize=0,A.whave=0,A.wnext=0,V(E)):F}function X(E,A){var T,D;return E&&E.state?(D=E.state,A<0?(T=0,A=-A):(T=1+(A>>4),A<48&&(A&=15)),A&&(A<8||15<A)?F:(D.window!==null&&D.wbits!==A&&(D.window=null),D.wrap=T,D.wbits=A,q(E))):F}function I(E,A){var T,D;return E?(D=new W,(E.state=D).window=null,(T=X(E,A))!==0&&(E.state=null),T):F}var H,O,R=!0;function C(E){if(R){var A;for(H=new g.Buf32(512),O=new g.Buf32(32),A=0;A<144;)E.lens[A++]=8;for(;A<256;)E.lens[A++]=9;for(;A<280;)E.lens[A++]=7;for(;A<288;)E.lens[A++]=8;for(N(1,E.lens,0,288,H,0,E.work,{bits:9}),A=0;A<32;)E.lens[A++]=5;N(2,E.lens,0,32,O,0,E.work,{bits:5}),R=!1}E.lencode=H,E.lenbits=9,E.distcode=O,E.distbits=5}function w(E,A,T,D){var U,P=E.state;return P.window===null&&(P.wsize=1<<P.wbits,P.wnext=0,P.whave=0,P.window=new g.Buf8(P.wsize)),D>=P.wsize?(g.arraySet(P.window,A,T-P.wsize,P.wsize,0),P.wnext=0,P.whave=P.wsize):(D<(U=P.wsize-P.wnext)&&(U=D),g.arraySet(P.window,A,T-D,U,P.wnext),(D-=U)?(g.arraySet(P.window,A,T-D,D,0),P.wnext=D,P.whave=P.wsize):(P.wnext+=U,P.wnext===P.wsize&&(P.wnext=0),P.whave<P.wsize&&(P.whave+=U))),0}b.inflateReset=q,b.inflateReset2=X,b.inflateResetKeep=V,b.inflateInit=function(E){return I(E,15)},b.inflateInit2=I,b.inflate=function(E,A){var T,D,U,P,K,Y,re,z,ee,L,M,Z,se,ae,ne,Q,fe,le,te,ce,he,Ee,ke,Ce,Fe=0,Pe=new g.Buf8(4),Xe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!E||!E.state||!E.output||!E.input&&E.avail_in!==0)return F;(T=E.state).mode===12&&(T.mode=13),K=E.next_out,U=E.output,re=E.avail_out,P=E.next_in,D=E.input,Y=E.avail_in,z=T.hold,ee=T.bits,L=Y,M=re,Ee=0;e:for(;;)switch(T.mode){case 1:if(T.wrap===0){T.mode=13;break}for(;ee<16;){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}if(2&T.wrap&&z===35615){Pe[T.check=0]=255&z,Pe[1]=z>>>8&255,T.check=y(T.check,Pe,2,0),ee=z=0,T.mode=2;break}if(T.flags=0,T.head&&(T.head.done=!1),!(1&T.wrap)||(((255&z)<<8)+(z>>8))%31){E.msg="incorrect header check",T.mode=30;break}if((15&z)!=8){E.msg="unknown compression method",T.mode=30;break}if(ee-=4,he=8+(15&(z>>>=4)),T.wbits===0)T.wbits=he;else if(he>T.wbits){E.msg="invalid window size",T.mode=30;break}T.dmax=1<<he,E.adler=T.check=1,T.mode=512&z?10:12,ee=z=0;break;case 2:for(;ee<16;){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}if(T.flags=z,(255&T.flags)!=8){E.msg="unknown compression method",T.mode=30;break}if(57344&T.flags){E.msg="unknown header flags set",T.mode=30;break}T.head&&(T.head.text=z>>8&1),512&T.flags&&(Pe[0]=255&z,Pe[1]=z>>>8&255,T.check=y(T.check,Pe,2,0)),ee=z=0,T.mode=3;case 3:for(;ee<32;){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}T.head&&(T.head.time=z),512&T.flags&&(Pe[0]=255&z,Pe[1]=z>>>8&255,Pe[2]=z>>>16&255,Pe[3]=z>>>24&255,T.check=y(T.check,Pe,4,0)),ee=z=0,T.mode=4;case 4:for(;ee<16;){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}T.head&&(T.head.xflags=255&z,T.head.os=z>>8),512&T.flags&&(Pe[0]=255&z,Pe[1]=z>>>8&255,T.check=y(T.check,Pe,2,0)),ee=z=0,T.mode=5;case 5:if(1024&T.flags){for(;ee<16;){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}T.length=z,T.head&&(T.head.extra_len=z),512&T.flags&&(Pe[0]=255&z,Pe[1]=z>>>8&255,T.check=y(T.check,Pe,2,0)),ee=z=0}else T.head&&(T.head.extra=null);T.mode=6;case 6:if(1024&T.flags&&(Y<(Z=T.length)&&(Z=Y),Z&&(T.head&&(he=T.head.extra_len-T.length,T.head.extra||(T.head.extra=new Array(T.head.extra_len)),g.arraySet(T.head.extra,D,P,Z,he)),512&T.flags&&(T.check=y(T.check,D,Z,P)),Y-=Z,P+=Z,T.length-=Z),T.length))break e;T.length=0,T.mode=7;case 7:if(2048&T.flags){if(Y===0)break e;for(Z=0;he=D[P+Z++],T.head&&he&&T.length<65536&&(T.head.name+=String.fromCharCode(he)),he&&Z<Y;);if(512&T.flags&&(T.check=y(T.check,D,Z,P)),Y-=Z,P+=Z,he)break e}else T.head&&(T.head.name=null);T.length=0,T.mode=8;case 8:if(4096&T.flags){if(Y===0)break e;for(Z=0;he=D[P+Z++],T.head&&he&&T.length<65536&&(T.head.comment+=String.fromCharCode(he)),he&&Z<Y;);if(512&T.flags&&(T.check=y(T.check,D,Z,P)),Y-=Z,P+=Z,he)break e}else T.head&&(T.head.comment=null);T.mode=9;case 9:if(512&T.flags){for(;ee<16;){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}if(z!==(65535&T.check)){E.msg="header crc mismatch",T.mode=30;break}ee=z=0}T.head&&(T.head.hcrc=T.flags>>9&1,T.head.done=!0),E.adler=T.check=0,T.mode=12;break;case 10:for(;ee<32;){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}E.adler=T.check=B(z),ee=z=0,T.mode=11;case 11:if(T.havedict===0)return E.next_out=K,E.avail_out=re,E.next_in=P,E.avail_in=Y,T.hold=z,T.bits=ee,2;E.adler=T.check=1,T.mode=12;case 12:if(A===5||A===6)break e;case 13:if(T.last){z>>>=7&ee,ee-=7&ee,T.mode=27;break}for(;ee<3;){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}switch(T.last=1&z,ee-=1,3&(z>>>=1)){case 0:T.mode=14;break;case 1:if(C(T),T.mode=20,A!==6)break;z>>>=2,ee-=2;break e;case 2:T.mode=17;break;case 3:E.msg="invalid block type",T.mode=30}z>>>=2,ee-=2;break;case 14:for(z>>>=7&ee,ee-=7&ee;ee<32;){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}if((65535&z)!=(z>>>16^65535)){E.msg="invalid stored block lengths",T.mode=30;break}if(T.length=65535&z,ee=z=0,T.mode=15,A===6)break e;case 15:T.mode=16;case 16:if(Z=T.length){if(Y<Z&&(Z=Y),re<Z&&(Z=re),Z===0)break e;g.arraySet(U,D,P,Z,K),Y-=Z,P+=Z,re-=Z,K+=Z,T.length-=Z;break}T.mode=12;break;case 17:for(;ee<14;){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}if(T.nlen=257+(31&z),z>>>=5,ee-=5,T.ndist=1+(31&z),z>>>=5,ee-=5,T.ncode=4+(15&z),z>>>=4,ee-=4,286<T.nlen||30<T.ndist){E.msg="too many length or distance symbols",T.mode=30;break}T.have=0,T.mode=18;case 18:for(;T.have<T.ncode;){for(;ee<3;){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}T.lens[Xe[T.have++]]=7&z,z>>>=3,ee-=3}for(;T.have<19;)T.lens[Xe[T.have++]]=0;if(T.lencode=T.lendyn,T.lenbits=7,ke={bits:T.lenbits},Ee=N(0,T.lens,0,19,T.lencode,0,T.work,ke),T.lenbits=ke.bits,Ee){E.msg="invalid code lengths set",T.mode=30;break}T.have=0,T.mode=19;case 19:for(;T.have<T.nlen+T.ndist;){for(;Q=(Fe=T.lencode[z&(1<<T.lenbits)-1])>>>16&255,fe=65535&Fe,!((ne=Fe>>>24)<=ee);){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}if(fe<16)z>>>=ne,ee-=ne,T.lens[T.have++]=fe;else{if(fe===16){for(Ce=ne+2;ee<Ce;){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}if(z>>>=ne,ee-=ne,T.have===0){E.msg="invalid bit length repeat",T.mode=30;break}he=T.lens[T.have-1],Z=3+(3&z),z>>>=2,ee-=2}else if(fe===17){for(Ce=ne+3;ee<Ce;){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}ee-=ne,he=0,Z=3+(7&(z>>>=ne)),z>>>=3,ee-=3}else{for(Ce=ne+7;ee<Ce;){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}ee-=ne,he=0,Z=11+(127&(z>>>=ne)),z>>>=7,ee-=7}if(T.have+Z>T.nlen+T.ndist){E.msg="invalid bit length repeat",T.mode=30;break}for(;Z--;)T.lens[T.have++]=he}}if(T.mode===30)break;if(T.lens[256]===0){E.msg="invalid code -- missing end-of-block",T.mode=30;break}if(T.lenbits=9,ke={bits:T.lenbits},Ee=N(1,T.lens,0,T.nlen,T.lencode,0,T.work,ke),T.lenbits=ke.bits,Ee){E.msg="invalid literal/lengths set",T.mode=30;break}if(T.distbits=6,T.distcode=T.distdyn,ke={bits:T.distbits},Ee=N(2,T.lens,T.nlen,T.ndist,T.distcode,0,T.work,ke),T.distbits=ke.bits,Ee){E.msg="invalid distances set",T.mode=30;break}if(T.mode=20,A===6)break e;case 20:T.mode=21;case 21:if(6<=Y&&258<=re){E.next_out=K,E.avail_out=re,E.next_in=P,E.avail_in=Y,T.hold=z,T.bits=ee,k(E,M),K=E.next_out,U=E.output,re=E.avail_out,P=E.next_in,D=E.input,Y=E.avail_in,z=T.hold,ee=T.bits,T.mode===12&&(T.back=-1);break}for(T.back=0;Q=(Fe=T.lencode[z&(1<<T.lenbits)-1])>>>16&255,fe=65535&Fe,!((ne=Fe>>>24)<=ee);){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}if(Q&&(240&Q)==0){for(le=ne,te=Q,ce=fe;Q=(Fe=T.lencode[ce+((z&(1<<le+te)-1)>>le)])>>>16&255,fe=65535&Fe,!(le+(ne=Fe>>>24)<=ee);){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}z>>>=le,ee-=le,T.back+=le}if(z>>>=ne,ee-=ne,T.back+=ne,T.length=fe,Q===0){T.mode=26;break}if(32&Q){T.back=-1,T.mode=12;break}if(64&Q){E.msg="invalid literal/length code",T.mode=30;break}T.extra=15&Q,T.mode=22;case 22:if(T.extra){for(Ce=T.extra;ee<Ce;){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}T.length+=z&(1<<T.extra)-1,z>>>=T.extra,ee-=T.extra,T.back+=T.extra}T.was=T.length,T.mode=23;case 23:for(;Q=(Fe=T.distcode[z&(1<<T.distbits)-1])>>>16&255,fe=65535&Fe,!((ne=Fe>>>24)<=ee);){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}if((240&Q)==0){for(le=ne,te=Q,ce=fe;Q=(Fe=T.distcode[ce+((z&(1<<le+te)-1)>>le)])>>>16&255,fe=65535&Fe,!(le+(ne=Fe>>>24)<=ee);){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}z>>>=le,ee-=le,T.back+=le}if(z>>>=ne,ee-=ne,T.back+=ne,64&Q){E.msg="invalid distance code",T.mode=30;break}T.offset=fe,T.extra=15&Q,T.mode=24;case 24:if(T.extra){for(Ce=T.extra;ee<Ce;){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}T.offset+=z&(1<<T.extra)-1,z>>>=T.extra,ee-=T.extra,T.back+=T.extra}if(T.offset>T.dmax){E.msg="invalid distance too far back",T.mode=30;break}T.mode=25;case 25:if(re===0)break e;if(Z=M-re,T.offset>Z){if((Z=T.offset-Z)>T.whave&&T.sane){E.msg="invalid distance too far back",T.mode=30;break}se=Z>T.wnext?(Z-=T.wnext,T.wsize-Z):T.wnext-Z,Z>T.length&&(Z=T.length),ae=T.window}else ae=U,se=K-T.offset,Z=T.length;for(re<Z&&(Z=re),re-=Z,T.length-=Z;U[K++]=ae[se++],--Z;);T.length===0&&(T.mode=21);break;case 26:if(re===0)break e;U[K++]=T.length,re--,T.mode=21;break;case 27:if(T.wrap){for(;ee<32;){if(Y===0)break e;Y--,z|=D[P++]<<ee,ee+=8}if(M-=re,E.total_out+=M,T.total+=M,M&&(E.adler=T.check=T.flags?y(T.check,U,M,K-M):x(T.check,U,M,K-M)),M=re,(T.flags?z:B(z))!==T.check){E.msg="incorrect data check",T.mode=30;break}ee=z=0}T.mode=28;case 28:if(T.wrap&&T.flags){for(;ee<32;){if(Y===0)break e;Y--,z+=D[P++]<<ee,ee+=8}if(z!==(4294967295&T.total)){E.msg="incorrect length check",T.mode=30;break}ee=z=0}T.mode=29;case 29:Ee=1;break e;case 30:Ee=-3;break e;case 31:return-4;case 32:default:return F}return E.next_out=K,E.avail_out=re,E.next_in=P,E.avail_in=Y,T.hold=z,T.bits=ee,(T.wsize||M!==E.avail_out&&T.mode<30&&(T.mode<27||A!==4))&&w(E,E.output,E.next_out,M-E.avail_out)?(T.mode=31,-4):(L-=E.avail_in,M-=E.avail_out,E.total_in+=L,E.total_out+=M,T.total+=M,T.wrap&&M&&(E.adler=T.check=T.flags?y(T.check,U,M,E.next_out-M):x(T.check,U,M,E.next_out-M)),E.data_type=T.bits+(T.last?64:0)+(T.mode===12?128:0)+(T.mode===20||T.mode===15?256:0),(L==0&&M===0||A===4)&&Ee===0&&(Ee=-5),Ee)},b.inflateEnd=function(E){if(!E||!E.state)return F;var A=E.state;return A.window&&(A.window=null),E.state=null,0},b.inflateGetHeader=function(E,A){var T;return E&&E.state?(2&(T=E.state).wrap)==0?F:((T.head=A).done=!1,0):F},b.inflateSetDictionary=function(E,A){var T,D=A.length;return E&&E.state?(T=E.state).wrap!==0&&T.mode!==11?F:T.mode===11&&x(1,A,D,0)!==T.check?-3:w(E,A,D,D)?(T.mode=31,-4):(T.havedict=1,0):F},b.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(h,v,b){var g=h("../utils/common"),x=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],y=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],k=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],N=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];v.exports=function(F,B,W,V,q,X,I,H){var O,R,C,w,E,A,T,D,U,P=H.bits,K=0,Y=0,re=0,z=0,ee=0,L=0,M=0,Z=0,se=0,ae=0,ne=null,Q=0,fe=new g.Buf16(16),le=new g.Buf16(16),te=null,ce=0;for(K=0;K<=15;K++)fe[K]=0;for(Y=0;Y<V;Y++)fe[B[W+Y]]++;for(ee=P,z=15;1<=z&&fe[z]===0;z--);if(z<ee&&(ee=z),z===0)return q[X++]=20971520,q[X++]=20971520,H.bits=1,0;for(re=1;re<z&&fe[re]===0;re++);for(ee<re&&(ee=re),K=Z=1;K<=15;K++)if(Z<<=1,(Z-=fe[K])<0)return-1;if(0<Z&&(F===0||z!==1))return-1;for(le[1]=0,K=1;K<15;K++)le[K+1]=le[K]+fe[K];for(Y=0;Y<V;Y++)B[W+Y]!==0&&(I[le[B[W+Y]]++]=Y);if(A=F===0?(ne=te=I,19):F===1?(ne=x,Q-=257,te=y,ce-=257,256):(ne=k,te=N,-1),K=re,E=X,M=Y=ae=0,C=-1,w=(se=1<<(L=ee))-1,F===1&&852<se||F===2&&592<se)return 1;for(;;){for(T=K-M,U=I[Y]<A?(D=0,I[Y]):I[Y]>A?(D=te[ce+I[Y]],ne[Q+I[Y]]):(D=96,0),O=1<<K-M,re=R=1<<L;q[E+(ae>>M)+(R-=O)]=T<<24|D<<16|U|0,R!==0;);for(O=1<<K-1;ae&O;)O>>=1;if(O!==0?(ae&=O-1,ae+=O):ae=0,Y++,--fe[K]==0){if(K===z)break;K=B[W+I[Y]]}if(ee<K&&(ae&w)!==C){for(M===0&&(M=ee),E+=re,Z=1<<(L=K-M);L+M<z&&!((Z-=fe[L+M])<=0);)L++,Z<<=1;if(se+=1<<L,F===1&&852<se||F===2&&592<se)return 1;q[C=ae&w]=ee<<24|L<<16|E-X|0}}return ae!==0&&(q[E+ae]=K-M<<24|64<<16|0),H.bits=ee,0}},{"../utils/common":41}],51:[function(h,v,b){v.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(h,v,b){var g=h("../utils/common");function x(te){for(var ce=te.length;0<=--ce;)te[ce]=0}var y=256,k=286,N=30,F=15,B=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],W=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],V=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=new Array(576);x(X);var I=new Array(60);x(I);var H=new Array(512);x(H);var O=new Array(256);x(O);var R=new Array(29);x(R);var C,w,E,A=new Array(N);function T(te,ce,he,Ee,ke){this.static_tree=te,this.extra_bits=ce,this.extra_base=he,this.elems=Ee,this.max_length=ke,this.has_stree=te&&te.length}function D(te,ce){this.dyn_tree=te,this.max_code=0,this.stat_desc=ce}function U(te){return te<256?H[te]:H[256+(te>>>7)]}function P(te,ce){te.pending_buf[te.pending++]=255&ce,te.pending_buf[te.pending++]=ce>>>8&255}function K(te,ce,he){te.bi_valid>16-he?(te.bi_buf|=ce<<te.bi_valid&65535,P(te,te.bi_buf),te.bi_buf=ce>>16-te.bi_valid,te.bi_valid+=he-16):(te.bi_buf|=ce<<te.bi_valid&65535,te.bi_valid+=he)}function Y(te,ce,he){K(te,he[2*ce],he[2*ce+1])}function re(te,ce){for(var he=0;he|=1&te,te>>>=1,he<<=1,0<--ce;);return he>>>1}function z(te,ce,he){var Ee,ke,Ce=new Array(16),Fe=0;for(Ee=1;Ee<=F;Ee++)Ce[Ee]=Fe=Fe+he[Ee-1]<<1;for(ke=0;ke<=ce;ke++){var Pe=te[2*ke+1];Pe!==0&&(te[2*ke]=re(Ce[Pe]++,Pe))}}function ee(te){var ce;for(ce=0;ce<k;ce++)te.dyn_ltree[2*ce]=0;for(ce=0;ce<N;ce++)te.dyn_dtree[2*ce]=0;for(ce=0;ce<19;ce++)te.bl_tree[2*ce]=0;te.dyn_ltree[512]=1,te.opt_len=te.static_len=0,te.last_lit=te.matches=0}function L(te){8<te.bi_valid?P(te,te.bi_buf):0<te.bi_valid&&(te.pending_buf[te.pending++]=te.bi_buf),te.bi_buf=0,te.bi_valid=0}function M(te,ce,he,Ee){var ke=2*ce,Ce=2*he;return te[ke]<te[Ce]||te[ke]===te[Ce]&&Ee[ce]<=Ee[he]}function Z(te,ce,he){for(var Ee=te.heap[he],ke=he<<1;ke<=te.heap_len&&(ke<te.heap_len&&M(ce,te.heap[ke+1],te.heap[ke],te.depth)&&ke++,!M(ce,Ee,te.heap[ke],te.depth));)te.heap[he]=te.heap[ke],he=ke,ke<<=1;te.heap[he]=Ee}function se(te,ce,he){var Ee,ke,Ce,Fe,Pe=0;if(te.last_lit!==0)for(;Ee=te.pending_buf[te.d_buf+2*Pe]<<8|te.pending_buf[te.d_buf+2*Pe+1],ke=te.pending_buf[te.l_buf+Pe],Pe++,Ee===0?Y(te,ke,ce):(Y(te,(Ce=O[ke])+y+1,ce),(Fe=B[Ce])!==0&&K(te,ke-=R[Ce],Fe),Y(te,Ce=U(--Ee),he),(Fe=W[Ce])!==0&&K(te,Ee-=A[Ce],Fe)),Pe<te.last_lit;);Y(te,256,ce)}function ae(te,ce){var he,Ee,ke,Ce=ce.dyn_tree,Fe=ce.stat_desc.static_tree,Pe=ce.stat_desc.has_stree,Xe=ce.stat_desc.elems,ct=-1;for(te.heap_len=0,te.heap_max=573,he=0;he<Xe;he++)Ce[2*he]!==0?(te.heap[++te.heap_len]=ct=he,te.depth[he]=0):Ce[2*he+1]=0;for(;te.heap_len<2;)Ce[2*(ke=te.heap[++te.heap_len]=ct<2?++ct:0)]=1,te.depth[ke]=0,te.opt_len--,Pe&&(te.static_len-=Fe[2*ke+1]);for(ce.max_code=ct,he=te.heap_len>>1;1<=he;he--)Z(te,Ce,he);for(ke=Xe;he=te.heap[1],te.heap[1]=te.heap[te.heap_len--],Z(te,Ce,1),Ee=te.heap[1],te.heap[--te.heap_max]=he,te.heap[--te.heap_max]=Ee,Ce[2*ke]=Ce[2*he]+Ce[2*Ee],te.depth[ke]=(te.depth[he]>=te.depth[Ee]?te.depth[he]:te.depth[Ee])+1,Ce[2*he+1]=Ce[2*Ee+1]=ke,te.heap[1]=ke++,Z(te,Ce,1),2<=te.heap_len;);te.heap[--te.heap_max]=te.heap[1],function(st,lt){var tt,ot,De,ht,rt,it,dt=lt.dyn_tree,wt=lt.max_code,gt=lt.stat_desc.static_tree,vt=lt.stat_desc.has_stree,Ve=lt.stat_desc.extra_bits,$e=lt.stat_desc.extra_base,xt=lt.stat_desc.max_length,nt=0;for(ht=0;ht<=F;ht++)st.bl_count[ht]=0;for(dt[2*st.heap[st.heap_max]+1]=0,tt=st.heap_max+1;tt<573;tt++)xt<(ht=dt[2*dt[2*(ot=st.heap[tt])+1]+1]+1)&&(ht=xt,nt++),dt[2*ot+1]=ht,wt<ot||(st.bl_count[ht]++,rt=0,$e<=ot&&(rt=Ve[ot-$e]),it=dt[2*ot],st.opt_len+=it*(ht+rt),vt&&(st.static_len+=it*(gt[2*ot+1]+rt)));if(nt!==0){do{for(ht=xt-1;st.bl_count[ht]===0;)ht--;st.bl_count[ht]--,st.bl_count[ht+1]+=2,st.bl_count[xt]--,nt-=2}while(0<nt);for(ht=xt;ht!==0;ht--)for(ot=st.bl_count[ht];ot!==0;)wt<(De=st.heap[--tt])||(dt[2*De+1]!==ht&&(st.opt_len+=(ht-dt[2*De+1])*dt[2*De],dt[2*De+1]=ht),ot--)}}(te,ce),z(Ce,ct,te.bl_count)}function ne(te,ce,he){var Ee,ke,Ce=-1,Fe=ce[1],Pe=0,Xe=7,ct=4;for(Fe===0&&(Xe=138,ct=3),ce[2*(he+1)+1]=65535,Ee=0;Ee<=he;Ee++)ke=Fe,Fe=ce[2*(Ee+1)+1],++Pe<Xe&&ke===Fe||(Pe<ct?te.bl_tree[2*ke]+=Pe:ke!==0?(ke!==Ce&&te.bl_tree[2*ke]++,te.bl_tree[32]++):Pe<=10?te.bl_tree[34]++:te.bl_tree[36]++,Ce=ke,ct=(Pe=0)===Fe?(Xe=138,3):ke===Fe?(Xe=6,3):(Xe=7,4))}function Q(te,ce,he){var Ee,ke,Ce=-1,Fe=ce[1],Pe=0,Xe=7,ct=4;for(Fe===0&&(Xe=138,ct=3),Ee=0;Ee<=he;Ee++)if(ke=Fe,Fe=ce[2*(Ee+1)+1],!(++Pe<Xe&&ke===Fe)){if(Pe<ct)for(;Y(te,ke,te.bl_tree),--Pe!=0;);else ke!==0?(ke!==Ce&&(Y(te,ke,te.bl_tree),Pe--),Y(te,16,te.bl_tree),K(te,Pe-3,2)):Pe<=10?(Y(te,17,te.bl_tree),K(te,Pe-3,3)):(Y(te,18,te.bl_tree),K(te,Pe-11,7));Ce=ke,ct=(Pe=0)===Fe?(Xe=138,3):ke===Fe?(Xe=6,3):(Xe=7,4)}}x(A);var fe=!1;function le(te,ce,he,Ee){K(te,0+(Ee?1:0),3),function(ke,Ce,Fe,Pe){L(ke),P(ke,Fe),P(ke,~Fe),g.arraySet(ke.pending_buf,ke.window,Ce,Fe,ke.pending),ke.pending+=Fe}(te,ce,he)}b._tr_init=function(te){fe||(function(){var ce,he,Ee,ke,Ce,Fe=new Array(16);for(ke=Ee=0;ke<28;ke++)for(R[ke]=Ee,ce=0;ce<1<<B[ke];ce++)O[Ee++]=ke;for(O[Ee-1]=ke,ke=Ce=0;ke<16;ke++)for(A[ke]=Ce,ce=0;ce<1<<W[ke];ce++)H[Ce++]=ke;for(Ce>>=7;ke<N;ke++)for(A[ke]=Ce<<7,ce=0;ce<1<<W[ke]-7;ce++)H[256+Ce++]=ke;for(he=0;he<=F;he++)Fe[he]=0;for(ce=0;ce<=143;)X[2*ce+1]=8,ce++,Fe[8]++;for(;ce<=255;)X[2*ce+1]=9,ce++,Fe[9]++;for(;ce<=279;)X[2*ce+1]=7,ce++,Fe[7]++;for(;ce<=287;)X[2*ce+1]=8,ce++,Fe[8]++;for(z(X,287,Fe),ce=0;ce<N;ce++)I[2*ce+1]=5,I[2*ce]=re(ce,5);C=new T(X,B,257,k,F),w=new T(I,W,0,N,F),E=new T(new Array(0),V,0,19,7)}(),fe=!0),te.l_desc=new D(te.dyn_ltree,C),te.d_desc=new D(te.dyn_dtree,w),te.bl_desc=new D(te.bl_tree,E),te.bi_buf=0,te.bi_valid=0,ee(te)},b._tr_stored_block=le,b._tr_flush_block=function(te,ce,he,Ee){var ke,Ce,Fe=0;0<te.level?(te.strm.data_type===2&&(te.strm.data_type=function(Pe){var Xe,ct=4093624447;for(Xe=0;Xe<=31;Xe++,ct>>>=1)if(1&ct&&Pe.dyn_ltree[2*Xe]!==0)return 0;if(Pe.dyn_ltree[18]!==0||Pe.dyn_ltree[20]!==0||Pe.dyn_ltree[26]!==0)return 1;for(Xe=32;Xe<y;Xe++)if(Pe.dyn_ltree[2*Xe]!==0)return 1;return 0}(te)),ae(te,te.l_desc),ae(te,te.d_desc),Fe=function(Pe){var Xe;for(ne(Pe,Pe.dyn_ltree,Pe.l_desc.max_code),ne(Pe,Pe.dyn_dtree,Pe.d_desc.max_code),ae(Pe,Pe.bl_desc),Xe=18;3<=Xe&&Pe.bl_tree[2*q[Xe]+1]===0;Xe--);return Pe.opt_len+=3*(Xe+1)+5+5+4,Xe}(te),ke=te.opt_len+3+7>>>3,(Ce=te.static_len+3+7>>>3)<=ke&&(ke=Ce)):ke=Ce=he+5,he+4<=ke&&ce!==-1?le(te,ce,he,Ee):te.strategy===4||Ce===ke?(K(te,2+(Ee?1:0),3),se(te,X,I)):(K(te,4+(Ee?1:0),3),function(Pe,Xe,ct,st){var lt;for(K(Pe,Xe-257,5),K(Pe,ct-1,5),K(Pe,st-4,4),lt=0;lt<st;lt++)K(Pe,Pe.bl_tree[2*q[lt]+1],3);Q(Pe,Pe.dyn_ltree,Xe-1),Q(Pe,Pe.dyn_dtree,ct-1)}(te,te.l_desc.max_code+1,te.d_desc.max_code+1,Fe+1),se(te,te.dyn_ltree,te.dyn_dtree)),ee(te),Ee&&L(te)},b._tr_tally=function(te,ce,he){return te.pending_buf[te.d_buf+2*te.last_lit]=ce>>>8&255,te.pending_buf[te.d_buf+2*te.last_lit+1]=255&ce,te.pending_buf[te.l_buf+te.last_lit]=255&he,te.last_lit++,ce===0?te.dyn_ltree[2*he]++:(te.matches++,ce--,te.dyn_ltree[2*(O[he]+y+1)]++,te.dyn_dtree[2*U(ce)]++),te.last_lit===te.lit_bufsize-1},b._tr_align=function(te){K(te,2,3),Y(te,256,X),function(ce){ce.bi_valid===16?(P(ce,ce.bi_buf),ce.bi_buf=0,ce.bi_valid=0):8<=ce.bi_valid&&(ce.pending_buf[ce.pending++]=255&ce.bi_buf,ce.bi_buf>>=8,ce.bi_valid-=8)}(te)}},{"../utils/common":41}],53:[function(h,v,b){v.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(h,v,b){(function(g){(function(x,y){if(!x.setImmediate){var k,N,F,B,W=1,V={},q=!1,X=x.document,I=Object.getPrototypeOf&&Object.getPrototypeOf(x);I=I&&I.setTimeout?I:x,k={}.toString.call(x.process)==="[object process]"?function(C){o.nextTick(function(){O(C)})}:function(){if(x.postMessage&&!x.importScripts){var C=!0,w=x.onmessage;return x.onmessage=function(){C=!1},x.postMessage("","*"),x.onmessage=w,C}}()?(B="setImmediate$"+Math.random()+"$",x.addEventListener?x.addEventListener("message",R,!1):x.attachEvent("onmessage",R),function(C){x.postMessage(B+C,"*")}):x.MessageChannel?((F=new MessageChannel).port1.onmessage=function(C){O(C.data)},function(C){F.port2.postMessage(C)}):X&&"onreadystatechange"in X.createElement("script")?(N=X.documentElement,function(C){var w=X.createElement("script");w.onreadystatechange=function(){O(C),w.onreadystatechange=null,N.removeChild(w),w=null},N.appendChild(w)}):function(C){setTimeout(O,0,C)},I.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var w=new Array(arguments.length-1),E=0;E<w.length;E++)w[E]=arguments[E+1];var A={callback:C,args:w};return V[W]=A,k(W),W++},I.clearImmediate=H}function H(C){delete V[C]}function O(C){if(q)setTimeout(O,0,C);else{var w=V[C];if(w){q=!0;try{(function(E){var A=E.callback,T=E.args;switch(T.length){case 0:A();break;case 1:A(T[0]);break;case 2:A(T[0],T[1]);break;case 3:A(T[0],T[1],T[2]);break;default:A.apply(void 0,T)}})(w)}finally{H(C),q=!1}}}}function R(C){C.source===x&&typeof C.data=="string"&&C.data.indexOf(B)===0&&O(+C.data.slice(B.length))}})(typeof self>"u"?g===void 0?this:g:self)}).call(this,s!==void 0?s:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],e("timers").setImmediate)},{_process:467,buffer:220,timers:523}],442:[function(e,n,a){(function(o){(function(){var s=/[\\^$.*+?()[\]{}|]/g,l=RegExp(s.source),c=typeof o=="object"&&o&&o.Object===Object&&o,i=typeof self=="object"&&self&&self.Object===Object&&self,u=c||i||Function("return this")(),p=Object.prototype.toString,f=u.Symbol,h=f?f.prototype:void 0,v=h?h.toString:void 0;function b(g){if(typeof g=="string")return g;if(function(y){return typeof y=="symbol"||function(k){return!!k&&typeof k=="object"}(y)&&p.call(y)=="[object Symbol]"}(g))return v?v.call(g):"";var x=g+"";return x=="0"&&1/g==-1/0?"-0":x}n.exports=function(g){var x;return(g=(x=g)==null?"":b(x))&&l.test(g)?g.replace(s,"\\$&"):g}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],443:[function(e,n,a){(function(o){(function(){var s="[object Arguments]",l="[object Map]",c="[object Object]",i="[object Set]",u=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,p=/^\w*$/,f=/^\./,h=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,v=/\\(\\)?/g,b=/^\[object .+?Constructor\]$/,g=/^(?:0|[1-9]\d*)$/,x={};x["[object Float32Array]"]=x["[object Float64Array]"]=x["[object Int8Array]"]=x["[object Int16Array]"]=x["[object Int32Array]"]=x["[object Uint8Array]"]=x["[object Uint8ClampedArray]"]=x["[object Uint16Array]"]=x["[object Uint32Array]"]=!0,x[s]=x["[object Array]"]=x["[object ArrayBuffer]"]=x["[object Boolean]"]=x["[object DataView]"]=x["[object Date]"]=x["[object Error]"]=x["[object Function]"]=x[l]=x["[object Number]"]=x[c]=x["[object RegExp]"]=x[i]=x["[object String]"]=x["[object WeakMap]"]=!1;var y=typeof o=="object"&&o&&o.Object===Object&&o,k=typeof self=="object"&&self&&self.Object===Object&&self,N=y||k||Function("return this")(),F=typeof a=="object"&&a&&!a.nodeType&&a,B=F&&typeof n=="object"&&n&&!n.nodeType&&n,W=B&&B.exports===F&&y.process,V=function(){try{return W&&W.binding("util")}catch{}}(),q=V&&V.isTypedArray;function X(ue,Ae,pe,xe){for(var We=-1,qe=ue?ue.length:0;++We<qe;){var ut=ue[We];Ae(xe,ut,pe(ut),ue)}return xe}function I(ue,Ae){for(var pe=-1,xe=ue?ue.length:0;++pe<xe;)if(Ae(ue[pe],pe,ue))return!0;return!1}function H(ue){var Ae=!1;if(ue!=null&&typeof ue.toString!="function")try{Ae=!!(ue+"")}catch{}return Ae}function O(ue){var Ae=-1,pe=Array(ue.size);return ue.forEach(function(xe,We){pe[++Ae]=[We,xe]}),pe}function R(ue){var Ae=-1,pe=Array(ue.size);return ue.forEach(function(xe){pe[++Ae]=xe}),pe}var C,w,E,A=Array.prototype,T=Function.prototype,D=Object.prototype,U=N["__core-js_shared__"],P=(C=/[^.]+$/.exec(U&&U.keys&&U.keys.IE_PROTO||""))?"Symbol(src)_1."+C:"",K=T.toString,Y=D.hasOwnProperty,re=D.toString,z=RegExp("^"+K.call(Y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ee=N.Symbol,L=N.Uint8Array,M=D.propertyIsEnumerable,Z=A.splice,se=(w=Object.keys,E=Object,function(ue){return w(E(ue))}),ae=Qe(N,"DataView"),ne=Qe(N,"Map"),Q=Qe(N,"Promise"),fe=Qe(N,"Set"),le=Qe(N,"WeakMap"),te=Qe(Object,"create"),ce=Le(ae),he=Le(ne),Ee=Le(Q),ke=Le(fe),Ce=Le(le),Fe=ee?ee.prototype:void 0,Pe=Fe?Fe.valueOf:void 0,Xe=Fe?Fe.toString:void 0;function ct(ue){var Ae=-1,pe=ue?ue.length:0;for(this.clear();++Ae<pe;){var xe=ue[Ae];this.set(xe[0],xe[1])}}function st(ue){var Ae=-1,pe=ue?ue.length:0;for(this.clear();++Ae<pe;){var xe=ue[Ae];this.set(xe[0],xe[1])}}function lt(ue){var Ae=-1,pe=ue?ue.length:0;for(this.clear();++Ae<pe;){var xe=ue[Ae];this.set(xe[0],xe[1])}}function tt(ue){var Ae=-1,pe=ue?ue.length:0;for(this.__data__=new lt;++Ae<pe;)this.add(ue[Ae])}function ot(ue){this.__data__=new st(ue)}function De(ue,Ae){var pe=ve(ue)||ge(ue)?function(ut,Mt){for(var Bt=-1,Ht=Array(ut);++Bt<ut;)Ht[Bt]=Mt(Bt);return Ht}(ue.length,String):[],xe=pe.length,We=!!xe;for(var qe in ue)!Y.call(ue,qe)||We&&(qe=="length"||Vt(qe,xe))||pe.push(qe);return pe}function ht(ue,Ae){for(var pe=ue.length;pe--;)if(de(ue[pe][0],Ae))return pe;return-1}function rt(ue,Ae,pe,xe){return dt(ue,function(We,qe,ut){Ae(xe,We,pe(We),ut)}),xe}ct.prototype.clear=function(){this.__data__=te?te(null):{}},ct.prototype.delete=function(ue){return this.has(ue)&&delete this.__data__[ue]},ct.prototype.get=function(ue){var Ae=this.__data__;if(te){var pe=Ae[ue];return pe==="__lodash_hash_undefined__"?void 0:pe}return Y.call(Ae,ue)?Ae[ue]:void 0},ct.prototype.has=function(ue){var Ae=this.__data__;return te?Ae[ue]!==void 0:Y.call(Ae,ue)},ct.prototype.set=function(ue,Ae){return this.__data__[ue]=te&&Ae===void 0?"__lodash_hash_undefined__":Ae,this},st.prototype.clear=function(){this.__data__=[]},st.prototype.delete=function(ue){var Ae=this.__data__,pe=ht(Ae,ue);return!(pe<0)&&(pe==Ae.length-1?Ae.pop():Z.call(Ae,pe,1),!0)},st.prototype.get=function(ue){var Ae=this.__data__,pe=ht(Ae,ue);return pe<0?void 0:Ae[pe][1]},st.prototype.has=function(ue){return ht(this.__data__,ue)>-1},st.prototype.set=function(ue,Ae){var pe=this.__data__,xe=ht(pe,ue);return xe<0?pe.push([ue,Ae]):pe[xe][1]=Ae,this},lt.prototype.clear=function(){this.__data__={hash:new ct,map:new(ne||st),string:new ct}},lt.prototype.delete=function(ue){return je(this,ue).delete(ue)},lt.prototype.get=function(ue){return je(this,ue).get(ue)},lt.prototype.has=function(ue){return je(this,ue).has(ue)},lt.prototype.set=function(ue,Ae){return je(this,ue).set(ue,Ae),this},tt.prototype.add=tt.prototype.push=function(ue){return this.__data__.set(ue,"__lodash_hash_undefined__"),this},tt.prototype.has=function(ue){return this.__data__.has(ue)},ot.prototype.clear=function(){this.__data__=new st},ot.prototype.delete=function(ue){return this.__data__.delete(ue)},ot.prototype.get=function(ue){return this.__data__.get(ue)},ot.prototype.has=function(ue){return this.__data__.has(ue)},ot.prototype.set=function(ue,Ae){var pe=this.__data__;if(pe instanceof st){var xe=pe.__data__;if(!ne||xe.length<199)return xe.push([ue,Ae]),this;pe=this.__data__=new lt(xe)}return pe.set(ue,Ae),this};var it,dt=(it=function(ue,Ae){return ue&&wt(ue,Ae,Te)},function(ue,Ae){if(ue==null)return ue;if(!ye(ue))return it(ue,Ae);for(var pe=ue.length,xe=-1,We=Object(ue);++xe<pe&&Ae(We[xe],xe,We)!==!1;);return ue}),wt=function(ue){return function(Ae,pe,xe){for(var We=-1,qe=Object(Ae),ut=xe(Ae),Mt=ut.length;Mt--;){var Bt=ut[++We];if(pe(qe[Bt],Bt,qe)===!1)break}return Ae}}();function gt(ue,Ae){for(var pe=0,xe=(Ae=yt(Ae,ue)?[Ae]:pt(Ae)).length;ue!=null&&pe<xe;)ue=ue[Ne(Ae[pe++])];return pe&&pe==xe?ue:void 0}function vt(ue,Ae){return ue!=null&&Ae in Object(ue)}function Ve(ue,Ae,pe,xe,We){return ue===Ae||(ue==null||Ae==null||!Re(ue)&&!Be(Ae)?ue!=ue&&Ae!=Ae:function(qe,ut,Mt,Bt,Ht,Lt){var er=ve(qe),gr=ve(ut),tr="[object Array]",Rr="[object Array]";er||(tr=(tr=At(qe))==s?c:tr),gr||(Rr=(Rr=At(ut))==s?c:Rr);var en=tr==c&&!H(qe),tn=Rr==c&&!H(ut),ra=tr==Rr;if(ra&&!en)return Lt||(Lt=new ot),er||be(qe)?Se(qe,ut,Mt,Bt,Ht,Lt):function(vr,ir,Gn,fs,ao,rn,Wa){switch(Gn){case"[object DataView]":if(vr.byteLength!=ir.byteLength||vr.byteOffset!=ir.byteOffset)return!1;vr=vr.buffer,ir=ir.buffer;case"[object ArrayBuffer]":return!(vr.byteLength!=ir.byteLength||!fs(new L(vr),new L(ir)));case"[object Boolean]":case"[object Date]":case"[object Number]":return de(+vr,+ir);case"[object Error]":return vr.name==ir.name&&vr.message==ir.message;case"[object RegExp]":case"[object String]":return vr==ir+"";case l:var Ga=O;case i:var di=2&rn;if(Ga||(Ga=R),vr.size!=ir.size&&!di)return!1;var fi=Wa.get(vr);if(fi)return fi==ir;rn|=1,Wa.set(vr,ir);var hi=Se(Ga(vr),Ga(ir),fs,ao,rn,Wa);return Wa.delete(vr),hi;case"[object Symbol]":if(Pe)return Pe.call(vr)==Pe.call(ir)}return!1}(qe,ut,tr,Mt,Bt,Ht,Lt);if(!(2&Ht)){var Aa=en&&Y.call(qe,"__wrapped__"),ui=tn&&Y.call(ut,"__wrapped__");if(Aa||ui){var hn=Aa?qe.value():qe,ds=ui?ut.value():ut;return Lt||(Lt=new ot),Mt(hn,ds,Bt,Ht,Lt)}}return ra?(Lt||(Lt=new ot),function(vr,ir,Gn,fs,ao,rn){var Wa=2&ao,Ga=Te(vr),di=Ga.length,fi=Te(ir).length;if(di!=fi&&!Wa)return!1;for(var hi=di;hi--;){var hs=Ga[hi];if(!(Wa?hs in ir:Y.call(ir,hs)))return!1}var so=rn.get(vr);if(so&&rn.get(ir))return so==ir;var pi=!0;rn.set(vr,ir),rn.set(ir,vr);for(var io=Wa;++hi<di;){hs=Ga[hi];var Ya=vr[hs],Xa=ir[hs];if(fs)var sc=Wa?fs(Xa,Ya,hs,ir,vr,rn):fs(Ya,Xa,hs,vr,ir,rn);if(!(sc===void 0?Ya===Xa||Gn(Ya,Xa,fs,ao,rn):sc)){pi=!1;break}io||(io=hs=="constructor")}if(pi&&!io){var mi=vr.constructor,oo=ir.constructor;mi==oo||!("constructor"in vr)||!("constructor"in ir)||typeof mi=="function"&&mi instanceof mi&&typeof oo=="function"&&oo instanceof oo||(pi=!1)}return rn.delete(vr),rn.delete(ir),pi}(qe,ut,Mt,Bt,Ht,Lt)):!1}(ue,Ae,Ve,pe,xe,We))}function $e(ue){return!(!Re(ue)||function(Ae){return!!P&&P in Ae}(ue))&&(Me(ue)||H(ue)?z:b).test(Le(ue))}function xt(ue){return typeof ue=="function"?ue:ue==null?Ge:typeof ue=="object"?ve(ue)?function(xe,We){return yt(xe)&&Ct(We)?It(Ne(xe),We):function(qe){var ut=function(Mt,Bt,Ht){var Lt=Mt==null?void 0:gt(Mt,Bt);return Lt===void 0?Ht:Lt}(qe,xe);return ut===void 0&&ut===We?function(Mt,Bt){return Mt!=null&&function(Ht,Lt,er){Lt=yt(Lt,Ht)?[Lt]:pt(Lt);for(var gr,tr=-1,Rr=Lt.length;++tr<Rr;){var en=Ne(Lt[tr]);if(!(gr=Ht!=null&&er(Ht,en)))break;Ht=Ht[en]}return gr||!!(Rr=Ht?Ht.length:0)&&Ue(Rr)&&Vt(en,Rr)&&(ve(Ht)||ge(Ht))}(Mt,Bt,vt)}(qe,xe):Ve(We,ut,void 0,3)}}(ue[0],ue[1]):function(xe){var We=function(qe){for(var ut=Te(qe),Mt=ut.length;Mt--;){var Bt=ut[Mt],Ht=qe[Bt];ut[Mt]=[Bt,Ht,Ct(Ht)]}return ut}(xe);return We.length==1&&We[0][2]?It(We[0][0],We[0][1]):function(qe){return qe===xe||function(ut,Mt,Bt,Ht){var Lt=Bt.length,er=Lt;if(ut==null)return!er;for(ut=Object(ut);Lt--;){var gr=Bt[Lt];if(gr[2]?gr[1]!==ut[gr[0]]:!(gr[0]in ut))return!1}for(;++Lt<er;){var tr=(gr=Bt[Lt])[0],Rr=ut[tr],en=gr[1];if(gr[2]){if(Rr===void 0&&!(tr in ut))return!1}else{var tn=new ot,ra;if(!(ra===void 0?Ve(en,Rr,Ht,3,tn):ra))return!1}}return!0}(qe,xe,We)}}(ue):yt(Ae=ue)?(pe=Ne(Ae),function(xe){return xe==null?void 0:xe[pe]}):function(xe){return function(We){return gt(We,xe)}}(Ae);var Ae,pe}function nt(ue){if(pe=(Ae=ue)&&Ae.constructor,xe=typeof pe=="function"&&pe.prototype||D,Ae!==xe)return se(ue);var Ae,pe,xe,We=[];for(var qe in Object(ue))Y.call(ue,qe)&&qe!="constructor"&&We.push(qe);return We}function pt(ue){return ve(ue)?ue:kt(ue)}function Se(ue,Ae,pe,xe,We,qe){var ut=2&We,Mt=ue.length,Bt=Ae.length;if(Mt!=Bt&&!(ut&&Bt>Mt))return!1;var Ht=qe.get(ue);if(Ht&&qe.get(Ae))return Ht==Ae;var Lt=-1,er=!0,gr=1&We?new tt:void 0;for(qe.set(ue,Ae),qe.set(Ae,ue);++Lt<Mt;){var tr=ue[Lt],Rr=Ae[Lt];if(xe)var en=ut?xe(Rr,tr,Lt,Ae,ue,qe):xe(tr,Rr,Lt,ue,Ae,qe);if(en!==void 0){if(en)continue;er=!1;break}if(gr){if(!I(Ae,function(tn,ra){if(!gr.has(ra)&&(tr===tn||pe(tr,tn,xe,We,qe)))return gr.add(ra)})){er=!1;break}}else if(tr!==Rr&&!pe(tr,Rr,xe,We,qe)){er=!1;break}}return qe.delete(ue),qe.delete(Ae),er}function je(ue,Ae){var pe,xe,We=ue.__data__;return((xe=typeof(pe=Ae))=="string"||xe=="number"||xe=="symbol"||xe=="boolean"?pe!=="__proto__":pe===null)?We[typeof Ae=="string"?"string":"hash"]:We.map}function Qe(ue,Ae){var pe=function(xe,We){return xe==null?void 0:xe[We]}(ue,Ae);return $e(pe)?pe:void 0}var At=function(ue){return re.call(ue)};function Vt(ue,Ae){return!!(Ae=Ae??9007199254740991)&&(typeof ue=="number"||g.test(ue))&&ue>-1&&ue%1==0&&ue<Ae}function yt(ue,Ae){if(ve(ue))return!1;var pe=typeof ue;return!(pe!="number"&&pe!="symbol"&&pe!="boolean"&&ue!=null&&!ze(ue))||p.test(ue)||!u.test(ue)||Ae!=null&&ue in Object(Ae)}function Ct(ue){return ue==ue&&!Re(ue)}function It(ue,Ae){return function(pe){return pe!=null&&pe[ue]===Ae&&(Ae!==void 0||ue in Object(pe))}}(ae&&At(new ae(new ArrayBuffer(1)))!="[object DataView]"||ne&&At(new ne)!=l||Q&&At(Q.resolve())!="[object Promise]"||fe&&At(new fe)!=i||le&&At(new le)!="[object WeakMap]")&&(At=function(ue){var Ae=re.call(ue),pe=Ae==c?ue.constructor:void 0,xe=pe?Le(pe):void 0;if(xe)switch(xe){case ce:return"[object DataView]";case he:return l;case Ee:return"[object Promise]";case ke:return i;case Ce:return"[object WeakMap]"}return Ae});var kt=we(function(ue){var Ae;ue=(Ae=ue)==null?"":function(xe){if(typeof xe=="string")return xe;if(ze(xe))return Xe?Xe.call(xe):"";var We=xe+"";return We=="0"&&1/xe==-1/0?"-0":We}(Ae);var pe=[];return f.test(ue)&&pe.push(""),ue.replace(h,function(xe,We,qe,ut){pe.push(qe?ut.replace(v,"$1"):We||xe)}),pe});function Ne(ue){if(typeof ue=="string"||ze(ue))return ue;var Ae=ue+"";return Ae=="0"&&1/ue==-1/0?"-0":Ae}function Le(ue){if(ue!=null){try{return K.call(ue)}catch{}try{return ue+""}catch{}}return""}var at,ie=(at=function(ue,Ae,pe){Y.call(ue,pe)?ue[pe].push(Ae):ue[pe]=[Ae]},function(ue,Ae){var pe=ve(ue)?X:rt,xe={};return pe(ue,at,xt(Ae),xe)});function we(ue,Ae){if(typeof ue!="function"||Ae&&typeof Ae!="function")throw new TypeError("Expected a function");var pe=function(){var xe=arguments,We=Ae?Ae.apply(this,xe):xe[0],qe=pe.cache;if(qe.has(We))return qe.get(We);var ut=ue.apply(this,xe);return pe.cache=qe.set(We,ut),ut};return pe.cache=new(we.Cache||lt),pe}function de(ue,Ae){return ue===Ae||ue!=ue&&Ae!=Ae}function ge(ue){return function(Ae){return Be(Ae)&&ye(Ae)}(ue)&&Y.call(ue,"callee")&&(!M.call(ue,"callee")||re.call(ue)==s)}we.Cache=lt;var ve=Array.isArray;function ye(ue){return ue!=null&&Ue(ue.length)&&!Me(ue)}function Me(ue){var Ae=Re(ue)?re.call(ue):"";return Ae=="[object Function]"||Ae=="[object GeneratorFunction]"}function Ue(ue){return typeof ue=="number"&&ue>-1&&ue%1==0&&ue<=9007199254740991}function Re(ue){var Ae=typeof ue;return!!ue&&(Ae=="object"||Ae=="function")}function Be(ue){return!!ue&&typeof ue=="object"}function ze(ue){return typeof ue=="symbol"||Be(ue)&&re.call(ue)=="[object Symbol]"}var be=q?function(ue){return function(Ae){return ue(Ae)}}(q):function(ue){return Be(ue)&&Ue(ue.length)&&!!x[re.call(ue)]};function Te(ue){return ye(ue)?De(ue):nt(ue)}function Ge(ue){return ue}n.exports=ie}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],444:[function(e,n,a){var o=Object.prototype.toString;n.exports=function(s){return s===!0||s===!1||function(l){return!!l&&typeof l=="object"}(s)&&o.call(s)=="[object Boolean]"}},{}],445:[function(e,n,a){(function(o){(function(){var s="[object Arguments]",l="[object Map]",c="[object Object]",i="[object Set]",u=/^\[object .+?Constructor\]$/,p=/^(?:0|[1-9]\d*)$/,f={};f["[object Float32Array]"]=f["[object Float64Array]"]=f["[object Int8Array]"]=f["[object Int16Array]"]=f["[object Int32Array]"]=f["[object Uint8Array]"]=f["[object Uint8ClampedArray]"]=f["[object Uint16Array]"]=f["[object Uint32Array]"]=!0,f[s]=f["[object Array]"]=f["[object ArrayBuffer]"]=f["[object Boolean]"]=f["[object DataView]"]=f["[object Date]"]=f["[object Error]"]=f["[object Function]"]=f[l]=f["[object Number]"]=f[c]=f["[object RegExp]"]=f[i]=f["[object String]"]=f["[object WeakMap]"]=!1;var h=typeof o=="object"&&o&&o.Object===Object&&o,v=typeof self=="object"&&self&&self.Object===Object&&self,b=h||v||Function("return this")(),g=typeof a=="object"&&a&&!a.nodeType&&a,x=g&&typeof n=="object"&&n&&!n.nodeType&&n,y=x&&x.exports===g,k=y&&h.process,N=function(){try{return k&&k.binding&&k.binding("util")}catch{}}(),F=N&&N.isTypedArray;function B(Ne,Le){for(var at=-1,ie=Ne==null?0:Ne.length;++at<ie;)if(Le(Ne[at],at,Ne))return!0;return!1}function W(Ne){var Le=-1,at=Array(Ne.size);return Ne.forEach(function(ie,we){at[++Le]=[we,ie]}),at}function V(Ne){var Le=-1,at=Array(Ne.size);return Ne.forEach(function(ie){at[++Le]=ie}),at}var q,X,I,H=Array.prototype,O=Function.prototype,R=Object.prototype,C=b["__core-js_shared__"],w=O.toString,E=R.hasOwnProperty,A=(q=/[^.]+$/.exec(C&&C.keys&&C.keys.IE_PROTO||""))?"Symbol(src)_1."+q:"",T=R.toString,D=RegExp("^"+w.call(E).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),U=y?b.Buffer:void 0,P=b.Symbol,K=b.Uint8Array,Y=R.propertyIsEnumerable,re=H.splice,z=P?P.toStringTag:void 0,ee=Object.getOwnPropertySymbols,L=U?U.isBuffer:void 0,M=(X=Object.keys,I=Object,function(Ne){return X(I(Ne))}),Z=vt(b,"DataView"),se=vt(b,"Map"),ae=vt(b,"Promise"),ne=vt(b,"Set"),Q=vt(b,"WeakMap"),fe=vt(Object,"create"),le=nt(Z),te=nt(se),ce=nt(ae),he=nt(ne),Ee=nt(Q),ke=P?P.prototype:void 0,Ce=ke?ke.valueOf:void 0;function Fe(Ne){var Le=-1,at=Ne==null?0:Ne.length;for(this.clear();++Le<at;){var ie=Ne[Le];this.set(ie[0],ie[1])}}function Pe(Ne){var Le=-1,at=Ne==null?0:Ne.length;for(this.clear();++Le<at;){var ie=Ne[Le];this.set(ie[0],ie[1])}}function Xe(Ne){var Le=-1,at=Ne==null?0:Ne.length;for(this.clear();++Le<at;){var ie=Ne[Le];this.set(ie[0],ie[1])}}function ct(Ne){var Le=-1,at=Ne==null?0:Ne.length;for(this.__data__=new Xe;++Le<at;)this.add(Ne[Le])}function st(Ne){var Le=this.__data__=new Pe(Ne);this.size=Le.size}function lt(Ne,Le){var at=je(Ne),ie=!at&&Se(Ne),we=!at&&!ie&&Qe(Ne),de=!at&&!ie&&!we&&It(Ne),ge=at||ie||we||de,ve=ge?function(Ue,Re){for(var Be=-1,ze=Array(Ue);++Be<Ue;)ze[Be]=Re(Be);return ze}(Ne.length,String):[],ye=ve.length;for(var Me in Ne)!E.call(Ne,Me)||ge&&(Me=="length"||we&&(Me=="offset"||Me=="parent")||de&&(Me=="buffer"||Me=="byteLength"||Me=="byteOffset")||xt(Me,ye))||ve.push(Me);return ve}function tt(Ne,Le){for(var at=Ne.length;at--;)if(pt(Ne[at][0],Le))return at;return-1}function ot(Ne){return Ne==null?Ne===void 0?"[object Undefined]":"[object Null]":z&&z in Object(Ne)?function(Le){var at=E.call(Le,z),ie=Le[z];try{Le[z]=void 0;var we=!0}catch{}var de=T.call(Le);return we&&(at?Le[z]=ie:delete Le[z]),de}(Ne):function(Le){return T.call(Le)}(Ne)}function De(Ne){return Ct(Ne)&&ot(Ne)==s}function ht(Ne,Le,at,ie,we){return Ne===Le||(Ne==null||Le==null||!Ct(Ne)&&!Ct(Le)?Ne!=Ne&&Le!=Le:function(de,ge,ve,ye,Me,Ue){var Re=je(de),Be=je(ge),ze=Re?"[object Array]":$e(de),be=Be?"[object Array]":$e(ge),Te=(ze=ze==s?c:ze)==c,Ge=(be=be==s?c:be)==c,ue=ze==be;if(ue&&Qe(de)){if(!Qe(ge))return!1;Re=!0,Te=!1}if(ue&&!Te)return Ue||(Ue=new st),Re||It(de)?dt(de,ge,ve,ye,Me,Ue):function(qe,ut,Mt,Bt,Ht,Lt,er){switch(Mt){case"[object DataView]":if(qe.byteLength!=ut.byteLength||qe.byteOffset!=ut.byteOffset)return!1;qe=qe.buffer,ut=ut.buffer;case"[object ArrayBuffer]":return!(qe.byteLength!=ut.byteLength||!Lt(new K(qe),new K(ut)));case"[object Boolean]":case"[object Date]":case"[object Number]":return pt(+qe,+ut);case"[object Error]":return qe.name==ut.name&&qe.message==ut.message;case"[object RegExp]":case"[object String]":return qe==ut+"";case l:var gr=W;case i:var tr=1&Bt;if(gr||(gr=V),qe.size!=ut.size&&!tr)return!1;var Rr=er.get(qe);if(Rr)return Rr==ut;Bt|=2,er.set(qe,ut);var en=dt(gr(qe),gr(ut),Bt,Ht,Lt,er);return er.delete(qe),en;case"[object Symbol]":if(Ce)return Ce.call(qe)==Ce.call(ut)}return!1}(de,ge,ze,ve,ye,Me,Ue);if(!(1&ve)){var Ae=Te&&E.call(de,"__wrapped__"),pe=Ge&&E.call(ge,"__wrapped__");if(Ae||pe){var xe=Ae?de.value():de,We=pe?ge.value():ge;return Ue||(Ue=new st),Me(xe,We,ve,ye,Ue)}}return ue?(Ue||(Ue=new st),function(qe,ut,Mt,Bt,Ht,Lt){var er=1&Mt,gr=wt(qe),tr=gr.length,Rr=wt(ut).length;if(tr!=Rr&&!er)return!1;for(var en=tr;en--;){var tn=gr[en];if(!(er?tn in ut:E.call(ut,tn)))return!1}var ra=Lt.get(qe);if(ra&&Lt.get(ut))return ra==ut;var Aa=!0;Lt.set(qe,ut),Lt.set(ut,qe);for(var ui=er;++en<tr;){tn=gr[en];var hn=qe[tn],ds=ut[tn];if(Bt)var vr=er?Bt(ds,hn,tn,ut,qe,Lt):Bt(hn,ds,tn,qe,ut,Lt);if(!(vr===void 0?hn===ds||Ht(hn,ds,Mt,Bt,Lt):vr)){Aa=!1;break}ui||(ui=tn=="constructor")}if(Aa&&!ui){var ir=qe.constructor,Gn=ut.constructor;ir==Gn||!("constructor"in qe)||!("constructor"in ut)||typeof ir=="function"&&ir instanceof ir&&typeof Gn=="function"&&Gn instanceof Gn||(Aa=!1)}return Lt.delete(qe),Lt.delete(ut),Aa}(de,ge,ve,ye,Me,Ue)):!1}(Ne,Le,at,ie,ht,we))}function rt(Ne){return!(!yt(Ne)||function(Le){return!!A&&A in Le}(Ne))&&(At(Ne)?D:u).test(nt(Ne))}function it(Ne){if(at=(Le=Ne)&&Le.constructor,ie=typeof at=="function"&&at.prototype||R,Le!==ie)return M(Ne);var Le,at,ie,we=[];for(var de in Object(Ne))E.call(Ne,de)&&de!="constructor"&&we.push(de);return we}function dt(Ne,Le,at,ie,we,de){var ge=1&at,ve=Ne.length,ye=Le.length;if(ve!=ye&&!(ge&&ye>ve))return!1;var Me=de.get(Ne);if(Me&&de.get(Le))return Me==Le;var Ue=-1,Re=!0,Be=2&at?new ct:void 0;for(de.set(Ne,Le),de.set(Le,Ne);++Ue<ve;){var ze=Ne[Ue],be=Le[Ue];if(ie)var Te=ge?ie(be,ze,Ue,Le,Ne,de):ie(ze,be,Ue,Ne,Le,de);if(Te!==void 0){if(Te)continue;Re=!1;break}if(Be){if(!B(Le,function(Ge,ue){if(Ae=ue,!Be.has(Ae)&&(ze===Ge||we(ze,Ge,at,ie,de)))return Be.push(ue);var Ae})){Re=!1;break}}else if(ze!==be&&!we(ze,be,at,ie,de)){Re=!1;break}}return de.delete(Ne),de.delete(Le),Re}function wt(Ne){return function(Le,at,ie){var we=at(Le);return je(Le)?we:function(de,ge){for(var ve=-1,ye=ge.length,Me=de.length;++ve<ye;)de[Me+ve]=ge[ve];return de}(we,ie(Le))}(Ne,kt,Ve)}function gt(Ne,Le){var at,ie,we=Ne.__data__;return((ie=typeof(at=Le))=="string"||ie=="number"||ie=="symbol"||ie=="boolean"?at!=="__proto__":at===null)?we[typeof Le=="string"?"string":"hash"]:we.map}function vt(Ne,Le){var at=function(ie,we){return ie==null?void 0:ie[we]}(Ne,Le);return rt(at)?at:void 0}Fe.prototype.clear=function(){this.__data__=fe?fe(null):{},this.size=0},Fe.prototype.delete=function(Ne){var Le=this.has(Ne)&&delete this.__data__[Ne];return this.size-=Le?1:0,Le},Fe.prototype.get=function(Ne){var Le=this.__data__;if(fe){var at=Le[Ne];return at==="__lodash_hash_undefined__"?void 0:at}return E.call(Le,Ne)?Le[Ne]:void 0},Fe.prototype.has=function(Ne){var Le=this.__data__;return fe?Le[Ne]!==void 0:E.call(Le,Ne)},Fe.prototype.set=function(Ne,Le){var at=this.__data__;return this.size+=this.has(Ne)?0:1,at[Ne]=fe&&Le===void 0?"__lodash_hash_undefined__":Le,this},Pe.prototype.clear=function(){this.__data__=[],this.size=0},Pe.prototype.delete=function(Ne){var Le=this.__data__,at=tt(Le,Ne);return!(at<0)&&(at==Le.length-1?Le.pop():re.call(Le,at,1),--this.size,!0)},Pe.prototype.get=function(Ne){var Le=this.__data__,at=tt(Le,Ne);return at<0?void 0:Le[at][1]},Pe.prototype.has=function(Ne){return tt(this.__data__,Ne)>-1},Pe.prototype.set=function(Ne,Le){var at=this.__data__,ie=tt(at,Ne);return ie<0?(++this.size,at.push([Ne,Le])):at[ie][1]=Le,this},Xe.prototype.clear=function(){this.size=0,this.__data__={hash:new Fe,map:new(se||Pe),string:new Fe}},Xe.prototype.delete=function(Ne){var Le=gt(this,Ne).delete(Ne);return this.size-=Le?1:0,Le},Xe.prototype.get=function(Ne){return gt(this,Ne).get(Ne)},Xe.prototype.has=function(Ne){return gt(this,Ne).has(Ne)},Xe.prototype.set=function(Ne,Le){var at=gt(this,Ne),ie=at.size;return at.set(Ne,Le),this.size+=at.size==ie?0:1,this},ct.prototype.add=ct.prototype.push=function(Ne){return this.__data__.set(Ne,"__lodash_hash_undefined__"),this},ct.prototype.has=function(Ne){return this.__data__.has(Ne)},st.prototype.clear=function(){this.__data__=new Pe,this.size=0},st.prototype.delete=function(Ne){var Le=this.__data__,at=Le.delete(Ne);return this.size=Le.size,at},st.prototype.get=function(Ne){return this.__data__.get(Ne)},st.prototype.has=function(Ne){return this.__data__.has(Ne)},st.prototype.set=function(Ne,Le){var at=this.__data__;if(at instanceof Pe){var ie=at.__data__;if(!se||ie.length<199)return ie.push([Ne,Le]),this.size=++at.size,this;at=this.__data__=new Xe(ie)}return at.set(Ne,Le),this.size=at.size,this};var Ve=ee?function(Ne){return Ne==null?[]:(Ne=Object(Ne),function(Le,at){for(var ie=-1,we=Le==null?0:Le.length,de=0,ge=[];++ie<we;){var ve=Le[ie];at(ve,ie,Le)&&(ge[de++]=ve)}return ge}(ee(Ne),function(Le){return Y.call(Ne,Le)}))}:function(){return[]},$e=ot;function xt(Ne,Le){return!!(Le=Le??9007199254740991)&&(typeof Ne=="number"||p.test(Ne))&&Ne>-1&&Ne%1==0&&Ne<Le}function nt(Ne){if(Ne!=null){try{return w.call(Ne)}catch{}try{return Ne+""}catch{}}return""}function pt(Ne,Le){return Ne===Le||Ne!=Ne&&Le!=Le}(Z&&$e(new Z(new ArrayBuffer(1)))!="[object DataView]"||se&&$e(new se)!=l||ae&&$e(ae.resolve())!="[object Promise]"||ne&&$e(new ne)!=i||Q&&$e(new Q)!="[object WeakMap]")&&($e=function(Ne){var Le=ot(Ne),at=Le==c?Ne.constructor:void 0,ie=at?nt(at):"";if(ie)switch(ie){case le:return"[object DataView]";case te:return l;case ce:return"[object Promise]";case he:return i;case Ee:return"[object WeakMap]"}return Le});var Se=De(function(){return arguments}())?De:function(Ne){return Ct(Ne)&&E.call(Ne,"callee")&&!Y.call(Ne,"callee")},je=Array.isArray,Qe=L||function(){return!1};function At(Ne){if(!yt(Ne))return!1;var Le=ot(Ne);return Le=="[object Function]"||Le=="[object GeneratorFunction]"||Le=="[object AsyncFunction]"||Le=="[object Proxy]"}function Vt(Ne){return typeof Ne=="number"&&Ne>-1&&Ne%1==0&&Ne<=9007199254740991}function yt(Ne){var Le=typeof Ne;return Ne!=null&&(Le=="object"||Le=="function")}function Ct(Ne){return Ne!=null&&typeof Ne=="object"}var It=F?function(Ne){return function(Le){return Ne(Le)}}(F):function(Ne){return Ct(Ne)&&Vt(Ne.length)&&!!f[ot(Ne)]};function kt(Ne){return(Le=Ne)!=null&&Vt(Le.length)&&!At(Le)?lt(Ne):it(Ne);var Le}n.exports=function(Ne,Le){return ht(Ne,Le)}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],446:[function(e,n,a){(function(o){(function(){var s=typeof o=="object"&&o&&o.Object===Object&&o,l=typeof self=="object"&&self&&self.Object===Object&&self,c=s||l||Function("return this")(),i=Object.prototype,u=i.hasOwnProperty,p=i.toString,f=c.Symbol,h=f?f.toStringTag:void 0;function v(b){return b==null?b===void 0?"[object Undefined]":"[object Null]":h&&h in Object(b)?function(g){var x=u.call(g,h),y=g[h];try{g[h]=void 0;var k=!0}catch{}var N=p.call(g);return k&&(x?g[h]=y:delete g[h]),N}(b):function(g){return p.call(g)}(b)}n.exports=function(b){if(!function(x){var y=typeof x;return x!=null&&(y=="object"||y=="function")}(b))return!1;var g=v(b);return g=="[object Function]"||g=="[object GeneratorFunction]"||g=="[object AsyncFunction]"||g=="[object Proxy]"}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],447:[function(e,n,a){n.exports=function(o){return o==null}},{}],448:[function(e,n,a){n.exports=function(o){return o===void 0}},{}],449:[function(e,n,a){(function(o){(function(){var s=/^\[object .+?Constructor\]$/,l=typeof o=="object"&&o&&o.Object===Object&&o,c=typeof self=="object"&&self&&self.Object===Object&&self,i=l||c||Function("return this")();function u(P,K){return!!(P&&P.length)&&function(Y,re,z){if(re!=re)return function(M,Z,se,ae){for(var ne=M.length,Q=se+-1;++Q<ne;)if(Z(M[Q],Q,M))return Q;return-1}(Y,p,z);for(var ee=z-1,L=Y.length;++ee<L;)if(Y[ee]===re)return ee;return-1}(P,K,0)>-1}function p(P){return P!=P}function f(P,K){return P.has(K)}function h(P){var K=-1,Y=Array(P.size);return P.forEach(function(re){Y[++K]=re}),Y}var v,b=Array.prototype,g=Function.prototype,x=Object.prototype,y=i["__core-js_shared__"],k=(v=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+v:"",N=g.toString,F=x.hasOwnProperty,B=x.toString,W=RegExp("^"+N.call(F).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),V=b.splice,q=D(i,"Map"),X=D(i,"Set"),I=D(Object,"create");function H(P){var K=-1,Y=P?P.length:0;for(this.clear();++K<Y;){var re=P[K];this.set(re[0],re[1])}}function O(P){var K=-1,Y=P?P.length:0;for(this.clear();++K<Y;){var re=P[K];this.set(re[0],re[1])}}function R(P){var K=-1,Y=P?P.length:0;for(this.clear();++K<Y;){var re=P[K];this.set(re[0],re[1])}}function C(P){var K=-1,Y=P?P.length:0;for(this.__data__=new R;++K<Y;)this.add(P[K])}function w(P,K){for(var Y,re,z=P.length;z--;)if((Y=P[z][0])===(re=K)||Y!=Y&&re!=re)return z;return-1}function E(P){return!(!U(P)||(K=P,k&&k in K))&&(function(Y){var re=U(Y)?B.call(Y):"";return re=="[object Function]"||re=="[object GeneratorFunction]"}(P)||function(Y){var re=!1;if(Y!=null&&typeof Y.toString!="function")try{re=!!(Y+"")}catch{}return re}(P)?W:s).test(function(Y){if(Y!=null){try{return N.call(Y)}catch{}try{return Y+""}catch{}}return""}(P));var K}H.prototype.clear=function(){this.__data__=I?I(null):{}},H.prototype.delete=function(P){return this.has(P)&&delete this.__data__[P]},H.prototype.get=function(P){var K=this.__data__;if(I){var Y=K[P];return Y==="__lodash_hash_undefined__"?void 0:Y}return F.call(K,P)?K[P]:void 0},H.prototype.has=function(P){var K=this.__data__;return I?K[P]!==void 0:F.call(K,P)},H.prototype.set=function(P,K){return this.__data__[P]=I&&K===void 0?"__lodash_hash_undefined__":K,this},O.prototype.clear=function(){this.__data__=[]},O.prototype.delete=function(P){var K=this.__data__,Y=w(K,P);return!(Y<0)&&(Y==K.length-1?K.pop():V.call(K,Y,1),!0)},O.prototype.get=function(P){var K=this.__data__,Y=w(K,P);return Y<0?void 0:K[Y][1]},O.prototype.has=function(P){return w(this.__data__,P)>-1},O.prototype.set=function(P,K){var Y=this.__data__,re=w(Y,P);return re<0?Y.push([P,K]):Y[re][1]=K,this},R.prototype.clear=function(){this.__data__={hash:new H,map:new(q||O),string:new H}},R.prototype.delete=function(P){return T(this,P).delete(P)},R.prototype.get=function(P){return T(this,P).get(P)},R.prototype.has=function(P){return T(this,P).has(P)},R.prototype.set=function(P,K){return T(this,P).set(P,K),this},C.prototype.add=C.prototype.push=function(P){return this.__data__.set(P,"__lodash_hash_undefined__"),this},C.prototype.has=function(P){return this.__data__.has(P)};var A=X&&1/h(new X([,-0]))[1]==1/0?function(P){return new X(P)}:function(){};function T(P,K){var Y,re,z=P.__data__;return((re=typeof(Y=K))=="string"||re=="number"||re=="symbol"||re=="boolean"?Y!=="__proto__":Y===null)?z[typeof K=="string"?"string":"hash"]:z.map}function D(P,K){var Y=function(re,z){return re==null?void 0:re[z]}(P,K);return E(Y)?Y:void 0}function U(P){var K=typeof P;return!!P&&(K=="object"||K=="function")}n.exports=function(P){return P&&P.length?function(K,Y,re){var z=-1,ee=u,L=K.length,M=!0,Z=[],se=Z;if(L>=200){var ae=A(K);if(ae)return h(ae);M=!1,ee=f,se=new C}else se=Z;e:for(;++z<L;){var ne=K[z],Q=ne;if(ne=ne!==0?ne:0,M&&Q==Q){for(var fe=se.length;fe--;)if(se[fe]===Q)continue e;Z.push(ne)}else ee(se,Q,re)||(se!==Z&&se.push(Q),Z.push(ne))}return Z}(P):[]}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],450:[function(e,n,a){var o=e("inherits"),s=e("hash-base"),l=e("safe-buffer").Buffer,c=new Array(16);function i(){s.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function u(b,g){return b<<g|b>>>32-g}function p(b,g,x,y,k,N,F){return u(b+(g&x|~g&y)+k+N|0,F)+g|0}function f(b,g,x,y,k,N,F){return u(b+(g&y|x&~y)+k+N|0,F)+g|0}function h(b,g,x,y,k,N,F){return u(b+(g^x^y)+k+N|0,F)+g|0}function v(b,g,x,y,k,N,F){return u(b+(x^(g|~y))+k+N|0,F)+g|0}o(i,s),i.prototype._update=function(){for(var b=c,g=0;g<16;++g)b[g]=this._block.readInt32LE(4*g);var x=this._a,y=this._b,k=this._c,N=this._d;x=p(x,y,k,N,b[0],3614090360,7),N=p(N,x,y,k,b[1],3905402710,12),k=p(k,N,x,y,b[2],606105819,17),y=p(y,k,N,x,b[3],3250441966,22),x=p(x,y,k,N,b[4],4118548399,7),N=p(N,x,y,k,b[5],1200080426,12),k=p(k,N,x,y,b[6],2821735955,17),y=p(y,k,N,x,b[7],4249261313,22),x=p(x,y,k,N,b[8],1770035416,7),N=p(N,x,y,k,b[9],2336552879,12),k=p(k,N,x,y,b[10],4294925233,17),y=p(y,k,N,x,b[11],2304563134,22),x=p(x,y,k,N,b[12],1804603682,7),N=p(N,x,y,k,b[13],4254626195,12),k=p(k,N,x,y,b[14],2792965006,17),x=f(x,y=p(y,k,N,x,b[15],1236535329,22),k,N,b[1],4129170786,5),N=f(N,x,y,k,b[6],3225465664,9),k=f(k,N,x,y,b[11],643717713,14),y=f(y,k,N,x,b[0],3921069994,20),x=f(x,y,k,N,b[5],3593408605,5),N=f(N,x,y,k,b[10],38016083,9),k=f(k,N,x,y,b[15],3634488961,14),y=f(y,k,N,x,b[4],3889429448,20),x=f(x,y,k,N,b[9],568446438,5),N=f(N,x,y,k,b[14],3275163606,9),k=f(k,N,x,y,b[3],4107603335,14),y=f(y,k,N,x,b[8],1163531501,20),x=f(x,y,k,N,b[13],2850285829,5),N=f(N,x,y,k,b[2],4243563512,9),k=f(k,N,x,y,b[7],1735328473,14),x=h(x,y=f(y,k,N,x,b[12],2368359562,20),k,N,b[5],4294588738,4),N=h(N,x,y,k,b[8],2272392833,11),k=h(k,N,x,y,b[11],1839030562,16),y=h(y,k,N,x,b[14],4259657740,23),x=h(x,y,k,N,b[1],2763975236,4),N=h(N,x,y,k,b[4],1272893353,11),k=h(k,N,x,y,b[7],4139469664,16),y=h(y,k,N,x,b[10],3200236656,23),x=h(x,y,k,N,b[13],681279174,4),N=h(N,x,y,k,b[0],3936430074,11),k=h(k,N,x,y,b[3],3572445317,16),y=h(y,k,N,x,b[6],76029189,23),x=h(x,y,k,N,b[9],3654602809,4),N=h(N,x,y,k,b[12],3873151461,11),k=h(k,N,x,y,b[15],530742520,16),x=v(x,y=h(y,k,N,x,b[2],3299628645,23),k,N,b[0],4096336452,6),N=v(N,x,y,k,b[7],1126891415,10),k=v(k,N,x,y,b[14],2878612391,15),y=v(y,k,N,x,b[5],4237533241,21),x=v(x,y,k,N,b[12],1700485571,6),N=v(N,x,y,k,b[3],2399980690,10),k=v(k,N,x,y,b[10],4293915773,15),y=v(y,k,N,x,b[1],2240044497,21),x=v(x,y,k,N,b[8],1873313359,6),N=v(N,x,y,k,b[15],4264355552,10),k=v(k,N,x,y,b[6],2734768916,15),y=v(y,k,N,x,b[13],1309151649,21),x=v(x,y,k,N,b[4],4149444226,6),N=v(N,x,y,k,b[11],3174756917,10),k=v(k,N,x,y,b[2],718787259,15),y=v(y,k,N,x,b[9],3951481745,21),this._a=this._a+x|0,this._b=this._b+y|0,this._c=this._c+k|0,this._d=this._d+N|0},i.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var b=l.allocUnsafe(16);return b.writeInt32LE(this._a,0),b.writeInt32LE(this._b,4),b.writeInt32LE(this._c,8),b.writeInt32LE(this._d,12),b},n.exports=i},{"hash-base":425,inherits:440,"safe-buffer":494}],451:[function(e,n,a){var o=e("bn.js"),s=e("brorand");function l(c){this.rand=c||new s.Rand}n.exports=l,l.create=function(c){return new l(c)},l.prototype._randbelow=function(c){var i=c.bitLength(),u=Math.ceil(i/8);do var p=new o(this.rand.generate(u));while(p.cmp(c)>=0);return p},l.prototype._randrange=function(c,i){var u=i.sub(c);return c.add(this._randbelow(u))},l.prototype.test=function(c,i,u){var p=c.bitLength(),f=o.mont(c),h=new o(1).toRed(f);i||(i=Math.max(1,p/48|0));for(var v=c.subn(1),b=0;!v.testn(b);b++);for(var g=c.shrn(b),x=v.toRed(f);i>0;i--){var y=this._randrange(new o(2),v);u&&u(y);var k=y.toRed(f).redPow(g);if(k.cmp(h)!==0&&k.cmp(x)!==0){for(var N=1;N<b;N++){if((k=k.redSqr()).cmp(h)===0)return!1;if(k.cmp(x)===0)break}if(N===b)return!1}}return!0},l.prototype.getDivisor=function(c,i){var u=c.bitLength(),p=o.mont(c),f=new o(1).toRed(p);i||(i=Math.max(1,u/48|0));for(var h=c.subn(1),v=0;!h.testn(v);v++);for(var b=c.shrn(v),g=h.toRed(p);i>0;i--){var x=this._randrange(new o(2),h),y=c.gcd(x);if(y.cmpn(1)!==0)return y;var k=x.toRed(p).redPow(b);if(k.cmp(f)!==0&&k.cmp(g)!==0){for(var N=1;N<v;N++){if((k=k.redSqr()).cmp(f)===0)return k.fromRed().subn(1).gcd(c);if(k.cmp(g)===0)break}if(N===v)return(k=k.redSqr()).fromRed().subn(1).gcd(c)}}return!1}},{"bn.js":452,brorand:187}],452:[function(e,n,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],453:[function(e,n,a){function o(s,l){if(!s)throw new Error(l||"Assertion failed")}n.exports=o,o.equal=function(s,l,c){if(s!=l)throw new Error(c||"Assertion failed: "+s+" != "+l)}},{}],454:[function(e,n,a){var o=a;function s(c){return c.length===1?"0"+c:c}function l(c){for(var i="",u=0;u<c.length;u++)i+=s(c[u].toString(16));return i}o.toArray=function(c,i){if(Array.isArray(c))return c.slice();if(!c)return[];var u=[];if(typeof c!="string"){for(var p=0;p<c.length;p++)u[p]=0|c[p];return u}if(i==="hex")for((c=c.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(c="0"+c),p=0;p<c.length;p+=2)u.push(parseInt(c[p]+c[p+1],16));else for(p=0;p<c.length;p++){var f=c.charCodeAt(p),h=f>>8,v=255&f;h?u.push(h,v):u.push(v)}return u},o.zero2=s,o.toHex=l,o.encode=function(c,i){return i==="hex"?l(c):c}},{}],455:[function(e,n,a){n.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],456:[function(e,n,a){var o=e("asn1.js");a.certificate=e("./certificate");var s=o.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});a.RSAPrivateKey=s;var l=o.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});a.RSAPublicKey=l;var c=o.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(i),this.key("subjectPublicKey").bitstr())});a.PublicKey=c;var i=o.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),u=o.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(i),this.key("subjectPrivateKey").octstr())});a.PrivateKey=u;var p=o.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});a.EncryptedPrivateKey=p;var f=o.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});a.DSAPrivateKey=f,a.DSAparam=o.define("DSAparam",function(){this.int()});var h=o.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(v),this.key("publicKey").optional().explicit(1).bitstr())});a.ECPrivateKey=h;var v=o.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});a.signature=o.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},{"./certificate":457,"asn1.js":170}],457:[function(e,n,a){var o=e("asn1.js"),s=o.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),l=o.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),c=o.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),i=o.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(c),this.key("subjectPublicKey").bitstr())}),u=o.define("RelativeDistinguishedName",function(){this.setof(l)}),p=o.define("RDNSequence",function(){this.seqof(u)}),f=o.define("Name",function(){this.choice({rdnSequence:this.use(p)})}),h=o.define("Validity",function(){this.seq().obj(this.key("notBefore").use(s),this.key("notAfter").use(s))}),v=o.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),b=o.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(c),this.key("issuer").use(f),this.key("validity").use(h),this.key("subject").use(f),this.key("subjectPublicKeyInfo").use(i),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(v).optional())}),g=o.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(b),this.key("signatureAlgorithm").use(c),this.key("signatureValue").bitstr())});n.exports=g},{"asn1.js":170}],458:[function(e,n,a){var o=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,s=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,l=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,c=e("evp_bytestokey"),i=e("browserify-aes"),u=e("safe-buffer").Buffer;n.exports=function(p,f){var h,v=p.toString(),b=v.match(o);if(b){var g="aes"+b[1],x=u.from(b[2],"hex"),y=u.from(b[3].replace(/[\r\n]/g,""),"base64"),k=c(f,x.slice(0,8),parseInt(b[1],10)).key,N=[],F=i.createDecipheriv(g,k,x);N.push(F.update(y)),N.push(F.final()),h=u.concat(N)}else{var B=v.match(l);h=u.from(B[2].replace(/[\r\n]/g,""),"base64")}return{tag:v.match(s)[1],data:h}}},{"browserify-aes":191,evp_bytestokey:423,"safe-buffer":494}],459:[function(e,n,a){var o=e("./asn1"),s=e("./aesid.json"),l=e("./fixProc"),c=e("browserify-aes"),i=e("pbkdf2"),u=e("safe-buffer").Buffer;function p(f){var h;typeof f!="object"||u.isBuffer(f)||(h=f.passphrase,f=f.key),typeof f=="string"&&(f=u.from(f));var v,b,g=l(f,h),x=g.tag,y=g.data;switch(x){case"CERTIFICATE":b=o.certificate.decode(y,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(b||(b=o.PublicKey.decode(y,"der")),v=b.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return o.RSAPublicKey.decode(b.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return b.subjectPrivateKey=b.subjectPublicKey,{type:"ec",data:b};case"1.2.840.10040.4.1":return b.algorithm.params.pub_key=o.DSAparam.decode(b.subjectPublicKey.data,"der"),{type:"dsa",data:b.algorithm.params};default:throw new Error("unknown key id "+v)}case"ENCRYPTED PRIVATE KEY":y=function(k,N){var F=k.algorithm.decrypt.kde.kdeparams.salt,B=parseInt(k.algorithm.decrypt.kde.kdeparams.iters.toString(),10),W=s[k.algorithm.decrypt.cipher.algo.join(".")],V=k.algorithm.decrypt.cipher.iv,q=k.subjectPrivateKey,X=parseInt(W.split("-")[1],10)/8,I=i.pbkdf2Sync(N,F,B,X,"sha1"),H=c.createDecipheriv(W,I,V),O=[];return O.push(H.update(q)),O.push(H.final()),u.concat(O)}(y=o.EncryptedPrivateKey.decode(y,"der"),h);case"PRIVATE KEY":switch(v=(b=o.PrivateKey.decode(y,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return o.RSAPrivateKey.decode(b.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:b.algorithm.curve,privateKey:o.ECPrivateKey.decode(b.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return b.algorithm.params.priv_key=o.DSAparam.decode(b.subjectPrivateKey,"der"),{type:"dsa",params:b.algorithm.params};default:throw new Error("unknown key id "+v)}case"RSA PUBLIC KEY":return o.RSAPublicKey.decode(y,"der");case"RSA PRIVATE KEY":return o.RSAPrivateKey.decode(y,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:o.DSAPrivateKey.decode(y,"der")};case"EC PRIVATE KEY":return{curve:(y=o.ECPrivateKey.decode(y,"der")).parameters.value,privateKey:y.privateKey};default:throw new Error("unknown key type "+x)}}n.exports=p,p.signature=o.signature},{"./aesid.json":455,"./asn1":456,"./fixProc":458,"browserify-aes":191,pbkdf2:460,"safe-buffer":494}],460:[function(e,n,a){a.pbkdf2=e("./lib/async"),a.pbkdf2Sync=e("./lib/sync")},{"./lib/async":461,"./lib/sync":464}],461:[function(e,n,a){(function(o){(function(){var s,l,c=e("safe-buffer").Buffer,i=e("./precondition"),u=e("./default-encoding"),p=e("./sync"),f=e("./to-buffer"),h=o.crypto&&o.crypto.subtle,v={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},b=[];function g(){return l||(l=o.process&&o.process.nextTick?o.process.nextTick:o.queueMicrotask?o.queueMicrotask:o.setImmediate?o.setImmediate:o.setTimeout)}function x(y,k,N,F,B){return h.importKey("raw",y,{name:"PBKDF2"},!1,["deriveBits"]).then(function(W){return h.deriveBits({name:"PBKDF2",salt:k,iterations:N,hash:{name:B}},W,F<<3)}).then(function(W){return c.from(W)})}n.exports=function(y,k,N,F,B,W){typeof B=="function"&&(W=B,B=void 0);var V=v[(B=B||"sha1").toLowerCase()];if(V&&typeof o.Promise=="function"){if(i(N,F),y=f(y,u,"Password"),k=f(k,u,"Salt"),typeof W!="function")throw new Error("No callback provided to pbkdf2");(function(q,X){q.then(function(I){g()(function(){X(null,I)})},function(I){g()(function(){X(I)})})})(function(q){if(o.process&&!o.process.browser||!h||!h.importKey||!h.deriveBits)return Promise.resolve(!1);if(b[q]!==void 0)return b[q];var X=x(s=s||c.alloc(8),s,10,128,q).then(function(){return!0}).catch(function(){return!1});return b[q]=X,X}(V).then(function(q){return q?x(y,k,N,F,V):p(y,k,N,F,B)}),W)}else g()(function(){var q;try{q=p(y,k,N,F,B)}catch(X){return W(X)}W(null,q)})}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"./default-encoding":462,"./precondition":463,"./sync":464,"./to-buffer":465,"safe-buffer":494}],462:[function(e,n,a){(function(o,s){(function(){var l;s.process&&s.process.browser?l="utf-8":s.process&&s.process.version?l=parseInt(o.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":l="utf-8",n.exports=l}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467}],463:[function(e,n,a){var o=Math.pow(2,30)-1;n.exports=function(s,l){if(typeof s!="number")throw new TypeError("Iterations not a number");if(s<0)throw new TypeError("Bad iterations");if(typeof l!="number")throw new TypeError("Key length not a number");if(l<0||l>o||l!=l)throw new TypeError("Bad key length")}},{}],464:[function(e,n,a){var o=e("create-hash/md5"),s=e("ripemd160"),l=e("sha.js"),c=e("safe-buffer").Buffer,i=e("./precondition"),u=e("./default-encoding"),p=e("./to-buffer"),f=c.alloc(128),h={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function v(b,g,x){var y=function(V){function q(X){return l(V).update(X).digest()}return V==="rmd160"||V==="ripemd160"?function(X){return new s().update(X).digest()}:V==="md5"?o:q}(b),k=b==="sha512"||b==="sha384"?128:64;g.length>k?g=y(g):g.length<k&&(g=c.concat([g,f],k));for(var N=c.allocUnsafe(k+h[b]),F=c.allocUnsafe(k+h[b]),B=0;B<k;B++)N[B]=54^g[B],F[B]=92^g[B];var W=c.allocUnsafe(k+x+4);N.copy(W,0,0,k),this.ipad1=W,this.ipad2=N,this.opad=F,this.alg=b,this.blocksize=k,this.hash=y,this.size=h[b]}v.prototype.run=function(b,g){return b.copy(g,this.blocksize),this.hash(g).copy(this.opad,this.blocksize),this.hash(this.opad)},n.exports=function(b,g,x,y,k){i(x,y);var N=new v(k=k||"sha1",b=p(b,u,"Password"),(g=p(g,u,"Salt")).length),F=c.allocUnsafe(y),B=c.allocUnsafe(g.length+4);g.copy(B,0,0,g.length);for(var W=0,V=h[k],q=Math.ceil(y/V),X=1;X<=q;X++){B.writeUInt32BE(X,g.length);for(var I=N.run(B,N.ipad1),H=I,O=1;O<x;O++){H=N.run(H,N.ipad2);for(var R=0;R<V;R++)I[R]^=H[R]}I.copy(F,W),W+=V}return F}},{"./default-encoding":462,"./precondition":463,"./to-buffer":465,"create-hash/md5":387,ripemd160:493,"safe-buffer":494,"sha.js":498}],465:[function(e,n,a){var o=e("safe-buffer").Buffer;n.exports=function(s,l,c){if(o.isBuffer(s))return s;if(typeof s=="string")return o.from(s,l);if(ArrayBuffer.isView(s))return o.from(s.buffer);throw new TypeError(c+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":494}],466:[function(e,n,a){(function(o){(function(){o===void 0||!o.version||o.version.indexOf("v0.")===0||o.version.indexOf("v1.")===0&&o.version.indexOf("v1.8.")!==0?n.exports={nextTick:function(s,l,c,i){if(typeof s!="function")throw new TypeError('"callback" argument must be a function');var u,p,f=arguments.length;switch(f){case 0:case 1:return o.nextTick(s);case 2:return o.nextTick(function(){s.call(null,l)});case 3:return o.nextTick(function(){s.call(null,l,c)});case 4:return o.nextTick(function(){s.call(null,l,c,i)});default:for(u=new Array(f-1),p=0;p<u.length;)u[p++]=arguments[p];return o.nextTick(function(){s.apply(null,u)})}}}:n.exports=o}).call(this)}).call(this,e("_process"))},{_process:467}],467:[function(e,n,a){var o,s,l=n.exports={};function c(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function u(k){if(o===setTimeout)return setTimeout(k,0);if((o===c||!o)&&setTimeout)return o=setTimeout,setTimeout(k,0);try{return o(k,0)}catch{try{return o.call(null,k,0)}catch{return o.call(this,k,0)}}}(function(){try{o=typeof setTimeout=="function"?setTimeout:c}catch{o=c}try{s=typeof clearTimeout=="function"?clearTimeout:i}catch{s=i}})();var p,f=[],h=!1,v=-1;function b(){h&&p&&(h=!1,p.length?f=p.concat(f):v=-1,f.length&&g())}function g(){if(!h){var k=u(b);h=!0;for(var N=f.length;N;){for(p=f,f=[];++v<N;)p&&p[v].run();v=-1,N=f.length}p=null,h=!1,function(F){if(s===clearTimeout)return clearTimeout(F);if((s===i||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(F);try{s(F)}catch{try{return s.call(null,F)}catch{return s.call(this,F)}}}(k)}}function x(k,N){this.fun=k,this.array=N}function y(){}l.nextTick=function(k){var N=new Array(arguments.length-1);if(arguments.length>1)for(var F=1;F<arguments.length;F++)N[F-1]=arguments[F];f.push(new x(k,N)),f.length!==1||h||u(g)},x.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=y,l.addListener=y,l.once=y,l.off=y,l.removeListener=y,l.removeAllListeners=y,l.emit=y,l.prependListener=y,l.prependOnceListener=y,l.listeners=function(k){return[]},l.binding=function(k){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(k){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],468:[function(e,n,a){a.publicEncrypt=e("./publicEncrypt"),a.privateDecrypt=e("./privateDecrypt"),a.privateEncrypt=function(o,s){return a.publicEncrypt(o,s,!0)},a.publicDecrypt=function(o,s){return a.privateDecrypt(o,s,!0)}},{"./privateDecrypt":471,"./publicEncrypt":472}],469:[function(e,n,a){var o=e("create-hash"),s=e("safe-buffer").Buffer;function l(c){var i=s.allocUnsafe(4);return i.writeUInt32BE(c,0),i}n.exports=function(c,i){for(var u,p=s.alloc(0),f=0;p.length<i;)u=l(f++),p=s.concat([p,o("sha1").update(c).update(u).digest()]);return p.slice(0,i)}},{"create-hash":386,"safe-buffer":494}],470:[function(e,n,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],471:[function(e,n,a){var o=e("parse-asn1"),s=e("./mgf"),l=e("./xor"),c=e("bn.js"),i=e("browserify-rsa"),u=e("create-hash"),p=e("./withPublic"),f=e("safe-buffer").Buffer;n.exports=function(h,v,b){var g;g=h.padding?h.padding:b?1:4;var x,y=o(h),k=y.modulus.byteLength();if(v.length>k||new c(v).cmp(y.modulus)>=0)throw new Error("decryption error");x=b?p(new c(v),y):i(v,y);var N=f.alloc(k-x.length);if(x=f.concat([N,x],k),g===4)return function(F,B){var W=F.modulus.byteLength(),V=u("sha1").update(f.alloc(0)).digest(),q=V.length;if(B[0]!==0)throw new Error("decryption error");var X=B.slice(1,q+1),I=B.slice(q+1),H=l(X,s(I,q)),O=l(I,s(H,W-q-1));if(function(C,w){C=f.from(C),w=f.from(w);var E=0,A=C.length;C.length!==w.length&&(E++,A=Math.min(C.length,w.length));for(var T=-1;++T<A;)E+=C[T]^w[T];return E}(V,O.slice(0,q)))throw new Error("decryption error");for(var R=q;O[R]===0;)R++;if(O[R++]!==1)throw new Error("decryption error");return O.slice(R)}(y,x);if(g===1)return function(F,B,W){for(var V=B.slice(0,2),q=2,X=0;B[q++]!==0;)if(q>=B.length){X++;break}var I=B.slice(2,q-1);if((V.toString("hex")!=="0002"&&!W||V.toString("hex")!=="0001"&&W)&&X++,I.length<8&&X++,X)throw new Error("decryption error");return B.slice(q)}(0,x,b);if(g===3)return x;throw new Error("unknown padding")}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,"safe-buffer":494}],472:[function(e,n,a){var o=e("parse-asn1"),s=e("randombytes"),l=e("create-hash"),c=e("./mgf"),i=e("./xor"),u=e("bn.js"),p=e("./withPublic"),f=e("browserify-rsa"),h=e("safe-buffer").Buffer;n.exports=function(v,b,g){var x;x=v.padding?v.padding:g?1:4;var y,k=o(v);if(x===4)y=function(N,F){var B=N.modulus.byteLength(),W=F.length,V=l("sha1").update(h.alloc(0)).digest(),q=V.length,X=2*q;if(W>B-X-2)throw new Error("message too long");var I=h.alloc(B-W-X-2),H=B-q-1,O=s(q),R=i(h.concat([V,I,h.alloc(1,1),F],H),c(O,H)),C=i(O,c(R,q));return new u(h.concat([h.alloc(1),C,R],B))}(k,b);else if(x===1)y=function(N,F,B){var W,V=F.length,q=N.modulus.byteLength();if(V>q-11)throw new Error("message too long");return W=B?h.alloc(q-V-3,255):function(X){for(var I,H=h.allocUnsafe(X),O=0,R=s(2*X),C=0;O<X;)C===R.length&&(R=s(2*X),C=0),(I=R[C++])&&(H[O++]=I);return H}(q-V-3),new u(h.concat([h.from([0,B?1:2]),W,h.alloc(1),F],q))}(k,b,g);else{if(x!==3)throw new Error("unknown padding");if((y=new u(b)).cmp(k.modulus)>=0)throw new Error("data too long for modulus")}return g?f(y,k):p(y,k)}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,randombytes:475,"safe-buffer":494}],473:[function(e,n,a){var o=e("bn.js"),s=e("safe-buffer").Buffer;n.exports=function(l,c){return s.from(l.toRed(o.mont(c.modulus)).redPow(new o(c.publicExponent)).fromRed().toArray())}},{"bn.js":470,"safe-buffer":494}],474:[function(e,n,a){n.exports=function(o,s){for(var l=o.length,c=-1;++c<l;)o[c]^=s[c];return o}},{}],475:[function(e,n,a){(function(o,s){(function(){var l=e("safe-buffer").Buffer,c=s.crypto||s.msCrypto;c&&c.getRandomValues?n.exports=function(i,u){if(i>4294967295)throw new RangeError("requested too many random bytes");var p=l.allocUnsafe(i);if(i>0)if(i>65536)for(var f=0;f<i;f+=65536)c.getRandomValues(p.slice(f,f+65536));else c.getRandomValues(p);return typeof u=="function"?o.nextTick(function(){u(null,p)}):p}:n.exports=function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,"safe-buffer":494}],476:[function(e,n,a){(function(o,s){(function(){function l(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var c=e("safe-buffer"),i=e("randombytes"),u=c.Buffer,p=c.kMaxLength,f=s.crypto||s.msCrypto,h=Math.pow(2,32)-1;function v(x,y){if(typeof x!="number"||x!=x)throw new TypeError("offset must be a number");if(x>h||x<0)throw new TypeError("offset must be a uint32");if(x>p||x>y)throw new RangeError("offset out of range")}function b(x,y,k){if(typeof x!="number"||x!=x)throw new TypeError("size must be a number");if(x>h||x<0)throw new TypeError("size must be a uint32");if(x+y>k||x>p)throw new RangeError("buffer too small")}function g(x,y,k,N){if(o.browser){var F=x.buffer,B=new Uint8Array(F,y,k);return f.getRandomValues(B),N?void o.nextTick(function(){N(null,x)}):x}if(!N)return i(k).copy(x,y),x;i(k,function(W,V){if(W)return N(W);V.copy(x,y),N(null,x)})}f&&f.getRandomValues||!o.browser?(a.randomFill=function(x,y,k,N){if(!(u.isBuffer(x)||x instanceof s.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof y=="function")N=y,y=0,k=x.length;else if(typeof k=="function")N=k,k=x.length-y;else if(typeof N!="function")throw new TypeError('"cb" argument must be a function');return v(y,x.length),b(k,y,x.length),g(x,y,k,N)},a.randomFillSync=function(x,y,k){if(y===void 0&&(y=0),!(u.isBuffer(x)||x instanceof s.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return v(y,x.length),k===void 0&&(k=x.length-y),b(k,y,x.length),g(x,y,k)}):(a.randomFill=l,a.randomFillSync=l)}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,randombytes:475,"safe-buffer":494}],477:[function(e,n,a){var o={};function s(c,i,u){u||(u=Error);var p=function(f){var h,v;function b(g,x,y){return f.call(this,function(k,N,F){return typeof i=="string"?i:i(k,N,F)}(g,x,y))||this}return v=f,(h=b).prototype=Object.create(v.prototype),h.prototype.constructor=h,h.__proto__=v,b}(u);p.prototype.name=u.name,p.prototype.code=c,o[c]=p}function l(c,i){if(Array.isArray(c)){var u=c.length;return c=c.map(function(p){return String(p)}),u>2?"one of ".concat(i," ").concat(c.slice(0,u-1).join(", "),", or ")+c[u-1]:u===2?"one of ".concat(i," ").concat(c[0]," or ").concat(c[1]):"of ".concat(i," ").concat(c[0])}return"of ".concat(i," ").concat(String(c))}s("ERR_INVALID_OPT_VALUE",function(c,i){return'The value "'+i+'" is invalid for option "'+c+'"'},TypeError),s("ERR_INVALID_ARG_TYPE",function(c,i,u){var p,f,h;if(typeof i=="string"&&(f="not ",i.substr(0,f.length)===f)?(p="must not be",i=i.replace(/^not /,"")):p="must be",function(b,g,x){return(x===void 0||x>b.length)&&(x=b.length),b.substring(x-g.length,x)===g}(c," argument"))h="The ".concat(c," ").concat(p," ").concat(l(i,"type"));else{var v=function(b,g,x){return typeof x!="number"&&(x=0),!(x+g.length>b.length)&&b.indexOf(g,x)!==-1}(c,".")?"property":"argument";h='The "'.concat(c,'" ').concat(v," ").concat(p," ").concat(l(i,"type"))}return h+=". Received type ".concat(typeof u)},TypeError),s("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),s("ERR_METHOD_NOT_IMPLEMENTED",function(c){return"The "+c+" method is not implemented"}),s("ERR_STREAM_PREMATURE_CLOSE","Premature close"),s("ERR_STREAM_DESTROYED",function(c){return"Cannot call "+c+" after a stream was destroyed"}),s("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),s("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),s("ERR_STREAM_WRITE_AFTER_END","write after end"),s("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),s("ERR_UNKNOWN_ENCODING",function(c){return"Unknown encoding: "+c},TypeError),s("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),n.exports.codes=o},{}],478:[function(e,n,a){(function(o){(function(){var s=Object.keys||function(b){var g=[];for(var x in b)g.push(x);return g};n.exports=f;var l=e("./_stream_readable"),c=e("./_stream_writable");e("inherits")(f,l);for(var i=s(c.prototype),u=0;u<i.length;u++){var p=i[u];f.prototype[p]||(f.prototype[p]=c.prototype[p])}function f(b){if(!(this instanceof f))return new f(b);l.call(this,b),c.call(this,b),this.allowHalfOpen=!0,b&&(b.readable===!1&&(this.readable=!1),b.writable===!1&&(this.writable=!1),b.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",h)))}function h(){this._writableState.ended||o.nextTick(v,this)}function v(b){b.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(f.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(f.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(b){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=b,this._writableState.destroyed=b)}})}).call(this)}).call(this,e("_process"))},{"./_stream_readable":480,"./_stream_writable":482,_process:467,inherits:440}],479:[function(e,n,a){n.exports=s;var o=e("./_stream_transform");function s(l){if(!(this instanceof s))return new s(l);o.call(this,l)}e("inherits")(s,o),s.prototype._transform=function(l,c,i){i(null,l)}},{"./_stream_transform":481,inherits:440}],480:[function(e,n,a){(function(o,s){(function(){var l;n.exports=H,H.ReadableState=I,e("events").EventEmitter;var c=function(L,M){return L.listeners(M).length},i=e("./internal/streams/stream"),u=e("buffer").Buffer,p=(s!==void 0?s:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},f,h=e("util");f=h&&h.debuglog?h.debuglog("stream"):function(){};var v,b,g,x=e("./internal/streams/buffer_list"),y=e("./internal/streams/destroy"),k=e("./internal/streams/state").getHighWaterMark,N=e("../errors").codes,F=N.ERR_INVALID_ARG_TYPE,B=N.ERR_STREAM_PUSH_AFTER_EOF,W=N.ERR_METHOD_NOT_IMPLEMENTED,V=N.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;e("inherits")(H,i);var q=y.errorOrDestroy,X=["error","close","destroy","pause","resume"];function I(L,M,Z){l=l||e("./_stream_duplex"),L=L||{},typeof Z!="boolean"&&(Z=M instanceof l),this.objectMode=!!L.objectMode,Z&&(this.objectMode=this.objectMode||!!L.readableObjectMode),this.highWaterMark=k(this,L,"readableHighWaterMark",Z),this.buffer=new x,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=L.emitClose!==!1,this.autoDestroy=!!L.autoDestroy,this.destroyed=!1,this.defaultEncoding=L.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,L.encoding&&(v||(v=e("string_decoder/").StringDecoder),this.decoder=new v(L.encoding),this.encoding=L.encoding)}function H(L){if(l=l||e("./_stream_duplex"),!(this instanceof H))return new H(L);var M=this instanceof l;this._readableState=new I(L,this,M),this.readable=!0,L&&(typeof L.read=="function"&&(this._read=L.read),typeof L.destroy=="function"&&(this._destroy=L.destroy)),i.call(this)}function O(L,M,Z,se,ae){f("readableAddChunk",M);var ne,Q=L._readableState;if(M===null)Q.reading=!1,function(fe,le){if(f("onEofChunk"),!le.ended){if(le.decoder){var te=le.decoder.end();te&&te.length&&(le.buffer.push(te),le.length+=le.objectMode?1:te.length)}le.ended=!0,le.sync?w(fe):(le.needReadable=!1,le.emittedReadable||(le.emittedReadable=!0,E(fe)))}}(L,Q);else if(ae||(ne=function(fe,le){var te;ce=le,u.isBuffer(ce)||ce instanceof p||typeof le=="string"||le===void 0||fe.objectMode||(te=new F("chunk",["string","Buffer","Uint8Array"],le));var ce;return te}(Q,M)),ne)q(L,ne);else if(Q.objectMode||M&&M.length>0)if(typeof M=="string"||Q.objectMode||Object.getPrototypeOf(M)===u.prototype||(M=function(fe){return u.from(fe)}(M)),se)Q.endEmitted?q(L,new V):R(L,Q,M,!0);else if(Q.ended)q(L,new B);else{if(Q.destroyed)return!1;Q.reading=!1,Q.decoder&&!Z?(M=Q.decoder.write(M),Q.objectMode||M.length!==0?R(L,Q,M,!1):A(L,Q)):R(L,Q,M,!1)}else se||(Q.reading=!1,A(L,Q));return!Q.ended&&(Q.length<Q.highWaterMark||Q.length===0)}function R(L,M,Z,se){M.flowing&&M.length===0&&!M.sync?(M.awaitDrain=0,L.emit("data",Z)):(M.length+=M.objectMode?1:Z.length,se?M.buffer.unshift(Z):M.buffer.push(Z),M.needReadable&&w(L)),A(L,M)}Object.defineProperty(H.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(L){this._readableState&&(this._readableState.destroyed=L)}}),H.prototype.destroy=y.destroy,H.prototype._undestroy=y.undestroy,H.prototype._destroy=function(L,M){M(L)},H.prototype.push=function(L,M){var Z,se=this._readableState;return se.objectMode?Z=!0:typeof L=="string"&&((M=M||se.defaultEncoding)!==se.encoding&&(L=u.from(L,M),M=""),Z=!0),O(this,L,M,!1,Z)},H.prototype.unshift=function(L){return O(this,L,null,!0,!1)},H.prototype.isPaused=function(){return this._readableState.flowing===!1},H.prototype.setEncoding=function(L){v||(v=e("string_decoder/").StringDecoder);var M=new v(L);this._readableState.decoder=M,this._readableState.encoding=this._readableState.decoder.encoding;for(var Z=this._readableState.buffer.head,se="";Z!==null;)se+=M.write(Z.data),Z=Z.next;return this._readableState.buffer.clear(),se!==""&&this._readableState.buffer.push(se),this._readableState.length=se.length,this};function C(L,M){return L<=0||M.length===0&&M.ended?0:M.objectMode?1:L!=L?M.flowing&&M.length?M.buffer.head.data.length:M.length:(L>M.highWaterMark&&(M.highWaterMark=function(Z){return Z>=1073741824?Z=1073741824:(Z--,Z|=Z>>>1,Z|=Z>>>2,Z|=Z>>>4,Z|=Z>>>8,Z|=Z>>>16,Z++),Z}(L)),L<=M.length?L:M.ended?M.length:(M.needReadable=!0,0))}function w(L){var M=L._readableState;f("emitReadable",M.needReadable,M.emittedReadable),M.needReadable=!1,M.emittedReadable||(f("emitReadable",M.flowing),M.emittedReadable=!0,o.nextTick(E,L))}function E(L){var M=L._readableState;f("emitReadable_",M.destroyed,M.length,M.ended),M.destroyed||!M.length&&!M.ended||(L.emit("readable"),M.emittedReadable=!1),M.needReadable=!M.flowing&&!M.ended&&M.length<=M.highWaterMark,K(L)}function A(L,M){M.readingMore||(M.readingMore=!0,o.nextTick(T,L,M))}function T(L,M){for(;!M.reading&&!M.ended&&(M.length<M.highWaterMark||M.flowing&&M.length===0);){var Z=M.length;if(f("maybeReadMore read 0"),L.read(0),Z===M.length)break}M.readingMore=!1}function D(L){var M=L._readableState;M.readableListening=L.listenerCount("readable")>0,M.resumeScheduled&&!M.paused?M.flowing=!0:L.listenerCount("data")>0&&L.resume()}function U(L){f("readable nexttick read 0"),L.read(0)}function P(L,M){f("resume",M.reading),M.reading||L.read(0),M.resumeScheduled=!1,L.emit("resume"),K(L),M.flowing&&!M.reading&&L.read(0)}function K(L){var M=L._readableState;for(f("flow",M.flowing);M.flowing&&L.read()!==null;);}function Y(L,M){return M.length===0?null:(M.objectMode?Z=M.buffer.shift():!L||L>=M.length?(Z=M.decoder?M.buffer.join(""):M.buffer.length===1?M.buffer.first():M.buffer.concat(M.length),M.buffer.clear()):Z=M.buffer.consume(L,M.decoder),Z);var Z}function re(L){var M=L._readableState;f("endReadable",M.endEmitted),M.endEmitted||(M.ended=!0,o.nextTick(z,M,L))}function z(L,M){if(f("endReadableNT",L.endEmitted,L.length),!L.endEmitted&&L.length===0&&(L.endEmitted=!0,M.readable=!1,M.emit("end"),L.autoDestroy)){var Z=M._writableState;(!Z||Z.autoDestroy&&Z.finished)&&M.destroy()}}function ee(L,M){for(var Z=0,se=L.length;Z<se;Z++)if(L[Z]===M)return Z;return-1}H.prototype.read=function(L){f("read",L),L=parseInt(L,10);var M=this._readableState,Z=L;if(L!==0&&(M.emittedReadable=!1),L===0&&M.needReadable&&((M.highWaterMark!==0?M.length>=M.highWaterMark:M.length>0)||M.ended))return f("read: emitReadable",M.length,M.ended),M.length===0&&M.ended?re(this):w(this),null;if((L=C(L,M))===0&&M.ended)return M.length===0&&re(this),null;var se,ae=M.needReadable;return f("need readable",ae),(M.length===0||M.length-L<M.highWaterMark)&&f("length less than watermark",ae=!0),M.ended||M.reading?f("reading or ended",ae=!1):ae&&(f("do read"),M.reading=!0,M.sync=!0,M.length===0&&(M.needReadable=!0),this._read(M.highWaterMark),M.sync=!1,M.reading||(L=C(Z,M))),(se=L>0?Y(L,M):null)===null?(M.needReadable=M.length<=M.highWaterMark,L=0):(M.length-=L,M.awaitDrain=0),M.length===0&&(M.ended||(M.needReadable=!0),Z!==L&&M.ended&&re(this)),se!==null&&this.emit("data",se),se},H.prototype._read=function(L){q(this,new W("_read()"))},H.prototype.pipe=function(L,M){var Z=this,se=this._readableState;switch(se.pipesCount){case 0:se.pipes=L;break;case 1:se.pipes=[se.pipes,L];break;default:se.pipes.push(L)}se.pipesCount+=1,f("pipe count=%d opts=%j",se.pipesCount,M);var ae=(!M||M.end!==!1)&&L!==o.stdout&&L!==o.stderr?Q:ke;function ne(Ce,Fe){f("onunpipe"),Ce===Z&&Fe&&Fe.hasUnpiped===!1&&(Fe.hasUnpiped=!0,f("cleanup"),L.removeListener("close",he),L.removeListener("finish",Ee),L.removeListener("drain",fe),L.removeListener("error",ce),L.removeListener("unpipe",ne),Z.removeListener("end",Q),Z.removeListener("end",ke),Z.removeListener("data",te),le=!0,!se.awaitDrain||L._writableState&&!L._writableState.needDrain||fe())}function Q(){f("onend"),L.end()}se.endEmitted?o.nextTick(ae):Z.once("end",ae),L.on("unpipe",ne);var fe=function(Ce){return function(){var Fe=Ce._readableState;f("pipeOnDrain",Fe.awaitDrain),Fe.awaitDrain&&Fe.awaitDrain--,Fe.awaitDrain===0&&c(Ce,"data")&&(Fe.flowing=!0,K(Ce))}}(Z);L.on("drain",fe);var le=!1;function te(Ce){f("ondata");var Fe=L.write(Ce);f("dest.write",Fe),Fe===!1&&((se.pipesCount===1&&se.pipes===L||se.pipesCount>1&&ee(se.pipes,L)!==-1)&&!le&&(f("false write response, pause",se.awaitDrain),se.awaitDrain++),Z.pause())}function ce(Ce){f("onerror",Ce),ke(),L.removeListener("error",ce),c(L,"error")===0&&q(L,Ce)}function he(){L.removeListener("finish",Ee),ke()}function Ee(){f("onfinish"),L.removeListener("close",he),ke()}function ke(){f("unpipe"),Z.unpipe(L)}return Z.on("data",te),function(Ce,Fe,Pe){if(typeof Ce.prependListener=="function")return Ce.prependListener(Fe,Pe);Ce._events&&Ce._events[Fe]?Array.isArray(Ce._events[Fe])?Ce._events[Fe].unshift(Pe):Ce._events[Fe]=[Pe,Ce._events[Fe]]:Ce.on(Fe,Pe)}(L,"error",ce),L.once("close",he),L.once("finish",Ee),L.emit("pipe",Z),se.flowing||(f("pipe resume"),Z.resume()),L},H.prototype.unpipe=function(L){var M=this._readableState,Z={hasUnpiped:!1};if(M.pipesCount===0)return this;if(M.pipesCount===1)return L&&L!==M.pipes||(L||(L=M.pipes),M.pipes=null,M.pipesCount=0,M.flowing=!1,L&&L.emit("unpipe",this,Z)),this;if(!L){var se=M.pipes,ae=M.pipesCount;M.pipes=null,M.pipesCount=0,M.flowing=!1;for(var ne=0;ne<ae;ne++)se[ne].emit("unpipe",this,{hasUnpiped:!1});return this}var Q=ee(M.pipes,L);return Q===-1||(M.pipes.splice(Q,1),M.pipesCount-=1,M.pipesCount===1&&(M.pipes=M.pipes[0]),L.emit("unpipe",this,Z)),this},H.prototype.on=function(L,M){var Z=i.prototype.on.call(this,L,M),se=this._readableState;return L==="data"?(se.readableListening=this.listenerCount("readable")>0,se.flowing!==!1&&this.resume()):L==="readable"&&(se.endEmitted||se.readableListening||(se.readableListening=se.needReadable=!0,se.flowing=!1,se.emittedReadable=!1,f("on readable",se.length,se.reading),se.length?w(this):se.reading||o.nextTick(U,this))),Z},H.prototype.addListener=H.prototype.on,H.prototype.removeListener=function(L,M){var Z=i.prototype.removeListener.call(this,L,M);return L==="readable"&&o.nextTick(D,this),Z},H.prototype.removeAllListeners=function(L){var M=i.prototype.removeAllListeners.apply(this,arguments);return L!=="readable"&&L!==void 0||o.nextTick(D,this),M},H.prototype.resume=function(){var L=this._readableState;return L.flowing||(f("resume"),L.flowing=!L.readableListening,function(M,Z){Z.resumeScheduled||(Z.resumeScheduled=!0,o.nextTick(P,M,Z))}(this,L)),L.paused=!1,this},H.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},H.prototype.wrap=function(L){var M=this,Z=this._readableState,se=!1;for(var ae in L.on("end",function(){if(f("wrapped end"),Z.decoder&&!Z.ended){var Q=Z.decoder.end();Q&&Q.length&&M.push(Q)}M.push(null)}),L.on("data",function(Q){f("wrapped data"),Z.decoder&&(Q=Z.decoder.write(Q)),Z.objectMode&&Q==null||(Z.objectMode||Q&&Q.length)&&(M.push(Q)||(se=!0,L.pause()))}),L)this[ae]===void 0&&typeof L[ae]=="function"&&(this[ae]=function(Q){return function(){return L[Q].apply(L,arguments)}}(ae));for(var ne=0;ne<X.length;ne++)L.on(X[ne],this.emit.bind(this,X[ne]));return this._read=function(Q){f("wrapped _read",Q),se&&(se=!1,L.resume())},this},typeof Symbol=="function"&&(H.prototype[Symbol.asyncIterator]=function(){return b===void 0&&(b=e("./internal/streams/async_iterator")),b(this)}),Object.defineProperty(H.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(H.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(H.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(L){this._readableState&&(this._readableState.flowing=L)}}),H._fromList=Y,Object.defineProperty(H.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(H.from=function(L,M){return g===void 0&&(g=e("./internal/streams/from")),g(H,L,M)})}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/async_iterator":483,"./internal/streams/buffer_list":484,"./internal/streams/destroy":485,"./internal/streams/from":487,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,events:422,inherits:440,"string_decoder/":522,util:188}],481:[function(e,n,a){n.exports=f;var o=e("../errors").codes,s=o.ERR_METHOD_NOT_IMPLEMENTED,l=o.ERR_MULTIPLE_CALLBACK,c=o.ERR_TRANSFORM_ALREADY_TRANSFORMING,i=o.ERR_TRANSFORM_WITH_LENGTH_0,u=e("./_stream_duplex");function p(b,g){var x=this._transformState;x.transforming=!1;var y=x.writecb;if(y===null)return this.emit("error",new l);x.writechunk=null,x.writecb=null,g!=null&&this.push(g),y(b);var k=this._readableState;k.reading=!1,(k.needReadable||k.length<k.highWaterMark)&&this._read(k.highWaterMark)}function f(b){if(!(this instanceof f))return new f(b);u.call(this,b),this._transformState={afterTransform:p.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,b&&(typeof b.transform=="function"&&(this._transform=b.transform),typeof b.flush=="function"&&(this._flush=b.flush)),this.on("prefinish",h)}function h(){var b=this;typeof this._flush!="function"||this._readableState.destroyed?v(this,null,null):this._flush(function(g,x){v(b,g,x)})}function v(b,g,x){if(g)return b.emit("error",g);if(x!=null&&b.push(x),b._writableState.length)throw new i;if(b._transformState.transforming)throw new c;return b.push(null)}e("inherits")(f,u),f.prototype.push=function(b,g){return this._transformState.needTransform=!1,u.prototype.push.call(this,b,g)},f.prototype._transform=function(b,g,x){x(new s("_transform()"))},f.prototype._write=function(b,g,x){var y=this._transformState;if(y.writecb=x,y.writechunk=b,y.writeencoding=g,!y.transforming){var k=this._readableState;(y.needTransform||k.needReadable||k.length<k.highWaterMark)&&this._read(k.highWaterMark)}},f.prototype._read=function(b){var g=this._transformState;g.writechunk===null||g.transforming?g.needTransform=!0:(g.transforming=!0,this._transform(g.writechunk,g.writeencoding,g.afterTransform))},f.prototype._destroy=function(b,g){u.prototype._destroy.call(this,b,function(x){g(x)})}},{"../errors":477,"./_stream_duplex":478,inherits:440}],482:[function(e,n,a){(function(o,s){(function(){function l(T){var D=this;this.next=null,this.entry=null,this.finish=function(){(function(U,P,K){var Y=U.entry;for(U.entry=null;Y;){var re=Y.callback;P.pendingcb--,re(K),Y=Y.next}P.corkedRequestsFree.next=U})(D,T)}}var c;n.exports=H,H.WritableState=I;var i={deprecate:e("util-deprecate")},u=e("./internal/streams/stream"),p=e("buffer").Buffer,f=(s!==void 0?s:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},h,v=e("./internal/streams/destroy"),b=e("./internal/streams/state").getHighWaterMark,g=e("../errors").codes,x=g.ERR_INVALID_ARG_TYPE,y=g.ERR_METHOD_NOT_IMPLEMENTED,k=g.ERR_MULTIPLE_CALLBACK,N=g.ERR_STREAM_CANNOT_PIPE,F=g.ERR_STREAM_DESTROYED,B=g.ERR_STREAM_NULL_VALUES,W=g.ERR_STREAM_WRITE_AFTER_END,V=g.ERR_UNKNOWN_ENCODING,q=v.errorOrDestroy;function X(){}function I(T,D,U){c=c||e("./_stream_duplex"),T=T||{},typeof U!="boolean"&&(U=D instanceof c),this.objectMode=!!T.objectMode,U&&(this.objectMode=this.objectMode||!!T.writableObjectMode),this.highWaterMark=b(this,T,"writableHighWaterMark",U),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var P=T.decodeStrings===!1;this.decodeStrings=!P,this.defaultEncoding=T.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(K){(function(Y,re){var z=Y._writableState,ee=z.sync,L=z.writecb;if(typeof L!="function")throw new k;if(function(Z){Z.writing=!1,Z.writecb=null,Z.length-=Z.writelen,Z.writelen=0}(z),re)(function(Z,se,ae,ne,Q){--se.pendingcb,ae?(o.nextTick(Q,ne),o.nextTick(A,Z,se),Z._writableState.errorEmitted=!0,q(Z,ne)):(Q(ne),Z._writableState.errorEmitted=!0,q(Z,ne),A(Z,se))})(Y,z,ee,re,L);else{var M=w(z)||Y.destroyed;M||z.corked||z.bufferProcessing||!z.bufferedRequest||C(Y,z),ee?o.nextTick(R,Y,z,M,L):R(Y,z,M,L)}})(D,K)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=T.emitClose!==!1,this.autoDestroy=!!T.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new l(this)}function H(T){var D=this instanceof(c=c||e("./_stream_duplex"));if(!D&&!h.call(H,this))return new H(T);this._writableState=new I(T,this,D),this.writable=!0,T&&(typeof T.write=="function"&&(this._write=T.write),typeof T.writev=="function"&&(this._writev=T.writev),typeof T.destroy=="function"&&(this._destroy=T.destroy),typeof T.final=="function"&&(this._final=T.final)),u.call(this)}function O(T,D,U,P,K,Y,re){D.writelen=P,D.writecb=re,D.writing=!0,D.sync=!0,D.destroyed?D.onwrite(new F("write")):U?T._writev(K,D.onwrite):T._write(K,Y,D.onwrite),D.sync=!1}function R(T,D,U,P){U||function(K,Y){Y.length===0&&Y.needDrain&&(Y.needDrain=!1,K.emit("drain"))}(T,D),D.pendingcb--,P(),A(T,D)}function C(T,D){D.bufferProcessing=!0;var U=D.bufferedRequest;if(T._writev&&U&&U.next){var P=D.bufferedRequestCount,K=new Array(P),Y=D.corkedRequestsFree;Y.entry=U;for(var re=0,z=!0;U;)K[re]=U,U.isBuf||(z=!1),U=U.next,re+=1;K.allBuffers=z,O(T,D,!0,D.length,K,"",Y.finish),D.pendingcb++,D.lastBufferedRequest=null,Y.next?(D.corkedRequestsFree=Y.next,Y.next=null):D.corkedRequestsFree=new l(D),D.bufferedRequestCount=0}else{for(;U;){var ee=U.chunk,L=U.encoding,M=U.callback;if(O(T,D,!1,D.objectMode?1:ee.length,ee,L,M),U=U.next,D.bufferedRequestCount--,D.writing)break}U===null&&(D.lastBufferedRequest=null)}D.bufferedRequest=U,D.bufferProcessing=!1}function w(T){return T.ending&&T.length===0&&T.bufferedRequest===null&&!T.finished&&!T.writing}function E(T,D){T._final(function(U){D.pendingcb--,U&&q(T,U),D.prefinished=!0,T.emit("prefinish"),A(T,D)})}function A(T,D){var U=w(D);if(U&&(function(K,Y){Y.prefinished||Y.finalCalled||(typeof K._final!="function"||Y.destroyed?(Y.prefinished=!0,K.emit("prefinish")):(Y.pendingcb++,Y.finalCalled=!0,o.nextTick(E,K,Y)))}(T,D),D.pendingcb===0&&(D.finished=!0,T.emit("finish"),D.autoDestroy))){var P=T._readableState;(!P||P.autoDestroy&&P.endEmitted)&&T.destroy()}return U}e("inherits")(H,u),I.prototype.getBuffer=function(){for(var T=this.bufferedRequest,D=[];T;)D.push(T),T=T.next;return D},function(){try{Object.defineProperty(I.prototype,"buffer",{get:i.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(h=Function.prototype[Symbol.hasInstance],Object.defineProperty(H,Symbol.hasInstance,{value:function(T){return!!h.call(this,T)||this===H&&T&&T._writableState instanceof I}})):h=function(T){return T instanceof this},H.prototype.pipe=function(){q(this,new N)},H.prototype.write=function(T,D,U){var P,K=this._writableState,Y=!1,re=!K.objectMode&&(P=T,p.isBuffer(P)||P instanceof f);return re&&!p.isBuffer(T)&&(T=function(z){return p.from(z)}(T)),typeof D=="function"&&(U=D,D=null),re?D="buffer":D||(D=K.defaultEncoding),typeof U!="function"&&(U=X),K.ending?function(z,ee){var L=new W;q(z,L),o.nextTick(ee,L)}(this,U):(re||function(z,ee,L,M){var Z;return L===null?Z=new B:typeof L=="string"||ee.objectMode||(Z=new x("chunk",["string","Buffer"],L)),!Z||(q(z,Z),o.nextTick(M,Z),!1)}(this,K,T,U))&&(K.pendingcb++,Y=function(z,ee,L,M,Z,se){if(!L){var ae=function(le,te,ce){return le.objectMode||le.decodeStrings===!1||typeof te!="string"||(te=p.from(te,ce)),te}(ee,M,Z);M!==ae&&(L=!0,Z="buffer",M=ae)}var ne=ee.objectMode?1:M.length;ee.length+=ne;var Q=ee.length<ee.highWaterMark;if(Q||(ee.needDrain=!0),ee.writing||ee.corked){var fe=ee.lastBufferedRequest;ee.lastBufferedRequest={chunk:M,encoding:Z,isBuf:L,callback:se,next:null},fe?fe.next=ee.lastBufferedRequest:ee.bufferedRequest=ee.lastBufferedRequest,ee.bufferedRequestCount+=1}else O(z,ee,!1,ne,M,Z,se);return Q}(this,K,re,T,D,U)),Y},H.prototype.cork=function(){this._writableState.corked++},H.prototype.uncork=function(){var T=this._writableState;T.corked&&(T.corked--,T.writing||T.corked||T.bufferProcessing||!T.bufferedRequest||C(this,T))},H.prototype.setDefaultEncoding=function(T){if(typeof T=="string"&&(T=T.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((T+"").toLowerCase())>-1))throw new V(T);return this._writableState.defaultEncoding=T,this},Object.defineProperty(H.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(H.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),H.prototype._write=function(T,D,U){U(new y("_write()"))},H.prototype._writev=null,H.prototype.end=function(T,D,U){var P=this._writableState;return typeof T=="function"?(U=T,T=null,D=null):typeof D=="function"&&(U=D,D=null),T!=null&&this.write(T,D),P.corked&&(P.corked=1,this.uncork()),P.ending||function(K,Y,re){Y.ending=!0,A(K,Y),re&&(Y.finished?o.nextTick(re):K.once("finish",re)),Y.ended=!0,K.writable=!1}(this,P,U),this},Object.defineProperty(H.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(H.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(T){this._writableState&&(this._writableState.destroyed=T)}}),H.prototype.destroy=v.destroy,H.prototype._undestroy=v.undestroy,H.prototype._destroy=function(T,D){D(T)}}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/destroy":485,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,inherits:440,"util-deprecate":524}],483:[function(e,n,a){(function(o){(function(){var s;function l(F,B,W){return(B=function(V){var q=function(X,I){if(typeof X!="object"||X===null)return X;var H=X[Symbol.toPrimitive];if(H!==void 0){var O=H.call(X,I);if(typeof O!="object")return O;throw new TypeError("@@toPrimitive must return a primitive value.")}return(I==="string"?String:Number)(X)}(V,"string");return typeof q=="symbol"?q:String(q)}(B))in F?Object.defineProperty(F,B,{value:W,enumerable:!0,configurable:!0,writable:!0}):F[B]=W,F}var c=e("./end-of-stream"),i=Symbol("lastResolve"),u=Symbol("lastReject"),p=Symbol("error"),f=Symbol("ended"),h=Symbol("lastPromise"),v=Symbol("handlePromise"),b=Symbol("stream");function g(F,B){return{value:F,done:B}}function x(F){var B=F[i];if(B!==null){var W=F[b].read();W!==null&&(F[h]=null,F[i]=null,F[u]=null,B(g(W,!1)))}}function y(F){o.nextTick(x,F)}var k=Object.getPrototypeOf(function(){}),N=Object.setPrototypeOf((l(s={get stream(){return this[b]},next:function(){var F=this,B=this[p];if(B!==null)return Promise.reject(B);if(this[f])return Promise.resolve(g(void 0,!0));if(this[b].destroyed)return new Promise(function(X,I){o.nextTick(function(){F[p]?I(F[p]):X(g(void 0,!0))})});var W,V=this[h];if(V)W=new Promise(function(X,I){return function(H,O){X.then(function(){I[f]?H(g(void 0,!0)):I[v](H,O)},O)}}(V,this));else{var q=this[b].read();if(q!==null)return Promise.resolve(g(q,!1));W=new Promise(this[v])}return this[h]=W,W}},Symbol.asyncIterator,function(){return this}),l(s,"return",function(){var F=this;return new Promise(function(B,W){F[b].destroy(null,function(V){V?W(V):B(g(void 0,!0))})})}),s),k);n.exports=function(F){var B,W=Object.create(N,(l(B={},b,{value:F,writable:!0}),l(B,i,{value:null,writable:!0}),l(B,u,{value:null,writable:!0}),l(B,p,{value:null,writable:!0}),l(B,f,{value:F._readableState.endEmitted,writable:!0}),l(B,v,{value:function(V,q){var X=W[b].read();X?(W[h]=null,W[i]=null,W[u]=null,V(g(X,!1))):(W[i]=V,W[u]=q)},writable:!0}),B));return W[h]=null,c(F,function(V){if(V&&V.code!=="ERR_STREAM_PREMATURE_CLOSE"){var q=W[u];return q!==null&&(W[h]=null,W[i]=null,W[u]=null,q(V)),void(W[p]=V)}var X=W[i];X!==null&&(W[h]=null,W[i]=null,W[u]=null,X(g(void 0,!0))),W[f]=!0}),F.on("readable",y.bind(null,W)),W}}).call(this)}).call(this,e("_process"))},{"./end-of-stream":486,_process:467}],484:[function(e,n,a){function o(h,v){var b=Object.keys(h);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(h);v&&(g=g.filter(function(x){return Object.getOwnPropertyDescriptor(h,x).enumerable})),b.push.apply(b,g)}return b}function s(h){for(var v=1;v<arguments.length;v++){var b=arguments[v]!=null?arguments[v]:{};v%2?o(Object(b),!0).forEach(function(g){l(h,g,b[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(b)):o(Object(b)).forEach(function(g){Object.defineProperty(h,g,Object.getOwnPropertyDescriptor(b,g))})}return h}function l(h,v,b){return(v=i(v))in h?Object.defineProperty(h,v,{value:b,enumerable:!0,configurable:!0,writable:!0}):h[v]=b,h}function c(h,v){for(var b=0;b<v.length;b++){var g=v[b];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(h,i(g.key),g)}}function i(h){var v=function(b,g){if(typeof b!="object"||b===null)return b;var x=b[Symbol.toPrimitive];if(x!==void 0){var y=x.call(b,g);if(typeof y!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return(g==="string"?String:Number)(b)}(h,"string");return typeof v=="symbol"?v:String(v)}var u=e("buffer").Buffer,p=e("util").inspect,f=p&&p.custom||"inspect";n.exports=function(){function h(){(function(g,x){if(!(g instanceof x))throw new TypeError("Cannot call a class as a function")})(this,h),this.head=null,this.tail=null,this.length=0}var v,b;return v=h,(b=[{key:"push",value:function(g){var x={data:g,next:null};this.length>0?this.tail.next=x:this.head=x,this.tail=x,++this.length}},{key:"unshift",value:function(g){var x={data:g,next:this.head};this.length===0&&(this.tail=x),this.head=x,++this.length}},{key:"shift",value:function(){if(this.length!==0){var g=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,g}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(g){if(this.length===0)return"";for(var x=this.head,y=""+x.data;x=x.next;)y+=g+x.data;return y}},{key:"concat",value:function(g){if(this.length===0)return u.alloc(0);for(var x,y,k,N=u.allocUnsafe(g>>>0),F=this.head,B=0;F;)x=F.data,y=N,k=B,u.prototype.copy.call(x,y,k),B+=F.data.length,F=F.next;return N}},{key:"consume",value:function(g,x){var y;return g<this.head.data.length?(y=this.head.data.slice(0,g),this.head.data=this.head.data.slice(g)):y=g===this.head.data.length?this.shift():x?this._getString(g):this._getBuffer(g),y}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(g){var x=this.head,y=1,k=x.data;for(g-=k.length;x=x.next;){var N=x.data,F=g>N.length?N.length:g;if(F===N.length?k+=N:k+=N.slice(0,g),(g-=F)==0){F===N.length?(++y,x.next?this.head=x.next:this.head=this.tail=null):(this.head=x,x.data=N.slice(F));break}++y}return this.length-=y,k}},{key:"_getBuffer",value:function(g){var x=u.allocUnsafe(g),y=this.head,k=1;for(y.data.copy(x),g-=y.data.length;y=y.next;){var N=y.data,F=g>N.length?N.length:g;if(N.copy(x,x.length-g,0,F),(g-=F)==0){F===N.length?(++k,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=N.slice(F));break}++k}return this.length-=k,x}},{key:f,value:function(g,x){return p(this,s(s({},x),{},{depth:0,customInspect:!1}))}}])&&c(v.prototype,b),Object.defineProperty(v,"prototype",{writable:!1}),h}()},{buffer:220,util:188}],485:[function(e,n,a){(function(o){(function(){function s(i,u){c(i,u),l(i)}function l(i){i._writableState&&!i._writableState.emitClose||i._readableState&&!i._readableState.emitClose||i.emit("close")}function c(i,u){i.emit("error",u)}n.exports={destroy:function(i,u){var p=this,f=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return f||h?(u?u(i):i&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,o.nextTick(c,this,i)):o.nextTick(c,this,i)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(i||null,function(v){!u&&v?p._writableState?p._writableState.errorEmitted?o.nextTick(l,p):(p._writableState.errorEmitted=!0,o.nextTick(s,p,v)):o.nextTick(s,p,v):u?(o.nextTick(l,p),u(v)):o.nextTick(l,p)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(i,u){var p=i._readableState,f=i._writableState;p&&p.autoDestroy||f&&f.autoDestroy?i.destroy(u):i.emit("error",u)}}}).call(this)}).call(this,e("_process"))},{_process:467}],486:[function(e,n,a){var o=e("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function s(){}n.exports=function l(c,i,u){if(typeof i=="function")return l(c,null,i);i||(i={}),u=function(F){var B=!1;return function(){if(!B){B=!0;for(var W=arguments.length,V=new Array(W),q=0;q<W;q++)V[q]=arguments[q];F.apply(this,V)}}}(u||s);var p=i.readable||i.readable!==!1&&c.readable,f=i.writable||i.writable!==!1&&c.writable,h=function(){c.writable||b()},v=c._writableState&&c._writableState.finished,b=function(){f=!1,v=!0,p||u.call(c)},g=c._readableState&&c._readableState.endEmitted,x=function(){p=!1,g=!0,f||u.call(c)},y=function(F){u.call(c,F)},k=function(){var F;return p&&!g?(c._readableState&&c._readableState.ended||(F=new o),u.call(c,F)):f&&!v?(c._writableState&&c._writableState.ended||(F=new o),u.call(c,F)):void 0},N=function(){c.req.on("finish",b)};return function(F){return F.setHeader&&typeof F.abort=="function"}(c)?(c.on("complete",b),c.on("abort",k),c.req?N():c.on("request",N)):f&&!c._writableState&&(c.on("end",h),c.on("close",h)),c.on("end",x),c.on("finish",b),i.error!==!1&&c.on("error",y),c.on("close",k),function(){c.removeListener("complete",b),c.removeListener("abort",k),c.removeListener("request",N),c.req&&c.req.removeListener("finish",b),c.removeListener("end",h),c.removeListener("close",h),c.removeListener("finish",b),c.removeListener("end",x),c.removeListener("error",y),c.removeListener("close",k)}}},{"../../../errors":477}],487:[function(e,n,a){n.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],488:[function(e,n,a){var o,s=e("../../../errors").codes,l=s.ERR_MISSING_ARGS,c=s.ERR_STREAM_DESTROYED;function i(v){if(v)throw v}function u(v,b,g,x){x=function(N){var F=!1;return function(){F||(F=!0,N.apply(void 0,arguments))}}(x);var y=!1;v.on("close",function(){y=!0}),o===void 0&&(o=e("./end-of-stream")),o(v,{readable:b,writable:g},function(N){if(N)return x(N);y=!0,x()});var k=!1;return function(N){if(!y&&!k)return k=!0,function(F){return F.setHeader&&typeof F.abort=="function"}(v)?v.abort():typeof v.destroy=="function"?v.destroy():void x(N||new c("pipe"))}}function p(v){v()}function f(v,b){return v.pipe(b)}function h(v){return v.length?typeof v[v.length-1]!="function"?i:v.pop():i}n.exports=function(){for(var v=arguments.length,b=new Array(v),g=0;g<v;g++)b[g]=arguments[g];var x,y=h(b);if(Array.isArray(b[0])&&(b=b[0]),b.length<2)throw new l("streams");var k=b.map(function(N,F){var B=F<b.length-1;return u(N,B,F>0,function(W){x||(x=W),W&&k.forEach(p),B||(k.forEach(p),y(x))})});return b.reduce(f)}},{"../../../errors":477,"./end-of-stream":486}],489:[function(e,n,a){var o=e("../../../errors").codes.ERR_INVALID_OPT_VALUE;n.exports={getHighWaterMark:function(s,l,c,i){var u=function(p,f,h){return p.highWaterMark!=null?p.highWaterMark:f?p[h]:null}(l,i,c);if(u!=null){if(!isFinite(u)||Math.floor(u)!==u||u<0)throw new o(i?c:"highWaterMark",u);return Math.floor(u)}return s.objectMode?16:16384}}},{"../../../errors":477}],490:[function(e,n,a){n.exports=e("events").EventEmitter},{events:422}],491:[function(e,n,a){(a=n.exports=e("./lib/_stream_readable.js")).Stream=a,a.Readable=a,a.Writable=e("./lib/_stream_writable.js"),a.Duplex=e("./lib/_stream_duplex.js"),a.Transform=e("./lib/_stream_transform.js"),a.PassThrough=e("./lib/_stream_passthrough.js"),a.finished=e("./lib/internal/streams/end-of-stream.js"),a.pipeline=e("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":478,"./lib/_stream_passthrough.js":479,"./lib/_stream_readable.js":480,"./lib/_stream_transform.js":481,"./lib/_stream_writable.js":482,"./lib/internal/streams/end-of-stream.js":486,"./lib/internal/streams/pipeline.js":488}],492:[function(e,n,a){var o=function(s){var l=Object.prototype,c=l.hasOwnProperty,i=Object.defineProperty||function(A,T,D){A[T]=D.value},u=typeof Symbol=="function"?Symbol:{},p=u.iterator||"@@iterator",f=u.asyncIterator||"@@asyncIterator",h=u.toStringTag||"@@toStringTag";function v(A,T,D){return Object.defineProperty(A,T,{value:D,enumerable:!0,configurable:!0,writable:!0}),A[T]}try{v({},"")}catch{v=function(T,D,U){return T[D]=U}}function b(A,T,D,U){var P=T&&T.prototype instanceof y?T:y,K=Object.create(P.prototype),Y=new C(U||[]);return i(K,"_invoke",{value:I(A,D,Y)}),K}function g(A,T,D){try{return{type:"normal",arg:A.call(T,D)}}catch(U){return{type:"throw",arg:U}}}s.wrap=b;var x={};function y(){}function k(){}function N(){}var F={};v(F,p,function(){return this});var B=Object.getPrototypeOf,W=B&&B(B(w([])));W&&W!==l&&c.call(W,p)&&(F=W);var V=N.prototype=y.prototype=Object.create(F);function q(A){["next","throw","return"].forEach(function(T){v(A,T,function(D){return this._invoke(T,D)})})}function X(A,T){var D;i(this,"_invoke",{value:function(U,P){function K(){return new T(function(Y,re){(function z(ee,L,M,Z){var se=g(A[ee],A,L);if(se.type!=="throw"){var ae=se.arg,ne=ae.value;return ne&&typeof ne=="object"&&c.call(ne,"__await")?T.resolve(ne.__await).then(function(Q){z("next",Q,M,Z)},function(Q){z("throw",Q,M,Z)}):T.resolve(ne).then(function(Q){ae.value=Q,M(ae)},function(Q){return z("throw",Q,M,Z)})}Z(se.arg)})(U,P,Y,re)})}return D=D?D.then(K,K):K()}})}function I(A,T,D){var U="suspendedStart";return function(P,K){if(U==="executing")throw new Error("Generator is already running");if(U==="completed"){if(P==="throw")throw K;return E()}for(D.method=P,D.arg=K;;){var Y=D.delegate;if(Y){var re=H(Y,D);if(re){if(re===x)continue;return re}}if(D.method==="next")D.sent=D._sent=D.arg;else if(D.method==="throw"){if(U==="suspendedStart")throw U="completed",D.arg;D.dispatchException(D.arg)}else D.method==="return"&&D.abrupt("return",D.arg);U="executing";var z=g(A,T,D);if(z.type==="normal"){if(U=D.done?"completed":"suspendedYield",z.arg===x)continue;return{value:z.arg,done:D.done}}z.type==="throw"&&(U="completed",D.method="throw",D.arg=z.arg)}}}function H(A,T){var D=T.method,U=A.iterator[D];if(U===void 0)return T.delegate=null,D==="throw"&&A.iterator.return&&(T.method="return",T.arg=void 0,H(A,T),T.method==="throw")||D!=="return"&&(T.method="throw",T.arg=new TypeError("The iterator does not provide a '"+D+"' method")),x;var P=g(U,A.iterator,T.arg);if(P.type==="throw")return T.method="throw",T.arg=P.arg,T.delegate=null,x;var K=P.arg;return K?K.done?(T[A.resultName]=K.value,T.next=A.nextLoc,T.method!=="return"&&(T.method="next",T.arg=void 0),T.delegate=null,x):K:(T.method="throw",T.arg=new TypeError("iterator result is not an object"),T.delegate=null,x)}function O(A){var T={tryLoc:A[0]};1 in A&&(T.catchLoc=A[1]),2 in A&&(T.finallyLoc=A[2],T.afterLoc=A[3]),this.tryEntries.push(T)}function R(A){var T=A.completion||{};T.type="normal",delete T.arg,A.completion=T}function C(A){this.tryEntries=[{tryLoc:"root"}],A.forEach(O,this),this.reset(!0)}function w(A){if(A){var T=A[p];if(T)return T.call(A);if(typeof A.next=="function")return A;if(!isNaN(A.length)){var D=-1,U=function P(){for(;++D<A.length;)if(c.call(A,D))return P.value=A[D],P.done=!1,P;return P.value=void 0,P.done=!0,P};return U.next=U}}return{next:E}}function E(){return{value:void 0,done:!0}}return k.prototype=N,i(V,"constructor",{value:N,configurable:!0}),i(N,"constructor",{value:k,configurable:!0}),k.displayName=v(N,h,"GeneratorFunction"),s.isGeneratorFunction=function(A){var T=typeof A=="function"&&A.constructor;return!!T&&(T===k||(T.displayName||T.name)==="GeneratorFunction")},s.mark=function(A){return Object.setPrototypeOf?Object.setPrototypeOf(A,N):(A.__proto__=N,v(A,h,"GeneratorFunction")),A.prototype=Object.create(V),A},s.awrap=function(A){return{__await:A}},q(X.prototype),v(X.prototype,f,function(){return this}),s.AsyncIterator=X,s.async=function(A,T,D,U,P){P===void 0&&(P=Promise);var K=new X(b(A,T,D,U),P);return s.isGeneratorFunction(T)?K:K.next().then(function(Y){return Y.done?Y.value:K.next()})},q(V),v(V,h,"Generator"),v(V,p,function(){return this}),v(V,"toString",function(){return"[object Generator]"}),s.keys=function(A){var T=Object(A),D=[];for(var U in T)D.push(U);return D.reverse(),function P(){for(;D.length;){var K=D.pop();if(K in T)return P.value=K,P.done=!1,P}return P.done=!0,P}},s.values=w,C.prototype={constructor:C,reset:function(A){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(R),!A)for(var T in this)T.charAt(0)==="t"&&c.call(this,T)&&!isNaN(+T.slice(1))&&(this[T]=void 0)},stop:function(){this.done=!0;var A=this.tryEntries[0].completion;if(A.type==="throw")throw A.arg;return this.rval},dispatchException:function(A){if(this.done)throw A;var T=this;function D(z,ee){return K.type="throw",K.arg=A,T.next=z,ee&&(T.method="next",T.arg=void 0),!!ee}for(var U=this.tryEntries.length-1;U>=0;--U){var P=this.tryEntries[U],K=P.completion;if(P.tryLoc==="root")return D("end");if(P.tryLoc<=this.prev){var Y=c.call(P,"catchLoc"),re=c.call(P,"finallyLoc");if(Y&&re){if(this.prev<P.catchLoc)return D(P.catchLoc,!0);if(this.prev<P.finallyLoc)return D(P.finallyLoc)}else if(Y){if(this.prev<P.catchLoc)return D(P.catchLoc,!0)}else{if(!re)throw new Error("try statement without catch or finally");if(this.prev<P.finallyLoc)return D(P.finallyLoc)}}}},abrupt:function(A,T){for(var D=this.tryEntries.length-1;D>=0;--D){var U=this.tryEntries[D];if(U.tryLoc<=this.prev&&c.call(U,"finallyLoc")&&this.prev<U.finallyLoc){var P=U;break}}P&&(A==="break"||A==="continue")&&P.tryLoc<=T&&T<=P.finallyLoc&&(P=null);var K=P?P.completion:{};return K.type=A,K.arg=T,P?(this.method="next",this.next=P.finallyLoc,x):this.complete(K)},complete:function(A,T){if(A.type==="throw")throw A.arg;return A.type==="break"||A.type==="continue"?this.next=A.arg:A.type==="return"?(this.rval=this.arg=A.arg,this.method="return",this.next="end"):A.type==="normal"&&T&&(this.next=T),x},finish:function(A){for(var T=this.tryEntries.length-1;T>=0;--T){var D=this.tryEntries[T];if(D.finallyLoc===A)return this.complete(D.completion,D.afterLoc),R(D),x}},catch:function(A){for(var T=this.tryEntries.length-1;T>=0;--T){var D=this.tryEntries[T];if(D.tryLoc===A){var U=D.completion;if(U.type==="throw"){var P=U.arg;R(D)}return P}}throw new Error("illegal catch attempt")},delegateYield:function(A,T,D){return this.delegate={iterator:w(A),resultName:T,nextLoc:D},this.method==="next"&&(this.arg=void 0),x}},s}(typeof n=="object"?n.exports:{});try{regeneratorRuntime=o}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=o:Function("r","regeneratorRuntime = r")(o)}},{}],493:[function(e,n,a){var o=e("buffer").Buffer,s=e("inherits"),l=e("hash-base"),c=new Array(16),i=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],u=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],p=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],f=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],h=[0,1518500249,1859775393,2400959708,2840853838],v=[1352829926,1548603684,1836072691,2053994217,0];function b(){l.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function g(B,W){return B<<W|B>>>32-W}function x(B,W,V,q,X,I,H,O){return g(B+(W^V^q)+I+H|0,O)+X|0}function y(B,W,V,q,X,I,H,O){return g(B+(W&V|~W&q)+I+H|0,O)+X|0}function k(B,W,V,q,X,I,H,O){return g(B+((W|~V)^q)+I+H|0,O)+X|0}function N(B,W,V,q,X,I,H,O){return g(B+(W&q|V&~q)+I+H|0,O)+X|0}function F(B,W,V,q,X,I,H,O){return g(B+(W^(V|~q))+I+H|0,O)+X|0}s(b,l),b.prototype._update=function(){for(var B=c,W=0;W<16;++W)B[W]=this._block.readInt32LE(4*W);for(var V=0|this._a,q=0|this._b,X=0|this._c,I=0|this._d,H=0|this._e,O=0|this._a,R=0|this._b,C=0|this._c,w=0|this._d,E=0|this._e,A=0;A<80;A+=1){var T,D;A<16?(T=x(V,q,X,I,H,B[i[A]],h[0],p[A]),D=F(O,R,C,w,E,B[u[A]],v[0],f[A])):A<32?(T=y(V,q,X,I,H,B[i[A]],h[1],p[A]),D=N(O,R,C,w,E,B[u[A]],v[1],f[A])):A<48?(T=k(V,q,X,I,H,B[i[A]],h[2],p[A]),D=k(O,R,C,w,E,B[u[A]],v[2],f[A])):A<64?(T=N(V,q,X,I,H,B[i[A]],h[3],p[A]),D=y(O,R,C,w,E,B[u[A]],v[3],f[A])):(T=F(V,q,X,I,H,B[i[A]],h[4],p[A]),D=x(O,R,C,w,E,B[u[A]],v[4],f[A])),V=H,H=I,I=g(X,10),X=q,q=T,O=E,E=w,w=g(C,10),C=R,R=D}var U=this._b+X+w|0;this._b=this._c+I+E|0,this._c=this._d+H+O|0,this._d=this._e+V+R|0,this._e=this._a+q+C|0,this._a=U},b.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var B=o.alloc?o.alloc(20):new o(20);return B.writeInt32LE(this._a,0),B.writeInt32LE(this._b,4),B.writeInt32LE(this._c,8),B.writeInt32LE(this._d,12),B.writeInt32LE(this._e,16),B},n.exports=b},{buffer:220,"hash-base":425,inherits:440}],494:[function(e,n,a){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var o=e("buffer"),s=o.Buffer;function l(i,u){for(var p in i)u[p]=i[p]}function c(i,u,p){return s(i,u,p)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?n.exports=o:(l(o,a),a.Buffer=c),c.prototype=Object.create(s.prototype),l(s,c),c.from=function(i,u,p){if(typeof i=="number")throw new TypeError("Argument must not be a number");return s(i,u,p)},c.alloc=function(i,u,p){if(typeof i!="number")throw new TypeError("Argument must be a number");var f=s(i);return u!==void 0?typeof p=="string"?f.fill(u,p):f.fill(u):f.fill(0),f},c.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return s(i)},c.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return o.SlowBuffer(i)}},{buffer:220}],495:[function(e,n,a){(function(o){(function(){var s,l=e("buffer"),c=l.Buffer,i={};for(s in l)l.hasOwnProperty(s)&&s!=="SlowBuffer"&&s!=="Buffer"&&(i[s]=l[s]);var u=i.Buffer={};for(s in c)c.hasOwnProperty(s)&&s!=="allocUnsafe"&&s!=="allocUnsafeSlow"&&(u[s]=c[s]);if(i.Buffer.prototype=c.prototype,u.from&&u.from!==Uint8Array.from||(u.from=function(p,f,h){if(typeof p=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof p);if(p&&p.length===void 0)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p);return c(p,f,h)}),u.alloc||(u.alloc=function(p,f,h){if(typeof p!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof p);if(p<0||p>=2*(1<<30))throw new RangeError('The value "'+p+'" is invalid for option "size"');var v=c(p);return f&&f.length!==0?typeof h=="string"?v.fill(f,h):v.fill(f):v.fill(0),v}),!i.kStringMaxLength)try{i.kStringMaxLength=o.binding("buffer").kStringMaxLength}catch{}i.constants||(i.constants={MAX_LENGTH:i.kMaxLength},i.kStringMaxLength&&(i.constants.MAX_STRING_LENGTH=i.kStringMaxLength)),n.exports=i}).call(this)}).call(this,e("_process"))},{_process:467,buffer:220}],496:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0});const o=e("xmlchars/xml/1.0/ed5"),s=e("xmlchars/xml/1.1/ed2"),l=e("xmlchars/xmlns/1.0/ed3");var c=o.isS,i=o.isChar,u=o.isNameStartChar,p=o.isNameChar,f=o.S_LIST,h=o.NAME_RE,v=s.isChar,b=l.isNCNameStartChar,g=l.isNCNameChar,x=l.NC_NAME_RE;const y="http://www.w3.org/XML/1998/namespace",k="http://www.w3.org/2000/xmlns/",N={__proto__:null,xml:y,xmlns:k},F={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},B=w=>w===34||w===39,W=[34,39],V=[...W,91,62],q=[...W,60,93],X=[61,63,...f],I=[...f,62,38,60];function H(w,E,A){switch(E){case"xml":A!==y&&w.fail(`xml prefix must be bound to ${y}.`);break;case"xmlns":A!==k&&w.fail(`xmlns prefix must be bound to ${k}.`)}switch(A){case k:w.fail(E===""?`the default namespace may not be set to ${A}.`:`may not assign a prefix (even "xmlns") to the URI ${k}.`);break;case y:switch(E){case"xml":break;case"":w.fail(`the default namespace may not be set to ${A}.`);break;default:w.fail("may not assign the xml namespace to another prefix.")}}}const O=w=>x.test(w),R=w=>h.test(w);a.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const C={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};a.SaxesParser=class{constructor(w){this.opt=w??{},this.fragmentOpt=!!this.opt.fragment;const E=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,E){this.nameStartCheck=b,this.nameCheck=g,this.isName=O,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},N);const A=this.opt.additionalNamespaces;A!=null&&(function(T,D){for(const U of Object.keys(D))H(T,U,D[U])}(this,A),Object.assign(this.ns,A))}else this.nameStartCheck=u,this.nameCheck=p,this.isName=R,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var w;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:E}=this;this.state=E?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=E,this.xmlDeclPossible=!E,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:A}=this.opt;if(A===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");A="1.0"}this.setXMLVersion(A),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(F),(w=this.readyHandler)===null||w===void 0||w.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(w,E){this[C[w]]=E}off(w){this[C[w]]=void 0}makeError(w){var E;let A=(E=this.fileName)!==null&&E!==void 0?E:"";return this.trackPosition&&(A.length>0&&(A+=":"),A+=`${this.line}:${this.column}`),A.length>0&&(A+=": "),new Error(A+w)}fail(w){const E=this.makeError(w),A=this.errorHandler;if(A===void 0)throw E;return A(E),this}write(w){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let E=!1;w===null?(E=!0,w=""):typeof w=="object"&&(w=w.toString()),this.carriedFromPrevious!==void 0&&(w=`${this.carriedFromPrevious}${w}`,this.carriedFromPrevious=void 0);let A=w.length;const T=w.charCodeAt(A-1);!E&&(T===13||T>=55296&&T<=56319)&&(this.carriedFromPrevious=w[A-1],A--,w=w.slice(0,A));const{stateTable:D}=this;for(this.chunk=w,this.i=0;this.i<A;)D[this.state].call(this);return this.chunkPosition+=A,E?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:w,i:E}=this;if(this.prevI=E,this.i=E+1,E>=w.length)return-1;const A=w.charCodeAt(E);if(this.column++,A<55296){if(A>=32||A===9)return A;switch(A){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return w.charCodeAt(E+1)===10&&(this.i=E+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),A}}if(A>56319)return A>=57344&&A<=65533||this.fail("disallowed character."),A;const T=65536+1024*(A-55296)+(w.charCodeAt(E+1)-56320);return this.i=E+2,T>1114111&&this.fail("disallowed character."),T}getCode11(){const{chunk:w,i:E}=this;if(this.prevI=E,this.i=E+1,E>=w.length)return-1;const A=w.charCodeAt(E);if(this.column++,A<55296){if(A>31&&A<127||A>159&&A!==8232||A===9)return A;switch(A){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{const D=w.charCodeAt(E+1);D!==10&&D!==133||(this.i=E+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),A}}if(A>56319)return A>=57344&&A<=65533||this.fail("disallowed character."),A;const T=65536+1024*(A-55296)+(w.charCodeAt(E+1)-56320);return this.i=E+2,T>1114111&&this.fail("disallowed character."),T}getCodeNorm(){const w=this.getCode();return w===-2?10:w}unget(){this.i=this.prevI,this.column--}captureTo(w){let{i:E}=this;const{chunk:A}=this;for(;;){const T=this.getCode(),D=T===-2,U=D?10:T;if(U===-1||w.includes(U))return this.text+=A.slice(E,this.prevI),U;D&&(this.text+=A.slice(E,this.prevI)+`
`,E=this.i)}}captureToChar(w){let{i:E}=this;const{chunk:A}=this;for(;;){let T=this.getCode();switch(T){case-2:this.text+=A.slice(E,this.prevI)+`
`,E=this.i,T=10;break;case-1:return this.text+=A.slice(E),!1}if(T===w)return this.text+=A.slice(E,this.prevI),!0}}captureNameChars(){const{chunk:w,i:E}=this;for(;;){const A=this.getCode();if(A===-1)return this.name+=w.slice(E),-1;if(!p(A))return this.name+=w.slice(E,this.prevI),A===-2?10:A}}skipSpaces(){for(;;){const w=this.getCodeNorm();if(w===-1||!c(w))return w}}setXMLVersion(w){this.currentXMLVersion=w,w==="1.0"?(this.isChar=i,this.getCode=this.getCode10):(this.isChar=v,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const w=this.i,E=this.skipSpaces();switch(this.prevI!==w&&(this.xmlDeclPossible=!1),E){case 60:if(this.state=15,this.text.length!==0)throw new Error("no-empty text at start");break;case-1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var w;const E=this.captureTo(V);switch(E){case 62:(w=this.doctypeHandler)===null||w===void 0||w.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case-1:break;default:this.text+=String.fromCodePoint(E),E===91?this.state=4:B(E)&&(this.state=3,this.q=E)}}sDoctypeQuote(){const w=this.q;this.captureToChar(w)&&(this.text+=String.fromCodePoint(w),this.q=null,this.state=2)}sDTD(){const w=this.captureTo(q);w!==-1&&(this.text+=String.fromCodePoint(w),w===93?this.state=2:w===60?this.state=6:B(w)&&(this.state=5,this.q=w))}sDTDQuoted(){const w=this.q;this.captureToChar(w)&&(this.text+=String.fromCodePoint(w),this.state=4,this.q=null)}sDTDOpenWaka(){const w=this.getCodeNorm();switch(this.text+=String.fromCodePoint(w),w){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const w=String.fromCodePoint(this.getCodeNorm()),E=this.openWakaBang+=w;this.text+=w,E!=="-"&&(this.state=E==="--"?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const w=this.getCodeNorm();this.text+=String.fromCodePoint(w),this.state=w===45?10:8}sDTDCommentEnded(){const w=this.getCodeNorm();this.text+=String.fromCodePoint(w),w===62?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const w=this.getCodeNorm();this.text+=String.fromCodePoint(w),w===62&&(this.state=4)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:w}=this;const{chunk:E}=this;e:for(;;)switch(this.getCode()){case-2:this.entity+=E.slice(w,this.prevI)+`
`,w=this.i;break;case 59:{const{entityReturnState:A}=this,T=this.entity+E.slice(w,this.prevI);let D;this.state=A,T===""?(this.fail("empty entity name."),D="&;"):(D=this.parseEntity(T),this.entity=""),A===13&&this.textHandler===void 0||(this.text+=D);break e}case-1:this.entity+=E.slice(w);break e}}sOpenWaka(){const w=this.getCode();if(u(w))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(w){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var w;const E=this.getCodeNorm();E===45?(this.state=19,(w=this.commentHandler)===null||w===void 0||w.call(this,this.text),this.text=""):(this.text+="-"+String.fromCodePoint(E),this.state=17)}sCommentEnded(){const w=this.getCodeNorm();w!==62?(this.fail("malformed comment."),this.text+="--"+String.fromCodePoint(w),this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){const w=this.getCodeNorm();w===93?this.state=22:(this.text+="]"+String.fromCodePoint(w),this.state=20)}sCDataEnding2(){var w;const E=this.getCodeNorm();switch(E){case 62:(w=this.cdataHandler)===null||w===void 0||w.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+="]]"+String.fromCodePoint(E),this.state=20}}sPIFirstChar(){const w=this.getCodeNorm();this.nameStartCheck(w)?(this.piTarget+=String.fromCodePoint(w),this.state=24):w===63||c(w)?(this.fail("processing instruction without a target."),this.state=w===63?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(w),this.state=24)}sPIRest(){const{chunk:w,i:E}=this;for(;;){const A=this.getCodeNorm();if(A===-1)return void(this.piTarget+=w.slice(E));if(!this.nameCheck(A)){this.piTarget+=w.slice(E,this.prevI);const T=A===63;T||c(A)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=T?33:27):this.state=T?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(A));break}}}sPIBody(){if(this.text.length===0){const w=this.getCodeNorm();w===63?this.state=26:c(w)||(this.text=String.fromCodePoint(w))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var w;const E=this.getCodeNorm();if(E===62){const{piTarget:A}=this;A.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(w=this.piHandler)===null||w===void 0||w.call(this,{target:A,body:this.text}),this.piTarget=this.text="",this.state=13}else E===63?this.text+="?":(this.text+="?"+String.fromCodePoint(E),this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const w=this.skipSpaces();w!==63?w!==-1&&(this.state=28,this.name=String.fromCodePoint(w)):this.state=33}sXMLDeclName(){const w=this.captureTo(X);if(w===63)return this.state=33,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(c(w)||w===61){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail("expected one of "+this.xmlDeclExpects.join(", "))}this.state=w===61?30:29}}sXMLDeclEq(){const w=this.getCodeNorm();if(w===63)return this.state=33,void this.fail("XML declaration is incomplete.");c(w)||(w!==61&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const w=this.getCodeNorm();if(w===63)return this.state=33,void this.fail("XML declaration is incomplete.");c(w)||(B(w)?this.q=w:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const w=this.captureTo([this.q,63]);if(w===63)return this.state=33,this.text="",void this.fail("XML declaration is incomplete.");if(w===-1)return;const E=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const A=E;this.xmlDecl.version=A,/^1\.[0-9]+$/.test(A)?this.opt.forceXMLVersion||this.setXMLVersion(A):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(E)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=E;break;case"standalone":E!=="yes"&&E!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=E}this.name="",this.state=32}sXMLDeclSeparator(){const w=this.getCodeNorm();w!==63?(c(w)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=33}sXMLDeclEnding(){var w;this.getCodeNorm()===62?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(w=this.xmldeclHandler)===null||w===void 0||w.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var w;const E=this.captureNameChars();if(E===-1)return;const A=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=A.ns=Object.create(null)),(w=this.openTagStartHandler)===null||w===void 0||w.call(this,A),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),E){case 62:this.openTag();break;case 47:this.state=35;break;default:c(E)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){this.getCode()===62?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const w=this.skipSpaces();w!==-1&&(u(w)?(this.unget(),this.state=37):w===62?this.openTag():w===47?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const w=this.captureNameChars();w===61?this.state=39:c(w)?this.state=38:w===62?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):w!==-1&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const w=this.skipSpaces();switch(w){case-1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",w===62?this.openTag():u(w)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const w=this.getCodeNorm();B(w)?(this.q=w,this.state=40):c(w)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){const{q:w,chunk:E}=this;let{i:A}=this;for(;;)switch(this.getCode()){case w:return this.pushAttrib(this.name,this.text+E.slice(A,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=E.slice(A,this.prevI),this.state=14,void(this.entityReturnState=40);case 10:case-2:case 9:this.text+=E.slice(A,this.prevI)+" ",A=this.i;break;case 60:return this.text+=E.slice(A,this.prevI),void this.fail("disallowed character.");case-1:return void(this.text+=E.slice(A))}}sAttribValueClosed(){const w=this.getCodeNorm();c(w)?this.state=36:w===62?this.openTag():w===47?this.state=35:u(w)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const w=this.captureTo(I);switch(w){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case-1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",w===62?this.openTag():this.state=36}}sCloseTag(){const w=this.captureNameChars();w===62?this.closeTag():c(w)?this.state=44:w!==-1&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case-1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:w,forbiddenState:E}=this;const{chunk:A,textHandler:T}=this;e:for(;;)switch(this.getCode()){case 60:if(this.state=15,T!==void 0){const{text:D}=this,U=A.slice(w,this.prevI);D.length!==0?(T(D+U),this.text=""):U.length!==0&&T(U)}E=0;break e;case 38:this.state=14,this.entityReturnState=13,T!==void 0&&(this.text+=A.slice(w,this.prevI)),E=0;break e;case 93:switch(E){case 0:E=1;break;case 1:E=2;break;case 2:break;default:throw new Error("impossible state")}break;case 62:E===2&&this.fail('the string "]]>" is disallowed in char data.'),E=0;break;case-2:T!==void 0&&(this.text+=A.slice(w,this.prevI)+`
`),w=this.i,E=0;break;case-1:T!==void 0&&(this.text+=A.slice(w));break e;default:E=0}this.forbiddenState=E}handleTextOutsideRoot(){let{i:w}=this;const{chunk:E,textHandler:A}=this;let T=!1;e:for(;;){const D=this.getCode();switch(D){case 60:if(this.state=15,A!==void 0){const{text:U}=this,P=E.slice(w,this.prevI);U.length!==0?(A(U+P),this.text=""):P.length!==0&&A(P)}break e;case 38:this.state=14,this.entityReturnState=13,A!==void 0&&(this.text+=E.slice(w,this.prevI)),T=!0;break e;case-2:A!==void 0&&(this.text+=E.slice(w,this.prevI)+`
`),w=this.i;break;case-1:A!==void 0&&(this.text+=E.slice(w));break e;default:c(D)||(T=!0)}}T&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(w,E){var A;const{prefix:T,local:D}=this.qname(w),U={name:w,prefix:T,local:D,value:E};if(this.attribList.push(U),(A=this.attributeHandler)===null||A===void 0||A.call(this,U),T==="xmlns"){const P=E.trim();this.currentXMLVersion==="1.0"&&P===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[D]=P,H(this,D,P)}else if(w==="xmlns"){const P=E.trim();this.topNS[""]=P,H(this,"",P)}}pushAttribPlain(w,E){var A;const T={name:w,value:E};this.attribList.push(T),(A=this.attributeHandler)===null||A===void 0||A.call(this,T)}end(){var w,E;this.sawRoot||this.fail("document must contain a root element.");const{tags:A}=this;for(;A.length>0;){const D=A.pop();this.fail("unclosed tag: "+D.name)}this.state!==0&&this.state!==13&&this.fail("unexpected end.");const{text:T}=this;return T.length!==0&&((w=this.textHandler)===null||w===void 0||w.call(this,T),this.text=""),this._closed=!0,(E=this.endHandler)===null||E===void 0||E.call(this),this._init(),this}resolve(w){var E,A;let T=this.topNS[w];if(T!==void 0)return T;const{tags:D}=this;for(let U=D.length-1;U>=0;U--)if(T=D[U].ns[w],T!==void 0)return T;return T=this.ns[w],T!==void 0?T:(A=(E=this.opt).resolvePrefix)===null||A===void 0?void 0:A.call(E,w)}qname(w){const E=w.indexOf(":");if(E===-1)return{prefix:"",local:w};const A=w.slice(E+1),T=w.slice(0,E);return(T===""||A===""||A.includes(":"))&&this.fail(`malformed name: ${w}.`),{prefix:T,local:A}}processAttribsNS(){var w;const{attribList:E}=this,A=this.tag;{const{prefix:U,local:P}=this.qname(A.name);A.prefix=U,A.local=P;const K=A.uri=(w=this.resolve(U))!==null&&w!==void 0?w:"";U!==""&&(U==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),K===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(U)}.`),A.uri=U))}if(E.length===0)return;const{attributes:T}=A,D=new Set;for(const U of E){const{name:P,prefix:K,local:Y}=U;let re,z;K===""?(re=P==="xmlns"?k:"",z=P):(re=this.resolve(K),re===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(K)}.`),re=K),z=`{${re}}${Y}`),D.has(z)&&this.fail(`duplicate attribute: ${z}.`),D.add(z),U.uri=re,T[P]=U}this.attribList=[]}processAttribsPlain(){const{attribList:w}=this,E=this.tag.attributes;for(const{name:A,value:T}of w)E[A]!==void 0&&this.fail(`duplicate attribute: ${A}.`),E[A]=T;this.attribList=[]}openTag(){var w;this.processAttribs();const{tags:E}=this,A=this.tag;A.isSelfClosing=!1,(w=this.openTagHandler)===null||w===void 0||w.call(this,A),E.push(A),this.state=13,this.name=""}openSelfClosingTag(){var w,E,A;this.processAttribs();const{tags:T}=this,D=this.tag;D.isSelfClosing=!0,(w=this.openTagHandler)===null||w===void 0||w.call(this,D),(E=this.closeTagHandler)===null||E===void 0||E.call(this,D),(this.tag=(A=T[T.length-1])!==null&&A!==void 0?A:null)===null&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){const{tags:w,name:E}=this;if(this.state=13,this.name="",E==="")return this.fail("weird empty close tag."),void(this.text+="</>");const A=this.closeTagHandler;let T=w.length;for(;T-- >0;){const D=this.tag=w.pop();if(this.topNS=D.ns,A==null||A(D),D.name===E)break;this.fail("unexpected close tag.")}T===0?this.closedRoot=!0:T<0&&(this.fail(`unmatched closing tag: ${E}.`),this.text+=`</${E}>`)}parseEntity(w){if(w[0]!=="#"){const A=this.ENTITIES[w];return A!==void 0?A:(this.fail(this.isName(w)?"undefined entity.":"disallowed character in entity name."),`&${w};`)}let E=NaN;return w[1]==="x"&&/^#x[0-9a-f]+$/i.test(w)?E=parseInt(w.slice(2),16):/^#[0-9]+$/.test(w)&&(E=parseInt(w.slice(1),10)),this.isChar(E)?String.fromCodePoint(E):(this.fail("malformed character entity."),`&${w};`)}}},{"xmlchars/xml/1.0/ed5":543,"xmlchars/xml/1.1/ed2":544,"xmlchars/xmlns/1.0/ed3":545}],497:[function(e,n,a){var o=e("safe-buffer").Buffer;function s(l,c){this._block=o.alloc(l),this._finalSize=c,this._blockSize=l,this._len=0}s.prototype.update=function(l,c){typeof l=="string"&&(c=c||"utf8",l=o.from(l,c));for(var i=this._block,u=this._blockSize,p=l.length,f=this._len,h=0;h<p;){for(var v=f%u,b=Math.min(p-h,u-v),g=0;g<b;g++)i[v+g]=l[h+g];h+=b,(f+=b)%u==0&&this._update(i)}return this._len+=p,this},s.prototype.digest=function(l){var c=this._len%this._blockSize;this._block[c]=128,this._block.fill(0,c+1),c>=this._finalSize&&(this._update(this._block),this._block.fill(0));var i=8*this._len;if(i<=4294967295)this._block.writeUInt32BE(i,this._blockSize-4);else{var u=(4294967295&i)>>>0,p=(i-u)/4294967296;this._block.writeUInt32BE(p,this._blockSize-8),this._block.writeUInt32BE(u,this._blockSize-4)}this._update(this._block);var f=this._hash();return l?f.toString(l):f},s.prototype._update=function(){throw new Error("_update must be implemented by subclass")},n.exports=s},{"safe-buffer":494}],498:[function(e,n,a){var o=n.exports=function(s){s=s.toLowerCase();var l=o[s];if(!l)throw new Error(s+" is not supported (we accept pull requests)");return new l};o.sha=e("./sha"),o.sha1=e("./sha1"),o.sha224=e("./sha224"),o.sha256=e("./sha256"),o.sha384=e("./sha384"),o.sha512=e("./sha512")},{"./sha":499,"./sha1":500,"./sha224":501,"./sha256":502,"./sha384":503,"./sha512":504}],499:[function(e,n,a){var o=e("inherits"),s=e("./hash"),l=e("safe-buffer").Buffer,c=[1518500249,1859775393,-1894007588,-899497514],i=new Array(80);function u(){this.init(),this._w=i,s.call(this,64,56)}function p(h){return h<<30|h>>>2}function f(h,v,b,g){return h===0?v&b|~v&g:h===2?v&b|v&g|b&g:v^b^g}o(u,s),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(h){for(var v,b=this._w,g=0|this._a,x=0|this._b,y=0|this._c,k=0|this._d,N=0|this._e,F=0;F<16;++F)b[F]=h.readInt32BE(4*F);for(;F<80;++F)b[F]=b[F-3]^b[F-8]^b[F-14]^b[F-16];for(var B=0;B<80;++B){var W=~~(B/20),V=0|((v=g)<<5|v>>>27)+f(W,x,y,k)+N+b[B]+c[W];N=k,k=y,y=p(x),x=g,g=V}this._a=g+this._a|0,this._b=x+this._b|0,this._c=y+this._c|0,this._d=k+this._d|0,this._e=N+this._e|0},u.prototype._hash=function(){var h=l.allocUnsafe(20);return h.writeInt32BE(0|this._a,0),h.writeInt32BE(0|this._b,4),h.writeInt32BE(0|this._c,8),h.writeInt32BE(0|this._d,12),h.writeInt32BE(0|this._e,16),h},n.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],500:[function(e,n,a){var o=e("inherits"),s=e("./hash"),l=e("safe-buffer").Buffer,c=[1518500249,1859775393,-1894007588,-899497514],i=new Array(80);function u(){this.init(),this._w=i,s.call(this,64,56)}function p(v){return v<<5|v>>>27}function f(v){return v<<30|v>>>2}function h(v,b,g,x){return v===0?b&g|~b&x:v===2?b&g|b&x|g&x:b^g^x}o(u,s),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(v){for(var b,g=this._w,x=0|this._a,y=0|this._b,k=0|this._c,N=0|this._d,F=0|this._e,B=0;B<16;++B)g[B]=v.readInt32BE(4*B);for(;B<80;++B)g[B]=(b=g[B-3]^g[B-8]^g[B-14]^g[B-16])<<1|b>>>31;for(var W=0;W<80;++W){var V=~~(W/20),q=p(x)+h(V,y,k,N)+F+g[W]+c[V]|0;F=N,N=k,k=f(y),y=x,x=q}this._a=x+this._a|0,this._b=y+this._b|0,this._c=k+this._c|0,this._d=N+this._d|0,this._e=F+this._e|0},u.prototype._hash=function(){var v=l.allocUnsafe(20);return v.writeInt32BE(0|this._a,0),v.writeInt32BE(0|this._b,4),v.writeInt32BE(0|this._c,8),v.writeInt32BE(0|this._d,12),v.writeInt32BE(0|this._e,16),v},n.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],501:[function(e,n,a){var o=e("inherits"),s=e("./sha256"),l=e("./hash"),c=e("safe-buffer").Buffer,i=new Array(64);function u(){this.init(),this._w=i,l.call(this,64,56)}o(u,s),u.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},u.prototype._hash=function(){var p=c.allocUnsafe(28);return p.writeInt32BE(this._a,0),p.writeInt32BE(this._b,4),p.writeInt32BE(this._c,8),p.writeInt32BE(this._d,12),p.writeInt32BE(this._e,16),p.writeInt32BE(this._f,20),p.writeInt32BE(this._g,24),p},n.exports=u},{"./hash":497,"./sha256":502,inherits:440,"safe-buffer":494}],502:[function(e,n,a){var o=e("inherits"),s=e("./hash"),l=e("safe-buffer").Buffer,c=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],i=new Array(64);function u(){this.init(),this._w=i,s.call(this,64,56)}function p(g,x,y){return y^g&(x^y)}function f(g,x,y){return g&x|y&(g|x)}function h(g){return(g>>>2|g<<30)^(g>>>13|g<<19)^(g>>>22|g<<10)}function v(g){return(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7)}function b(g){return(g>>>7|g<<25)^(g>>>18|g<<14)^g>>>3}o(u,s),u.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},u.prototype._update=function(g){for(var x,y=this._w,k=0|this._a,N=0|this._b,F=0|this._c,B=0|this._d,W=0|this._e,V=0|this._f,q=0|this._g,X=0|this._h,I=0;I<16;++I)y[I]=g.readInt32BE(4*I);for(;I<64;++I)y[I]=0|(((x=y[I-2])>>>17|x<<15)^(x>>>19|x<<13)^x>>>10)+y[I-7]+b(y[I-15])+y[I-16];for(var H=0;H<64;++H){var O=X+v(W)+p(W,V,q)+c[H]+y[H]|0,R=h(k)+f(k,N,F)|0;X=q,q=V,V=W,W=B+O|0,B=F,F=N,N=k,k=O+R|0}this._a=k+this._a|0,this._b=N+this._b|0,this._c=F+this._c|0,this._d=B+this._d|0,this._e=W+this._e|0,this._f=V+this._f|0,this._g=q+this._g|0,this._h=X+this._h|0},u.prototype._hash=function(){var g=l.allocUnsafe(32);return g.writeInt32BE(this._a,0),g.writeInt32BE(this._b,4),g.writeInt32BE(this._c,8),g.writeInt32BE(this._d,12),g.writeInt32BE(this._e,16),g.writeInt32BE(this._f,20),g.writeInt32BE(this._g,24),g.writeInt32BE(this._h,28),g},n.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],503:[function(e,n,a){var o=e("inherits"),s=e("./sha512"),l=e("./hash"),c=e("safe-buffer").Buffer,i=new Array(160);function u(){this.init(),this._w=i,l.call(this,128,112)}o(u,s),u.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},u.prototype._hash=function(){var p=c.allocUnsafe(48);function f(h,v,b){p.writeInt32BE(h,b),p.writeInt32BE(v,b+4)}return f(this._ah,this._al,0),f(this._bh,this._bl,8),f(this._ch,this._cl,16),f(this._dh,this._dl,24),f(this._eh,this._el,32),f(this._fh,this._fl,40),p},n.exports=u},{"./hash":497,"./sha512":504,inherits:440,"safe-buffer":494}],504:[function(e,n,a){var o=e("inherits"),s=e("./hash"),l=e("safe-buffer").Buffer,c=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],i=new Array(160);function u(){this.init(),this._w=i,s.call(this,128,112)}function p(N,F,B){return B^N&(F^B)}function f(N,F,B){return N&F|B&(N|F)}function h(N,F){return(N>>>28|F<<4)^(F>>>2|N<<30)^(F>>>7|N<<25)}function v(N,F){return(N>>>14|F<<18)^(N>>>18|F<<14)^(F>>>9|N<<23)}function b(N,F){return(N>>>1|F<<31)^(N>>>8|F<<24)^N>>>7}function g(N,F){return(N>>>1|F<<31)^(N>>>8|F<<24)^(N>>>7|F<<25)}function x(N,F){return(N>>>19|F<<13)^(F>>>29|N<<3)^N>>>6}function y(N,F){return(N>>>19|F<<13)^(F>>>29|N<<3)^(N>>>6|F<<26)}function k(N,F){return N>>>0<F>>>0?1:0}o(u,s),u.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},u.prototype._update=function(N){for(var F=this._w,B=0|this._ah,W=0|this._bh,V=0|this._ch,q=0|this._dh,X=0|this._eh,I=0|this._fh,H=0|this._gh,O=0|this._hh,R=0|this._al,C=0|this._bl,w=0|this._cl,E=0|this._dl,A=0|this._el,T=0|this._fl,D=0|this._gl,U=0|this._hl,P=0;P<32;P+=2)F[P]=N.readInt32BE(4*P),F[P+1]=N.readInt32BE(4*P+4);for(;P<160;P+=2){var K=F[P-30],Y=F[P-30+1],re=b(K,Y),z=g(Y,K),ee=x(K=F[P-4],Y=F[P-4+1]),L=y(Y,K),M=F[P-14],Z=F[P-14+1],se=F[P-32],ae=F[P-32+1],ne=z+Z|0,Q=re+M+k(ne,z)|0;Q=(Q=Q+ee+k(ne=ne+L|0,L)|0)+se+k(ne=ne+ae|0,ae)|0,F[P]=Q,F[P+1]=ne}for(var fe=0;fe<160;fe+=2){Q=F[fe],ne=F[fe+1];var le=f(B,W,V),te=f(R,C,w),ce=h(B,R),he=h(R,B),Ee=v(X,A),ke=v(A,X),Ce=c[fe],Fe=c[fe+1],Pe=p(X,I,H),Xe=p(A,T,D),ct=U+ke|0,st=O+Ee+k(ct,U)|0;st=(st=(st=st+Pe+k(ct=ct+Xe|0,Xe)|0)+Ce+k(ct=ct+Fe|0,Fe)|0)+Q+k(ct=ct+ne|0,ne)|0;var lt=he+te|0,tt=ce+le+k(lt,he)|0;O=H,U=D,H=I,D=T,I=X,T=A,X=q+st+k(A=E+ct|0,E)|0,q=V,E=w,V=W,w=C,W=B,C=R,B=st+tt+k(R=ct+lt|0,ct)|0}this._al=this._al+R|0,this._bl=this._bl+C|0,this._cl=this._cl+w|0,this._dl=this._dl+E|0,this._el=this._el+A|0,this._fl=this._fl+T|0,this._gl=this._gl+D|0,this._hl=this._hl+U|0,this._ah=this._ah+B+k(this._al,R)|0,this._bh=this._bh+W+k(this._bl,C)|0,this._ch=this._ch+V+k(this._cl,w)|0,this._dh=this._dh+q+k(this._dl,E)|0,this._eh=this._eh+X+k(this._el,A)|0,this._fh=this._fh+I+k(this._fl,T)|0,this._gh=this._gh+H+k(this._gl,D)|0,this._hh=this._hh+O+k(this._hl,U)|0},u.prototype._hash=function(){var N=l.allocUnsafe(64);function F(B,W,V){N.writeInt32BE(B,V),N.writeInt32BE(W,V+4)}return F(this._ah,this._al,0),F(this._bh,this._bl,8),F(this._ch,this._cl,16),F(this._dh,this._dl,24),F(this._eh,this._el,32),F(this._fh,this._fl,40),F(this._gh,this._gl,48),F(this._hh,this._hl,56),N},n.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],505:[function(e,n,a){n.exports=s;var o=e("events").EventEmitter;function s(){o.call(this)}e("inherits")(s,o),s.Readable=e("readable-stream/readable.js"),s.Writable=e("readable-stream/writable.js"),s.Duplex=e("readable-stream/duplex.js"),s.Transform=e("readable-stream/transform.js"),s.PassThrough=e("readable-stream/passthrough.js"),s.Stream=s,s.prototype.pipe=function(l,c){var i=this;function u(x){l.writable&&l.write(x)===!1&&i.pause&&i.pause()}function p(){i.readable&&i.resume&&i.resume()}i.on("data",u),l.on("drain",p),l._isStdio||c&&c.end===!1||(i.on("end",h),i.on("close",v));var f=!1;function h(){f||(f=!0,l.end())}function v(){f||(f=!0,typeof l.destroy=="function"&&l.destroy())}function b(x){if(g(),o.listenerCount(this,"error")===0)throw x}function g(){i.removeListener("data",u),l.removeListener("drain",p),i.removeListener("end",h),i.removeListener("close",v),i.removeListener("error",b),l.removeListener("error",b),i.removeListener("end",g),i.removeListener("close",g),l.removeListener("close",g)}return i.on("error",b),l.on("error",b),i.on("end",g),i.on("close",g),l.on("close",g),l.emit("pipe",i),l}},{events:422,inherits:440,"readable-stream/duplex.js":507,"readable-stream/passthrough.js":516,"readable-stream/readable.js":517,"readable-stream/transform.js":518,"readable-stream/writable.js":519}],506:[function(e,n,a){var o={}.toString;n.exports=Array.isArray||function(s){return o.call(s)=="[object Array]"}},{}],507:[function(e,n,a){n.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":508}],508:[function(e,n,a){var o=e("process-nextick-args"),s=Object.keys||function(g){var x=[];for(var y in g)x.push(y);return x};n.exports=h;var l=Object.create(e("core-util-is"));l.inherits=e("inherits");var c=e("./_stream_readable"),i=e("./_stream_writable");l.inherits(h,c);for(var u=s(i.prototype),p=0;p<u.length;p++){var f=u[p];h.prototype[f]||(h.prototype[f]=i.prototype[f])}function h(g){if(!(this instanceof h))return new h(g);c.call(this,g),i.call(this,g),g&&g.readable===!1&&(this.readable=!1),g&&g.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,g&&g.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",v)}function v(){this.allowHalfOpen||this._writableState.ended||o.nextTick(b,this)}function b(g){g.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(g){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=g,this._writableState.destroyed=g)}}),h.prototype._destroy=function(g,x){this.push(null),this.end(),o.nextTick(x,g)}},{"./_stream_readable":510,"./_stream_writable":512,"core-util-is":383,inherits:440,"process-nextick-args":466}],509:[function(e,n,a){n.exports=l;var o=e("./_stream_transform"),s=Object.create(e("core-util-is"));function l(c){if(!(this instanceof l))return new l(c);o.call(this,c)}s.inherits=e("inherits"),s.inherits(l,o),l.prototype._transform=function(c,i,u){u(null,c)}},{"./_stream_transform":511,"core-util-is":383,inherits:440}],510:[function(e,n,a){(function(o,s){(function(){var l=e("process-nextick-args");n.exports=B;var c,i=e("isarray");B.ReadableState=F,e("events").EventEmitter;var u=function(U,P){return U.listeners(P).length},p=e("./internal/streams/stream"),f=e("safe-buffer").Buffer,h=(s!==void 0?s:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},v=Object.create(e("core-util-is"));v.inherits=e("inherits");var b=e("util"),g=void 0;g=b&&b.debuglog?b.debuglog("stream"):function(){};var x,y=e("./internal/streams/BufferList"),k=e("./internal/streams/destroy");v.inherits(B,p);var N=["error","close","destroy","pause","resume"];function F(U,P){U=U||{};var K=P instanceof(c=c||e("./_stream_duplex"));this.objectMode=!!U.objectMode,K&&(this.objectMode=this.objectMode||!!U.readableObjectMode);var Y=U.highWaterMark,re=U.readableHighWaterMark,z=this.objectMode?16:16384;this.highWaterMark=Y||Y===0?Y:K&&(re||re===0)?re:z,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=U.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,U.encoding&&(x||(x=e("string_decoder/").StringDecoder),this.decoder=new x(U.encoding),this.encoding=U.encoding)}function B(U){if(c=c||e("./_stream_duplex"),!(this instanceof B))return new B(U);this._readableState=new F(U,this),this.readable=!0,U&&(typeof U.read=="function"&&(this._read=U.read),typeof U.destroy=="function"&&(this._destroy=U.destroy)),p.call(this)}function W(U,P,K,Y,re){var z,ee=U._readableState;return P===null?(ee.reading=!1,function(L,M){if(!M.ended){if(M.decoder){var Z=M.decoder.end();Z&&Z.length&&(M.buffer.push(Z),M.length+=M.objectMode?1:Z.length)}M.ended=!0,X(L)}}(U,ee)):(re||(z=function(L,M){var Z;se=M,f.isBuffer(se)||se instanceof h||typeof M=="string"||M===void 0||L.objectMode||(Z=new TypeError("Invalid non-string/buffer chunk"));var se;return Z}(ee,P)),z?U.emit("error",z):ee.objectMode||P&&P.length>0?(typeof P=="string"||ee.objectMode||Object.getPrototypeOf(P)===f.prototype||(P=function(L){return f.from(L)}(P)),Y?ee.endEmitted?U.emit("error",new Error("stream.unshift() after end event")):V(U,ee,P,!0):ee.ended?U.emit("error",new Error("stream.push() after EOF")):(ee.reading=!1,ee.decoder&&!K?(P=ee.decoder.write(P),ee.objectMode||P.length!==0?V(U,ee,P,!1):H(U,ee)):V(U,ee,P,!1))):Y||(ee.reading=!1)),function(L){return!L.ended&&(L.needReadable||L.length<L.highWaterMark||L.length===0)}(ee)}function V(U,P,K,Y){P.flowing&&P.length===0&&!P.sync?(U.emit("data",K),U.read(0)):(P.length+=P.objectMode?1:K.length,Y?P.buffer.unshift(K):P.buffer.push(K),P.needReadable&&X(U)),H(U,P)}Object.defineProperty(B.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(U){this._readableState&&(this._readableState.destroyed=U)}}),B.prototype.destroy=k.destroy,B.prototype._undestroy=k.undestroy,B.prototype._destroy=function(U,P){this.push(null),P(U)},B.prototype.push=function(U,P){var K,Y=this._readableState;return Y.objectMode?K=!0:typeof U=="string"&&((P=P||Y.defaultEncoding)!==Y.encoding&&(U=f.from(U,P),P=""),K=!0),W(this,U,P,!1,K)},B.prototype.unshift=function(U){return W(this,U,null,!0,!1)},B.prototype.isPaused=function(){return this._readableState.flowing===!1},B.prototype.setEncoding=function(U){return x||(x=e("string_decoder/").StringDecoder),this._readableState.decoder=new x(U),this._readableState.encoding=U,this};function q(U,P){return U<=0||P.length===0&&P.ended?0:P.objectMode?1:U!=U?P.flowing&&P.length?P.buffer.head.data.length:P.length:(U>P.highWaterMark&&(P.highWaterMark=function(K){return K>=8388608?K=8388608:(K--,K|=K>>>1,K|=K>>>2,K|=K>>>4,K|=K>>>8,K|=K>>>16,K++),K}(U)),U<=P.length?U:P.ended?P.length:(P.needReadable=!0,0))}function X(U){var P=U._readableState;P.needReadable=!1,P.emittedReadable||(g("emitReadable",P.flowing),P.emittedReadable=!0,P.sync?l.nextTick(I,U):I(U))}function I(U){g("emit readable"),U.emit("readable"),w(U)}function H(U,P){P.readingMore||(P.readingMore=!0,l.nextTick(O,U,P))}function O(U,P){for(var K=P.length;!P.reading&&!P.flowing&&!P.ended&&P.length<P.highWaterMark&&(g("maybeReadMore read 0"),U.read(0),K!==P.length);)K=P.length;P.readingMore=!1}function R(U){g("readable nexttick read 0"),U.read(0)}function C(U,P){P.reading||(g("resume read 0"),U.read(0)),P.resumeScheduled=!1,P.awaitDrain=0,U.emit("resume"),w(U),P.flowing&&!P.reading&&U.read(0)}function w(U){var P=U._readableState;for(g("flow",P.flowing);P.flowing&&U.read()!==null;);}function E(U,P){return P.length===0?null:(P.objectMode?K=P.buffer.shift():!U||U>=P.length?(K=P.decoder?P.buffer.join(""):P.buffer.length===1?P.buffer.head.data:P.buffer.concat(P.length),P.buffer.clear()):K=function(Y,re,z){var ee;return Y<re.head.data.length?(ee=re.head.data.slice(0,Y),re.head.data=re.head.data.slice(Y)):ee=Y===re.head.data.length?re.shift():z?function(L,M){var Z=M.head,se=1,ae=Z.data;for(L-=ae.length;Z=Z.next;){var ne=Z.data,Q=L>ne.length?ne.length:L;if(Q===ne.length?ae+=ne:ae+=ne.slice(0,L),(L-=Q)===0){Q===ne.length?(++se,Z.next?M.head=Z.next:M.head=M.tail=null):(M.head=Z,Z.data=ne.slice(Q));break}++se}return M.length-=se,ae}(Y,re):function(L,M){var Z=f.allocUnsafe(L),se=M.head,ae=1;for(se.data.copy(Z),L-=se.data.length;se=se.next;){var ne=se.data,Q=L>ne.length?ne.length:L;if(ne.copy(Z,Z.length-L,0,Q),(L-=Q)===0){Q===ne.length?(++ae,se.next?M.head=se.next:M.head=M.tail=null):(M.head=se,se.data=ne.slice(Q));break}++ae}return M.length-=ae,Z}(Y,re),ee}(U,P.buffer,P.decoder),K);var K}function A(U){var P=U._readableState;if(P.length>0)throw new Error('"endReadable()" called on non-empty stream');P.endEmitted||(P.ended=!0,l.nextTick(T,P,U))}function T(U,P){U.endEmitted||U.length!==0||(U.endEmitted=!0,P.readable=!1,P.emit("end"))}function D(U,P){for(var K=0,Y=U.length;K<Y;K++)if(U[K]===P)return K;return-1}B.prototype.read=function(U){g("read",U),U=parseInt(U,10);var P=this._readableState,K=U;if(U!==0&&(P.emittedReadable=!1),U===0&&P.needReadable&&(P.length>=P.highWaterMark||P.ended))return g("read: emitReadable",P.length,P.ended),P.length===0&&P.ended?A(this):X(this),null;if((U=q(U,P))===0&&P.ended)return P.length===0&&A(this),null;var Y,re=P.needReadable;return g("need readable",re),(P.length===0||P.length-U<P.highWaterMark)&&g("length less than watermark",re=!0),P.ended||P.reading?g("reading or ended",re=!1):re&&(g("do read"),P.reading=!0,P.sync=!0,P.length===0&&(P.needReadable=!0),this._read(P.highWaterMark),P.sync=!1,P.reading||(U=q(K,P))),(Y=U>0?E(U,P):null)===null?(P.needReadable=!0,U=0):P.length-=U,P.length===0&&(P.ended||(P.needReadable=!0),K!==U&&P.ended&&A(this)),Y!==null&&this.emit("data",Y),Y},B.prototype._read=function(U){this.emit("error",new Error("_read() is not implemented"))},B.prototype.pipe=function(U,P){var K=this,Y=this._readableState;switch(Y.pipesCount){case 0:Y.pipes=U;break;case 1:Y.pipes=[Y.pipes,U];break;default:Y.pipes.push(U)}Y.pipesCount+=1,g("pipe count=%d opts=%j",Y.pipesCount,P);var re=(!P||P.end!==!1)&&U!==o.stdout&&U!==o.stderr?ee:fe;function z(le,te){g("onunpipe"),le===K&&te&&te.hasUnpiped===!1&&(te.hasUnpiped=!0,g("cleanup"),U.removeListener("close",ne),U.removeListener("finish",Q),U.removeListener("drain",L),U.removeListener("error",ae),U.removeListener("unpipe",z),K.removeListener("end",ee),K.removeListener("end",fe),K.removeListener("data",se),M=!0,!Y.awaitDrain||U._writableState&&!U._writableState.needDrain||L())}function ee(){g("onend"),U.end()}Y.endEmitted?l.nextTick(re):K.once("end",re),U.on("unpipe",z);var L=function(le){return function(){var te=le._readableState;g("pipeOnDrain",te.awaitDrain),te.awaitDrain&&te.awaitDrain--,te.awaitDrain===0&&u(le,"data")&&(te.flowing=!0,w(le))}}(K);U.on("drain",L);var M=!1,Z=!1;function se(le){g("ondata"),Z=!1,U.write(le)!==!1||Z||((Y.pipesCount===1&&Y.pipes===U||Y.pipesCount>1&&D(Y.pipes,U)!==-1)&&!M&&(g("false write response, pause",Y.awaitDrain),Y.awaitDrain++,Z=!0),K.pause())}function ae(le){g("onerror",le),fe(),U.removeListener("error",ae),u(U,"error")===0&&U.emit("error",le)}function ne(){U.removeListener("finish",Q),fe()}function Q(){g("onfinish"),U.removeListener("close",ne),fe()}function fe(){g("unpipe"),K.unpipe(U)}return K.on("data",se),function(le,te,ce){if(typeof le.prependListener=="function")return le.prependListener(te,ce);le._events&&le._events[te]?i(le._events[te])?le._events[te].unshift(ce):le._events[te]=[ce,le._events[te]]:le.on(te,ce)}(U,"error",ae),U.once("close",ne),U.once("finish",Q),U.emit("pipe",K),Y.flowing||(g("pipe resume"),K.resume()),U},B.prototype.unpipe=function(U){var P=this._readableState,K={hasUnpiped:!1};if(P.pipesCount===0)return this;if(P.pipesCount===1)return U&&U!==P.pipes||(U||(U=P.pipes),P.pipes=null,P.pipesCount=0,P.flowing=!1,U&&U.emit("unpipe",this,K)),this;if(!U){var Y=P.pipes,re=P.pipesCount;P.pipes=null,P.pipesCount=0,P.flowing=!1;for(var z=0;z<re;z++)Y[z].emit("unpipe",this,{hasUnpiped:!1});return this}var ee=D(P.pipes,U);return ee===-1||(P.pipes.splice(ee,1),P.pipesCount-=1,P.pipesCount===1&&(P.pipes=P.pipes[0]),U.emit("unpipe",this,K)),this},B.prototype.on=function(U,P){var K=p.prototype.on.call(this,U,P);if(U==="data")this._readableState.flowing!==!1&&this.resume();else if(U==="readable"){var Y=this._readableState;Y.endEmitted||Y.readableListening||(Y.readableListening=Y.needReadable=!0,Y.emittedReadable=!1,Y.reading?Y.length&&X(this):l.nextTick(R,this))}return K},B.prototype.addListener=B.prototype.on,B.prototype.resume=function(){var U=this._readableState;return U.flowing||(g("resume"),U.flowing=!0,function(P,K){K.resumeScheduled||(K.resumeScheduled=!0,l.nextTick(C,P,K))}(this,U)),this},B.prototype.pause=function(){return g("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(g("pause"),this._readableState.flowing=!1,this.emit("pause")),this},B.prototype.wrap=function(U){var P=this,K=this._readableState,Y=!1;for(var re in U.on("end",function(){if(g("wrapped end"),K.decoder&&!K.ended){var ee=K.decoder.end();ee&&ee.length&&P.push(ee)}P.push(null)}),U.on("data",function(ee){g("wrapped data"),K.decoder&&(ee=K.decoder.write(ee)),K.objectMode&&ee==null||(K.objectMode||ee&&ee.length)&&(P.push(ee)||(Y=!0,U.pause()))}),U)this[re]===void 0&&typeof U[re]=="function"&&(this[re]=function(ee){return function(){return U[ee].apply(U,arguments)}}(re));for(var z=0;z<N.length;z++)U.on(N[z],this.emit.bind(this,N[z]));return this._read=function(ee){g("wrapped _read",ee),Y&&(Y=!1,U.resume())},this},Object.defineProperty(B.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),B._fromList=E}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"./_stream_duplex":508,"./internal/streams/BufferList":513,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,events:422,inherits:440,isarray:506,"process-nextick-args":466,"safe-buffer":520,"string_decoder/":521,util:188}],511:[function(e,n,a){n.exports=c;var o=e("./_stream_duplex"),s=Object.create(e("core-util-is"));function l(p,f){var h=this._transformState;h.transforming=!1;var v=h.writecb;if(!v)return this.emit("error",new Error("write callback called multiple times"));h.writechunk=null,h.writecb=null,f!=null&&this.push(f),v(p);var b=this._readableState;b.reading=!1,(b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}function c(p){if(!(this instanceof c))return new c(p);o.call(this,p),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,p&&(typeof p.transform=="function"&&(this._transform=p.transform),typeof p.flush=="function"&&(this._flush=p.flush)),this.on("prefinish",i)}function i(){var p=this;typeof this._flush=="function"?this._flush(function(f,h){u(p,f,h)}):u(this,null,null)}function u(p,f,h){if(f)return p.emit("error",f);if(h!=null&&p.push(h),p._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(p._transformState.transforming)throw new Error("Calling transform done when still transforming");return p.push(null)}s.inherits=e("inherits"),s.inherits(c,o),c.prototype.push=function(p,f){return this._transformState.needTransform=!1,o.prototype.push.call(this,p,f)},c.prototype._transform=function(p,f,h){throw new Error("_transform() is not implemented")},c.prototype._write=function(p,f,h){var v=this._transformState;if(v.writecb=h,v.writechunk=p,v.writeencoding=f,!v.transforming){var b=this._readableState;(v.needTransform||b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}},c.prototype._read=function(p){var f=this._transformState;f.writechunk!==null&&f.writecb&&!f.transforming?(f.transforming=!0,this._transform(f.writechunk,f.writeencoding,f.afterTransform)):f.needTransform=!0},c.prototype._destroy=function(p,f){var h=this;o.prototype._destroy.call(this,p,function(v){f(v),h.emit("close")})}},{"./_stream_duplex":508,"core-util-is":383,inherits:440}],512:[function(e,n,a){(function(o,s,l){(function(){var c=e("process-nextick-args");function i(H){var O=this;this.next=null,this.entry=null,this.finish=function(){(function(R,C,w){var E=R.entry;for(R.entry=null;E;){var A=E.callback;C.pendingcb--,A(w),E=E.next}C.corkedRequestsFree.next=R})(O,H)}}n.exports=F;var u,p=!o.browser&&["v0.10","v0.9."].indexOf(o.version.slice(0,5))>-1?l:c.nextTick;F.WritableState=N;var f=Object.create(e("core-util-is"));f.inherits=e("inherits");var h={deprecate:e("util-deprecate")},v=e("./internal/streams/stream"),b=e("safe-buffer").Buffer,g=(s!==void 0?s:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},x,y=e("./internal/streams/destroy");function k(){}function N(H,O){u=u||e("./_stream_duplex"),H=H||{};var R=O instanceof u;this.objectMode=!!H.objectMode,R&&(this.objectMode=this.objectMode||!!H.writableObjectMode);var C=H.highWaterMark,w=H.writableHighWaterMark,E=this.objectMode?16:16384;this.highWaterMark=C||C===0?C:R&&(w||w===0)?w:E,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var A=H.decodeStrings===!1;this.decodeStrings=!A,this.defaultEncoding=H.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(T){(function(D,U){var P=D._writableState,K=P.sync,Y=P.writecb;if(function(z){z.writing=!1,z.writecb=null,z.length-=z.writelen,z.writelen=0}(P),U)(function(z,ee,L,M,Z){--ee.pendingcb,L?(c.nextTick(Z,M),c.nextTick(I,z,ee),z._writableState.errorEmitted=!0,z.emit("error",M)):(Z(M),z._writableState.errorEmitted=!0,z.emit("error",M),I(z,ee))})(D,P,K,U,Y);else{var re=q(P);re||P.corked||P.bufferProcessing||!P.bufferedRequest||V(D,P),K?p(W,D,P,re,Y):W(D,P,re,Y)}})(O,T)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function F(H){if(u=u||e("./_stream_duplex"),!(x.call(F,this)||this instanceof u))return new F(H);this._writableState=new N(H,this),this.writable=!0,H&&(typeof H.write=="function"&&(this._write=H.write),typeof H.writev=="function"&&(this._writev=H.writev),typeof H.destroy=="function"&&(this._destroy=H.destroy),typeof H.final=="function"&&(this._final=H.final)),v.call(this)}function B(H,O,R,C,w,E,A){O.writelen=C,O.writecb=A,O.writing=!0,O.sync=!0,R?H._writev(w,O.onwrite):H._write(w,E,O.onwrite),O.sync=!1}function W(H,O,R,C){R||function(w,E){E.length===0&&E.needDrain&&(E.needDrain=!1,w.emit("drain"))}(H,O),O.pendingcb--,C(),I(H,O)}function V(H,O){O.bufferProcessing=!0;var R=O.bufferedRequest;if(H._writev&&R&&R.next){var C=O.bufferedRequestCount,w=new Array(C),E=O.corkedRequestsFree;E.entry=R;for(var A=0,T=!0;R;)w[A]=R,R.isBuf||(T=!1),R=R.next,A+=1;w.allBuffers=T,B(H,O,!0,O.length,w,"",E.finish),O.pendingcb++,O.lastBufferedRequest=null,E.next?(O.corkedRequestsFree=E.next,E.next=null):O.corkedRequestsFree=new i(O),O.bufferedRequestCount=0}else{for(;R;){var D=R.chunk,U=R.encoding,P=R.callback;if(B(H,O,!1,O.objectMode?1:D.length,D,U,P),R=R.next,O.bufferedRequestCount--,O.writing)break}R===null&&(O.lastBufferedRequest=null)}O.bufferedRequest=R,O.bufferProcessing=!1}function q(H){return H.ending&&H.length===0&&H.bufferedRequest===null&&!H.finished&&!H.writing}function X(H,O){H._final(function(R){O.pendingcb--,R&&H.emit("error",R),O.prefinished=!0,H.emit("prefinish"),I(H,O)})}function I(H,O){var R=q(O);return R&&(function(C,w){w.prefinished||w.finalCalled||(typeof C._final=="function"?(w.pendingcb++,w.finalCalled=!0,c.nextTick(X,C,w)):(w.prefinished=!0,C.emit("prefinish")))}(H,O),O.pendingcb===0&&(O.finished=!0,H.emit("finish"))),R}f.inherits(F,v),N.prototype.getBuffer=function(){for(var H=this.bufferedRequest,O=[];H;)O.push(H),H=H.next;return O},function(){try{Object.defineProperty(N.prototype,"buffer",{get:h.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(x=Function.prototype[Symbol.hasInstance],Object.defineProperty(F,Symbol.hasInstance,{value:function(H){return!!x.call(this,H)||this===F&&H&&H._writableState instanceof N}})):x=function(H){return H instanceof this},F.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},F.prototype.write=function(H,O,R){var C,w=this._writableState,E=!1,A=!w.objectMode&&(C=H,b.isBuffer(C)||C instanceof g);return A&&!b.isBuffer(H)&&(H=function(T){return b.from(T)}(H)),typeof O=="function"&&(R=O,O=null),A?O="buffer":O||(O=w.defaultEncoding),typeof R!="function"&&(R=k),w.ended?function(T,D){var U=new Error("write after end");T.emit("error",U),c.nextTick(D,U)}(this,R):(A||function(T,D,U,P){var K=!0,Y=!1;return U===null?Y=new TypeError("May not write null values to stream"):typeof U=="string"||U===void 0||D.objectMode||(Y=new TypeError("Invalid non-string/buffer chunk")),Y&&(T.emit("error",Y),c.nextTick(P,Y),K=!1),K}(this,w,H,R))&&(w.pendingcb++,E=function(T,D,U,P,K,Y){if(!U){var re=function(M,Z,se){return M.objectMode||M.decodeStrings===!1||typeof Z!="string"||(Z=b.from(Z,se)),Z}(D,P,K);P!==re&&(U=!0,K="buffer",P=re)}var z=D.objectMode?1:P.length;D.length+=z;var ee=D.length<D.highWaterMark;if(ee||(D.needDrain=!0),D.writing||D.corked){var L=D.lastBufferedRequest;D.lastBufferedRequest={chunk:P,encoding:K,isBuf:U,callback:Y,next:null},L?L.next=D.lastBufferedRequest:D.bufferedRequest=D.lastBufferedRequest,D.bufferedRequestCount+=1}else B(T,D,!1,z,P,K,Y);return ee}(this,w,A,H,O,R)),E},F.prototype.cork=function(){this._writableState.corked++},F.prototype.uncork=function(){var H=this._writableState;H.corked&&(H.corked--,H.writing||H.corked||H.bufferProcessing||!H.bufferedRequest||V(this,H))},F.prototype.setDefaultEncoding=function(H){if(typeof H=="string"&&(H=H.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((H+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+H);return this._writableState.defaultEncoding=H,this},Object.defineProperty(F.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),F.prototype._write=function(H,O,R){R(new Error("_write() is not implemented"))},F.prototype._writev=null,F.prototype.end=function(H,O,R){var C=this._writableState;typeof H=="function"?(R=H,H=null,O=null):typeof O=="function"&&(R=O,O=null),H!=null&&this.write(H,O),C.corked&&(C.corked=1,this.uncork()),C.ending||function(w,E,A){E.ending=!0,I(w,E),A&&(E.finished?c.nextTick(A):w.once("finish",A)),E.ended=!0,w.writable=!1}(this,C,R)},Object.defineProperty(F.prototype,"destroyed",{get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(H){this._writableState&&(this._writableState.destroyed=H)}}),F.prototype.destroy=y.destroy,F.prototype._undestroy=y.undestroy,F.prototype._destroy=function(H,O){this.end(),O(H)}}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{},e("timers").setImmediate)},{"./_stream_duplex":508,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,inherits:440,"process-nextick-args":466,"safe-buffer":520,timers:523,"util-deprecate":524}],513:[function(e,n,a){var o=e("safe-buffer").Buffer,s=e("util");n.exports=function(){function l(){(function(c,i){if(!(c instanceof i))throw new TypeError("Cannot call a class as a function")})(this,l),this.head=null,this.tail=null,this.length=0}return l.prototype.push=function(c){var i={data:c,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length},l.prototype.unshift=function(c){var i={data:c,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length},l.prototype.shift=function(){if(this.length!==0){var c=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,c}},l.prototype.clear=function(){this.head=this.tail=null,this.length=0},l.prototype.join=function(c){if(this.length===0)return"";for(var i=this.head,u=""+i.data;i=i.next;)u+=c+i.data;return u},l.prototype.concat=function(c){if(this.length===0)return o.alloc(0);for(var i,u,p,f=o.allocUnsafe(c>>>0),h=this.head,v=0;h;)i=h.data,u=f,p=v,i.copy(u,p),v+=h.data.length,h=h.next;return f},l}(),s&&s.inspect&&s.inspect.custom&&(n.exports.prototype[s.inspect.custom]=function(){var l=s.inspect({length:this.length});return this.constructor.name+" "+l})},{"safe-buffer":520,util:188}],514:[function(e,n,a){var o=e("process-nextick-args");function s(l,c){l.emit("error",c)}n.exports={destroy:function(l,c){var i=this,u=this._readableState&&this._readableState.destroyed,p=this._writableState&&this._writableState.destroyed;return u||p?(c?c(l):l&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,o.nextTick(s,this,l)):o.nextTick(s,this,l)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(l||null,function(f){!c&&f?i._writableState?i._writableState.errorEmitted||(i._writableState.errorEmitted=!0,o.nextTick(s,i,f)):o.nextTick(s,i,f):c&&c(f)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":466}],515:[function(e,n,a){arguments[4][490][0].apply(a,arguments)},{dup:490,events:422}],516:[function(e,n,a){n.exports=e("./readable").PassThrough},{"./readable":517}],517:[function(e,n,a){(a=n.exports=e("./lib/_stream_readable.js")).Stream=a,a.Readable=a,a.Writable=e("./lib/_stream_writable.js"),a.Duplex=e("./lib/_stream_duplex.js"),a.Transform=e("./lib/_stream_transform.js"),a.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":508,"./lib/_stream_passthrough.js":509,"./lib/_stream_readable.js":510,"./lib/_stream_transform.js":511,"./lib/_stream_writable.js":512}],518:[function(e,n,a){n.exports=e("./readable").Transform},{"./readable":517}],519:[function(e,n,a){n.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":512}],520:[function(e,n,a){arguments[4][217][0].apply(a,arguments)},{buffer:220,dup:217}],521:[function(e,n,a){arguments[4][218][0].apply(a,arguments)},{dup:218,"safe-buffer":520}],522:[function(e,n,a){arguments[4][218][0].apply(a,arguments)},{dup:218,"safe-buffer":494}],523:[function(e,n,a){(function(o,s){(function(){var l=e("process/browser.js").nextTick,c=Function.prototype.apply,i=Array.prototype.slice,u={},p=0;function f(h,v){this._id=h,this._clearFn=v}a.setTimeout=function(){return new f(c.call(setTimeout,window,arguments),clearTimeout)},a.setInterval=function(){return new f(c.call(setInterval,window,arguments),clearInterval)},a.clearTimeout=a.clearInterval=function(h){h.close()},f.prototype.unref=f.prototype.ref=function(){},f.prototype.close=function(){this._clearFn.call(window,this._id)},a.enroll=function(h,v){clearTimeout(h._idleTimeoutId),h._idleTimeout=v},a.unenroll=function(h){clearTimeout(h._idleTimeoutId),h._idleTimeout=-1},a._unrefActive=a.active=function(h){clearTimeout(h._idleTimeoutId);var v=h._idleTimeout;v>=0&&(h._idleTimeoutId=setTimeout(function(){h._onTimeout&&h._onTimeout()},v))},a.setImmediate=typeof o=="function"?o:function(h){var v=p++,b=!(arguments.length<2)&&i.call(arguments,1);return u[v]=!0,l(function(){u[v]&&(b?h.apply(null,b):h.call(null),a.clearImmediate(v))}),v},a.clearImmediate=typeof s=="function"?s:function(h){delete u[h]}}).call(this)}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":467,timers:523}],524:[function(e,n,a){(function(o){(function(){function s(l){try{if(!o.localStorage)return!1}catch{return!1}var c=o.localStorage[l];return c!=null&&String(c).toLowerCase()==="true"}n.exports=function(l,c){if(s("noDeprecation"))return l;var i=!1;return function(){if(!i){if(s("throwDeprecation"))throw new Error(c);s("traceDeprecation")?console.trace(c):console.warn(c),i=!0}return l.apply(this,arguments)}}}).call(this)}).call(this,typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],525:[function(e,n,a){typeof Object.create=="function"?n.exports=function(o,s){o.super_=s,o.prototype=Object.create(s.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}})}:n.exports=function(o,s){o.super_=s;var l=function(){};l.prototype=s.prototype,o.prototype=new l,o.prototype.constructor=o}},{}],526:[function(e,n,a){n.exports=function(o){return o&&typeof o=="object"&&typeof o.copy=="function"&&typeof o.fill=="function"&&typeof o.readUInt8=="function"}},{}],527:[function(e,n,a){(function(o,s){(function(){var l=/%[sdj%]/g;a.format=function(w){if(!N(w)){for(var E=[],A=0;A<arguments.length;A++)E.push(u(arguments[A]));return E.join(" ")}A=1;for(var T=arguments,D=T.length,U=String(w).replace(l,function(K){if(K==="%%")return"%";if(A>=D)return K;switch(K){case"%s":return String(T[A++]);case"%d":return Number(T[A++]);case"%j":try{return JSON.stringify(T[A++])}catch{return"[Circular]"}default:return K}}),P=T[A];A<D;P=T[++A])y(P)||!W(P)?U+=" "+P:U+=" "+u(P);return U},a.deprecate=function(w,E){if(F(s.process))return function(){return a.deprecate(w,E).apply(this,arguments)};if(o.noDeprecation===!0)return w;var A=!1;return function(){if(!A){if(o.throwDeprecation)throw new Error(E);o.traceDeprecation?console.trace(E):console.error(E),A=!0}return w.apply(this,arguments)}};var c,i={};function u(w,E){var A={seen:[],stylize:f};return arguments.length>=3&&(A.depth=arguments[2]),arguments.length>=4&&(A.colors=arguments[3]),x(E)?A.showHidden=E:E&&a._extend(A,E),F(A.showHidden)&&(A.showHidden=!1),F(A.depth)&&(A.depth=2),F(A.colors)&&(A.colors=!1),F(A.customInspect)&&(A.customInspect=!0),A.colors&&(A.stylize=p),h(A,w,A.depth)}function p(w,E){var A=u.styles[E];return A?"\x1B["+u.colors[A][0]+"m"+w+"\x1B["+u.colors[A][1]+"m":w}function f(w,E){return w}function h(w,E,A){if(w.customInspect&&E&&X(E.inspect)&&E.inspect!==a.inspect&&(!E.constructor||E.constructor.prototype!==E)){var T=E.inspect(A,w);return N(T)||(T=h(w,T,A)),T}var D=function(L,M){if(F(M))return L.stylize("undefined","undefined");if(N(M)){var Z="'"+JSON.stringify(M).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return L.stylize(Z,"string")}if(k(M))return L.stylize(""+M,"number");if(x(M))return L.stylize(""+M,"boolean");if(y(M))return L.stylize("null","null")}(w,E);if(D)return D;var U=Object.keys(E),P=function(L){var M={};return L.forEach(function(Z,se){M[Z]=!0}),M}(U);if(w.showHidden&&(U=Object.getOwnPropertyNames(E)),q(E)&&(U.indexOf("message")>=0||U.indexOf("description")>=0))return v(E);if(U.length===0){if(X(E)){var K=E.name?": "+E.name:"";return w.stylize("[Function"+K+"]","special")}if(B(E))return w.stylize(RegExp.prototype.toString.call(E),"regexp");if(V(E))return w.stylize(Date.prototype.toString.call(E),"date");if(q(E))return v(E)}var Y,re="",z=!1,ee=["{","}"];return g(E)&&(z=!0,ee=["[","]"]),X(E)&&(re=" [Function"+(E.name?": "+E.name:"")+"]"),B(E)&&(re=" "+RegExp.prototype.toString.call(E)),V(E)&&(re=" "+Date.prototype.toUTCString.call(E)),q(E)&&(re=" "+v(E)),U.length!==0||z&&E.length!=0?A<0?B(E)?w.stylize(RegExp.prototype.toString.call(E),"regexp"):w.stylize("[Object]","special"):(w.seen.push(E),Y=z?function(L,M,Z,se,ae){for(var ne=[],Q=0,fe=M.length;Q<fe;++Q)C(M,String(Q))?ne.push(b(L,M,Z,se,String(Q),!0)):ne.push("");return ae.forEach(function(le){le.match(/^\d+$/)||ne.push(b(L,M,Z,se,le,!0))}),ne}(w,E,A,P,U):U.map(function(L){return b(w,E,A,P,L,z)}),w.seen.pop(),function(L,M,Z){return L.reduce(function(se,ae){return ae.indexOf(`
`)>=0,se+ae.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?Z[0]+(M===""?"":M+`
 `)+" "+L.join(`,
  `)+" "+Z[1]:Z[0]+M+" "+L.join(", ")+" "+Z[1]}(Y,re,ee)):ee[0]+re+ee[1]}function v(w){return"["+Error.prototype.toString.call(w)+"]"}function b(w,E,A,T,D,U){var P,K,Y;if((Y=Object.getOwnPropertyDescriptor(E,D)||{value:E[D]}).get?K=Y.set?w.stylize("[Getter/Setter]","special"):w.stylize("[Getter]","special"):Y.set&&(K=w.stylize("[Setter]","special")),C(T,D)||(P="["+D+"]"),K||(w.seen.indexOf(Y.value)<0?(K=y(A)?h(w,Y.value,null):h(w,Y.value,A-1)).indexOf(`
`)>-1&&(K=U?K.split(`
`).map(function(re){return"  "+re}).join(`
`).substr(2):`
`+K.split(`
`).map(function(re){return"   "+re}).join(`
`)):K=w.stylize("[Circular]","special")),F(P)){if(U&&D.match(/^\d+$/))return K;(P=JSON.stringify(""+D)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(P=P.substr(1,P.length-2),P=w.stylize(P,"name")):(P=P.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),P=w.stylize(P,"string"))}return P+": "+K}function g(w){return Array.isArray(w)}function x(w){return typeof w=="boolean"}function y(w){return w===null}function k(w){return typeof w=="number"}function N(w){return typeof w=="string"}function F(w){return w===void 0}function B(w){return W(w)&&I(w)==="[object RegExp]"}function W(w){return typeof w=="object"&&w!==null}function V(w){return W(w)&&I(w)==="[object Date]"}function q(w){return W(w)&&(I(w)==="[object Error]"||w instanceof Error)}function X(w){return typeof w=="function"}function I(w){return Object.prototype.toString.call(w)}function H(w){return w<10?"0"+w.toString(10):w.toString(10)}a.debuglog=function(w){if(F(c)&&(c=o.env.NODE_DEBUG||""),w=w.toUpperCase(),!i[w])if(new RegExp("\\b"+w+"\\b","i").test(c)){var E=o.pid;i[w]=function(){var A=a.format.apply(a,arguments);console.error("%s %d: %s",w,E,A)}}else i[w]=function(){};return i[w]},a.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},a.isArray=g,a.isBoolean=x,a.isNull=y,a.isNullOrUndefined=function(w){return w==null},a.isNumber=k,a.isString=N,a.isSymbol=function(w){return typeof w=="symbol"},a.isUndefined=F,a.isRegExp=B,a.isObject=W,a.isDate=V,a.isError=q,a.isFunction=X,a.isPrimitive=function(w){return w===null||typeof w=="boolean"||typeof w=="number"||typeof w=="string"||typeof w=="symbol"||w===void 0},a.isBuffer=e("./support/isBuffer");var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(){var w=new Date,E=[H(w.getHours()),H(w.getMinutes()),H(w.getSeconds())].join(":");return[w.getDate(),O[w.getMonth()],E].join(" ")}function C(w,E){return Object.prototype.hasOwnProperty.call(w,E)}a.log=function(){console.log("%s - %s",R(),a.format.apply(a,arguments))},a.inherits=e("inherits"),a._extend=function(w,E){if(!E||!W(E))return w;for(var A=Object.keys(E),T=A.length;T--;)w[A[T]]=E[A[T]];return w}}).call(this)}).call(this,e("_process"),typeof ur<"u"?ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":526,_process:467,inherits:525}],528:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"v1",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(a,"v3",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(a,"v4",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(a,"v5",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(a,"NIL",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(a,"version",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(a,"validate",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(a,"stringify",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(a,"parse",{enumerable:!0,get:function(){return h.default}});var o=v(e("./v1.js")),s=v(e("./v3.js")),l=v(e("./v4.js")),c=v(e("./v5.js")),i=v(e("./nil.js")),u=v(e("./version.js")),p=v(e("./validate.js")),f=v(e("./stringify.js")),h=v(e("./parse.js"));function v(b){return b&&b.__esModule?b:{default:b}}},{"./nil.js":530,"./parse.js":531,"./stringify.js":535,"./v1.js":536,"./v3.js":537,"./v4.js":539,"./v5.js":540,"./validate.js":541,"./version.js":542}],529:[function(e,n,a){function o(h){return 14+(h+64>>>9<<4)+1}function s(h,v){const b=(65535&h)+(65535&v);return(h>>16)+(v>>16)+(b>>16)<<16|65535&b}function l(h,v,b,g,x,y){return s((k=s(s(v,h),s(g,y)))<<(N=x)|k>>>32-N,b);var k,N}function c(h,v,b,g,x,y,k){return l(v&b|~v&g,h,v,x,y,k)}function i(h,v,b,g,x,y,k){return l(v&g|b&~g,h,v,x,y,k)}function u(h,v,b,g,x,y,k){return l(v^b^g,h,v,x,y,k)}function p(h,v,b,g,x,y,k){return l(b^(v|~g),h,v,x,y,k)}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var f=function(h){if(typeof h=="string"){const v=unescape(encodeURIComponent(h));h=new Uint8Array(v.length);for(let b=0;b<v.length;++b)h[b]=v.charCodeAt(b)}return function(v){const b=[],g=32*v.length;for(let x=0;x<g;x+=8){const y=v[x>>5]>>>x%32&255,k=parseInt("0123456789abcdef".charAt(y>>>4&15)+"0123456789abcdef".charAt(15&y),16);b.push(k)}return b}(function(v,b){v[b>>5]|=128<<b%32,v[o(b)-1]=b;let g=1732584193,x=-271733879,y=-1732584194,k=271733878;for(let N=0;N<v.length;N+=16){const F=g,B=x,W=y,V=k;g=c(g,x,y,k,v[N],7,-680876936),k=c(k,g,x,y,v[N+1],12,-389564586),y=c(y,k,g,x,v[N+2],17,606105819),x=c(x,y,k,g,v[N+3],22,-1044525330),g=c(g,x,y,k,v[N+4],7,-176418897),k=c(k,g,x,y,v[N+5],12,1200080426),y=c(y,k,g,x,v[N+6],17,-1473231341),x=c(x,y,k,g,v[N+7],22,-45705983),g=c(g,x,y,k,v[N+8],7,1770035416),k=c(k,g,x,y,v[N+9],12,-1958414417),y=c(y,k,g,x,v[N+10],17,-42063),x=c(x,y,k,g,v[N+11],22,-1990404162),g=c(g,x,y,k,v[N+12],7,1804603682),k=c(k,g,x,y,v[N+13],12,-40341101),y=c(y,k,g,x,v[N+14],17,-1502002290),x=c(x,y,k,g,v[N+15],22,1236535329),g=i(g,x,y,k,v[N+1],5,-165796510),k=i(k,g,x,y,v[N+6],9,-1069501632),y=i(y,k,g,x,v[N+11],14,643717713),x=i(x,y,k,g,v[N],20,-373897302),g=i(g,x,y,k,v[N+5],5,-701558691),k=i(k,g,x,y,v[N+10],9,38016083),y=i(y,k,g,x,v[N+15],14,-660478335),x=i(x,y,k,g,v[N+4],20,-405537848),g=i(g,x,y,k,v[N+9],5,568446438),k=i(k,g,x,y,v[N+14],9,-1019803690),y=i(y,k,g,x,v[N+3],14,-187363961),x=i(x,y,k,g,v[N+8],20,1163531501),g=i(g,x,y,k,v[N+13],5,-1444681467),k=i(k,g,x,y,v[N+2],9,-51403784),y=i(y,k,g,x,v[N+7],14,1735328473),x=i(x,y,k,g,v[N+12],20,-1926607734),g=u(g,x,y,k,v[N+5],4,-378558),k=u(k,g,x,y,v[N+8],11,-2022574463),y=u(y,k,g,x,v[N+11],16,1839030562),x=u(x,y,k,g,v[N+14],23,-35309556),g=u(g,x,y,k,v[N+1],4,-1530992060),k=u(k,g,x,y,v[N+4],11,1272893353),y=u(y,k,g,x,v[N+7],16,-155497632),x=u(x,y,k,g,v[N+10],23,-1094730640),g=u(g,x,y,k,v[N+13],4,681279174),k=u(k,g,x,y,v[N],11,-358537222),y=u(y,k,g,x,v[N+3],16,-722521979),x=u(x,y,k,g,v[N+6],23,76029189),g=u(g,x,y,k,v[N+9],4,-640364487),k=u(k,g,x,y,v[N+12],11,-421815835),y=u(y,k,g,x,v[N+15],16,530742520),x=u(x,y,k,g,v[N+2],23,-995338651),g=p(g,x,y,k,v[N],6,-198630844),k=p(k,g,x,y,v[N+7],10,1126891415),y=p(y,k,g,x,v[N+14],15,-1416354905),x=p(x,y,k,g,v[N+5],21,-57434055),g=p(g,x,y,k,v[N+12],6,1700485571),k=p(k,g,x,y,v[N+3],10,-1894986606),y=p(y,k,g,x,v[N+10],15,-1051523),x=p(x,y,k,g,v[N+1],21,-2054922799),g=p(g,x,y,k,v[N+8],6,1873313359),k=p(k,g,x,y,v[N+15],10,-30611744),y=p(y,k,g,x,v[N+6],15,-1560198380),x=p(x,y,k,g,v[N+13],21,1309151649),g=p(g,x,y,k,v[N+4],6,-145523070),k=p(k,g,x,y,v[N+11],10,-1120210379),y=p(y,k,g,x,v[N+2],15,718787259),x=p(x,y,k,g,v[N+9],21,-343485551),g=s(g,F),x=s(x,B),y=s(y,W),k=s(k,V)}return[g,x,y,k]}(function(v){if(v.length===0)return[];const b=8*v.length,g=new Uint32Array(o(b));for(let x=0;x<b;x+=8)g[x>>5]|=(255&v[x/8])<<x%32;return g}(h),8*h.length))};a.default=f},{}],530:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,a.default="00000000-0000-0000-0000-000000000000"},{}],531:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o,s=(o=e("./validate.js"))&&o.__esModule?o:{default:o},l=function(c){if(!(0,s.default)(c))throw TypeError("Invalid UUID");let i;const u=new Uint8Array(16);return u[0]=(i=parseInt(c.slice(0,8),16))>>>24,u[1]=i>>>16&255,u[2]=i>>>8&255,u[3]=255&i,u[4]=(i=parseInt(c.slice(9,13),16))>>>8,u[5]=255&i,u[6]=(i=parseInt(c.slice(14,18),16))>>>8,u[7]=255&i,u[8]=(i=parseInt(c.slice(19,23),16))>>>8,u[9]=255&i,u[10]=(i=parseInt(c.slice(24,36),16))/1099511627776&255,u[11]=i/4294967296&255,u[12]=i>>>24&255,u[13]=i>>>16&255,u[14]=i>>>8&255,u[15]=255&i,u};a.default=l},{"./validate.js":541}],532:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,a.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],533:[function(e,n,a){let o;Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(){if(!o&&(o=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!o))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(s)};const s=new Uint8Array(16)},{}],534:[function(e,n,a){function o(c,i,u,p){switch(c){case 0:return i&u^~i&p;case 1:return i^u^p;case 2:return i&u^i&p^u&p;case 3:return i^u^p}}function s(c,i){return c<<i|c>>>32-i}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=function(c){const i=[1518500249,1859775393,2400959708,3395469782],u=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof c=="string"){const v=unescape(encodeURIComponent(c));c=[];for(let b=0;b<v.length;++b)c.push(v.charCodeAt(b))}else Array.isArray(c)||(c=Array.prototype.slice.call(c));c.push(128);const p=c.length/4+2,f=Math.ceil(p/16),h=new Array(f);for(let v=0;v<f;++v){const b=new Uint32Array(16);for(let g=0;g<16;++g)b[g]=c[64*v+4*g]<<24|c[64*v+4*g+1]<<16|c[64*v+4*g+2]<<8|c[64*v+4*g+3];h[v]=b}h[f-1][14]=8*(c.length-1)/Math.pow(2,32),h[f-1][14]=Math.floor(h[f-1][14]),h[f-1][15]=8*(c.length-1)&4294967295;for(let v=0;v<f;++v){const b=new Uint32Array(80);for(let F=0;F<16;++F)b[F]=h[v][F];for(let F=16;F<80;++F)b[F]=s(b[F-3]^b[F-8]^b[F-14]^b[F-16],1);let g=u[0],x=u[1],y=u[2],k=u[3],N=u[4];for(let F=0;F<80;++F){const B=Math.floor(F/20),W=s(g,5)+o(B,x,y,k)+N+i[B]+b[F]>>>0;N=k,k=y,y=s(x,30)>>>0,x=g,g=W}u[0]=u[0]+g>>>0,u[1]=u[1]+x>>>0,u[2]=u[2]+y>>>0,u[3]=u[3]+k>>>0,u[4]=u[4]+N>>>0}return[u[0]>>24&255,u[0]>>16&255,u[0]>>8&255,255&u[0],u[1]>>24&255,u[1]>>16&255,u[1]>>8&255,255&u[1],u[2]>>24&255,u[2]>>16&255,u[2]>>8&255,255&u[2],u[3]>>24&255,u[3]>>16&255,u[3]>>8&255,255&u[3],u[4]>>24&255,u[4]>>16&255,u[4]>>8&255,255&u[4]]};a.default=l},{}],535:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o,s=(o=e("./validate.js"))&&o.__esModule?o:{default:o};const l=[];for(let i=0;i<256;++i)l.push((i+256).toString(16).substr(1));var c=function(i){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const p=(l[i[u+0]]+l[i[u+1]]+l[i[u+2]]+l[i[u+3]]+"-"+l[i[u+4]]+l[i[u+5]]+"-"+l[i[u+6]]+l[i[u+7]]+"-"+l[i[u+8]]+l[i[u+9]]+"-"+l[i[u+10]]+l[i[u+11]]+l[i[u+12]]+l[i[u+13]]+l[i[u+14]]+l[i[u+15]]).toLowerCase();if(!(0,s.default)(p))throw TypeError("Stringified UUID is invalid");return p};a.default=c},{"./validate.js":541}],536:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=l(e("./rng.js")),s=l(e("./stringify.js"));function l(h){return h&&h.__esModule?h:{default:h}}let c,i,u=0,p=0;var f=function(h,v,b){let g=v&&b||0;const x=v||new Array(16);let y=(h=h||{}).node||c,k=h.clockseq!==void 0?h.clockseq:i;if(y==null||k==null){const q=h.random||(h.rng||o.default)();y==null&&(y=c=[1|q[0],q[1],q[2],q[3],q[4],q[5]]),k==null&&(k=i=16383&(q[6]<<8|q[7]))}let N=h.msecs!==void 0?h.msecs:Date.now(),F=h.nsecs!==void 0?h.nsecs:p+1;const B=N-u+(F-p)/1e4;if(B<0&&h.clockseq===void 0&&(k=k+1&16383),(B<0||N>u)&&h.nsecs===void 0&&(F=0),F>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=N,p=F,i=k,N+=122192928e5;const W=(1e4*(268435455&N)+F)%4294967296;x[g++]=W>>>24&255,x[g++]=W>>>16&255,x[g++]=W>>>8&255,x[g++]=255&W;const V=N/4294967296*1e4&268435455;x[g++]=V>>>8&255,x[g++]=255&V,x[g++]=V>>>24&15|16,x[g++]=V>>>16&255,x[g++]=k>>>8|128,x[g++]=255&k;for(let q=0;q<6;++q)x[g+q]=y[q];return v||(0,s.default)(x)};a.default=f},{"./rng.js":533,"./stringify.js":535}],537:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=l(e("./v35.js")),s=l(e("./md5.js"));function l(i){return i&&i.__esModule?i:{default:i}}var c=(0,o.default)("v3",48,s.default);a.default=c},{"./md5.js":529,"./v35.js":538}],538:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(u,p,f){function h(v,b,g,x){if(typeof v=="string"&&(v=function(k){k=unescape(encodeURIComponent(k));const N=[];for(let F=0;F<k.length;++F)N.push(k.charCodeAt(F));return N}(v)),typeof b=="string"&&(b=(0,s.default)(b)),b.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let y=new Uint8Array(16+v.length);if(y.set(b),y.set(v,b.length),y=f(y),y[6]=15&y[6]|p,y[8]=63&y[8]|128,g){x=x||0;for(let k=0;k<16;++k)g[x+k]=y[k];return g}return(0,o.default)(y)}try{h.name=u}catch{}return h.DNS=c,h.URL=i,h},a.URL=a.DNS=void 0;var o=l(e("./stringify.js")),s=l(e("./parse.js"));function l(u){return u&&u.__esModule?u:{default:u}}const c="6ba7b810-9dad-11d1-80b4-00c04fd430c8";a.DNS=c;const i="6ba7b811-9dad-11d1-80b4-00c04fd430c8";a.URL=i},{"./parse.js":531,"./stringify.js":535}],539:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=l(e("./rng.js")),s=l(e("./stringify.js"));function l(i){return i&&i.__esModule?i:{default:i}}var c=function(i,u,p){const f=(i=i||{}).random||(i.rng||o.default)();if(f[6]=15&f[6]|64,f[8]=63&f[8]|128,u){p=p||0;for(let h=0;h<16;++h)u[p+h]=f[h];return u}return(0,s.default)(f)};a.default=c},{"./rng.js":533,"./stringify.js":535}],540:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=l(e("./v35.js")),s=l(e("./sha1.js"));function l(i){return i&&i.__esModule?i:{default:i}}var c=(0,o.default)("v5",80,s.default);a.default=c},{"./sha1.js":534,"./v35.js":538}],541:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o,s=(o=e("./regex.js"))&&o.__esModule?o:{default:o},l=function(c){return typeof c=="string"&&s.default.test(c)};a.default=l},{"./regex.js":532}],542:[function(e,n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o,s=(o=e("./validate.js"))&&o.__esModule?o:{default:o},l=function(c){if(!(0,s.default)(c))throw TypeError("Invalid UUID");return parseInt(c.substr(14,1),16)};a.default=l},{"./validate.js":541}],543:[function(e,n,a){/**
* Character classes and associated utilities for the 5th edition of XML 1.0.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(a,"__esModule",{value:!0}),a.CHAR=`	
\r ---`,a.S=` 	\r
`,a.NAME_START_CHAR=":A-Z_a-z-----------",a.NAME_CHAR="-"+a.NAME_START_CHAR+".0-9--",a.CHAR_RE=new RegExp("^["+a.CHAR+"]$","u"),a.S_RE=new RegExp("^["+a.S+"]+$","u"),a.NAME_START_CHAR_RE=new RegExp("^["+a.NAME_START_CHAR+"]$","u"),a.NAME_CHAR_RE=new RegExp("^["+a.NAME_CHAR+"]$","u"),a.NAME_RE=new RegExp("^["+a.NAME_START_CHAR+"]["+a.NAME_CHAR+"]*$","u"),a.NMTOKEN_RE=new RegExp("^["+a.NAME_CHAR+"]+$","u");function o(s){return s>=65&&s<=90||s>=97&&s<=122||s===58||s===95||s===8204||s===8205||s>=192&&s<=214||s>=216&&s<=246||s>=248&&s<=767||s>=880&&s<=893||s>=895&&s<=8191||s>=8304&&s<=8591||s>=11264&&s<=12271||s>=12289&&s<=55295||s>=63744&&s<=64975||s>=65008&&s<=65533||s>=65536&&s<=983039}a.S_LIST=[32,10,13,9],a.isChar=function(s){return s>=32&&s<=55295||s===10||s===13||s===9||s>=57344&&s<=65533||s>=65536&&s<=1114111},a.isS=function(s){return s===32||s===10||s===13||s===9},a.isNameStartChar=o,a.isNameChar=function(s){return o(s)||s>=48&&s<=57||s===45||s===46||s===183||s>=768&&s<=879||s>=8255&&s<=8256}},{}],544:[function(e,n,a){/**
* Character classes and associated utilities for the 2nd edition of XML 1.1.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(a,"__esModule",{value:!0}),a.CHAR="---",a.RESTRICTED_CHAR="-\b\v\f---",a.S=` 	\r
`,a.NAME_START_CHAR=":A-Z_a-z-----------",a.NAME_CHAR="-"+a.NAME_START_CHAR+".0-9--",a.CHAR_RE=new RegExp("^["+a.CHAR+"]$","u"),a.RESTRICTED_CHAR_RE=new RegExp("^["+a.RESTRICTED_CHAR+"]$","u"),a.S_RE=new RegExp("^["+a.S+"]+$","u"),a.NAME_START_CHAR_RE=new RegExp("^["+a.NAME_START_CHAR+"]$","u"),a.NAME_CHAR_RE=new RegExp("^["+a.NAME_CHAR+"]$","u"),a.NAME_RE=new RegExp("^["+a.NAME_START_CHAR+"]["+a.NAME_CHAR+"]*$","u"),a.NMTOKEN_RE=new RegExp("^["+a.NAME_CHAR+"]+$","u");function o(s){return s>=65&&s<=90||s>=97&&s<=122||s===58||s===95||s===8204||s===8205||s>=192&&s<=214||s>=216&&s<=246||s>=248&&s<=767||s>=880&&s<=893||s>=895&&s<=8191||s>=8304&&s<=8591||s>=11264&&s<=12271||s>=12289&&s<=55295||s>=63744&&s<=64975||s>=65008&&s<=65533||s>=65536&&s<=983039}a.S_LIST=[32,10,13,9],a.isChar=function(s){return s>=1&&s<=55295||s>=57344&&s<=65533||s>=65536&&s<=1114111},a.isRestrictedChar=function(s){return s>=1&&s<=8||s===11||s===12||s>=14&&s<=31||s>=127&&s<=132||s>=134&&s<=159},a.isCharAndNotRestricted=function(s){return s===9||s===10||s===13||s>31&&s<127||s===133||s>159&&s<=55295||s>=57344&&s<=65533||s>=65536&&s<=1114111},a.isS=function(s){return s===32||s===10||s===13||s===9},a.isNameStartChar=o,a.isNameChar=function(s){return o(s)||s>=48&&s<=57||s===45||s===46||s===183||s>=768&&s<=879||s>=8255&&s<=8256}},{}],545:[function(e,n,a){/**
* Character class utilities for XML NS 1.0 edition 3.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/function o(s){return s>=65&&s<=90||s===95||s>=97&&s<=122||s>=192&&s<=214||s>=216&&s<=246||s>=248&&s<=767||s>=880&&s<=893||s>=895&&s<=8191||s>=8204&&s<=8205||s>=8304&&s<=8591||s>=11264&&s<=12271||s>=12289&&s<=55295||s>=63744&&s<=64975||s>=65008&&s<=65533||s>=65536&&s<=983039}Object.defineProperty(a,"__esModule",{value:!0}),a.NC_NAME_START_CHAR="A-Z_a-z------------",a.NC_NAME_CHAR="-"+a.NC_NAME_START_CHAR+".0-9--",a.NC_NAME_START_CHAR_RE=new RegExp("^["+a.NC_NAME_START_CHAR+"]$","u"),a.NC_NAME_CHAR_RE=new RegExp("^["+a.NC_NAME_CHAR+"]$","u"),a.NC_NAME_RE=new RegExp("^["+a.NC_NAME_START_CHAR+"]["+a.NC_NAME_CHAR+"]*$","u"),a.isNCNameStartChar=o,a.isNCNameChar=function(s){return o(s)||s===45||s===46||s>=48&&s<=57||s===183||s>=768&&s<=879||s>=8255&&s<=8256}},{}]},{},[15])(15)})}(bp)),bp.exports}var tj=ej();const rj=n8(tj);function nj({data:t,stats:r,filters:e}){const n=t.reduce((I,H)=>{const O=H.nome_cliente||"Desconhecido",R=Number(H.valor_total_nota)||0;return I[O]=(I[O]||0)+R,I},{}),a=Object.entries(n).map(([I,H])=>({name:I,value:H})).sort((I,H)=>H.value-I.value).slice(0,10),o=t.reduce((I,H)=>{const O=H.vendedor||"Desconhecido",R=Number(H.valor_total_nota)||0;return I[O]=(I[O]||0)+R,I},{}),s=Object.entries(o).map(([I,H])=>({name:I,value:H})).sort((I,H)=>H.value-I.value).slice(0,5),l=t.reduce((I,H)=>{const O=H.rede||"Sem rede",R=Number(H.valor_total_nota)||0;return I[O]=(I[O]||0)+R,I},{}),c=Object.entries(l).map(([I,H])=>({name:I,value:H})).sort((I,H)=>H.value-I.value).slice(0,5),i=t.reduce((I,H)=>{const O=H.cidade_origem||"N/A";return I[O]=(I[O]||0)+(Number(H.valor_total_nota)||0),I},{}),u=Object.entries(i).map(([I,H])=>({name:I,value:H})).sort((I,H)=>H.value-I.value).slice(0,6),p=t.reduce((I,H)=>{const O=H.motivo_nome||"No informado";return I[O]=(I[O]||0)+1,I},{}),f=Object.entries(p).map(([I,H])=>({name:I,value:H})).sort((I,H)=>H.value-I.value).slice(0,5),h={};t.forEach(I=>{(I.itens||[]).forEach(O=>{const w=(O.descricao||"Desconhecido").split(" ").slice(0,2).join(" "),E=Number(O.quantidade)||0;h[w]=(h[w]||0)+E})});const v=Object.entries(h).map(([I,H])=>({name:I,quantidade:H})).sort((I,H)=>H.quantidade-I.quantidade).slice(0,10),b=t.reduce((I,H)=>I+(Number(H.valor_total_nota)||0),0),g=t.length,x=g>0?b/g:0,y=[];if(g>0&&y.push(` Total de ${g} devoluo(es) no perodo selecionado, totalizando R$ ${b.toLocaleString("pt-BR",{minimumFractionDigits:2})}.`),a.length>0&&b>0){const I=a[0].value/b*100;I>20&&y.push(` Cliente "${a[0].name}" concentra ${I.toFixed(1)}% do valor total de devolues.`)}s.length>0&&y.push(` Vendedor "${s[0].name}" lidera em devolues com R$ ${s[0].value.toLocaleString("pt-BR")}.`),v.length>0&&y.push(` Produto "${v[0].name}"  o mais devolvido com ${v[0].quantidade.toFixed(2)} unidades.`);const k=t.filter(I=>I.resultado==="VALIDADA"),N=e.startDate&&e.endDate?`${Wt(e.startDate,"dd/MM/yyyy",{locale:br})} a ${Wt(e.endDate,"dd/MM/yyyy",{locale:br})}`:e.period||"Perodo no especificado",F=[];e.motivo&&e.motivo.length>0&&F.push(`Motivos: ${e.motivo.length} selecionado(s)`),e.cliente&&e.cliente.length>0&&F.push(`Clientes: ${e.cliente.length} selecionado(s)`),e.vendedor&&e.vendedor.length>0&&F.push(`Vendedores: ${e.vendedor.length} selecionado(s)`),e.setor&&e.setor.length>0&&F.push(`Setores: ${e.setor.length} selecionado(s)`),e.search&&F.push(`Busca: "${e.search}"`);const B=t.filter(I=>I.resultado==="PENDENTE VALIDAO"),W=t.filter(I=>I.resultado==="TRATATIVA DE ANULAO"),V=[];t.filter(I=>I.resultado==="PENDENTE VALIDAO").forEach(I=>{I.itens&&I.itens.length>0&&I.itens.forEach(H=>{V.push({nf:I.numero||"-",vendedor:I.vendedor||"-",cliente:(I.nome_cliente||"-").substring(0,25),produto:(H.descricao||"-").substring(0,30),unidade:H.unidade||"-",quantidade:H.quantidade?H.quantidade.toString():"-",valor:`R$ ${(Number(H.valor_total_bruto)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`})})});const q={};t.forEach(I=>{const H=new Date(I.data_emissao||I.created_at),O=Wt(H,"dd/MM",{locale:br});q[O]||(q[O]={value:0,count:0}),q[O].value+=Number(I.valor_total_nota)||0,q[O].count+=1});const X=Object.keys(q).sort((I,H)=>{const O=new Date(I.split("/").reverse().join("-")),R=new Date(H.split("/").reverse().join("-"));return O.getTime()-R.getTime()}).map(I=>({name:I,value:q[I].value,count:q[I].count}));return`
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Relatrio de Devolues - Grupo Doce Mel</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"><\/script>
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
  
  @page {
    size: A4 portrait;
    margin: 15mm;
  }
  
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: white;
    padding: 10px;
    color: #333;
    font-size: 9px;
  }
  
  .page {
    page-break-after: auto;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }
  
  .header {
    background: linear-gradient(135deg, #073e29 0%, #0a4d33 100%);
    color: white;
    padding: 12px;
    border-radius: 6px;
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    gap: 15px;
  }
  
  .header-logo {
    width: 50px;
    height: 50px;
    background: white;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }
  
  .header-logo img {
    width: 100%;
    height: 100%;
    object-fit: contain;
  }
  
  .header-content {
    flex: 1;
  }
  
  .header h1 {
    font-size: 18px;
    margin-bottom: 4px;
  }
  
  .header-info {
    font-size: 9px;
    opacity: 0.95;
    margin-bottom: 3px;
  }
  
  .header-filters {
    font-size: 8px;
    opacity: 0.85;
    margin-top: 4px;
  }
  
  .kpi-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 6px;
    margin-bottom: 12px;
  }
  
  .kpi-card {
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 8px;
    background: #f9fafb;
  }
  
  .kpi-title {
    font-size: 7px;
    color: #666;
    margin-bottom: 3px;
  }
  
  .kpi-value {
    font-size: 13px;
    font-weight: bold;
    color: #073e29;
  }
  
  .kpi-desc {
    font-size: 6px;
    color: #999;
    margin-top: 2px;
  }
  
  .chart-section {
    margin-bottom: 10px;
    page-break-inside: avoid;
    break-inside: avoid;
  }
  
  .chart-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-bottom: 10px;
  }
  
  .chart-title {
    font-size: 11px;
    font-weight: bold;
    margin-bottom: 6px;
    color: #073e29;
    border-bottom: 2px solid #073e29;
    padding-bottom: 3px;
  }

  .chart-container {
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 6px;
    background: white;
    height: 140px;
    position: relative;
    width: 100%;
  }
  
  .insights-container {
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 6px;
    background: white;
    height: 140px;
    position: relative;
    width: 100%;
    overflow-y: auto;
  }
  
  .insight-item {
    font-size: 8px;
    margin-bottom: 4px;
    padding-left: 6px;
    line-height: 1.4;
    color: #333;
  }
  
  .data-table-section {
    margin-top: 12px;
    margin-bottom: 12px;
  }
  
  .data-table-title {
    font-size: 12px;
    font-weight: bold;
    color: #073e29;
    margin-bottom: 8px;
    border-bottom: 2px solid #073e29;
    padding-bottom: 4px;
  }
  
  .data-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 7px;
    margin-bottom: 15px;
    page-break-inside: avoid;
  }
  
  .data-table thead {
    background: #073e29;
    color: white;
  }
  
  .data-table th {
    padding: 6px 4px;
    text-align: left;
    font-weight: bold;
    font-size: 7px;
  }
  
  .data-table td {
    padding: 4px;
    border: 1px solid #ddd;
    color: #333;
  }
  
  .data-table tbody tr:nth-child(even) {
    background: #f9fafb;
  }
  
  .footer {
    margin-top: auto;
    padding-top: 12px;
    border-top: 2px solid #073e29;
    text-align: center;
    font-size: 7px;
    color: #666;
  }
  
  @media print {
    body {
      padding: 0;
    }
    .no-print {
      display: none !important;
    }
    .chart-container, .data-table {
      page-break-inside: avoid;
    }
  }
</style>
</head>
<body>
<button class="no-print" onclick="window.print()" style="position: fixed; top: 10px; right: 10px; z-index: 1000; background: #073e29; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold;">
   Imprimir
</button>

<div class="page">
  <div class="header">
    <div class="header-logo">
      <img src="/logo.png" alt="Logo" onerror="this.style.display='none'" style="background-color: #073e29;">
    </div>
    <div class="header-content">
      <h1>Relatrio de Devolues</h1>
      <div class="header-info">Relatrio Gerado em ${Wt(new Date,"dd/MM/yyyy 's' HH:mm",{locale:br})}</div>
      <div class="header-info">Perodo: ${N}</div>
      ${F.length>0?`<div class="header-filters">Filtros: ${F.join(" | ")}</div>`:""}
    </div>
  </div>
  
  <div class="kpi-grid">
    <div class="kpi-card">
      <div class="kpi-title">NF Pendentes</div>
      <div class="kpi-value">${r.nfPendentes}</div>
      <div class="kpi-desc">R$ ${r.totalPendente.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">NF Cancelamento</div>
      <div class="kpi-value">${r.nfCancelamento}</div>
      <div class="kpi-desc">R$ ${r.totalCancelamento.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">NF em Atraso</div>
      <div class="kpi-value">${r.nfAtraso}</div>
      <div class="kpi-desc">R$ ${r.totalAtraso.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">NF Validadas</div>
      <div class="kpi-value">${r.nfValidadas}</div>
      <div class="kpi-desc">R$ ${r.totalValidadas.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">Total Geral</div>
      <div class="kpi-value">${t.length}</div>
      <div class="kpi-desc">R$ ${r.totalGeral.toLocaleString("pt-BR",{minimumFractionDigits:2})}</div>
    </div>
    <div class="kpi-card">
      <div class="kpi-title">Ticket Mdio</div>
      <div class="kpi-value">R$ ${x.toLocaleString("pt-BR",{maximumFractionDigits:0})}</div>
      <div class="kpi-desc">Por devoluo</div>
    </div>
  </div>
  
  <!-- Seo 1: Evoluo no Tempo | Top Clientes -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Evoluo no Tempo</div>
      <div class="chart-container">
        <canvas id="chartEvolucao"></canvas>
      </div>
    </div>
    <div class="chart-section">
      <div class="chart-title">Top Clientes (Valor)</div>
      <div class="chart-container">
        <canvas id="chartTopClientes"></canvas>
      </div>
    </div>
  </div>
  
  <!-- Seo 2: Top Vendedores | Top Redes -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Top Vendedores (Valor)</div>
      <div class="chart-container">
        <canvas id="chartVendedores"></canvas>
      </div>
    </div>
    <div class="chart-section">
      <div class="chart-title">Top Redes (Valor)</div>
      <div class="chart-container">
        <canvas id="chartRedes"></canvas>
      </div>
    </div>
  </div>
  
  <!-- Seo 3: Distribuio por Municpio | Principais Motivos -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Distribuio por Municpio</div>
      <div class="chart-container">
        <canvas id="chartMunicipios"></canvas>
      </div>
    </div>
    <div class="chart-section">
      <div class="chart-title">Principais Motivos</div>
      <div class="chart-container">
        <canvas id="chartMotivos"></canvas>
      </div>
    </div>
  </div>
  
  <!-- Seo 4: Produtos Crticos | Insights Automticos -->
  <div class="chart-grid">
    <div class="chart-section">
      <div class="chart-title">Produtos Crticos (Top 10)</div>
      <div class="chart-container">
        <canvas id="chartProdutos"></canvas>
      </div>
    </div>
    ${y.length>0?`
    <div class="chart-section">
      <div class="chart-title">Insights Automticos</div>
      <div class="insights-container">
        ${y.map(I=>`
          <div class="insight-item">${I}</div>
        `).join("")}
      </div>
    </div>
    `:'<div class="chart-section"></div>'}
  </div>
  
  <!-- Tabelas de Dados -->
  <div class="data-table-section">
    ${W.length>0?`
      <div class="data-table-title">Notas em Tratativa de Anulao (${W.length})</div>
      <table class="data-table">
        <thead>
          <tr>
            <th>Data Emisso</th>
            <th>NF</th>
            <th>Cliente</th>
            <th>Vendedor</th>
            <th>Valor</th>
            <th>Dias</th>
            <th>Prazo</th>
          </tr>
        </thead>
        <tbody>
          ${W.slice(0,50).map(I=>`
            <tr>
              <td>${I.data_emissao?Wt(new Date(I.data_emissao),"dd/MM/yyyy",{locale:br}):"-"}</td>
              <td><strong>${I.numero||"-"}</strong></td>
              <td>${(I.nome_cliente||"-").substring(0,20)}</td>
              <td>${(I.vendedor||"-").substring(0,15)}</td>
              <td><strong>R$ ${(Number(I.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}</strong></td>
              <td>${I.dias!==null&&I.dias!==void 0?I.dias:"-"}</td>
              <td>${I.prazo||"-"}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>
    `:""}

    ${B.length>0?`
      <div class="data-table-title">Notas Pendentes (${B.length})</div>
      <table class="data-table">
        <thead>
          <tr>
            <th>Data Emisso</th>
            <th>NF</th>
            <th>Cliente</th>
            <th>Vendedor</th>
            <th>Valor</th>
            <th>Dias</th>
            <th>Prazo</th>
          </tr>
        </thead>
        <tbody>
          ${B.slice(0,50).map(I=>`
            <tr>
              <td>${I.data_emissao?Wt(new Date(I.data_emissao),"dd/MM/yyyy",{locale:br}):"-"}</td>
              <td><strong>${I.numero||"-"}</strong></td>
              <td>${(I.nome_cliente||"-").substring(0,20)}</td>
              <td>${(I.vendedor||"-").substring(0,15)}</td>
              <td><strong>R$ ${(Number(I.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}</strong></td>
              <td>${I.dias!==null&&I.dias!==void 0?I.dias:"-"}</td>
              <td>${I.prazo||"-"}</td>
            </tr>
          `).join("")}
        </tbody>
      </table>
    `:""}

    ${k.length>0?`
      <div class="data-table-title">Notas Validadas (${k.length})</div>
      <table class="data-table">
        <thead>
          <tr>
            <th>Data Emisso</th>
            <th>NF</th>
            <th>Cliente</th>
            <th>Vendedor</th>
            <th>Motivo</th>
            <th>Valor</th>
          </tr>
        </thead>
        <tbody>
          ${k.slice(0,50).map(I=>`
            <tr>
              <td>${I.data_emissao?Wt(new Date(I.data_emissao),"dd/MM/yyyy",{locale:br}):"-"}</td>
              <td><strong>${I.numero||"-"}</strong></td>
              <td>${(I.nome_cliente||"-").substring(0,20)}</td>
              <td>${(I.vendedor||"-").substring(0,15)}</td>
              <td>${(I.motivo_nome||"-").substring(0,20)}</td>
              <td><strong>R$ ${(Number(I.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}</strong></td>
            </tr>
          `).join("")}
        </tbody>
      </table>
    `:""}

    ${V.length>0?`
      <div class="data-table-title">Lista Completa com Produtos (${V.length})</div>
      <table class="data-table">
        <thead>
          <tr>
            <th>NF</th>
            <th>Vendedor</th>
            <th>Cliente</th>
            <th>Produto</th>
            <th>Unidade</th>
            <th>Quantidade</th>
            <th>Valor</th>
          </tr>
        </thead>
        <tbody>
          ${V.slice(0,100).map(I=>`
            <tr>
              <td><strong>${I.nf}</strong></td>
              <td>${I.vendedor}</td>
              <td>${I.cliente}</td>
              <td>${I.produto}</td>
              <td>${I.unidade}</td>
              <td>${I.quantidade}</td>
              <td><strong>${I.valor}</strong></td>
            </tr>
          `).join("")}
        </tbody>
      </table>
    `:""}
  </div>
  
  <div class="footer">
    <p>Relatrio gerado automaticamente pelo Sistema de Devolues - Grupo Doce Mel</p>
    <p>Data de gerao: ${Wt(new Date,"dd/MM/yyyy 's' HH:mm:ss",{locale:br})}</p>
  </div>
</div>

<script>
  Chart.defaults.font.size = 8;
  Chart.defaults.color = '#1f2937';
  Chart.defaults.borderColor = '#e5e7eb';
  
  const commonChartOptions = {
    responsive: false,
    maintainAspectRatio: false,
    plugins: {
      legend: { display: false },
      tooltip: {
        backgroundColor: 'rgba(0, 0, 0, 0.8)',
        titleColor: '#fff',
        bodyColor: '#fff',
        borderColor: '#17432a',
        borderWidth: 1
      }
    },
    scales: {
      x: {
        grid: { color: '#e5e7eb' },
        ticks: { color: '#1f2937', font: { size: 8 } }
      },
      y: {
        grid: { color: '#e5e7eb' },
        ticks: { color: '#1f2937', font: { size: 8 } }
      }
    }
  };
  
  // Grfico de Evoluo no Tempo
  new Chart(document.getElementById('chartEvolucao'), {
    type: 'line',
    data: {
      labels: ${JSON.stringify(X.map(I=>I.name))},
      datasets: [{
        label: 'Valor Total (R$)',
        data: ${JSON.stringify(X.map(I=>I.value))},
        borderColor: '#17432a',
        backgroundColor: 'rgba(23, 67, 42, 0.15)',
        borderWidth: 2,
        fill: true,
        tension: 0.4
      }]
    },
    options: {
      ...commonChartOptions,
      plugins: {
        ...commonChartOptions.plugins,
        legend: { display: true, position: 'bottom', labels: { color: '#1f2937' } },
        tooltip: {
          ...commonChartOptions.plugins.tooltip,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      },
      scales: {
        ...commonChartOptions.scales,
        y: {
          ...commonChartOptions.scales.y,
          beginAtZero: true,
          ticks: {
            ...commonChartOptions.scales.y.ticks,
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR', { maximumFractionDigits: 0 })
          }
        },
        x: {
          ...commonChartOptions.scales.x,
          ticks: {
            ...commonChartOptions.scales.x.ticks,
            maxRotation: 45,
            minRotation: 45
          }
        }
      }
    }
  });
  
  // Grfico Top Clientes
  new Chart(document.getElementById('chartTopClientes'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(a.map(I=>I.name.length>12?I.name.substring(0,12)+"...":I.name))},
      datasets: [{
        label: 'Valor (R$)',
        data: ${JSON.stringify(a.map(I=>I.value))},
        backgroundColor: '#17432a',
        borderColor: '#0a4d33',
        borderWidth: 1
      }]
    },
    options: {
      ...commonChartOptions,
      indexAxis: 'y',
      scales: {
        ...commonChartOptions.scales,
        x: {
          ...commonChartOptions.scales.x,
          ticks: {
            ...commonChartOptions.scales.x.ticks,
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR', { maximumFractionDigits: 0 })
          }
        }
      },
      plugins: {
        ...commonChartOptions.plugins,
        tooltip: {
          ...commonChartOptions.plugins.tooltip,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.x.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      }
    }
  });
  
  // Grfico Top Vendedores
  new Chart(document.getElementById('chartVendedores'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(s.map(I=>I.name.length>12?I.name.substring(0,12)+"...":I.name))},
      datasets: [{
        label: 'Valor (R$)',
        data: ${JSON.stringify(s.map(I=>I.value))},
        backgroundColor: '#0a4d33',
        borderColor: '#17432a',
        borderWidth: 1
      }]
    },
    options: {
      ...commonChartOptions,
      scales: {
        ...commonChartOptions.scales,
        y: {
          ...commonChartOptions.scales.y,
          beginAtZero: true,
          ticks: {
            ...commonChartOptions.scales.y.ticks,
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR', { maximumFractionDigits: 0 })
          }
        },
        x: {
          ...commonChartOptions.scales.x,
          ticks: {
            ...commonChartOptions.scales.x.ticks,
            maxRotation: 45,
            minRotation: 45
          }
        }
      },
      plugins: {
        ...commonChartOptions.plugins,
        tooltip: {
          ...commonChartOptions.plugins.tooltip,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      }
    }
  });
  
  // Grfico Top Redes
  new Chart(document.getElementById('chartRedes'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(c.map(I=>I.name.length>12?I.name.substring(0,12)+"...":I.name))},
      datasets: [{
        label: 'Valor (R$)',
        data: ${JSON.stringify(c.map(I=>I.value))},
        backgroundColor: '#065f46',
        borderColor: '#0a4d33',
        borderWidth: 1
      }]
    },
    options: {
      ...commonChartOptions,
      scales: {
        ...commonChartOptions.scales,
        y: {
          ...commonChartOptions.scales.y,
          beginAtZero: true,
          ticks: {
            ...commonChartOptions.scales.y.ticks,
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR', { maximumFractionDigits: 0 })
          }
        },
        x: {
          ...commonChartOptions.scales.x,
          ticks: {
            ...commonChartOptions.scales.x.ticks,
            maxRotation: 45,
            minRotation: 45
          }
        }
      },
      plugins: {
        ...commonChartOptions.plugins,
        tooltip: {
          ...commonChartOptions.plugins.tooltip,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      }
    }
  });
  
  // Grfico Municpios
  new Chart(document.getElementById('chartMunicipios'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(u.map(I=>I.name.length>12?I.name.substring(0,12)+"...":I.name))},
      datasets: [{
        label: 'Valor (R$)',
        data: ${JSON.stringify(u.map(I=>I.value))},
        backgroundColor: '#17432a',
        borderColor: '#0a4d33',
        borderWidth: 1
      }]
    },
    options: {
      ...commonChartOptions,
      indexAxis: 'y',
      scales: {
        ...commonChartOptions.scales,
        x: {
          ...commonChartOptions.scales.x,
          ticks: {
            ...commonChartOptions.scales.x.ticks,
            callback: (value) => 'R$ ' + value.toLocaleString('pt-BR', { maximumFractionDigits: 0 })
          }
        }
      },
      plugins: {
        ...commonChartOptions.plugins,
        tooltip: {
          ...commonChartOptions.plugins.tooltip,
          callbacks: {
            label: (context) => 'R$ ' + context.parsed.x.toLocaleString('pt-BR', { minimumFractionDigits: 2 })
          }
        }
      }
    }
  });
  
  // Grfico Motivos
  new Chart(document.getElementById('chartMotivos'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(f.map(I=>I.name.length>15?I.name.substring(0,15)+"...":I.name))},
      datasets: [{
        label: 'Quantidade',
        data: ${JSON.stringify(f.map(I=>I.value))},
        backgroundColor: '#0a4d33',
        borderColor: '#17432a',
        borderWidth: 1
      }]
    },
    options: {
      ...commonChartOptions,
      scales: {
        ...commonChartOptions.scales,
        y: {
          ...commonChartOptions.scales.y,
          beginAtZero: true,
          ticks: {
            ...commonChartOptions.scales.y.ticks,
            stepSize: 1
          }
        },
        x: {
          ...commonChartOptions.scales.x,
          ticks: {
            ...commonChartOptions.scales.x.ticks,
            maxRotation: 45,
            minRotation: 45
          }
        }
      },
      plugins: {
        ...commonChartOptions.plugins,
        tooltip: {
          ...commonChartOptions.plugins.tooltip,
          callbacks: {
            label: (context) => context.parsed.y + ' ocorrncia(s)'
          }
        }
      }
    }
  });
  
  // Grfico Produtos
  new Chart(document.getElementById('chartProdutos'), {
    type: 'bar',
    data: {
      labels: ${JSON.stringify(v.slice(0,10).map(I=>I.name.length>15?I.name.substring(0,15)+"...":I.name))},
      datasets: [{
        label: 'Quantidade',
        data: ${JSON.stringify(v.slice(0,10).map(I=>I.quantidade))},
        backgroundColor: '#065f46',
        borderColor: '#0a4d33',
        borderWidth: 1
      }]
    },
    options: {
      ...commonChartOptions,
      indexAxis: 'y',
      scales: {
        ...commonChartOptions.scales,
        x: {
          ...commonChartOptions.scales.x,
          beginAtZero: true
        }
      },
      plugins: {
        ...commonChartOptions.plugins,
        tooltip: {
          ...commonChartOptions.plugins.tooltip,
          callbacks: {
            label: (context) => context.parsed.x.toFixed(2) + ' unidades'
          }
        }
      }
    }
  });
<\/script>
</body>
</html>
  `}const zi={"PENDENTE VALIDAO":1,VALIDADA:2,LANADA:3,"TRATATIVA DE ANULAO":4,"ANULADA/CANCELADA":5};function aj(){const{filters:t}=ec(),{user:r}=Dn(),[e,n]=_e.useState([]),[a,o]=_e.useState([]),[s,l]=_e.useState([]),[c,i]=_e.useState(!0),[u,p]=_e.useState(1),[f,h]=_e.useState(null),[v,b]=_e.useState(null),[g,x]=_e.useState(null),[y,k]=_e.useState({valorTotalLancado:0,notasLancadas:0,valorTotalAnulado:0,notasAnuladas:0,momPercent:0,yoyPercent:0}),N=100;_e.useEffect(()=>{F(),b(null),x(null),p(1)},[t]);const F=async()=>{i(!0);const I=(r==null?void 0:r.role)==="VENDEDOR"?r.vendedor:null;let H=St.from("devolucoes").select(`
        *,
        itens:itens_devolucao(*, motivo_item:motivos_devolucao(id, nome)),
        setores(nome),
        motivos_devolucao(nome, setores:setores(nome))
      `);r&&r.role==="VENDEDOR"&&I&&(H=H.eq("vendedor",I),console.log(" Reports - Filtrando por vendedor:",I));const O=t.period&&!t.startDate&&!t.endDate?Kf(t.period):{},R=t.startDate||O.startDate,C=t.endDate||O.endDate;t.search&&(H=H.or(`nome_cliente.ilike.%${t.search}%,vendedor.ilike.%${t.search}%,numero.ilike.%${t.search}%`)),t.resultado&&t.resultado.length>0&&(H=H.in("resultado",t.resultado)),t.motivo&&t.motivo.length>0&&(H=H.in("motivo_id",t.motivo)),t.cliente&&t.cliente.length>0&&(H=H.in("nome_cliente",t.cliente)),t.vendedor&&t.vendedor.length>0&&(H=H.in("vendedor",t.vendedor));let w=[];if(t.setor&&t.setor.length>0){const{data:D}=await St.from("motivos_devolucao").select("id").in("sector_id",t.setor);w=(D==null?void 0:D.map(U=>U.id))||[],H=H.in("setor_id",t.setor)}const E=w;if(R){const D=new Date(R);D.setHours(0,0,0,0);const U=new Date(D.getTime()-3*60*60*1e3);H=H.gte("data_emissao",U.toISOString().split("T")[0])}if(C){const D=new Date(C);D.setHours(23,59,59,999);const U=new Date(D.getTime()-3*60*60*1e3);H=H.lte("data_emissao",U.toISOString().split("T")[0])}const{data:A,error:T}=await H;if(T)console.error(T),_t.error("Erro ao carregar dados do relatrio");else if(A){let D=A;t.setor&&t.setor.length>0&&E.length>0&&(D=A.filter(ne=>{const Q=ne.setor_id&&t.setor.includes(ne.setor_id),fe=ne.motivo_id&&E.includes(ne.motivo_id);return Q||fe}));const U=D.map(ne=>ne.cnpj_destinatario).filter(ne=>ne&&ne.trim()!=="");let P=new Map;if(U.length>0){const{data:ne}=await St.from("clientes").select("cnpj_cpf, nome, vendedor, rede, uf, municipio").in("cnpj_cpf",U);ne&&ne.forEach(Q=>{P.set(Q.cnpj_cpf,Q)})}const K=D.map(ne=>{var fe,le,te,ce,he;const Q=P.get(ne.cnpj_destinatario);return{...ne,setor_nome:typeof ne.motivos_devolucao=="object"&&((le=(fe=ne.motivos_devolucao)==null?void 0:fe.setores)!=null&&le.nome)?ne.motivos_devolucao.setores.nome:typeof ne.setores=="object"&&((te=ne.setores)!=null&&te.nome)?ne.setores.nome:typeof ne.setores=="string"?ne.setores:"-",motivo_nome:typeof ne.motivos_devolucao=="object"&&((ce=ne.motivos_devolucao)!=null&&ce.nome)?ne.motivos_devolucao.nome:typeof ne.motivos_devolucao=="string"?ne.motivos_devolucao:"-",itens_count:((he=ne.itens)==null?void 0:he.length)||0,nome_cliente:(Q==null?void 0:Q.nome)||ne.nome_cliente||"Cliente no encontrado",vendedor:(Q==null?void 0:Q.vendedor)||ne.vendedor||"-",rede:(Q==null?void 0:Q.rede)||ne.rede||"-",uf_destino:(Q==null?void 0:Q.uf)||ne.uf_destino||"-",cidade_destino:(Q==null?void 0:Q.municipio)||ne.cidade_destino||"-",prazo:ne.prazo||(ne.resultado==="LANADA"||ne.resultado==="ANULADA/CANCELADA"?"FINALIZADO":ne.prazo),nome_validador:ne.nome_validador||"-",finalizada_por:ne.finalizada_por||"-",justificativa:ne.justificativa||""}}),Y=K.sort((ne,Q)=>{const fe=zi[ne.resultado]||999,le=zi[Q.resultado]||999;if(fe!==le)return fe-le;const te=ne.data_emissao?new Date(ne.data_emissao).getTime():0;return(Q.data_emissao?new Date(Q.data_emissao).getTime():0)-te});o(Y);const z=K.filter(ne=>ne.resultado==="LANADA"||ne.resultado==="ANULADA/CANCELADA").sort((ne,Q)=>{const fe=zi[ne.resultado]||999,le=zi[Q.resultado]||999;if(fe!==le)return fe-le;const te=ne.data_emissao?new Date(ne.data_emissao).getTime():0;return(Q.data_emissao?new Date(Q.data_emissao).getTime():0)-te});l(z);const ee=Y.filter(ne=>ne.resultado==="LANADA"),L=Y.filter(ne=>ne.resultado==="ANULADA/CANCELADA"),M=ee.reduce((ne,Q)=>ne+(Number(Q.valor_total_nota)||0),0),Z=L.reduce((ne,Q)=>ne+(Number(Q.valor_total_nota)||0),0);let se=0,ae=0;if(R&&C){const ne=Math.ceil((C.getTime()-R.getTime())/864e5),Q=new Date(R);Q.setMonth(Q.getMonth()-1);const fe=new Date(Q);fe.setDate(fe.getDate()+ne);const{data:le}=await St.from("devolucoes").select("valor_total_nota, resultado").gte("data_emissao",Q.toISOString().split("T")[0]).lte("data_emissao",fe.toISOString().split("T")[0]).eq("resultado","LANADA"),te=(le==null?void 0:le.reduce((Ce,Fe)=>Ce+(Number(Fe.valor_total_nota)||0),0))||0;se=te>0?(M-te)/te*100:0;const ce=new Date(R);ce.setFullYear(ce.getFullYear()-1);const he=new Date(C);he.setFullYear(he.getFullYear()-1);const{data:Ee}=await St.from("devolucoes").select("valor_total_nota, resultado").gte("data_emissao",ce.toISOString().split("T")[0]).lte("data_emissao",he.toISOString().split("T")[0]).eq("resultado","LANADA"),ke=(Ee==null?void 0:Ee.reduce((Ce,Fe)=>Ce+(Number(Fe.valor_total_nota)||0),0))||0;ae=ke>0?(M-ke)/ke*100:0}k({valorTotalLancado:M,notasLancadas:ee.length,valorTotalAnulado:Z,notasAnuladas:L.length,momPercent:se,yoyPercent:ae})}i(!1)},B=()=>{try{const I=new h8("p","mm","a4"),H=I.internal.pageSize.getWidth(),O=I.internal.pageSize.getHeight();let R=20;const C=[7,62,41],w=[10,80,55],E=[7,62,41],A=[251,191,36],T=[239,68,68],D=[220,252,231],U=[7,62,41],P={nfPendentes:a.filter(Se=>Se.resultado==="PENDENTE VALIDAO").length,totalPendente:a.filter(Se=>Se.resultado==="PENDENTE VALIDAO").reduce((Se,je)=>Se+(Number(je.valor_total_nota)||0),0),nfCancelamento:a.filter(Se=>Se.resultado==="TRATATIVA DE ANULAO").length,totalCancelamento:a.filter(Se=>Se.resultado==="TRATATIVA DE ANULAO").reduce((Se,je)=>Se+(Number(je.valor_total_nota)||0),0),nfAtraso:a.filter(Se=>Se.prazo==="EM ATRASO").length,totalAtraso:a.filter(Se=>Se.prazo==="EM ATRASO").reduce((Se,je)=>Se+(Number(je.valor_total_nota)||0),0)};I.setFillColor(C[0],C[1],C[2]),I.rect(0,0,H,45,"F");try{const Se=new Image;Se.src="/logo.png",I.addImage(Se,"PNG",15,8,25,25)}catch{I.setFillColor(255,255,255),I.rect(15,8,12,12,"F"),I.setFillColor(w[0],w[1],w[2]),I.rect(15.5,8.5,11,11,"F"),I.setTextColor(255,255,255),I.setFontSize(10),I.setFont("helvetica","bold"),I.text("DM",19,16)}I.setFontSize(22),I.setFont("helvetica","bold"),I.setTextColor(255,255,255),I.text("Gesto de Devolues",45,18),I.setFontSize(10),I.setFont("helvetica","normal"),I.setTextColor(255,255,255),I.text("Grupo Doce Mel",45,28),I.text(`Relatrio Gerado em: ${Wt(new Date,"dd/MM/yyyy HH:mm",{locale:br})}`,15,38);const K=t.startDate&&t.endDate?`${Wt(t.startDate,"dd/MM/yyyy",{locale:br})} a ${Wt(t.endDate,"dd/MM/yyyy",{locale:br})}`:t.period||"Perodo no especificado";I.text(`Perodo: ${K}`,H-15,20,{align:"right"}),I.text("Filial: Todas",H-15,30,{align:"right"}),R=55,I.setTextColor(w[0],w[1],w[2]),I.setFontSize(14),I.setFont("helvetica","bold"),I.text("Resumo Executivo",15,R),R+=10;const Y=(H-45)/3,re=25;let z=15,ee=R;I.setFillColor(D[0],D[1],D[2]),I.setDrawColor(U[0],U[1],U[2]),I.setLineWidth(.5),I.rect(z,ee,Y,re,"FD"),I.setFontSize(10),I.setFont("helvetica","bold"),I.setTextColor(w[0],w[1],w[2]),I.text("NF Pendentes",z+5,ee+8),I.setFontSize(16),I.setTextColor(T[0],T[1],T[2]),I.text(P.nfPendentes.toString(),z+5,ee+18),I.setFontSize(8),I.setTextColor(100,100,100),I.text(`R$ ${P.totalPendente.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,z+5,ee+23),z+=Y+7.5,I.setFillColor(D[0],D[1],D[2]),I.setDrawColor(U[0],U[1],U[2]),I.setLineWidth(.5),I.rect(z,ee,Y,re,"FD"),I.setFontSize(10),I.setFont("helvetica","bold"),I.setTextColor(w[0],w[1],w[2]),I.text("NF Cancelamento",z+5,ee+8),I.setFontSize(16),I.setTextColor(A[0],A[1],A[2]),I.text(P.nfCancelamento.toString(),z+5,ee+18),I.setFontSize(8),I.setTextColor(100,100,100),I.text(`R$ ${P.totalCancelamento.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,z+5,ee+23),z+=Y+7.5,I.setFillColor(D[0],D[1],D[2]),I.setDrawColor(U[0],U[1],U[2]),I.setLineWidth(.5),I.rect(z,ee,Y,re,"FD"),I.setFontSize(10),I.setFont("helvetica","bold"),I.setTextColor(w[0],w[1],w[2]),I.text("NF em Atraso",z+5,ee+8),I.setFontSize(16),I.setTextColor(T[0],T[1],T[2]),I.text(P.nfAtraso.toString(),z+5,ee+18),I.setFontSize(8),I.setTextColor(100,100,100),I.text(`R$ ${P.totalAtraso.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,z+5,ee+23),R+=re+15,z=15,ee=R;const L=a.filter(Se=>Se.resultado==="VALIDADA").length,M=a.filter(Se=>Se.resultado==="VALIDADA").reduce((Se,je)=>Se+(Number(je.valor_total_nota)||0),0);I.setFillColor(D[0],D[1],D[2]),I.setDrawColor(U[0],U[1],U[2]),I.setLineWidth(.5),I.rect(z,ee,Y,re,"FD"),I.setFontSize(10),I.setFont("helvetica","bold"),I.setTextColor(w[0],w[1],w[2]),I.text("NF Validadas",z+5,ee+8),I.setFontSize(16),I.setTextColor(E[0],E[1],E[2]),I.text(L.toString(),z+5,ee+18),I.setFontSize(8),I.setTextColor(100,100,100),I.text(`R$ ${M.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,z+5,ee+23);const Z=a.filter(Se=>Se.resultado==="LANADA").length,se=a.filter(Se=>Se.resultado==="LANADA").reduce((Se,je)=>Se+(Number(je.valor_total_nota)||0),0);z+=Y+7.5,I.setFillColor(D[0],D[1],D[2]),I.setDrawColor(U[0],U[1],U[2]),I.setLineWidth(.5),I.rect(z,ee,Y,re,"FD"),I.setFontSize(10),I.setFont("helvetica","bold"),I.setTextColor(w[0],w[1],w[2]),I.text("NF Lanadas",z+5,ee+8),I.setFontSize(16),I.setTextColor(E[0],E[1],E[2]),I.text(Z.toString(),z+5,ee+18),I.setFontSize(8),I.setTextColor(100,100,100),I.text(`R$ ${se.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,z+5,ee+23);const ae=a.reduce((Se,je)=>Se+(Number(je.valor_total_nota)||0),0);z+=Y+7.5,I.setFillColor(D[0],D[1],D[2]),I.setDrawColor(U[0],U[1],U[2]),I.setLineWidth(.5),I.rect(z,ee,Y,re,"FD"),I.setFontSize(10),I.setFont("helvetica","bold"),I.setTextColor(w[0],w[1],w[2]),I.text("Total Geral",z+5,ee+8),I.setFontSize(16),I.setTextColor(C[0],C[1],C[2]),I.text(a.length.toString(),z+5,ee+18),I.setFontSize(8),I.setTextColor(100,100,100),I.text(`R$ ${ae.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,z+5,ee+23),R+=re+20;const ne=a.reduce((Se,je)=>{const Qe=je.nome_cliente||"Desconhecido",At=Number(je.valor_total_nota)||0;return Se[Qe]=(Se[Qe]||0)+At,Se},{}),Q=Object.entries(ne).map(([Se,je])=>({name:Se,value:je})).sort((Se,je)=>je.value-Se.value).slice(0,5),fe=a.reduce((Se,je)=>{const Qe=je.vendedor||"Desconhecido",At=Number(je.valor_total_nota)||0;return Se[Qe]=(Se[Qe]||0)+At,Se},{}),le=Object.entries(fe).map(([Se,je])=>({name:Se,value:je})).sort((Se,je)=>je.value-Se.value).slice(0,5),te=a.reduce((Se,je)=>{const Qe=je.rede||"Sem rede",At=Number(je.valor_total_nota)||0;return Se[Qe]=(Se[Qe]||0)+At,Se},{}),ce=Object.entries(te).map(([Se,je])=>({name:Se,value:je})).sort((Se,je)=>je.value-Se.value).slice(0,5),he=a.filter(Se=>Se.resultado==="TRATATIVA DE ANULAO").reduce((Se,je)=>{const Qe=new Date(je.data_emissao||je.created_at),At=Wt(Qe,"dd/MM",{locale:br});return Se[At]=(Se[At]||0)+1,Se},{}),Ee=a.reduce((Se,je)=>{const Qe=je.cidade_origem||"N/A";return Se[Qe]=(Se[Qe]||0)+(Number(je.valor_total_nota)||0),Se},{}),ke=Object.entries(Ee).map(([Se,je])=>({name:Se,value:je})).sort((Se,je)=>je.value-Se.value).slice(0,6),Ce=a.reduce((Se,je)=>{const Qe=je.motivo_nome||"No informado";return Se[Qe]=(Se[Qe]||0)+1,Se},{}),Fe=Object.entries(Ce).map(([Se,je])=>({name:Se,value:je})).sort((Se,je)=>je.value-Se.value).slice(0,5),Pe={};a.forEach(Se=>{(Se.itens||[]).forEach(Qe=>{const yt=(Qe.descricao||"Desconhecido").split(" ").slice(0,2).join(" "),Ct=Number(Qe.quantidade)||0;Pe[yt]=(Pe[yt]||0)+Ct})});const Xe=Object.entries(Pe).map(([Se,je])=>({name:Se,quantidade:je})).sort((Se,je)=>je.quantidade-Se.quantidade).slice(0,10);I.setTextColor(w[0],w[1],w[2]),I.setFontSize(14),I.setFont("helvetica","bold"),I.text("Analises Graficas",15,R),R+=10,I.setFontSize(11),I.setFont("helvetica","bold"),I.setTextColor(w[0],w[1],w[2]),I.text("Top 5 Clientes (Valor)",15,R),R+=6,I.setFont("helvetica","normal"),I.setFontSize(9),Q.forEach((Se,je)=>{const Qe=Se.name.length>40?Se.name.substring(0,37)+"...":Se.name;I.text(`${je+1}. ${Qe}: R$ ${Se.value.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,20,R),R+=5}),R+=5,I.setFont("helvetica","bold"),I.setFontSize(11),I.text("Top 5 Vendedores (Valor)",15,R),R+=6,I.setFont("helvetica","normal"),I.setFontSize(9),le.forEach((Se,je)=>{const Qe=Se.name.length>40?Se.name.substring(0,37)+"...":Se.name;I.text(`${je+1}. ${Qe}: R$ ${Se.value.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,20,R),R+=5}),R+=5,I.setFont("helvetica","bold"),I.setFontSize(11),I.text("Top 5 Redes (Valor)",15,R),R+=6,I.setFont("helvetica","normal"),I.setFontSize(9),ce.forEach((Se,je)=>{const Qe=Se.name.length>40?Se.name.substring(0,37)+"...":Se.name;I.text(`${je+1}. ${Qe}: R$ ${Se.value.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,20,R),R+=5}),R+=5;const ct=Object.entries(he).sort((Se,je)=>{const Qe=new Date(Se[0].split("/").reverse().join("-")),At=new Date(je[0].split("/").reverse().join("-"));return Qe.getTime()-At.getTime()}).slice(0,10);I.setFont("helvetica","bold"),I.setFontSize(11),I.text("Notas em Cancelamento",15,R),R+=6,I.setFont("helvetica","normal"),I.setFontSize(9),ct.forEach(([Se,je])=>{I.text(`${Se}: ${je} nota(s)`,20,R),R+=5}),R+=5,I.setFont("helvetica","bold"),I.setFontSize(11),I.text("Distribuio por Municpio",15,R),R+=6,I.setFont("helvetica","normal"),I.setFontSize(9),ke.forEach((Se,je)=>{const Qe=Se.name.length>40?Se.name.substring(0,37)+"...":Se.name;I.text(`${je+1}. ${Qe}: R$ ${Se.value.toLocaleString("pt-BR",{minimumFractionDigits:2})}`,20,R),R+=5}),R+=5,I.setFont("helvetica","bold"),I.setFontSize(11),I.text("Principais Motivos",15,R),R+=6,I.setFont("helvetica","normal"),I.setFontSize(9),Fe.forEach((Se,je)=>{const Qe=Se.name.length>40?Se.name.substring(0,37)+"...":Se.name;I.text(`${je+1}. ${Qe}: ${Se.value} ocorrncia(s)`,20,R),R+=5}),R+=5,I.setFont("helvetica","bold"),I.setFontSize(11),I.text("Produtos Crticos (Top 10)",15,R),R+=6,I.setFont("helvetica","normal"),I.setFontSize(9),Xe.forEach((Se,je)=>{const Qe=Se.name.length>40?Se.name.substring(0,37)+"...":Se.name;I.text(`${je+1}. ${Qe}: ${Se.quantidade.toFixed(2)} unidades`,20,R),R+=5}),R+=10,R>O-50&&(I.addPage(),R=20),I.setTextColor(w[0],w[1],w[2]),I.setFontSize(12),I.setFont("helvetica","bold");const st=a.filter(Se=>Se.resultado==="PENDENTE VALIDAO");if(st.length>0){I.text("1. Lista de Pendentes",15,R),R+=5;const Se=st.map(je=>[je.numero||"-",je.vendedor||"-",(je.nome_cliente||"-").substring(0,30),je.data_emissao?Wt(new Date(je.data_emissao),"dd/MM/yyyy",{locale:br}):"-",`R$ ${(Number(je.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,je.prazo||"-",je.dias!==null&&je.dias!==void 0?je.dias.toString():"-",je.resultado||"-"]);sf(I,{head:[["NF","Vendedor","Cliente","Data Emisso","Valor","Prazo","Dias","Resultado"]],body:Se,startY:R,styles:{fontSize:7,cellPadding:2},headStyles:{fillColor:[C[0],C[1],C[2]],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:15,right:15}}),R=I.lastAutoTable.finalY+10}R>O-50&&(I.addPage(),R=20);const lt=a.filter(Se=>Se.resultado==="TRATATIVA DE ANULAO");if(lt.length>0){I.text("2. Lista em Tratativas",15,R),R+=5;const Se=lt.map(je=>[je.numero||"-",je.vendedor||"-",(je.nome_cliente||"-").substring(0,30),je.data_emissao?Wt(new Date(je.data_emissao),"dd/MM/yyyy",{locale:br}):"-",`R$ ${(Number(je.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,je.prazo||"-",je.dias!==null&&je.dias!==void 0?je.dias.toString():"-",je.resultado||"-"]);sf(I,{head:[["NF","Vendedor","Cliente","Data Emisso","Valor","Prazo","Dias","Resultado"]],body:Se,startY:R,styles:{fontSize:7,cellPadding:2},headStyles:{fillColor:[A[0],A[1],A[2]],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[255,250,240]},margin:{left:15,right:15}}),R=I.lastAutoTable.finalY+10}R>O-50&&(I.addPage(),R=20);const tt=a.filter(Se=>Se.resultado==="VALIDADA");if(tt.length>0){I.text("3. Lista Validadas",15,R),R+=5;const Se=tt.map(je=>[je.numero||"-",je.vendedor||"-",(je.nome_cliente||"-").substring(0,30),je.data_emissao?Wt(new Date(je.data_emissao),"dd/MM/yyyy",{locale:br}):"-",`R$ ${(Number(je.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,je.prazo||"-",je.dias!==null&&je.dias!==void 0?je.dias.toString():"-",je.resultado||"-"]);sf(I,{head:[["NF","Vendedor","Cliente","Data Emisso","Valor","Prazo","Dias","Resultado"]],body:Se,startY:R,styles:{fontSize:7,cellPadding:2},headStyles:{fillColor:[E[0],E[1],E[2]],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[240,255,240]},margin:{left:15,right:15}}),R=I.lastAutoTable.finalY+10}R>O-50&&(I.addPage(),R=20),I.text("4. Lista Completa com Produtos",15,R),R+=5;const ot=[];a.forEach(Se=>{Se.itens&&Se.itens.length>0?Se.itens.forEach(je=>{ot.push([Se.numero||"-",Se.vendedor||"-",(Se.nome_cliente||"-").substring(0,25),(je.descricao||"-").substring(0,30),je.unidade||"-",je.quantidade?je.quantidade.toString():"-",`R$ ${(Number(je.valor_total_bruto)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`])}):ot.push([Se.numero||"-",Se.vendedor||"-",(Se.nome_cliente||"-").substring(0,25),"Sem itens","-","-",`R$ ${(Number(Se.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`])}),sf(I,{head:[["NF","Vendedor","Cliente","Produto","Unidade","Quantidade","Valor"]],body:ot.slice(0,50),startY:R,styles:{fontSize:6,cellPadding:1.5},headStyles:{fillColor:[w[0],w[1],w[2]],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[250,250,250]},margin:{left:15,right:15}}),R=I.lastAutoTable.finalY+10,R>O-60&&(I.addPage(),R=20),I.setFillColor(C[0],C[1],C[2]),I.rect(0,R-5,H,8,"F"),I.setTextColor(255,255,255),I.setFontSize(14),I.setFont("helvetica","bold"),I.text("Inteligencia e Analises",15,R+3),R+=15;const De=a.reduce((Se,je)=>Se+(Number(je.valor_total_nota)||0),0),ht=a.length,rt=a.reduce((Se,je)=>{const Qe=je.itens||[];return Se+Qe.reduce((At,Vt)=>At+(Number(Vt.quantidade)||0),0)},0),it=ht>0?De/ht:0,dt=rt>0&&ht>0?rt/ht:0,wt=[];if(ht>0&&wt.push(`Total de ${ht} devolucao(oes) no periodo selecionado, totalizando R$ ${De.toLocaleString("pt-BR",{minimumFractionDigits:2})}.`),Q.length>0&&De>0){const Se=Q[0].value/De*100;Se>20&&wt.push(`Cliente "${Q[0].name}" concentra ${Se.toFixed(1)}% do valor total de devolucoes.`)}dt>0&&wt.push(`Media de ${dt.toFixed(1)} produtos por devolucao.`),le.length>0&&wt.push(`Vendedor "${le[0].name}" lidera em devolucoes com R$ ${le[0].value.toLocaleString("pt-BR")}.`),Xe.length>0&&wt.push(`Produto "${Xe[0].name}" e o mais devolvido com ${Xe[0].quantidade.toFixed(2)} unidades.`);const gt=a.filter(Se=>Se.resultado==="TRATATIVA DE ANULAO"||Se.resultado==="ANULADA/CANCELADA").length,vt=ht>0?gt/ht*100:0;if(vt>10?wt.push(`Taxa de cancelamento alta: ${vt.toFixed(1)}% das devolucoes estao em cancelamento.`):gt>0&&wt.push(`${gt} devolucao(oes) em processo de cancelamento.`),Fe.length>0&&wt.push(`Motivo mais frequente: "${Fe[0].name}" com ${Fe[0].value} ocorrencia(s).`),it>0){const Se=a.filter(je=>Number(je.valor_total_nota)>it*1.5).length;Se>0&&wt.push(`${Se} devolucao(oes) com valor acima de 150% do ticket medio.`)}if(ce.length>0&&De>0){const Se=ce[0].value/De*100;Se>15&&wt.push(`Rede "${ce[0].name}" representa ${Se.toFixed(1)}% do valor devolvido.`)}I.setTextColor(w[0],w[1],w[2]),I.setFontSize(11),I.setFont("helvetica","bold"),I.text("Insights Automaticos:",15,R),R+=7,I.setFont("helvetica","normal"),I.setFontSize(9),I.setTextColor(0,0,0),wt.forEach(Se=>{R>O-20&&(I.addPage(),R=20),I.text(Se,20,R),R+=5}),R+=5,I.setFont("helvetica","bold"),I.setFontSize(11),I.setTextColor(w[0],w[1],w[2]),I.text("Alertas e Recomendacoes:",15,R),R+=7,I.setFont("helvetica","normal"),I.setFontSize(9),I.setTextColor(0,0,0);const Ve=[];if(P.nfAtraso>0&&Ve.push(`${P.nfAtraso} nota(s) fiscal(is) em atraso requerem atencao imediata`),P.nfPendentes>10&&Ve.push(`Alto volume de pendencias (${P.nfPendentes}) - considere revisar processos`),P.totalCancelamento>ae*.1&&Ve.push("Taxa de cancelamento acima de 10% - investigar causas"),a.length>0){const Se=a.filter(je=>je.dias!==null&&je.dias!==void 0).reduce((je,Qe)=>je+(Qe.dias||0),0)/a.filter(je=>je.dias!==null&&je.dias!==void 0).length;Se>30&&Ve.push(`Tempo medio de processamento alto (${Se.toFixed(1)} dias)`)}Ve.length===0&&Ve.push("Nenhum alerta critico identificado"),Ve.forEach(Se=>{R>O-20&&(I.addPage(),R=20),I.text(Se,20,R),R+=5}),R+=5,I.setFont("helvetica","bold"),I.setFontSize(11),I.setTextColor(w[0],w[1],w[2]),I.text("Tendencias:",15,R),R+=7,I.setFont("helvetica","normal"),I.setFontSize(9),I.setTextColor(0,0,0);const $e=a.length>0?(tt.length/a.length*100).toFixed(1):"0",xt=a.length>0?(P.nfCancelamento/a.length*100).toFixed(1):"0";I.text(`Taxa de Validacao: ${$e}%`,20,R),R+=5,I.text(`Taxa de Cancelamento: ${xt}%`,20,R),R+=5,I.text(`Total Processado: ${a.length} nota(s) fiscal(is)`,20,R);const nt=I.getNumberOfPages();for(let Se=1;Se<=nt;Se++)I.setPage(Se),I.setFontSize(8),I.setTextColor(150,150,150),I.text(`Pgina ${Se} de ${nt} - Sistema de Devolues`,H/2,O-10,{align:"center"});const pt=`Relatorio_Devolucoes_${Wt(new Date,"yyyy-MM-dd_HH-mm-ss",{locale:br})}.pdf`;I.save(pt),_t.success("PDF gerado com sucesso!")}catch(I){console.error("Erro ao gerar PDF:",I),_t.error("Erro ao gerar PDF: "+I.message)}};_e.useEffect(()=>{if(s.length===0)return;let I=[...s];v&&g?I=[...a].sort((R,C)=>{let w,E;switch(v){case"data_emissao":w=R.data_emissao?new Date(R.data_emissao).getTime():0,E=C.data_emissao?new Date(C.data_emissao).getTime():0;break;case"numero":w=R.numero||"",E=C.numero||"";break;case"nome_cliente":w=(R.nome_cliente||"").toLowerCase(),E=(C.nome_cliente||"").toLowerCase();break;case"cidade_origem":w=(R.cidade_origem||"").toLowerCase(),E=(C.cidade_origem||"").toLowerCase();break;case"vendedor":w=(R.vendedor||"").toLowerCase(),E=(C.vendedor||"").toLowerCase();break;case"motivo_nome":w=(R.motivo_nome||"").toLowerCase(),E=(C.motivo_nome||"").toLowerCase();break;case"valor_total_nota":w=parseFloat(R.valor_total_nota||0),E=parseFloat(C.valor_total_nota||0);break;case"dias":w=R.dias!==null&&R.dias!==void 0?R.dias:-1,E=C.dias!==null&&C.dias!==void 0?C.dias:-1;break;case"prazo":w=(R.prazo||"").toLowerCase(),E=(C.prazo||"").toLowerCase();break;case"resultado":w=zi[R.resultado]||999,E=zi[C.resultado]||999;break;default:return 0}return w<E?g==="asc"?-1:1:w>E?g==="asc"?1:-1:0}):I=[...s].sort((R,C)=>{const w=zi[R.resultado]||999,E=zi[C.resultado]||999;if(w!==E)return w-E;const A=R.data_emissao?new Date(R.data_emissao).getTime():0;return(C.data_emissao?new Date(C.data_emissao).getTime():0)-A});const H=(u-1)*N,O=H+N;n(I.slice(H,O))},[v,g,s,u]);const W=I=>{v===I?g==="asc"?x("desc"):g==="desc"&&(b(null),x(null)):(b(I),x("asc")),p(1)},V=({field:I})=>v!==I?_.jsx(Ry,{className:"ml-1 h-4 w-4 opacity-50"}):g==="asc"?_.jsx(My,{className:"ml-1 h-4 w-4"}):_.jsx(Dy,{className:"ml-1 h-4 w-4"}),q=async()=>{if(!(!f||!r))try{const{error:I}=await St.from("itens_devolucao").delete().eq("devolucao_id",f);if(I)throw I;const{error:H}=await St.from("devolucoes").delete().eq("id",f);if(H)throw H;_t.success("Registro excludo com sucesso!"),h(null),F()}catch(I){_t.error("Erro ao excluir registro: "+I.message)}},X=async()=>{if(a.length===0){_t.warning("Sem dados para exportar");return}try{const I=a.map(Y=>Y.id);let H=new Map;if(I.length>0){const{data:Y}=await St.from("logs_validacao").select(`
            devolucao_id,
            status_novo,
            usuario_id
          `).in("devolucao_id",I).order("created_at",{ascending:!1});if(Y){const re=[...new Set(Y.map(ee=>ee.usuario_id).filter(Boolean))],z=new Map;if(re.length>0){const{data:ee}=await St.from("profiles").select("id, name").in("id",re);ee&&ee.forEach(L=>{z.set(L.id,L.name)})}Y.forEach(ee=>{const L=`${ee.devolucao_id}_${ee.status_novo}`;if(!H.has(L)){const M=z.get(ee.usuario_id);M&&H.set(L,M)}})}}const O=[];a.forEach(Y=>{const re=Y.resultado||"PENDENTE VALIDAO",z=re!=="PENDENTE VALIDAO"&&H.get(`${Y.id}_${re}`)||"-";!Y.itens||Y.itens.length===0?O.push({"Data Emisso":Y.data_emissao?Wt(new Date(Y.data_emissao),"dd/MM/yyyy"):"","Data Criao":Y.created_at?Wt(new Date(Y.created_at),"dd/MM/yyyy HH:mm"):"","Nota Fiscal":Y.numero||"",Srie:Y.serie||"","Chave de Acesso":Y.chave_acesso||"",Cliente:Y.nome_cliente||"","CNPJ Cliente":Y.cnpj_destinatario||"","CNPJ Emitente":Y.cnpj_emitente||"","Razo Social Emitente":Y.razao_social_emitente||"",Vendedor:Y.vendedor||"",Rede:Y.rede||"","Cidade Origem":Y.cidade_origem||"","UF Origem":Y.uf_origem||"","Cidade Destino":Y.cidade_destino||"","UF Destino":Y.uf_destino||"",Setor:Y.setor_nome||"",Motivo:Y.motivo_nome||"",Status:re,"Validado Por":z,Comentrio:Y.justificativa||"",Dias:Y.dias!==null&&Y.dias!==void 0?Y.dias:"",Prazo:Y.prazo||"","Valor Total Nota":Y.valor_total_nota?Number(Y.valor_total_nota).toFixed(2):"0.00","Peso Lquido":Y.peso_liquido||"","Sincronizao ERP":Y.sincronizacao_erp||"","Finalidade NFe":Y.finalidade_nfe||"","Natureza Operao":Y.natureza_operacao||"",CFOP:Y.cfop||"","Nmero Item":"","Descrio Produto":"",Unidade:"",Quantidade:"","Valor Unitrio":"","Valor Total Item":""}):Y.itens.forEach((ee,L)=>{O.push({"Data Emisso":L===0&&Y.data_emissao?Wt(new Date(Y.data_emissao),"dd/MM/yyyy"):"","Data Criao":L===0&&Y.created_at?Wt(new Date(Y.created_at),"dd/MM/yyyy HH:mm"):"","Nota Fiscal":L===0&&Y.numero||"",Srie:L===0&&Y.serie||"","Chave de Acesso":L===0&&Y.chave_acesso||"",Cliente:L===0&&Y.nome_cliente||"","CNPJ Cliente":L===0&&Y.cnpj_destinatario||"","CNPJ Emitente":L===0&&Y.cnpj_emitente||"","Razo Social Emitente":L===0&&Y.razao_social_emitente||"",Vendedor:L===0&&Y.vendedor||"",Rede:L===0&&Y.rede||"","Cidade Origem":L===0&&Y.cidade_origem||"","UF Origem":L===0&&Y.uf_origem||"","Cidade Destino":L===0&&Y.cidade_destino||"","UF Destino":L===0&&Y.uf_destino||"",Setor:L===0&&Y.setor_nome||"",Motivo:L===0&&Y.motivo_nome||"",Status:L===0?re:"","Validado Por":L===0?z:"",Comentrio:L===0&&Y.justificativa||"",Dias:L===0&&Y.dias!==null&&Y.dias!==void 0?Y.dias:"",Prazo:L===0&&Y.prazo||"","Valor Total Nota":L===0?Y.valor_total_nota?Number(Y.valor_total_nota).toFixed(2):"0.00":"","Peso Lquido":L===0&&Y.peso_liquido||"","Sincronizao ERP":L===0&&Y.sincronizacao_erp||"","Finalidade NFe":L===0&&Y.finalidade_nfe||"","Natureza Operao":L===0&&Y.natureza_operacao||"",CFOP:L===0&&Y.cfop||"","Nmero Item":ee.numero_item||"","Descrio Produto":ee.descricao||"",Unidade:ee.unidade||"",Quantidade:ee.quantidade?Number(ee.quantidade).toFixed(2):"","Valor Unitrio":ee.valor_unitario?Number(ee.valor_unitario).toFixed(2):"","Valor Total Item":ee.valor_total_bruto?Number(ee.valor_total_bruto).toFixed(2):""})})});const R=new rj.Workbook,C=R.addWorksheet("Devolues"),w=["Data Emisso","Data Criao","Nota Fiscal","Srie","Chave de Acesso","Cliente","CNPJ Cliente","CNPJ Emitente","Razo Social Emitente","Vendedor","Rede","Cidade Origem","UF Origem","Cidade Destino","UF Destino","Setor","Motivo","Status","Validado Por","Comentrio","Dias","Prazo","Valor Total Nota","Peso Lquido","Sincronizao ERP","Finalidade NFe","Natureza Operao","CFOP","Nmero Item","Descrio Produto","Unidade","Quantidade","Valor Unitrio","Valor Total Item"],E=[12,18,12,8,45,30,18,18,30,20,20,20,5,20,5,15,30,20,20,40,8,12,15,12,18,15,20,8,12,40,8,12,15,15],A=C.addRow(w);A.eachCell(Y=>{Y.font={bold:!0,color:{argb:"FFFFFFFF"},size:11},Y.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF073E29"}},Y.alignment={vertical:"middle",horizontal:"center",wrapText:!0},Y.border={top:{style:"thin",color:{argb:"FF000000"}},left:{style:"thin",color:{argb:"FF000000"}},bottom:{style:"thin",color:{argb:"FF000000"}},right:{style:"thin",color:{argb:"FF000000"}}}}),A.height=25,E.forEach((Y,re)=>{C.getColumn(re+1).width=Y}),O.forEach(Y=>{C.addRow(w.map(z=>Y[z]||"")).eachCell(z=>{z.border={top:{style:"thin",color:{argb:"FFCCCCCC"}},left:{style:"thin",color:{argb:"FFCCCCCC"}},bottom:{style:"thin",color:{argb:"FFCCCCCC"}},right:{style:"thin",color:{argb:"FFCCCCCC"}}}})});const T=w.indexOf("Chave de Acesso")+1;C.getColumn(T).numFmt="@",C.autoFilter={from:{row:1,column:1},to:{row:O.length+1,column:w.length}},C.views=[{state:"frozen",ySplit:1}];const D=await R.xlsx.writeBuffer(),U=new Blob([D],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),P=window.URL.createObjectURL(U),K=document.createElement("a");K.href=P,K.download=`Relatorio_Devolucoes_${Wt(new Date,"yyyy-MM-dd_HHmm")}.xlsx`,K.click(),window.URL.revokeObjectURL(P),_t.success("Relatrio Excel gerado com sucesso!")}catch(I){console.error("Erro ao gerar Excel:",I),_t.error("Erro ao gerar relatrio Excel: "+I.message)}};return _.jsxs("div",{className:"space-y-6",children:[_.jsx(Qi,{title:"Relatrios",description:"Visualize e exporte relatrios detalhados das devolues. Gere PDFs e planilhas Excel com todos os dados filtrados."}),_.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[_.jsx(Xf,{}),_.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full md:w-auto shrink-0",children:[_.jsxs(Nt,{variant:"outline",onClick:X,className:"w-full sm:w-auto",children:[_.jsx(MS,{className:"mr-2 h-4 w-4 text-green-600"}),"Exportar Excel"]}),_.jsxs(Nt,{variant:"outline",onClick:()=>{const I=nj({data:a,stats:{nfPendentes:a.filter(O=>O.resultado==="PENDENTE VALIDAO").length,totalPendente:a.filter(O=>O.resultado==="PENDENTE VALIDAO").reduce((O,R)=>O+(Number(R.valor_total_nota)||0),0),nfCancelamento:a.filter(O=>O.resultado==="TRATATIVA DE ANULAO").length,totalCancelamento:a.filter(O=>O.resultado==="TRATATIVA DE ANULAO").reduce((O,R)=>O+(Number(R.valor_total_nota)||0),0),nfAtraso:a.filter(O=>O.prazo==="EM ATRASO").length,totalAtraso:a.filter(O=>O.prazo==="EM ATRASO").reduce((O,R)=>O+(Number(R.valor_total_nota)||0),0),nfValidadas:a.filter(O=>O.resultado==="VALIDADA").length,totalValidadas:a.filter(O=>O.resultado==="VALIDADA").reduce((O,R)=>O+(Number(R.valor_total_nota)||0),0),nfLancadas:a.filter(O=>O.resultado==="LANADA").length,totalLancadas:a.filter(O=>O.resultado==="LANADA").reduce((O,R)=>O+(Number(R.valor_total_nota)||0),0),totalGeral:a.reduce((O,R)=>O+(Number(R.valor_total_nota)||0),0)},filters:t}),H=window.open("","_blank");H&&(H.document.write(I),H.document.close())},className:"w-full sm:w-auto",children:[_.jsx(Jb,{className:"mr-2 h-4 w-4"}),"Gerar Relatrio HTML"]}),_.jsxs(Nt,{variant:"outline",onClick:B,className:"w-full sm:w-auto",children:[_.jsx(Jb,{className:"mr-2 h-4 w-4"}),"Gerar PDF"]})]})]}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-6",children:[_.jsxs(jt,{children:[_.jsx(Dt,{className:"pb-3",children:_.jsx(Rt,{className:"text-sm font-semibold",children:"Valor Total Lanado"})}),_.jsxs(Ot,{children:[_.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",y.valorTotalLancado.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),_.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[y.notasLancadas," nota(s) lanada(s)"]})]})]}),_.jsxs(jt,{children:[_.jsx(Dt,{className:"pb-3",children:_.jsx(Rt,{className:"text-sm font-semibold",children:"Notas Lanadas"})}),_.jsxs(Ot,{children:[_.jsx("div",{className:"text-2xl font-bold",children:y.notasLancadas}),_.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Total de notas com resultado LANADA"})]})]}),_.jsxs(jt,{children:[_.jsx(Dt,{className:"pb-3",children:_.jsx(Rt,{className:"text-sm font-semibold",children:"Valor Total Anulado"})}),_.jsxs(Ot,{children:[_.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",y.valorTotalAnulado.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]}),_.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[y.notasAnuladas," nota(s) anulada(s)"]})]})]}),_.jsxs(jt,{children:[_.jsx(Dt,{className:"pb-3",children:_.jsx(Rt,{className:"text-sm font-semibold",children:"Notas Anuladas"})}),_.jsxs(Ot,{children:[_.jsx("div",{className:"text-2xl font-bold",children:y.notasAnuladas}),_.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Total de notas com resultado ANULADA/CANCELADA"})]})]})]}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-2 mb-6",children:[_.jsxs(jt,{children:[_.jsx(Dt,{className:"pb-3",children:_.jsx(Rt,{className:"text-sm font-semibold",children:"Comparativo MoM"})}),_.jsxs(Ot,{children:[_.jsxs("div",{className:"flex items-center gap-2",children:[y.momPercent>=0?_.jsx(_u,{className:"h-6 w-6 text-red-600"}):_.jsx(ox,{className:"h-6 w-6 text-green-600"}),_.jsxs("div",{className:"text-2xl font-bold",style:{color:y.momPercent>=0?"#dc2626":"#16a34a"},children:[Math.abs(y.momPercent).toFixed(2),"%"]})]}),_.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Variao ms sobre ms (valor total)"})]})]}),_.jsxs(jt,{children:[_.jsx(Dt,{className:"pb-3",children:_.jsx(Rt,{className:"text-sm font-semibold",children:"Comparativo YoY"})}),_.jsxs(Ot,{children:[_.jsxs("div",{className:"flex items-center gap-2",children:[y.yoyPercent>=0?_.jsx(_u,{className:"h-6 w-6 text-red-600"}):_.jsx(ox,{className:"h-6 w-6 text-green-600"}),_.jsxs("div",{className:"text-2xl font-bold",style:{color:y.yoyPercent>=0?"#dc2626":"#16a34a"},children:[Math.abs(y.yoyPercent).toFixed(2),"%"]})]}),_.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Variao ano sobre ano (valor total)"})]})]})]}),_.jsxs(jt,{children:[_.jsx(Dt,{children:_.jsx(Rt,{children:"Detalhamento de Devolues"})}),_.jsx(Ot,{children:c?_.jsx("div",{className:"flex justify-center py-10",children:_.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"})}):_.jsx("div",{className:"rounded-md border overflow-x-auto",children:_.jsxs(Un,{children:[_.jsx(Jn,{children:_.jsxs(dr,{children:[_.jsx(Tt,{className:"w-[50px]"}),_.jsx(Tt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>W("data_emissao"),children:_.jsxs("div",{className:"flex items-center",children:["Data Emisso",_.jsx(V,{field:"data_emissao"})]})}),_.jsx(Tt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>W("numero"),children:_.jsxs("div",{className:"flex items-center",children:["Nota Fiscal",_.jsx(V,{field:"numero"})]})}),_.jsx(Tt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>W("nome_cliente"),children:_.jsxs("div",{className:"flex items-center",children:["Cliente",_.jsx(V,{field:"nome_cliente"})]})}),_.jsx(Tt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>W("vendedor"),children:_.jsxs("div",{className:"flex items-center",children:["Vendedor",_.jsx(V,{field:"vendedor"})]})}),_.jsx(Tt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>W("motivo"),children:_.jsxs("div",{className:"flex items-center",children:["Motivo",_.jsx(V,{field:"motivo"})]})}),_.jsx(Tt,{className:"text-[10px] px-2",children:"Setor"}),_.jsx(Tt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>W("valor_total_nota"),children:_.jsxs("div",{className:"flex items-center",children:["Valor Total",_.jsx(V,{field:"valor_total_nota"})]})}),_.jsx(Tt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>W("prazo"),children:_.jsxs("div",{className:"flex items-center",children:["Prazo",_.jsx(V,{field:"prazo"})]})}),_.jsx(Tt,{className:"cursor-pointer hover:bg-muted/50 text-[10px] px-2",onClick:()=>W("resultado"),children:_.jsxs("div",{className:"flex items-center",children:["Resultado",_.jsx(V,{field:"resultado"})]})}),_.jsx(Tt,{className:"text-[10px] px-2",children:"Validado Por"}),_.jsx(Tt,{className:"text-[10px] px-2",children:"Finalizada Por"}),_.jsx(Tt,{className:"text-[10px] px-2",children:"Comentrio"}),_.jsx(Tt,{className:"text-[10px] px-2",children:"Aes"})]})}),_.jsxs(zn,{children:[e.map(I=>_.jsx(dr,{className:"group",children:_.jsx(Pt,{colSpan:14,className:"p-0 border-b",children:_.jsx(s_,{type:"single",collapsible:!0,className:"w-full",children:_.jsxs(Lm,{value:I.id,className:"border-b-0",children:[_.jsx("div",{className:"flex items-center w-full py-2 px-4 hover:bg-muted/50",children:_.jsxs("div",{className:"flex gap-2 w-full items-center text-[10px]",children:[_.jsx(Bm,{className:"w-[50px] py-0 pr-4 hover:no-underline flex-shrink-0"}),_.jsx("div",{className:"w-20",children:I.data_emissao?Wt(new Date(I.data_emissao),"dd/MM/yyyy"):"-"}),_.jsx("div",{className:"w-20 font-medium",children:I.numero}),_.jsx("div",{className:"w-32 truncate",title:I.nome_cliente,children:I.nome_cliente}),_.jsx("div",{className:"w-24 truncate",title:I.vendedor,children:I.vendedor}),_.jsx("div",{className:"w-40 truncate",title:I.motivo_nome,children:I.motivo_nome||"-"}),_.jsx("div",{className:"w-32 truncate",title:I.setor_nome,children:I.setor_nome||"-"}),_.jsxs("div",{className:"w-28 text-right",children:["R$ ",Number(I.valor_total_nota||0).toLocaleString("pt-BR",{minimumFractionDigits:2})]}),_.jsx("div",{className:"w-20",children:_.jsx("span",{className:`text-[9px] px-1 py-0.5 rounded ${I.prazo==="EM ATRASO"?"bg-red-500 text-white":I.prazo==="NO PRAZO"?"bg-green-500 text-white":I.prazo==="FINALIZADO"?"bg-green-200 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-500 text-white"}`,children:I.prazo||"-"})}),_.jsx("div",{className:"w-32",children:_.jsx("span",{className:`text-[9px] px-1 py-0.5 rounded ${I.resultado==="VALIDADA"||I.resultado==="LANADA"?"bg-blue-500 text-white":I.resultado==="ANULADA/CANCELADA"?"bg-red-500 text-white":"bg-gray-500 text-white"}`,children:I.resultado||"-"})}),_.jsx("div",{className:"w-28 truncate text-[9px]",title:I.nome_validador||"-",children:I.nome_validador||"-"}),_.jsx("div",{className:"w-28 truncate text-[9px]",title:I.finalizada_por||"-",children:I.finalizada_por||"-"}),_.jsx("div",{className:"w-48 truncate text-[9px]",title:I.justificativa||"-",children:I.justificativa||"-"}),_.jsx("div",{className:"w-28 flex gap-1",children:((r==null?void 0:r.role)==="ADMIN"||(r==null?void 0:r.role)==="LOGISTICA")&&_.jsx(_.Fragment,{children:_.jsx(Nt,{size:"sm",variant:"destructive",className:"h-7 px-1",onClick:H=>{H.stopPropagation(),h(I.id)},title:"Excluir",children:_.jsx(za,{className:"h-3 w-3"})})})})]})}),_.jsx(Um,{children:_.jsx("div",{className:"px-4 pb-4",children:_.jsxs("div",{className:"rounded-md border bg-muted/50 p-4",children:[_.jsx("h4",{className:"font-semibold mb-2 text-sm",children:"Itens da Devoluo"}),_.jsxs(Un,{children:[_.jsx(Jn,{children:_.jsxs(dr,{children:[_.jsx(Tt,{className:"h-8 text-xs",children:"Nmero"}),_.jsx(Tt,{className:"h-8 text-xs",children:"Descrio"}),_.jsx(Tt,{className:"h-8 text-xs",children:"Unidade"}),_.jsx(Tt,{className:"h-8 text-xs",children:"Quantidade"}),_.jsx(Tt,{className:"h-8 text-xs",children:"Valor Unitrio"}),_.jsx(Tt,{className:"h-8 text-xs",children:"Valor Total Bruto"}),_.jsx(Tt,{className:"h-8 text-xs",children:"Motivo"})]})}),_.jsx(zn,{children:I.itens&&I.itens.length>0?I.itens.map((H,O)=>{var R;return _.jsxs(dr,{children:[_.jsx(Pt,{className:"text-xs",children:H.numero_item||"-"}),_.jsx(Pt,{className:"text-xs",children:H.descricao||"-"}),_.jsx(Pt,{className:"text-xs",children:H.unidade||"-"}),_.jsx(Pt,{className:"text-xs",children:H.quantidade||"-"}),_.jsxs(Pt,{className:"text-xs",children:["R$ ",Number(H.valor_unitario||0).toFixed(2)]}),_.jsxs(Pt,{className:"text-xs",children:["R$ ",Number(H.valor_total_bruto||0).toFixed(2)]}),_.jsx(Pt,{className:"text-xs",children:((R=H.motivo_item)==null?void 0:R.nome)||"-"})]},O)}):_.jsx(dr,{children:_.jsx(Pt,{colSpan:7,className:"text-center text-xs text-muted-foreground",children:"Nenhum item cadastrado"})})})]})]})})})]})})})},I.id)),e.length===0&&_.jsx(dr,{children:_.jsx(Pt,{colSpan:14,className:"text-center py-8 text-muted-foreground",children:"Nenhum dado encontrado com os filtros atuais."})})]})]})})})]}),!c&&s.length>0&&_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",(u-1)*N+1," a ",Math.min(u*N,s.length)," de ",s.length," registros"]}),_.jsxs("div",{className:"flex gap-2",children:[_.jsxs(Nt,{variant:"outline",size:"sm",onClick:()=>p(I=>Math.max(1,I-1)),disabled:u===1,children:[_.jsx(yu,{className:"h-4 w-4 mr-1"}),"Anterior"]}),_.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.ceil(s.length/N)},(I,H)=>H+1).filter(I=>{const H=Math.ceil(s.length/N);return I===1||I===H||I>=u-2&&I<=u+2}).map((I,H,O)=>{const R=O[H-1],C=R&&I-R>1;return _.jsxs("div",{className:"flex items-center gap-1",children:[C&&_.jsx("span",{className:"px-2",children:"..."}),_.jsx(Nt,{variant:u===I?"default":"outline",size:"sm",onClick:()=>p(I),className:"w-10",children:I})]},I)})}),_.jsxs(Nt,{variant:"outline",size:"sm",onClick:()=>p(I=>Math.min(Math.ceil(s.length/N),I+1)),disabled:u>=Math.ceil(s.length/N),children:["Prxima",_.jsx(wu,{className:"h-4 w-4 ml-1"})]})]})]}),_.jsx(ri,{open:!!f,onOpenChange:I=>!I&&h(null),children:_.jsxs(As,{className:"sm:max-w-[425px]",children:[_.jsxs(Cs,{children:[_.jsxs(js,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[_.jsx(za,{className:"h-5 w-5"}),"Confirmar Excluso"]}),_.jsx(Os,{className:"pt-2",children:"Tem certeza que deseja excluir este registro?"}),_.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mt-4",children:_.jsx("p",{className:"text-sm text-destructive font-medium",children:" Esta ao no pode ser desfeita."})})]}),_.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[_.jsx(Nt,{variant:"outline",onClick:()=>h(null),className:"flex-1 sm:flex-initial",children:"No"}),_.jsx(Nt,{variant:"destructive",onClick:q,className:"flex-1 sm:flex-initial",children:"Sim, Excluir"})]})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var o_=1252,sj=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],zm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},$m=function(t){sj.indexOf(t)!=-1&&(o_=zm[0]=t)};function ij(){$m(1252)}var ls=function(t){$m(t)};function l_(){ls(1200),ij()}function Gx(t){for(var r=[],e=0,n=t.length;e<n;++e)r[e]=t.charCodeAt(e);return r}function oj(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e)+(t.charCodeAt(2*e+1)<<8));return r.join("")}function c_(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e+1)+(t.charCodeAt(2*e)<<8));return r.join("")}var au=function(t){var r=t.charCodeAt(0),e=t.charCodeAt(1);return r==255&&e==254?oj(t.slice(2)):r==254&&e==255?c_(t.slice(2)):r==65279?t.slice(1):t},hf=function(r){return String.fromCharCode(r)},Yx=function(r){return String.fromCharCode(r)},ju,Wi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Xx(t){for(var r="",e=0,n=0,a=0,o=0,s=0,l=0,c=0,i=0;i<t.length;)e=t.charCodeAt(i++),o=e>>2,n=t.charCodeAt(i++),s=(e&3)<<4|n>>4,a=t.charCodeAt(i++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),r+=Wi.charAt(o)+Wi.charAt(s)+Wi.charAt(l)+Wi.charAt(c);return r}function Ta(t){var r="",e=0,n=0,a=0,o=0,s=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var i=0;i<t.length;)o=Wi.indexOf(t.charAt(i++)),s=Wi.indexOf(t.charAt(i++)),e=o<<2|s>>4,r+=String.fromCharCode(e),l=Wi.indexOf(t.charAt(i++)),n=(s&15)<<4|l>>2,l!==64&&(r+=String.fromCharCode(n)),c=Wi.indexOf(t.charAt(i++)),a=(l&3)<<6|c,c!==64&&(r+=String.fromCharCode(a));return r}var fr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),$o=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(r,e){return e?new Buffer(r,e):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function eo(t){return fr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Kx(t){return fr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var is=function(r){return fr?$o(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)&255})};function Vo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],e=0;e<t.length;++e)r[e]=String.fromCharCode(t[e]);return r.join("")}function Vm(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Vm(new Uint8Array(t));for(var r=new Array(t.length),e=0;e<t.length;++e)r[e]=t[e];return r}var qi=fr?function(t){return Buffer.concat(t.map(function(r){return Buffer.isBuffer(r)?r:$o(r)}))}:function(t){if(typeof Uint8Array<"u"){var r=0,e=0;for(r=0;r<t.length;++r)e+=t[r].length;var n=new Uint8Array(e),a=0;for(r=0,e=0;r<t.length;e+=a,++r)if(a=t[r].length,t[r]instanceof Uint8Array)n.set(t[r],e);else{if(typeof t[r]=="string")throw"wtf";n.set(new Uint8Array(t[r]),e)}return n}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function lj(t){for(var r=[],e=0,n=t.length+250,a=eo(t.length+255),o=0;o<t.length;++o){var s=t.charCodeAt(o);if(s<128)a[e++]=s;else if(s<2048)a[e++]=192|s>>6&31,a[e++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var l=t.charCodeAt(++o)&1023;a[e++]=240|s>>8&7,a[e++]=128|s>>2&63,a[e++]=128|l>>6&15|(s&3)<<4,a[e++]=128|l&63}else a[e++]=224|s>>12&15,a[e++]=128|s>>6&63,a[e++]=128|s&63;e>n&&(r.push(a.slice(0,e)),e=0,a=eo(65535),n=65530)}return r.push(a.slice(0,e)),qi(r)}var ea=/\u0000/g,su=/[\u0001-\u0006]/g;function Wl(t){for(var r="",e=t.length-1;e>=0;)r+=t.charAt(e--);return r}function cs(t,r){var e=""+t;return e.length>=r?e:Gr("0",r-e.length)+e}function Hm(t,r){var e=""+t;return e.length>=r?e:Gr(" ",r-e.length)+e}function Cf(t,r){var e=""+t;return e.length>=r?e:e+Gr(" ",r-e.length)}function cj(t,r){var e=""+Math.round(t);return e.length>=r?e:Gr("0",r-e.length)+e}function uj(t,r){var e=""+t;return e.length>=r?e:Gr("0",r-e.length)+e}var Zx=Math.pow(2,32);function Ol(t,r){if(t>Zx||t<-Zx)return cj(t,r);var e=Math.round(t);return uj(e,r)}function Nf(t,r){return r=r||0,t.length>=7+r&&(t.charCodeAt(r)|32)===103&&(t.charCodeAt(r+1)|32)===101&&(t.charCodeAt(r+2)|32)===110&&(t.charCodeAt(r+3)|32)===101&&(t.charCodeAt(r+4)|32)===114&&(t.charCodeAt(r+5)|32)===97&&(t.charCodeAt(r+6)|32)===108}var Jx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],xp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function dj(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var rr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Qx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},fj={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function jf(t,r,e){for(var n=t<0?-1:1,a=t*n,o=0,s=1,l=0,c=1,i=0,u=0,p=Math.floor(a);i<r&&(p=Math.floor(a),l=p*s+o,u=p*i+c,!(a-p<5e-8));)a=1/(a-p),o=s,s=l,c=i,i=u;if(u>r&&(i>r?(u=c,l=o):(u=i,l=s)),!e)return[0,n*l,u];var f=Math.floor(n*l/u);return[f,n*l-f*u,u]}function Fo(t,r,e){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),o=0,s=[],l={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),r&&r.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)s=e?[1317,10,29]:[1900,2,29],o=3;else if(n===0)s=e?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],o=c.getDay(),n<60&&(o=(o+6)%7),e&&(o=bj(c,s))}return l.y=s[0],l.m=s[1],l.d=s[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=o,l}var u_=new Date(1899,11,31,0,0,0),hj=u_.getTime(),pj=new Date(1900,2,1,0,0,0);function d_(t,r){var e=t.getTime();return r?e-=1461*24*60*60*1e3:t>=pj&&(e+=24*60*60*1e3),(e-(hj+(t.getTimezoneOffset()-u_.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function qm(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function mj(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function gj(t){var r=t<0?12:11,e=qm(t.toFixed(12));return e.length<=r||(e=t.toPrecision(10),e.length<=r)?e:t.toExponential(5)}function vj(t){var r=qm(t.toFixed(11));return r.length>(t<0?12:11)||r==="0"||r==="-0"?t.toPrecision(6):r}function Ou(t){var r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),e;return r>=-4&&r<=-1?e=t.toPrecision(10+r):Math.abs(r)<=9?e=gj(t):r===10?e=t.toFixed(10).substr(0,12):e=vj(t),qm(mj(e.toUpperCase()))}function Bo(t,r){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Ou(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ha(14,d_(t,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+t)}function bj(t,r){r[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}function xj(t,r,e,n){var a="",o=0,s=0,l=e.y,c,i=0;switch(t){case 98:l=e.y+543;case 121:switch(r.length){case 1:case 2:c=l%100,i=2;break;default:c=l%1e4,i=4;break}break;case 109:switch(r.length){case 1:case 2:c=e.m,i=r.length;break;case 3:return xp[e.m-1][1];case 5:return xp[e.m-1][0];default:return xp[e.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=e.d,i=r.length;break;case 3:return Jx[e.q][0];default:return Jx[e.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(e.H+11)%12,i=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=e.H,i=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=e.M,i=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return e.u===0&&(r=="s"||r=="ss")?cs(e.S,r.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,o=Math.round(s*(e.S+e.u)),o>=60*s&&(o=0),r==="s"?o===0?"0":""+o/s:(a=cs(o,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=e.D*24+e.H;break;case"[m]":case"[mm]":c=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":c=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+r}i=r.length===3?1:2;break;case 101:c=l,i=1;break}var u=i>0?cs(c,i):"";return u}function Gi(t){var r=3;if(t.length<=r)return t;for(var e=t.length%r,n=t.substr(0,e);e!=t.length;e+=r)n+=(n.length>0?",":"")+t.substr(e,r);return n}var f_=/%/g;function yj(t,r,e){var n=r.replace(f_,""),a=r.length-n.length;return ai(t,n,e*Math.pow(10,2*a))+Gr("%",a)}function wj(t,r,e){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return ai(t,r.substr(0,n),e/Math.pow(10,3*(r.length-n)))}function h_(t,r){var e,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+h_(t,-r);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%a;if(o<0&&(o+=a),e=(r/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),e.indexOf("e")===-1){var s=Math.floor(Math.log(r)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+o):e+="E+"+(s-o);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,a)+"."+e.substr(2+a),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,i,u){return c+i+u.substr(0,(a+o)%a)+"."+u.substr(o)+"E"})}else e=r.toExponential(n);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var p_=/# (\?+)( ?)\/( ?)(\d+)/;function _j(t,r,e){var n=parseInt(t[4],10),a=Math.round(r*n),o=Math.floor(a/n),s=a-o*n,l=n;return e+(o===0?"":""+o)+" "+(s===0?Gr(" ",t[1].length+1+t[4].length):Hm(s,t[1].length)+t[2]+"/"+t[3]+cs(l,t[4].length))}function Sj(t,r,e){return e+(r===0?"":""+r)+Gr(" ",t[1].length+2+t[4].length)}var m_=/^#*0*\.([0#]+)/,g_=/\).*[0#]/,v_=/\(###\) ###\\?-####/;function Kn(t){for(var r="",e,n=0;n!=t.length;++n)switch(e=t.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(e)}return r}function e2(t,r){var e=Math.pow(10,r);return""+Math.round(t*e)/e}function t2(t,r){var e=t-Math.floor(t),n=Math.pow(10,r);return r<(""+Math.round(e*n)).length?0:Math.round(e*n)}function kj(t,r){return r<(""+Math.round((t-Math.floor(t))*Math.pow(10,r))).length?1:0}function Ej(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ia(t,r,e){if(t.charCodeAt(0)===40&&!r.match(g_)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Ia("n",n,e):"("+Ia("n",n,-e)+")"}if(r.charCodeAt(r.length-1)===44)return wj(t,r,e);if(r.indexOf("%")!==-1)return yj(t,r,e);if(r.indexOf("E")!==-1)return h_(r,e);if(r.charCodeAt(0)===36)return"$"+Ia(t,r.substr(r.charAt(1)==" "?2:1),e);var a,o,s,l,c=Math.abs(e),i=e<0?"-":"";if(r.match(/^00+$/))return i+Ol(c,r.length);if(r.match(/^[#?]+$/))return a=Ol(e,0),a==="0"&&(a=""),a.length>r.length?a:Kn(r.substr(0,r.length-a.length))+a;if(o=r.match(p_))return _j(o,c,i);if(r.match(/^#+0+$/))return i+Ol(c,r.length-r.indexOf("0"));if(o=r.match(m_))return a=e2(e,o[1].length).replace(/^([^\.]+)$/,"$1."+Kn(o[1])).replace(/\.$/,"."+Kn(o[1])).replace(/\.(\d*)$/,function(v,b){return"."+b+Gr("0",Kn(o[1]).length-b.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return i+e2(c,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return i+Gi(Ol(c,0));if(o=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Ia(t,r,-e):Gi(""+(Math.floor(e)+kj(e,o[1].length)))+"."+cs(t2(e,o[1].length),o[1].length);if(o=r.match(/^#,#*,#0/))return Ia(t,r.replace(/^#,#*,/,""),e);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Wl(Ia(t,r.replace(/[\\-]/g,""),e)),s=0,Wl(Wl(r.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<a.length?a.charAt(s++):v==="0"?"0":""}));if(r.match(v_))return a=Ia(t,"##########",e),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),l=jf(c,Math.pow(10,s)-1,!1),a=""+i,u=ai("n",o[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+o[2]+"/"+o[3],u=Cf(l[2],s),u.length<o[4].length&&(u=Kn(o[4].substr(o[4].length-u.length))+u),a+=u,a;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),l=jf(c,Math.pow(10,s)-1,!0),i+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Hm(l[1],s)+o[2]+"/"+o[3]+Cf(l[2],s):Gr(" ",2*s+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return a=Ol(e,0),r.length<=a.length?a:Kn(r.substr(0,r.length-a.length))+a;if(o=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var p=r.indexOf(".")-s,f=r.length-a.length-p;return Kn(r.substr(0,p)+a+r.substr(r.length-f))}if(o=r.match(/^00,000\.([#0]*0)$/))return s=t2(e,o[1].length),e<0?"-"+Ia(t,r,-e):Gi(Ej(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?cs(0,3-v.length):"")+v})+"."+cs(s,o[1].length);switch(r){case"###,##0.00":return Ia(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var h=Gi(Ol(c,0));return h!=="0"?i+h:"";case"###,###.00":return Ia(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Ia(t,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function Tj(t,r,e){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return ai(t,r.substr(0,n),e/Math.pow(10,3*(r.length-n)))}function Aj(t,r,e){var n=r.replace(f_,""),a=r.length-n.length;return ai(t,n,e*Math.pow(10,2*a))+Gr("%",a)}function b_(t,r){var e,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+b_(t,-r);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%a;if(o<0&&(o+=a),e=(r/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),!e.match(/[Ee]/)){var s=Math.floor(Math.log(r)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+o):e+="E+"+(s-o),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,i,u){return c+i+u.substr(0,(a+o)%a)+"."+u.substr(o)+"E"})}else e=r.toExponential(n);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function _s(t,r,e){if(t.charCodeAt(0)===40&&!r.match(g_)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?_s("n",n,e):"("+_s("n",n,-e)+")"}if(r.charCodeAt(r.length-1)===44)return Tj(t,r,e);if(r.indexOf("%")!==-1)return Aj(t,r,e);if(r.indexOf("E")!==-1)return b_(r,e);if(r.charCodeAt(0)===36)return"$"+_s(t,r.substr(r.charAt(1)==" "?2:1),e);var a,o,s,l,c=Math.abs(e),i=e<0?"-":"";if(r.match(/^00+$/))return i+cs(c,r.length);if(r.match(/^[#?]+$/))return a=""+e,e===0&&(a=""),a.length>r.length?a:Kn(r.substr(0,r.length-a.length))+a;if(o=r.match(p_))return Sj(o,c,i);if(r.match(/^#+0+$/))return i+cs(c,r.length-r.indexOf("0"));if(o=r.match(m_))return a=(""+e).replace(/^([^\.]+)$/,"$1."+Kn(o[1])).replace(/\.$/,"."+Kn(o[1])),a=a.replace(/\.(\d*)$/,function(v,b){return"."+b+Gr("0",Kn(o[1]).length-b.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return i+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return i+Gi(""+c);if(o=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+_s(t,r,-e):Gi(""+e)+"."+Gr("0",o[1].length);if(o=r.match(/^#,#*,#0/))return _s(t,r.replace(/^#,#*,/,""),e);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Wl(_s(t,r.replace(/[\\-]/g,""),e)),s=0,Wl(Wl(r.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<a.length?a.charAt(s++):v==="0"?"0":""}));if(r.match(v_))return a=_s(t,"##########",e),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),l=jf(c,Math.pow(10,s)-1,!1),a=""+i,u=ai("n",o[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+o[2]+"/"+o[3],u=Cf(l[2],s),u.length<o[4].length&&(u=Kn(o[4].substr(o[4].length-u.length))+u),a+=u,a;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),l=jf(c,Math.pow(10,s)-1,!0),i+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Hm(l[1],s)+o[2]+"/"+o[3]+Cf(l[2],s):Gr(" ",2*s+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return a=""+e,r.length<=a.length?a:Kn(r.substr(0,r.length-a.length))+a;if(o=r.match(/^([#0]+)\.([#0]+)$/)){a=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var p=r.indexOf(".")-s,f=r.length-a.length-p;return Kn(r.substr(0,p)+a+r.substr(r.length-f))}if(o=r.match(/^00,000\.([#0]*0)$/))return e<0?"-"+_s(t,r,-e):Gi(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?cs(0,3-v.length):"")+v})+"."+cs(0,o[1].length);switch(r){case"###,###":case"##,###":case"#,###":var h=Gi(""+c);return h!=="0"?i+h:"";default:if(r.match(/\.[0#?]*$/))return _s(t,r.slice(0,r.lastIndexOf(".")),e)+Kn(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function ai(t,r,e){return(e|0)===e?_s(t,r,e):Ia(t,r,e)}function Cj(t){for(var r=[],e=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:e=!e;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=t.substr(a,n-a),a=n+1}if(r[r.length]=t.substr(a),e===!0)throw new Error("Format |"+t+"| unterminated string ");return r}var x_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function rc(t){for(var r=0,e="",n="";r<t.length;)switch(e=t.charAt(r)){case"G":Nf(t,r)&&(r+=6),r++;break;case'"':for(;t.charCodeAt(++r)!==34&&r<t.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(t.charAt(r+1)==="1"||t.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(r,3).toUpperCase()==="A/P"||t.substr(r,5).toUpperCase()==="AM/PM"||t.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(n=e;t.charAt(r++)!=="]"&&r<t.length;)n+=t.charAt(r);if(n.match(x_))return!0;break;case".":case"0":case"#":for(;r<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++r))>-1||e=="\\"&&t.charAt(r+1)=="-"&&"0#".indexOf(t.charAt(r+2))>-1););break;case"?":for(;t.charAt(++r)===e;);break;case"*":++r,(t.charAt(r)==" "||t.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<t.length&&"0123456789".indexOf(t.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function Nj(t,r,e,n){for(var a=[],o="",s=0,l="",c="t",i,u,p,f="H";s<t.length;)switch(l=t.charAt(s)){case"G":if(!Nf(t,s))throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(o="";(p=t.charCodeAt(++s))!==34&&s<t.length;)o+=String.fromCharCode(p);a[a.length]={t:"t",v:o},++s;break;case"\\":var h=t.charAt(++s),v=h==="("||h===")"?h:"t";a[a.length]={t:v,v:h},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:r},++s;break;case"B":case"b":if(t.charAt(s+1)==="1"||t.charAt(s+1)==="2"){if(i==null&&(i=Fo(r,e,t.charAt(s+1)==="2"),i==null))return"";a[a.length]={t:"X",v:t.substr(s,2)},c=l,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||i==null&&(i=Fo(r,e),i==null))return"";for(o=l;++s<t.length&&t.charAt(s).toLowerCase()===l;)o+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=f),a[a.length]={t:l,v:o},c=l;break;case"A":case"a":case"":var b={t:l,v:l};if(i==null&&(i=Fo(r,e)),t.substr(s,3).toUpperCase()==="A/P"?(i!=null&&(b.v=i.H>=12?"P":"A"),b.t="T",f="h",s+=3):t.substr(s,5).toUpperCase()==="AM/PM"?(i!=null&&(b.v=i.H>=12?"PM":"AM"),b.t="T",s+=5,f="h"):t.substr(s,5).toUpperCase()==="/"?(i!=null&&(b.v=i.H>=12?"":""),b.t="T",s+=5,f="h"):(b.t="t",++s),i==null&&b.t==="T")return"";a[a.length]=b,c=l;break;case"[":for(o=l;t.charAt(s++)!=="]"&&s<t.length;)o+=t.charAt(s);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(x_)){if(i==null&&(i=Fo(r,e),i==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},c=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",rc(t)||(a[a.length]={t:"t",v:o}));break;case".":if(i!=null){for(o=l;++s<t.length&&(l=t.charAt(s))==="0";)o+=l;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=l;++s<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(s))>-1;)o+=l;a[a.length]={t:"n",v:o};break;case"?":for(o=l;t.charAt(++s)===l;)o+=l;a[a.length]={t:l,v:o},c=l;break;case"*":++s,(t.charAt(s)==" "||t.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=l;s<t.length&&"0123456789".indexOf(t.charAt(++s))>-1;)o+=t.charAt(s);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:l,v:l},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"t",v:l},++s;break}var g=0,x=0,y;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=f,c="h",g<1&&(g=1);break;case"s":(y=a[s].v.match(/\.0+$/))&&(x=Math.max(x,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=a[s].t;break;case"m":c==="s"&&(a[s].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&a[s].v.match(/[Hh]/)&&(g=1),g<2&&a[s].v.match(/[Mm]/)&&(g=2),g<3&&a[s].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M),i.M>=60&&(i.M=0,++i.H);break;case 2:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M);break}var k="",N;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=xj(a[s].t.charCodeAt(0),a[s].v,i,x),a[s].t="t";break;case"n":case"?":for(N=s+1;a[N]!=null&&((l=a[N].t)==="?"||l==="D"||(l===" "||l==="t")&&a[N+1]!=null&&(a[N+1].t==="?"||a[N+1].t==="t"&&a[N+1].v==="/")||a[s].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[N].v==="/"||a[N].v===" "&&a[N+1]!=null&&a[N+1].t=="?"));)a[s].v+=a[N].v,a[N]={v:"",t:";"},++N;k+=a[s].v,s=N-1;break;case"G":a[s].t="t",a[s].v=Bo(r,e);break}var F="",B,W;if(k.length>0){k.charCodeAt(0)==40?(B=r<0&&k.charCodeAt(0)===45?-r:r,W=ai("n",k,B)):(B=r<0&&n>1?-r:r,W=ai("n",k,B),B<0&&a[0]&&a[0].t=="t"&&(W=W.substr(1),a[0].v="-"+a[0].v)),N=W.length-1;var V=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){V=s;break}var q=a.length;if(V===a.length&&W.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(N>=a[s].v.length-1?(N-=a[s].v.length,a[s].v=W.substr(N+1,a[s].v.length)):N<0?a[s].v="":(a[s].v=W.substr(0,N+1),N=-1),a[s].t="t",q=s);N>=0&&q<a.length&&(a[q].v=W.substr(0,N+1)+a[q].v)}else if(V!==a.length&&W.indexOf("E")===-1){for(N=W.indexOf(".")-1,s=V;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(u=a[s].v.indexOf(".")>-1&&s===V?a[s].v.indexOf(".")-1:a[s].v.length-1,F=a[s].v.substr(u+1);u>=0;--u)N>=0&&(a[s].v.charAt(u)==="0"||a[s].v.charAt(u)==="#")&&(F=W.charAt(N--)+F);a[s].v=F,a[s].t="t",q=s}for(N>=0&&q<a.length&&(a[q].v=W.substr(0,N+1)+a[q].v),N=W.indexOf(".")+1,s=V;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==V)){for(u=a[s].v.indexOf(".")>-1&&s===V?a[s].v.indexOf(".")+1:0,F=a[s].v.substr(0,u);u<a[s].v.length;++u)N<W.length&&(F+=W.charAt(N++));a[s].v=F,a[s].t="t",q=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(B=n>1&&r<0&&s>0&&a[s-1].v==="-"?-r:r,a[s].v=ai(a[s].t,a[s].v,B),a[s].t="t");var X="";for(s=0;s!==a.length;++s)a[s]!=null&&(X+=a[s].v);return X}var r2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function n2(t,r){if(r==null)return!1;var e=parseFloat(r[2]);switch(r[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0;break}return!1}function jj(t,r){var e=Cj(t),n=e.length,a=e[n-1].indexOf("@");if(n<4&&a>-1&&--n,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof r!="number")return[4,e.length===4||a>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=a>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=a>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=a>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var o=r>0?e[0]:r<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[n,o];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var s=e[0].match(r2),l=e[1].match(r2);return n2(r,s)?[n,e[0]]:n2(r,l)?[n,e[1]]:[n,e[s!=null&&l!=null?2:1]]}return[n,o]}function Ha(t,r,e){e==null&&(e={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&e.dateNF?n=e.dateNF:n=t;break;case"number":t==14&&e.dateNF?n=e.dateNF:n=(e.table!=null?e.table:rr)[t],n==null&&(n=e.table&&e.table[Qx[t]]||rr[Qx[t]]),n==null&&(n=fj[t]||"General");break}if(Nf(n,0))return Bo(r,e);r instanceof Date&&(r=d_(r,e.date1904));var a=jj(n,r);if(Nf(a[1]))return Bo(r,e);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return Nj(a[1],r,e,a[0])}function Po(t,r){if(typeof r!="number"){r=+r||-1;for(var e=0;e<392;++e){if(rr[e]==null){r<0&&(r=e);continue}if(rr[e]==t){r=e;break}}r<0&&(r=391)}return rr[r]=t,r}function y_(){rr=dj()}var Oj={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},w_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Dj(t){var r=typeof t=="number"?rr[t]:t;return r=r.replace(w_,"(\\d+)"),new RegExp("^"+r+"$")}function Rj(t,r,e){var n=-1,a=-1,o=-1,s=-1,l=-1,c=-1;(r.match(w_)||[]).forEach(function(p,f){var h=parseInt(e[f+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=h;break;case"d":o=h;break;case"h":s=h;break;case"s":c=h;break;case"m":s>=0?l=h:a=h;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var i=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);i.length==7&&(i="0"+i),i.length==8&&(i="20"+i);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&l==-1&&c==-1?i:n==-1&&a==-1&&o==-1?u:i+"T"+u}var Mj=function(){var t={};t.version="1.2.0";function r(){for(var W=0,V=new Array(256),q=0;q!=256;++q)W=q,W=W&1?-306674912^W>>>1:W>>>1,W=W&1?-306674912^W>>>1:W>>>1,W=W&1?-306674912^W>>>1:W>>>1,W=W&1?-306674912^W>>>1:W>>>1,W=W&1?-306674912^W>>>1:W>>>1,W=W&1?-306674912^W>>>1:W>>>1,W=W&1?-306674912^W>>>1:W>>>1,W=W&1?-306674912^W>>>1:W>>>1,V[q]=W;return typeof Int32Array<"u"?new Int32Array(V):V}var e=r();function n(W){var V=0,q=0,X=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(X=0;X!=256;++X)I[X]=W[X];for(X=0;X!=256;++X)for(q=W[X],V=256+X;V<4096;V+=256)q=I[V]=q>>>8^W[q&255];var H=[];for(X=1;X!=16;++X)H[X-1]=typeof Int32Array<"u"?I.subarray(X*256,X*256+256):I.slice(X*256,X*256+256);return H}var a=n(e),o=a[0],s=a[1],l=a[2],c=a[3],i=a[4],u=a[5],p=a[6],f=a[7],h=a[8],v=a[9],b=a[10],g=a[11],x=a[12],y=a[13],k=a[14];function N(W,V){for(var q=V^-1,X=0,I=W.length;X<I;)q=q>>>8^e[(q^W.charCodeAt(X++))&255];return~q}function F(W,V){for(var q=V^-1,X=W.length-15,I=0;I<X;)q=k[W[I++]^q&255]^y[W[I++]^q>>8&255]^x[W[I++]^q>>16&255]^g[W[I++]^q>>>24]^b[W[I++]]^v[W[I++]]^h[W[I++]]^f[W[I++]]^p[W[I++]]^u[W[I++]]^i[W[I++]]^c[W[I++]]^l[W[I++]]^s[W[I++]]^o[W[I++]]^e[W[I++]];for(X+=15;I<X;)q=q>>>8^e[(q^W[I++])&255];return~q}function B(W,V){for(var q=V^-1,X=0,I=W.length,H=0,O=0;X<I;)H=W.charCodeAt(X++),H<128?q=q>>>8^e[(q^H)&255]:H<2048?(q=q>>>8^e[(q^(192|H>>6&31))&255],q=q>>>8^e[(q^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,O=W.charCodeAt(X++)&1023,q=q>>>8^e[(q^(240|H>>8&7))&255],q=q>>>8^e[(q^(128|H>>2&63))&255],q=q>>>8^e[(q^(128|O>>6&15|(H&3)<<4))&255],q=q>>>8^e[(q^(128|O&63))&255]):(q=q>>>8^e[(q^(224|H>>12&15))&255],q=q>>>8^e[(q^(128|H>>6&63))&255],q=q>>>8^e[(q^(128|H&63))&255]);return~q}return t.table=e,t.bstr=N,t.buf=F,t.str=B,t}(),pr=function(){var r={};r.version="1.2.1";function e(ie,we){for(var de=ie.split("/"),ge=we.split("/"),ve=0,ye=0,Me=Math.min(de.length,ge.length);ve<Me;++ve){if(ye=de[ve].length-ge[ve].length)return ye;if(de[ve]!=ge[ve])return de[ve]<ge[ve]?-1:1}return de.length-ge.length}function n(ie){if(ie.charAt(ie.length-1)=="/")return ie.slice(0,-1).indexOf("/")===-1?ie:n(ie.slice(0,-1));var we=ie.lastIndexOf("/");return we===-1?ie:ie.slice(0,we+1)}function a(ie){if(ie.charAt(ie.length-1)=="/")return a(ie.slice(0,-1));var we=ie.lastIndexOf("/");return we===-1?ie:ie.slice(we+1)}function o(ie,we){typeof we=="string"&&(we=new Date(we));var de=we.getHours();de=de<<6|we.getMinutes(),de=de<<5|we.getSeconds()>>>1,ie.write_shift(2,de);var ge=we.getFullYear()-1980;ge=ge<<4|we.getMonth()+1,ge=ge<<5|we.getDate(),ie.write_shift(2,ge)}function s(ie){var we=ie.read_shift(2)&65535,de=ie.read_shift(2)&65535,ge=new Date,ve=de&31;de>>>=5;var ye=de&15;de>>>=4,ge.setMilliseconds(0),ge.setFullYear(de+1980),ge.setMonth(ye-1),ge.setDate(ve);var Me=we&31;we>>>=5;var Ue=we&63;return we>>>=6,ge.setHours(we),ge.setMinutes(Ue),ge.setSeconds(Me<<1),ge}function l(ie){On(ie,0);for(var we={},de=0;ie.l<=ie.length-4;){var ge=ie.read_shift(2),ve=ie.read_shift(2),ye=ie.l+ve,Me={};switch(ge){case 21589:de=ie.read_shift(1),de&1&&(Me.mtime=ie.read_shift(4)),ve>5&&(de&2&&(Me.atime=ie.read_shift(4)),de&4&&(Me.ctime=ie.read_shift(4))),Me.mtime&&(Me.mt=new Date(Me.mtime*1e3));break}ie.l=ye,we[ge]=Me}return we}var c;function i(){return c||(c={})}function u(ie,we){if(ie[0]==80&&ie[1]==75)return $e(ie,we);if((ie[0]|32)==109&&(ie[1]|32)==105)return yt(ie,we);if(ie.length<512)throw new Error("CFB file size "+ie.length+" < 512");var de=3,ge=512,ve=0,ye=0,Me=0,Ue=0,Re=0,Be=[],ze=ie.slice(0,512);On(ze,0);var be=p(ze);switch(de=be[0],de){case 3:ge=512;break;case 4:ge=4096;break;case 0:if(be[1]==0)return $e(ie,we);default:throw new Error("Major Version: Expected 3 or 4 saw "+de)}ge!==512&&(ze=ie.slice(0,ge),On(ze,28));var Te=ie.slice(0,ge);f(ze,de);var Ge=ze.read_shift(4,"i");if(de===3&&Ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ge);ze.l+=4,Me=ze.read_shift(4,"i"),ze.l+=4,ze.chk("00100000","Mini Stream Cutoff Size: "),Ue=ze.read_shift(4,"i"),ve=ze.read_shift(4,"i"),Re=ze.read_shift(4,"i"),ye=ze.read_shift(4,"i");for(var ue=-1,Ae=0;Ae<109&&(ue=ze.read_shift(4,"i"),!(ue<0));++Ae)Be[Ae]=ue;var pe=h(ie,ge);g(Re,ye,pe,ge,Be);var xe=y(pe,Me,Be,ge);xe[Me].name="!Directory",ve>0&&Ue!==O&&(xe[Ue].name="!MiniFAT"),xe[Be[0]].name="!FAT",xe.fat_addrs=Be,xe.ssz=ge;var We={},qe=[],ut=[],Mt=[];k(Me,xe,pe,qe,ve,We,ut,Ue),v(ut,Mt,qe),qe.shift();var Bt={FileIndex:ut,FullPaths:Mt};return we&&we.raw&&(Bt.raw={header:Te,sectors:pe}),Bt}function p(ie){if(ie[ie.l]==80&&ie[ie.l+1]==75)return[0,0];ie.chk(R,"Header Signature: "),ie.l+=16;var we=ie.read_shift(2,"u");return[ie.read_shift(2,"u"),we]}function f(ie,we){var de=9;switch(ie.l+=2,de=ie.read_shift(2)){case 9:if(we!=3)throw new Error("Sector Shift: Expected 9 saw "+de);break;case 12:if(we!=4)throw new Error("Sector Shift: Expected 12 saw "+de);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+de)}ie.chk("0600","Mini Sector Shift: "),ie.chk("000000000000","Reserved: ")}function h(ie,we){for(var de=Math.ceil(ie.length/we)-1,ge=[],ve=1;ve<de;++ve)ge[ve-1]=ie.slice(ve*we,(ve+1)*we);return ge[de-1]=ie.slice(de*we),ge}function v(ie,we,de){for(var ge=0,ve=0,ye=0,Me=0,Ue=0,Re=de.length,Be=[],ze=[];ge<Re;++ge)Be[ge]=ze[ge]=ge,we[ge]=de[ge];for(;Ue<ze.length;++Ue)ge=ze[Ue],ve=ie[ge].L,ye=ie[ge].R,Me=ie[ge].C,Be[ge]===ge&&(ve!==-1&&Be[ve]!==ve&&(Be[ge]=Be[ve]),ye!==-1&&Be[ye]!==ye&&(Be[ge]=Be[ye])),Me!==-1&&(Be[Me]=ge),ve!==-1&&ge!=Be[ge]&&(Be[ve]=Be[ge],ze.lastIndexOf(ve)<Ue&&ze.push(ve)),ye!==-1&&ge!=Be[ge]&&(Be[ye]=Be[ge],ze.lastIndexOf(ye)<Ue&&ze.push(ye));for(ge=1;ge<Re;++ge)Be[ge]===ge&&(ye!==-1&&Be[ye]!==ye?Be[ge]=Be[ye]:ve!==-1&&Be[ve]!==ve&&(Be[ge]=Be[ve]));for(ge=1;ge<Re;++ge)if(ie[ge].type!==0){if(Ue=ge,Ue!=Be[Ue])do Ue=Be[Ue],we[ge]=we[Ue]+"/"+we[ge];while(Ue!==0&&Be[Ue]!==-1&&Ue!=Be[Ue]);Be[ge]=-1}for(we[0]+="/",ge=1;ge<Re;++ge)ie[ge].type!==2&&(we[ge]+="/")}function b(ie,we,de){for(var ge=ie.start,ve=ie.size,ye=[],Me=ge;de&&ve>0&&Me>=0;)ye.push(we.slice(Me*H,Me*H+H)),ve-=H,Me=Do(de,Me*4);return ye.length===0?vn(0):qi(ye).slice(0,ie.size)}function g(ie,we,de,ge,ve){var ye=O;if(ie===O){if(we!==0)throw new Error("DIFAT chain shorter than expected")}else if(ie!==-1){var Me=de[ie],Ue=(ge>>>2)-1;if(!Me)return;for(var Re=0;Re<Ue&&(ye=Do(Me,Re*4))!==O;++Re)ve.push(ye);g(Do(Me,ge-4),we-1,de,ge,ve)}}function x(ie,we,de,ge,ve){var ye=[],Me=[];ve||(ve=[]);var Ue=ge-1,Re=0,Be=0;for(Re=we;Re>=0;){ve[Re]=!0,ye[ye.length]=Re,Me.push(ie[Re]);var ze=de[Math.floor(Re*4/ge)];if(Be=Re*4&Ue,ge<4+Be)throw new Error("FAT boundary crossed: "+Re+" 4 "+ge);if(!ie[ze])break;Re=Do(ie[ze],Be)}return{nodes:ye,data:h2([Me])}}function y(ie,we,de,ge){var ve=ie.length,ye=[],Me=[],Ue=[],Re=[],Be=ge-1,ze=0,be=0,Te=0,Ge=0;for(ze=0;ze<ve;++ze)if(Ue=[],Te=ze+we,Te>=ve&&(Te-=ve),!Me[Te]){Re=[];var ue=[];for(be=Te;be>=0;){ue[be]=!0,Me[be]=!0,Ue[Ue.length]=be,Re.push(ie[be]);var Ae=de[Math.floor(be*4/ge)];if(Ge=be*4&Be,ge<4+Ge)throw new Error("FAT boundary crossed: "+be+" 4 "+ge);if(!ie[Ae]||(be=Do(ie[Ae],Ge),ue[be]))break}ye[Te]={nodes:Ue,data:h2([Re])}}return ye}function k(ie,we,de,ge,ve,ye,Me,Ue){for(var Re=0,Be=ge.length?2:0,ze=we[ie].data,be=0,Te=0,Ge;be<ze.length;be+=128){var ue=ze.slice(be,be+128);On(ue,64),Te=ue.read_shift(2),Ge=Km(ue,0,Te-Be),ge.push(Ge);var Ae={name:Ge,type:ue.read_shift(1),color:ue.read_shift(1),L:ue.read_shift(4,"i"),R:ue.read_shift(4,"i"),C:ue.read_shift(4,"i"),clsid:ue.read_shift(16),state:ue.read_shift(4,"i"),start:0,size:0},pe=ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2);pe!==0&&(Ae.ct=N(ue,ue.l-8));var xe=ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2);xe!==0&&(Ae.mt=N(ue,ue.l-8)),Ae.start=ue.read_shift(4,"i"),Ae.size=ue.read_shift(4,"i"),Ae.size<0&&Ae.start<0&&(Ae.size=Ae.type=0,Ae.start=O,Ae.name=""),Ae.type===5?(Re=Ae.start,ve>0&&Re!==O&&(we[Re].name="!StreamData")):Ae.size>=4096?(Ae.storage="fat",we[Ae.start]===void 0&&(we[Ae.start]=x(de,Ae.start,we.fat_addrs,we.ssz)),we[Ae.start].name=Ae.name,Ae.content=we[Ae.start].data.slice(0,Ae.size)):(Ae.storage="minifat",Ae.size<0?Ae.size=0:Re!==O&&Ae.start!==O&&we[Re]&&(Ae.content=b(Ae,we[Re].data,(we[Ue]||{}).data))),Ae.content&&On(Ae.content,0),ye[Ge]=Ae,Me.push(Ae)}}function N(ie,we){return new Date((wa(ie,we+4)/1e7*Math.pow(2,32)+wa(ie,we)/1e7-11644473600)*1e3)}function F(ie,we){return i(),u(c.readFileSync(ie),we)}function B(ie,we){var de=we&&we.type;switch(de||fr&&Buffer.isBuffer(ie)&&(de="buffer"),de||"base64"){case"file":return F(ie,we);case"base64":return u(is(Ta(ie)),we);case"binary":return u(is(ie),we)}return u(ie,we)}function W(ie,we){var de=we||{},ge=de.root||"Root Entry";if(ie.FullPaths||(ie.FullPaths=[]),ie.FileIndex||(ie.FileIndex=[]),ie.FullPaths.length!==ie.FileIndex.length)throw new Error("inconsistent CFB structure");ie.FullPaths.length===0&&(ie.FullPaths[0]=ge+"/",ie.FileIndex[0]={name:ge,type:5}),de.CLSID&&(ie.FileIndex[0].clsid=de.CLSID),V(ie)}function V(ie){var we="Sh33tJ5";if(!pr.find(ie,"/"+we)){var de=vn(4);de[0]=55,de[1]=de[3]=50,de[2]=54,ie.FileIndex.push({name:we,type:2,content:de,size:4,L:69,R:69,C:69}),ie.FullPaths.push(ie.FullPaths[0]+we),q(ie)}}function q(ie,we){W(ie);for(var de=!1,ge=!1,ve=ie.FullPaths.length-1;ve>=0;--ve){var ye=ie.FileIndex[ve];switch(ye.type){case 0:ge?de=!0:(ie.FileIndex.pop(),ie.FullPaths.pop());break;case 1:case 2:case 5:ge=!0,isNaN(ye.R*ye.L*ye.C)&&(de=!0),ye.R>-1&&ye.L>-1&&ye.R==ye.L&&(de=!0);break;default:de=!0;break}}if(!(!de&&!we)){var Me=new Date(1987,1,19),Ue=0,Re=Object.create?Object.create(null):{},Be=[];for(ve=0;ve<ie.FullPaths.length;++ve)Re[ie.FullPaths[ve]]=!0,ie.FileIndex[ve].type!==0&&Be.push([ie.FullPaths[ve],ie.FileIndex[ve]]);for(ve=0;ve<Be.length;++ve){var ze=n(Be[ve][0]);ge=Re[ze],ge||(Be.push([ze,{name:a(ze).replace("/",""),type:1,clsid:w,ct:Me,mt:Me,content:null}]),Re[ze]=!0)}for(Be.sort(function(Ge,ue){return e(Ge[0],ue[0])}),ie.FullPaths=[],ie.FileIndex=[],ve=0;ve<Be.length;++ve)ie.FullPaths[ve]=Be[ve][0],ie.FileIndex[ve]=Be[ve][1];for(ve=0;ve<Be.length;++ve){var be=ie.FileIndex[ve],Te=ie.FullPaths[ve];if(be.name=a(Te).replace("/",""),be.L=be.R=be.C=-(be.color=1),be.size=be.content?be.content.length:0,be.start=0,be.clsid=be.clsid||w,ve===0)be.C=Be.length>1?1:-1,be.size=0,be.type=5;else if(Te.slice(-1)=="/"){for(Ue=ve+1;Ue<Be.length&&n(ie.FullPaths[Ue])!=Te;++Ue);for(be.C=Ue>=Be.length?-1:Ue,Ue=ve+1;Ue<Be.length&&n(ie.FullPaths[Ue])!=n(Te);++Ue);be.R=Ue>=Be.length?-1:Ue,be.type=1}else n(ie.FullPaths[ve+1]||"")==n(Te)&&(be.R=ve+1),be.type=2}}}function X(ie,we){var de=we||{};if(de.fileType=="mad")return Ct(ie,de);switch(q(ie),de.fileType){case"zip":return nt(ie,de)}var ge=function(Ge){for(var ue=0,Ae=0,pe=0;pe<Ge.FileIndex.length;++pe){var xe=Ge.FileIndex[pe];if(xe.content){var We=xe.content.length;We>0&&(We<4096?ue+=We+63>>6:Ae+=We+511>>9)}}for(var qe=Ge.FullPaths.length+3>>2,ut=ue+7>>3,Mt=ue+127>>7,Bt=ut+Ae+qe+Mt,Ht=Bt+127>>7,Lt=Ht<=109?0:Math.ceil((Ht-109)/127);Bt+Ht+Lt+127>>7>Ht;)Lt=++Ht<=109?0:Math.ceil((Ht-109)/127);var er=[1,Lt,Ht,Mt,qe,Ae,ue,0];return Ge.FileIndex[0].size=ue<<6,er[7]=(Ge.FileIndex[0].start=er[0]+er[1]+er[2]+er[3]+er[4]+er[5])+(er[6]+7>>3),er}(ie),ve=vn(ge[7]<<9),ye=0,Me=0;{for(ye=0;ye<8;++ye)ve.write_shift(1,C[ye]);for(ye=0;ye<8;++ye)ve.write_shift(2,0);for(ve.write_shift(2,62),ve.write_shift(2,3),ve.write_shift(2,65534),ve.write_shift(2,9),ve.write_shift(2,6),ye=0;ye<3;++ye)ve.write_shift(2,0);for(ve.write_shift(4,0),ve.write_shift(4,ge[2]),ve.write_shift(4,ge[0]+ge[1]+ge[2]+ge[3]-1),ve.write_shift(4,0),ve.write_shift(4,4096),ve.write_shift(4,ge[3]?ge[0]+ge[1]+ge[2]-1:O),ve.write_shift(4,ge[3]),ve.write_shift(-4,ge[1]?ge[0]-1:O),ve.write_shift(4,ge[1]),ye=0;ye<109;++ye)ve.write_shift(-4,ye<ge[2]?ge[1]+ye:-1)}if(ge[1])for(Me=0;Me<ge[1];++Me){for(;ye<236+Me*127;++ye)ve.write_shift(-4,ye<ge[2]?ge[1]+ye:-1);ve.write_shift(-4,Me===ge[1]-1?O:Me+1)}var Ue=function(Ge){for(Me+=Ge;ye<Me-1;++ye)ve.write_shift(-4,ye+1);Ge&&(++ye,ve.write_shift(-4,O))};for(Me=ye=0,Me+=ge[1];ye<Me;++ye)ve.write_shift(-4,E.DIFSECT);for(Me+=ge[2];ye<Me;++ye)ve.write_shift(-4,E.FATSECT);Ue(ge[3]),Ue(ge[4]);for(var Re=0,Be=0,ze=ie.FileIndex[0];Re<ie.FileIndex.length;++Re)ze=ie.FileIndex[Re],ze.content&&(Be=ze.content.length,!(Be<4096)&&(ze.start=Me,Ue(Be+511>>9)));for(Ue(ge[6]+7>>3);ve.l&511;)ve.write_shift(-4,E.ENDOFCHAIN);for(Me=ye=0,Re=0;Re<ie.FileIndex.length;++Re)ze=ie.FileIndex[Re],ze.content&&(Be=ze.content.length,!(!Be||Be>=4096)&&(ze.start=Me,Ue(Be+63>>6)));for(;ve.l&511;)ve.write_shift(-4,E.ENDOFCHAIN);for(ye=0;ye<ge[4]<<2;++ye){var be=ie.FullPaths[ye];if(!be||be.length===0){for(Re=0;Re<17;++Re)ve.write_shift(4,0);for(Re=0;Re<3;++Re)ve.write_shift(4,-1);for(Re=0;Re<12;++Re)ve.write_shift(4,0);continue}ze=ie.FileIndex[ye],ye===0&&(ze.start=ze.size?ze.start-1:O);var Te=ye===0&&de.root||ze.name;if(Be=2*(Te.length+1),ve.write_shift(64,Te,"utf16le"),ve.write_shift(2,Be),ve.write_shift(1,ze.type),ve.write_shift(1,ze.color),ve.write_shift(-4,ze.L),ve.write_shift(-4,ze.R),ve.write_shift(-4,ze.C),ze.clsid)ve.write_shift(16,ze.clsid,"hex");else for(Re=0;Re<4;++Re)ve.write_shift(4,0);ve.write_shift(4,ze.state||0),ve.write_shift(4,0),ve.write_shift(4,0),ve.write_shift(4,0),ve.write_shift(4,0),ve.write_shift(4,ze.start),ve.write_shift(4,ze.size),ve.write_shift(4,0)}for(ye=1;ye<ie.FileIndex.length;++ye)if(ze=ie.FileIndex[ye],ze.size>=4096)if(ve.l=ze.start+1<<9,fr&&Buffer.isBuffer(ze.content))ze.content.copy(ve,ve.l,0,ze.size),ve.l+=ze.size+511&-512;else{for(Re=0;Re<ze.size;++Re)ve.write_shift(1,ze.content[Re]);for(;Re&511;++Re)ve.write_shift(1,0)}for(ye=1;ye<ie.FileIndex.length;++ye)if(ze=ie.FileIndex[ye],ze.size>0&&ze.size<4096)if(fr&&Buffer.isBuffer(ze.content))ze.content.copy(ve,ve.l,0,ze.size),ve.l+=ze.size+63&-64;else{for(Re=0;Re<ze.size;++Re)ve.write_shift(1,ze.content[Re]);for(;Re&63;++Re)ve.write_shift(1,0)}if(fr)ve.l=ve.length;else for(;ve.l<ve.length;)ve.write_shift(1,0);return ve}function I(ie,we){var de=ie.FullPaths.map(function(Re){return Re.toUpperCase()}),ge=de.map(function(Re){var Be=Re.split("/");return Be[Be.length-(Re.slice(-1)=="/"?2:1)]}),ve=!1;we.charCodeAt(0)===47?(ve=!0,we=de[0].slice(0,-1)+we):ve=we.indexOf("/")!==-1;var ye=we.toUpperCase(),Me=ve===!0?de.indexOf(ye):ge.indexOf(ye);if(Me!==-1)return ie.FileIndex[Me];var Ue=!ye.match(su);for(ye=ye.replace(ea,""),Ue&&(ye=ye.replace(su,"!")),Me=0;Me<de.length;++Me)if((Ue?de[Me].replace(su,"!"):de[Me]).replace(ea,"")==ye||(Ue?ge[Me].replace(su,"!"):ge[Me]).replace(ea,"")==ye)return ie.FileIndex[Me];return null}var H=64,O=-2,R="d0cf11e0a1b11ae1",C=[208,207,17,224,161,177,26,225],w="00000000000000000000000000000000",E={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:O,FREESECT:-1,HEADER_SIGNATURE:R,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:w,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function A(ie,we,de){i();var ge=X(ie,de);c.writeFileSync(we,ge)}function T(ie){for(var we=new Array(ie.length),de=0;de<ie.length;++de)we[de]=String.fromCharCode(ie[de]);return we.join("")}function D(ie,we){var de=X(ie,we);switch(we&&we.type||"buffer"){case"file":return i(),c.writeFileSync(we.filename,de),de;case"binary":return typeof de=="string"?de:T(de);case"base64":return Xx(typeof de=="string"?de:T(de));case"buffer":if(fr)return Buffer.isBuffer(de)?de:$o(de);case"array":return typeof de=="string"?is(de):de}return de}var U;function P(ie){try{var we=ie.InflateRaw,de=new we;if(de._processChunk(new Uint8Array([3,0]),de._finishFlushFlag),de.bytesRead)U=ie;else throw new Error("zlib does not expose bytesRead")}catch(ge){console.error("cannot use native zlib: "+(ge.message||ge))}}function K(ie,we){if(!U)return vt(ie,we);var de=U.InflateRaw,ge=new de,ve=ge._processChunk(ie.slice(ie.l),ge._finishFlushFlag);return ie.l+=ge.bytesRead,ve}function Y(ie){return U?U.deflateRawSync(ie):ot(ie)}var re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function L(ie){var we=(ie<<1|ie<<11)&139536|(ie<<5|ie<<15)&558144;return(we>>16|we>>8|we)&255}for(var M=typeof Uint8Array<"u",Z=M?new Uint8Array(256):[],se=0;se<256;++se)Z[se]=L(se);function ae(ie,we){var de=Z[ie&255];return we<=8?de>>>8-we:(de=de<<8|Z[ie>>8&255],we<=16?de>>>16-we:(de=de<<8|Z[ie>>16&255],de>>>24-we))}function ne(ie,we){var de=we&7,ge=we>>>3;return(ie[ge]|(de<=6?0:ie[ge+1]<<8))>>>de&3}function Q(ie,we){var de=we&7,ge=we>>>3;return(ie[ge]|(de<=5?0:ie[ge+1]<<8))>>>de&7}function fe(ie,we){var de=we&7,ge=we>>>3;return(ie[ge]|(de<=4?0:ie[ge+1]<<8))>>>de&15}function le(ie,we){var de=we&7,ge=we>>>3;return(ie[ge]|(de<=3?0:ie[ge+1]<<8))>>>de&31}function te(ie,we){var de=we&7,ge=we>>>3;return(ie[ge]|(de<=1?0:ie[ge+1]<<8))>>>de&127}function ce(ie,we,de){var ge=we&7,ve=we>>>3,ye=(1<<de)-1,Me=ie[ve]>>>ge;return de<8-ge||(Me|=ie[ve+1]<<8-ge,de<16-ge)||(Me|=ie[ve+2]<<16-ge,de<24-ge)||(Me|=ie[ve+3]<<24-ge),Me&ye}function he(ie,we,de){var ge=we&7,ve=we>>>3;return ge<=5?ie[ve]|=(de&7)<<ge:(ie[ve]|=de<<ge&255,ie[ve+1]=(de&7)>>8-ge),we+3}function Ee(ie,we,de){var ge=we&7,ve=we>>>3;return de=(de&1)<<ge,ie[ve]|=de,we+1}function ke(ie,we,de){var ge=we&7,ve=we>>>3;return de<<=ge,ie[ve]|=de&255,de>>>=8,ie[ve+1]=de,we+8}function Ce(ie,we,de){var ge=we&7,ve=we>>>3;return de<<=ge,ie[ve]|=de&255,de>>>=8,ie[ve+1]=de&255,ie[ve+2]=de>>>8,we+16}function Fe(ie,we){var de=ie.length,ge=2*de>we?2*de:we+5,ve=0;if(de>=we)return ie;if(fr){var ye=Kx(ge);if(ie.copy)ie.copy(ye);else for(;ve<ie.length;++ve)ye[ve]=ie[ve];return ye}else if(M){var Me=new Uint8Array(ge);if(Me.set)Me.set(ie);else for(;ve<de;++ve)Me[ve]=ie[ve];return Me}return ie.length=ge,ie}function Pe(ie){for(var we=new Array(ie),de=0;de<ie;++de)we[de]=0;return we}function Xe(ie,we,de){var ge=1,ve=0,ye=0,Me=0,Ue=0,Re=ie.length,Be=M?new Uint16Array(32):Pe(32);for(ye=0;ye<32;++ye)Be[ye]=0;for(ye=Re;ye<de;++ye)ie[ye]=0;Re=ie.length;var ze=M?new Uint16Array(Re):Pe(Re);for(ye=0;ye<Re;++ye)Be[ve=ie[ye]]++,ge<ve&&(ge=ve),ze[ye]=0;for(Be[0]=0,ye=1;ye<=ge;++ye)Be[ye+16]=Ue=Ue+Be[ye-1]<<1;for(ye=0;ye<Re;++ye)Ue=ie[ye],Ue!=0&&(ze[ye]=Be[Ue+16]++);var be=0;for(ye=0;ye<Re;++ye)if(be=ie[ye],be!=0)for(Ue=ae(ze[ye],ge)>>ge-be,Me=(1<<ge+4-be)-1;Me>=0;--Me)we[Ue|Me<<be]=be&15|ye<<4;return ge}var ct=M?new Uint16Array(512):Pe(512),st=M?new Uint16Array(32):Pe(32);if(!M){for(var lt=0;lt<512;++lt)ct[lt]=0;for(lt=0;lt<32;++lt)st[lt]=0}(function(){for(var ie=[],we=0;we<32;we++)ie.push(5);Xe(ie,st,32);var de=[];for(we=0;we<=143;we++)de.push(8);for(;we<=255;we++)de.push(9);for(;we<=279;we++)de.push(7);for(;we<=287;we++)de.push(8);Xe(de,ct,288)})();var tt=function(){for(var we=M?new Uint8Array(32768):[],de=0,ge=0;de<ee.length-1;++de)for(;ge<ee[de+1];++ge)we[ge]=de;for(;ge<32768;++ge)we[ge]=29;var ve=M?new Uint8Array(259):[];for(de=0,ge=0;de<z.length-1;++de)for(;ge<z[de+1];++ge)ve[ge]=de;function ye(Ue,Re){for(var Be=0;Be<Ue.length;){var ze=Math.min(65535,Ue.length-Be),be=Be+ze==Ue.length;for(Re.write_shift(1,+be),Re.write_shift(2,ze),Re.write_shift(2,~ze&65535);ze-- >0;)Re[Re.l++]=Ue[Be++]}return Re.l}function Me(Ue,Re){for(var Be=0,ze=0,be=M?new Uint16Array(32768):[];ze<Ue.length;){var Te=Math.min(65535,Ue.length-ze);if(Te<10){for(Be=he(Re,Be,+(ze+Te==Ue.length)),Be&7&&(Be+=8-(Be&7)),Re.l=Be/8|0,Re.write_shift(2,Te),Re.write_shift(2,~Te&65535);Te-- >0;)Re[Re.l++]=Ue[ze++];Be=Re.l*8;continue}Be=he(Re,Be,+(ze+Te==Ue.length)+2);for(var Ge=0;Te-- >0;){var ue=Ue[ze];Ge=(Ge<<5^ue)&32767;var Ae=-1,pe=0;if((Ae=be[Ge])&&(Ae|=ze&-32768,Ae>ze&&(Ae-=32768),Ae<ze))for(;Ue[Ae+pe]==Ue[ze+pe]&&pe<250;)++pe;if(pe>2){ue=ve[pe],ue<=22?Be=ke(Re,Be,Z[ue+1]>>1)-1:(ke(Re,Be,3),Be+=5,ke(Re,Be,Z[ue-23]>>5),Be+=3);var xe=ue<8?0:ue-4>>2;xe>0&&(Ce(Re,Be,pe-z[ue]),Be+=xe),ue=we[ze-Ae],Be=ke(Re,Be,Z[ue]>>3),Be-=3;var We=ue<4?0:ue-2>>1;We>0&&(Ce(Re,Be,ze-Ae-ee[ue]),Be+=We);for(var qe=0;qe<pe;++qe)be[Ge]=ze&32767,Ge=(Ge<<5^Ue[ze])&32767,++ze;Te-=pe-1}else ue<=143?ue=ue+48:Be=Ee(Re,Be,1),Be=ke(Re,Be,Z[ue]),be[Ge]=ze&32767,++ze}Be=ke(Re,Be,0)-1}return Re.l=(Be+7)/8|0,Re.l}return function(Re,Be){return Re.length<8?ye(Re,Be):Me(Re,Be)}}();function ot(ie){var we=vn(50+Math.floor(ie.length*1.1)),de=tt(ie,we);return we.slice(0,de)}var De=M?new Uint16Array(32768):Pe(32768),ht=M?new Uint16Array(32768):Pe(32768),rt=M?new Uint16Array(128):Pe(128),it=1,dt=1;function wt(ie,we){var de=le(ie,we)+257;we+=5;var ge=le(ie,we)+1;we+=5;var ve=fe(ie,we)+4;we+=4;for(var ye=0,Me=M?new Uint8Array(19):Pe(19),Ue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Re=1,Be=M?new Uint8Array(8):Pe(8),ze=M?new Uint8Array(8):Pe(8),be=Me.length,Te=0;Te<ve;++Te)Me[re[Te]]=ye=Q(ie,we),Re<ye&&(Re=ye),Be[ye]++,we+=3;var Ge=0;for(Be[0]=0,Te=1;Te<=Re;++Te)ze[Te]=Ge=Ge+Be[Te-1]<<1;for(Te=0;Te<be;++Te)(Ge=Me[Te])!=0&&(Ue[Te]=ze[Ge]++);var ue=0;for(Te=0;Te<be;++Te)if(ue=Me[Te],ue!=0){Ge=Z[Ue[Te]]>>8-ue;for(var Ae=(1<<7-ue)-1;Ae>=0;--Ae)rt[Ge|Ae<<ue]=ue&7|Te<<3}var pe=[];for(Re=1;pe.length<de+ge;)switch(Ge=rt[te(ie,we)],we+=Ge&7,Ge>>>=3){case 16:for(ye=3+ne(ie,we),we+=2,Ge=pe[pe.length-1];ye-- >0;)pe.push(Ge);break;case 17:for(ye=3+Q(ie,we),we+=3;ye-- >0;)pe.push(0);break;case 18:for(ye=11+te(ie,we),we+=7;ye-- >0;)pe.push(0);break;default:pe.push(Ge),Re<Ge&&(Re=Ge);break}var xe=pe.slice(0,de),We=pe.slice(de);for(Te=de;Te<286;++Te)xe[Te]=0;for(Te=ge;Te<30;++Te)We[Te]=0;return it=Xe(xe,De,286),dt=Xe(We,ht,30),we}function gt(ie,we){if(ie[0]==3&&!(ie[1]&3))return[eo(we),2];for(var de=0,ge=0,ve=Kx(we||1<<18),ye=0,Me=ve.length>>>0,Ue=0,Re=0;(ge&1)==0;){if(ge=Q(ie,de),de+=3,ge>>>1)ge>>1==1?(Ue=9,Re=5):(de=wt(ie,de),Ue=it,Re=dt);else{de&7&&(de+=8-(de&7));var Be=ie[de>>>3]|ie[(de>>>3)+1]<<8;if(de+=32,Be>0)for(!we&&Me<ye+Be&&(ve=Fe(ve,ye+Be),Me=ve.length);Be-- >0;)ve[ye++]=ie[de>>>3],de+=8;continue}for(;;){!we&&Me<ye+32767&&(ve=Fe(ve,ye+32767),Me=ve.length);var ze=ce(ie,de,Ue),be=ge>>>1==1?ct[ze]:De[ze];if(de+=be&15,be>>>=4,(be>>>8&255)===0)ve[ye++]=be;else{if(be==256)break;be-=257;var Te=be<8?0:be-4>>2;Te>5&&(Te=0);var Ge=ye+z[be];Te>0&&(Ge+=ce(ie,de,Te),de+=Te),ze=ce(ie,de,Re),be=ge>>>1==1?st[ze]:ht[ze],de+=be&15,be>>>=4;var ue=be<4?0:be-2>>1,Ae=ee[be];for(ue>0&&(Ae+=ce(ie,de,ue),de+=ue),!we&&Me<Ge&&(ve=Fe(ve,Ge+100),Me=ve.length);ye<Ge;)ve[ye]=ve[ye-Ae],++ye}}}return we?[ve,de+7>>>3]:[ve.slice(0,ye),de+7>>>3]}function vt(ie,we){var de=ie.slice(ie.l||0),ge=gt(de,we);return ie.l+=ge[1],ge[0]}function Ve(ie,we){if(ie)typeof console<"u"&&console.error(we);else throw new Error(we)}function $e(ie,we){var de=ie;On(de,0);var ge=[],ve=[],ye={FileIndex:ge,FullPaths:ve};W(ye,{root:we.root});for(var Me=de.length-4;(de[Me]!=80||de[Me+1]!=75||de[Me+2]!=5||de[Me+3]!=6)&&Me>=0;)--Me;de.l=Me+4,de.l+=4;var Ue=de.read_shift(2);de.l+=6;var Re=de.read_shift(4);for(de.l=Re,Me=0;Me<Ue;++Me){de.l+=20;var Be=de.read_shift(4),ze=de.read_shift(4),be=de.read_shift(2),Te=de.read_shift(2),Ge=de.read_shift(2);de.l+=8;var ue=de.read_shift(4),Ae=l(de.slice(de.l+be,de.l+be+Te));de.l+=be+Te+Ge;var pe=de.l;de.l=ue+4,xt(de,Be,ze,ye,Ae),de.l=pe}return ye}function xt(ie,we,de,ge,ve){ie.l+=2;var ye=ie.read_shift(2),Me=ie.read_shift(2),Ue=s(ie);if(ye&8257)throw new Error("Unsupported ZIP encryption");for(var Re=ie.read_shift(4),Be=ie.read_shift(4),ze=ie.read_shift(4),be=ie.read_shift(2),Te=ie.read_shift(2),Ge="",ue=0;ue<be;++ue)Ge+=String.fromCharCode(ie[ie.l++]);if(Te){var Ae=l(ie.slice(ie.l,ie.l+Te));(Ae[21589]||{}).mt&&(Ue=Ae[21589].mt),((ve||{})[21589]||{}).mt&&(Ue=ve[21589].mt)}ie.l+=Te;var pe=ie.slice(ie.l,ie.l+Be);switch(Me){case 8:pe=K(ie,ze);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Me)}var xe=!1;ye&8&&(Re=ie.read_shift(4),Re==134695760&&(Re=ie.read_shift(4),xe=!0),Be=ie.read_shift(4),ze=ie.read_shift(4)),Be!=we&&Ve(xe,"Bad compressed size: "+we+" != "+Be),ze!=de&&Ve(xe,"Bad uncompressed size: "+de+" != "+ze),kt(ge,Ge,pe,{unsafe:!0,mt:Ue})}function nt(ie,we){var de=we||{},ge=[],ve=[],ye=vn(1),Me=de.compression?8:0,Ue=0,Re=0,Be=0,ze=0,be=0,Te=ie.FullPaths[0],Ge=Te,ue=ie.FileIndex[0],Ae=[],pe=0;for(Re=1;Re<ie.FullPaths.length;++Re)if(Ge=ie.FullPaths[Re].slice(Te.length),ue=ie.FileIndex[Re],!(!ue.size||!ue.content||Ge=="Sh33tJ5")){var xe=ze,We=vn(Ge.length);for(Be=0;Be<Ge.length;++Be)We.write_shift(1,Ge.charCodeAt(Be)&127);We=We.slice(0,We.l),Ae[be]=Mj.buf(ue.content,0);var qe=ue.content;Me==8&&(qe=Y(qe)),ye=vn(30),ye.write_shift(4,67324752),ye.write_shift(2,20),ye.write_shift(2,Ue),ye.write_shift(2,Me),ue.mt?o(ye,ue.mt):ye.write_shift(4,0),ye.write_shift(-4,Ae[be]),ye.write_shift(4,qe.length),ye.write_shift(4,ue.content.length),ye.write_shift(2,We.length),ye.write_shift(2,0),ze+=ye.length,ge.push(ye),ze+=We.length,ge.push(We),ze+=qe.length,ge.push(qe),ye=vn(46),ye.write_shift(4,33639248),ye.write_shift(2,0),ye.write_shift(2,20),ye.write_shift(2,Ue),ye.write_shift(2,Me),ye.write_shift(4,0),ye.write_shift(-4,Ae[be]),ye.write_shift(4,qe.length),ye.write_shift(4,ue.content.length),ye.write_shift(2,We.length),ye.write_shift(2,0),ye.write_shift(2,0),ye.write_shift(2,0),ye.write_shift(2,0),ye.write_shift(4,0),ye.write_shift(4,xe),pe+=ye.l,ve.push(ye),pe+=We.length,ve.push(We),++be}return ye=vn(22),ye.write_shift(4,101010256),ye.write_shift(2,0),ye.write_shift(2,0),ye.write_shift(2,be),ye.write_shift(2,be),ye.write_shift(4,pe),ye.write_shift(4,ze),ye.write_shift(2,0),qi([qi(ge),qi(ve),ye])}var pt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Se(ie,we){if(ie.ctype)return ie.ctype;var de=ie.name||"",ge=de.match(/\.([^\.]+)$/);return ge&&pt[ge[1]]||we&&(ge=(de=we).match(/[\.\\]([^\.\\])+$/),ge&&pt[ge[1]])?pt[ge[1]]:"application/octet-stream"}function je(ie){for(var we=Xx(ie),de=[],ge=0;ge<we.length;ge+=76)de.push(we.slice(ge,ge+76));return de.join(`\r
`)+`\r
`}function Qe(ie){var we=ie.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Be){var ze=Be.charCodeAt(0).toString(16).toUpperCase();return"="+(ze.length==1?"0"+ze:ze)});we=we.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),we.charAt(0)==`
`&&(we="=0D"+we.slice(1)),we=we.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var de=[],ge=we.split(`\r
`),ve=0;ve<ge.length;++ve){var ye=ge[ve];if(ye.length==0){de.push("");continue}for(var Me=0;Me<ye.length;){var Ue=76,Re=ye.slice(Me,Me+Ue);Re.charAt(Ue-1)=="="?Ue--:Re.charAt(Ue-2)=="="?Ue-=2:Re.charAt(Ue-3)=="="&&(Ue-=3),Re=ye.slice(Me,Me+Ue),Me+=Ue,Me<ye.length&&(Re+="="),de.push(Re)}}return de.join(`\r
`)}function At(ie){for(var we=[],de=0;de<ie.length;++de){for(var ge=ie[de];de<=ie.length&&ge.charAt(ge.length-1)=="=";)ge=ge.slice(0,ge.length-1)+ie[++de];we.push(ge)}for(var ve=0;ve<we.length;++ve)we[ve]=we[ve].replace(/[=][0-9A-Fa-f]{2}/g,function(ye){return String.fromCharCode(parseInt(ye.slice(1),16))});return is(we.join(`\r
`))}function Vt(ie,we,de){for(var ge="",ve="",ye="",Me,Ue=0;Ue<10;++Ue){var Re=we[Ue];if(!Re||Re.match(/^\s*$/))break;var Be=Re.match(/^(.*?):\s*([^\s].*)$/);if(Be)switch(Be[1].toLowerCase()){case"content-location":ge=Be[2].trim();break;case"content-type":ye=Be[2].trim();break;case"content-transfer-encoding":ve=Be[2].trim();break}}switch(++Ue,ve.toLowerCase()){case"base64":Me=is(Ta(we.slice(Ue).join("")));break;case"quoted-printable":Me=At(we.slice(Ue));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ve)}var ze=kt(ie,ge.slice(de.length),Me,{unsafe:!0});ye&&(ze.ctype=ye)}function yt(ie,we){if(T(ie.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var de=we&&we.root||"",ge=(fr&&Buffer.isBuffer(ie)?ie.toString("binary"):T(ie)).split(`\r
`),ve=0,ye="";for(ve=0;ve<ge.length;++ve)if(ye=ge[ve],!!/^Content-Location:/i.test(ye)&&(ye=ye.slice(ye.indexOf("file")),de||(de=ye.slice(0,ye.lastIndexOf("/")+1)),ye.slice(0,de.length)!=de))for(;de.length>0&&(de=de.slice(0,de.length-1),de=de.slice(0,de.lastIndexOf("/")+1),ye.slice(0,de.length)!=de););var Me=(ge[1]||"").match(/boundary="(.*?)"/);if(!Me)throw new Error("MAD cannot find boundary");var Ue="--"+(Me[1]||""),Re=[],Be=[],ze={FileIndex:Re,FullPaths:Be};W(ze);var be,Te=0;for(ve=0;ve<ge.length;++ve){var Ge=ge[ve];Ge!==Ue&&Ge!==Ue+"--"||(Te++&&Vt(ze,ge.slice(be,ve),de),be=ve)}return ze}function Ct(ie,we){var de=we||{},ge=de.boundary||"SheetJS";ge="------="+ge;for(var ve=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ge.slice(2)+'"',"","",""],ye=ie.FullPaths[0],Me=ye,Ue=ie.FileIndex[0],Re=1;Re<ie.FullPaths.length;++Re)if(Me=ie.FullPaths[Re].slice(ye.length),Ue=ie.FileIndex[Re],!(!Ue.size||!Ue.content||Me=="Sh33tJ5")){Me=Me.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(pe){return"_x"+pe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(pe){return"_u"+pe.charCodeAt(0).toString(16)+"_"});for(var Be=Ue.content,ze=fr&&Buffer.isBuffer(Be)?Be.toString("binary"):T(Be),be=0,Te=Math.min(1024,ze.length),Ge=0,ue=0;ue<=Te;++ue)(Ge=ze.charCodeAt(ue))>=32&&Ge<128&&++be;var Ae=be>=Te*4/5;ve.push(ge),ve.push("Content-Location: "+(de.root||"file:///C:/SheetJS/")+Me),ve.push("Content-Transfer-Encoding: "+(Ae?"quoted-printable":"base64")),ve.push("Content-Type: "+Se(Ue,Me)),ve.push(""),ve.push(Ae?Qe(ze):je(ze))}return ve.push(ge+`--\r
`),ve.join(`\r
`)}function It(ie){var we={};return W(we,ie),we}function kt(ie,we,de,ge){var ve=ge&&ge.unsafe;ve||W(ie);var ye=!ve&&pr.find(ie,we);if(!ye){var Me=ie.FullPaths[0];we.slice(0,Me.length)==Me?Me=we:(Me.slice(-1)!="/"&&(Me+="/"),Me=(Me+we).replace("//","/")),ye={name:a(we),type:2},ie.FileIndex.push(ye),ie.FullPaths.push(Me),ve||pr.utils.cfb_gc(ie)}return ye.content=de,ye.size=de?de.length:0,ge&&(ge.CLSID&&(ye.clsid=ge.CLSID),ge.mt&&(ye.mt=ge.mt),ge.ct&&(ye.ct=ge.ct)),ye}function Ne(ie,we){W(ie);var de=pr.find(ie,we);if(de){for(var ge=0;ge<ie.FileIndex.length;++ge)if(ie.FileIndex[ge]==de)return ie.FileIndex.splice(ge,1),ie.FullPaths.splice(ge,1),!0}return!1}function Le(ie,we,de){W(ie);var ge=pr.find(ie,we);if(ge){for(var ve=0;ve<ie.FileIndex.length;++ve)if(ie.FileIndex[ve]==ge)return ie.FileIndex[ve].name=a(de),ie.FullPaths[ve]=de,!0}return!1}function at(ie){q(ie,!0)}return r.find=I,r.read=B,r.parse=u,r.write=D,r.writeFile=A,r.utils={cfb_new:It,cfb_add:kt,cfb_del:Ne,cfb_mov:Le,cfb_gc:at,ReadShift:uu,CheckField:V_,prep_blob:On,bconcat:qi,use_zlib:P,_deflateRaw:ot,_inflateRaw:vt,consts:E},r}();function Fj(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(t);r.open("r"),r.encoding="binary";var e=r.read();return r.close(),e}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ds(t){for(var r=Object.keys(t),e=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(t,r[n])&&e.push(r[n]);return e}function Wm(t){for(var r=[],e=Ds(t),n=0;n!==e.length;++n)r[t[e[n]]]=e[n];return r}var Of=new Date(1899,11,30,0,0,0);function ta(t,r){var e=t.getTime(),n=Of.getTime()+(t.getTimezoneOffset()-Of.getTimezoneOffset())*6e4;return(e-n)/(24*60*60*1e3)}var __=new Date,Ij=Of.getTime()+(__.getTimezoneOffset()-Of.getTimezoneOffset())*6e4,a2=__.getTimezoneOffset();function Zf(t){var r=new Date;return r.setTime(t*24*60*60*1e3+Ij),r.getTimezoneOffset()!==a2&&r.setTime(r.getTime()+(r.getTimezoneOffset()-a2)*6e4),r}function Pj(t){var r=0,e=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(e=1,o>3&&(n=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":e*=24;case"H":e*=60;case"M":if(n)e*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=e*parseInt(a[o],10)}return r}var s2=new Date("2017-02-19T19:06:09.000Z"),S_=isNaN(s2.getFullYear())?new Date("2/19/17"):s2,Lj=S_.getFullYear()==2017;function kn(t,r){var e=new Date(t);if(Lj)return r>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):r<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(t instanceof Date)return t;if(S_.getFullYear()==1917&&!isNaN(e.getFullYear())){var n=e.getFullYear();return t.indexOf(""+n)>-1||e.setFullYear(e.getFullYear()+100),e}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function Uo(t,r){if(fr&&Buffer.isBuffer(t)){if(r){if(t[0]==255&&t[1]==254)return ou(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ou(c_(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(t[0]==255&&t[1]==254)return ou(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ou(new TextDecoder("utf-16be").decode(t.slice(2)))}var e={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(o){return e[o]||o})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function Rn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var r={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=Rn(t[e]));return r}function Gr(t,r){for(var e="";e.length<r;)e+=t;return e}function us(t){var r=Number(t);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(t))return r;var e=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,o){return e=-e,o}),!isNaN(r=Number(n)))?r/e:r}var Bj=["january","february","march","april","may","june","july","august","september","october","november","december"];function Zl(t){var r=new Date(t),e=new Date(NaN),n=r.getYear(),a=r.getMonth(),o=r.getDate();if(isNaN(o))return e;var s=t.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&Bj.indexOf(s)==-1)return e}else if(s.match(/[a-z]/))return e;return n<0||n>8099?e:(a>0||o>1)&&n!=101?r:t.match(/[^-0-9:,\/\\]/)?e:r}var Uj=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(e,n,a){if(t||typeof n=="string")return e.split(n);for(var o=e.split(n),s=[o[0]],l=1;l<o.length;++l)s.push(a),s.push(o[l]);return s}}();function k_(t){return t?t.content&&t.type?Uo(t.content,!0):t.data?au(t.data):t.asNodeBuffer&&fr?au(t.asNodeBuffer().toString("binary")):t.asBinary?au(t.asBinary()):t._data&&t._data.getContent?au(Uo(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function E_(t){if(!t)return null;if(t.data)return Gx(t.data);if(t.asNodeBuffer&&fr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var r=t._data.getContent();return typeof r=="string"?Gx(r):Array.prototype.slice.call(r)}return t.content&&t.type?t.content:null}function zj(t){return t&&t.name.slice(-4)===".bin"?E_(t):k_(t)}function La(t,r){for(var e=t.FullPaths||Ds(t.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),o=0;o<e.length;++o){var s=e[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return t.files?t.files[e[o]]:t.FileIndex[o]}return null}function Gm(t,r){var e=La(t,r);if(e==null)throw new Error("Cannot find file "+r+" in zip");return e}function on(t,r,e){if(!e)return zj(Gm(t,r));if(!r)return null;try{return on(t,r)}catch{return null}}function ka(t,r,e){if(!e)return k_(Gm(t,r));if(!r)return null;try{return ka(t,r)}catch{return null}}function $j(t,r,e){return E_(Gm(t,r))}function i2(t){for(var r=t.FullPaths||Ds(t.files),e=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&e.push(r[n].replace(/^Root Entry[\/]/,""));return e.sort()}function Vj(t,r,e){if(t.FullPaths){if(typeof e=="string"){var n;return fr?n=$o(e):n=lj(e),pr.utils.cfb_add(t,r,n)}pr.utils.cfb_add(t,r,e)}else t.file(r,e)}function T_(t,r){switch(r.type){case"base64":return pr.read(t,{type:"base64"});case"binary":return pr.read(t,{type:"binary"});case"buffer":case"array":return pr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function iu(t,r){if(t.charAt(0)=="/")return t.slice(1);var e=r.split("/");r.slice(-1)!="/"&&e.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?e.pop():a!=="."&&e.push(a)}return e.join("/")}var A_=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Hj=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,o2=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,qj=/<[^>]*>/g,Wn=A_.match(o2)?o2:qj,Wj=/<\w*:/,Gj=/<(\/?)\w+:/;function Jt(t,r,e){for(var n={},a=0,o=0;a!==t.length&&!((o=t.charCodeAt(a))===32||o===10||o===13);++a);if(r||(n[0]=t.slice(0,a)),a===t.length)return n;var s=t.match(Hj),l=0,c="",i=0,u="",p="",f=1;if(s)for(i=0;i!=s.length;++i){for(p=s[i],o=0;o!=p.length&&p.charCodeAt(o)!==61;++o);for(u=p.slice(0,o).trim();p.charCodeAt(o+1)==32;)++o;for(f=(a=p.charCodeAt(o+1))==34||a==39?1:0,c=p.slice(o+1+f,p.length-f),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,n[u.toLowerCase()]=c;else{var h=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(n[h]&&u.slice(l-3,l)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function Fs(t){return t.replace(Gj,"<$1")}var C_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Yj=Wm(C_),xr=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function e(n){var a=n+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(t,function(l,c){return C_[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(r,function(l,c){return String.fromCharCode(parseInt(c,16))});var s=a.indexOf("]]>");return e(a.slice(0,o))+a.slice(o+9,s)+e(a.slice(s+3))}}(),Xj=/[&<>'"]/g,Kj=/[\u0000-\u001f]/g;function Ym(t){var r=t+"";return r.replace(Xj,function(e){return Yj[e]}).replace(/\n/g,"<br/>").replace(Kj,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var l2=function(){var t=/&#(\d+);/g;function r(e,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,r)}}();function Br(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function yp(t){for(var r="",e=0,n=0,a=0,o=0,s=0,l=0;e<t.length;){if(n=t.charCodeAt(e++),n<128){r+=String.fromCharCode(n);continue}if(a=t.charCodeAt(e++),n>191&&n<224){s=(n&31)<<6,s|=a&63,r+=String.fromCharCode(s);continue}if(o=t.charCodeAt(e++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|o&63);continue}s=t.charCodeAt(e++),l=((n&7)<<18|(a&63)<<12|(o&63)<<6|s&63)-65536,r+=String.fromCharCode(55296+(l>>>10&1023)),r+=String.fromCharCode(56320+(l&1023))}return r}function c2(t){var r=eo(2*t.length),e,n,a=1,o=0,s=0,l;for(n=0;n<t.length;n+=a)a=1,(l=t.charCodeAt(n))<128?e=l:l<224?(e=(l&31)*64+(t.charCodeAt(n+1)&63),a=2):l<240?(e=(l&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,e=(l&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),e-=65536,s=55296+(e>>>10&1023),e=56320+(e&1023)),s!==0&&(r[o++]=s&255,r[o++]=s>>>8,s=0),r[o++]=e%256,r[o++]=e>>>8;return r.slice(0,o).toString("ucs2")}function u2(t){return $o(t,"binary").toString("utf8")}var pf="foo bar baz",Ir=fr&&(u2(pf)==yp(pf)&&u2||c2(pf)==yp(pf)&&c2)||yp,ou=fr?function(t){return $o(t,"utf8").toString("binary")}:function(t){for(var r=[],e=0,n=0,a=0;e<t.length;)switch(n=t.charCodeAt(e++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(e++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Du=function(){var t={};return function(e,n){var a=e+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",n||"")}}(),N_=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(e){for(var n=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}}(),Zj=function(){var t={};return function(e){return t[e]!==void 0?t[e]:t[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}}(),Jj=/<\/?(?:vt:)?variant>/g,Qj=/<(?:vt:)([^>]*)>([\s\S]*)</;function d2(t,r){var e=Jt(t),n=t.match(Zj(e.baseType))||[],a=[];if(n.length!=e.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+e.size);return a}return n.forEach(function(o){var s=o.replace(Jj,"").match(Qj);s&&a.push({v:Ir(s[2]),t:s[1]})}),a}var eO=/(^\s|\s$|\n)/;function tO(t){return Ds(t).map(function(r){return" "+r+'="'+t[r]+'"'}).join("")}function rO(t,r,e){return"<"+t+(e!=null?tO(e):"")+(r!=null?(r.match(eO)?' xml:space="preserve"':"")+">"+r+"</"+t:"/")+">"}function Xm(t){if(fr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Ir(Vo(Vm(t)));throw new Error("Bad input format: expected Buffer or string")}var Ru=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,nO={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},aO=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function sO(t,r){for(var e=1-2*(t[r+7]>>>7),n=((t[r+7]&127)<<4)+(t[r+6]>>>4&15),a=t[r+6]&15,o=5;o>=0;--o)a=a*256+t[r+o];return n==2047?a==0?e*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),e*Math.pow(2,n-52)*a)}function iO(t,r,e){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,o=0,s=n?-r:r;isFinite(s)?s==0?a=o=0:(a=Math.floor(Math.log(s)/Math.LN2),o=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(r)?26985:0);for(var l=0;l<=5;++l,o/=256)t[e+l]=o&255;t[e+6]=(a&15)<<4|o&15,t[e+7]=a>>4|n}var f2=function(t){for(var r=[],e=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,o=t[0][n].length;a<o;a+=e)r.push.apply(r,t[0][n].slice(a,a+e));return r},h2=fr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(r){return Buffer.isBuffer(r)?r:$o(r)})):f2(t)}:f2,p2=function(t,r,e){for(var n=[],a=r;a<e;a+=2)n.push(String.fromCharCode(ni(t,a)));return n.join("").replace(ea,"")},Km=fr?function(t,r,e){return Buffer.isBuffer(t)?t.toString("utf16le",r,e).replace(ea,""):p2(t,r,e)}:p2,m2=function(t,r,e){for(var n=[],a=r;a<r+e;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},j_=fr?function(t,r,e){return Buffer.isBuffer(t)?t.toString("hex",r,r+e):m2(t,r,e)}:m2,g2=function(t,r,e){for(var n=[],a=r;a<e;a++)n.push(String.fromCharCode(Bl(t,a)));return n.join("")},Wu=fr?function(r,e,n){return Buffer.isBuffer(r)?r.toString("utf8",e,n):g2(r,e,n)}:g2,O_=function(t,r){var e=wa(t,r);return e>0?Wu(t,r+4,r+4+e-1):""},D_=O_,R_=function(t,r){var e=wa(t,r);return e>0?Wu(t,r+4,r+4+e-1):""},M_=R_,F_=function(t,r){var e=2*wa(t,r);return e>0?Wu(t,r+4,r+4+e-1):""},I_=F_,P_=function(r,e){var n=wa(r,e);return n>0?Km(r,e+4,e+4+n):""},L_=P_,B_=function(t,r){var e=wa(t,r);return e>0?Wu(t,r+4,r+4+e):""},U_=B_,z_=function(t,r){return sO(t,r)},Df=z_,$_=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};fr&&(D_=function(r,e){if(!Buffer.isBuffer(r))return O_(r,e);var n=r.readUInt32LE(e);return n>0?r.toString("utf8",e+4,e+4+n-1):""},M_=function(r,e){if(!Buffer.isBuffer(r))return R_(r,e);var n=r.readUInt32LE(e);return n>0?r.toString("utf8",e+4,e+4+n-1):""},I_=function(r,e){if(!Buffer.isBuffer(r))return F_(r,e);var n=2*r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+n-1)},L_=function(r,e){if(!Buffer.isBuffer(r))return P_(r,e);var n=r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+n)},U_=function(r,e){if(!Buffer.isBuffer(r))return B_(r,e);var n=r.readUInt32LE(e);return r.toString("utf8",e+4,e+4+n)},Df=function(r,e){return Buffer.isBuffer(r)?r.readDoubleLE(e):z_(r,e)},$_=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Bl=function(t,r){return t[r]},ni=function(t,r){return t[r+1]*256+t[r]},oO=function(t,r){var e=t[r+1]*256+t[r];return e<32768?e:(65535-e+1)*-1},wa=function(t,r){return t[r+3]*(1<<24)+(t[r+2]<<16)+(t[r+1]<<8)+t[r]},Do=function(t,r){return t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]},lO=function(t,r){return t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]};function uu(t,r){var e="",n,a,o=[],s,l,c,i;switch(r){case"dbcs":if(i=this.l,fr&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)e+=String.fromCharCode(ni(this,i)),i+=2;t*=2;break;case"utf8":e=Wu(this,this.l,this.l+t);break;case"utf16le":t*=2,e=Km(this,this.l,this.l+t);break;case"wstr":return uu.call(this,t,"dbcs");case"lpstr-ansi":e=D_(this,this.l),t=4+wa(this,this.l);break;case"lpstr-cp":e=M_(this,this.l),t=4+wa(this,this.l);break;case"lpwstr":e=I_(this,this.l),t=4+2*wa(this,this.l);break;case"lpp4":t=4+wa(this,this.l),e=L_(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+wa(this,this.l),e=U_(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,e="";(s=Bl(this,this.l+t++))!==0;)o.push(hf(s));e=o.join("");break;case"_wstr":for(t=0,e="";(s=ni(this,this.l+t))!==0;)o.push(hf(s)),t+=2;t+=2,e=o.join("");break;case"dbcs-cont":for(e="",i=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(i)!==-1)return s=Bl(this,i),this.l=i+1,l=uu.call(this,t-c,s?"dbcs-cont":"sbcs-cont"),o.join("")+l;o.push(hf(ni(this,i))),i+=2}e=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(e="",i=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(i)!==-1)return s=Bl(this,i),this.l=i+1,l=uu.call(this,t-c,s?"dbcs-cont":"sbcs-cont"),o.join("")+l;o.push(hf(Bl(this,i))),i+=1}e=o.join("");break;default:switch(t){case 1:return n=Bl(this,this.l),this.l++,n;case 2:return n=(r==="i"?oO:ni)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(t>0?Do:lO)(this,this.l),this.l+=4,n):(a=wa(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return t==8?a=Df(this,this.l):a=Df([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:e=j_(this,this.l,t);break}}return this.l+=t,e}var cO=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24&255},uO=function(t,r,e){t[e]=r&255,t[e+1]=r>>8&255,t[e+2]=r>>16&255,t[e+3]=r>>24&255},dO=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255};function fO(t,r,e){var n=0,a=0;if(e==="dbcs"){for(a=0;a!=r.length;++a)dO(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(e==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(e==="hex"){for(;a<t;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(e==="utf16le"){var o=Math.min(this.l+t,this.length);for(a=0;a<Math.min(r.length,t);++a){var s=r.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,cO(this,r,this.l);break;case 8:if(n=8,e==="f"){iO(this,r,this.l);break}case 16:break;case-4:n=4,uO(this,r,this.l);break}return this.l+=n,this}function V_(t,r){var e=j_(this,this.l,t.length>>1);if(e!==t)throw new Error(r+"Expected "+t+" saw "+e);this.l+=t.length>>1}function On(t,r){t.l=r,t.read_shift=uu,t.chk=V_,t.write_shift=fO}function qn(t,r){t.l+=r}function vn(t){var r=eo(t);return On(r,0),r}function ci(t,r,e){if(t){var n,a,o;On(t,t.l||0);for(var s=t.length,l=0,c=0;t.l<s;){l=t.read_shift(1),l&128&&(l=(l&127)+((t.read_shift(1)&127)<<7));var i=Lf[l]||Lf[65535];for(n=t.read_shift(1),o=n&127,a=1;a<4&&n&128;++a)o+=((n=t.read_shift(1))&127)<<7*a;c=t.l+o;var u=i.f&&i.f(t,o,e);if(t.l=c,r(u,i,l))return}}}function Qp(){var t=[],r=fr?256:2048,e=function(i){var u=vn(i);return On(u,0),u},n=e(r),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},o=function(i){return n&&i<n.length-n.l?n:(a(),n=e(Math.max(i+1,r)))},s=function(){return a(),qi(t)},l=function(i){a(),n=i,n.l==null&&(n.l=n.length),o(r)};return{next:o,push:l,end:s,_bufs:t}}function du(t,r,e){var n=Rn(t);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!e||e.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function v2(t,r,e){var n=Rn(t);return n.s=du(n.s,r.s,e),n.e=du(n.e,r.s,e),n}function fu(t,r){if(t.cRel&&t.c<0)for(t=Rn(t);t.c<0;)t.c+=r>8?16384:256;if(t.rRel&&t.r<0)for(t=Rn(t);t.r<0;)t.r+=r>8?1048576:r>5?65536:16384;var e=Qt(t);return!t.cRel&&t.cRel!=null&&(e=mO(e)),!t.rRel&&t.rRel!=null&&(e=hO(e)),e}function wp(t,r){return t.s.r==0&&!t.s.rRel&&t.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+bn(t.s.c)+":"+(t.e.cRel?"":"$")+bn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(r.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Mn(t.s.r)+":"+(t.e.rRel?"":"$")+Mn(t.e.r):fu(t.s,r.biff)+":"+fu(t.e,r.biff)}function Zm(t){return parseInt(pO(t),10)-1}function Mn(t){return""+(t+1)}function hO(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function pO(t){return t.replace(/\$(\d+)$/,"$1")}function Jm(t){for(var r=gO(t),e=0,n=0;n!==r.length;++n)e=26*e+r.charCodeAt(n)-64;return e-1}function bn(t){if(t<0)throw new Error("invalid column "+t);var r="";for(++t;t;t=Math.floor((t-1)/26))r=String.fromCharCode((t-1)%26+65)+r;return r}function mO(t){return t.replace(/^([A-Z])/,"$$$1")}function gO(t){return t.replace(/^\$([A-Z])/,"$1")}function vO(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Qn(t){for(var r=0,e=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(e=26*e+(a-64))}return{c:e-1,r:r-1}}function Qt(t){for(var r=t.c+1,e="";r;r=(r-1)/26|0)e=String.fromCharCode((r-1)%26+65)+e;return e+(t.r+1)}function nc(t){var r=t.indexOf(":");return r==-1?{s:Qn(t),e:Qn(t)}:{s:Qn(t.slice(0,r)),e:Qn(t.slice(r+1))}}function mr(t,r){return typeof r>"u"||typeof r=="number"?mr(t.s,t.e):(typeof t!="string"&&(t=Qt(t)),typeof r!="string"&&(r=Qt(r)),t==r?t:t+":"+r)}function Yr(t){var r={s:{c:0,r:0},e:{c:0,r:0}},e=0,n=0,a=0,o=t.length;for(e=0;n<o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)e=26*e+a;for(r.s.c=--e,e=0;n<o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)e=10*e+a;if(r.s.r=--e,n===o||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,e=0;n!=o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)e=26*e+a;for(r.e.c=--e,e=0;n!=o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)e=10*e+a;return r.e.r=--e,r}function b2(t,r){var e=t.t=="d"&&r instanceof Date;if(t.z!=null)try{return t.w=Ha(t.z,e?ta(r):r)}catch{}try{return t.w=Ha((t.XF||{}).numFmtId||(e?14:0),e?ta(r):r)}catch{return""+r}}function ii(t,r,e){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),t.t=="e"?Wo[t.v]||t.v:r==null?b2(t,t.v):b2(t,r))}function no(t,r){var e=r&&r.sheet?r.sheet:"Sheet1",n={};return n[e]=t,{SheetNames:[e],Sheets:n}}function H_(t,r,e){var n=e||{},a=t?Array.isArray(t):n.dense,o=t||(a?[]:{}),s=0,l=0;if(o&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Qn(n.origin):n.origin;s=c.r,l=c.c}o["!ref"]||(o["!ref"]="A1:A1")}var i={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var u=Yr(o["!ref"]);i.s.c=u.s.c,i.s.r=u.s.r,i.e.c=Math.max(i.e.c,u.e.c),i.e.r=Math.max(i.e.r,u.e.r),s==-1&&(i.e.r=s=u.e.r+1)}for(var p=0;p!=r.length;++p)if(r[p]){if(!Array.isArray(r[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=r[p].length;++f)if(!(typeof r[p][f]>"u")){var h={v:r[p][f]},v=s+p,b=l+f;if(i.s.r>v&&(i.s.r=v),i.s.c>b&&(i.s.c=b),i.e.r<v&&(i.e.r=v),i.e.c<b&&(i.e.c=b),r[p][f]&&typeof r[p][f]=="object"&&!Array.isArray(r[p][f])&&!(r[p][f]instanceof Date))h=r[p][f];else if(Array.isArray(h.v)&&(h.f=r[p][f][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||rr[14],n.cellDates?(h.t="d",h.w=Ha(h.z,ta(h.v))):(h.t="n",h.v=ta(h.v),h.w=Ha(h.z,h.v))):h.t="s";if(a)o[v]||(o[v]=[]),o[v][b]&&o[v][b].z&&(h.z=o[v][b].z),o[v][b]=h;else{var g=Qt({c:b,r:v});o[g]&&o[g].z&&(h.z=o[g].z),o[g]=h}}}return i.s.c<1e7&&(o["!ref"]=mr(i)),o}function ac(t,r){return H_(null,t,r)}function bO(t){return t.read_shift(4,"i")}function Hn(t){var r=t.read_shift(4);return r===0?"":t.read_shift(r,"dbcs")}function xO(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Qm(t,r){var e=t.l,n=t.read_shift(1),a=Hn(t),o=[],s={t:a,h:a};if((n&1)!==0){for(var l=t.read_shift(4),c=0;c!=l;++c)o.push(xO(t));s.r=o}else s.r=[{ich:0,ifnt:0}];return t.l=e+r,s}var yO=Qm;function qa(t){var r=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:r,iStyleRef:e}}function Ho(t){var r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:r}}var wO=Hn;function e1(t){var r=t.read_shift(4);return r===0||r===4294967295?"":t.read_shift(r,"dbcs")}var _O=Hn,em=e1;function t1(t){var r=t.slice(t.l,t.l+4),e=r[0]&1,n=r[0]&2;t.l+=4;var a=n===0?Df([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Do(r,0)>>2;return e?a/100:a}function q_(t){var r={s:{},e:{}};return r.s.r=t.read_shift(4),r.e.r=t.read_shift(4),r.s.c=t.read_shift(4),r.e.c=t.read_shift(4),r}var qo=q_;function $n(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function SO(t){var r={},e=t.read_shift(1),n=e>>>1,a=t.read_shift(1),o=t.read_shift(2,"i"),s=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var i=Lo[a];i&&(r.rgb=Fu(i));break;case 2:r.rgb=Fu([s,l,c]);break;case 3:r.theme=a;break}return o!=0&&(r.tint=o>0?o/32767:o/32768),r}function kO(t){var r=t.read_shift(1);t.l++;var e={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return e}function W_(t,r){var e={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return e[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,r==1?"lpstr":"lpwstr")}function EO(t){return W_(t,1)}function TO(t){return W_(t,2)}var r1=2,la=3,mf=11,x2=12,Rf=19,gf=64,AO=65,CO=71,NO=4108,jO=4126,Sn=80,G_=81,OO=[Sn,G_],DO={1:{n:"CodePage",t:r1},2:{n:"Category",t:Sn},3:{n:"PresentationFormat",t:Sn},4:{n:"ByteCount",t:la},5:{n:"LineCount",t:la},6:{n:"ParagraphCount",t:la},7:{n:"SlideCount",t:la},8:{n:"NoteCount",t:la},9:{n:"HiddenCount",t:la},10:{n:"MultimediaClipCount",t:la},11:{n:"ScaleCrop",t:mf},12:{n:"HeadingPairs",t:NO},13:{n:"TitlesOfParts",t:jO},14:{n:"Manager",t:Sn},15:{n:"Company",t:Sn},16:{n:"LinksUpToDate",t:mf},17:{n:"CharacterCount",t:la},19:{n:"SharedDoc",t:mf},22:{n:"HyperlinksChanged",t:mf},23:{n:"AppVersion",t:la,p:"version"},24:{n:"DigSig",t:AO},26:{n:"ContentType",t:Sn},27:{n:"ContentStatus",t:Sn},28:{n:"Language",t:Sn},29:{n:"Version",t:Sn},255:{},2147483648:{n:"Locale",t:Rf},2147483651:{n:"Behavior",t:Rf},1919054434:{}},RO={1:{n:"CodePage",t:r1},2:{n:"Title",t:Sn},3:{n:"Subject",t:Sn},4:{n:"Author",t:Sn},5:{n:"Keywords",t:Sn},6:{n:"Comments",t:Sn},7:{n:"Template",t:Sn},8:{n:"LastAuthor",t:Sn},9:{n:"RevNumber",t:Sn},10:{n:"EditTime",t:gf},11:{n:"LastPrinted",t:gf},12:{n:"CreatedDate",t:gf},13:{n:"ModifiedDate",t:gf},14:{n:"PageCount",t:la},15:{n:"WordCount",t:la},16:{n:"CharCount",t:la},17:{n:"Thumbnail",t:CO},18:{n:"Application",t:Sn},19:{n:"DocSecurity",t:la},255:{},2147483648:{n:"Locale",t:Rf},2147483651:{n:"Behavior",t:Rf},1919054434:{}},y2={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},MO=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function FO(t){return t.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var IO=FO([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Lo=Rn(IO),Wo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Y_={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},w2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function PO(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function LO(t){var r=PO();if(!t||!t.match)return r;var e={};if((t.match(Wn)||[]).forEach(function(n){var a=Jt(n);switch(a[0].replace(Wj,"<")){case"<?xml":break;case"<Types":r.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[a.Extension]=a.ContentType;break;case"<Override":r[w2[a.ContentType]]!==void 0&&r[w2[a.ContentType]].push(a.PartName);break}}),r.xmlns!==nO.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=e,delete r.calcchains,r}var $l={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function tm(t){var r=t.lastIndexOf("/");return t.slice(0,r+1)+"_rels/"+t.slice(r+1)+".rels"}function hu(t,r){var e={"!id":{}};if(!t)return e;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(t.match(Wn)||[]).forEach(function(a){var o=Jt(a);if(o[0]==="<Relationship"){var s={};s.Type=o.Type,s.Target=o.Target,s.Id=o.Id,o.TargetMode&&(s.TargetMode=o.TargetMode);var l=o.TargetMode==="External"?o.Target:iu(o.Target,r);e[l]=s,n[o.Id]=s}}),e["!id"]=n,e}var BO="application/vnd.oasis.opendocument.spreadsheet";function UO(t,r){for(var e=Xm(t),n,a;n=Ru.exec(e);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Jt(n[0],!1),a.path=="/"&&a.type!==BO)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var pu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],zO=function(){for(var t=new Array(pu.length),r=0;r<pu.length;++r){var e=pu[r],n="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);t[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function X_(t){var r={};t=Ir(t);for(var e=0;e<pu.length;++e){var n=pu[e],a=t.match(zO[e]);a!=null&&a.length>0&&(r[n[1]]=xr(a[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=kn(r[n[1]]))}return r}var $O=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function K_(t,r,e,n){var a=[];if(typeof t=="string")a=d2(t,n);else for(var o=0;o<t.length;++o)a=a.concat(t[o].map(function(u){return{v:u}}));var s=typeof r=="string"?d2(r,n).map(function(u){return u.v}):r,l=0,c=0;if(s.length>0)for(var i=0;i!==a.length;i+=2){switch(c=+a[i+1].v,a[i].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":e.Worksheets=c,e.SheetNames=s.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":e.NamedRanges=c,e.DefinedNames=s.slice(l,l+c);break;case"Charts":case"Diagramme":e.Chartsheets=c,e.ChartNames=s.slice(l,l+c);break}l+=c}}function VO(t,r,e){var n={};return r||(r={}),t=Ir(t),$O.forEach(function(a){var o=(t.match(Du(a[0]))||[])[1];switch(a[2]){case"string":o&&(r[a[1]]=xr(o));break;case"bool":r[a[1]]=o==="true";break;case"raw":var s=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&K_(n.HeadingPairs,n.TitlesOfParts,r,e),r}var HO=/<[^>]+>[^<]*/g;function qO(t,r){var e={},n="",a=t.match(HO);if(a)for(var o=0;o!=a.length;++o){var s=a[o],l=Jt(s);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=xr(l.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),i=c[0].slice(4),u=c[1];switch(i){case"lpstr":case"bstr":case"lpwstr":e[n]=xr(u);break;case"bool":e[n]=Br(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":e[n]=parseFloat(u);break;case"filetime":case"date":e[n]=kn(u);break;case"cy":case"error":e[n]=xr(u);break;default:if(i.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",s,i,c)}}else if(s.slice(0,2)!=="</"){if(r.WTF)throw new Error(s)}}}return e}var WO={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},_p;function GO(t,r,e){_p||(_p=Wm(WO)),r=_p[r]||r,t[r]=e}function n1(t){var r=t.read_shift(4),e=t.read_shift(4);return new Date((e/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Z_(t,r,e){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(e)for(;t.l-n&3;)++t.l;return a}function J_(t,r,e){var n=t.read_shift(0,"lpwstr");return n}function Q_(t,r,e){return r===31?J_(t):Z_(t,r,e)}function rm(t,r,e){return Q_(t,r,e===!1?0:4)}function YO(t,r){if(!r)throw new Error("VtUnalignedString must have positive length");return Q_(t,r,0)}function XO(t){for(var r=t.read_shift(4),e=[],n=0;n!=r;++n){var a=t.l;e[n]=t.read_shift(0,"lpwstr").replace(ea,""),t.l-a&2&&(t.l+=2)}return e}function KO(t){for(var r=t.read_shift(4),e=[],n=0;n!=r;++n)e[n]=t.read_shift(0,"lpstr-cp").replace(ea,"");return e}function ZO(t){var r=t.l,e=Mf(t,G_);t[t.l]==0&&t[t.l+1]==0&&t.l-r&2&&(t.l+=2);var n=Mf(t,la);return[e,n]}function JO(t){for(var r=t.read_shift(4),e=[],n=0;n<r/2;++n)e.push(ZO(t));return e}function _2(t,r){for(var e=t.read_shift(4),n={},a=0;a!=e;++a){var o=t.read_shift(4),s=t.read_shift(4);n[o]=t.read_shift(s,r===1200?"utf16le":"utf8").replace(ea,"").replace(su,"!"),r===1200&&s%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function e4(t){var r=t.read_shift(4),e=t.slice(t.l,t.l+r);return t.l+=r,(r&3)>0&&(t.l+=4-(r&3)&3),e}function QO(t){var r={};return r.Size=t.read_shift(4),t.l+=r.Size+3-(r.Size-1)%4,r}function Mf(t,r,e){var n=t.read_shift(2),a,o=e||{};if(t.l+=2,r!==x2&&n!==r&&OO.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===x2?n:r){case 2:return a=t.read_shift(2,"i"),o.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return Z_(t,n,4).replace(ea,"");case 31:return J_(t);case 64:return n1(t);case 65:return e4(t);case 71:return QO(t);case 80:return rm(t,n,!o.raw).replace(ea,"");case 81:return YO(t,n).replace(ea,"");case 4108:return JO(t);case 4126:case 4127:return n==4127?XO(t):KO(t);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function S2(t,r){var e=t.l,n=t.read_shift(4),a=t.read_shift(4),o=[],s=0,l=0,c=-1,i={};for(s=0;s!=a;++s){var u=t.read_shift(4),p=t.read_shift(4);o[s]=[u,p+e]}o.sort(function(y,k){return y[1]-k[1]});var f={};for(s=0;s!=a;++s){if(t.l!==o[s][1]){var h=!0;if(s>0&&r)switch(r[o[s-1][0]].t){case 2:t.l+2===o[s][1]&&(t.l+=2,h=!1);break;case 80:t.l<=o[s][1]&&(t.l=o[s][1],h=!1);break;case 4108:t.l<=o[s][1]&&(t.l=o[s][1],h=!1);break}if((!r||s==0)&&t.l<=o[s][1]&&(h=!1,t.l=o[s][1]),h)throw new Error("Read Error: Expected address "+o[s][1]+" at "+t.l+" :"+s)}if(r){var v=r[o[s][0]];if(f[v.n]=Mf(t,v.t,{raw:!0}),v.p==="version"&&(f[v.n]=String(f[v.n]>>16)+"."+("0000"+String(f[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(f[v.n]){case 0:f[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ls(l=f[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[v.n])}}else if(o[s][0]===1){if(l=f.CodePage=Mf(t,r1),ls(l),c!==-1){var b=t.l;t.l=o[c][1],i=_2(t,l),t.l=b}}else if(o[s][0]===0){if(l===0){c=s,t.l=o[s+1][1];continue}i=_2(t,l)}else{var g=i[o[s][0]],x;switch(t[t.l]){case 65:t.l+=4,x=e4(t);break;case 30:t.l+=4,x=rm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,x=rm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,x=t.read_shift(4,"i");break;case 19:t.l+=4,x=t.read_shift(4);break;case 5:t.l+=4,x=t.read_shift(8,"f");break;case 11:t.l+=4,x=Zr(t,4);break;case 64:t.l+=4,x=kn(n1(t));break;default:throw new Error("unparsed value: "+t[t.l])}f[g]=x}}return t.l=e+n,f}function k2(t,r,e){var n=t.content;if(!n)return{};On(n,0);var a,o,s,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var i=n.read_shift(4),u=n.read_shift(16);if(u!==pr.utils.consts.HEADER_CLSID&&u!==e)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(s=n.read_shift(16),c=n.read_shift(4));var p=S2(n,r),f={SystemIdentifier:i};for(var h in p)f[h]=p[h];if(f.FMTID=o,a===1)return f;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var v;try{v=S2(n,null)}catch{}for(h in v)f[h]=v[h];return f.FMTID=[o,s],f}function $i(t,r){return t.read_shift(r),null}function eD(t,r,e){for(var n=[],a=t.l+r;t.l<a;)n.push(e(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Zr(t,r){return t.read_shift(r)===1}function ln(t){return t.read_shift(2,"u")}function t4(t,r){return eD(t,r,ln)}function tD(t){var r=t.read_shift(1),e=t.read_shift(1);return e===1?r:r===1}function Gu(t,r,e){var n=t.read_shift(e&&e.biff>=12?2:1),a="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var o=t.read_shift(1);o&&(a="dbcs-cont")}else e.biff==12&&(a="wstr");e.biff>=2&&e.biff<=5&&(a="cpstr");var s=n?t.read_shift(n,a):"";return s}function rD(t){var r=t.read_shift(2),e=t.read_shift(1),n=e&4,a=e&8,o=1+(e&1),s=0,l,c={};a&&(s=t.read_shift(2)),n&&(l=t.read_shift(4));var i=o==2?"dbcs-cont":"sbcs-cont",u=r===0?"":t.read_shift(r,i);return a&&(t.l+=4*s),n&&(t.l+=l),c.t=u,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function zo(t,r,e){var n;if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(r,"cpstr");if(e.biff>=12)return t.read_shift(r,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(r,"sbcs-cont"):n=t.read_shift(r,"dbcs-cont"),n}function Yu(t,r,e){var n=t.read_shift(e&&e.biff==2?1:2);return n===0?(t.l++,""):zo(t,n,e)}function Go(t,r,e){if(e.biff>5)return Yu(t,r,e);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function nD(t){var r=t.read_shift(1);t.l++;var e=t.read_shift(2);return t.l+=2,[r,e]}function aD(t){var r=t.read_shift(4),e=t.l,n=!1;r>24&&(t.l+=r-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=e);var a=t.read_shift((n?r-24:r)>>1,"utf16le").replace(ea,"");return n&&(t.l+=24),a}function sD(t){for(var r=t.read_shift(2),e="";r-- >0;)e+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return e+n.replace(/\\/g,"/");var o=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=t.read_shift(o>>1,"utf16le").replace(ea,"");return e+s}function iD(t,r){var e=t.read_shift(16);switch(e){case"e0c9ea79f9bace118c8200aa004ba90b":return aD(t);case"0303000000000000c000000000000046":return sD(t);default:throw new Error("Unsupported Moniker "+e)}}function vf(t){var r=t.read_shift(4),e=r>0?t.read_shift(r,"utf16le").replace(ea,""):"";return e}function oD(t,r){var e=t.l+r,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var o,s,l,c,i="",u,p;a&16&&(o=vf(t,e-t.l)),a&128&&(s=vf(t,e-t.l)),(a&257)===257&&(l=vf(t,e-t.l)),(a&257)===1&&(c=iD(t,e-t.l)),a&8&&(i=vf(t,e-t.l)),a&32&&(u=t.read_shift(16)),a&64&&(p=n1(t)),t.l=e;var f=s||l||c||"";f&&i&&(f+="#"+i),f||(f="#"+i),a&2&&f.charAt(0)=="/"&&f.charAt(1)!="/"&&(f="file://"+f);var h={Target:f};return u&&(h.guid=u),p&&(h.time=p),o&&(h.Tooltip=o),h}function r4(t){var r=t.read_shift(1),e=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[r,e,n,a]}function n4(t,r){var e=r4(t);return e[3]=0,e}function Is(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2);return{r,c:e,ixfe:n}}function lD(t){var r=t.read_shift(2),e=t.read_shift(2);return t.l+=8,{type:r,flags:e}}function cD(t,r,e){return r===0?"":Go(t,r,e)}function uD(t,r,e){var n=e.biff>8?4:2,a=t.read_shift(n),o=t.read_shift(n,"i"),s=t.read_shift(n,"i");return[a,o,s]}function a4(t){var r=t.read_shift(2),e=t1(t);return[r,e]}function dD(t,r,e){t.l+=4,r-=4;var n=t.l+r,a=Gu(t,r,e),o=t.read_shift(2);if(n-=t.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return t.l+=o,a}function Jf(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r},e:{c:a,r:e}}}function s4(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r},e:{c:a,r:e}}}var fD=s4;function i4(t){t.l+=4;var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[e,r,n]}function hD(t){var r={};return t.l+=4,t.l+=16,r.fSharedNote=t.read_shift(2),t.l+=4,r}function pD(t){var r={};return t.l+=4,t.cf=t.read_shift(2),r}function In(t){t.l+=2,t.l+=t.read_shift(2)}var mD={0:In,4:In,5:In,6:In,7:pD,8:In,9:In,10:In,11:In,12:In,13:hD,14:In,15:In,16:In,17:In,18:In,19:In,20:In,21:i4};function gD(t,r){for(var e=t.l+r,n=[];t.l<e;){var a=t.read_shift(2);t.l-=2;try{n.push(mD[a](t,e-t.l))}catch{return t.l=e,n}}return t.l!=e&&(t.l=e),n}function bf(t,r){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=t.read_shift(2),r-=2,r>=2&&(e.dt=t.read_shift(2),t.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return t.read_shift(r),e}function vD(t,r){return r===0||t.read_shift(2),1200}function bD(t,r,e){if(e.enc)return t.l+=r,"";var n=t.l,a=Go(t,0,e);return t.read_shift(r+n-t.l),a}function xD(t,r,e){var n=e&&e.biff==8||r==2?t.read_shift(2):(t.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function yD(t,r,e){var n=t.read_shift(4),a=t.read_shift(1)&3,o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var s=Gu(t,0,e);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:o,name:s}}function wD(t,r){for(var e=t.l+r,n=t.read_shift(4),a=t.read_shift(4),o=[],s=0;s!=a&&t.l<e;++s)o.push(rD(t));return o.Count=n,o.Unique=a,o}function _D(t,r){var e={};return e.dsst=t.read_shift(2),t.l+=r-2,e}function SD(t){var r={};r.r=t.read_shift(2),r.c=t.read_shift(2),r.cnt=t.read_shift(2)-r.c;var e=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=e/20),r}function kD(t){var r=lD(t);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var e=t.read_shift(4);return e!==0}function ED(t){return t.read_shift(2),t.read_shift(4)}function E2(t,r,e){var n=0;e&&e.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);e&&e.biff==2&&(n=1-(a>>15),a&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,a]}function TD(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),s=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),i=t.read_shift(2);return{Pos:[r,e],Dim:[n,a],Flags:o,CurTab:s,FirstTab:l,Selected:c,TabRatio:i}}function AD(t,r,e){if(e&&e.biff>=2&&e.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function CD(){}function ND(t,r,e){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Gu(t,0,e),n}function jD(t){var r=Is(t);return r.isst=t.read_shift(4),r}function OD(t,r,e){e.biffguess&&e.biff==2&&(e.biff=5);var n=t.l+r,a=Is(t);e.biff==2&&t.l++;var o=Yu(t,n-t.l,e);return a.val=o,a}function DD(t,r,e){var n=t.read_shift(2),a=Go(t,0,e);return[n,a]}var RD=Go;function T2(t,r,e){var n=t.l+r,a=e.biff==8||!e.biff?4:2,o=t.read_shift(a),s=t.read_shift(a),l=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:o,c:l},e:{r:s,c}}}function MD(t){var r=t.read_shift(2),e=t.read_shift(2),n=a4(t);return{r,c:e,ixfe:n[0],rknum:n[1]}}function FD(t,r){for(var e=t.l+r-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<e;)o.push(a4(t));if(t.l!==e)throw new Error("MulRK read error");var s=t.read_shift(2);if(o.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:o}}function ID(t,r){for(var e=t.l+r-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<e;)o.push(t.read_shift(2));if(t.l!==e)throw new Error("MulBlank read error");var s=t.read_shift(2);if(o.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:o}}function PD(t,r,e,n){var a={},o=t.read_shift(4),s=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(2);return a.patternType=MO[l>>26],n.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function LD(t,r,e){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=PD(t,r,n.fStyle,e),n}function BD(t){t.l+=4;var r=[t.read_shift(2),t.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function A2(t,r,e){var n=Is(t);(e.biff==2||r==9)&&++t.l;var a=tD(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function UD(t,r,e){e.biffguess&&e.biff==2&&(e.biff=5);var n=Is(t),a=$n(t);return n.val=a,n}var C2=cD;function zD(t,r,e){var n=t.l+r,a=t.read_shift(2),o=t.read_shift(2);if(e.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var s=zo(t,o),l=[];n>t.l;)l.push(Yu(t));return[o,a,s,l]}function N2(t,r,e){var n=t.read_shift(2),a,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return e.sbcch===14849&&(a=dD(t,r-2,e)),o.body=a||t.read_shift(r-2),typeof a=="string"&&(o.Name=a),o}var $D=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function j2(t,r,e){var n=t.l+r,a=t.read_shift(2),o=t.read_shift(1),s=t.read_shift(1),l=t.read_shift(e&&e.biff==2?1:2),c=0;(!e||e.biff>=5)&&(e.biff!=5&&(t.l+=2),c=t.read_shift(2),e.biff==5&&(t.l+=2),t.l+=4);var i=zo(t,s,e);a&32&&(i=$D[i.charCodeAt(0)]);var u=n-t.l;e&&e.biff==2&&--u;var p=n==t.l||l===0||!(u>0)?[]:SI(t,u,e,l);return{chKey:o,Name:i,itab:c,rgce:p}}function o4(t,r,e){if(e.biff<8)return VD(t,r,e);for(var n=[],a=t.l+r,o=t.read_shift(e.biff>8?4:2);o--!==0;)n.push(uD(t,e.biff>8?12:6,e));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function VD(t,r,e){t[t.l+1]==3&&t[t.l]++;var n=Gu(t,r,e);return n.charCodeAt(0)==3?n.slice(1):n}function HD(t,r,e){if(e.biff<8){t.l+=r;return}var n=t.read_shift(2),a=t.read_shift(2),o=zo(t,n,e),s=zo(t,a,e);return[o,s]}function qD(t,r,e){var n=s4(t);t.l++;var a=t.read_shift(1);return r-=8,[kI(t,r,e),a,n]}function O2(t,r,e){var n=fD(t);switch(e.biff){case 2:t.l++,r-=7;break;case 3:case 4:t.l+=2,r-=8;break;default:t.l+=6,r-=12}return[n,wI(t,r,e)]}function WD(t){var r=t.read_shift(4)!==0,e=t.read_shift(4)!==0,n=t.read_shift(4);return[r,e,n]}function GD(t,r,e){if(!(e.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),s=t.read_shift(2),l=Go(t,0,e);return e.biff<8&&t.read_shift(1),[{r:n,c:a},l,s,o]}}function YD(t,r,e){return GD(t,r,e)}function XD(t,r){for(var e=[],n=t.read_shift(2);n--;)e.push(Jf(t));return e}function KD(t,r,e){if(e&&e.biff<8)return JD(t,r,e);var n=i4(t),a=gD(t,r-22,n[1]);return{cmo:n,ft:a}}var ZD={8:function(t,r){var e=t.l+r;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=e,{fmt:n}}};function JD(t,r,e){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,r-=36;var s=[];return s.push((ZD[n]||qn)(t,r,e)),{cmo:[a,n,o],ft:s}}function QD(t,r,e){var n=t.l,a="";try{t.l+=4;var o=(e.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(o)==-1?t.l+=6:s=nD(t,6,e);var l=t.read_shift(2);t.read_shift(2),ln(t,2);var c=t.read_shift(2);t.l+=c;for(var i=1;i<t.lens.length-1;++i){if(t.l-n!=t.lens[i])throw new Error("TxO: bad continue record");var u=t[t.l],p=zo(t,t.lens[i+1]-t.lens[i]-1);if(a+=p,a.length>=(u?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return t.l=n+r,{t:a}}catch{return t.l=n+r,{t:a}}}function eR(t,r){var e=Jf(t);t.l+=16;var n=oD(t,r-24);return[e,n]}function tR(t,r){t.read_shift(2);var e=Jf(t),n=t.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(ea,""),[e,n]}function rR(t){var r=[0,0],e;return e=t.read_shift(2),r[0]=y2[e]||e,e=t.read_shift(2),r[1]=y2[e]||e,r}function nR(t){for(var r=t.read_shift(2),e=[];r-- >0;)e.push(n4(t));return e}function aR(t){for(var r=t.read_shift(2),e=[];r-- >0;)e.push(n4(t));return e}function sR(t){t.l+=2;var r={cxfs:0,crc:0};return r.cxfs=t.read_shift(2),r.crc=t.read_shift(4),r}function l4(t,r,e){if(!e.cellStyles)return qn(t,r);var n=e&&e.biff>=12?4:2,a=t.read_shift(n),o=t.read_shift(n),s=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var i={s:a,e:o,w:s,ixfe:l,flags:c};return(e.biff>=5||!e.biff)&&(i.level=c>>8&7),i}function iR(t,r){var e={};return r<32||(t.l+=16,e.header=$n(t),e.footer=$n(t),t.l+=2),e}function oR(t,r,e){var n={area:!1};if(e.biff!=5)return t.l+=r,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}var lR=Is,cR=t4,uR=Yu;function dR(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(4),a={fmt:r,env:e,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function fR(t,r,e){e.biffguess&&e.biff==5&&(e.biff=2);var n=Is(t);++t.l;var a=Go(t,r-7,e);return n.t="str",n.val=a,n}function hR(t){var r=Is(t);++t.l;var e=$n(t);return r.t="n",r.val=e,r}function pR(t){var r=Is(t);++t.l;var e=t.read_shift(2);return r.t="n",r.val=e,r}function mR(t){var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,"sbcs-cont")}function gR(t,r){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=r-13}function vR(t,r,e){var n=t.l+r,a=Is(t),o=t.read_shift(2),s=zo(t,o,e);return t.l=n,a.t="str",a.val=s,a}var bR=[2,3,48,49,131,139,140,245],D2=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Wm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(l,c){var i=[],u=eo(1);switch(c.type){case"base64":u=is(Ta(l));break;case"binary":u=is(l);break;case"buffer":case"array":u=l;break}On(u,0);var p=u.read_shift(1),f=!!(p&136),h=!1,v=!1;switch(p){case 2:break;case 3:break;case 48:h=!0,f=!0;break;case 49:h=!0,f=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var b=0,g=521;p==2&&(b=u.read_shift(2)),u.l+=3,p!=2&&(b=u.read_shift(4)),b>1048576&&(b=1e6),p!=2&&(g=u.read_shift(2));var x=u.read_shift(2),y=c.codepage||1252;p!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(y=t[u[u.l]]),u.l+=1,u.l+=2),v&&(u.l+=36);for(var k=[],N={},F=Math.min(u.length,p==2?521:g-10-(h?264:0)),B=v?32:11;u.l<F&&u[u.l]!=13;)switch(N={},N.name=ju.utils.decode(y,u.slice(u.l,u.l+B)).replace(/[\u0000\r\n].*$/g,""),u.l+=B,N.type=String.fromCharCode(u.read_shift(1)),p!=2&&!v&&(N.offset=u.read_shift(4)),N.len=u.read_shift(1),p==2&&(N.offset=u.read_shift(2)),N.dec=u.read_shift(1),N.name.length&&k.push(N),p!=2&&(u.l+=v?13:14),N.type){case"B":(!h||N.len!=8)&&c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var W=0,V=0;for(i[0]=[],V=0;V!=k.length;++V)i[0][V]=k[V].name;for(;b-- >0;){if(u[u.l]===42){u.l+=x;continue}for(++u.l,i[++W]=[],V=0,V=0;V!=k.length;++V){var q=u.slice(u.l,u.l+k[V].len);u.l+=k[V].len,On(q,0);var X=ju.utils.decode(y,q);switch(k[V].type){case"C":X.trim().length&&(i[W][V]=X.replace(/\s+$/,""));break;case"D":X.length===8?i[W][V]=new Date(+X.slice(0,4),+X.slice(4,6)-1,+X.slice(6,8)):i[W][V]=X;break;case"F":i[W][V]=parseFloat(X.trim());break;case"+":case"I":i[W][V]=v?q.read_shift(-4,"i")^2147483648:q.read_shift(4,"i");break;case"L":switch(X.trim().toUpperCase()){case"Y":case"T":i[W][V]=!0;break;case"N":case"F":i[W][V]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+X+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));i[W][V]="##MEMO##"+(v?parseInt(X.trim(),10):q.read_shift(4));break;case"N":X=X.replace(/\u0000/g,"").trim(),X&&X!="."&&(i[W][V]=+X||0);break;case"@":i[W][V]=new Date(q.read_shift(-8,"f")-621356832e5);break;case"T":i[W][V]=new Date((q.read_shift(4)-2440588)*864e5+q.read_shift(4));break;case"Y":i[W][V]=q.read_shift(4,"i")/1e4+q.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":i[W][V]=-q.read_shift(-8,"f");break;case"B":if(h&&k[V].len==8){i[W][V]=q.read_shift(8,"f");break}case"G":case"P":q.l+=k[V].len;break;case"0":if(k[V].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+k[V].type)}}}if(p!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(i=i.slice(0,c.sheetRows)),c.DBF=k,i}function n(l,c){var i=c||{};i.dateNF||(i.dateNF="yyyymmdd");var u=ac(e(l,i),i);return u["!cols"]=i.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete i.DBF,u}function a(l,c){try{return no(n(l,c),c)}catch(i){if(c&&c.WTF)throw i}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function s(l,c){var i=c||{};if(+i.codepage>=0&&ls(+i.codepage),i.type=="string")throw new Error("Cannot write DBF to JS string");var u=Qp(),p=lm(l,{header:1,raw:!0,cellDates:!0}),f=p[0],h=p.slice(1),v=l["!cols"]||[],b=0,g=0,x=0,y=1;for(b=0;b<f.length;++b){if(((v[b]||{}).DBF||{}).name){f[b]=v[b].DBF.name,++x;continue}if(f[b]!=null){if(++x,typeof f[b]=="number"&&(f[b]=f[b].toString(10)),typeof f[b]!="string")throw new Error("DBF Invalid column name "+f[b]+" |"+typeof f[b]+"|");if(f.indexOf(f[b])!==b){for(g=0;g<1024;++g)if(f.indexOf(f[b]+"_"+g)==-1){f[b]+="_"+g;break}}}}var k=Yr(l["!ref"]),N=[],F=[],B=[];for(b=0;b<=k.e.c-k.s.c;++b){var W="",V="",q=0,X=[];for(g=0;g<h.length;++g)h[g][b]!=null&&X.push(h[g][b]);if(X.length==0||f[b]==null){N[b]="?";continue}for(g=0;g<X.length;++g){switch(typeof X[g]){case"number":V="B";break;case"string":V="C";break;case"boolean":V="L";break;case"object":V=X[g]instanceof Date?"D":"C";break;default:V="C"}q=Math.max(q,String(X[g]).length),W=W&&W!=V?"C":V}q>250&&(q=250),V=((v[b]||{}).DBF||{}).type,V=="C"&&v[b].DBF.len>q&&(q=v[b].DBF.len),W=="B"&&V=="N"&&(W="N",B[b]=v[b].DBF.dec,q=v[b].DBF.len),F[b]=W=="C"||V=="N"?q:o[W]||0,y+=F[b],N[b]=W}var I=u.next(32);for(I.write_shift(4,318902576),I.write_shift(4,h.length),I.write_shift(2,296+32*x),I.write_shift(2,y),b=0;b<4;++b)I.write_shift(4,0);for(I.write_shift(4,0|(+r[o_]||3)<<8),b=0,g=0;b<f.length;++b)if(f[b]!=null){var H=u.next(32),O=(f[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);H.write_shift(1,O,"sbcs"),H.write_shift(1,N[b]=="?"?"C":N[b],"sbcs"),H.write_shift(4,g),H.write_shift(1,F[b]||o[N[b]]||0),H.write_shift(1,B[b]||0),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(1,0),H.write_shift(4,0),H.write_shift(4,0),g+=F[b]||o[N[b]]||0}var R=u.next(264);for(R.write_shift(4,13),b=0;b<65;++b)R.write_shift(4,0);for(b=0;b<h.length;++b){var C=u.next(y);for(C.write_shift(1,0),g=0;g<f.length;++g)if(f[g]!=null)switch(N[g]){case"L":C.write_shift(1,h[b][g]==null?63:h[b][g]?84:70);break;case"B":C.write_shift(8,h[b][g]||0,"f");break;case"N":var w="0";for(typeof h[b][g]=="number"&&(w=h[b][g].toFixed(B[g]||0)),x=0;x<F[g]-w.length;++x)C.write_shift(1,32);C.write_shift(1,w,"sbcs");break;case"D":h[b][g]?(C.write_shift(4,("0000"+h[b][g].getFullYear()).slice(-4),"sbcs"),C.write_shift(2,("00"+(h[b][g].getMonth()+1)).slice(-2),"sbcs"),C.write_shift(2,("00"+h[b][g].getDate()).slice(-2),"sbcs")):C.write_shift(8,"00000000","sbcs");break;case"C":var E=String(h[b][g]!=null?h[b][g]:"").slice(0,F[g]);for(C.write_shift(1,E,"sbcs"),x=0;x<F[g]-E.length;++x)C.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),xR=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Ds(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(f,h){var v=t[h];return typeof v=="number"?Yx(v):v},n=function(f,h,v){var b=h.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return b==59?f:Yx(b)};t["|"]=254;function a(f,h){switch(h.type){case"base64":return o(Ta(f),h);case"binary":return o(f,h);case"buffer":return o(fr&&Buffer.isBuffer(f)?f.toString("binary"):Vo(f),h);case"array":return o(Uo(f),h)}throw new Error("Unrecognized type "+h.type)}function o(f,h){var v=f.split(/[\n\r]+/),b=-1,g=-1,x=0,y=0,k=[],N=[],F=null,B={},W=[],V=[],q=[],X=0,I;for(+h.codepage>=0&&ls(+h.codepage);x!==v.length;++x){X=0;var H=v[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,e),O=H.replace(/;;/g,"\0").split(";").map(function(re){return re.replace(/\u0000/g,";")}),R=O[0],C;if(H.length>0)switch(R){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":O[1].charAt(0)=="P"&&N.push(H.slice(3).replace(/;;/g,";"));break;case"C":var w=!1,E=!1,A=!1,T=!1,D=-1,U=-1;for(y=1;y<O.length;++y)switch(O[y].charAt(0)){case"A":break;case"X":g=parseInt(O[y].slice(1))-1,E=!0;break;case"Y":for(b=parseInt(O[y].slice(1))-1,E||(g=0),I=k.length;I<=b;++I)k[I]=[];break;case"K":C=O[y].slice(1),C.charAt(0)==='"'?C=C.slice(1,C.length-1):C==="TRUE"?C=!0:C==="FALSE"?C=!1:isNaN(us(C))?isNaN(Zl(C).getDate())||(C=kn(C)):(C=us(C),F!==null&&rc(F)&&(C=Zf(C))),w=!0;break;case"E":T=!0;var P=Gl(O[y].slice(1),{r:b,c:g});k[b][g]=[k[b][g],P];break;case"S":A=!0,k[b][g]=[k[b][g],"S5S"];break;case"G":break;case"R":D=parseInt(O[y].slice(1))-1;break;case"C":U=parseInt(O[y].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+H)}if(w&&(k[b][g]&&k[b][g].length==2?k[b][g][0]=C:k[b][g]=C,F=null),A){if(T)throw new Error("SYLK shared formula cannot have own formula");var K=D>-1&&k[D][U];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");k[b][g][1]=b4(K[1],{r:b-D,c:g-U})}break;case"F":var Y=0;for(y=1;y<O.length;++y)switch(O[y].charAt(0)){case"X":g=parseInt(O[y].slice(1))-1,++Y;break;case"Y":for(b=parseInt(O[y].slice(1))-1,I=k.length;I<=b;++I)k[I]=[];break;case"M":X=parseInt(O[y].slice(1))/20;break;case"F":break;case"G":break;case"P":F=N[parseInt(O[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(q=O[y].slice(1).split(" "),I=parseInt(q[0],10);I<=parseInt(q[1],10);++I)X=parseInt(q[2],10),V[I-1]=X===0?{hidden:!0}:{wch:X},Jl(V[I-1]);break;case"C":g=parseInt(O[y].slice(1))-1,V[g]||(V[g]={});break;case"R":b=parseInt(O[y].slice(1))-1,W[b]||(W[b]={}),X>0?(W[b].hpt=X,W[b].hpx=Iu(X)):X===0&&(W[b].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+H)}Y<1&&(F=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+H)}}return W.length>0&&(B["!rows"]=W),V.length>0&&(B["!cols"]=V),h&&h.sheetRows&&(k=k.slice(0,h.sheetRows)),[k,B]}function s(f,h){var v=a(f,h),b=v[0],g=v[1],x=ac(b,h);return Ds(g).forEach(function(y){x[y]=g[y]}),x}function l(f,h){return no(s(f,h),h)}function c(f,h,v,b){var g="C;Y"+(v+1)+";X"+(b+1)+";K";switch(f.t){case"n":g+=f.v||0,f.f&&!f.F&&(g+=";E"+sF(f.f,{r:v,c:b}));break;case"b":g+=f.v?"TRUE":"FALSE";break;case"e":g+=f.w||f.v;break;case"d":g+='"'+(f.w||f.v)+'"';break;case"s":g+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function i(f,h){h.forEach(function(v,b){var g="F;W"+(b+1)+" "+(b+1)+" ";v.hidden?g+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=If(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Pf(v.wpx)),typeof v.wch=="number"&&(g+=Math.round(v.wch))),g.charAt(g.length-1)!=" "&&f.push(g)})}function u(f,h){h.forEach(function(v,b){var g="F;";v.hidden?g+="M0;":v.hpt?g+="M"+20*v.hpt+";":v.hpx&&(g+="M"+20*m4(v.hpx)+";"),g.length>2&&f.push(g+"R"+(b+1))})}function p(f,h){var v=["ID;PWXL;N;E"],b=[],g=Yr(f["!ref"]),x,y=Array.isArray(f),k=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),f["!cols"]&&i(v,f["!cols"]),f["!rows"]&&u(v,f["!rows"]),v.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var N=g.s.r;N<=g.e.r;++N)for(var F=g.s.c;F<=g.e.c;++F){var B=Qt({r:N,c:F});x=y?(f[N]||[])[F]:f[B],!(!x||x.v==null&&(!x.f||x.F))&&b.push(c(x,f,N,F))}return v.join(k)+k+b.join(k)+k+"E"+k}return{to_workbook:l,to_sheet:s,from_sheet:p}}(),yR=function(){function t(o,s){switch(s.type){case"base64":return r(Ta(o),s);case"binary":return r(o,s);case"buffer":return r(fr&&Buffer.isBuffer(o)?o.toString("binary"):Vo(o),s);case"array":return r(Uo(o),s)}throw new Error("Unrecognized type "+s.type)}function r(o,s){for(var l=o.split(`
`),c=-1,i=-1,u=0,p=[];u!==l.length;++u){if(l[u].trim()==="BOT"){p[++c]=[],i=0;continue}if(!(c<0)){var f=l[u].trim().split(","),h=f[0],v=f[1];++u;for(var b=l[u]||"";(b.match(/["]/g)||[]).length&1&&u<l.length-1;)b+=`
`+l[++u];switch(b=b.trim(),+h){case-1:if(b==="BOT"){p[++c]=[],i=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?p[c][i]=!0:b==="FALSE"?p[c][i]=!1:isNaN(us(v))?isNaN(Zl(v).getDate())?p[c][i]=v:p[c][i]=kn(v):p[c][i]=us(v),++i;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),p[c][i++]=b!==""?b:null;break}if(b==="EOD")break}}return s&&s.sheetRows&&(p=p.slice(0,s.sheetRows)),p}function e(o,s){return ac(t(o,s),s)}function n(o,s){return no(e(o,s),s)}var a=function(){var o=function(c,i,u,p,f){c.push(i),c.push(u+","+p),c.push('"'+f.replace(/"/g,'""')+'"')},s=function(c,i,u,p){c.push(i+","+u),c.push(i==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(c){var i=[],u=Yr(c["!ref"]),p,f=Array.isArray(c);o(i,"TABLE",0,1,"sheetjs"),o(i,"VECTORS",0,u.e.r-u.s.r+1,""),o(i,"TUPLES",0,u.e.c-u.s.c+1,""),o(i,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){s(i,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var b=Qt({r:h,c:v});if(p=f?(c[h]||[])[v]:c[b],!p){s(i,1,0,"");continue}switch(p.t){case"n":var g=p.w;!g&&p.v!=null&&(g=p.v),g==null?p.f&&!p.F?s(i,1,0,"="+p.f):s(i,1,0,""):s(i,0,g,"V");break;case"b":s(i,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":s(i,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Ha(p.z||rr[14],ta(kn(p.v)))),s(i,0,p.w,"V");break;default:s(i,1,0,"")}}}s(i,-1,0,"EOD");var x=`\r
`,y=i.join(x);return y}}();return{to_workbook:n,to_sheet:e,from_sheet:a}}(),wR=function(){function t(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(p,f){for(var h=p.split(`
`),v=-1,b=-1,g=0,x=[];g!==h.length;++g){var y=h[g].trim().split(":");if(y[0]==="cell"){var k=Qn(y[1]);if(x.length<=k.r)for(v=x.length;v<=k.r;++v)x[v]||(x[v]=[]);switch(v=k.r,b=k.c,y[2]){case"t":x[v][b]=t(y[3]);break;case"v":x[v][b]=+y[3];break;case"vtf":var N=y[y.length-1];case"vtc":switch(y[3]){case"nl":x[v][b]=!!+y[4];break;default:x[v][b]=+y[4];break}y[2]=="vtf"&&(x[v][b]=[x[v][b],N])}}}return f&&f.sheetRows&&(x=x.slice(0,f.sheetRows)),x}function n(p,f){return ac(e(p,f),f)}function a(p,f){return no(n(p,f),f)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function i(p){if(!p||!p["!ref"])return"";for(var f=[],h=[],v,b="",g=nc(p["!ref"]),x=Array.isArray(p),y=g.s.r;y<=g.e.r;++y)for(var k=g.s.c;k<=g.e.c;++k)if(b=Qt({r:y,c:k}),v=x?(p[y]||[])[k]:p[b],!(!v||v.v==null||v.t==="z")){switch(h=["cell",b,"t"],v.t){case"s":case"str":h.push(r(v.v));break;case"n":v.f?(h[2]="vtf",h[3]="n",h[4]=v.v,h[5]=r(v.f)):(h[2]="v",h[3]=v.v);break;case"b":h[2]="vt"+(v.f?"f":"c"),h[3]="nl",h[4]=v.v?"1":"0",h[5]=r(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var N=ta(kn(v.v));h[2]="vtc",h[3]="nd",h[4]=""+N,h[5]=v.w||Ha(v.z||rr[14],N);break;case"e":continue}f.push(h.join(":"))}return f.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(p){return[o,s,l,s,i(p),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),Mu=function(){function t(u,p,f,h,v){v.raw?p[f][h]=u:u===""||(u==="TRUE"?p[f][h]=!0:u==="FALSE"?p[f][h]=!1:isNaN(us(u))?isNaN(Zl(u).getDate())?p[f][h]=u:p[f][h]=kn(u):p[f][h]=us(u))}function r(u,p){var f=p||{},h=[];if(!u||u.length===0)return h;for(var v=u.split(/[\r\n]/),b=v.length-1;b>=0&&v[b].length===0;)--b;for(var g=10,x=0,y=0;y<=b;++y)x=v[y].indexOf(" "),x==-1?x=v[y].length:x++,g=Math.max(g,x);for(y=0;y<=b;++y){h[y]=[];var k=0;for(t(v[y].slice(0,g).trim(),h,y,k,f),k=1;k<=(v[y].length-g)/10+1;++k)t(v[y].slice(g+(k-1)*10,g+k*10).trim(),h,y,k,f)}return f.sheetRows&&(h=h.slice(0,f.sheetRows)),h}var e={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var p={},f=!1,h=0,v=0;h<u.length;++h)(v=u.charCodeAt(h))==34?f=!f:!f&&v in e&&(p[v]=(p[v]||0)+1);v=[];for(h in p)Object.prototype.hasOwnProperty.call(p,h)&&v.push([p[h],h]);if(!v.length){p=n;for(h in p)Object.prototype.hasOwnProperty.call(p,h)&&v.push([p[h],h])}return v.sort(function(b,g){return b[0]-g[0]||n[b[1]]-n[g[1]]}),e[v.pop()[1]]||44}function o(u,p){var f=p||{},h="",v=f.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=a(u.slice(0,1024)):f&&f.FS?h=f.FS:h=a(u.slice(0,1024));var g=0,x=0,y=0,k=0,N=0,F=h.charCodeAt(0),B=!1,W=0,V=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var q=f.dateNF!=null?Dj(f.dateNF):null;function X(){var I=u.slice(k,N),H={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)H.t="z";else if(f.raw)H.t="s",H.v=I;else if(I.trim().length===0)H.t="s",H.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(H.t="s",H.v=I.slice(2,-1).replace(/""/g,'"')):oF(I)?(H.t="n",H.f=I.slice(1)):(H.t="s",H.v=I);else if(I=="TRUE")H.t="b",H.v=!0;else if(I=="FALSE")H.t="b",H.v=!1;else if(!isNaN(y=us(I)))H.t="n",f.cellText!==!1&&(H.w=I),H.v=y;else if(!isNaN(Zl(I).getDate())||q&&I.match(q)){H.z=f.dateNF||rr[14];var O=0;q&&I.match(q)&&(I=Rj(I,f.dateNF,I.match(q)||[]),O=1),f.cellDates?(H.t="d",H.v=kn(I,O)):(H.t="n",H.v=ta(kn(I,O))),f.cellText!==!1&&(H.w=Ha(H.z,H.v instanceof Date?ta(H.v):H.v)),f.cellNF||delete H.z}else H.t="s",H.v=I;if(H.t=="z"||(f.dense?(v[g]||(v[g]=[]),v[g][x]=H):v[Qt({c:x,r:g})]=H),k=N+1,V=u.charCodeAt(k),b.e.c<x&&(b.e.c=x),b.e.r<g&&(b.e.r=g),W==F)++x;else if(x=0,++g,f.sheetRows&&f.sheetRows<=g)return!0}e:for(;N<u.length;++N)switch(W=u.charCodeAt(N)){case 34:V===34&&(B=!B);break;case F:case 10:case 13:if(!B&&X())break e;break}return N-k>0&&X(),v["!ref"]=mr(b),v}function s(u,p){return!(p&&p.PRN)||p.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?o(u,p):ac(r(u,p),p)}function l(u,p){var f="",h=p.type=="string"?[0,0,0,0]:d1(u,p);switch(p.type){case"base64":f=Ta(u);break;case"binary":f=u;break;case"buffer":p.codepage==65001?f=u.toString("utf8"):p.codepage&&typeof ju<"u"||(f=fr&&Buffer.isBuffer(u)?u.toString("binary"):Vo(u));break;case"array":f=Uo(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+p.type)}return h[0]==239&&h[1]==187&&h[2]==191?f=Ir(f.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?f=Ir(f):p.type=="binary"&&typeof ju<"u",f.slice(0,19)=="socialcalc:version:"?wR.to_sheet(p.type=="string"?f:Ir(f),p):s(f,p)}function c(u,p){return no(l(u,p),p)}function i(u){for(var p=[],f=Yr(u["!ref"]),h,v=Array.isArray(u),b=f.s.r;b<=f.e.r;++b){for(var g=[],x=f.s.c;x<=f.e.c;++x){var y=Qt({r:b,c:x});if(h=v?(u[b]||[])[x]:u[y],!h||h.v==null){g.push("          ");continue}for(var k=(h.w||(ii(h),h.w)||"").slice(0,10);k.length<10;)k+=" ";g.push(k+(x===0?" ":""))}p.push(g.join(""))}return p.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:i}}();function _R(t,r){var e=r||{},n=!!e.WTF;e.WTF=!0;try{var a=xR.to_workbook(t,e);return e.WTF=n,a}catch(o){if(e.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return Mu.to_workbook(t,r)}}var mu=function(){function t(P,K,Y){if(P){On(P,P.l||0);for(var re=Y.Enum||D;P.l<P.length;){var z=P.read_shift(2),ee=re[z]||re[65535],L=P.read_shift(2),M=P.l+L,Z=ee.f&&ee.f(P,L,Y);if(P.l=M,K(Z,ee,z))return}}}function r(P,K){switch(K.type){case"base64":return e(is(Ta(P)),K);case"binary":return e(is(P),K);case"buffer":case"array":return e(P,K)}throw"Unsupported type "+K.type}function e(P,K){if(!P)return P;var Y=K||{},re=Y.dense?[]:{},z="Sheet1",ee="",L=0,M={},Z=[],se=[],ae={s:{r:0,c:0},e:{r:0,c:0}},ne=Y.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)Y.Enum=D,t(P,function(te,ce,he){switch(he){case 0:Y.vers=te,te>=4096&&(Y.qpro=!0);break;case 6:ae=te;break;case 204:te&&(ee=te);break;case 222:ee=te;break;case 15:case 51:Y.qpro||(te[1].v=te[1].v.slice(1));case 13:case 14:case 16:he==14&&(te[2]&112)==112&&(te[2]&15)>1&&(te[2]&15)<15&&(te[1].z=Y.dateNF||rr[14],Y.cellDates&&(te[1].t="d",te[1].v=Zf(te[1].v))),Y.qpro&&te[3]>L&&(re["!ref"]=mr(ae),M[z]=re,Z.push(z),re=Y.dense?[]:{},ae={s:{r:0,c:0},e:{r:0,c:0}},L=te[3],z=ee||"Sheet"+(L+1),ee="");var Ee=Y.dense?(re[te[0].r]||[])[te[0].c]:re[Qt(te[0])];if(Ee){Ee.t=te[1].t,Ee.v=te[1].v,te[1].z!=null&&(Ee.z=te[1].z),te[1].f!=null&&(Ee.f=te[1].f);break}Y.dense?(re[te[0].r]||(re[te[0].r]=[]),re[te[0].r][te[0].c]=te[1]):re[Qt(te[0])]=te[1];break}},Y);else if(P[2]==26||P[2]==14)Y.Enum=U,P[2]==14&&(Y.qpro=!0,P.l=0),t(P,function(te,ce,he){switch(he){case 204:z=te;break;case 22:te[1].v=te[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(te[3]>L&&(re["!ref"]=mr(ae),M[z]=re,Z.push(z),re=Y.dense?[]:{},ae={s:{r:0,c:0},e:{r:0,c:0}},L=te[3],z="Sheet"+(L+1)),ne>0&&te[0].r>=ne)break;Y.dense?(re[te[0].r]||(re[te[0].r]=[]),re[te[0].r][te[0].c]=te[1]):re[Qt(te[0])]=te[1],ae.e.c<te[0].c&&(ae.e.c=te[0].c),ae.e.r<te[0].r&&(ae.e.r=te[0].r);break;case 27:te[14e3]&&(se[te[14e3][0]]=te[14e3][1]);break;case 1537:se[te[0]]=te[1],te[0]==L&&(z=te[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(re["!ref"]=mr(ae),M[ee||z]=re,Z.push(ee||z),!se.length)return{SheetNames:Z,Sheets:M};for(var Q={},fe=[],le=0;le<se.length;++le)M[Z[le]]?(fe.push(se[le]||Z[le]),Q[se[le]]=M[se[le]]||M[Z[le]]):(fe.push(se[le]),Q[se[le]]={"!ref":"A1"});return{SheetNames:fe,Sheets:Q}}function n(P,K){var Y=K||{};if(+Y.codepage>=0&&ls(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var re=Qp(),z=Yr(P["!ref"]),ee=Array.isArray(P),L=[];rs(re,0,o(1030)),rs(re,6,c(z));for(var M=Math.min(z.e.r,8191),Z=z.s.r;Z<=M;++Z)for(var se=Mn(Z),ae=z.s.c;ae<=z.e.c;++ae){Z===z.s.r&&(L[ae]=bn(ae));var ne=L[ae]+se,Q=ee?(P[Z]||[])[ae]:P[ne];if(!(!Q||Q.t=="z"))if(Q.t=="n")(Q.v|0)==Q.v&&Q.v>=-32768&&Q.v<=32767?rs(re,13,h(Z,ae,Q.v)):rs(re,14,b(Z,ae,Q.v));else{var fe=ii(Q);rs(re,15,p(Z,ae,fe.slice(0,239)))}}return rs(re,1),re.end()}function a(P,K){var Y=K||{};if(+Y.codepage>=0&&ls(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var re=Qp();rs(re,0,s(P));for(var z=0,ee=0;z<P.SheetNames.length;++z)(P.Sheets[P.SheetNames[z]]||{})["!ref"]&&rs(re,27,T(P.SheetNames[z],ee++));var L=0;for(z=0;z<P.SheetNames.length;++z){var M=P.Sheets[P.SheetNames[z]];if(!(!M||!M["!ref"])){for(var Z=Yr(M["!ref"]),se=Array.isArray(M),ae=[],ne=Math.min(Z.e.r,8191),Q=Z.s.r;Q<=ne;++Q)for(var fe=Mn(Q),le=Z.s.c;le<=Z.e.c;++le){Q===Z.s.r&&(ae[le]=bn(le));var te=ae[le]+fe,ce=se?(M[Q]||[])[le]:M[te];if(!(!ce||ce.t=="z"))if(ce.t=="n")rs(re,23,X(Q,le,L,ce.v));else{var he=ii(ce);rs(re,22,W(Q,le,L,he.slice(0,239)))}}++L}}return rs(re,1),re.end()}function o(P){var K=vn(2);return K.write_shift(2,P),K}function s(P){var K=vn(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var Y=0,re=0,z=0,ee=0;ee<P.SheetNames.length;++ee){var L=P.SheetNames[ee],M=P.Sheets[L];if(!(!M||!M["!ref"])){++z;var Z=nc(M["!ref"]);Y<Z.e.r&&(Y=Z.e.r),re<Z.e.c&&(re=Z.e.c)}}return Y>8191&&(Y=8191),K.write_shift(2,Y),K.write_shift(1,z),K.write_shift(1,re),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function l(P,K,Y){var re={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&Y.qpro?(re.s.c=P.read_shift(1),P.l++,re.s.r=P.read_shift(2),re.e.c=P.read_shift(1),P.l++,re.e.r=P.read_shift(2),re):(re.s.c=P.read_shift(2),re.s.r=P.read_shift(2),K==12&&Y.qpro&&(P.l+=2),re.e.c=P.read_shift(2),re.e.r=P.read_shift(2),K==12&&Y.qpro&&(P.l+=2),re.s.c==65535&&(re.s.c=re.e.c=re.s.r=re.e.r=0),re)}function c(P){var K=vn(8);return K.write_shift(2,P.s.c),K.write_shift(2,P.s.r),K.write_shift(2,P.e.c),K.write_shift(2,P.e.r),K}function i(P,K,Y){var re=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(re[0].c=P.read_shift(1),re[3]=P.read_shift(1),re[0].r=P.read_shift(2),P.l+=2):(re[2]=P.read_shift(1),re[0].c=P.read_shift(2),re[0].r=P.read_shift(2)),re}function u(P,K,Y){var re=P.l+K,z=i(P,K,Y);if(z[1].t="s",Y.vers==20768){P.l++;var ee=P.read_shift(1);return z[1].v=P.read_shift(ee,"utf8"),z}return Y.qpro&&P.l++,z[1].v=P.read_shift(re-P.l,"cstr"),z}function p(P,K,Y){var re=vn(7+Y.length);re.write_shift(1,255),re.write_shift(2,K),re.write_shift(2,P),re.write_shift(1,39);for(var z=0;z<re.length;++z){var ee=Y.charCodeAt(z);re.write_shift(1,ee>=128?95:ee)}return re.write_shift(1,0),re}function f(P,K,Y){var re=i(P,K,Y);return re[1].v=P.read_shift(2,"i"),re}function h(P,K,Y){var re=vn(7);return re.write_shift(1,255),re.write_shift(2,K),re.write_shift(2,P),re.write_shift(2,Y,"i"),re}function v(P,K,Y){var re=i(P,K,Y);return re[1].v=P.read_shift(8,"f"),re}function b(P,K,Y){var re=vn(13);return re.write_shift(1,255),re.write_shift(2,K),re.write_shift(2,P),re.write_shift(8,Y,"f"),re}function g(P,K,Y){var re=P.l+K,z=i(P,K,Y);if(z[1].v=P.read_shift(8,"f"),Y.qpro)P.l=re;else{var ee=P.read_shift(2);N(P.slice(P.l,P.l+ee),z),P.l+=ee}return z}function x(P,K,Y){var re=K&32768;return K&=-32769,K=(re?P:0)+(K>=8192?K-16384:K),(re?"":"$")+(Y?bn(K):Mn(K))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},k=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(P,K){On(P,0);for(var Y=[],re=0,z="",ee="",L="",M="";P.l<P.length;){var Z=P[P.l++];switch(Z){case 0:Y.push(P.read_shift(8,"f"));break;case 1:ee=x(K[0].c,P.read_shift(2),!0),z=x(K[0].r,P.read_shift(2),!1),Y.push(ee+z);break;case 2:{var se=x(K[0].c,P.read_shift(2),!0),ae=x(K[0].r,P.read_shift(2),!1);ee=x(K[0].c,P.read_shift(2),!0),z=x(K[0].r,P.read_shift(2),!1),Y.push(se+ae+":"+ee+z)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(P.read_shift(2));break;case 6:{for(var ne="";Z=P[P.l++];)ne+=String.fromCharCode(Z);Y.push('"'+ne.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:M=Y.pop(),L=Y.pop(),Y.push(["AND","OR"][Z-20]+"("+L+","+M+")");break;default:if(Z<32&&k[Z])M=Y.pop(),L=Y.pop(),Y.push(L+k[Z]+M);else if(y[Z]){if(re=y[Z][1],re==69&&(re=P[P.l++]),re>Y.length){console.error("WK1 bad formula parse 0x"+Z.toString(16)+":|"+Y.join("|")+"|");return}var Q=Y.slice(-re);Y.length-=re,Y.push(y[Z][0]+"("+Q.join(",")+")")}else return Z<=7?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=24?console.error("WK1 unsupported op "+Z.toString(16)):Z<=30?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=115?console.error("WK1 unsupported function opcode "+Z.toString(16)):console.error("WK1 unrecognized opcode "+Z.toString(16))}}Y.length==1?K[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function F(P){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=P.read_shift(2),K[3]=P[P.l++],K[0].c=P[P.l++],K}function B(P,K){var Y=F(P);return Y[1].t="s",Y[1].v=P.read_shift(K-4,"cstr"),Y}function W(P,K,Y,re){var z=vn(6+re.length);z.write_shift(2,P),z.write_shift(1,Y),z.write_shift(1,K),z.write_shift(1,39);for(var ee=0;ee<re.length;++ee){var L=re.charCodeAt(ee);z.write_shift(1,L>=128?95:L)}return z.write_shift(1,0),z}function V(P,K){var Y=F(P);Y[1].v=P.read_shift(2);var re=Y[1].v>>1;if(Y[1].v&1)switch(re&7){case 0:re=(re>>3)*5e3;break;case 1:re=(re>>3)*500;break;case 2:re=(re>>3)/20;break;case 3:re=(re>>3)/200;break;case 4:re=(re>>3)/2e3;break;case 5:re=(re>>3)/2e4;break;case 6:re=(re>>3)/16;break;case 7:re=(re>>3)/64;break}return Y[1].v=re,Y}function q(P,K){var Y=F(P),re=P.read_shift(4),z=P.read_shift(4),ee=P.read_shift(2);if(ee==65535)return re===0&&z===3221225472?(Y[1].t="e",Y[1].v=15):re===0&&z===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var L=ee&32768;return ee=(ee&32767)-16446,Y[1].v=(1-L*2)*(z*Math.pow(2,ee+32)+re*Math.pow(2,ee)),Y}function X(P,K,Y,re){var z=vn(14);if(z.write_shift(2,P),z.write_shift(1,Y),z.write_shift(1,K),re==0)return z.write_shift(4,0),z.write_shift(4,0),z.write_shift(2,65535),z;var ee=0,L=0,M=0,Z=0;return re<0&&(ee=1,re=-re),L=Math.log2(re)|0,re/=Math.pow(2,L-31),Z=re>>>0,(Z&2147483648)==0&&(re/=2,++L,Z=re>>>0),re-=Z,Z|=2147483648,Z>>>=0,re*=Math.pow(2,32),M=re>>>0,z.write_shift(4,M),z.write_shift(4,Z),L+=16383+(ee?32768:0),z.write_shift(2,L),z}function I(P,K){var Y=q(P);return P.l+=K-14,Y}function H(P,K){var Y=F(P),re=P.read_shift(4);return Y[1].v=re>>6,Y}function O(P,K){var Y=F(P),re=P.read_shift(8,"f");return Y[1].v=re,Y}function R(P,K){var Y=O(P);return P.l+=K-10,Y}function C(P,K){return P[P.l+K-1]==0?P.read_shift(K,"cstr"):""}function w(P,K){var Y=P[P.l++];Y>K-1&&(Y=K-1);for(var re="";re.length<Y;)re+=String.fromCharCode(P[P.l++]);return re}function E(P,K,Y){if(!(!Y.qpro||K<21)){var re=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var z=P.read_shift(K-21,"cstr");return[re,z]}}function A(P,K){for(var Y={},re=P.l+K;P.l<re;){var z=P.read_shift(2);if(z==14e3){for(Y[z]=[0,""],Y[z][0]=P.read_shift(2);P[P.l];)Y[z][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return Y}function T(P,K){var Y=vn(5+P.length);Y.write_shift(2,14e3),Y.write_shift(2,K);for(var re=0;re<P.length;++re){var z=P.charCodeAt(re);Y[Y.l++]=z>127?95:z}return Y[Y.l++]=0,Y}var D={0:{n:"BOF",f:ln},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:C},222:{n:"SHEETNAMELP",f:w},65535:{n:""}},U={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:q},24:{n:"NUMBER18",f:V},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:A},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:H},38:{n:"??"},39:{n:"NUMBER27",f:O},40:{n:"FORMULA28",f:R},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:C},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:E},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:r}}();function SR(t){var r={},e=t.match(Wn),n=0,a=!1;if(e)for(;n!=e.length;++n){var o=Jt(e[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;r.cp=zm[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=o.val;break;case"<sz":r.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":o.rgb&&(r.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return r}var kR=function(){var t=Du("t"),r=Du("rPr");function e(o){var s=o.match(t);if(!s)return{t:"s",v:""};var l={t:"s",v:xr(s[1])},c=o.match(r);return c&&(l.s=SR(c[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(e).filter(function(l){return l.v})}}(),ER=function(){var r=/(\r\n|\n)/g;function e(a,o,s){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),o.push('<span style="'+l.join("")+'">'),a.b&&(o.push("<b>"),s.push("</b>")),a.i&&(o.push("<i>"),s.push("</i>")),a.strike&&(o.push("<s>"),s.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(o.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),a}function n(a){var o=[[],a.v,[]];return a.v?(a.s&&e(a.s,o[0],o[2]),o[0].join("")+o[1].replace(r,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}}(),TR=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,AR=/<(?:\w+:)?r>/,CR=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function a1(t,r){var e=r?r.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=xr(Ir(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ir(t),e&&(n.h=Ym(n.t))):t.match(AR)&&(n.r=Ir(t),n.t=xr(Ir((t.replace(CR,"").match(TR)||[]).join("").replace(Wn,""))),e&&(n.h=ER(kR(n.r)))),n):{t:""}}var NR=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,jR=/<(?:\w+:)?(?:si|sstItem)>/g,OR=/<\/(?:\w+:)?(?:si|sstItem)>/;function DR(t,r){var e=[],n="";if(!t)return e;var a=t.match(NR);if(a){n=a[2].replace(jR,"").split(OR);for(var o=0;o!=n.length;++o){var s=a1(n[o].trim(),r);s!=null&&(e[e.length]=s)}a=Jt(a[1]),e.Count=a.count,e.Unique=a.uniqueCount}return e}function RR(t){return[t.read_shift(4),t.read_shift(4)]}function MR(t,r){var e=[],n=!1;return ci(t,function(o,s,l){switch(l){case 159:e.Count=o[0],e.Unique=o[1];break;case 19:e.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),e}function c4(t){for(var r=[],e=t.split(""),n=0;n<e.length;++n)r[n]=e[n].charCodeAt(0);return r}function si(t,r){var e={};return e.Major=t.read_shift(2),e.Minor=t.read_shift(2),r>=4&&(t.l+=r-4),e}function FR(t){var r={};return r.id=t.read_shift(0,"lpp4"),r.R=si(t,4),r.U=si(t,4),r.W=si(t,4),r}function IR(t){for(var r=t.read_shift(4),e=t.l+r-4,n={},a=t.read_shift(4),o=[];a-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=o,t.l!=e)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+e);return n}function PR(t){var r=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)r.push(IR(t));return r}function LR(t){var r=[];t.l+=4;for(var e=t.read_shift(4);e-- >0;)r.push(t.read_shift(0,"lpp4"));return r}function BR(t){var r={};return t.read_shift(4),t.l+=4,r.id=t.read_shift(0,"lpp4"),r.name=t.read_shift(0,"lpp4"),r.R=si(t,4),r.U=si(t,4),r.W=si(t,4),r}function UR(t){var r=BR(t);if(r.ename=t.read_shift(0,"8lpp4"),r.blksz=t.read_shift(4),r.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function u4(t,r){var e=t.l+r,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(e-t.l>>1,"utf16le"),t.l=e,n}function d4(t,r){var e={},n=t.l+r;return t.l+=4,e.Salt=t.slice(t.l,t.l+16),t.l+=16,e.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),e.VerifierHash=t.slice(t.l,n),t.l=n,e}function zR(t){var r=si(t);switch(r.Minor){case 2:return[r.Minor,$R(t)];case 3:return[r.Minor,VR()];case 4:return[r.Minor,HR(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function $R(t){var r=t.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var e=t.read_shift(4),n=u4(t,e),a=d4(t,t.length-t.l);return{t:"Std",h:n,v:a}}function VR(){throw new Error("File is password-protected: ECMA-376 Extensible")}function HR(t){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var e=t.read_shift(t.length-t.l,"utf8"),n={};return e.replace(Wn,function(o){var s=Jt(o);switch(Fs(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(l){n[l]=s[l]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function qR(t,r){var e={},n=e.EncryptionVersionInfo=si(t,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);e.Flags=t.read_shift(4),r-=4;var a=t.read_shift(4);return r-=4,e.EncryptionHeader=u4(t,a),r-=a,e.EncryptionVerifier=d4(t,r),e}function WR(t){var r={},e=r.EncryptionVersionInfo=si(t,4);if(e.Major!=1||e.Minor!=1)throw"unrecognized version code "+e.Major+" : "+e.Minor;return r.Salt=t.read_shift(16),r.EncryptedVerifier=t.read_shift(16),r.EncryptedVerifierHash=t.read_shift(16),r}function GR(t){var r=0,e,n=c4(t),a=n.length+1,o,s,l,c,i;for(e=eo(a),e[0]=n.length,o=1;o!=a;++o)e[o]=n[o-1];for(o=a-1;o>=0;--o)s=e[o],l=(r&16384)===0?0:1,c=r<<1&32767,i=l|c,r=i^s;return r^52811}var f4=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,l){return n(s^l)},o=function(s){for(var l=r[s.length-1],c=104,i=s.length-1;i>=0;--i)for(var u=s[i],p=0;p!=7;++p)u&64&&(l^=e[c]),u*=2,--c;return l};return function(s){for(var l=c4(s),c=o(l),i=l.length,u=eo(16),p=0;p!=16;++p)u[p]=0;var f,h,v;for((i&1)===1&&(f=c>>8,u[i]=a(t[0],f),--i,f=c&255,h=l[l.length-1],u[i]=a(h,f));i>0;)--i,f=c>>8,u[i]=a(l[i],f),--i,f=c&255,u[i]=a(l[i],f);for(i=15,v=15-l.length;v>0;)f=c>>8,u[i]=a(t[v],f),--i,--v,f=c&255,u[i]=a(l[i],f),--i,--v;return u}}(),YR=function(t,r,e,n,a){a||(a=r),n||(n=f4(t));var o,s;for(o=0;o!=r.length;++o)s=r[o],s^=n[e],s=(s>>5|s<<3)&255,a[o]=s,++e;return[a,e,n]},XR=function(t){var r=0,e=f4(t);return function(n){var a=YR("",n,r,e);return r=a[1],a[0]}};function KR(t,r,e,n){var a={key:ln(t),verificationBytes:ln(t)};return e.password&&(a.verifier=GR(e.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=XR(e.password)),a}function ZR(t,r,e){var n=e||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=WR(t):n.Data=qR(t,r),n}function JR(t,r,e){var n={Type:e.biff>=8?t.read_shift(2):0};return n.Type?ZR(t,r-2,n):KR(t,e.biff>=8?r:r-2,e,n),n}var QR=function(){function t(a,o){switch(o.type){case"base64":return r(Ta(a),o);case"binary":return r(a,o);case"buffer":return r(fr&&Buffer.isBuffer(a)?a.toString("binary"):Vo(a),o);case"array":return r(Uo(a),o)}throw new Error("Unrecognized type "+o.type)}function r(a,o){var s=o||{},l=s.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var i={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,p){Array.isArray(l)&&(l[p]=[]);for(var f=/\\\w+\b/g,h=0,v,b=-1;v=f.exec(u);){switch(v[0]){case"\\cell":var g=u.slice(h,f.lastIndex-v[0].length);if(g[0]==" "&&(g=g.slice(1)),++b,g.length){var x={v:g,t:"s"};Array.isArray(l)?l[p][b]=x:l[Qt({r:p,c:b})]=x}break}h=f.lastIndex}b>i.e.c&&(i.e.c=b)}),l["!ref"]=mr(i),l}function e(a,o){return no(t(a,o),o)}function n(a){for(var o=["{\\rtf1\\ansi"],s=Yr(a["!ref"]),l,c=Array.isArray(a),i=s.s.r;i<=s.e.r;++i){o.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)o.push("\\cellx"+(u+1));for(o.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var p=Qt({r:i,c:u});l=c?(a[i]||[])[u]:a[p],!(!l||l.v==null&&(!l.f||l.F))&&(o.push(" "+(l.w||(ii(l),l.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:e,to_sheet:t,from_sheet:n}}();function eM(t){var r=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Fu(t){for(var r=0,e=1;r!=3;++r)e=e*256+(t[r]>255?255:t[r]<0?0:t[r]);return e.toString(16).toUpperCase().slice(1)}function tM(t){var r=t[0]/255,e=t[1]/255,n=t[2]/255,a=Math.max(r,e,n),o=Math.min(r,e,n),s=a-o;if(s===0)return[0,0,r];var l=0,c=0,i=a+o;switch(c=s/(i>1?2-i:i),a){case r:l=((e-n)/s+6)%6;break;case e:l=(n-r)/s+2;break;case n:l=(r-e)/s+4;break}return[l/6,c,i/2]}function rM(t){var r=t[0],e=t[1],n=t[2],a=e*2*(n<.5?n:1-n),o=n-a/2,s=[o,o,o],l=6*r,c;if(e!==0)switch(l|0){case 0:case 6:c=a*l,s[0]+=a,s[1]+=c;break;case 1:c=a*(2-l),s[0]+=c,s[1]+=a;break;case 2:c=a*(l-2),s[1]+=a,s[2]+=c;break;case 3:c=a*(4-l),s[1]+=c,s[2]+=a;break;case 4:c=a*(l-4),s[2]+=a,s[0]+=c;break;case 5:c=a*(6-l),s[2]+=c,s[0]+=a;break}for(var i=0;i!=3;++i)s[i]=Math.round(s[i]*255);return s}function Ff(t,r){if(r===0)return t;var e=tM(eM(t));return r<0?e[2]=e[2]*(1+r):e[2]=1-(1-e[2])*(1-r),Fu(rM(e))}var h4=6,nM=15,aM=1,Zn=h4;function If(t){return Math.floor((t+Math.round(128/Zn)/256)*Zn)}function Pf(t){return Math.floor((t-5)/Zn*100+.5)/100}function nm(t){return Math.round((t*Zn+5)/Zn*256)/256}function Sp(t){return nm(Pf(If(t)))}function s1(t){var r=Math.abs(t-Sp(t)),e=Zn;if(r>.005)for(Zn=aM;Zn<nM;++Zn)Math.abs(t-Sp(t))<=r&&(r=Math.abs(t-Sp(t)),e=Zn);Zn=e}function Jl(t){t.width?(t.wpx=If(t.width),t.wch=Pf(t.wpx),t.MDW=Zn):t.wpx?(t.wch=Pf(t.wpx),t.width=nm(t.wch),t.MDW=Zn):typeof t.wch=="number"&&(t.width=nm(t.wch),t.wpx=If(t.width),t.MDW=Zn),t.customWidth&&delete t.customWidth}var sM=96,p4=sM;function m4(t){return t*96/p4}function Iu(t){return t*p4/96}var iM={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function oM(t,r,e,n){r.Borders=[];var a={},o=!1;(t[0].match(Wn)||[]).forEach(function(s){var l=Jt(s);switch(Fs(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=Br(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=Br(l.diagonalDown)),r.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+l[0]+" in borders")}})}function lM(t,r,e,n){r.Fills=[];var a={},o=!1;(t[0].match(Wn)||[]).forEach(function(s){var l=Jt(s);switch(Fs(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},r.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+l[0]+" in fills")}})}function cM(t,r,e,n){r.Fonts=[];var a={},o=!1;(t[0].match(Wn)||[]).forEach(function(s){var l=Jt(s);switch(Fs(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=Ir(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?Br(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?Br(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?Br(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?Br(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?Br(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?Br(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?Br(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=zm[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=Br(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var c=Lo[a.color.index];a.color.index==81&&(c=Lo[1]),c||(c=Lo[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&e.themeElements&&e.themeElements.clrScheme&&(a.color.rgb=Ff(e.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+l[0]+" in fonts")}})}function uM(t,r,e){r.NumberFmt=[];for(var n=Ds(rr),a=0;a<n.length;++a)r.NumberFmt[n[a]]=rr[n[a]];var o=t[0].match(Wn);if(o)for(a=0;a<o.length;++a){var s=Jt(o[a]);switch(Fs(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=xr(Ir(s.formatCode)),c=parseInt(s.numFmtId,10);if(r.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&r.NumberFmt[c]!=null;--c);r.NumberFmt[c]=l}Po(l,c)}}break;case"</numFmt>":break;default:if(e.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var xf=["numFmtId","fillId","fontId","borderId","xfId"],yf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function dM(t,r,e){r.CellXf=[];var n,a=!1;(t[0].match(Wn)||[]).forEach(function(o){var s=Jt(o),l=0;switch(Fs(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],l=0;l<xf.length;++l)n[xf[l]]&&(n[xf[l]]=parseInt(n[xf[l]],10));for(l=0;l<yf.length;++l)n[yf[l]]&&(n[yf[l]]=Br(n[yf[l]]));if(r.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[l]){n.numFmtId=l;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=Br(s.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(e&&e.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var fM=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,i){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=l.match(r))&&uM(p,u,i),(p=l.match(a))&&cM(p,u,c,i),(p=l.match(n))&&lM(p,u,c,i),(p=l.match(o))&&oM(p,u,c,i),(p=l.match(e))&&dM(p,u,i),u}}();function hM(t,r){var e=t.read_shift(2),n=Hn(t);return[e,n]}function pM(t,r,e){var n={};n.sz=t.read_shift(2)/20;var a=kO(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var o=t.read_shift(2);switch(o===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=t.read_shift(1);s!=0&&(n.underline=s);var l=t.read_shift(1);l>0&&(n.family=l);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=SO(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Hn(t),n}var mM=qn;function gM(t,r){var e=t.l+r,n=t.read_shift(2),a=t.read_shift(2);return t.l=e,{ixfe:n,numFmtId:a}}var vM=qn;function bM(t,r,e){var n={};n.NumberFmt=[];for(var a in rr)n.NumberFmt[a]=rr[a];n.CellXf=[],n.Fonts=[];var o=[],s=!1;return ci(t,function(c,i,u){switch(u){case 44:n.NumberFmt[c[0]]=c[1],Po(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(c.color.rgb=Ff(r.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:o.push(u),s=!0;break;case 38:o.pop(),s=!1;break;default:if(i.T>0)o.push(u);else if(i.T<0)o.pop();else if(!s||e.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var xM=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function yM(t,r,e){r.themeElements.clrScheme=[];var n={};(t[0].match(Wn)||[]).forEach(function(a){var o=Jt(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(r.themeElements.clrScheme[xM.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function wM(){}function _M(){}var SM=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,kM=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,EM=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function TM(t,r,e){r.themeElements={};var n;[["clrScheme",SM,yM],["fontScheme",kM,wM],["fmtScheme",EM,_M]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,r,e)})}var AM=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function g4(t,r){(!t||t.length===0)&&(t=CM());var e,n={};if(!(e=t.match(AM)))throw new Error("themeElements not found in theme");return TM(e[0],n,r),n.raw=t,n}function CM(t,r){var e=[A_];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function NM(t,r,e){var n=t.l+r,a=t.read_shift(4);if(a!==124226){if(!e.cellStyles){t.l=n;return}var o=t.slice(t.l);t.l=n;var s;try{s=T_(o,{type:"array"})}catch{return}var l=ka(s,"theme/theme/theme1.xml",!0);if(l)return g4(l,e)}}function jM(t){return t.read_shift(4)}function OM(t){var r={};switch(r.xclrType=t.read_shift(2),r.nTintShade=t.read_shift(2),r.xclrType){case 0:t.l+=4;break;case 1:r.xclrValue=DM(t,4);break;case 2:r.xclrValue=r4(t);break;case 3:r.xclrValue=jM(t);break;case 4:t.l+=4;break}return t.l+=8,r}function DM(t,r){return qn(t,r)}function RM(t,r){return qn(t,r)}function MM(t){var r=t.read_shift(2),e=t.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=OM(t);break;case 6:n[1]=RM(t,e);break;case 14:case 15:n[1]=t.read_shift(e===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+e)}return n}function FM(t,r){var e=t.l+r;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),o=[];a-- >0;)o.push(MM(t,e-t.l));return{ixfe:n,ext:o}}function IM(t,r){r.forEach(function(e){e[0]})}function PM(t,r){return{flags:t.read_shift(4),version:t.read_shift(4),name:Hn(t)}}function LM(t){for(var r=[],e=t.read_shift(4);e-- >0;)r.push([t.read_shift(4),t.read_shift(4)]);return r}function BM(t){return t.l+=4,t.read_shift(4)!=0}function UM(t,r,e){var n={Types:[],Cell:[],Value:[]},a=e||{},o=[],s=!1,l=2;return ci(t,function(c,i,u){switch(u){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(p){l==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):l==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:o.push(u),s=!0;break;case 36:o.pop(),s=!1;break;default:if(!i.T){if(!s||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function zM(t,r,e){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,o=2,s;return t.replace(Wn,function(l){var c=Jt(l);switch(Fs(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var i=0;i<n.Types.length;++i)n.Types[i].name==c.name&&(s=n.Types[i]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):o==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!a&&e.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function $M(t){var r=[];if(!t)return r;var e=1;return(t.match(Wn)||[]).forEach(function(n){var a=Jt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?e=a.i:a.i=e,r.push(a);break}}),r}function VM(t){var r={};r.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),r.r=Qt(e);var n=t.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function HM(t,r,e){var n=[];return ci(t,function(o,s,l){switch(l){case 63:n.push(o);break;default:if(!s.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function qM(t,r,e,n){if(!t)return t;var a=n||{},o=!1;ci(t,function(l,c,i){switch(i){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!c.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}}},a)}function WM(t,r){if(!t)return"??";var e=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][e].Target}function R2(t,r,e,n){var a=Array.isArray(t),o;r.forEach(function(s){var l=Qn(s.ref);if(a?(t[l.r]||(t[l.r]=[]),o=t[l.r][l.c]):o=t[s.ref],!o){o={t:"z"},a?t[l.r][l.c]=o:t[s.ref]=o;var c=Yr(t["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var i=mr(c);i!==t["!ref"]&&(t["!ref"]=i)}o.c||(o.c=[]);var u={a:s.author,t:s.t,r:s.r,T:e};s.h&&(u.h=s.h);for(var p=o.c.length-1;p>=0;--p){if(!e&&o.c[p].T)return;e&&!o.c[p].T&&o.c.splice(p,1)}if(e&&n){for(p=0;p<n.length;++p)if(u.a==n[p].id){u.a=n[p].name||u.a;break}}o.c.push(u)})}function GM(t,r){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var l=s.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&e.push(l[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var l=s.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Jt(l[0]),i={author:c.authorId&&e[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=Qn(c.ref);if(!(r.sheetRows&&r.sheetRows<=u.r)){var p=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),f=!!p&&!!p[1]&&a1(p[1])||{r:"",t:"",h:""};i.r=f.r,f.r=="<t></t>"&&(f.t=f.h=""),i.t=(f.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(i.h=f.h),n.push(i)}}}}),n}function YM(t,r){var e=[],n=!1,a={},o=0;return t.replace(Wn,function(l,c){var i=Jt(l);switch(Fs(i[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:i.personId,guid:i.id,ref:i.ref,T:1};break;case"</threadedComment>":a.t!=null&&e.push(a);break;case"<text>":case"<text":o=c+l.length;break;case"</text>":a.t=t.slice(o,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return l}),e}function XM(t,r){var e=[],n=!1;return t.replace(Wn,function(o){var s=Jt(o);switch(Fs(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":e.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return o}),e}function KM(t){var r={};r.iauthor=t.read_shift(4);var e=qo(t);return r.rfx=e.s,r.ref=Qt(e.s),t.l+=16,r}var ZM=Hn;function JM(t,r){var e=[],n=[],a={},o=!1;return ci(t,function(l,c,i){switch(i){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,r.sheetRows&&a.rfx&&r.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,e.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!o||r.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}}}),e}var QM="application/vnd.ms-office.vbaProject";function eF(t){var r=pr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(e,n){if(!(e.slice(-1)==="/"||!e.match(/_VBA_PROJECT_CUR/))){var a=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");pr.utils.cfb_add(r,a,t.FileIndex[n].content)}}),pr.write(r)}function tF(){return{"!type":"dialog"}}function rF(){return{"!type":"dialog"}}function nF(){return{"!type":"macro"}}function aF(){return{"!type":"macro"}}var Gl=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function e(n,a,o,s){var l=!1,c=!1;o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1)),s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1));var i=o.length>0?parseInt(o,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return l?u+=r.c:--u,c?i+=r.r:--i,a+(l?"":"$")+bn(u)+(c?"":"$")+Mn(i)}return function(a,o){return r=o,a.replace(t,e)}}(),v4=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,sF=function(){return function(r,e){return r.replace(v4,function(n,a,o,s,l,c){var i=Jm(s)-(o?0:e.c),u=Zm(c)-(l?0:e.r),p=u==0?"":l?u+1:"["+u+"]",f=i==0?"":o?i+1:"["+i+"]";return a+"R"+p+"C"+f})}}();function b4(t,r){return t.replace(v4,function(e,n,a,o,s,l){return n+(a=="$"?a+o:bn(Jm(o)+r.c))+(s=="$"?s+l:Mn(Zm(l)+r.r))})}function iF(t,r,e){var n=nc(r),a=n.s,o=Qn(e),s={r:o.r-a.r,c:o.c-a.c};return b4(t,s)}function oF(t){return t.length!=1}function M2(t){return t.replace(/_xlfn\./g,"")}function sn(t){t.l+=1}function to(t,r){var e=t.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function x4(t,r,e){var n=2;if(e){if(e.biff>=2&&e.biff<=5)return y4(t);e.biff==12&&(n=4)}var a=t.read_shift(n),o=t.read_shift(n),s=to(t),l=to(t);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:o,c:l[0],cRel:l[1],rRel:l[2]}}}function y4(t){var r=to(t),e=to(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:e[0],c:a,cRel:e[1],rRel:e[2]}}}function lF(t,r,e){if(e.biff<8)return y4(t);var n=t.read_shift(e.biff==12?4:2),a=t.read_shift(e.biff==12?4:2),o=to(t),s=to(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function w4(t,r,e){if(e&&e.biff>=2&&e.biff<=5)return cF(t);var n=t.read_shift(e&&e.biff==12?4:2),a=to(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function cF(t){var r=to(t),e=t.read_shift(1);return{r:r[0],c:e,cRel:r[1],rRel:r[2]}}function uF(t){var r=t.read_shift(2),e=t.read_shift(2);return{r,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function dF(t,r,e){var n=e&&e.biff?e.biff:8;if(n>=2&&n<=5)return fF(t);var a=t.read_shift(n>=12?4:2),o=t.read_shift(2),s=(o&16384)>>14,l=(o&32768)>>15;if(o&=16383,l==1)for(;a>524287;)a-=1048576;if(s==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:s,rRel:l}}function fF(t){var r=t.read_shift(2),e=t.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&e>=128&&(e=e-256),{r,c:e,cRel:a,rRel:n}}function hF(t,r,e){var n=(t[t.l++]&96)>>5,a=x4(t,e.biff>=2&&e.biff<=5?6:8,e);return[n,a]}function pF(t,r,e){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),o=8;if(e)switch(e.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var s=x4(t,o,e);return[n,a,s]}function mF(t,r,e){var n=(t[t.l++]&96)>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[n]}function gF(t,r,e){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=8;if(e)switch(e.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[n,a]}function vF(t,r,e){var n=(t[t.l++]&96)>>5,a=lF(t,r-1,e);return[n,a]}function bF(t,r,e){var n=(t[t.l++]&96)>>5;return t.l+=e.biff==2?6:e.biff==12?14:7,[n]}function F2(t){var r=t[t.l+1]&1,e=1;return t.l+=4,[r,e]}function xF(t,r,e){t.l+=2;for(var n=t.read_shift(e&&e.biff==2?1:2),a=[],o=0;o<=n;++o)a.push(t.read_shift(e&&e.biff==2?1:2));return a}function yF(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(e&&e.biff==2?1:2)]}function wF(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(e&&e.biff==2?1:2)]}function _F(t){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(2)]}function SF(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=e&&e.biff==2?3:4,[n]}function _4(t){var r=t.read_shift(1),e=t.read_shift(1);return[r,e]}function kF(t){return t.read_shift(2),_4(t)}function EF(t){return t.read_shift(2),_4(t)}function TF(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var a=w4(t,0,e);return[n,a]}function AF(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var a=dF(t,0,e);return[n,a]}function CF(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);e&&e.biff==5&&(t.l+=12);var o=w4(t,0,e);return[n,a,o]}function NF(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(e&&e.biff<=3?1:2);return[jI[a],E4[a],n]}function jF(t,r,e){var n=t[t.l++],a=t.read_shift(1),o=e&&e.biff<=3?[n==88?-1:0,t.read_shift(1)]:OF(t);return[a,(o[0]===0?E4:NI)[o[1]]]}function OF(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function DF(t,r,e){t.l+=e&&e.biff==2?3:4}function RF(t,r,e){if(t.l++,e&&e.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(e&&e.biff==2?1:2);return[n,a]}function MF(t){return t.l++,Wo[t.read_shift(1)]}function FF(t){return t.l++,t.read_shift(2)}function IF(t){return t.l++,t.read_shift(1)!==0}function PF(t){return t.l++,$n(t)}function LF(t,r,e){return t.l++,Gu(t,r-1,e)}function BF(t,r){var e=[t.read_shift(1)];if(r==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=Zr(t,1)?"TRUE":"FALSE",r!=12&&(t.l+=7);break;case 37:case 16:e[1]=Wo[t[t.l]],t.l+=r==12?4:8;break;case 0:t.l+=8;break;case 1:e[1]=$n(t);break;case 2:e[1]=Go(t,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function UF(t,r,e){for(var n=t.read_shift(e.biff==12?4:2),a=[],o=0;o!=n;++o)a.push((e.biff==12?qo:Jf)(t));return a}function zF(t,r,e){var n=0,a=0;e.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--n,--a==0&&(a=256));for(var o=0,s=[];o!=n&&(s[o]=[]);++o)for(var l=0;l!=a;++l)s[o][l]=BF(t,e.biff);return s}function $F(t,r,e){var n=t.read_shift(1)>>>5&3,a=!e||e.biff>=8?4:2,o=t.read_shift(a);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,o]}function VF(t,r,e){if(e.biff==5)return HF(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),o=t.read_shift(4);return[n,a,o]}function HF(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[r,e,n]}function qF(t,r,e){var n=t.read_shift(1)>>>5&3;t.l+=e&&e.biff==2?3:4;var a=t.read_shift(e&&e.biff==2?1:2);return[n,a]}function WF(t,r,e){var n=t.read_shift(1)>>>5&3,a=t.read_shift(e&&e.biff==2?1:2);return[n,a]}function GF(t,r,e){var n=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,e.biff==12&&(t.l+=2),[n]}function YF(t,r,e){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=4;if(e)switch(e.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[n,a]}var XF=qn,KF=qn,ZF=qn;function Xu(t,r,e){return t.l+=2,[uF(t)]}function i1(t){return t.l+=6,[]}var JF=Xu,QF=i1,eI=i1,tI=Xu;function S4(t){return t.l+=2,[ln(t),t.read_shift(2)&1]}var rI=Xu,nI=S4,aI=i1,sI=Xu,iI=Xu,oI=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function lI(t){t.l+=2;var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),o=t.read_shift(2),s=oI[e>>2&31];return{ixti:r,coltype:e&3,rt:s,idx:n,c:a,C:o}}function cI(t){return t.l+=2,[t.read_shift(4)]}function uI(t,r,e){return t.l+=5,t.l+=2,t.l+=e.biff==2?1:4,["PTGSHEET"]}function dI(t,r,e){return t.l+=e.biff==2?4:5,["PTGENDSHEET"]}function fI(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function hI(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function pI(t){return t.l+=4,[0,0]}var I2={1:{n:"PtgExp",f:RF},2:{n:"PtgTbl",f:ZF},3:{n:"PtgAdd",f:sn},4:{n:"PtgSub",f:sn},5:{n:"PtgMul",f:sn},6:{n:"PtgDiv",f:sn},7:{n:"PtgPower",f:sn},8:{n:"PtgConcat",f:sn},9:{n:"PtgLt",f:sn},10:{n:"PtgLe",f:sn},11:{n:"PtgEq",f:sn},12:{n:"PtgGe",f:sn},13:{n:"PtgGt",f:sn},14:{n:"PtgNe",f:sn},15:{n:"PtgIsect",f:sn},16:{n:"PtgUnion",f:sn},17:{n:"PtgRange",f:sn},18:{n:"PtgUplus",f:sn},19:{n:"PtgUminus",f:sn},20:{n:"PtgPercent",f:sn},21:{n:"PtgParen",f:sn},22:{n:"PtgMissArg",f:sn},23:{n:"PtgStr",f:LF},26:{n:"PtgSheet",f:uI},27:{n:"PtgEndSheet",f:dI},28:{n:"PtgErr",f:MF},29:{n:"PtgBool",f:IF},30:{n:"PtgInt",f:FF},31:{n:"PtgNum",f:PF},32:{n:"PtgArray",f:bF},33:{n:"PtgFunc",f:NF},34:{n:"PtgFuncVar",f:jF},35:{n:"PtgName",f:$F},36:{n:"PtgRef",f:TF},37:{n:"PtgArea",f:hF},38:{n:"PtgMemArea",f:qF},39:{n:"PtgMemErr",f:XF},40:{n:"PtgMemNoMem",f:KF},41:{n:"PtgMemFunc",f:WF},42:{n:"PtgRefErr",f:GF},43:{n:"PtgAreaErr",f:mF},44:{n:"PtgRefN",f:AF},45:{n:"PtgAreaN",f:vF},46:{n:"PtgMemAreaN",f:fI},47:{n:"PtgMemNoMemN",f:hI},57:{n:"PtgNameX",f:VF},58:{n:"PtgRef3d",f:CF},59:{n:"PtgArea3d",f:pF},60:{n:"PtgRefErr3d",f:YF},61:{n:"PtgAreaErr3d",f:gF},255:{}},mI={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},gI={1:{n:"PtgElfLel",f:S4},2:{n:"PtgElfRw",f:sI},3:{n:"PtgElfCol",f:JF},6:{n:"PtgElfRwV",f:iI},7:{n:"PtgElfColV",f:tI},10:{n:"PtgElfRadical",f:rI},11:{n:"PtgElfRadicalS",f:aI},13:{n:"PtgElfColS",f:QF},15:{n:"PtgElfColSV",f:eI},16:{n:"PtgElfRadicalLel",f:nI},25:{n:"PtgList",f:lI},29:{n:"PtgSxName",f:cI},255:{}},vI={0:{n:"PtgAttrNoop",f:pI},1:{n:"PtgAttrSemi",f:SF},2:{n:"PtgAttrIf",f:wF},4:{n:"PtgAttrChoose",f:xF},8:{n:"PtgAttrGoto",f:yF},16:{n:"PtgAttrSum",f:DF},32:{n:"PtgAttrBaxcel",f:F2},33:{n:"PtgAttrBaxcel",f:F2},64:{n:"PtgAttrSpace",f:kF},65:{n:"PtgAttrSpaceSemi",f:EF},128:{n:"PtgAttrIfError",f:_F},255:{}};function Ku(t,r,e,n){if(n.biff<8)return qn(t,r);for(var a=t.l+r,o=[],s=0;s!==e.length;++s)switch(e[s][0]){case"PtgArray":e[s][1]=zF(t,0,n),o.push(e[s][1]);break;case"PtgMemArea":e[s][2]=UF(t,e[s][1],n),o.push(e[s][2]);break;case"PtgExp":n&&n.biff==12&&(e[s][1][1]=t.read_shift(4),o.push(e[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[s][0]}return r=a-t.l,r!==0&&o.push(qn(t,r)),o}function Zu(t,r,e){for(var n=t.l+r,a,o,s=[];n!=t.l;)r=n-t.l,o=t[t.l],a=I2[o]||I2[mI[o]],(o===24||o===25)&&(a=(o===24?gI:vI)[t[t.l+1]]),!a||!a.f?qn(t,r):s.push([a.n,a.f(t,r,e)]);return s}function bI(t){for(var r=[],e=0;e<t.length;++e){for(var n=t[e],a=[],o=0;o<n.length;++o){var s=n[o];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var xI={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function yI(t,r){if(!t&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function k4(t,r,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[r]))return t.SheetNames[r];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[r];if(e.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":t.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(e.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return e.SID!=null?t.SheetNames[e.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function P2(t,r,e){var n=k4(t,r,e);return n=="#REF"?n:yI(n,e)}function Bn(t,r,e,n,a){var o=a&&a.biff||8,s={s:{c:0,r:0}},l=[],c,i,u,p=0,f=0,h,v="";if(!t[0]||!t[0][0])return"";for(var b=-1,g="",x=0,y=t[0].length;x<y;++x){var k=t[0][x];switch(k[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),i=l.pop(),b>=0){switch(t[0][b][1][0]){case 0:g=Gr(" ",t[0][b][1][1]);break;case 1:g=Gr("\r",t[0][b][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][b][1][0])}i=i+g,b=-1}l.push(i+xI[k[0]]+c);break;case"PtgIsect":c=l.pop(),i=l.pop(),l.push(i+" "+c);break;case"PtgUnion":c=l.pop(),i=l.pop(),l.push(i+","+c);break;case"PtgRange":c=l.pop(),i=l.pop(),l.push(i+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=du(k[1][1],s,a),l.push(fu(u,o));break;case"PtgRefN":u=e?du(k[1][1],e,a):k[1][1],l.push(fu(u,o));break;case"PtgRef3d":p=k[1][1],u=du(k[1][2],s,a),v=P2(n,p,a),l.push(v+"!"+fu(u,o));break;case"PtgFunc":case"PtgFuncVar":var N=k[1][0],F=k[1][1];N||(N=0),N&=127;var B=N==0?[]:l.slice(-N);l.length-=N,F==="User"&&(F=B.shift()),l.push(F+"("+B.join(",")+")");break;case"PtgBool":l.push(k[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(k[1]);break;case"PtgNum":l.push(String(k[1]));break;case"PtgStr":l.push('"'+k[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(k[1]);break;case"PtgAreaN":h=v2(k[1][1],e?{s:e}:s,a),l.push(wp(h,a));break;case"PtgArea":h=v2(k[1][1],s,a),l.push(wp(h,a));break;case"PtgArea3d":p=k[1][1],h=k[1][2],v=P2(n,p,a),l.push(v+"!"+wp(h,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=k[1][2];var W=(n.names||[])[f-1]||(n[0]||[])[f],V=W?W.Name:"SH33TJSNAME"+String(f);V&&V.slice(0,6)=="_xlfn."&&!a.xlfn&&(V=V.slice(6)),l.push(V);break;case"PtgNameX":var q=k[1][1];f=k[1][2];var X;if(a.biff<=5)q<0&&(q=-q),n[q]&&(X=n[q][f]);else{var I="";if(((n[q]||[])[0]||[])[0]==14849||(((n[q]||[])[0]||[])[0]==1025?n[q][f]&&n[q][f].itab>0&&(I=n.SheetNames[n[q][f].itab-1]+"!"):I=n.SheetNames[f-1]+"!"),n[q]&&n[q][f])I+=n[q][f].Name;else if(n[0]&&n[0][f])I+=n[0][f].Name;else{var H=(k4(n,q,a)||"").split(";;");H[f-1]?I=H[f-1]:I+="SH33TJSERRX"}l.push(I);break}X||(X={Name:"SH33TJSERRY"}),l.push(X.Name);break;case"PtgParen":var O="(",R=")";if(b>=0){switch(g="",t[0][b][1][0]){case 2:O=Gr(" ",t[0][b][1][1])+O;break;case 3:O=Gr("\r",t[0][b][1][1])+O;break;case 4:R=Gr(" ",t[0][b][1][1])+R;break;case 5:R=Gr("\r",t[0][b][1][1])+R;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][b][1][0])}b=-1}l.push(O+l.pop()+R);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:k[1][1],r:k[1][0]};var C={c:e.c,r:e.r};if(n.sharedf[Qt(u)]){var w=n.sharedf[Qt(u)];l.push(Bn(w,s,C,n,a))}else{var E=!1;for(c=0;c!=n.arrayf.length;++c)if(i=n.arrayf[c],!(u.c<i[0].s.c||u.c>i[0].e.c)&&!(u.r<i[0].s.r||u.r>i[0].e.r)){l.push(Bn(i[1],s,C,n,a)),E=!0;break}E||l.push(k[1])}break;case"PtgArray":l.push("{"+bI(k[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+k[1].idx+"[#"+k[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(k));default:throw new Error("Unrecognized Formula Token: "+String(k))}var A=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&b>=0&&A.indexOf(t[0][x][0])==-1){k=t[0][b];var T=!0;switch(k[1][0]){case 4:T=!1;case 0:g=Gr(" ",k[1][1]);break;case 5:T=!1;case 1:g=Gr("\r",k[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+k[1][0])}l.push((T?g:"")+l.pop()+(T?"":g)),b=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function wI(t,r,e){var n=t.l+r,a=e.biff==2?1:2,o,s=t.read_shift(a);if(s==65535)return[[],qn(t,r-2)];var l=Zu(t,s,e);return r!==s+a&&(o=Ku(t,r-s-a,l,e)),t.l=n,[l,o]}function _I(t,r,e){var n=t.l+r,a=e.biff==2?1:2,o,s=t.read_shift(a);if(s==65535)return[[],qn(t,r-2)];var l=Zu(t,s,e);return r!==s+a&&(o=Ku(t,r-s-a,l,e)),t.l=n,[l,o]}function SI(t,r,e,n){var a=t.l+r,o=Zu(t,n,e),s;return a!==t.l&&(s=Ku(t,a-t.l,o,e)),[o,s]}function kI(t,r,e){var n=t.l+r,a,o=t.read_shift(2),s=Zu(t,o,e);return o==65535?[[],qn(t,r-2)]:(r!==o+2&&(a=Ku(t,n-o-2,s,e)),[s,a])}function EI(t){var r;if(ni(t,t.l+6)!==65535)return[$n(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return r=t[t.l+2]===1,t.l+=8,[r,"b"];case 2:return r=t[t.l+2],t.l+=8,[r,"e"];case 3:return t.l+=8,["","s"]}return[]}function kp(t,r,e){var n=t.l+r,a=Is(t);e.biff==2&&++t.l;var o=EI(t),s=t.read_shift(1);e.biff!=2&&(t.read_shift(1),e.biff>=5&&t.read_shift(4));var l=_I(t,n-t.l,e);return{cell:a,val:o[0],formula:l,shared:s>>3&1,tt:o[1]}}function Qf(t,r,e){var n=t.read_shift(4),a=Zu(t,n,e),o=t.read_shift(4),s=o>0?Ku(t,o,a,e):null;return[a,s]}var TI=Qf,eh=Qf,AI=Qf,CI=Qf,NI={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},E4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},jI={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function L2(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,e){return e.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Ep(t){var r=t.split(":"),e=r[0].split(".")[0];return[e,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var gu={},Yl={};function vu(t,r){if(t){var e=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(e=[1,1,1,1,.5,.5]),t.left==null&&(t.left=e[0]),t.right==null&&(t.right=e[1]),t.top==null&&(t.top=e[2]),t.bottom==null&&(t.bottom=e[3]),t.header==null&&(t.header=e[4]),t.footer==null&&(t.footer=e[5])}}function T4(t,r,e,n,a,o){try{n.cellNF&&(t.z=rr[r])}catch(l){if(n.WTF)throw l}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=kn(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(rr[r]==null&&Po(Oj[r]||"General",r),t.t==="e")t.w=t.w||Wo[t.v];else if(r===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Ou(t.v);else if(t.t==="d"){var s=ta(t.v);(s|0)===s?t.w=s.toString(10):t.w=Ou(s)}else{if(t.v===void 0)return"";t.w=Bo(t.v,Yl)}else t.t==="d"?t.w=Ha(r,ta(t.v),Yl):t.w=Ha(r,t.v,Yl)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&e!=null)try{t.s=o.Fills[e],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Ff(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Ff(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&o.Fills)throw l}}}function OI(t,r){var e=Yr(r);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(t["!ref"]=mr(e))}var DI=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,RI=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,MI=/<(?:\w:)?hyperlink [^>]*>/mg,FI=/"(\w*:\w*)"/,II=/<(?:\w:)?col\b[^>]*[\/]?>/g,PI=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,LI=/<(?:\w:)?pageMargins[^>]*\/>/g,A4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,BI=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,UI=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function zI(t,r,e,n,a,o,s){if(!t)return t;n||(n={"!id":{}});var l=r.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},i="",u="",p=t.match(RI);p?(i=t.slice(0,p.index),u=t.slice(p.index+p[0].length)):i=u=t;var f=i.match(A4);f?o1(f[0],l,a,e):(f=i.match(BI))&&$I(f[0],f[1]||"",l,a,e);var h=(i.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var v=i.slice(h,h+50).match(FI);v&&OI(l,v[1])}var b=i.match(UI);b&&b[1]&&YI(b[1],a);var g=[];if(r.cellStyles){var x=i.match(II);x&&qI(g,x)}p&&XI(p[1],l,r,c,o,s);var y=u.match(PI);y&&(l["!autofilter"]=WI(y[0]));var k=[],N=u.match(DI);if(N)for(h=0;h!=N.length;++h)k[h]=Yr(N[h].slice(N[h].indexOf('"')+1));var F=u.match(MI);F&&VI(l,F,n);var B=u.match(LI);if(B&&(l["!margins"]=HI(Jt(B[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=mr(c)),r.sheetRows>0&&l["!ref"]){var W=Yr(l["!ref"]);r.sheetRows<=+W.e.r&&(W.e.r=r.sheetRows-1,W.e.r>c.e.r&&(W.e.r=c.e.r),W.e.r<W.s.r&&(W.s.r=W.e.r),W.e.c>c.e.c&&(W.e.c=c.e.c),W.e.c<W.s.c&&(W.s.c=W.e.c),l["!fullref"]=l["!ref"],l["!ref"]=mr(W))}return g.length>0&&(l["!cols"]=g),k.length>0&&(l["!merges"]=k),l}function o1(t,r,e,n){var a=Jt(t);e.Sheets[n]||(e.Sheets[n]={}),a.codeName&&(e.Sheets[n].CodeName=xr(Ir(a.codeName)))}function $I(t,r,e,n,a){o1(t.slice(0,t.indexOf(">")),e,n,a)}function VI(t,r,e){for(var n=Array.isArray(t),a=0;a!=r.length;++a){var o=Jt(Ir(r[a]),!0);if(!o.ref)return;var s=((e||{})["!id"]||[])[o.id];s?(o.Target=s.Target,o.location&&(o.Target+="#"+xr(o.location))):(o.Target="#"+xr(o.location),s={Target:o.Target,TargetMode:"Internal"}),o.Rel=s,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var l=Yr(o.ref),c=l.s.r;c<=l.e.r;++c)for(var i=l.s.c;i<=l.e.c;++i){var u=Qt({c:i,r:c});n?(t[c]||(t[c]=[]),t[c][i]||(t[c][i]={t:"z",v:void 0}),t[c][i].l=o):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=o)}}}function HI(t){var r={};return["left","right","top","bottom","header","footer"].forEach(function(e){t[e]&&(r[e]=parseFloat(t[e]))}),r}function qI(t,r){for(var e=!1,n=0;n!=r.length;++n){var a=Jt(r[n],!0);a.hidden&&(a.hidden=Br(a.hidden));var o=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!e&&a.width&&(e=!0,s1(a.width)),Jl(a);o<=s;)t[o++]=Rn(a)}}function WI(t){var r={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return r}var GI=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function YI(t,r){r.Views||(r.Views=[{}]),(t.match(GI)||[]).forEach(function(e,n){var a=Jt(e);r.Views[n]||(r.Views[n]={}),+a.zoomScale&&(r.Views[n].zoom=+a.zoomScale),Br(a.rightToLeft)&&(r.Views[n].RTL=!0)})}var XI=function(){var t=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=Du("v"),s=Du("f");return function(c,i,u,p,f,h){for(var v=0,b="",g=[],x=[],y=0,k=0,N=0,F="",B,W,V=0,q=0,X,I,H=0,O=0,R=Array.isArray(h.CellXf),C,w=[],E=[],A=Array.isArray(i),T=[],D={},U=!1,P=!!u.sheetStubs,K=c.split(r),Y=0,re=K.length;Y!=re;++Y){b=K[Y].trim();var z=b.length;if(z!==0){var ee=0;e:for(v=0;v<z;++v)switch(b[v]){case">":if(b[v-1]!="/"){++v;break e}if(u&&u.cellStyles){if(W=Jt(b.slice(ee,v),!0),V=W.r!=null?parseInt(W.r,10):V+1,q=-1,u.sheetRows&&u.sheetRows<V)continue;D={},U=!1,W.ht&&(U=!0,D.hpt=parseFloat(W.ht),D.hpx=Iu(D.hpt)),W.hidden=="1"&&(U=!0,D.hidden=!0),W.outlineLevel!=null&&(U=!0,D.level=+W.outlineLevel),U&&(T[V-1]=D)}break;case"<":ee=v;break}if(ee>=v)break;if(W=Jt(b.slice(ee,v),!0),V=W.r!=null?parseInt(W.r,10):V+1,q=-1,!(u.sheetRows&&u.sheetRows<V)){p.s.r>V-1&&(p.s.r=V-1),p.e.r<V-1&&(p.e.r=V-1),u&&u.cellStyles&&(D={},U=!1,W.ht&&(U=!0,D.hpt=parseFloat(W.ht),D.hpx=Iu(D.hpt)),W.hidden=="1"&&(U=!0,D.hidden=!0),W.outlineLevel!=null&&(U=!0,D.level=+W.outlineLevel),U&&(T[V-1]=D)),g=b.slice(v).split(t);for(var L=0;L!=g.length&&g[L].trim().charAt(0)=="<";++L);for(g=g.slice(L),v=0;v!=g.length;++v)if(b=g[v].trim(),b.length!==0){if(x=b.match(e),y=v,k=0,N=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,x!=null&&x.length===2){for(y=0,F=x[1],k=0;k!=F.length&&!((N=F.charCodeAt(k)-64)<1||N>26);++k)y=26*y+N;--y,q=y}else++q;for(k=0;k!=b.length&&b.charCodeAt(k)!==62;++k);if(++k,W=Jt(b.slice(0,k),!0),W.r||(W.r=Qt({r:V-1,c:q})),F=b.slice(k),B={t:""},(x=F.match(o))!=null&&x[1]!==""&&(B.v=xr(x[1])),u.cellFormula){if((x=F.match(s))!=null&&x[1]!==""){if(B.f=xr(Ir(x[1])).replace(/\r\n/g,`
`),u.xlfn||(B.f=M2(B.f)),x[0].indexOf('t="array"')>-1)B.F=(F.match(a)||[])[1],B.F.indexOf(":")>-1&&w.push([Yr(B.F),B.F]);else if(x[0].indexOf('t="shared"')>-1){I=Jt(x[0]);var M=xr(Ir(x[1]));u.xlfn||(M=M2(M)),E[parseInt(I.si,10)]=[I,M,W.r]}}else(x=F.match(/<f[^>]*\/>/))&&(I=Jt(x[0]),E[I.si]&&(B.f=iF(E[I.si][1],E[I.si][2],W.r)));var Z=Qn(W.r);for(k=0;k<w.length;++k)Z.r>=w[k][0].s.r&&Z.r<=w[k][0].e.r&&Z.c>=w[k][0].s.c&&Z.c<=w[k][0].e.c&&(B.F=w[k][1])}if(W.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(P)B.t="z";else continue;else B.t=W.t||"n";switch(p.s.c>q&&(p.s.c=q),p.e.c<q&&(p.e.c=q),B.t){case"n":if(B.v==""||B.v==null){if(!P)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!P)continue;B.t="z"}else X=gu[parseInt(B.v,10)],B.v=X.t,B.r=X.r,u.cellHTML&&(B.h=X.h);break;case"str":B.t="s",B.v=B.v!=null?Ir(B.v):"",u.cellHTML&&(B.h=Ym(B.v));break;case"inlineStr":x=F.match(n),B.t="s",x!=null&&(X=a1(x[1]))?(B.v=X.t,u.cellHTML&&(B.h=X.h)):B.v="";break;case"b":B.v=Br(B.v);break;case"d":u.cellDates?B.v=kn(B.v,1):(B.v=ta(kn(B.v,1)),B.t="n");break;case"e":(!u||u.cellText!==!1)&&(B.w=B.v),B.v=Y_[B.v];break}if(H=O=0,C=null,R&&W.s!==void 0&&(C=h.CellXf[W.s],C!=null&&(C.numFmtId!=null&&(H=C.numFmtId),u.cellStyles&&C.fillId!=null&&(O=C.fillId))),T4(B,H,O,u,f,h),u.cellDates&&R&&B.t=="n"&&rc(rr[H])&&(B.t="d",B.v=Zf(B.v)),W.cm&&u.xlmeta){var se=(u.xlmeta.Cell||[])[+W.cm-1];se&&se.type=="XLDAPR"&&(B.D=!0)}if(A){var ae=Qn(W.r);i[ae.r]||(i[ae.r]=[]),i[ae.r][ae.c]=B}else i[W.r]=B}}}}T.length>0&&(i["!rows"]=T)}}();function KI(t,r){var e={},n=t.l+r;e.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=n,o&7&&(e.level=o&7),o&16&&(e.hidden=!0),o&32&&(e.hpt=a/20),e}var ZI=qo;function JI(){}function QI(t,r){var e={},n=t[t.l];return++t.l,e.above=!(n&64),e.left=!(n&128),t.l+=18,e.name=wO(t),e}function eP(t){var r=qa(t);return[r]}function tP(t){var r=Ho(t);return[r]}function rP(t){var r=qa(t),e=t.read_shift(1);return[r,e,"b"]}function nP(t){var r=Ho(t),e=t.read_shift(1);return[r,e,"b"]}function aP(t){var r=qa(t),e=t.read_shift(1);return[r,e,"e"]}function sP(t){var r=Ho(t),e=t.read_shift(1);return[r,e,"e"]}function iP(t){var r=qa(t),e=t.read_shift(4);return[r,e,"s"]}function oP(t){var r=Ho(t),e=t.read_shift(4);return[r,e,"s"]}function lP(t){var r=qa(t),e=$n(t);return[r,e,"n"]}function C4(t){var r=Ho(t),e=$n(t);return[r,e,"n"]}function cP(t){var r=qa(t),e=t1(t);return[r,e,"n"]}function uP(t){var r=Ho(t),e=t1(t);return[r,e,"n"]}function dP(t){var r=qa(t),e=Qm(t);return[r,e,"is"]}function fP(t){var r=qa(t),e=Hn(t);return[r,e,"str"]}function hP(t){var r=Ho(t),e=Hn(t);return[r,e,"str"]}function pP(t,r,e){var n=t.l+r,a=qa(t);a.r=e["!row"];var o=t.read_shift(1),s=[a,o,"b"];if(e.cellFormula){t.l+=2;var l=eh(t,n-t.l,e);s[3]=Bn(l,null,a,e.supbooks,e)}else t.l=n;return s}function mP(t,r,e){var n=t.l+r,a=qa(t);a.r=e["!row"];var o=t.read_shift(1),s=[a,o,"e"];if(e.cellFormula){t.l+=2;var l=eh(t,n-t.l,e);s[3]=Bn(l,null,a,e.supbooks,e)}else t.l=n;return s}function gP(t,r,e){var n=t.l+r,a=qa(t);a.r=e["!row"];var o=$n(t),s=[a,o,"n"];if(e.cellFormula){t.l+=2;var l=eh(t,n-t.l,e);s[3]=Bn(l,null,a,e.supbooks,e)}else t.l=n;return s}function vP(t,r,e){var n=t.l+r,a=qa(t);a.r=e["!row"];var o=Hn(t),s=[a,o,"str"];if(e.cellFormula){t.l+=2;var l=eh(t,n-t.l,e);s[3]=Bn(l,null,a,e.supbooks,e)}else t.l=n;return s}var bP=qo;function xP(t,r){var e=t.l+r,n=qo(t),a=e1(t),o=Hn(t),s=Hn(t),l=Hn(t);t.l=e;var c={rfx:n,relId:a,loc:o,display:l};return s&&(c.Tooltip=s),c}function yP(){}function wP(t,r,e){var n=t.l+r,a=q_(t),o=t.read_shift(1),s=[a];if(s[2]=o,e.cellFormula){var l=TI(t,n-t.l,e);s[1]=l}else t.l=n;return s}function _P(t,r,e){var n=t.l+r,a=qo(t),o=[a];if(e.cellFormula){var s=CI(t,n-t.l,e);o[1]=s,t.l=n}else t.l=n;return o}var SP=["left","right","top","bottom","header","footer"];function kP(t){var r={};return SP.forEach(function(e){r[e]=$n(t)}),r}function EP(t){var r=t.read_shift(2);return t.l+=28,{RTL:r&32}}function TP(){}function AP(){}function CP(t,r,e,n,a,o,s){if(!t)return t;var l=r||{};n||(n={"!id":{}});var c=l.dense?[]:{},i,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,f=!1,h,v,b,g,x,y,k,N,F,B=[];l.biff=12,l["!row"]=0;var W=0,V=!1,q=[],X={},I=l.supbooks||a.supbooks||[[]];if(I.sharedf=X,I.arrayf=q,I.SheetNames=a.SheetNames||a.Sheets.map(function(A){return A.name}),!l.supbooks&&(l.supbooks=I,a.Names))for(var H=0;H<a.Names.length;++H)I[0][H+1]=a.Names[H];var O=[],R=[],C=!1;Lf[16]={n:"BrtShortReal",f:C4};var w;if(ci(t,function(T,D,U){if(!f)switch(U){case 148:i=T;break;case 0:h=T,l.sheetRows&&l.sheetRows<=h.r&&(f=!0),N=Mn(g=h.r),l["!row"]=h.r,(T.hidden||T.hpt||T.level!=null)&&(T.hpt&&(T.hpx=Iu(T.hpt)),R[T.r]=T);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:T[2]},T[2]){case"n":v.v=T[1];break;case"s":k=gu[T[1]],v.v=k.t,v.r=k.r;break;case"b":v.v=!!T[1];break;case"e":v.v=T[1],l.cellText!==!1&&(v.w=Wo[v.v]);break;case"str":v.t="s",v.v=T[1];break;case"is":v.t="s",v.v=T[1].t;break}if((b=s.CellXf[T[0].iStyleRef])&&T4(v,b.numFmtId,null,l,o,s),x=T[0].c==-1?x+1:T[0].c,l.dense?(c[g]||(c[g]=[]),c[g][x]=v):c[bn(x)+N]=v,l.cellFormula){for(V=!1,W=0;W<q.length;++W){var P=q[W];h.r>=P[0].s.r&&h.r<=P[0].e.r&&x>=P[0].s.c&&x<=P[0].e.c&&(v.F=mr(P[0]),V=!0)}!V&&T.length>3&&(v.f=T[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>x&&(u.s.c=x),u.e.r<h.r&&(u.e.r=h.r),u.e.c<x&&(u.e.c=x),l.cellDates&&b&&v.t=="n"&&rc(rr[b.numFmtId])){var K=Fo(v.v);K&&(v.t="d",v.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}w&&(w.type=="XLDAPR"&&(v.D=!0),w=void 0);break;case 1:case 12:if(!l.sheetStubs||p)break;v={t:"z",v:void 0},x=T[0].c==-1?x+1:T[0].c,l.dense?(c[g]||(c[g]=[]),c[g][x]=v):c[bn(x)+N]=v,u.s.r>h.r&&(u.s.r=h.r),u.s.c>x&&(u.s.c=x),u.e.r<h.r&&(u.e.r=h.r),u.e.c<x&&(u.e.c=x),w&&(w.type=="XLDAPR"&&(v.D=!0),w=void 0);break;case 176:B.push(T);break;case 49:w=((l.xlmeta||{}).Cell||[])[T-1];break;case 494:var Y=n["!id"][T.relId];for(Y?(T.Target=Y.Target,T.loc&&(T.Target+="#"+T.loc),T.Rel=Y):T.relId==""&&(T.Target="#"+T.loc),g=T.rfx.s.r;g<=T.rfx.e.r;++g)for(x=T.rfx.s.c;x<=T.rfx.e.c;++x)l.dense?(c[g]||(c[g]=[]),c[g][x]||(c[g][x]={t:"z",v:void 0}),c[g][x].l=T):(y=Qt({c:x,r:g}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=T);break;case 426:if(!l.cellFormula)break;q.push(T),F=l.dense?c[g][x]:c[bn(x)+N],F.f=Bn(T[1],u,{r:h.r,c:x},I,l),F.F=mr(T[0]);break;case 427:if(!l.cellFormula)break;X[Qt(T[0].s)]=T[1],F=l.dense?c[g][x]:c[bn(x)+N],F.f=Bn(T[1],u,{r:h.r,c:x},I,l);break;case 60:if(!l.cellStyles)break;for(;T.e>=T.s;)O[T.e--]={width:T.w/256,hidden:!!(T.flags&1),level:T.level},C||(C=!0,s1(T.w/256)),Jl(O[T.e+1]);break;case 161:c["!autofilter"]={ref:mr(T)};break;case 476:c["!margins"]=T;break;case 147:a.Sheets[e]||(a.Sheets[e]={}),T.name&&(a.Sheets[e].CodeName=T.name),(T.above||T.left)&&(c["!outline"]={above:T.above,left:T.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),T.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!D.T){if(!p||l.WTF)throw new Error("Unexpected record 0x"+U.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(u.s.r<2e6||i&&(i.e.r>0||i.e.c>0||i.s.r>0||i.s.c>0))&&(c["!ref"]=mr(i||u)),l.sheetRows&&c["!ref"]){var E=Yr(c["!ref"]);l.sheetRows<=+E.e.r&&(E.e.r=l.sheetRows-1,E.e.r>u.e.r&&(E.e.r=u.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>u.e.c&&(E.e.c=u.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),c["!fullref"]=c["!ref"],c["!ref"]=mr(E))}return B.length>0&&(c["!merges"]=B),O.length>0&&(c["!cols"]=O),R.length>0&&(c["!rows"]=R),c}function NP(t){var r=[],e=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var s=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(r[+s[1]]=e?+s[2]:s[2])});var a=xr((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[r,a,n]}function jP(t,r,e,n,a,o){var s=o||{"!type":"chart"};if(!t)return o;var l=0,c=0,i="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var f=NP(p);u.s.r=u.s.c=0,u.e.c=l,i=bn(l),f[0].forEach(function(h,v){s[i+Mn(v)]={t:"n",v:h,z:f[1]},c=v}),u.e.r<c&&(u.e.r=c),++l}),l>0&&(s["!ref"]=mr(u)),s}function OP(t,r,e,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},s,l=t.match(A4);return l&&o1(l[0],o,a,e),(s=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=s[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function DP(t,r){t.l+=10;var e=Hn(t);return{name:e}}function RP(t,r,e,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},s=!1;return ci(t,function(c,i,u){switch(u){case 550:o["!rel"]=c;break;case 651:a.Sheets[e]||(a.Sheets[e]={}),c.name&&(a.Sheets[e].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(i.T>0)){if(!(i.T<0)){if(!s||r.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},r),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var N4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],MP=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],FP=[],IP=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function B2(t,r){for(var e=0;e!=t.length;++e)for(var n=t[e],a=0;a!=r.length;++a){var o=r[a];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=Br(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function U2(t,r){for(var e=0;e!=r.length;++e){var n=r[e];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Br(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function j4(t){U2(t.WBProps,N4),U2(t.CalcPr,IP),B2(t.WBView,MP),B2(t.Sheets,FP),Yl.date1904=Br(t.WBProps.date1904)}var PP="][*?/\\".split("");function LP(t,r){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return PP.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}var BP=/<\w+:workbook/;function UP(t,r){if(!t)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",o={},s=0;if(t.replace(Wn,function(c,i){var u=Jt(c);switch(Fs(u[0])){case"<?xml":break;case"<workbook":c.match(BP)&&(a="xmlns"+c.match(/<(\w+):/)[1]),e.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],e.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":N4.forEach(function(p){if(u[p[0]]!=null)switch(p[2]){case"bool":e.WBProps[p[0]]=Br(u[p[0]]);break;case"int":e.WBProps[p[0]]=parseInt(u[p[0]],10);break;default:e.WBProps[p[0]]=u[p[0]]}}),u.codeName&&(e.WBProps.CodeName=Ir(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],e.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=xr(Ir(u.name)),delete u[0],e.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=Ir(u.name),u.comment&&(o.Comment=u.comment),u.localSheetId&&(o.Sheet=+u.localSheetId),Br(u.hidden||"0")&&(o.Hidden=!0),s=i+c.length;break;case"</definedName>":o.Ref=xr(Ir(t.slice(s,i))),e.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete u[0],e.CalcPr=u;break;case"<calcPr/>":delete u[0],e.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),aO.indexOf(e.xmlns)===-1)throw new Error("Unknown Namespace: "+e.xmlns);return j4(e),e}function zP(t,r){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=em(t),e.name=Hn(t),e}function $P(t,r){var e={},n=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var a=r>8?Hn(t):"";return a.length>0&&(e.CodeName=a),e.autoCompressPictures=!!(n&65536),e.backupFile=!!(n&64),e.checkCompatibility=!!(n&4096),e.date1904=!!(n&1),e.filterPrivacy=!!(n&8),e.hidePivotFieldList=!!(n&1024),e.promptedSolutions=!!(n&16),e.publishItems=!!(n&2048),e.refreshAllConnections=!!(n&262144),e.saveExternalLinkValues=!!(n&128),e.showBorderUnselectedTables=!!(n&4),e.showInkAnnotation=!!(n&32),e.showObjects=["all","placeholders","none"][n>>13&3],e.showPivotChartFilter=!!(n&32768),e.updateLinks=["userSet","never","always"][n>>8&3],e}function VP(t,r){var e={};return t.read_shift(4),e.ArchID=t.read_shift(4),t.l+=r-8,e}function HP(t,r,e){var n=t.l+r;t.l+=4,t.l+=1;var a=t.read_shift(4),o=_O(t),s=AI(t,0,e),l=e1(t);t.l=n;var c={Name:o,Ptg:s};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function qP(t,r){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;r||(r={}),r.biff=12;var o=[],s=[[]];return s.SheetNames=[],s.XTI=[],Lf[16]={n:"BrtFRTArchID$",f:VP},ci(t,function(c,i,u){switch(u){case 156:s.SheetNames.push(c.name),e.Sheets.push(c);break;case 153:e.WBProps=c;break;case 39:c.Sheet!=null&&(r.SID=c.Sheet),c.Ref=Bn(c.Ptg,null,null,s,r),delete r.SID,delete c.Ptg,o.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([u,c]):s[0]=[u,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!i.T){if(!a||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},r),j4(e),e.Names=o,e.supbooks=s,e}function WP(t,r,e){return r.slice(-4)===".bin"?qP(t,e):UP(t,e)}function GP(t,r,e,n,a,o,s,l){return r.slice(-4)===".bin"?CP(t,n,e,a,o,s,l):zI(t,n,e,a,o,s,l)}function YP(t,r,e,n,a,o,s,l){return r.slice(-4)===".bin"?RP(t,n,e,a,o):OP(t,n,e,a,o)}function XP(t,r,e,n,a,o,s,l){return r.slice(-4)===".bin"?nF():aF()}function KP(t,r,e,n,a,o,s,l){return r.slice(-4)===".bin"?tF():rF()}function ZP(t,r,e,n){return r.slice(-4)===".bin"?bM(t,e,n):fM(t,e,n)}function JP(t,r,e){return g4(t,e)}function QP(t,r,e){return r.slice(-4)===".bin"?MR(t,e):DR(t,e)}function eL(t,r,e){return r.slice(-4)===".bin"?JM(t,e):GM(t,e)}function tL(t,r,e){return r.slice(-4)===".bin"?HM(t):$M(t)}function rL(t,r,e,n){return e.slice(-4)===".bin"?qM(t,r,e,n):void 0}function nL(t,r,e){return r.slice(-4)===".bin"?UM(t,r,e):zM(t,r,e)}var O4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,D4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ts(t,r){var e=t.split(/\s+/),n=[];if(n[0]=e[0],e.length===1)return n;var a=t.match(O4),o,s,l,c;if(a)for(c=0;c!=a.length;++c)o=a[c].match(D4),(s=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?l="xmlns"+o[1].slice(6):l=o[1].slice(s+1),n[l]=o[2].slice(1,o[2].length-1));return n}function aL(t){var r=t.split(/\s+/),e={};if(r.length===1)return e;var n=t.match(O4),a,o,s,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(D4),(o=a[1].indexOf(":"))===-1?e[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(o+1),e[s]=a[2].slice(1,a[2].length-1));return e}var bu;function sL(t,r){var e=bu[t]||xr(t);return e==="General"?Bo(r):Ha(e,r)}function iL(t,r,e,n){var a=n;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Br(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=kn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}t[xr(r)]=a}function oL(t,r,e){if(t.t!=="z"){if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Wo[t.v]:r==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Ou(t.v):t.w=Bo(t.v):t.w=sL(r||"General",t.v)}catch(o){if(e.WTF)throw o}try{var n=bu[r]||r||"General";if(e.cellNF&&(t.z=n),e.cellDates&&t.t=="n"&&rc(n)){var a=Fo(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(e.WTF)throw o}}}function lL(t,r,e){if(e.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=iM[n.Pattern]||n.Pattern)}t[r.ID]=r}function cL(t,r,e,n,a,o,s,l,c,i){var u="General",p=n.StyleID,f={};i=i||{};var h=[],v=0;for(p===void 0&&l&&(p=l.StyleID),p===void 0&&s&&(p=s.StyleID);o[p]!==void 0&&(o[p].nf&&(u=o[p].nf),o[p].Interior&&h.push(o[p].Interior),!!o[p].Parent);)p=o[p].Parent;switch(e.Type){case"Boolean":n.t="b",n.v=Br(t);break;case"String":n.t="s",n.r=l2(xr(t)),n.v=t.indexOf("<")>-1?xr(r||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(kn(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=xr(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Y_[t],i.cellText!==!1&&(n.w=t);break;default:t==""&&r==""?n.t="z":(n.t="s",n.v=l2(r||t));break}if(oL(n,u,i),i.cellFormula!==!1)if(n.Formula){var b=xr(n.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),n.f=Gl(b,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Gl("RC:RC",a):n.ArrayRange&&(n.F=Gl(n.ArrayRange,a),c.push([Yr(n.F),n.F]))}else for(v=0;v<c.length;++v)a.r>=c[v][0].s.r&&a.r<=c[v][0].e.r&&a.c>=c[v][0].s.c&&a.c<=c[v][0].e.c&&(n.F=c[v][1]);i.cellStyles&&(h.forEach(function(g){!f.patternType&&g.patternType&&(f.patternType=g.patternType)}),n.s=f),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function uL(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Tp(t,r){var e=r||{};y_();var n=au(Xm(t));(e.type=="binary"||e.type=="array"||e.type=="base64")&&(n=Ir(n));var a=n.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=Rn(e);return s.type="string",Mu.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ce){a.indexOf("<"+ce)>=0&&(o=!0)}),o)return xL(n,e);bu={"General Number":"General","General Date":rr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":rr[15],"Short Date":rr[14],"Long Time":rr[19],"Medium Time":rr[18],"Short Time":rr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:rr[2],Standard:rr[4],Percent:rr[10],Scientific:rr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],i,u={},p=[],f=e.dense?[]:{},h="",v={},b={},g=ts('<Data ss:Type="String">'),x=0,y=0,k=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},F={},B={},W="",V=0,q=[],X={},I={},H=0,O=[],R=[],C={},w=[],E,A=!1,T=[],D=[],U={},P=0,K=0,Y={Sheets:[],WBProps:{date1904:!1}},re={};Ru.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var z="";l=Ru.exec(n);)switch(l[3]=(z=l[3]).toLowerCase()){case"data":if(z=="data"){if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?cL(n.slice(x,l.index),W,g,c[c.length-1][0]=="comment"?C:v,{c:y,r:k},F,w[y],b,T,e):(W="",g=ts(l[0]),x=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(R.length>0&&(v.c=R),(!e.sheetRows||e.sheetRows>k)&&v.v!==void 0&&(e.dense?(f[k]||(f[k]=[]),f[k][y]=v):f[bn(y)+Mn(k)]=v),v.HRef&&(v.l={Target:xr(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(P=y+(parseInt(v.MergeAcross,10)|0),K=k+(parseInt(v.MergeDown,10)|0),q.push({s:{c:y,r:k},e:{c:P,r:K}})),!e.sheetStubs)v.MergeAcross?y=P+1:++y;else if(v.MergeAcross||v.MergeDown){for(var ee=y;ee<=P;++ee)for(var L=k;L<=K;++L)(ee>y||L>k)&&(e.dense?(f[L]||(f[L]=[]),f[L][ee]={t:"z"}):f[bn(ee)+Mn(L)]={t:"z"});y=P+1}else++y;else v=aL(l[0]),v.Index&&(y=+v.Index-1),y<N.s.c&&(N.s.c=y),y>N.e.c&&(N.e.c=y),l[0].slice(-2)==="/>"&&++y,R=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(k<N.s.r&&(N.s.r=k),k>N.e.r&&(N.e.r=k),l[0].slice(-2)==="/>"&&(b=ts(l[0]),b.Index&&(k=+b.Index-1)),y=0,++k):(b=ts(l[0]),b.Index&&(k=+b.Index-1),U={},(b.AutoFitHeight=="0"||b.Height)&&(U.hpx=parseInt(b.Height,10),U.hpt=m4(U.hpx),D[k]=U),b.Hidden=="1"&&(U.hidden=!0,D[k]=U));break;case"worksheet":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"));p.push(h),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(f["!ref"]=mr(N),e.sheetRows&&e.sheetRows<=N.e.r&&(f["!fullref"]=f["!ref"],N.e.r=e.sheetRows-1,f["!ref"]=mr(N))),q.length&&(f["!merges"]=q),w.length>0&&(f["!cols"]=w),D.length>0&&(f["!rows"]=D),u[h]=f}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},k=y=0,c.push([l[3],!1]),i=ts(l[0]),h=xr(i.Name),f=e.dense?[]:{},q=[],T=[],D=[],re={name:h,Hidden:0},Y.Sheets.push(re);break;case"table":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),w=[],A=!1}break;case"style":l[1]==="/"?lL(F,B,e):B=ts(l[0]);break;case"numberformat":B.nf=xr(ts(l[0]).Format||"General"),bu[B.nf]&&(B.nf=bu[B.nf]);for(var M=0;M!=392&&rr[M]!=B.nf;++M);if(M==392){for(M=57;M!=392;++M)if(rr[M]==null){Po(B.nf,M);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(E=ts(l[0]),E.Hidden&&(E.hidden=!0,delete E.Hidden),E.Width&&(E.wpx=parseInt(E.Width,10)),!A&&E.wpx>10){A=!0,Zn=h4;for(var Z=0;Z<w.length;++Z)w[Z]&&Jl(w[Z])}A&&Jl(E),w[E.Index-1||w.length]=E;for(var se=0;se<+E.Span;++se)w[w.length]=Rn(E);break;case"namedrange":if(l[1]==="/")break;Y.Names||(Y.Names=[]);var ae=Jt(l[0]),ne={Name:ae.Name,Ref:Gl(ae.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(ne.Sheet=Y.Sheets.length-1),Y.Names.push(ne);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?W+=n.slice(V,l.index):V=l.index+l[0].length;break;case"interior":if(!e.cellStyles)break;B.Interior=ts(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?GO(X,z,n.slice(H,l.index)):H=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"));uL(C),R.push(C)}else c.push([l[3],!1]),i=ts(l[0]),C={a:i.Author};break;case"autofilter":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var Q=ts(l[0]);f["!autofilter"]={ref:Gl(Q.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((i=c.pop())[0]!==l[3])throw new Error("Bad state: "+i.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return W2(n,e);var fe=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:fe=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:fe=!1}break;case"excelworkbook":switch(l[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:fe=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:fe=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(H,l.index)){case"SheetHidden":re.Hidden=1;break;case"SheetVeryHidden":re.Hidden=2;break}else H=l.index+l[0].length;break;case"header":f["!margins"]||vu(f["!margins"]={},"xlml"),isNaN(+Jt(l[0]).Margin)||(f["!margins"].header=+Jt(l[0]).Margin);break;case"footer":f["!margins"]||vu(f["!margins"]={},"xlml"),isNaN(+Jt(l[0]).Margin)||(f["!margins"].footer=+Jt(l[0]).Margin);break;case"pagemargins":var le=Jt(l[0]);f["!margins"]||vu(f["!margins"]={},"xlml"),isNaN(+le.Top)||(f["!margins"].top=+le.Top),isNaN(+le.Left)||(f["!margins"].left=+le.Left),isNaN(+le.Right)||(f["!margins"].right=+le.Right),isNaN(+le.Bottom)||(f["!margins"].bottom=+le.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:fe=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:fe=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:fe=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:fe=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:fe=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:fe=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:fe=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:fe=!1}break;case"smarttags":break;default:fe=!1;break}if(fe||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?iL(I,z,O,n.slice(H,l.index)):(O=l,H=l.index+l[0].length);break}if(e.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var te={};return!e.bookSheets&&!e.bookProps&&(te.Sheets=u),te.SheetNames=p,te.Workbook=Y,te.SSF=Rn(rr),te.Props=X,te.Custprops=I,te}function am(t,r){switch(u1(r=r||{}),r.type||"base64"){case"base64":return Tp(Ta(t),r);case"binary":case"buffer":case"file":return Tp(t,r);case"array":return Tp(Vo(t),r)}}function dL(t){var r={},e=t.content;if(e.l=28,r.AnsiUserType=e.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=EO(e),e.length-e.l<=4)return r;var n=e.read_shift(4);if(n==0||n>40||(e.l-=4,r.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||(n=e.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=TO(e),n=e.read_shift(4),n==0||n>40))return r;e.l-=4,r.Reserved2=e.read_shift(0,"lpwstr")}var fL=[60,1084,2066,2165,2175];function hL(t,r,e,n,a){var o=n,s=[],l=e.slice(e.l,e.l+o);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}s.push(l),e.l+=o;for(var c=ni(e,e.l),i=sm[c],u=0;i!=null&&fL.indexOf(c)>-1;)o=ni(e,e.l+2),u=e.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),l=e.slice(u,e.l+4+o),s.push(l),e.l+=4+o,i=sm[c=ni(e,e.l)];var p=qi(s);On(p,0);var f=0;p.lens=[];for(var h=0;h<s.length;++h)p.lens.push(f),f+=s[h].length;if(p.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+p.length+" < "+n;return r.f(p,p.length,a)}function ws(t,r,e){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,r.cellNF&&(t.z=rr[n])}catch(o){if(r.WTF)throw o}if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Wo[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Ou(t.v):t.w=Bo(t.v):t.w=Ha(n,t.v,{date1904:!!e,dateNF:r&&r.dateNF})}catch(o){if(r.WTF)throw o}if(r.cellDates&&n&&t.t=="n"&&rc(rr[n]||String(n))){var a=Fo(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function wf(t,r,e){return{v:t,ixfe:r,t:e}}function pL(t,r){var e={opts:{}},n={},a=r.dense?[]:{},o={},s={},l=null,c=[],i="",u={},p,f="",h,v,b,g,x={},y=[],k,N,F=[],B=[],W={Sheets:[],WBProps:{date1904:!1},Views:[{}]},V={},q=function(ot){return ot<8?Lo[ot]:ot<64&&B[ot-8]||Lo[ot]},X=function(ot,De,ht){var rt=De.XF.data;if(!(!rt||!rt.patternType||!ht||!ht.cellStyles)){De.s={},De.s.patternType=rt.patternType;var it;(it=Fu(q(rt.icvFore)))&&(De.s.fgColor={rgb:it}),(it=Fu(q(rt.icvBack)))&&(De.s.bgColor={rgb:it})}},I=function(ot,De,ht){if(!(U>1)&&!(ht.sheetRows&&ot.r>=ht.sheetRows)){if(ht.cellStyles&&De.XF&&De.XF.data&&X(ot,De,ht),delete De.ixfe,delete De.XF,p=ot,f=Qt(ot),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),ot.r<s.s.r&&(s.s.r=ot.r),ot.c<s.s.c&&(s.s.c=ot.c),ot.r+1>s.e.r&&(s.e.r=ot.r+1),ot.c+1>s.e.c&&(s.e.c=ot.c+1),ht.cellFormula&&De.f){for(var rt=0;rt<y.length;++rt)if(!(y[rt][0].s.c>ot.c||y[rt][0].s.r>ot.r)&&!(y[rt][0].e.c<ot.c||y[rt][0].e.r<ot.r)){De.F=mr(y[rt][0]),(y[rt][0].s.c!=ot.c||y[rt][0].s.r!=ot.r)&&delete De.f,De.f&&(De.f=""+Bn(y[rt][1],s,ot,T,H));break}}ht.dense?(a[ot.r]||(a[ot.r]=[]),a[ot.r][ot.c]=De):a[f]=De}},H={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(H.password=r.password);var O,R=[],C=[],w=[],E=[],A=!1,T=[];T.SheetNames=H.snames,T.sharedf=H.sharedf,T.arrayf=H.arrayf,T.names=[],T.XTI=[];var D=0,U=0,P=0,K=[],Y=[],re;H.codepage=1200,ls(1200);for(var z=!1;t.l<t.length-1;){var ee=t.l,L=t.read_shift(2);if(L===0&&D===10)break;var M=t.l===t.length?0:t.read_shift(2),Z=sm[L];if(Z&&Z.f){if(r.bookSheets&&D===133&&L!==133)break;if(D=L,Z.r===2||Z.r==12){var se=t.read_shift(2);if(M-=2,!H.enc&&se!==L&&((se&255)<<8|se>>8)!==L)throw new Error("rt mismatch: "+se+"!="+L);Z.r==12&&(t.l+=10,M-=10)}var ae={};if(L===10?ae=Z.f(t,M,H):ae=hL(L,Z,t,M,H),U==0&&[9,521,1033,2057].indexOf(D)===-1)continue;switch(L){case 34:e.opts.Date1904=W.WBProps.date1904=ae;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(H.enc||(t.l=0),H.enc=ae,!r.password)throw new Error("File is password-protected");if(ae.valid==null)throw new Error("Encryption scheme unsupported");if(!ae.valid)throw new Error("Password is incorrect");break;case 92:H.lastuser=ae;break;case 66:var ne=Number(ae);switch(ne){case 21010:ne=1200;break;case 32768:ne=1e4;break;case 32769:ne=1252;break}ls(H.codepage=ne),z=!0;break;case 317:H.rrtabid=ae;break;case 25:H.winlocked=ae;break;case 439:e.opts.RefreshAll=ae;break;case 12:e.opts.CalcCount=ae;break;case 16:e.opts.CalcDelta=ae;break;case 17:e.opts.CalcIter=ae;break;case 13:e.opts.CalcMode=ae;break;case 14:e.opts.CalcPrecision=ae;break;case 95:e.opts.CalcSaveRecalc=ae;break;case 15:H.CalcRefMode=ae;break;case 2211:e.opts.FullCalc=ae;break;case 129:ae.fDialog&&(a["!type"]="dialog"),ae.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),ae.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:F.push(ae);break;case 430:T.push([ae]),T[T.length-1].XTI=[];break;case 35:case 547:T[T.length-1].push(ae);break;case 24:case 536:re={Name:ae.Name,Ref:Bn(ae.rgce,s,null,T,H)},ae.itab>0&&(re.Sheet=ae.itab-1),T.names.push(re),T[0]||(T[0]=[],T[0].XTI=[]),T[T.length-1].push(ae),ae.Name=="_xlnm._FilterDatabase"&&ae.itab>0&&ae.rgce&&ae.rgce[0]&&ae.rgce[0][0]&&ae.rgce[0][0][0]=="PtgArea3d"&&(Y[ae.itab-1]={ref:mr(ae.rgce[0][0][1][2])});break;case 22:H.ExternCount=ae;break;case 23:T.length==0&&(T[0]=[],T[0].XTI=[]),T[T.length-1].XTI=T[T.length-1].XTI.concat(ae),T.XTI=T.XTI.concat(ae);break;case 2196:if(H.biff<8)break;re!=null&&(re.Comment=ae[1]);break;case 18:a["!protect"]=ae;break;case 19:ae!==0&&H.WTF&&console.error("Password verifier: "+ae);break;case 133:o[ae.pos]=ae,H.snames.push(ae.name);break;case 10:{if(--U)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=mr(s),r.sheetRows&&r.sheetRows<=s.e.r){var Q=s.e.r;s.e.r=r.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=mr(s),s.e.r=Q}s.e.r++,s.e.c++}R.length>0&&(a["!merges"]=R),C.length>0&&(a["!objects"]=C),w.length>0&&(a["!cols"]=w),E.length>0&&(a["!rows"]=E),W.Sheets.push(V)}i===""?u=a:n[i]=a,a=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(H.biff===8&&(H.biff={9:2,521:3,1033:4}[L]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ae.BIFFVer]||8),H.biffguess=ae.BIFFVer==0,ae.BIFFVer==0&&ae.dt==4096&&(H.biff=5,z=!0,ls(H.codepage=28591)),H.biff==8&&ae.BIFFVer==0&&ae.dt==16&&(H.biff=2),U++)break;if(a=r.dense?[]:{},H.biff<8&&!z&&(z=!0,ls(H.codepage=r.codepage||1252)),H.biff<5||ae.BIFFVer==0&&ae.dt==4096){i===""&&(i="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var fe={pos:t.l-M,name:i};o[fe.pos]=fe,H.snames.push(i)}else i=(o[ee]||{name:""}).name;ae.dt==32&&(a["!type"]="chart"),ae.dt==64&&(a["!type"]="macro"),R=[],C=[],H.arrayf=y=[],w=[],E=[],A=!1,V={Hidden:(o[ee]||{hs:0}).hs,name:i}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(r.dense?(a[ae.r]||[])[ae.c]:a[Qt({c:ae.c,r:ae.r})])&&++ae.c,k={ixfe:ae.ixfe,XF:F[ae.ixfe]||{},v:ae.val,t:"n"},P>0&&(k.z=K[k.ixfe>>8&63]),ws(k,r,e.opts.Date1904),I({c:ae.c,r:ae.r},k,r);break;case 5:case 517:k={ixfe:ae.ixfe,XF:F[ae.ixfe],v:ae.val,t:ae.t},P>0&&(k.z=K[k.ixfe>>8&63]),ws(k,r,e.opts.Date1904),I({c:ae.c,r:ae.r},k,r);break;case 638:k={ixfe:ae.ixfe,XF:F[ae.ixfe],v:ae.rknum,t:"n"},P>0&&(k.z=K[k.ixfe>>8&63]),ws(k,r,e.opts.Date1904),I({c:ae.c,r:ae.r},k,r);break;case 189:for(var le=ae.c;le<=ae.C;++le){var te=ae.rkrec[le-ae.c][0];k={ixfe:te,XF:F[te],v:ae.rkrec[le-ae.c][1],t:"n"},P>0&&(k.z=K[k.ixfe>>8&63]),ws(k,r,e.opts.Date1904),I({c:le,r:ae.r},k,r)}break;case 6:case 518:case 1030:{if(ae.val=="String"){l=ae;break}if(k=wf(ae.val,ae.cell.ixfe,ae.tt),k.XF=F[k.ixfe],r.cellFormula){var ce=ae.formula;if(ce&&ce[0]&&ce[0][0]&&ce[0][0][0]=="PtgExp"){var he=ce[0][0][1][0],Ee=ce[0][0][1][1],ke=Qt({r:he,c:Ee});x[ke]?k.f=""+Bn(ae.formula,s,ae.cell,T,H):k.F=((r.dense?(a[he]||[])[Ee]:a[ke])||{}).F}else k.f=""+Bn(ae.formula,s,ae.cell,T,H)}P>0&&(k.z=K[k.ixfe>>8&63]),ws(k,r,e.opts.Date1904),I(ae.cell,k,r),l=ae}break;case 7:case 519:if(l)l.val=ae,k=wf(ae,l.cell.ixfe,"s"),k.XF=F[k.ixfe],r.cellFormula&&(k.f=""+Bn(l.formula,s,l.cell,T,H)),P>0&&(k.z=K[k.ixfe>>8&63]),ws(k,r,e.opts.Date1904),I(l.cell,k,r),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(ae);var Ce=Qt(ae[0].s);if(h=r.dense?(a[ae[0].s.r]||[])[ae[0].s.c]:a[Ce],r.cellFormula&&h){if(!l||!Ce||!h)break;h.f=""+Bn(ae[1],s,ae[0],T,H),h.F=mr(ae[0])}}break;case 1212:{if(!r.cellFormula)break;if(f){if(!l)break;x[Qt(l.cell)]=ae[0],h=r.dense?(a[l.cell.r]||[])[l.cell.c]:a[Qt(l.cell)],(h||{}).f=""+Bn(ae[0],s,p,T,H)}}break;case 253:k=wf(c[ae.isst].t,ae.ixfe,"s"),c[ae.isst].h&&(k.h=c[ae.isst].h),k.XF=F[k.ixfe],P>0&&(k.z=K[k.ixfe>>8&63]),ws(k,r,e.opts.Date1904),I({c:ae.c,r:ae.r},k,r);break;case 513:r.sheetStubs&&(k={ixfe:ae.ixfe,XF:F[ae.ixfe],t:"z"},P>0&&(k.z=K[k.ixfe>>8&63]),ws(k,r,e.opts.Date1904),I({c:ae.c,r:ae.r},k,r));break;case 190:if(r.sheetStubs)for(var Fe=ae.c;Fe<=ae.C;++Fe){var Pe=ae.ixfe[Fe-ae.c];k={ixfe:Pe,XF:F[Pe],t:"z"},P>0&&(k.z=K[k.ixfe>>8&63]),ws(k,r,e.opts.Date1904),I({c:Fe,r:ae.r},k,r)}break;case 214:case 516:case 4:k=wf(ae.val,ae.ixfe,"s"),k.XF=F[k.ixfe],P>0&&(k.z=K[k.ixfe>>8&63]),ws(k,r,e.opts.Date1904),I({c:ae.c,r:ae.r},k,r);break;case 0:case 512:U===1&&(s=ae);break;case 252:c=ae;break;case 1054:if(H.biff==4){K[P++]=ae[1];for(var Xe=0;Xe<P+163&&rr[Xe]!=ae[1];++Xe);Xe>=163&&Po(ae[1],P+163)}else Po(ae[1],ae[0]);break;case 30:{K[P++]=ae;for(var ct=0;ct<P+163&&rr[ct]!=ae;++ct);ct>=163&&Po(ae,P+163)}break;case 229:R=R.concat(ae);break;case 93:C[ae.cmo[0]]=H.lastobj=ae;break;case 438:H.lastobj.TxO=ae;break;case 127:H.lastobj.ImData=ae;break;case 440:for(g=ae[0].s.r;g<=ae[0].e.r;++g)for(b=ae[0].s.c;b<=ae[0].e.c;++b)h=r.dense?(a[g]||[])[b]:a[Qt({c:b,r:g})],h&&(h.l=ae[1]);break;case 2048:for(g=ae[0].s.r;g<=ae[0].e.r;++g)for(b=ae[0].s.c;b<=ae[0].e.c;++b)h=r.dense?(a[g]||[])[b]:a[Qt({c:b,r:g})],h&&h.l&&(h.l.Tooltip=ae[1]);break;case 28:{if(H.biff<=5&&H.biff>=2)break;h=r.dense?(a[ae[0].r]||[])[ae[0].c]:a[Qt(ae[0])];var st=C[ae[2]];h||(r.dense?(a[ae[0].r]||(a[ae[0].r]=[]),h=a[ae[0].r][ae[0].c]={t:"z"}):h=a[Qt(ae[0])]={t:"z"},s.e.r=Math.max(s.e.r,ae[0].r),s.s.r=Math.min(s.s.r,ae[0].r),s.e.c=Math.max(s.e.c,ae[0].c),s.s.c=Math.min(s.s.c,ae[0].c)),h.c||(h.c=[]),v={a:ae[1],t:st.TxO.t},h.c.push(v)}break;case 2173:IM(F[ae.ixfe],ae.ext);break;case 125:{if(!H.cellStyles)break;for(;ae.e>=ae.s;)w[ae.e--]={width:ae.w/256,level:ae.level||0,hidden:!!(ae.flags&1)},A||(A=!0,s1(ae.w/256)),Jl(w[ae.e+1])}break;case 520:{var lt={};ae.level!=null&&(E[ae.r]=lt,lt.level=ae.level),ae.hidden&&(E[ae.r]=lt,lt.hidden=!0),ae.hpt&&(E[ae.r]=lt,lt.hpt=ae.hpt,lt.hpx=Iu(ae.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||vu(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[L]]=ae;break;case 161:a["!margins"]||vu(a["!margins"]={}),a["!margins"].header=ae.header,a["!margins"].footer=ae.footer;break;case 574:ae.RTL&&(W.Views[0].RTL=!0);break;case 146:B=ae;break;case 2198:O=ae;break;case 140:N=ae;break;case 442:i?V.CodeName=ae||V.name:W.WBProps.CodeName=ae||"ThisWorkbook";break}}else Z||console.error("Missing Info for XLS Record 0x"+L.toString(16)),t.l+=M}return e.SheetNames=Ds(o).sort(function(tt,ot){return Number(tt)-Number(ot)}).map(function(tt){return o[tt].name}),r.bookSheets||(e.Sheets=n),!e.SheetNames.length&&u["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=u)):e.Preamble=u,e.Sheets&&Y.forEach(function(tt,ot){e.Sheets[e.SheetNames[ot]]["!autofilter"]=tt}),e.Strings=c,e.SSF=Rn(rr),H.enc&&(e.Encryption=H.enc),O&&(e.Themes=O),e.Metadata={},N!==void 0&&(e.Metadata.Country=N),T.names.length>0&&(W.Names=T.names),e.Workbook=W,e}var z2={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function mL(t,r,e){var n=pr.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=k2(n,DO,z2.DSI);for(var o in a)r[o]=a[o]}catch(i){if(e.WTF)throw i}var s=pr.find(t,"/!SummaryInformation");if(s&&s.size>0)try{var l=k2(s,RO,z2.SI);for(var c in l)r[c]==null&&(r[c]=l[c])}catch(i){if(e.WTF)throw i}r.HeadingPairs&&r.TitlesOfParts&&(K_(r.HeadingPairs,r.TitlesOfParts,r,e),delete r.HeadingPairs,delete r.TitlesOfParts)}function R4(t,r){r||(r={}),u1(r),l_(),r.codepage&&$m(r.codepage);var e,n;if(t.FullPaths){if(pr.find(t,"/encryption"))throw new Error("File is password-protected");e=pr.find(t,"!CompObj"),n=pr.find(t,"/Workbook")||pr.find(t,"/Book")}else{switch(r.type){case"base64":t=is(Ta(t));break;case"binary":t=is(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}On(t,0),n={content:t}}var a,o;if(e&&dL(e),r.bookProps&&!r.bookSheets)a={};else{var s=fr?"buffer":"array";if(n&&n.content)a=pL(n.content,r);else if((o=pr.find(t,"PerfectOffice_MAIN"))&&o.content)a=mu.to_workbook(o.content,(r.type=s,r));else if((o=pr.find(t,"NativeContent_MAIN"))&&o.content)a=mu.to_workbook(o.content,(r.type=s,r));else throw(o=pr.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&t.FullPaths&&pr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=eF(t))}var l={};return t.FullPaths&&mL(t,l,r),a.Props=a.Custprops=l,r.bookFiles&&(a.cfb=t),a}var Lf={0:{f:KI},1:{f:eP},2:{f:cP},3:{f:aP},4:{f:rP},5:{f:lP},6:{f:fP},7:{f:iP},8:{f:vP},9:{f:gP},10:{f:pP},11:{f:mP},12:{f:tP},13:{f:uP},14:{f:sP},15:{f:nP},16:{f:C4},17:{f:hP},18:{f:oP},19:{f:Qm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:HP},40:{},42:{},43:{f:pM},44:{f:hM},45:{f:mM},46:{f:vM},47:{f:gM},48:{},49:{f:bO},50:{},51:{f:LM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:l4},62:{f:dP},63:{f:VM},64:{f:TP},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:qn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:EP},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:QI},148:{f:ZI,p:16},151:{f:yP},152:{},153:{f:$P},154:{},155:{},156:{f:zP},157:{},158:{},159:{T:1,f:RR},160:{T:-1},161:{T:1,f:qo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:bP},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:PM},336:{T:-1},337:{f:BM,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:em},357:{},358:{},359:{},360:{T:1},361:{},362:{f:o4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:wP},427:{f:_P},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:kP},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:JI},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:xP},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:em},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ZM},633:{T:1},634:{T:-1},635:{T:1,f:KM},636:{T:-1},637:{f:yO},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:DP},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:AP},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},sm={6:{f:kp},10:{f:$i},12:{f:ln},13:{f:ln},14:{f:Zr},15:{f:Zr},16:{f:$n},17:{f:Zr},18:{f:Zr},19:{f:ln},20:{f:C2},21:{f:C2},23:{f:o4},24:{f:j2},25:{f:Zr},26:{},27:{},28:{f:YD},29:{},34:{f:Zr},35:{f:N2},38:{f:$n},39:{f:$n},40:{f:$n},41:{f:$n},42:{f:Zr},43:{f:Zr},47:{f:JR},49:{f:ND},51:{f:ln},60:{},61:{f:TD},64:{f:Zr},65:{f:CD},66:{f:ln},77:{},80:{},81:{},82:{},85:{f:ln},89:{},90:{},91:{},92:{f:bD},93:{f:KD},94:{},95:{f:Zr},96:{},97:{},99:{f:Zr},125:{f:l4},128:{f:BD},129:{f:xD},130:{f:ln},131:{f:Zr},132:{f:Zr},133:{f:yD},134:{},140:{f:rR},141:{f:ln},144:{},146:{f:aR},151:{},152:{},153:{},154:{},155:{},156:{f:ln},157:{},158:{},160:{f:cR},161:{f:iR},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:FD},190:{f:ID},193:{f:$i},197:{},198:{},199:{},200:{},201:{},202:{f:Zr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ln},220:{},221:{f:Zr},222:{},224:{f:LD},225:{f:vD},226:{f:$i},227:{},229:{f:XD},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:wD},253:{f:jD},255:{f:_D},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:t4},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Zr},353:{f:$i},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:zD},431:{f:Zr},432:{},433:{},434:{},437:{},438:{f:QD},439:{f:Zr},440:{f:eR},441:{},442:{f:Yu},443:{},444:{f:ln},445:{},446:{},448:{f:$i},449:{f:ED,r:2},450:{f:$i},512:{f:T2},513:{f:lR},515:{f:UD},516:{f:OD},517:{f:A2},519:{f:uR},520:{f:SD},523:{},545:{f:O2},549:{f:E2},566:{},574:{f:AD},638:{f:MD},659:{},1048:{},1054:{f:DD},1084:{},1212:{f:qD},2048:{f:tR},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:bf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:$i},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:sR,r:12},2173:{f:FM,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Zr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:HD,r:12},2197:{},2198:{f:NM,r:12},2199:{},2200:{},2201:{},2202:{f:WD,r:12},2203:{f:$i},2204:{},2205:{},2206:{},2207:{},2211:{f:kD},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ln},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:oR},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:nR},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:T2},1:{},2:{f:pR},3:{f:hR},4:{f:fR},5:{f:A2},7:{f:mR},8:{},9:{f:bf},11:{},22:{f:ln},30:{f:RD},31:{},32:{},33:{f:O2},36:{},37:{f:E2},50:{f:gR},62:{},52:{},67:{},68:{f:ln},69:{},86:{},126:{},127:{f:dR},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:vR},223:{},234:{},354:{},421:{},518:{f:kp},521:{f:bf},536:{f:j2},547:{f:N2},561:{},579:{},1030:{f:kp},1033:{f:bf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function rs(t,r,e,n){var a=r;if(!isNaN(a)){var o=(e||[]).length||0,s=t.next(4);s.write_shift(2,a),s.write_shift(2,o),o>0&&$_(e)&&t.push(e)}}function $2(t,r){var e=r||{},n=e.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),s=a.index,l=o&&o.index||t.length,c=Uj(t.slice(s,l),/(:?<tr[^>]*>)/i,"<tr>"),i=-1,u=0,p=0,f=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(s=0;s<c.length;++s){var b=c[s].trim(),g=b.slice(0,3).toLowerCase();if(g=="<tr"){if(++i,e.sheetRows&&e.sheetRows<=i){--i;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var x=b.split(/<\/t[dh]>/i);for(l=0;l<x.length;++l){var y=x[l].trim();if(y.match(/<t[dh]/i)){for(var k=y,N=0;k.charAt(0)=="<"&&(N=k.indexOf(">"))>-1;)k=k.slice(N+1);for(var F=0;F<v.length;++F){var B=v[F];B.s.c==u&&B.s.r<i&&i<=B.e.r&&(u=B.e.c+1,F=-1)}var W=Jt(y.slice(0,y.indexOf(">")));f=W.colspan?+W.colspan:1,((p=+W.rowspan)>1||f>1)&&v.push({s:{r:i,c:u},e:{r:i+(p||1)-1,c:u+f-1}});var V=W.t||W["data-t"]||"";if(!k.length){u+=f;continue}if(k=N_(k),h.s.r>i&&(h.s.r=i),h.e.r<i&&(h.e.r=i),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!k.length){u+=f;continue}var q={t:"s",v:k};e.raw||!k.trim().length||V=="s"||(k==="TRUE"?q={t:"b",v:!0}:k==="FALSE"?q={t:"b",v:!1}:isNaN(us(k))?isNaN(Zl(k).getDate())||(q={t:"d",v:kn(k)},e.cellDates||(q={t:"n",v:ta(q.v)}),q.z=e.dateNF||rr[14]):q={t:"n",v:us(k)}),e.dense?(n[i]||(n[i]=[]),n[i][u]=q):n[Qt({r:i,c:u})]=q,u+=f}}}}return n["!ref"]=mr(h),v.length&&(n["!merges"]=v),n}function gL(t,r,e,n){for(var a=t["!merges"]||[],o=[],s=r.s.c;s<=r.e.c;++s){for(var l=0,c=0,i=0;i<a.length;++i)if(!(a[i].s.r>e||a[i].s.c>s)&&!(a[i].e.r<e||a[i].e.c<s)){if(a[i].s.r<e||a[i].s.c<s){l=-1;break}l=a[i].e.r-a[i].s.r+1,c=a[i].e.c-a[i].s.c+1;break}if(!(l<0)){var u=Qt({r:e,c:s}),p=n.dense?(t[e]||[])[s]:t[u],f=p&&p.v!=null&&(p.h||Ym(p.w||(ii(p),p.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?f='<span contenteditable="true">'+f+"</span>":p&&(h["data-t"]=p&&p.t||"z",p.v!=null&&(h["data-v"]=p.v),p.z!=null&&(h["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+p.l.Target+'">'+f+"</a>")),h.id=(n.id||"sjs")+"-"+u,o.push(rO("td",f,h))}}var v="<tr>";return v+o.join("")+"</tr>"}var vL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',bL="</body></html>";function xL(t,r){var e=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||e.length==0)throw new Error("Invalid HTML: could not find <table>");if(e.length==1)return no($2(e[0],r),r);var n=f1();return e.forEach(function(a,o){h1(n,$2(a,r),"Sheet"+(o+1))}),n}function yL(t,r,e){var n=[];return n.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function wL(t,r){var e=r||{},n=e.header!=null?e.header:vL,a=e.footer!=null?e.footer:bL,o=[n],s=nc(t["!ref"]);e.dense=Array.isArray(t),o.push(yL(t,s,e));for(var l=s.s.r;l<=s.e.r;++l)o.push(gL(t,s,l,e));return o.push("</table>"+a),o.join("")}function M4(t,r,e){var n=e||{},a=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?Qn(n.origin):n.origin;a=s.r,o=s.c}var l=r.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),i={s:{r:0,c:0},e:{r:a,c:o}};if(t["!ref"]){var u=nc(t["!ref"]);i.s.r=Math.min(i.s.r,u.s.r),i.s.c=Math.min(i.s.c,u.s.c),i.e.r=Math.max(i.e.r,u.e.r),i.e.c=Math.max(i.e.c,u.e.c),a==-1&&(i.e.r=a=u.e.r+1)}var p=[],f=0,h=t["!rows"]||(t["!rows"]=[]),v=0,b=0,g=0,x=0,y=0,k=0;for(t["!cols"]||(t["!cols"]=[]);v<l.length&&b<c;++v){var N=l[v];if(V2(N)){if(n.display)continue;h[b]={hidden:!0}}var F=N.children;for(g=x=0;g<F.length;++g){var B=F[g];if(!(n.display&&V2(B))){var W=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):N_(B.innerHTML),V=B.getAttribute("data-z")||B.getAttribute("z");for(f=0;f<p.length;++f){var q=p[f];q.s.c==x+o&&q.s.r<b+a&&b+a<=q.e.r&&(x=q.e.c+1-o,f=-1)}k=+B.getAttribute("colspan")||1,((y=+B.getAttribute("rowspan")||1)>1||k>1)&&p.push({s:{r:b+a,c:x+o},e:{r:b+a+(y||1)-1,c:x+o+(k||1)-1}});var X={t:"s",v:W},I=B.getAttribute("data-t")||B.getAttribute("t")||"";W!=null&&(W.length==0?X.t=I||"z":n.raw||W.trim().length==0||I=="s"||(W==="TRUE"?X={t:"b",v:!0}:W==="FALSE"?X={t:"b",v:!1}:isNaN(us(W))?isNaN(Zl(W).getDate())||(X={t:"d",v:kn(W)},n.cellDates||(X={t:"n",v:ta(X.v)}),X.z=n.dateNF||rr[14]):X={t:"n",v:us(W)})),X.z===void 0&&V!=null&&(X.z=V);var H="",O=B.getElementsByTagName("A");if(O&&O.length)for(var R=0;R<O.length&&!(O[R].hasAttribute("href")&&(H=O[R].getAttribute("href"),H.charAt(0)!="#"));++R);H&&H.charAt(0)!="#"&&(X.l={Target:H}),n.dense?(t[b+a]||(t[b+a]=[]),t[b+a][x+o]=X):t[Qt({c:x+o,r:b+a})]=X,i.e.c<x+o&&(i.e.c=x+o),x+=k}}++b}return p.length&&(t["!merges"]=(t["!merges"]||[]).concat(p)),i.e.r=Math.max(i.e.r,b-1+a),t["!ref"]=mr(i),b>=c&&(t["!fullref"]=mr((i.e.r=l.length-v+b-1+a,i))),t}function F4(t,r){var e=r||{},n=e.dense?[]:{};return M4(n,t,r)}function _L(t,r){return no(F4(t,r),r)}function V2(t){var r="",e=SL(t);return e&&(r=e(t).getPropertyValue("display")),r||(r=t.style&&t.style.display),r==="none"}function SL(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function kL(t){var r=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),e=xr(r.replace(/<[^>]*>/g,""));return[e]}var H2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function I4(t,r){var e=r||{},n=Xm(t),a=[],o,s,l={name:""},c="",i=0,u,p,f={},h=[],v=e.dense?[]:{},b,g,x={value:""},y="",k=0,N=[],F=-1,B=-1,W={s:{r:1e6,c:1e7},e:{r:0,c:0}},V=0,q={},X=[],I={},H=0,O=0,R=[],C=1,w=1,E=[],A={Names:[]},T={},D=["",""],U=[],P={},K="",Y=0,re=!1,z=!1,ee=0;for(Ru.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=Ru.exec(n);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(W.e.c>=W.s.c&&W.e.r>=W.s.r?v["!ref"]=mr(W):v["!ref"]="A1:A1",e.sheetRows>0&&e.sheetRows<=W.e.r&&(v["!fullref"]=v["!ref"],W.e.r=e.sheetRows-1,v["!ref"]=mr(W)),X.length&&(v["!merges"]=X),R.length&&(v["!rows"]=R),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),f[u.name]=v,z=!1):b[0].charAt(b[0].length-2)!=="/"&&(u=Jt(b[0],!1),F=B=-1,W.s.r=W.s.c=1e7,W.e.r=W.e.c=0,v=e.dense?[]:{},X=[],R=[],z=!0);break;case"table-row-group":b[1]==="/"?--V:++V;break;case"table-row":case"":if(b[1]==="/"){F+=C,C=1;break}if(p=Jt(b[0],!1),p.?F=p.-1:F==-1&&(F=0),C=+p["number-rows-repeated"]||1,C<10)for(ee=0;ee<C;++ee)V>0&&(R[F+ee]={level:V});B=-1;break;case"covered-table-cell":b[1]!=="/"&&++B,e.sheetStubs&&(e.dense?(v[F]||(v[F]=[]),v[F][B]={t:"z"}):v[Qt({r:F,c:B})]={t:"z"}),y="",N=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++B,x=Jt(b[0],!1),w=parseInt(x["number-columns-repeated"]||"1",10),g={t:"z",v:null},x.formula&&e.cellFormula!=!1&&(g.f=L2(xr(x.formula))),(x.||x["value-type"])=="string"&&(g.t="s",g.v=xr(x["string-value"]||""),e.dense?(v[F]||(v[F]=[]),v[F][B]=g):v[Qt({r:F,c:B})]=g),B+=w-1;else if(b[1]!=="/"){++B,y="",k=0,N=[],w=1;var L=C?F+C-1:F;if(B>W.e.c&&(W.e.c=B),B<W.s.c&&(W.s.c=B),F<W.s.r&&(W.s.r=F),L>W.e.r&&(W.e.r=L),x=Jt(b[0],!1),U=[],P={},g={t:x.||x["value-type"],v:null},e.cellFormula)if(x.formula&&(x.formula=xr(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(H=parseInt(x["number-matrix-rows-spanned"],10)||0,O=parseInt(x["number-matrix-columns-spanned"],10)||0,I={s:{r:F,c:B},e:{r:F+H-1,c:B+O-1}},g.F=mr(I),E.push([I,g.F])),x.formula)g.f=L2(x.formula);else for(ee=0;ee<E.length;++ee)F>=E[ee][0].s.r&&F<=E[ee][0].e.r&&B>=E[ee][0].s.c&&B<=E[ee][0].e.c&&(g.F=E[ee][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(H=parseInt(x["number-rows-spanned"],10)||0,O=parseInt(x["number-columns-spanned"],10)||0,I={s:{r:F,c:B},e:{r:F+H-1,c:B+O-1}},X.push(I)),x["number-columns-repeated"]&&(w=parseInt(x["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Br(x["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(x.value);break;case"percentage":g.t="n",g.v=parseFloat(x.value);break;case"currency":g.t="n",g.v=parseFloat(x.value);break;case"date":g.t="d",g.v=kn(x["date-value"]),e.cellDates||(g.t="n",g.v=ta(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=Pj(x["time-value"])/86400,e.cellDates&&(g.t="d",g.v=Zf(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(x.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",x["string-value"]!=null&&(y=xr(x["string-value"]),N=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(re=!1,g.t==="s"&&(g.v=y||"",N.length&&(g.R=N),re=k==0),T.Target&&(g.l=T),U.length>0&&(g.c=U,U=[]),y&&e.cellText!==!1&&(g.w=y),re&&(g.t="z",delete g.v),(!re||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=F))for(var M=0;M<C;++M){if(w=parseInt(x["number-columns-repeated"]||"1",10),e.dense)for(v[F+M]||(v[F+M]=[]),v[F+M][B]=M==0?g:Rn(g);--w>0;)v[F+M][B+w]=Rn(g);else for(v[Qt({r:F+M,c:B})]=g;--w>0;)v[Qt({r:F+M,c:B+w})]=Rn(g);W.e.c<=B&&(W.e.c=B)}w=parseInt(x["number-columns-repeated"]||"1",10),B+=w-1,w=0,g={},y="",N=[]}T={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((o=a.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((o=a.pop())[0]!==b[3])throw"Bad state: "+o;P.t=y,N.length&&(P.R=N),P.a=K,U.push(P)}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);K="",Y=0,y="",k=0,N=[];break;case"creator":b[1]==="/"?K=n.slice(Y,b.index):Y=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((o=a.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);y="",k=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(q[l.name]=c,(o=a.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&(c="",l=Jt(b[0],!1),a.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=Jt(b[0],!1),c+=H2[b[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=Jt(b[0],!1),c+=H2[b[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(i,b.index);break}else i=b.index+b[0].length;break;case"named-range":s=Jt(b[0],!1),D=Ep(s["cell-range-address"]);var Z={Name:s.name,Ref:D[0]+"!"+D[1]};z&&(Z.Sheet=h.length),A.Names.push(Z);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(b[1]==="/"&&(!x||!x["string-value"])){var se=kL(n.slice(k,b.index));y=(y.length>0?y+`
`:"")+se[0]}else Jt(b[0],!1),k=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{D=Ep(Jt(b[0])["target-range-address"]),f[D[0]]["!autofilter"]={ref:D[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(T=Jt(b[0],!1),!T.href)break;T.Target=xr(T.href),delete T.href,T.Target.charAt(0)=="#"&&T.Target.indexOf(".")>-1?(D=Ep(T.Target.slice(1)),T.Target="#"+D[0]+"!"+D[1]):T.Target.match(/^\.\.[\\\/]/)&&(T.Target=T.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(e.WTF)throw new Error(b)}}var ae={Sheets:f,SheetNames:h,Workbook:A};return e.bookSheets&&delete ae.Sheets,ae}function q2(t,r){r=r||{},La(t,"META-INF/manifest.xml")&&UO(on(t,"META-INF/manifest.xml"),r);var e=ka(t,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var n=I4(Ir(e),r);return La(t,"meta.xml")&&(n.Props=X_(on(t,"meta.xml"))),n}function W2(t,r){return I4(t,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function l1(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function im(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Ir(Vo(t))}function om(t){var r=t.reduce(function(a,o){return a+o.length},0),e=new Uint8Array(r),n=0;return t.forEach(function(a){e.set(a,n),n+=a.length}),e}function G2(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function EL(t,r){for(var e=(t[r+15]&127)<<7|t[r+14]>>1,n=t[r+14]&1,a=r+13;a>=r;--a)n=n*256+t[a];return(t[r+15]&128?-n:n)*Math.pow(10,e-6176)}function Pu(t,r){var e=r?r[0]:0,n=t[e]&127;e:if(t[e++]>=128&&(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,28),++e,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,35),++e,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,42),++e,t[e++]<128)))break e;return r&&(r[0]=e),n}function xn(t){var r=0,e=t[r]&127;e:if(t[r++]>=128){if(e|=(t[r]&127)<<7,t[r++]<128||(e|=(t[r]&127)<<14,t[r++]<128)||(e|=(t[r]&127)<<21,t[r++]<128))break e;e|=(t[r]&127)<<28}return e}function Vn(t){for(var r=[],e=[0];e[0]<t.length;){var n=e[0],a=Pu(t,e),o=a&7;a=Math.floor(a/8);var s=0,l;if(a==0)break;switch(o){case 0:{for(var c=e[0];t[e[0]++]>=128;);l=t.slice(c,e[0])}break;case 5:s=4,l=t.slice(e[0],e[0]+s),e[0]+=s;break;case 1:s=8,l=t.slice(e[0],e[0]+s),e[0]+=s;break;case 2:s=Pu(t,e),l=t.slice(e[0],e[0]+s),e[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(n))}var i={data:l,type:o};r[a]==null?r[a]=[i]:r[a].push(i)}return r}function c1(t,r){return(t==null?void 0:t.map(function(e){return r(e.data)}))||[]}function TL(t){for(var r,e=[],n=[0];n[0]<t.length;){var a=Pu(t,n),o=Vn(t.slice(n[0],n[0]+a));n[0]+=a;var s={id:xn(o[1][0].data),messages:[]};o[2].forEach(function(l){var c=Vn(l.data),i=xn(c[3][0].data);s.messages.push({meta:c,data:t.slice(n[0],n[0]+i)}),n[0]+=i}),(r=o[3])!=null&&r[0]&&(s.merge=xn(o[3][0].data)>>>0>0),e.push(s)}return e}function AL(t,r){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],n=Pu(r,e),a=[];e[0]<r.length;){var o=r[e[0]]&3;if(o==0){var s=r[e[0]++]>>2;if(s<60)++s;else{var l=s-59;s=r[e[0]],l>1&&(s|=r[e[0]+1]<<8),l>2&&(s|=r[e[0]+2]<<16),l>3&&(s|=r[e[0]+3]<<24),s>>>=0,s++,e[0]+=l}a.push(r.slice(e[0],e[0]+s)),e[0]+=s;continue}else{var c=0,i=0;if(o==1?(i=(r[e[0]]>>2&7)+4,c=(r[e[0]++]&224)<<3,c|=r[e[0]++]):(i=(r[e[0]++]>>2)+1,o==2?(c=r[e[0]]|r[e[0]+1]<<8,e[0]+=2):(c=(r[e[0]]|r[e[0]+1]<<8|r[e[0]+2]<<16|r[e[0]+3]<<24)>>>0,e[0]+=4)),a=[om(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(i>=c)for(a.push(a[0].slice(-c)),i-=c;i>=a[a.length-1].length;)a.push(a[a.length-1]),i-=a[a.length-1].length;a.push(a[0].slice(-c,-c+i))}}var u=om(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function CL(t){for(var r=[],e=0;e<t.length;){var n=t[e++],a=t[e]|t[e+1]<<8|t[e+2]<<16;e+=3,r.push(AL(n,t.slice(e,e+a))),e+=a}if(e!==t.length)throw new Error("data is not a valid framed stream!");return om(r)}function NL(t,r,e,n){var a=l1(t),o=a.getUint32(4,!0),s=(n>1?12:8)+G2(o&(n>1?3470:398))*4,l=-1,c=-1,i=NaN,u=new Date(2001,0,1);o&512&&(l=a.getUint32(s,!0),s+=4),s+=G2(o&(n>1?12288:4096))*4,o&16&&(c=a.getUint32(s,!0),s+=4),o&32&&(i=a.getFloat64(s,!0),s+=8),o&64&&(u.setTime(u.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var p;switch(t[2]){case 0:break;case 2:p={t:"n",v:i};break;case 3:p={t:"s",v:r[c]};break;case 5:p={t:"d",v:u};break;case 6:p={t:"b",v:i>0};break;case 7:p={t:"n",v:i/86400};break;case 8:p={t:"e",v:0};break;case 9:if(l>-1)p={t:"s",v:e[l]};else if(c>-1)p={t:"s",v:r[c]};else if(!isNaN(i))p={t:"n",v:i};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return p}function jL(t,r,e){var n=l1(t),a=n.getUint32(8,!0),o=12,s=-1,l=-1,c=NaN,i=NaN,u=new Date(2001,0,1);a&1&&(c=EL(t,o),o+=16),a&2&&(i=n.getFloat64(o,!0),o+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(o,!0)*1e3),o+=8),a&8&&(l=n.getUint32(o,!0),o+=4),a&16&&(s=n.getUint32(o,!0),o+=4);var p;switch(t[1]){case 0:break;case 2:p={t:"n",v:c};break;case 3:p={t:"s",v:r[l]};break;case 5:p={t:"d",v:u};break;case 6:p={t:"b",v:i>0};break;case 7:p={t:"n",v:i/86400};break;case 8:p={t:"e",v:0};break;case 9:if(s>-1)p={t:"s",v:e[s]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:p={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return p}function OL(t,r,e){switch(t[0]){case 0:case 1:case 2:case 3:return NL(t,r,e,t[0]);case 5:return jL(t,r,e);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Zi(t){var r=Vn(t);return Pu(r[1][0].data)}function Y2(t,r){var e=Vn(r.data),n=xn(e[1][0].data),a=e[3],o=[];return(a||[]).forEach(function(s){var l=Vn(s.data),c=xn(l[1][0].data)>>>0;switch(n){case 1:o[c]=im(l[3][0].data);break;case 8:{var i=t[Zi(l[9][0].data)][0],u=Vn(i.data),p=t[Zi(u[1][0].data)][0],f=xn(p.meta[1][0].data);if(f!=2001)throw new Error("2000 unexpected reference to ".concat(f));var h=Vn(p.data);o[c]=h[3].map(function(v){return im(v.data)}).join("")}break}}),o}function DL(t,r){var e,n,a,o,s,l,c,i,u,p,f,h,v,b,g=Vn(t),x=xn(g[1][0].data)>>>0,y=xn(g[2][0].data)>>>0,k=((n=(e=g[8])==null?void 0:e[0])==null?void 0:n.data)&&xn(g[8][0].data)>0||!1,N,F;if((o=(a=g[7])==null?void 0:a[0])!=null&&o.data&&r!=0)N=(l=(s=g[7])==null?void 0:s[0])==null?void 0:l.data,F=(i=(c=g[6])==null?void 0:c[0])==null?void 0:i.data;else if((p=(u=g[4])==null?void 0:u[0])!=null&&p.data&&r!=1)N=(h=(f=g[4])==null?void 0:f[0])==null?void 0:h.data,F=(b=(v=g[3])==null?void 0:v[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var B=k?4:1,W=l1(N),V=[],q=0;q<N.length/2;++q){var X=W.getUint16(q*2,!0);X<65535&&V.push([q,X])}if(V.length!=y)throw"Expected ".concat(y," cells, found ").concat(V.length);var I=[];for(q=0;q<V.length-1;++q)I[V[q][0]]=F.subarray(V[q][1]*B,V[q+1][1]*B);return V.length>=1&&(I[V[V.length-1][0]]=F.subarray(V[V.length-1][1]*B)),{R:x,cells:I}}function RL(t,r){var e,n=Vn(r.data),a=(e=n==null?void 0:n[7])!=null&&e[0]?xn(n[7][0].data)>>>0>0?1:0:-1,o=c1(n[5],function(s){return DL(s,a)});return{nrows:xn(n[4][0].data)>>>0,data:o.reduce(function(s,l){return s[l.R]||(s[l.R]=[]),l.cells.forEach(function(c,i){if(s[l.R][i])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(i));s[l.R][i]=c}),s},[])}}function ML(t,r,e){var n,a=Vn(r.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(xn(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(xn(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));e["!ref"]=mr(o);var s=Vn(a[4][0].data),l=Y2(t,t[Zi(s[4][0].data)][0]),c=(n=s[17])!=null&&n[0]?Y2(t,t[Zi(s[17][0].data)][0]):[],i=Vn(s[3][0].data),u=0;i[1].forEach(function(p){var f=Vn(p.data),h=t[Zi(f[2][0].data)][0],v=xn(h.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var b=RL(t,h);b.data.forEach(function(g,x){g.forEach(function(y,k){var N=Qt({r:u+x,c:k}),F=OL(y,l,c);F&&(e[N]=F)})}),u+=b.nrows})}function FL(t,r){var e=Vn(r.data),n={"!ref":"A1"},a=t[Zi(e[2][0].data)],o=xn(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return ML(t,a[0],n),n}function IL(t,r){var e,n=Vn(r.data),a={name:(e=n[1])!=null&&e[0]?im(n[1][0].data):"",sheets:[]},o=c1(n[2],Zi);return o.forEach(function(s){t[s].forEach(function(l){var c=xn(l.meta[1][0].data);c==6e3&&a.sheets.push(FL(t,l))})}),a}function PL(t,r){var e=f1(),n=Vn(r.data),a=c1(n[1],Zi);if(a.forEach(function(o){t[o].forEach(function(s){var l=xn(s.meta[1][0].data);if(l==2){var c=IL(t,s);c.sheets.forEach(function(i,u){h1(e,i,u==0?c.name:c.name+"_"+u,!0)})}})}),e.SheetNames.length==0)throw new Error("Empty NUMBERS file");return e}function Ap(t){var r,e,n,a,o={},s=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var i;try{i=CL(c.content)}catch(p){return console.log("?? "+c.content.length+" "+(p.message||p))}var u;try{u=TL(i)}catch(p){return console.log("## "+(p.message||p))}u.forEach(function(p){o[p.id]=p.messages,s.push(p.id)})}}),!s.length)throw new Error("File has no messages");var l=((a=(n=(e=(r=o==null?void 0:o[1])==null?void 0:r[0])==null?void 0:e.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&xn(o[1][0].meta[1][0].data)==1&&o[1][0];if(l||s.forEach(function(c){o[c].forEach(function(i){var u=xn(i.meta[1][0].data)>>>0;if(u==1)if(!l)l=i;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return PL(o,l)}function LL(t){return function(e){for(var n=0;n!=t.length;++n){var a=t[n];e[a[0]]===void 0&&(e[a[0]]=a[1]),a[2]==="n"&&(e[a[0]]=Number(e[a[0]]))}}}function u1(t){LL([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function BL(t){return $l.WS.indexOf(t)>-1?"sheet":t==$l.CS?"chart":t==$l.DS?"dialog":t==$l.MS?"macro":t&&t.length?t:"sheet"}function UL(t,r){if(!t)return 0;try{t=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,BL(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function zL(t,r,e,n,a,o,s,l,c,i,u,p){try{o[n]=hu(ka(t,e,!0),r);var f=on(t,r),h;switch(l){case"sheet":h=GP(f,r,a,c,o[n],i,u,p);break;case"chart":if(h=YP(f,r,a,c,o[n],i,u,p),!h||!h["!drawel"])break;var v=iu(h["!drawel"].Target,r),b=tm(v),g=WM(ka(t,v,!0),hu(ka(t,b,!0),v)),x=iu(g,v),y=tm(x);h=jP(ka(t,x,!0),x,c,hu(ka(t,y,!0),x),i,h);break;case"macro":h=XP(f,r,a,c,o[n],i,u,p);break;case"dialog":h=KP(f,r,a,c,o[n],i,u,p);break;default:throw new Error("Unrecognized sheet type "+l)}s[n]=h;var k=[];o&&o[n]&&Ds(o[n]).forEach(function(N){var F="";if(o[n][N].Type==$l.CMNT){F=iu(o[n][N].Target,r);var B=eL(on(t,F,!0),F,c);if(!B||!B.length)return;R2(h,B,!1)}o[n][N].Type==$l.TCMNT&&(F=iu(o[n][N].Target,r),k=k.concat(YM(on(t,F,!0),c)))}),k&&k.length&&R2(h,k,!0,c.people||[])}catch(N){if(c.WTF)throw N}}function Fa(t){return t.charAt(0)=="/"?t.slice(1):t}function $L(t,r){if(y_(),r=r||{},u1(r),La(t,"META-INF/manifest.xml")||La(t,"objectdata.xml"))return q2(t,r);if(La(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ap<"u"){if(t.FileIndex)return Ap(t);var e=pr.utils.cfb_new();return i2(t).forEach(function(R){Vj(e,R,$j(t,R))}),Ap(e)}throw new Error("Unsupported NUMBERS file")}if(!La(t,"[Content_Types].xml"))throw La(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):La(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=i2(t),a=LO(ka(t,"[Content_Types].xml")),o=!1,s,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",on(t,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!on(t,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var c={},i={};if(!r.bookSheets&&!r.bookProps){if(gu=[],a.sst)try{gu=QP(on(t,Fa(a.sst)),a.sst,r)}catch(R){if(r.WTF)throw R}r.cellStyles&&a.themes.length&&(c=JP(ka(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],r)),a.style&&(i=ZP(on(t,Fa(a.style)),a.style,c,r))}a.links.map(function(R){try{var C=hu(ka(t,tm(Fa(R))),R);return rL(on(t,Fa(R)),C,R,r)}catch{}});var u=WP(on(t,Fa(a.workbooks[0])),a.workbooks[0],r),p={},f="";a.coreprops.length&&(f=on(t,Fa(a.coreprops[0]),!0),f&&(p=X_(f)),a.extprops.length!==0&&(f=on(t,Fa(a.extprops[0]),!0),f&&VO(f,p,r)));var h={};(!r.bookSheets||r.bookProps)&&a.custprops.length!==0&&(f=ka(t,Fa(a.custprops[0]),!0),f&&(h=qO(f,r)));var v={};if((r.bookSheets||r.bookProps)&&(u.Sheets?s=u.Sheets.map(function(C){return C.name}):p.Worksheets&&p.SheetNames.length>0&&(s=p.SheetNames),r.bookProps&&(v.Props=p,v.Custprops=h),r.bookSheets&&typeof s<"u"&&(v.SheetNames=s),r.bookSheets?v.SheetNames:r.bookProps))return v;s={};var b={};r.bookDeps&&a.calcchain&&(b=tL(on(t,Fa(a.calcchain)),a.calcchain));var g=0,x={},y,k;{var N=u.Sheets;p.Worksheets=N.length,p.SheetNames=[];for(var F=0;F!=N.length;++F)p.SheetNames[F]=N[F].name}var B=o?"bin":"xml",W=a.workbooks[0].lastIndexOf("/"),V=(a.workbooks[0].slice(0,W+1)+"_rels/"+a.workbooks[0].slice(W+1)+".rels").replace(/^\//,"");La(t,V)||(V="xl/_rels/workbook."+B+".rels");var q=hu(ka(t,V,!0),V.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(r.xlmeta=nL(on(t,Fa(a.metadata[0])),a.metadata[0],r)),(a.people||[]).length>=1&&(r.people=XM(on(t,Fa(a.people[0])),r)),q&&(q=UL(q,u.Sheets));var X=on(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=p.Worksheets;++g){var I="sheet";if(q&&q[g]?(y="xl/"+q[g][1].replace(/[\/]?xl\//,""),La(t,y)||(y=q[g][1]),La(t,y)||(y=V.replace(/_rels\/.*$/,"")+q[g][1]),I=q[g][2]):(y="xl/worksheets/sheet"+(g+1-X)+"."+B,y=y.replace(/sheet0\./,"sheet.")),k=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(g!=r.sheets)continue e;break;case"string":if(p.SheetNames[g].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var H=!1,O=0;O!=r.sheets.length;++O)typeof r.sheets[O]=="number"&&r.sheets[O]==g&&(H=1),typeof r.sheets[O]=="string"&&r.sheets[O].toLowerCase()==p.SheetNames[g].toLowerCase()&&(H=1);if(!H)continue e}}zL(t,y,k,p.SheetNames[g],g,x,s,I,r,u,c,i)}return v={Directory:a,Workbook:u,Props:p,Custprops:h,Deps:b,Sheets:s,SheetNames:p.SheetNames,Strings:gu,Styles:i,Themes:c,SSF:Rn(rr)},r&&r.bookFiles&&(t.files?(v.keys=n,v.files=t.files):(v.keys=[],v.files={},t.FullPaths.forEach(function(R,C){R=R.replace(/^Root Entry[\/]/,""),v.keys.push(R),v.files[R]=t.FileIndex[C]}))),r&&r.bookVBA&&(a.vba.length>0?v.vbaraw=on(t,Fa(a.vba[0]),!0):a.defaults&&a.defaults.bin===QM&&(v.vbaraw=on(t,"xl/vbaProject.bin",!0))),v}function VL(t,r){var e=r||{},n="Workbook",a=pr.find(t,n);try{if(n="/!DataSpaces/Version",a=pr.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(FR(a.content),n="/!DataSpaces/DataSpaceMap",a=pr.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=PR(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=pr.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=LR(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=pr.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);UR(a.content)}catch{}if(n="/EncryptionInfo",a=pr.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=zR(a.content);if(n="/EncryptedPackage",a=pr.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,e.password||"",e);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,e.password||"",e);throw new Error("File is password-protected")}function d1(t,r){var e="";switch((r||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=Ta(t.slice(0,12));break;case"binary":e=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function HL(t,r){return pr.find(t,"EncryptedPackage")?VL(t,r):R4(t,r)}function qL(t,r){var e,n=t,a=r||{};return a.type||(a.type=fr&&Buffer.isBuffer(t)?"buffer":"base64"),e=T_(n,a),$L(e,a)}function P4(t,r){var e=0;e:for(;e<t.length;)switch(t.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return am(t.slice(e),r);default:break e}return Mu.to_workbook(t,r)}function WL(t,r){var e="",n=d1(t,r);switch(r.type){case"base64":e=Ta(t);break;case"binary":e=t;break;case"buffer":e=t.toString("binary");break;case"array":e=Uo(t);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(e=Ir(e)),r.type="binary",P4(e,r)}function GL(t,r){var e=t;return r.type=="base64"&&(e=Ta(e)),e=ju.utils.decode(1200,e.slice(2),"str"),r.type="binary",P4(e,r)}function YL(t){return t.match(/[^\x00-\x7F]/)?ou(t):t}function Cp(t,r,e,n){return n?(e.type="string",Mu.to_workbook(t,e)):Mu.to_workbook(r,e)}function Bf(t,r){l_();var e=r||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Bf(new Uint8Array(t),(e=Rn(e),e.type="array",e));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!e.type&&(e.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],o=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),Yl={},e.dateNF&&(Yl.dateNF=e.dateNF),e.type||(e.type=fr&&Buffer.isBuffer(t)?"buffer":"base64"),e.type=="file"&&(e.type=fr?"buffer":"binary",n=Fj(t),typeof Uint8Array<"u"&&!fr&&(e.type="array")),e.type=="string"&&(o=!0,e.type="binary",e.codepage=65001,n=YL(t)),e.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),l=new Uint8Array(s);if(l.foo="bar",!l.foo)return e=Rn(e),e.type="array",Bf(Vm(n),e)}switch((a=d1(n,e))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return HL(pr.read(n,e),e);break;case 9:if(a[1]<=8)return R4(n,e);break;case 60:return am(n,e);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return _R(n,e);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return yR.to_workbook(n,e);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?qL(n,e):Cp(t,n,e,o);case 239:return a[3]===60?am(n,e):Cp(t,n,e,o);case 255:if(a[1]===254)return GL(n,e);if(a[1]===0&&a[2]===2&&a[3]===0)return mu.to_workbook(n,e);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return mu.to_workbook(n,e);break;case 3:case 131:case 139:case 140:return D2.to_workbook(n,e);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return QR.to_workbook(n,e);break;case 10:case 13:case 32:return WL(n,e);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return bR.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?D2.to_workbook(n,e):Cp(t,n,e,o)}function XL(t,r,e,n,a,o,s,l){var c=Mn(e),i=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),p=!0,f=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:e,enumerable:!1})}catch{f.__rowNum__=e}else f.__rowNum__=e;if(!s||t[e])for(var h=r.s.c;h<=r.e.c;++h){var v=s?t[e][h]:t[n[h]+c];if(v===void 0||v.t===void 0){if(i===void 0)continue;o[h]!=null&&(f[o[h]]=i);continue}var b=v.v;switch(v.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(o[h]!=null){if(b==null)if(v.t=="e"&&b===null)f[o[h]]=null;else if(i!==void 0)f[o[h]]=i;else if(u&&b===null)f[o[h]]=null;else continue;else f[o[h]]=u&&(v.t!=="n"||v.t==="n"&&l.rawNumbers!==!1)?b:ii(v,b,l);b!=null&&(p=!1)}}return{row:f,isempty:p}}function lm(t,r){if(t==null||t["!ref"]==null)return[];var e={t:"n",v:0},n=0,a=1,o=[],s=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},i=r||{},u=i.range!=null?i.range:t["!ref"];switch(i.header===1?n=1:i.header==="A"?n=2:Array.isArray(i.header)?n=3:i.header==null&&(n=0),typeof u){case"string":c=Yr(u);break;case"number":c=Yr(t["!ref"]),c.s.r=u;break;default:c=u}n>0&&(a=0);var p=Mn(c.s.r),f=[],h=[],v=0,b=0,g=Array.isArray(t),x=c.s.r,y=0,k={};g&&!t[x]&&(t[x]=[]);var N=i.skipHidden&&t["!cols"]||[],F=i.skipHidden&&t["!rows"]||[];for(y=c.s.c;y<=c.e.c;++y)if(!(N[y]||{}).hidden)switch(f[y]=bn(y),e=g?t[x][y]:t[f[y]+p],n){case 1:o[y]=y-c.s.c;break;case 2:o[y]=f[y];break;case 3:o[y]=i.header[y-c.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),l=s=ii(e,null,i),b=k[s]||0,!b)k[s]=1;else{do l=s+"_"+b++;while(k[l]);k[s]=b,k[l]=1}o[y]=l}for(x=c.s.r+a;x<=c.e.r;++x)if(!(F[x]||{}).hidden){var B=XL(t,c,x,f,n,o,g,i);(B.isempty===!1||(n===1?i.blankrows!==!1:i.blankrows))&&(h[v++]=B.row)}return h.length=v,h}var X2=/"/g;function KL(t,r,e,n,a,o,s,l){for(var c=!0,i=[],u="",p=Mn(e),f=r.s.c;f<=r.e.c;++f)if(n[f]){var h=l.dense?(t[e]||[])[f]:t[n[f]+p];if(h==null)u="";else if(h.v!=null){c=!1,u=""+(l.rawNumbers&&h.t=="n"?h.v:ii(h,null,l));for(var v=0,b=0;v!==u.length;++v)if((b=u.charCodeAt(v))===a||b===o||b===34||l.forceQuotes){u='"'+u.replace(X2,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(c=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(X2,'""')+'"')):u="";i.push(u)}return l.blankrows===!1&&c?null:i.join(s)}function L4(t,r){var e=[],n=r??{};if(t==null||t["!ref"]==null)return"";var a=Yr(t["!ref"]),o=n.FS!==void 0?n.FS:",",s=o.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),i=new RegExp((o=="|"?"\\|":o)+"+$"),u="",p=[];n.dense=Array.isArray(t);for(var f=n.skipHidden&&t["!cols"]||[],h=n.skipHidden&&t["!rows"]||[],v=a.s.c;v<=a.e.c;++v)(f[v]||{}).hidden||(p[v]=bn(v));for(var b=0,g=a.s.r;g<=a.e.r;++g)(h[g]||{}).hidden||(u=KL(t,a,g,p,s,c,o,n),u!=null&&(n.strip&&(u=u.replace(i,"")),(u||n.blankrows!==!1)&&e.push((b++?l:"")+u)));return delete n.dense,e.join("")}function ZL(t,r){r||(r={}),r.FS="	",r.RS=`
`;var e=L4(t,r);return e}function JL(t){var r="",e,n="";if(t==null||t["!ref"]==null)return[];var a=Yr(t["!ref"]),o="",s=[],l,c=[],i=Array.isArray(t);for(l=a.s.c;l<=a.e.c;++l)s[l]=bn(l);for(var u=a.s.r;u<=a.e.r;++u)for(o=Mn(u),l=a.s.c;l<=a.e.c;++l)if(r=s[l]+o,e=i?(t[u]||[])[l]:t[r],n="",e!==void 0){if(e.F!=null){if(r=e.F,!e.f)continue;n=e.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(e.f!=null)n=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)n=""+e.v;else if(e.t=="b")n=e.v?"TRUE":"FALSE";else if(e.w!==void 0)n="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?n="'"+e.v:n=""+e.v}}c[c.length]=r+"="+n}return c}function B4(t,r,e){var n=e||{},a=+!n.skipHeader,o=t||{},s=0,l=0;if(o&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Qn(n.origin):n.origin;s=c.r,l=c.c}var i,u={s:{c:0,r:0},e:{c:l,r:s+r.length-1+a}};if(o["!ref"]){var p=Yr(o["!ref"]);u.e.c=Math.max(u.e.c,p.e.c),u.e.r=Math.max(u.e.r,p.e.r),s==-1&&(s=p.e.r+1,u.e.r=s+r.length-1+a)}else s==-1&&(s=0,u.e.r=r.length-1+a);var f=n.header||[],h=0;r.forEach(function(b,g){Ds(b).forEach(function(x){(h=f.indexOf(x))==-1&&(f[h=f.length]=x);var y=b[x],k="z",N="",F=Qt({c:l+h,r:s+g+a});i=Lu(o,F),y&&typeof y=="object"&&!(y instanceof Date)?o[F]=y:(typeof y=="number"?k="n":typeof y=="boolean"?k="b":typeof y=="string"?k="s":y instanceof Date?(k="d",n.cellDates||(k="n",y=ta(y)),N=n.dateNF||rr[14]):y===null&&n.nullError&&(k="e",y=0),i?(i.t=k,i.v=y,delete i.w,delete i.R,N&&(i.z=N)):o[F]=i={t:k,v:y},N&&(i.z=N))})}),u.e.c=Math.max(u.e.c,l+f.length-1);var v=Mn(s);if(a)for(h=0;h<f.length;++h)o[bn(h+l)+v]={t:"s",v:f[h]};return o["!ref"]=mr(u),o}function QL(t,r){return B4(null,t,r)}function Lu(t,r,e){if(typeof r=="string"){if(Array.isArray(t)){var n=Qn(r);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return typeof r!="number"?Lu(t,Qt(r)):Lu(t,Qt({r,c:e||0}))}function eB(t,r){if(typeof r=="number"){if(r>=0&&t.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var e=t.SheetNames.indexOf(r);if(e>-1)return e;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function f1(){return{SheetNames:[],Sheets:{}}}function h1(t,r,e,n){var a=1;if(!e)for(;a<=65535&&t.SheetNames.indexOf(e="Sheet"+a)!=-1;++a,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(e)>=0){var o=e.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var s=o&&o[1]||e;for(++a;a<=65535&&t.SheetNames.indexOf(e=s+a)!=-1;++a);}if(LP(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=r,e}function tB(t,r,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=eB(t,r);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[n].Hidden=e}function rB(t,r){return t.z=r,t}function U4(t,r,e){return r?(t.l={Target:r},e&&(t.l.Tooltip=e)):delete t.l,t}function nB(t,r,e){return U4(t,"#"+r,e)}function aB(t,r,e){t.c||(t.c=[]),t.c.push({t:r,a:e||"SheetJS"})}function sB(t,r,e,n){for(var a=typeof r!="string"?r:Yr(r),o=typeof r=="string"?r:mr(r),s=a.s.r;s<=a.e.r;++s)for(var l=a.s.c;l<=a.e.c;++l){var c=Lu(t,s,l);c.t="n",c.F=o,delete c.v,s==a.s.r&&l==a.s.c&&(c.f=e,n&&(c.D=!0))}return t}var K2={encode_col:bn,encode_row:Mn,encode_cell:Qt,encode_range:mr,decode_col:Jm,decode_row:Zm,split_cell:vO,decode_cell:Qn,decode_range:nc,format_cell:ii,sheet_add_aoa:H_,sheet_add_json:B4,sheet_add_dom:M4,aoa_to_sheet:ac,json_to_sheet:QL,table_to_sheet:F4,table_to_book:_L,sheet_to_csv:L4,sheet_to_txt:ZL,sheet_to_json:lm,sheet_to_html:wL,sheet_to_formulae:JL,sheet_to_row_object_array:lm,sheet_get_cell:Lu,book_new:f1,book_append_sheet:h1,book_set_sheet_visibility:tB,cell_set_number_format:rB,cell_set_hyperlink:U4,cell_set_internal_link:nB,cell_add_comment:aB,sheet_set_array_formula:sB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Z2={"CNPJ Destinatrio":{dbField:"cnpj_destinatario",visible:!1,type:"string"},Destinatrio:{dbField:"destinatario",visible:!1,type:"string"},"Cidade Destino":{dbField:"cidade_destino",visible:!1,type:"string"},"UF Destino":{dbField:"uf_destino",visible:!1,type:"string"},"CNPJ Emitente":{dbField:"cnpj_emitente",visible:!1,type:"string"},"Nome PJ Emitente":{dbField:"nome_pj_emitente",visible:!1,type:"string"},"Chave de Acesso":{dbField:"chave_acesso",visible:!1,type:"string"},Srie:{dbField:"serie",visible:!1,type:"string"},Tipo:{dbField:"tipo",visible:!1,type:"string"},Status:{dbField:"status_nfe",visible:!1,type:"string"},"Nome ou e-mail do usurio que fez a sincronizao":{dbField:"nome_usuario_sync",visible:!1,type:"string"},"Data da sincronizao":{dbField:"data_sync",visible:!1,type:"date"},"Natureza Operao":{dbField:"natureza_operacao",visible:!1,type:"string"},"CFOPs da Nota":{dbField:"cfops",visible:!1,type:"string"},Etiquetas:{dbField:"etiquetas",visible:!1,type:"string"},"Nome Filial":{dbField:"nome_filial",visible:!0,type:"string"},FILIAL:{dbField:"nome_filial",visible:!0,type:"string"},"Nome Cliente":{dbField:"nome_cliente",visible:!0,type:"string"},"Cidade Origem":{dbField:"cidade_origem",visible:!0,type:"string"},"UF Origem":{dbField:"uf_origem",visible:!0,type:"string"},"Data Emisso":{dbField:"data_emissao",visible:!0,type:"date"},Nmero:{dbField:"numero",visible:!0,type:"string"},"Valor Total da Nota":{dbField:"valor_total_nota",visible:!0,type:"number"},"Peso lquido":{dbField:"peso_liquido",visible:!0,type:"number"},"Sincronizao ERP":{dbField:"sincronizacao_erp",visible:!0,type:"string"},"Finalidade NFe":{dbField:"finalidade_nfe",visible:!0,type:"string"},"Dados Adicionais":{dbField:"dados_adicionais",visible:!0,type:"string"},Vendedor:{dbField:"vendedor",visible:!0,type:"string"},Motivo:{dbField:"motivo",visible:!0,type:"string"},Resultado:{dbField:"resultado",visible:!0,type:"string"},"[Item] Descrio":{dbField:"item_description",visible:!0,type:"string"},"[Item] Unidade":{dbField:"item_unit",visible:!0,type:"string"},"[Item] Quantidade":{dbField:"item_quantity",visible:!0,type:"number"},"[Item] Valor Unitrio":{dbField:"item_unit_value",visible:!0,type:"number"},"[Item] Valor Total Bruto":{dbField:"item_total_value",visible:!0,type:"number"},"[Item] Nmero do Item.":{dbField:"item_number",visible:!0,type:"string"}};function iB(){const[t,r]=_e.useState(null),[e,n]=_e.useState([]),[a,o]=_e.useState(!1),s=h=>{if(h.target.files&&h.target.files[0]){const v=h.target.files[0];r(v),l(v)}},l=async h=>{const v=new FileReader;v.onload=async b=>{var x;const g=(x=b.target)==null?void 0:x.result;if(g){const y=Bf(g,{type:"binary",cellDates:!0}),k=y.SheetNames[0],N=y.Sheets[k],F=K2.sheet_to_json(N),B=F.map(H=>String(H["CNPJ Emitente"]||"")).filter(H=>H&&H.trim()!=="");let W=new Map,V=new Map;const q=H=>H?H.replace(/[^\d]/g,""):"";if(B.length>0){const{data:H}=await St.from("clientes").select("cnpj_cpf, nome, vendedor, rede, uf, municipio");H&&H.forEach(O=>{const R=q(O.cnpj_cpf||"");R&&R.length>=11&&W.set(R,O)})}const{data:X}=await St.from("emitentes").select("cnpj, nome_fantasia");X&&X.forEach(H=>{const O=q(H.cnpj||"");if(O&&O.length>=11){const R=H.nome_fantasia||"";V.set(O,R)}});const I=F.slice(0,10).map(H=>{const O={...H};O["Data Emisso"]instanceof Date&&(O["Data Emisso"]=O["Data Emisso"].toLocaleDateString("pt-BR"));const R=String(H["CNPJ Emitente"]||""),C=q(R),w=C.length>=11?W.get(C):null;w?(O["Nome Cliente"]=w.nome||"",O.Vendedor=w.vendedor||""):(O["Nome Cliente"]="",O.Vendedor="");const E=String(H["CNPJ Destinatrio"]||""),A=q(E);if(A&&A.length>=11){const T=V.get(A);T&&T.trim()!==""?(O["Nome Filial"]=T,O.FILIAL=T):(O["Nome Filial"]="",O.FILIAL="")}else O["Nome Filial"]="",O.FILIAL="";return O});n(I)}},v.readAsBinaryString(h)},c=h=>h?String(h).replace(/[.\-\/\s]/g,"").trim():"",i=h=>{if(typeof h=="number"&&!isNaN(h))return h;if(h==null||h==="")return null;let v=String(h).trim();if(v==="")return null;v=v.replace(/\s/g,""),v.includes(",")&&(v=v.replace(/\./g,""),v=v.replace(",","."));const b=parseFloat(v);return isNaN(b)?null:b},u=async()=>{const h=new Map;try{const{data:v,error:b}=await St.from("clientes").select("nome, razao_social, cnpj_cpf, vendedor, rede").not("cnpj_cpf","is",null);if(b)return console.error("Erro ao buscar clientes:",b),h;v&&v.length>0&&v.forEach(g=>{if(g.cnpj_cpf){const x=c(g.cnpj_cpf);if(x&&x.length>=11){const y=g.nome||g.razao_social||"";h.set(x,{nome:y,vendedor:g.vendedor||"",rede:g.rede||""})}}})}catch(v){console.error("Erro ao carregar clientes:",v)}return h},p=async()=>{if(t){o(!0);try{const h=new FileReader;h.onload=async v=>{var I,H,O;const b=(I=v.target)==null?void 0:I.result,g=Bf(b,{type:"binary",cellDates:!0}),x=g.Sheets[g.SheetNames[0]],y=K2.sheet_to_json(x),k=new Map;for(const R of y){const C=R.Nmero;if(!C)continue;if(!k.has(C)){let A=new Date().toISOString();if(R["Data Emisso"])if(R["Data Emisso"]instanceof Date)A=R["Data Emisso"].toISOString();else{const T=new Date(R["Data Emisso"]);isNaN(T.getTime())||(A=T.toISOString())}k.set(C,{invoice_number:String(C),customer_cnpj:String(R["CNPJ Destinatrio"]||""),destinatario:String(R.Destinatrio||""),cidade_origem:String(R["Cidade Origem"]||""),uf_origem:String(R["UF Origem"]||""),cidade_destino:String(R["Cidade Destino"]||""),uf_destino:String(R["UF Destino"]||""),cnpj_emitente:String(R["CNPJ Emitente"]||""),nome_pj_emitente:String(R["Nome PJ Emitente"]||""),chave_acesso:String(R["Chave de Acesso"]||""),serie:String(R.Srie||""),peso_liquido:i(R["Peso lquido"])||0,tipo:String(R.Tipo||""),status_nfe:String(R.Status||""),sincronizacao_erp:String(R["Sincronizao ERP"]||""),finalidade_nfe:String(R["Finalidade NFe"]||""),natureza_operacao:String(R["Natureza Operao"]||""),cfops:String(R["CFOPs da Nota"]||""),dados_adicionais:String(R["Dados Adicionais"]||""),nfe_referenciada:String(R["NFe Referenciada"]||""),etiquetas:String(R.Etiquetas||""),invoice_date:A,total_value:0,motivo_id:null,sector_id:null,items:[]})}const w=k.get(C),E=i(R["[Item] Valor Total Bruto"])||0;w.total_value+=E,w.items.push({description:R["[Item] Descrio"],quantity:i(R["[Item] Quantidade"])||0,unit:R["[Item] Unidade"],unit_value:i(R["[Item] Valor Unitrio"])||0,total_value:i(E)||0,item_number:String(R["[Item] Nmero do Item."]||"")})}let N=0,F=0;const B=Array.from(k.values()),W=await u(),V=new Map;try{const{data:R}=await St.from("emitentes").select("cnpj, nome_fantasia").not("cnpj","is",null);R&&R.forEach(C=>{if(C.cnpj){const w=c(C.cnpj);if(w&&w.length>=11){const E=C.nome_fantasia||"";V.set(w,E)}}})}catch(R){console.error("Erro ao carregar emitentes:",R)}const{data:q}=await St.from("devolucoes").select("chave_acesso").not("chave_acesso","is",null),X=new Set((q||[]).map(R=>R.chave_acesso).filter(R=>R&&R.trim()!==""));for(const R of B){if(R.chave_acesso&&R.chave_acesso.trim()!==""&&X.has(R.chave_acesso)){console.log(`Chave de acesso duplicada ignorada: ${R.chave_acesso}`),F++;continue}const C=String(R.sincronizacao_erp||"").trim().toUpperCase();if(C==="SINCRONIZADO"||C==="SIM"||C==="S"){console.log(`Registro descartado - j sincronizado: ${R.invoice_number} (Chave: ${R.chave_acesso})`),F++;continue}let w="",E="",A="";if(R.cnpj_emitente){const P=c(R.cnpj_emitente);if(P&&P.length>=11){const K=W.get(P);K&&(w=K.nome||"",E=K.vendedor||"",A=K.rede||"")}}let T="";if(R.customer_cnpj){const P=c(R.customer_cnpj);if(P&&P.length>=11){const K=V.get(P);K&&K.trim()!==""&&(T=K)}}const{data:D,error:U}=await St.from("devolucoes").insert({numero:R.invoice_number,nome_cliente:w,cnpj_destinatario:R.customer_cnpj,destinatario:R.destinatario,cidade_origem:R.cidade_origem,uf_origem:R.uf_origem,cidade_destino:R.cidade_destino,uf_destino:R.uf_destino,cnpj_emitente:R.cnpj_emitente,nome_pj_emitente:R.nome_pj_emitente,chave_acesso:R.chave_acesso||null,serie:R.serie,peso_liquido:i(R.peso_liquido),tipo:R.tipo,status_nfe:R.status_nfe,sincronizacao_erp:R.sincronizacao_erp,finalidade_nfe:R.finalidade_nfe,natureza_operacao:R.natureza_operacao,cfops:R.cfops,dados_adicionais:R.dados_adicionais,nfe_referenciada:R.nfe_referenciada,etiquetas:R.etiquetas,nome_filial:T,data_emissao:R.invoice_date,valor_total_nota:i(R.total_value)||0,vendedor:E,rede:A,resultado:"PENDENTE VALIDAO",motivo_id:R.reason_id,setor_id:R.sector_id}).select().single();if(U){if(U.code==="23505"||(H=U.message)!=null&&H.includes("unique")||(O=U.message)!=null&&O.includes("duplicate")){console.log(`Chave de acesso duplicada ignorada (constraint): ${R.chave_acesso}`),F++;continue}console.error("Erro ao inserir devoluo:",U);continue}if(D){R.chave_acesso&&R.chave_acesso.trim()!==""&&X.add(R.chave_acesso);const P=R.items.map(Y=>({devolucao_id:D.id,descricao:Y.description,quantidade:i(Y.quantity)||0,unidade:Y.unit,valor_unitario:i(Y.unit_value)||0,valor_total_bruto:i(Y.total_value)||0,numero_item:Y.item_number})),{error:K}=await St.from("itens_devolucao").insert(P);K||N++}}if(N>0){let R=`${N} devoluo(es) importada(s) com sucesso!`;F>0&&(R+=` ${F} registro(s) ignorado(s) (duplicados ou j sincronizados).`),_t.success(R)}else F>0?_t.warning(`${F} registro(s) ignorado(s) (duplicados ou j sincronizados). Nenhuma devoluo nova foi importada.`):_t.warning("Nenhuma devoluo importada. Verifique o arquivo.");o(!1),r(null),n([])},h.readAsBinaryString(t)}catch(h){console.error(h),_t.error("Erro crtico ao processar arquivo"),o(!1)}}},f=Object.keys(Z2).filter(h=>Z2[h].visible);return _.jsxs("div",{className:"space-y-6",children:[_.jsx(Qi,{title:"Sincronizao",description:"Importe arquivos CSV ou XLSX para sincronizar devolues. O sistema busca automaticamente dados de clientes e filiais."}),_.jsx("div",{className:"grid gap-6 md:grid-cols-1",children:_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Importar Arquivo"}),_.jsx(Or,{children:"Faa upload de arquivos CSV ou XLSX. O sistema identificar automaticamente os Motivos, Setores e buscar o nome do cliente na base de dados usando o CNPJ."})]}),_.jsxs(Ot,{children:[_.jsxs("div",{className:"flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-10 hover:bg-muted/50 transition-colors relative",children:[_.jsx(_r,{type:"file",accept:".csv, .xlsx, .xls",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:s}),_.jsx(NS,{className:"h-10 w-10 text-muted-foreground mb-4"}),_.jsx("p",{className:"text-sm font-medium mb-1",children:t?t.name:"Arraste e solte ou clique para selecionar"}),_.jsx("p",{className:"text-xs text-muted-foreground",children:"Suporta .csv e .xlsx"})]}),e.length>0&&_.jsxs("div",{className:"mt-6 space-y-4",children:[_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsx("h3",{className:"text-sm font-semibold",children:"Pr-visualizao"}),_.jsxs(Nt,{onClick:p,disabled:a,children:[a&&_.jsx(oi,{className:"mr-2 h-4 w-4 animate-spin"}),"Confirmar e Processar"]})]}),_.jsx("div",{className:"overflow-x-auto rounded-md border",children:_.jsxs(Un,{children:[_.jsx(Jn,{children:_.jsx(dr,{children:f.map(h=>_.jsx(Tt,{className:"whitespace-nowrap",children:h},h))})}),_.jsx(zn,{children:e.map((h,v)=>_.jsx(dr,{children:f.map(b=>_.jsx(Pt,{className:"whitespace-nowrap",children:h[b]},`${v}-${b}`))},v))})]})}),_.jsxs("div",{className:"flex items-center gap-2 text-xs text-amber-600 bg-amber-50 p-2 rounded border border-amber-200",children:[_.jsx(Ml,{className:"h-4 w-4"}),_.jsx("span",{children:'Certifique-se de que os nomes dos "Motivos" no Excel correspondam exatamente aos cadastrados em Configuraes para que os grficos funcionem.'})]})]})]})]})})]})}const cm=_e.forwardRef(({className:t,...r},e)=>_.jsx("textarea",{className:Et("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:e,...r}));cm.displayName="Textarea";const J2=["PENDENTE VALIDAO","VALIDADA","LANADA","TRATATIVA DE ANULAO","ANULADA/CANCELADA"],Q2={"PENDENTE VALIDAO":"bg-red-500 hover:bg-red-600 text-white",VALIDADA:"bg-blue-500 hover:bg-blue-600 text-white",LANADA:"bg-green-500 hover:bg-green-600 text-white","TRATATIVA DE ANULAO":"bg-orange-500 hover:bg-orange-600 text-white","ANULADA/CANCELADA":"bg-black hover:bg-gray-900 text-white"},Dl={"PENDENTE VALIDAO":1,VALIDADA:2,LANADA:3,"TRATATIVA DE ANULAO":4,"ANULADA/CANCELADA":5};function oB(t){return t.trim().split(/\s+/).filter(r=>r.length>0).length}function lB(){const[t,r]=_e.useState([]),[e,n]=_e.useState([]),[a,o]=_e.useState(!0),[s,l]=_e.useState([]),[c,i]=_e.useState({}),[u,p]=_e.useState({}),[f,h]=_e.useState(1),[v,b]=_e.useState(null),[g,x]=_e.useState(null),[y,k]=_e.useState(new Set),[N,F]=_e.useState(null),[B,W]=_e.useState(null),[V,q]=_e.useState(!1),[X,I]=_e.useState(!1),[H,O]=_e.useState({nfPendentes:0,totalPendente:0,nfValidadas:0,totalValidadas:0,nfCancelamento:0,totalCancelamento:0,nfAtraso:0,totalAtraso:0}),{user:R}=Dn(),{filters:C}=ec(),w=100;_e.useEffect(()=>{E(),A(),b(null),x(null),h(1)},[C]);const E=async()=>{try{const{data:Q,error:fe}=await St.from("motivos_devolucao").select("id, nome, sector_id").order("nome");if(fe){console.error("Erro ao buscar motivos:",fe),_t.error("Erro ao carregar motivos");return}if(!Q||Q.length===0){console.warn("Nenhum motivo encontrado"),l([]);return}const le=Q.map(he=>he.sector_id).filter(he=>he!==null);let te={};if(le.length>0){const{data:he}=await St.from("setores").select("id, nome").in("id",le);he&&(te=he.reduce((Ee,ke)=>(Ee[ke.id]=ke.nome,Ee),{}))}const ce=Q.map(he=>({...he,setores:he.sector_id?{nome:te[he.sector_id]||""}:null}));console.log("Motivos carregados:",ce.length),l(ce)}catch(Q){console.error("Erro ao buscar motivos:",Q),_t.error("Erro ao carregar motivos")}},A=async()=>{o(!0);const Q=(R==null?void 0:R.role)==="VENDEDOR"?R.vendedor:null;let fe=St.from("devolucoes").select(`
            *,
            itens:itens_devolucao(*, motivo_item:motivos_devolucao(id, nome)),
            setores:setores(nome),
            motivos_devolucao:motivos_devolucao(id, nome, setores:setores(nome))
        `);R&&R.role==="VENDEDOR"&&Q&&(fe=fe.eq("vendedor",Q),console.log(" Validao - Filtrando por vendedor:",Q));const le=C.period&&!C.startDate&&!C.endDate?Kf(C.period):{},te=C.startDate||le.startDate,ce=C.endDate||le.endDate;C.search&&(fe=fe.or(`nome_cliente.ilike.%${C.search}%,vendedor.ilike.%${C.search}%,numero.ilike.%${C.search}%`)),C.resultado&&C.resultado.length>0&&(fe=fe.in("resultado",C.resultado)),C.motivo&&C.motivo.length>0&&(fe=fe.in("motivo_id",C.motivo)),C.cliente&&C.cliente.length>0&&(fe=fe.in("nome_cliente",C.cliente)),C.vendedor&&C.vendedor.length>0&&(fe=fe.in("vendedor",C.vendedor));let he=[];if(C.setor&&C.setor.length>0){const{data:Ce}=await St.from("motivos_devolucao").select("id").in("sector_id",C.setor);he=(Ce==null?void 0:Ce.map(Fe=>Fe.id))||[],fe=fe.in("setor_id",C.setor)}if(te){const Ce=new Date(te);Ce.setHours(0,0,0,0);const Fe=new Date(Ce.getTime()-3*60*60*1e3);fe=fe.gte("data_emissao",Fe.toISOString().split("T")[0])}if(ce){const Ce=new Date(ce);Ce.setHours(23,59,59,999);const Fe=new Date(Ce.getTime()-3*60*60*1e3);fe=fe.lte("data_emissao",Fe.toISOString().split("T")[0])}const{data:Ee,error:ke}=await fe.order("created_at",{ascending:!1});if(ke)_t.error("Erro ao carregar devolues"),console.error(ke);else if(Ee){let Ce=Ee;C.setor&&C.setor.length>0&&he.length>0&&(Ce=Ee.filter(Ve=>{const $e=Ve.setor_id&&C.setor.includes(Ve.setor_id),xt=Ve.motivo_id&&he.includes(Ve.motivo_id);return $e||xt}));const Fe=Ce.filter(Ve=>Ve.resultado==="PENDENTE VALIDAO"||Ve.resultado==="VALIDADA"||Ve.resultado==="TRATATIVA DE ANULAO"),Pe=Fe.map(Ve=>Ve.cnpj_destinatario).filter(Ve=>Ve&&Ve.trim()!=="");let Xe=new Map;if(Pe.length>0){const{data:Ve}=await St.from("clientes").select("cnpj_cpf, nome, vendedor, rede, uf, municipio").in("cnpj_cpf",Pe);Ve&&Ve.forEach($e=>{Xe.set($e.cnpj_cpf,$e)})}const ct=Fe.map(Ve=>Ve.id);let st=new Map;if(ct.length>0){const{data:Ve}=await St.from("logs_validacao").select(`
              devolucao_id,
              status_novo,
              usuario_id
            `).in("devolucao_id",ct).order("created_at",{ascending:!1});if(Ve){const $e=[...new Set(Ve.map(nt=>nt.usuario_id).filter(Boolean))],xt=new Map;if($e.length>0){const{data:nt}=await St.from("profiles").select("id, name").in("id",$e);nt&&nt.forEach(pt=>{xt.set(pt.id,pt.name)})}Ve.forEach(nt=>{const pt=`${nt.devolucao_id}_${nt.status_novo}`;if(!st.has(pt)){const Se=xt.get(nt.usuario_id);Se&&st.set(pt,Se)}})}}const tt=Fe.map(Ve=>{var Qe,At,Vt;const $e=Xe.get(Ve.cnpj_destinatario),xt=(Qe=Ve.itens)==null?void 0:Qe.map(yt=>{var Ct;return yt.id||console.warn("Item sem ID:",yt),{...yt,id:yt.id,motivo_id:yt.motivo_id||null,motivo_nome:((Ct=yt.motivo_item)==null?void 0:Ct.nome)||"-"}}),nt=Ve.resultado||"PENDENTE VALIDAO";let pt="-";if(nt!=="PENDENTE VALIDAO"){const yt=`${Ve.id}_${nt}`;pt=st.get(yt)||"-"}let Se=null;if(Ve.data_emissao)try{const yt=new Date,Ct=-3*60,It=yt.getTime()+yt.getTimezoneOffset()*6e4,kt=new Date(It+Ct*6e4);kt.setHours(0,0,0,0);const Ne=new Date(Ve.data_emissao);Ne.setHours(0,0,0,0),Se=cN(Ne,kt)}catch(yt){console.warn("Erro ao calcular dias:",yt),Se=Ve.dias}let je=Ve.prazo;if(nt==="LANADA"||nt==="ANULADA/CANCELADA")je="FINALIZADO";else if(nt==="TRATATIVA DE ANULAO")je="TRATANDO";else if(nt==="VALIDADA")je="CONCLUIDO";else if(nt==="PENDENTE VALIDAO"){const yt=Se!==null?Se:Ve.dias;yt!=null&&(yt>=3?je="EM ATRASO":je="NO PRAZO")}return{...Ve,setor:(At=Ve.setores)==null?void 0:At.nome,motivo:typeof Ve.motivos_devolucao=="object"&&((Vt=Ve.motivos_devolucao)!=null&&Vt.nome)?Ve.motivos_devolucao.nome:typeof Ve.motivos_devolucao=="string"?Ve.motivos_devolucao:"-",motivo_id:Ve.motivo_id,resultado:nt,itens:xt,nome_validador:pt,prazo:je,dias:Se!==null?Se:Ve.dias,nome_cliente:($e==null?void 0:$e.nome)||Ve.nome_cliente||"Cliente no encontrado",vendedor:($e==null?void 0:$e.vendedor)||Ve.vendedor||"-",rede:($e==null?void 0:$e.rede)||Ve.rede||"-",uf_destino:($e==null?void 0:$e.uf)||Ve.uf_destino||"-",cidade_destino:($e==null?void 0:$e.municipio)||Ve.cidade_destino||"-"}}).sort((Ve,$e)=>{const xt=Dl[Ve.resultado]||999,nt=Dl[$e.resultado]||999;if(xt!==nt)return xt-nt;const pt=Ve.data_emissao?new Date(Ve.data_emissao).getTime():0;return($e.data_emissao?new Date($e.data_emissao).getTime():0)-pt});n(tt);const ot=tt.filter(Ve=>Ve.resultado==="PENDENTE VALIDAO").length,De=tt.filter(Ve=>Ve.resultado==="PENDENTE VALIDAO").reduce((Ve,$e)=>Ve+(Number($e.valor_total_nota)||0),0),ht=tt.filter(Ve=>Ve.resultado==="VALIDADA").length,rt=tt.filter(Ve=>Ve.resultado==="VALIDADA").reduce((Ve,$e)=>Ve+(Number($e.valor_total_nota)||0),0),it=tt.filter(Ve=>Ve.resultado==="TRATATIVA DE ANULAO").length,dt=tt.filter(Ve=>Ve.resultado==="TRATATIVA DE ANULAO").reduce((Ve,$e)=>Ve+(Number($e.valor_total_nota)||0),0),wt=tt.filter(Ve=>Ve.prazo==="EM ATRASO").length,gt=tt.filter(Ve=>Ve.prazo==="EM ATRASO").reduce((Ve,$e)=>Ve+(Number($e.valor_total_nota)||0),0);O({nfPendentes:ot,totalPendente:De,nfValidadas:ht,totalValidadas:rt,nfCancelamento:it,totalCancelamento:dt,nfAtraso:wt,totalAtraso:gt});const vt={};tt.forEach(Ve=>{vt[Ve.id]=Ve.justificativa||""}),i(vt)}o(!1)};_e.useEffect(()=>{if(e.length===0)return;let Q=[...e];v&&g?Q=[...e].sort((te,ce)=>{let he,Ee;switch(v){case"data_emissao":he=te.data_emissao?new Date(te.data_emissao).getTime():0,Ee=ce.data_emissao?new Date(ce.data_emissao).getTime():0;break;case"numero":const ke=parseInt(te.numero||"0",10)||0,Ce=parseInt(ce.numero||"0",10)||0;ke!==0||Ce!==0?(he=ke,Ee=Ce):(he=(te.numero||"").toLowerCase(),Ee=(ce.numero||"").toLowerCase());break;case"nome_cliente":he=(te.nome_cliente||"").toLowerCase(),Ee=(ce.nome_cliente||"").toLowerCase();break;case"vendedor":he=(te.vendedor||"").toLowerCase(),Ee=(ce.vendedor||"").toLowerCase();break;case"motivo":he=(te.motivo||"").toLowerCase(),Ee=(ce.motivo||"").toLowerCase();break;case"valor_total_nota":he=parseFloat(te.valor_total_nota||0),Ee=parseFloat(ce.valor_total_nota||0);break;case"dias":he=te.dias!==null&&te.dias!==void 0?te.dias:-1,Ee=ce.dias!==null&&ce.dias!==void 0?ce.dias:-1;break;case"prazo":he=(te.prazo||"").toLowerCase(),Ee=(ce.prazo||"").toLowerCase();break;case"resultado":he=Dl[te.resultado]||999,Ee=Dl[ce.resultado]||999;break;default:return 0}return he<Ee?g==="asc"?-1:1:he>Ee?g==="asc"?1:-1:0}):Q=[...e].sort((te,ce)=>{const he=Dl[te.resultado]||999,Ee=Dl[ce.resultado]||999;if(he!==Ee)return he-Ee;const ke=te.data_emissao?new Date(te.data_emissao).getTime():0;return(ce.data_emissao?new Date(ce.data_emissao).getTime():0)-ke});const fe=(f-1)*w,le=fe+w;r(Q.slice(fe,le))},[v,g,e,f]);const T=Q=>{v===Q?g==="asc"?x("desc"):g==="desc"&&(b(null),x(null)):(b(Q),x("asc")),h(1)},D=({field:Q})=>v!==Q?_.jsx(Ry,{className:"ml-1 h-4 w-4 opacity-50"}):g==="asc"?_.jsx(My,{className:"ml-1 h-4 w-4"}):_.jsx(Dy,{className:"ml-1 h-4 w-4"}),U=async(Q,fe)=>{if(!R)return;const le=fe;if(!J2.includes(le)){console.error("Resultado invlido:",fe),_t.error("Resultado invlido");return}try{if(le==="LANADA"){const{data:ct,error:st}=await St.from("devolucoes").select(`
              *,
              itens:itens_devolucao(id, motivo_id)
            `).eq("id",Q).single();if(st)throw console.error("Erro ao buscar devoluo:",st),st;if(!ct.motivo_id){_t.error("No  possvel lanar a nota sem o motivo principal preenchido.");return}if(ct.itens&&ct.itens.length>0){const lt=ct.itens.filter(tt=>!tt.motivo_id);if(lt.length>0){_t.error(`No  possvel lanar a nota. ${lt.length} item(ns) ainda no possui(m) motivo preenchido.`);return}}}const{data:te,error:ce}=await St.from("devolucoes").select("resultado").eq("id",Q).single();if(ce)throw console.error("Erro ao buscar resultado atual:",ce),ce;const he=(te==null?void 0:te.resultado)||"PENDENTE VALIDAO";if(he===le)return;let Ee=null;le==="LANADA"||le==="ANULADA/CANCELADA"?Ee="FINALIZADO":le==="TRATATIVA DE ANULAO"?Ee="TRATANDO":le==="VALIDADA"?Ee="CONCLUIDO":le==="PENDENTE VALIDAO"&&(Ee=null);const ke={resultado:le};Ee&&(ke.prazo=Ee);const Ce=R.name||R.email||"-";(le==="VALIDADA"||le==="TRATATIVA DE ANULAO")&&(ke.nome_validador=Ce),(le==="LANADA"||le==="ANULADA/CANCELADA")&&(ke.finalizada_por=Ce,ke.data_finalizacao=new Date().toISOString());const{error:Fe}=await St.from("devolucoes").update(ke).eq("id",Q);if(Fe)throw Fe;const{error:Pe}=await St.from("logs_validacao").insert({devolucao_id:Q,usuario_id:R.id,acao:"ALTERAR_RESULTADO",status_anterior:he,status_novo:le});Pe&&console.error("Erro ao salvar log:",Pe),_t.success(`Resultado alterado para: ${le}`);let Xe=null;if(le==="LANADA"||le==="ANULADA/CANCELADA"?Xe="FINALIZADO":le==="TRATATIVA DE ANULAO"?Xe="TRATANDO":le==="VALIDADA"&&(Xe="CONCLUIDO"),le==="LANADA"||le==="ANULADA/CANCELADA")r(ct=>ct.filter(st=>st.id!==Q)),n(ct=>ct.filter(st=>st.id!==Q));else{const ct=st=>st.id===Q?{...st,resultado:le,nome_validador:le!=="PENDENTE VALIDAO"&&(R.name||R.email)||"-",prazo:Xe||st.prazo}:st;r(st=>st.map(ct)),n(st=>st.map(ct))}}catch(te){_t.error("Erro ao processar: "+te.message)}},P=async(Q,fe)=>{if(R)try{const{data:le}=await St.from("devolucoes").select("resultado").eq("id",Q).single(),te=(le==null?void 0:le.resultado)||"PENDENTE VALIDAO",{data:ce}=await St.from("itens_devolucao").select("id").eq("devolucao_id",Q);if(ce&&ce.length>0)for(const Ce of ce){const{error:Fe}=await St.from("itens_devolucao").update({motivo_id:fe}).eq("id",Ce.id);if(Fe)throw console.error("Erro ao atualizar item:",Fe),Fe}const{error:he}=await St.from("devolucoes").update({motivo_id:fe,resultado:"VALIDADA",prazo:"CONCLUIDO",nome_validador:R.name||R.email||"-"}).eq("id",Q);if(he)throw he;const{error:Ee}=await St.from("logs_validacao").insert({devolucao_id:Q,usuario_id:R.id,acao:"SELECIONAR_MOTIVO",status_anterior:te,status_novo:"VALIDADA"});Ee&&console.error("Erro ao salvar log:",Ee),_t.success("Motivo aplicado a todos os produtos e resultado alterado para VALIDADA!");const ke=Ce=>{var Fe,Pe;return Ce.id===Q?{...Ce,motivo_id:fe,resultado:"VALIDADA",nome_validador:R.name||R.email||"-",prazo:"CONCLUIDO",motivo:((Fe=s.find(Xe=>Xe.id===fe))==null?void 0:Fe.nome)||Ce.motivo,itens:(Pe=Ce.itens)==null?void 0:Pe.map(Xe=>({...Xe,motivo_id:fe}))}:Ce};r(Ce=>Ce.map(ke)),n(Ce=>Ce.map(ke))}catch(le){_t.error("Erro ao processar: "+le.message)}},K=(Q,fe)=>{i(le=>({...le,[Q]:fe}))},Y=Q=>oB(Q)>100?(_t.warning("Mximo de 100 palavras permitido"),!1):!0,re=async Q=>{if(R&&Y(c[Q]||"")){p(fe=>({...fe,[Q]:!0}));try{const{error:fe}=await St.from("devolucoes").update({justificativa:c[Q]||null}).eq("id",Q);if(fe)throw fe;_t.success("Comentrio salvo com sucesso!"),await St.from("logs_validacao").insert({devolucao_id:Q,usuario_id:R.id,acao:"ADICIONAR_COMENTARIO",status_anterior:null,status_novo:null})}catch(fe){_t.error("Erro ao salvar comentrio: "+fe.message)}finally{p(fe=>({...fe,[Q]:!1}))}}},z=async(Q,fe,le)=>{var he;if(!R){console.error("Usurio no autenticado");return}if(!fe||fe.trim()===""){console.log("Motivo vazio, ignorando...");return}if(!Q||!le){console.error("IDs invlidos:",{itemId:Q,devolucaoId:le,tipoItemId:typeof Q,tipoDevolucaoId:typeof le}),_t.error("Erro: IDs invlidos. Verifique o console para mais detalhes.");return}const te=String(Q).trim(),ce=String(le).trim();if(!te||te==="undefined"||te==="null"){console.error("itemId invlido aps converso:",{itemId:Q,itemIdString:te}),_t.error("Erro: ID do produto invlido");return}try{const Ee=R.name||R.email||"-";console.log("Salvando motivo:",{itemId:te,motivoId:fe,devolucaoId:ce});const{data:ke,error:Ce}=await St.from("itens_devolucao").select("id, motivo_id, devolucao_id").eq("id",te).single();if(Ce)throw console.error("Erro ao verificar item:",Ce),_t.error("Erro: Item no encontrado no banco de dados. Verifique o console."),Ce;if(!ke){console.error("Item no encontrado:",te),_t.error("Erro: Item no encontrado");return}if(console.log("Item encontrado:",ke),ke.devolucao_id!==ce){console.error("Item no pertence  devoluo:",{itemDevolucaoId:ke.devolucao_id,devolucaoIdEsperado:ce}),_t.error("Erro: Item no pertence  devoluo correta");return}console.log("Tentando atualizar item:",{itemIdString:te,motivoId:fe});const{data:Fe,error:Pe}=await St.from("itens_devolucao").update({motivo_id:fe}).eq("id",te).select("id, motivo_id");if(console.log("Resultado do update:",{updatedItem:Fe,error:Pe}),Pe)throw console.error("Erro ao salvar motivo no Supabase:",Pe),_t.error("Erro ao salvar motivo: "+Pe.message),Pe;Fe&&Fe.length>0&&Fe[0].motivo_id===fe?console.log(" Motivo salvo com sucesso! Item atualizado:",Fe[0]):console.warn(" Update pode no ter funcionado completamente, verificando..."),await new Promise(vt=>setTimeout(vt,500));let Xe=null,ct=0;const st=5;for(;ct<st;){const{data:vt,error:Ve}=await St.from("itens_devolucao").select("id, motivo_id, devolucao_id").eq("id",te).single();if(Ve){if(console.error(`Erro ao verificar item (tentativa ${ct+1}):`,Ve),ct===st-1){console.warn("No foi possvel verificar o item aps todas as tentativas");break}}else if(vt&&(Xe=vt,console.log(`Item verificado (tentativa ${ct+1}):`,Xe),Xe.motivo_id===fe)){console.log(" Motivo confirmado no banco de dados!");break}ct<st-1&&await new Promise($e=>setTimeout($e,300)),ct++}if(!Xe||Xe.motivo_id!==fe){console.error(" Update no funcionou aps todas as tentativas!",{esperado:fe,atual:(Xe==null?void 0:Xe.motivo_id)||"null",itemVerificado:Xe}),_t.error("Erro: No foi possvel salvar o motivo. Pode ser um problema de permisses no banco de dados.");return}const lt=vt=>{var $e;return{itensAtualizados:($e=vt.itens)==null?void 0:$e.map(xt=>String(xt.id)===te?{...xt,motivo_id:fe}:xt)}};r(vt=>vt.map(Ve=>{if(String(Ve.id)!==ce)return Ve;const $e=lt(Ve);return{...Ve,itens:$e.itensAtualizados}})),n(vt=>vt.map(Ve=>{if(String(Ve.id)!==ce)return Ve;const $e=lt(Ve);return{...Ve,itens:$e.itensAtualizados}})),await new Promise(vt=>setTimeout(vt,500));let tt=null,ot=null,De=0;const ht=5;for(;De<ht;){const{data:vt,error:Ve}=await St.from("devolucoes").select(`
            itens:itens_devolucao(id, motivo_id)
          `).eq("id",ce).single();if(Ve){console.error(`Erro ao buscar devoluo (tentativa ${De+1}):`,Ve);const{data:$e,error:xt}=await St.from("itens_devolucao").select("id, motivo_id").eq("devolucao_id",ce);tt=$e,ot=xt}else vt&&vt.itens&&(tt=vt.itens,ot=null);if(ot){if(console.error(`Erro ao buscar itens (tentativa ${De+1}):`,ot),De===ht-1)break}else if(tt){const $e=tt.find(xt=>String(xt.id)===te);if(console.log(`Tentativa ${De+1} - Item encontrado:`,$e),$e&&$e.motivo_id===fe){console.log(` Item confirmado com motivo na tentativa ${De+1}`);break}else $e&&console.log(`Item ainda no tem o motivo correto. Esperado: ${fe}, Atual: ${$e.motivo_id}`)}De<ht-1&&(console.log(`Aguardando e tentando novamente... (tentativa ${De+1}/${ht})`),await new Promise($e=>setTimeout($e,400))),De++}if(ot)throw console.error("Erro ao buscar itens aps todas as tentativas:",ot),ot;if(!tt){console.error("No foi possvel buscar os itens"),_t.error("Erro: No foi possvel buscar os itens da devoluo");return}console.log("Itens encontrados:",tt);const it=tt&&tt.length>0&&tt.every(vt=>{const Ve=!!vt.motivo_id&&vt.motivo_id!==null&&vt.motivo_id!=="";return console.log("Item:",vt.id,"tem motivo?",Ve,"motivo_id:",vt.motivo_id),Ve});console.log("Todos tm motivo?",it,"Total de itens:",tt.length,"Itens com motivos:",tt.filter(vt=>!!vt.motivo_id).length);const dt={};let wt=null,gt=0;if(tt&&tt.forEach(vt=>{if(!vt.motivo_id||vt.motivo_id===null||vt.motivo_id==="")return;const Ve=String(vt.motivo_id),$e=(dt[Ve]||0)+1;dt[Ve]=$e,$e>gt&&(gt=$e,wt=Ve)}),console.log("Motivo mais repetido:",wt,"Contagem:",dt),it){const vt=wt||(tt&&tt.length>0&&((he=tt[0])!=null&&he.motivo_id)?String(tt[0].motivo_id):null);if(!vt){console.error("Erro: Todos tm motivos mas no foi possvel determinar o motivo principal"),_t.error("Erro ao validar: no foi possvel determinar o motivo principal");return}console.log("Validando nota...",{motivoParaSalvar:vt});const{data:Ve,error:$e}=await St.from("devolucoes").select("resultado, motivo_id").eq("id",ce).single();if($e)throw console.error("Erro ao buscar devoluo:",$e),$e;const xt=s.find(je=>je.id===vt),nt=(xt==null?void 0:xt.nome)||"",pt={resultado:"VALIDADA",prazo:"CONCLUIDO",nome_validador:Ee,motivo_id:vt};console.log("Atualizando devoluo com:",pt);const{error:Se}=await St.from("devolucoes").update(pt).eq("id",ce);if(Se)throw console.error("Erro ao atualizar devoluo:",Se),Se;console.log("Devoluo atualizada com sucesso!"),await St.from("logs_validacao").insert({devolucao_id:ce,usuario_id:R.id,acao:"SELECIONAR_MOTIVO_PRODUTO",status_anterior:(Ve==null?void 0:Ve.resultado)||"PENDENTE VALIDAO",status_novo:"VALIDADA"}),r(je=>je.map(Qe=>String(Qe.id)!==ce?Qe:{...Qe,resultado:"VALIDADA",prazo:"CONCLUIDO",nome_validador:Ee,motivo_id:vt,motivo:nt||Qe.motivo})),n(je=>je.map(Qe=>String(Qe.id)!==ce?Qe:{...Qe,resultado:"VALIDADA",prazo:"CONCLUIDO",nome_validador:Ee,motivo_id:vt,motivo:nt||Qe.motivo})),_t.success("Motivo salvo! Todos os produtos tm motivos. Resultado alterado para VALIDADA!")}else{const vt=(tt==null?void 0:tt.filter($e=>!!$e.motivo_id).length)||0,Ve=(tt==null?void 0:tt.length)||0;_t.success(`Motivo salvo para o produto! (${vt}/${Ve} produtos com motivos)`)}}catch(Ee){console.error("Erro completo:",Ee),_t.error("Erro ao atualizar motivo: "+Ee.message)}},ee=async()=>{if(!(!B||!R))try{const{error:Q}=await St.from("itens_devolucao").delete().eq("devolucao_id",B);if(Q)throw Q;const{error:fe}=await St.from("devolucoes").delete().eq("id",B);if(fe)throw fe;_t.success("Registro excludo com sucesso!"),W(null),A(),k(new Set)}catch(Q){_t.error("Erro ao excluir registro: "+Q.message)}},L=async()=>{if(y.size===0){_t.warning("Selecione pelo menos um registro para excluir");return}if(!V){q(!0);return}try{const Q=Array.from(y);for(const le of Q)await St.from("itens_devolucao").delete().eq("devolucao_id",le);const{error:fe}=await St.from("devolucoes").delete().in("id",Q);if(fe)throw fe;_t.success(`${Q.length} registro(s) excludo(s) com sucesso!`),q(!1),A(),k(new Set),I(!1)}catch(Q){_t.error("Erro ao excluir registros: "+Q.message),q(!1)}},M=Q=>{F(Q)},Z=async()=>{if(!(!N||!R))try{const{error:Q}=await St.from("devolucoes").update({numero:N.numero,nome_cliente:N.nome_cliente,vendedor:N.vendedor,cidade_origem:N.cidade_origem,uf_origem:N.uf_origem,data_emissao:N.data_emissao,valor_total_nota:N.valor_total_nota,peso_liquido:N.peso_liquido,motivo_id:N.motivo_id,setor_id:N.setor_id,resultado:N.resultado,justificativa:N.justificativa,updated_at:new Date().toISOString()}).eq("id",N.id);if(Q)throw Q;_t.success("Registro atualizado com sucesso!"),F(null),A()}catch(Q){_t.error("Erro ao atualizar registro: "+Q.message)}},se=Q=>{var ce;const fe=((ce=Q.itens)==null?void 0:ce.map((he,Ee)=>`${Ee+1}. ${he.descricao||"-"}
   Quantidade: ${he.quantidade||"-"} ${he.unidade||""}
   Valor Unitrio: R$ ${(Number(he.valor_unitario)||0).toFixed(2)}
   Valor Total: R$ ${(Number(he.valor_total_bruto)||0).toFixed(2)}`).join(`

`))||"Nenhum produto cadastrado",le=` *Devoluo - Nota Fiscal ${Q.numero||"-"}*

*Cliente:* ${Q.nome_cliente||"-"}
*Vendedor:* ${Q.vendedor||"-"}
*Data de Emisso:* ${Q.data_emissao?Wt(new Date(Q.data_emissao),"dd/MM/yyyy",{locale:br}):"-"}
*Origem:* ${Q.cidade_origem||"-"}/${Q.uf_origem||"-"}

*Valor Total:* R$ ${(Number(Q.valor_total_nota)||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}
*Peso Lquido:* ${Q.peso_liquido||"-"} kg
*Dias:* ${Q.dias!==null&&Q.dias!==void 0?Q.dias:"-"}
*Prazo:* ${Q.prazo||"-"}
*Resultado:* ${Q.resultado||"-"}
*Motivo:* ${Q.motivo||"-"}
*Setor:* ${Q.setor||"-"}

*Produtos:*
${fe}

${Q.justificativa?`*Comentrio:*
${Q.justificativa}`:""}`,te=`https://wa.me/?text=${encodeURIComponent(le)}`;window.open(te,"_blank")},ae=Q=>{const fe=new Set(y);fe.has(Q)?fe.delete(Q):fe.add(Q),k(fe)},ne=()=>{y.size===t.length?k(new Set):k(new Set(t.map(Q=>Q.id)))};return _.jsxs("div",{className:"space-y-6",children:[_.jsx(Qi,{title:"Validao",description:"Valide e gerencie devolues pendentes. Selecione motivos, altere resultados e adicione comentrios para cada devoluo."}),_.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[_.jsx(Xf,{}),_.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full md:w-auto shrink-0",children:[X&&y.size>0&&_.jsxs(Nt,{variant:"destructive",onClick:()=>q(!0),className:"w-full sm:w-auto",disabled:y.size===0,children:[_.jsx(za,{className:"mr-2 h-4 w-4"}),"Excluir (",y.size,")"]}),_.jsx(Nt,{variant:X?"default":"outline",onClick:()=>{I(!X),k(new Set)},className:"w-full sm:w-auto",children:X?_.jsxs(_.Fragment,{children:[_.jsx(Vf,{className:"mr-2 h-4 w-4"}),"Cancelar Seleo"]}):_.jsxs(_.Fragment,{children:[_.jsx(_f,{className:"mr-2 h-4 w-4"}),"Selecionar"]})})]})]}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[_.jsxs(jt,{children:[_.jsx(Dt,{className:"pb-2",children:_.jsx(Rt,{className:"text-sm font-medium",children:"NF Pendentes"})}),_.jsx(Ot,{children:_.jsx("div",{className:"text-2xl font-bold",children:H.nfPendentes})})]}),_.jsxs(jt,{children:[_.jsx(Dt,{className:"pb-2",children:_.jsx(Rt,{className:"text-sm font-medium",children:"Total Pendente"})}),_.jsx(Ot,{children:_.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",H.totalPendente.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),_.jsxs(jt,{children:[_.jsx(Dt,{className:"pb-2",children:_.jsx(Rt,{className:"text-sm font-medium",children:"NF Validadas"})}),_.jsx(Ot,{children:_.jsx("div",{className:"text-2xl font-bold text-blue-600",children:H.nfValidadas})})]}),_.jsxs(jt,{children:[_.jsx(Dt,{className:"pb-2",children:_.jsx(Rt,{className:"text-sm font-medium",children:"Total Validadas"})}),_.jsx(Ot,{children:_.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["R$ ",H.totalValidadas.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),_.jsxs(jt,{children:[_.jsx(Dt,{className:"pb-2",children:_.jsx(Rt,{className:"text-sm font-medium",children:"NF em Cancelamento"})}),_.jsx(Ot,{children:_.jsx("div",{className:"text-2xl font-bold",children:H.nfCancelamento})})]}),_.jsxs(jt,{children:[_.jsx(Dt,{className:"pb-2",children:_.jsx(Rt,{className:"text-sm font-medium",children:"Total Cancelamento"})}),_.jsx(Ot,{children:_.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",H.totalCancelamento.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),_.jsxs(jt,{children:[_.jsx(Dt,{className:"pb-2",children:_.jsx(Rt,{className:"text-sm font-medium",children:"NF em Atraso"})}),_.jsx(Ot,{children:_.jsx("div",{className:"text-2xl font-bold text-red-600",children:H.nfAtraso})})]}),_.jsxs(jt,{children:[_.jsx(Dt,{className:"pb-2",children:_.jsx(Rt,{className:"text-sm font-medium",children:"Total em Atraso"})}),_.jsx(Ot,{children:_.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["R$ ",H.totalAtraso.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]})]}),_.jsx("div",{className:"rounded-md border bg-card min-h-[400px]",children:a?_.jsx("div",{className:"flex items-center justify-center h-full py-20",children:_.jsx(oi,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):t.length===0?_.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-20 text-muted-foreground",children:[_.jsx(Iy,{className:"h-10 w-10 mb-2"}),_.jsx("p",{children:"Nenhuma devoluo encontrada."})]}):_.jsxs("div",{children:[e.length>w&&_.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[_.jsxs("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",(f-1)*w+1," a ",Math.min(f*w,e.length)," de ",e.length," registros"]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsxs(Nt,{variant:"outline",size:"sm",onClick:()=>h(Q=>Math.max(1,Q-1)),disabled:f===1,children:[_.jsx(yu,{className:"h-4 w-4 mr-1"}),"Anterior"]}),_.jsxs("div",{className:"text-sm text-muted-foreground",children:["Pgina ",f," de ",Math.ceil(e.length/w)]}),_.jsxs(Nt,{variant:"outline",size:"sm",onClick:()=>h(Q=>Math.min(Math.ceil(e.length/w),Q+1)),disabled:f>=Math.ceil(e.length/w),children:["Prxima",_.jsx(wu,{className:"h-4 w-4 ml-1"})]})]})]}),_.jsx("div",{className:"overflow-x-auto border rounded-lg",children:_.jsxs(Un,{children:[_.jsx(Jn,{className:"bg-muted/50",children:_.jsxs(dr,{children:[X&&_.jsx(Tt,{className:"w-[50px] sticky left-0 bg-muted/50 z-10",children:_.jsx("button",{onClick:ne,className:"p-1 hover:bg-muted rounded",children:y.size===t.length&&t.length>0?_.jsx(_f,{className:"h-4 w-4"}):_.jsx(sx,{className:"h-4 w-4"})})}),_.jsx(Tt,{className:"w-[50px] sticky left-0 bg-muted/50 z-10"}),_.jsx(Tt,{className:"min-w-[100px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("data_emissao"),children:_.jsxs("div",{className:"flex items-center gap-1",children:["Data Emisso",_.jsx(D,{field:"data_emissao"})]})}),_.jsx(Tt,{className:"min-w-[120px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("numero"),children:_.jsxs("div",{className:"flex items-center gap-1",children:["Nota Fiscal",_.jsx(D,{field:"numero"})]})}),_.jsx(Tt,{className:"min-w-[200px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("nome_cliente"),children:_.jsxs("div",{className:"flex items-center gap-1",children:["Cliente",_.jsx(D,{field:"nome_cliente"})]})}),_.jsx(Tt,{className:"min-w-[150px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("vendedor"),children:_.jsxs("div",{className:"flex items-center gap-1",children:["Vendedor",_.jsx(D,{field:"vendedor"})]})}),_.jsx(Tt,{className:"min-w-[150px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("motivo"),children:_.jsxs("div",{className:"flex items-center gap-1",children:["Motivo",_.jsx(D,{field:"motivo"})]})}),_.jsx(Tt,{className:"min-w-[100px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("valor_total_nota"),children:_.jsxs("div",{className:"flex items-center gap-1",children:["Valor Total",_.jsx(D,{field:"valor_total_nota"})]})}),_.jsx(Tt,{className:"min-w-[60px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("dias"),children:_.jsxs("div",{className:"flex items-center gap-1",children:["Dias",_.jsx(D,{field:"dias"})]})}),_.jsx(Tt,{className:"min-w-[100px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("prazo"),children:_.jsxs("div",{className:"flex items-center gap-1",children:["Prazo",_.jsx(D,{field:"prazo"})]})}),_.jsx(Tt,{className:"min-w-[120px] cursor-pointer hover:bg-muted/50 text-xs font-semibold px-3 py-3",onClick:()=>T("resultado"),children:_.jsxs("div",{className:"flex items-center gap-1",children:["Resultado",_.jsx(D,{field:"resultado"})]})}),_.jsx(Tt,{className:"min-w-[150px] text-xs font-semibold px-3 py-3",children:"Validado Por"}),_.jsx(Tt,{className:"min-w-[200px] text-xs font-semibold px-3 py-3",children:"Comentrio"}),_.jsx(Tt,{className:"min-w-[120px] text-xs font-semibold px-3 py-3",children:"Aes"})]})}),_.jsx(zn,{children:t.map(Q=>{const fe=Q.resultado||"PENDENTE VALIDAO";return _.jsx(dr,{className:"group hover:bg-muted/30",children:_.jsx(Pt,{colSpan:X?15:14,className:"p-0",children:_.jsx(s_,{type:"single",collapsible:!0,className:"w-full",children:_.jsxs(Lm,{value:Q.id,className:"border-0",children:[_.jsxs("div",{className:"flex items-center w-full py-3 px-3 hover:bg-muted/50 transition-colors",children:[X&&_.jsx("button",{onClick:()=>ae(Q.id),className:"w-[50px] flex items-center justify-center flex-shrink-0",children:y.has(Q.id)?_.jsx(_f,{className:"h-4 w-4 text-primary"}):_.jsx(sx,{className:"h-4 w-4"})}),_.jsxs("div",{className:"flex items-center gap-3 w-full text-xs",children:[_.jsx(Bm,{className:"w-[50px] py-0 pr-2 hover:no-underline flex-shrink-0"}),_.jsx("div",{className:"min-w-[100px] text-xs",children:Q.data_emissao?Wt(new Date(Q.data_emissao),"dd/MM/yyyy",{locale:br}):"-"}),_.jsx("div",{className:"min-w-[120px] font-medium text-xs",children:Q.numero}),_.jsx("div",{className:"min-w-[200px] truncate text-xs",title:Q.nome_cliente,children:Q.nome_cliente}),_.jsx("div",{className:"min-w-[150px] truncate text-xs",title:Q.vendedor,children:Q.vendedor}),_.jsx("div",{className:"w-40",style:{position:"relative",zIndex:1e4},onMouseDown:le=>{le.stopPropagation(),le.preventDefault()},onPointerDown:le=>{le.stopPropagation(),le.preventDefault()},onClick:le=>{le.stopPropagation()},children:_.jsxs("select",{value:Q.motivo_id||"",onChange:le=>{le.stopPropagation(),P(Q.id,le.target.value)},onMouseDown:le=>{le.stopPropagation()},onPointerDown:le=>{le.stopPropagation()},onClick:le=>{le.stopPropagation()},onFocus:le=>{le.stopPropagation()},onKeyDown:le=>{le.stopPropagation()},className:"h-7 w-full px-2 text-[10px] border rounded-md bg-background cursor-pointer",style:{position:"relative",zIndex:10001},children:[_.jsxs("option",{value:"",children:["Selecione... (",s.length," motivos)"]}),s&&s.length>0?s.map(le=>{var ce;const te=((ce=le.setores)==null?void 0:ce.nome)||"";return _.jsxs("option",{value:le.id,children:[le.nome," ",te?`(${te})`:""]},le.id)}):_.jsx("option",{value:"",disabled:!0,children:"Carregando motivos..."})]})}),_.jsx("div",{className:"w-24 text-[9px] text-muted-foreground",children:Q.motivo_id&&(()=>{var ce;const le=s.find(he=>he.id===Q.motivo_id),te=le?(ce=le.setores)==null?void 0:ce.nome:null;return te?`Setor: ${te}`:""})()}),_.jsxs("div",{className:"w-20 font-bold",children:["R$ ",Number(Q.valor_total_nota||0).toFixed(2)]}),_.jsx("div",{className:"w-12 text-center",children:Q.dias!==null&&Q.dias!==void 0?Q.dias:"-"}),_.jsx("div",{className:"w-20",children:_.jsx("span",{className:`text-[9px] px-1 py-0.5 rounded ${Q.prazo==="EM ATRASO"?"bg-red-500 text-white":Q.prazo==="NO PRAZO"?"bg-green-500 text-white":Q.prazo==="FINALIZADO"?"bg-green-200 text-green-800 dark:bg-green-900 dark:text-green-200":Q.prazo==="TRATANDO"?"bg-purple-200 text-purple-800 dark:bg-purple-900 dark:text-purple-200":Q.prazo==="CONCLUIDO"?"bg-blue-200 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-gray-500 text-white"}`,children:Q.prazo||"-"})}),_.jsx("div",{className:"w-32",children:_.jsxs($a,{value:fe,onValueChange:le=>{U(Q.id,le)},children:[_.jsx(xa,{className:`h-6 w-full text-[8px] px-1 py-0.5 ${Q2[fe]} border-0 cursor-pointer hover:opacity-90`,onClick:le=>le.stopPropagation(),onMouseDown:le=>le.stopPropagation(),children:_.jsx(Va,{className:"text-white",children:fe})}),_.jsx(ya,{onClick:le=>le.stopPropagation(),onMouseDown:le=>le.stopPropagation(),className:"z-[10000]",children:J2.map(le=>_.jsx(sr,{value:le,className:`${Q2[le]} text-white cursor-pointer hover:opacity-90`,children:le},le))})]})}),_.jsx("div",{className:"w-28 truncate text-[9px]",title:Q.nome_validador||"-",children:Q.nome_validador||"-"}),_.jsxs("div",{className:"w-48 flex gap-1",children:[_.jsx(cm,{className:`h-7 text-[9px] min-h-[28px] max-h-[28px] resize-none flex-1 ${c[Q.id]||Q.justificativa?"bg-red-100/50 dark:bg-red-900/20 border-red-300 dark:border-red-700":""}`,placeholder:"Comentrio...",value:c[Q.id]||"",onChange:le=>K(Q.id,le.target.value),onClick:le=>le.stopPropagation(),maxLength:500}),_.jsx(Nt,{size:"sm",variant:"outline",className:"h-7 px-1",onClick:le=>{le.stopPropagation(),re(Q.id)},disabled:u[Q.id],children:_.jsx(uk,{className:"h-3 w-3"})})]}),_.jsxs("div",{className:"w-28 flex gap-1",children:[_.jsx(Nt,{size:"sm",variant:"outline",className:"h-7 px-1",onClick:le=>{le.stopPropagation(),se(Q)},title:"Compartilhar via WhatsApp",children:_.jsx(Fp,{className:"h-3 w-3"})}),((R==null?void 0:R.role)==="ADMIN"||(R==null?void 0:R.role)==="LOGISTICA")&&_.jsxs(_.Fragment,{children:[_.jsx(Nt,{size:"sm",variant:"outline",className:"h-7 px-1",onClick:le=>{le.stopPropagation(),M(Q)},title:"Editar",children:_.jsx(ax,{className:"h-3 w-3"})}),_.jsx(Nt,{size:"sm",variant:"destructive",className:"h-7 px-1",onClick:le=>{le.stopPropagation(),W(Q.id)},title:"Excluir",children:_.jsx(za,{className:"h-3 w-3"})})]})]})]})]}),_.jsx(Um,{children:_.jsx("div",{className:"px-4 pb-4",children:_.jsxs("div",{className:"rounded-md border bg-muted/50 p-4",children:[_.jsx("div",{className:"mb-3 pb-2 border-b",children:_.jsxs("p",{className:"text-sm font-medium text-muted-foreground",children:[_.jsx("span",{className:"font-semibold",children:"Origem:"})," ",Q.cidade_origem||"-","/",Q.uf_origem||"-"]})}),_.jsx("h4",{className:"font-semibold mb-2 text-sm",children:"Itens da Devoluo"}),_.jsxs(Un,{children:[_.jsx(Jn,{children:_.jsxs(dr,{children:[_.jsx(Tt,{className:"h-8 text-xs",children:"Nmero"}),_.jsx(Tt,{className:"h-8 text-xs",children:"Descrio"}),_.jsx(Tt,{className:"h-8 text-xs",children:"Unidade"}),_.jsx(Tt,{className:"h-8 text-xs",children:"Quantidade"}),_.jsx(Tt,{className:"h-8 text-xs",children:"Valor Unitrio"}),_.jsx(Tt,{className:"h-8 text-xs",children:"Valor Total Bruto"}),_.jsx(Tt,{className:"h-8 text-xs",children:"Motivo"})]})}),_.jsx(zn,{children:Q.itens&&Q.itens.length>0?Q.itens.map((le,te)=>_.jsxs(dr,{children:[_.jsx(Pt,{className:"text-xs",children:le.numero_item||"-"}),_.jsx(Pt,{className:"text-xs",children:le.descricao||"-"}),_.jsx(Pt,{className:"text-xs",children:le.unidade||"-"}),_.jsx(Pt,{className:"text-xs",children:le.quantidade||"-"}),_.jsxs(Pt,{className:"text-xs",children:["R$ ",Number(le.valor_unitario||0).toFixed(2)]}),_.jsxs(Pt,{className:"text-xs",children:["R$ ",Number(le.valor_total_bruto||0).toFixed(2)]}),_.jsxs(Pt,{className:"text-xs relative",style:{position:"relative",zIndex:9999},onMouseDown:ce=>ce.stopPropagation(),onPointerDown:ce=>ce.stopPropagation(),onClick:ce=>ce.stopPropagation(),children:[_.jsxs("select",{value:le.motivo_id||"",onChange:ce=>{ce.stopPropagation();const he=ce.target.value;console.log("Select onChange:",{motivoSelecionado:he,prodId:le.id,itemId:Q.id,produto:le}),he&&le.id&&Q.id?z(le.id,he,Q.id):(console.error("Valores invlidos:",{motivoSelecionado:he,prodId:le.id,itemId:Q.id}),_t.error("Erro: Dados invlidos para salvar motivo"))},onMouseDown:ce=>{ce.stopPropagation()},onPointerDown:ce=>{ce.stopPropagation()},onClick:ce=>{ce.stopPropagation()},onFocus:ce=>{ce.stopPropagation()},className:"h-7 w-full px-2 text-xs border rounded-md bg-background cursor-pointer",style:{position:"relative",zIndex:9999},children:[_.jsx("option",{value:"",children:"Selecione..."}),s&&s.length>0?s.map(ce=>{var Ee;const he=((Ee=ce.setores)==null?void 0:Ee.nome)||"";return _.jsxs("option",{value:ce.id,children:[ce.nome," ",he?`(${he})`:""]},ce.id)}):_.jsx("option",{value:"",disabled:!0,children:"Carregando motivos..."})]}),le.motivo_id&&(()=>{var Ee;const ce=s.find(ke=>ke.id===le.motivo_id),he=ce?(Ee=ce.setores)==null?void 0:Ee.nome:null;return he?_.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Setor: ",he]}):null})()]})]},te)):_.jsx(dr,{children:_.jsx(Pt,{colSpan:7,className:"text-center text-xs text-muted-foreground",children:"Nenhum item cadastrado"})})})]}),Q.dados_adicionais&&_.jsx("div",{className:"mt-4 pt-4 border-t",children:_.jsx("p",{className:"text-[10px] font-bold italic text-muted-foreground whitespace-pre-wrap break-words",children:Q.dados_adicionais})})]})})})]})})})},Q.id)})})]})}),e.length>w&&_.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t",children:[_.jsxs("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",(f-1)*w+1," a ",Math.min(f*w,e.length)," de ",e.length," registros"]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsxs(Nt,{variant:"outline",size:"sm",onClick:()=>h(Q=>Math.max(1,Q-1)),disabled:f===1,children:[_.jsx(yu,{className:"h-4 w-4 mr-1"}),"Anterior"]}),_.jsxs("div",{className:"text-sm text-muted-foreground",children:["Pgina ",f," de ",Math.ceil(e.length/w)]}),_.jsxs(Nt,{variant:"outline",size:"sm",onClick:()=>h(Q=>Math.min(Math.ceil(e.length/w),Q+1)),disabled:f>=Math.ceil(e.length/w),children:["Prxima",_.jsx(wu,{className:"h-4 w-4 ml-1"})]})]})]})]})}),_.jsx(ri,{open:!!B,onOpenChange:Q=>!Q&&W(null),children:_.jsxs(As,{className:"sm:max-w-[425px]",children:[_.jsxs(Cs,{children:[_.jsxs(js,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[_.jsx(za,{className:"h-5 w-5"}),"Confirmar Excluso"]}),_.jsx(Os,{className:"pt-2",children:"Tem certeza que deseja excluir este registro?"}),_.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mt-4",children:_.jsx("p",{className:"text-sm text-destructive font-medium",children:" Esta ao no pode ser desfeita."})})]}),_.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[_.jsx(Nt,{variant:"outline",onClick:()=>W(null),className:"flex-1 sm:flex-initial",children:"No"}),_.jsx(Nt,{variant:"destructive",onClick:ee,className:"flex-1 sm:flex-initial",children:"Sim, Excluir"})]})]})}),_.jsx(ri,{open:V,onOpenChange:Q=>!Q&&q(!1),children:_.jsxs(As,{className:"sm:max-w-[425px]",children:[_.jsxs(Cs,{children:[_.jsxs(js,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[_.jsx(za,{className:"h-5 w-5"}),"Confirmar Excluso"]}),_.jsxs(Os,{className:"pt-2",children:["Tem certeza que deseja excluir ",_.jsxs("span",{className:"font-semibold text-foreground",children:[y.size," registro(s)"]}),"?"]}),_.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mt-4",children:_.jsx("p",{className:"text-sm text-destructive font-medium",children:" Esta ao no pode ser desfeita."})})]}),_.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[_.jsx(Nt,{variant:"outline",onClick:()=>q(!1),className:"flex-1 sm:flex-initial",children:"No"}),_.jsx(Nt,{variant:"destructive",onClick:L,className:"flex-1 sm:flex-initial",children:"Sim, Excluir"})]})]})}),_.jsx(ri,{open:!!N,onOpenChange:Q=>!Q&&F(null),children:_.jsxs(As,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[_.jsxs(Cs,{children:[_.jsxs(js,{className:"text-xl font-bold flex items-center gap-2",children:[_.jsx(ax,{className:"h-5 w-5 text-primary"}),"Editar Registro"]}),_.jsx(Os,{className:"pt-2",children:"Alterar informaes da nota fiscal"})]}),N&&_.jsxs("div",{className:"space-y-4 py-4",children:[_.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"Nmero da Nota"}),_.jsx(_r,{value:N.numero||"",onChange:Q=>F({...N,numero:Q.target.value})})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"Cliente"}),_.jsx(_r,{value:N.nome_cliente||"",onChange:Q=>F({...N,nome_cliente:Q.target.value})})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"Vendedor"}),_.jsx(_r,{value:N.vendedor||"",onChange:Q=>F({...N,vendedor:Q.target.value})})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"Cidade Origem"}),_.jsx(_r,{value:N.cidade_origem||"",onChange:Q=>F({...N,cidade_origem:Q.target.value})})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"UF Origem"}),_.jsx(_r,{value:N.uf_origem||"",onChange:Q=>F({...N,uf_origem:Q.target.value})})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"Data de Emisso"}),_.jsx(_r,{type:"date",value:N.data_emissao?new Date(N.data_emissao).toISOString().split("T")[0]:"",onChange:Q=>F({...N,data_emissao:Q.target.value})})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"Valor Total"}),_.jsx(_r,{type:"number",step:"0.01",value:N.valor_total_nota||"",onChange:Q=>F({...N,valor_total_nota:Q.target.value})})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"Peso Lquido"}),_.jsx(_r,{type:"number",step:"0.01",value:N.peso_liquido||"",onChange:Q=>F({...N,peso_liquido:Q.target.value})})]})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"Motivo Principal"}),_.jsxs($a,{value:N.motivo_id||"",onValueChange:Q=>F({...N,motivo_id:Q}),children:[_.jsx(xa,{children:_.jsx(Va,{placeholder:"Selecione um motivo"})}),_.jsx(ya,{children:s.map(Q=>_.jsx(sr,{value:Q.id,children:Q.nome},Q.id))})]})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"Justificativa"}),_.jsx(cm,{value:N.justificativa||"",onChange:Q=>F({...N,justificativa:Q.target.value})})]})]}),_.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[_.jsx(Nt,{variant:"outline",onClick:()=>F(null),className:"flex-1 sm:flex-initial",children:"Cancelar"}),_.jsx(Nt,{onClick:Z,className:"flex-1 sm:flex-initial bg-primary hover:bg-primary/90",children:"Salvar Alteraes"})]})]})})]})}var Np="rovingFocusGroup.onEntryFocus",cB={bubbles:!1,cancelable:!0},Ju="RovingFocusGroup",[um,z4,uB]=Z5(Ju),[dB,$4]=Uf(Ju,[uB]),[fB,hB]=dB(Ju),V4=_e.forwardRef((t,r)=>_.jsx(um.Provider,{scope:t.__scopeRovingFocusGroup,children:_.jsx(um.Slot,{scope:t.__scopeRovingFocusGroup,children:_.jsx(pB,{...t,ref:r})})}));V4.displayName=Ju;var pB=_e.forwardRef((t,r)=>{const{__scopeRovingFocusGroup:e,orientation:n,loop:a=!1,dir:o,currentTabStopId:s,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:i,preventScrollOnEntryFocus:u=!1,...p}=t,f=_e.useRef(null),h=Bu(r,f),v=gy(o),[b,g]=hm({prop:s,defaultProp:l??null,onChange:c,caller:Ju}),[x,y]=_e.useState(!1),k=dm(i),N=z4(e),F=_e.useRef(!1),[B,W]=_e.useState(0);return _e.useEffect(()=>{const V=f.current;if(V)return V.addEventListener(Np,k),()=>V.removeEventListener(Np,k)},[k]),_.jsx(fB,{scope:e,orientation:n,dir:v,loop:a,currentTabStopId:b,onItemFocus:_e.useCallback(V=>g(V),[g]),onItemShiftTab:_e.useCallback(()=>y(!0),[]),onFocusableItemAdd:_e.useCallback(()=>W(V=>V+1),[]),onFocusableItemRemove:_e.useCallback(()=>W(V=>V-1),[]),children:_.jsx(Rs.div,{tabIndex:x||B===0?-1:0,"data-orientation":n,...p,ref:h,style:{outline:"none",...t.style},onMouseDown:ca(t.onMouseDown,()=>{F.current=!0}),onFocus:ca(t.onFocus,V=>{const q=!F.current;if(V.target===V.currentTarget&&q&&!x){const X=new CustomEvent(Np,cB);if(V.currentTarget.dispatchEvent(X),!X.defaultPrevented){const I=N().filter(w=>w.focusable),H=I.find(w=>w.active),O=I.find(w=>w.id===b),C=[H,O,...I].filter(Boolean).map(w=>w.ref.current);W4(C,u)}}F.current=!1}),onBlur:ca(t.onBlur,()=>y(!1))})})}),H4="RovingFocusGroupItem",q4=_e.forwardRef((t,r)=>{const{__scopeRovingFocusGroup:e,focusable:n=!0,active:a=!1,tabStopId:o,children:s,...l}=t,c=pm(),i=o||c,u=hB(H4,e),p=u.currentTabStopId===i,f=z4(e),{onFocusableItemAdd:h,onFocusableItemRemove:v,currentTabStopId:b}=u;return _e.useEffect(()=>{if(n)return h(),()=>v()},[n,h,v]),_.jsx(um.ItemSlot,{scope:e,id:i,focusable:n,active:a,children:_.jsx(Rs.span,{tabIndex:p?0:-1,"data-orientation":u.orientation,...l,ref:r,onMouseDown:ca(t.onMouseDown,g=>{n?u.onItemFocus(i):g.preventDefault()}),onFocus:ca(t.onFocus,()=>u.onItemFocus(i)),onKeyDown:ca(t.onKeyDown,g=>{if(g.key==="Tab"&&g.shiftKey){u.onItemShiftTab();return}if(g.target!==g.currentTarget)return;const x=vB(g,u.orientation,u.dir);if(x!==void 0){if(g.metaKey||g.ctrlKey||g.altKey||g.shiftKey)return;g.preventDefault();let k=f().filter(N=>N.focusable).map(N=>N.ref.current);if(x==="last")k.reverse();else if(x==="prev"||x==="next"){x==="prev"&&k.reverse();const N=k.indexOf(g.currentTarget);k=u.loop?bB(k,N+1):k.slice(N+1)}setTimeout(()=>W4(k))}}),children:typeof s=="function"?s({isCurrentTabStop:p,hasTabStop:b!=null}):s})})});q4.displayName=H4;var mB={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function gB(t,r){return r!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function vB(t,r,e){const n=gB(t.key,e);if(!(r==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(r==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return mB[n]}function W4(t,r=!1){const e=document.activeElement;for(const n of t)if(n===e||(n.focus({preventScroll:r}),document.activeElement!==e))return}function bB(t,r){return t.map((e,n)=>t[(r+n)%t.length])}var xB=V4,yB=q4,th="Tabs",[wB,ZB]=Uf(th,[$4]),G4=$4(),[_B,p1]=wB(th),Y4=_e.forwardRef((t,r)=>{const{__scopeTabs:e,value:n,onValueChange:a,defaultValue:o,orientation:s="horizontal",dir:l,activationMode:c="automatic",...i}=t,u=gy(l),[p,f]=hm({prop:n,onChange:a,defaultProp:o??"",caller:th});return _.jsx(_B,{scope:e,baseId:pm(),value:p,onValueChange:f,orientation:s,dir:u,activationMode:c,children:_.jsx(Rs.div,{dir:u,"data-orientation":s,...i,ref:r})})});Y4.displayName=th;var X4="TabsList",K4=_e.forwardRef((t,r)=>{const{__scopeTabs:e,loop:n=!0,...a}=t,o=p1(X4,e),s=G4(e);return _.jsx(xB,{asChild:!0,...s,orientation:o.orientation,dir:o.dir,loop:n,children:_.jsx(Rs.div,{role:"tablist","aria-orientation":o.orientation,...a,ref:r})})});K4.displayName=X4;var Z4="TabsTrigger",J4=_e.forwardRef((t,r)=>{const{__scopeTabs:e,value:n,disabled:a=!1,...o}=t,s=p1(Z4,e),l=G4(e),c=t3(s.baseId,n),i=r3(s.baseId,n),u=n===s.value;return _.jsx(yB,{asChild:!0,...l,focusable:!a,active:u,children:_.jsx(Rs.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":i,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...o,ref:r,onMouseDown:ca(t.onMouseDown,p=>{!a&&p.button===0&&p.ctrlKey===!1?s.onValueChange(n):p.preventDefault()}),onKeyDown:ca(t.onKeyDown,p=>{[" ","Enter"].includes(p.key)&&s.onValueChange(n)}),onFocus:ca(t.onFocus,()=>{const p=s.activationMode!=="manual";!u&&!a&&p&&s.onValueChange(n)})})})});J4.displayName=Z4;var Q4="TabsContent",e3=_e.forwardRef((t,r)=>{const{__scopeTabs:e,value:n,forceMount:a,children:o,...s}=t,l=p1(Q4,e),c=t3(l.baseId,n),i=r3(l.baseId,n),u=n===l.value,p=_e.useRef(u);return _e.useEffect(()=>{const f=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(f)},[]),_.jsx(fm,{present:a||u,children:({present:f})=>_.jsx(Rs.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:i,tabIndex:0,...s,ref:r,style:{...t.style,animationDuration:p.current?"0s":void 0},children:f&&o})})});e3.displayName=Q4;function t3(t,r){return`${t}-trigger-${r}`}function r3(t,r){return`${t}-content-${r}`}var SB=Y4,n3=K4,a3=J4,s3=e3;const i3=SB,m1=_e.forwardRef(({className:t,...r},e)=>_.jsx(n3,{ref:e,className:Et("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...r}));m1.displayName=n3.displayName;const Yi=_e.forwardRef(({className:t,...r},e)=>_.jsx(a3,{ref:e,className:Et("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...r}));Yi.displayName=a3.displayName;const Xi=_e.forwardRef(({className:t,...r},e)=>_.jsx(s3,{ref:e,className:Et("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r}));Xi.displayName=s3.displayName;function kB(){const{user:t}=Dn(),[r,e]=_e.useState([]),[n,a]=_e.useState([]),[o,s]=_e.useState([]),[l,c]=_e.useState([]),[i,u]=_e.useState([]),[p,f]=_e.useState(""),[h,v]=_e.useState(""),[b,g]=_e.useState(""),[x,y]=_e.useState(""),[k,N]=_e.useState(""),[F,B]=_e.useState(""),[W,V]=_e.useState(""),[q,X]=_e.useState(""),[I,H]=_e.useState(""),[O,R]=_e.useState(""),[C,w]=_e.useState(null),[E,A]=_e.useState(""),[T,D]=_e.useState("COMERCIAL"),[U,P]=_e.useState(""),[K,Y]=_e.useState(""),[re,z]=_e.useState(null),[ee,L]=_e.useState(null),[M,Z]=_e.useState(null),[se,ae]=_e.useState(""),[ne,Q]=_e.useState(""),[fe,le]=_e.useState(""),[te,ce]=_e.useState("NOVO"),[he,Ee]=_e.useState("");_e.useEffect(()=>{ke()},[]);const ke=async()=>{var wt;const[De,ht,rt,it,dt]=await Promise.all([St.from("setores").select("*").order("nome"),St.from("motivos_devolucao").select("*, setor:setores(nome)").order("nome"),St.from("profiles").select("*").order("name"),St.from("clientes").select("*").order("nome"),St.from("devolucoes").select("vendedor").not("vendedor","is",null)]);if(De.data&&e(De.data.map(gt=>({id:gt.id,name:gt.nome}))),ht.data&&a(ht.data.map(gt=>({id:gt.id,name:gt.nome,sector_id:gt.sector_id,sector:gt.setor}))),rt.data&&s(rt.data),it.data&&c(it.data),dt.data){const gt=new Set;dt.data.forEach(vt=>{vt.vendedor&&vt.vendedor.trim()&&gt.add(vt.vendedor.trim().toUpperCase())}),(wt=it.data)==null||wt.forEach(vt=>{vt.vendedor&&vt.vendedor.trim()&&gt.add(vt.vendedor.trim().toUpperCase())}),u(Array.from(gt).sort())}},Ce=async()=>{if(!h)return;const{error:De}=await St.from("setores").insert({nome:h});De?_t.error("Erro ao adicionar setor: "+De.message):(_t.success("Setor adicionado!"),v(""),ke())},Fe=async()=>{if(!b||!b.trim()){_t.error("Nome do motivo  obrigatrio");return}if(!x){_t.error("Selecione um setor para o motivo");return}try{const{error:De}=await St.from("motivos_devolucao").insert({nome:b.trim(),sector_id:x});De?(console.error("Erro ao adicionar motivo:",De),_t.error("Erro ao adicionar motivo: "+De.message)):(_t.success("Motivo adicionado!"),g(""),y(""),ke())}catch(De){console.error("Erro ao adicionar motivo:",De),_t.error("Erro ao adicionar motivo: "+(De.message||"Erro desconhecido"))}},Pe=async()=>{var De,ht;if(!k||!k.trim()){_t.error("Nome do cliente  obrigatrio");return}if(!F||!F.trim()){_t.error("CNPJ/CPF  obrigatrio");return}if(I&&I.length!==2){_t.error("UF deve ter 2 caracteres");return}try{const{error:rt}=await St.from("clientes").insert({nome:k.trim(),cnpj_cpf:F.trim(),vendedor:(W==null?void 0:W.trim())||null,rede:(q==null?void 0:q.trim())||null,uf:(I==null?void 0:I.trim().toUpperCase())||null,municipio:(O==null?void 0:O.trim())||null});rt?(console.error("Erro ao adicionar cliente:",rt),rt.code==="23505"||(De=rt.message)!=null&&De.includes("duplicate")||(ht=rt.message)!=null&&ht.includes("unique")?_t.error("Cliente com este CNPJ/CPF j est cadastrado"):_t.error("Erro ao adicionar cliente: "+rt.message)):(_t.success("Cliente adicionado!"),N(""),B(""),V(""),X(""),H(""),R(""),ke())}catch(rt){console.error("Erro ao adicionar cliente:",rt),_t.error("Erro ao adicionar cliente: "+(rt.message||"Erro desconhecido"))}},Xe=async()=>{var ht,rt,it,dt;if(!se||!ne||!fe){_t.error("Nome, email e senha so obrigatrios");return}if(fe.length<6){_t.error("A senha deve ter pelo menos 6 caracteres");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(ne)){_t.error("Email invlido");return}try{const wt={name:se},{data:gt,error:vt}=await St.auth.signUp({email:ne.trim().toLowerCase(),password:fe,options:{data:wt,emailRedirectTo:void 0}});if(vt){console.error("Erro no auth.signUp:",vt),(ht=vt.message)!=null&&ht.includes("already registered")||(rt=vt.message)!=null&&rt.includes("already exists")?_t.error("Este email j est cadastrado no sistema"):(it=vt.message)!=null&&it.includes("password")?_t.error("Senha invlida. Verifique os requisitos de senha."):(dt=vt.message)!=null&&dt.includes("email")?_t.error("Email invlido ou j cadastrado"):_t.error(`Erro ao criar usurio: ${vt.message||"Erro desconhecido"}`);return}if(gt.user){console.log(" Usurio criado no Auth:",gt.user.id,gt.user.email),await new Promise(nt=>setTimeout(nt,1500));let Ve=null,$e=0;const xt=3;for(;$e<xt&&!Ve;){$e++,console.log(` Tentativa ${$e}/${xt} de verificar perfil...`);const{data:nt,error:pt}=await St.from("profiles").select("*").eq("id",gt.user.id).single();if(pt&&pt.code!=="PGRST116"&&console.warn("Erro ao verificar perfil:",pt),nt){Ve=nt,console.log(" Perfil encontrado:",Ve);break}$e<xt&&await new Promise(Se=>setTimeout(Se,1500))}if(Ve){const{error:nt}=await St.from("profiles").update({name:se,role:"NOVO",vendedor:null}).eq("id",gt.user.id);nt?console.warn(" Aviso ao atualizar perfil:",nt):console.log(" Perfil atualizado com sucesso")}else{console.log(" Perfil no encontrado aps tentativas, criando manualmente...");const{data:nt,error:pt}=await St.from("profiles").insert({id:gt.user.id,name:se,email:ne.trim().toLowerCase(),role:"NOVO",vendedor:null}).select().single();if(pt){console.error(" Erro ao inserir perfil:",pt),_t.error(`Usurio criado no Auth, mas erro ao criar perfil: ${pt.message}. Verifique o perfil manualmente no Supabase.`);return}Ve=nt,console.log(" Perfil criado manualmente:",Ve)}_t.success("Usurio criado com sucesso! O usurio foi criado como tipo NOVO. Atribua a funo apropriada na gesto de usurios."),ae(""),Q(""),le(""),ce("NOVO"),Ee(""),ke()}else _t.warning("Usurio criado, mas no foi possvel obter os dados. Recarregue a pgina.")}catch(wt){console.error("Erro ao criar usurio:",wt),_t.error(`Erro ao criar usurio: ${wt.message||"Erro desconhecido"}`)}},ct=async()=>{var De,ht;if(C){if(T==="VENDEDOR"&&!U){_t.error("Usurios do tipo VENDEDOR devem ter um vendedor selecionado");return}if(!T||T==="NOVO"){_t.error("Selecione um role vlido para o usurio");return}try{const rt={name:E.trim()};T&&(rt.role=T),T==="VENDEDOR"?rt.vendedor=U||null:rt.vendedor=null,console.log(" Atualizando usurio:",C.id,"com dados:",rt),console.log(" Usurio atual (ADMIN):",t==null?void 0:t.email,"role:",t==null?void 0:t.role),rt.updated_at=new Date().toISOString();const{error:it,data:dt}=await St.from("profiles").update(rt).eq("id",C.id).select();if(it){console.error(" Erro ao atualizar perfil:",it),console.error(" Detalhes do erro:",JSON.stringify(it,null,2)),console.error(" Cdigo do erro:",it.code),console.error(" Mensagem:",it.message),console.error(" Detalhes:",it.details),console.error(" Hint:",it.hint),it.code==="42501"||(De=it.message)!=null&&De.includes("permission")||(ht=it.message)!=null&&ht.includes("policy")?_t.error("Erro de permisso: Verifique se voc tem permisso para atualizar este usurio. Apenas ADMINs podem atualizar outros perfis."):_t.error("Erro ao atualizar usurio: "+(it.message||"Erro desconhecido"));return}if(console.log(" Resposta do update:",dt),!dt||dt.length===0){console.error(" Update retornou array vazio - possvel problema de RLS"),_t.error("Usurio no foi atualizado. Verifique se voc tem permisso ADMIN para atualizar outros perfis.");return}console.log(" Usurio atualizado com sucesso:",dt[0]),K&&K.length>=6&&(_t.warning("Alterao de senha de outros usurios requer configurao de Edge Function ou uso da API Admin do Supabase. Por favor, use o Supabase Dashboard para alterar senhas."),Y("")),_t.success("Usurio atualizado com sucesso!"),w(null),Y(""),ke()}catch(rt){console.error("Erro ao atualizar usurio:",rt),_t.error("Erro ao atualizar usurio: "+rt.message)}}},st=async()=>{if(re)try{const{error:De}=await St.from("profiles").delete().eq("id",re.id);if(De){_t.error("Erro ao excluir usurio: "+De.message);return}_t.success("Usurio excludo com sucesso! (Nota: O registro no Auth pode precisar ser removido manualmente no Supabase Dashboard)"),z(null),ke()}catch(De){_t.error("Erro ao excluir usurio: "+De.message)}},lt=async()=>{if(ee)try{const{error:De}=await St.from("motivos_devolucao").delete().eq("id",ee);De?_t.error("Erro ao excluir: "+De.message):(_t.success("Excludo com sucesso"),L(null),ke())}catch(De){_t.error("Erro ao excluir: "+De.message)}},tt=()=>{M&&(u(i.filter(De=>De!==M)),_t.success("Vendedor removido da lista!"),Z(null))},ot=async()=>{if(!p||!p.trim()){_t.error("Nome do vendedor  obrigatrio");return}const De=p.trim().toUpperCase();if(i.includes(De)){_t.warning("Este vendedor j est cadastrado");return}u([...i,De].sort()),f(""),_t.success("Vendedor adicionado  lista!")};return(t==null?void 0:t.role)!=="ADMIN"&&(t==null?void 0:t.role)!=="LOGISTICA"?_.jsx("div",{className:"p-8 text-center",children:"Acesso restrito a administradores e logstica."}):_.jsxs("div",{className:"space-y-6",children:[_.jsx(Qi,{title:"Configuraes",description:"Gerencie setores, motivos de devoluo, vendedores, clientes e usurios do sistema. Acesso restrito a administradores."}),_.jsxs(i3,{defaultValue:"master-data",children:[_.jsx("div",{className:"overflow-x-auto",children:_.jsxs(m1,{className:"w-full md:w-auto min-w-full md:min-w-0",children:[_.jsx(Yi,{value:"master-data",className:"text-xs sm:text-sm whitespace-nowrap",children:"Master Data (Setores/Motivos)"}),_.jsx(Yi,{value:"vendedores",className:"text-xs sm:text-sm whitespace-nowrap",children:"Vendedores"}),_.jsx(Yi,{value:"clientes",className:"text-xs sm:text-sm whitespace-nowrap",children:"Clientes"}),(t==null?void 0:t.role)==="ADMIN"&&_.jsx(Yi,{value:"users",className:"text-xs sm:text-sm whitespace-nowrap",children:"Usurios"})]})}),_.jsx(Xi,{value:"master-data",className:"space-y-6 mt-6",children:_.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Setores"}),_.jsx(Or,{children:"Gerencie as reas responsveis."})]}),_.jsxs(Ot,{children:[_.jsxs("div",{className:"flex gap-2 mb-4",children:[_.jsx(_r,{placeholder:"Novo Setor",value:h,onChange:De=>v(De.target.value)}),_.jsx(Nt,{onClick:Ce,size:"icon",children:_.jsx(tu,{className:"h-4 w-4"})})]}),_.jsx("div",{className:"rounded-md border max-h-[300px] overflow-y-auto",children:_.jsx(Un,{children:_.jsx(zn,{children:r.map(De=>_.jsx(dr,{children:_.jsx(Pt,{children:De.name})},De.id))})})})]})]}),_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Motivos de Devoluo"}),_.jsx(Or,{children:"Associe motivos aos setores."})]}),_.jsxs(Ot,{children:[_.jsxs("div",{className:"flex flex-col gap-2 mb-4",children:[_.jsxs($a,{value:x,onValueChange:y,children:[_.jsx(xa,{children:_.jsx(Va,{placeholder:"Selecione o Setor"})}),_.jsx(ya,{children:r.map(De=>_.jsx(sr,{value:De.id,children:De.name},De.id))})]}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx(_r,{placeholder:"Novo Motivo",value:b,onChange:De=>g(De.target.value)}),_.jsx(Nt,{onClick:Fe,size:"icon",children:_.jsx(tu,{className:"h-4 w-4"})})]})]}),_.jsx("div",{className:"rounded-md border max-h-[300px] overflow-y-auto",children:_.jsxs(Un,{children:[_.jsx(Jn,{children:_.jsxs(dr,{children:[_.jsx(Tt,{children:"Motivo"}),_.jsx(Tt,{children:"Setor"}),_.jsx(Tt,{className:"w-[50px]"})]})}),_.jsx(zn,{children:n.length===0?_.jsx(dr,{children:_.jsx(Pt,{colSpan:3,className:"text-center text-muted-foreground",children:"Nenhum motivo cadastrado"})}):n.map(De=>{var ht;return _.jsxs(dr,{children:[_.jsx(Pt,{children:De.name}),_.jsx(Pt,{className:"text-xs text-muted-foreground",children:((ht=De.sector)==null?void 0:ht.name)||"-"}),_.jsx(Pt,{children:_.jsx(Nt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:bg-destructive/10",onClick:()=>L(De.id),children:_.jsx(za,{className:"h-3 w-3"})})})]},De.id)})})]})})]})]})]})}),_.jsx(Xi,{value:"vendedores",className:"space-y-6 mt-6",children:_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Cadastro de Vendedores"}),_.jsx(Or,{children:"Gerencie a lista de vendedores disponveis no sistema."})]}),_.jsxs(Ot,{children:[_.jsxs("div",{className:"flex gap-2 mb-4",children:[_.jsx(_r,{placeholder:"Nome do Vendedor",value:p,onChange:De=>f(De.target.value),onKeyPress:De=>De.key==="Enter"&&ot()}),_.jsx(Nt,{onClick:ot,size:"icon",children:_.jsx(tu,{className:"h-4 w-4"})})]}),_.jsx("div",{className:"rounded-md border max-h-[400px] overflow-y-auto",children:_.jsxs(Un,{children:[_.jsx(Jn,{children:_.jsxs(dr,{children:[_.jsx(Tt,{children:"Nome"}),_.jsx(Tt,{className:"text-right",children:"Aes"})]})}),_.jsxs(zn,{children:[i.map((De,ht)=>_.jsxs(dr,{children:[_.jsx(Pt,{className:"font-medium",children:De}),_.jsx(Pt,{className:"text-right",children:_.jsx(Nt,{variant:"ghost",size:"icon",className:"hover:bg-destructive/10",onClick:()=>Z(De),children:_.jsx(za,{className:"h-4 w-4 text-destructive"})})})]},ht)),i.length===0&&_.jsx(dr,{children:_.jsx(Pt,{colSpan:2,className:"text-center text-muted-foreground",children:"Nenhum vendedor cadastrado. Adicione um acima."})})]})]})})]})]})}),_.jsx(Xi,{value:"clientes",className:"space-y-6 mt-6",children:_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Cadastro de Clientes"}),_.jsx(Or,{children:"Adicione novos clientes ao sistema."})]}),_.jsxs(Ot,{children:[_.jsxs("div",{className:"space-y-4 mb-6",children:[_.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"Nome *"}),_.jsx(_r,{value:k,onChange:De=>N(De.target.value),placeholder:"Nome do cliente"})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"CNPJ/CPF *"}),_.jsx(_r,{value:F,onChange:De=>B(De.target.value),placeholder:"00.000.000/0000-00"})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"Vendedor"}),_.jsx(_r,{value:W,onChange:De=>V(De.target.value),placeholder:"Nome do vendedor"})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"Rede"}),_.jsx(_r,{value:q,onChange:De=>X(De.target.value),placeholder:"Nome da rede"})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"UF"}),_.jsx(_r,{value:I,onChange:De=>H(De.target.value.toUpperCase()),placeholder:"UF",maxLength:2})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"Municpio"}),_.jsx(_r,{value:O,onChange:De=>R(De.target.value),placeholder:"Nome do municpio"})]})]}),_.jsxs(Nt,{onClick:Pe,children:[_.jsx(tu,{className:"mr-2 h-4 w-4"}),"Adicionar Cliente"]})]}),_.jsx("div",{className:"rounded-md border max-h-[400px] overflow-y-auto",children:_.jsxs(Un,{children:[_.jsx(Jn,{children:_.jsxs(dr,{children:[_.jsx(Tt,{children:"Nome"}),_.jsx(Tt,{children:"CNPJ/CPF"}),_.jsx(Tt,{children:"Vendedor"}),_.jsx(Tt,{children:"Rede"}),_.jsx(Tt,{children:"UF"}),_.jsx(Tt,{children:"Municpio"})]})}),_.jsx(zn,{children:l.map(De=>_.jsxs(dr,{children:[_.jsx(Pt,{className:"font-medium",children:De.nome}),_.jsx(Pt,{children:De.cnpj_cpf}),_.jsx(Pt,{children:De.vendedor||"-"}),_.jsx(Pt,{children:De.rede||"-"}),_.jsx(Pt,{children:De.uf||"-"}),_.jsx(Pt,{children:De.municipio||"-"})]},De.id))})]})})]})]})}),_.jsxs(Xi,{value:"users",className:"space-y-6 mt-6",children:[_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Cadastro de Usurios"}),_.jsx(Or,{children:"Adicione novos usurios ao sistema."})]}),_.jsx(Ot,{children:_.jsxs("div",{className:"space-y-4 mb-6 p-4 border rounded-lg",children:[_.jsx("h3",{className:"font-semibold mb-4",children:"Novo Usurio"}),_.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"Nome *"}),_.jsx(_r,{value:se,onChange:De=>ae(De.target.value),placeholder:"Nome completo"})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"Email *"}),_.jsx(_r,{type:"email",value:ne,onChange:De=>Q(De.target.value),placeholder:"email@exemplo.com"})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"Senha *"}),_.jsx(_r,{type:"password",value:fe,onChange:De=>le(De.target.value),placeholder:"Senha"})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{children:"Funo"}),_.jsx(_r,{value:"NOVO (Ser atribudo pelo Admin)",disabled:!0,className:"bg-muted"}),_.jsx("p",{className:"text-xs text-muted-foreground",children:"Novos usurios so criados como tipo NOVO. O administrador deve atribuir a funo apropriada aps o cadastro."})]}),!1]}),_.jsxs(Nt,{onClick:Xe,children:[_.jsx(tu,{className:"mr-2 h-4 w-4"}),"Criar Usurio"]})]})})]}),_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Gesto de Usurios"}),_.jsx(Or,{children:"Visualize e gerencie os usurios do sistema."})]}),_.jsx(Ot,{children:_.jsx("div",{className:"rounded-md border",children:_.jsxs(Un,{children:[_.jsx(Jn,{children:_.jsxs(dr,{children:[_.jsx(Tt,{children:"Nome"}),_.jsx(Tt,{children:"Email"}),_.jsx(Tt,{children:"Funo"}),_.jsx(Tt,{children:"Vendedor"}),_.jsx(Tt,{className:"text-right",children:"Aes"})]})}),_.jsx(zn,{children:o.map(De=>_.jsxs(dr,{children:[_.jsx(Pt,{className:"font-medium",children:De.name}),_.jsx(Pt,{children:De.email}),_.jsx(Pt,{children:_.jsx(Ua,{variant:De.role==="ADMIN"?"default":De.role==="NOVO"?"destructive":"secondary",children:De.role||"NOVO"})}),_.jsx(Pt,{children:_.jsx(Ua,{variant:"outline",children:De.vendedor||"GERAL"})}),_.jsx(Pt,{className:"text-right",children:_.jsxs("div",{className:"flex justify-end gap-2",children:[_.jsx(Nt,{variant:"ghost",size:"icon",className:"hover:bg-primary/10",onClick:()=>{w(De),A(De.name),D(De.role),P(De.vendedor||""),Y("")},children:_.jsx(rx,{className:"h-4 w-4 text-primary"})}),_.jsx(Nt,{variant:"ghost",size:"icon",className:"hover:bg-destructive/10",onClick:()=>z({id:De.id,name:De.name}),disabled:De.id===(t==null?void 0:t.id),children:_.jsx(za,{className:"h-4 w-4 text-destructive"})})]})})]},De.id))})]})})})]})]})]}),_.jsx(ri,{open:!!re,onOpenChange:De=>!De&&z(null),children:_.jsxs(As,{className:"sm:max-w-[425px]",children:[_.jsxs(Cs,{children:[_.jsxs(js,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[_.jsx(za,{className:"h-5 w-5"}),"Confirmar Excluso"]}),_.jsxs(Os,{className:"pt-2",children:["Tem certeza que deseja excluir o usurio ",_.jsxs("span",{className:"font-semibold text-foreground",children:['"',re==null?void 0:re.name,'"']}),"?"]}),_.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mt-4",children:_.jsx("p",{className:"text-sm text-destructive font-medium",children:" Esta ao no pode ser desfeita. O usurio perder acesso ao sistema."})})]}),_.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[_.jsx(Nt,{variant:"outline",onClick:()=>z(null),className:"flex-1 sm:flex-initial",children:"No"}),_.jsx(Nt,{variant:"destructive",onClick:st,className:"flex-1 sm:flex-initial",children:"Sim, Excluir"})]})]})}),_.jsx(ri,{open:!!ee,onOpenChange:De=>!De&&L(null),children:_.jsxs(As,{className:"sm:max-w-[425px]",children:[_.jsxs(Cs,{children:[_.jsxs(js,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[_.jsx(za,{className:"h-5 w-5"}),"Confirmar Excluso"]}),_.jsx(Os,{className:"pt-2",children:"Tem certeza que deseja excluir este motivo de devoluo?"}),_.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mt-4",children:_.jsx("p",{className:"text-sm text-destructive font-medium",children:" Esta ao no pode ser desfeita."})})]}),_.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[_.jsx(Nt,{variant:"outline",onClick:()=>L(null),className:"flex-1 sm:flex-initial",children:"No"}),_.jsx(Nt,{variant:"destructive",onClick:lt,className:"flex-1 sm:flex-initial",children:"Sim, Excluir"})]})]})}),_.jsx(ri,{open:!!M,onOpenChange:De=>!De&&Z(null),children:_.jsxs(As,{className:"sm:max-w-[425px]",children:[_.jsxs(Cs,{children:[_.jsxs(js,{className:"text-xl font-bold text-destructive flex items-center gap-2",children:[_.jsx(za,{className:"h-5 w-5"}),"Confirmar Excluso"]}),_.jsxs(Os,{className:"pt-2",children:["Tem certeza que deseja remover o vendedor ",_.jsxs("span",{className:"font-semibold text-foreground",children:['"',M,'"']})," da lista?"]}),_.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-4 mt-4",children:_.jsx("p",{className:"text-sm text-destructive font-medium",children:" Esta ao no pode ser desfeita."})})]}),_.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[_.jsx(Nt,{variant:"outline",onClick:()=>Z(null),className:"flex-1 sm:flex-initial",children:"No"}),_.jsx(Nt,{variant:"destructive",onClick:tt,className:"flex-1 sm:flex-initial",children:"Sim, Remover"})]})]})}),_.jsx(ri,{open:!!C,onOpenChange:De=>{De||(w(null),Y(""))},children:_.jsxs(As,{className:"sm:max-w-[500px]",children:[_.jsxs(Cs,{children:[_.jsxs(js,{className:"text-xl font-bold flex items-center gap-2",children:[_.jsx(rx,{className:"h-5 w-5 text-primary"}),"Editar Usurio"]}),_.jsxs(Os,{className:"pt-2",children:["Alterar permisses e dados de ",_.jsx("span",{className:"font-semibold text-foreground",children:C==null?void 0:C.name})]})]}),_.jsxs("div",{className:"space-y-4 py-4",children:[_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{className:"text-sm font-medium",children:"Nome"}),_.jsx(_r,{value:E,onChange:De=>A(De.target.value),className:"h-10"})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{className:"text-sm font-medium",children:"Funo (Role)"}),_.jsxs($a,{value:T||"",onValueChange:De=>{D(De),De!=="VENDEDOR"&&P("")},children:[_.jsx(xa,{className:"h-10",children:_.jsx(Va,{})}),_.jsxs(ya,{children:[_.jsx(sr,{value:"ADMIN",children:"ADMIN"}),_.jsx(sr,{value:"GESTOR",children:"GESTOR"}),_.jsx(sr,{value:"COMERCIAL",children:"COMERCIAL"}),_.jsx(sr,{value:"LOGISTICA",children:"LOGISTICA"}),_.jsx(sr,{value:"VENDEDOR",children:"VENDEDOR"}),_.jsx(sr,{value:"NOVO",children:"NOVO (Sem Acesso)"})]})]})]}),T==="VENDEDOR"&&_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{className:"text-sm font-medium",children:"Vendedor *"}),_.jsxs($a,{value:U,onValueChange:P,children:[_.jsx(xa,{className:"h-10",children:_.jsx(Va,{placeholder:"Selecione o vendedor"})}),_.jsxs(ya,{children:[i.map(De=>_.jsx(sr,{value:De,children:De},De)),i.length===0&&_.jsx(sr,{value:"",disabled:!0,children:"Nenhum vendedor cadastrado"})]})]})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{className:"text-sm font-medium",children:"Nova Senha (opcional)"}),_.jsx(_r,{type:"password",value:K,onChange:De=>Y(De.target.value),placeholder:"Deixe em branco para manter a senha atual",minLength:6,className:"h-10"}),_.jsx("p",{className:"text-xs text-muted-foreground",children:"Mnimo de 6 caracteres. Deixe em branco para no alterar."})]})]}),_.jsxs(Ns,{className:"gap-2 sm:gap-0",children:[_.jsx(Nt,{variant:"outline",onClick:()=>{w(null),Y("")},className:"flex-1 sm:flex-initial",children:"Cancelar"}),_.jsx(Nt,{onClick:ct,className:"flex-1 sm:flex-initial bg-primary hover:bg-primary/90",children:"Salvar Alteraes"})]})]})})]})}function EB(t,r=[]){let e=[];function n(o,s){const l=_e.createContext(s);l.displayName=o+"Context";const c=e.length;e=[...e,s];const i=p=>{var x;const{scope:f,children:h,...v}=p,b=((x=f==null?void 0:f[t])==null?void 0:x[c])||l,g=_e.useMemo(()=>v,Object.values(v));return _.jsx(b.Provider,{value:g,children:h})};i.displayName=o+"Provider";function u(p,f){var b;const h=((b=f==null?void 0:f[t])==null?void 0:b[c])||l,v=_e.useContext(h);if(v)return v;if(s!==void 0)return s;throw new Error(`\`${p}\` must be used within \`${o}\``)}return[i,u]}const a=()=>{const o=e.map(s=>_e.createContext(s));return function(l){const c=(l==null?void 0:l[t])||o;return _e.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return a.scopeName=t,[n,TB(a,...r)]}function TB(...t){const r=t[0];if(t.length===1)return r;const e=()=>{const n=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(o){const s=n.reduce((l,{useScope:c,scopeName:i})=>{const p=c(o)[`__scope${i}`];return{...l,...p}},{});return _e.useMemo(()=>({[`__scope${r.scopeName}`]:s}),[s])}};return e.scopeName=r.scopeName,e}var AB=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],g1=AB.reduce((t,r)=>{const e=gm(`Primitive.${r}`),n=_e.forwardRef((a,o)=>{const{asChild:s,...l}=a,c=s?e:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),_.jsx(c,{...l,ref:o})});return n.displayName=`Primitive.${r}`,{...t,[r]:n}},{}),CB=u8();function NB(){return CB.useSyncExternalStore(jB,()=>!0,()=>!1)}function jB(){return()=>{}}var v1="Avatar",[OB,JB]=EB(v1),[DB,o3]=OB(v1),l3=_e.forwardRef((t,r)=>{const{__scopeAvatar:e,...n}=t,[a,o]=_e.useState("idle");return _.jsx(DB,{scope:e,imageLoadingStatus:a,onImageLoadingStatusChange:o,children:_.jsx(g1.span,{...n,ref:r})})});l3.displayName=v1;var c3="AvatarImage",u3=_e.forwardRef((t,r)=>{const{__scopeAvatar:e,src:n,onLoadingStatusChange:a=()=>{},...o}=t,s=o3(c3,e),l=RB(n,o),c=dm(i=>{a(i),s.onImageLoadingStatusChange(i)});return xu(()=>{l!=="idle"&&c(l)},[l,c]),l==="loaded"?_.jsx(g1.img,{...o,ref:r,src:n}):null});u3.displayName=c3;var d3="AvatarFallback",f3=_e.forwardRef((t,r)=>{const{__scopeAvatar:e,delayMs:n,...a}=t,o=o3(d3,e),[s,l]=_e.useState(n===void 0);return _e.useEffect(()=>{if(n!==void 0){const c=window.setTimeout(()=>l(!0),n);return()=>window.clearTimeout(c)}},[n]),s&&o.imageLoadingStatus!=="loaded"?_.jsx(g1.span,{...a,ref:r}):null});f3.displayName=d3;function ey(t,r){return t?r?(t.src!==r&&(t.src=r),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function RB(t,{referrerPolicy:r,crossOrigin:e}){const n=NB(),a=_e.useRef(null),o=n?(a.current||(a.current=new window.Image),a.current):null,[s,l]=_e.useState(()=>ey(o,t));return xu(()=>{l(ey(o,t))},[o,t]),xu(()=>{const c=p=>()=>{l(p)};if(!o)return;const i=c("loaded"),u=c("error");return o.addEventListener("load",i),o.addEventListener("error",u),r&&(o.referrerPolicy=r),typeof e=="string"&&(o.crossOrigin=e),()=>{o.removeEventListener("load",i),o.removeEventListener("error",u)}},[o,e,r]),s}var h3=l3,p3=u3,m3=f3;const g3=_e.forwardRef(({className:t,...r},e)=>_.jsx(h3,{ref:e,className:Et("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...r}));g3.displayName=h3.displayName;const v3=_e.forwardRef(({className:t,...r},e)=>_.jsx(p3,{ref:e,className:Et("aspect-square h-full w-full",t),...r}));v3.displayName=p3.displayName;const b3=_e.forwardRef(({className:t,...r},e)=>_.jsx(m3,{ref:e,className:Et("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...r}));b3.displayName=m3.displayName;function MB(){const{user:t}=Dn(),{filters:r}=ec(),[e,n]=_e.useState(""),[a,o]=_e.useState(!1),[s,l]=_e.useState([]),[c,i]=_e.useState(1),[u,p]=_e.useState(0),f=100,[h,v]=_e.useState({myReturnsCount:0,approvalRate:0,totalValue:0,avgCompanyTicket:0,avgCompanyReturns:0}),[b,g]=_e.useState([]),[x,y]=_e.useState(""),[k,N]=_e.useState(null),[F,B]=_e.useState(!1),[W,V]=_e.useState(new Date);_e.useEffect(()=>{t&&(q(),(t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA")&&A(),(t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA")&&X())},[t,r,c]);const q=async()=>{if(!t)return;let D=St.from("devolucoes").select("*");t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"||(t.role==="VENDEDOR"&&t.vendedor?D=D.eq("vendedor",t.vendedor):D=D.ilike("vendedor",`%${t.name}%`)),r.startDate&&(D=D.gte("data_emissao",r.startDate.toISOString())),r.endDate&&(D=D.lte("data_emissao",r.endDate.toISOString()));const{data:U}=await D;let P=St.from("devolucoes").select("*");r.startDate&&(P=P.gte("data_emissao",r.startDate.toISOString())),r.endDate&&(P=P.lte("data_emissao",r.endDate.toISOString()));const{data:K}=await P;if(U){const Y=U.length,re=U.reduce((ce,he)=>ce+(Number(he.valor_total_nota)||0),0),z=U.filter(ce=>ce.resultado&&ce.resultado!=="PENDENTE VALIDAO"),ee=U.filter(ce=>ce.resultado==="VALIDADA"||ce.resultado==="LANADA").length,L=z.length>0?ee/z.length*100:0,M=(K==null?void 0:K.length)||0,Z=(K==null?void 0:K.reduce((ce,he)=>ce+(Number(he.valor_total_nota)||0),0))||0,se=M>0?Z/M:0,ae=Y>0?re/Y:0;v({myReturnsCount:Y,totalValue:re,approvalRate:Math.round(L),avgCompanyTicket:se,avgCompanyReturns:M});const ne=U.reduce((ce,he)=>{const Ee=new Date(he.data_emissao||he.created_at),ke=Wt(Ee,"MMM yyyy",{locale:br});return ce[ke]||(ce[ke]={count:0,value:0}),ce[ke].count+=1,ce[ke].value+=Number(he.valor_total_nota)||0,ce},{}),Q=Object.entries(ne).map(([ce,he])=>({name:ce,quantidade:he.count,valor:he.value})).sort((ce,he)=>{var tt,ot;const Ee={jan:1,fev:2,mar:3,abr:4,mai:5,jun:6,jul:7,ago:8,set:9,out:10,nov:11,dez:12},ke=ce.name.toLowerCase().split(" "),Ce=he.name.toLowerCase().split(" "),Fe=Ee[((tt=ke[0])==null?void 0:tt.substring(0,3))||""]||0,Pe=Ee[((ot=Ce[0])==null?void 0:ot.substring(0,3))||""]||0,Xe=parseInt(ke[1]||"0"),ct=parseInt(Ce[1]||"0"),st=new Date(Xe,Fe-1),lt=new Date(ct,Pe-1);return st.getTime()-lt.getTime()});g(Q);const fe=ae>se?"acima":ae<se?"abaixo":"igual",le=se>0?Math.abs((ae-se)/se*100).toFixed(1):"0";let te=`Voc registrou ${Y} devolues neste perodo, totalizando R$ ${re.toLocaleString("pt-BR")}. `;te+=`Sua taxa de aprovao  de ${Math.round(L)}%. `,Y>0&&M>0&&(te+=`Seu ticket mdio (R$ ${ae.toLocaleString("pt-BR",{maximumFractionDigits:0})}) est ${fe} da mdia da empresa (R$ ${se.toLocaleString("pt-BR",{maximumFractionDigits:0})}). `,fe!=="igual"&&(te+=`Diferena de ${le}%. `)),te+=`A empresa registrou ${M} devolues no total neste perodo.`,y(te)}},X=async()=>{if(!(!t||t.role!=="ADMIN"&&t.role!=="COMERCIAL"&&t.role!=="LOGISTICA"))try{const{data:D}=await St.from("profiles").select("id, name, role, vendedor").eq("role","VENDEDOR");if(!D)return;const{data:U}=await St.from("devolucoes").select(`
            *,
            logs_validacao(
              usuario_id,
              created_at,
              status_novo,
              status_anterior
            )
          `);if(!U)return;const P={};D.forEach(Y=>{Y.vendedor&&(P[Y.vendedor]={id:Y.id,name:Y.name,role:Y.role,vendedor:Y.vendedor,tempoMedioValidacao:0,diasAtraso:0,totalValidacoes:0,notasPendentes:0,notasCancelamento:0,devolucoesValidadas:[],ultimaValidacao:null})}),new Date().setHours(0,0,0,0),U.forEach(Y=>{const re=Y.vendedor;if(!re||!P[re])return;const z=P[re],ee=Y.logs_validacao||[];Y.resultado==="PENDENTE VALIDAO"&&z.notasPendentes++,Y.resultado==="TRATATIVA DE ANULAO"&&z.notasCancelamento++;const L=ee.find(M=>M.status_novo==="VALIDADA");if(L){const M=new Date(L.created_at),Z=new Date(Y.data_emissao||Y.created_at),se=Math.floor((M.getTime()-Z.getTime())/(1e3*60*60*24));z.totalValidacoes++,z.tempoMedioValidacao+=se,(!z.ultimaValidacao||M>z.ultimaValidacao)&&(z.ultimaValidacao=M),z.devolucoesValidadas.push({dias:se,prazo:Y.prazo})}}),Object.keys(P).forEach(Y=>{const re=P[Y];re.totalValidacoes>0&&(re.tempoMedioValidacao=Math.round(re.tempoMedioValidacao/re.totalValidacoes));const z=U.filter(ee=>ee.vendedor===Y&&ee.resultado==="PENDENTE VALIDAO"&&ee.prazo==="EM ATRASO"&&ee.dias!=null&&ee.dias>0);if(z.length>0){const ee=z.reduce((L,M)=>L+(Number(M.dias)||0),0);re.diasAtraso=Math.round(ee/z.length)}else re.diasAtraso=0}),N({usuarios:Object.values(P),totalUsuarios:Object.keys(P).length})}catch(D){console.error("Erro ao buscar KPIs de usurios:",D)}},I=async D=>{if(!t||t.role!=="VENDEDOR"||!t.vendedor)return[];const U=Wt(D,"yyyy-MM-dd");console.log("Buscando validaes para a data:",U),console.log("Vendedor do usurio:",t.vendedor);const{data:P,error:K}=await St.from("devolucoes").select(`
        *,
        itens:itens_devolucao(*, motivo_item:motivos_devolucao(nome)),
        logs_validacao!inner(
          created_at,
          status_novo,
          acao
        )
      `).eq("vendedor",t.vendedor).eq("resultado","VALIDADA").eq("logs_validacao.status_novo","VALIDADA");if(K){console.error("Erro ao buscar devolues com logs:",K),console.log("Tentando fallback: buscar devolues sem join...");const{data:z,error:ee}=await St.from("devolucoes").select(`
          *,
          itens:itens_devolucao(*, motivo_item:motivos_devolucao(nome))
        `).eq("vendedor",t.vendedor).eq("resultado","VALIDADA");if(ee)return console.error("Erro ao buscar devolues simples:",ee),[];if(console.log("Devolues encontradas (sem filtro de data):",(z==null?void 0:z.length)||0),z&&z.length>0){const L=z.map(ne=>ne.id),{data:M,error:Z}=await St.from("logs_validacao").select("devolucao_id, created_at, status_novo").in("devolucao_id",L).eq("status_novo","VALIDADA").order("created_at",{ascending:!1});if(Z)return console.error("Erro ao buscar logs:",Z),console.log("Retornando todas as devolues sem filtro de data"),z;console.log("Logs encontrados:",(M==null?void 0:M.length)||0),M&&M.length>0?console.log("Primeiros 3 logs:",M.slice(0,3).map(ne=>({devolucao_id:ne.devolucao_id,created_at:ne.created_at,data_formatada:Wt(new Date(ne.created_at),"yyyy-MM-dd"),status:ne.status_novo}))):console.log(" Nenhum log encontrado para as devolues!");const se=new Map;if(M==null||M.forEach(ne=>{const Q=se.get(ne.devolucao_id),fe=new Date(ne.created_at);(!Q||fe>Q)&&se.set(ne.devolucao_id,fe)}),console.log("Mapa de validaes criado:",se.size,"devolues com data de validao"),console.log("Data buscada:",U),se.size>0){const ne=Array.from(se.entries()).slice(0,5);console.log("Primeiras datas de validao:",ne.map(([Q,fe])=>({devolucao_id:Q.substring(0,8)+"...",data:Wt(fe,"yyyy-MM-dd")})))}const ae=z.filter(ne=>{const Q=se.get(ne.id);if(!Q)return console.log("Devoluo",ne.numero,"no tem data de validao nos logs"),!1;const fe=Wt(Q,"yyyy-MM-dd"),le=fe===U;return le||console.log("Devoluo",ne.numero,"validada em",fe,"no corresponde a",U),le});return console.log("Devolues filtradas pela data:",ae.length),ae.length>0&&console.log("Primeiras devolues filtradas:",ae.slice(0,3).map(ne=>({numero:ne.numero,vendedor:ne.vendedor}))),ae}return[]}if(!P||P.length===0)return console.log("Nenhuma devoluo encontrada"),[];console.log("Devolues encontradas (com join):",P.length);const Y=P.filter(z=>{const ee=z.logs_validacao||[];if(ee.length===0)return!1;const L=ee.filter(se=>se.status_novo==="VALIDADA").sort((se,ae)=>new Date(ae.created_at).getTime()-new Date(se.created_at).getTime())[0];if(!L)return!1;const M=new Date(L.created_at);return Wt(M,"yyyy-MM-dd")===U});return console.log("Devolues filtradas pela data:",Y.length),Y.map(z=>{const{logs_validacao:ee,...L}=z;return L})},H=async()=>{if(!t||t.role!=="VENDEDOR"||!t.vendedor)return[];const{data:D}=await St.from("devolucoes").select(`
        *,
        itens:itens_devolucao(*)
      `).eq("vendedor",t.vendedor).eq("resultado","TRATATIVA DE ANULAO").order("data_emissao",{ascending:!1});return D||[]},O=(D,U)=>{if(!t||!t.vendedor)return"";const P=Wt(U,"dd/MM/yyyy",{locale:br});let K=` *RESUMO: NOTAS VALIDADAS - ${t.vendedor}*

`;return K+=` *DATA DA VALIDAO* ${P}
`,K+=` *USURIO* ${t.name}

`,K+=` *DETALHAMENTO*

`,D.forEach((Y,re)=>{var Z,se;K+=`============= ${re+1} NOTA FISCAL =============
`,K+=` *DEVOLUO N* ${Y.numero||"-"}
`,K+=` *Cliente:* ${Y.nome_cliente||"-"}
`,K+=` *Vendedor:* ${Y.vendedor||"-"}
`,K+=` *Data de Emisso:* ${Wt(new Date(Y.data_emissao),"dd/MM/yyyy",{locale:br})}
`,K+=` *Observao:* ${Y.justificativa||"-"}
`;const z=((Z=Y.itens)==null?void 0:Z.reduce((ae,ne)=>ae+(Number(ne.valor_total_bruto)||0),0))||Number(Y.valor_total_nota)||0;K+=` *Valor Total da NFD:* R$ ${z.toFixed(2)}
`;const ee=new Date(Y.data_emissao),L=new Date(U),M=Math.floor((L.getTime()-ee.getTime())/(1e3*60*60*24));K+=` *Mdia de Dias p/ Validao:* ${M} dias
`,K+=` *Prazo:* ${M>=3?"VALIDADA COM ATRASO":"DENTRO DO PRAZO"}
`,K+=`-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
`,(se=Y.itens)==null||se.forEach(ae=>{var fe;const Q=(ae.descricao||"-").split(" ").slice(0,3).join(" ");K+=` *Produto:* ${Q}
`,K+=` *Quantidade:* ${ae.quantidade||0} ${ae.unidade||"UN"}
`,K+=` *Valor Total:* R$ ${Number(ae.valor_total_bruto||0).toFixed(2)}
`,K+=` *Motivo:* ${((fe=ae.motivo_item)==null?void 0:fe.nome)||"-"}
`,K+=`-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
`})}),K},R=D=>{if(!t||!t.vendedor)return"";let U=` *RESUMO: NOTAS EM TRATATIVAS - ${t.vendedor}*

`;return U+=` *DATA DA SINALIZAO* ${Wt(new Date,"dd/MM/yyyy",{locale:br})}
`,U+=` *USURIO* ${t.name}

`,U+=` *DETALHAMENTO*

`,D.forEach((P,K)=>{var re,z;U+=`============= ${K+1} NOTA FISCAL =============
`,U+=` *DEVOLUO N* ${P.numero||"-"}
`,U+=` *Cliente:* ${P.nome_cliente||"-"}
`,U+=` *Vendedor:* ${P.vendedor||"-"}
`,U+=` *Data de Emisso:* ${Wt(new Date(P.data_emissao),"dd/MM/yyyy",{locale:br})}
`;const Y=((re=P.itens)==null?void 0:re.reduce((ee,L)=>ee+(Number(L.valor_total_bruto)||0),0))||Number(P.valor_total_nota)||0;U+=` *Valor Total da NFD:* R$ ${Y.toFixed(2)}
`,U+=` *Observao:* ${P.justificativa||"-"}
`,U+=`-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
`,(z=P.itens)==null||z.forEach(ee=>{const M=(ee.descricao||"-").split(" ").slice(0,3).join(" ");U+=` *Produto:* ${M}
`})}),U},C=D=>{const U=encodeURIComponent(D);window.open(`https://api.whatsapp.com/send?text=${U}`,"_blank")},w=async()=>{if(!W){_t.error("Selecione uma data");return}const D=await I(W);if(D.length===0){_t.error("Nenhuma validao encontrada para esta data");return}const U=O(D,W);C(U),B(!1)},E=async()=>{const D=await H();if(D.length===0){_t.error("Nenhuma tratativa encontrada");return}const U=R(D);C(U)},A=async()=>{console.log(" fetchAuditLogs - Iniciando busca de logs para role:",t==null?void 0:t.role);let D=St.from("logs_validacao").select("*",{count:"exact",head:!0});r.startDate&&(D=D.gte("created_at",r.startDate.toISOString())),r.endDate&&(D=D.lte("created_at",r.endDate.toISOString()));const{count:U,error:P}=await D;P&&console.error(" Erro ao contar logs:",P),console.log(" Total de logs encontrados:",U),p(U||0);const K=(c-1)*f,Y=K+f-1;let re=St.from("logs_validacao").select(`
            *,
            user:profiles(name, email),
            devolucao:devolucoes(numero, nome_cliente)
        `).order("created_at",{ascending:!1}).range(K,Y);r.startDate&&(re=re.gte("created_at",r.startDate.toISOString())),r.endDate&&(re=re.lte("created_at",r.endDate.toISOString()));const{data:z,error:ee}=await re;ee?console.error(" Erro ao buscar logs:",ee):console.log(" Logs carregados:",(z==null?void 0:z.length)||0),l(z||[])},T=async D=>{D.preventDefault(),o(!0);try{const{error:U}=await St.auth.updateUser({password:e});if(U)throw U;_t.success("Senha atualizada com sucesso!"),n("")}catch(U){_t.error(U.message)}finally{o(!1)}};return t?!t.role||t.role==="NOVO"?_.jsxs("div",{className:"space-y-6",children:[_.jsx(Qi,{title:"Meu Perfil",description:"Aguarde a atribuio de permisses por um administrador para acessar os recursos do sistema."}),_.jsx(jt,{children:_.jsx(Ot,{className:"pt-6",children:_.jsxs("div",{className:"text-center py-12",children:[_.jsx(nx,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground opacity-50"}),_.jsx("p",{className:"text-muted-foreground",children:"Seu perfil est aguardando a atribuio de permisses por um administrador."}),_.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Entre em contato com o administrador do sistema para obter acesso."})]})})})]}):_.jsxs("div",{className:"space-y-6",children:[_.jsx(Qi,{title:t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"?"Painel Administrativo":"Meu Perfil",description:t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"?"Viso geral de todos os dados do sistema, mtricas gerais e KPIs de usurios.":"Visualize suas mtricas pessoais, histrico de validaes e gerencie suas configuraes de segurana."}),_.jsxs("div",{className:"grid gap-6 md:grid-cols-7",children:[_.jsxs(jt,{className:"md:col-span-2 h-fit",children:[_.jsxs(Dt,{className:"text-center",children:[_.jsx("div",{className:"flex justify-center mb-4",children:_.jsxs(g3,{className:"h-24 w-24 border-4 border-primary/10",children:[_.jsx(v3,{src:t.avatar_url}),_.jsx(b3,{className:"text-2xl font-bold text-primary bg-primary/10",children:t.name.charAt(0).toUpperCase()})]})}),_.jsx(Rt,{children:t.name}),_.jsx(Or,{children:t.email}),_.jsxs("div",{className:"mt-2 space-y-1",children:[_.jsx(Ua,{variant:"outline",className:"border-primary text-primary",children:t.role||"Sem permisses"}),t.role==="VENDEDOR"&&t.vendedor&&_.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:[_.jsx("div",{className:"font-medium",children:"VENDEDOR"}),_.jsx("div",{className:"text-primary font-semibold",children:t.vendedor})]})]})]}),_.jsx(Ot,{children:_.jsxs("div",{className:"space-y-4 text-sm bg-muted/30 p-4 rounded-lg",children:[_.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[_.jsx(Ip,{className:"h-4 w-4 text-primary"}),_.jsxs("span",{className:"truncate",title:t.id,children:["ID: ",t.id.slice(0,8),"..."]})]}),_.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[_.jsx(GS,{className:"h-4 w-4 text-primary"}),_.jsx("span",{className:"truncate",title:t.email,children:t.email})]}),_.jsxs("div",{className:"flex items-center gap-3 text-muted-foreground",children:[_.jsx(nx,{className:"h-4 w-4 text-primary"}),_.jsxs("span",{children:["Acesso: ",t.role]})]})]})})]}),_.jsxs(jt,{className:"md:col-span-5",children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Painel do Usurio"}),_.jsx(Or,{children:"Suas mtricas e configuraes pessoais"})]}),_.jsx(Ot,{children:_.jsxs(i3,{defaultValue:t.role==="GESTOR"?"security":"overview",children:[_.jsxs(m1,{className:"w-full justify-start",children:[t.role!=="GESTOR"&&_.jsx(Yi,{value:"overview",children:"Viso Geral"}),(t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA")&&_.jsx(Yi,{value:"audit",children:"Histrico de Validaes"}),_.jsx(Yi,{value:"security",children:"Segurana"})]}),_.jsxs(Xi,{value:"overview",className:"space-y-6 mt-6",children:[_.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[_.jsxs(jt,{className:"bg-primary/5 border-primary/20",children:[_.jsxs(Dt,{className:"pb-2 flex flex-row items-center justify-between",children:[_.jsx(Rt,{className:"text-sm font-medium text-muted-foreground",children:t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"?"Total de Devolues":"Minhas Devolues"}),_.jsx(ek,{className:"h-4 w-4 text-primary"})]}),_.jsxs(Ot,{children:[_.jsx("div",{className:"text-2xl font-bold text-foreground",children:h.myReturnsCount}),_.jsx("p",{className:"text-xs text-muted-foreground",children:"No perodo selecionado"})]})]}),_.jsxs(jt,{children:[_.jsxs(Dt,{className:"pb-2 flex flex-row items-center justify-between",children:[_.jsx(Rt,{className:"text-sm font-medium text-muted-foreground",children:"Valor Envolvido"}),_.jsx(_u,{className:"h-4 w-4 text-muted-foreground"})]}),_.jsxs(Ot,{children:[_.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",h.totalValue.toLocaleString("pt-BR",{maximumFractionDigits:0})]}),_.jsx("p",{className:"text-xs text-muted-foreground",children:"Total devolvido"})]})]}),_.jsxs(jt,{children:[_.jsxs(Dt,{className:"pb-2 flex flex-row items-center justify-between",children:[_.jsx(Rt,{className:"text-sm font-medium text-muted-foreground",children:"Taxa de Aprovao"}),_.jsx(Zb,{className:"h-4 w-4 text-muted-foreground"})]}),_.jsxs(Ot,{children:[_.jsxs("div",{className:"text-2xl font-bold",children:[h.approvalRate,"%"]}),_.jsx("p",{className:"text-xs text-muted-foreground",children:"Das devolues finalizadas"})]})]})]}),b.length>0&&_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"?"Devolues no Tempo":"Minhas Devolues no Tempo"}),_.jsx(Or,{children:t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA"?"Evoluo mensal de todas as devolues":"Evoluo mensal das suas devolues"})]}),_.jsx(Ot,{children:_.jsx(Jr,{width:"100%",height:300,children:_.jsxs(d8,{data:b,children:[_.jsx(un,{strokeDasharray:"3 3",className:"stroke-muted/30"}),_.jsx(dn,{dataKey:"name",className:"text-xs"}),_.jsx($r,{yAxisId:"left",className:"text-xs"}),_.jsx($r,{yAxisId:"right",orientation:"right",className:"text-xs",tickFormatter:D=>`R$${D}`}),_.jsx(Qr,{contentStyle:{backgroundColor:"var(--card)",borderRadius:"8px",border:"1px solid var(--border)",color:"var(--foreground)"},formatter:(D,U)=>U==="quantidade"?[D,"Quantidade"]:U==="valor"?[`R$ ${(D||0).toLocaleString("pt-BR")}`,"Valor"]:[D,U||""]}),_.jsx(_y,{}),_.jsx(Xl,{yAxisId:"left",type:"monotone",dataKey:"quantidade",stroke:"#073e29",strokeWidth:2,name:"Quantidade"}),_.jsx(Xl,{yAxisId:"right",type:"monotone",dataKey:"valor",stroke:"#4a9170",strokeWidth:2,name:"Valor (R$)"})]})})})]}),h.myReturnsCount>0&&h.avgCompanyReturns>0&&_.jsxs(jt,{children:[_.jsx(Dt,{children:_.jsx(Rt,{children:"Comparao com Mdia da Empresa"})}),_.jsxs(Ot,{children:[_.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[_.jsxs("div",{className:"space-y-2",children:[_.jsx("div",{className:"text-sm text-muted-foreground",children:"Seu Ticket Mdio"}),_.jsxs("div",{className:"text-2xl font-bold",children:["R$ ",h.myReturnsCount>0?(h.totalValue/h.myReturnsCount).toLocaleString("pt-BR",{maximumFractionDigits:0}):"0"]})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx("div",{className:"text-sm text-muted-foreground",children:"Ticket Mdio da Empresa"}),_.jsxs("div",{className:"text-2xl font-bold text-muted-foreground",children:["R$ ",h.avgCompanyTicket.toLocaleString("pt-BR",{maximumFractionDigits:0})]})]})]}),h.myReturnsCount>0&&_.jsx("div",{className:"mt-4 p-3 bg-muted/50 rounded-lg",children:_.jsx("div",{className:"text-sm",children:h.totalValue/h.myReturnsCount>h.avgCompanyTicket?_.jsxs("span",{className:"text-orange-600 dark:text-orange-400",children:[" Seu ticket mdio est ",(h.totalValue/h.myReturnsCount/h.avgCompanyTicket*100-100).toFixed(1),"% acima da mdia da empresa."]}):h.totalValue/h.myReturnsCount<h.avgCompanyTicket?_.jsxs("span",{className:"text-green-600 dark:text-green-400",children:[" Seu ticket mdio est ",(100-h.totalValue/h.myReturnsCount/h.avgCompanyTicket*100).toFixed(1),"% abaixo da mdia da empresa."]}):_.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:" Seu ticket mdio est igual  mdia da empresa."})})})]})]}),_.jsxs("div",{className:"rounded-lg border p-6 bg-card flex items-start gap-4 shadow-sm",children:[_.jsx("div",{className:"p-3 bg-primary/10 rounded-full",children:_.jsx(Zb,{className:"h-6 w-6 text-primary"})}),_.jsxs("div",{children:[_.jsx("h3",{className:"font-semibold text-lg mb-1",children:"Resumo Automtico"}),_.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:x||(h.myReturnsCount>0?`Voc registrou ${h.myReturnsCount} devolues neste perodo, totalizando R$ ${h.totalValue.toLocaleString("pt-BR")}. Sua taxa de aprovao atual  de ${h.approvalRate}%.`:"Nenhuma atividade registrada para o perodo selecionado. Ajuste os filtros acima para ver seu histrico.")})]})]}),t.role==="VENDEDOR"&&t.vendedor&&_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Compartilhar Resumos"}),_.jsx(Or,{children:"Compartilhe seus resumos via WhatsApp"})]}),_.jsx(Ot,{children:_.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[_.jsxs(ri,{open:F,onOpenChange:B,children:[_.jsx(JN,{asChild:!0,children:_.jsxs(Nt,{className:"flex-1",variant:"outline",children:[_.jsx(Fp,{className:"mr-2 h-4 w-4"}),"COMPARTILHAR VALIDAO"]})}),_.jsxs(As,{children:[_.jsxs(Cs,{children:[_.jsx(js,{children:"Selecione a Data da Validao"}),_.jsx(Os,{children:"Escolha a data para gerar o resumo de validaes"})]}),_.jsx("div",{className:"py-4",children:_.jsx(Pw,{mode:"single",selected:W,onSelect:V,className:"rounded-md border"})}),_.jsxs(Ns,{children:[_.jsx(Nt,{variant:"outline",onClick:()=>B(!1),children:"Cancelar"}),_.jsx(Nt,{onClick:w,children:"OK"})]})]})]}),_.jsxs(Nt,{className:"flex-1",variant:"outline",onClick:E,children:[_.jsx(Fp,{className:"mr-2 h-4 w-4"}),"COMPARTILHAR TRATATIVAS"]})]})})]}),(t.role==="ADMIN"||t.role==="COMERCIAL"||t.role==="LOGISTICA")&&k&&_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"KPIs de Usurios"}),_.jsx(Or,{children:"Mtricas de desempenho por usurio"})]}),_.jsx(Ot,{children:_.jsxs("div",{className:"space-y-4",children:[k.usuarios.map((D,U)=>_.jsxs("div",{className:"border rounded-lg p-4",children:[_.jsxs("div",{className:"flex items-center justify-between mb-2",children:[_.jsxs("div",{children:[_.jsx("h4",{className:"font-semibold",children:D.name}),D.role==="VENDEDOR"&&D.vendedor&&_.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[_.jsx("span",{className:"font-medium",children:"VENDEDOR:"})," ",_.jsx("span",{className:"text-primary font-semibold",children:D.vendedor})]})]}),_.jsx(Ua,{variant:"outline",children:D.role})]}),_.jsxs("div",{className:"grid gap-2 md:grid-cols-3 text-sm",children:[D.role==="VENDEDOR"&&_.jsxs(_.Fragment,{children:[_.jsxs("div",{children:[_.jsx("span",{className:"text-muted-foreground",children:"Mdia Tempo Validao:"}),_.jsxs("span",{className:"ml-2 font-semibold",children:[D.tempoMedioValidacao," dias"]})]}),_.jsxs("div",{children:[_.jsx("span",{className:"text-muted-foreground",children:"Total Validaes:"}),_.jsx("span",{className:"ml-2 font-semibold",children:D.totalValidacoes})]}),_.jsxs("div",{children:[_.jsx("span",{className:"text-muted-foreground",children:"Dias em Atraso:"}),_.jsxs("span",{className:`ml-2 font-semibold ${D.diasAtraso>=3?"text-red-600":"text-green-600"}`,children:[D.diasAtraso," dias"]})]}),_.jsxs("div",{children:[_.jsx("span",{className:"text-muted-foreground",children:"Notas Pendentes:"}),_.jsx("span",{className:"ml-2 font-semibold",children:D.notasPendentes||0})]}),_.jsxs("div",{children:[_.jsx("span",{className:"text-muted-foreground",children:"Notas em Cancelamento:"}),_.jsx("span",{className:"ml-2 font-semibold",children:D.notasCancelamento||0})]})]}),D.role==="LOGISTICA"&&_.jsxs(_.Fragment,{children:[_.jsxs("div",{children:[_.jsx("span",{className:"text-muted-foreground",children:"Mdia Tempo Lanamento:"}),_.jsxs("span",{className:"ml-2 font-semibold",children:[D.tempoMedioLancamento," dias"]})]}),_.jsxs("div",{children:[_.jsx("span",{className:"text-muted-foreground",children:"Total Lanamentos:"}),_.jsx("span",{className:"ml-2 font-semibold",children:D.totalLancamentos})]})]})]})]},U)),k.usuarios.length===0&&_.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhum usurio VENDEDOR ou LOGISTICA encontrado."})]})})]})]}),_.jsxs(Xi,{value:"audit",className:"mt-6",children:[_.jsx("div",{className:"rounded-md border",children:_.jsxs(Un,{children:[_.jsx(Jn,{children:_.jsxs(dr,{children:[_.jsx(Tt,{children:"Data"}),_.jsx(Tt,{children:"Usurio"}),_.jsx(Tt,{children:"Nota Fiscal"}),_.jsx(Tt,{children:"Ao"}),_.jsx(Tt,{children:"Status Anterior"})]})}),_.jsx(zn,{children:s&&s.length>0?s.map(D=>{var U,P,K;return _.jsxs(dr,{children:[_.jsx(Pt,{className:"text-xs",children:Wt(new Date(D.created_at),"dd/MM/yyyy HH:mm")}),_.jsx(Pt,{className:"font-medium",children:((U=D.user)==null?void 0:U.name)||"Sistema"}),_.jsx(Pt,{children:((P=D.devolucao)==null?void 0:P.numero)||((K=D.devolucao_id)==null?void 0:K.slice(0,8))||"-"}),_.jsx(Pt,{children:_.jsx(Ua,{variant:D.acao==="SELECIONAR_MOTIVO"||D.status_novo==="VALIDADA"?"default":D.status_novo==="TRATATIVA DE ANULAO"?"destructive":"secondary",children:D.acao==="SELECIONAR_MOTIVO"?"Validou":D.acao==="ALTERAR_RESULTADO"?"Alterou Resultado":D.acao||"Ao"})}),_.jsxs(Pt,{className:"text-muted-foreground text-xs",children:[D.status_anterior,"  ",D.status_novo]})]},D.id)}):_.jsx(dr,{children:_.jsxs(Pt,{colSpan:5,className:"text-center py-12 text-muted-foreground",children:[_.jsx(BS,{className:"h-10 w-10 mx-auto mb-3 opacity-20"}),_.jsx("p",{children:"Nenhum registro de validao encontrado."}),(t==null?void 0:t.role)==="COMERCIAL"||(t==null?void 0:t.role)==="LOGISTICA"?_.jsx("p",{className:"text-xs mt-2",children:"Carregando dados..."}):null]})})})]})}),u>0&&_.jsxs("div",{className:"flex items-center justify-between px-2 py-4 border-t",children:[_.jsx("div",{className:"text-sm text-muted-foreground",children:u>f?_.jsxs(_.Fragment,{children:["Mostrando ",(c-1)*f+1," a ",Math.min(c*f,u)," de ",u," registros"]}):_.jsxs(_.Fragment,{children:["Total de ",u," registro(s)"]})}),u>f&&_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsxs(Nt,{variant:"outline",size:"sm",onClick:()=>{i(D=>Math.max(1,D-1))},disabled:c===1,children:[_.jsx(yu,{className:"h-4 w-4"}),"Anterior"]}),_.jsxs("div",{className:"text-sm text-muted-foreground",children:["Pgina ",c," de ",Math.ceil(u/f)]}),_.jsxs(Nt,{variant:"outline",size:"sm",onClick:()=>{i(D=>{const U=Math.ceil(u/f);return Math.min(U,D+1)})},disabled:c>=Math.ceil(u/f),children:["Prxima",_.jsx(wu,{className:"h-4 w-4"})]})]})]})]}),_.jsx(Xi,{value:"security",className:"mt-6",children:_.jsxs(jt,{children:[_.jsxs(Dt,{children:[_.jsx(Rt,{children:"Alterar Senha"}),_.jsx(Or,{children:"Escolha uma senha forte para proteger sua conta."})]}),_.jsx(Ot,{children:_.jsxs("form",{onSubmit:T,className:"space-y-4 max-w-md",children:[_.jsxs("div",{className:"space-y-2",children:[_.jsx(kr,{htmlFor:"new-password",children:"Nova Senha"}),_.jsx(_r,{id:"new-password",type:"password",value:e,onChange:D=>n(D.target.value),placeholder:"Mnimo de 6 caracteres",minLength:6})]}),_.jsx(Nt,{type:"submit",disabled:a||!e,children:a?"Atualizando...":"Atualizar Senha"})]})})]})})]})})]})]})]}):null}function FB(){const{user:t,logout:r}=Dn();return console.log("EmptyPage - Renderizando para usurio:",t==null?void 0:t.email,"role:",t==null?void 0:t.role),t?_.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background",children:_.jsxs(jt,{className:"w-full max-w-md",children:[_.jsxs(Dt,{className:"text-center",children:[_.jsx(Rt,{className:"text-2xl",children:"Acesso Pendente"}),_.jsx(Or,{children:"Seu cadastro est aguardando aprovao. Entre em contato com o administrador para obter acesso ao sistema."})]}),_.jsxs(Ot,{className:"space-y-4",children:[_.jsxs("div",{className:"text-center space-y-2",children:[_.jsxs("p",{className:"text-sm text-muted-foreground",children:["Usurio: ",_.jsx("span",{className:"font-semibold",children:t==null?void 0:t.email})]}),_.jsxs("p",{className:"text-sm text-muted-foreground",children:["Status: ",_.jsx("span",{className:"font-semibold text-orange-600",children:"NOVO"})]})]}),_.jsxs(Nt,{variant:"destructive",className:"w-full",onClick:r,children:[_.jsx(Rp,{className:"mr-2 h-4 w-4"}),"Sair"]})]})]})}):_.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background",children:_.jsx("div",{className:"text-center",children:_.jsx("p",{className:"text-muted-foreground",children:"Carregando..."})})})}function IB({className:t,isOpen:r=!1,onClose:e}){const{user:n,logout:a}=Dn(),o=vy(),s=()=>{const p=document.querySelector("html");p&&(p.classList.contains("dark")?p.classList.remove("dark"):p.classList.add("dark"))};if(!n)return null;console.log("Sidebar - User role:",n.role,"Tipo:",typeof n.role);const l=[{label:"Dashboard Pendncias",icon:ex,href:"/dashboard",roles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"]},{label:"Dashboard Lanadas",icon:ex,href:"/dashboard-lancadas",roles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"]},{label:"Validao",icon:_f,href:"/validation",roles:["COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"]},{label:"Relatrios",icon:DS,href:"/reports",roles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"]},{label:"Sincronizao",icon:vm,href:"/sync",roles:["LOGISTICA","ADMIN"]},{label:"Configuraes",icon:pk,href:"/settings",roles:["ADMIN"]}],c=!n.role||n.role==="NOVO",i=typeof n.role=="string"?n.role.toUpperCase():n.role;console.log("Sidebar - Filtrando rotas com role:",i);const u=c?[]:l.filter(p=>p.roles.includes(i));return console.log("Sidebar - Rotas filtradas:",u.map(p=>p.label)),_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:Et("hidden lg:flex pb-12 w-64 border-r bg-card h-screen fixed left-0 top-0 z-30 shadow-lg flex-col dark:border-r-zinc-800 transition-transform duration-300 ease-in-out",r?"translate-x-0":"-translate-x-full",t),onClick:p=>p.stopPropagation(),children:[_.jsxs("div",{className:"px-6 py-8 flex flex-col items-center border-b border-border/50",children:[_.jsx("div",{className:"h-24 w-24 relative mb-3 flex items-center justify-center overflow-hidden",children:_.jsx("img",{src:"https://i.ibb.co/b095hpJ/Chat-GPT-Image-25-de-dez-de-2025-15-24-45.png",alt:"Logo Doce Mel",className:"object-contain rounded"})}),_.jsx("h2",{className:"text-xl font-bold tracking-tight text-primary font-serif",children:"TRIELO CD BA"}),_.jsx("p",{className:"text-[10px] text-muted-foreground uppercase tracking-widest mt-1",children:"Gesto de Devolues"})]}),!c&&_.jsx("div",{className:"flex-1 overflow-y-auto py-4 px-3",children:_.jsx("div",{className:"space-y-1",children:u.map(p=>_.jsx(af,{to:p.href,children:_.jsxs(Nt,{variant:o.pathname===p.href?"secondary":"ghost",className:Et("w-full justify-start transition-all duration-200 mb-1",o.pathname===p.href?"bg-primary/10 text-primary font-bold border-r-4 border-primary rounded-r-none dark:text-primary dark:bg-primary/20":"hover:bg-muted text-muted-foreground hover:text-foreground"),children:[_.jsx(p.icon,{className:Et("mr-3 h-4 w-4",o.pathname===p.href?"text-primary":"text-muted-foreground")}),p.label]})},p.href))})}),_.jsxs("div",{className:"p-4 border-t border-border/50 bg-muted/10",children:[!c&&_.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[_.jsx("span",{className:"text-xs font-semibold text-muted-foreground",children:"Tema"}),_.jsxs(Nt,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:s,children:[_.jsx(ix,{className:"h-4 w-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),_.jsx(tx,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"})]})]}),_.jsxs("div",{className:"space-y-1 mb-4",children:[!c&&_.jsx(af,{to:"/profile",children:_.jsxs(Nt,{variant:o.pathname==="/profile"?"secondary":"ghost",className:"w-full justify-start h-9",children:[_.jsx(Ip,{className:"mr-2 h-4 w-4"}),"Perfil"]})}),_.jsxs(Nt,{variant:"ghost",className:"w-full justify-start text-destructive hover:text-destructive hover:bg-destructive/10 h-9",onClick:a,children:[_.jsx(Rp,{className:"mr-2 h-4 w-4"}),"Sair"]})]}),_.jsxs("div",{className:"flex items-center gap-3 px-2 py-2 rounded-lg bg-card border shadow-sm",children:[_.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/20 flex items-center justify-center text-primary font-bold text-xs",children:n.name.charAt(0).toUpperCase()}),_.jsxs("div",{className:"flex-1 overflow-hidden",children:[_.jsx("p",{className:"text-sm font-bold truncate text-foreground leading-none",children:n.name}),_.jsx("p",{className:"text-[10px] text-muted-foreground mt-1 truncate",children:n.role})]})]})]})]}),_.jsxs("div",{className:Et("lg:hidden pb-12 w-64 border-r bg-card h-screen fixed left-0 top-0 z-40 shadow-lg flex flex-col dark:border-r-zinc-800 transition-transform duration-300 ease-in-out",r?"translate-x-0":"-translate-x-full",t),onClick:p=>p.stopPropagation(),children:[_.jsxs("div",{className:"px-6 py-8 flex flex-col items-center border-b border-border/50 relative",children:[_.jsx(Nt,{variant:"ghost",size:"icon",className:"absolute top-4 right-4",onClick:e,children:_.jsx(Vf,{className:"h-5 w-5"})}),_.jsx("div",{className:"h-24 w-24 relative mb-3 flex items-center justify-center overflow-hidden",children:_.jsx("img",{src:"https://i.ibb.co/b095hpJ/Chat-GPT-Image-25-de-dez-de-2025-15-24-45.png",alt:"Logo Doce Mel",className:"object-contain rounded"})}),_.jsx("h2",{className:"text-xl font-bold tracking-tight text-foreground font-serif",children:"TRIELO CD BA"}),_.jsx("p",{className:"text-[10px] text-muted-foreground uppercase tracking-widest mt-1",children:"Gesto de Devolues"})]}),!c&&_.jsx("div",{className:"flex-1 overflow-y-auto py-4 px-3",children:_.jsx("div",{className:"space-y-1",children:u.map(p=>_.jsx(af,{to:p.href,onClick:e,children:_.jsxs(Nt,{variant:o.pathname===p.href?"secondary":"ghost",className:Et("w-full justify-start transition-all duration-200 mb-1",o.pathname===p.href?"bg-primary/10 text-primary font-bold border-r-4 border-primary rounded-r-none dark:text-primary dark:bg-primary/20":"hover:bg-muted text-muted-foreground hover:text-foreground"),children:[_.jsx(p.icon,{className:Et("mr-3 h-4 w-4",o.pathname===p.href?"text-primary":"text-muted-foreground")}),p.label]})},p.href))})}),_.jsxs("div",{className:"p-4 border-t border-border/50 bg-muted/10",children:[!c&&_.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[_.jsx("span",{className:"text-xs font-semibold text-muted-foreground",children:"Tema"}),_.jsxs(Nt,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:s,children:[_.jsx(ix,{className:"h-4 w-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),_.jsx(tx,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"})]})]}),_.jsxs("div",{className:"space-y-1 mb-4",children:[!c&&_.jsx(af,{to:"/profile",onClick:e,children:_.jsxs(Nt,{variant:o.pathname==="/profile"?"secondary":"ghost",className:"w-full justify-start h-9",children:[_.jsx(Ip,{className:"mr-2 h-4 w-4"}),"Perfil"]})}),_.jsxs(Nt,{variant:"ghost",className:"w-full justify-start text-destructive hover:text-destructive hover:bg-destructive/10 h-9",onClick:a,children:[_.jsx(Rp,{className:"mr-2 h-4 w-4"}),"Sair"]})]}),_.jsxs("div",{className:"flex items-center gap-3 px-2 py-2 rounded-lg bg-card border shadow-sm",children:[_.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/20 flex items-center justify-center text-primary font-bold text-xs",children:n.name.charAt(0).toUpperCase()}),_.jsxs("div",{className:"flex-1 overflow-hidden",children:[_.jsx("p",{className:"text-sm font-bold truncate text-foreground leading-none",children:n.name}),_.jsx("p",{className:"text-[10px] text-muted-foreground mt-1 truncate",children:n.role})]})]})]})]})]})}function PB(){const{user:t}=Dn(),r=!(t!=null&&t.role)||t.role==="NOVO",[e,n]=_e.useState(!r),a=()=>{n(!e)},o=()=>{n(!1)};return _.jsxs("div",{className:"flex h-screen bg-background relative",children:[e&&!r&&_.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:o}),!r&&_.jsx(Nt,{variant:"ghost",size:"icon",className:"fixed top-4 left-4 z-50",onClick:a,children:e?_.jsx(Vf,{className:"h-6 w-6"}):_.jsx(KS,{className:"h-6 w-6"})}),_.jsx(IB,{isOpen:e,onClose:o}),_.jsx("main",{className:`flex-1 overflow-y-auto transition-all duration-300 ${!r&&e?"lg:ml-64":"lg:ml-0"} ${r?"":"pt-16 lg:pt-0"}`,onClick:()=>{e&&!r&&o()},children:_.jsx("div",{className:r?"":"p-4 lg:p-6",children:_.jsx(a8,{})})})]})}var LB=(t,r,e,n,a,o,s,l)=>{let c=document.documentElement,i=["light","dark"];function u(h){(Array.isArray(t)?t:[t]).forEach(v=>{let b=v==="class",g=b&&o?a.map(x=>o[x]||x):a;b?(c.classList.remove(...g),c.classList.add(o&&o[h]?o[h]:h)):c.setAttribute(v,h)}),p(h)}function p(h){l&&i.includes(h)&&(c.style.colorScheme=h)}function f(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(n)u(n);else try{let h=localStorage.getItem(r)||e,v=s&&h==="system"?f():h;u(v)}catch{}},BB=_e.createContext(void 0),UB={setTheme:t=>{},themes:[]},zB=()=>{var t;return(t=_e.useContext(BB))!=null?t:UB};_e.memo(({forcedTheme:t,storageKey:r,attribute:e,enableSystem:n,enableColorScheme:a,defaultTheme:o,value:s,themes:l,nonce:c,scriptProps:i})=>{let u=JSON.stringify([e,r,o,t,l,s,n,a]).slice(1,-1);return _e.createElement("script",{...i,suppressHydrationWarning:!0,nonce:typeof window>"u"?c:"",dangerouslySetInnerHTML:{__html:`(${LB.toString()})(${u})`}})});const $B=({...t})=>{const{theme:r="system"}=zB();return _.jsx(IN,{theme:r,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};function VB(){return _.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background",children:_.jsxs("div",{className:"max-w-md p-8 space-y-4 text-center",children:[_.jsx("div",{className:"text-destructive",children:_.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),_.jsx("h1",{className:"text-2xl font-bold",children:"Erro de Configurao"}),_.jsx("p",{className:"text-muted-foreground",children:"As variveis de ambiente do Supabase no esto configuradas."}),_.jsxs("p",{className:"text-sm text-muted-foreground",children:["Crie um arquivo ",_.jsx("code",{className:"px-2 py-1 bg-muted rounded",children:".env"})," na raiz do projeto com:"]}),_.jsx("pre",{className:"p-4 text-left bg-muted rounded-lg text-sm",children:`VITE_SUPABASE_URL=sua_url_aqui
VITE_SUPABASE_ANON_KEY=sua_chave_aqui`}),_.jsx("p",{className:"text-sm text-muted-foreground",children:"Aps configurar, reinicie o servidor de desenvolvimento."})]})})}function ty({children:t,allowNovo:r=!1}){const{user:e,isLoading:n}=Dn(),a=vy();return console.log("ProtectedRoute - isLoading:",n,"user:",e==null?void 0:e.email,"location:",a.pathname),n?_.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[_.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"}),_.jsx("p",{className:"ml-4 text-sm text-muted-foreground",children:"Carregando..."})]}):e?r?_.jsx(_.Fragment,{children:t}):(!e.role||e.role==="NOVO")&&a.pathname!=="/empty"?(console.log("ProtectedRoute - Redirecionando usurio NOVO para /empty"),_.jsx(Io,{to:"/empty",replace:!0})):_.jsx(_.Fragment,{children:t}):(console.log("ProtectedRoute - Redirecionando para /login"),_.jsx(Io,{to:"/login",replace:!0}))}function HB(){const{user:t,isLoading:r}=Dn();return r?_.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[_.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"}),_.jsx("p",{className:"ml-4 text-sm text-muted-foreground",children:"Carregando..."})]}):!(t!=null&&t.role)||t.role==="NOVO"?_.jsx(Io,{to:"/empty",replace:!0}):_.jsx(Io,{to:"/dashboard",replace:!0})}function Rl({children:t,allowedRoles:r}){const{user:e,isLoading:n}=Dn();if(n)return _.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[_.jsx(oi,{className:"h-8 w-8 animate-spin text-primary"}),_.jsx("p",{className:"ml-4 text-sm text-muted-foreground",children:"Carregando..."})]});if(!e)return _.jsx(Io,{to:"/login",replace:!0});if(!e.role||e.role==="NOVO")return console.warn(` Acesso negado: usurio ${e.email} (${e.role||"sem role"}) tentou acessar rota protegida`),_.jsx(Io,{to:"/empty",replace:!0});const a=typeof e.role=="string"?e.role.toUpperCase():e.role;return r.includes(a)?_.jsx(_.Fragment,{children:t}):(console.warn(` Acesso negado: usurio ${e.email} (${a}) tentou acessar rota permitida apenas para:`,r),_.jsx(Io,{to:"/profile",replace:!0}))}function qB(){const{setUser:t,setIsLoading:r}=Dn(),[e,n]=_e.useState(!1);return _e.useEffect(()=>{let a=!0;console.log(" App - Inicializando autenticao...");const o=setTimeout(()=>{a&&(console.warn(" Timeout de segurana - forando setIsLoading(false)"),r(!1))},15e3),s=async(c,i)=>{var h,v,b;console.log(" Carregando perfil para:",i,"userId:",c);const p=Dn.getState().user;if(p&&p.id===c&&p.role&&p.role!=="NOVO")return console.log(" Usando perfil em cache:",p.role),p;try{const g=Date.now(),x=St.from("profiles").select("id, email, name, role, vendedor").eq("id",c).maybeSingle(),y=new Promise((W,V)=>{setTimeout(()=>V(new Error("Query timeout aps 8 segundos")),8e3)});let k;try{k=await Promise.race([x,y])}catch(W){throw console.warn(" Query timeout, continuando com fallback..."),W}const{data:N,error:F}=k,B=Date.now()-g;if(console.log(` Query executada em ${B}ms`,{hasData:!!N,error:F==null?void 0:F.message}),N&&!F){let W="NOVO";if(N.role){const q=String(N.role).trim().toUpperCase();console.log(" Role processado:",q),["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR","NOVO"].includes(q)?W=q:(console.warn(" Role invlido no banco:",q,"- usando NOVO"),W="NOVO")}else console.warn(" Role est vazio no banco - usando NOVO"),W="NOVO";const V={id:N.id,email:i,name:N.name||i.split("@")[0],role:W,vendedor:N.vendedor||null};console.log(" Perfil carregado do banco:",V);try{const q={...V,_cacheTime:Date.now()};localStorage.setItem(`profile_${c}`,JSON.stringify(q))}catch(q){console.warn(" Erro ao salvar perfil no localStorage:",q)}return V}else console.warn(" Sem dados do perfil no banco. Erro:",F)}catch(g){console.warn(" Erro na query do banco, tentando fallback...",(g==null?void 0:g.message)||g)}try{console.log(" Tentando fallback 1: metadata do auth...");const{data:g,error:x}=await St.auth.getUser();if(!x&&(g!=null&&g.user)){const y=(h=g.user.user_metadata)==null?void 0:h.role,k=y&&["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR","NOVO"].includes(String(y).toUpperCase())?String(y).toUpperCase():"NOVO",N={id:c,email:i,name:((v=g.user.user_metadata)==null?void 0:v.name)||i.split("@")[0],role:k,vendedor:((b=g.user.user_metadata)==null?void 0:b.vendedor)||null};return console.log(" Usando fallback (metadata):",N),N}else console.warn(" Metadata retornou erro ou sem dados:",x)}catch(g){console.warn(" Erro ao buscar metadata:",g)}const f={id:c,email:i,name:i.split("@")[0],role:"NOVO",vendedor:null};return console.log(" Usando fallback final (NOVO) - query do banco falhou:",f),f},{data:{subscription:l}}=St.auth.onAuthStateChange(async(c,i)=>{var u;if(console.log(" Auth mudou:",c,(u=i==null?void 0:i.user)==null?void 0:u.email),!!a){if(c==="TOKEN_REFRESHED"){console.log(" Token renovado - mantendo perfil atual");return}if(c!=="SIGNED_IN"&&c!=="SIGNED_OUT"&&c!=="USER_UPDATED"){console.log(" Evento ignorado:",c);return}try{if(i!=null&&i.user){const f=Dn.getState().user;if(f&&f.id===i.user.id&&c!=="USER_UPDATED"){console.log(" Usurio j carregado, mantendo perfil atual:",f.role),a&&r(!1);return}const h=s(i.user.id,i.user.email),v=new Promise(g=>{setTimeout(()=>{const x={id:i.user.id,email:i.user.email,name:i.user.email.split("@")[0],role:"NOVO",vendedor:null};console.log(" Timeout no loadProfile - usando perfil mnimo:",x),g(x)},1e4)}),b=await Promise.race([h,v]);a&&b&&(console.log(" Usurio setado:",{email:b.email,role:b.role,name:b.name,id:b.id,vendedor:b.vendedor}),t(b))}else a&&(console.log(" Sem sesso"),t(null))}catch(p){if(console.error(" Erro no listener de auth:",p),a&&(i!=null&&i.user)){const f={id:i.user.id,email:i.user.email,name:i.user.email.split("@")[0],role:"NOVO",vendedor:null};console.log(" Usando perfil mnimo devido a erro:",f),t(f)}else t(null)}finally{a&&r(!1)}}});return St.auth.getSession().then(async({data:{session:c}})=>{if(a)try{if(c!=null&&c.user){console.log(" Sesso encontrada:",c.user.email);const u=Dn.getState().user;if(u&&u.id===c.user.id&&u.role&&u.role!=="NOVO"){console.log(" Usando perfil do store (cache):",u.role),r(!1),clearTimeout(o),s(c.user.id,c.user.email).then(f=>{f&&a&&t(f)}).catch(f=>{console.warn(" Erro ao atualizar perfil em background:",f)});return}try{const f=localStorage.getItem(`profile_${c.user.id}`);if(f){const h=JSON.parse(f),v=h._cacheTime||0,g=Date.now()-v,x=24*60*60*1e3;if(g<x&&h.role&&h.role!=="NOVO"){const{_cacheTime:y,...k}=h;console.log(" Usando perfil do localStorage:",k.role),t(k),r(!1),clearTimeout(o),s(c.user.id,c.user.email).then(N=>{N&&a&&t(N)}).catch(N=>{console.warn(" Erro ao atualizar perfil em background:",N)});return}else console.log(" Cache expirado ou invlido, buscando do banco..."),localStorage.removeItem(`profile_${c.user.id}`)}}catch(f){console.warn(" Erro ao ler cache do localStorage:",f)}const p=await s(c.user.id,c.user.email);if(a&&p){console.log(" Setando usurio inicial:",{email:p.email,role:p.role,name:p.name,vendedor:p.vendedor});try{const f={...p,_cacheTime:Date.now()};localStorage.setItem(`profile_${c.user.id}`,JSON.stringify(f))}catch(f){console.warn(" Erro ao salvar no localStorage:",f)}t(p),r(!1),clearTimeout(o)}}else console.log(" Sem sesso inicial"),a&&(t(null),r(!1),clearTimeout(o))}catch(i){if(console.error(" Erro ao carregar sesso inicial:",i),a&&(c!=null&&c.user)){const p=Dn.getState().user;if(p&&p.id===c.user.id&&p.role&&p.role!=="NOVO"){console.log(" Usando perfil do store devido a erro:",p.role),r(!1),clearTimeout(o);return}try{const h=localStorage.getItem(`profile_${c.user.id}`);if(h){const v=JSON.parse(h),{_cacheTime:b,...g}=v;if(g.role&&g.role!=="NOVO"){console.log(" Usando perfil do cache devido a erro:",g.role),t(g),r(!1),clearTimeout(o);return}}}catch(h){console.warn(" Erro ao ler cache em fallback:",h)}const f={id:c.user.id,email:c.user.email,name:c.user.email.split("@")[0],role:"NOVO",vendedor:null};console.log(" Usando perfil mnimo devido a erro (sem cache vlido):",f),t(f),r(!1),clearTimeout(o)}else t(null),r(!1),clearTimeout(o)}}).catch(c=>{console.error(" Erro ao verificar sesso:",c),a&&(t(null),r(!1),clearTimeout(o))}),()=>{console.log(" Cleanup"),a=!1,clearTimeout(o),l.unsubscribe()}},[t,r]),e?_.jsx(VB,{}):_.jsxs(s8,{children:[_.jsxs(i8,{children:[_.jsx(Qa,{path:"/login",element:_.jsx(ZN,{})}),_.jsx(Qa,{path:"/empty",element:_.jsx(ty,{allowNovo:!0,children:_.jsx(FB,{})})}),_.jsxs(Qa,{path:"/",element:_.jsx(ty,{children:_.jsx(PB,{})}),children:[_.jsx(Qa,{index:!0,element:_.jsx(HB,{})}),_.jsx(Qa,{path:"dashboard",element:_.jsx(Rl,{allowedRoles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"],children:_.jsx(BN,{})})}),_.jsx(Qa,{path:"dashboard-lancadas",element:_.jsx(Rl,{allowedRoles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"],children:_.jsx(YN,{})})}),_.jsx(Qa,{path:"validation",element:_.jsx(Rl,{allowedRoles:["COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"],children:_.jsx(lB,{})})}),_.jsx(Qa,{path:"reports",element:_.jsx(Rl,{allowedRoles:["GESTOR","COMERCIAL","LOGISTICA","ADMIN","VENDEDOR"],children:_.jsx(aj,{})})}),_.jsx(Qa,{path:"sync",element:_.jsx(Rl,{allowedRoles:["LOGISTICA","ADMIN"],children:_.jsx(iB,{})})}),_.jsx(Qa,{path:"settings",element:_.jsx(Rl,{allowedRoles:["ADMIN","LOGISTICA"],children:_.jsx(kB,{})})}),_.jsx(Qa,{path:"profile",element:_.jsx(MB,{})})]})]}),_.jsx($B,{})]})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log(" Service Worker registrado com sucesso:",t.scope)}).catch(t=>{console.warn(" Falha ao registrar Service Worker:",t)})});b8.createRoot(document.getElementById("root")).render(_.jsx(qB,{}));
